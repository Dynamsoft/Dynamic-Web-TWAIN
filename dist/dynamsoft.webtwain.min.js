// 20231129
/*
* @name: Dynamic Web TWAIN all-in-one package
* @version: 18.4.2
* @components:
*   + Dynamic Web TWAIN: 18.4.2
*   + Barcode Reader Addon for Dynamic Web TWAIN: 18.4.2 (DBR version 9.6.20)
*   + PDF Rasterizer Addon for Dynamic Web TWAIN: 18.4.2
*   + OCR Basic Addon for Dynamic Web TWAIN: 18.4.2
*   + OCR Pro Addon for Dynamic Web TWAIN: 18.4.2
*   + Webcam Addon for Dynamic Web TWAIN: 18.4.2
*   + Dynamsoft File Uploader: 18.4.2
*/

 
/*! 20230919165843 - 20230504
* Dynamsoft JavaScript Library
* Product: Dynamic Web TWAIN
* Web Site: https://www.dynamsoft.com
*
* Copyright 2023, Dynamsoft Corporation
* Author: Dynamsoft Support Team
* Version: 18.4.2
*/
var globalThis=self||window||{},Dynamsoft=globalThis.Dynamsoft||{};
(function(b){if(!b.DWT){b.DWT={}}if(!b.DWT.LTS){b.DWT.LTS={}}if(!b.Lib){b.Lib={}}if(!b.Lib.UI){b.Lib.UI={}}if(!b.Lib.html5){b.Lib.html5={}}globalThis.Dynamsoft=b})(Dynamsoft);
(function(e){if(!e.WeakSet){e.WeakSet=b;var c=Date.now()%1E9;function b(a){this.name="__st"+(1E9*Math.random()>>>0)+(c++ +"__");a&&a.forEach&&a.forEach(this.add,this)}var z=b.prototype;z.add=function(a){var d=this.name;a[d]||Object.defineProperty(a,d,{value:!0,writable:!0});return this};z["delete"]=function(a){if(!a[this.name])return!1;a[this.name]=void 0;return!0};z.has=function(a){return!!a[this.name]};}
if(!e.WeakMap){var r=Object.prototype.hasOwnProperty;var n=Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{value:1}).x===1}catch(e){}}();var i=function(e,t,r){if(n){Object.defineProperty(e,t,{configurable:true,writable:true,value:r})}else{e[t]=r}};e.WeakMap=function(){function WeakMap(){if(this===void 0){throw new TypeError("Constructor WeakMap requires 'new'")}i(this,"_id",genId("_WeakMap"));if(arguments.length>0){throw new TypeError("WeakMap iterable is not supported")}}i(WeakMap.prototype,"delete",function(e){checkInstance(this,"delete");if(!isObject(e)){return false}var t=e[this._id];if(t&&t[0]===e){delete e[this._id];return true}return false});i(WeakMap.prototype,"get",function(e){checkInstance(this,"get");if(!isObject(e)){return void 0}var t=e[this._id];if(t&&t[0]===e){return t[1]}return void 0});i(WeakMap.prototype,"has",function(e){checkInstance(this,"has");if(!isObject(e)){return false}var t=e[this._id];if(t&&t[0]===e){return true}return false});i(WeakMap.prototype,"set",function(e,t){checkInstance(this,"set");if(!isObject(e)){throw new TypeError("Invalid value used as weak map key")}var r=e[this._id];if(r&&r[0]===e){r[1]=t;return this}i(e,this._id,[e,t]);return this});function checkInstance(e,t){if(!isObject(e)||!r.call(e,"_id")){throw new TypeError(t+" method called on incompatible receiver "+typeof e)}}function genId(e){return e+"_"+rand()+"."+rand()}function rand(){return Math.random().toString().substring(2)}i(WeakMap,"_polyfill",true);return WeakMap}();function isObject(e){return Object(e)===e}}})(typeof globalThis!=="undefined"?globalThis:typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof global!=="undefined"?global:this);
(function(factory){if(typeof exports==="object"){module.exports=factory()}else if(typeof define==="function"&&define.amd){define(factory)}else{var glob;try{glob=window}catch(e){glob=self}glob.SparkMD5=factory()}})(function(undefined){"use strict";var add32=function(a,b){return a+b&4294967295},hex_chr=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function cmn(q,a,b,x,s,t){a=add32(add32(a,q),add32(x,t));return add32(a<<s|a>>>32-s,b)}function md5cycle(x,k){var a=x[0],b=x[1],c=x[2],d=x[3];a+=(b&c|~b&d)+k[0]-680876936|0;a=(a<<7|a>>>25)+b|0;d+=(a&b|~a&c)+k[1]-389564586|0;d=(d<<12|d>>>20)+a|0;c+=(d&a|~d&b)+k[2]+606105819|0;c=(c<<17|c>>>15)+d|0;b+=(c&d|~c&a)+k[3]-1044525330|0;b=(b<<22|b>>>10)+c|0;a+=(b&c|~b&d)+k[4]-176418897|0;a=(a<<7|a>>>25)+b|0;d+=(a&b|~a&c)+k[5]+1200080426|0;d=(d<<12|d>>>20)+a|0;c+=(d&a|~d&b)+k[6]-1473231341|0;c=(c<<17|c>>>15)+d|0;b+=(c&d|~c&a)+k[7]-45705983|0;b=(b<<22|b>>>10)+c|0;a+=(b&c|~b&d)+k[8]+1770035416|0;a=(a<<7|a>>>25)+b|0;d+=(a&b|~a&c)+k[9]-1958414417|0;d=(d<<12|d>>>20)+a|0;c+=(d&a|~d&b)+k[10]-42063|0;c=(c<<17|c>>>15)+d|0;b+=(c&d|~c&a)+k[11]-1990404162|0;b=(b<<22|b>>>10)+c|0;a+=(b&c|~b&d)+k[12]+1804603682|0;a=(a<<7|a>>>25)+b|0;d+=(a&b|~a&c)+k[13]-40341101|0;d=(d<<12|d>>>20)+a|0;c+=(d&a|~d&b)+k[14]-1502002290|0;c=(c<<17|c>>>15)+d|0;b+=(c&d|~c&a)+k[15]+1236535329|0;b=(b<<22|b>>>10)+c|0;a+=(b&d|c&~d)+k[1]-165796510|0;a=(a<<5|a>>>27)+b|0;d+=(a&c|b&~c)+k[6]-1069501632|0;d=(d<<9|d>>>23)+a|0;c+=(d&b|a&~b)+k[11]+643717713|0;c=(c<<14|c>>>18)+d|0;b+=(c&a|d&~a)+k[0]-373897302|0;b=(b<<20|b>>>12)+c|0;a+=(b&d|c&~d)+k[5]-701558691|0;a=(a<<5|a>>>27)+b|0;d+=(a&c|b&~c)+k[10]+38016083|0;d=(d<<9|d>>>23)+a|0;c+=(d&b|a&~b)+k[15]-660478335|0;c=(c<<14|c>>>18)+d|0;b+=(c&a|d&~a)+k[4]-405537848|0;b=(b<<20|b>>>12)+c|0;a+=(b&d|c&~d)+k[9]+568446438|0;a=(a<<5|a>>>27)+b|0;d+=(a&c|b&~c)+k[14]-1019803690|0;d=(d<<9|d>>>23)+a|0;c+=(d&b|a&~b)+k[3]-187363961|0;c=(c<<14|c>>>18)+d|0;b+=(c&a|d&~a)+k[8]+1163531501|0;b=(b<<20|b>>>12)+c|0;a+=(b&d|c&~d)+k[13]-1444681467|0;a=(a<<5|a>>>27)+b|0;d+=(a&c|b&~c)+k[2]-51403784|0;d=(d<<9|d>>>23)+a|0;c+=(d&b|a&~b)+k[7]+1735328473|0;c=(c<<14|c>>>18)+d|0;b+=(c&a|d&~a)+k[12]-1926607734|0;b=(b<<20|b>>>12)+c|0;a+=(b^c^d)+k[5]-378558|0;a=(a<<4|a>>>28)+b|0;d+=(a^b^c)+k[8]-2022574463|0;d=(d<<11|d>>>21)+a|0;c+=(d^a^b)+k[11]+1839030562|0;c=(c<<16|c>>>16)+d|0;b+=(c^d^a)+k[14]-35309556|0;b=(b<<23|b>>>9)+c|0;a+=(b^c^d)+k[1]-1530992060|0;a=(a<<4|a>>>28)+b|0;d+=(a^b^c)+k[4]+1272893353|0;d=(d<<11|d>>>21)+a|0;c+=(d^a^b)+k[7]-155497632|0;c=(c<<16|c>>>16)+d|0;b+=(c^d^a)+k[10]-1094730640|0;b=(b<<23|b>>>9)+c|0;a+=(b^c^d)+k[13]+681279174|0;a=(a<<4|a>>>28)+b|0;d+=(a^b^c)+k[0]-358537222|0;d=(d<<11|d>>>21)+a|0;c+=(d^a^b)+k[3]-722521979|0;c=(c<<16|c>>>16)+d|0;b+=(c^d^a)+k[6]+76029189|0;b=(b<<23|b>>>9)+c|0;a+=(b^c^d)+k[9]-640364487|0;a=(a<<4|a>>>28)+b|0;d+=(a^b^c)+k[12]-421815835|0;d=(d<<11|d>>>21)+a|0;c+=(d^a^b)+k[15]+530742520|0;c=(c<<16|c>>>16)+d|0;b+=(c^d^a)+k[2]-995338651|0;b=(b<<23|b>>>9)+c|0;a+=(c^(b|~d))+k[0]-198630844|0;a=(a<<6|a>>>26)+b|0;d+=(b^(a|~c))+k[7]+1126891415|0;d=(d<<10|d>>>22)+a|0;c+=(a^(d|~b))+k[14]-1416354905|0;c=(c<<15|c>>>17)+d|0;b+=(d^(c|~a))+k[5]-57434055|0;b=(b<<21|b>>>11)+c|0;a+=(c^(b|~d))+k[12]+1700485571|0;a=(a<<6|a>>>26)+b|0;d+=(b^(a|~c))+k[3]-1894986606|0;d=(d<<10|d>>>22)+a|0;c+=(a^(d|~b))+k[10]-1051523|0;c=(c<<15|c>>>17)+d|0;b+=(d^(c|~a))+k[1]-2054922799|0;b=(b<<21|b>>>11)+c|0;a+=(c^(b|~d))+k[8]+1873313359|0;a=(a<<6|a>>>26)+b|0;d+=(b^(a|~c))+k[15]-30611744|0;d=(d<<10|d>>>22)+a|0;c+=(a^(d|~b))+k[6]-1560198380|0;c=(c<<15|c>>>17)+d|0;b+=(d^(c|~a))+k[13]+1309151649|0;b=(b<<21|b>>>11)+c|0;a+=(c^(b|~d))+k[4]-145523070|0;a=(a<<6|a>>>26)+b|0;d+=(b^(a|~c))+k[11]-1120210379|0;d=(d<<10|d>>>22)+a|0;c+=(a^(d|~b))+k[2]+718787259|0;c=(c<<15|c>>>17)+d|0;b+=(d^(c|~a))+k[9]-343485551|0;b=(b<<21|b>>>11)+c|0;x[0]=a+x[0]|0;x[1]=b+x[1]|0;x[2]=c+x[2]|0;x[3]=d+x[3]|0}function md5blk(s){var md5blks=[],i;for(i=0;i<64;i+=4){md5blks[i>>2]=s.charCodeAt(i)+(s.charCodeAt(i+1)<<8)+(s.charCodeAt(i+2)<<16)+(s.charCodeAt(i+3)<<24)}return md5blks}function md5blk_array(a){var md5blks=[],i;for(i=0;i<64;i+=4){md5blks[i>>2]=a[i]+(a[i+1]<<8)+(a[i+2]<<16)+(a[i+3]<<24)}return md5blks}function md51(s){var n=s.length,state=[1732584193,-271733879,-1732584194,271733878],i,length,tail,tmp,lo,hi;for(i=64;i<=n;i+=64){md5cycle(state,md5blk(s.substring(i-64,i)))}s=s.substring(i-64);length=s.length;tail=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(i=0;i<length;i+=1){tail[i>>2]|=s.charCodeAt(i)<<(i%4<<3)}tail[i>>2]|=128<<(i%4<<3);if(i>55){md5cycle(state,tail);for(i=0;i<16;i+=1){tail[i]=0}}tmp=n*8;tmp=tmp.toString(16).match(/(.*?)(.{0,8})$/);lo=parseInt(tmp[2],16);hi=parseInt(tmp[1],16)||0;tail[14]=lo;tail[15]=hi;md5cycle(state,tail);return state}function md51_array(a){var n=a.length,state=[1732584193,-271733879,-1732584194,271733878],i,length,tail,tmp,lo,hi;for(i=64;i<=n;i+=64){md5cycle(state,md5blk_array(a.subarray(i-64,i)))}a=i-64<n?a.subarray(i-64):new Uint8Array(0);length=a.length;tail=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(i=0;i<length;i+=1){tail[i>>2]|=a[i]<<(i%4<<3)}tail[i>>2]|=128<<(i%4<<3);if(i>55){md5cycle(state,tail);for(i=0;i<16;i+=1){tail[i]=0}}tmp=n*8;tmp=tmp.toString(16).match(/(.*?)(.{0,8})$/);lo=parseInt(tmp[2],16);hi=parseInt(tmp[1],16)||0;tail[14]=lo;tail[15]=hi;md5cycle(state,tail);return state}function rhex(n){var s="",j;for(j=0;j<4;j+=1){s+=hex_chr[n>>j*8+4&15]+hex_chr[n>>j*8&15]}return s}function hex(x){var i;for(i=0;i<x.length;i+=1){x[i]=rhex(x[i])}return x.join("")}if(hex(md51("hello"))!=="5d41402abc4b2a76b9719d911017c592"){add32=function(x,y){var lsw=(x&65535)+(y&65535),msw=(x>>16)+(y>>16)+(lsw>>16);return msw<<16|lsw&65535}}if(typeof ArrayBuffer!=="undefined"&&!ArrayBuffer.prototype.slice){(function(){function clamp(val,length){val=val|0||0;if(val<0){return Math.max(val+length,0)}return Math.min(val,length)}ArrayBuffer.prototype.slice=function(from,to){var length=this.byteLength,begin=clamp(from,length),end=length,num,target,targetArray,sourceArray;if(to!==undefined){end=clamp(to,length)}if(begin>end){return new ArrayBuffer(0)}num=end-begin;target=new ArrayBuffer(num);targetArray=new Uint8Array(target);sourceArray=new Uint8Array(this,begin,num);targetArray.set(sourceArray);return target}})()}function toUtf8(str){if(/[\u0080-\uFFFF]/.test(str)){str=unescape(encodeURIComponent(str))}return str}function utf8Str2ArrayBuffer(str,returnUInt8Array){var length=str.length,buff=new ArrayBuffer(length),arr=new Uint8Array(buff),i;for(i=0;i<length;i+=1){arr[i]=str.charCodeAt(i)}return returnUInt8Array?arr:buff}function arrayBuffer2Utf8Str(buff){return String.fromCharCode.apply(null,new Uint8Array(buff))}function concatenateArrayBuffers(first,second,returnUInt8Array){var result=new Uint8Array(first.byteLength+second.byteLength);result.set(new Uint8Array(first));result.set(new Uint8Array(second),first.byteLength);return returnUInt8Array?result:result.buffer}function hexToBinaryString(hex){var bytes=[],length=hex.length,x;for(x=0;x<length-1;x+=2){bytes.push(parseInt(hex.substr(x,2),16))}return String.fromCharCode.apply(String,bytes)}function SparkMD5(){this.reset()}SparkMD5.prototype.append=function(str){this.appendBinary(toUtf8(str));return this};SparkMD5.prototype.appendBinary=function(contents){this._buff+=contents;this._length+=contents.length;var length=this._buff.length,i;for(i=64;i<=length;i+=64){md5cycle(this._hash,md5blk(this._buff.substring(i-64,i)))}this._buff=this._buff.substring(i-64);return this};SparkMD5.prototype.end=function(raw){var buff=this._buff,length=buff.length,i,tail=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ret;for(i=0;i<length;i+=1){tail[i>>2]|=buff.charCodeAt(i)<<(i%4<<3)}this._finish(tail,length);ret=hex(this._hash);if(raw){ret=hexToBinaryString(ret)}this.reset();return ret};SparkMD5.prototype.reset=function(){this._buff="";this._length=0;this._hash=[1732584193,-271733879,-1732584194,271733878];return this};SparkMD5.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}};SparkMD5.prototype.setState=function(state){this._buff=state.buff;this._length=state.length;this._hash=state.hash;return this};SparkMD5.prototype.destroy=function(){delete this._hash;delete this._buff;delete this._length};SparkMD5.prototype._finish=function(tail,length){var i=length,tmp,lo,hi;tail[i>>2]|=128<<(i%4<<3);if(i>55){md5cycle(this._hash,tail);for(i=0;i<16;i+=1){tail[i]=0}}tmp=this._length*8;tmp=tmp.toString(16).match(/(.*?)(.{0,8})$/);lo=parseInt(tmp[2],16);hi=parseInt(tmp[1],16)||0;tail[14]=lo;tail[15]=hi;md5cycle(this._hash,tail)};SparkMD5.hash=function(str,raw){return SparkMD5.hashBinary(toUtf8(str),raw)};SparkMD5.hashBinary=function(content,raw){var hash=md51(content),ret=hex(hash);return raw?hexToBinaryString(ret):ret};SparkMD5.ArrayBuffer=function(){this.reset()};SparkMD5.ArrayBuffer.prototype.append=function(arr){var buff=concatenateArrayBuffers(this._buff.buffer,arr,true),length=buff.length,i;this._length+=arr.byteLength;for(i=64;i<=length;i+=64){md5cycle(this._hash,md5blk_array(buff.subarray(i-64,i)))}this._buff=i-64<length?new Uint8Array(buff.buffer.slice(i-64)):new Uint8Array(0);return this};SparkMD5.ArrayBuffer.prototype.end=function(raw){var buff=this._buff,length=buff.length,tail=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],i,ret;for(i=0;i<length;i+=1){tail[i>>2]|=buff[i]<<(i%4<<3)}this._finish(tail,length);ret=hex(this._hash);if(raw){ret=hexToBinaryString(ret)}this.reset();return ret};SparkMD5.ArrayBuffer.prototype.reset=function(){this._buff=new Uint8Array(0);this._length=0;this._hash=[1732584193,-271733879,-1732584194,271733878];return this};SparkMD5.ArrayBuffer.prototype.getState=function(){var state=SparkMD5.prototype.getState.call(this);state.buff=arrayBuffer2Utf8Str(state.buff);return state};SparkMD5.ArrayBuffer.prototype.setState=function(state){state.buff=utf8Str2ArrayBuffer(state.buff,true);return SparkMD5.prototype.setState.call(this,state)};SparkMD5.ArrayBuffer.prototype.destroy=SparkMD5.prototype.destroy;SparkMD5.ArrayBuffer.prototype._finish=SparkMD5.prototype._finish;SparkMD5.ArrayBuffer.hash=function(arr,raw){var hash=md51_array(new Uint8Array(arr)),ret=hex(hash);return raw?hexToBinaryString(ret):ret};return SparkMD5});
!function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(t){var r=function(t,r){if("object"!==e(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(n!==undefined){var i=n.call(t,r||"default");if("object"!==e(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"===e(r)?r:String(r)}function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,r(i.key),i)}}function i(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function a(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e["default"]:e}var s={exports:{}},u={exports:{}};!function(e){function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports["default"]=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports["default"]=e.exports}(u);var c=u.exports;!function(e){var t=c["default"];function r(){e.exports=r=function(){return i},e.exports.__esModule=!0,e.exports["default"]=e.exports;var n,i={},o=Object.prototype,a=o.hasOwnProperty,s=Object.defineProperty||function(e,t,r){e[t]=r.value},u="function"==typeof Symbol?Symbol:{},c=u.iterator||"@@iterator",l=u.asyncIterator||"@@asyncIterator",d=u.toStringTag||"@@toStringTag";function f(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch(n){f=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var i=t&&t.prototype instanceof I?t:I,o=Object.create(i.prototype),a=new W(n||[]);return s(o,"_invoke",{value:P(e,r,a)}),o}function g(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}i.wrap=h;var p="suspendedStart",m="suspendedYield",_="executing",v="completed",y={};function I(){}function S(){}function T(){}var b={};f(b,c,(function(){return this}));var C=Object.getPrototypeOf,w=C&&C(C(R([])));w&&w!==o&&a.call(w,c)&&(b=w);var E=T.prototype=I.prototype=Object.create(b);function A(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,r){function n(i,o,s,u){var c=g(e[i],e,o);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==t(d)&&a.call(d,"__await")?r.resolve(d.__await).then((function(e){n("next",e,s,u)}),(function(e){n("throw",e,s,u)})):r.resolve(d).then((function(e){l.value=e,s(l)}),(function(e){return n("throw",e,s,u)}))}u(c.arg)}var i;s(this,"_invoke",{value:function(e,t){function o(){return new r((function(r,i){n(e,t,r,i)}))}return i=i?i.then(o,o):o()}})}function P(e,t,r){var i=p;return function(o,a){if(i===_)throw new Error("Generator is already running");if(i===v){if("throw"===o)throw a;return{value:n,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=x(s,r);if(u){if(u===y)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===p)throw i=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=_;var c=g(e,t,r);if("normal"===c.type){if(i=r.done?v:m,c.arg===y)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=v,r.method="throw",r.arg=c.arg)}}}function x(e,t){var r=t.method,i=e.iterator[r];if(i===n)return t.delegate=null,"throw"===r&&e.iterator["return"]&&(t.method="return",t.arg=n,x(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var o=g(i,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,y;var a=o.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,y):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,y)}function D(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function F(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function W(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(D,this),this.reset(!0)}function R(e){if(e||""===e){var r=e[c];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function t(){for(;++i<e.length;)if(a.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=n,t.done=!0,t};return o.next=o}}throw new TypeError(t(e)+" is not iterable")}return S.prototype=T,s(E,"constructor",{value:T,configurable:!0}),s(T,"constructor",{value:S,configurable:!0}),S.displayName=f(T,d,"GeneratorFunction"),i.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===S||"GeneratorFunction"===(t.displayName||t.name))},i.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,T):(e.__proto__=T,f(e,d,"GeneratorFunction")),e.prototype=Object.create(E),e},i.awrap=function(e){return{__await:e}},A(k.prototype),f(k.prototype,l,(function(){return this})),i.AsyncIterator=k,i.async=function(e,t,r,n,o){void 0===o&&(o=Promise);var a=new k(h(e,t,r,n),o);return i.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},A(E),f(E,d,"Generator"),f(E,c,(function(){return this})),f(E,"toString",(function(){return"[object Generator]"})),i.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function i(){for(;r.length;){var e=r.pop();if(e in t)return i.value=e,i.done=!1,i}return i.done=!0,i}},i.values=R,W.prototype={constructor:W,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(F),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,i){return s.type="throw",s.arg=e,t.next=r,i&&(t.method="next",t.arg=n),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var u=a.call(o,"catchLoc"),c=a.call(o,"finallyLoc");if(u&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),F(r),y}},"catch":function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;F(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:R(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=n),y}},i}e.exports=r,e.exports.__esModule=!0,e.exports["default"]=e.exports}(s);var l=(0,s.exports)(),d=l;try{regeneratorRuntime=l}catch(tJ){"object"==typeof globalThis?globalThis.regeneratorRuntime=l:Function("r","regeneratorRuntime = r")(l)}var f,h,g=a(d);function p(e){var t=e?new Date(e):new Date,r="yyyy-MM-dd HH:mm:ss.SSSZ",n={"M+":t.getUTCMonth()+1,"d+":t.getUTCDate(),"H+":t.getUTCHours(),"h+":t.getUTCHours()%12||12,"m+":t.getUTCMinutes(),"s+":t.getUTCSeconds(),"q+":Math.floor((t.getUTCMonth()+3)/3),"S+":t.getUTCMilliseconds()};for(var i in/(y+)/.test(r)&&(r=r.replace(RegExp.$1,(t.getUTCFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+i+")").test(r)&&(r=r.replace(RegExp.$1,1==RegExp.$1.length?n[i]:("000"+n[i]).substr(("000"+n[i]).length-RegExp.$1.length)));return r}function m(e){return e===h}function _(e){return e!==h}function v(e){return null===e}f="object"===("undefined"==typeof window?"undefined":e(window))?window:{};var y={"[object Function]":"function","[object AsyncFunction]":"function","[object String]":"string","[object Object]":"object","[object Boolean]":"boolean","[object Number]":"number","[object Array]":"array"};function I(e){return v(e)||m(e)?String(e):y[{}.toString.call(e)]||"object"}function S(e){return"function"===I(e)}function T(e){return"string"===I(e)}function b(e){return"object"===I(e)}function C(e){return"boolean"===I(e)}function w(e){return"number"===I(e)}function E(e){return Array.isArray?Array.isArray(e):"array"===I(e)}function A(t){if(null==t)return[];if(E(t))return t;var r=e(t.length),n=e(t);if("number"!==r||t.alert||"string"===n||"function"===n&&(!("item"in t)||"number"!==r))return[t];for(var i=[],o=0,a=t.length;o<a;o++)i[o]=t[o];return i}var k,P,x={debug:!1,showConsoleError:!1};function D(){return k}function F(e){k=e}function W(e,t,r,n){if(x.debug&&P&&S(P.log)){var i=p((new Date).getTime()),o=A(arguments);P.log(["[",i,"] ",o].join(""))}}function R(e,t,r,n){if((x.debug||x.showConsoleError)&&P&&S(P.error)){var i=p((new Date).getTime()),o=A(arguments);P.error(["[",i,"] ",o].join(""))}}function N(e,t,r,n){if(x.debug&&P&&S(P.warn)){var i=p((new Date).getTime()),o=A(arguments);P.warn(["[",i,"] ",o].join(""))}}function O(e,t,r,n){if(x.debug&&P&&S(P.info)){var i=p((new Date).getTime()),o=A(arguments);P.info(["[",i,"] ",o].join(""))}}f&&_(f.console)&&(S((P=f.console).log)&&S(P.error)?k={log:W,error:R,info:O,warn:N,debug:function(e,t,r,n){if(x.debug&&P&&S(P.debug)){var i=p((new Date).getTime()),o=A(arguments);P.debug(["[",i,"] ",o].join(""))}}}:(P=!1,k=!1));var M={queue:[],doNextStarted:!1,timer:null,pushToDo:function(e,t,r){M.queue.push({obj:e,method:t,args:r})},doNext:function(){if(M.doNextStarted)if(0!=M.queue.length){var e=M.queue[0],t=e.obj,r=e.method,n=e.args;if(M.queue.splice(0,1),t&&S(t[r])){var i=!1;if(n.length>2){var o=n[n.length-2],a=n[n.length-1];S(o)&&S(a)&&(n[n.length-2]=function(){try{o.apply(t,arguments)}catch(VV){}M.timer=setTimeout(M.doNext,0)},n[n.length-1]=function(){try{a.apply(t,arguments)}catch(VV){}M.timer=setTimeout(M.doNext,0)},i=!0)}try{t[r].apply(t,n)}catch(s){}i||(M.timer=setTimeout(M.doNext,0))}else if(null===t&&S(r)){try{r.apply(null,n)}catch(u){}M.timer=setTimeout(M.doNext,0)}else W("not invoke a function: "+r),M.timer=setTimeout(M.doNext,0)}else M.stop();else M.stop()},start:function(){M.doNextStarted||(M.doNextStarted=!0,M.timer=setTimeout(M.doNext,0))},stop:function(){clearTimeout(M.timer),M.timer=null,M.doNextStarted=!1,M.queue=[]}},L=!0,B=!1;function U(e,t,r){if(e){var n,i,o,a=0,s=e.length;if(r=r||null,m(s)||S(e))for(o=Object.keys(e);a<o.length&&(n=o[a],t.call(r,e[n],n,e)!==B);a++);else for(i=e[0];a<s&&t.call(r,i,a,e)!==B;i=e[++a]);}return e}var V={fire:function(e){var t,r=this;r.exec=r.exec||{},e=e.toLowerCase(),t=Array.prototype.slice.call(arguments,1),U(r.exec[e]||[],(function(e){var n=e.f,i=e.c||r;try{n.apply(i,t)}catch(VV){W(VV)}}))},on:function(e,t,r){var n=this;n.exec=n.exec||{},e=e.toLowerCase(),n.exec[e]=n.exec[e]||[],n.exec[e].push({f:t,c:r})},off:function(e,t,r){var n=this.exec;if(n)if(e)if(e=e.toLowerCase(),t)for(var i=n[e]||[],o=i.length-1;o>=0;o--)i[o]===t&&i.splice(o,1);else n[e]=null;else this.exec=null}};function G(e){return null!=e&&e==e.window}function j(e){e&&/\S/.test(e)&&(f.execScript?f.execScript(e):function(e){f.eval.call(f,e)}(e))}var H,z="";var K,J,Q,q,Y=navigator,X=!0;if("userAgentData"in Y){var Z=Y.userAgentData,$=[];Z.platform&&""!=Z.platform&&("brands"in Z&&Array.isArray(Z.brands)&&Z.brands.length>0?$=Z.brands:"uaList"in Z&&Array.isArray(Z.uaList)&&Z.uaList.length>0&&($=Z.uaList),$.length>0&&(X=!1,J=Z.platform.toLowerCase(),K=function(e,t,r){var n,i,o,a,s,u,c,l,d,f=!1,h=!1,g=!1,p=e.mobile,m=!1,_=z,v=navigator.maxTouchPoints||0;for(i=t.length,n=0;n<i;n++){var y=t[n].brand.toLowerCase();if(y.indexOf("chrome")>=0){g=!0,_=t[n].version;break}if(y.indexOf("edge")>=0){f=!0,_=t[n].version;break}if(y.indexOf("opera")>=0){h=!0,_=t[n].version;break}}return g||f||h||(g=!0,_="100"),o=/windows/g.test(r),a=/mac/g.test(r),s=/linux/g.test(r),u=/android/g.test(r),c=/harmony/g.test(r),l=/(chromeos|chrome\sos)/g.test(r),d=/iphone/g.test(r),o||u||s||d||(m=/macintel/g.test(r)&&v>1),(u||c||d||m)&&(p=!0),{bUseUserAgent:!1,bWin:o,bMac:a,bLinux:s,bAndroid:u,bHarmonyOS:c,bChromeOS:l,bIE:!1,bEdge:f,bUC:!1,bPlaybook:!1,bBlackBerry:!1,bHuaWeiBrowser:!1,bOpera:h,bFirefox:!1,bChrome:g,bJSDom:!1,biPhone:d,biPad:m,bPad:u&&!e.mobile,bSafari:!1,bMobile:p,strBrowserVersion:_,bHTML5Edition:!0,IEVersion:0,IEMode:0}}(Z,$,J)))}X&&(Q||(Q=Y.userAgent.toLowerCase()),q||(q=Y.platform.toLowerCase()),K=function(e,t){var r,n=e.toLowerCase(),i=t.toLowerCase(),o=/harmonyos/g.test(n);"linux"==i&&n.indexOf("windows nt")>=0&&(i="harmonyos",o=!0);var a=!o&&/cros/.test(n),s=!o&&/android/g.test(n)||/android/g.test(i),u=/iphone/g.test(n)||/iphone/g.test(i),c=/macintosh/.test(n),l=navigator.maxTouchPoints||0,d=/ipad/g.test(n)||(c||"macintel"==i)&&l>1,f=/ucweb|ucbrowser/g.test(n),h=!f&&/nexus/g.test(n)&&/version\/[\d.]+.*safari\//g.test(n),g=/playbook/g.test(n),p=/hp-tablet/g.test(n),m=/blackberry|bb10/g.test(n),_=/symbian/g.test(n),v=/windows phone/g.test(n),y=/mobile/g.test(n),I=/arm64|aarch64/g.test(n),S=/mips64/g.test(n),T=/huaweibrowser/g.test(n),b=/jsdom/g.test(n),C=g||d||p,w=!C&&!a&&(u||h||m||_||v||s||o||y),E=!w&&!C&&!a,A=E&&/win32|win64|windows/.test(i),k=A&&/win64|x64/.test(n),P=E&&/mac68k|macppc|macintosh|macintel/.test(n),x=E&&/linux/.test(i),D="win64"==i||/wow64|x86_64|win64|x64/.test(n)||I||S,F=/wow64/g.test(n),W=B,R=/opera|opr/g.test(n),N=/360se/g.test(n),O=/maxthon/g.test(n),M=/tencenttraveler|qqbrowser/g.test(n),U=/the world/g.test(n),V=/metasr/g.test(n),G=/avant/g.test(n),j=/firefox|fxios/g.test(n),H=/gecko/g.test(n),K=!(j||T)&&/edge\/|edga\/|edgios\/|edg\//g.test(n),J=!(m||g||f||R||K||T||b)&&/chrome|crios/g.test(n),Q=!1,q=0,Y=0,X=z;if(A&&!K&&!j&&!J){var Z=n.indexOf("msie "),$=n.indexOf("trident"),ee=n.indexOf("rv:");Q=-1!=Z||-1!=$||-1!=ee}if(!(P||u||d||A||m||g||h)||f||R||K||Q||j||(r=n.match(/version\/([\d.]+).*safari\//))&&(m||g||h||(W=L,J=B),X=r[1]),K){var te=n.indexOf("edge/");te>-1?te+=5:(te=n.indexOf("edg/"))>-1?te+=4:(te=n.indexOf("edga/"))>-1?te+=5:(te=n.indexOf("edgios/"))>-1&&(te+=7),te>-1&&(r=(X=n.slice(te)).indexOf(" "))>-1&&(X=X.slice(0,r))}else if(j)if((r=n.indexOf("firefox/"))>-1){var re=(r=n.slice(r+8)).indexOf(" ");re>-1&&(r=r.slice(0,re)),X=r,(re=r.indexOf("."))>-1&&(r=X.slice(0,re))}else(u||d)&&(r=n.indexOf("fxios/"))>-1&&(X=r=(r=n.slice(r+6)).slice(0,r.indexOf(" ")));else if(Q){var ne=n.indexOf("msie "),ie=n.indexOf("trident"),oe=n.indexOf("rv:");-1!=ne?r=(r=n.slice(ne+5)).slice(0,r.indexOf(";")):-1!=oe?r=(r=(r=n.slice(oe+3)).slice(0,r.indexOf(";"))).slice(0,r.indexOf(")")):-1!=ie&&(r=(r=n.slice(ie+7)).slice(0,r.indexOf(";"))),X=r}else if(W)(r=X.indexOf("."))>-1&&(r=X.slice(0,r));else if(f)(r=n.indexOf("ucweb"))>-1?X=n.slice(r+5):(r=n.indexOf("ucbrowser/"))>-1&&(r=(X=n.slice(r+10)).indexOf(" "))>-1&&(X=X.slice(0,r));else if(R)(r=n.indexOf("version/"))>-1?X=n.slice(r+8):(r=n.indexOf("opr/"))>-1&&(X=n.slice(r+4));else if(_)(r=n.indexOf("browserng/"))>-1&&(X=n.slice(r+10));else if(v)(r=n.indexOf("iemobile/"))>-1&&(X=n.slice(r+9));else if(J){var ae=n.indexOf("chrome/");ae>-1?(r=(X=n.slice(ae+7)).indexOf(" "))>-1&&(X=X.slice(0,r)):(ae=n.indexOf("crios/"))>-1&&(r=(X=n.slice(ae+6)).indexOf(" "))>-1&&(X=X.slice(0,r)),(r=X.indexOf("."))>-1&&(r=X.slice(0,r))}else if(T){var se=n.indexOf("huaweibrowser");se>-1&&(r=(X=n.slice(se+14)).indexOf(" "))>-1&&(X=X.slice(0,r))}else if(b){var ue=n.indexOf("jsdom");ue>-1&&(r=(X=n.slice(ue+6)).indexOf(" "))>-1&&(X=X.slice(0,r))}if(K||Q){var ce=window.document;ce&&ce.documentMode?q=ce.documentMode:(q=5,ce.compatMode&&"CSS1Compat"==ce.compatMode&&(q=7)),Q&&(Y=parseInt(X))}return(P||x)&&(D=!0,P&&(r=n.match(/mac os x (\d+)(_|\.)(\d+)/))&&r.length>3&&(10==r[1]&&r[3]<14||r[1]<10)&&(D=!1)),A||P||x||I||S||(w=!0),{bUseUserAgent:!0,bWin:A,bMac:P,bLinux:x,bMobile:w,bPad:C,bChromeOS:a,bHarmonyOS:o,bArm64:I,bMips64:S,bEmbed:I||S,bAndroid:s,biPhone:u,biPad:d,bWin64:k,bWOW64:F,bOSx64:D,bIE:Q,bEdge:K,bChrome:J,bFirefox:j,bSafari:W,bOpera:R,bNexus:h,bUC:f,b360SE:N,bMaxthon:O,bTencentTraveler:M,bTheWorld:U,bMetaSr:V,bAvant:G,bHuaWeiBrowser:T,bJSDom:b,bGecko:H,bHTML5Edition:!0,strBrowserVersion:X,IEVersion:Y,IEMode:q}}(Q,q));var ee=null===(H=null==f?void 0:f.location)||void 0===H?void 0:H.protocol;function te(e){return K.bGecko&&"mousewheel"===e?"DOMMouseScroll":e}function re(e,t,r){var n=te(t);e&&e.addEventListener(n,r,!1)}function ne(e,t,r){var n=te(t);e&&e.removeEventListener(n,r,!1)}function ie(e){var t=e||f.event;t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.returnValue=!1,t.cancelBubble=!0}function oe(e,t){var r=f.document.createEvent("HTMLEvents");r.initEvent(e,L,L),t.dispatchEvent&&t.dispatchEvent(r)}ee||(ee="http:"),K.protocol=ee,K.bSSL="https:"===ee,K.bFileSystem="https:"!==ee&&"http:"!==ee;var ae,se,ue,ce,le=f.document,de=[],fe=de.push,he=de.slice,ge=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,pe=function(){se()};function me(e,t,r,n){var i,o,a,s=t&&t.ownerDocument,u=t?t.nodeType:9;if(r=r||[],"string"!=typeof e||!e||1!==u&&9!==u&&11!==u)return r;if(!n&&((t?t.ownerDocument||t:le)!==ue&&se(t),t=t||ue,11!==u&&(a=ge.exec(e))))if(i=a[1]){if(9===u){if(!(o=t.getElementById(i)))return r;if(o.id===i)return r.push(o),r}else if(s&&(o=s.getElementById(i))&&ce(t,o)&&o.id===i)return r.push(o),r}else{if(a[2])return fe.apply(r,t.getElementsByTagName(e)),r;if((i=a[3])&&t.getElementsByClassName)return fe.apply(r,t.getElementsByClassName(i)),r}return r}fe.apply(he.call(le.childNodes),le.childNodes),se=me.setDocument=function(e){var t,r=e?e.ownerDocument||e:le;return r!==ue&&9===r.nodeType&&r.documentElement?(le!==(ue=r)&&(t=ue.defaultView)&&t.top!==t&&(t.addEventListener?t.addEventListener("unload",pe,!1):t.attachEvent&&t.attachEvent("onunload",pe)),ce=function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},ue):ue},me.contains=function(e,t){return(e.ownerDocument||e)!==ue&&se(e),ce(e,t)},me.error=function(e){throw new Error("Syntax error: "+e)},ae=me.getText=function(e){var t,r="",n=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)r+=ae(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[n++];)r+=ae(t);return r},se();var _e={encodeChars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",decodeChars:[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1]},ve={UTF16ToUTF8:function(e){for(var t,r,n=[],i=e.length,o=0;o<i;o++){var a=e.charCodeAt(o);if(a>0&&a<=127)n.push(e.charAt(o));else if(a>=128&&a<=2047)t=192|a>>6&31,r=128|63&a,n.push(String.fromCharCode(t),String.fromCharCode(r));else if(a>=2048&&a<=65535){t=224|a>>12&15,r=128|a>>6&63;var s=128|63&a;n.push(String.fromCharCode(t),String.fromCharCode(r),String.fromCharCode(s))}}return n.join("")},UTF8ToUTF16:function(e){var t,r,n,i,o=[],a=e.length;for(t=0;t<a;t++)0==((r=e.charCodeAt(t))>>7&255)?o.push(e.charAt(t)):6==(r>>5&255)?(i=(31&r)<<6|63&(n=e.charCodeAt(++t)),o.push(String.fromCharCode(i))):14==(r>>4&255)&&(i=(255&(r<<4|(n=e.charCodeAt(++t))>>2&15))<<8|((3&n)<<6|63&e.charCodeAt(++t)),o.push(String.fromCharCode(i)));return o.join("")},encode:function(e){for(var t,r,n,i=this.UTF16ToUTF8(e),o=[],a=0,s=i.length;a<s;){if(t=255&i.charCodeAt(a++),a==s){o.push(_e.encodeChars.charAt(t>>2)),o.push(_e.encodeChars.charAt((3&t)<<4)),o.push("==");break}if(r=i.charCodeAt(a++),a==s){o.push(_e.encodeChars.charAt(t>>2)),o.push(_e.encodeChars.charAt((3&t)<<4|(240&r)>>4)),o.push(_e.encodeChars.charAt((15&r)<<2)),o.push("=");break}n=i.charCodeAt(a++),o.push(_e.encodeChars.charAt(t>>2)),o.push(_e.encodeChars.charAt((3&t)<<4|(240&r)>>4)),o.push(_e.encodeChars.charAt((15&r)<<2|(192&n)>>6)),o.push(_e.encodeChars.charAt(63&n))}return o.join("")},encodeArray:function(e){for(var t,r,n,i=[],o=0,a=e.length;o<a;){if(t=255&e[o++],o==a){i.push(_e.encodeChars.charAt(t>>2)),i.push(_e.encodeChars.charAt((3&t)<<4)),i.push("==");break}if(r=255&e[o++],o==a){i.push(_e.encodeChars.charAt(t>>2)),i.push(_e.encodeChars.charAt((3&t)<<4|(240&r)>>4)),i.push(_e.encodeChars.charAt((15&r)<<2)),i.push("=");break}n=255&e[o++],i.push(_e.encodeChars.charAt(t>>2)),i.push(_e.encodeChars.charAt((3&t)<<4|(240&r)>>4)),i.push(_e.encodeChars.charAt((15&r)<<2|(192&n)>>6)),i.push(_e.encodeChars.charAt(63&n))}return i.join("")},decode:function(e,t){for(var r,n,i,o,a=this,s=[],u=0,c=e.length;u<c;){do{r=_e.decodeChars[255&e.charCodeAt(u++)]}while(u<c&&-1==r);if(-1==r)break;do{n=_e.decodeChars[255&e.charCodeAt(u++)]}while(u<c&&-1==n);if(-1==n)break;t?s.push(r<<2|(48&n)>>4):s.push(String.fromCharCode(r<<2|(48&n)>>4));do{if(61==(i=255&e.charCodeAt(u++)))return t?s:a.UTF8ToUTF16(s.join(""));i=_e.decodeChars[i]}while(u<c&&-1==i);if(-1==i)break;t?s.push((15&n)<<4|(60&i)>>2):s.push(String.fromCharCode((15&n)<<4|(60&i)>>2));do{if(61==(o=255&e.charCodeAt(u++)))return t?s:a.UTF8ToUTF16(s.join(""));o=_e.decodeChars[o]}while(u<c&&-1==o);if(-1==o)break;t?s.push((3&i)<<6|o):s.push(String.fromCharCode((3&i)<<6|o))}return t?s:a.UTF8ToUTF16(s.join(""))}},ye={fromUTF16:function(e){for(var t,r=[],n=0,i=e.length;n<i;)(t=e.charCodeAt(n))>=1&&t<=127?r.push(e.charAt(n)):t>2047?(r.push(String.fromCharCode(224|t>>12&15)),r.push(String.fromCharCode(128|t>>6&63)),r.push(String.fromCharCode(128|t>>0&63))):(r.push(String.fromCharCode(192|t>>6&31)),r.push(String.fromCharCode(128|t>>0&63))),n++;return r.join("")},toUTF16:function(e){for(var t,r,n,i=[],o=0,a=e.length;o<a;)switch((t=e.charCodeAt(o++))>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:i.push(e.charAt(o-1));break;case 12:case 13:r=e.charCodeAt(o++),i.push(String.fromCharCode((31&t)<<6|63&r));break;case 14:r=e.charCodeAt(o++),n=e.charCodeAt(o++),i.push(String.fromCharCode((15&t)<<12|(63&r)<<6|(63&n)<<0))}return i.join("")}};function Ie(t){if(null==t||"object"!=e(t))return t;var r,n,i;if(t instanceof Date)return(r=new Date).setTime(t.getTime()),r;if(t instanceof Array){for(r=[],i=t.length,n=0;n<i;n++)r[n]=Ie(t[n]);return r}if(t instanceof Object){for(n in r={},t)t.hasOwnProperty(n)&&(r[n]=Ie(t[n]));return r}return 0}function Se(e){return Math.random().toString(16).substring(2,2+e)}function Te(e){var t=[Se(8),"-",Se(4),"-",Se(4),"-",Se(4),"-",Se(8)];return e&&t.unshift(e),t.join("")}var be=Date.now||function(){return+new Date},Ce=function(){return""+be()};function we(){for(var e,t=be()%1e4,r=[],n=0;n<5;n++)e=Math.floor(10*Math.random()),0!=n||0!=e?r.push(e):n=-1;return t<10?r.push("000"):t<100?r.push("00"):t<1e3&&r.push("0"),r.push(t),r.join("")}function Ee(e,t){var r;for(r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}function Ae(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(VV){o(VV)}}function s(e){try{u(n["throw"](e))}catch(VV){o(VV)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))}var ke=!1;"wakeLock"in navigator&&(ke=!0);var Pe=null;function xe(){ke&&(null==Pe?function(){Ae(this,void 0,void 0,g.mark((function e(){return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.wakeLock.request("screen");case 3:Pe=e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e["catch"](0),Pe=null;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))}():Pe.release().then((function(){Pe=null})))}function De(){return Pe}var Fe=Array.prototype;function We(e,t,r){return Fe.filter.call(e,t,r||this)}function Re(e,t){return Fe.indexOf.call(t,e)}function Ne(e){var t,r,n=[],i=e.length;for(t=0;t<i;t++){for(r=t+1;r<i;r++)e[t]===e[r]&&(r=++t);n.push(e[t])}return n}var Oe=/^(\/?)([\s\S]+\/(?!$)|\/)?((?:\.{1,2}$|[\s\S]+?)?(\.[^.\/]*)?)$/;function Me(e,t){var r,n=[];for(r=0;r<e.length;r++){var i=e[r];i&&"."!==i&&(".."===i?n.length&&".."!==n[n.length-1]?n.pop():t&&n.push(".."):n.push(i))}return n}function Le(e){var t="/"===e.charAt(0),r="/"===e.slice(-1);return(e=Me(We(e.split("/"),(function(e){return!!e})),!t).join("/"))||t||(e="."),e&&r&&(e+="/"),(t?"/":"")+e}var Be=function(){function e(){t(this,e)}return i(e,[{key:"resolve",value:function(){var e,t,r="",n=arguments,i=!1;for(e=n.length-1;e>=0&&!i;e--)T(t=n[e])&&t&&(r=t+"/"+r,i="/"===t.charAt(0));return(i?"/":"")+Me(We(r.split("/"),(function(e){return!!e})),!i).join("/")||"."}},{key:"join",value:function(){return Le(We(A(arguments),(function(e){return e&&T(e)})).join("/"))}},{key:"relative",value:function(e,t){e=Le(e),t=Le(t);var r,n,i=We(e.split("/"),(function(e){return!!e})),o=[],a=We(t.split("/"),(function(e){return!!e})),s=Math.min(i.length,a.length);for(r=0;r<s&&i[r]===a[r];r++);for(n=r;r<i.length;)o.push(".."),r++;return(o=o.concat(a.slice(n))).join("/")}},{key:"basename",value:function(e,t){var r;return r=(e.match(Oe)||[])[3]||"",t&&r&&r.slice(-1*t.length)===t&&(r=r.slice(0,-1*t.length)),r}},{key:"dirname",value:function(e){var t=e.match(Oe)||[],r=t[1]||"",n=t[2]||"";return r||n?(n&&(n=n.substring(0,n.length-1)),r+n):"."}},{key:"extname",value:function(e){return(e.match(Oe)||[])[4]||""}}]),e}(),Ue={}.hasOwnProperty;function Ve(e){if(!e||"object"!==I(e)||e.nodeType||e.window==e)return B;var t,r;try{if((r=e.constructor)&&!Ue(e,"constructor")&&!Ue(r.prototype,"isPrototypeOf"))return B}catch(VV){return B}for(t in e);return m(t)||Ue(e,t)}var Ge="object"===("undefined"==typeof HTMLElement?"undefined":e(HTMLElement));function je(t){return Ge?t instanceof HTMLElement:t&&"object"===e(t)&&(1===t.nodeType||9===t.nodeType)&&"string"==typeof t.nodeName}function He(e){var t=e;if(je(e))for(;!t&&t!=document.body;)t=t.parentNode;else t=0;return!!t}function ze(e,t){return 0===e.lastIndexOf(t,0)}function Ke(e,t){var r=e.length-t.length;return r>=0&&e.indexOf(t,r)===r}function Je(e){return null==e?z:String.prototype.trim.call(e)}function Qe(e){var t;if(e)for(t in e)if(!m(t))return!1;return!0}function qe(e){return T(e)?e.replace(/[^\x20-\x7E]/g,""):e}function Ye(e,t,r){return e.replace(new RegExp(t,"gi"),r)}function Xe(e){return e.charAt(0).toUpperCase()+e.substr(1)}var Ze="none",$e={getOffset:function(e,t,r){var n,i;e=e||f.event;for(var o,a,s=r||e.target,u=0,c=0,l=0,d=0,h=!1,g=f.document;s&&!isNaN(s.offsetLeft)&&!isNaN(s.offsetTop);)a=s.scrollLeft,o=s.scrollTop,"BODY"===s.tagName?h?(a=0,o=0):(a|=null===(n=g.documentElement)||void 0===n?void 0:n.scrollLeft,o|=null===(i=g.documentElement)||void 0===i?void 0:i.scrollTop):"fixed"===s.style.position&&(h=!0),u+=s.offsetLeft-a,c+=s.offsetTop-o,s=s.offsetParent;return t&&(l=t.Left,d=t.Top),{x:u=e.clientX-u-l,y:c=e.clientY-c-d}},getElDimensions:function(e,t){var r,n;return e?(r=e.style.display,e.style.display="",n=t?{offsetTop:e.offsetTop,offsetLeft:e.offsetLeft,offsetWidth:e.offsetWidth,offsetHeight:e.offsetHeight}:{clientTop:e.clientTop,clientLeft:e.clientLeft,clientWidth:e.clientWidth?e.clientWidth:parseInt(e.style.width)?parseInt(e.style.width):0,clientHeight:e.clientHeight?e.clientHeight:parseInt(e.style.height)?parseInt(e.style.height):0},e.style.display=r,n):{offsetTop:0,offsetLeft:0,offsetWidth:0,offsetHeight:0}}};function et(e){return document.getElementById(e)}function tt(e){var t=T(e)?et(e):e;t&&(t.length>0&&(t=t[0]),t.style.display=Ze)}function rt(e){var t=T(e)?et(e):e;t&&(t.length>0&&(t=t[0]),t.style.display=z)}function nt(e){var t=T(e)?et(e):e;t&&(t.length>0&&(t=t[0]),t.style.display===Ze?t.style.display=z:t.style.display=Ze)}function it(e){if(e)for(;e.firstChild;)e.removeChild(e.firstChild)}function ot(e){return encodeURIComponent(String(e))}function at(e){return decodeURIComponent(e.replace(/\+/g," "))}var st=!0,ut=document,ct=ut&&ut.documentElement,lt=ut.getElementsByTagName("head")[0]||ct,dt=ut.createElement("script").readyState?function(e,t){var r=e.onreadystatechange;e.onreadystatechange=function(){var n=e.readyState;if("loaded"===n||"complete"===n){e.onreadystatechange=null,r&&r();t.call(this,{type:"load",path:[e]})}else"loading"===n||t.call(this,{type:"error",path:[e]})}}:function(e,t){e.addEventListener("load",t,B),e.addEventListener("error",t,B)};function ft(e,t,r){return ht(e,t,!1,r)}function ht(e,t,r,n){var i,o,a=n;if(S(a)||(a=function(){}),T(e)&&e!=z)return i=ut.createElement("script"),o=["",e].join(z),i.src=o,t&&(i.async=st),i.charset="utf-8",dt(i,a),r?lt.appendChild(i):lt.insertBefore(i,lt.firstChild),i;a()}function gt(e,t,r){return pt(e,t,!1,r)}function pt(e,t,r,n){var i=n;if(S(i)||(i=function(){}),K.bJSDom)i("ok");else if(E(e)){var o=e.length,a=function(e){e&&"load"==e.type?o--:(e&&"error"==e.type&&R(["Failed to load resource: ",e.target.src,"."].join("")),i()),o<=0&&i("ok")};o<=0?i("ok"):U(e,(function(e){ht(e,t,r,a)}))}else i()}function mt(e,t){return _t(e,!1,t)}function _t(e,t,r){var n,i=r;if(S(i)||(i=!1),T(e)&&e!=z){if(!K.bJSDom)return(n=ut.createElement("link")).href=e,n.rel="stylesheet",n.async=st,i&&dt(n,i),t?lt.appendChild(n):lt.insertBefore(n,lt.firstChild),n;i&&i()}else i&&i()}function vt(e,t){return yt(e,!1,t)}function yt(e,t,r){if(K.bJSDom)r&&r("ok");else if(E(e)){var n=e.length,i=function(e){e&&"load"==e.type&&n--,e&&"load"!=e.type&&(e&&"error"==e.type&&R(["Failed to load resource: ",e.target.href,"."].join("")),r()),n<=0&&r("ok")};U(e,(function(e){_t(e,t,i)}))}else r&&r()}function It(e){var t,r;if(!K.bJSDom){var n=document;if(n&&T(r=e.body)&&r!=z){(t=n.createElement("script")).charset="utf-8",K.bIE?t.text=r:t.appendChild(n.createTextNode(r)),e.language?t.language=e.language:t.language="javascript",e.type?t.type=e.type:t.type="text/javascript";var i=n&&n.documentElement,o=n.getElementsByTagName("head")[0]||i;o.insertBefore(t,o.firstChild)}}}function St(e){It({body:e})}function Tt(e){It({body:e,language:"vbscript",type:"text/vbscript"})}var bt,Ct,wt=function(){function e(){t(this,e),this.nil=undefined,this.bNode=!1,this.noop=function(){},this.mix=Ee,this.clone=Ie,this.keys=Object.keys,this.now=Ce,this.getFormatedNow=p,this.getRandom=we,this.guid=Te,this.get=et,this.show=rt,this.hide=tt,this.toggle=nt,this.empty=it,this.stringify=f.JSON.stringify,this.parse=f.JSON.parse,this.isDef=_,this.isUndef=m,this.isUndefined=m,this.isNull=v,this.isNaN=isNaN,this.isFunction=S,this.isString=T,this.isObject=b,this.isBoolean=C,this.isNumber=w,this.isArray=E,this.type=I,this.isPlainObject=Ve,this.isDOM=je,this.isDOMInBody=He,this.each=U,this.getLogger=D,this.setLogger=F,this.log=W,this.error=R,this.warn=N,this.info=O,this.filter=We,this.indexOf=Re,this.uniq=Ne,this.startsWith=ze,this.endsWith=Ke,this.replaceAll=Ye,this.upperCaseFirst=Xe,this.removeNonPrintableChar=qe,this.trim=Je,this.makeArray=A,this.isEmptyObject=Qe,this.Path=new Be,this.DOM=$e,this.isWindow=G,this.globalEval=j,this.obj={customEvent:V},this.addEventListener=re,this.removeEventListener=ne,this.stopPropagation=ie,this.fireEvent=oe,this.base64=ve,this.utf8=ye,this.btoa=function(e){return f.btoa(e)},this.atob=function(e){return f.atob(e)},this.asyncQueue=M,this.sizzle=me,this.toggleWakeLock=xe,this.getWakeLock=De,this.urlEncode=ot,this.urlDecode=at,this.scriptOnload=dt,this.addAllCss=yt,this.getAllCss=vt,this.addCss=_t,this.getCss=mt,this.addScripts=pt,this.getScripts=gt,this.addScript=ht,this.getScript=ft,this.addJS=St,this.addVBS=Tt}return i(e,[{key:"debug",get:function(){return x.debug},set:function(e){x.debug=e}},{key:"showConsoleError",get:function(){return x.debug},set:function(e){x.showConsoleError=e}}]),e}(),Et=new wt,At=20230515,kt=!!("object"==("undefined"==typeof global?"undefined":e(global))&&global.process&&global.process.release&&global.process.release.name&&"undefined"==typeof HTMLCanvasElement),Pt=kt?global:self||{},xt=Pt.Dynamsoft;function Dt(e){return Math.floor(e)}function Ft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}xt?xt.Lib||(xt.Lib={}):(xt={Lib:{},DWT:{}},Pt&&(Pt.Dynamsoft=xt)),bt=Et.mix(xt.Lib,Et),(Ct=xt).DWT||(Ct.DWT={}),Ct.DWT.LTS||(Ct.DWT.LTS={}),Ct.Lib.UI||(Ct.Lib.UI={}),Ct.Lib.html5||(Ct.Lib.html5={});var Wt={exports:{}},Rt=function(e){return e&&e.Math===Math&&e},Nt=Rt("object"==typeof globalThis&&globalThis)||Rt("object"==typeof window&&window)||Rt("object"==typeof self&&self)||Rt("object"==typeof o&&o)||function(){return this}()||o||Function("return this")(),Ot=function(e){try{return!!e()}catch(pC){return!0}},Mt=!Ot((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})),Lt=Mt,Bt=Function.prototype,Ut=Bt.apply,Vt=Bt.call,Gt="object"==typeof Reflect&&Reflect.apply||(Lt?Vt.bind(Ut):function(){return Vt.apply(Ut,arguments)}),jt=Mt,Ht=Function.prototype,zt=Ht.call,Kt=jt&&Ht.bind.bind(zt,zt),Jt=jt?Kt:function(e){return function(){return zt.apply(e,arguments)}},Qt=Jt,qt=Qt({}.toString),Yt=Qt("".slice),Xt=function(e){return Yt(qt(e),8,-1)},Zt=Xt,$t=Jt,er=function(e){if("Function"===Zt(e))return $t(e)},tr="object"==typeof document&&document.all,rr={all:tr,IS_HTMLDDA:void 0===tr&&tr!==undefined},nr=rr.all,ir=rr.IS_HTMLDDA?function(e){return"function"==typeof e||e===nr}:function(e){return"function"==typeof e},or={},ar=!Ot((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})),sr=Mt,ur=Function.prototype.call,cr=sr?ur.bind(ur):function(){return ur.apply(ur,arguments)},lr={},dr={}.propertyIsEnumerable,fr=Object.getOwnPropertyDescriptor,hr=fr&&!dr.call({1:2},1);lr.f=hr?function(e){var t=fr(this,e);return!!t&&t.enumerable}:dr;var gr,pr,mr=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},_r=Ot,vr=Xt,yr=Object,Ir=Jt("".split),Sr=_r((function(){return!yr("z").propertyIsEnumerable(0)}))?function(e){return"String"===vr(e)?Ir(e,""):yr(e)}:yr,Tr=function(e){return null===e||e===undefined},br=Tr,Cr=TypeError,wr=function(e){if(br(e))throw Cr("Can't call method on "+e);return e},Er=Sr,Ar=wr,kr=function(e){return Er(Ar(e))},Pr=ir,xr=rr.all,Dr=rr.IS_HTMLDDA?function(e){return"object"==typeof e?null!==e:Pr(e)||e===xr}:function(e){return"object"==typeof e?null!==e:Pr(e)},Fr={},Wr=Fr,Rr=Nt,Nr=ir,Or=function(e){return Nr(e)?e:undefined},Mr=function(e,t){return arguments.length<2?Or(Wr[e])||Or(Rr[e]):Wr[e]&&Wr[e][t]||Rr[e]&&Rr[e][t]},Lr=Jt({}.isPrototypeOf),Br="undefined"!=typeof navigator&&String(navigator.userAgent)||"",Ur=Nt,Vr=Br,Gr=Ur.process,jr=Ur.Deno,Hr=Gr&&Gr.versions||jr&&jr.version,zr=Hr&&Hr.v8;zr&&(pr=(gr=zr.split("."))[0]>0&&gr[0]<4?1:+(gr[0]+gr[1])),!pr&&Vr&&(!(gr=Vr.match(/Edge\/(\d+)/))||gr[1]>=74)&&(gr=Vr.match(/Chrome\/(\d+)/))&&(pr=+gr[1]);var Kr=pr,Jr=Kr,Qr=Ot,qr=Nt.String,Yr=!!Object.getOwnPropertySymbols&&!Qr((function(){var e=Symbol("symbol detection");return!qr(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&Jr&&Jr<41})),Xr=Yr&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Zr=Mr,$r=ir,en=Lr,tn=Object,rn=Xr?function(e){return"symbol"==typeof e}:function(e){var t=Zr("Symbol");return $r(t)&&en(t.prototype,tn(e))},nn=String,on=function(e){try{return nn(e)}catch(pC){return"Object"}},an=ir,sn=on,un=TypeError,cn=function(e){if(an(e))return e;throw un(sn(e)+" is not a function")},ln=cn,dn=Tr,fn=function(e,t){var r=e[t];return dn(r)?undefined:ln(r)},hn=cr,gn=ir,pn=Dr,mn=TypeError,_n={exports:{}},vn=Nt,yn=Object.defineProperty,In=function(e,t){try{yn(vn,e,{value:t,configurable:!0,writable:!0})}catch(pC){vn[e]=t}return t},Sn="__core-js_shared__",Tn=Nt[Sn]||In(Sn,{}),bn=Tn;(_n.exports=function(e,t){return bn[e]||(bn[e]=t!==undefined?t:{})})("versions",[]).push({version:"3.32.2",mode:"pure",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.32.2/LICENSE",source:"https://github.com/zloirock/core-js"});var Cn=_n.exports,wn=wr,En=Object,An=function(e){return En(wn(e))},kn=An,Pn=Jt({}.hasOwnProperty),xn=Object.hasOwn||function(e,t){return Pn(kn(e),t)},Dn=Jt,Fn=0,Wn=Math.random(),Rn=Dn(1..toString),Nn=function(e){return"Symbol("+(e===undefined?"":e)+")_"+Rn(++Fn+Wn,36)},On=Cn,Mn=xn,Ln=Nn,Bn=Yr,Un=Xr,Vn=Nt.Symbol,Gn=On("wks"),jn=Un?Vn["for"]||Vn:Vn&&Vn.withoutSetter||Ln,Hn=function(e){return Mn(Gn,e)||(Gn[e]=Bn&&Mn(Vn,e)?Vn[e]:jn("Symbol."+e)),Gn[e]},zn=cr,Kn=Dr,Jn=rn,Qn=fn,qn=function(e,t){var r,n;if("string"===t&&gn(r=e.toString)&&!pn(n=hn(r,e)))return n;if(gn(r=e.valueOf)&&!pn(n=hn(r,e)))return n;if("string"!==t&&gn(r=e.toString)&&!pn(n=hn(r,e)))return n;throw mn("Can't convert object to primitive value")},Yn=TypeError,Xn=Hn("toPrimitive"),Zn=function(e,t){if(!Kn(e)||Jn(e))return e;var r,n=Qn(e,Xn);if(n){if(t===undefined&&(t="default"),r=zn(n,e,t),!Kn(r)||Jn(r))return r;throw Yn("Can't convert object to primitive value")}return t===undefined&&(t="number"),qn(e,t)},$n=rn,ei=function(e){var t=Zn(e,"string");return $n(t)?t:t+""},ti=Dr,ri=Nt.document,ni=ti(ri)&&ti(ri.createElement),ii=function(e){return ni?ri.createElement(e):{}},oi=ii,ai=!ar&&!Ot((function(){return 7!==Object.defineProperty(oi("div"),"a",{get:function(){return 7}}).a})),si=ar,ui=cr,ci=lr,li=mr,di=kr,fi=ei,hi=xn,gi=ai,pi=Object.getOwnPropertyDescriptor;or.f=si?pi:function(e,t){if(e=di(e),t=fi(t),gi)try{return pi(e,t)}catch(pC){}if(hi(e,t))return li(!ui(ci.f,e,t),e[t])};var mi=Ot,_i=ir,vi=/#|\.prototype\./,yi=function(e,t){var r=Si[Ii(e)];return r===bi||r!==Ti&&(_i(t)?mi(t):!!t)},Ii=yi.normalize=function(e){return String(e).replace(vi,".").toLowerCase()},Si=yi.data={},Ti=yi.NATIVE="N",bi=yi.POLYFILL="P",Ci=yi,wi=cn,Ei=Mt,Ai=er(er.bind),ki=function(e,t){return wi(e),t===undefined?e:Ei?Ai(e,t):function(){return e.apply(t,arguments)}},Pi={},xi=ar&&Ot((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),Di=Dr,Fi=String,Wi=TypeError,Ri=function(e){if(Di(e))return e;throw Wi(Fi(e)+" is not an object")},Ni=ar,Oi=ai,Mi=xi,Li=Ri,Bi=ei,Ui=TypeError,Vi=Object.defineProperty,Gi=Object.getOwnPropertyDescriptor,ji="enumerable",Hi="configurable",zi="writable";Pi.f=Ni?Mi?function(e,t,r){if(Li(e),t=Bi(t),Li(r),"function"==typeof e&&"prototype"===t&&"value"in r&&zi in r&&!r[zi]){var n=Gi(e,t);n&&n[zi]&&(e[t]=r.value,r={configurable:Hi in r?r[Hi]:n[Hi],enumerable:ji in r?r[ji]:n[ji],writable:!1})}return Vi(e,t,r)}:Vi:function(e,t,r){if(Li(e),t=Bi(t),Li(r),Oi)try{return Vi(e,t,r)}catch(pC){}if("get"in r||"set"in r)throw Ui("Accessors not supported");return"value"in r&&(e[t]=r.value),e};var Ki=Pi,Ji=mr,Qi=ar?function(e,t,r){return Ki.f(e,t,Ji(1,r))}:function(e,t,r){return e[t]=r,e},qi=Nt,Yi=Gt,Xi=er,Zi=ir,$i=or.f,eo=Ci,to=Fr,ro=ki,no=Qi,io=xn,oo=function(e){var t=function(r,n,i){if(this instanceof t){switch(arguments.length){case 0:return new e;case 1:return new e(r);case 2:return new e(r,n)}return new e(r,n,i)}return Yi(e,this,arguments)};return t.prototype=e.prototype,t},ao=function(e,t){var r,n,i,o,a,s,u,c,l,d=e.target,f=e.global,h=e.stat,g=e.proto,p=f?qi:h?qi[d]:(qi[d]||{}).prototype,m=f?to:to[d]||no(to,d,{})[d],_=m.prototype;for(o in t)n=!(r=eo(f?o:d+(h?".":"#")+o,e.forced))&&p&&io(p,o),s=m[o],n&&(u=e.dontCallGetSet?(l=$i(p,o))&&l.value:p[o]),a=n&&u?u:t[o],n&&typeof s==typeof a||(c=e.bind&&n?ro(a,qi):e.wrap&&n?oo(a):g&&Zi(a)?Xi(a):a,(e.sham||a&&a.sham||s&&s.sham)&&no(c,"sham",!0),no(m,o,c),g&&(io(to,i=d+"Prototype")||no(to,i,{}),no(to[i],o,a),e.real&&_&&(r||!_[o])&&no(_,o,a)))},so=ao,uo=ar,co=Pi.f;so({target:"Object",stat:!0,forced:Object.defineProperty!==co,sham:!uo},{defineProperty:co});var lo=Fr.Object,fo=Wt.exports=function(e,t,r){return lo.defineProperty(e,t,r)};lo.defineProperty.sham&&(fo.sham=!0);var ho=Wt.exports,go=ho,po=a(go),mo=Xt,_o=Array.isArray||function(e){return"Array"===mo(e)},vo=Math.ceil,yo=Math.floor,Io=Math.trunc||function(e){var t=+e;return(t>0?yo:vo)(t)},So=function(e){var t=+e;return t!=t||0===t?0:Io(t)},To=So,bo=Math.min,Co=function(e){return e>0?bo(To(e),9007199254740991):0},wo=Co,Eo=function(e){return wo(e.length)},Ao=TypeError,ko=function(e){if(e>9007199254740991)throw Ao("Maximum allowed index exceeded");return e},Po=ei,xo=Pi,Do=mr,Fo=function(e,t,r){var n=Po(t);n in e?xo.f(e,n,Do(0,r)):e[n]=r},Wo={};Wo[Hn("toStringTag")]="z";var Ro="[object z]"===String(Wo),No=Ro,Oo=ir,Mo=Xt,Lo=Hn("toStringTag"),Bo=Object,Uo="Arguments"===Mo(function(){return arguments}()),Vo=No?Mo:function(e){var t,r,n;return e===undefined?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(pC){}}(t=Bo(e),Lo))?r:Uo?Mo(t):"Object"===(n=Mo(t))&&Oo(t.callee)?"Arguments":n},Go=ir,jo=Tn,Ho=Jt(Function.toString);Go(jo.inspectSource)||(jo.inspectSource=function(e){return Ho(e)});var zo=jo.inspectSource,Ko=Jt,Jo=Ot,Qo=ir,qo=Vo,Yo=zo,Xo=function(){},Zo=[],$o=Mr("Reflect","construct"),ea=/^\s*(?:class|function)\b/,ta=Ko(ea.exec),ra=!ea.exec(Xo),na=function(e){if(!Qo(e))return!1;try{return $o(Xo,Zo,e),!0}catch(pC){return!1}},ia=function(e){if(!Qo(e))return!1;switch(qo(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return ra||!!ta(ea,Yo(e))}catch(pC){return!0}};ia.sham=!0;var oa=!$o||Jo((function(){var e;return na(na.call)||!na(Object)||!na((function(){e=!0}))||e}))?ia:na,aa=_o,sa=oa,ua=Dr,ca=Hn("species"),la=Array,da=function(e){var t;return aa(e)&&(t=e.constructor,(sa(t)&&(t===la||aa(t.prototype))||ua(t)&&null===(t=t[ca]))&&(t=undefined)),t===undefined?la:t},fa=function(e,t){return new(da(e))(0===t?0:t)},ha=Ot,ga=Kr,pa=Hn("species"),ma=function(e){return ga>=51||!ha((function(){var t=[];return(t.constructor={})[pa]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},_a=ao,va=Ot,ya=_o,Ia=Dr,Sa=An,Ta=Eo,ba=ko,Ca=Fo,wa=fa,Ea=ma,Aa=Kr,ka=Hn("isConcatSpreadable"),Pa=Aa>=51||!va((function(){var e=[];return e[ka]=!1,e.concat()[0]!==e})),xa=function(e){if(!Ia(e))return!1;var t=e[ka];return t!==undefined?!!t:ya(e)};_a({target:"Array",proto:!0,arity:1,forced:!Pa||!Ea("concat")},{concat:function(e){var t,r,n,i,o,a=Sa(this),s=wa(a,0),u=0;for(t=-1,n=arguments.length;t<n;t++)if(xa(o=-1===t?a:arguments[t]))for(i=Ta(o),ba(u+i),r=0;r<i;r++,u++)r in o&&Ca(s,u,o[r]);else ba(u+1),Ca(s,u++,o);return s.length=u,s}});var Da=Vo,Fa=String,Wa=function(e){if("Symbol"===Da(e))throw TypeError("Cannot convert a Symbol value to a string");return Fa(e)},Ra={},Na=So,Oa=Math.max,Ma=Math.min,La=function(e,t){var r=Na(e);return r<0?Oa(r+t,0):Ma(r,t)},Ba=kr,Ua=La,Va=Eo,Ga=function(e){return function(t,r,n){var i,o=Ba(t),a=Va(o),s=Ua(n,a);if(e&&r!=r){for(;a>s;)if((i=o[s++])!=i)return!0}else for(;a>s;s++)if((e||s in o)&&o[s]===r)return e||s||0;return!e&&-1}},ja={includes:Ga(!0),indexOf:Ga(!1)},Ha={},za=xn,Ka=kr,Ja=ja.indexOf,Qa=Ha,qa=Jt([].push),Ya=function(e,t){var r,n=Ka(e),i=0,o=[];for(r in n)!za(Qa,r)&&za(n,r)&&qa(o,r);for(;t.length>i;)za(n,r=t[i++])&&(~Ja(o,r)||qa(o,r));return o},Xa=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Za=Ya,$a=Xa,es=Object.keys||function(e){return Za(e,$a)},ts=ar,rs=xi,ns=Pi,is=Ri,os=kr,as=es;Ra.f=ts&&!rs?Object.defineProperties:function(e,t){is(e);for(var r,n=os(t),i=as(t),o=i.length,a=0;o>a;)ns.f(e,r=i[a++],n[r]);return e};var ss,us=Mr("document","documentElement"),cs=Nn,ls=Cn("keys"),ds=function(e){return ls[e]||(ls[e]=cs(e))},fs=Ri,hs=Ra,gs=Xa,ps=Ha,ms=us,_s=ii,vs="prototype",ys="script",Is=ds("IE_PROTO"),Ss=function(){},Ts=function(e){return"<"+ys+">"+e+"</"+ys+">"},bs=function(e){e.write(Ts("")),e.close();var t=e.parentWindow.Object;return e=null,t},Cs=function(){try{ss=new ActiveXObject("htmlfile")}catch(pC){}var e,t,r;Cs="undefined"!=typeof document?document.domain&&ss?bs(ss):(t=_s("iframe"),r="java"+ys+":",t.style.display="none",ms.appendChild(t),t.src=String(r),(e=t.contentWindow.document).open(),e.write(Ts("document.F=Object")),e.close(),e.F):bs(ss);for(var n=gs.length;n--;)delete Cs[vs][gs[n]];return Cs()};ps[Is]=!0;var ws=Object.create||function(e,t){var r;return null!==e?(Ss[vs]=fs(e),r=new Ss,Ss[vs]=null,r[Is]=e):r=Cs(),t===undefined?r:hs.f(r,t)},Es={},As=Ya,ks=Xa.concat("length","prototype");Es.f=Object.getOwnPropertyNames||function(e){return As(e,ks)};var Ps={},xs=La,Ds=Eo,Fs=Fo,Ws=Array,Rs=Math.max,Ns=function(e,t,r){for(var n=Ds(e),i=xs(t,n),o=xs(r===undefined?n:r,n),a=Ws(Rs(o-i,0)),s=0;i<o;i++,s++)Fs(a,s,e[i]);return a.length=s,a},Os=Xt,Ms=kr,Ls=Es.f,Bs=Ns,Us="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];Ps.f=function(e){return Us&&"Window"===Os(e)?function(e){try{return Ls(e)}catch(pC){return Bs(Us)}}(e):Ls(Ms(e))};var Vs={};Vs.f=Object.getOwnPropertySymbols;var Gs=Qi,js=function(e,t,r,n){return n&&n.enumerable?e[t]=r:Gs(e,t,r),e},Hs=Pi,zs=function(e,t,r){return Hs.f(e,t,r)},Ks={},Js=Hn;Ks.f=Js;var Qs,qs,Ys,Xs=Fr,Zs=xn,$s=Ks,eu=Pi.f,tu=function(e){var t=Xs.Symbol||(Xs.Symbol={});Zs(t,e)||eu(t,e,{value:$s.f(e)})},ru=cr,nu=Mr,iu=Hn,ou=js,au=function(){var e=nu("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=iu("toPrimitive");t&&!t[n]&&ou(t,n,(function(e){return ru(r,this)}),{arity:1})},su=Vo,uu=Ro?{}.toString:function(){return"[object "+su(this)+"]"},cu=Ro,lu=Pi.f,du=Qi,fu=xn,hu=uu,gu=Hn("toStringTag"),pu=function(e,t,r,n){if(e){var i=r?e:e.prototype;fu(i,gu)||lu(i,gu,{configurable:!0,value:t}),n&&!cu&&du(i,"toString",hu)}},mu=ir,_u=Nt.WeakMap,vu=mu(_u)&&/native code/.test(String(_u)),yu=Nt,Iu=Dr,Su=Qi,Tu=xn,bu=Tn,Cu=ds,wu=Ha,Eu="Object already initialized",Au=yu.TypeError,ku=yu.WeakMap;if(vu||bu.state){var Pu=bu.state||(bu.state=new ku);Pu.get=Pu.get,Pu.has=Pu.has,Pu.set=Pu.set,Qs=function(e,t){if(Pu.has(e))throw Au(Eu);return t.facade=e,Pu.set(e,t),t},qs=function(e){return Pu.get(e)||{}},Ys=function(e){return Pu.has(e)}}else{var xu=Cu("state");wu[xu]=!0,Qs=function(e,t){if(Tu(e,xu))throw Au(Eu);return t.facade=e,Su(e,xu,t),t},qs=function(e){return Tu(e,xu)?e[xu]:{}},Ys=function(e){return Tu(e,xu)}}var Du={set:Qs,get:qs,has:Ys,enforce:function(e){return Ys(e)?qs(e):Qs(e,{})},getterFor:function(e){return function(t){var r;if(!Iu(t)||(r=qs(t)).type!==e)throw Au("Incompatible receiver, "+e+" required");return r}}},Fu=ki,Wu=Sr,Ru=An,Nu=Eo,Ou=fa,Mu=Jt([].push),Lu=function(e){var t=1===e,r=2===e,n=3===e,i=4===e,o=6===e,a=7===e,s=5===e||o;return function(u,c,l,d){for(var f,h,g=Ru(u),p=Wu(g),m=Fu(c,l),_=Nu(p),v=0,y=d||Ou,I=t?y(u,_):r||a?y(u,0):undefined;_>v;v++)if((s||v in p)&&(h=m(f=p[v],v,g),e))if(t)I[v]=h;else if(h)switch(e){case 3:return!0;case 5:return f;case 6:return v;case 2:Mu(I,f)}else switch(e){case 4:return!1;case 7:Mu(I,f)}return o?-1:n||i?i:I}},Bu={forEach:Lu(0),map:Lu(1),filter:Lu(2),some:Lu(3),every:Lu(4),find:Lu(5),findIndex:Lu(6),filterReject:Lu(7)},Uu=ao,Vu=Nt,Gu=cr,ju=Jt,Hu=ar,zu=Yr,Ku=Ot,Ju=xn,Qu=Lr,qu=Ri,Yu=kr,Xu=ei,Zu=Wa,$u=mr,ec=ws,tc=es,rc=Es,nc=Ps,ic=Vs,oc=or,ac=Pi,sc=Ra,uc=lr,cc=js,lc=zs,dc=Cn,fc=Ha,hc=Nn,gc=Hn,pc=Ks,mc=tu,_c=au,vc=pu,yc=Du,Ic=Bu.forEach,Sc=ds("hidden"),Tc="Symbol",bc="prototype",Cc=yc.set,wc=yc.getterFor(Tc),Ec=Object[bc],Ac=Vu.Symbol,kc=Ac&&Ac[bc],Pc=Vu.TypeError,xc=Vu.QObject,Dc=oc.f,Fc=ac.f,Wc=nc.f,Rc=uc.f,Nc=ju([].push),Oc=dc("symbols"),Mc=dc("op-symbols"),Lc=dc("wks"),Bc=!xc||!xc[bc]||!xc[bc].findChild,Uc=Hu&&Ku((function(){return 7!==ec(Fc({},"a",{get:function(){return Fc(this,"a",{value:7}).a}})).a}))?function(e,t,r){var n=Dc(Ec,t);n&&delete Ec[t],Fc(e,t,r),n&&e!==Ec&&Fc(Ec,t,n)}:Fc,Vc=function(e,t){var r=Oc[e]=ec(kc);return Cc(r,{type:Tc,tag:e,description:t}),Hu||(r.description=t),r},Gc=function(e,t,r){e===Ec&&Gc(Mc,t,r),qu(e);var n=Xu(t);return qu(r),Ju(Oc,n)?(r.enumerable?(Ju(e,Sc)&&e[Sc][n]&&(e[Sc][n]=!1),r=ec(r,{enumerable:$u(0,!1)})):(Ju(e,Sc)||Fc(e,Sc,$u(1,{})),e[Sc][n]=!0),Uc(e,n,r)):Fc(e,n,r)},jc=function(e,t){qu(e);var r=Yu(t),n=tc(r).concat(Jc(r));return Ic(n,(function(t){Hu&&!Gu(Hc,r,t)||Gc(e,t,r[t])})),e},Hc=function(e){var t=Xu(e),r=Gu(Rc,this,t);return!(this===Ec&&Ju(Oc,t)&&!Ju(Mc,t))&&(!(r||!Ju(this,t)||!Ju(Oc,t)||Ju(this,Sc)&&this[Sc][t])||r)},zc=function(e,t){var r=Yu(e),n=Xu(t);if(r!==Ec||!Ju(Oc,n)||Ju(Mc,n)){var i=Dc(r,n);return!i||!Ju(Oc,n)||Ju(r,Sc)&&r[Sc][n]||(i.enumerable=!0),i}},Kc=function(e){var t=Wc(Yu(e)),r=[];return Ic(t,(function(e){Ju(Oc,e)||Ju(fc,e)||Nc(r,e)})),r},Jc=function(e){var t=e===Ec,r=Wc(t?Mc:Yu(e)),n=[];return Ic(r,(function(e){!Ju(Oc,e)||t&&!Ju(Ec,e)||Nc(n,Oc[e])})),n};zu||(Ac=function(){if(Qu(kc,this))throw Pc("Symbol is not a constructor");var e=arguments.length&&arguments[0]!==undefined?Zu(arguments[0]):undefined,t=hc(e),r=function(e){this===Ec&&Gu(r,Mc,e),Ju(this,Sc)&&Ju(this[Sc],t)&&(this[Sc][t]=!1),Uc(this,t,$u(1,e))};return Hu&&Bc&&Uc(Ec,t,{configurable:!0,set:r}),Vc(t,e)},cc(kc=Ac[bc],"toString",(function(){return wc(this).tag})),cc(Ac,"withoutSetter",(function(e){return Vc(hc(e),e)})),uc.f=Hc,ac.f=Gc,sc.f=jc,oc.f=zc,rc.f=nc.f=Kc,ic.f=Jc,pc.f=function(e){return Vc(gc(e),e)},Hu&&lc(kc,"description",{configurable:!0,get:function(){return wc(this).description}})),Uu({global:!0,constructor:!0,wrap:!0,forced:!zu,sham:!zu},{Symbol:Ac}),Ic(tc(Lc),(function(e){mc(e)})),Uu({target:Tc,stat:!0,forced:!zu},{useSetter:function(){Bc=!0},useSimple:function(){Bc=!1}}),Uu({target:"Object",stat:!0,forced:!zu,sham:!Hu},{create:function(e,t){return t===undefined?ec(e):jc(ec(e),t)},defineProperty:Gc,defineProperties:jc,getOwnPropertyDescriptor:zc}),Uu({target:"Object",stat:!0,forced:!zu},{getOwnPropertyNames:Kc}),_c(),vc(Ac,Tc),fc[Sc]=!0;var Qc=Yr&&!!Symbol["for"]&&!!Symbol.keyFor,qc=ao,Yc=Mr,Xc=xn,Zc=Wa,$c=Cn,el=Qc,tl=$c("string-to-symbol-registry"),rl=$c("symbol-to-string-registry");qc({target:"Symbol",stat:!0,forced:!el},{"for":function(e){var t=Zc(e);if(Xc(tl,t))return tl[t];var r=Yc("Symbol")(t);return tl[t]=r,rl[r]=t,r}});var nl=ao,il=xn,ol=rn,al=on,sl=Qc,ul=Cn("symbol-to-string-registry");nl({target:"Symbol",stat:!0,forced:!sl},{keyFor:function(e){if(!ol(e))throw TypeError(al(e)+" is not a symbol");if(il(ul,e))return ul[e]}});var cl=Jt([].slice),ll=_o,dl=ir,fl=Xt,hl=Wa,gl=Jt([].push),pl=ao,ml=Mr,_l=Gt,vl=cr,yl=Jt,Il=Ot,Sl=ir,Tl=rn,bl=cl,Cl=function(e){if(dl(e))return e;if(ll(e)){for(var t=e.length,r=[],n=0;n<t;n++){var i=e[n];"string"==typeof i?gl(r,i):"number"!=typeof i&&"Number"!==fl(i)&&"String"!==fl(i)||gl(r,hl(i))}var o=r.length,a=!0;return function(e,t){if(a)return a=!1,t;if(ll(this))return t;for(var n=0;n<o;n++)if(r[n]===e)return t}}},wl=Yr,El=String,Al=ml("JSON","stringify"),kl=yl(/./.exec),Pl=yl("".charAt),xl=yl("".charCodeAt),Dl=yl("".replace),Fl=yl(1..toString),Wl=/[\uD800-\uDFFF]/g,Rl=/^[\uD800-\uDBFF]$/,Nl=/^[\uDC00-\uDFFF]$/,Ol=!wl||Il((function(){var e=ml("Symbol")("stringify detection");return"[null]"!==Al([e])||"{}"!==Al({a:e})||"{}"!==Al(Object(e))})),Ml=Il((function(){return'"\\udf06\\ud834"'!==Al("\udf06\ud834")||'"\\udead"'!==Al("\udead")})),Ll=function(e,t){var r=bl(arguments),n=Cl(t);if(Sl(n)||e!==undefined&&!Tl(e))return r[1]=function(e,t){if(Sl(n)&&(t=vl(n,this,El(e),t)),!Tl(t))return t},_l(Al,null,r)},Bl=function(e,t,r){var n=Pl(r,t-1),i=Pl(r,t+1);return kl(Rl,e)&&!kl(Nl,i)||kl(Nl,e)&&!kl(Rl,n)?"\\u"+Fl(xl(e,0),16):e};Al&&pl({target:"JSON",stat:!0,arity:3,forced:Ol||Ml},{stringify:function(e,t,r){var n=bl(arguments),i=_l(Ol?Ll:Al,null,n);return Ml&&"string"==typeof i?Dl(i,Wl,Bl):i}});var Ul=Vs,Vl=An;ao({target:"Object",stat:!0,forced:!Yr||Ot((function(){Ul.f(1)}))},{getOwnPropertySymbols:function(e){var t=Ul.f;return t?t(Vl(e)):[]}}),tu("asyncIterator"),tu("hasInstance"),tu("isConcatSpreadable"),tu("iterator"),tu("match"),tu("matchAll"),tu("replace"),tu("search"),tu("species"),tu("split");var Gl=au;tu("toPrimitive"),Gl();var jl=Mr,Hl=pu;tu("toStringTag"),Hl(jl("Symbol"),"Symbol"),tu("unscopables"),pu(Nt.JSON,"JSON",!0);var zl,Kl,Jl,Ql=Fr.Symbol,ql={},Yl=ar,Xl=xn,Zl=Function.prototype,$l=Yl&&Object.getOwnPropertyDescriptor,ed=Xl(Zl,"name"),td={EXISTS:ed,PROPER:ed&&"something"===function(){}.name,CONFIGURABLE:ed&&(!Yl||Yl&&$l(Zl,"name").configurable)},rd=!Ot((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),nd=xn,id=ir,od=An,ad=rd,sd=ds("IE_PROTO"),ud=Object,cd=ud.prototype,ld=ad?ud.getPrototypeOf:function(e){var t=od(e);if(nd(t,sd))return t[sd];var r=t.constructor;return id(r)&&t instanceof r?r.prototype:t instanceof ud?cd:null},dd=Ot,fd=ir,hd=Dr,gd=ws,pd=ld,md=js,_d=Hn("iterator"),vd=!1;[].keys&&("next"in(Jl=[].keys())?(Kl=pd(pd(Jl)))!==Object.prototype&&(zl=Kl):vd=!0);var yd=!hd(zl)||dd((function(){var e={};return zl[_d].call(e)!==e}));fd((zl=yd?{}:gd(zl))[_d])||md(zl,_d,(function(){return this}));var Id={IteratorPrototype:zl,BUGGY_SAFARI_ITERATORS:vd},Sd=Id.IteratorPrototype,Td=ws,bd=mr,Cd=pu,wd=ql,Ed=function(){return this},Ad=function(e,t,r,n){var i=t+" Iterator";return e.prototype=Td(Sd,{next:bd(+!n,r)}),Cd(e,i,!1,!0),wd[i]=Ed,e},kd=Jt,Pd=cn,xd=ir,Dd=String,Fd=TypeError,Wd=function(e,t,r){try{return kd(Pd(Object.getOwnPropertyDescriptor(e,t)[r]))}catch(pC){}},Rd=Ri,Nd=function(e){if("object"==typeof e||xd(e))return e;throw Fd("Can't set "+Dd(e)+" as a prototype")},Od=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=Wd(Object.prototype,"__proto__","set"))(r,[]),t=r instanceof Array}catch(pC){}return function(r,n){return Rd(r),Nd(n),t?e(r,n):r.__proto__=n,r}}():undefined),Md=ao,Ld=cr,Bd=td,Ud=Ad,Vd=ld,Gd=pu,jd=js,Hd=ql,zd=Id,Kd=Bd.PROPER,Jd=zd.BUGGY_SAFARI_ITERATORS,Qd=Hn("iterator"),qd="keys",Yd="values",Xd="entries",Zd=function(){return this},$d=function(e,t,r,n,i,o,a){Ud(r,t,n);var s,u,c,l=function(e){if(e===i&&p)return p;if(!Jd&&e&&e in h)return h[e];switch(e){case qd:case Yd:case Xd:return function(){return new r(this,e)}}return function(){return new r(this)}},d=t+" Iterator",f=!1,h=e.prototype,g=h[Qd]||h["@@iterator"]||i&&h[i],p=!Jd&&g||l(i),m="Array"===t&&h.entries||g;if(m&&(s=Vd(m.call(new e)))!==Object.prototype&&s.next&&(Gd(s,d,!0,!0),Hd[d]=Zd),Kd&&i===Yd&&g&&g.name!==Yd&&(f=!0,p=function(){return Ld(g,this)}),i)if(u={values:l(Yd),keys:o?p:l(qd),entries:l(Xd)},a)for(c in u)(Jd||f||!(c in h))&&jd(h,c,u[c]);else Md({target:t,proto:!0,forced:Jd||f},u);return a&&h[Qd]!==p&&jd(h,Qd,p,{name:i}),Hd[t]=p,u},ef=function(e,t){return{value:e,done:t}},tf=kr,rf=ql,nf=Du;Pi.f;var of=$d,af=ef,sf="Array Iterator",uf=nf.set,cf=nf.getterFor(sf);of(Array,"Array",(function(e,t){uf(this,{type:sf,target:tf(e),index:0,kind:t})}),(function(){var e=cf(this),t=e.target,r=e.kind,n=e.index++;if(!t||n>=t.length)return e.target=undefined,af(undefined,!0);switch(r){case"keys":return af(n,!1);case"values":return af(t[n],!1)}return af([n,t[n]],!1)}),"values"),rf.Arguments=rf.Array;var lf={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},df=Nt,ff=Vo,hf=Qi,gf=ql,pf=Hn("toStringTag");for(var mf in lf){var _f=df[mf],vf=_f&&_f.prototype;vf&&ff(vf)!==pf&&hf(vf,pf,mf),gf[mf]=gf.Array}var yf=Ql,If=Hn,Sf=Pi.f,Tf=If("metadata"),bf=Function.prototype;bf[Tf]===undefined&&Sf(bf,Tf,{value:null}),tu("asyncDispose"),tu("dispose"),tu("metadata");var Cf=yf,wf=Jt,Ef=Mr("Symbol"),Af=Ef.keyFor,kf=wf(Ef.prototype.valueOf),Pf=Ef.isRegisteredSymbol||function(e){try{return Af(kf(e))!==undefined}catch(pC){return!1}};ao({target:"Symbol",stat:!0},{isRegisteredSymbol:Pf});for(var xf=Cn,Df=Mr,Ff=Jt,Wf=rn,Rf=Hn,Nf=Df("Symbol"),Of=Nf.isWellKnownSymbol,Mf=Df("Object","getOwnPropertyNames"),Lf=Ff(Nf.prototype.valueOf),Bf=xf("wks"),Uf=0,Vf=Mf(Nf),Gf=Vf.length;Uf<Gf;Uf++)try{var jf=Vf[Uf];Wf(Nf[jf])&&Rf(jf)}catch(pC){}var Hf=function(e){if(Of&&Of(e))return!0;try{for(var t=Lf(e),r=0,n=Mf(Bf),i=n.length;r<i;r++)if(Bf[n[r]]==t)return!0}catch(pC){}return!1};ao({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:Hf}),tu("matcher"),tu("observable"),ao({target:"Symbol",stat:!0,name:"isRegisteredSymbol"},{isRegistered:Pf}),ao({target:"Symbol",stat:!0,name:"isWellKnownSymbol",forced:!0},{isWellKnown:Hf}),tu("metadataKey"),tu("patternMatch"),tu("replaceAll");var zf=Cf,Kf=a(zf),Jf=Jt,Qf=So,qf=Wa,Yf=wr,Xf=Jf("".charAt),Zf=Jf("".charCodeAt),$f=Jf("".slice),eh=function(e){return function(t,r){var n,i,o=qf(Yf(t)),a=Qf(r),s=o.length;return a<0||a>=s?e?"":undefined:(n=Zf(o,a))<55296||n>56319||a+1===s||(i=Zf(o,a+1))<56320||i>57343?e?Xf(o,a):n:e?$f(o,a,a+2):i-56320+(n-55296<<10)+65536}},th={codeAt:eh(!1),charAt:eh(!0)},rh=th.charAt,nh=Wa,ih=Du,oh=$d,ah=ef,sh="String Iterator",uh=ih.set,ch=ih.getterFor(sh);oh(String,"String",(function(e){uh(this,{type:sh,string:nh(e),index:0})}),(function(){var e,t=ch(this),r=t.string,n=t.index;return n>=r.length?ah(undefined,!0):(e=rh(r,n),t.index+=e.length,ah(e,!1))}));var lh=Ks.f("iterator"),dh=a(lh);function fh(e){return fh="function"==typeof Kf&&"symbol"==typeof dh?function(e){return typeof e}:function(e){return e&&"function"==typeof Kf&&e.constructor===Kf&&e!==Kf.prototype?"symbol":typeof e},fh(e)}var hh=a(Ks.f("toPrimitive"));function gh(e){var t=function(e,t){if("object"!==fh(e)||null===e)return e;var r=e[hh];if(r!==undefined){var n=r.call(e,t||"default");if("object"!==fh(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===fh(t)?t:String(t)}function ph(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),po(e,gh(n.key),n)}}function mh(e,t,r){return t&&ph(e.prototype,t),r&&ph(e,r),po(e,"prototype",{writable:!1}),e}var _h="\t\n\x0B\f\r                　\u2028\u2029\ufeff",vh=wr,yh=Wa,Ih=_h,Sh=Jt("".replace),Th=RegExp("^["+Ih+"]+"),bh=RegExp("(^|[^"+Ih+"])["+Ih+"]+$"),Ch=function(e){return function(t){var r=yh(vh(t));return 1&e&&(r=Sh(r,Th,"")),2&e&&(r=Sh(r,bh,"$1")),r}},wh={start:Ch(1),end:Ch(2),trim:Ch(3)},Eh=td.PROPER,Ah=Ot,kh=_h,Ph=wh.trim;ao({target:"String",proto:!0,forced:function(e){return Ah((function(){return!!kh[e]()||"​᠎"!=="​᠎"[e]()||Eh&&kh[e].name!==e}))}("trim")},{trim:function(){return Ph(this)}});var xh=Fr,Dh=function(e){return xh[e+"Prototype"]},Fh=Dh("String").trim,Wh=Lr,Rh=Fh,Nh=String.prototype,Oh=a((function(e){var t=e.trim;return"string"==typeof e||e===Nh||Wh(Nh,e)&&t===Nh.trim?Rh:t})),Mh=Ot,Lh=function(e,t){var r=[][e];return!!r&&Mh((function(){r.call(null,t||function(){return 1},1)}))},Bh=ao,Uh=ja.indexOf,Vh=Lh,Gh=er([].indexOf),jh=!!Gh&&1/Gh([1],1,-0)<0;Bh({target:"Array",proto:!0,forced:jh||!Vh("indexOf")},{indexOf:function(e){var t=arguments.length>1?arguments[1]:undefined;return jh?Gh(this,e,t)||0:Uh(this,e,t)}});var Hh=Dh("Array").indexOf,zh=Lr,Kh=Hh,Jh=Array.prototype,Qh=a((function(e){var t=e.indexOf;return e===Jh||zh(Jh,e)&&t===Jh.indexOf?Kh:t})),qh=Dh("Array").keys,Yh=Vo,Xh=xn,Zh=Lr,$h=qh,eg=Array.prototype,tg={DOMTokenList:!0,NodeList:!0},rg=a((function(e){var t=e.keys;return e===eg||Zh(eg,e)&&t===eg.keys||Xh(tg,Yh(e))?$h:t})),ng=ao,ig=_o,og=oa,ag=Dr,sg=La,ug=Eo,cg=kr,lg=Fo,dg=Hn,fg=cl,hg=ma("slice"),gg=dg("species"),pg=Array,mg=Math.max;ng({target:"Array",proto:!0,forced:!hg},{slice:function(e,t){var r,n,i,o=cg(this),a=ug(o),s=sg(e,a),u=sg(t===undefined?a:t,a);if(ig(o)&&(r=o.constructor,(og(r)&&(r===pg||ig(r.prototype))||ag(r)&&null===(r=r[gg]))&&(r=undefined),r===pg||r===undefined))return fg(o,s,u);for(n=new(r===undefined?pg:r)(mg(u-s,0)),i=0;s<u;s++,i++)s in o&&lg(n,i,o[s]);return n.length=i,n}});var _g=Dh("Array").slice,vg=Lr,yg=_g,Ig=Array.prototype,Sg=function(e){var t=e.slice;return e===Ig||vg(Ig,e)&&t===Ig.slice?yg:t},Tg=a(Sg),bg=Nt,Cg=Ot,wg=Jt,Eg=Wa,Ag=wh.trim,kg=_h,Pg=bg.parseInt,xg=bg.Symbol,Dg=xg&&xg.iterator,Fg=/^[+-]?0x/i,Wg=wg(Fg.exec),Rg=8!==Pg(kg+"08")||22!==Pg(kg+"0x16")||Dg&&!Cg((function(){Pg(Object(Dg))}))?function(e,t){var r=Ag(Eg(e));return Pg(r,t>>>0||(Wg(Fg,r)?16:10))}:Pg;ao({global:!0,forced:parseInt!==Rg},{parseInt:Rg});var Ng=a(Fr.parseInt);ao({target:"Array",stat:!0},{isArray:_o});var Og=Fr.Array.isArray,Mg=a(Og),Lg="function"==typeof Bun&&Bun&&"string"==typeof Bun.version,Bg=TypeError,Ug=function(e,t){if(e<t)throw Bg("Not enough arguments");return e},Vg=Nt,Gg=Gt,jg=ir,Hg=Lg,zg=Br,Kg=cl,Jg=Ug,Qg=Vg.Function,qg=/MSIE .\./.test(zg)||Hg&&function(){var e=Vg.Bun.version.split(".");return e.length<3||"0"===e[0]&&(e[1]<3||"3"===e[1]&&"0"===e[2])}(),Yg=function(e,t){var r=t?2:1;return qg?function(n,i){var o=Jg(arguments.length,1)>r,a=jg(n)?n:Qg(n),s=o?Kg(arguments,r):[],u=o?function(){Gg(a,this,s)}:a;return t?e(u,i):e(u)}:e},Xg=ao,Zg=Nt,$g=Yg(Zg.setInterval,!0);Xg({global:!0,bind:!0,forced:Zg.setInterval!==$g},{setInterval:$g});var ep=ao,tp=Nt,rp=Yg(tp.setTimeout,!0);ep({global:!0,bind:!0,forced:tp.setTimeout!==rp},{setTimeout:rp});var np=a(Fr.setTimeout),ip=ar,op=_o,ap=TypeError,sp=Object.getOwnPropertyDescriptor,up=ip&&!function(){if(this!==undefined)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(pC){return pC instanceof TypeError}}()?function(e,t){if(op(e)&&!sp(e,"length").writable)throw ap("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},cp=on,lp=TypeError,dp=ao,fp=An,hp=La,gp=So,pp=Eo,mp=up,_p=ko,vp=fa,yp=Fo,Ip=function(e,t){if(!delete e[t])throw lp("Cannot delete property "+cp(t)+" of "+cp(e))},Sp=ma("splice"),Tp=Math.max,bp=Math.min;dp({target:"Array",proto:!0,forced:!Sp},{splice:function(e,t){var r,n,i,o,a,s,u=fp(this),c=pp(u),l=hp(e,c),d=arguments.length;for(0===d?r=n=0:1===d?(r=0,n=c-l):(r=d-2,n=bp(Tp(gp(t),0),c-l)),_p(c+r-n),i=vp(u,n),o=0;o<n;o++)(a=l+o)in u&&yp(i,o,u[a]);if(i.length=n,r<n){for(o=l;o<c-n;o++)s=o+r,(a=o+n)in u?u[s]=u[a]:Ip(u,s);for(o=c;o>c-n+r;o--)Ip(u,o-1)}else if(r>n)for(o=c-n;o>l;o--)s=o+r-1,(a=o+n-1)in u?u[s]=u[a]:Ip(u,s);for(o=0;o<r;o++)u[o+l]=arguments[o+2];return mp(u,c-n+r),i}});var Cp=Dh("Array").splice,wp=Lr,Ep=Cp,Ap=Array.prototype,kp=a((function(e){var t=e.splice;return e===Ap||wp(Ap,e)&&t===Ap.splice?Ep:t})),Pp=Mr,xp=Es,Dp=Vs,Fp=Ri,Wp=Jt([].concat),Rp=Pp("Reflect","ownKeys")||function(e){var t=xp.f(Fp(e)),r=Dp.f;return r?Wp(t,r(e)):t},Np=xn,Op=Rp,Mp=or,Lp=Pi,Bp=Dr,Up=Qi,Vp=Error,Gp=Jt("".replace),jp=String(Vp("zxcasd").stack),Hp=/\n\s*at [^:]*:[^\n]*/,zp=Hp.test(jp),Kp=mr,Jp=!Ot((function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",Kp(1,7)),7!==e.stack)})),Qp=Qi,qp=function(e,t){if(zp&&"string"==typeof e&&!Vp.prepareStackTrace)for(;t--;)e=Gp(e,Hp,"");return e},Yp=Jp,Xp=Error.captureStackTrace,Zp=ql,$p=Hn("iterator"),em=Array.prototype,tm=function(e){return e!==undefined&&(Zp.Array===e||em[$p]===e)},rm=Vo,nm=fn,im=Tr,om=ql,am=Hn("iterator"),sm=function(e){if(!im(e))return nm(e,am)||nm(e,"@@iterator")||om[rm(e)]},um=cr,cm=cn,lm=Ri,dm=on,fm=sm,hm=TypeError,gm=function(e,t){var r=arguments.length<2?fm(e):t;if(cm(r))return lm(um(r,e));throw hm(dm(e)+" is not iterable")},pm=cr,mm=Ri,_m=fn,vm=function(e,t,r){var n,i;mm(e);try{if(!(n=_m(e,"return"))){if("throw"===t)throw r;return r}n=pm(n,e)}catch(pC){i=!0,n=pC}if("throw"===t)throw r;if(i)throw n;return mm(n),r},ym=ki,Im=cr,Sm=Ri,Tm=on,bm=tm,Cm=Eo,wm=Lr,Em=gm,Am=sm,km=vm,Pm=TypeError,xm=function(e,t){this.stopped=e,this.result=t},Dm=xm.prototype,Fm=function(e,t,r){var n,i,o,a,s,u,c,l=r&&r.that,d=!(!r||!r.AS_ENTRIES),f=!(!r||!r.IS_RECORD),h=!(!r||!r.IS_ITERATOR),g=!(!r||!r.INTERRUPTED),p=ym(t,l),m=function(e){return n&&km(n,"normal",e),new xm(!0,e)},_=function(e){return d?(Sm(e),g?p(e[0],e[1],m):p(e[0],e[1])):g?p(e,m):p(e)};if(f)n=e.iterator;else if(h)n=e;else{if(!(i=Am(e)))throw Pm(Tm(e)+" is not iterable");if(bm(i)){for(o=0,a=Cm(e);a>o;o++)if((s=_(e[o]))&&wm(Dm,s))return s;return new xm(!1)}n=Em(e,i)}for(u=f?e.next:n.next;!(c=Im(u,n)).done;){try{s=_(c.value)}catch(pC){km(n,"throw",pC)}if("object"==typeof s&&s&&wm(Dm,s))return s}return new xm(!1)},Wm=Wa,Rm=ao,Nm=Lr,Om=ld,Mm=Od,Lm=function(e,t,r){for(var n=Op(t),i=Lp.f,o=Mp.f,a=0;a<n.length;a++){var s=n[a];Np(e,s)||r&&Np(r,s)||i(e,s,o(t,s))}},Bm=ws,Um=Qi,Vm=mr,Gm=function(e,t){Bp(t)&&"cause"in t&&Up(e,"cause",t.cause)},jm=function(e,t,r,n){Yp&&(Xp?Xp(e,t):Qp(e,"stack",qp(r,n)))},Hm=Fm,zm=function(e,t){return e===undefined?arguments.length<2?"":t:Wm(e)},Km=Hn("toStringTag"),Jm=Error,Qm=[].push,qm=function(e,t){var r,n=Nm(Ym,this);Mm?r=Mm(Jm(),n?Om(this):Ym):(r=n?this:Bm(Ym),Um(r,Km,"Error")),t!==undefined&&Um(r,"message",zm(t)),jm(r,qm,r.stack,1),arguments.length>2&&Gm(r,arguments[2]);var i=[];return Hm(e,Qm,{that:i}),Um(r,"errors",i),r};Mm?Mm(qm,Jm):Lm(qm,Jm,{name:!0});var Ym=qm.prototype=Bm(Jm.prototype,{constructor:Vm(1,qm),message:Vm(1,""),name:Vm(1,"AggregateError")});Rm({global:!0,constructor:!0,arity:2},{AggregateError:qm});var Xm,Zm,$m,e_,t_="process"===Xt(Nt.process),r_=Mr,n_=zs,i_=ar,o_=Hn("species"),a_=function(e){var t=r_(e);i_&&t&&!t[o_]&&n_(t,o_,{configurable:!0,get:function(){return this}})},s_=Lr,u_=TypeError,c_=function(e,t){if(s_(t,e))return e;throw u_("Incorrect invocation")},l_=oa,d_=on,f_=TypeError,h_=function(e){if(l_(e))return e;throw f_(d_(e)+" is not a constructor")},g_=Ri,p_=h_,m_=Tr,__=Hn("species"),v_=function(e,t){var r,n=g_(e).constructor;return n===undefined||m_(r=g_(n)[__])?t:p_(r)},y_=/(?:ipad|iphone|ipod).*applewebkit/i.test(Br),I_=Nt,S_=Gt,T_=ki,b_=ir,C_=xn,w_=Ot,E_=us,A_=cl,k_=ii,P_=Ug,x_=y_,D_=t_,F_=I_.setImmediate,W_=I_.clearImmediate,R_=I_.process,N_=I_.Dispatch,O_=I_.Function,M_=I_.MessageChannel,L_=I_.String,B_=0,U_={},V_="onreadystatechange";w_((function(){Xm=I_.location}));var G_=function(e){if(C_(U_,e)){var t=U_[e];delete U_[e],t()}},j_=function(e){return function(){G_(e)}},H_=function(e){G_(e.data)},z_=function(e){I_.postMessage(L_(e),Xm.protocol+"//"+Xm.host)};F_&&W_||(F_=function(e){P_(arguments.length,1);var t=b_(e)?e:O_(e),r=A_(arguments,1);return U_[++B_]=function(){S_(t,undefined,r)},Zm(B_),B_},W_=function(e){delete U_[e]},D_?Zm=function(e){R_.nextTick(j_(e))}:N_&&N_.now?Zm=function(e){N_.now(j_(e))}:M_&&!x_?(e_=($m=new M_).port2,$m.port1.onmessage=H_,Zm=T_(e_.postMessage,e_)):I_.addEventListener&&b_(I_.postMessage)&&!I_.importScripts&&Xm&&"file:"!==Xm.protocol&&!w_(z_)?(Zm=z_,I_.addEventListener("message",H_,!1)):Zm=V_ in k_("script")?function(e){E_.appendChild(k_("script"))[V_]=function(){E_.removeChild(this),G_(e)}}:function(e){setTimeout(j_(e),0)});var K_={set:F_,clear:W_},J_=function(){this.head=null,this.tail=null};J_.prototype={add:function(e){var t={item:e,next:null},r=this.tail;r?r.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return null===(this.head=e.next)&&(this.tail=null),e.item}};var Q_,q_,Y_,X_,Z_,$_=J_,ev=/ipad|iphone|ipod/i.test(Br)&&"undefined"!=typeof Pebble,tv=/web0s(?!.*chrome)/i.test(Br),rv=Nt,nv=ki,iv=or.f,ov=K_.set,av=$_,sv=y_,uv=ev,cv=tv,lv=t_,dv=rv.MutationObserver||rv.WebKitMutationObserver,fv=rv.document,hv=rv.process,gv=rv.Promise,pv=iv(rv,"queueMicrotask"),mv=pv&&pv.value;if(!mv){var _v=new av,vv=function(){var e,t;for(lv&&(e=hv.domain)&&e.exit();t=_v.get();)try{t()}catch(pC){throw _v.head&&Q_(),pC}e&&e.enter()};sv||lv||cv||!dv||!fv?!uv&&gv&&gv.resolve?((X_=gv.resolve(undefined)).constructor=gv,Z_=nv(X_.then,X_),Q_=function(){Z_(vv)}):lv?Q_=function(){hv.nextTick(vv)}:(ov=nv(ov,rv),Q_=function(){ov(vv)}):(q_=!0,Y_=fv.createTextNode(""),new dv(vv).observe(Y_,{characterData:!0}),Q_=function(){Y_.data=q_=!q_}),mv=function(e){_v.head||Q_(),_v.add(e)}}var yv=mv,Iv=function(e){try{return{error:!1,value:e()}}catch(pC){return{error:!0,value:pC}}},Sv=Nt.Promise,Tv="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,bv=!Tv&&!t_&&"object"==typeof window&&"object"==typeof document,Cv=Nt,wv=Sv,Ev=ir,Av=Ci,kv=zo,Pv=Hn,xv=bv,Dv=Tv,Fv=Kr,Wv=wv&&wv.prototype,Rv=Pv("species"),Nv=!1,Ov=Ev(Cv.PromiseRejectionEvent),Mv=Av("Promise",(function(){var e=kv(wv),t=e!==String(wv);if(!t&&66===Fv)return!0;if(!Wv["catch"]||!Wv["finally"])return!0;if(!Fv||Fv<51||!/native code/.test(e)){var r=new wv((function(e){e(1)})),n=function(e){e((function(){}),(function(){}))};if((r.constructor={})[Rv]=n,!(Nv=r.then((function(){}))instanceof n))return!0}return!t&&(xv||Dv)&&!Ov})),Lv={CONSTRUCTOR:Mv,REJECTION_EVENT:Ov,SUBCLASSING:Nv},Bv={},Uv=cn,Vv=TypeError,Gv=function(e){var t,r;this.promise=new e((function(e,n){if(t!==undefined||r!==undefined)throw Vv("Bad Promise constructor");t=e,r=n})),this.resolve=Uv(t),this.reject=Uv(r)};Bv.f=function(e){return new Gv(e)};var jv,Hv,zv=ao,Kv=t_,Jv=Nt,Qv=cr,qv=js,Yv=pu,Xv=a_,Zv=cn,$v=ir,ey=Dr,ty=c_,ry=v_,ny=K_.set,iy=yv,oy=function(e,t){},ay=Iv,sy=$_,uy=Du,cy=Sv,ly=Lv,dy=Bv,fy="Promise",hy=ly.CONSTRUCTOR,gy=ly.REJECTION_EVENT,py=uy.getterFor(fy),my=uy.set,_y=cy&&cy.prototype,vy=cy,yy=_y,Iy=Jv.TypeError,Sy=Jv.document,Ty=Jv.process,by=dy.f,Cy=by,wy=!!(Sy&&Sy.createEvent&&Jv.dispatchEvent),Ey="unhandledrejection",Ay=function(e){var t;return!(!ey(e)||!$v(t=e.then))&&t},ky=function(e,t){var r,n,i,o=t.value,a=1===t.state,s=a?e.ok:e.fail,u=e.resolve,c=e.reject,l=e.domain;try{s?(a||(2===t.rejection&&Wy(t),t.rejection=1),!0===s?r=o:(l&&l.enter(),r=s(o),l&&(l.exit(),i=!0)),r===e.promise?c(Iy("Promise-chain cycle")):(n=Ay(r))?Qv(n,r,u,c):u(r)):c(o)}catch(pC){l&&!i&&l.exit(),c(pC)}},Py=function(e,t){e.notified||(e.notified=!0,iy((function(){for(var r,n=e.reactions;r=n.get();)ky(r,e);e.notified=!1,t&&!e.rejection&&Dy(e)})))},xy=function(e,t,r){var n,i;wy?((n=Sy.createEvent("Event")).promise=t,n.reason=r,n.initEvent(e,!1,!0),Jv.dispatchEvent(n)):n={promise:t,reason:r},!gy&&(i=Jv["on"+e])?i(n):e===Ey&&oy("Unhandled promise rejection",r)},Dy=function(e){Qv(ny,Jv,(function(){var t,r=e.facade,n=e.value;if(Fy(e)&&(t=ay((function(){Kv?Ty.emit("unhandledRejection",n,r):xy(Ey,r,n)})),e.rejection=Kv||Fy(e)?2:1,t.error))throw t.value}))},Fy=function(e){return 1!==e.rejection&&!e.parent},Wy=function(e){Qv(ny,Jv,(function(){var t=e.facade;Kv?Ty.emit("rejectionHandled",t):xy("rejectionhandled",t,e.value)}))},Ry=function(e,t,r){return function(n){e(t,n,r)}},Ny=function(e,t,r){e.done||(e.done=!0,r&&(e=r),e.value=t,e.state=2,Py(e,!0))},Oy=function(e,t,r){if(!e.done){e.done=!0,r&&(e=r);try{if(e.facade===t)throw Iy("Promise can't be resolved itself");var n=Ay(t);n?iy((function(){var r={done:!1};try{Qv(n,t,Ry(Oy,r,e),Ry(Ny,r,e))}catch(pC){Ny(r,pC,e)}})):(e.value=t,e.state=1,Py(e,!1))}catch(pC){Ny({done:!1},pC,e)}}};hy&&(yy=(vy=function(e){ty(this,yy),Zv(e),Qv(jv,this);var t=py(this);try{e(Ry(Oy,t),Ry(Ny,t))}catch(pC){Ny(t,pC)}}).prototype,(jv=function(e){my(this,{type:fy,done:!1,notified:!1,parent:!1,reactions:new sy,rejection:!1,state:0,value:undefined})}).prototype=qv(yy,"then",(function(e,t){var r=py(this),n=by(ry(this,vy));return r.parent=!0,n.ok=!$v(e)||e,n.fail=$v(t)&&t,n.domain=Kv?Ty.domain:undefined,0===r.state?r.reactions.add(n):iy((function(){ky(n,r)})),n.promise})),Hv=function(){var e=new jv,t=py(e);this.promise=e,this.resolve=Ry(Oy,t),this.reject=Ry(Ny,t)},dy.f=by=function(e){return e===vy||undefined===e?new Hv(e):Cy(e)}),zv({global:!0,constructor:!0,wrap:!0,forced:hy},{Promise:vy}),Yv(vy,fy,!1,!0),Xv(fy);var My=Hn("iterator"),Ly=!1;try{var By=0,Uy={next:function(){return{done:!!By++}},"return":function(){Ly=!0}};Uy[My]=function(){return this},Array.from(Uy,(function(){throw 2}))}catch(pC){}var Vy=function(e,t){try{if(!t&&!Ly)return!1}catch(pC){return!1}var r=!1;try{var n={};n[My]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch(pC){}return r},Gy=Sv,jy=Lv.CONSTRUCTOR||!Vy((function(e){Gy.all(e).then(undefined,(function(){}))})),Hy=cr,zy=cn,Ky=Bv,Jy=Iv,Qy=Fm;ao({target:"Promise",stat:!0,forced:jy},{all:function(e){var t=this,r=Ky.f(t),n=r.resolve,i=r.reject,o=Jy((function(){var r=zy(t.resolve),o=[],a=0,s=1;Qy(e,(function(e){var u=a++,c=!1;s++,Hy(r,t,e).then((function(e){c||(c=!0,o[u]=e,--s||n(o))}),i)})),--s||n(o)}));return o.error&&i(o.value),r.promise}});var qy=ao,Yy=Lv.CONSTRUCTOR;Sv&&Sv.prototype,qy({target:"Promise",proto:!0,forced:Yy,real:!0},{"catch":function(e){return this.then(undefined,e)}});var Xy=cr,Zy=cn,$y=Bv,eI=Iv,tI=Fm;ao({target:"Promise",stat:!0,forced:jy},{race:function(e){var t=this,r=$y.f(t),n=r.reject,i=eI((function(){var i=Zy(t.resolve);tI(e,(function(e){Xy(i,t,e).then(r.resolve,n)}))}));return i.error&&n(i.value),r.promise}});var rI=cr,nI=Bv;ao({target:"Promise",stat:!0,forced:Lv.CONSTRUCTOR},{reject:function(e){var t=nI.f(this);return rI(t.reject,undefined,e),t.promise}});var iI=Ri,oI=Dr,aI=Bv,sI=function(e,t){if(iI(e),oI(t)&&t.constructor===e)return t;var r=aI.f(e);return(0,r.resolve)(t),r.promise},uI=ao,cI=Sv,lI=Lv.CONSTRUCTOR,dI=sI,fI=Mr("Promise"),hI=!lI;uI({target:"Promise",stat:!0,forced:true},{resolve:function(e){return dI(hI&&this===fI?cI:this,e)}});var gI=cr,pI=cn,mI=Bv,_I=Iv,vI=Fm;ao({target:"Promise",stat:!0,forced:jy},{allSettled:function(e){var t=this,r=mI.f(t),n=r.resolve,i=r.reject,o=_I((function(){var r=pI(t.resolve),i=[],o=0,a=1;vI(e,(function(e){var s=o++,u=!1;a++,gI(r,t,e).then((function(e){u||(u=!0,i[s]={status:"fulfilled",value:e},--a||n(i))}),(function(e){u||(u=!0,i[s]={status:"rejected",reason:e},--a||n(i))}))})),--a||n(i)}));return o.error&&i(o.value),r.promise}});var yI=cr,II=cn,SI=Mr,TI=Bv,bI=Iv,CI=Fm,wI="No one promise resolved";ao({target:"Promise",stat:!0,forced:jy},{any:function(e){var t=this,r=SI("AggregateError"),n=TI.f(t),i=n.resolve,o=n.reject,a=bI((function(){var n=II(t.resolve),a=[],s=0,u=1,c=!1;CI(e,(function(e){var l=s++,d=!1;u++,yI(n,t,e).then((function(e){d||c||(c=!0,i(e))}),(function(e){d||c||(d=!0,a[l]=e,--u||o(new r(a,wI)))}))})),--u||o(new r(a,wI))}));return a.error&&o(a.value),n.promise}});var EI=ao,AI=Sv,kI=Ot,PI=Mr,xI=ir,DI=v_,FI=sI,WI=AI&&AI.prototype;EI({target:"Promise",proto:!0,real:!0,forced:!!AI&&kI((function(){WI["finally"].call({then:function(){}},(function(){}))}))},{"finally":function(e){var t=DI(this,PI("Promise")),r=xI(e);return this.then(r?function(r){return FI(t,e()).then((function(){return r}))}:e,r?function(r){return FI(t,e()).then((function(){throw r}))}:e)}});var RI=Fr.Promise,NI=a(RI),OI=Dr,MI=Xt,LI=Hn("match"),BI=function(e){var t;return OI(e)&&((t=e[LI])!==undefined?!!t:"RegExp"===MI(e))},UI=TypeError,VI=function(e){if(BI(e))throw UI("The method doesn't accept regular expressions");return e},GI=Hn("match"),jI=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[GI]=!1,"/./"[e](t)}catch(n){}}return!1},HI=ao,zI=er;or.f;var KI=Co,JI=Wa,QI=VI,qI=wr,YI=jI,XI=zI("".endsWith),ZI=zI("".slice),$I=Math.min;HI({target:"String",proto:!0,forced:!YI("endsWith")},{endsWith:function(e){var t=JI(qI(this));QI(e);var r=arguments.length>1?arguments[1]:undefined,n=t.length,i=r===undefined?n:$I(KI(r),n),o=JI(e);return XI?XI(t,o,i):ZI(t,i-o.length,i)===o}});var eS=Dh("String").endsWith,tS=Lr,rS=eS,nS=String.prototype,iS=a((function(e){var t=e.endsWith;return"string"==typeof e||e===nS||tS(nS,e)&&t===nS.endsWith?rS:t})),oS=Jt,aS=cn,sS=Dr,uS=xn,cS=cl,lS=Mt,dS=Function,fS=oS([].concat),hS=oS([].join),gS={},pS=lS?dS.bind:function(e){var t=aS(this),r=t.prototype,n=cS(arguments,1),i=function(){var r=fS(n,cS(arguments));return this instanceof i?function(e,t,r){if(!uS(gS,t)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";gS[t]=dS("C,a","return new C("+hS(n,",")+")")}return gS[t](e,r)}(t,r.length,r):t.apply(e,r)};return sS(r)&&(i.prototype=r),i},mS=pS;ao({target:"Function",proto:!0,forced:Function.bind!==mS},{bind:mS});var _S=Dh("Function").bind,vS=Lr,yS=_S,IS=Function.prototype,SS=function(e){var t=e.bind;return e===IS||vS(IS,e)&&t===IS.bind?yS:t},TS=a(SS),bS=Nt,CS=Ot,wS=Wa,ES=wh.trim,AS=_h,kS=Jt("".charAt),PS=bS.parseFloat,xS=bS.Symbol,DS=xS&&xS.iterator,FS=1/PS(AS+"-0")!=-Infinity||DS&&!CS((function(){PS(Object(DS))}))?function(e){var t=ES(wS(e)),r=PS(t);return 0===r&&"-"===kS(t,0)?-0:r}:PS;ao({global:!0,forced:parseFloat!==FS},{parseFloat:FS});var WS=a(Fr.parseFloat),RS=ao,NS=er;or.f;var OS=Co,MS=Wa,LS=VI,BS=wr,US=jI,VS=NS("".startsWith),GS=NS("".slice),jS=Math.min;RS({target:"String",proto:!0,forced:!US("startsWith")},{startsWith:function(e){var t=MS(BS(this));LS(e);var r=OS(jS(arguments.length>1?arguments[1]:undefined,t.length)),n=MS(e);return VS?VS(t,n,r):GS(t,r,r+n.length)===n}});var HS,zS=Dh("String").startsWith,KS=Lr,JS=zS,QS=String.prototype,qS=a((function(e){var t=e.startsWith;return"string"==typeof e||e===QS||KS(QS,e)&&t===QS.startsWith?JS:t}));function YS(e){var t,r,n="0x";if(/^(rgb|RGB)/.test(e)){var i=e.replace(/[^\d,.]/g,"").split(",");for(r=0;r<3;++r)1==(t=Number(i[r]).toString(16)).length&&(t="0"+t),n+=t;4==i.length?(1==(t=Math.round(255*Number(i[r])).toString(16)).length&&(t="0"+t),n+=t):n+="ff"}else if("transparent"==e)n+="00000000";else if(/^#[0-9a-fA-f]{6}$/.test(e))n+=e.replace(/#/,"")+"ff";else if(/^#[0-9a-fA-f]{3}$/.test(e)){for(r=0;r<3;++r)n+=e[r]+e[r];n+="ff"}else n="-1";return Number(n)}function XS(e){if(e>4294967295||e<0)return null;var t;if(K.bHTML5Edition)t="rgba("+Math.floor(e/16777216)+","+Math.floor(e/65536)%256+","+Math.floor(e/256)%256+","+e%256/255+")";else if(e%256==0)t="transparent";else{for(t=Math.floor(e/256).toString(16);6!=t.length;)t="0"+t;t="#"+t}return t}function ZS(e){var t,r=(e=e||window.event).wheelDelta,n=e.detail;return r&&(t=r/120),n&&(t=-(n%3==0?n/3:n)),t}Oh(String.prototype)||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,z)}),HS={registedClass:[],registedObjs:[]};var $S={LEFT:0,MIDDLE:1,RIGHT:2};function eT(e){var t=e||window.event;return null==t.which?t.button<2?$S.LEFT:4==t.button?$S.MIDDLE:$S.RIGHT:t.which<2?$S.LEFT:2==t.which?$S.MIDDLE:$S.RIGHT}var tT,rT,nT=/[\-#$\^*()+\[\]{}|\\,.?\s]/g,iT={"&amp;":"&","&gt;":">","&lt;":"<","&#x60;":"`","&#x2F;":"/","&quot;":'"',"&#x27;":"'"},oT={};function aT(e){return e.replace(/\\u([a-f\d]{4})/gi,(function(e,t){return String.fromCharCode(Ng(t,16))}))}function sT(e){return(e+"").replace(function(){if(tT)return tT;var e=z;return Et.each(iT,(function(t){e+=t+"|"})),e=Tg(e).call(e,0,-1),tT=new RegExp(e,"g")}(),(function(e){return oT[e]}))}function uT(e){return e.replace(nT,"\\$&")}function cT(e){return e.replace(function(){if(rT)return rT;var e=z;return Et.each(oT,(function(t){e+=t+"|"})),e+="&#(\\d{1,5});",rT=new RegExp(e,"g")}(),(function(e,t){return iT[e]||String.fromCharCode(+t)}))}Et.each(iT,(function(e,t){oT[e]=t}));var lT,dT=undefined,fT=function(e){return"function"==typeof e},hT=function(e){return Mg?Mg(e):e instanceof Array},gT=function(e){return!1===e||e===dT||null===e},pT="undefined",mT=("undefined"==typeof TypeError?"undefined":fh(TypeError))===pT?Error:TypeError;if(("undefined"==typeof process?"undefined":fh(process))!==pT&&process.nextTick)lT=process.nextTick;else if(("undefined"==typeof MessageChannel?"undefined":fh(MessageChannel))!==pT){var _T=new MessageChannel,vT=[];_T.port1.onmessage=function(){vT.length&&vT.shift()()},lT=function(e){vT.push(e),_T.port2.postMessage(0)}}else lT=function(e){np(e,0)};function yT(e){lT((function(){throw e}))}function IT(e){return this.then(e,dT)}function ST(e){return this.then(dT,e)}function TT(e,t){return this.then((function(t){return fT(e)?e.apply(null,hT(t)?t:[t]):ET.onlyFuncs?t:e}),t||dT)}function bT(e){function t(){e()}return this.then(t,t),this}function CT(e){return this.then((function(t){return fT(e)?e.apply(null,hT(t)?kp(t).call(t,0,0,undefined)&&t:[undefined,t]):ET.onlyFuncs?t:e}),(function(t){return e(t)}))}function wT(e){return this.then(dT,e?function(t){throw e(t),t}:yT)}var ET=function(){function e(t){Ft(this,e),this.alwaysAsyncFn=null,this.status=0,this.pendings=[],this.promise={then:function(t,r){var n=new e;return this.pendings.push([function(r){try{gT(t)?n.resolve(r):n.resolve(fT(t)?t(r):e.onlyFuncs?r:t)}catch(VV){n.reject(VV)}},function(t){if((gT(r)||!fT(r)&&e.onlyFuncs)&&n.reject(t),r)try{n.resolve(fT(r)?r(t):r)}catch(VV){n.reject(VV)}}]),0!==this.status&&this.alwaysAsyncFn(this.execCallbacks),n.promise},success:IT,error:ST,otherwise:ST,apply:TT,spread:TT,ensure:bT,nodify:CT,rethrow:wT,isPending:function(){return 0===this.status},getStatus:function(){return this.status}},this.alwaysAsyncFn=(dT!==t?t:e.alwaysAsync)?lT:function(e){e()},this.promise.toSource=this.promise.toString=this.promise.valueOf=function(){return this.value===undefined?this:this.value}}return mh(e,[{key:"resolve",value:function(e){var t,r=!1;function n(e){return function(t){return r?undefined:(r=!0,e(t))}}if(this.status)return this;try{var i=!(!(t=e)||!fh(t).match(/function|object/))&&e.then;if(fT(i)){if(e===this.promise)throw new mT("Promise can't resolve itself");return i.call(e,n(this.resolve),n(this.reject)),this}}catch(VV){return n(this.reject)(VV),this}return this.alwaysAsyncFn((function(){this.value=e,this.status=1,this.execCallbacks()})),this}},{key:"reject",value:function(e){return this.status||this.alwaysAsyncFn((function(){try{throw e}catch(VV){this.value=VV}this.status=-1,this.execCallbacks()})),this}},{key:"execCallbacks",value:function(){if(0!==this.status){var e,t=this.pendings,r=0,n=t.length,i=~this.status?0:1;for(this.pendings=[];r<n;r++)(e=t[r][i])&&e(this.value)}}}]),e}();ET.deferred=ET,ET.defer=ET,ET.nextTick=lT,ET.alwaysAsync=!0,ET.onlyFuncs=!0,ET.resolve=function(e){return new ET(!0).resolve(e).promise},ET.resolved=ET.resolve,ET.fulfilled=ET.resolve,ET.reject=function(e){return new ET(!0).reject(e).promise},ET.rejected=ET.reject;var AT,kT,PT=window;function xT(e){return null==(e=e||window.event).which?e.which=e.button<2?1:4==e.button?2:3:e.which=e.which<2?1:2==e.which?2:3,e}function DT(e,t){return e.currentStyle?e.currentStyle[t]:window.getComputedStyle?document.defaultView.getComputedStyle(e,null)[t]:null}PT&&Et.isFunction(PT.__zone_symbol__Promise)&&(kT=PT.__zone_symbol__Promise),AT=self&&NI||PT&&NI?NI:ET,kT||(kT=AT);var FT;function WT(e){var t=fh(e);return null==e||"object"!==t&&"function"!==t}function RT(e,t,r,n){t=t||"&",r=r||"=",Et.isUndefined(n)&&(n=L);var i=[];return Et.each(e,(function(e,o){var a=Et.urlEncode(o);WT(e)?(i.push(a),Et.isDef(e)&&i.push(r,Et.urlEncode(e+z)),i.push(t)):Et.isArray(e)&&e.length&&Et.each(e,(function(e){WT(e)&&(i.push(a,n?Et.urlEncode("[]"):z),Et.isDef(e)&&i.push(r,Et.urlEncode(e+z)),i.push(t))}))})),i.pop(),i.join(z)}function NT(e,t,r){if(!Et.isString(e)||!(e=Oh(Et).call(Et,e)))return{};t=t||"&",r=r||"=";for(var n,i,o,a={},s=Et.urlDecode,u=e.split(t),c=0,l=u.length;c<l;++c){if(-1===(n=Qh(Et).call(Et,r,u[c])))i=s(u[c]),o=undefined;else{i=s(u[c].substring(0,n)),o=u[c].substring(n+1);try{o=s(o)}catch(VV){Et.error("decodeURIComponent error : "+o),Et.error(VV)}iS(Et).call(Et,i,"[]")&&(i=i.substring(0,i.length-2))}i in a?Et.isArray(a[i])?a[i].push(o):a[i]=[a[i],o]:a[i]=o}return a}Et.each({"&amp;":"&","&gt;":">","&lt;":"<","&#x60;":"`","&#x2F;":"/","&quot;":'"',"&#x27;":"'"},(function(e,t){}));var OT="ds-dwt-loaderBar",MT="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjAiIHdpZHRoPSIxMDBweCIgaGVpZ2h0PSIxMDBweCIgdmlld0JveD0iMCAwIDEyOCAxMjgiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxnPjxjaXJjbGUgY3g9IjE2IiBjeT0iNjQiIHI9IjE2IiBmaWxsPSIjZmU4ZTE0Ii8+PGNpcmNsZSBjeD0iMTYiIGN5PSI2NCIgcj0iMTQuMzQ0IiBmaWxsPSIjZmU4ZTE0IiB0cmFuc2Zvcm09InJvdGF0ZSg0NSA2NCA2NCkiLz48Y2lyY2xlIGN4PSIxNiIgY3k9IjY0IiByPSIxMi41MzEiIGZpbGw9IiNmZThlMTQiIHRyYW5zZm9ybT0icm90YXRlKDkwIDY0IDY0KSIvPjxjaXJjbGUgY3g9IjE2IiBjeT0iNjQiIHI9IjEwLjc1IiBmaWxsPSIjZmU4ZTE0IiB0cmFuc2Zvcm09InJvdGF0ZSgxMzUgNjQgNjQpIi8+PGNpcmNsZSBjeD0iMTYiIGN5PSI2NCIgcj0iMTAuMDYzIiBmaWxsPSIjZmU4ZTE0IiB0cmFuc2Zvcm09InJvdGF0ZSgxODAgNjQgNjQpIi8+PGNpcmNsZSBjeD0iMTYiIGN5PSI2NCIgcj0iOC4wNjMiIGZpbGw9IiNmZThlMTQiIHRyYW5zZm9ybT0icm90YXRlKDIyNSA2NCA2NCkiLz48Y2lyY2xlIGN4PSIxNiIgY3k9IjY0IiByPSI2LjQzOCIgZmlsbD0iI2ZlOGUxNCIgdHJhbnNmb3JtPSJyb3RhdGUoMjcwIDY0IDY0KSIvPjxjaXJjbGUgY3g9IjE2IiBjeT0iNjQiIHI9IjUuMzc1IiBmaWxsPSIjZmU4ZTE0IiB0cmFuc2Zvcm09InJvdGF0ZSgzMTUgNjQgNjQpIi8+PGFuaW1hdGVUcmFuc2Zvcm0gYXR0cmlidXRlTmFtZT0idHJhbnNmb3JtIiB0eXBlPSJyb3RhdGUiIHZhbHVlcz0iNDUgNjQgNjQ7OTAgNjQgNjQ7MTM1IDY0IDY0OzE4MCA2NCA2NDsyMjUgNjQgNjQ7MjcwIDY0IDY0OzMxNSA2NCA2NDswIDY0IDY0IiBjYWxjTW9kZT0iZGlzY3JldGUiIGR1cj0iNzIwbXMiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIj48L2FuaW1hdGVUcmFuc2Zvcm0+PC9nPjwvc3ZnPg==";function LT(e){var t,r,n,i="",o="230px",a="240px",s="",u="";return e&&(e.background&&(i=";background:"+e.background),e.width&&(o=e.width),e.height&&(a=e.height),e.imageSource&&(t=e.imageSource)),t||(t=MT),n=Ng(o)/2,Et.isNumber(n)&&n>0&&(u=";width:"+n+"px"),r=Ng(a)/2,Et.isNumber(r)&&r>0&&(s=";height:"+r+"px"),['<div align="center" ','class="',OT,'" ','style="margin:0 auto;max-width:',o,";max-height:",a,";line-height:",a,i,'"><img style="user-select:none',s,u,';max-width:230px;max-height:240px;vertical-align:middle" src="',t,'" draggable="false" /></div>'].join("")}var BT,UT=window,VT=document,GT=5e5;function jT(e,t){for(var r=0;r<e.length;++r)if(e[r]==t)return L;return B}function HT(e){var t;return UT.getComputedStyle?t=UT.getComputedStyle(e):e.currentStyle&&(t=e.currentStyle),t&&"absolute"!=t.position||"auto"!=e.style.top&&""!=e.style.top||"auto"!=e.style.bottom&&""!=e.style.bottom?B:!function(e){for(var t=0;t<VT.styleSheets.length;++t){var r=VT.styleSheets[t],n=void 0,i=void 0,o=void 0,a=void 0;try{n=r.cssRules,i=VT.querySelectorAll}catch(VV){}if(n&&i)for(var s=0;s<n.length;++s){o=n[s],a=B;try{a=i(o.selectorText)}catch(VV){}if(a&&jT(a,e)){var u=o.style.getPropertyValue("top"),c=o.style.getPropertyValue("bottom");if(u&&"auto"!=u||c&&"auto"!=c)return L}}}return B}(e)}function zT(e){var t=VT.createEvent("MouseEvents");return null==t||t.initMouseEvent(e.type,e.bubbles,e.cancelable,UT,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),t}function KT(e){var t;null===(t=VT.body)||void 0===t||t.dispatchEvent(zT(e))}function JT(e,t){if(BT){var r=BT.style;r.backgroundColor=["rgba(",t,",",t,",",t,",",e,")"].join(""),r.filter=["alpha(opacity=",100*e,")"].join(""),r.opacity=r.MozOpacity=e}}function QT(e,t){BT===FT?function(e,t){if(BT=VT.createElement("div")){var r=BT.style;r.position="fixed",r.display="block",r.left=r.top=r.margin=r.padding=0,JT(e,t),r.zIndex=GT,r.width=r.height="100%",K.bIE&&K.IEVersion<10&&(BT.innerHTML='<iframe src="javascript:\'\'" style="background:none;margin:0px auto;border:0;width:100%;height:100%;position:relative;z-index:9999;"></iframe>'),VT.createEvent&&Et.addEventListener(BT,"click",KT)}}(e,t):JT(e,t),VT.body&&!VT.body.contains(BT)&&VT.body.appendChild(BT)}var qT,YT,XT={pendingDialogStack:[],pendingDialogTopmostStack:[],opacity:.1,grayHex:128,_updateStacking:function(e){var t,r;0!=(t=this.pendingDialogStack).length?(1!=e&&QT(XT.opacity,XT.grayHex),r=GT,Et.each(t,(function(e){r++,e._dlgInfo.mask&&(e._dlgInfo.mask.style.zIndex=r++),e.style.zIndex=r}))):BT!==FT&&(Et.removeEventListener(BT,"click",KT),VT&&VT.body&&VT.body.removeChild(BT),BT=FT)},pushDialog:function(e,t){var r,n,i=this;if(e.getBoundingClientRect(),(n=e.bTopmost?i.pendingDialogTopmostStack:i.pendingDialogStack).length>=1e3)Et.error("Too many modal dialogs.");else{if((r=VT.createElement("div")).style.zIndex="10000",r.className="dynamsoft-backdrop",1==t?(r.style.left=0,r.style.top=0,r.style.position="absolute"):(r.style.left=0,r.style.top=0,r.style.width="100%",r.style.height="100%",r.style.position="fixed"),VT.createEvent&&Et.addEventListener(r,"click",(function(t){if(e.dispatchEvent){var r=zT(t);e.dispatchEvent(r)}})),e.parentNode.insertBefore(r,e.nextSibling),e._dlgInfo.mask=r,e.bTopmost){var o=1e3+GT;e._dlgInfo.mask&&(e._dlgInfo.mask.style.zIndex=o),e.style.zIndex=o+1}n.push(e),i._updateStacking(t)}},removeDialog:function(e){var t,r,n,i=this;n=e.bTopmost?i.pendingDialogTopmostStack:i.pendingDialogStack,-1!=(t=Et.isArray(n)?Qh(Et).call(Et,e,n):-1)&&(kp(n).call(n,t,1),(r=e._dlgInfo.mask).parentNode&&r.parentNode.removeChild(r),e._dlgInfo.mask=null,i._updateStacking())}};function ZT(e,t){var r,n=this,i=!0,o=1==t?"absolute":"fixed",a="50%",s="50%",u="",c="",l=null;if(n._dlgInfo&&n._dlgInfo.styleConfig){var d=n._dlgInfo.styleConfig;Et.isString(d.style)?(r=d.style,i=!1):(Et.isString(d.position)&&(o=d.position,i=!1),(Et.isString(d.left)||Et.isNumber(d.left))&&(s=d.left,i=!1),(Et.isString(d.top)||Et.isNumber(d.top))&&(a=d.top,i=!1),(Et.isString(d.width)||Et.isNumber(d.width))&&(u=d.width,i=!1),(Et.isString(d.height)||Et.isNumber(d.height))&&(c=d.height,i=!1),Et.isString(d.transform)&&(l=d.transform,i=!1))}if(n.open)Et.error("showDialog called on open dialog.");else{var f;if(n.open=L,n.removeAttribute("closed"),n.setAttribute("open","open"),r)n.setAttribute("style",r);else i?f=["display:block;position:",o,";left:50%;top:50%;transform:translate(-50%,-50%)"]:(f=["display:block;position:",o,";left:",s,";top:",a,";width:",u,";height:",c],l&&(f.push(";transform:"),f.push(l))),"DIALOG"==n.tagName?f.push(";margin:0;border-radius:6px;box-shadow:2px 2px 0 0 rgba(0,0,0,.05);-webkit-box-sizing:border-box;box-sizing:border-box;"):f.push(";border:0;margin:0;-webkit-box-sizing:border-box;box-sizing:border-box;"),n.setAttribute("style",f.join(""));HT(n)&&function(e){var t,r,n,i;i=((null===(t=VT.body)||void 0===t?void 0:t.scrollTop)||(null===(r=VT.documentElement)||void 0===r?void 0:r.scrollTop)||0)+((UT.innerHeight?UT.innerHeight:null===(n=VT.documentElement)||void 0===n?void 0:n.clientHeight)-e.offsetHeight)/2,e.style.top=i+"px",e._dlgInfo.isTopOverridden=L}(n),e&&(n._dlgInfo.modal=L,XT.pushDialog(n,t))}}function $T(e){var t=this;return t.open||Et.error("closeDialog called on closed dialog."),t.open=B,t.removeAttribute("open"),t.setAttribute("closed","closed"),t.style.display="none",void 0!==e&&(t.returnValue=e),t._dlgInfo.isTopOverridden&&(t.style.top="auto"),t._dlgInfo.modal&&XT.removeDialog(t),t.returnValue}function eb(e){Et.isNumber(e.opacity)?XT.opacity=e.opacity:XT.opacity=.1,Et.isNumber(e.grayHex)?XT.grayHex=e.grayHex:XT.grayHex=128}function tb(e){var t,r,n,i,o;if(!YT.dlgMask){var a,s,u,c,l=!1;if(e&&(c={},e.style?c.style=e.style:((Et.isString(e.top)||Et.isNumber(e.top))&&(c.top=e.top),(Et.isString(e.left)||Et.isNumber(e.left))&&(c.left=e.left),Et.isString(e.position)&&(c.position=e.position)),e.confined&&(l=e.confined),(Et.isString(e.width)||Et.isNumber(e.width))&&(r=e.width),(Et.isString(e.height)||Et.isNumber(e.height))&&(n=e.height),Et.isString(e.background)&&(i=e.background),Et.isString(e.imageSource)&&(o=e.imageSource),eb(e),l&&e.wrapperEl&&(s=e.wrapperEl,Et.isString(s)&&(s=VT.getElementById(s)))),!o){var d;if(window&&window.Dynamsoft){var f=window.Dynamsoft.DWT;f&&f.CustomizableDisplayInfo&&(d=f.CustomizableDisplayInfo)}d?(K.bIE&&Et.isString(d.loaderBarSourceIE)&&""!=d.loaderBarSourceIE&&(o=d.loaderBarSourceIE),!o&&Et.isString(d.loaderBarSource)&&""!=d.loaderBarSource&&(o=d.loaderBarSource)):o=MT}s&&(u=s.getBoundingClientRect(),s.style.position="relative"),(a=VT.createElement("div"))&&(a.className="dynamsoft-dialog-wrap",a.innerHTML=LT({width:r,height:n,backgroundColor:i,imageSource:o}),s?(s.appendChild(a),a.style.position="absolute",a.style.top="50%",a.style.left="50%",a.style.transform="translate(-50%, -50%)"):null===(t=VT.body)||void 0===t||t.appendChild(a),l&&u&&(window.onresize?YT.preOnresize=window.onresize:YT.preOnresize=!1,window.onscroll?YT.preOnscroll=window.onscroll:YT.preOnscroll=!1),YT.dlgMask=a,qT.setup(a,l),c&&(a._dlgInfo.styleConfig=c),s&&(a._dlgInfo.wrapperEl=s),a.showModal())}}function rb(){var e,t=YT.dlgMask;t&&(t.close(),t._dlgInfo&&t._dlgInfo.wrapperEl?(t._dlgInfo.wrapperEl.removeChild(t),t._dlgInfo.wrapperEl=null):null===(e=VT.body)||void 0===e||e.removeChild(t),YT.dlgMask=!1),YT.preOnresize?window.onresize=YT.preOnresize:window.onresize=null,YT.preOnresize=!1,YT.preOnscroll?window.onscroll=YT.preOnscroll:window.onscroll=null,YT.preOnscroll=!1}qT={setup:function(e,t){e.show=TS(ZT).call(ZT,e,B,t),e.showModal=TS(ZT).call(ZT,e,L,t),e.close=TS($T).call($T,e),e._dlgInfo={}}},YT={dlgMask:!1,preOnresize:!1,preOnscroll:!1};var nb,ib,ob=function(){function e(t){Ft(this,e);var r=t.createElement("div"),n=t.createElement("div");n.style&&(this.div=n,this.container=r,this.docElem=t.documentElement,n.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",this.leadingWhitespace=3===n.firstChild.nodeType,this.tbody=!n.getElementsByTagName("tbody").length,this.htmlSerialize=!!n.getElementsByTagName("link").length,n.style.cssText="float:left;opacity:.5",this.opacity="0.5"===n.style.opacity,this.cssFloat=!!n.style.cssFloat,n.style.backgroundClip="content-box",n.cloneNode(!0).style.backgroundClip="",this.clearCloneStyle="content-box"===n.style.backgroundClip,(r=document.createElement("div")).style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",n.innerHTML="",r.appendChild(n),this.boxSizing=""===n.style.boxSizing||""===n.style.MozBoxSizing||""===n.style.WebkitBoxSizing)}return mh(e,[{key:"reliableHiddenOffsets",value:function(){return null==this.pixelPositionVal&&this.computeStyleTests(),this.reliableHiddenOffsetsVal}},{key:"boxSizingReliable",value:function(){return null==this.pixelPositionVal&&this.computeStyleTests(),this.boxSizingReliableVal}},{key:"pixelMarginRight",value:function(){return null==this.pixelPositionVal&&this.computeStyleTests(),this.pixelMarginRightVal}},{key:"pixelPosition",value:function(){return null==this.pixelPositionVal&&this.computeStyleTests(),this.pixelPositionVal}},{key:"reliableMarginRight",value:function(){return null==this.pixelPositionVal&&this.computeStyleTests(),this.reliableMarginRightVal}},{key:"reliableMarginLeft",value:function(){return null==this.pixelPositionVal&&this.computeStyleTests(),this.reliableMarginLeftVal}},{key:"computeStyleTests",value:function(){var e,t,r=this.div;this.docElem&&this.docElem.appendChild(this.container),r.style.cssText="-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",this.pixelPositionVal=this.boxSizingReliableVal=this.reliableMarginLeftVal=!1,this.pixelMarginRightVal=this.reliableMarginRightVal=!0,window.getComputedStyle&&(t=window.getComputedStyle(r),this.pixelPositionVal="1%"!==(t||{}).top,this.reliableMarginLeftVal="2px"===(t||{}).marginLeft,this.boxSizingReliableVal="4px"===(t||{width:"4px"}).width,r.style.marginRight="50%",this.pixelMarginRightVal="4px"===(t||{marginRight:"4px"}).marginRight,(e=r.appendChild(document.createElement("div"))).style.cssText=r.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",e.style.marginRight=e.style.width="0",r.style.width="1px",this.reliableMarginRightVal=!WS((window.getComputedStyle(e)||{}).marginRight),r&&r.removeChild(e)),r.style.display="none",this.reliableHiddenOffsetsVal=0===r.getClientRects().length,this.reliableHiddenOffsetsVal&&(r.style.display="",r.innerHTML="<table><tr><td></td><td>t</td></tr></table>",r.childNodes[0].style.borderCollapse="separate",(e=r.getElementsByTagName("td"))[0].style.cssText="margin:0;border:0;padding:0;display:none",this.reliableHiddenOffsetsVal=0===e[0].offsetHeight,this.reliableHiddenOffsetsVal&&(e[0].style.display="",e[1].style.display="none",this.reliableHiddenOffsetsVal=0===e[0].offsetHeight)),this.docElem&&this.docElem.removeChild(this.container)}}]),e}(),ab=new ob(document),sb=ab.docElem,ub=Et.sizzle,cb=/^margin/,lb=/^(top|right|bottom|left)$/,db=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,fb=new RegExp("^("+db+")(?!px)[a-z%]+$","i"),hb=new RegExp("^("+db+")(.*)$","i");window.getComputedStyle?(nb=function(e){var t,r;return(r=(t=Et.isFunction(e.getEL)?e.getEL():e).ownerDocument.defaultView)&&r.opener||(r=window),r.getComputedStyle(t)},ib=function(e,t,r){var n,i,o,a,s=e.style;return""!==(a=(r=r||nb(e))?r.getPropertyValue(t)||r[t]:undefined)&&a!==undefined||ub.contains(e.ownerDocument,e)||(a=Bb(e,t)),r&&!ab.pixelMarginRight()&&fb.test(a)&&cb.test(t)&&(n=s.width,i=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=r.width,s.width=n,s.minWidth=i,s.maxWidth=o),a===undefined?a:a+""}):sb&&sb.currentStyle&&(nb=function(e){return e.currentStyle},ib=function(e,t,r){var n,i,o,a,s=e.style;return null==(a=(r=r||nb(e))?r[t]:undefined)&&s&&s[t]&&(a=s[t]),fb.test(a)&&!lb.test(t)&&(n=s.left,(o=(i=e.runtimeStyle)&&i.left)&&(i.left=e.currentStyle.left),s.left="fontSize"===t?"1em":a,a=s.pixelLeft+"px",s.left=n,o&&(i.left=o)),a===undefined?a:a+""||"auto"});var gb,pb=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,mb=/<([\w:-]+)/,_b=/^\s+/,vb=/<|&#?\w+;/,yb=/<tbody/i,Ib=/^-ms-/,Sb=/-([\da-z])/gi,Tb=/^(none|table(?!-c[ea]).+)/,bb=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,Cb={position:"absolute",visibility:"hidden",display:"block"},wb={letterSpacing:"0",fontWeight:"400"},Eb=["Top","Right","Bottom","Left"],Ab={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:ab.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},kb=["Webkit","O","Moz","ms"],Pb="abbr|article|aside|audio|bdi|canvas|data|datalist|details|dialog|figcaption|figure|footer|header|hgroup|main|mark|meter|nav|output|picture|progress|section|summary|template|time|video",xb=document.createElement("div");gb=xb.style,ab.cssFloat=!!xb.style.cssFloat;var Db=function(e,t){return t.toUpperCase()},Fb={cssHooks:{},htmlPrefilter:function(e){return e.replace(pb,"<$1></$2>")},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},merge:function(e,t){for(var r=+t.length,n=0,i=e.length;n<r;)e[i++]=t[n++];if(r!=r)for(;t[n]!==undefined;)e[i++]=t[n++];return e.length=i,e},camelCase:function(e){return e.replace(Ib,"ms-").replace(Sb,Db)},cssProps:{},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0}},Wb=["flo","at"].join("");function Rb(e){if(e in gb)return e;for(var t=e.charAt(0).toUpperCase()+Tg(e).call(e,1),r=kb.length;r--;)if((e=kb[r]+t)in gb)return e}function Nb(e,t){for(var r,n,i,o,a,s,u=e.length,c=function(e){var t=Pb.split("|"),r=e.createDocumentFragment();if(r.createElement)for(;t.length;)r.createElement(t.pop());return r}(t),l=[],d=0;d<u;d++)if((n=e[d])||0===n)if("object"===Et.type(n))Fb.merge(l,n.nodeType?[n]:n);else if(vb.test(n)){if(i=i||c.appendChild(t.createElement("div"))){for(o=(mb.exec(n)||["",""])[1].toLowerCase(),s=Ab[o]||Ab._default,i.innerHTML=s[1]+Fb.htmlPrefilter(n)+s[2],r=s[0];r--;)i=i.lastChild;if(!ab.leadingWhitespace&&_b.test(n)){var f=_b.exec(n);f&&f.length>0&&l.push(t.createTextNode(f[0]))}if(!ab.tbody&&(r=(n="table"!==o||yb.test(n)?"<table>"!==s[1]||yb.test(n)?0:i:i.firstChild)&&n.childNodes.length,n))for(;r--;)Fb.nodeName(a=n.childNodes[r],"tbody")&&!a.childNodes.length&&n.removeChild(a);for(Fb.merge(l,i.childNodes),i.textContent="";i.firstChild;)i.removeChild(i.firstChild);i=c.lastChild}}else l.push(t.createTextNode(n));for(i&&c&&c.removeChild(i),d=0;n=l[d++];)"SCRIPT"!==n.tagName&&(ub.contains(n.ownerDocument,n),c.appendChild(n));return i=null,c}Fb.cssProps[Wb]=ab.cssFloat?"cssFloat":"styleFloat";function Ob(e,t,r,n,i){for(var o=r===(n?"border":"content")?4:"width"===t?1:0,a=0;o<4;o+=2)"margin"===r&&(a+=Ub(e,r+Eb[o],!0,i)),n?("content"===r&&(a-=Ub(e,"padding"+Eb[o],!0,i)),"margin"!==r&&(a-=Ub(e,"border"+Eb[o]+"Width",!0,i))):(a+=Ub(e,"padding"+Eb[o],!0,i),"padding"!==r&&(a+=Ub(e,"border"+Eb[o]+"Width",!0,i)));return a}function Mb(e,t,r){var n=!0,i="width"===t?e.offsetWidth:e.offsetHeight,o=nb(e),a=ab.boxSizing&&"border-box"===Ub(e,"boxSizing",!1,o);if(i<=0||null==i){if(((i=ib(e,t,o))<0||null==i)&&(i=e.style[t]),fb.test(i))return i;n=a&&(ab.boxSizingReliable()||i===e.style[t]),i=WS(i)||0}return i+Ob(e,t,r||(a?"border":"content"),n,o)}function Lb(e){return new RegExp("^(?:([+-])=|)("+db+")([a-z%]*)$","i").exec(e)}function Bb(e,t,r,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,a,s=Fb.camelCase(t),u=e.style;if(t=Fb.cssProps[s]||(Fb.cssProps[s]=Rb(s)||s),a=Fb.cssHooks[t]||Fb.cssHooks[s],r===undefined)return a&&"get"in a&&(i=a.get(e,!1,n))!==undefined?i:u[t]+"";"string"===(o=fh(r))&&(i=Lb(r))&&i[1]&&(r=function(e,t,r,n){var i,o=1,a=20,s=n?function(){return n.cur()}:function(){return Ub(e,t,"")},u=s(),c=r&&r[3]||(Fb.cssNumber[t]?"":"px"),l=(Fb.cssNumber[t]||"px"!==c&&+u)&&Lb(Ub(e,t));if(l&&l[3]!==c){c=c||l[3],r=r||[],l=+u||1;do{Bb(e,t,(l/=o=o||".5")+c)}while(o!==(o=s()/u)&&1!==o&&--a)}return r&&(l=+l||+u||0,i=r[1]?l+(r[1]+1)*r[2]:+r[2],n&&(n.unit=c,n.start=l,n.end=i)),i}(e,t,i),o="number"),null!=r&&r==r&&("number"===o&&(r+=i&&i[3]||(Fb.cssNumber[s]?"":"px")),ab.clearCloneStyle||""!==r||0!==Qh(t).call(t,"background")||(u[t]="inherit"),a&&"set"in a&&(r=a.set(e,r,n))===undefined||(u[t]=r))}}function Ub(e,t,r,n){var i,o,a,s=Fb.camelCase(t);return t=Fb.cssProps[s]||(Fb.cssProps[s]=Rb(s)||s),(a=Fb.cssHooks[t]||Fb.cssHooks[s])&&"get"in a&&(o=a.get(e,!0,r)),o===undefined&&(o=ib(e,t,n)),"normal"===o&&t in wb&&(o=wb[t]),""===r||r?(i=WS(o),!0===r||isFinite(i)?i||0:o):o}function Vb(e,t){if(!e||"string"!=typeof e)return[];"boolean"==typeof t&&(t=!1),t=t||document;var r=bb.exec(e);return r?[t.createElement(r[1])]:(r=Nb([e],t),Fb.merge([],r.childNodes))}Et.each(["height","width"],(function(e,t){Fb.cssHooks[e]={get:function(t,r,n){if(r)return Tb.test(Ub(t,"display"))&&0===t.offsetWidth?function(e,t,r,n){var i,o={};return Et.each(t,(function(r,n){o[n]=e.style[n],e.style[n]=t[n]})),i=r.apply(e,n||[]),Et.each(t,(function(t,r){e.style[r]=o[r]})),i}(t,Cb,(function(){return Mb(t,e,n)})):Mb(t,e,n)},set:function(t,r,n){var i=n&&nb(t);return function(e,t,r){var n=hb.exec(t);return n?Math.max(0,Ng(n[1])-(r||0))+(n[2]||"px"):t}(0,r,n?Ob(t,e,n,ab.boxSizing&&"border-box"===Ub(t,"boxSizing",!1,i),i):0)}}}));var Gb,jb=Array.prototype,Hb=Tg(jb),zb=" ",Kb=K.bIE&&K.IEMode<10,Jb=/[\n\t\r\.]/g,Qb=function(){function e(t,r,n){Ft(this,e),this.isNodeList=!0,this.length=0;var i=this;return!t||Et.isString(t)?i:Et.isArray(t)||t.isNodeList?(Array.prototype.push.apply(i,Et.makeArray(t)),i):(i[0]=t,i.length=1,i)}return mh(e,[{key:"item",value:function(t){return Et.isNumber(t)?t>=this.length?null:new e(this[t]):new e(t)}},{key:"slice",value:function(){return new e(Hb.apply(this,arguments))}},{key:"getDOMNodes",value:function(){return Hb.call(this)}},{key:"each",value:function(t,r){var n=this;return Et.each(n,(function(i,o){return i=new e(i),t.call(r||i,i,o,n)})),n}},{key:"getEL",value:function(){return this.length>0?this[0]:undefined}},{key:"all",value:function(t){return this.length>0?Zb(t,this):new e}},{key:"one",value:function(e){var t=this.all(e);return t.length?Tg(t).call(t,0,1):t}},{key:"attr",value:function(e,t){var r=this.getEL();if(r){if(Et.isUndefined(t))return"readonly"===e?r.readOnly?"readonly":"":("style"!==e&&Kb?r=r[e]:(r=r.attributes[e])&&(r=r.value),r);"class"==e?r.className=t:r[e]=t}}},{key:"addClass",value:function(e){var t=this.getEL();t&&function(e,t){var r,n,i,o,a=e.className,s=t.length;if(a){for(r=Yb(a),n=a,i=0;i<s;i++)o=Xb(t[i]),Qh(r).call(r,zb+o+zb)<0&&(n+=zb+o);n=Oh(Et).call(Et,n)}else n=t.join(" ");e.className=n}(t,e.split(zb))}},{key:"removeClass",value:function(e){var t=this.getEL();t&&function(e,t){var r,n,i,o=e.className,a=t.length;if(o&&a){for(r=Yb(o),n=0;n<a;n++)for(i=zb+Xb(t[n])+zb;Qh(r).call(r,i)>=0;)r=r.replace(i,zb);e.className=Oh(Et).call(Et,r)}}(t,e.split(zb))}},{key:"hasClass",value:function(e){var t=this.getEL();if(t)return function(e,t){var r,n,i,o=e.className,a=t.length;if(o&&a){for(r=Yb(o),n=0;n<a;n++)if(i=zb+Xb(t[n])+zb,Qh(r).call(r,i)<0)return B;return L}return B}(t,e.split(zb))}},{key:"parent",value:function(){var t=this.getEL();return t&&(t=t.parentNode),new e(t)}},{key:"remove",value:function(){var e=this.getEL();e&&e.parentNode&&e.parentNode.removeChild(e)}},{key:"offset",value:function(){var e=this.getEL();return Et.DOM.getElDimensions(e,L)}},{key:"before",value:function(e){var t=this.getEL(),r=[e];t&&(qb(e)&&(r=Vb(e)),Et.each(r,(function(e){t.insertBefore(e,t.childNodes[0])})))}},{key:"append",value:function(e){var t=this.getEL(),r=[e];t&&(qb(e)&&(r=Vb(e)),Et.each(r,(function(e){t.appendChild(e)})))}},{key:"html",value:function(e){var t=this.getEL();if(t){if(Et.isUndefined(e))return function(e){var t=e.innerHTML;if(!document.all)return t;var r=/(\s+\w+)\s*=\s*([^<>"\s]+)(?=[^<>]*\/>)/gi,n=/"'([^'"]*)'"/gi;return(t=t.replace(r,'$1="$2"').replace(n,'"$1"')).replace(/<(\/?)(\w+)([^>]*)>/g,(function(e,t,r,n){return t?"</"+r.toLowerCase()+">":("<"+r.toLowerCase()+n+">").replace(/=(("[^"]*?")|('[^']*?')|([\w\-\.]+))([\s>])/g,(function(e,t,r,n,i,o,a,s){return i?'="'+i+'"'+o:e}))})).replace(/<\/?([^>]+)>/g,(function(e){return e}))}(t);t.innerHTML="",Et.each(Vb(e),(function(e){t.appendChild(e)}))}}},{key:"style",value:function(e,t){var r=this.getEL();if(r)return Bb(r,e,t)}},{key:"css",value:function(e){Et.each(this,(function(t){Et.each(e,(function(e,r){Bb(t,r,e)}))}))}}]),e}();function qb(e){return Et.isString(e)&&(e=Oh(Et).call(Et,e))&&e.length>=3&&qS(Et).call(Et,e,"<")&&iS(Et).call(Et,e,">")}function Yb(e){return(zb+e+zb).replace(Jb,zb)}function Xb(e){return e.replace(Jb,"")}function Zb(e,t){var r=t;return r&&r.isNodeList&&(r=r.getEL()),Et.isString(e)?(qb(e)&&Et.error("Err 4002."),new Qb(Et.sizzle(e,r))):e.isNodeList?e:new Qb(e)}function $b(e,t){var r=Zb(e,t);return r.length?Tg(r).call(r,0,1):r}function eC(e){return e instanceof Qb}(Gb=self||{}).Map||(Gb.Map=function(){this.keys=[],this.data={},this.set=function(e,t){var r;null==this.data[e]&&-1==Qh(r=rg(this)).call(r,e)&&rg(this).push(e),this.data[e]=t},this.get=function(e){return this.data[e]}});var tC=new(mh((function rJ(){Ft(this,rJ),this.__ver=20230516,this.Events=HS,this.EnumMouseButton=$S,this.detectButton=eT,this.getWheelDelta=ZS,this.fromUnicode=aT,this.escapeHtml=sT,this.escapeRegExp=uT,this.unEscapeHtml=cT,this.param=RT,this.unparam=NT,this.colorStrToInt=YS,this.IntToColorStr=XS,this.currentStyle=DT,this.parseHTML=Vb,this.css=Ub,this.style=Bb,this.support=ab,this.all=Zb,this.one=$b,this.isNodeList=eC,this.Promise=AT,this.nativePromise=kT,this.loaderBarClassName=OT,this.loaderBarSource=MT,this.createShowMaskContent=LT,this.switchEvent=xT,this.setBackOpacity=eb,this.showMask=tb,this.hideMask=rb,this.dialog=qT,this.mask=YT}))),rC={getHex:function(e){var t=Number(e).toString(16).toUpperCase();return 1==t.length&&(t=["0",t].join("")),t},getColor:function(e){var t,r,n;return n=e>>16,r=(65280&e)>>8,t=255&e,["#",rC.getHex(n),rC.getHex(r),rC.getHex(t)].join("")},RGB2BGR:function(e){return(255&e)<<16|65280&e|e>>16}};function nC(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}rC.BGR2RGB=rC.RGB2BGR;var iC=!1,oC=!0,aC=/[#\/\?@]/g,sC=/[#\?]/g,uC={scheme:1,userInfo:2,hostname:3,port:4,path:5},cC=new RegExp("^(?:([\\w\\d+.-]+):)?(?://(?:([^/?#@]*)@)?([\\w\\d\\-\\u0100-\\uffff.+%]*|\\[[^\\]]+\\])(?::([0-9]+))?)?(.+)?$");function lC(e,t){return Et.isString(e)&&Et.isString(t)?e.toLowerCase()===t.toLowerCase():e===t}function dC(e,t){return encodeURI(e).replace(t,(function(e){return"%"+function(e){return 1===e.length?"0"+e:e}(e.charCodeAt(0).toString(16))}))}var fC,hC=function(){function e(r){if(t(this,e),nC(this,"scheme",""),nC(this,"userInfo",""),nC(this,"hostname",""),nC(this,"port",""),nC(this,"path",""),r instanceof e)return Et.clone(r);e.getComponents(r,this)}return i(e,[{key:"clone",value:function(){var t=new e,r=this;return Et.each(uC,(function(e,n){t[n]=r[n]})),t}},{key:"getScheme",value:function(){return this.scheme}},{key:"setScheme",value:function(e){return this.scheme=e,this}},{key:"getHostname",value:function(){return this.hostname}},{key:"setHostname",value:function(e){return this.hostname=e,this}},{key:"setUserInfo",value:function(e){return this.userInfo=e,this}},{key:"getUserInfo",value:function(){return this.userInfo}},{key:"setPort",value:function(e){return this.port=e,this}},{key:"getPort",value:function(){return this.port}},{key:"setPath",value:function(e){return this.path=e,this}},{key:"getPath",value:function(){return this.path}},{key:"isSameOriginAs",value:function(e){var t=this;return lC(t.hostname,e.hostname)&&lC(t.scheme,e.scheme)&&lC(t.port,e.port)}},{key:"toString",value:function(e){var t,r,n,i,o,a=[],s=this;return(t=s.scheme)&&(a.push(dC(t,aC)),a.push(":")),(r=s.hostname)&&(a.push("//"),(o=s.userInfo)&&(a.push(dC(o,aC)),a.push("@")),a.push(encodeURIComponent(r)),(i=s.port)&&(a.push(":"),a.push(i))),(n=s.path)&&(r&&!Et.startsWith(n,"/")&&(n="/"+n),a.push(dC(n,sC))),a.join("")}}],[{key:"getComponents",value:function(e,t){var r=(e=e||z).match(cC)||[],n=t||{};return Et.each(uC,(function(e,t){n[t]=r[e]})),n}}]),e}(),gC=Et.each,pC=Et.error,mC=Et.isFunction,_C=Et.isString,vC=K.bIE&&K.IEVersion<=9,yC=K.bIE&&K.IEVersion<=10,IC=window,SC=new hC(location.href),TC=SC&&/^(?:about|app|app\-storage|.+\-extension|file|widget)$/.test(SC.getScheme()),bC=!1,CC=function(){try{return new IC.XMLHttpRequest}catch(VV){}},wC=function(){try{var e=iC;return gC(["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.3.0","Msxml3.XMLHTTP"],(function(t){try{if(!e)return e=new IC.ActiveXObject(t),iC}catch(VV){pC("new xhr error: "+VV.message)}})),e}catch(VV){}},EC=!(TC||!IC.XMLHttpRequest)&&"withCredentials"in(CC()||[]),AC=IC.ActiveXObject?function(e){return vC?wC():!TC&&CC()||wC()}:CC,kC=function(e){return bC},PC=/^(?:GET|HEAD)$/,xC=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,DC={xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":"*/*"},FC=fC;yC&&(FC=Et.noop);var WC=function(){function e(){t(this,e),nC(this,"url",!1),nC(this,"onSuccess",!1),nC(this,"onError",!1),nC(this,"onComplete",!1),nC(this,"method","GET"),nC(this,"async",!0),nC(this,"xhrFields",!1),nC(this,"mimeType",!1),nC(this,"username",!1),nC(this,"password",!1),nC(this,"data",!1),nC(this,"dataType","text"),nC(this,"headers",!1),nC(this,"contentType","application/x-www-form-urlencoded; charset=UTF-8"),nC(this,"beforeSend",!1),nC(this,"afterSend",!1),nC(this,"timeout",0),nC(this,"cache",!0),nC(this,"crossDomain",!1),nC(this,"retry",0)}return i(e,[{key:"setRequestHeader",value:function(e,t){this.headers[e]=t}},{key:"getAllResponseHeaders",value:function(){return 2===this.state?this.responseHeadersString:null}},{key:"getNativeXhr",value:function(){return this.nativeXhr}},{key:"getResponseHeader",value:function(e){var t,r;if(e=e.toLowerCase(),2===this.state){if(!(r=this.responseHeaders))for(r=this.responseHeaders={};t=xC.exec(this.responseHeadersString);)r[t[1].toLowerCase()]=t[2];t=r[e]}return t===undefined?null:t}},{key:"overrideMimeType",value:function(e){return this.state||(this.mimeType=e),this}},{key:"abort",value:function(e){return this.state=3,this.status=0,this.statusText=null!=e?e:"abort",this.nativeXhr&&this.nativeXhr.abort(),this._callback(),this}},{key:"_ioReady",value:function(e,t){var r=!1,n=this;if(2!==this.state&&3!==this.state){1===this.state&&(this.state=2),this.readyState=4,e>=200&&e<300||304===e?304===e?(t="not modified",r=!0):(t="success",r=!0):e<0&&(e=0);try{e>=200&&this.handleResponseData()}catch(VV){pC(VV,"error"),t=VV.message||"parser error"}if((e<200||!r)&&this.retry>0)return this.retry=this.retry-1,void setTimeout((function(){n.sendInternal()}),200);this.status=e,this.statusText=t,this._callback(r)}}},{key:"_callback",value:function(e){var t=this,r=this.timeoutTimer;r&&(clearTimeout(r),this.timeoutTimer=0),gC([e?this.onSuccess:this.onError,this.onComplete],(function(e){mC(e)&&e.apply(t.context,[t.responseData,t.statusText,t])})),this.responseData=null}},{key:"handleResponseData",value:function(){var e,t=this.dataType,r=this.nativeXhr;if("blob"===t||"arraybuffer"===t)if(vC){var n,i,o;if("responseBody"in r)n=r.responseBody,i=IC.dsVbsBinGetLength(n),e=new IC.VBArray(IC.dsVbsBinGetBytes(n,0,i)).toArray();else for(e=[],i=(n=r.responseText).length,o=0;o<i;++o)e.push(255&n.charCodeAt(o));n=null}else e=IC.Blob?r.response:"responseBody"in r?r.responseBody:r.responseText;else if("json"==t)e=r.responseType&&"json"==r.responseType.toLowerCase()?r.response:r.responseText?Et.parse(r.responseText):Et.parse(r.response);else if("user-defined"===t)e=r.response!==undefined?r.response:r.responseText;else{this.responseText=e=r.responseText||"";try{var a=r.responseXML;a&&a.documentElement&&(this.responseXML=a)}catch(VV){}}this.responseData=e}},{key:"sendInternal",value:function(e){var t,r,n,i,o,a,s,u,c,l,d,f=this;if(r=(t=this._setup(e)).method,_C(r)&&(r=r.toUpperCase()),o=t.contentType,n=t.url,i=t.dataType,u=t.mimeType,_C(n)&&(this.nativeXhr=a=AC(t.crossDomain),a)){try{if(this.state=1,t.username?a.open(r,n,t.async,t.username,t.password):a.open(r,n,t.async),(t.async||K.bIE)&&i&&"user-defined"!=i&&"responseType"in a)try{a.responseType=i}catch(VV){}}catch(h){return void(this.state<2?(pC(h,"error"),this._ioReady(-1,"open error: "+(Et.isNumber(h.number)?"("+h.number+")":"")+(h.message||""))):pC(h))}"withCredentials"in(s=t.xhrFields||{})&&(EC||delete s.withCredentials),gC(s,(function(e,t){try{a[t]=e}catch(VV){pC(VV)}})),u&&a.overrideMimeType&&a.overrideMimeType(u),!1===(c=t.headers||{})["X-Requested-With"]&&delete c["X-Requested-With"],"setRequestHeader"in a&&(o&&a.setRequestHeader("Content-Type",t.contentType),a.setRequestHeader("Accept",i&&DC[i]?DC[i]+("*"===i?"":", */*; q=0.01"):DC["*"]),gC(c,(function(e,t){a.setRequestHeader(t,e)}))),t.cache||(a.setRequestHeader("If-Modified-Since","0"),a.setRequestHeader("Cache-Control","no-cache")),d=(l=!PC.test(t.method))&&t.data||null,l&&vC&&(d=t.data),t.async&&t.timeout>0&&(t.timeout<300&&(t.timeout=300),this.timeoutTimer=setTimeout((function(){f.abort("timeout")}),t.timeout));try{if(this.state=1,mC(this.beforeSend))if(!1===this.beforeSend(a,f))return void this.abort("cancel");a.send(d),d=null,t.data=null,mC(this.afterSend)&&this.afterSend(f)}catch(VV){this.state<2?(pC(VV,"error"),this._ioReady(-1,"send error: "+(VV.message||""))):pC(VV)}t.async&&4!==a.readyState?a.onreadystatechange=function(){f._xhrCallback()}:f._xhrCallback()}}},{key:"_xhrCallback",value:function(e,t){var r=this.nativeXhr;try{if(4===r.readyState||t)if(kC()||(r.onreadystatechange=FC),t)4!==r.readyState&&r.abort();else{kC()||(this.responseHeadersString=r.getAllResponseHeaders());var n,i=r.status;try{n=r.statusText}catch(VV){pC("xhr statusText error: "),pC(VV),n=""}this._ioReady(i,n)}}catch(VV){pC(VV,"error"),r.onreadystatechange=FC,t||this._ioReady(-1,VV.message||"process error")}}},{key:"_setup",value:function(t){var r,n,i,o,a;if(t){for(n in this.context=t.context,delete t.context,t instanceof e&&(t=t.config),this.config=t,o=t.url,Et.startsWith(o,"//")&&(t.url=o="http:"+o),(Et.startsWith(o,"http://")||Et.startsWith(o,"https://"))&&(a=new hC(o)),r=t.dataType?t.dataType.toLowerCase():"text",t.dataType=r,t.method?t.method=t.method.toUpperCase():t.method="GET",a&&!("crossDomain"in t)&&(t.crossDomain=!a.isSameOriginAs(SC)),i=t.headers)i[n]===fC&&delete i[n];Et.mix(this,t)}return this.state=1,this}},{key:"dispose",value:function(){this.responseHeaders=null,this.responseHeadersString=null,this.responseData=null,this.responseText=null,this.responseXML=null,this.context=null,this.config=null,this.onSuccess=null,this.onError=null,this.onComplete=null,this.xhrFields=null,this.data=null,this.headers=null,this.beforeSend=null,this.afterSend=null}}]),e}();function RC(e){if(e&&_C(e.url)){var t=new WC;return t.sendInternal(e),t}Et.log("the url is error.")}var NC,OC,MC={ErrStr_MODULE_NOT_INSTALLED:"Error: The Dynamic Web TWAIN module is not installed.",ErrStr_BROWSER_NOT_SUPPORT:"Error: This browser is currently not supported.",ErrStr_CreateID_MustNotInContainers:"Error: Duplicate ContainerId detected while creating a Dynamic Web TWAIN object.",ErrStr_CreateID_WebTwainIdDuplicated:"Error: Duplicate ID detected while creating a Dynamic Web TWAIN object.",ErrStr_CreateID_NotContainer:"Error: The ID of the target DIV for the new DWT object is invalid."},LC="Checking WebTwain version ...",BC="18",UC="4",VC="1110",GC="4",jC="".concat(BC,",").concat(UC,",").concat("2",",").concat(VC),HC="".concat(BC,",").concat(GC,",").concat("2",",").concat("1110"),zC=parseInt(BC),KC=parseInt(UC),JC=parseInt("2"),QC=[zC,KC,JC,VC],qC=[zC,KC,JC,VC],YC=[zC,KC,JC,VC],XC=[1,8,4,VC],ZC=[1,8,4,VC],$C=[1,8,4,VC];function ew(){if(K.bWin);else{if(K.bMac)return qC;if(K.bLinux)return YC}return QC}function tw(){if(K.bWin);else{if(K.bMac)return ZC;if(K.bLinux)return $C}return XC}function rw(){return"dcp/dwasm2_"+nw()}function nw(){return ew().join("")}function iw(){var e=xt.DWT.ServiceInstallerLocation;return Et.isString(e)&&e.length>0?("/"!=e[e.length-1]&&(e+="/"),e):(e=xt.DWT.ResourcesPath,Et.isString(e)&&e.length>0?"/"!=e[e.length-1]&&(e+="/"):e="Resources/",e+"dist/")}!function(e){e.enumUnknown=-1,e.enumChrome=1,e.enumFirefox=2,e.enumEdge=3,e.enumSafari=4,e.enumIE=5,e.enumOpera=6,e.enumHuaWeiBrowser=7}(NC||(NC={})),function(e){e.enumUnknown=-1,e.enumWindow=0,e.enumMac=1,e.enumLinux=2,e.enumEmbed=3,e.enumChromeOS=4,e.enumHarmonyOS=5,e.enumAndroid=6,e.enumiOS=7}(OC||(OC={}));var ow,aw={getDSPath:function(e){var t=iw(),r=e;return r||(r=K.bWin?".msi":K.bMac?".pkg":xt.navInfo.bArm64?"-arm64.deb":xt.navInfo.bMips64?"-mips64el.deb":xt.navInfo.bAndroid?".apk":K.bLinux||K.bChromeOS||K.bHarmonyOS?".deb":".msi"),[t,"DynamsoftServiceSetup",r].join("")},getLinuxHTML5DebPath:function(){return aw.getDSPath(".deb")},getLinuxHTML5RpmPath:function(){return aw.getDSPath(".rpm")},getEnumPlatform:function(){return K.bAndroid?OC.enumAndroid:K.bMac?OC.enumMac:K.bChromeOS?OC.enumChromeOS:K.bHarmonyOS?OC.enumHarmonyOS:xt.navInfo.bEmbed?OC.enumEmbed:K.bLinux?OC.enumLinux:K.biPhone||K.biPad?OC.enumiOS:OC.enumWindow},getEnumBrowser:function(){return K.bEdge?NC.enumEdge:K.bChrome?NC.enumChrome:K.bFirefox?NC.enumFirefox:K.bIE?NC.enumIE:K.bSafari?NC.enumSafari:K.bHuaWeiBrowser?NC.enumHuaWeiBrowser:K.bOpera?NC.enumOpera:NC.enumUnknown}},sw=K.bAndroid?"local.dynamsoft.com":"127.0.0.1";ow="Dynamic Web TWAIN 18.4.2";var uw={JSVersion:"18,4,2,1110",ServerVersionInfo:"18,4,2,1110",ServerLinuxVersionInfo:"18,4,2,1110",ServerMacVersionInfo:"18,4,2,1110",ActiveXVersion:"18,4,2,1212",ActiveXPdfVersion:"11.5.1.0926",PdfVersion:"11.5.1.0926",PdfLinuxVersion:"11.5.1.0926",PdfMacVersion:"11.5.1.0926"},cw={ProductName:ow,Containers:undefined,ContainerMap:{},WebTwainIdMap:{},RemoteScanIdMap:{},Trial:!1,ResourcesPath:"Resources",Debug:!1,IfUpdateService:!1,AutoLoad:!0,ReConnectToService:!0,OnWebTwainReady:!1,OnWebTwainNotFound:!1,OnWebTwainOldPluginNotAllowed:!1,OnWebTwainNeedUpgrade:!1,OnWebTwainNeedUpgradeWebJavascript:!1,OnWebTwainInitMessage:!1,ViewerJSIntegerited:!0,ActiveXInstallWithCAB:!1,IfUseActiveXForIE10Plus:!1,IfUseEmbeddedDownloadNoticeForActiveX:!1,IfCheckDCP:!1,IfDisableDefaultSettings:!1,OnWebTwainWillInit:!1,IfAddMD5InUploadHeader:!1,IfAlwaysFocusOnPopupWindow:!0,IfConfineMaskWithinTheViewer:!1,fetchOptions:{mode:"cors",credentials:"same-origin"},HideTrialMessage:!1,CheckCertExpired:!0,ConnectWithSocket:!1,SSLPort:18623,Port:18622,showLoadingMsgDialog:!0,licenseServer:undefined,sessionPassword:undefined,organizationID:undefined,handshakeCode:undefined,UseDefaultViewer:!0,Host:sw};function lw(){var e=xt.DWT.Host;return Et.isString(e)&&""!=e||(xt.DWT.Host=e=sw),e}function dw(){var e=300,t=xt.DWT.RemoteScanConfig;return t&&Et.isNumber(t.sessionTimeout)&&t.sessionTimeout>0&&(e=t.sessionTimeout),e}var fw={URL:"",UpdateDaysBeforeExpired:30},hw=!0,gw=!1,pw=K.bHTML5Edition,mw=0,_w=gw;K.bIE&&(""===(mw=K.IEVersion)||mw>=10?xt.DWT.IfUseActiveXForIE10Plus?(pw=gw,_w=hw,K.bHTML5Edition=pw):pw=hw:(pw=gw,mw>=9&&(_w=hw))),_w||pw||(pw=hw);var vw,yw,Iw,Sw,Tw={SSLPort:18626,Port:18625,bEnhancedMode:!1,oldDWASMVerStr:"dwasm_13000404",oldDWASMVer:[13,0,0,"0404"],wsProtocol:"dwt_command",managerVersion:QC,managerVersionMac:qC,managerVersionLinux:YC,serviceVersion:XC,serviceVersionMac:ZC,serviceVersionLinux:$C,detect:{dcpStatus:0,ddmPort:0,dwtPort:0,bConnected:!1,connectedResult:"",MaxManagerModuleConnectCount:1,EnumDCP_DetectStatus:{Init:0,Connected:1,CheckingManagerVer:15,CheckingServiceVer:16,NotInstalled:17,CheckedService:5,VerifyingZip:6,VerifiedZip:7,UpdatingService:8,UpdateSucceed:9,UpdateFailed:10,UpdateSkipped:11}},strSID:"",b64bit:!0,currentUserPorts:{},objEnhancedPorts:{}},bw={name:"Dynamic Web TWAIN",bHTML5Edition:pw,bActiveXEdition:_w,_iImageCaptureDriverType:3,_iBrokerProcessType:1,getChromeEditionPath:aw.getDSPath,getPKGPath:function(){return iw()+"DynamicWebTWAINMacEdition.pkg"},getMSIPath:function(){return iw()+"DynamicWebTWAINPlugIn.msi"},getActiveXCABx86Path:function(){return iw()+"DynamicWebTWAIN.cab"},getActiveXCABx64Path:function(){return iw()+"DynamicWebTWAINx64.cab"},onlineResources:"https://demo.dynamsoft.com/DWT/Resources/",strMIMEType:"Application/DynamicWebTwain-Plugin",strFullClassID:"E7DA7F8D-27AB-4EE9-8FC0-3FEC9ECFE758",scripts:{},dwtConfigLoaded:!1,dwtConfigLoading:!1,getServerVersionInfo:function(e){var t=uw.ServerVersionInfo;return K.bWin||(K.bMac?t=uw.ServerMacVersionInfo:(K.bLinux||K.bAndroid||K.bChromeOS||K.bHarmonyOS)&&(t=uw.ServerLinuxVersionInfo)),e?t:Et.replaceAll(t,",","")},getDWTPrefix:function(){return!0===xt.DWT.CustomMode?"dwtc_":"dwt_"},loadResourcePath:!1,loadingResourcePath:!1,handshakeCode:undefined,organizationID:undefined,licenseServer:undefined,sessionPassword:"",bPublicLTS:!0,refProductKey:undefined,ltsDebug:!1,bDWTLoading:!1,bAndroidConnected:!1,unloadQueue:[],appendBrowserLicenseWhenServiceMode:function(){},bChromeEdition:pw},Cw={bFullEdition:!1,getVersionStrForCheck:function(){return"".concat(BC,"000000")},versionInfoFromServer:"",hostForCheckCert:"127.0.0.1",RemoteReconnectMaxTimes:200,RemoteReconnectTimeSpan:5e3,LocalReconnectMaxTimes:60,LocaleReconnectTimeSpan:3e3},ww=K.bSSL?3e3:1e3;function Ew(){return Et.isString(bw.handshakeCode)||Et.isString(bw.organizationID)||bw.bPublicLTS||Et.isString(xt.DWT.ProductKey)&&Et.startsWith(xt.DWT.ProductKey,"DLS2")}function Aw(e){return e===undefined||e&&("127.0.0.1"===e||"localhost"===e||"local.dynamsoftwebtwain.com"===e||"local.dynamsoft.com"===e)}function kw(e,t,r){e._errorCode=t,e._errorString=r}function Pw(e){var t=xt.DWT.licenseException;t.code=e._errorCode,t.message=e._errorString,t.fromLTS=!1}function xw(){return xt.DWT.bChromeExtension?"":"Please contact the site administrator."}function Dw(e){kw(e,-1033,"Invalid index.")}function Fw(e){kw(e,-1034,"Invalid value.")}function Ww(e){kw(e,-1035,"There is no image.")}function Rw(e){kw(e,-1110,"Unrecognized file extension.")}function Nw(e){kw(e,-2007,"The system is busy, some operations are not completed. Please try later.")}function Ow(e,t){var r=t?["[",t,"]"].join(""):"your device";kw(e,yw.MustUpgrade,"The Dynamsoft Service installed on "+r+" is outdated and no longer works with the JavaScript code on the website.")}function Mw(e){kw(e,-2209,"The HTML5 edition does not support this method or property.")}function Lw(e){kw(e,-2300,"Http upload error: the HTTP Server name/ip cannot be empty.")}function Bw(e){kw(e,-2301,"Network error.")}function Uw(e){kw(e,-2302,"The result format is invalid.")}function Vw(e,t,r,n){if(t)kE(e);else if(e._errorCode=-2003,n&&n>0||r){var i=["HTTP process error: "];r&&(r.indexOf("HTTP process error: ")>=0&&(i=[""]),i.push(r)),n&&n>0&&i.push(" ("+n+")");var o=i.toString().lastIndexOf(".");o>=0&&o==i.toString().length-1?e._errorString=i.join(""):e._errorString=i.join("")+"."}else e._errorString="HTTP process error."}function Gw(e){kw(e,-2304,"Http download error: the url is invalid.")}function jw(e,t,r,n){if(t)kw(e,-2305,"User cancelled the operation.");else if(e._errorCode=-2003,n&&n>0||r){var i=["HTTP put error: "];r&&(r.indexOf("HTTP put error: ")>=0&&(i=[""]),i.push(r));var o=i.toString().lastIndexOf(".");o>=0&&o==i.toString().length-1?e._errorString=i.join(""):e._errorString=i.join("")+"."}else e._errorString="HTTP put error."}function Hw(e,t,r,n){if(t)kw(e,-2305,"User cancelled the operation.");else if(e._errorCode=-2003,n&&n>0||r){var i=["HTTP process error: "];r&&(r.indexOf("HTTP process error: ")>=0&&(i=[""]),i.push(r));var o=i.toString().lastIndexOf(".");o>=0&&o==i.toString().length-1?e._errorString=i.join(""):e._errorString=i.join("")+"."}else e._errorString="HTTP process error."}function zw(e){kw(e,-2306,"Upload Error: the upload file cannot be empty.")}function Kw(e){kw(e,-2307,"The width or height you entered is invalid.")}function Jw(e){kw(e,-2313,"The size of the images you are about to upload has exceeded the limit.")}function Qw(e){kw(e,-2314,"The parameter cannot be empty.")}function qw(e){kw(e,-2320,"Invalid file.")}function Yw(e){kw(e,vw.LicenseInvalid,Ew()?"The license is invalid.":"The current product key is empty or invalid."),Pw(e)}function Xw(e,t){e._errorCode=vw.LicenseExpired;var r="";if(t&&""!=t&&(-1==t.indexOf("on")&&(r=" on "+t),e.__licenseInfo&&(e.__licenseInfo.ExpireDate=t)),Ew()){var n,i,o,a;if(n=xt.DWT.EnumInstance.dwt_desktop,e._bRemoteMode)i=null!==(o=null===(a=e._dmService)||void 0===a||null===(a=a.attrs)||void 0===a?void 0:a.UUID)&&void 0!==o?o:"";else i="";e._errorString="The license has expired"+r+".",xt.DWT.lcexp(n,i).then((function(){e._errorString=xt.DWT.licenseException.message}))}else e._errorString="The current product key has expired"+r+". "+xw(),Pw(e)}function Zw(e,t,r){Ew()?t?111==r?(e._errorCode=vw.LicenseExpiredForDLS,e._errorString="The license for v"+BC+" WebAssembly Core Module has expired."):(e._errorCode=vw.LicenseNoCoreForDLS,e._errorString="The license for v"+BC+" WebAssembly Core Module is not found."):111==r?(e._errorCode=vw.LicenseExpiredForDLS,e._errorString="The license for v"+BC+" Service Core Module has expired."):(e._errorCode=vw.LicenseNoCoreForDLS,e._errorString="The license for v"+BC+" Service Core Module is not found."):(e._errorCode=vw.LicenseNoCore,e._errorString=t?"The current product key is missing the WebAssembly Core license. "+xw():"The current product key is missing the Service Core license. "+xw()),Pw(e)}function $w(e){e._errorCode=-2339,Ew()?e._errorString="The license for the module pdf rasterizer is not found or has expired.":e._errorString="The current product key does not support pdf rasterizer. "+xw(),Pw(e)}function eE(e){kw(e,-2350,"The indices cannot be empty.")}function tE(e){kw(e,-2351,"You cannot upload more than one image when the format is BMP, JPG or PNG")}function rE(e){kw(e,-2352,"The indices are out of range.")}function nE(e){kw(e,-2353,"The header name being used is a protected keyword and is not allowed.")}function iE(e){kw(e,-2358,"The type of the parameter indices must be an Array.")}function oE(e){kw(e,-2359,"The index is out of range.")}function aE(e){kw(e,-2360,"The index is null or undefined.")}function sE(e){kw(e,-2362,"The image type is not supported.")}function uE(e){kw(e,-2363,"The data format is not supported.")}function cE(e){kw(e,-2365,"The url is invalid.")}function lE(e){kw(e,-2376,"The generate url failed.")}function dE(e){kw(e,-2377,"Failed to set Image Capture Driver Type.")}function fE(e){kw(e,-2391,"Invalid event name.")}function hE(e){kw(e,-2393,"Failed to convert the data to blob.")}function gE(e){kw(e,-2416,"Invalid parameter.")}function pE(e){kw(e,-2426,"You have used a full license with a trial license which is not permitted. Please check and update Dynamsoft.DWT.ProductKey.")}function mE(e){kw(e,-2510,"The callback is not a function.")}function _E(e){kw(e,-2513,"The WebTwain instance has been destroyed and can not be used anymore.")}function vE(e){kw(e,-2530,"Document name cannot be empty.")}function yE(e){kw(e,-2531,"Document name is not a string.")}function IE(e){kw(e,-2548,"You cannot call this function when Dynamsoft.DWT.UseDefaultViewer is set to false.")}function SE(e){kw(e,-2549,"You cannot call this function when there is no ui binding.")}function TE(e){kw(e,0,"")}function bE(e){var t=e;return t||(t="[]"),{code:-2601,message:"Failed to connect to the Dynamsoft Service on "+t+". Please make sure Dynamsoft Service is running or the certificate is valid."}}function CE(e){var t;return e._bRemoteMode?bE(null===(t=e._dmService)||void 0===t||null===(t=t.attrs)||void 0===t?void 0:t.name).message:"The Dynamsoft Service has been stopped."}function wE(e){kw(e,-2607,"The device selected was not found under the current service object.")}function EE(e){kw(e,-2608,"IfShowFileDialog cannot be set to true when Object is created by CreateRemoteScanObjectAsync.")}function AE(e,t){Et.isString(t)&&""!=t?kw(e,yw.RemoteDynamsoftServiceStopped,"The Dynamsoft Service on ["+t+"] has been stopped."):kw(e,-2308,"The Dynamsoft Service has been stopped.")}function kE(e){kw(e,-2615,"User cancelled the operation.")}function PE(e){kw(e,-2616,"Invalid image format type.")}function xE(e){kw(e,-2618,"Only single index selection is allowed when enumImageType is set to BMP, JPG or PNG.")}function DE(e){kw(e,-2620,"The RemoteScan object has been disposed.")}function FE(e){kw(e,-2621,"Dynamsoft.DWT.Containers was not set.")}function WE(e){kw(e,-2622,'Please do not set enumImageType to "IT_MULTIPAGE_PDF", "IT_MULTIPAGE_TIF" or "IT_ALL".')}function RE(e){kw(e,-2800,"Please make sure the Dynamsoft Service has been installed.")}function NE(e){kw(e,yw.ResponseDataTypeError,"Invalid response data was returned from the Dynamsoft Service.")}function OE(e,t){kw(e,-2811,t)}function ME(e){kw(e,-2812,MC.ErrStr_CreateID_WebTwainIdDuplicated)}function LE(e){kw(e,-2814,MC.ErrStr_MODULE_NOT_INSTALLED)}function BE(e){kw(e,-2815,MC.ErrStr_CreateID_MustNotInContainers)}function UE(e,t,r){kw(e,-2816,["HTTP process error: ",r," (",t,")."].join(""))}function VE(){return{code:yw.HTSTError,message:"The Connection from the insecure (HTTP) web page failed for HTST."}}function GE(e){return{code:-2826,message:"Failed to connect the Dynamsoft Service on ["+e+"]."}}function jE(e){kw(e,-2828,"Invalid PDF Convert Mode Value.")}function HE(e){var t=e,r=t.lastIndexOf("/");r>=0&&(t=t.substr(r+1));var n=t.indexOf("?");return n>0&&(t=t.substr(0,n)),{code:-2835,message:['Failed to load CSS file "',t,'".'].join("")}}function zE(e){return-1416==e}function KE(e){kw(e,-2901,"Source document does not exist. Please check the document name or create the document before performing this operation.")}function JE(e){kw(e,-2902,"Target document does not exist. Please check the document name or create the document before performing this operation.")}!function(e){e.LicenseInvalid=-2325,e.LicenseExpired=-2326,e.LicenseParseFailed=-2546,e.LicenseExpiredForDLS=-2808,e.LicenseNoCoreForDLS=-2809,e.LicenseNoCore=-2810,e.LicenseIsFuture=-2396,e.LicenseVersionNotCurrent=-2539}(vw||(vw={})),xt.DWT.EnumDWT_LicenseErrorCode=vw,function(e){e.UserCancelled=-1032,e.CommonError=-2201,e.ModuleNotExists=-2371,e.MustUpgrade=-2207,e.RemoteDynamsoftServiceStopped=-2613,e.ResponseDataTypeError=-2801,e.HTSTError=-2817,e.CORSError=-2820,e.EnhancedPortNotReady=-2821,e.HTTPRedirected=-2823,e.BboError=-2827}(yw||(yw={}));var QE=K.bIE&&K.IEVersion<=9;Iw=self&&self.fetch?self.fetch:window.fetch;var qE=0;function YE(e,t){var r,n=!1;return qE=t,Iw?r=function(r,i){var o=!1,a="text",s=!1;if(i&&(i.dataType&&(a=i.dataType),i.fetchRaw&&(s=!0),i.timeout)){var u=i.timeout;u<300&&(u=300);var c=new AbortController;i.signal=c.signal,setTimeout((function(){o||c.abort()}),u)}n=!1;var l=Iw(r,i).then((function(r){if(r.ok){var i,a;if(o=!0,!e)return r;e.IfShowCancelDialogWhenImageTransfer?(ZE(!0),a=e.on("cancel",(function(){n=!0}))):ZE(!1);var s=r.headers.get("Content-Length"),u=0;e._onPercent&&qE==t&&e._onPercent({loaded:u,total:s});var c=null==r||null===(i=r.body)||void 0===i?void 0:i.getReader(),l=new ReadableStream({start:function(r){c?setTimeout((function i(){return c.read().then((function(o){if(o.done||n)return n?c.cancel():a&&e.off("cancel",a),r.close(),void(a=null);var l=o.value;u+=l.length,e._onPercent&&qE==t&&e._onPercent({loaded:u,total:s});try{return r.enqueue(l),i()}catch(d){Et.error(d)}}))}),0):r.close()}}),d=r.headers.get("Content-Type");return d&&""!=d||(d="application/octet-stream"),new Response(l,{headers:{"Content-Type":d}})}if("opaqueredirect"==r.type)throw{code:yw.HTTPRedirected,message:"The http url redirected."};var f;throw UE(f={},r.status,r.statusText),{code:f._errorCode,message:f._errorString,httpCode:r.status}}));return s?l:(l="blob"==a?l.then((function(e){var t=e.headers.get("content-type");return"text/json"==t?e.json():K.bLinux?e.arrayBuffer().then((function(e){return new Blob([e],{type:t})})):e.blob()})):"json"==a?l.then((function(e){return e.json()})):"arraybuffer"==a?l.then((function(e){return"text/json"==e.headers.get("content-type")?e.json():e.arrayBuffer()})):l.then((function(e){return e.text()}))).then((function(e){var t;if(n)throw kE(t={}),{code:t._errorCode,message:t._errorString};return e}))}:(QE&&Et.addVBS(["Function dsVbsBinGetAt(strBinary,iOffset)\r\n"," dsVbsBinGetAt=AscB(MidB(strBinary,iOffset+1,1))\r\n","End Function\r\n","Function dsVbsBinGetBytes(strBinary,iOffset,iLength)\r\n"," Dim aBytes()\r\n"," ReDim aBytes(iLength-1)\r\n"," For i=0 To iLength-1\r\n","  aBytes(i)=dsVbsBinGetAt(strBinary,iOffset+i)\r\n"," Next\r\n"," dsVbsBinGetBytes=aBytes\r\n","End Function\r\n","Function dsVbsBinGetLength(strBinary)\r\n"," dsVbsBinGetLength=LenB(strBinary)\r\n","End Function"].join("")),r=function(r,n){return new(bt.nativePromise||window.Promise)((function(i,o){var a,s=!1;a={url:r,async:!0,onSuccess:function(e,t,r){var n=!1;r.responseHeadersString&&(-1!=r.responseHeadersString.indexOf("text/json")&&(Et.isArray(e)||e instanceof ArrayBuffer)&&(n=!0));if(n){var o=e;e instanceof ArrayBuffer&&(o=new Uint8Array(e));var a=String.fromCharCode.apply(null,o);i(a)}else i(e)},onError:function(e,t,r){var n;UE(n={},r.status,t),o({code:n._errorCode,message:n._errorString,httpCode:r.status})},dataType:"text",method:Sw,data:Sw,headers:Sw,contentType:Sw,mimeType:Sw},n&&(n.method&&(a.method=n.method),n.body&&(a.data=n.body),n.headers&&(a.headers||(a.headers={}),Et.each(n.headers,(function(e,t){"content-type"==t.toLowerCase()&&(s=!0),a.headers[t]=e}))),n.dataType&&(a.dataType=n.dataType),n.contentType&&(a.contentType=n.contentType),Et.isNumber(n.timeout)&&n.timeout>0&&(a.timeout=n.timeout)),s&&(a.contentType=!1),"blob"==a.dataType&&QE&&(a.mimeType="text/plain; charset=x-user-defined"),e&&(e._onPercent&&(a.beforeSend=function(r,n,i){r.upload.addEventListener("progress",(function(r){e._onPercent&&qE==t&&e._onPercent(r)}),!1)}),e.IfShowCancelDialogWhenImageTransfer?ZE(!0):ZE(!1));var u=RC(a);e&&e.IfShowCancelDialogWhenImageTransfer&&e.on("cancel",(function(){u.abort()}))}))}),r}var XE=YE(null,0);function ZE(e){var t=Et.sizzle(".dynamsoft-btnCancel");if(t.length>0){var r=t[0];r.style.display=e?"":"none"}}function $E(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(pC){return void r(pC)}s.done?t(u):Promise.resolve(u).then(n,i)}function eA(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){$E(o,n,i,a,s,"next",e)}function s(e){$E(o,n,i,a,s,"throw",e)}a(undefined)}))}}String.prototype.startsWith||(String.prototype.startsWith=function(e){return 0==this.indexOf(e)});var tA,rA,nA=function(e){var t,r=e,n=r._license||"",i=JSON.parse(JSON.stringify(r._licenseServer)),o=r._sessionPassword,a=0;if(n.startsWith("t")||n.startsWith("f"))a=0;else if(0===n.length||n.startsWith("P")||n.startsWith("L")||n.startsWith("Y")||n.startsWith("A"))a=1;else{a=2;var s=n.indexOf(":");if(-1!=s&&(n=n.substring(s+1)),n.startsWith("DLS2")){var u;try{var c=n.substring(4);c=Dynamsoft.Lib.atob(c),u=JSON.parse(c)}catch(d){throw new Error("Format Error: The license string you specified is invalid, please check to make sure it is correct.")}if("number"==typeof(n=u.handshakeCode?u.handshakeCode:u.organizationID?u.organizationID:"")&&(n=JSON.stringify(n)),0===i.length){var l=[];u.mainServerURL&&(l[0]=u.mainServerURL),u.standbyServerURL&&(l[1]=u.standbyServerURL),i=function(e){if(null==e)e=[];else{e instanceof Array||(e=[e]);for(var t=0;t<e.length;++t){if(document&&document.createElement){var r=document.createElement("a");r.href=e[t],e[t]=r.href}e[t].lastIndexOf("/")!=e[t].length-1&&(e[t]+="/")}}return e}(l)}!o&&u.sessionPassword&&(o=u.sessionPassword),t=u.remark}("200001"===n||n.startsWith("200001-"))&&(i&&i.length||(n="")),n||(a=1)}return 1===a&&(n=""),{lt:a,l:n,ls:i,sp:o,rmk:t}},iA=i((function nJ(e,r,n,i,o){t(this,nJ),this.server=e,this.port=r,this.ssl=n,this.useWS=i,this.protocol=o}));function oA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aA(e,t){return aA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},aA(e,t)}function sA(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aA(e,t)}function uA(t,r){if(r&&("object"===e(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return oA(t)}function cA(e){return cA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},cA(e)}!function(e){e.OK=0,e.Custom=-1,e.NWB=-4200,e.WS_DISCONN=-4201,e.CB=-5e3,e.JSON_REQUIRED=-5001,e.OBJECT_DISPOSED=-5002,e.INVALID_TASK=-5003,e.OBJECT_DISPOSING=-5004}(tA||(tA={})),function(e){e.WS_DISCONN="The Web Socket connection failed.",e.JSON_REQUIRED="The input is not a JSON object or JSON styled string.",e.OBJECT_DISPOSED="The object has been disposed.",e.INVALID_TASK="The task is invalid.",e.OBJECT_DISPOSING="The object need to be disposed."}(rA||(rA={}));var lA=function(){function e(){t(this,e)}return i(e,null,[{key:"message",value:function(e){return this._errorMessage[e]}},{key:"init",value:function(){this._errorMessage[tA.OK]="Successful.",this._errorMessage[tA.WS_DISCONN]=rA.WS_DISCONN,this._errorMessage[tA.JSON_REQUIRED]=rA.JSON_REQUIRED,this._errorMessage[tA.OBJECT_DISPOSED]=rA.OBJECT_DISPOSED,this._errorMessage[tA.INVALID_TASK]=rA.INVALID_TASK,this._errorMessage[tA.OBJECT_DISPOSING]=rA.OBJECT_DISPOSING}}]),e}();nC(lA,"_errorMessage",Object.create(null)),lA.init();var dA,fA=function(){function e(r,n){t(this,e),nC(this,"_code",tA.OK),this.name="DSError",this.message=null!=n?n:"string"==typeof r?r:lA.message(r),this._code="string"==typeof r?tA.Custom:r}return i(e,[{key:"code",get:function(){return this._code}}]),e}();function hA(e){return{code:e._errorCode,message:e._errorString}}function gA(e){return"exception"in e&&"description"in e&&0!=e.exception&&""!=e.description}!function(e){e.NONE=0,e.TRACE=1,e.DEBUG=2,e.INFO=4,e.WARN=8,e.ERROR=16}(dA||(dA={}));var pA,mA=Et.getLogger(),_A=function(){function e(){t(this,e)}return i(e,null,[{key:"LogLevel",get:function(){return this._logLevel},set:function(e){this._logLevel=e}},{key:"LogFunc",set:function(e){this._logFunc=e}},{key:"all",value:function(e,t){if((this._logLevel&e)==e)if(this._logFunc)this._logFunc(t,e);else switch(e){case dA.DEBUG:mA.debug(t);break;case dA.ERROR:mA.error(t);break;case dA.INFO:mA.info(t);break;case dA.WARN:mA.warn(t);break;case dA.TRACE:mA.trace(t)}}},{key:"trace",value:function(e){this.all(dA.TRACE,e)}},{key:"debug",value:function(e){this.all(dA.DEBUG,e)}},{key:"info",value:function(e){this.all(dA.INFO,e)}},{key:"warn",value:function(e){this.all(dA.WARN,e)}},{key:"error",value:function(e){this.all(dA.ERROR,e)}}]),e}();function vA(e){window.console&&(e instanceof Error||Et.isString(e)?window.console.error(e):window.console.error(Et.stringify(e)))}nC(_A,"_logLevel",dA.ERROR),nC(_A,"_logFunc",undefined),function(e){e.GET_TASKID=0,e.GET_EVENT_TASKID=1,e.ONMESSAGE_PROCESS_DATA=2,e.ONMESSAGE_GET_TASKID=3,e.ONMESSAGE_GET_EVENT_TASKID=4,e.HANDLE_RAW_MESSAGE=5,e.HANDLE_PROCESSED_MESSAGE=6}(pA||(pA={}));var yA=function(){function e(r){t(this,e),nC(this,"_serverInfo",undefined),nC(this,"_disposed",!1),this._serverInfo=r,this._ref=1}var r,n;return i(e,[{key:"serverInfo",get:function(){return this._serverInfo}},{key:"requestSync",value:function(e,t){return _A.error("requestSync should be implemented in child class"),undefined}},{key:"request",value:function(){var e=eA(g.mark((function t(e,r,n,i){return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _A.error("request should be implemented in child class"),e.abrupt("return",null);case 2:case"end":return e.stop()}}),t)})));return function(t,r,n,i){return e.apply(this,arguments)}}()},{key:"send",value:(n=eA(g.mark((function o(e,t,r){return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:_A.error("reqsenduestSync should be implemented in child class");case 1:case"end":return e.stop()}}),o)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"testConnection",value:(r=eA(g.mark((function a(e,t,r,n){return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _A.error("testConnection should be implemented in child class"),e.abrupt("return");case 2:case"end":return e.stop()}}),a)}))),function(e,t,n,i){return r.apply(this,arguments)})},{key:"disposed",get:function(){return this._disposed}},{key:"dispose",value:function(){if(this._ref--,this._ref>0)return!1;this._disposed=!0,this._terminate()}},{key:"_terminate",value:function(){}},{key:"addRef",value:function(){this._ref++}}]),e}();function IA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(VV){return!1}}();return function(){var r,n=cA(e);if(t){var i=cA(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return uA(this,r)}}function SA(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function TA(e,t,r){if(!t.has(e));return r}var bA,CA=Et.getLogger(),wA=new WeakSet,EA=new WeakSet,AA=function(e){sA(a,e);var r,n,o=IA(a);function a(){var e;t(this,a);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return SA(oA(e=o.call.apply(o,[this].concat(n))),EA),SA(oA(e),wA),e}return i(a,[{key:"send",value:(n=eA(g.mark((function s(e,t,r){return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:CA.error("HTTP Client send not supported");case 1:case"end":return e.stop()}}),s)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"requestSync",value:function(e,t,r){return undefined}},{key:"request",value:function(e,t,r,n){return TA(this,EA,PA).call(this,e,t,r,undefined,undefined,n)}},{key:"testConnection",value:(r=eA(g.mark((function u(e,t,r,n){return g.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",TA(this,EA,PA).call(this,undefined,undefined,e,t,r,n));case 1:case"end":return i.stop()}}),u,this)}))),function(e,t,n,i){return r.apply(this,arguments)})}]),a}(yA);function kA(e){var t=this.serverInfo,r="";return r=t.ssl?"https://":"http://",r+=t.server,t.port&&(r+=":",r+=t.port),e&&(Et.startsWith(e,"/")||Et.endsWith(r,"/")||(r+="/"),Et.endsWith(e,"/")?r+=e.slice(0,-1):r+=e),r}function PA(e,t,r,n,i,o){return xA.apply(this,arguments)}function xA(){return xA=eA(g.mark((function e(t,r,n,i,o,a){var s,u;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=null!=n?n:{},t&&(s.body=t),s.method||(s.method="POST"),a&&(s.timeout=a),u=TA(this,wA,kA).call(this,r),CA.debug("HTTP URL: "+u),e.next=9,XE(u,s);case 9:return e.abrupt("return",e.sent);case 12:if(e.prev=12,e.t0=e["catch"](0),!(e.t0 instanceof fA||e.t0&&e.t0.code&&e.t0.message)){e.next=18;break}throw e.t0;case 18:if(!e.t0.message){e.next=20;break}throw new fA(e.t0.message);case 20:case"end":return e.stop()}}),e,this,[[0,12]])}))),xA.apply(this,arguments)}function DA(t){try{return"object"===e(t)?t:(t="string"!=typeof t?Et.stringify(t):t,Et.parse(t))}catch(r){throw r instanceof fA?r:new fA(tA.JSON_REQUIRED)}}function FA(e){return Math.random().toString(16).substring(2,2+e)}function WA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(VV){return!1}}();return function(){var r,n=cA(e);if(t){var i=cA(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return uA(this,r)}}function RA(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function NA(e,t,r){if(!t.has(e));return r}var OA,MA,LA=Et.getLogger(),BA=1006,UA=new WeakSet,VA=new WeakSet,GA=new WeakSet,jA=new WeakSet,HA=new WeakSet,zA=new WeakSet,KA=new WeakSet,JA=function(e){sA(s,e);var r,n,o,a=WA(s);function s(e){var r;return t(this,s),RA(oA(r=a.call(this,e)),KA),RA(oA(r),zA),RA(oA(r),HA),RA(oA(r),jA),RA(oA(r),GA),RA(oA(r),VA),RA(oA(r),UA),nC(oA(r),"_defaultRetries",1),nC(oA(r),"_ws",OA),nC(oA(r),"_events",{}),nC(oA(r),"_bHeartBeatStarted",!1),nC(oA(r),"_heartBeatTicks",6e4),r._ws=OA,r.bUseParentWS=!1,r._tasks=Object.create(null),r.bReady=!1,r._blob_callbacks=[],r._processing_blob=!1,r}return i(s,[{key:"ws",get:function(){return this._ws}},{key:"requestSync",value:function(e,t,r){return LA.error("WebSocket Client requestSync not supported"),undefined}},{key:"send",value:(o=eA(g.mark((function u(e,t,r){var n,i,o,a;return g.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(n=r.client,s.prev=1,(i=r.taskId)!==undefined){s.next=7;break}return s.next=6,t(e,pA.GET_TASKID,n._requestTaskId,r);case 6:i=s.sent;case 7:if(o=n._tasks[i]){s.next=11;break}throw LA.error("invalid task id: "+i),new fA(tA.INVALID_TASK);case 11:return s.next=13,NA(n,HA,ek).call(n,!1);case 13:return s.next=15,NA(n,zA,rk).call(n,e,t,r,o);case 15:LA.debug("begin to send data "+i),n.disposed||n._ws.send(e),e=null,LA.debug("end to send data "+i),s.next=27;break;case 21:s.prev=21,s.t0=s["catch"](1),LA.debug("failed to send data."),LA.error(s.t0),delete n._tasks[i],null===(a=o)||void 0===a||null===(a=a.resolver)||void 0===a||a.reject(s.t0.message);case 27:case"end":return s.stop()}}),u,null,[[1,21]])}))),function(e,t,r){return o.apply(this,arguments)})},{key:"request",value:function(e,t,r,n){var i=this._defaultRetries,o=null!=t?t:NA(this,jA,ZA),a=null!=r?r:{client:this,userData:this};return NA(this,KA,ik).call(this,e,o,a,i,!1,undefined,n)}},{key:"connected",get:function(){var e;return(null===(e=this._ws)||void 0===e?void 0:e.readyState)==WebSocket.OPEN}},{key:"testConnection",value:function(e,t,r,n){return NA(this,HA,ek).call(this,!0,null!=t?t:0,r,n)}},{key:"_terminate",value:(n=eA(g.mark((function c(){var e;return g.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e in LA.debug("terminate WSClient"),this.fireEvent("disposed"),this._tasks)this._tasks[e]!==undefined&&this._tasks[e].resolver&&this._tasks[e].resolver.reject(new fA(tA.OBJECT_DISPOSING));this._lic_callback=OA,this._blob_callbacks=[],this._processing_blob=!1,this._ws&&(this._ws.onopen=null,this._ws.onerror=null,this._ws.onmessage=null,this._ws.onclose=null,this._ws.close()),this._ws=OA,this._tasks=Object.create(null);case 9:case"end":return t.stop()}}),c,this)}))),function(){return n.apply(this,arguments)})},{key:"setRetry",value:function(e){this._defaultRetries=null!=e?e:1}},{key:"addEvent",value:function(e,t,r){var n=this._events[e];n||(this._events[e]={},n=this._events[e]),Et.isString(t)&&Et.isFunction(r)&&(n[t]=r)}},{key:"removeEvent",value:function(e,t){var r=this._events[e];r&&Et.isString(t)&&delete r[t]}},{key:"clearEvent",value:function(e){this._events[e]&&(this._events[e]={})}},{key:"fireEvent",value:function(e){var t,r=this._events[e];if(r){var n=Object.keys(r);for(t=0;t<n.length;t++)Et.isFunction(r[n[t]])&&r[n[t]]()}}},{key:"getRequestTaskId",value:function(){return this._requestTaskId?this._requestTaskId:0}}],[{key:"_waitForPreBlob",value:(r=eA(g.mark((function l(e){return g.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e._processing_blob){t.next=3;break}return setTimeout((function(){s._waitForPreBlob(e)}),500),t.abrupt("return");case 3:s._preBlobResolv&&s._preBlobResolv();case 4:case"end":return t.stop()}}),l)}))),function(e){return r.apply(this,arguments)})}]),s}(yA);function QA(e){var t="";return t=e.ssl?"wss://":"ws://",t+=e.server,e.port&&(t+=":",t+=e.port),t}function qA(e,t,r,n){var i=this;return new bt.Promise((function(o,a){try{var s,u,c=a,l=o;if(n&&(u=setTimeout((function(){var e=new fA("createWebSocket timed out.");LA.debug(e.message),c&&(c(e),c=null,l=null),u&&clearTimeout(u),s&&s.close()}),n)),e.bUseParentWS){var d=window,f=parent,h=d.WebSocket;try{for(;d!=f&&f&&f.WebSocket;)h=f.WebSocket,d=f.window,f=f.parent}catch(g){h=window.WebSocket}s=r?new h(t,r):new h(t)}else s=r?new WebSocket(t,r):new WebSocket(t);s.onopen=function(){u&&clearTimeout(u),e._ws=s,l&&(l(s),c=null,l=null)},s.onerror=function(t){s.close(),e.bReady=!1,u&&clearTimeout(u),i.fireEvent("error"),c&&(c(new fA("websocket error")),c=null,l=null)},s.onmessage=function(t){NA(e,GA,YA).call(e,e,t.data)},s.onclose=function(t){e.bReady=!1,u&&clearTimeout(u),i.fireEvent("close"),c&&(t&&t.code==BA?c(new fA("websocket error")):c(t),c=null,l=null)}}catch(p){if(p instanceof fA||p&&p.code&&p.message)throw p;if(p.message)throw new fA(p.message)}}))}function YA(e,t){return XA.apply(this,arguments)}function XA(){return XA=eA(g.mark((function t(r,n){var i,o,a,s,u,c,l,d,f;return g.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=r,t.prev=1,s={client:i,userData:undefined},"object"!==e(n)){t.next=17;break}if(!(i._blob_callbacks.length>0)){t.next=17;break}if(!i._processing_blob){t.next=9;break}return t.next=8,new bt.Promise((function(e){bA._preBlobResolv=e,bA._waitForPreBlob(i)}));case 8:bA._preBlobResolv=null;case 9:return i._processing_blob=!0,u=i._blob_callbacks.shift(),t.next=13,u(n);case 13:return t.sent,i._processing_blob=!1,t.abrupt("return");case 17:if(!(i.bReady&&Et.isString(n)&&(n.indexOf("Function not found")>0||n.indexOf("Version not found")>0))){t.next=19;break}return t.abrupt("return");case 19:if(i._cbToGetTaskId){t.next=21;break}return t.abrupt("return");case 21:return t.next=23,i._cbToGetTaskId(n,pA.ONMESSAGE_PROCESS_DATA,i._requestTaskId,s);case 23:return c=t.sent,l=!1,t.next=27,i._cbToGetTaskId(c,pA.ONMESSAGE_GET_TASKID,i._requestTaskId,s);case 27:if(a=t.sent){t.next=36;break}if(!c.Detail||!c.Domain){t.next=32;break}return i._lic_callback&&i._lic_callback(c),t.abrupt("return");case 32:return t.next=34,i._cbToGetTaskId(c,pA.ONMESSAGE_GET_EVENT_TASKID,i._requestTaskId,s);case 34:(a=t.sent)&&(l=!0);case 36:if(o=i._tasks[a]){t.next=46;break}if(!l){t.next=42;break}o={},t.next=44;break;case 42:return""!=a&&LA.log("invalid task id: "+a),t.abrupt("return");case 44:t.next=48;break;case 46:if(!o.timedout){t.next=48;break}return t.abrupt("return");case 48:return t.next=50,i._cbToGetTaskId(n,pA.HANDLE_RAW_MESSAGE,i._requestTaskId,o.ctx);case 50:if((d=t.sent)!==undefined){t.next=55;break}return t.next=54,i._cbToGetTaskId(c,pA.HANDLE_PROCESSED_MESSAGE,i._requestTaskId,o.ctx);case 54:d=t.sent;case 55:d&&!l&&(o.tmid&&clearTimeout(o.tmid),delete i._tasks[a],o.resolver&&o.resolver.resolve(d)),t.next=64;break;case 58:t.prev=58,t.t0=t["catch"](1),LA.debug("failed to handle message."),t.t0 instanceof Error?LA.error(t.t0):LA.error(Et.stringify(t.t0)),delete i._tasks[a],null===(f=o)||void 0===f||null===(f=f.resolver)||void 0===f||f.reject(t.t0.message);case 64:case"end":return t.stop()}}),t,null,[[1,58]])}))),XA.apply(this,arguments)}function ZA(e,t,r){return $A.apply(this,arguments)}function $A(){return $A=eA(g.mark((function e(t,r,n){var i,o;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=r,e.next=e.t0===pA.GET_TASKID?3:e.t0===pA.HANDLE_RAW_MESSAGE?7:9;break;case 3:return(o=DA(t)).cmdId=null!==(i=o.cmdId)&&void 0!==i?i:(n=void 0,a=void 0,a=[FA(8),"-",FA(4),"-",FA(4),"-",FA(4),"-",FA(8)],n&&a.unshift(n),a.join("")),bt.Promise.resolve(["cmdId"]),e.abrupt("break",9);case 7:return bt.Promise.resolve(t),e.abrupt("break",9);case 9:case"end":return e.stop()}var n,a}),e)}))),$A.apply(this,arguments)}function ek(e,t,r,n){return tk.apply(this,arguments)}function tk(){return tk=eA(g.mark((function e(t,r,n,i){var o,a,s,u;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.connected&&!this.disposed){e.next=2;break}return e.abrupt("return");case 2:if(!(s=this)._connectPromise){e.next=7;break}return e.next=6,s._connectPromise;case 6:return e.abrupt("return");case 7:return r=null!==(o=r)&&void 0!==o?o:this._defaultRetries,n=null!==(a=n)&&void 0!==a?a:100,u=NA(s,UA,QA).call(s,s.serverInfo),LA.debug("WebSocket URL: "+u+", try to create websocket "+r+"/"+n),s._connectPromise=new bt.Promise((function(e,t){var o=function(n){NA(s,VA,qA).call(s,s,u,s.serverInfo.protocol,i).then((function(t){e(t)}))["catch"]((function(e){LA.debug("create websocket failed: "+e.message),n<r?a(n):t(e)}))};function a(e,t,r){setTimeout((function(){o(++e)}),n)}o(0)})),e.prev=12,e.next=15,s._connectPromise;case 15:e.next=20;break;case 17:throw e.prev=17,e.t0=e["catch"](12),e.t0;case 20:return e.prev=20,s._connectPromise=null,e.finish(20);case 23:case"end":return e.stop()}}),e,this,[[12,17,20,23]])}))),tk.apply(this,arguments)}function rk(e,t,r,n){return nk.apply(this,arguments)}function nk(){return nk=eA(g.mark((function e(t,r,n,i){var o,a,s,u;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this,a=n.eventTaskId,s=n.lastEventTaskId,a!==undefined){e.next=7;break}return e.next=6,r(t,pA.GET_EVENT_TASKID,o._requestTaskId,n);case 6:a=e.sent;case 7:a&&(o._tasks[a]?n&&n.userData&&n.userData.command&&((u=o._tasks[a]).ctx=n,s&&((u=o._tasks[s]).ctx=n)):(u={id:i.id,resolver:null,ctx:n,timedout:!1},o._tasks[a]=u,s&&(o._tasks[s]=u)));case 8:case"end":return e.stop()}}),e,this)}))),nk.apply(this,arguments)}function ik(e,t,r,n,i,o,a){return ok.apply(this,arguments)}function ok(){return ok=eA(g.mark((function e(t,r,n,i,o,a,s){var u,c,l,d;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=this,e.prev=1,n.client=u,e.next=5,NA(u,HA,ek).call(u,o,i,a,s);case 5:if("0"!=(c=n.taskId)){e.next=12;break}return u.disposed||u._ws.send(t),t=null,e.abrupt("return");case 12:if(c!==undefined){e.next=16;break}return e.next=15,r(t,pA.GET_TASKID,null,n);case 15:c=e.sent;case 16:return c===undefined&&LA.debug("websocket send: task id is invalid."),(l={}).promise=new bt.Promise((function(e,t){l.resolve=e,l.reject=t})),d={id:c,resolver:l,ctx:n,timedout:!1},u._tasks[c]=d,u._requestTaskId=c,e.next=24,NA(u,zA,rk).call(u,t,r,n,d);case 24:return u._cbToGetTaskId=r,s&&(d.tmid=setTimeout((function(){LA.debug("ws request time out."),d.timedout=!0,d.resolver.reject("request timed out.")}),s)),u.disposed||u._ws.send(t),LA.debug("end to send task "+c),t=null,e.abrupt("return",l.promise);case 32:if(e.prev=32,e.t0=e["catch"](1),c&&delete u._tasks[c],!(e.t0 instanceof fA||e.t0&&e.t0.code&&e.t0.message)){e.next=39;break}throw e.t0;case 39:if(!e.t0.message){e.next=41;break}throw new fA(e.t0.message);case 41:return e.prev=41,t=null,e.finish(41);case 44:case"end":return e.stop()}}),e,this,[[1,32,41,44]])}))),ok.apply(this,arguments)}function ak(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return sk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sk(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r["return"]||r["return"]()}finally{if(s)throw o}}}}function sk(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function uk(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function ck(e,t,r){if(!t.has(e));return r}bA=JA;var lk=new WeakSet,dk=new WeakSet,fk=function(){function e(){t(this,e),uk(this,dk),uk(this,lk),nC(this,"_maxWebSocketCon",10),nC(this,"_wsClients",[])}return i(e,[{key:"removeTerminatedWSClient",value:function(){this._wsClients=this._wsClients.filter((function(e){return!e.disposed}))}},{key:"getClient",value:function(e,t){return e.useWS?ck(this,dk,gk).call(this,e,t):new AA(e)}},{key:"terminate",value:function(){var e=this._wsClients.slice();this._wsClients=[],e.forEach((function(e){e.dispose()}))}}],[{key:"Instance",get:function(){return this._gClientPool||(this._gClientPool=new e),this._gClientPool}}]),e}();function hk(e){this.removeTerminatedWSClient();var t,r,n,i=ak(this._wsClients);try{for(i.s();!(t=i.n()).done;){var o=t.value;if(r=o.serverInfo,n=e,(null==r?void 0:r.port)==(null==n?void 0:n.port)&&(null==r?void 0:r.protocol)==(null==n?void 0:n.protocol)&&(null==r?void 0:r.server)==(null==n?void 0:n.server)&&(null==r?void 0:r.ssl)==(null==n?void 0:n.ssl)&&(null==r?void 0:r.useWS)==(null==n?void 0:n.useWS)&&!o.disposed)return o.addRef(),o}}catch(a){i.e(a)}finally{i.f()}return null}function gk(e,t){var r;return t||(r=ck(this,lk,hk).call(this,e)),r||(this._wsClients.length<this._maxWebSocketCon?((r=new JA(e)).addEvent("disposed","1",(function(){MA.Instance.removeTerminatedWSClient()})),this._wsClients.push(r),r):null)}MA=fk,nC(fk,"_gClientPool",null);var pk=function(){function e(){t(this,e)}return i(e,null,[{key:"getHttpClientForDcp",value:function(t,r){var n,i=xt.dcp,o=bt.detect.ssl;if(r||!K.bSSL?(n=i.Port,o=!1):(n=i.SSLPort,o=!0),Et.isString(t)){var a=new iA;return Et.startsWith(t,"https://")?(a.ssl=!0,a.server=t.substring(8)):Et.startsWith(t,"http://")?(a.ssl=!1,a.server=t.substring(7)):(a.ssl=bt.detect.ssl,a.server=t),fk.Instance.getClient(a)}return e.getHttpClient(null,n,o)}},{key:"getHttpClient",value:function(e,t,r){var n=r?"https":"http",i=new iA(e||lw(),t,r,!1,n);return fk.Instance.getClient(i)}},{key:"getWsClient",value:function(e,t,r,n){var i=new iA(e||lw(),t,r,!0,Tw.wsProtocol);return fk.Instance.getClient(i,n)}}]),e}();bt.ClientPool=fk;var mk,_k=parseInt(BC),vk=parseInt(UC),yk=parseInt("0"),Ik="ddm/",Sk="ddm_"+[_k,vk,yk,VC].join("");function Tk(){return Ik+Sk}function bk(e){return Ck.apply(this,arguments)}function Ck(){return(Ck=eA(g.mark((function e(t){var r,n,i,o;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ww,n=[Tk(),"/VersionInfo?","ts=",Et.now()].join(""),i=['{"id":"',Et.guid(),'","method":"VersionInfo"}'].join(""),o=pk.getHttpClientForDcp(t),e.abrupt("return",o.request(i,n,{dataType:"json"},r));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function wk(){var e=window.Dynamsoft.Lib.Promise;if(mk)return e.resolve(mk);var t,r,n=navigator;if(n&&"userAgentData"in n){var i=navigator.userAgentData;if(i.platform&&""!=i.platform){var o=[];if("brands"in i&&Et.isArray(i.brands)&&i.brands.length>0?o=i.brands:"uaList"in i&&Et.isArray(i.uaList)&&i.uaList.length>0&&(o=i.uaList),o.length>0)return(r=function(e){var t=K,r=e.architecture.toLowerCase(),n="64"==e.bitness,i=r.indexOf("arm")>-1,o=r.indexOf("mips")>-1;return{bUseUserAgent:!1,bWin:t.bWin,bMac:t.bMac,bLinux:t.bLinux,bAndroid:t.bAndroid,bMobile:t.bMobile,bPad:t.bPad,bChromeOS:t.bChromeOS,bHarmonyOS:t.bHarmonyOS,bArm64:i,bMips64:o,bEmbed:i||o,bOSx64:n,bIE:!1,bEdge:t.bEdge,bChrome:t.bChrome,bFirefox:t.bFirefox,bSafari:t.bSafari,bOpera:t.bOpera,bGecko:!0,bHuaWeiBrowser:!1,bHTML5Edition:!0,strBrowserVersion:t.strBrowserVersion,IEMode:0}},t?window.Dynamsoft.Lib.Promise.resolve((function(){return r(t)})):navigator.userAgentData.getHighEntropyValues(["platform","platformVersion","architecture","bitness"]).then(r)).then((function(e){return mk=e,e}))}}return mk=K,e.resolve(mk)}bt.install={_divDWTNonInstallContainerID:"dwt-NonInstallContainerID",_divDWTemessageContainer:"",_dlgInstall:!1},bt.install._strNonInstallDIV=['<div style="text-align:center;" id="',bt.install._divDWTNonInstallContainerID,'"></div>'].join("");var Ek=0,Ak=[],kk=!(!document||!document.addEventListener),Pk="DOMContentLoaded",xk="readystatechange",Dk="load",Fk="complete",Wk=kk?function(e,t,r){e.addEventListener(t,r,!1)}:function(e,t,r){e.attachEvent("on"+t,r)},Rk=kk?function(e,t,r){e.removeEventListener(t,r,!1)}:function(e,t,r){e.detachEvent("on"+t,r)};function Nk(){Ek||(Ek=1,wk().then((function(){document&&Rk(window,Dk,Nk),function(){for(var e=function(){try{Ak[t]()}catch(VV){Et.log(VV,"error"),setTimeout((function(){throw VV}),0)}},t=0;t<Ak.length;t++)e()}()})))}function Ok(e){if(Ek)try{e()}catch(VV){Et.log(VV,"error"),setTimeout((function(){throw VV}),0)}else Ak.push(e);return this}function Mk(e){Et.log(e)}Ok((function(){var e=document.createElement("style"),t=["dialog[open]{display:block}dialog[closed]{display:none}.dynamsoft-backdrop{position:fixed;background:rgba(128,128,128,0.1);top:0;bottom:0;left:0;right:0;z-index:-99999999;}.dynamsoft-dwt-dialogProgress{width:330px;background:#FFF}.dynamsoft-finalMessage{margin:0;color:#3a3a3a;font:20px Arial,sans-serif}.dynamsoft-desc{margin:7px 0;color:#3a3a3a;font:14px Arial,sans-serif}.dynamsoft-status{color:#555;font:14px/22px Arial,sans-serif;margin-bottom:5px}.dynamsoft-progressBar{-webkit-appearance:none;width:280px;margin-bottom:20px;height:14px}.dynamsoft-progressBar,.dynamsoft-progressBar::-webkit-progress-bar{background-color:#e7e7e7;border-radius:7px}.dynamsoft-progressBar::-webkit-progress-value,.dynamsoft-progressBar::-moz-progress-bar{background-color:#50a8e1;border-radius:7px}.dynamsoft-loadingMsg{width:290px;height:290px;margin:auto;color:#CCC;border-width:1px;background:#FFF}.dynamsoft-loadingMsg-msg{margin:0 0 15px 25px;color:#3a3a3a;font:20px Arial,sans-serif}.dynamsoft-loadingMsg-desc{text-align:center;margin:0 0 15px 0;color:#3a3a3a;font:14px Arial,sans-serif}.ds-dwt-loaderBar-noserver-parent{height:100%;}.ds-dwt-loaderBar-noserver{margin: 0 auto;padding-top: 50px;text-align: center;}.ds-dwt-loaderBar-noserver img{height: 100px}"].join("");e.type="text/css";try{e.appendChild(document.createTextNode(t))}catch(r){e.styleSheet.cssText=t}document.body.appendChild(e)})),bt._zdgb_xkz_dhk=function(){var e=bt.install._dlgInstall;if(e){var t=Et.sizzle(".dynamsoft-dialog-closeTimer",e);if(t.length>0){var r=t[0],n=parseInt(r.style.width);(n-=1)<=0?xt.DWT.CloseDialog():(r.style.width=n+"%",setTimeout(bt._zdgb_xkz_dhk,100))}}},bt.ShowLicenseDialog=xt.DWT.ShowMessage,bt.createLoadingBarContent=function(){};var Lk,Bk="All scripts and css loaded.",Uk="Checking Product Key format...",Vk="Initializing the service...",Gk="Checking the service enhanced module...",jk="Getting the WebTwain port...",Hk="Checking the WebTwain module...",zk="Checking the WebTwain version...",Kk="Check the WebTwain version successfully.",Jk="The WebTwain version not compatible.",Qk="Getting Machine ID.",qk="Creating WebTwain from Dynamsoft.DWT.Containers...",Yk="Decoding the license...",Xk="Checking the license...";function Zk(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function $k(e,t,r){if(!t.has(e));return r}!function(e){e.CM_RENDERALL=1,e.CM_IMAGEONLY=2,e.CM_AUTO=3,e.CM_RENDERALLWITHANNOTATION=4}(Lk||(Lk={}));var eP=BC+".",tP=parseInt(BC),rP={ActiveX:0,Plugin:1,HTML5:2,WinMacLinux:3,Barcode1D:4,Barcode2D:5,BarcodeWriter:6,OCR:7,Webcam:8,PDFRasterizer:9,OCRPro:10,QR:50,PDF417:51,DataMatrix:52};function nP(e){return Et.isString(e)?Et.trim(e):e}var iP=new WeakSet,oP=new WeakSet,aP=new WeakSet,sP=new WeakSet,uP=new WeakSet,cP=new WeakSet,lP=new WeakSet,dP=new WeakSet,fP=new WeakSet,hP=function(){function e(){t(this,e),Zk(this,fP),Zk(this,dP),Zk(this,lP),Zk(this,cP),Zk(this,uP),Zk(this,sP),Zk(this,aP),Zk(this,oP),Zk(this,iP),nC(this,"isLTS",Ew)}return i(e,[{key:"isLongKey",value:function(e){if(Et.isString(e)&&e.length>0){var t=e.charAt(0);if("f"==t||"t"==t)return!0;if(Et.startsWith(e,"DLS"))return!1;if(Et.isNumber(e))return!1;var r=parseInt(e)+"-";return!Et.startsWith(e,r)}return!1}},{key:"isLicenseMixed",value:function(e,t){var r,n=!1,i=e||xt.DWT.ProductKey;(xt.DWT.lclex(),t)&&((nP(xt.DWT.organizationID)||nP(xt.DWT.handshakeCode))&&i&&(n=!0,kw(r={},-2444,"A license can only be specified once and has already been set using the ProductKey API.")));if(!n&&Et.isString(i))if(i=Et.trim(i),Et.startsWith(i,"f")||Et.startsWith(i,"t"));else if(""==i);else if(Et.startsWith(i,"DLS2"))try{$k(this,oP,pP).call(this,i)}catch(a){n=!0,kw(r={},-2440,""),r._errorString=a.message}else{$k(this,iP,gP).call(this,i).LTS||(n=!0,function(e){kw(e,vw.LicenseParseFailed,"The license is invalid.")}(r={}))}if(n&&r){Pw(r);var o=xt.DWT.licenseException;Et.error(o.message)}return n}},{key:"reparseProductKey",value:function(e){e&&Mk("Parsing Product Key...");var t=nP(xt.DWT.organizationID),r=nP(xt.DWT.handshakeCode),n=t||r,i=Et.trim(xt.DWT.ProductKey);if(!n){var o=$k(this,iP,gP).call(this,i);o.LTS&&(r=nP(o.handshakeCode),n=(t=nP(o.organizationID))||r)}if(n)return this._innerResetLicense(),Et.isNumber(i)&&(t=i),bw.handshakeCode=r,bw.organizationID=t,bw.licenseServer=xt.DWT.licenseServer,bw.sessionPassword=xt.DWT.sessionPassword,void(bw.bPublicLTS=$k(this,aP,mP).call(this,bw.licenseServer,n));var a=!1;if(bw.refProductKey!==i&&(this._innerResetLicense(),Et.isString(i)&&i.length>0&&(bw.refProductKey=i,a=!0)),a)if(this.isLongKey(bw.refProductKey))bw.bPublicLTS=!1;else{var s,u={_pLoad:{isEmpty:oC},_license:bw.refProductKey,_licenseServer:[]};try{s=nA(u)}catch(l){Et.error(l),s=!1}if(s&&Et.isString(s.l)){var c=Et.trim(s.l);""==c?bw.organizationID=c:-1!=c.indexOf("-")?bw.handshakeCode=c:bw.organizationID=c,Et.isArray(s.ls)&&s.ls.length>0&&(bw.licenseServer=s.ls),bw.bPublicLTS=$k(this,aP,mP).call(this,bw.licenseServer,c),bw.sessionPassword=s.sp}else bw.bPublicLTS=!1}}},{key:"_innerResetLicense",value:function(){bw.refProductKey="",bw.handshakeCode=undefined,bw.organizationID=undefined,bw.licenseServer=undefined,bw.sessionPassword="",bw.bPublicLTS=!0}},{key:"checkOSForAllowCore",value:function(e,t,r){if(bw.bHTML5Edition){if(e)return $k(this,fP,TP).call(this,t);var n=r._bRemoteMode,i=r.__serverPlatform;return this.isOSOK(t,n,i)}return oC}},{key:"checkLocalPlatformForRemoteService",value:function(e){var t,r,n,i=e.__licenseInfo,o=e._bScanForProxyRemote,a=aw.getEnumPlatform(),s=!1;for(t=0;t<i.Detail.length;t++)if(r=i.Detail[t],(n=$k(this,lP,IP).call(this,r.EnumLicenseType,r.LicenseType)).Core&&Et.isString(r.Version)&&0==r.Version.indexOf(eP)){if(s=$k(this,fP,TP).call(this,r.OS))break;if(s=this.isOSOK(r.OS,true,a))break;if(o&&n.RemoteScan)break}return s||(a==OC.enumWindow?function(e){kw(e,-2344,"The current product key does not support Windows OS. "+xw()),Pw(e)}(e):a==OC.enumLinux?function(e){kw(e,-2346,"The current product key does not support Linux OS. "+xw()),Pw(e)}(e):a==OC.enumMac?function(e){kw(e,-2345,"The current product key does not support MAC OS. "+xw()),Pw(e)}(e):function(e){kw(e,-2347,"The current product key does not support your OS. "+xw()),Pw(e)}(e)),s}},{key:"checkProductKey",value:function(e,t,r){var n,i=xt.DWT.licenseException;return!t.Camera&&(e.__licenseInfo||(e.__licenseInfo={}),(n=$k(this,uP,vP).call(this,e,e.__licenseInfo,iC,t,r))||(i.code=e._errorCode,i.message=e._getErrorString(),i.fromLTS=!1),n)}},{key:"isBindDomainOK",value:function(e){if(Et.isUndefined(e)||null==e||""==e||"*"==e||"*.*"==e)return oC;var t=location.hostname,r=iC;if(""==t)return oC;for(var n=t.toLowerCase().split("."),i=n.length,o=e.toLowerCase().split(";"),a=0;a<o.length;a++){var s=o[a];if("*.*"==s){r=oC;break}var u=s.split("."),c=u.length;if(c>0&&c-1<=i){for(var l=oC,d=c-1;d>0;d--){if(u[d].indexOf("*")>-1){r=oC;break}if(d+i-c>=0){if(n[d+i-c]!=u[d]){l=iC;break}}else if("*"!=u[d]){l=iC;break}}if(l&&("*"==u[0]||i>=c&&n[i-c]==u[0])){r=oC;break}}}return r}},{key:"isExpiredOrFuture",value:function(e,t){if(""==e)return iC;if(!t){var r=e.length;if(r>2&&"/"==e[r-2]&&"0"==e[r-1])return iC}var n=kP(e),i=(new Date).getTime(),o=i+5184e6;return n.getTime()<i||t&&n.getTime()>o?oC:iC}},{key:"willTrialExpire",value:function(e){if(""==e)return iC;var t=kP(e),r=(new Date).getTime();return t.getTime()<r+432e6&&t.getTime()>r?oC:iC}},{key:"isOSOK",value:function(e,t,r){var n=!1,i=!1,o=!1,a=!1,s=!1,u=!1,c=!1,l=!1;return""==e||"0"==e?oC:(t?r==OC.enumWindow?o=!0:r==OC.enumLinux?i=!0:r==OC.enumMac?n=!0:r==OC.enumEmbed?s=!0:r==OC.enumChromeOS?u=!0:r==OC.enumAndroid?c=!0:r==OC.enumHarmonyOS?l=!0:r==OC.enumiOS&&(a=!0):(n=K.bMac,i=K.bLinux,o=K.bWin,a=K.biPhone||K.biPad,u=K.bChromeOS,s=xt.navInfo.bEmbed,c=K.bAndroid,l=K.bHarmonyOS),(e=e.toLowerCase()).indexOf("windows")>-1&&o||e.indexOf("mac")>-1&&n||e.indexOf("linux")>-1&&(i||u||l)||e.indexOf("android")>-1&&c||e.indexOf("ios")>-1&&a||e.indexOf("embed")>-1&&s?oC:iC)}},{key:"isBrowserOK",value:function(e){if(Et.isString(e)){if(""==e||"0"==e)return oC;var t=(e=e.toLowerCase()).split(";"),r=iC;return Et.each(t,(function(e){("chrome"==Et.trim(e)&&(K.bChrome||K.bSafari||K.bOpera||K.bEdge)||"ie"==Et.trim(e)&&K.bIE||"firefox"==Et.trim(e)&&K.bFirefox)&&(r=oC)})),r}return iC}},{key:"isAllowLicenseType",value:function(e,t){return t.Core?e.Core:t.PDFRasterizer?e.PDFRasterizer:t.Webcam||t.Camera?e.Webcam:t.barcode1D?e.barcode1D:t.QR?e.QR:t.PDF417?e.PDF417:t.DataMatrix?e.DataMatrix:t.OCR?e.OCR:t.OCRPro?e.OCRPro:e.Core}},{key:"setNoAllowedLicenseTypeError",value:function(e,t,r){r.Core?Zw(e,t):r.Webcam||r.Camera?t||r.Camera?function(e){e._errorCode=-2431,Ew()?e._errorString="The license for the Camera Addon is not found or has expired.":kw(e,-2431,"The current product key does not support Camera Addon. "+xw()),Pw(e)}(e):function(e){e._errorCode=-2338,Ew()?e._errorString="The license for the module direct show is not found or has expired.":e._errorString="The current product key does not support Webcam. "+xw(),Pw(e)}(e):r.PDFRasterizer?t?function(e){e._errorCode=-2370,Ew()?e._errorString="The license for the module pdf rasterizer is not found or has expired.":e._errorString="The current product key does not support Pdf Rasterizer Wasm. "+xw(),Pw(e)}(e):$w(e):r.OCR?function(e){e._errorCode=-2340,Ew()?e._errorString="The license for the module ocr is not found or has expired.":e._errorString="The current product key does not support OCR. "+xw(),Pw(e)}(e):r.OCRPro?function(e){e._errorCode=-2341,Ew()?e._errorString="The license for the module ocr pro is not found or has expired.":e._errorString="The current product key does not support OCR pro. "+xw(),Pw(e)}(e):Yw(e)}},{key:"getLicenseDateString",value:function(e){var t,r=e.getFullYear();return[(t=e.getMonth()+1)>=10?""+t:"0"+t,"/",e.getDate()>=10?""+e.getDate():"0"+e.getDate(),"/",r].join("")}},{key:"hasPDFRProductKey",value:function(e){return!!this.checkProductKey(e,{PDFRasterizer:!0},!0)||(e._resetErr(),!1)}},{key:"checkPDFProductKeyWhenNeeds",value:function(e,t){var r;if((t==xt.DWT.EnumDWT_ImageType.IT_PDF||t==xt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF)&&(bw.bHTML5Edition?e.__addon&&e.__addon.PDF&&(r=e._getConvertMode()):e.Addon&&e.Addon.PDF&&(r=e._getConvertMode()),r==Lk.CM_RENDERALL||r==Lk.CM_RENDERALLWITHANNOTATION))return this.checkProductKey(e,{PDFRasterizer:!0},!0);return oC}},{key:"getPublicLicenseContent",value:function(e){var t=[],r=e;if(!Et.isString(r)){if(Et.isUndefined(r))return"";r=r instanceof Error||"message"in r?r.message:""+r}var n=r.indexOf("["),i=r.indexOf("]",n),o=r.indexOf("(",i),a=r.indexOf(")",o);if(-1==n||-1==i||-1==o||-1==a)return r;n>0&&t.push(r.substring(0,n));var s=r.substring(n+1,i),u=r.substring(o+1,a);return t.push(['<a href="',u,'" target="_blank" class="dynamsoft-major-color">',s,"</a>"].join("")),t.push(r.substring(a+1)),t.join("")}},{key:"getLTSLicense",value:function(){return bw.bPublicLTS?"":bw.handshakeCode||bw.organizationID}}]),e}();function gP(e){var t,r,n=e,i=e.indexOf("-"),o=-1!=i;return r={},o&&(n=e.substring(0,i)),t=Number(n),isNaN(t)||String(Number(t))!==n||(o?r.handshakeCode=e:r.organizationID=e,r.LTS=oC),r}function pP(e){nA({_pLoad:{isEmpty:oC},_license:e,_licenseServer:[]})}function mP(e,t){var r=!0;if(Et.isArray(e)&&e.length>0){var n=e[0];Et.isString(n)&&""!=n&&-1==n.indexOf("https://mlts.dynamsoft.com")&&(r=!1)}return r&&(!t||"200001"===t||Et.startsWith(t,"200001-"))}function _P(e,t,r){return this.checkOSForAllowCore(e,t,r)}function vP(e,t,r,n,i){var o,a=!1;if(bw.bHTML5Edition&&Et.isFunction(e._needCheckProxyRemoteScanLicense)&&(a=e._needCheckProxyRemoteScanLicense()),t&&t.LTS){if(!t||!Et.isArray(t.Detail)||0==t.Detail.length)return this.isLTS()?Zw(e,r):Yw(e),iC}else if(!t||!Et.isArray(t.Detail)||0==t.Detail.length)return this.isLTS()?Zw(e,r):Yw(e),iC;var s,u,c,l,d=0,f=0,h=[],g=[],p=iC,m=iC,_=iC,v=iC,y=iC;if(!this.isBindDomainOK(t.Domain))return function(e){kw(e,-2342,"The domain of your current site does not match the domain bound in the current product key. "+xw()),Pw(e)}(e),iC;for(t.Detail.length>0&&(o="FALSE"!=(c=t.Detail[0]).Trial),u=1;u<t.Detail.length;u++)if("FALSE"==(c=t.Detail[u]).Trial&&o||"TRUE"==c.Trial&&!o)return pE(e),iC;if(t.bTrial=o,n.Core||n.Webcam){var I=[],S=!1;for(u=0;u<t.Detail.length;u++)if(c=t.Detail[u],l=$k(this,lP,IP).call(this,c.EnumLicenseType,c.LicenseType),n.Core&&l.Core&&this.checkOSForAllowCore(r,c.OS,e)||n.Core&&l.Core&&bw.bActiveXEdition&&l.ActiveX||n.Webcam&&l.Webcam&&!r){if(t.LTS);else if(!Et.isString(c.Version)||0!=c.Version.indexOf(eP)){I.push(c);continue}if(bw.bHTML5Edition){if(l.ActiveX&&!l.Html5)continue;if(a&&!l.RemoteScan)continue;g.push(c)}else{if(!l.ActiveX&&l.Html5)continue;g.push(c)}S=!0}if(!S&&I.length>0)return I.splice(0),function(e,t){var r=xw();kw(e,vw.LicenseVersionNotCurrent,"The current product key is not for version ".concat(t,". ").concat(r)),Pw(e)}(e,[BC,UC].join(".")),!1;I.splice(0)}else g=t.Detail;for(u=0;u<g.length;u++){var T=oC;if(c=g[u],l=$k(this,lP,IP).call(this,c.EnumLicenseType,c.LicenseType),n.Core&&l.Core||this.isAllowLicenseType(l,n)){s=c.ExpireDate.replace(/-/g,"/");var b="FALSE"!=c.Trial;if(this.isExpiredOrFuture(s,b))h.push(s);else if(b&&l.Core&&this.willTrialExpire(s)&&(t.ExpireDate=s),t.LTS||l.Core&&bw.bHTML5Edition&&parseInt(c.Version)>=tP||l.Core&&bw.bActiveXEdition||!l.Core){var C=!1;if(l.Core)(this.checkOSForAllowCore(r,c.OS,e)||bw.bActiveXEdition&&l.ActiveX)&&(C=!0);else{var w=r;n.Camera&&(w=!0),$k(this,sP,_P).call(this,w,c.OS,e)&&(C=!0)}C?this.isBrowserOK(c.Browser)||i?(d++,T=iC):m=oC:n.Core?p=oC:n.PDFRasterizer?v=oC:(n.Webcam||n.Camera)&&(y=oC)}else _=oC;T&&f++}}if(d>0)return oC;if(0==f)return this.setNoAllowedLicenseTypeError(e,r,n),iC;if(h.length>0){var E,A=0,k=1e20,P="",x=(new Date).getTime();for(s="",u=0;u<h.length;u++)(E=kP(h[u])).getTime()<x&&E.getTime()>A?(A=E.getTime(),s=h[u]):E.getTime()>x&&E.getTime()<k&&(k=E.getTime(),P=h[u]);return""!=s?(E=kP(s),Xw(e,s=this.getLicenseDateString(E))):""!=P?(E=kP(P),P=this.getLicenseDateString(E),function(e,t){kw(e,vw.LicenseIsFuture,"The current product key is invalid. "+xw()),Pw(e)}(e)):Xw(e,""),iC}return _?(function(e){kw(e,-2348,"The current product key is invalid because it's generated with the licenses of a different major version."),Pw(e)}(e),iC):m?(K.bEdge?function(e){kw(e,-2330,"The current product key does not support Edge. "+xw()),Pw(e)}(e):K.bChrome?function(e){kw(e,-2327,"The current product key does not support Chrome. "+xw()),Pw(e)}(e):K.bFirefox?function(e){kw(e,-2328,"The current product key does not support Firefox. "+xw()),Pw(e)}(e):K.bIE?function(e){kw(e,-2329,"The current product key does not support IE. "+xw()),Pw(e)}(e):K.bSafari?function(e){kw(e,-2392,"The current product key does not support Safari. "+xw()),Pw(e)}(e):function(e){kw(e,-2343,"The current product key does not support your browser. "+xw()),Pw(e)}(e),iC):p?(this.setNoAllowedLicenseTypeError(e,r,{Core:!0}),iC):v?(this.setNoAllowedLicenseTypeError(e,r,{PDFRasterizer:!0}),iC):y?(this.setNoAllowedLicenseTypeError(e,r,{Webcam:!0}),iC):(Yw(e),iC)}function yP(e){var t=iC,r=iC,n=iC,i=iC,o=iC,a=iC,s=iC,u=iC,c=iC;return Et.isString(e)&&""!=e&&Et.each(e.split(";"),(function(e){var l=1*e;l==rP.HTML5||l==rP.WinMacLinux||l==rP.ActiveX||l==rP.Plugin?t=oC:l==rP.Barcode1D?r=oC:l==rP.QR?n=oC:l==rP.PDF417?i=oC:l==rP.DataMatrix?o=oC:l==rP.OCR?a=oC:l==rP.Webcam?s=oC:l==rP.PDFRasterizer?u=oC:l==rP.OCRPro&&(c=oC)})),{Core:t,PDFRasterizer:u,Webcam:s,barcode1D:r,QR:n,PDF417:i,DataMatrix:o,OCR:a,OCRPro:c}}function IP(e,t){var r=$k(this,cP,yP).call(this,e),n=$k(this,dP,SP).call(this,t);return Et.each(["Core","Html5","RemoteScan","LocalScan","ActiveX","PDFRasterizer","Webcam","barcode1D","QR","PDF417","DataMatrix","OCR","OCRPro"],(function(e){r[e]=r[e]||n[e]})),r}function SP(e){var t=iC,r=iC,n=iC,i=iC,o=iC,a=iC,s=iC,u=iC,c=iC,l=iC,d=iC,f=iC,h=iC;return e&&""!=e&&((e=e.toLowerCase()).indexOf("html5")>-1||"win=(aph) or mac=(ph) or linux(h)"==e?(t=oC,e.indexOf("html5;activex;oldie")>-1?i=oC:e.indexOf("html5;activex")>-1?(r=oC,h=oC,i=oC):(r=oC,h=oC),e.indexOf(";remotescan")>-1&&(r=oC,f=oC,e.indexOf(";onlyremote")>-1&&(h=iC))):"1d barcode reader"==e?n=oC:"2d barcode reader(qrcode)"==e?o=oC:"2d barcode reader(pdf417)"==e?a=oC:"2d barcode reader(data matrix)"==e?s=oC:"ocr"==e?u=oC:"webcam"==e?c=oC:"pdf rasterizer"==e?l=oC:"proocr"==e&&(d=oC)),{Core:t,Html5:r,RemoteScan:f,LocalScan:h,ActiveX:i,PDFRasterizer:l,Webcam:c,barcode1D:n,QR:o,PDF417:a,DataMatrix:s,OCR:u,OCRPro:d}}function TP(e){var t=e.toLowerCase();return t.indexOf("wasm")>-1||t.indexOf("mobile")>-1}var bP=new hP;function CP(e,t){return wP.apply(this,arguments)}function wP(){return(wP=eA(g.mark((function e(t,r){var n;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ew()){e.next=2;break}return e.abrupt("return");case 2:if(e.prev=2,xt.DWT.li({instanceMode:xt.DWT.EnumInstance.dwt_desktop},"")){e.next=17;break}return r&&Mk(Qk),e.prev=6,e.next=9,bk();case 9:return n=e.sent,e.next=12,EP(n);case 12:e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](6),Et.log(e.t0);case 17:e.next=22;break;case 19:e.prev=19,e.t1=e["catch"](2),Et.log(e.t1);case 22:case"end":return e.stop()}}),e,null,[[2,19],[6,14]])})))).apply(this,arguments)}function EP(e){return AP.apply(this,arguments)}function AP(){return(AP=eA(g.mark((function e(t){var r;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=7;break}if(!(Et.isArray(t.result)&&t.result.length>3)){e.next=5;break}r=t.result[3],e.next=7;break;case 5:if(!t.description){e.next=7;break}return e.abrupt("return",{code:t.exception,message:t.description});case 7:Et.isString(r)&&""!=r&&(xt.DWT.lsmid(r,""),xt.DWT.lsmid2b(r));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function kP(e){var t,r=e;return r=r.replace(/-/g,"/"),t=Date.parse(r),isNaN(t)&&(t=0),(t=new Date(t)).setHours(23,59,59,999),t}xt.DWT.isPublicLicense=function(){return bw.bPublicLTS};var PP,xP=function(){function e(){t(this,e),nC(this,"_exec",{})}return i(e,[{key:"fire",value:function(e,t){var r,n=this;e=e.toLowerCase(),r=Array.prototype.slice.call(arguments,1),Et.each(n._exec[e]||[],(function(e){var t=e.f,i=e.c||n;try{t.apply(i,r)}catch(VV){Et.error(VV)}}))}},{key:"on",value:function(e,t,r){e=e.toLowerCase(),this._exec[e]=this._exec[e]||[],this._exec[e].push({f:t,c:r})}},{key:"off",value:function(e,t,r){if(e&&t){e=e.toLowerCase();for(var n=this._exec[e]||[],i=n.length-1;i>=0;i--)n[i]===t&&n.splice(i,1)}else this._exec={}}}]),e}();function DP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(VV){return!1}}();return function(){var r,n=cA(e);if(t){var i=cA(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return uA(this,r)}}function FP(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function WP(e,t,r){if(!t.has(e));return r}var RP,NP="[bio]: ",OP=window,MP=OP&&OP.FormData,LP=new WeakSet,BP=new WeakSet,UP=new WeakSet,VP=new WeakSet,GP=new WeakSet,jP=new WeakSet,HP=new WeakSet,zP=new WeakSet,KP=function(e){sA(n,e);var r=DP(n);function n(e){var i;return t(this,n),FP(oA(i=r.call(this)),zP),FP(oA(i),HP),FP(oA(i),jP),FP(oA(i),GP),FP(oA(i),VP),FP(oA(i),UP),FP(oA(i),BP),FP(oA(i),LP),nC(oA(i),"_attrs",{}),Et.mix(i._attrs,{action:"",data:{},bChunkedSendData:oC,ajaxConfig:{value:{},type:"post",processData:iC,cache:iC,dataType:"text",async:oC,contentType:iC,retry:0,headers:{"X-Requested-With":iC}},ajax:"",formData:"",CORS:iC,bOnlyResponseEmptyIsOK:oC}),Et.mix(i._attrs,e),WP(oA(i),LP,JP).call(oA(i)),i}return i(n,[{key:"get",value:function(e){return e in this._attrs?this._attrs[e]:""}},{key:"set",value:function(e,t){e in this._attrs&&(this._attrs[e]=t)}},{key:"uploadFilesToServer",value:function(e){return WP(this,BP,QP).call(this,e)}},{key:"uploadToServer",value:function(e){var t=this,r=t.get("ajaxConfig");WP(t,UP,qP).call(t),e&&e.size>0&&(WP(t,VP,YP).call(t,e),Et.isString(e.name)&&""!=e.name?t.name=e.name:t.name=e.fileName,e=null),Et.mix(r,{data:t.get(n.PROP.formData),url:t.get(n.PROP.action),beforeSend:function(e,r,i){e.upload.addEventListener("progress",(function(e){t.fire(n.event.PROGRESS,{loaded:e.loaded,total:e.total,name:t.name})}),!1)}}),Et.mix(r,{method:"POST",async:!0,onSuccess:function(e){$P(t.get(n.PROP.data)),$P(t.get(n.PROP.formData)),t.get(n.PROP.ajax).dispose(),t.set(n.PROP.data,null),t.set(n.PROP.formData,null),t.set(n.PROP.ajax,null);var r=WP(t,zP,ZP).call(t,e);t.fire(n.event.SUCCESS,r)},onError:function(e,r,i){var o,a;$P(t.get(n.PROP.data)),$P(t.get(n.PROP.formData)),t.get(n.PROP.ajax).dispose(),t.set(n.PROP.data,null),t.set(n.PROP.formData,null),t.set(n.PROP.ajax,null),e&&Et.isArray(e)&&e.length>2?(o=e[1],a=e[2]):(o=r,a=i),WP(t,GP,XP).call(t,a,o)}});var i=RC(r);return t.set(n.PROP.ajax,i),!0}},{key:"abort",value:function(){var e=this,t=e.get("ajax");return Et.isObject(t)?(t.abort(),e.set("ajax",!1),e):(Et.log(NP+"abort(), the value of io invalid!"),e)}},{key:"setRequestHeader",value:function(e,t){var r=this.get("ajaxConfig");return r.headers[e]=t,this.set("ajaxConfig",r),r=null,t}}]),n}(xP);function JP(){this.get("CORS");var e=this.get("ajaxConfig");return Et.mix(e,{xhrFields:{withCredentials:!1}}),e}function QP(e){var t=this,r=t.get(PP.PROP.ajaxConfig),n=[];WP(t,UP,qP).call(t),Et.each(e,(function(e){e&&e.size>0?(WP(t,VP,YP).call(t,e),Et.isString(e.name)&&""!=e.name?n.push(e.name):n.push(e.fileName)):n.push("")})),Et.mix(r,{data:t.get(PP.PROP.formData),url:t.get(PP.PROP.action),beforeSend:function(e,r,n){e.upload.addEventListener("progress",(function(e){t.fire(PP.event.PROGRESS,{loaded:e.loaded,total:e.total,name:""})}),!1)}}),Et.mix(r,{method:"POST",async:!0,onSuccess:function(e){var r="";n=[],e&&(e&&Et.isArray(e)&&e.length>1?r=e[0]:Et.isString(e)&&(r=e)),r=WP(t,zP,ZP).call(t,r),t.fire(PP.event.SUCCESS,r)},onError:function(e,r,i){var o,a;n=[],e&&Et.isArray(e)&&e.length>2?(o=e[1],a=e[2]):(o=r,a=i),WP(t,GP,XP).call(t,a,o)}}),t.name="";var i=RC(r);return t.set(PP.PROP.formData,null),t.set(PP.PROP.ajax,i),!0}function qP(){var e,t=this,r=t.get("data");if(MP)if(r instanceof MP)t.set(PP.PROP.formData,r);else{e=new MP;try{Et.each(r,(function(t,r){e.append(r,t)})),t.set(PP.PROP.formData,e)}catch(VV){Et.log(NP+"something error when reset FormData.")}}else Et.log(NP+"the browser does not support ajax.")}function YP(e){if(!Et.isObject(e))return Et.log(NP+"_addFileData(), file parameter invalid!"),!1;var t=this.get(PP.PROP.formData),r=e.name,n=e.remoteFilename;return n||(n="RemoteFile"),t.append(n,e,r),this.set(PP.PROP.formData,t),e=null,t}function XP(e,t){var r=PP.status.ERROR,n={status:r,msg:t,response:!1,name:this.name};e&&(n.httpStatus=e.status,n.response=e.responseText),this.fire(r,n)}function ZP(e){var t,r,n,i=!1,o=this.name,a=PP.status.SUCCESS,s=PP.event.ERROR;if(Et.log("Response from server: "+e),!this.get("bOnlyResponseEmptyIsOK"))return{status:a,msg:!1,json:!1,response:e,name:o};if(Et.isUndefined(e)||""===e)t={status:a,msg:!1,json:!1,response:"",name:o};else if(Et.isString(e)){try{for(r=0;r<e.length&&!(r>10);r++){if("{"==(n=e[r])){i=!0;break}if(" "!=n&&"\r"!=n&&"\n"!=n&&"\t"!=n)break}if(i){var u=Et.parse(e);t=1==u.status?{status:a,msg:!1,json:u,response:e,name:o}:{status:s,msg:!1,json:u,response:e,name:o}}}catch(VV){i=!1,Et.log(VV)}if(!i){var c=String(e);t=""==(c=c.replace(/( |\t|\r|\n)/g,""))?{status:a,msg:!1,json:!1,response:e,name:o}:{status:s,msg:!1,json:!1,response:e,name:o}}}else t={status:a,msg:!1,json:!1,response:"",name:o};return t}function $P(e){e&&e instanceof MP&&e.forEach&&e.forEach((function(t,r){r&&e["delete"](r)}))}function ex(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(VV){return!1}}();return function(){var r,n=cA(e);if(t){var i=cA(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return uA(this,r)}}function tx(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function rx(e,t,r){if(!t.has(e));return r}PP=KP,nC(KP,"event",{SUCCESS:"success",ERROR:"error",PROGRESS:"progress"}),nC(KP,"status",{SUCCESS:"success",ERROR:"error"}),nC(KP,"PROP",{action:"action",data:"data",bChunkedSendData:"bChunkedSendData",ajaxConfig:"ajaxConfig",ajax:"ajax",formData:"formData",CORS:"CORS",bOnlyResponseEmptyIsOK:"bOnlyResponseEmptyIsOK"});var nx=new WeakSet,ix=new WeakSet,ox=new WeakSet,ax=new WeakSet,sx=function(e){sA(n,e);var r=ex(n);function n(e){var i;return t(this,n),tx(oA(i=r.call(this)),ax),tx(oA(i),ox),tx(oA(i),ix),tx(oA(i),nx),i._attrs={action:"",retry:0,timeout:0,CORS:iC,async:oC,dataType:"text",fileStatus:"",data:{},bOnlyResponseEmptyIsOK:oC},Et.mix(i._attrs,e),rx(oA(i),ix,cx).call(oA(i)),i}return i(n,[{key:"get",value:function(e){return e in this._attrs?this._attrs[e]:""}},{key:"set",value:function(e,t){e in this._attrs&&(this._attrs[e]=t)}},{key:"upload",value:function(e){var t;if(e){if(Et.isArray(e))return t=this._uploadType.uploadFilesToServer(e),e=null,t;if(Et.isObject(e)){var r=e;return r.size?(r.id||(r.id=Et.guid("file-")),r.size&&(r.textSize=rx(this,nx,ux).call(this,r.size))):r.size=0,t=this._uploadType.uploadToServer(r),r=null,e=null,t}}return t=this._uploadType.uploadToServer(e),e=null,t}},{key:"abort",value:function(e){return this._uploadType&&this._uploadType.abort(),!0}},{key:"setRequestHeader",value:function(e,t){this._uploadType.setRequestHeader(e,t)}}]),n}(xP);function ux(e){var t=-1;do{e/=1024,t++}while(e>99&&t<4);return Math.max(e,.1).toFixed(1)+["KB","MB","GB","TB"][t]}function cx(){var e=this,t={action:e.get(RP.PROP.action),data:e.get(RP.PROP.data),CORS:e.get(RP.PROP.CORS),bOnlyResponseEmptyIsOK:e.get(RP.PROP.bOnlyResponseEmptyIsOK)};this._uploadType=new KP(t);var r=this._uploadType.get(KP.PROP.ajaxConfig);return r&&(r.dataType=e.get(RP.PROP.dataType),r.async=e.get(RP.PROP.async),r.retry=e.get(RP.PROP.retry)),this._uploadType.on(KP.event.SUCCESS,rx(e,ax,dx),e),this._uploadType.on(KP.event.ERROR,rx(e,ax,dx),e),this._uploadType.on(KP.event.PROGRESS,rx(e,ox,lx),e),this._uploadType}function lx(e){this.fire(RP.event.PROGRESS,e)}function dx(e){var t=this,r=e.status,n=e.msg,i=t.get("file");Et.mix(e,{file:i}),"success"===r?t.fire(RP.event.SUCCESS,e):(!1===n||("abort"===n?Et.mix(e,{canceled:!0}):"timeout"===n&&Et.mix(e,{timeout:!0})),t.fire(RP.event.ERROR,e))}RP=sx,nC(sx,"event",{SUCCESS:"success",ERROR:"error",PROGRESS:"progress"}),nC(sx,"PROP",{action:"action",retry:"retry",timeout:"timeout",CORS:"CORS",async:"async",dataType:"dataType",fileStatus:"fileStatus",data:"data",bOnlyResponseEmptyIsOK:"bOnlyResponseEmptyIsOK"});var fx={Loading:"Processing...",LoadingTiff:"Processing tiff...",LoadingPdf:"Processing pdf...",Encoding:"Processing...",ConvertingToBlob:"Converting to blob...",ConvertingToBase64:"Converting to base64...",SavingPdf:"Saving pdf...",SavingTiff:"Saving tiff...",Downloading:"Downloading...",Uploading:"Uploading...",Transfer:"Transferring...",CanvasLoading:"Loading ...",Err_ServiceModeNotSupportMobile:"Service Mode does not support your Operating System. Please contact the site administrator."};function hx(e,t){bt.detect.bMaskShow=!0,xt.DWT.ScanDirectly||Et.isFunction(xt.DWT.OnWebTwainPreExecute)&&xt.DWT.OnWebTwainPreExecute(e,t)}function gx(){bt.detect.bMaskShow=!1,xt.DWT.ScanDirectly||Et.isFunction(xt.DWT.OnWebTwainPostExecute)&&xt.DWT.OnWebTwainPostExecute()}var px=K.bWin,mx=K.bMac,_x=K.bLinux,vx=K.bSafari,yx=K.bFirefox,Ix=K.bChrome,Sx=location.hostname,Tx=location.pathname,bx=0,Cx=K.bMobile,wx=parseFloat(K.strBrowserVersion);if(K.bWin||K.bMac||K.bLinux||K.bChromeOS){if(xt.navInfo){var Ex=xt.navInfo;Cx=Cx||Ex.bAndroid||Ex.bPad||Ex.biPhone||Ex.biPad}}else Cx=!0;""===Sx?px&&Tx.lastIndexOf("\\")>1?Tx=Tx.substring(1,Tx.lastIndexOf("\\")).replace(/%20/g," "):(bx=1,Tx=Tx.substring(1,Tx.lastIndexOf("/")).replace(/%20/g," ")):(bx=1,Tx=Tx.substring(0,Tx.lastIndexOf("/")));var Ax={bChrome:Ix,bFirefox:yx,bSafari:vx,bIE:K.bIE,bEdge:K.bEdge,bWin:px,bMac:mx,bLinux:_x,iPluginLength:0,bFileSystem:K.bFileSystem,bMobile:Cx,strIEVersion:K.IEVersion,strChromeVersion:K.bChrome?wx:"",strFirefoxVersion:K.bFirefox?wx:"",basePath:Tx,pathType:bx,isDesktopViewer:function(){return K.bWin||K.bLinux||K.bChromeOS||K.bMac},isPadViewer:function(){return K.bPad||K.biPad},isMobileViewer:function(){return K.bMobile||K.biPhone||K.bAndroid||K.bHarmonyOS},WSVersion:"12.0.0",WSSession:(new Date).getTime(),bDiscardBlankImage:iC},kx={getImageUrl:function(e,t,r,n,i){var o,a=[e];if(Et.isNumber(t)&&t<0)return"";if(t!==undefined&&null!==t&&(a.push("&index="),a.push(t)),a.push("&width="),a.push(r),a.push("&height="),a.push(n),Ax.bMobile&&a.push("&type=1&quality=85"),a.push("&ticks="),i?a.push(i):a.push(Date.now()),o=a.join(""),K.bFileSystem&&o.indexOf("dwt://")<0){var s=new Image;s.crossOrigin="anonymous",s.src=o,s=null}return o},getUrlByAct:function(e,t,r){var n=[e];return t!==undefined&&null!==t&&(n.push("&index="),n.push(t)),r&&(n.push("&act="),n.push(r)),n.push("&ticks="),n.push(Date.now()),n.join("")},output:function(e,t){Et.debug&&Et.log(t)},print:function(e){var t,r=850,n=1120,i=0,o=0,a=0,s="";for(bw.bHTML5Edition&&(K.bIE&&(n=1160),K.bFirefox&&(n=1150)),i=0;i<e.length;i++){var u=n,c=e[i],l=c.Width,d=c.Height,f=c.Url;l<=0&&(l=r),d<=0&&(d=u);var h=r/l,g=u/d;h<g?u=Math.floor(d*h):h>g&&(r=Math.floor(l*g)),o+=l,a+=d,s=s+'<div style="width:'+r+"px;height:"+u+'px"><img id="D_img'+i+'" src="'+f+'" style="position:relative;left:0px;top:0px;width: '+r+"px;height: "+u+'px" referrerpolicy="strict-origin-when-cross-origin" /></div>'}var p,m=["alwaysRaised=yes,z-look=yes,top=0,left=0,toolbar=no,menubar=no,location=no,status=no,width=",o,",height=",a].join(""),_=window.open("about:blank","_blank",m);t='<html><body id="D_img">'+s+"</body></html>",_&&(_.document.write(t),_.document.close(),_.focus(),(p=_.document.getElementById("D_img"))?p.onload=function(){_&&_.print(),Et.log("print image...ok")}:Et.log("cannot find image"))}};bt.html5.Funs2=kx;var Px,xx=Et.isString,Dx=Et.isArray,Fx=Et.each;function Wx(e,t){if(xx(t))e.push('"'),e.push(t),e.push('"');else if(Dx(t)){var r=oC;e.push("["),Fx(t,(function(t){r?r=iC:e.push(","),Wx(e,t)})),e.push("]")}else t===undefined?e.push('""'):e.push(t)}function Rx(){for(var e=[],t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(r.length>0)if(1===r.length){var i=r[0];e.push("["),Wx(e,i),e.push("]")}else if(2===r.length){var o=r[0],a=r[1];e.push("["),Wx(e,o),e.push(","),Wx(e,a),e.push("]")}else Wx(e,Array.prototype.slice.call(r));return e.join("")}function Nx(e){return e instanceof ArrayBuffer||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||window.Uint8ClampedArray&&e instanceof window.Uint8ClampedArray||e instanceof Float32Array||e instanceof Float64Array}!function(e){e.TWAINSCANNER=16,e.WIASCANNER=32,e.TWAINX64SCANNER=64,e.ICASCANNER=128,e.SANESCANNER=256,e.ESCLSCANNER=512,e.WIFIDIRECTSCANNER=1024,e.WIATWAINSCANNER=2048}(Px||(Px={}));var Ox=Px.TWAINSCANNER|Px.WIASCANNER|Px.TWAINX64SCANNER|Px.ICASCANNER|Px.SANESCANNER|Px.ESCLSCANNER|Px.WIFIDIRECTSCANNER|Px.WIATWAINSCANNER,Mx=Px.TWAINSCANNER|Px.WIASCANNER|Px.TWAINX64SCANNER|Px.ICASCANNER|Px.SANESCANNER,Lx=Px.TWAINSCANNER|Px.WIATWAINSCANNER|Px.TWAINX64SCANNER|Px.ICASCANNER|Px.SANESCANNER;Px.TWAINSCANNER,Px.WIASCANNER,Px.WIATWAINSCANNER;var Bx=Px.ESCLSCANNER|Px.WIFIDIRECTSCANNER,Ux=Px.TWAINSCANNER|Px.WIATWAINSCANNER,Vx=1;function Gx(){return(++Vx).toString()}function jx(){return["dwt_",Et.getRandom()].join("")}var Hx=0;function zx(e,t,r){if(Et.log("showMask:"+e+"--"+Hx),0==Hx)if(t){hx(t);var n=bt.mask.dlgMask;if(n){n.style.zIndex="10000";var i=Et.sizzle(".dynamsoft-backdrop",n.parentNode);i&&i.length>0&&(i[0].style.zIndex="10000")}}else hx(r||{});Hx++}function Kx(e){Et.log("hideMask:"+e+"--"+Hx),Hx>1?Hx--:Hx<=1&&(gx(),Hx=0)}var Jx=function(){function e(r,n){t(this,e),nC(this,"m_server",""),nC(this,"m_iUsingTime",0),nC(this,"m_countMap",{}),nC(this,"m_newConsum",!1),nC(this,"m_mapSavedToDb",!1),this.clearData(),this.m_enumInstance=r,r==xt.DWT.EnumInstance.dwt_desktop?(this.m_deploymentType="desktop",this.m_server=n):r==xt.DWT.EnumInstance.dbr&&(this.m_deploymentType="browser",this.m_server="")}return i(e,[{key:"clearData",value:function(){this.m_iUsingTime=0,this.m_jvUsingTime=Et.nil,this.m_countMap={},this.m_newConsum=!1,this.m_mapSavedToDb=!1,this.m_minExpiredTime=Et.nil,this.m_maxExpiredTime=Et.nil,this.m_cu=Et.nil,this.m_ar=Et.nil,this.m_ltsInstance=Et.nil}},{key:"set_cu",value:function(e){this.m_cu=e}},{key:"get_cu",value:function(){return this.m_cu}},{key:"set_ar",value:function(e){this.m_ar=e}},{key:"get_ar",value:function(){return this.m_ar}},{key:"get_ltsInstance",value:function(e){return this.m_ltsInstance||(this.m_ltsInstance=e(this.m_enumInstance)),this.m_ltsInstance}},{key:"inited_ltsInstance",value:function(){return!!this.m_ltsInstance}},{key:"set_maxExpiredTime",value:function(e){this.m_maxExpiredTime=e}},{key:"get_maxExpiredTime",value:function(){return this.m_maxExpiredTime}},{key:"set_minExpiredTime",value:function(e){this.m_minExpiredTime=e}},{key:"get_minExpiredTime",value:function(){return this.m_minExpiredTime}},{key:"get_deploymentType",value:function(){return this.m_deploymentType}},{key:"get_enumDeploymentType",value:function(){return this.m_enumInstance}}]),e}();var Qx=xt.DWT;Qx.LTS=Qx.LTS||{},Qx.licenseException={code:0,message:"",fromLTS:!1},Qx.bLTSOnline=!0,Qx.axInstance=undefined,Qx.lOnUpdateDWObj=[],Qx.EnumInstance={dwt_desktop:0,dwt_browser:1,dbr:2};var qx,Yx,Xx,Zx=0,$x={},eD=!1,tD=!1,rD=!1,nD=!1,iD=!1;function oD(){var e=bw.handshakeCode;return Et.isString(e)||(e=""),e}function aD(){var e=bw.organizationID;return Et.isNumber(e)?e=""+e:Et.isString(e)||(e=""),e}function sD(){return Et.replaceAll(uw.JSVersion,",",".")}function uD(e,t){var r=e;return r===Et.nil&&(r=Qx.EnumInstance.dwt_desktop),r==Qx.EnumInstance.dbr?(Xx||(Xx=new Jx(r,"")),Xx):(Yx||(Yx=new Jx(r,"")),Yx)}Qx.lupverfy=function(){uD(Qx.EnumInstance.dwt_desktop).get_ltsInstance(lD),uD(Qx.EnumInstance.dbr).get_ltsInstance(lD)},Qx.lsmid=function(e,t){uD(Qx.EnumInstance.dwt_desktop).set_cu(e)},Qx.lsar=function(e,t){uD(Qx.EnumInstance.dwt_desktop).set_ar(e)},Qx.lsmid2b=function(e){uD(Qx.EnumInstance.dwt_desktop).set_cu(e)},Qx.lgar=function(e,t){uD(e).get_ar()},Qx.laddDWTObj=function(e){var t=!1;Et.each(Qx.lOnUpdateDWObj,(function(r){if(r==e)return t=!0,!1})),t||Qx.lOnUpdateDWObj.push(e)},Qx.lremoveDWTObj=function(e){Et.each(Qx.lOnUpdateDWObj,(function(t,r){if(t==e)return Qx.lOnUpdateDWObj.splice(r,1),!1}))},Qx.lsendUpdateEvt=function(e,t){var r=[];if(Et.each(Qx.lOnUpdateDWObj,(function(t){e==Qx.EnumInstance.dwt_desktop&&r.push(t)})),0==r.length)return bt.Promise.resolve();var n,i=r[0];return i._bAx?(Et.each(r,(function(t){t.SetLTSInfo(uD(e).get_ar(),uD(e).get_cu())})),i.GetLicenseInfo().then((function(r){r&&Et.isArray(r.Detail)&&r.Detail.length>0&&Qx.lsexp(e,r.Detail[0].ExpireDate,t)}))):(n=i.SetLTSLicenseAsync(uD(e).get_ar()).then((function(r){r&&Et.isArray(r.Detail)&&r.Detail.length>0&&Qx.lsexp(e,r.Detail[0].ExpireDate,t)})),Et.each(r,(function(t,r){0!=r&&t.SetLTSLicenseAsync(uD(e).get_ar())})),n)},Qx.lgcb=function(){var e=[];return K.bChrome?e.push("Chrome"):K.bFirefox?e.push("Firefox"):K.bEdge?e.push("Edge"):K.bIE?e.push("IE"):K.bSafari?e.push("Safari"):K.bOpera?e.push("Opera"):K.b360SE?e.push("360SE"):K.bTencentTraveler?e.push("TencentTraveler"):K.bMaxthon?e.push("Maxthon"):K.bMetaSr?e.push("MetaSr"):K.bTheWorld?e.push("TheWorld"):K.bUC?e.push("UC"):K.bHuaWeiBrowser&&e.push("HuaWeiBrowser"),e.push(K.strBrowserVersion),K.bWin?e.push("Windows"):K.bMac?e.push("Mac"):K.bLinux?e.push("Linux"):K.bAndroid?e.push("Android"):K.bChromeOS?e.push("ChromeOS"):K.bHarmonyOS?e.push("HarmonyOS"):Ax.bMobile?e.push("Mobile OS"):xt.navInfo.bEmbed&&e.push("Embed OS"),e.join(" ")};var cD={NetworkError:-2440,Timedout:-2441,JsonError:-2442,CorsError:-2443,Expired:-2445,LtsJsLoadError:-2446,UUIDError:-2447};function lD(e){var t,r,n=bw.licenseServer;if(n&&n.length>0)for(t=0;t<n.length;t++)r=n[t],Et.endsWith(r,"/")||(n[t]=r+"/");var i={dm:location.origin?Et.startsWith(location.origin,"http")?location.origin:"https://localhost":Et.startsWith(location.href,"http")?location.href:"https://localhost",lf:bt.localforage,btoa:Et.btoa,atob:Et.atob,sutlcb:function(){Et.isFunction(Qx.lonsend)&&Qx.lonsend()},fol:Qx.OnFirstOffline,dwt:!0};if(e==Qx.EnumInstance.dwt_browser||e==Qx.EnumInstance.dbr?i.feab=Qx.lfeab_wasm:i.feab=Qx.lfeab_ax,!K.bIE&&bw.ltsDebug&&(i.debugLog=console.log),xt.LTS&&xt.LTS._)return xt.LTS._.createLtsInstance(i);var o={},a=function(){return bt.Promise.reject({code:cD.LtsJsLoadError,message:"The dynamsoft.lts.js load failed."})};return o.i=a,o.s=a,o.u=a,o.caret=a,o}function dD(e,t){var r=null!=t?t:"",n=uD(e),i=n.get_enumDeploymentType();if(Qx.lclex(),n.get_ar()&&n.get_cu())return bt.Promise.resolve({ar:n.get_ar(),cu:n.get_cu()});var o={pd:Qx.lgpd(e),v:sD(),os:Qx.lgcb(),fn:Qx.DeviceFriendlyName||"",ls:bw.licenseServer,sp:bw.sessionPassword,l:bP.getLTSLicense(),mnet:function(){return n.get_maxExpiredTime()},mxet:function(){return n.get_minExpiredTime()},fol:Qx.OnFirstOffline};return o.dt=n.get_deploymentType(),i==Qx.EnumInstance.dwt_desktop?o.lsu=n.get_cu():i==Qx.EnumInstance.dbr||(o.dwt=!0,""!=n.get_cu()&&(o.lsu=n.get_cu()),o.updateLicense=function(e){n.set_ar(e.ar),n.get_cu()||n.set_cu(e.cu),Qx.lsendUpdateEvt(i,r)}),n.get_ltsInstance(lD).i(o).then((function(e){return n.get_ar()||n.set_ar(e.ar),n.get_cu()||n.set_cu(e.cu),e}))}function fD(){return Date.now()}function hD(e){var t=e?new Date(e):new Date,r="yyyy-MM-ddTHH:mm:ss.SSSZ",n={"M+":t.getUTCMonth()+1,"d+":t.getUTCDate(),"H+":t.getUTCHours(),"h+":t.getUTCHours()%12||12,"m+":t.getUTCMinutes(),"s+":t.getUTCSeconds(),"q+":Math.floor((t.getUTCMonth()+3)/3),"S+":t.getUTCMilliseconds()};for(var i in/(y+)/.test(r)&&(r=r.replace(RegExp.$1,(t.getUTCFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+i+")").test(r)&&(r=r.replace(RegExp.$1,1==RegExp.$1.length?n[i]:("000"+n[i]).substr(("000"+n[i]).length-RegExp.$1.length)));return r}function gD(e,t){e.__licenseInfo=t,function(e){e.__calic||(e.__calic=e.__licenseInfo)}(e)}function pD(e){var t=xt.DWT.licenseException;t.code=e.code,t.message=e.message,e&&(mD(e),e instanceof Error?Et.error(e):Et.error(Et.stringify(e)))}function mD(e){Et.isFunction(xt.DWT.OnWebTwainError)?xt.DWT.OnWebTwainError(e):Et.isFunction(window.Dynamsoft_OnError)&&window.Dynamsoft_OnError(e)}function _D(e){return e==vw.LicenseExpiredForDLS||e==vw.LicenseNoCoreForDLS||e==vw.LicenseNoCore||e==vw.LicenseInvalid||e==vw.LicenseExpired||e==vw.LicenseParseFailed||e==vw.LicenseIsFuture||e==vw.LicenseVersionNotCurrent}function vD(e){return e==vw.LicenseExpired}function yD(e){var t=0,r=e.message;Et.isNumber(e.code)?t=e.code:Et.isString(r)&&(t=-1),0!=t&&function(e,t){Et.isFunction(xt.OnLicenseError)&&xt.OnLicenseError(t,e)}(t,r)}function ID(e){yD(hA(e))}Qx.lgpd=function(e){return K.bWin&&e==Qx.EnumInstance.dwt_desktop?"dwt|dbr":"dwt"},Qx.lglic=dD,Qx.lgbuuid=function(){return""},Qx.lshow=function(){return{t:qx,t2:Zx,m:Et.stringify($x)}},Qx.lgct=function(e){switch(e){case 0:return"3011";case 1:return"3012";case 2:return"3014";case 3:return"3013";case 4:return"3015";case 14:return"3016";case 3001:return"3001";case 3002:return"3002";case 3003:return"3003";case 3004:return"3004";case 3005:return"3005";case 3006:return"3006";case 3007:return"3007";case 3008:return"3008";case 3009:return"3009";case 5001:return"5001";case 4001:return"4001";case 4002:return"4002";case 4003:return"4003"}return""},Qx.lcvrf=function(e){e&&setTimeout((function(){Qx.lcvrf_(e)}),1)},Qx.lcvrf_=function(e){var t;t=Qx.EnumInstance.dwt_desktop;var r,n=Qx.DeviceFriendlyName||"",i=Qx.lgcb(),o=uD(t),a={hs:oD(),og:aD(),cu:o.get_cu(),fn:n,cw:"",os:i,v:sD(),dt:o.get_deploymentType(),ed:"js"},s=function(e,t){var r,n,i=0;if(Et.isString(e)&&""!=e&&"{}"!=e&&t&&Et.isArray(t)&&!(t.length<1)){if(n=uD(t[0]),r=Et.parse(e),Qx.lclex(),0==Zx){var o=fD(),a="";Zx=o,qx=hD(o),$x={},i=0,Et.each(r,(function(e,t){(t<i||0==i)&&(i=t,a=e)})),i>0&&n.get_ltsInstance(lD).s(bw.licenseServer,a,i,!0).then((function(){}),(function(e){}))}Et.each(r,(function(e,t){var r=!1,o=parseInt(t);o>0&&o!=i&&(o+18e4<fD()&&(r=!0),n.get_ltsInstance(lD).s(bw.licenseServer,e,t,r).then((function(){}),(function(e){})))}))}};if(a.pd=Qx.lgpd(t),r=Et.stringify(a),!e._bAx){var u="GetBuffer",c=Rx(Et.replaceAll(r,'"','\\"')),l={cmd:u,cmdId:Gx(),sFun:s,fFun:function(){},params:[t]};return e._innerSendByWS(u,c,l,null,!0)}s(e.GetBuffer(r),[t,""])},Qx.lavrf=function(e,t,r,n){var i=1;if(""!=e){t>1&&(i=t);var o=fD();if(Zx>0&&Zx+18e4<o){tD?($x={},Qx.lavrf__unload()):Qx.lavrf__(!0,r,n);var a=fD()+1;Zx=a,qx=hD(a),$x={}}eD=!0,tD=!1,$x[e]?$x[e]+=i:$x[e]=i,0==Zx&&Qx.lavrf__(!0,r,n)}},Qx.lavrf_=function(e,t,r){if(eD){var n=1;e&&(n=e),setTimeout((function(){Qx.lavrf__(!1,t,r)}),n)}},Qx.lavrf__=function(e,t,r){var n,i,o,a=fD(),s=!1,u=!!e,c=0,l=t;Et.isUndefined(l)&&(l=Qx.EnumInstance.dwt_desktop),o=uD(l),eD=!1,0==Zx&&(s=!0,Zx=a,qx=hD(a)),n=Zx,i=qx;var d={};d.ut=i;var f={};if(Et.each($x,(function(e,t){f[t]=e,e>0&&c++})),d.cts=f,u||n+18e4<a){u=!0;var h=fD()+1;if(Zx=h,qx=hD(h),$x={},tD=!1,0==c)return}else{if(0==c)return;tD=!0}d.dur=s?1:180;var g,p=Qx.DeviceFriendlyName||"",m=Qx.lgcb(),_={hs:oD(),og:aD(),cu:o.get_cu(),fn:p,cw:"",os:m,v:sD(),dt:o.get_deploymentType(),ed:"js",rcs:[d]};_.product=Qx.lgpd(t),g=Et.stringify(_),bw.ltsDebug&&hD(),Qx.lclex(),o.get_ltsInstance(lD).s(bw.licenseServer,g,""+n,u).then((function(){}),(function(e){}))},Qx.lavrf__unload=function(){var e,t=fD(),r=uD(Qx.EnumInstance.dwt_desktop),n=uD(Qx.EnumInstance.dbr);eD=!1,0==Zx&&(Zx=t,qx=hD(t)),e=Zx;var i=fD()+1;Zx=i,qx=hD(i),$x={},tD=!1,e+=1,Qx.lclex(),r.inited_ltsInstance()&&r.get_ltsInstance(lD).s(bw.licenseServer,false,""+e,true).then((function(){}),(function(e){})),n.inited_ltsInstance()&&n.get_ltsInstance(lD).s(bw.licenseServer,false,""+e,true).then((function(){}),(function(e){}))},Qx.lclex=function(){var e=Qx.licenseException;e.code=0,e.message="",e.httpResponse="",e.fromLTS=!1},Qx.li=function(e,t){var r;if(e.axInstance&&(Qx.axInstance=e.axInstance,Qx.axInstance))return r=Qx.axInstance.GetUUID(),bw.ltsDebug&&Et.log("ActiveX cu: "+r),uD(e.instanceMode).set_cu(r),r;return uD(e.instanceMode).get_cu()},Qx.lfeab_ax=function(e){return new bt.Promise((function(t,r){var n="";if(Qx.axInstance)try{n=Qx.axInstance.Encrypt(e,0)}catch(YV){}t(n)}))},Qx.lfeab_wasm=function(e){return bt.Promise.resolve("")},Qx.lwsproc=function(e,t){try{e=Et.parse(e)}catch(r){return void(t.fFun&&t.fFun(r))}"GetBuffer"==e.method?t.sFun&&e.result.length>0?t.sFun(e.result[0],t.params):t.sFun("",t.params):t.sFun&&t.sFun(e)},Qx.lsexp=function(e,t,r){var n,i=t;if(3==(n=(i=Et.replaceAll(i,"/","-")).split("-")).length){var o=n[0],a=n[1],s=n[2];a.length<2&&(a=(a="00"+a).substr(a.length-2)),s.length<2&&(s=(s="00"+s).substr(s.length-2)),i=[o,a,s].join("-")}var u=[i,"T23:59:59.999Z"].join("");uD(e).set_minExpiredTime(u),uD(e).set_maxExpiredTime(u)},Qx.lunload=function(){Qx.lavrf__unload();var e=uD(Qx.EnumInstance.dwt_desktop),t=uD(Qx.EnumInstance.dbr);e.clearData(),t.clearData(),Zx=0,qx=Et.nil,$x={},tD=!1,eD=!1,rD=!1,nD=!1,iD=!1,Qx.lclex(),Qx.bLTSOnline=!0,Qx.axInstance=Et.nil,Qx.lOnUpdateDWObj=[]},Qx.lcexp=function(e,t){return uD(e).get_ltsInstance(lD).caret().then((function(){return!1}),(function(e){var t=Qx.licenseException,r="";return e instanceof Error||"message"in e?r=e.message:Et.isString(e)&&(r=e),Qx.lsetException(cD.Expired,r,!1),nD||(nD=!0,Et.error(r),xt.OnLTSLicenseError&&xt.OnLTSLicenseError(bP.getPublicLicenseContent(t.message),t.code)),!0}))},Qx.OnLicenseException=function(){var e=Qx.licenseException,t=e.message;if(Et.isString(t)&&(t.indexOf("Error Code")>-1?t=Et.replaceAll(t,"Error Code","error code"):t.indexOf("Error code")>-1&&(t=Et.replaceAll(t,"Error code","error code"))),t.indexOf("(https://www.dynamsoft.com/purchase-center/)")>-1&&(t=t.replace("(https://www.dynamsoft.com/purchase-center/)","(https://www.dynamsoft.com/store/dynamic-web-twain/)"),e.message=t),t.indexOf("error code:")>-1){var r=t.substr(0,t.indexOf("message")),n=t.substr(t.indexOf("message"));r.indexOf("{")>-1&&(r=r.substr(r.indexOf("{")+1)),n.indexOf("}")>-1&&(n=n.substr(0,n.indexOf("}"))),r=Et.replaceAll(r,"error code:",""),n=Et.replaceAll(n,"message: ",""),Qx.lsetException(parseInt(r),n,!0),Et.error(n),xt.OnLTSLicenseError&&xt.OnLTSLicenseError(bP.getPublicLicenseContent(t),e.code)}else{if(!e.code){var i=cD.NetworkError;t.indexOf("timed out")>-1||t.indexOf("timeout")>-1?i=cD.Timedout:(t.indexOf("access-control-allow-origin")>-1||t.indexOf("cors")>-1)&&(i=cD.CorsError),Qx.lsetException(i,t,!0)}if(Et.error(e.message),e.code==cD.LtsJsLoadError)return;xt.OnLTSLicenseError&&xt.OnLTSLicenseError(bP.getPublicLicenseContent(e.message),e.code)}},Qx.lol=function(){return Qx.bLTSOnline},Qx.OnFirstOffline=function(e){Qx.bLTSOnline=!1},Qx.lpubdlg=function(e,t){if(Et.isString(e)&&""!=e){if(e=Et.atob(e),console&&console.warn,1==t)return rD||(rD=!0,xt.OnLTSPublicLicenseWarning&&xt.OnLTSPublicLicenseWarning(bP.getPublicLicenseContent(e))),!0;2==t&&(rD||(rD=!0))}return!1},Qx.lcheckLic=function(e,t,r){var n=!1;if(t){if(Et.isArray(t.Detail)&&t.Detail.length>0){var i=t.Detail[0].ExpireDate;return Qx.lsexp(e,i,r),Qx.lcexp(e,r).then((function(e){var r=!1;e?r=!0:1!=t.Trial&&2!=t.Trial||(r=Qx.lpubdlg(t.Message,t.Trial)),r||Qx.bLTSOnline||iD||(iD=!0,xt.OnLTSConnectionWarning&&xt.OnLTSConnectionWarning())}))}1!=t.Trial&&2!=t.Trial||(n=Qx.lpubdlg(t.Message,t.Trial))}return n||Qx.bLTSOnline||iD||(iD=!0,xt.OnLTSConnectionWarning&&xt.OnLTSConnectionWarning()),bt.Promise.resolve()},Qx.lisValidID=function(e){if(Et.isString(e)&&""!=e)return!0;var t,r=Qx.licenseException;return Qx.lsetException(cD.UUIDError,"Failed to generate an ID for your device to license it: not enough permission.",!0),Et.error(r.message),t=r.message,xt.OnLTSLicenseError&&xt.OnLTSLicenseError(t,r.code),!1},Qx.lsetException=function(e,t,r){var n=Qx.licenseException;n.code=e,n.message=t,Et.isUndefined(r)||(n.fromLTS=r)},Qx.lgcuid=function(e){var t=xt.DWT.li({instanceMode:e},"");return t?bt.Promise.resolve(t):uD(e).get_ltsInstance(lD).u().then((function(e){return xt.DWT.lsmid(e,""),xt.DWT.lsmid2b(e),e}))};var SD,TD=i((function iJ(){t(this,iJ)}));function bD(e){var t=new TD;return t.server=e.server,t.normal=!0,e.attrs&&(t.attrs=Et.clone(e.attrs)),t}function CD(t,r,n){if(Et.isString(t)&&(t.indexOf("Function not found")>0||t.indexOf("Version not found")>0))r&&r(t);else{var i=t.data;if("object"===e(i))return i=null,t=null,void(n&&n());var o=i.replace(/\0/g,"");try{r&&r(o)}catch(a){Et.log(i),n&&n()}i=null,t=null}}function wD(e,t){e&&e.readyState!=SD.CLOSING&&e.readyState!=SD.CLOSED?e.readyState==SD.CONNECTING?(e.onerror=function(t){t&&Et.log("websocket error: "+t),e._reject&&(e._reject(),e._reject=null),e.close()},e.onclose=function(t){e.onclose=null,e.onerror=null,e.onmessage=null,e.onopen=null,e._reject=null},e.onopen=function(){e.readyState==SD.OPEN?(e.onopen=null,e.send(t)):e.readyState==SD.CONNECTING&&(e.onopen?setTimeout(e.onopen,100):e._reject&&(e._reject(),e._reject=null))}):e.readyState==SD.OPEN&&(e.onopen=null,e.send(t)):e._reject&&(e._reject(),e._reject=null)}function ED(e,t,r){var n,i=r;return i||(xt.DWT.ConnectWithSocket?Et.startsWith(e,"wss://")||Et.startsWith(e,"ws://")||(i=K.bSSL?"wss://":"ws://"):Et.startsWith(e,"https://")||Et.startsWith(e,"http://")||(i=K.bSSL?"https://":"http://")),t?(Et.endsWith(e,"/")&&(e=e.substring(0,e.length-1)),n=":"+t+"/"):Et.endsWith(e,"/")||(n="/"),[i,e,n].join("")}!function(e){e.CONNECTING=0,e.OPEN=1,e.CLOSING=2,e.CLOSED=3}(SD||(SD={}));var AD,kD=function(){function e(){t(this,e)}return i(e,null,[{key:"postStringDataByWS",value:function(e,t){return new bt.Promise((function(r,n){e.onmessage=function(t){CD(t,(function(t){r(t),e.close(),e=null}),(function(){n(),e.close(),e=null}))},e._reject=n,wD(e,t)}))}},{key:"postStringDataByWSUrl",value:function(t,r){var n=new bt.Promise((function(n,i){var o=e.newWebsocket(t,!1);o.onmessage=function(e){CD(e,(function(e){n(e),o.close(),o=null}),(function(){i(),o.close(),o=null}))},o._reject=i,wD(o,r)}));return K.bEdge&&n["catch"]((function(){return new bt.Promise((function(n,i){var o=e.newWebsocket(t,!0);o.onmessage=function(e){CD(e,(function(e){n(e),o.close(),o=null}),(function(){i(),o.close(),o=null}))},o._reject=i,wD(o,r)}))})),n}},{key:"newWebsocket",value:function(e,t){var r,n=Tw.wsProtocol,i=window.MozWebSocket;if(void 0!==i)r=n?new i(e,n):new i(e);else{var o=window.WebSocket;if(t){var a=window,s=parent;try{for(;a!=s&&s.WebSocket;)o=s.WebSocket,a=s.window,s=s.parent}catch(u){o=window.WebSocket}}r=n?new o(e,n):new o(e)}return r}},{key:"getWsUrl",value:function(e,t,r){var n=r;return n===undefined&&(n=K.bSSL),ED(e,t,n?"wss://":"ws://")}},{key:"getDDMUrl",value:function(e,t,r){var n,i,o="/";return Et.startsWith(e,"https://")?n=!0:Et.startsWith(e,"http://")?n=!1:e=(n=bt.detect.ssl)?"https://"+e:"http://"+e,i=n?"18626/":"18625/",Et.endsWith(e,"/")&&(o=""),t?[e,o,"ddm/",i,r].join(""):[e,o,r].join("")}},{key:"getModuleUrl",value:function(e){var t;return t=ED(lw(),K.bSSL?Tw.SSLPort:Tw.Port),e?t+e:t}}]),e}();xt.DWT.NetManager=kD,function(e){e.ST_UNKNOWN=0,e.ST_TWAIN_DIRECT=1,e.ST_DYNAMSOFT_SERVICE=2,e.ST_ESCL=3,e.ST_WIFI_DIRECT=4}(AD||(AD={}));var PD,xD,DD=function(){function e(r){t(this,e);var n=this;if(n._id=r.id,n._clientId=Et.getRandom(),n._uuidForActiveUI=null,n._bReady=iC,n._destroy=iC,n._bMustUpgradeService=iC,n._wsClient=null,n._wsRetry=0,n._wsFailedTimes=0,n._bConnecting=iC,n._bNoMask=iC,n._bNotShowMessage=iC,n.__serverPlatform=OC.enumWindow,n.__productKey="",n.__licenseInfo=null,n._reconnectTimeSpan=Cw.RemoteReconnectTimeSpan,n._reconnectShortSpan=300,n._reconnectShortSpanTimes=5,n._bIfShowProgressBar=oC,n.__IfShowCancelDialogWhenImageTransfer=oC,this._bLicenseErrorDispose=!0,r.dmService){var i,o,a,s,u,c,l=bD(r.dmService),d="/",f="";o=l.server;var h=new hC(r.dmService.server),g=h.scheme;g&&(g=g.toLowerCase()),"https"==g?(i=!0,a=o.substring(8)):"http"==g?(i=!1,a=o.substring(7)):"wss"==g?(i=!0,a=o,o=Et.replaceAll(o,"wss://","")):"ws"==g?(i=!1,a=o,o=Et.replaceAll(o,"ws://","")):(a=o,o=(i=bt.detect.ssl)?"https://"+o:"http://"+o),Aw(h.hostname||h.scheme)?n._bRemoteMode=iC:n._bRemoteMode=oC,Et.endsWith(o,"/")&&(d="");var p=l.attrs;if(p){var m,_;s=(null===(m=p)||void 0===m?void 0:m.UUID)||"";var v=(null===(_=p.modules)||void 0===_?void 0:_.length)||0;if(""!=s&&v>0){var y;i?v>1&&v>1+(y=p.modules[1])+2&&(u=p.modules[1+y+2]):v>2&&(u=p.modules[2]),Et.endsWith(u,"/")&&(d=""),f=[s,"/",u,"/"].join("")}}else p={UUID:"",service_type:AD.ST_DYNAMSOFT_SERVICE};c=[o,d,f].join(""),p.url=c,n._serverInfo=new iA([a,d,f].join(""),null,i,!0,Tw.wsProtocol),n._httpUrl=c,n._dmService=l}else{var I,S=r.port,T=bt.detect.ssl;Aw(I=r.host?r.host:lw())?n._bRemoteMode=!1:n._bRemoteMode=!0,S||(S=T?Tw.SSLPort:Tw.Port),n._serverInfo=new iA(I,S,T,!0,Tw.wsProtocol),n._httpUrl=function(e){var t=e.server;if(t){if(Et.startsWith(t,"wss://")||Et.startsWith(t,"ws://"))return t}else t=lw();return e.ssl?["https://",t,":",e.port,"/"].join(""):["http://",t,":",e.port,"/"].join("")}(n._serverInfo),n._dmService={server:n._httpUrl,attrs:{url:n._httpUrl,UUID:"",service_type:AD.ST_DYNAMSOFT_SERVICE},normal:!0}}}return i(e,[{key:"_resetErr",value:function(){this._errorCode=0,this._errorString="";var e=xt.DWT.licenseException;e.code=0,e.message=""}},{key:"dispose",value:function(){this._bReady=iC,this._destroy=oC}},{key:"isDestroy",get:function(){return this._destroy}}]),e}(),FD=i((function oJ(){t(this,oJ)}));function WD(e,t){var r,n=[],i=t;if(Et.isString(i)&&(i=Et.parse(i)),Et.isArray(i))for(r=0;r<i.length;r++){var o=OD(i[r]);n.push(o)}for(r=0;r<n.length;r++){var a=n[r],s=a.deviceType;a.strDevice=Et.stringify(a),a.name&&(a.name=Et.base64.decode(a.name)),s&Ox&&a.deviceInfo&&ND(a.deviceInfo),a.serviceInfo=null==e?void 0:e._dmService,RD(a,null==e?void 0:e._dmService),Et.isBoolean(a.isSystemDefaultPrinter)||(a.isSystemDefaultPrinter=!1)}return n}function RD(e,t){var r,n=e.name,i="",o=e.deviceType;o==Px.TWAINSCANNER?r="":o==Px.TWAINX64SCANNER?r="Twain64-":o==Px.WIASCANNER?r="WIA-":o==Px.WIATWAINSCANNER?(n=Et.replaceAll(n,"WIA-",""),r="WIATWAIN-"):r=o==Px.ICASCANNER?"ICA-":o==Px.SANESCANNER?"Sane-":o==Px.ESCLSCANNER?"eSCL-":(Px.WIFIDIRECTSCANNER,""),t&&t.attrs&&t.attrs.ty&&(i=" on ["+t.attrs.ty+"]"),e.displayName=[r,n,i].join("")}function ND(e){if(e.ProductName){var t=e.ProductName;e.ProductName=Et.base64.decode(t)}if(e.ProductFamily){var r=e.ProductFamily;e.ProductFamily=Et.base64.decode(r)}if(e.Manufacturer){var n=e.Manufacturer;e.Manufacturer=Et.base64.decode(n)}if(e.Version&&e.Version.Info){var i=e.Version.Info;e.Version.Info=Et.base64.decode(i)}}function OD(e){var t=new FD;return e.deviceInfo&&(t.deviceInfo=Et.clone(e.deviceInfo)),e.deviceType&&(t.deviceType=Et.clone(e.deviceType)),e.displayName&&(t.displayName=Et.clone(e.displayName)),e.name&&(t.name=Et.clone(e.name)),e.serviceInfo&&(t.serviceInfo=bD(e.serviceInfo)),Et.isBoolean(e.isSystemDefaultPrinter)?t.isSystemDefaultPrinter=e.isSystemDefaultPrinter:t.isSystemDefaultPrinter=!1,t}function MD(e){var t=e||{};t.basePath&&(Ax.basePath=t.basePath),t.pathType&&(Ax.pathType=t.pathType),Et.isUndefined(t.bDiscardBlankImage)||(Ax.bDiscardBlankImage=t.bDiscardBlankImage),t.msgPrefix&&t.msgPrefix,t.msgSuffix&&t.msgSuffix,t.detectType&&(bt.detect.detectType=t.detectType),t.tryTimes&&(bt.detect.tryTimes=t.tryTimes);var r=xt.DWT.RemoteScanConfig;r||(r={sessionTimeout:300,keepAwake:!0},xt.DWT.RemoteScanConfig=r),r.keepAwake===undefined&&(r.keepAwake=!0)}function LD(){return!!Et.getWakeLock()}function BD(e){return UD.apply(this,arguments)}function UD(){return(UD=eA(g.mark((function e(t){var r;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Et.getWakeLock(),!t){e.next=7;break}if(null!=r){e.next=5;break}return e.next=5,Et.toggleWakeLock();case 5:e.next=10;break;case 7:if(!r){e.next=10;break}return e.next=10,Et.toggleWakeLock();case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function VD(e){return GD.apply(this,arguments)}function GD(){return(GD=eA(g.mark((function e(t){var r;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&((r=document.createElement("style")).innerHTML=['@import url("',xt.DWT.ResourcesPath,"/src/dynamsoft.webtwain.viewer.css",bt.timestamp,'")'].join(""),t.appendChild(r));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function jD(e){var t="application/octet-stream";switch(e){case xD.IT_BMP:t="image/bmp";break;case xD.IT_JPG:t="image/jpeg";break;case xD.IT_TIF:t="image/tiff";break;case xD.IT_PNG:t="image/png";break;case xD.IT_PDF:t="application/pdf";break;case xD.IT_J2K:t="image/jp2"}return t}bt.removeNonPrintableChar,function(e){e.SMF_NAME=1,e.SMF_TWAINVERSION=2,e.SMF_TWAINPROTOCOL=4,e.SMF_ICAUUID=8,e.SMF_ICAMODULEVERSION=16,e.SMF_ICALOCATIONTYPE=32}(PD||(PD={})),function(e){e.IT_BMP=0,e.IT_JPG=1,e.IT_TIF=2,e.IT_PNG=3,e.IT_PDF=4,e.IT_ALL=5,e.IT_MULTIPAGE_PDF=7,e.IT_MULTIPAGE_TIF=8,e.IT_J2K=14}(xD||(xD={}));var HD={isSupportLS:function(){var e=!1;if(K.bEdge&&K.bFileSystem);else try{e=!!window.localStorage}catch(VV){}return e},item:function(e,t,r){var n=null;return this.isSupportLS()?(t?(localStorage.setItem(e,t),n=t):n=localStorage.getItem(e),null===n?r:n):r},removeItem:function(e){return!!this.isSupportLS()&&(localStorage.removeItem(e),!0)}},zD=!0,KD=!1;function JD(e){if(Et.isUndefined(e))return KD;var t,r,n,i=e.toString().toLowerCase(),o=(n=i.toLowerCase().replace(bw.name.toLowerCase()+" ",""),(n=Et.replaceAll(n,"[.]",",")).split(","));t=bw.bActiveXEdition?uw.ActiveXVersion:bw.getServerVersionInfo(!0),r=(t=Et.replaceAll(String(t),"[.]",",")).split(",");for(var a=o.length>r.length?o.length:r.length,s=0;s<a;s++){if(null==o[s]&&(o[s]=0),null==r[s]&&(r[s]=0),parseInt(o[s])<parseInt(r[s]))return KD;if(parseInt(o[s])>parseInt(r[s]))return zD}return zD}function QD(e,t){var r=e.split(","),n=t.split(",");return r.length>3&&Et.trim(r[0])==n[0]&&(Et.trim(r[1])>n[1]||Et.trim(r[1])==n[1]&&Et.trim(r[2])>n[2]||Et.trim(r[1])==n[1]&&Et.trim(r[2])==n[2]&&parseInt(Et.trim(r[3]))>=parseInt(n[3]))}function qD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(VV){return!1}}();return function(){var r,n=cA(e);if(t){var i=cA(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return uA(this,r)}}function YD(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function XD(e,t,r){if(!t.has(e));return r}var ZD=new WeakSet,$D=new WeakSet,eF=function(e){sA(w,e);var r,n,o,a,s,u,c,l,d,f,h,p,m,_,v,y,I,S,T,b,C=qD(w);function w(e){var r;return t(this,w),YD(oA(r=C.call(this,e)),$D),YD(oA(r),ZD),r._acquireDivEL=null,r.__serverId="",r.__bAcquireImageNow=iC,r._blts=Ew(),r._b64bit=Tw.b64bit,r._logLevel=0,r._bServerAlwaysFocusOnPopupWindow=oC,r._bPageFocus=oC,r.__bOpenFileNow=iC,r._bScanForProxyRemote=iC,r}return i(w,[{key:"_isValid",value:function(){return!this._destroy||(_E(this),!1)}},{key:"_connnect",value:(b=eA(g.mark((function E(){var e;return g.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this,t.abrupt("return",new bt.Promise((function(t,r){var n,i;n=e._serverInfo.server,i=e._serverInfo.port,xt.DWT.CheckConnectToTheService(n,i,t,r)})));case 2:case"end":return t.stop()}}),E,this)}))),function(){return b.apply(this,arguments)})},{key:"_waitForConnect",value:function(){var e=this;return e._wsRetry=0,e._bReady?bt.Promise.resolve():new bt.Promise((function(t,r){e._wsCheckResolve=t,e._wsCheckReject=r,aF(e)}))}},{key:"_getWSCallback",value:function(){return sF}},{key:"_getWSContextData",value:function(){return""}},{key:"_additionalWSCallback",value:function(e,t,r,n){"GetLicenseInfo"==e?t._lic_callback=function(e){return r(e,pA.HANDLE_PROCESSED_MESSAGE,"0",n)}:"ConvertToBlob"==e&&t._blob_callbacks.push((function(e){return r(e,pA.HANDLE_RAW_MESSAGE,"0",n)}))}},{key:"_innerSendBlobByWS",value:function(e,t,r,n,i){var o={cmd:e,cmdId:Gx(),sFun:function(e){Et.isFunction(n)&&n(e)},fFun:i,contextData:{document:r.currentFileName,tag:r.currentTagName,bNeedClearTag:r.bNeedClearCurrentTagName},rawData:!0};return this._innerSendByWS(e,t,o,r,!0)}},{key:"_innerSendByWS",value:function(e,t,r,n,i){var o,a,s,u,c=this,l=this._getWSCallback();r&&r.cmdId?(o=r.cmdId,s=oF(c._clientId,o),u=oF(c._clientId,"")):(o=0,s=0,u=0);var d=iF(c._clientId,e,t,o,c._bScanForProxyRemote),f=c._wsClient;a={client:f,userData:{stwain:c,command:r},taskId:o,eventTaskId:s,lastEventTaskId:u};var h,g,p,m,_,v,y,I,S=0;if(!i){try{f.request(d,l,a)}catch(VV){Et.log(VV)}return iC}if(p=new ArrayBuffer(12),n)if(n instanceof Blob)S=n.size;else if(n instanceof ArrayBuffer||n instanceof Uint8Array)S=n.byteLength;else if(n instanceof Array)S=n.length;else{var T=n;S=T.size||T.byteLength||T.length}for(g=(h=(y=new Blob([d])).size)+S,m=new DataView(p),v=0;v<8&&g;v++)m.setUint8(v,g%256),g=Math.floor(g/256);for(v=0;v<4&&h;v++)m.setUint8(8+v,h%256),h=Math.floor(h/256);return _=new Blob([p,y]),I=f.request(_,l,a),this._additionalWSCallback(e,f,l,a),S>0&&(I=f.request(n,l,a)),p=null,y=null,_=null,m=null,n=null,I}},{key:"_sendDataConnectWithSocket",value:function(e,t,r,n){var i=this;return new bt.Promise((function(r,o){i._sendData(e,t,!0,(function(e){var t=!1;try{t=Et.isString(e)?Et.parse(e):e}catch(VV){}if(i._resetErr(),t){if(t instanceof Blob||Nx(t))return void r(t);gA(t)&&(i._errorCode=t.exception,i._errorString=t.description)}r(n?t:t.result)}),(function(e){o({code:i._errorCode,message:i._getErrorString()})}))}))}},{key:"_sendDataByHttpAsync",value:function(e,t,r,n,i){var o,a=this;if(a._resetErr(),!a._isValid())return bt.Promise.reject({code:a._errorCode,message:a._getErrorString()});if(w.isServerInvalid(a))return i?bt.Promise.reject({code:a._errorCode,message:a._getErrorString()}):a._waitForConnect().then((function(){return a._sendDataByHttpAsync(e,t,r)}));if(xt.DWT.ConnectWithSocket)return a._sendDataConnectWithSocket(e,t,r,n);o={method:"post",async:!0,body:iF(a._clientId,e,t,0,a._bScanForProxyRemote),dataType:null!=r?r:"text"};var s=null,u=Et.guid();return a._bIfShowProgressBar&&(s=bt.progressContext),YE(s,u)([a._httpUrl,"fa/",e].join(""),o).then((function(e){var t=!1;try{t=Et.isString(e)?Et.parse(e):e}catch(VV){}if(t){if(t instanceof Blob||Nx(t))return t;if(!gA(t))return a._resetErr(),n?t:t.result;a._errorCode=t.exception,a._errorString=t.description}else Uw(a);throw{code:a._errorCode,message:a._getErrorString()}}),(function(e){if(a._errorCode=e.code,a._errorString=e.message,!bt.page.bUnload)throw e}))}},{key:"_sendData",value:function(e,t,r,n,i){var o=this,a=null,s=null,u=!1,c=!0;if(!o._destroy){if("ActiveUI"==e?c=!1:u=w.isServerInvalid(o),u)return o._waitForConnect().then((function(){o._sendData(e,t,r,n,i)}))["catch"]((function(e){Et.isFunction(i)&&i(e.code,e.message)}));var l;Et.isFunction(n)&&(s=n),Et.isFunction(i)&&(a=i),l="GetLicenseInfo"==e||"ConvertToBlob"==e||"Heartbeat"==e?0:Gx();var d=this._getWSContextData(),f={cmd:e,cmdId:l,sFun:s,fFun:a,contextData:d,rawData:null!=r&&r};return o._innerSendByWS(e,t,f,null,c)}}},{key:"_innerFunV2",value:(T=eA(g.mark((function A(e,t,r){var n,i;return g.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(n=this,!r){o.next=7;break}return o.next=4,n._sendDataConnectWithSocket(e,t,"json",!0);case 4:i=o.sent,o.next=10;break;case 7:return o.next=9,n._sendDataByHttpAsync(e,t,"json",!0);case 9:i=o.sent;case 10:if(!(i&&Et.isArray(i)&&i.length>0)){o.next=12;break}return o.abrupt("return",i[0]);case 12:if(!(i&&Et.isArray(i.result)&&i.result.length>0)){o.next=14;break}return o.abrupt("return",i.result[0]);case 14:return o.abrupt("return",i);case 15:case"end":return o.stop()}}),A,this)}))),function(e,t,r){return T.apply(this,arguments)})},{key:"_OnReady",value:(S=eA(g.mark((function k(){var e,t;return g.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if((e=this)._wsRetry=0,e._wsFailedTimes=0,bt.detect.starting=!1,e._bRemoteMode||(bt.detect.bOK=!0),e._bReady=!0,null!==(t=e._wsClient.ws)){r.next=9;break}return r.abrupt("return");case 9:t.onopen=null,e._wsClient.addEvent("close",e._clientId,(function(t){t&&Et.log("websocket close: "+t),e.__bAcquireImageNow=!1,e._OnWSClose(t)})),e._wsClient.addEvent("error",e._clientId,(function(t){t&&Et.log("websocket error: "+t),e.__bAcquireImageNow=!1,e._OnWSError(t)})),e._wsClient.addEvent("timeout",e._clientId,(function(t){t&&Et.log("websocket timeout: "+t),e._OnWSTimeout(t)}));case 13:case"end":return r.stop()}}),k,this)}))),function(){return S.apply(this,arguments)})},{key:"getServiceInfo",value:function(){return this._dmService}},{key:"_OnWSClose",value:function(e){var t,r,n,i=this;(i._bReady=!1,i._wsRetry=0,i._bRemoteMode)&&(t=null!==(r=null===(n=i.getServiceInfo())||void 0===n||null===(n=n.attrs)||void 0===n?void 0:n.name)&&void 0!==r?r:"");AE(i,t),i.__closeRemoteScanUI(!0),i._heartBeatTimer&&(clearTimeout(i._heartBeatTimer),i._heartBeatTimer=null),i._bNoMask||function(e){Et.log("hideMask:"+e+"--"+Hx),gx(),Hx=0}("websocket close"),i.__OnWSClose&&i.__OnWSClose();var o=i._bRemoteMode?Cw.RemoteReconnectMaxTimes:Cw.LocalReconnectMaxTimes;if(i._wsFailedTimes<o){var a=i._reconnectTimeSpan;i._wsFailedTimes<i._reconnectShortSpanTimes&&(a=i._reconnectShortSpan),i._heartBeatTimer=setTimeout((function(){w.startDWTReconnect(i)}),a)}}},{key:"_OnWSError",value:function(e){var t=this;t._bReady=!1,t.__OnWSError&&t.__OnWSError()}},{key:"_OnWSTimeout",value:function(e){var t,r,n,i=this;(i._bReady=!1,i._wsRetry=0,i._bRemoteMode)&&(t=null!==(r=null===(n=i.getServiceInfo())||void 0===n||null===(n=n.attrs)||void 0===n?void 0:n.name)&&void 0!==r?r:"");AE(i,t),i.__closeRemoteScanUI(!0),i._heartBeatTimer&&(clearTimeout(i._heartBeatTimer),i._heartBeatTimer=null);var o=i._bRemoteMode?Cw.RemoteReconnectMaxTimes:Cw.LocalReconnectMaxTimes;if(i._wsFailedTimes<o){var a=i._reconnectTimeSpan;i._wsFailedTimes<i._reconnectShortSpanTimes&&(a=i._reconnectShortSpan),i._heartBeatTimer=setTimeout((function(){w.startDWTReconnect(i)}),a)}}},{key:"__OnRecieveMsg",value:function(e,t){var r=this;if(e.event)return r._handleEvent(e,t.contextData);if(xt.DWT.ConnectWithSocket){var n=e,i=null==t?void 0:t.cmd;return"ActiveUI"==i||"VersionInfo"==i||"ConvertToBase64"==i||"ConvertToBlob"==i?t.sFun&&Et.isArray(e.result)&&e.result.length>0?(t.sFun(e.result),!0):(t.fFun&&t.fFun(e.result),!1):(n=t.rawData?e:Et.isArray(e.result)&&e.result.length>0?e.result[0]:e.result,t.sFun?t.sFun(n):t.fFun&&t.fFun(n),e=null,!0)}if(gA(e)?(r._errorCode=e.exception,r._errorString=e.description):(r._errorCode=0,r._errorString=""),0==r._errorCode)return t.sFun&&Et.isArray(e.result)&&e.result.length>0?(t.sFun(e.result),!0):(t.fFun(e.result),!0);var o=!1;t.fFun&&(o=t.fFun(r._errorString)),!o&&e.exception&&e.exception<0&&-2115!=e.exception&&Et.isFunction(r.__OnPrintMsg)&&r.__OnPrintMsg(r._errorString)}},{key:"_handleOnBitmapChangedEvent",value:function(e,t){try{this._OnBitmapChanged(e.result,e,t)}catch(r){vA(r)}return oC}},{key:"_handleEvent",value:function(e,t){var r=this,n=e.result[0],i=iC;return"OnBitmapChanged"==e.event?r._handleOnBitmapChangedEvent(e,t):(Et.each(pF,(function(t,n){if(e.event===t){var o=["_",t].join("");return i=oC,Et.isFunction(r[o])&&r[o](e.result,e),iC}})),i?(Et.log("handled event:"+e.event),Et.each(mF,(function(t,i){if(e.event===t)return Et.log("sendback event:"+e.event),r._innerSendByWS(e.event,Rx(n),null,null,oC),iC}))):(Et.each(bt.Addon_Events,(function(t,n){if(e.event===t){var o=["_",t].join("");return i=oC,Et.isFunction(r[o])&&r[o](e.result),iC}})),i&&(Et.log("handled addon event:"+e.event),Et.each(bt.Addon_Sendback_Events,(function(t,i){if(e.event===t)return Et.log("sendback addon event:"+e.event),r._innerSendByWS(e.event,Rx(n),null,null,oC),iC})))),i)}},{key:"_setProductKeyAsync",value:function(e){var t=this,r=e;return t._resetErr(),t._isValid()?Et.isString(r)?bP.isLicenseMixed(r,!1)?bt.Promise.reject(xt.DWT.licenseException):bP.isLongKey(r)?XD(t,ZD,tF).call(t,r).then((function(e){var r=e;if(!r||r.message)throw Yw(t),r&&r.message&&(t._errorString=r.message),{code:t._errorCode,message:t._getErrorString()};return gD(t,r),r})):(Yw(t),bt.Promise.reject({code:t._errorCode,message:t._getErrorString()})):(Yw(t),bt.Promise.reject({code:t._errorCode,message:t._getErrorString()})):bt.Promise.reject({code:t._errorCode,message:t._getErrorString()})}},{key:"_setLTSLic",value:function(e){var t=this,r=e;return t._resetErr(),!!t._isValid()&&(Et.isString(r)?t._sendDataByHttpAsync("LTSLicense",Rx(r),null,!0).then((function(e){if(e){if(gA(e))throw t._errorCode=e.exception,t._errorString=e.description,{code:t._errorCode,message:t._getErrorString()};var r="GetLicenseInfo";return xt.DWT.ConnectWithSocket?t._sendDataConnectWithSocket(r,null,"json",!0):t._sendDataByHttpAsync(r,null,"json",!0)}throw Yw(t),{code:t._errorCode,message:t._getErrorString()}})):(Yw(t),bt.Promise.reject({code:t._errorCode,message:t._getErrorString()})))}},{key:"_setLTSLicenseAsync",value:function(e){var t=this;return t._resetErr(),t._isValid()?Et.isString(e)?t._setLTSLic(e).then((function(e){var r=e;if(!r||r.message)throw Yw(t),r&&r.message&&(t._errorString=r.message),{code:t._errorCode,message:t._getErrorString()};return gD(t,r),t.__licenseInfo&&(t.__licenseInfo.LTS=!0),r})):(Yw(t),bt.Promise.reject({code:t._errorCode,message:t._getErrorString()})):bt.Promise.reject({code:t._errorCode,message:t._getErrorString()})}},{key:"_innerActiveUI",value:(I=eA(g.mark((function P(e){var t,r,n,i,o;return g.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t=this,r=bt.detect.ssl,n=dw(),t._bRemoteMode||(n=5),i="",t._blts&&(i=null!=e?e:""),a.next=6,new bt.Promise((function(e,o){t._sendData("ActiveUI",Rx(Ax.WSVersion,Ax.WSSession,1,i,r,1,n),!1,e,o)}));case 6:return o=a.sent,t=null,a.abrupt("return",o);case 9:case"end":return a.stop()}}),P,this)}))),function(e){return I.apply(this,arguments)})},{key:"_reconnected",value:(y=eA(g.mark((function x(e){var t,r,n,i,o,a,s,u;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=this)._wsFailedTimes=0,e.next=4,t._innerActiveUI(t._uuidForActiveUI);case 4:if(r=e.sent,n=!1,r&&(r.length>12?(t.__serverId=r[1],n=r[12]):r.length>8?(t.__serverId=r[1],n=r[8]):r.length>=2&&(t.__serverId=r[1])),t._bReady=!0,t._bRemoteMode||(bt.detect.bOK=!0),bt.detect.starting=!1,!n){e.next=20;break}return e.prev=11,e.next=14,t._removeAllImagesAsync("ActiveUI",!1);case 14:e.next=19;break;case 16:e.prev=16,e.t0=e["catch"](11),t._resetErr();case 19:kw(t,-2614,"The Dynamsoft Service has been restarted.");case 20:if(e.prev=20,!t._blts){e.next=30;break}return i=t._bRemoteMode&&null!==(o=null===(a=t._dmService)||void 0===a||null===(a=a.attrs)||void 0===a?void 0:a.UUID)&&void 0!==o?o:"",e.next=25,dD(xt.DWT.EnumInstance.dwt_desktop,i);case 25:return s=e.sent,e.next=28,t._setLTSLicenseAsync(s.ar);case 28:e.next=33;break;case 30:return u=bw.refProductKey,e.next=33,t._setProductKeyAsync(u);case 33:e.next=39;break;case 35:throw e.prev=35,e.t1=e["catch"](20),t._bRemoteMode&&Zw(t,!1),{code:t._errorCode,message:t._getErrorString()};case 39:return e.prev=39,t._bRemoteMode&&w.startHeartBeat(t),e.finish(39);case 42:case"end":return e.stop()}}),x,this,[[11,16],[20,35,39,42]])}))),function(e){return y.apply(this,arguments)})},{key:"_initRemoteDiv",value:function(){if(!this._acquireDivEL){var e=document.createElement("div");e.style.position="fixed",e.style.zIndex="510000",e.style.left="0",e.style.top="0";var t=document.createElement("img");t.className="ds-img-screen",e.appendChild(t),document.body.appendChild(e),this._acquireDivEL=e}}},{key:"getHeartBeatData",value:function(e){var t,r=iF(this._clientId,e.cmd,null,e.cmdId,this._bScanForProxyRemote),n=r.length,i=n,o=new ArrayBuffer(12+i),a=new DataView(o);for(t=0;t<8&&i;t++)a.setUint8(t,i%256),i=Math.floor(i/256);for(t=0;t<4&&n;t++)a.setUint8(8+t,n%256),n=Math.floor(n/256);for(t=0;t<r.length;t++)a.setUint8(12+t,r.charCodeAt(t));return o}},{key:"__closeRemoteScanUI",value:function(e){var t=this;if(t._acquireDivEL){var r=Et.sizzle(".ds-img-screen");t._acquireDivEL.evtFun?(r&&r.length>0&&Et.removeEventListener(r[0],"mouseup",t._acquireDivEL.evtFun),t._acquireDivEL.evtFun=null):r&&r.length>0&&Et.removeEventListener(r[0],"mouseup"),r&&r.length>0&&(r[0].src=""),e&&(document.body.removeChild(t._acquireDivEL),t._acquireDivEL=null)}}},{key:"_removeImageByIdAsync",value:(v=eA(g.mark((function D(e){var t;return g.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if((t=this)._resetErr(),t._isValid()){r.next=4;break}throw{code:t._errorCode,message:t._errorString};case 4:return r.next=6,t._innerFunV2("RemoveAllImages",Rx(e));case 6:return r.abrupt("return",r.sent);case 7:case"end":return r.stop()}}),D,this)}))),function(e){return v.apply(this,arguments)})},{key:"_removeAllImagesAsync",value:(_=eA(g.mark((function F(e,t){var r;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=this)._resetErr(),r._isValid()){e.next=4;break}throw{code:r._errorCode,message:r._getErrorString()};case 4:return e.next=6,r._innerFunV2("RemoveAllImages");case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),F,this)}))),function(e,t){return _.apply(this,arguments)})},{key:"_LicensePromptExpired",value:function(){}},{key:"_OnActiveUI",value:(m=eA(g.mark((function W(e){var t,r,n,i,o,a,s,u,c,l,d,f,h,p,m,_;return g.wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(t=this,n=!1,e&&e.length>=6?(e[2],r=e[5],i=!1,o=!1,a=0,e.length>12?(e[6],t._b64bit="64"==e[7],e[8],i=e[9],o=e[10],a=e[11],e[12]):e.length>8&&(i=e[6],o=e[7],a=e[8]),i?o&&a&&(t._bRemoteMode=!0):t._bRemoteMode=!0,Et.isString(r)&&("win"==r?t.__serverPlatform=OC.enumWindow:"linux"==r?t.__serverPlatform=OC.enumLinux:"mac"==r?t.__serverPlatform=OC.enumMac:"embed"==r?t.__serverPlatform=OC.enumEmbed:"chromeos"==r&&(t.__serverPlatform=OC.enumChromeOS))):n=!0,t._bMustUpgradeService=n,n){g.next=65;break}if(Mk("Activating the WebTwain instance..."),s=!1,!t._blts){g.next=43;break}return c=t._bRemoteMode&&null!==(l=null===(d=t._dmService)||void 0===d||null===(d=d.attrs)||void 0===d?void 0:d.UUID)&&void 0!==l?l:"",g.prev=10,g.next=13,dD(xt.DWT.EnumInstance.dwt_desktop,c);case 13:u=g.sent,g.next=26;break;case 16:if(g.prev=16,g.t0=g["catch"](10),cF(t,g.t0),!t._bLicenseErrorDispose){g.next=24;break}throw t._bRemoteMode||(vD(t._errorCode)?this._LicensePromptExpired():ID(t)),{code:t._errorCode,message:t._getErrorString()};case 24:Et.warn(t._getErrorString()),u=null;case 26:if(Mk(Yk),!u){g.next=40;break}return g.next=30,t._setLTSLicenseAsync(u.ar);case 30:return f=g.sent,xt.DWT.laddDWTObj(t),c="",t._bRemoteMode&&(c=null!==(h=null===(p=t._dmService)||void 0===p||null===(p=p.attrs)||void 0===p?void 0:p.UUID)&&void 0!==h?h:""),Mk(Xk),g.next=37,xt.DWT.lcheckLic(xt.DWT.EnumInstance.dwt_desktop,f,c);case 37:s=0==xt.DWT.licenseException.code,g.next=41;break;case 40:s=!1;case 41:g.next=60;break;case 43:return Mk(Yk),m=bw.refProductKey,g.prev=45,g.next=48,t._setProductKeyAsync(m);case 48:g.sent&&(s=!0),g.next=60;break;case 52:if(g.prev=52,g.t1=g["catch"](45),!t._bLicenseErrorDispose){g.next=58;break}throw g.t1;case 58:Et.warn(g.t1.message);case 59:s=!1;case 60:if(s&&(Mk(Xk),bP.checkProductKey(t,{Core:!0})||(_={code:t._errorCode,message:t._getErrorString()},t._resetErr(),xt.DWT.lclex(),K.bWin&&bP.checkProductKey(t,{Webcam:!0},!0)||(t._errorCode=_.code,t._errorString=_.message))),0==t._errorCode){g.next=65;break}if(t._bRemoteMode||(vD(t._errorCode)?this._LicensePromptExpired():ID(t)),!t._bLicenseErrorDispose){g.next=65;break}throw{code:t._errorCode,message:t._getErrorString()};case 65:t._bRemoteMode&&w.startHeartBeat(t);case 66:case"end":return g.stop()}}),W,this,[[10,16],[45,52]])}))),function(e){return m.apply(this,arguments)})},{key:"_innerConvertToArrayBufferAsync",value:(p=eA(g.mark((function R(e,t,r,n){var i,o,a,s,u;return g.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return i=this,o=r,a=null!=n?n:"arraybuffer",s=",",Et.isString(o)&&""!=o||(o="",s=""),u=["[",e,',"',t.join(","),'"',s,o,"]"].join(""),c.next=6,i._sendDataByHttpAsync("ConvertToBlob",u,a,!0);case 6:return c.abrupt("return",c.sent);case 7:case"end":return c.stop()}}),R,this)}))),function(e,t,r,n){return p.apply(this,arguments)})},{key:"_getImageByServerId",value:(h=eA(g.mark((function N(e){var t,r,n;return g.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return t=xD.IT_PNG,i.next=3,this._innerConvertToArrayBufferAsync(t,[e],void 0,void 0);case 3:return r=i.sent,n=jD(t),i.abrupt("return",new Blob([r],{type:n}));case 6:case"end":return i.stop()}}),N,this)}))),function(e){return h.apply(this,arguments)})},{key:"_getSourcesAsync",value:(f=eA(g.mark((function O(e,t,r){var n,i;return g.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return n=this,o.next=3,n._innerFunV2("GetSources",Rx(e,null!=t&&t,null!=r&&r));case 3:return i=o.sent,o.abrupt("return",WD(this,i));case 5:case"end":return o.stop()}}),O,this)}))),function(e,t,r){return f.apply(this,arguments)})},{key:"_getDevices",value:(d=eA(g.mark((function M(e,t,r){var n,i,o,a,s,u;return g.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(i=[],o="getDevices",a=(n=this)._bRemoteMode?Mx:K.bAndroid?Bx:Mx,s=null!=e?e:a,n._resetErr(),n._isValid()){c.next=5;break}return c.abrupt("return",bt.Promise.reject({code:n._errorCode,message:n._getErrorString()}));case 5:return n._bNoMask||zx(o,n),c.prev=6,c.next=9,n._getSourcesAsync(s,t,r);case 9:u=c.sent,Et.isArray(u)&&u.length>0&&(i=i.concat(u)),c.next=16;break;case 13:throw c.prev=13,c.t0=c["catch"](6),c.t0;case 16:return c.prev=16,n._bNoMask||Kx(o),c.finish(16);case 19:return c.abrupt("return",i);case 20:case"end":return c.stop()}}),M,this,[[6,13,16,19]])}))),function(e,t,r){return d.apply(this,arguments)})},{key:"_innerAcquireImageFromService",value:function(e,t,r){var n,i,o=this;if(i=Et.clone(e),!bP.checkProductKey(o,{Core:!0}))return Et.isFunction(r)&&r(o._errorCode,o._getErrorString()),!1;var a=o._bRemoteMode?oC:iC,s=iC;i.RemoteScan=a?1:0,o._bRemoteMode&&(Et.isFunction(o.__OnRemoteScanStatusAsync)||(o.__OnRemoteScanStatusAsync=function(){}),Et.isFunction(o.__OnSourceUIClose)||(o.__OnSourceUIClose=function(){}));for(var u=0,c=0;c<fF.length;c++){var l=["__",fF[c]].join("");Et.isFunction(o[l])&&(u|=1<<c)}return i.EnableEvents=u,a&&(o._isBindViewer()||s)&&o._initRemoteDiv(),o._bRemoteMode||(o._bPageFocus&&xt.DWT.IfAlwaysFocusOnPopupWindow?o._bServerAlwaysFocusOnPopupWindow||o._OnPageFocus(!0):o._bServerAlwaysFocusOnPopupWindow&&o._OnPageBlur(!0)),n=["[",Et.stringify(i),"]"].join(""),o._sendData("AcquireImage",n,!0,(function(e){t(e)}),(function(e){r(o._errorCode,o._getErrorString())})),!0}},{key:"_acquireImageFromServiceAsync",value:function(e){var t=this;return new bt.Promise((function(r,n){return t._innerAcquireImageFromService(e,(function(){t._blts&&xt.DWT.lcvrf(t),r(!0)}),(function(e,t){n({code:e,message:t})}))}))}},{key:"_acquireImage",value:(l=eA(g.mark((function L(e,t){var r,n,i,o,a;return g.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(r=this,n=t?Et.clone(t):{},i="acuqireImage",r._resetErr(),r._isValid()){s.next=4;break}throw{code:r._errorCode,message:r._getErrorString()};case 4:if(bP.checkProductKey(r,{Core:!0})&&r._isValid()){s.next=6;break}throw{code:r._errorCode,message:r._getErrorString()};case 6:if(!r.__bAcquireImageNow){s.next=9;break}throw Nw(r),{code:r._errorCode,message:r._getErrorString()};case 9:return r.__bAcquireImageNow=!0,r._bNoMask||zx(i,r),o=xt.DWT.RemoteScanConfig,a=LD(),s.prev=12,lF(n),o&&BD(o.keepAwake),null!=e&&(n.Device=e.strDevice,n.DeviceMatchField=PD.SMF_NAME),s.next=18,r._acquireImageFromServiceAsync(n);case 18:s.next=23;break;case 20:throw s.prev=20,s.t0=s["catch"](12),s.t0;case 23:return s.prev=23,r.__bAcquireImageNow=!1,r._bNoMask||Kx(i),BD(a),s.finish(23);case 28:return s.abrupt("return",!0);case 29:case"end":return s.stop()}}),L,this,[[12,20,23,28]])}))),function(e,t){return l.apply(this,arguments)})},{key:"_getCapabilities",value:(c=eA(g.mark((function B(e,t){var r,n,i,o;return g.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return XD(r=this,$D,rF).call(r,e),r._initRemoteDiv(),t.next=5,r._innerSelectDeviceAsync(e);case 5:return t.next=7,r._sendDataByHttpAsync("GetCapabilities",null);case 7:if(n=t.sent,t.prev=8,n.length>0&&(o=n[0]),!Et.isString(o)){t.next=21;break}if(o=bt.removeNonPrintableChar(o),o=Et.replaceAll(o,"\\\\","\\\\"),0!=(i=JSON.parse(o)).errorCode){t.next=16;break}return t.abrupt("return",i.response);case 16:throw r._errorCode=i.errorCode,r._errorString=i.errorString,{code:r._errorCode,message:r._getErrorString()};case 21:throw NE(r),{code:r._errorCode,message:r._getErrorString()};case 23:t.next=30;break;case 25:throw t.prev=25,t.t0=t["catch"](8),r._errorCode=-2302,r._errorString=t.t0,{code:r._errorCode,message:r._getErrorString()};case 30:case"end":return t.stop()}}),B,this,[[8,25]])}))),function(e,t){return c.apply(this,arguments)})},{key:"_setCapabilities",value:(u=eA(g.mark((function U(e,t,r){var n,i;return g.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(XD(n=this,$D,rF).call(n,e),Et.isObject(t)&&!Et.isArray(t)){r.next=5;break}throw gE(n),{code:n._errorCode,message:n._getErrorString()};case 5:return n._initRemoteDiv(),r.next=8,n._innerSelectDeviceAsync(e);case 8:return i=["[",Et.stringify(t),"]"].join(""),r.next=11,n._sendDataByHttpAsync("SetCapabilities",i);case 11:return r.abrupt("return",r.sent);case 12:case"end":return r.stop()}}),U,this)}))),function(e,t,r){return u.apply(this,arguments)})},{key:"_closeSource",value:(s=eA(g.mark((function V(){var e;return g.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this,t.next=3,e._innerFunV2("CloseSource");case 3:case"end":return t.stop()}}),V,this)}))),function(){return s.apply(this,arguments)})},{key:"_innerSelectDeviceAsync",value:(a=eA(g.mark((function G(e,t){var r,n,i,o,a,s,u,c,l;return g.wrap((function(d){for(;;)switch(d.prev=d.next){case 0:if(n=this,e&&e instanceof FD){d.next=4;break}throw gE(n),{code:n._errorCode,message:n._errorString};case 4:if(!(i=null===(r=this._dmService.attrs)||void 0===r?void 0:r.UUID)){d.next=15;break}if((null===(o=e.serviceInfo.attrs)||void 0===o?void 0:o.UUID)!=i){d.next=9;break}d.next=15;break;case 9:if(!((s=(null===(a=e.serviceInfo.attrs)||void 0===a?void 0:a.url)||e.serviceInfo.server)&&s.indexOf(i)>-1)){d.next=13;break}d.next=15;break;case 13:throw wE(n),{code:n._errorCode,message:n._errorString};case 15:return u=null!=t?t:PD.SMF_NAME,c=["[",e.strDevice,",",u,"]"].join(""),d.next=18,n._sendDataByHttpAsync("SelectSourceEx",c,null,!0);case 18:if(!((l=d.sent)&&Et.isArray(l.result)&&l.result.length>0)){d.next=21;break}return d.abrupt("return",l.result[0]);case 21:return d.abrupt("return",l);case 22:case"end":return d.stop()}}),G,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"registerEvent",value:function(e,t){return!!this._registerEvent(e,t)}},{key:"unregisterEvent",value:function(e,t){return this._unregisterEvent(e,t)}},{key:"_registerEvent",value:function(e,t){var r=this;return r._resetErr(),!!r._isValid()&&(r[["__",e].join("")]=t,!0)}},{key:"_unregisterEvent",value:function(e,t){var r=this;return r._resetErr(),!!r._isValid()&&(r[["__",e].join("")]=null,oC)}},{key:"_OnPageFocus",value:function(e){var t=this;if(t._bPageFocus=!0,t._bReady&&K.bWin&&xt.DWT.IfAlwaysFocusOnPopupWindow){var r=Et.stringify({sequence:0,wnds:0,wnd:"0",type:3,x:0,y:0});if(t.__bAcquireImageNow||e||t.__bOpenFileNow){t._bServerAlwaysFocusOnPopupWindow=!0;try{t._isValid()&&t._sendDataByHttpAsync("SendEventToScannerUI",["[",r,"]"].join(""))}catch(n){}}}}},{key:"_OnPageBlur",value:function(e){var t=this;if(K.bWin&&t._bReady){var r=Et.stringify({sequence:0,wnds:0,wnd:"0",type:4,x:0,y:0});if((0!=t._bPageFocus||e)&&(t._bPageFocus=!1,t.__bAcquireImageNow||e||t.__bOpenFileNow)){t._bServerAlwaysFocusOnPopupWindow=!1;try{t._isValid()&&t._sendDataByHttpAsync("SendEventToScannerUI",["[",r,"]"].join(""))}catch(n){}}}}},{key:"_OnRemoteScanStatusAsync",value:function(e){var t,r,n,i,o,a,s,u=this;if(e&&e.length>=2){try{var c=new String(e[1]);t=Et.parse(c)}catch(d){Et.error(d.message),Et.log("parse json failed: "+e[1])}t||(t={sequence:0,screen:[]})}if(t&&t.sequence)if(t.sequence>0&&t.screen&&t.screen.length>0){if(r=t.screen,i=t.sequence,a=t.wnds,s=(n=r[0]).img,Et.isString(s)&&""!=s&&(o=n.wnd),i&&o){var l=Et.sizzle(".ds-img-screen");l&&l.length>0&&u._acquireDivEL&&(u._acquireDivEL.evtFun&&(Et.removeEventListener(l[0],"mouseup",u._acquireDivEL.evtFun),u._acquireDivEL.evtFun=null),l[0].src=s,u._acquireDivEL.evtFun=function(e){a||(a="0");var t=Et.stringify({sequence:i,wnds:a,wnd:o+"",type:2,x:e.offsetX,y:e.offsetY});u._sendDataByHttpAsync("SendEventToScannerUI",["[",t,"]"].join(""))},Et.addEventListener(l[0],"mouseup",u._acquireDivEL.evtFun))}}else u.__closeRemoteScanUI(!1);return Et.isFunction(u.__OnRemoteScanStatusAsync)&&u.__OnRemoteScanStatusAsync(t),!0}},{key:"_OnBitmapChanged",value:function(e,t,r){var n=this,i="10"==e[0];e[0];var o="c2"==e[0];e[1].split(",");var a=e[2],s=e[3];e[4];var u=-1,c=[];if(i);else if(o)e.length>5&&(c=e[5]),Et.isArray(c)||(c=[]);else{var l={};if(e.length>5&&(l.width=e[5]),e.length>6&&(l.height=e[6]),e.length>7&&(l.bitDepth=e[7]),e.length>8&&(l.resolutionX=e[8]),e.length>9&&(l.resolutionY=e[9]),e.length>10&&(u=e[10]),c.push(l),u>-1&&n._blts&&(a==dF.enumBCAppend||a==dF.enumBCInsert)){var d=xt.DWT.lgct(u);Et.isFunction(n.__OnLtsverify)&&n.__OnLtsverify(d,1)}if((a==dF.enumBCAppend||a==dF.enumBCInsert)&&Et.isFunction(n.__OnBufferChanged)){var f={action:"add",currentId:s,imageIds:[],selectedIds:[]};n.__OnBufferChanged(f)}}}},{key:"_OnPostTransferAsync",value:function(e,t,r){var n,i=this;if(e&&e.length>=2)try{var o=String(e[1]).replace(/\\/g,"\\\\");n=Et.parse(o)}catch(s){Et.error(s)}n||(n={imageId:-1});var a=!1;if(Et.isFunction(i.__OnPostTransferAsync))try{a=i.__OnPostTransferAsync(n)}catch(u){vA(u)}if(Et.isFunction(i.__OnPostTransferAsync2))try{i.__OnPostTransferAsync2(n)}catch(u){vA(u)}return a}},{key:"_getErrorCode",value:function(){return this._errorCode}},{key:"_getErrorString",value:function(){return 0!=this._errorCode?this._errorString:"Successful."}},{key:"_isBindViewer",value:function(){return!1}},{key:"_isNoViewer",value:function(){return!0}},{key:"_isMobileMode",value:function(){return!1}},{key:"_needCheckProxyRemoteScanLicense",value:function(){if(this._bScanForProxyRemote){if(""==this._strRemoteServiceVer)return!0;var e=function(e){var t=e.split(","),r=[18,3];return Et.trim(t[0])>r[0]||t.length>1&&Et.trim(t[0])==r[0]&&Et.trim(t[1])>=r[1]}(this._strRemoteServiceVer);if(e)return!0}return!1}}],[{key:"isServerInvalid",value:function(e){var t,r;if(t=!e._bReady||null===e._wsClient,r=e._bMustUpgradeService,t){var n,i,o;if(e._bRemoteMode)n=null!==(i=null===(o=e._dmService)||void 0===o||null===(o=o.attrs)||void 0===o?void 0:o.name)&&void 0!==i?i:"";AE(e,n)}else r?Ow(e):e.isDestroy&&_E(e);return t||r||-2208==e._errorCode||e.isDestroy}},{key:"STwainConnectToServer",value:(o=eA(g.mark((function j(e){var t,r;return g.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=e._id,!xt.DWT.WebTwainIdMap[t]){n.next=5;break}return n.next=4,e._OnReady();case 4:return n.abrupt("return");case 5:if(!e._bReady&&!e._destroy){n.next=7;break}return n.abrupt("return");case 7:return e._bConnecting=!0,(r=fk.Instance.getClient(e._serverInfo)).setRetry(0),e._bNoMask||zx("",e),n.prev=11,n.next=14,CP(e._bRemoteMode);case 14:return n.next=17,r.testConnection(void 0,0,void 0,1e4);case 17:if(e._wsClient=r,e._wsClient.bReady=!0,bt.detect.bFirst&&(vF(),bt.detect.bFirst=!1),e._bReady){n.next=24;break}return e._bReady=!0,n.next=24,e._OnReady();case 24:n.next=30;break;case 26:throw n.prev=26,n.t0=n["catch"](11),e._bReady=!1,{code:e._errorCode,message:e._getErrorString()};case 30:return n.prev=30,e._bConnecting=!1,e._bNoMask||Kx(""),n.finish(30);case 34:case"end":return n.stop()}}),j,null,[[11,26,30,34]])}))),function(e){return o.apply(this,arguments)})},{key:"_innerSendHeartBeat",value:(n=eA(g.mark((function H(e,t){var r,n,i,o;return g.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,!e.__bAcquireImageNow){a.next=4;break}a.next=14;break;case 4:if(r={client:null,userData:null,taskId:"0",eventTaskId:"0",lastEventTaskId:"0"},n=Gx(),i={cmd:"Heartbeat",cmdId:n,sFun:null,fFun:null,contextData:null,rawData:!0},o=e.getHeartBeatData(i),!e._wsClient){a.next=12;break}return e._wsClient.setRetry(0),a.next=12,e._wsClient.request(o,null,r);case 12:i=null,o=null;case 14:a.next=18;break;case 16:a.prev=16,a.t0=a["catch"](0);case 18:e._wsClient&&e._wsClient.connected&&t&&setTimeout((function(){w._innerSendHeartBeat(e,t)}),e._wsClient._heartBeatTicks);case 19:case"end":return a.stop()}}),H,null,[[0,16]])}))),function(e,t){return n.apply(this,arguments)})},{key:"startDWTReconnect",value:(r=eA(g.mark((function z(e){var t;return g.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,!e._destroy){r.next=3;break}return r.abrupt("return");case 3:return e._bConnecting=!0,(t=fk.Instance.getClient(e._serverInfo)).setRetry(0),r.next=9,t.testConnection(void 0,0,void 0,3e4);case 9:return e._wsClient=t,e._wsClient.bReady=!0,e._wsRetry=0,r.next=14,e._reconnected(t);case 14:r.next=19;break;case 16:r.prev=16,r.t0=r["catch"](0),e._wsFailedTimes++;case 19:return r.prev=19,e._bConnecting=!1,r.finish(19);case 22:case"end":return r.stop()}}),z,null,[[0,16,19,22]])}))),function(e){return r.apply(this,arguments)})},{key:"startHeartBeat",value:function(e){var t=e._wsClient;t&&t.connected&&!t._bHeartBeatStarted&&(t._bHeartBeatStarted=!0,setTimeout((function(){w._innerSendHeartBeat(e,!0)}),t._heartBeatTicks))}},{key:"getServerImageUrlPrefix",value:function(e){var t,r=e._httpUrl;return t=e._bScanForProxyRemote?Cw.getVersionStrForCheck():bw.getServerVersionInfo(),[r,"dwt/",bw.getDWTPrefix(),t,"/img?id=",e._clientId].join("")}}]),w}(DD);function tF(e){var t,r=this,n=e;return r._resetErr(),r._isValid()?(n=Et.isString(n)?Et.trim(n):"",t=r._sendDataByHttpAsync("ProductKey",Rx(n)),r.__productKey=n,t=t.then((function(e){if(Et.isArray(e)&&e.length>0){if(0!=r._errorCode)throw r.__productKey="",{code:r._errorCode,message:r._getErrorString()};xt.DWT.ProductKey=r.__productKey,bP.reparseProductKey();var n="GetLicenseInfo";return xt.DWT.ConnectWithSocket?r._sendDataConnectWithSocket(n,null,"json",!0):r._sendDataByHttpAsync(n,null,"json",!0)}throw Yw(r),t.context=null,{code:r._errorCode,message:r._getErrorString()}})),t):bt.Promise.reject({code:r._errorCode,message:r._getErrorString()})}function rF(e){return nF.apply(this,arguments)}function nF(){return(nF=eA(g.mark((function e(t){var r;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=this)._resetErr(),r._isValid()){e.next=4;break}return e.abrupt("return",bt.Promise.reject({code:r._errorCode,message:r._errorString}));case 4:if(t&&t instanceof FD){e.next=7;break}throw gE(r),{code:r._errorCode,message:r._errorString};case 7:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function iF(e,t,r,n,i){var o,a=[];return a.push("{"),a.push('"id":"'),a.push(e),a.push('"'),n&&(a.push(',"cmdId":"'),a.push(n),a.push('"')),a.push(',"method":"'),a.push(t),a.push('"'),a.push(',"module":"dwt","version":"'),o=i?[bw.getDWTPrefix(),Cw.getVersionStrForCheck()].join(""):[bw.getDWTPrefix(),bw.getServerVersionInfo()].join(""),a.push(o),a.push('"'),r!==undefined&&null!==r&&(a.push(',"parameter":'),a.push(r)),a.push("}"),a.join("")}function oF(e,t){return["evt",e,t].join("_")}function aF(e){if(e._bReady)e._wsCheckResolve();else{if(xt.DWT.bConnectCanceled)return Et.asyncQueue.stop(),kE(e),void e._wsCheckReject({code:e._errorCode,message:e._getErrorString()});if(e._wsRetry>10)return CE(e),void e._wsCheckReject({code:e._errorCode,message:e._getErrorString()});e._wsRetry++,setTimeout((function(){aF(e)}),1100)}}function sF(e,t,r,n){return uF.apply(this,arguments)}function uF(){return uF=eA(g.mark((function t(r,n,i,o){var a,s,u,c,l,d,f;return g.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n!=pA.GET_TASKID){t.next=4;break}return t.abrupt("return",o.taskId);case 4:if(n!=pA.GET_EVENT_TASKID){t.next=8;break}return t.abrupt("return",o.eventTaskId);case 8:if(n!=pA.ONMESSAGE_PROCESS_DATA){t.next=17;break}if("object"!==e(r)){t.next=11;break}return t.abrupt("return",r);case 11:if(!((c=r).indexOf("Version not found")>=0||c.indexOf("Function not found")>=0)){t.next=14;break}return t.abrupt("return",{cmdId:null!=i?i:0});case 14:return t.abrupt("return",Et.parse(r));case 17:if(n!=pA.ONMESSAGE_GET_TASKID){t.next=25;break}if(!r){t.next=22;break}if(!r.event){t.next=21;break}return t.abrupt("return",0);case 21:return t.abrupt("return",r.cmdId);case 22:return t.abrupt("return",r);case 25:if(n!=pA.ONMESSAGE_GET_EVENT_TASKID){t.next=31;break}if(!r||!r.event){t.next=28;break}return t.abrupt("return",oF(r.id,r.cmdId));case 28:return t.abrupt("return",0);case 31:if(n!=pA.HANDLE_RAW_MESSAGE){t.next=59;break}if(a=null==o?void 0:o.userData){t.next=35;break}return t.abrupt("return",!1);case 35:if(s=a.stwain,u=a.command){t.next=39;break}return t.abrupt("return",!1);case 39:if(s&&Et.isFunction(s.__OnWSMessage)&&s.__OnWSMessage(r),"object"!==e(r)){t.next=44;break}if(!xt.DWT.ConnectWithSocket){t.next=44;break}return"ConvertToBlob"!=u.cmd&&"GetImageByIndex"!=u.cmd||u.sFun(r),t.abrupt("return",!0);case 44:if(!((l=r.replace(/\0/g,"")).indexOf('"method" : "Heartbeat"')>=0)){t.next=47;break}return t.abrupt("return",!0);case 47:if(!(l.indexOf('"method" : "EnableBuffer"')>=0||l.indexOf('"method" : "GetBuffer"')>=0)){t.next=50;break}return xt.DWT.lwsproc(l,u),t.abrupt("return",!0);case 50:if(!(l.indexOf("Exception:")>=0||0==l.indexOf("Error"))){t.next=57;break}return d=r,f=!1,Et.log(d+"@"+u.cmd),u.fFun&&(f=u.fFun(d)),!f&&s&&Et.isFunction(s.__OnPrintMsg)&&s.__OnPrintMsg(d),t.abrupt("return",!0);case 57:t.next=70;break;case 59:if(n!=pA.HANDLE_PROCESSED_MESSAGE){t.next=70;break}if(a=null==o?void 0:o.userData){t.next=63;break}return t.abrupt("return",!1);case 63:if(s=a.stwain){t.next=66;break}return t.abrupt("return",!1);case 66:if(u=a.command){t.next=69;break}return t.abrupt("return",!1);case 69:return t.abrupt("return",s.__OnRecieveMsg(r,u));case 70:case"end":return t.stop()}}),t)}))),uF.apply(this,arguments)}function cF(e,t){if(t){var r=t.code||t.ltsErrorCode,n=t.message;111==r||106==r||108==r?(Zw(e,!1,r),111!=r||xt.DWT.isPublicLicense()||(e._errorString=n)):(e._errorCode=r,e._errorString=n),xt.DWT.lsetException(e._errorCode,e._getErrorString(),!0)}}function lF(e){e.Resolution!==undefined&&(e.Resolution=parseInt(e.Resolution)),e.PixelType!==undefined&&(e.PixelType=parseInt(e.PixelType)),e.SelectSourceByIndex!==undefined&&(e.SelectSourceByIndex=parseInt(e.SelectSourceByIndex))}var dF,fF=["OnPreAllTransfers","OnPreTransfer","OnPostTransfer","OnPostTransferAsync"];!function(e){e.enumBCAppend=1,e.enumBCInsert=2,e.enumBCRemove=3,e.enumBCEdit=4,e.enumBCIndexChange=5}(dF||(dF={}));var hF,gF,pF=["OnPostAllTransfers","OnPostTransfer","OnPostLoad","OnPreTransfer","OnPreAllTransfers","OnResult","OnTransferCancelled","OnTransferError","OnSourceUIClose","OnGetFilePath","OnPercentDone","OnPostTransferAsync","OnPreAllTransfersAsync","OnRemoteScanStatusAsync","OnConsumed"],mF=["OnPreAllTransfers","OnPreTransfer","OnPostTransfer","OnGetFilePath","OnPostLoad"],_F=Et.each;function vF(){var e,t=HD.item("DWT_port"),r=HD.item("DWT_ssl");if(Tw.bEnhancedMode)return!0;bt.detect.urls.splice(0),bt.detect.cUrlIndex=0,t!==hF&&r!==hF&&(e={port:t,ssl:"true"==r});var n=function(t){return!e||!(!t||t.port==e.port&&t.ssl==e.ssl)};1===bt.detect.detectType?(e!==hF&&e.ssl&&bt.detect.urls.push(e),_F(bt.detect.ports,(function(e){e.ssl&&n(e)&&bt.detect.urls.push(e)}))):0===bt.detect.detectType?(e===hF||e.ssl||bt.detect.urls.push(e),_F(bt.detect.ports,(function(e){!1===e.ssl&&n(e)&&bt.detect.urls.push(e)}))):(e!==hF&&bt.detect.urls.push(e),_F(bt.detect.ports,(function(e){n(e)&&bt.detect.urls.push(e)})))}!function(e){e.TWAIN=0,e.ICA=3,e.SANE=3,e.TWAIN_AND_ICA=4,e.TWAIN_AND_TWAIN64=4,e.TWAIN64=5}(gF||(gF={}));var yF={notSupportProperty:function(e){},notSupportMethod:function(e){},refreshImageAfterInvokeFun:function(e,t,r){return 1==r},loadHttpBlob:function(e,t,r,n,i,o,a,s){var u,c,l=iC;if(c={method:t,dataType:"blob"},s&&(c.headers=s),""!=e.HTTPUserName&&(c.username=e.HTTPUserName,c.password=e.HTTPPassword),e.__HTTPPostResponseString="",n){if("get"==t){var d=Et.guid();return bt.progressContext&&(bt.progressContext._onPercent=a),YE(bt.progressContext,d)(r,c).then((function(t){var r=t.type;if("text/plain"==r||"text/html"==r||"text/json"==r){var n=new FileReader;n.readAsText(t),n.onload=function(){e.__HTTPPostResponseString=n.result,i(t)},n.onerror=function(){i(t)}}else i(t)}),(function(t){t&&t.code?(e._errorCode=t.code,e._errorString=t.message):t&&t.httpCode?Hw(e,!1,t.message,t.httpCode):Gw(e),Et.isFunction(o)&&o({code:e._errorCode,message:e._errorString})})),!0}c.onSuccess=function(t,r,n){if((n?n.getResponseHeader("content-type"):"").indexOf("text/")>=0){var o=new FileReader;o.readAsText(t),o.onload=function(){e.__HTTPPostResponseString=o.result,i(t)},o.onerror=function(){i(t)}}else i(t)},Et.isFunction(a)&&(c.beforeSend=function(e){e.addEventListener("progress",(function(e){!K.bSafari&&e&&(delete e.totalSize,delete e.position),a(e)}),iC)}),l=oC}else K.bIE?(c.dataType="arraybuffer",c.onSuccess=function(t,r,n){var o,a;(o=t||n.responseData)&&(a=new Uint8Array(o)),e.__HTTPPostResponseString=n.responseText,e._errorCode=0,e._errorString="",i(a),a=null,l=oC}):(c.dataType="text",c.contentType="text/plain; charset=x-user-defined",c.mimeType="text/plain; charset=x-user-defined",c.onSuccess=function(t,r,n){var o,a,s;o=n.responseText,e.__HTTPPostResponseString=o,a=o.length,s=new Uint8Array(a);for(var u=0;u<a;u++)s[u]=o.charCodeAt(u);e._errorCode=0,e._errorString="",i(s),s=null,l=oC}),c.headers?Et.mix(c.headers,{"X-Requested-With":iC}):c.headers={"X-Requested-With":iC};if("post"==t){var f,h=e.httpFormFields;if(h)try{f=new FormData,Et.each(h,(function(e,t){if(e instanceof Blob){var r=e.name;f.append(t,e,r)}else f.append(t,e)})),Et.mix(c,{data:f,processData:iC,contentType:iC})}catch(VV){}}u=function(t,r,n){var i,a;(t&&Et.isArray(t)&&t.length>2?(i=t[1],a=t[2]):(i=r,a=n),2!=a.state&&3!=a.state||0!=a.status)?Hw(e,iC,i,a.status):"abort"===a.statusText?Hw(e,oC):Gw(e);Et.isFunction(o)&&o()},c.url=r,c.async=n,c.onError=u,c.onComplete=function(){e._cancelableObj=null};var g=RC(c);return n&&bt.progressContext&&(bt.progressContext._onPercent=a,e.IfShowCancelDialogWhenImageTransfer&&bt.progressContext.on("cancel",(function(){g.abort()}))),l},combineUrl:function(e,t,r){var n=[],i=t;return i===undefined||r===undefined?undefined:(Et.isString(i)||(i=String(t)),0==i.indexOf("http://")?(i=i.replace("http://",""),n.push("http://")):0==i.indexOf("https://")?(i=i.replace("https://",""),n.push("https://")):(0==i.indexOf("//")&&(i=i.replace("//","")),e.IfSSL?n.push("https://"):n.push("http://")),n.push(i),i.indexOf(":")<0&&(e.HTTPPort||(e.HTTPPort=bt.detect.ssl?443:80),(!bt.detect.ssl&&80!=e.HTTPPort||bt.detect.ssl&&443!=e.HTTPPort)&&(n.push(":"),n.push(e.HTTPPort))),0!==r.indexOf("/")&&n.push("/"),n.push(r),n.join(""))},httpPutImage:function(e,t,r,n,i,o,a){var s=oC,u={method:"PUT",url:t,hasContent:oC,processData:iC,async:n,data:r,onSuccess:i,onError:function(t,r,n){var i,a;(s=iC,t&&Et.isArray(t)&&t.length>2?(i=t[1],a=t[2]):(i=r,a=n),2!=a.state&&3!=a.state||0!=a.status)?jw(e,iC,i,a.status):"abort"===a.statusText?jw(e,oC):function(e){kw(e,-2304,"Http put error: the url is invalid.")}(e);Et.isFunction(o)&&o()},onComplete:function(){e._cancelableObj=null},beforeSend:function(e){Et.isFunction(a)&&e.upload.addEventListener("progress",(function(e){!K.bSafari&&e&&(delete e.totalSize,delete e.position),a(e)}),iC)}};""!=e.HTTPUserName&&(u.username=e.HTTPUserName,u.password=e.HTTPPassword),n||Et.mix(u,{headers:{"X-Requested-With":iC}});var c=RC(u);return bt.progressContext&&(bt.progressContext._onPercent=a,bt.progressContext._onCancel=function(){c.abort()}),s},GetImageInfo:function(e,t){var r=e._ImgManager.convertClientIndexToServerId(t);return-1==r?(oE(e),!1):e._innerFun("GetImageInfo",Rx(r))},getBlobTypeByImageType:jD,callbacks:[],pushCallback:function(e,t,r){var n={method:e,callback:t,ticks:r};yF.callbacks.push(n)},refreshUIRef:0,isServerInvalid:function(e){eF.isServerInvalid(e)},replaceLocalFilename:function(e){var t;return e===undefined?"":(t=(e=String(e)).replace(/\\/g,"\\\\"),K.bFileSystem&&(t=decodeURI(t)),t)},getImageType:function(e){if(e===undefined)return-1;if(e.length<4)return-1;var t=e.lastIndexOf(".");if(-1===t)return-1;var r=e.slice(t).toLowerCase();return".bmp"===r||".dib"===r?xt.DWT.EnumDWT_ImageType.IT_BMP:".jpg"===r||".jpe"===r||".jpeg"===r||".jfif"===r?xt.DWT.EnumDWT_ImageType.IT_JPG:".tif"===r||".tiff"===r?xt.DWT.EnumDWT_ImageType.IT_TIF:".png"===r?xt.DWT.EnumDWT_ImageType.IT_PNG:".pdf"===r?xt.DWT.EnumDWT_ImageType.IT_PDF:".jp2"===r||".j2k"===r||".j2c"===r?xt.DWT.EnumDWT_ImageType.IT_J2K:-1},makeParams:Rx,showMask:zx,hideMask:Kx};function IF(e,t,r,n,i){var o=0;return e==gF.TWAIN&&(o=Ux),e==gF.TWAIN64?o=Px.TWAINX64SCANNER:e==gF.ICA?r?o=Px.SANESCANNER:n?o=Px.ICASCANNER:(t||i)&&(o=Ux):e==gF.TWAIN_AND_TWAIN64&&(r?o=Ux|Px.SANESCANNER:n?o=Ux|Px.ICASCANNER:t?o=Ux|Px.TWAINX64SCANNER:i&&(o=Ux)),o}function SF(e,t){for(var r=e._ImgManager.GetServerIdList(),n=0;n<r.length;n++)t.push(r[n])}function TF(e,t){return 0!=e._ImgManager.count()||(Ww(e),Et.isFunction(t)&&t(e._errorCode,e._getErrorString()),!1)}function bF(e,t,r){return!!TF(e,r)&&(!(isNaN(t)||!Et.isNumber(t)||t<0||t>=e._ImgManager.count())||(oE(e),Et.isFunction(r)&&r(e._errorCode,e._getErrorString()),!1))}function CF(e){var t,r,n,i=[];return e._ImgManager.count()<=0||((r=e._ImgManager.getCurrentImageIndex())>=0&&(t=e._ImgManager.convertClientIndexToServerId(r)),n=e._ImgManager.getSelectedClientIndexArray(),Et.isArray(n)&&Et.each(n,(function(t){var r=e._ImgManager.convertClientIndexToServerId(t);-1!=r&&i.push(r)})),-1!=t&&0==i.length&&i.push(t)),i}function wF(e){var t,r=[];return e._ImgManager.count()<=0||(t=e._ImgManager.getCurrentImageIndex(),r=e._ImgManager.getSelectedClientIndexArray(),-1!=t&&0==r.length&&r.push(t)),r}function EF(e,t,r){return e._resetErr(),!!e._isValid()&&(isNaN(t)?(Dw(e),Et.isFunction(r)&&r(e._errorCode,e.ErrorString),iC):t<0||t>=e._ImgManager.count()?(oE(e),Et.isFunction(r)&&r(e._errorCode,e.ErrorString),iC):oC)}function AF(e,t,r,n,i){try{e(t,r,n,i)}catch(o){}t=r=n=i=null}function kF(e,t,r){try{e(t._errorCode,t._getErrorString(),r)}catch(n){}t=r=null}function PF(e,t,r,n,i,o){try{e(t._errorCode,t._getErrorString(),r,n,i,o)}catch(a){}t=r=n=i=o=null}function xF(){return xF="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=cA(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},xF.apply(this,arguments)}function DF(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function FF(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,c=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){c=!0,i=e}finally{try{if(!u&&null!=r["return"]&&(a=r["return"](),Object(a)!==a))return}finally{if(c)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return DF(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?DF(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}bt.html5.Funs=yF;var WF=function(){function e(){t(this,e),nC(this,"bIsDirty",!1),nC(this,"imageWidth",0),nC(this,"imageHeight",0),nC(this,"iImageControlWidth",0),nC(this,"iImageControlHeight",0),nC(this,"imageUrl",""),nC(this,"minImageUrl",""),nC(this,"uuid",-1),nC(this,"imageId",-1),nC(this,"aryOverlayRectangleData",[]),nC(this,"ticks",Date.now())}return i(e,[{key:"Clear",value:function(){this.imageUrl="",this.minImageUrl="",this.imageId=-1,this.aryOverlayRectangleData=[]}}]),e}(),RF=ao,NF=Gt,OF=pS,MF=h_,LF=Ri,BF=Dr,UF=ws,VF=Ot,GF=Mr("Reflect","construct"),jF=Object.prototype,HF=[].push,zF=VF((function(){function e(){}return!(GF((function(){}),[],e)instanceof e)})),KF=!VF((function(){GF((function(){}))})),JF=zF||KF;RF({target:"Reflect",stat:!0,forced:JF,sham:JF},{construct:function(e,t){MF(e),LF(t);var r=arguments.length<3?e:MF(arguments[2]);if(KF&&!zF)return GF(e,t,r);if(e===r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return NF(HF,n,t),new(NF(OF,e,n))}var i=r.prototype,o=UF(BF(i)?i:jF),a=NF(e,o,t);return BF(a)?a:o}});var QF=a(Fr.Reflect.construct),qF=a(Fr.Object.getOwnPropertySymbols),YF={exports:{}},XF=ao,ZF=Ot,$F=kr,eW=or.f,tW=ar;XF({target:"Object",stat:!0,forced:!tW||ZF((function(){eW(1)})),sham:!tW},{getOwnPropertyDescriptor:function(e,t){return eW($F(e),t)}});var rW=Fr.Object,nW=YF.exports=function(e,t){return rW.getOwnPropertyDescriptor(e,t)};rW.getOwnPropertyDescriptor.sham&&(nW.sham=!0);var iW=YF.exports,oW=a(iW),aW=Rp,sW=kr,uW=or,cW=Fo;ao({target:"Object",stat:!0,sham:!ar},{getOwnPropertyDescriptors:function(e){for(var t,r,n=sW(e),i=uW.f,o=aW(n),a={},s=0;o.length>s;)(r=i(n,t=o[s++]))!==undefined&&cW(a,t,r);return a}});var lW=a(Fr.Object.getOwnPropertyDescriptors),dW={exports:{}},fW=ao,hW=ar,gW=Ra.f;fW({target:"Object",stat:!0,forced:Object.defineProperties!==gW,sham:!hW},{defineProperties:gW});var pW=Fr.Object,mW=dW.exports=function(e,t){return pW.defineProperties(e,t)};pW.defineProperties.sham&&(mW.sham=!0);var _W=a(dW.exports),vW=Bv;ao({target:"Promise",stat:!0},{withResolvers:function(){var e=vW.f(this);return{promise:e.promise,resolve:e.resolve,reject:e.reject}}});var yW=RI,IW=Bv,SW=Iv;ao({target:"Promise",stat:!0,forced:!0},{"try":function(e){var t=IW.f(this),r=SW(e);return(r.error?t.reject:t.resolve)(r.value),t.promise}});var TW=yW,bW=a(TW);function CW(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(pC){return void r(pC)}s.done?t(u):bW.resolve(u).then(n,i)}function wW(e){return function(){var t=this,r=arguments;return new bW((function(n,i){var o=e.apply(t,r);function a(e){CW(o,n,i,a,s,"next",e)}function s(e){CW(o,n,i,a,s,"throw",e)}a(undefined)}))}}function EW(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var AW=xn,kW=cr,PW=Dr,xW=Ri,DW=function(e){return e!==undefined&&(AW(e,"value")||AW(e,"writable"))},FW=or,WW=ld;ao({target:"Reflect",stat:!0},{get:function aJ(e,t){var r,n,i=arguments.length<3?e:arguments[2];return xW(e)===i?e[t]:(r=FW.f(e,t))?DW(r)?r.value:r.get===undefined?undefined:kW(r.get,i):PW(n=WW(e))?aJ(n,t,i):void 0}});var RW=a(Fr.Reflect.get),NW=a(SS),OW=a(iW);ao({target:"Object",stat:!0},{setPrototypeOf:Od});var MW=Fr.Object.setPrototypeOf,LW=a(MW),BW=An,UW=ld,VW=rd;ao({target:"Object",stat:!0,forced:Ot((function(){UW(1)})),sham:!VW},{getPrototypeOf:function(e){return UW(BW(e))}});var GW=Fr.Object.getPrototypeOf,jW=a(GW);function HW(e){var t;return HW=LW?NW(t=jW).call(t):function(e){return e.__proto__||jW(e)},HW(e)}function zW(){var e;"undefined"!=typeof Reflect&&RW?zW=NW(e=RW).call(e):zW=function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=HW(e)););return e}(e,t);if(n){var i=OW(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}};return zW.apply(this,arguments)}ao({target:"Object",stat:!0,sham:!ar},{create:ws});var KW=Fr.Object,JW=function(e,t){return KW.create(e,t)},QW=a(JW);function qW(e,t){var r;return qW=LW?NW(r=LW).call(r):function(e,t){return e.__proto__=t,e},qW(e,t)}function YW(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=QW(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),po(e,"prototype",{writable:!1}),t&&qW(e,t)}var XW=a(Og);var ZW=a(sm),$W=An,eR=Eo,tR=up,rR=ko;ao({target:"Array",proto:!0,arity:1,forced:Ot((function(){return 4294967297!==[].push.call({length:4294967296},1)}))||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(pC){return pC instanceof TypeError}}()},{push:function(e){var t=$W(this),r=eR(t),n=arguments.length;rR(r+n);for(var i=0;i<n;i++)t[r]=arguments[i],r++;return tR(t,r),r}});var nR=Dh("Array").push,iR=Lr,oR=nR,aR=Array.prototype,sR=function(e){var t=e.push;return e===aR||iR(aR,e)&&t===aR.push?oR:t},uR=a(sR);var cR=Sg,lR=a(cR),dR=Ri,fR=vm,hR=ki,gR=cr,pR=An,mR=function(e,t,r,n){try{return n?t(dR(r)[0],r[1]):t(r)}catch(pC){fR(e,"throw",pC)}},_R=tm,vR=oa,yR=Eo,IR=Fo,SR=gm,TR=sm,bR=Array,CR=function(e){var t=pR(e),r=vR(this),n=arguments.length,i=n>1?arguments[1]:undefined,o=i!==undefined;o&&(i=hR(i,n>2?arguments[2]:undefined));var a,s,u,c,l,d,f=TR(t),h=0;if(!f||this===bR&&_R(f))for(a=yR(t),s=r?new this(a):bR(a);a>h;h++)d=o?i(t[h],h):t[h],IR(s,h,d);else for(l=(c=SR(t,f)).next,s=r?new this:[];!(u=gR(l,c)).done;h++)d=o?mR(c,i,[u.value,h],!0):u.value,IR(s,h,d);return s.length=h,s},wR=CR;ao({target:"Array",stat:!0,forced:!Vy((function(e){Array.from(e)}))},{from:wR});var ER=Fr.Array.from,AR=a(ER);function kR(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function PR(e,t){var r;if(e){if("string"==typeof e)return kR(e,t);var n=lR(r=Object.prototype.toString.call(e)).call(r,8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?AR(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?kR(e,t):void 0}}function xR(e,t){return function(e){if(XW(e))return e}(e)||function(e,t){var r=null==e?null:void 0!==Kf&&ZW(e)||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,c=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(uR(s).call(s,n.value),s.length!==t);u=!0);}catch(e){c=!0,i=e}finally{try{if(!u&&null!=r["return"]&&(a=r["return"](),Object(a)!==a))return}finally{if(c)throw i}}return s}}(e,t)||PR(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function DR(e){return function(e){if(XW(e))return kR(e)}(e)||function(e){if(void 0!==Kf&&null!=ZW(e)||null!=e["@@iterator"])return AR(e)}(e)||PR(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function FR(e,t,r){return(t=gh(t))in e?po(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var WR={exports:{}},RR={exports:{}};!function(e){var t=zf,r=lh;function n(i){return e.exports=n="function"==typeof t&&"symbol"==typeof r?function(e){return typeof e}:function(e){return e&&"function"==typeof t&&e.constructor===t&&e!==t.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports["default"]=e.exports,n(i)}e.exports=n,e.exports.__esModule=!0,e.exports["default"]=e.exports}(RR);var NR=RR.exports,OR=Bu.forEach,MR=Lh("forEach")?[].forEach:function(e){return OR(this,e,arguments.length>1?arguments[1]:undefined)};ao({target:"Array",proto:!0,forced:[].forEach!==MR},{forEach:MR});var LR=Dh("Array").forEach,BR=Vo,UR=xn,VR=Lr,GR=LR,jR=Array.prototype,HR={DOMTokenList:!0,NodeList:!0},zR=function(e){var t=e.forEach;return e===jR||VR(jR,e)&&t===jR.forEach||UR(HR,BR(e))?GR:t},KR=zR,JR=ao,QR=_o,qR=Jt([].reverse),YR=[1,2];JR({target:"Array",proto:!0,forced:String(YR)===String(YR.reverse())},{reverse:function(){return QR(this)&&(this.length=this.length),qR(this)}});var XR=Dh("Array").reverse,ZR=Lr,$R=XR,eN=Array.prototype,tN=function(e){var t=e.reverse;return e===eN||ZR(eN,e)&&t===eN.reverse?$R:t};!function(e){var t=NR["default"],r=go,n=zf,i=JW,o=GW,a=KR,s=sR,u=MW,c=TW,l=tN,d=cR;function f(){e.exports=f=function(){return g},e.exports.__esModule=!0,e.exports["default"]=e.exports;var h,g={},p=Object.prototype,m=p.hasOwnProperty,_=r||function(e,t,r){e[t]=r.value},v="function"==typeof n?n:{},y=v.iterator||"@@iterator",I=v.asyncIterator||"@@asyncIterator",S=v.toStringTag||"@@toStringTag";function T(e,t,n){return r(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{T({},"")}catch(h){T=function(e,t,r){return e[t]=r}}function b(e,t,r,n){var o=t&&t.prototype instanceof x?t:x,a=i(o.prototype),s=new G(n||[]);return _(a,"_invoke",{value:L(e,r,s)}),a}function C(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}g.wrap=b;var w="suspendedStart",E="suspendedYield",A="executing",k="completed",P={};function x(){}function D(){}function F(){}var W={};T(W,y,(function(){return this}));var R=o&&o(o(j([])));R&&R!==p&&m.call(R,y)&&(W=R);var N=F.prototype=x.prototype=i(W);function O(e){var t;a(t=["next","throw","return"]).call(t,(function(t){T(e,t,(function(e){return this._invoke(t,e)}))}))}function M(e,r){function n(i,o,a,s){var u=C(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==t(l)&&m.call(l,"__await")?r.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):r.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var i;_(this,"_invoke",{value:function(e,t){function o(){return new r((function(r,i){n(e,t,r,i)}))}return i=i?i.then(o,o):o()}})}function L(e,t,r){var n=w;return function(i,o){if(n===A)throw new Error("Generator is already running");if(n===k){if("throw"===i)throw o;return{value:h,done:!0}}for(r.method=i,r.arg=o;;){var a=r.delegate;if(a){var s=B(a,r);if(s){if(s===P)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===w)throw n=k,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=A;var u=C(e,t,r);if("normal"===u.type){if(n=r.done?k:E,u.arg===P)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n=k,r.method="throw",r.arg=u.arg)}}}function B(e,t){var r=t.method,n=e.iterator[r];if(n===h)return t.delegate=null,"throw"===r&&e.iterator["return"]&&(t.method="return",t.arg=h,B(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),P;var i=C(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,P;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=h),t.delegate=null,P):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,P)}function U(e){var t,r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),s(t=this.tryEntries).call(t,r)}function V(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function G(e){this.tryEntries=[{tryLoc:"root"}],a(e).call(e,U,this),this.reset(!0)}function j(e){if(e||""===e){var r=e[y];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(m.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=h,t.done=!0,t};return i.next=i}}throw new TypeError(t(e)+" is not iterable")}return D.prototype=F,_(N,"constructor",{value:F,configurable:!0}),_(F,"constructor",{value:D,configurable:!0}),D.displayName=T(F,S,"GeneratorFunction"),g.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===D||"GeneratorFunction"===(t.displayName||t.name))},g.mark=function(e){return u?u(e,F):(e.__proto__=F,T(e,S,"GeneratorFunction")),e.prototype=i(N),e},g.awrap=function(e){return{__await:e}},O(M.prototype),T(M.prototype,I,(function(){return this})),g.AsyncIterator=M,g.async=function(e,t,r,n,i){void 0===i&&(i=c);var o=new M(b(e,t,r,n),i);return g.isGeneratorFunction(t)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},O(N),T(N,S,"Generator"),T(N,y,(function(){return this})),T(N,"toString",(function(){return"[object Generator]"})),g.keys=function(e){var t=Object(e),r=[];for(var n in t)s(r).call(r,n);return l(r).call(r),function i(){for(;r.length;){var e=r.pop();if(e in t)return i.value=e,i.done=!1,i}return i.done=!0,i}},g.values=j,G.prototype={constructor:G,reset:function(e){var t;if(this.prev=0,this.next=0,this.sent=this._sent=h,this.done=!1,this.delegate=null,this.method="next",this.arg=h,a(t=this.tryEntries).call(t,V),!e)for(var r in this)"t"===r.charAt(0)&&m.call(this,r)&&!isNaN(+d(r).call(r,1))&&(this[r]=h)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,n){return o.type="throw",o.arg=e,t.next=r,n&&(t.method="next",t.arg=h),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],o=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var a=m.call(i,"catchLoc"),s=m.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&m.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,P):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),P},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),V(r),P}},"catch":function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;V(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:j(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=h),P}},g}e.exports=f,e.exports.__esModule=!0,e.exports["default"]=e.exports}(WR);var rN=(0,WR.exports)(),nN=rN;try{regeneratorRuntime=rN}catch(tJ){"object"==typeof globalThis?globalThis.regeneratorRuntime=rN:Function("r","regeneratorRuntime = r")(rN)}var iN=a(nN),oN=a(zR),aN=An,sN=es;ao({target:"Object",stat:!0,forced:Ot((function(){sN(1)}))},{keys:function(e){return sN(aN(e))}});var uN=a(Fr.Object.keys);ao({target:"Number",stat:!0},{isNaN:function(e){return e!=e}});var cN=a(Fr.Number.isNaN),lN=Dh("Array").concat,dN=Lr,fN=lN,hN=Array.prototype,gN=a((function(e){var t=e.concat;return e===hN||dN(hN,e)&&t===hN.concat?fN:t})),pN=Ot,mN=Hn("iterator"),_N=!pN((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,r=new URLSearchParams("a=1&a=2&b=3"),n="";return e.pathname="c%20d",t.forEach((function(e,r){t["delete"]("b"),n+=r+e})),r["delete"]("a",2),r["delete"]("b",undefined),!e.toJSON||!r.has("a",1)||r.has("a",2)||!r.has("a",undefined)||r.has("b")||!t.size&&true||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[mN]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://тест").host||"#%D0%B1"!==new URL("http://a#б").hash||"a1c3"!==n||"x"!==new URL("http://x",undefined).host})),vN=js,yN=function(e,t,r){for(var n in t)r&&r.unsafe&&e[n]?e[n]=t[n]:vN(e,n,t[n],r);return e},IN=Ns,SN=Math.floor,TN=function(e,t){var r=e.length,n=SN(r/2);return r<8?bN(e,t):CN(e,TN(IN(e,0,n),t),TN(IN(e,n),t),t)},bN=function(e,t){for(var r,n,i=e.length,o=1;o<i;){for(n=o,r=e[o];n&&t(e[n-1],r)>0;)e[n]=e[--n];n!==o++&&(e[n]=r)}return e},CN=function(e,t,r,n){for(var i=t.length,o=r.length,a=0,s=0;a<i||s<o;)e[a+s]=a<i&&s<o?n(t[a],r[s])<=0?t[a++]:r[s++]:a<i?t[a++]:r[s++];return e},wN=ao,EN=Nt,AN=cr,kN=Jt,PN=ar,xN=_N,DN=js,FN=zs,WN=yN,RN=pu,NN=Ad,ON=Du,MN=c_,LN=ir,BN=xn,UN=ki,VN=Vo,GN=Ri,jN=Dr,HN=Wa,zN=ws,KN=mr,JN=gm,QN=sm,qN=Ug,YN=TN,XN=Hn("iterator"),ZN="URLSearchParams",$N=ZN+"Iterator",eO=ON.set,tO=ON.getterFor(ZN),rO=ON.getterFor($N),nO=Object.getOwnPropertyDescriptor,iO=function(e){if(!PN)return EN[e];var t=nO(EN,e);return t&&t.value},oO=iO("fetch"),aO=iO("Request"),sO=iO("Headers"),uO=aO&&aO.prototype,cO=sO&&sO.prototype,lO=EN.RegExp,dO=EN.TypeError,fO=EN.decodeURIComponent,hO=EN.encodeURIComponent,gO=kN("".charAt),pO=kN([].join),mO=kN([].push),_O=kN("".replace),vO=kN([].shift),yO=kN([].splice),IO=kN("".split),SO=kN("".slice),TO=/\+/g,bO=Array(4),CO=function(e){return bO[e-1]||(bO[e-1]=lO("((?:%[\\da-f]{2}){"+e+"})","gi"))},wO=function(e){try{return fO(e)}catch(pC){return e}},EO=function(e){var t=_O(e,TO," "),r=4;try{return fO(t)}catch(pC){for(;r;)t=_O(t,CO(r--),wO);return t}},AO=/[!'()~]|%20/g,kO={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},PO=function(e){return kO[e]},xO=function(e){return _O(hO(e),AO,PO)},DO=NN((function(e,t){eO(this,{type:$N,iterator:JN(tO(e).entries),kind:t})}),"Iterator",(function(){var e=rO(this),t=e.kind,r=e.iterator.next(),n=r.value;return r.done||(r.value="keys"===t?n.key:"values"===t?n.value:[n.key,n.value]),r}),!0),FO=function(e){this.entries=[],this.url=null,e!==undefined&&(jN(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===gO(e,0)?SO(e,1):e:HN(e)))};FO.prototype={type:ZN,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,r,n,i,o,a,s,u=QN(e);if(u)for(r=(t=JN(e,u)).next;!(n=AN(r,t)).done;){if(o=(i=JN(GN(n.value))).next,(a=AN(o,i)).done||(s=AN(o,i)).done||!AN(o,i).done)throw dO("Expected sequence with length 2");mO(this.entries,{key:HN(a.value),value:HN(s.value)})}else for(var c in e)BN(e,c)&&mO(this.entries,{key:c,value:HN(e[c])})},parseQuery:function(e){if(e)for(var t,r,n=IO(e,"&"),i=0;i<n.length;)(t=n[i++]).length&&(r=IO(t,"="),mO(this.entries,{key:EO(vO(r)),value:EO(pO(r,"="))}))},serialize:function(){for(var e,t=this.entries,r=[],n=0;n<t.length;)e=t[n++],mO(r,xO(e.key)+"="+xO(e.value));return pO(r,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var WO=function(){MN(this,RO);var e=arguments.length>0?arguments[0]:undefined,t=eO(this,new FO(e));PN||(this.size=t.entries.length)},RO=WO.prototype;if(WN(RO,{append:function(e,t){var r=tO(this);qN(arguments.length,2),mO(r.entries,{key:HN(e),value:HN(t)}),PN||this.length++,r.updateURL()},"delete":function(e){for(var t=tO(this),r=qN(arguments.length,1),n=t.entries,i=HN(e),o=r<2?undefined:arguments[1],a=o===undefined?o:HN(o),s=0;s<n.length;){var u=n[s];if(u.key!==i||a!==undefined&&u.value!==a)s++;else if(yO(n,s,1),a!==undefined)break}PN||(this.size=n.length),t.updateURL()},get:function(e){var t=tO(this).entries;qN(arguments.length,1);for(var r=HN(e),n=0;n<t.length;n++)if(t[n].key===r)return t[n].value;return null},getAll:function(e){var t=tO(this).entries;qN(arguments.length,1);for(var r=HN(e),n=[],i=0;i<t.length;i++)t[i].key===r&&mO(n,t[i].value);return n},has:function(e){for(var t=tO(this).entries,r=qN(arguments.length,1),n=HN(e),i=r<2?undefined:arguments[1],o=i===undefined?i:HN(i),a=0;a<t.length;){var s=t[a++];if(s.key===n&&(o===undefined||s.value===o))return!0}return!1},set:function(e,t){var r=tO(this);qN(arguments.length,1);for(var n,i=r.entries,o=!1,a=HN(e),s=HN(t),u=0;u<i.length;u++)(n=i[u]).key===a&&(o?yO(i,u--,1):(o=!0,n.value=s));o||mO(i,{key:a,value:s}),PN||(this.size=i.length),r.updateURL()},sort:function(){var e=tO(this);YN(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){for(var t,r=tO(this).entries,n=UN(e,arguments.length>1?arguments[1]:undefined),i=0;i<r.length;)n((t=r[i++]).value,t.key,this)},keys:function(){return new DO(this,"keys")},values:function(){return new DO(this,"values")},entries:function(){return new DO(this,"entries")}},{enumerable:!0}),DN(RO,XN,RO.entries,{name:"entries"}),DN(RO,"toString",(function(){return tO(this).serialize()}),{enumerable:!0}),PN&&FN(RO,"size",{get:function(){return tO(this).entries.length},configurable:!0,enumerable:!0}),RN(WO,ZN),wN({global:!0,constructor:!0,forced:!xN},{URLSearchParams:WO}),!xN&&LN(sO)){var NO=kN(cO.has),OO=kN(cO.set),MO=function(e){if(jN(e)){var t,r=e.body;if(VN(r)===ZN)return t=e.headers?new sO(e.headers):new sO,NO(t,"content-type")||OO(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),zN(e,{body:KN(0,HN(r)),headers:KN(0,t)})}return e};if(LN(oO)&&wN({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(e){return oO(e,arguments.length>1?MO(arguments[1]):{})}}),LN(aO)){var LO=function(e){return MN(this,uO),new aO(e,arguments.length>1?MO(arguments[1]):{})};uO.constructor=LO,LO.prototype=uO,wN({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:LO})}}var BO,UO={URLSearchParams:WO,getState:tO},VO=ar,GO=Jt,jO=cr,HO=Ot,zO=es,KO=Vs,JO=lr,QO=An,qO=Sr,YO=Object.assign,XO=Object.defineProperty,ZO=GO([].concat),$O=!YO||HO((function(){if(VO&&1!==YO({b:1},YO(XO({},"a",{enumerable:!0,get:function(){XO(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},r=Symbol("assign detection"),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach((function(e){t[e]=e})),7!==YO({},e)[r]||zO(YO({},t)).join("")!==n}))?function(e,t){for(var r=QO(e),n=arguments.length,i=1,o=KO.f,a=JO.f;n>i;)for(var s,u=qO(arguments[i++]),c=o?ZO(zO(u),o(u)):zO(u),l=c.length,d=0;l>d;)s=c[d++],VO&&!jO(a,u,s)||(r[s]=u[s]);return r}:YO,eM=Jt,tM=2147483647,rM=/[^\0-\u007E]/,nM=/[.\u3002\uFF0E\uFF61]/g,iM="Overflow: input needs wider integers to process",oM=RangeError,aM=eM(nM.exec),sM=Math.floor,uM=String.fromCharCode,cM=eM("".charCodeAt),lM=eM([].join),dM=eM([].push),fM=eM("".replace),hM=eM("".split),gM=eM("".toLowerCase),pM=function(e){return e+22+75*(e<26)},mM=function(e,t,r){var n=0;for(e=r?sM(e/700):e>>1,e+=sM(e/t);e>455;)e=sM(e/35),n+=36;return sM(n+36*e/(e+38))},_M=function(e){var t=[];e=function(e){for(var t=[],r=0,n=e.length;r<n;){var i=cM(e,r++);if(i>=55296&&i<=56319&&r<n){var o=cM(e,r++);56320==(64512&o)?dM(t,((1023&i)<<10)+(1023&o)+65536):(dM(t,i),r--)}else dM(t,i)}return t}(e);var r,n,i=e.length,o=128,a=0,s=72;for(r=0;r<e.length;r++)(n=e[r])<128&&dM(t,uM(n));var u=t.length,c=u;for(u&&dM(t,"-");c<i;){var l=tM;for(r=0;r<e.length;r++)(n=e[r])>=o&&n<l&&(l=n);var d=c+1;if(l-o>sM((tM-a)/d))throw oM(iM);for(a+=(l-o)*d,o=l,r=0;r<e.length;r++){if((n=e[r])<o&&++a>tM)throw oM(iM);if(n===o){for(var f=a,h=36;;){var g=h<=s?1:h>=s+26?26:h-s;if(f<g)break;var p=f-g,m=36-g;dM(t,uM(pM(g+p%m))),f=sM(p/m),h+=36}dM(t,uM(pM(f))),s=mM(a,d,c===u),a=0,c++}}a++,o++}return lM(t,"")},vM=ao,yM=ar,IM=_N,SM=Nt,TM=ki,bM=Jt,CM=js,wM=zs,EM=c_,AM=xn,kM=$O,PM=CR,xM=Ns,DM=th.codeAt,FM=function(e){var t,r,n=[],i=hM(fM(gM(e),nM,"."),".");for(t=0;t<i.length;t++)r=i[t],dM(n,aM(rM,r)?"xn--"+_M(r):r);return lM(n,".")},WM=Wa,RM=pu,NM=Ug,OM=UO,MM=Du,LM=MM.set,BM=MM.getterFor("URL"),UM=OM.URLSearchParams,VM=OM.getState,GM=SM.URL,jM=SM.TypeError,HM=SM.parseInt,zM=Math.floor,KM=Math.pow,JM=bM("".charAt),QM=bM(/./.exec),qM=bM([].join),YM=bM(1..toString),XM=bM([].pop),ZM=bM([].push),$M=bM("".replace),eL=bM([].shift),tL=bM("".split),rL=bM("".slice),nL=bM("".toLowerCase),iL=bM([].unshift),oL="Invalid scheme",aL="Invalid host",sL="Invalid port",uL=/[a-z]/i,cL=/[\d+-.a-z]/i,lL=/\d/,dL=/^0x/i,fL=/^[0-7]+$/,hL=/^\d+$/,gL=/^[\da-f]+$/i,pL=/[\0\t\n\r #%/:<>?@[\\\]^|]/,mL=/[\0\t\n\r #/:<>?@[\\\]^|]/,_L=/^[\u0000-\u0020]+/,vL=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,yL=/[\t\n\r]/g,IL=function(e){var t,r,n,i;if("number"==typeof e){for(t=[],r=0;r<4;r++)iL(t,e%256),e=zM(e/256);return qM(t,".")}if("object"==typeof e){for(t="",n=function(e){for(var t=null,r=1,n=null,i=0,o=0;o<8;o++)0!==e[o]?(i>r&&(t=n,r=i),n=null,i=0):(null===n&&(n=o),++i);return i>r&&(t=n,r=i),t}(e),r=0;r<8;r++)i&&0===e[r]||(i&&(i=!1),n===r?(t+=r?":":"::",i=!0):(t+=YM(e[r],16),r<7&&(t+=":")));return"["+t+"]"}return e},SL={},TL=kM({},SL,{" ":1,'"':1,"<":1,">":1,"`":1}),bL=kM({},TL,{"#":1,"?":1,"{":1,"}":1}),CL=kM({},bL,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),wL=function(e,t){var r=DM(e,0);return r>32&&r<127&&!AM(t,e)?e:encodeURIComponent(e)},EL={ftp:21,file:null,http:80,https:443,ws:80,wss:443},AL=function(e,t){var r;return 2===e.length&&QM(uL,JM(e,0))&&(":"===(r=JM(e,1))||!t&&"|"===r)},kL=function(e){var t;return e.length>1&&AL(rL(e,0,2))&&(2===e.length||"/"===(t=JM(e,2))||"\\"===t||"?"===t||"#"===t)},PL=function(e){return"."===e||"%2e"===nL(e)},xL={},DL={},FL={},WL={},RL={},NL={},OL={},ML={},LL={},BL={},UL={},VL={},GL={},jL={},HL={},zL={},KL={},JL={},QL={},qL={},YL={},XL=function(e,t,r){var n,i,o,a=WM(e);if(t){if(i=this.parse(a))throw jM(i);this.searchParams=null}else{if(r!==undefined&&(n=new XL(r,!0)),i=this.parse(a,null,n))throw jM(i);(o=VM(new UM)).bindURL(this),this.searchParams=o}};XL.prototype={type:"URL",parse:function(e,t,r){var n,i,o,a,s,u=this,c=t||xL,l=0,d="",f=!1,h=!1,g=!1;for(e=WM(e),t||(u.scheme="",u.username="",u.password="",u.host=null,u.port=null,u.path=[],u.query=null,u.fragment=null,u.cannotBeABaseURL=!1,e=$M(e,_L,""),e=$M(e,vL,"$1")),e=$M(e,yL,""),n=PM(e);l<=n.length;){switch(i=n[l],c){case xL:if(!i||!QM(uL,i)){if(t)return oL;c=FL;continue}d+=nL(i),c=DL;break;case DL:if(i&&(QM(cL,i)||"+"===i||"-"===i||"."===i))d+=nL(i);else{if(":"!==i){if(t)return oL;d="",c=FL,l=0;continue}if(t&&(u.isSpecial()!==AM(EL,d)||"file"===d&&(u.includesCredentials()||null!==u.port)||"file"===u.scheme&&!u.host))return;if(u.scheme=d,t)return void(u.isSpecial()&&EL[u.scheme]===u.port&&(u.port=null));d="","file"===u.scheme?c=jL:u.isSpecial()&&r&&r.scheme===u.scheme?c=WL:u.isSpecial()?c=ML:"/"===n[l+1]?(c=RL,l++):(u.cannotBeABaseURL=!0,ZM(u.path,""),c=QL)}break;case FL:if(!r||r.cannotBeABaseURL&&"#"!==i)return oL;if(r.cannotBeABaseURL&&"#"===i){u.scheme=r.scheme,u.path=xM(r.path),u.query=r.query,u.fragment="",u.cannotBeABaseURL=!0,c=YL;break}c="file"===r.scheme?jL:NL;continue;case WL:if("/"!==i||"/"!==n[l+1]){c=NL;continue}c=LL,l++;break;case RL:if("/"===i){c=BL;break}c=JL;continue;case NL:if(u.scheme=r.scheme,i===BO)u.username=r.username,u.password=r.password,u.host=r.host,u.port=r.port,u.path=xM(r.path),u.query=r.query;else if("/"===i||"\\"===i&&u.isSpecial())c=OL;else if("?"===i)u.username=r.username,u.password=r.password,u.host=r.host,u.port=r.port,u.path=xM(r.path),u.query="",c=qL;else{if("#"!==i){u.username=r.username,u.password=r.password,u.host=r.host,u.port=r.port,u.path=xM(r.path),u.path.length--,c=JL;continue}u.username=r.username,u.password=r.password,u.host=r.host,u.port=r.port,u.path=xM(r.path),u.query=r.query,u.fragment="",c=YL}break;case OL:if(!u.isSpecial()||"/"!==i&&"\\"!==i){if("/"!==i){u.username=r.username,u.password=r.password,u.host=r.host,u.port=r.port,c=JL;continue}c=BL}else c=LL;break;case ML:if(c=LL,"/"!==i||"/"!==JM(d,l+1))continue;l++;break;case LL:if("/"!==i&&"\\"!==i){c=BL;continue}break;case BL:if("@"===i){f&&(d="%40"+d),f=!0,o=PM(d);for(var p=0;p<o.length;p++){var m=o[p];if(":"!==m||g){var _=wL(m,CL);g?u.password+=_:u.username+=_}else g=!0}d=""}else if(i===BO||"/"===i||"?"===i||"#"===i||"\\"===i&&u.isSpecial()){if(f&&""===d)return"Invalid authority";l-=PM(d).length+1,d="",c=UL}else d+=i;break;case UL:case VL:if(t&&"file"===u.scheme){c=zL;continue}if(":"!==i||h){if(i===BO||"/"===i||"?"===i||"#"===i||"\\"===i&&u.isSpecial()){if(u.isSpecial()&&""===d)return aL;if(t&&""===d&&(u.includesCredentials()||null!==u.port))return;if(a=u.parseHost(d))return a;if(d="",c=KL,t)return;continue}"["===i?h=!0:"]"===i&&(h=!1),d+=i}else{if(""===d)return aL;if(a=u.parseHost(d))return a;if(d="",c=GL,t===VL)return}break;case GL:if(!QM(lL,i)){if(i===BO||"/"===i||"?"===i||"#"===i||"\\"===i&&u.isSpecial()||t){if(""!==d){var v=HM(d,10);if(v>65535)return sL;u.port=u.isSpecial()&&v===EL[u.scheme]?null:v,d=""}if(t)return;c=KL;continue}return sL}d+=i;break;case jL:if(u.scheme="file","/"===i||"\\"===i)c=HL;else{if(!r||"file"!==r.scheme){c=JL;continue}switch(i){case BO:u.host=r.host,u.path=xM(r.path),u.query=r.query;break;case"?":u.host=r.host,u.path=xM(r.path),u.query="",c=qL;break;case"#":u.host=r.host,u.path=xM(r.path),u.query=r.query,u.fragment="",c=YL;break;default:kL(qM(xM(n,l),""))||(u.host=r.host,u.path=xM(r.path),u.shortenPath()),c=JL;continue}}break;case HL:if("/"===i||"\\"===i){c=zL;break}r&&"file"===r.scheme&&!kL(qM(xM(n,l),""))&&(AL(r.path[0],!0)?ZM(u.path,r.path[0]):u.host=r.host),c=JL;continue;case zL:if(i===BO||"/"===i||"\\"===i||"?"===i||"#"===i){if(!t&&AL(d))c=JL;else if(""===d){if(u.host="",t)return;c=KL}else{if(a=u.parseHost(d))return a;if("localhost"===u.host&&(u.host=""),t)return;d="",c=KL}continue}d+=i;break;case KL:if(u.isSpecial()){if(c=JL,"/"!==i&&"\\"!==i)continue}else if(t||"?"!==i)if(t||"#"!==i){if(i!==BO&&(c=JL,"/"!==i))continue}else u.fragment="",c=YL;else u.query="",c=qL;break;case JL:if(i===BO||"/"===i||"\\"===i&&u.isSpecial()||!t&&("?"===i||"#"===i)){if(".."===(s=nL(s=d))||"%2e."===s||".%2e"===s||"%2e%2e"===s?(u.shortenPath(),"/"===i||"\\"===i&&u.isSpecial()||ZM(u.path,"")):PL(d)?"/"===i||"\\"===i&&u.isSpecial()||ZM(u.path,""):("file"===u.scheme&&!u.path.length&&AL(d)&&(u.host&&(u.host=""),d=JM(d,0)+":"),ZM(u.path,d)),d="","file"===u.scheme&&(i===BO||"?"===i||"#"===i))for(;u.path.length>1&&""===u.path[0];)eL(u.path);"?"===i?(u.query="",c=qL):"#"===i&&(u.fragment="",c=YL)}else d+=wL(i,bL);break;case QL:"?"===i?(u.query="",c=qL):"#"===i?(u.fragment="",c=YL):i!==BO&&(u.path[0]+=wL(i,SL));break;case qL:t||"#"!==i?i!==BO&&("'"===i&&u.isSpecial()?u.query+="%27":u.query+="#"===i?"%23":wL(i,SL)):(u.fragment="",c=YL);break;case YL:i!==BO&&(u.fragment+=wL(i,TL))}l++}},parseHost:function(e){var t,r,n;if("["===JM(e,0)){if("]"!==JM(e,e.length-1))return aL;if(t=function(e){var t,r,n,i,o,a,s,u=[0,0,0,0,0,0,0,0],c=0,l=null,d=0,f=function(){return JM(e,d)};if(":"===f()){if(":"!==JM(e,1))return;d+=2,l=++c}for(;f();){if(8===c)return;if(":"!==f()){for(t=r=0;r<4&&QM(gL,f());)t=16*t+HM(f(),16),d++,r++;if("."===f()){if(0===r)return;if(d-=r,c>6)return;for(n=0;f();){if(i=null,n>0){if(!("."===f()&&n<4))return;d++}if(!QM(lL,f()))return;for(;QM(lL,f());){if(o=HM(f(),10),null===i)i=o;else{if(0===i)return;i=10*i+o}if(i>255)return;d++}u[c]=256*u[c]+i,2!=++n&&4!==n||c++}if(4!==n)return;break}if(":"===f()){if(d++,!f())return}else if(f())return;u[c++]=t}else{if(null!==l)return;d++,l=++c}}if(null!==l)for(a=c-l,c=7;0!==c&&a>0;)s=u[c],u[c--]=u[l+a-1],u[l+--a]=s;else if(8!==c)return;return u}(rL(e,1,-1)),!t)return aL;this.host=t}else if(this.isSpecial()){if(e=FM(e),QM(pL,e))return aL;if(t=function(e){var t,r,n,i,o,a,s,u=tL(e,".");if(u.length&&""===u[u.length-1]&&u.length--,(t=u.length)>4)return e;for(r=[],n=0;n<t;n++){if(""===(i=u[n]))return e;if(o=10,i.length>1&&"0"===JM(i,0)&&(o=QM(dL,i)?16:8,i=rL(i,8===o?1:2)),""===i)a=0;else{if(!QM(10===o?hL:8===o?fL:gL,i))return e;a=HM(i,o)}ZM(r,a)}for(n=0;n<t;n++)if(a=r[n],n===t-1){if(a>=KM(256,5-t))return null}else if(a>255)return null;for(s=XM(r),n=0;n<r.length;n++)s+=r[n]*KM(256,3-n);return s}(e),null===t)return aL;this.host=t}else{if(QM(mL,e))return aL;for(t="",r=PM(e),n=0;n<r.length;n++)t+=wL(r[n],SL);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"===this.scheme},includesCredentials:function(){return""!==this.username||""!==this.password},isSpecial:function(){return AM(EL,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"===this.scheme&&1===t&&AL(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,r=e.username,n=e.password,i=e.host,o=e.port,a=e.path,s=e.query,u=e.fragment,c=t+":";return null!==i?(c+="//",e.includesCredentials()&&(c+=r+(n?":"+n:"")+"@"),c+=IL(i),null!==o&&(c+=":"+o)):"file"===t&&(c+="//"),c+=e.cannotBeABaseURL?a[0]:a.length?"/"+qM(a,"/"):"",null!==s&&(c+="?"+s),null!==u&&(c+="#"+u),c},setHref:function(e){var t=this.parse(e);if(t)throw jM(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"===e)try{return new ZL(e.path[0]).origin}catch(pC){return"null"}return"file"!==e&&this.isSpecial()?e+"://"+IL(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(WM(e)+":",xL)},getUsername:function(){return this.username},setUsername:function(e){var t=PM(WM(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var r=0;r<t.length;r++)this.username+=wL(t[r],CL)}},getPassword:function(){return this.password},setPassword:function(e){var t=PM(WM(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var r=0;r<t.length;r++)this.password+=wL(t[r],CL)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?IL(e):IL(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,UL)},getHostname:function(){var e=this.host;return null===e?"":IL(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,VL)},getPort:function(){var e=this.port;return null===e?"":WM(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(""===(e=WM(e))?this.port=null:this.parse(e,GL))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+qM(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,KL))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){""===(e=WM(e))?this.query=null:("?"===JM(e,0)&&(e=rL(e,1)),this.query="",this.parse(e,qL)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){""!==(e=WM(e))?("#"===JM(e,0)&&(e=rL(e,1)),this.fragment="",this.parse(e,YL)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var ZL=function(e){var t=EM(this,$L),r=NM(arguments.length,1)>1?arguments[1]:undefined,n=LM(t,new XL(e,!1,r));yM||(t.href=n.serialize(),t.origin=n.getOrigin(),t.protocol=n.getProtocol(),t.username=n.getUsername(),t.password=n.getPassword(),t.host=n.getHost(),t.hostname=n.getHostname(),t.port=n.getPort(),t.pathname=n.getPathname(),t.search=n.getSearch(),t.searchParams=n.getSearchParams(),t.hash=n.getHash())},$L=ZL.prototype,eB=function(e,t){return{get:function(){return BM(this)[e]()},set:t&&function(e){return BM(this)[t](e)},configurable:!0,enumerable:!0}};if(yM&&(wM($L,"href",eB("serialize","setHref")),wM($L,"origin",eB("getOrigin")),wM($L,"protocol",eB("getProtocol","setProtocol")),wM($L,"username",eB("getUsername","setUsername")),wM($L,"password",eB("getPassword","setPassword")),wM($L,"host",eB("getHost","setHost")),wM($L,"hostname",eB("getHostname","setHostname")),wM($L,"port",eB("getPort","setPort")),wM($L,"pathname",eB("getPathname","setPathname")),wM($L,"search",eB("getSearch","setSearch")),wM($L,"searchParams",eB("getSearchParams")),wM($L,"hash",eB("getHash","setHash"))),CM($L,"toJSON",(function(){return BM(this).serialize()}),{enumerable:!0}),CM($L,"toString",(function(){return BM(this).serialize()}),{enumerable:!0}),GM){var tB=GM.createObjectURL,rB=GM.revokeObjectURL;tB&&CM(ZL,"createObjectURL",TM(tB,GM)),rB&&CM(ZL,"revokeObjectURL",TM(rB,GM))}RM(ZL,"URL"),vM({global:!0,constructor:!0,forced:!IM,sham:!yM},{URL:ZL});var nB=ao,iB=Ot,oB=Ug,aB=Wa,sB=_N,uB=Mr("URL");nB({target:"URL",stat:!0,forced:!(sB&&iB((function(){uB.canParse()})))},{canParse:function(e){var t=oB(arguments.length,1),r=aB(e),n=t<2||arguments[1]===undefined?undefined:aB(arguments[1]);try{return!!new uB(r,n)}catch(pC){return!1}}});var cB=a(Fr.URL),lB=ao,dB=Bu.findIndex,fB="findIndex",hB=!0;fB in[]&&Array(1)[fB]((function(){hB=!1})),lB({target:"Array",proto:!0,forced:hB},{findIndex:function(e){return dB(this,e,arguments.length>1?arguments[1]:undefined)}});var gB=Dh("Array").findIndex,pB=Lr,mB=gB,_B=Array.prototype,vB=a((function(e){var t=e.findIndex;return e===_B||pB(_B,e)&&t===_B.findIndex?mB:t})),yB=ar,IB=Ot,SB=Jt,TB=ld,bB=es,CB=kr,wB=SB(lr.f),EB=SB([].push),AB=yB&&IB((function(){var e=Object.create(null);return e[2]=2,!wB(e,2)})),kB=function(e){return function(t){for(var r,n=CB(t),i=bB(n),o=AB&&null===TB(n),a=i.length,s=0,u=[];a>s;)r=i[s++],yB&&!(o?r in n:wB(n,r))||EB(u,e?[r,n[r]]:n[r]);return u}},PB={entries:kB(!0),values:kB(!1)}.entries;ao({target:"Object",stat:!0},{entries:function(e){return PB(e)}});var xB=a(Fr.Object.entries),DB=ao,FB=Bu.find,WB="find",RB=!0;WB in[]&&Array(1)[WB]((function(){RB=!1})),DB({target:"Array",proto:!0,forced:RB},{find:function(e){return FB(this,e,arguments.length>1?arguments[1]:undefined)}});var NB=Dh("Array").find,OB=Lr,MB=NB,LB=Array.prototype,BB=a((function(e){var t=e.find;return e===LB||OB(LB,e)&&t===LB.find?MB:t})),UB=Bu.filter;ao({target:"Array",proto:!0,forced:!ma("filter")},{filter:function(e){return UB(this,e,arguments.length>1?arguments[1]:undefined)}});var VB=Dh("Array").filter,GB=Lr,jB=VB,HB=Array.prototype,zB=a((function(e){var t=e.filter;return e===HB||GB(HB,e)&&t===HB.filter?jB:t})),KB=Bu.map;ao({target:"Array",proto:!0,forced:!ma("map")},{map:function(e){return KB(this,e,arguments.length>1?arguments[1]:undefined)}});var JB=Dh("Array").map,QB=Lr,qB=JB,YB=Array.prototype,XB=a((function(e){var t=e.map;return e===YB||QB(YB,e)&&t===YB.map?qB:t})),ZB=ja.includes;ao({target:"Array",proto:!0,forced:Ot((function(){return!Array(1).includes()}))},{includes:function(e){return ZB(this,e,arguments.length>1?arguments[1]:undefined)}});var $B=Dh("Array").includes,eU=ao,tU=VI,rU=wr,nU=Wa,iU=jI,oU=Jt("".indexOf);eU({target:"String",proto:!0,forced:!iU("includes")},{includes:function(e){return!!~oU(nU(rU(this)),nU(tU(e)),arguments.length>1?arguments[1]:undefined)}});var aU=Dh("String").includes,sU=Lr,uU=$B,cU=aU,lU=Array.prototype,dU=String.prototype,fU=a((function(e){var t=e.includes;return e===lU||sU(lU,e)&&t===lU.includes?uU:"string"==typeof e||e===dU||sU(dU,e)&&t===dU.includes?cU:t})),hU=a(ER),gU={exports:{}},pU=Ot((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}})),mU=Ot,_U=Dr,vU=Xt,yU=pU,IU=Object.isExtensible,SU=mU((function(){IU(1)}))||yU?function(e){return!!_U(e)&&((!yU||"ArrayBuffer"!==vU(e))&&(!IU||IU(e)))}:IU,TU=!Ot((function(){return Object.isExtensible(Object.preventExtensions({}))})),bU=ao,CU=Jt,wU=Ha,EU=Dr,AU=xn,kU=Pi.f,PU=Es,xU=Ps,DU=SU,FU=TU,WU=!1,RU=Nn("meta"),NU=0,OU=function(e){kU(e,RU,{value:{objectID:"O"+NU++,weakData:{}}})},MU=gU.exports={enable:function(){MU.enable=function(){},WU=!0;var e=PU.f,t=CU([].splice),r={};r[RU]=1,e(r).length&&(PU.f=function(r){for(var n=e(r),i=0,o=n.length;i<o;i++)if(n[i]===RU){t(n,i,1);break}return n},bU({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:xU.f}))},fastKey:function(e,t){if(!EU(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!AU(e,RU)){if(!DU(e))return"F";if(!t)return"E";OU(e)}return e[RU].objectID},getWeakData:function(e,t){if(!AU(e,RU)){if(!DU(e))return!0;if(!t)return!1;OU(e)}return e[RU].weakData},onFreeze:function(e){return FU&&WU&&DU(e)&&!AU(e,RU)&&OU(e),e}};wU[RU]=!0;var LU=gU.exports,BU=ao,UU=Nt,VU=LU,GU=Ot,jU=Qi,HU=Fm,zU=c_,KU=ir,JU=Dr,QU=Tr,qU=pu,YU=Pi.f,XU=Bu.forEach,ZU=ar,$U=Du.set,eV=Du.getterFor,tV=ws,rV=zs,nV=yN,iV=ki,oV=c_,aV=Tr,sV=Fm,uV=$d,cV=ef,lV=a_,dV=ar,fV=LU.fastKey,hV=Du.set,gV=Du.getterFor,pV={getConstructor:function(e,t,r,n){var i=e((function(e,i){oV(e,o),hV(e,{type:t,index:tV(null),first:undefined,last:undefined,size:0}),dV||(e.size=0),aV(i)||sV(i,e[n],{that:e,AS_ENTRIES:r})})),o=i.prototype,a=gV(t),s=function(e,t,r){var n,i,o=a(e),s=u(e,t);return s?s.value=r:(o.last=s={index:i=fV(t,!0),key:t,value:r,previous:n=o.last,next:undefined,removed:!1},o.first||(o.first=s),n&&(n.next=s),dV?o.size++:e.size++,"F"!==i&&(o.index[i]=s)),e},u=function(e,t){var r,n=a(e),i=fV(t);if("F"!==i)return n.index[i];for(r=n.first;r;r=r.next)if(r.key===t)return r};return nV(o,{clear:function(){for(var e=a(this),t=e.index,r=e.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=undefined),delete t[r.index],r=r.next;e.first=e.last=undefined,dV?e.size=0:this.size=0},"delete":function(e){var t=this,r=a(t),n=u(t,e);if(n){var i=n.next,o=n.previous;delete r.index[n.index],n.removed=!0,o&&(o.next=i),i&&(i.previous=o),r.first===n&&(r.first=i),r.last===n&&(r.last=o),dV?r.size--:t.size--}return!!n},forEach:function(e){for(var t,r=a(this),n=iV(e,arguments.length>1?arguments[1]:undefined);t=t?t.next:r.first;)for(n(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!u(this,e)}}),nV(o,r?{get:function(e){var t=u(this,e);return t&&t.value},set:function(e,t){return s(this,0===e?0:e,t)}}:{add:function(e){return s(this,e=0===e?0:e,e)}}),dV&&rV(o,"size",{configurable:!0,get:function(){return a(this).size}}),i},setStrong:function(e,t,r){var n=t+" Iterator",i=gV(t),o=gV(n);uV(e,t,(function(e,t){hV(this,{type:n,target:e,state:i(e),kind:t,last:undefined})}),(function(){for(var e=o(this),t=e.kind,r=e.last;r&&r.removed;)r=r.previous;return e.target&&(e.last=r=r?r.next:e.state.first)?cV("keys"===t?r.key:"values"===t?r.value:[r.key,r.value],!1):(e.target=undefined,cV(undefined,!0))}),r?"entries":"values",!r,!0),lV(t)}},mV=function(e,t,r){var n,i=-1!==e.indexOf("Map"),o=-1!==e.indexOf("Weak"),a=i?"set":"add",s=UU[e],u=s&&s.prototype,c={};if(ZU&&KU(s)&&(o||u.forEach&&!GU((function(){(new s).entries().next()})))){var l=(n=t((function(t,r){$U(zU(t,l),{type:e,collection:new s}),QU(r)||HU(r,t[a],{that:t,AS_ENTRIES:i})}))).prototype,d=eV(e);XU(["add","clear","delete","forEach","get","has","set","keys","values","entries"],(function(e){var t="add"===e||"set"===e;!(e in u)||o&&"clear"===e||jU(l,e,(function(r,n){var i=d(this).collection;if(!t&&o&&!JU(r))return"get"===e&&undefined;var a=i[e](0===r?0:r,n);return t?this:a}))})),o||YU(l,"size",{configurable:!0,get:function(){return d(this).collection.size}})}else n=r.getConstructor(t,e,i,a),VU.enable();return qU(n,e,!1,!0),c[e]=n,BU({global:!0,forced:!0},c),o||r.setStrong(n,e,i),n};mV("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:undefined)}}),pV);var _V=a(Fr.Set),vV=a(ho);function yV(e,t){var r=uN(e);if(qF){var n=qF(e);t&&(n=zB(n).call(n,(function(t){return oW(e,t).enumerable}))),r.push.apply(r,n)}return r}function IV(e){for(var t=1;t<arguments.length;t++){var r,n,i=null!=arguments[t]?arguments[t]:{};t%2?oN(r=yV(Object(i),!0)).call(r,(function(t){FR(e,t,i[t])})):lW?_W(e,lW(i)):oN(n=yV(Object(i))).call(n,(function(t){vV(e,t,oW(i,t))}))}return e}function SV(e){var t=function(){if("undefined"==typeof Reflect||!QF)return!1;if(QF.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(QF(Boolean,[],(function(){}))),!0}catch(VV){return!1}}();return function(){var r,n=HW(e);if(t){var i=HW(this).constructor;r=QF(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"===fh(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return EW(e)}(this,r)}}var TV=function(e){return Mg?Mg(e):"[object Array]"===function(e){return Object.prototype.toString.call(e)}(e)},bV=function(e){return void 0===e},CV=function(e,t){var r,n;e=null!==(r=e)&&void 0!==r?r:"yyyy-MM-dd hh:mm:ss";var i=bV(t)?new Date:new Date(t),o={"M+":(i.getMonth()+1).toString(),"d+":i.getDate().toString(),"h+":i.getHours().toString(),"m+":i.getMinutes().toString(),"s+":i.getSeconds().toString(),"q+":Math.floor((i.getMonth()+3)/3).toString(),S:i.getMilliseconds().toString()};return/(y+)/.test(e)&&(e=e.replace(RegExp.$1,"".concat(i.getFullYear()).substring(4-RegExp.$1.length))),oN(n=uN(o)).call(n,(function(t){new RegExp("(".concat(t,")")).test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?o[t]:"00".concat(o[t]).substring("".concat(o[t]).length)))})),e},wV=function(e){return"string"==typeof e},EV=function(e){return"number"==typeof e&&!cN(e)},AV=function(e){return"function"==typeof e},kV=0,PV=function(){var e;return kV+=1,gN(e="".concat((new Date).getTime().toString(36))).call(e,kV.toString(36))},xV=function(e){var t=cB||window.webkitURL;/^blob:/.test(e)&&t.revokeObjectURL(e)},DV=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"",r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";Ft(this,e),FR(this,"prefix",void 0),FR(this,"postfix",void 0),FR(this,"isDestroyed",!1),FR(this,"uid",PV()),FR(this,"cacheEvents",void 0),FR(this,"events",void 0),FR(this,"isCached",void 0),this.cacheEvents=[],this.events={},this.isCached=!1,this.prefix=t,this.postfix=r}return mh(e,[{key:"save",value:function(){this.isCached=!0}},{key:"restore",value:function(){var e,t=this;this.isCached=!1,oN(e=this.cacheEvents).call(e,(function(e){var r,n=e.eventName,i=e.param;t.emit.apply(t,gN(r=[n]).call(r,DR(i)))})),this.cacheEvents.length=0}},{key:"destroy",value:function(){var e=this;if(!this.isDestroyed){for(var t in this.events)if(Object.prototype.hasOwnProperty.call(this.events,t)){var r,n=this.events[t];n&&oN(r=Tg(n).call(n)).call(r,(function(t){var r=t.name,n=t.fn,i=t.context,o=t.once;e.off(r,n,i,o)}))}this.events={},this.isDestroyed=!0}}},{key:"on",value:function(e,t,r){var n,i=arguments.length>3&&arguments[3]!==undefined&&arguments[3],o=this.events,a={name:e=this.format(e),uid:PV(),context:r,once:i,fn:t};return o[e]||(o[e]=[]),Qh(n=o[e]).call(n,a)<0&&o[e].push(a),a}},{key:"once",value:function(e,t,r){return this.on(e,t,r,!0)}},{key:"emit",value:function(e){for(var t,r,n=this,i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];if(this.isCached)return this.cacheEvents.push({eventName:e,param:o}),!0;var s=this.events[e=this.format(e)];return!(!s||!s.length||(oN(t=Tg(s).call(s)).call(t,(function(e){var t,r=e.fn,n=e.context;r.call.apply(r,gN(t=[n||null]).call(t,o))})),oN(r=Tg(s).call(s)).call(r,(function(t){var r=t.fn,i=t.context,o=t.once;o&&n.off(e,r,i,o)})),0))}},{key:"off",value:function(e,t,r,n){var i=this.events[e=this.format(e)];if(!i)return!1;if(!arguments.length)return i.length=0,!0;for(var o=i.length-1;o>=0;o--){var a=i[o];t&&a.fn!==t||r&&a.context!==r||n&&a.once!==n||kp(i).call(i,o,1)}return!0}},{key:"removeAllEventListeners",value:function(e){if(e){var t,r;e=this.format(e);var n=vB(t=this.cacheEvents).call(t,(function(t){return t.eventName===e}));n>-1&&kp(r=this.cacheEvents).call(r,n,1),this.events[e]&&delete this.events[e]}else this.cacheEvents=[],this.events={}}},{key:"getAllEvents",value:function(){return this.events}},{key:"format",value:function(e){var t,r;return gN(t=gN(r="".concat(this.prefix||"")).call(r,e)).call(t,this.postfix||"")}}],[{key:"create",value:function(t,r){return new e(t,r)}}]),e}(),FV="default",WV=function(){function e(){Ft(this,e),FR(this,"emitter",new DV)}return mh(e,[{key:"on",value:function(e){this.emitter.on(FV,e)}},{key:"emit",value:function(){for(var e,t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(e=this.emitter).emit.apply(e,gN(t=[FV]).call(t,n))}},{key:"off",value:function(e){this.emitter.off(FV,e)}}],[{key:"create",value:function(){return new e}}]),e}(),RV=function(){function e(t){Ft(this,e),FR(this,"uid",void 0),FR(this,"children",void 0),this.uid=t.uid,this.children=t.children||[]}return mh(e,[{key:"append",value:function(e){var t=this.children;return Qh(t).call(t,e)<0&&(t.push(e),!0)}},{key:"insert",value:function(e,t){var r=this.children;return!(t<0||(t>r.length&&(t=r.length),kp(r).call(r,t,0,e),0))}},{key:"remove",value:function(e){var t=this.children,r=Qh(t).call(t,e);return!(r<0||(kp(t).call(t,r,1),0))}},{key:"clear",value:function(){return this.children=[],!0}},{key:"move",value:function(e,t){if(e===t)return!0;var r=this.children,n=xR(kp(r).call(r,e,1),1)[0];return kp(r).call(r,t,0,n),!0}},{key:"switch",value:function(e,t){if(e===t)return!0;var r=this.children,n=r[e];return r[e]=r[t],r[t]=n,!0}},{key:"reorder",value:function(e){var t=this.children,r=e.length,n=[],i=0;if(t.length!==r||0===r)return!1;for(var o=0;o<r;o++)e[o]===o&&(i+=1);if(i===r)return!0;for(var a=0;a<r;a++)n[a]=t[e[a]];for(var s=0;s<r;s++)t[s]=n[s];return!0}}]),e}(),NV=function(){function e(t,r){Ft(this,e),FR(this,"isDestroyed",!1),FR(this,"data",void 0),FR(this,"table",["database","table","item"]),FR(this,"dbName",void 0),FR(this,"tableName",void 0),this.data={},this.dbName=t,this.tableName=r,this.createDatabase(t,r)}return mh(e,[{key:"destroy",value:function(){if(!this.isDestroyed){for(var e=0,t=xB(this.data);e<t.length;e++){var r=xR(t[e],2),n=r[0];r[1],this.data[n]=null}this.data=null,this.isDestroyed=!0}}},{key:"createDatabase",value:function(e,t){this.data[e]={},this.data[e][t]={}}},{key:"set",value:function(e,t){var r=this,n=this.dbName,i=this.tableName;return new NI((function(o,a){r.checkId(e)?a(new Error("The ".concat(e," already exists."))):(r.data[n][i][e]=t,o("Save ".concat(e," to database successful.")))}))}},{key:"get",value:function(e){var t=this,r=this.dbName,n=this.tableName;return new NI((function(i,o){t.checkId(e)?i(t.data[r][n][e]):o(t.erMsg(2,e))}))}},{key:"remove",value:function(e){var t=this,r=this.dbName,n=this.tableName;return new NI((function(i,o){delete t.data[r][n][e],i("Remove ".concat(e," successful."))}))}},{key:"update",value:function(e,t){var r=this,n=this.dbName,i=this.tableName;return new NI((function(o,a){r.checkId(e)?(r.data[n][i][e]=t,o("Update ".concat(e," successful."))):a(r.erMsg(2,e))}))}},{key:"checkId",value:function(e){var t=this.dbName,r=this.tableName;return void 0!==this.data[t][r][e]}},{key:"erMsg",value:function(e,t){var r;return gN(r="The ".concat(this.table[e]," ")).call(r,t," does not exist.")}}]),e}(),OV=function(){function e(){Ft(this,e),FR(this,"isDestroyed",!1),FR(this,"data",void 0),this.data={}}return mh(e,[{key:"destroy",value:function(){if(!this.isDestroyed){for(var e=0,t=xB(this.data);e<t.length;e++){var r,n=xR(t[e],2),i=n[0];n[1],null!==(r=this.data[i])&&void 0!==r&&r.destroy(),this.data[i]=null}this.data=null,this.isDestroyed=!0}}},{key:"set",value:function(e,t){return!this.check(e)&&(this.data[e]=t,!0)}},{key:"get",value:function(e){return this.data[e]}},{key:"remove",value:function(e){return!!this.check(e)&&(delete this.data[e],!0)}},{key:"update",value:function(e,t){return!!this.check(e)&&(this.data[e]=t,!0)}},{key:"check",value:function(e){return void 0!==this.data[e]}}]),e}(),MV=function(e){YW(r,e);var t=SV(r);function r(e){var n;return Ft(this,r),FR(EW(n=t.call(this,e)),"name",void 0),FR(EW(n),"type",void 0),FR(EW(n),"fileType",void 0),FR(EW(n),"createdDate",void 0),FR(EW(n),"modifiedDate",void 0),FR(EW(n),"parent",void 0),FR(EW(n),"isRoot",!1),n.name=e.name,n.type=e.type,n.fileType=e.fileType,n.parent=e.parent||null,n.isRoot=e.isRoot||!1,n.createdDate=CV(),n.modifiedDate=n.createdDate,n}return mh(r,[{key:"updateDate",value:function(){this.modifiedDate=CV()}},{key:"setName",value:function(e){this.name=e}},{key:"reorder",value:function(e){var t=this.type;return("file"===t||"default"===t)&&zW(HW(r.prototype),"reorder",this).call(this,e)}}]),r}(RV),LV=function(){function e(){Ft(this,e),FR(this,"root",void 0),FR(this,"currentNode",void 0),FR(this,"selectedUid",void 0),FR(this,"defaultNode",void 0),FR(this,"hooks",{fileChanged:WV.create(),beforeRemoveFile:WV.create(),removeFile:WV.create(),afterRemoveFile:WV.create(),afterRenameFile:WV.create(),destroy:WV.create()}),this.root=new MV({uid:PV(),children:[],name:"root",type:"file",fileType:"folder",parent:void 0,isRoot:!0}),this.defaultNode=this.root,this.currentNode=this.root}return mh(e,[{key:"appendChildrenToFile",value:function(e,t,r){var n=r,i=BV(this.defaultNode,e);return i||(i=this.createFile(e),this.hooks.fileChanged.emit(this.defaultNode)),oN(t).call(t,(function(e){bV(n)?i.append(e):(i.insert(e,n),n+=1)})),i}},{key:"removeChildFromFile",value:function(e,t){wV(t)&&(t=[t]);var r=this.getFileByUid(e);r&&oN(t).call(t,(function(e){r.remove(e)}))}},{key:"findChild",value:function(e,t){var r;return BB(r=e.children).call(r,(function(e){return e.name===t}))}},{key:"createFile",value:function(e){var t=this.defaultNode;t||(t=this.root);var r=BV(t,e);return r&&"file"===r.type||(r=new MV({uid:PV(),children:[],name:e,type:"file",fileType:"file",parent:t,isRoot:!1}),this.currentNode.append(r),this.hooks.fileChanged.emit(this.currentNode.children)),r}},{key:"removeFile",value:function(e){for(var t=this.defaultNode.children,r=0;r<t.length;r++){var n=t[r];if(n.name===e)return this.hooks.beforeRemoveFile.emit(n),kp(t).call(t,r,1),this.hooks.afterRemoveFile.emit(n),this.hooks.fileChanged.emit(n),!0}return!1}},{key:"renameFile",value:function(e,t){var r=this.findChild(this.defaultNode,e),n=this.findChild(this.defaultNode,t);return!!r&&!n&&(r.name=t,this.hooks.afterRenameFile.emit(r),this.hooks.fileChanged.emit(this.currentNode.children),!0)}},{key:"getFile",value:function(e){return this.findChild(this.defaultNode,e)}},{key:"getFileByUid",value:function(e){return BB(this).call(this,e,this.root)}},{key:"getCurrentFileList",value:function(){return this.currentNode.children}},{key:"isFileExist",value:function(e){return!!this.findChild(this.defaultNode,e)}},{key:"createFolder",value:function(){}},{key:"find",value:function(e,t){for(var r=t.children,n=r.length,i=0;i<n;i++){if(r[i].uid===e)return r[i];if(r[i].children){var o=BB(this).call(this,e,r[i]);if(o)return o}}return null}}]),e}();function BV(e,t){var r,n=zB(r=e.children).call(r,(function(e){return e.name===t}));return 0===n.length?null:n[0]}var UV,VV,GV=function(e){YW(r,e);var t=SV(r);function r(e){var n;return Ft(this,r),FR(EW(n=t.call(this,e)),"name",void 0),FR(EW(n),"type","tag"),n.name=e.name,n.uid=e.uid||PV(),n.type="tag",n}return mh(r)}(RV),jV=function(){function e(){Ft(this,e),FR(this,"tags",void 0),FR(this,"defaultName",void 0),FR(this,"defaultUid",void 0),FR(this,"selectedUid",void 0),FR(this,"emptyItem",void 0),FR(this,"hooks",{beforeRemoveTag:WV.create(),afterRenameTag:WV.create(),destroy:WV.create(),load:WV.create()}),this.tags=[],this.defaultName=null,this.defaultUid=null,this.selectedUid=null,this.emptyItem=new GV({name:"defaultTag",children:[]})}return mh(e,[{key:"appendChildToTag",value:function(e,t){var r=this.createTag(e);wV(t)&&(t=[t]);var n=!1;return oN(t).call(t,(function(e){r.append(e)&&(n=!0)})),n}},{key:"removeChildFromTag",value:function(e,t){var r=this.getTag(e);return!!r&&(wV(t)&&(t=[t]),oN(t).call(t,(function(e){r.remove(e)})),!0)}},{key:"createTag",value:function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[],r=this.getTag(e);return r||(r=new GV({name:e,children:t}),this.tags.push(r)),r}},{key:"removeTag",value:function(e){var t,r,n=this.getTag(e);if(!n)return!1;this.hooks.beforeRemoveTag.emit(n);var i=vB(t=this.tags).call(t,(function(t){return t.name===e}));return e===this.defaultName&&(this.defaultName=null,this.selectedUid=null),kp(r=this.tags).call(r,i,1),!0}},{key:"renameTag",value:function(e,t){if(!wV(e)||!wV(t))return!1;var r=this.isTagExisted(t),n=this.getTag(e);return!(!n||r||(n.name=t,this.hooks.afterRenameTag.emit(n),0))}},{key:"getTag",value:function(e){var t;return BB(t=this.tags).call(t,(function(t){return t.name===e}))}},{key:"getTagByUid",value:function(e){var t;return BB(t=this.tags).call(t,(function(t){return t.uid===e}))}},{key:"getTagList",value:function(){var e;return Tg(e=this.tags).call(e)}},{key:"setDefaultTag",value:function(e){if(!e)return this.defaultName=null,this.defaultUid=null,!0;var t=this.getTag(e);return!!t&&(this.defaultName=e,this.defaultUid=t.uid,!0)}},{key:"getDefaultTag",value:function(){return this.defaultName}},{key:"isTagExisted",value:function(e){return!!this.getTag(e)}}]),e}(),HV=function(){function e(){Ft(this,e)}return mh(e,[{key:"apply",value:function(e){var t=e.hooks,r={beforeStatus:null,afterStatus:null,operation:null,docUid:null},n=function(e){r.beforeStatus={uids:[],selectedUids:[],currentUid:"",modifiedUid:e.modifiedUid,removedUids:e.removedUids}},i=function(t){r.afterStatus={uids:[],selectedUids:[],currentUid:"",modifiedUid:t.modifiedUid,removedUids:t.removedUids},r.docUid="",r.operation=t.operation,e.emit("bufferChanged",IV({},r)),r={beforeStatus:null,afterStatus:null,operation:null,docUid:null}};t.beforeBufferChanged.on(n),t.afterBufferChanged.on(i),t.destroy.on((function(){t.beforeBufferChanged.off(n),t.afterBufferChanged.off(i)}))}}]),e}(),zV=function(){function e(){Ft(this,e)}return mh(e,[{key:"apply",value:function(e){var t=e.hooks;e.customStore=new OV;var r=function(t){var r=t.data;oN(r).call(r,(function(t){var r=t.customData;r||(r={}),e.customStore.set(t.uid,r)}))},n=function(t){var r=t.removedUids;oN(r).call(r,(function(t){e.customStore.remove(t)}))},i=function(t){var r=t.data.customData;r&&e.customStore.update(t.modifiedUid,r)};t.loadSource.on(r),t.removeSource.on(n),t.updateSource.on(i),t.destroy.on((function(){t.loadSource.off(r),t.removeSource.off(n),t.updateSource.off(i)}))}}]),e}(),KV=function(e){YW(r,e);var t=SV(r);function r(){var e;return Ft(this,r),FR(EW(e=t.call(this,{uid:PV(),children:[]})),"name","dvs-default"),FR(EW(e),"isDestroyed",!1),FR(EW(e),"type",void 0),e}return mh(r,[{key:"destroy",value:function(){this.isDestroyed||(this.isDestroyed=!0)}}]),r}(RV),JV=function(){function e(){Ft(this,e)}return mh(e,[{key:"apply",value:function(e){e.defaultFile=new KV;var t=e.hooks,r=function(t){var r,n,i,o=t.filename,a=t.index,s=t.data;if(bV(o)){var u=XB(s).call(s,(function(e){return e.uid}));void 0===a?(r=e.defaultFile.children).push.apply(r,DR(u)):kp(n=e.defaultFile.children).apply(n,gN(i=[a,0]).call(i,DR(u)));var c={docUid:e.defaultFile.uid,sourceUids:u,type:"default",index:a};e.hooks.loadToDoc.emit(c)}},n=function(t){var r=t.removedUids,n=[];oN(r).call(r,(function(t){var r=e.statusStore.get(t);r&&r.ownerDefaultFile&&(e.defaultFile.remove(t),n.push(t))})),n.length&&e.hooks.removeFromDoc.emit({docUid:e.defaultFile.uid,sourceUids:r,type:"default"})};t.loadSource.on(r),t.removeSource.on(n),t.destroy.on((function(){t.loadSource.off(r),t.removeSource.off(n)}))}}]),e}(),QV=function(){function e(){Ft(this,e)}return mh(e,[{key:"apply",value:function(e){e.dir=new LV,this.listenDirectoryHooks(e),this.listenSpaceHooks(e)}},{key:"listenDirectoryHooks",value:function(e){var t=e.dir.hooks,r=function(t){var r;oN(r=t.children).call(r,(function(r){var n=e.statusStore.get(r);n&&n.ownerFiles.remove(t.uid)})),e.hooks.removeDoc.emit(t)},n=function(t){e.hooks.renameDoc.emit(t)};t.beforeRemoveFile.on(r),t.afterRenameFile.on(n),t.destroy.on((function(){t.beforeRemoveFile.off(r),t.afterRenameFile.off(n)}))}},{key:"listenSpaceHooks",value:function(e){var t=e.hooks,r=function(t){var r=t.data,n=t.filename,i=t.index;if(!bV(n)){var o=XB(r).call(r,(function(e){return e.uid})),a={docUid:e.dir.appendChildrenToFile(n,o,i).uid,sourceUids:o,type:"file",index:i};e.hooks.loadToDoc.emit(a)}},n=function(t){var r=t.removedUids,n={};oN(r).call(r,(function(t){var r,i,o=e.statusStore.get(t);o&&oN(r=Tg(i=o.ownerFiles.children).call(i)).call(r,(function(e){n[e]||(n[e]=[]),n[e].push(t)}))}));for(var i=0,o=xB(n);i<o.length;i++){var a=xR(o[i],2),s=a[0],u=a[1];e.dir.removeChildFromFile(s,u),e.hooks.removeFromDoc.emit({docUid:s,sourceUids:u})}};t.loadSource.on(r),t.removeSource.on(n),t.destroy.on((function(){t.loadSource.off(r),t.removeSource.off(n)}))}}]),e}(),qV=function(){function e(){Ft(this,e)}return mh(e,[{key:"apply",value:function(e){var t=e.hooks;e.metadataStore=new OV;var r=function(t){var r=t.data;oN(r).call(r,(function(t){var r=t.metadata;r||(r={width:void 0,height:void 0}),e.metadataStore.set(t.uid,r)}))},n=function(t){var r=t.removedUids;oN(r).call(r,(function(t){e.metadataStore.remove(t)}))},i=function(t){var r=t.data.metadata;r&&e.metadataStore.update(t.modifiedUid,r)};t.loadSource.on(r),t.removeSource.on(n),t.updateSource.on(i),t.destroy.on((function(){t.loadSource.off(r),t.removeSource.off(n),t.updateSource.off(i)}))}}]),e}(),YV=function(){function e(t){Ft(this,e),FR(this,"uid",null),FR(this,"minData",null),FR(this,"oriData",null),FR(this,"customData",{}),FR(this,"activeOri",!1),FR(this,"activeMin",!1),FR(this,"minTask",null),FR(this,"oriTask",null),FR(this,"load",!1),FR(this,"preload",[]),FR(this,"visible",[]),FR(this,"overlays",[]),FR(this,"img",null),FR(this,"minImg",null),FR(this,"imageScale",1),FR(this,"owners",[]),FR(this,"oriType",null),FR(this,"minType",null),FR(this,"metadata",null),FR(this,"realTimeWidth",0),FR(this,"realTimeHeight",0),FR(this,"isFromFile",!1),FR(this,"isCached",!1),FR(this,"isDestroyed",!1),FR(this,"isLoading",!1),FR(this,"isMinLoading",!1),FR(this,"isSaving",!1),FR(this,"annotations",void 0),FR(this,"ownerFiles",new RV({children:[]})),FR(this,"ownerTags",new RV({children:[]})),FR(this,"ownerDefaultFile",void 0),FR(this,"operations",[]),FR(this,"useFillColor",!1),this.uid=t.uid,this.metadata=IV({},t.metadata),this.setRealTimeSize(this.metadata.width,this.metadata.height)}return mh(e,[{key:"setRealTimeSize",value:function(e,t){this.realTimeWidth=e,this.realTimeHeight=t}},{key:"destroy",value:function(){this.isDestroyed||(this.customData=null,this.img=null,this.owners=null,this.metadata=null,this.isDestroyed=!0)}},{key:"addOwner",value:function(e){var t=this.owners;Qh(t).call(t,e)<0&&t.push(e)}},{key:"removeOwner",value:function(e){var t=this.owners,r=Qh(t).call(t,e);r>-1&&kp(t).call(t,r,1)}},{key:"removeViewer",value:function(e){var t=this.owners,r=Qh(t).call(t,e);r>-1&&kp(t).call(t,r,1)}},{key:"setVisible",value:function(e){var t;Qh(t=this.visible).call(t,e)<0&&this.visible.push(e)}},{key:"cancelVisible",value:function(e){var t,r,n=Qh(t=this.visible).call(t,e);n>-1&&kp(r=this.visible).call(r,n,1)}},{key:"setPreload",value:function(e){var t;Qh(t=this.preload).call(t,e)<0&&this.preload.push(e)}},{key:"cancelPreload",value:function(e){var t,r,n=Qh(t=this.preload).call(t,e);n>-1&&kp(r=this.preload).call(r,n,1)}},{key:"reset",value:function(){this.minData=null,this.oriData=null,this.img=null,this.activeOri=!1,this.activeMin=!1,this.minTask=null,this.oriTask=null,this.operations=[]}}]),e}(),XV=function(){function e(){Ft(this,e)}return mh(e,[{key:"apply",value:function(e){var t=e.hooks;e.statusStore=new OV;var r=function(t){var r=t.data;t.filename,t.index,oN(r).call(r,(function(t){var r=new YV(t);e.statusStore.set(t.uid,r)}))},n=function(t){var r=t.removedUids;oN(r).call(r,(function(t){var r,n,i=e.statusStore.get(t);i&&(xV(i.minData),xV(i.oriData),i.ownerFiles.clear(),i.ownerTags.clear(),i.ownerDefaultFile=!1,null!==(r=i.img)&&void 0!==r&&r.src&&(i.img.src=""),null!==(n=i.minImg)&&void 0!==n&&n.src&&(i.minImg.src=""),i.img=null,i.minImg=null),e.statusStore.remove(t)}))},i=function(t){var r=t.modifiedUid,n=t.data,i=t.revoke,o=e.statusStore.get(r);if(o){o.img=null,o.minImg=null;var a=n.metadata;a&&(o.metadata=IV({},a),o.setRealTimeSize(a.width,a.height)),i&&(xV(o.oriData),xV(o.minData)),o.reset(),e.statusStore.update(r,o)}},o=function(t){var r;oN(r=t.children).call(r,(function(r){var n=e.statusStore.get(r);n&&("file"===t.type?n.ownerFiles.remove(t.uid):"tag"===t.type&&n.ownerTags.remove(t.uid))}))},a=function(t){var r=t.docUid,n=t.sourceUids,i=t.type;oN(n).call(n,(function(t){var n=e.statusStore.get(t);n&&("file"===i?n.ownerFiles.append(r):"tag"===i?n.ownerTags.append(r):"default"===i&&(n.ownerDefaultFile=!0))}))},s=function(t){var r=t.docUid,n=t.sourceUids,i=t.type;oN(n).call(n,(function(t){var n=e.statusStore.get(t);n&&("file"===i?n.ownerFiles.remove(r):"tag"===i?n.ownerTags.remove(r):"default"===i&&(n.ownerDefaultFile=!0))}))};t.loadSource.on(r),t.afterRemoveSource.on(n),t.updateSource.on(i),t.removeDoc.on(o),t.loadToDoc.on(a),t.removeFromDoc.on(s),t.destroy.on((function(){t.loadSource.off(r),t.afterRemoveSource.off(n),t.updateSource.off(i),t.removeDoc.off(o),t.loadToDoc.off(a),t.removeFromDoc.off(s)}))}}]),e}(),ZV=function(){function e(){Ft(this,e)}return mh(e,[{key:"apply",value:function(e){var t=e.hooks;e.store=new NV("space_db","space_doc");var r=function(t){var r=t.data;r&&oN(r).call(r,(function(t){e.store.set(t.uid,t)}))},n=function(t){var r;oN(r=t.removedUids).call(r,(function(t){e.store.remove(t)}))},i=function(t){e.store.update(t.modifiedUid,t.data)};t.loadSource.on(r),t.removeSource.on(n),t.updateSource.on(i),t.destroy.on((function(){t.loadSource.off(r),t.removeSource.off(n),t.updateSource.off(i)}))}}]),e}(),$V=function(){function e(){Ft(this,e)}return mh(e,[{key:"apply",value:function(e){e.tag=new jV,this.listenSpaceHooks(e),this.listenTagHooks(e)}},{key:"listenTagHooks",value:function(e){var t=e.tag.hooks,r=function(t){var r;oN(r=t.children).call(r,(function(r){var n=e.statusStore.get(r);n&&n.ownerFiles.remove(t.uid)})),e.hooks.removeDoc.emit(t)},n=function(t){e.hooks.renameDoc.emit(t)};t.beforeRemoveTag.on(r),t.afterRenameTag.on(n),t.destroy.on((function(){t.beforeRemoveTag.off(r),t.afterRenameTag.off(n)}))}},{key:"listenSpaceHooks",value:function(e){var t=e.hooks,r=function(t){var r=t.data,n=e.tag.defaultName;oN(r).call(r,(function(e){var t;(e.tags||(e.tags=[]),n)&&(Qh(t=e.tags).call(t,n)<0&&e.tags.push(n))}))},n=function(t){var r=t.data;oN(r).call(r,(function(t){var r;null===(r=t.tags)||void 0===r||oN(r).call(r,(function(r){e.tag.appendChildToTag(r,t.uid);var n={docUid:e.tag.getTag(r).uid,sourceUids:[t.uid],type:"tag"};e.hooks.loadToDoc.emit(n)}))}))},i=function(t){var r=t.removedUids,n={};oN(r).call(r,(function(t){var r,i,o=e.statusStore.get(t);o&&oN(r=Tg(i=o.ownerTags.children).call(i)).call(r,(function(e){n[e]||(n[e]=[]),n[e].push(t)}))}));for(var i=0,o=xB(n);i<o.length;i++){var a=xR(o[i],2),s=a[0],u=a[1],c=e.tag.getTagByUid(s);c&&e.tag.removeChildFromTag(c.name,u),e.hooks.removeFromDoc.emit({docUid:s,sourceUids:u,type:"tag"})}},o=function(e){"tag"!==e.type&&i({removedUids:e.children})},a=function(t){var r=t.docUid,n=t.sourceUids;if("tag"===t.type){var i=e.tag.getTagByUid(r);i&&oN(n).call(n,function(){var t=wW(iN.mark((function r(t){var n,o;return iN.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e.store.get(t);case 3:if(o=r.sent,r.t0=o&&Qh(n=o.tags).call(n,i.name)<0,!r.t0){r.next=9;break}return o.tags.push(i.name),r.next=9,e.store.update(t,o);case 9:r.next=14;break;case 11:r.prev=11,r.t1=r["catch"](0);case 14:case"end":return r.stop()}}),r,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}())}},s=function(t){var r=t.docUid,n=t.sourceUids;if("tag"===t.type){var i=e.tag.getTagByUid(r);i&&oN(n).call(n,function(){var t=wW(iN.mark((function r(t){var n,o,a,s;return iN.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e.store.get(t);case 3:if(!(n=r.sent)){r.next=9;break}return(s=Qh(o=n.tags).call(o,i.name))>-1&&kp(a=n.tags).call(a,s,1),r.next=9,e.store.update(t,n);case 9:r.next=14;break;case 11:r.prev=11,r.t0=r["catch"](0);case 14:case"end":return r.stop()}}),r,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}())}};t.beforeLoadSource.on(r),t.loadSource.on(n),t.removeSource.on(i),t.removeDoc.on(o),t.loadToDoc.on(a),t.removeFromDoc.on(s),t.destroy.on((function(){t.beforeLoadSource.off(r),t.loadSource.off(n),t.removeSource.off(i),t.removeDoc.off(o),t.loadToDoc.off(a),t.removeFromDoc.off(s)}))}}]),e}(),eG=function(e){YW(r,e);var t=SV(r);function r(){var e;return Ft(this,r),FR(EW(e=t.call(this)),"uid",PV()),FR(EW(e),"hooks",{init:WV.create(),destroy:WV.create(),beforeLoadSource:WV.create(),loadSource:WV.create(),afterLoadSource:WV.create(),beforeRemoveSource:WV.create(),removeSource:WV.create(),afterRemoveSource:WV.create(),beforeUpdateSource:WV.create(),updateSource:WV.create(),afterUpdateSource:WV.create(),beforeBufferChanged:WV.create(),afterBufferChanged:WV.create(),directoryChanged:WV.create(),tagChanged:WV.create(),openDoc:WV.create(),loadToDoc:WV.create(),removeFromDoc:WV.create(),removeDoc:WV.create(),renameDoc:WV.create(),move:WV.create(),afterMove:WV.create(),"switch":WV.create(),afterSwitch:WV.create(),reorder:WV.create(),afterReorder:WV.create()}),FR(EW(e),"dir",void 0),FR(EW(e),"tag",void 0),FR(EW(e),"store",void 0),FR(EW(e),"customStore",void 0),FR(EW(e),"metadataStore",void 0),FR(EW(e),"statusStore",void 0),FR(EW(e),"defaultFile",void 0),FR(EW(e),"plugins",[]),FR(EW(e),"imageLoader",void 0),e.initPlugins(),e.hooks.init.emit(),e}return mh(r,[{key:"destroy",value:function(){this.hooks.destroy.emit()}},{key:"initPlugins",value:function(){(new ZV).apply(this),(new XV).apply(this),(new zV).apply(this),(new qV).apply(this),(new HV).apply(this),(new JV).apply(this),(new QV).apply(this),(new $V).apply(this)}},{key:"setImageLoader",value:function(e){this.imageLoader=e}},{key:"getCustomData",value:function(e){return this.customStore.get(e)}},{key:"setCustomData",value:function(e,t){return this.customStore.set(e,t)}},{key:"getMetadata",value:function(e){return this.metadataStore.get(e)}},{key:"setMetadata",value:function(e,t){return this.metadataStore.set(e,t)}},{key:"createStore",value:function(e){var t=e.type,r=void 0===t?"sync":t,n=e.tableName,i=e.dbName;return"sync"===r?new OV:i&&n?new NV(i,n):null}},{key:"loadSource",value:function(e){if(bV(e))return[];var t=e.data;if(!TV(t))return[];var r=[];return oN(t).call(t,(function(e){e.uid=PV(),r.push(e.uid)})),this.hooks.beforeBufferChanged.emit(e),this.hooks.beforeLoadSource.emit(e),this.hooks.loadSource.emit(e),this.hooks.afterLoadSource.emit(e),this.hooks.afterBufferChanged.emit(e),r}},{key:"removeSource",value:function(e){var t=!(arguments.length>1&&arguments[1]!==undefined)||arguments[1];wV(e)&&(e=[e]);var r={removedUids:e,docUid:"",trigger:this.uid,operation:"remove"};return this.hooks.beforeRemoveSource.emit(r),this.hooks.beforeBufferChanged.emit(r),this.hooks.removeSource.emit(r),t&&this.hooks.afterRemoveSource.emit(r),this.hooks.afterBufferChanged.emit(r),!0}},{key:"updateSource",value:function(e,t){var r={modifiedUid:e,data:t,revoke:!(arguments.length>2&&arguments[2]!==undefined)||arguments[2],operation:"modify"};return this.hooks.beforeUpdateSource.emit(r),this.hooks.beforeBufferChanged.emit(r),this.hooks.updateSource.emit(r),this.hooks.afterUpdateSource.emit(r),this.hooks.afterBufferChanged.emit(r),!0}},{key:"getSource",value:function(e){return this.store.get(e)}},{key:"openDefault",value:function(e){var t={node:this.defaultFile,type:"default",config:e};this.hooks.openDoc.emit(t)}},{key:"createFile",value:function(e){return this.dir.createFile(e)}},{key:"removeFile",value:function(e){return this.dir.removeFile(e)}},{key:"renameFile",value:function(e,t){return this.dir.renameFile(e,t)}},{key:"openFile",value:function(e,t){var r=this.getFile(e);if(!r)return!1;var n={node:r,type:"file",config:t};return this.hooks.openDoc.emit(n),!0}},{key:"movePagesToFile",value:function(e,t,r,n){var i=this,o=this.getFile(e),a=this.getFile(r);if(!o||!a)return!1;for(var s=0;s<t.length;s++)if(t[s]<0||t[s]>=o.children.length)return!1;if(n<0)return!1;var u=XB(t).call(t,(function(e){return o.children[e]}));oN(u).call(u,(function(e){var t=i.statusStore.get(e);t&&t.ownerFiles.remove(o.uid)})),this.dir.removeChildFromFile(o.uid,u),this.hooks.removeFromDoc.emit({docUid:o.uid,sourceUids:u}),n>a.children.length&&(n=a.children.length);var c=this.dir.appendChildrenToFile(r,u,n),l={docUid:c.uid,sourceUids:u,type:"file",index:n};return oN(u).call(u,(function(e){var t=i.statusStore.get(e);t&&t.ownerFiles.append(c.uid)})),this.hooks.loadToDoc.emit(l),!0}},{key:"getFile",value:function(e){return this.dir.getFile(e)}},{key:"getFileList",value:function(){return this.dir.getCurrentFileList()}},{key:"isFileExisted",value:function(e){return this.dir.isFileExist(e)}},{key:"createTag",value:function(e){return this.tag.createTag(e)}},{key:"removeTag",value:function(e){for(var t=this.getTag(e).children||[],r=0;r<t.length;r++)this.store.get(t[r]).then((function(t){var r,n,i=Qh(r=(null==t?void 0:t.tags)||[]).call(r,e);-1!==i&&kp(n=t.tags).call(n,i,1)}));return this.tag.removeTag(e)}},{key:"renameTag",value:function(e,t){var r=this.getTag(e).children||[],n=this.tag.renameTag(e,t);if(n)for(var i=0;i<r.length;i++)this.store.get(r[i]).then((function(r){var n,i,o=Qh(n=(null==r?void 0:r.tags)||[]).call(n,e);-1!==o&&kp(i=r.tags).call(i,o,1,t)}));return n}},{key:"openTag",value:function(e,t){var r=this.getTag(e);if(!r)return!1;var n={node:r,type:"tag",config:t};return this.hooks.openDoc.emit(n),!0}},{key:"getTag",value:function(e){return this.tag.getTag(e)}},{key:"getTagList",value:function(){return this.tag.getTagList()}},{key:"setDefaultTag",value:function(e){return this.tag.setDefaultTag(e)}},{key:"getDefaultTag",value:function(){return this.tag.getDefaultTag()}},{key:"isTagExisted",value:function(e){return this.tag.isTagExisted(e)}},{key:"addTagToSource",value:function(e,t){if(this.statusStore.get(e)){wV(t)&&(t=[t]);for(var r=0;r<t.length;r++)if(!this.addSourceToTag(t[r],e))return!1;return!0}return!1}},{key:"removeTagFromSource",value:function(e,t){if(this.statusStore.get(e)){var r;bV(t)?t=XB(r=this.tag.tags).call(r,(function(e){return e.name})):wV(t)&&(t=[t]);for(var n=0;n<t.length;n++)if(!this.removeSourceFromTag(t[n],e))return!1;return!0}return!1}},{key:"addSourceToTag",value:function(e,t){var r=this.tag.getTag(e);if(r&&this.tag.appendChildToTag(e,t)){wV(t)&&(t=[t]);for(var n=0;n<t.length;n++)this.store.get(t[n]).then((function(t){var r;fU(r=t.tags).call(r,e)||t.tags.push(e)}));var i={sourceUids:t,docUid:r.uid,type:"tag"};return this.hooks.loadToDoc.emit(i),!0}return!1}},{key:"removeSourceFromTag",value:function(e,t){var r=this.tag.getTag(e);if(r){this.tag.removeChildFromTag(e,t),wV(t)&&(t=[t]);for(var n=0;n<t.length;n++)this.store.get(t[n]).then((function(t){var r,n,i=Qh(r=(null==t?void 0:t.tags)||[]).call(r,e);-1!==i&&kp(n=t.tags).call(n,i,1)}));var i={docUid:r.uid,sourceUids:t,type:"tag"};return this.hooks.removeFromDoc.emit(i),!0}return!1}},{key:"getSourceTags",value:function(e){var t,r=this,n=this.statusStore.get(e);return n?XB(t=n.ownerTags.children).call(t,(function(e){return r.tag.getTagByUid(e).name})):[]}},{key:"switch",value:function(e){var t=e.one,r=e.other,n=e.type,i=e.docUid,o=e.emit,a=this.getDocNode(i,n);if(a){if(a["switch"](t,r),o||bV(o)){var s={one:t,other:r,docUid:i,type:a.type,trigger:this.uid,operation:"shift"};this.hooks["switch"].emit(s)}return!0}return!1}},{key:"move",value:function(e){var t=e.from,r=e.to,n=e.type,i=e.docUid,o=e.emit,a=this.getDocNode(i,n);if(a){if(a.move(t,r),o||bV(o)){var s={from:t,to:r,docUid:i,type:a.type,trigger:this.uid,operation:"shift"};this.hooks.move.emit(s)}return!0}return!1}},{key:"reorder",value:function(e){var t=e.indexes,r=e.type,n=e.docUid,i=e.emit,o=this.getDocNode(n,r);if(o&&(o.reorder(t),i||bV(i))){var a={indexes:t,docUid:n,type:o.type,trigger:this.uid,operation:"shift"};this.hooks.move.emit(a)}}},{key:"getDocNode",value:function(e,t){switch(t){case"default":return this.defaultFile;case"file":return this.dir.getFileByUid(e);case"tag":return this.tag.getTagByUid(e);default:return e===this.defaultFile.uid?this.defaultFile:this.tag.getTagByUid(e)||(this.dir.getFileByUid(e)||null)}}}]),r}(DV),tG={Successful:{errorCode:0,errorString:"Successful."},InvalidIndex:{errorCode:-1033,errorString:"Invalid index."},InvalidValue:{errorCode:-1034,errorString:"Invalid value."},NoImage:{errorCode:-1035,errorString:"There is no image."},UnBindViewer:{errorCode:-2210,errorString:"You cannot call this method on this WebTwain instance because it does not use the default viewer."},AlReadyBindViewer:{errorCode:-2211,errorString:"The element is already bound to the viewer."},ParameterCannotEmpty:{errorCode:-2314,errorString:"The parameter cannot be empty."},IndicesNotArray:{errorCode:-2358,errorString:"The type of the parameter indices must be an Array."},IndexOutOfRange:{errorCode:-2359,errorString:"The index is out of range."},InvalidTagName:{errorCode:-2394,errorString:"Invalid tag name."},InvalidLeftOrTopOrRightOrBottom:{errorCode:-2417,errorString:"The left or top or right or bottom you entered is invalid."},InvalidWidth:{errorCode:-2418,errorString:"The width you entered is invalid."},InvalidHeight:{errorCode:-2419,errorString:"The height you entered is invalid."},WidthOrHeightOutOfImageSize:{errorCode:-2420,errorString:"The width or height is out of image size."},MobileServer_InvalidIndex:{errorCode:-2423,errorString:"The index is invalid."},ImageEditorExist:{errorCode:-2500,errorString:"An ImageEditor already exists."},ThumbnailViewerExist:{errorCode:-2501,errorString:"A ThumbnailViewer already exists."},CustomElementExist:{errorCode:-2502,errorString:"A CustomElement already exists."},ImageEditorDispose:{errorCode:-2504,errorString:"The ImageEditor object has been disposed."},ThumbnailViewerNotExist:{errorCode:-2505,errorString:"This ThumbnailViewer doesn't exist."},ThumbnailViewerDispose:{errorCode:-2506,errorString:"The ThumbnailViewer object has been disposed."},CallbackNotAFunction:{errorCode:-2510,errorString:"The callback is not a function."},ElementRequired:{errorCode:-2511,errorString:"Parameter 'element' is required."},ElementNotExist:{errorCode:-2512,errorString:"Parameter 'element' doesn't instanceof HTMLDivElement."},InvalidPropertyValue:{errorCode:-2514,errorString:"Invalid property value."},CursorInvalidMode:{errorCode:-2519,errorString:"The current mode does not support setting the cursor to zoom."},OldTagNameRequired:{errorCode:-2517,errorString:"Old tag name is required."},NewTagNameRequired:{errorCode:-2518,errorString:"New tag name is required."},FileNameCannotEmpty:{errorCode:-2530,errorString:"Document name cannot be empty."},FileNameNotString:{errorCode:-2531,errorString:"Document name is not a string."},FileNotExist:{errorCode:-2540,errorString:"The document does not exist."},FileExist:{errorCode:-2541,errorString:"The document already exists."},CustomElementDispose:{errorCode:-2508,errorString:"The CustomElement object has been disposed."},CustomElementNotExist:{errorCode:-2507,errorString:"This CustomElement doesn't exist."},ParameterOutRange:{errorCode:80002,errorString:"The parameter is out of range."},TagNotExist:{errorCode:80009,errorString:"Tag does not exist."},TagExist:{errorCode:80010,errorString:"The tag already exists."},OperationError:{errorCode:80022,errorString:"The operation mode is wrong."}};(VV=UV||(UV={}))[VV.Normal=0]="Normal",VV[VV.Balance=1]="Balance";var rG=function(){function e(t){Ft(this,e),FR(this,"space",void 0),FR(this,"webViewer",void 0),FR(this,"isActiveFile",!1),FR(this,"isActiveTag",!1),FR(this,"currentFileName",""),FR(this,"currentTagName",""),FR(this,"bufferConfig",null),FR(this,"currentSelected",[]),this.space=new eG,t&&(this.bufferConfig=t)}return mh(e,[{key:"e",value:function(){this.setError("Successful")}},{key:"convertServerIdToGuid",value:function(e){return 1*e+239514e3}},{key:"IsFileNameExist",value:function(e){var t=this.space.getFileList();if("dynamsoft-default-document"===e)return!0;if(t)for(var r=0;r<t.length;r++)if(t[r].name===e)return!0;return!1}},{key:"getCurrentDataSet",value:function(){if(this.webViewer){var e=this.webViewer.myViewer.getCurrentTab();if(void 0===e)return!1;var t=e.type;this.isActiveFile="file"===t,this.isActiveTag="tag"===t}if(this.isActiveFile){var r=this.getCurrentFileName(),n=this.space.getFile(r);if(n)return n}if(this.isActiveTag){var i=this.space.getTag(this.currentTagName);if(i)return i}return!1}},{key:"setError",value:function(e){var t;if("Default"!==e){if(this.webViewer)this.webViewer.setError(e);else if(this.bufferConfig&&this.bufferConfig.viewerError){var r=tG[e],n=r.errorCode,i=r.errorString;this.bufferConfig.viewerError.setError(n,i)}}else null==this||null===(t=this.webViewer)||void 0===t||t.setDefaultError()}},{key:"emitViewerEvent",value:function(){var e,t,r,n;this.webViewer&&0===this.getHowManyImagesInBuffer()&&(null!==(e=this.webViewer)&&void 0!==e&&null!==(t=e.myViewer)&&void 0!==t&&t.emit("topPageChanged",-1),null===(r=this.webViewer)||void 0===r||null===(n=r.myViewer)||void 0===n||n.emit("pageRendered",-1))}},{key:"bindViewer",value:function(e){this.webViewer=e}},{key:"getCurrentTag",value:function(){return this.currentTagName}},{key:"getCurrentDocument",value:function(){return this.currentFileName}},{key:"getCurrentFileName",value:function(){var e=this,t=this.space.getFileList(),r="";return t&&oN(t).call(t,(function(t){t.name===e.currentFileName&&(r=e.currentFileName)})),r}},{key:"getCurrentIndex",value:function(){if(this.webViewer)return this.webViewer.getCurrentIndex();var e=this.getSelectedImagesIndices().length;if(e<=0){var t=this.getCurrentDataSet();return!!t&&t.children.length-1}return this.getSelectedImagesIndices()[e-1]}},{key:"getHowManyImagesInBuffer",value:function(){if(this.webViewer)return this.webViewer.getHowManyImagesInBuffer();var e=this.getCurrentDataSet();return e?e.children.length:0}},{key:"getSelectedImagesIndices",value:function(){return this.webViewer?this.webViewer.getSelectedImagesIndices():this.currentSelected}},{key:"getIndexByUid",value:function(e){if(!wV(e)||!e)return this.setError("InvalidValue"),!1;if(this.webViewer)return this.webViewer.myViewer.getIndexByUid(e);var t=this.getCurrentDataSet(),r=t.children;return!!(t&&r&&TV(r))&&Qh(r).call(r,e)}},{key:"getUidByIndex",value:function(e){if(e<0||e>=this.getHowManyImagesInBuffer())return this.setError("IndexOutOfRange"),!1;if(this.webViewer)return this.webViewer.myViewer.getUidByIndex(e);var t=this.getCurrentDataSet().children;return!(t&&t.length<e)&&t[e]}},{key:"getDataByUid",value:function(e){return this.space.getSource(e)}},{key:"updateDataByUid",value:function(e,t){return this.space.store.set(e,t)}},{key:"setCustomDataByUid",value:function(e,t){return wV(e)&&""!==e?this.space.setCustomData(e,t):(this.setError("InvalidValue"),!1)}},{key:"getCustomDataByUid",value:function(e){return this.space.getCustomData(e)}},{key:"setMetadataByUid",value:function(e,t){return wV(e)&&""!==e?this.space.setMetadata(e,t):(this.setError("InvalidValue"),!1)}},{key:"getMetadataByUid",value:function(e){return this.space.getMetadata(e)}},{key:"addImage",value:function(e,t,r){var n,i,o={},a=this.currentFileName,s="";!bV(r)&&wV(r)?(this.IsFileNameExist(r)||this.createDocument(r),s=r):bV(a)||""===a?(this.space.isFileExisted("dynamsoft-default-document")||this.createDocument("dynamsoft-default-document"),this.webViewer&&(this.webViewer.bEmitBufferChanged=!1),this.openDocument("dynamsoft-default-document"),this.webViewer&&(this.webViewer.bEmitBufferChanged=!0),s="dynamsoft-default-document"):s=a,t&&(delete(i=IV({},t)).oriBlobData,t.oriBlobData&&(n=t.oriBlobData));var u=e.imageUrl,c=e.minImageUrl,l=e.imageId,d=e.index;if(n&&(o=IV({},n)),l&&(o.imageId=l),!bV(d)&&EV(d)){var f=this.getDocumentContents(s).length;d>=f&&(d=f)}var h=this.space.loadSource({data:[{oriData:u,minData:c,metadata:i,customData:o}],filename:s,index:d}),g=xR(h,1)[0];return e.uuid=g,this.currentSelected=!bV(d)&&EV(d)?[d]:[],h}},{key:"insertImage",value:function(e,t,r){var n;return r&&r>=0?(n=this.space.loadSource({data:[e],filename:t,index:r}))[0]&&(this.currentSelected=[r]):(n=this.space.loadSource({data:[e],filename:t}),this.currentSelected=[]),n[0]}},{key:"updateImage",value:function(e,t){var r=e.imageUrl,n=e.minImageUrl,i=e.imageId,o=e.uuid,a=IV({},t);return o&&""!==o&&-1!==o?(this.space.updateSource(o,{oriData:r,minData:n,metadata:a,customData:{imageId:i}}),o):(this.setError("IndexOutOfRange"),!1)}},{key:"removeImageByUid",value:function(e){if(this.e(),this.webViewer){var t=this.webViewer.removePageByUid(e);return this.webViewer.resized(),this.emitViewerEvent(),t}return this.space.removeSource(e)}},{key:"removeImageByIndex",value:function(e){if(this.e(),e<0||e>=this.getHowManyImagesInBuffer())return this.setError("IndexOutOfRange"),!1;var t=this.getCurrentIndex(),r=!1;if(this.webViewer)r=this.webViewer.removePageByIndexes(e),this.webViewer.resized(),this.emitViewerEvent();else{var n=this.getCurrentDataSet();if(!n)return!1;r=this.space.removeSource(n.children[e])}return r||this.setError("Default"),this.currentSelected=e===t&&0===e?this.getHowManyImagesInBuffer()>0?[0]:[]:e<=t?[t-1]:[t],r}},{key:"removeSelectedImages",value:function(e){this.e();var t=this.getSelectedImagesIndices();TV(e)&&e.length>0&&(t=e);var r=!1;if(this.webViewer)r=this.webViewer.removePageByIndexes(t),this.webViewer.resized(),this.emitViewerEvent();else{var n=[],i=this.getCurrentDataSet();if(!i)return!1;oN(t).call(t,(function(e){i.children[e]&&i.children[e]&&n.push(i.children[e])})),r=this.space.removeSource(n)}return r||this.setError("Default"),r}},{key:"removeImageByIndexArr",value:function(e){if(this.e(),!TV(e))return!1;var t=this.getCurrentDataSet();if(!t)return!1;var r,n=[];return oN(e).call(e,(function(e){var r=t.children[e];r&&n.push(r)})),(r=this.space.removeSource(n))||this.setError("Default"),this.webViewer&&(this.webViewer.resized(),this.emitViewerEvent()),this.currentSelected=[],r}},{key:"removeAllImages",value:function(){this.e();var e=!1;if(this.webViewer)e=this.webViewer.removeAllPages(),this.webViewer.resized(),this.emitViewerEvent();else{var t=this.getCurrentDataSet();t&&(e=this.space.removeSource(DR(t.children)))}return e||this.setError("Default"),this.currentSelected=[],e}},{key:"tagImages",value:function(e,t){this.e();var r=this.getHowManyImagesInBuffer();if(!TV(e))return this.setError("IndicesNotArray"),!1;if(!wV(t)||""===t)return this.setError("InvalidTagName"),!1;for(var n=0;n<r;n++){var i=e[n];if(cN(i)||i<0||i>=r)return this.setError("IndexOutOfRange"),!1}this.space.createTag(t);for(var o=0;o<e.length;o++){var a=e[o];if(a>=0){var s=this.getUidByIndex(a);s&&""!==s&&-1!==Ng(s,10)&&this.space.addTagToSource(s,t)}}return!0}},{key:"removeImageTag",value:function(e,t){if(this.e(),!EV(e))return this.setError("InvalidValue"),!1;if(e<0||e>this.getHowManyImagesInBuffer())return this.setError("IndexOutOfRange"),!1;var r=this.getUidByIndex(e),n=!1;return r&&""!==r&&-1!==r&&(n=this.space.removeTagFromSource(r,t)),n||this.setError("Default"),n}},{key:"getDefaultTag",value:function(){return this.space.getDefaultTag()}},{key:"setDefaultTag",value:function(e){if(this.e(),!wV(e))return this.setError("InvalidValue"),!1;if(""===e)return this.currentTagName="",this.space.setDefaultTag(null),!0;var t;return this.currentTagName=e,this.space.createTag(e),(t=this.space.setDefaultTag(e))||this.setError("Default"),t}},{key:"removeTag",value:function(e,t){var r=this;if(this.e(),!wV(e))return this.setError("InvalidValue"),!1;if(!bV(t)&&!TV(t))return this.setError("IndicesNotArray"),!1;if(!this.space.isTagExisted(e))return this.setError("TagNotExist"),!1;var n=this.currentTagName,i=!1,o=!1;if(n&&(i=n===e),bV(t))o=this.space.removeTag(e),i&&this.clearFilter();else{var a=[];oN(t).call(t,(function(e){var t=r.getUidByIndex(e);-1!==t&&a.push(t)}));for(var s=0;s<(null==a?void 0:a.length);s++)if(!(o=this.space.removeTagFromSource(a[s],e)))return!1}return o||this.webViewer.setDefaultError(),o}},{key:"renameTag",value:function(e,t){if(this.e(),bV(e)||""===e)return this.setError("OldTagNameRequired"),!1;if(bV(t)||""===t)return this.setError("NewTagNameRequired"),!1;if(!this.space.isTagExisted(e))return this.setError("TagNotExist"),!1;if(this.space.isTagExisted(t))return this.setError("TagExist"),!1;var r;return this.currentTagName=t,(r=this.space.renameTag(e,t))?this.space.setDefaultTag(t):this.setError("Default"),r}},{key:"getTagContents",value:function(e){return this.e(),e&&wV(e)&&""!==e?this.space.getTag(e).children:[]}},{key:"getTagList",value:function(){var e=this;this.e();var t=this.space.getTagList(),r=[];return t?oN(t).call(t,(function(t){var n,i=[];oN(n=t.children).call(n,(function(t){var r=e.getCustomDataByUid(t);if(r){var n=e.convertServerIdToGuid(r.imageId);i.push(n)}})),r.push({name:t.name,imageIds:i})})):r=[],r}},{key:"getTagListByIndex",value:function(e){if(!EV(e))return!1;var t=this.getUidByIndex(e);return this.space.getSourceTags(t)}},{key:"clearFilter",value:function(){this.e(),this.currentTagName="";var e,t=this.getCurrentFileName();return""===t&&(t="dynamsoft-default-document"),(e=this.openDocument(t))||this.setError("Default"),e}},{key:"filterImagesByTag",value:function(e,t,r){this.e();var n=!1;if(bV(e)||null===e||""===e){this.currentTagName="";var i=this.getCurrentFileName();""===i&&(i="dynamsoft-default-document"),(n=this.openDocument(i))?AV(t)&&t():(this.setError("Default"),AV(r)&&r())}else{var o,a;if(!this.space.isTagExisted(e))return this.setError("TagNotExist"),AV(r)&&r(),!1;this.currentTagName=e,(n=this.space.openTag(e,null==this||null===(o=this.webViewer)||void 0===o||null===(a=o.myViewer)||void 0===a?void 0:a.uid))?(this.isActiveTag=!0,this.isActiveFile=!1,this.setDefaultTag(e),AV(t)&&t()):(this.setError("Default"),AV(r)&&r())}return this.webViewer&&this.webViewer.render(),n}},{key:"createDocument",value:function(e){if(this.e(),!e||""===e){var t=EV(e)?"FileNameNotString":"FileNameCannotEmpty";return this.setError(t),!1}return wV(e)?this.space.isFileExisted(e)?(this.setError("FileExist"),!1):!!this.space.createFile(e)||(this.setError("Default"),!1):(this.setError("FileNameNotString"),!1)}},{key:"openDocument",value:function(e,t){var r,n;if(this.e(),!e||""===e){var i=EV(e)?"FileNameNotString":"FileNameCannotEmpty";return this.setError(i),!1}if(!wV(e))return this.setError("FileNameNotString"),!1;if(!this.space.isFileExisted(e))return this.setError("FileNotExist"),!1;var o=t&&""!==t?t:null==this||null===(r=this.webViewer)||void 0===r||null===(n=r.myViewer)||void 0===n?void 0:n.uid;return this.space.openFile(e,{viewerUid:o})?(this.currentFileName=e,this.isActiveFile=!0,this.isActiveTag=!1,!0):(this.setError("Default"),!1)}},{key:"getDocumentContents",value:function(e){return this.e(),e&&wV(e)&&""!==e?this.space.getFile(e).children:[]}},{key:"renameDocument",value:function(e,t){return this.e(),wV(e)&&wV(t)?(e&&""!==e&&t&&""!==t||this.setError("FileNameCannotEmpty"),this.space.isFileExisted(e)?this.space.isFileExisted(t)?(this.setError("FileExist"),!1):this.space.renameFile(e,t)?(this.currentFileName=t,!0):(this.setError("Default"),!1):(this.setError("FileNotExist"),!1)):(this.setError("FileNameNotString"),!1)}},{key:"removeDocument",value:function(e){if(this.e(),!e||!wV(e))return this.setError("FileNameNotString"),!1;if(!this.space.isFileExisted(e))return this.setError("FileNotExist"),!1;var t=this.space.removeFile(e);return t?(t&&this.webViewer&&this.webViewer.resized(),this.currentFileName===e&&(this.currentFileName=""),!0):(this.setError("Default"),!1)}},{key:"getDocumentInfoList",value:function(){var e=this;this.e();var t=this.space.getFileList(),r=[];return t?(oN(t).call(t,(function(t){if(t.children){for(var n=[],i=0;i<t.children.length;i++){var o=t.children[i],a=e.getCustomDataByUid(o);a&&n.push(e.convertServerIdToGuid(a.imageId))}r.push({imageIds:n,name:t.name})}})),r):[]}},{key:"getDocumentInfo",value:function(e){this.e();var t=this.space.getFile(e);if(!t)return{imageIds:[],length:0};for(var r=[],n=0;n<t.children.length;n++){var i=t.children[n],o=this.getCustomDataByUid(i);o&&r.push(this.convertServerIdToGuid(o.imageId))}return{imageIds:r,length:r.length}}},{key:"selectImages",value:function(e){this.e();var t=!0;if(!e||!TV(e))return!1;if(this.webViewer){var r=this.webViewer.getIfAutoScroll();!1===r&&this.webViewer.setIfAutoScroll(!0),t=this.webViewer.selectPages(e),!1===r&&this.webViewer.setIfAutoScroll(!1)}else{for(var n=this.getHowManyImagesInBuffer(),i=0;i<e.length;i++)if(!EV(e[i])||e[i]<0||e[i]>=n)return this.setError("ParameterOutRange"),!1;t=!0}return t?this.currentSelected=e:this.setError("Default"),t}},{key:"selectAllImages",value:function(){this.e();var e=!0;if(this.webViewer)e=this.webViewer.myViewer.selectAll(),this.currentSelected=this.webViewer.getSelectedImagesIndices();else{var t,r=this.getCurrentDataSet();this.currentSelected=hU(rg(t=new Array(r.children.length)).call(t))}return e||this.setError("Default"),e}},{key:"moveImage",value:function(e,t){this.e();var r=Ng(e,10),n=Ng(t,10);if(cN(e)||cN(t))return this.setError("InvalidIndex"),!1;var i=this.getHowManyImagesInBuffer();if(r<0||r>=i||n<0||n>i)return this.setError("IndexOutOfRange"),!1;var o=!1;if(this.webViewer)o=this.webViewer.myViewer.movePage(e,t);else{var a=this.getCurrentDataSet();if(!a)return!1;o=this.space.move({docUid:a.uid,type:a.type,from:e,to:t})}return o||this.setError("Default"),this.currentSelected=[t],o}},{key:"switchImage",value:function(e,t){this.e();var r=Ng(e,10),n=Ng(t,10);if(cN(e)||cN(t))return this.setError("InvalidIndex"),!1;var i=this.getHowManyImagesInBuffer(),o=this.getCurrentIndex();if(r<0||r>=i||n<0||n>i)return this.setError("IndexOutOfRange"),!1;var a=!1;if(this.webViewer)a=this.webViewer.myViewer.switchPage(e,t);else{var s=this.getCurrentDataSet();if(!s)return!1;a=this.space["switch"]({docUid:s.uid,type:s.type,one:e,other:t})}a||this.setError("Default");var u=o;return r===o?u=n:n===o&&(u=r),this.currentSelected=[u],a}},{key:"moveImageToFile",value:function(e,t,r,n){if(!this.space.isFileExisted(e)||!this.space.isFileExisted(r))return this.setError("FileNotExist"),!1;t=DR(new _V(t));var i=this.getDocumentInfo(e).length;return!TV(t)||t.length>i?(this.setError("ParameterOutRange"),!1):this.space.movePagesToFile(e,t,r,n)}}]),e}();HTMLCanvasElement.prototype.toBlob||vV(HTMLCanvasElement.prototype,"toBlob",{value:function(e,t,r){for(var n=atob(this.toDataURL(t,r).split(",")[1]),i=n.length,o=new Uint8Array(i),a=0;a<i;a++)o[a]=n.charCodeAt(a);e(new Blob([o],{type:t||"image/png"}))}});var nG=function(){function e(r){if(t(this,e),r)this._baseUrl=r._baseUrl,this._buffer=r._buffer,this._imageIdMap=r._imageIdMap;else{var n={viewerError:{setError:function(e,t){Et.log(e,t),this._error={code:e,message:t}}}};this._baseUrl="",this._buffer=new rG(n),this._imageIdMap={}}}return i(e,[{key:"getError",value:function(){return this._error}},{key:"BaseUrl",get:function(){return this._baseUrl}},{key:"getImageUrl",value:function(e){var t=this.convertClientIndexToServerId(e),r=Date.now();return kx.getImageUrl(this._baseUrl,t,-1,-1,r)}},{key:"getMinImageUrl",value:function(e,t,r){var n=this.convertClientIndexToServerId(e),i=Date.now();return n&&t&&r?kx.getImageUrl(this._baseUrl,n,parseInt(t),parseInt(r),i):""}},{key:"append",value:function(e,t,r,n){var i,o,a,s=Date.now(),u=t;if(i={imageUrl:o=kx.getImageUrl(this._baseUrl,t,-1,-1,s),minImageUrl:r&&r.controlWidth&&r.controlWidth>0&&r.controlHeight&&r.controlHeight>0?xt.navInfoSync.bMobile?kx.getImageUrl(this._baseUrl,t,Math.round(r.controlWidth*devicePixelRatio),Math.round(r.controlHeight*devicePixelRatio),s):kx.getImageUrl(this._baseUrl,t,parseInt(r.controlWidth),parseInt(r.controlHeight),s):o,imageId:u},a=r.currentFileName.length>0?this._buffer.addImage(i,r,r.currentFileName):this._buffer.addImage(i,r)){var c=FF(a,1)[0];return this._innerInsertModel(i.imageId,c,i.imageUrl,i.minImageUrl),c}return!1}},{key:"insertBefore",value:function(e,t,r,n){var i,o,a=Date.now(),s=r;i={imageUrl:o=kx.getImageUrl(this._baseUrl,r,-1,-1,a),minImageUrl:n&&n.controlWidth&&n.controlWidth>0&&n.controlHeight&&n.controlHeight>0?xt.navInfoSync.bMobile?kx.getImageUrl(this._baseUrl,r,Math.round(n.controlWidth*devicePixelRatio),Math.round(n.controlHeight*devicePixelRatio),a):kx.getImageUrl(this._baseUrl,r,parseInt(n.controlWidth),parseInt(n.controlHeight),a):o,imageId:s,index:e};var u=this._buffer.addImage(i);if(u){var c=FF(u,1)[0];return this._innerInsertModel(i.imageId,c,i.imageUrl,i.minImageUrl),this._buffer.openDocument(this.getCurrentFileName()),c}return!1}},{key:"_innerInsertModel",value:function(e,t,r,n){var i=new WF;i.imageId=e,i.uuid=t,i.imageUrl=r,i.minImageUrl=n,this._imageIdMap[e]=i}},{key:"refresh",value:function(e,t,r,n){var i,o=this,a=1*e;if(r){var s=o.count();if(a<0||a>s)return!1;i=o.convertClientIndexToServerId(a),o.__setDataImageControl(a,i,n)}return!0}},{key:"__setDataImageControl",value:function(e,t,r){var n,i,o,a=this,s=a._baseUrl;return-1!=t&&((n=a.getImageIdMap(t))||((n=new WF).imageId=t,a._imageIdMap[t]=n),s&&(null!=n&&(n.ticks=Date.now()),i=kx.getImageUrl(s,t,-1,-1,n.ticks),o=r&&r.controlWidth&&r.controlWidth>0&&r.controlHeight&&r.controlHeight>0?xt.navInfoSync.bMobile?kx.getImageUrl(s,t,Math.round(r.controlWidth*devicePixelRatio),Math.round(r.controlHeight*devicePixelRatio),n.ticks):kx.getImageUrl(s,t,parseInt(r.controlWidth),parseInt(r.controlHeight),n.ticks):i,n.imageUrl=i,n.minImageUrl=o,a._buffer.updateImage(n,r)),!0)}},{key:"convertIndicesToServerIds",value:function(e){var t,r=e.length,n=[];for(t=0;t<r;t++){var i=this._buffer.getUidByIndex(e[t]);if(i&&-1!=i){var o=this._buffer.getCustomDataByUid(i);n.push(o.imageId)}}return n}},{key:"removeImagesByServerId",value:function(e,t){var r=this,n=null!=t?t:this._buffer.getCurrentDocument(),i=[];return Et.each(e,(function(e,t){var o=parseInt(e);r._removeMapModelImageControlByServerId(o);var a=-1;return a=r._buffer.isActiveFile?r._convertServerIdToIndexInFile(n,o):r._convertServerIdToIndex(o),!isNaN(a)&&(!(a<0||a>=r.count())&&void i.push(a))})),i.length>0&&r._buffer.removeImageByIndexArr(i)}},{key:"removeByServerId",value:function(e,t,r){var n=this,i=null!=r?r:this._buffer.getCurrentDocument();n._removeMapModelImageControlByServerId(e);var o=-1;return o=this._buffer.isActiveFile?this._convertServerIdToIndexInFile(i,e):t,!isNaN(o)&&(!(o<0||o>=n.count())&&n._buffer.removeImageByIndex(o))}},{key:"exists",value:function(e){if(this._imageIdMap[e])return!0;var t=-1;if(this._buffer.isActiveFile){var r=this.getCurrentFileName();t=this._convertServerIdToIndexInFile(r,e)}else t=this._convertServerIdToIndex(e);return t>-1}},{key:"removeImages",value:function(e){var t,r,n;for(n=e.length,t=0;t<n;t++)r=this.convertClientIndexToServerId(e[t]),this._removeMapModelImageControlByServerId(r);return this._buffer.removeSelectedImages(e)}},{key:"clear",value:function(){var e,t,r,n=this;for(r=n.count(),e=0;e<r;e++)t=n.convertClientIndexToServerId(e),this._removeMapModelImageControlByServerId(t);return r==Object.keys(n._imageIdMap).length&&(n._imageIdMap={}),n._buffer.removeAllImages()}},{key:"convertServerIdToClientIndex",value:function(e){var t,r,n,i=this;if((n=i._imageIdMap[e])&&(r=n.uuid),r)t=i._buffer.getIndexByUid(r);else if(i._buffer.isActiveFile){var o=this.getCurrentFileName();t=this._convertServerIdToIndexInFile(o,e)}else t=this._convertServerIdToIndex(e);return Et.isNumber(t)||(t=-1),t}},{key:"getIndexByUid",value:function(e){var t;return!1===(t=this._buffer.getIndexByUid(e))?-1:t}},{key:"getUidByIndex",value:function(e){return this._buffer.getUidByIndex(e)}},{key:"convertClientIndexToServerId",value:function(e){var t=this.getCustomDataByIndex(e);return t?t.imageId:-1}},{key:"getCurrentImageIndex",value:function(){return this._buffer.getCurrentIndex()}},{key:"setCurrentImageIndex",value:function(e){return this._buffer.selectImages([e])}},{key:"getCurrentFileName",value:function(){return this._buffer.getCurrentFileName()}},{key:"setDefaultTag",value:function(e){return this._buffer.setDefaultTag(e)}},{key:"getDefaultTag",value:function(){return this._buffer.getDefaultTag()}},{key:"count",value:function(){return this._buffer.getHowManyImagesInBuffer()}},{key:"getCountByDocumentName",value:function(e){return this._buffer.getDocumentInfo(e).length}},{key:"dispose",value:function(){this.clear()}},{key:"getImageData",value:function(e){var t=this._buffer.getUidByIndex(e);return t?this._buffer.getDataByUid(t):bt.Promise.resolve(null)}},{key:"getCustomDataByIndex",value:function(e){return this._buffer.getCustomDataByUid(this._buffer.getUidByIndex(e))}},{key:"getMetadataByIndex",value:function(e){return this._buffer.getMetadataByUid(this._buffer.getUidByIndex(e))}},{key:"setCustomData",value:function(e,t){var r=this._buffer.getUidByIndex(e);return!(!r||!t)&&this._buffer.setCustomDataByUid(r,t)}},{key:"openDocument",value:function(e){return this._buffer.openDocument(e)}},{key:"createDocument",value:function(e){return this._buffer.createDocument(e)}},{key:"getImageIdMap",value:function(e){return this._imageIdMap[e]}},{key:"_removeMapModelImageControlByServerId",value:function(e){var t=this;-1!=e&&t._imageIdMap[e]&&(t._imageIdMap[e].Clear(),delete t._imageIdMap[e])}},{key:"_convertServerIdToIndexInFile",value:function(e,t){var r,n,i=-1;for(r=this._buffer.getDocumentContents(e),n=0;n<r.length;n++){var o=r[n];if(o){var a=this._buffer.getCustomDataByUid(o);if(a&&a.imageId==t){i=n;break}}}return i}},{key:"_convertServerIdToIndex",value:function(e){var t,r=-1;for(t=0;t<this.count();t++){var n=this._buffer.getUidByIndex(t);if(n){var i=this._buffer.getCustomDataByUid(n);if(i&&i.imageId==e){r=t;break}}}return r}},{key:"convertServerIdToUUID",value:function(e){var t=this._imageIdMap[e];return t?t.uuid:-1}},{key:"convertUUIDToServerId",value:function(e){var t=this._buffer.getCustomDataByUid(e);return t&&t.imageId?t.imageId:-1}},{key:"UpdateImage",value:function(e,t){return this._buffer.updateImage(e,t),!0}}],[{key:"_setBaseUrl",value:function(e,t){e._baseUrl=t}},{key:"_getBuffer",value:function(e){return e._buffer}}]),e}();function iG(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(VV){return!1}}();return function(){var r,n=cA(e);if(t){var i=cA(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return uA(this,r)}}var oG,aG,sG=function(e){sA(a,e);var r,n,o=iG(a);function a(e){var r;t(this,a),(r=o.call(this,e)).__IfAppendImage=oC,r.__maxImagesInBuffer=32767,r.__insertingIndex=-1,r._aryBitmapCache=[],r._imageBufferWrapper=new nG;var n=eF.getServerImageUrlPrefix(oA(r));return nG._setBaseUrl(r._imageBufferWrapper,n),r}return i(a,[{key:"_registerMultiEvent",value:function(e,t){var r=this;if(r._resetErr(),!r._isValid())return!1;var n=["_$",e].join("");r[n]||(r[n]={});var i=r[n],o=Et.guid();return i[o]=t,o}},{key:"_unregisterMultiEvent",value:function(e,t){var r=this;if(r._resetErr(),!r._isValid())return!1;var n=["_$",e].join(""),i=r[n];if(t){var o;if(Et.isString(t))return delete i[t],oC;if(Et.isFunction(t))for(o=0;o<i.length;o++)if(t==i[o])return i.splice(o,1),oC}return r[n]=null,oC}},{key:"_getMetadata",value:function(e){return this._imageBufferWrapper.getMetadataByIndex(e)}},{key:"_updateImage",value:function(e,t,r){var n=this,i={imageId:e,bufferLen:t.byteLength,imageType:15,width:parseInt(r.width),height:parseInt(r.height),bit:r.bitDepth,xres:parseInt(r.resolutionX),yres:parseInt(r.resolutionY)},o=Et.stringify([Et.stringify(i)]);return new bt.Promise((function(e,r){n._innerSendBlobByWS("UpdateImage",o,t,(function(t){Et.log("UpdateImage success."),e(t)}),(function(e){Et.log("UpdateImage failed."),Et.error(e),r(e)}))}))}},{key:"_removeImages",value:function(e){return this._imageBufferWrapper.removeImages(e)}},{key:"_getCurrentDocumentName",value:function(){var e="";return this._imageBufferWrapper&&(e=this._imageBufferWrapper.getCurrentFileName()),e}},{key:"_getCurrentDefaultTagName",value:function(){var e="";return this._imageBufferWrapper&&(e=this._imageBufferWrapper.getDefaultTag()),e}},{key:"_innerRefreshUI",value:function(e,t,r,n,i){var o=this;return r&&o._imageBufferWrapper.refresh(e,o._imageBufferWrapper.count(),!0,n),Et.isFunction(o.__OnRefreshUI)&&o.__OnRefreshUI(o._imageBufferWrapper.getCurrentImageIndex(),o._imageBufferWrapper.count()),!0}},{key:"_getHowManyImagesInBuffer",value:function(){return this._isValid()?this._imageBufferWrapper.count():0}},{key:"_OnBitmapChanged",value:function(e,t,r){var n,i,o,a=this,s="10"==e[0],u="0"==e[0],c="c2"==e[0],l=u||c||s,d=e[1].split(","),f=e[2],h=e[3],g=a.__maxImagesInBuffer,p=-1,m=!1,_=[];if(r&&(n=r.document,i=r.tag,r.bNeedClearTag&&(o=r.bNeedClearTag)),Et.log("_OnBitmapChanged.currentFileName="+n+", tag="+i),n?n!=a._getCurrentDocumentName()&&(m=!0):n=a._getCurrentDocumentName(),a._imageBufferWrapper&&(i?(a._imageBufferWrapper.setDefaultTag(i),Et.log("metaDataObj.currentTag="+i)):o&&(a._imageBufferWrapper.setDefaultTag(""),Et.log("metaDataObj.currentTag=''"))),s);else if(c)e.length>5&&(_=e[5]),Et.isArray(_)||(_=[]);else{var v={};if(e.length>5&&(v.width=e[5]),e.length>6&&(v.height=e[6]),e.length>7&&(v.bitDepth=e[7]),e.length>8&&(v.resolutionX=e[8]),e.length>9&&(v.resolutionY=e[9]),e.length>10&&(p=e[10]),_.push(v),p>-1&&a._blts&&(f==dF.enumBCAppend||f==dF.enumBCInsert)){var y=xt.DWT.lgct(p);Et.isFunction(a.__OnLtsverify)&&a.__OnLtsverify(y,1)}}if(Et.log("OnBitmapChanged:"+e),f==dF.enumBCInsert||f==dF.enumBCAppend&&!a.__IfAppendImage)Et.each(d,(function(e,t){var r,i=parseInt(e),o=a._imageBufferWrapper.getCurrentImageIndex();if((r=t<_.length&&_[t]?_[t]:{}).currentFileName=n,isNaN(i)||i<0)return!0;if(l)a._aryBitmapCache.push(i);else for(var s=0;s<a._aryBitmapCache.length;s++)if(a._aryBitmapCache[s]==i)return a._aryBitmapCache.splice(s,1),!0;if(a._imageBufferWrapper.exists(i))return!0;a.__insertingIndex>-1&&(o=a.__insertingIndex),r.controlWidth=400,r.controlHeight=400,a._controlWidth&&a._controlWidth>400&&(r.controlWidth=a._controlWidth),a._controlHeight&&a._controlHeight>400&&(r.controlHeight=a._controlHeight),-1==o&&(o=0),a._imageBufferWrapper.insertBefore(o,g,i,r),a.__insertingIndex>-1&&(a.__insertingIndex=a.__insertingIndex+1)})),Et.isFunction(a.__OnRefreshUI)&&a.__OnRefreshUI(a._imageBufferWrapper.getCurrentImageIndex(),a._imageBufferWrapper.count());else if(f==dF.enumBCAppend&&a.__IfAppendImage)Et.each(d,(function(e,t){var r,i=parseInt(e);if(isNaN(i)||i<0)return!0;if((r=t<_.length&&_[t]?_[t]:{}).currentFileName=n,Et.log("metaDataObj.currentFileName="+n),l)a._aryBitmapCache.push(i);else for(var o=0;o<a._aryBitmapCache.length;o++)if(a._aryBitmapCache[o]==i)return a._aryBitmapCache.splice(o,1),!0;if(a._imageBufferWrapper.exists(i))return!0;r.controlWidth=400,r.controlHeight=400,a._controlWidth&&a._controlWidth>400&&(r.controlWidth=a._controlWidth),a._controlHeight&&a._controlHeight>400&&(r.controlHeight=a._controlHeight),m?a._imageBufferWrapper.append(g,i,r,n):a._imageBufferWrapper.append(g,i,r)})),Et.isFunction(a.__OnRefreshUI)&&a.__OnRefreshUI(a._imageBufferWrapper.getCurrentImageIndex(),a._imageBufferWrapper.count());else if(f==dF.enumBCRemove&&l){var I=!1;if(1==d.length&&-1==d[0]&&(I=!0),I)a._imageBufferWrapper.clear();else{var S=[];Et.each(d,(function(e,t){var r=parseInt(e);if(isNaN(r)||r<0)return!0;S.push(r)})),a._imageBufferWrapper.removeImagesByServerId(S,n)}Et.isFunction(a.__OnRefreshUI)&&a.__OnRefreshUI(a._imageBufferWrapper.getCurrentImageIndex(),a._imageBufferWrapper.count())}else if(f==dF.enumBCEdit)Et.each(d,(function(e,t){var r,i=parseInt(e);if(isNaN(i)||i<0)return!0;if((r=t<_.length&&_[t]?_[t]:{}).currentFileName=n,i>=0&&!a.__bLoadingImage){var o=a._imageBufferWrapper.convertServerIdToClientIndex(i);o>-1&&a._innerRefreshUI(o,a._imageBufferWrapper.count(),!0,r,f)}}));else if(f==dF.enumBCIndexChange){var T;if(h>=0&&!a.__bLoadingImage)(T=0<_.length&&_[0]?_[0]:{}).currentFileName=n,0==a.__IfAppendImage&&a._innerRefreshUI(h,a._imageBufferWrapper.count(),!0,T,f),a._imageBufferWrapper.refresh(h,a._imageBufferWrapper.count(),!1,T)}if(Et.isFunction(a.__OnBitmapChanged)){if(!s)if(l){if(f==dF.enumBCRemove);else if(!K.bFirefox&&l)return!0}else{if(f==dF.enumBCRemove)return!0;if(K.bFirefox&&!l)return!0}var b=[];Et.each(d,(function(e){var t,r=parseInt(e);if(isNaN(r)||r<0)return!0;(t=a._imageBufferWrapper.convertServerIdToClientIndex(r))>-1&&b.push(t)}));var C=a._imageBufferWrapper.getCurrentImageIndex(),w=f;f==dF.enumBCAppend&&(w=a.__IfAppendImage?dF.enumBCAppend:dF.enumBCInsert),a.__OnBitmapChanged(b,w,C,a._imageBufferWrapper.count())}}},{key:"_removeImageAsync",value:(n=eA(g.mark((function s(e,t){var r,n,i;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this,n=parseInt(t),EF(r,n)){e.next=4;break}return e.abrupt("return",!1);case 4:return i=r._imageBufferWrapper.convertClientIndexToServerId(n),e.next=7,r._removeImageByIdAsync(i);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),s,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"_removeImageByIdAsync",value:(r=eA(g.mark((function u(e){var t,r;return g.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=this,-1!=e){n.next=4;break}return oE(t),n.abrupt("return",!1);case 4:return n.next=6,t._innerFunV2("RemoveImage",Rx(e));case 6:return((r=n.sent)||-1033==t._errorCode)&&t._OnBitmapChanged(["0",""+e,3,t._imageBufferWrapper.getCurrentImageIndex(),t._imageBufferWrapper.count()]),n.abrupt("return",r);case 9:case"end":return n.stop()}}),u,this)}))),function(e){return r.apply(this,arguments)})}]),a}(eF);!function(e){e.Text=0,e.Blob=1,e.ArrayBuffer=2,e.XML=3,e.JSON=4,e.UserDefined=5}(oG||(oG={})),function(e){e.Other=0,e.HTTPUpload=1,e.HTTPDownload=2,e.FTPUpload=3,e.FTPDownload=4,e.Scan=5,e.LoadImage=6,e.ConvertToBlob=7,e.HTTPPut=8}(aG||(aG={}));var uG={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function cG(e,t){if(Et.isFunction("_".repeat))return e.repeat(t);for(var r=0,n=[];r<t;r++)n.push(e);return n.join("")}var lG,dG=Object.create?Object.create(null):{};function fG(t,r,n,i){return function(t,r){var n,i,o,a,s,u,c,l,d,f=1,h=t.length,g="";for(i=0;i<h;i++)if("string"==typeof t[i])g+=t[i];else if("object"===e(t[i])){if((a=t[i]).keys)for(n=r[f],o=0;o<a.keys.length;o++){if(n==undefined)throw new Error(fG('[sprintf] Cannot access property "%s" of undefined value "%s"',a.keys[o],a.keys[o-1]));n=n[a.keys[o]]}else n=a.param_no?r[a.param_no]:r[f++];if(uG.not_type.test(a.type)&&uG.not_primitive.test(a.type)&&n instanceof Function&&(n=n()),uG.numeric_arg.test(a.type)&&"number"!=typeof n&&isNaN(n))throw new TypeError(fG("[sprintf] expecting number but found %T",n));switch(uG.number.test(a.type)&&(l=n>=0),a.type){case"b":n=parseInt(n,10).toString(2);break;case"c":n=String.fromCharCode(parseInt(n,10));break;case"d":case"i":n=parseInt(n,10);break;case"j":n=Et.stringify(n,null,a.width?parseInt(a.width):0);break;case"e":n=a.precision?parseFloat(n).toExponential(a.precision):parseFloat(n).toExponential();break;case"f":n=a.precision?parseFloat(n).toFixed(a.precision):parseFloat(n);break;case"g":n=a.precision?String(Number(n.toPrecision(a.precision))):parseFloat(n);break;case"o":n=(parseInt(n,10)>>>0).toString(8);break;case"s":n=String(n),n=a.precision?n.substring(0,a.precision):n;break;case"t":n=String(!!n),n=a.precision?n.substring(0,a.precision):n;break;case"T":n=Object.prototype.toString.call(n).slice(8,-1).toLowerCase(),n=a.precision?n.substring(0,a.precision):n;break;case"u":n=parseInt(n,10)>>>0;break;case"v":n=n.valueOf(),n=a.precision?n.substring(0,a.precision):n;break;case"x":n=(parseInt(n,10)>>>0).toString(16);break;case"X":n=(parseInt(n,10)>>>0).toString(16).toUpperCase()}uG.json.test(a.type)?g+=n:(!uG.number.test(a.type)||l&&!a.sign?d="":(d=l?"+":"-",n=n.toString().replace(uG.sign,"")),u=a.pad_char?"0"===a.pad_char?"0":a.pad_char.charAt(1):" ",c=a.width-(d+n).length,s=a.width&&c>0?cG(u,c):"",g+=a.align?d+n+s:"0"===u?d+s+n:s+d+n)}return g}(function(e){if(dG[e])return dG[e];for(var t,r=e,n=[],i=0;r;){if(null!==(t=uG.text.exec(r)))n.push(t[0]);else if(null!==(t=uG.modulo.exec(r)))n.push("%");else{if(null===(t=uG.placeholder.exec(r)))throw new SyntaxError("[sprintf] unexpected placeholder");if(t[2]){i|=1;var o=[],a=t[2],s=[];if(null===(s=uG.key.exec(a)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(o.push(s[1]);""!==(a=a.substring(s[0].length));)if(null!==(s=uG.key_access.exec(a)))o.push(s[1]);else{if(null===(s=uG.index_access.exec(a)))throw new SyntaxError("[sprintf] failed to parse named argument key");o.push(s[1])}t[2]=o}else i|=2;if(3===i)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");n.push({placeholder:t[0],param_no:t[1],keys:t[2],sign:t[3],pad_char:t[4],align:t[5],width:t[6],precision:t[7],type:t[8]})}r=r.substring(t[0].length)}return dG[e]=n,n}(t),arguments)}function hG(e,t){if(Et.isString(e)){var r,n,i,o,a,s=e.indexOf("<%");if(-1==s)return e;if(n=e.substring(0,s),!(s+2<(r=e.indexOf(">",n))))return e;i=e.substring(s+1,r),o=e.substring(r+1);try{a=fG(i,t)}catch(YV){a=""}return[n,a,o].join("")}return""}function gG(e,t){var r,n=e.substring(e.lastIndexOf(".")).toLowerCase();if(t==xt.DWT.EnumDWT_ImageType.IT_BMP){if(".bmp"==n||".dib"==n)return e;r=[e,".bmp"].join("")}else if(t==xt.DWT.EnumDWT_ImageType.IT_JPG){if(".jpg"==n||".jpe"==n||".jpeg"==n||".jfif"==n)return e;r=[e,".jpg"].join("")}else if(t==xt.DWT.EnumDWT_ImageType.IT_PNG){if(".png"==n)return e;r=[e,".png"].join("")}else if(t==xt.DWT.EnumDWT_ImageType.IT_TIF){if(".tif"==n||".tiff"==n)return e;r=[e,".tif"].join("")}else if(t==xt.DWT.EnumDWT_ImageType.IT_PDF){if(".pdf"==n)return e;r=[e,".pdf"].join("")}else if(t==xt.DWT.EnumDWT_ImageType.IT_J2K){if(".jp2"==n)return e;r=[e,".jp2"].join("")}return r}function pG(e,t,r,n){var i,o,a,s,u=t.url,c=t.headers,l=t.retry,d=t.httpFormData,f=t.bOnlyResponseEmptyIsOK,h=t.bAsync,g=(o=t.responseType)==oG.Text?"text":o==oG.JSON?"json":o==oG.Blob?"blob":o==oG.ArrayBuffer?"arraybuffer":o==oG.XML?"xml":5==o?"user-defined":"text",p=e.IfShowProgressBar,m=e.IfShowCancelDialogWhenImageTransfer,_=e.objUploadStatus;(i=t.content)&&(i.remoteFilename||(i.remoteFilename=t.remoteFilename),i.fileName||(i.fileName=t.fileName||i.name),i.name||(i.name=t.fileName||i.fileName));var v,y=new sx({action:u,data:d,async:h,retry:l,bOnlyResponseEmptyIsOK:f,dataType:g});if(m&&bt.progressContext&&(v=bt.progressContext.on("cancel",(function(){y.abort(),y=null}))),(a=y._uploadType)&&(s=a.get("ajaxConfig"),c&&s&&s.headers&&c&&Et.mix(s.headers,c),e.HTTPRequestswithCredentials&&Et.mix(s.xhrFields,{withCredentials:!0}),s=null),y.on(sx.event.SUCCESS,(function(n){if(t.content=null,y=null,v&&bt.progressContext.off("cancel",v),n?e.HTTPPostResponse=n.response:t.responseType==oG.ArrayBuffer?e.HTTPPostResponse=[]:t.responseType==oG.Blob?e.HTTPPostResponse=new Blob([]):t.responseType==oG.JSON?e.HTTPPostResponse={}:e.HTTPPostResponse="",Et.isFunction(e.onHttpUploadStatus)){var i;i={fileName:n.name,percentage:100,statusCode:200,responseString:e.HTTPPostResponse},e.onHttpUploadStatus(i)}Et.isFunction(r)&&r(e.HTTPPostResponse)})),y.on(sx.event.ERROR,(function(r){t.content=null,y=null;var i=r&&r.canceled;r&&r.timeout;var o="",a=0;v&&bt.progressContext.off("cancel",v),r&&Et.isString(r.response)?e.HTTPPostResponse=r.response:e.HTTPPostResponse="",i||(r&&r.msg&&(o=r.msg),r&&r.httpStatus&&(a=r.httpStatus));var s,u={};(Vw(u,i,o,a),Et.isFunction(e.onHttpUploadStatus))&&(s={fileName:r.name,percentage:100,statusCode:a,responseString:e.HTTPPostResponse},e.onHttpUploadStatus(s));Et.isFunction(n)&&n(u._errorCode,u._errorString,e.HTTPPostResponse)})),(p||Et.isFunction(e.onHttpUploadStatus))&&(y.on(sx.event.PROGRESS,(function(t){!K.bSafari&&t&&(delete t.totalSize,delete t.position);var r=0===t.total?100:Math.round(100*t.loaded/t.total);if([t.loaded," / ",t.total].join(""),Et.isFunction(e.onHttpUploadStatus)){var n;n={fileName:t.name,percentage:r,statusCode:0,responseString:""},e.onHttpUploadStatus(n)}e.onPercent([0,r,"","http",t.name])})),e.onPercent([0,-1,fx.Uploading,"http"]),Et.isFunction(e.onHttpUploadStatus))){var I="";Et.isArray(i)&&i.length>0||(i&&i.name&&""!=i.name?I=i.name:i&&i.fileName&&(I=i.fileName)),!I&&t.fileName&&(I=t.fileName),e.onHttpUploadStatus({fileName:I,percentage:0,statusCode:0,responseString:""})}if(_&&_.bCancel){_.st=2;var S={};return kE(S),t.content=null,Et.isFunction(n)&&n(S._errorCode,S._errorString),!1}var T=y.upload(i);return i=null,T}function mG(e,t,r,n){var i,o,a=e.MaxUploadImageSize,s=0,u=t.content;if(!u||!Et.isArray(u)||u.length<=0){t.content=null;var c={};return zw(c),Et.isFunction(n)&&n(c._errorCode,c._errorString),iC}for(i=0;i<u.length;i++){var l=u[i];if(!l||l.size<=0){var d={};return zw(d),Et.isFunction(n)&&n(d._errorCode,d._errorString),iC}var f=l.size,h=l.type;if(s+=f,""===h||h&&h!=t.contentType){var g=l.slice||l.webkitSlice||l.mozSlice,p=l.name,m=g.call(l,0,f,t.contentType);Et.isString(p)&&""!=p||(p=l.fileName),m.name=hG(p,i+1),u[i]=m}u[i].remoteFilename=hG(t.remoteFilename,i+1),l=null}if(s>a&&-1!=a){var _={};return Jw(_),Et.isFunction(n)&&n(_._errorCode,_._errorString),iC}for(bt.cancelFrom=aG.HTTPUpload,o=pG(e,t,r,n),t=null,i=0;i<u.length;i++)u[i]=null;return u=null,o}function _G(e){bt.dlgRef<=0||0==bt.dialogShowStatus||ZE(e)}!function(e){e.Init=-1,e.OK=0,e.Failed=1,e.Cancelled=2}(lG||(lG={})),bt.setBtnCancelVisibleForProgress=ZE;var vG,yG=function(){function e(){t(this,e)}return i(e,[{key:"_onProgress",value:function(e,t,r){var n=0===r.total?100:Math.round(100*r.loaded/r.total);[r.loaded," / ",r.total].join(""),e.onPercent([0,n,"","http",t])}},{key:"_uploadBlobFragment",value:function(e,t,r,n){var i=t.fileName,o=t.blockSize,a=0;t.method;var s,u,c,l=t.offset,d=this,f=function(e,r){t.content=null,Et.isFunction(n)&&n(e,r)};if((s=t.content).size<=0){var h={};return zw(h),f(h._errorCode,h._errorString),iC}if(a=s.size,(u=a-l)>0){var g;if(u>=o&&o>0?(u-=o,c=o):(c=u,u=0),!(g=0==l&&c==a?s:s.slice(l,l+c))){var p={};zw(p),f(p._errorCode,p._errorString)}if(!e.IfShowProgressBar||e.IfShowProgressBar&&bt.dlgRef>0){g.name=i,_G(e.IfShowCancelDialogWhenImageTransfer),t.headers["Content-Range"]=["bytes ",l,"-",l+g.size-1,"/",a].join(""),d._onProgress(e,i,{total:a,loaded:l});var m=Et.clone(t);return m.content=g,m.offset=0,d.httpPostUpload(e,m,(function(n){0==u&&(bt.needShowTwiceShowDialog=!1),d._onProgress(e,i,{total:a,loaded:l+c}),0==u?(t.content=null,Et.isFunction(r)&&AF(r,n)):(t.offset=t.offset+c,setTimeout((function(){d._uploadBlobFragment(e,t,r,f)}),100))}),f),!0}var _={};return kE(_),f(_._errorCode,_._errorString),!1}return bt.needShowTwiceShowDialog=!1,t.content=null,Et.isFunction(r)&&r(""),!0}},{key:"httpPostUploadFragment",value:function(e,t,r,n){var i;if(!(i=t.content)){var o={};return zw(o),Et.isFunction(n)&&n(o._errorCode,o._errorString),iC}if(Et.isString(i)){if(""==i){var a={};return zw(a),Et.isFunction(n)&&n(a._errorCode,a._errorString),iC}var s=new Blob([i],{type:"text/plain"}),u=t.fileName;s.name=u,t.content=s,s=null}return bt.cancelFrom=aG.HTTPUpload,this._uploadBlobFragment(e,t,r,n)}},{key:"httpPostUpload",value:function(e,t,r,n){var i,o,a=function(r,i){var o;(t.content=null,t=null,Et.isFunction(n))&&n(r,i,null!==(o=null==e?void 0:e.HTTPPostResponse)&&void 0!==o?o:"")};if(!(i=t.content)){var s={};return zw(s),a(s._errorCode,s._errorString),iC}if(Et.isString(i)){var u,c=t.fileName;if(""==i){var l={};return zw(l),a(l._errorCode,l._errorString),iC}if(u=e.MaxUploadImageSize,i.length>u&&-1!=u){var d={};return Jw(d),a(d._errorCode,d._errorString),iC}(o=new Blob([i],{type:"text/plain"})).name=c,i=null}else if(i instanceof Blob&&(o=i,i=null,o.size<=0)){var f={};return zw(f),a(f._errorCode,f._errorString),iC}if(o){var h,g,p=e.MaxUploadImageSize,m=o.size,_=o.type;if(m>p&&-1!=p){var v={};return Jw(v),a(v._errorCode,v._errorString),iC}if(""===_||_&&_!=t.contentType)(h=(o.slice||o.webkitSlice||o.mozSlice).call(o,0,m,t.contentType))instanceof File?(g=h.fileName,h.name=g):h.name=o.name||o.fileName;else h=o;o=null,h&&(t.content=h),h=null}return _G(e.IfShowCancelDialogWhenImageTransfer),bt.cancelFrom=aG.HTTPUpload,pG(e,t,(function(e){t.content=null,t=null,Et.isFunction(r)&&r(e),e=null}),a)}}]),e}(),IG=i((function sJ(){t(this,sJ),this.method="",this.httpMethod="POST",this.contentType="application/octet-stream",this.remoteFilename="RemoteFile",this.blockSize=0,this.offset=0,this.retry=0,this.bOnlyResponseEmptyIsOK=!0,this.responseType=oG.Text})),SG=i((function uJ(){t(this,uJ),this.IfShowProgressBar=!1,this.IfShowCancelDialogWhenImageTransfer=!0})),TG=239514e3;function bG(e){return 1*e+TG}function CG(e){return 1*e-TG}!function(e){e.URL=0,e.Blob=1,e.Base64=2}(vG||(vG={}));var wG=window.SparkMD5,EG=function(){function e(r,n,i,o){t(this,e);var a=this;a._md5=i,a._length=n,a._content=o}return i(e,[{key:"getLength",value:function(){return this._length}},{key:"getMD5",value:function(){return this._md5}},{key:"getData",value:function(e,t){var r=this,n=t;return Et.isNumber(e)&&Et.isNumber(t)?e<0||t<=0?"":0==e&&n==r._length?r._content:(e+n>r._length&&(n=r._length-e),r._content.substr(e,n)):""}}]),e}();function AG(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(VV){return!1}}();return function(){var r,n=cA(e);if(t){var i=cA(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return uA(this,r)}}bt.html5.Base64Result=EG;var kG=function(e){sA(T,e);var r,n,o,a,s,u,c,l,d,f,h,p,m,_,v,y,I,S=AG(T);function T(e){var r;return t(this,T),(r=S.call(this,e)).__maxUploadImageSize=-1,r._strHttpContentTypeFieldValue="application/octet-stream",r}return i(T,[{key:"_saveImages",value:(I=eA(g.mark((function b(e,t,r,n){var i,o,a,s,u,c,l;return g.wrap((function(d){for(;;)switch(d.prev=d.next){case 0:return i=this,o=gG(t,n),a=this._imageBufferWrapper.convertIndicesToServerIds(r),bt.cancelFrom=aG.Other,d.next=5,this._innerConvertToArrayBufferWithUIAsync(e,n,a);case 5:if(s=d.sent,u=yF.getBlobTypeByImageType(n),c=new Blob([s],{type:u}),!xt.navInfo.bIE){d.next=14;break}return d.next=12,i._innerSaveLocal(c,o);case 12:d.next=18;break;case 14:return l=URL.createObjectURL(c),d.next=17,i._innerSaveLocal(l,o);case 17:URL.revokeObjectURL(l);case 18:c=null;case 19:case"end":return d.stop()}}),b,this)}))),function(e,t,r,n){return I.apply(this,arguments)})},{key:"_innerSaveLocal",value:(y=eA(g.mark((function C(e,t){return g.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",new bt.Promise((function(r,n){var i=window,o=xt.navInfo,a=i.requestFileSystem||i.webkitRequestFileSystem||i.mozRequestFileSystem;if(!o.biPad&&!o.biPhone||a||!(K.bSafari&&parseFloat(K.strBrowserVersion)<13)&&K.bSafari){var s=document.createElementNS("http://www.w3.org/1999/xhtml","a");if(s.href=e,s.download=t,s.target="_blank",document.body.appendChild(s),o.bEdge)s.click(),e=null,s.href=null;else if(o.bIE){var u;(u=window.navigator)&&"msSaveOrOpenBlob"in u&&u.msSaveOrOpenBlob(e,t)}else{var c=document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!1),s.dispatchEvent(c)}setTimeout((function(){document.body.removeChild(s),s=null,r()}),6e3)}else{var l=i.open(e,"","",!1);setTimeout((function(){l.document.title=t,r()}),6e3)}})));case 2:case"end":return r.stop()}}),C,this)}))),function(e,t){return y.apply(this,arguments)})},{key:"_OnPostTransferAsync",value:function(e,t,r){var n,i=this;if(e&&e.length>=2)try{var o=String(e[1]).replace(/\\/g,"\\\\");n=Et.parse(o),!r&&n.imageId&&(n.imageId=i._convertServerIdToGuid(n.imageId))}catch(s){Et.log(e)}n||(n={imageId:-1});var a=!1;if(Et.isFunction(i.__OnPostTransferAsync))try{a=i.__OnPostTransferAsync(n)}catch(u){vA(u)}if(Et.isFunction(i.__OnPostTransferAsync2))try{i.__OnPostTransferAsync2(n)}catch(u){vA(u)}return a}},{key:"_checkIndices",value:function(e,t){var r,n,i=this;if(!Et.isArray(e))return iE(i),!1;if(0==e.length)return eE(i),!1;if(xt.DWT.ConnectWithSocket)return!0;for(r=!Et.isUndefined(t)&&t>=0?t:this._imageBufferWrapper.count(),n=0;n<e.length;n++){var o=e[n];if(Et.isUndefined(o)||null===o)return aE(i),!1;if(o=parseInt(o),isNaN(o))return Dw(i),!1;if(o<0||o>=r)return rE(i),!1}return!0}},{key:"_acquireImageForSendTo",value:(v=eA(g.mark((function w(e,t,r,n){var i,o,a,s,u,c,l,d;return g.wrap((function(f){for(;;)switch(f.prev=f.next){case 0:if(i=this,o=r?Et.clone(r):{},s=a=n,i._resetErr(),i._isValid()){f.next=4;break}throw{code:i._errorCode,message:i._errorString};case 4:if(Et.isString(a._id)){f.next=6;break}throw{code:-2602,message:'The parameter "SendTo" is invalid.'};case 6:if(!i.__bAcquireImageNow){f.next=9;break}throw Nw(i),{code:i._errorCode,message:i._getErrorString()};case 9:if(i.__bAcquireImageNow=!0,zx(e,s),u=bt.Promise.resolve(),c=xt.DWT.RemoteScanConfig,l=LD(),f.prev=13,lF(o),c&&BD(c.keepAwake),bP.checkProductKey(i,{Core:!0})&&i._isValid()){f.next=18;break}throw{code:i._errorCode,message:i._errorString};case 18:return eF._innerSendHeartBeat(a,!1),d=function(){var e=eA(g.mark((function t(e){return g.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:u=u.then((function(){return new bt.Promise((function(t,r){var n=[i._convertGuidToServerId(e.imageId)],o=xt.DWT.EnumDWT_ImageType.IT_PNG;bt.cancelFrom=aG.Scan,i._innerConvertToArrayBufferAsync(o,n).then((function(n){a._blts_tmp=a._blts,a._blts=!1,a.__LoadImageFromBytesV2(n,o,"",!0,0,0,!1,0,function(){var r=eA(g.mark((function n(r,o){var s;return g.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return s=i._convertGuidToServerId(e.imageId),o?(Et.log("LoadImageFromBinary success"),a._blts=a._blts_tmp,e.imageId=a._convertServerIdToGuid(o.ids),Et.isFunction(a._OnPostTransferAsync)&&a._OnPostTransferAsync([!0,Et.stringify(e)],null,!0)):Et.log("LoadImageFromBinary return null."),t(),r.next=5,i._removeImageByIdAsync(s);case 5:case"end":return r.stop()}}),n)})));return function(e,t){return r.apply(this,arguments)}}(),(function(e,t){Et.log(t),a._blts=a._blts_tmp,r({code:e,message:t})}))}),(function(e){e&&e.message&&Et.log(e.message),r(e)}))}))}));case 1:case"end":return t.stop()}}),t)})));return function(t){return e.apply(this,arguments)}}(),i._registerEvent("OnPostTransferAsync2",d),null!=t&&(o.Device=t.strDevice,o.DeviceMatchField=PD.SMF_NAME),f.next=24,i._acquireImageFromServiceAsync(o);case 24:f.next=29;break;case 26:throw f.prev=26,f.t0=f["catch"](13),f.t0;case 29:return f.prev=29,f.prev=30,f.next=33,u;case 33:f.next=37;break;case 35:f.prev=35,f.t1=f["catch"](30);case 37:return i._unregisterEvent("OnPostTransferAsync2"),i.__bAcquireImageNow=!1,Kx(e),BD(l),f.finish(29);case 42:case"end":return f.stop()}}),w,this,[[13,26,29,42],[30,35]])}))),function(e,t,r,n){return v.apply(this,arguments)})},{key:"_imageIDToIndex",value:function(e){var t,r=this,n=-1;return r._resetErr(),!!r._isValid()&&((t=CG(e))>0&&(n=r._imageBufferWrapper.convertServerIdToClientIndex(t)),-1==n&&kw(r,-1034,"Invalid image ID."),n)}},{key:"_indexToImageID",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return!1;var r=parseInt(e);return isNaN(r)?(Dw(t),-1):r<0||r>=t._imageBufferWrapper.count()?(oE(t),-1):bG(t._imageBufferWrapper.convertClientIndexToServerId(r))}},{key:"__LoadImageFromBytesV2",value:function(e,t,r,n,i,o,a,s,u,c){var l,d=this,f=t||3,h=0,g=e.name,p=!0,m=1;if(e)if(e instanceof Blob)h=e.size;else if(Nx(e))h=e.byteLength;else if(e instanceof Array)h=e.length;else{var _=e;h=_.size||_.byteLength||_.length}!isNaN(i)&&i>=0&&!isNaN(o)&&o>0?m=0:(i=0,o=0),l=["[",h,",",0,",",f,',"',r,'",',i,",",o,",",s,",",m,",",a?"true":"false","]"].join("");var v=function(){if(d.__bLoadingImage=!1,p){var e=d._imageBufferWrapper.getCurrentImageIndex();e>=0&&d._innerRefreshUI(e)}return Et.isFunction(c)&&c(d._errorCode,d._getErrorString(),g),!1};return bP.checkProductKey(d,{Core:!0})||K.bWin&&bP.checkProductKey(d,{Webcam:!0},!0)?bP.checkPDFProductKeyWhenNeeds(d,t)?0===h?(kw(d,-2312,"The file length is empty."),p=!1,v()):this._innerSendBlob("LoadImageFromBytes",l,e,n,m,(function(e){if(d.__bLoadingImage=!1,d._isBindViewer()){var t=d._imageBufferWrapper.getCurrentImageIndex();n&&t>=0&&d._innerRefreshUI(t)}if(Et.isFunction(u)){var r=e;if(Et.isArray(r)&&(r=r.length>0?r[0]:{}),n)setTimeout((function(){u(g,r)}),30);else try{u(g,r)}catch(i){Et.error(i.message)}}return d._blts&&xt.DWT.lcvrf(d),!0}),v):(p=!1,v()):(bP.checkProductKey(d,{Core:!0},!1),p=!1,v())}},{key:"_innerSendBlob",value:function(e,t,r,n,i,o,a){var s=this;if(eF.isServerInvalid(s))return s._waitForConnect().then((function(){s._innerSendBlob(e,t,r,n,i,o,a)}));if(!n){var u,c,l,d,f=[],h="";return s._resetErr(),s._isValid()?(c=[s._httpUrl,"f/",e].join(""),l=iF(s._clientId,e,t,0,s._bScanForProxyRemote),l+="\r\n\r\n",d={method:"POST",url:c,processData:!1,data:l+=Et.base64.encodeArray(r),async:!1,onSuccess:function(e,t,r){var n=!1,o=!1;try{n=Et.isString(e)&&"text/json"===r.getResponseHeader("content-type")?Et.parse(e):e}catch(VV){}if(n!==undefined&&null!==n&&(gA(n)?(s._errorCode=n.exception,s._errorString=n.description):s._resetErr(),(u=n.result)&&Et.isArray(u)&&u.length>=1))if(i){var a=u[0];a&&Et.isObject(a)&&(h=a.ids,Et.isArray(a.metaData)&&(f=a.metaData),o=!0)}else h=u.join(","),f=[],o=!0;o||(Uw(s),u="",f=[])},onError:function(){Bw(s),u="",f=[]}},Et.mix(d,{headers:{"X-Requested-With":!1}}),K.bFileSystem&&(d.crossDomain=!1),RC(d),0==s._errorCode?(h.length>0&&s._OnBitmapChanged(["c2",h,1,s._imageBufferWrapper.getCurrentImageIndex(),s._imageBufferWrapper.count(),f],null,r.currentFileName),Et.isFunction(o)&&o()):Et.isFunction(a)&&a(),u):!1}return s._innerSendBlobByWS(e,t,r,o,a),!0}},{key:"_convertToBase64ByServerIdsWithUI",value:function(e,t,r,n,i,o,a){return this._convertToBase64ByServerIdsWithUIAsync(e,r,t,n).then((function(e){Et.isFunction(o)&&AF(o,e)}),(function(){return Et.isFunction(a)&&a(),!1})),!0}},{key:"_OnPercentDone",value:function(e){var t,r,n,i,o,a=this,s=!1,u=!1,c=0;Et.isArray(e)&&e.length>2&&(r=e[0],c=e[1],n=e[2],e.length>3&&(i=e[3]),e.length>4&&(o=e[4]),e.length>5&&e[5],t=c,c<0?t=0:c>100&&(t=100),t=Math.floor(t),bt.cancelFrom!=aG.HTTPUpload&&bt.cancelFrom!=aG.HTTPDownload&&bt.cancelFrom!=aG.Scan&&bt.cancelFrom!=aG.HTTPPut||(u=o)),(a._bServerPercentDone||0==r)&&((c>0||0==c)&&(bt.cancelFrom!=aG.HTTPUpload&&bt.cancelFrom!=aG.HTTPDownload&&bt.cancelFrom!=aG.FTPUpload&&bt.cancelFrom!=aG.FTPDownload&&bt.cancelFrom!=aG.HTTPPut||(s=!0)),a.IfShowProgressBar&&bt.progressBarOnPercentDone(c,n,i,t,u,this._containerElement),1==s&&(Et.isFunction(a.__OnInternetTransferPercentage)&&a.__OnInternetTransferPercentage(t,!1),Et.isFunction(a.__OnInternetTransferPercentageEx)&&a.__OnInternetTransferPercentageEx(t,!1)),Et.isFunction(a.__OnPercentDone)&&a.__OnPercentDone())}},{key:"IfShowProgressBar",get:function(){return this._bIfShowProgressBar},set:function(e){this._resetErr(),Et.isBoolean(e)?this._bIfShowProgressBar=e:Fw(this)}},{key:"IfShowCancelDialogWhenImageTransfer",get:function(){return this.__IfShowCancelDialogWhenImageTransfer},set:function(e){this._resetErr(),Et.isBoolean(e)?this.__IfShowCancelDialogWhenImageTransfer=e:Fw(this)}},{key:"_getLogLevel",value:function(){return this._logLevel}},{key:"_setLogLevel",value:(_=eA(g.mark((function E(e){return g.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._logLevel=e,t.next=3,this._innerFunV2("LogLevel",Rx(e));case 3:case"end":return t.stop()}}),E,this)}))),function(e){return _.apply(this,arguments)})},{key:"MaxUploadImageSize",get:function(){return this.__maxUploadImageSize},set:function(e){var t=this;t._resetErr();var r=1*e;!Et.isNumber(r)||isNaN(r)?Fw(t):t.__maxUploadImageSize=r}},{key:"HTTPRequestswithCredentials",get:function(){return this._resetErr(),this._bWithCredentials},set:function(e){this._resetErr(),Et.isBoolean(e)?this._bWithCredentials=e:Fw(this)}},{key:"cancelableObj",get:function(){return this._cancelableObj},set:function(e){this._cancelableObj=e}},{key:"_getProfile",value:(m=eA(g.mark((function A(e){var t,r;return g.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((t=this)._resetErr(),t._isValid()){n.next=4;break}throw{code:t._errorCode,message:t._errorString};case 4:return e&&(r=Et.stringify([e.strDevice])),n.abrupt("return",t._innerFunV2("GetCustomDSDataEx",r));case 6:case"end":return n.stop()}}),A,this)}))),function(e){return m.apply(this,arguments)})},{key:"_setProfile",value:(p=eA(g.mark((function k(e,t){var r,n;return g.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if((r=this)._resetErr(),r._isValid()){i.next=4;break}throw{code:r._errorCode,message:r._errorString};case 4:return n=e?Et.stringify([t,e.strDevice]):Rx(t),i.abrupt("return",this._innerFunV2("SetCustomDSDataEx",n));case 6:case"end":return i.stop()}}),k,this)}))),function(e,t){return p.apply(this,arguments)})},{key:"_removeAllImagesAsync",value:(h=eA(g.mark((function P(e,t){var r,n,i,o,a,s;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=this)._resetErr(),r._isValid()){e.next=4;break}throw{code:r._errorCode,message:r._errorString};case 4:for(i=[],a=r._getHowManyImagesInBuffer(),o=a-1;o>=0;o--)(s=r._imageBufferWrapper.convertClientIndexToServerId(o))>-1&&i.push(s);if(0!=i.length){e.next=13;break}return e.next=10,r._innerFunV2("RemoveAllImages");case 10:n=e.sent,e.next=23;break;case 13:if(!t){e.next=19;break}return e.next=16,r._innerFunV2("RemoveAllImages",Rx(i.join(",")));case 16:n=e.sent,e.next=22;break;case 19:return e.next=21,r._innerFunV2("RemoveAllImages");case 21:n=e.sent;case 22:(n||-1033==r._errorCode)&&r._OnBitmapChanged(["0",i.join(","),3,r._imageBufferWrapper.getCurrentImageIndex(),r._imageBufferWrapper.count()]);case 23:return e.abrupt("return",n);case 24:case"end":return e.stop()}}),P,this)}))),function(e,t){return h.apply(this,arguments)})},{key:"__OnRecieveMsg",value:function(e,t){var r=this,n=null==t?void 0:t.cmd;if(e.event)return xF(cA(T.prototype),"__OnRecieveMsg",this).call(this,e,t);if(xt.DWT.ConnectWithSocket)return xF(cA(T.prototype),"__OnRecieveMsg",this).call(this,e,t);if(gA(e)?(r._errorCode=e.exception,r._errorString=e.description):"StartScan"!=n&&"GetAddOnVersion"!=n&&(r._errorCode=0,r._errorString=""),"ReadBarcode"==n||"OCRRecognize"==n||e.request&&"OCRProRecognize"==e.request.method)return t.sFun?(t.sFun(e),!0):(t.fFun&&t.fFun(e),!0);if("GetLicenseInfo"==n&&Et.isArray(e.Detail))return t.sFun?(t.sFun(e),!0):(t.fFun&&t.fFun(e),!0);if("SetCapabilities"==n||"GetSkewAngleFromBinary"==n||"UpdateImage"==n)return"exception"in e&&"0"!=e.exception?(e.result.errorCode&&e.result.errorString?(r._errorCode=e.result.errorCode,r._errorString=e.result.errorString):(r._errorCode=e.exception,r._errorString=e.description),t.fFun&&t.fFun(e.result),e=null,!0):(t.sFun&&t.sFun(e.result),e=null,!0);if(e.result&&e.result.length&&("1"==e.result[0]||1==e.result[0]||"ok"==e.result[0]))return(t.sFun||t.sFun)&&t.sFun(e.result),!0;if(e.exception){var i=!1;t.fFun&&(i=t.fFun(r._errorString)),!i&&e.exception&&e.exception<0&&-2115!=e.exception&&Et.isFunction(r.__OnPrintMsg)&&r.__OnPrintMsg(r._errorString)}else{if("LoadImage"==n||"LoadImageEx"==n||"LoadImageFromBytes"==n||"LoadImageFromBase64Binary"==n||"LoadDibFromClipboard"==n||"FTPDownload"==n||"FTPDownloadEx"==n)return t.sFun&&t.sFun(e.result),e=null,!0;t.fFun&&t.fFun(Wx(["result:"],e.result))}return!0}},{key:"_convertServerIdToGuid",value:function(e){return bG(e)}},{key:"_convertGuidToServerId",value:function(e){return CG(e)}},{key:"_innerConvertToBlobWithUI",value:function(e,t,r,n,i,o){var a=this,s=arguments,u=function(e){if(bt.needShowTwiceShowDialog=!1,Et.isFunction(o)){var t=[];Et.isArray(r)&&Et.each(r,(function(e){var r=a._imageBufferWrapper.convertServerIdToClientIndex(e);r>-1&&t.push(r)})),e&&(a._errorCode=e.code,a._errorString=e.message),o(t)}return!1};return a._innerConvertToArrayBufferWithUIAsync(e,t,r,n).then((function(e){if(!e||e.byteLength<=0)return hE(a),u();var n=a.__maxUploadImageSize;if(e.byteLength>n&&-1!=n)return Jw(a),u();if(bt.needShowTwiceShowDialog=!1,Et.isFunction(i)){var o=[];Et.isArray(r)&&Et.each(r,(function(e){var t=a._imageBufferWrapper.convertServerIdToClientIndex(e);t>-1&&o.push(t)}));var c=yF.getBlobTypeByImageType(t),l=new Blob([e],{type:c});try{i(l,o,s)}catch(d){}l=null}return!0}),u),!0}},{key:"convertToBlob",value:(f=eA(g.mark((function x(e,t,r){var n,i,o,a;return g.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return n=this,i=this._imageBufferWrapper.convertIndicesToServerIds(t),bt.cancelFrom=aG.ConvertToBlob,s.next=4,n._innerConvertToArrayBufferWithUIAsync("convertToBlob",e,i,r);case 4:return o=s.sent,a=yF.getBlobTypeByImageType(e),s.abrupt("return",new Blob([o],{type:a}));case 7:case"end":return s.stop()}}),x,this)}))),function(e,t,r){return f.apply(this,arguments)})},{key:"_innerConvertToArrayBufferWithUIAsync",value:(d=eA(g.mark((function D(e,t,r,n,i){var o,a,s,u;return g.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return a=this,u=null===(o=bt.progressContext)||void 0===o?void 0:o.IfShowCancelDialogWhenImageTransfer,c.prev=2,a.IfShowProgressBar?bt.showProgress(a,e,!1):bt.hideProgress(),a._OnPercentDone([0,-1,fx.Encoding]),bt.progressContext&&(bt.progressContext.IfShowCancelDialogWhenImageTransfer=!1),c.next=8,this._innerConvertToArrayBufferAsync(t,r,n,i);case 8:s=c.sent;case 9:return c.prev=9,bt.progressContext&&(bt.progressContext.IfShowCancelDialogWhenImageTransfer=u),a.IfShowProgressBar&&bt.closeProgress(null,e),c.finish(9);case 13:return c.abrupt("return",s);case 14:case"end":return c.stop()}}),D,this,[[2,,9,13]])}))),function(e,t,r,n,i){return d.apply(this,arguments)})},{key:"_innerConvertToBase64Async",value:(l=eA(g.mark((function F(e,t,r){var n,i,o,a,s,u,c,l,d;return g.wrap((function(f){for(;;)switch(f.prev=f.next){case 0:return n=this,i=r,Et.isString(i)&&""!=i||(i="{}"),o=["[",e,',"',t.join(","),'",',i,",1]"].join(""),f.next=5,n._sendDataByHttpAsync("ConvertToBase64",o,"text",!0);case 5:if(a=f.sent,s=0,u="",c="",l=a&&a.result,0==n._errorCode){f.next=9;break}throw{code:n._errorCode,message:n._errorString};case 9:if(!l||!Et.isArray(l)||3!=l.length){f.next=17;break}return c=l[0],s=l[1],u=l[2],d=new EG(null,s,u,c),f.abrupt("return",d);case 17:throw kw(n,-2366,"Converting images to a base64 string failed."),{code:n._errorCode,message:n._errorString};case 19:case"end":return f.stop()}}),F,this)}))),function(e,t,r){return l.apply(this,arguments)})},{key:"_convertToBase64ByServerIdsWithUIAsync",value:(c=eA(g.mark((function W(e,t,r,n){var i,o,a;return g.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return o=this,a=null===(i=bt.progressContext)||void 0===i?void 0:i.IfShowCancelDialogWhenImageTransfer,s.prev=2,o.IfShowProgressBar?bt.showProgress(o,e,!1):bt.hideProgress(),o._OnPercentDone([0,-1,fx.Encoding]),bt.progressContext&&(bt.progressContext.IfShowCancelDialogWhenImageTransfer=o.IfShowCancelDialogWhenImageTransfer),s.next=8,this._innerConvertToBase64Async(t,r,n);case 8:return s.abrupt("return",s.sent);case 9:return s.prev=9,bt.progressContext&&(bt.progressContext.IfShowCancelDialogWhenImageTransfer=a),o.IfShowProgressBar&&bt.closeProgress(null,e),s.finish(9);case 13:case"end":return s.stop()}}),W,this,[[2,,9,13]])}))),function(e,t,r,n){return c.apply(this,arguments)})},{key:"_convertToBlobForUpload",value:function(e,t,r,n,i,o,a){var s=this,u=arguments;if(xt.DWT.ConnectWithSocket){var c=r,l=",";Et.isString(c)&&""!=c||(c="",l="");var d=["[",e,',"',t.join(","),'"',l,c,"]"].join("");return bt.cancelFrom=aG.ConvertToBlob,bt.progressContext&&(bt.progressContext.IfShowCancelDialogWhenImageTransfer=!1),s._sendData("ConvertToBlob",d,!0,(function(e){s._resetErr();var t=e;if(t){if(t instanceof Blob||Nx(t))return void i(t,"",u);gA(t)&&(s._errorCode=t.exception,s._errorString=t.description)}}),(function(e){s._errorCode=e.code,s._errorString=e.message,o(e)})),!0}return s._innerConvertToArrayBufferAsync(e,t,r,"arraybuffer").then((function(e){var t=s._strHttpContentTypeFieldValue,r=new Blob([e],{type:t});if(xt.DWT.IfAddMD5InUploadHeader){var n=new wG.ArrayBuffer;n.append(e),Et.isFunction(i)&&i(r,n.end(),u)}else Et.isFunction(i)&&i(r,"",u);r=null}),(function(e){o(e.code,e.message)}))}},{key:"dispose",value:function(){return this.__unload()}},{key:"_innerDisposeWSClient",value:function(){return this._isValid()?this._sendData("dispose",null,!0,(function(){}),(function(){})):bt.Promise.reject()}},{key:"__unload",value:(u=eA(g.mark((function R(){var e;return g.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e=this)._bReady||bt.page.bUnload){t.next=10;break}if(!e._wsClient){t.next=10;break}return t.prev=3,t.next=6,e._innerDisposeWSClient();case 6:t.next=10;break;case 8:t.prev=8,t.t0=t["catch"](3);case 10:e._wsClient&&(e._wsClient.removeEvent("close",e._clientId),e._wsClient.removeEvent("error",e._clientId),e._wsClient.removeEvent("timeout",e._clientId),e._wsClient.dispose(),delete e._wsClient,e._wsClient=null),this._imageBufferWrapper.dispose(),this._bReady=iC,this._destroy=oC;case 14:case"end":return t.stop()}}),R,this,[[3,8]])}))),function(){return u.apply(this,arguments)})},{key:"_getImages",value:(s=eA(g.mark((function N(e,t,r,n){var i,o,a;return g.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(Et.isArray(t)){s.next=3;break}throw iE(this),{code:this._errorCode,message:this._errorString};case 3:if(0!=t.length){s.next=6;break}throw eE(this),{code:this._errorCode,message:this._errorString};case 6:if(n!=vG.URL){s.next=12;break}if(!(t.length>1)){s.next=10;break}throw kw(this,-2619,"Only single index selection is allowed when enumImageFormatType is set to url."),{code:this._errorCode,message:this._errorString};case 10:s.next=16;break;case 12:if(r!=xt.DWT.EnumDWT_ImageType.IT_BMP&&r!=xt.DWT.EnumDWT_ImageType.IT_JPG&&r!=xt.DWT.EnumDWT_ImageType.IT_PNG){s.next=16;break}if(!(t.length>1)){s.next=16;break}throw xE(this),{code:this._errorCode,message:this._errorString};case 16:if(n!=vG.URL){s.next=20;break}return s.abrupt("return",this._imageBufferWrapper.getImageUrl(t[0]));case 20:if(bt.cancelFrom=aG.Other,i=this._imageBufferWrapper.convertIndicesToServerIds(t),n!=vG.Blob){s.next=30;break}return s.next=25,this._innerConvertToArrayBufferWithUIAsync(e,r,i);case 25:return o=s.sent,a=yF.getBlobTypeByImageType(r),s.abrupt("return",new Blob([o],{type:a}));case 30:if(n!=vG.Base64){s.next=34;break}return s.next=33,this._convertToBase64ByServerIdsWithUIAsync(e,r,i);case 33:return s.abrupt("return",s.sent);case 34:throw PE(this),{code:this._errorCode,message:this._errorString};case 36:case"end":return s.stop()}}),N,this)}))),function(e,t,r,n){return s.apply(this,arguments)})},{key:"_LicensePromptExpired",value:function(){var e=this,t=e.__licenseInfo.bTrial,r="";e.__licenseInfo&&e.__licenseInfo.ExpireDate&&(r=e.__licenseInfo.ExpireDate);var n=PG(r);n<=0&&Et.isFunction(xt.OnLicenseExpiredWarning)&&xt.OnLicenseExpiredWarning(r,n,t)}},{key:"__saveToViewerAfterUpdate",value:function(e,t){var r=this,n=this,i=this._imageBufferWrapper.getIndexByUid(e),o=this._imageBufferWrapper.convertClientIndexToServerId(i),a=kx.getUrlByAct(this._imageBufferWrapper.BaseUrl,o,2);return new bt.Promise((function(e,s){RC({method:"GET",xhrFields:{withCredentials:!0},url:a,onSuccess:function(a){var s,u=n._imageBufferWrapper.getMetadataByIndex(i);u||(u={}),u.width=t.width,u.height=t.height,s=xt.navInfoSync.bMobile?r._imageBufferWrapper.getMinImageUrl(i,Math.round(u.controlWidth*devicePixelRatio),Math.round(u.controlHeight*devicePixelRatio)):r._imageBufferWrapper.getMinImageUrl(i,u.controlWidth,u.controlHeight);var c=n._imageBufferWrapper.getImageIdMap(o);c.ticks=Date.now(),c.imageUrl=r._imageBufferWrapper.getImageUrl(i),c.minImageUrl=s,c.width=t.width,c.height=t.height,n._imageBufferWrapper.UpdateImage(c,u),e()},onError:function(){e(),Kx("save")}})}))}},{key:"RunCommandAsync",value:(a=eA(g.mark((function O(e){var t,r,n,i,o;return g.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(t=this,e&&Et.isString(e.command)&&e.parameter){a.next=4;break}throw gE(t),{code:t._errorCode,message:t._errorString};case 4:if("Invert"!=e.command){a.next=6;break}return a.abrupt("return",t._invert(e.parameter.index));case 6:if(r=e.parameter.index,!Et.isNumber(r)){a.next=13;break}if(!(isNaN(r)||!Et.isNumber(r)||r<0||r>=t._imageBufferWrapper.count())){a.next=11;break}throw oE(t),{code:t._errorCode,message:t._errorString};case 11:a.next=15;break;case 13:throw Dw(t),{code:t._errorCode,message:t._errorString};case 15:return n=t._imageBufferWrapper.convertClientIndexToServerId(r),e.parameter.index=n,i=["[",Et.stringify(e),"]"].join(""),a.next=20,t._innerFunRawV3("runCommand",i);case 20:if(o=a.sent,!K.bIE){a.next=25;break}if(!Et.isString(o)){a.next=24;break}return a.abrupt("return",Et.parse(o));case 24:return a.abrupt("return",o);case 25:return a.next=27,o.json();case 27:return a.abrupt("return",a.sent);case 28:case"end":return a.stop()}}),O,this)}))),function(e){return a.apply(this,arguments)})},{key:"_innerFunRawV3",value:(o=eA(g.mark((function M(e,t){var r,n,i;return g.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(i="fa/",(r=this)._resetErr(),r._isValid()){o.next=4;break}throw{code:r._errorCode,message:r._errorString};case 4:if(!eF.isServerInvalid(r)){o.next=7;break}return o.abrupt("return",r._waitForConnect().then((function(){return r._innerFunRawV3(e,t)})));case 7:return n={method:"post",body:iF(r._clientId,e,t,0,r._bScanForProxyRemote),fetchRaw:!0},o.next=10,XE([r._httpUrl,i,e].join(""),n);case 10:return o.abrupt("return",o.sent);case 11:case"end":return o.stop()}}),M,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"_invert",value:(n=eA(g.mark((function L(e){var t,r,n,i,o;return g.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(t=this,r=parseInt(e),t._resetErr(),t._isValid()){a.next=4;break}throw{code:t._errorCode,message:t._errorString};case 4:if(!isNaN(r)){a.next=7;break}throw Dw(t),{code:t._errorCode,message:t._errorString};case 7:if(!(r<0||r>=t._imageBufferWrapper.count())){a.next=10;break}throw oE(t),{code:t._errorCode,message:t._errorString};case 10:if(-1!=(n=t._imageBufferWrapper.convertClientIndexToServerId(r))){a.next=14;break}throw oE(t),{code:t._errorCode,message:t._errorString};case 14:return a.next=16,t._innerFunV2("Invert",Rx(n),!0);case 16:if(i=a.sent,!(o=1==i)){a.next=22;break}yF.refreshImageAfterInvokeFun(t,r),a.next=23;break;case 22:throw{code:t._errorCode,message:t._errorString};case 23:return a.abrupt("return",o);case 24:case"end":return a.stop()}}),L,this)}))),function(e){return n.apply(this,arguments)})}],[{key:"create",value:(r=eA(g.mark((function B(e){var t;return g.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=new T(e),r.next=3,eF.STwainConnectToServer(t);case 3:return r.abrupt("return",t);case 4:case"end":return r.stop()}}),B)}))),function(e){return r.apply(this,arguments)})}]),T}(sG);function PG(e){if(""==e)return 65536;var t=kP(e),r=(new Date).getTime(),n=(t.getTime()-r)/864e5;return t.getTime()<r?0:Math.ceil(n)}function xG(e){var t=e,r="",n=!1;if(t.__licenseInfo&&(t.__licenseInfo.ExpireDate&&(r=t.__licenseInfo.ExpireDate),n=t.__licenseInfo.bTrial),n&&!xt.DWT.HideTrialMessage){var i=PG(r);i<=5&&(Et.isFunction(xt.OnLicenseExpiredWarning)&&xt.OnLicenseExpiredWarning(r,i,!0),xt.DWT.HideTrialMessage=!0)}}var DG={changeImageUISize:function(e,t,r){var n,i,o,a,s=t,u=r,c=iC;n=tC.one(e._containerElement),Et.isString(t)&&t.indexOf("%")>=0?(0==(o=tC.css(n,"width"))&&(n[0].style.width="100%"),o=tC.css(n,"width")*parseInt(t)/100,c=oC):s=[(o=parseInt(t))+2,"px"].join(""),Et.isString(r)&&r.indexOf("%")>=0?(0==(a=tC.css(n,"height"))&&(n[0].style.height="100%"),a=tC.css(n,"height")*parseInt(r)/100,c=oC):u=[(a=parseInt(r))+2,"px"].join(""),n&&(i=tC.one(".dynamsoft-dwt-container-box",n))&&i.getEL()&&(i.style("width",s),i.style("height",u)),c?(e.__funResize||(e.__funResize=function(){if(e._ImgManager&&e._containerElement){var t=DG.__innerGetUIViewRealSize(e._containerElement,e._width,e._height);return e._UIView.ChangeSize(t.width,t.height)}return oC}),Et.removeEventListener(window,"resize",e.__funResize),Et.addEventListener(window,"resize",e.__funResize)):e.__funResize&&(Et.removeEventListener(window,"resize",e.__funResize),e.__funResize=iC);var l=DG.__innerGetUIViewRealSize(e._containerElement,o,a);return e._ImgManager?e._UIView.ChangeSize(l.width,l.height):oC},__innerGetUIViewRealSize:function(e,t,r){var n,i=-1,o=-1;return n=tC.one(e),Et.isString(t)&&t.indexOf("%")>=0&&(i=tC.css(n,"width")*parseInt(t)/100),i<0&&t&&(i=parseInt(t)),Et.isString(r)&&r.indexOf("%")>=0&&(o=tC.css(n,"height")*parseInt(r)/100),o<0&&r&&(o=parseInt(r)),{width:i,height:o}},bindUIViewEvents:function(e,t){var r=e;t.onSelected=function(e){if(!r._isNoViewer()){var t,n=e.length;n>0&&(r._ImgManager.SetSelectedImageCount(n),t=e[n-1],!0,Et.isFunction(r.__OnRefreshUI)&&r.__OnRefreshUI(t))}},t.onRefreshUI=function(e){r._isNoViewer()||DG.__innerRefreshFromUIView(r,e)},t.onResetCurrentIndex=function(e){if(!r._isNoViewer()){var t=r._ImgManager.getCurrentImageIndex();if(e>=0&&e<r._ImgManager.count()&&t!=e&&Et.isFunction(r.__OnIndexChangeDuringDragDrop))try{r.__OnIndexChangeDuringDragDrop(t,e)}catch(n){vA(n)}}},t.onMouseMove=function(e){if(!r._isNoViewer()){var t=e.index;if(e){var n=e.x,i=e.y;r.__MouseX=n,r.__MouseY=i}if(Et.isFunction(r.__OnMouseMove))try{r.__OnMouseMove(t)}catch(o){vA(o)}}},t.onMouseClick=function(e){if(!r._isNoViewer()){var t=e.index;if(e){var n=e.x,i=e.y;r.__MouseX=n,r.__MouseY=i}if(Et.isFunction(r.__OnMouseClick))try{r.__OnMouseClick(t)}catch(o){vA(o)}}},t.onMouseDoubleClick=function(e){if(!r._isNoViewer()){var t=e.index;if(Et.isFunction(r.__OnMouseDoubleClick))try{r.__OnMouseDoubleClick(t)}catch(n){vA(n)}}},t.onMouseRightClick=function(e){if(!r._isNoViewer()){var t=e.index;if(e){var n=e.x,i=e.y;r.__MouseX=n,r.__MouseY=i}if(Et.isFunction(r.__OnMouseRightClick))try{return r.__OnMouseRightClick(t)}catch(o){vA(o)}return oC}},t.onImageAreaSelected=function(e){if(!r._isNoViewer()&&Et.isFunction(r.__OnImageAreaSelected))try{r.__OnImageAreaSelected(e.index,e.left,e.top,e.right,e.bottom,e.areaIndex)}catch(t){vA(t)}},t.onImageAreaDeSelected=function(e){if(!r._isNoViewer()&&Et.isFunction(r.__OnImageAreaDeSelected))try{r.__OnImageAreaDeSelected(e)}catch(t){vA(t)}},t.onBufferChanged=function(e){if(Et.isFunction(r.__OnBufferChanged))try{r.__OnBufferChanged(e)}catch(t){vA(t)}}},__innerRefreshFromUIView:function(e,t){var r=e;Et.isFunction(r.__OnRefreshUI)&&r.__OnRefreshUI(t)}};function FG(e,t,r){t in e||Object.defineProperty(e,t,r)}var WG=function(){function e(r){t(this,e);var n=this;n._parent=r,FG(n,"width",{get:function(){return this._parent._width},set:function(e){this.SetSize(e,!1)}}),FG(n,"height",{get:function(){return this._parent._height},set:function(e){this.SetSize(!1,e)}})}return i(e,[{key:"SetSize",value:function(e,t){var r,n=this._parent,i=!1,o=!1;return!!n._isBindViewer()&&(Et.isString(e)&&e.length>0&&"%"===e.charAt(e.length-1)&&(i=e),!i&&e&&(r=parseInt(e))&&(i=r+"px"),Et.isString(t)&&t.length>0&&"%"===t.charAt(t.length-1)&&(o=t),!o&&t&&(r=parseInt(t))&&(o=r+"px"),i&&(n._width=i),o&&(n._height=o),DG.changeImageUISize(n,i,o))}}]),e}();function RG(e){var t,r,n,i,o=e._config;bt.dlgProgress||bt.initProgress(e),o.bNoViewer?e._containerElement=null:(o.container?e._containerElement=o.container:o.containerId&&(e._containerElement=Et.get(o.containerId)),e._width=o.width,e._height=o.height,t=tC.one(e._containerElement)),function(e,t){var r={Stwain:e},n=iC;if(t){var i,o=e._width,a=e._height;i=tC.one(e._containerElement),Et.isString(o)&&o.indexOf("%")>=0?(o=tC.css(i,"width")*parseInt(o)/100,n=oC):o=parseInt(o),Et.isString(a)&&a.indexOf("%")>=0?(a=tC.css(i,"height")*parseInt(a)/100,n=oC):a=parseInt(a),r={Stwain:e,Container:t,Width:o,Height:a}}DG.bindUIViewEvents(e,r),e._UIView?e._UIView._Init(r):e._UIView=new bt.UI.ImageUIView(e,r),e.Width<=0&&(e.Width=270),e.Height<=0&&(e.Height=350),n&&DG.changeImageUISize(e,e._width,e._height)}(e,t),e._isBindViewer()&&(r=e,n=e._config,i=n||{},r.__OnImageAreaDeSelected=i.onImageAreaDeSelected||"",r.__OnImageAreaSelected=i.onImageAreaSelected||"",r.__OnMouseClick=i.onMouseClick||"",r.__OnMouseDoubleClick=i.onMouseDoubleClick||"",r.__OnMouseMove=i.onMouseMove||"",r.__OnMouseRightClick=i.onMouseRightClick||"",r.__OnTopImageInTheViewChanged=i.onTopImageInTheViewChanged||"",r.__OnBufferChanged=i.onBufferChanged||"",e.__OnMouseClick=o.onMouseClick||"",e.__OnThumbnailMouseClick="",e.__OnKeyDown=o.onKeyDown||"",e.__OnMouseWheel=o.onMouseWheel||"",e.__OnMouseDoubleClick=o.onMouseDoubleClick||"",e.__OnMouseRightClick=o.onMouseRightClick||"",e.__OnMouseMove=o.onMouseMove||"",e.__OnImageAreaSelected=o.onImageAreaSelected||"",e.__OnImageAreaDeSelected=o.onImageAreaDeSelected||"",e.__OnRefreshUI=o.onRefreshUI||"",e.__OnBufferChanged=o.onBufferChanged||"",e.__MouseX=0,e.__MouseY=0,e.__style=new WG(e),e.__fSelectionRectAspectRatio=0)}function NG(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(VV){return!1}}();return function(){var r,n=cA(e);if(t){var i=cA(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return uA(this,r)}}function OG(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function MG(e,t,r){if(!t.has(e));return r}var LG=new WeakSet,BG=new WeakSet,UG=new WeakSet,VG=function(e){sA(f,e);var r,n,o,a,s,u,c,l,d=NG(f);function f(e){var r;return t(this,f),OG(oA(r=d.call(this,e)),UG),OG(oA(r),BG),OG(oA(r),LG),r}return i(f,[{key:"_getWSContextData",value:function(){return this._getCurrentDocumentName()}},{key:"_getErrorString",value:function(){var e=this;return-2207==e._errorCode&&e._bMustUpgradeService&&Ow(e),0!=e._errorCode?e._errorString:"Successful."}},{key:"_getWebTwainId",value:function(){return this._id}},{key:"_isTwainServiceType",value:function(){return!0}},{key:"_isPC",value:function(){return K.bWin||K.bMac||K.bLinux}},{key:"_serviceSyncMethodNotSupport",value:function(e){var t=this;return kw(t,-2605,'The synchronized method "'+e+'" is not supported under the current settings.'),{code:t._errorCode,message:t._getErrorString()}}},{key:"_serviceAsyncMethodNotSupport",value:function(e){var t=this;return kw(t,-2606,'The asynchronized method "'+e+'" is not supported under the current settings.'),{code:t._errorCode,message:t._getErrorString()}}},{key:"_serviceNotSupportAsync",value:function(e){var t=this;return kw(t,-2397,e+" doesn't work under current settings."),tC.Promise.reject({code:t._errorCode,message:t._getErrorString()})}},{key:"_nouiNotSupport",value:function(e,t){var r=this;return kw(r,-2210,"You cannot call this method on this WebTwain instance because it does not use the default viewer."),Et.isFunction(t)&&t(r._errorCode,r._getErrorString()),!1}},{key:"_innerFunRaw",value:function(e,t,r,n,i,o,a){var s,u,c,l,d=this,f="f/",h=!1;if(xt.DWT.ConnectWithSocket)return this._sendData(e,t,!1,o,a),!0;if(d._resetErr(),!d._isValid())return!1;var g=eF.isServerInvalid(d);if(r&&g)return d._waitForConnect().then((function(){return d._innerFunRaw(e,t,r,n,i,o,a)}));if(!r&&g)return CE(d),!1;if(r&&(h=!0,f="fa/"),c={method:"POST",url:s=[d._httpUrl,f,e].join(""),data:u=iF(d._clientId,e,t,0,d._bScanForProxyRemote),async:h,onSuccess:function(e,t,r){var n=!1;try{n=Et.isString(e)&&"text/json"===r.getResponseHeader("content-type")?Et.parse(e):e}catch(VV){}n?(gA(n)?(d._errorCode=n.exception,d._errorString=n.description):d._resetErr(),l=i?n:n.result):(Uw(d),l=""),Et.isFunction(o)&&o(l),h&&(l=null)},onError:function(){Bw(d),l="",!bt.page.bUnload&&Et.isFunction(a)&&a()}},!h&&n)K.bIE?(c.dataType="arraybuffer",c.onSuccess=function(e,t,r){var n,i,a,s=!1;r.responseHeadersString&&(-1!=r.responseHeadersString.indexOf("text/json")&&(s=!0));if(n=r.responseData,d._resetErr(),l=!1,n&&(i=new Uint8Array(n),s?n=String.fromCharCode.apply(null,i):(l=new Blob([i],{type:d._strHttpContentTypeFieldValue}),(a=new wG.ArrayBuffer).append(i),l.md5=a.end())),!n||s){var u,c=!1;if((u=s?n:r.responseText).length>0){if("{"==u.charAt(0))try{c=Et.parse(u),s=!0}catch(f){Et.log(u)}s?gA(c)?(d._errorCode=c.exception,d._errorString=c.description,l=!1):l=!0:(i=new Uint8Array(u),l=new Blob([i],{type:d._strHttpContentTypeFieldValue}),(a=new wG.ArrayBuffer).append(i),l.md5=a.end())}}Et.isFunction(o)&&o(l)}):(h||(c.dataType="text",c.contentType="text/plain; charset=x-user-defined",c.mimeType="text/plain; charset=x-user-defined"),c.onSuccess=function(e,t,r){var n,i,a;if(d._resetErr(),(i=(n=r.responseText).length)>0){var s,u=!1;if("{"==n.charAt(0))try{s=Et.parse(n),u=!0}catch(h){Et.log(n)}if(u)gA(s)?(d._errorCode=s.exception,d._errorString=s.description,l=!1):l=!0;else{a=new Uint8Array(i);for(var c=0;c<i;c++)a[c]=n.charCodeAt(c);l=new Blob([a],{type:d._strHttpContentTypeFieldValue});var f=new wG.ArrayBuffer;f.append(a),l.md5=f.end()}}else l="";Et.isFunction(o)&&o(l)});else if(h&&n){c={method:"POST",body:u},K.bIE?c.dataType="arraybuffer":c.fetchRaw=!0;var p=XE(s,c);return K.bIE||(p=p.then((function(e){var t=e.headers.get("content-type");return t.indexOf("image/")>=0||t.indexOf("application/octet-stream")>=0?e.arrayBuffer():e.json()}))),p=p.then((function(e){if(d._resetErr(),Nx(e))return Et.isFunction(o)&&o(e),void(e=null);if(Et.isObject(e)){var t=e;if(gA(t))d._errorCode=t.exception,d._errorString=t.description,Et.isFunction(a)&&a();else{var r="";t.result&&(r=t.result),Et.isFunction(o)&&o(r)}}else Bw(d),!bt.page.bUnload&&Et.isFunction(a)&&a()}),(function(e){Bw(d),!bt.page.bUnload&&Et.isFunction(a)&&a()})),!0}return h||Et.mix(c,{headers:{"X-Requested-With":!1}}),K.bFileSystem&&(c.crossDomain=!1),RC(c),!!h||l}},{key:"_innerSendCmd",value:function(e,t){this._innerFunRaw(e,t,!0,!1,!0)}},{key:"_innerFun",value:function(e,t){var r;return r=this._innerFunRaw(e,t,!1,!1,!1),Et.isArray(r)?r[0]:r}},{key:"__OnRecieveMsg",value:function(e,t){var r=this,n=null==t?void 0:t.cmd;if(e.event)return xF(cA(f.prototype),"__OnRecieveMsg",this).call(this,e,t);if(xt.DWT.ConnectWithSocket)return xF(cA(f.prototype),"__OnRecieveMsg",this).call(this,e,t);if(gA(e)?(r._errorCode=e.exception,r._errorString=e.description):"StartScan"!=n&&"GetAddOnVersion"!=n&&(r._errorCode=0,r._errorString=""),"ReadBarcode"==n||"OCRRecognize"==n||e.request&&"OCRProRecognize"==e.request.method)return t.sFun?t.sFun(e):t.fFun&&t.fFun(e),!0;if("ActiveUI"==n||"VersionInfo"==n||"ConvertToBase64"==n||"SaveSelectedImagesToBase64Binary"==n||"ConvertToBlob"==n)return t.sFun&&Et.isArray(e.result)&&e.result.length>0?t.sFun(e.result):t.fFun&&t.fFun(e.result),!0;if("ShowFileDialog"==n||"SplitTiff"==n||"SplitPDF"==n||"EncodeAsBase64"==n||"ProductKey"==n||"GetSourceNames"==n||"GetSkewAngle"==n||"GetImageInfo"==n||"GetSkewAngleFromBinary"==n)return t.sFun?t.sFun(e.result):t.fFun&&t.fFun(e.result),!0;if("GetLicenseInfo"==n&&Et.isArray(e.Detail))return xF(cA(f.prototype),"__OnRecieveMsg",this).call(this,e,t);if("SetCapabilities"==n)return xF(cA(f.prototype),"__OnRecieveMsg",this).call(this,e,t);if(e.result&&e.result.length&&("1"==e.result[0]||1==e.result[0]||"ok"==e.result[0]))(t.sFun||t.sFun)&&t.sFun(t.rawData?e:e.result);else if(e.exception){var i=!1;t.fFun&&(i=t.fFun(r._errorString)),!i&&e.exception&&e.exception<0&&-2115!=e.exception&&Et.isFunction(r.__OnPrintMsg)&&r.__OnPrintMsg(r._errorString)}else{if("LoadImage"==n||"LoadImageEx"==n||"LoadImageFromBytes"==n||"LoadImageFromBase64Binary"==n||"LoadDibFromClipboard"==n||"FTPDownload"==n||"FTPDownloadEx"==n)return t.sFun&&t.sFun(e.result),e=null,!0;t.fFun&&t.fFun(Wx(["result:"],e.result))}return!0}},{key:"OnRefreshUI",value:function(e,t,r,n){return this._innerRefreshUI(e,t,r,n)}},{key:"GetCurrentDocumentName",value:function(){return this._resetErr(),!!this._isValid()&&this._getCurrentDocumentName()}},{key:"RegisterEvent",value:function(e,t){return!!this.registerEvent(e,t)}},{key:"UnregisterEvent",value:function(e,t){return this.unregisterEvent(e,t)}},{key:"onEvent",value:function(e,t){this.registerEvent(e,t)}},{key:"on",value:function(e,t){this.registerEvent(e,t)}},{key:"_OnConsumed",value:function(e){}},{key:"_OnPostLoad",value:function(e,t){var r,n,i,o,a=this;t!==undefined&&t.exception!==undefined&&t.description!==undefined&&(a._errorCode=t.exception,a._errorString=t.description),Et.log("OnPostLoad Results:"),n=e[1].split(","),r=Et.base64.decode(n[0]),i=Et.base64.decode(n[1]),Et.log(r),Et.log(i),Et.log(n[2]),HG(a,"On PostLoad"),(o=a._ImgManager.getCurrentImageIndex())>=0&&a._innerRefreshUI(o),Et.isFunction(a.__OnPostLoad)&&a.__OnPostLoad(r,i,n[2])}},{key:"_OnPostTransfer",value:function(e){var t=this;if(Et.log("On PostTransfer Results:"+e),HG(t,"On PostTransfer"),Et.isFunction(t.__OnPostTransfer))try{t.__OnPostTransfer()}catch(r){vA(r)}}},{key:"_OnPreAllTransfersAsync",value:function(e){var t=this;if(Et.isFunction(t.__OnPreAllTransfersAsync)){var r={event:"beforeAcquire",result:{}};try{Et.isArray(e)&&e.length>1&&(r=Et.parse(e[1]))}catch(YV){}setTimeout((function(){try{t.__OnPreAllTransfersAsync(r)}catch(e){vA(e)}}),10)}}},{key:"_OnPostAllTransfers",value:function(e){var t=this;if(e.length>=2&&0==t._errorCode&&(t._errorCode=e[1],t._errorString=e[2]),Et.log("On PostAllTransfers Results:"+e),t.__bLoadingImage=!1,t.__bAcquireImageNow=!1,t.__closeRemoteScanUI(!0),Et.isFunction(t.__OnPostAllTransfers))try{t.__OnPostAllTransfers()}catch(r){vA(r)}}},{key:"_OnResult",value:function(e){var t=e[1];if(Et.isFunction(this.__OnResult))try{this.__OnResult(t)}catch(r){vA(r)}}},{key:"_OnTransferCancelled",value:function(e){var t=this;if(t._ImgManager.getCurrentImageIndex(),t._ImgManager.count(),t.__bLoadingImage=!1,t.__bAcquireImageNow=!1,Et.isFunction(t.__OnTransferCancelled))try{t.__OnTransferCancelled()}catch(r){vA(r)}}},{key:"_OnTransferError",value:function(e){if(Et.isFunction(this.__OnTransferError))try{this.__OnTransferError()}catch(t){vA(t)}}},{key:"_OnSourceUIClose",value:function(e){var t=this;if(t.__closeRemoteScanUI(!0),Et.isFunction(t.__OnSourceUIClose))try{t.__OnSourceUIClose()}catch(r){vA(r)}}},{key:"_OnPreTransfer",value:function(e){if(Et.isFunction(this.__OnPreTransfer))try{this.__OnPreTransfer()}catch(t){vA(t)}}},{key:"_OnPreAllTransfers",value:function(e){if(Et.isFunction(this.__OnPreAllTransfers))try{this.__OnPreAllTransfers()}catch(t){vA(t)}}},{key:"_OnGetFilePath",value:function(e){var t,r,n,i=this;if(t=e[1].split(","),Et.log("On GetFilePath Results:"+e),r=Et.base64.decode(t[3]),n=Et.base64.decode(t[4]),"-1032"==t[2]&&(t[2]="-1",r=n=""),Et.isFunction(i.__OnGetFilePath))try{i.__OnGetFilePath(1*t[0],1*t[1],1*t[2],r,n)}catch(o){vA(o)}i.__bOpenFileNow=!1}},{key:"__GetLoadEventsNum",value:function(){var e=0;return Et.isFunction(this.__OnPostLoad)&&(e|=1),Et.isFunction(this.__OnGetFilePath)&&(e|=2),e}},{key:"_innerSend",value:function(e,t,r,n,i){var o=this;if(xt.DWT.ConnectWithSocket||"SaveSelectedImagesToBytes"!=e&&"ConvertToBlob"!=e)return this._sendData(e,t,r,n,i);var a=Gx(),s=iF(o._clientId,e,t,a,o._bScanForProxyRemote);return o._innerFunRaw(e,s,!0,!0,!0,n,i),tC.Promise.resolve(!0)}},{key:"_convertToBlobByIndices",value:function(e,t,r,n,i){var o=this;if(o._resetErr(),!o._isValid())return!1;var a=parseInt(t),s=arguments,u=function(e){return Et.isFunction(n)&&PF(n,o,e,t,s),e=null,!1};if(!bP.checkProductKey(o,{Core:!0}))return Et.isFunction(n)&&n(o._errorCode,o._getErrorString()),!1;if(!o._checkIndices(e))return u(e);if(a==xt.DWT.EnumDWT_ImageType.IT_BMP||a==xt.DWT.EnumDWT_ImageType.IT_JPG||a==xt.DWT.EnumDWT_ImageType.IT_PNG||a==xt.DWT.EnumDWT_ImageType.IT_J2K){if(e.length>1)return kw(o,-2372,"You cannot convert more than one image to binary when the format is BMP, JPG or PNG."),u(e)}else if(a!=xt.DWT.EnumDWT_ImageType.IT_TIF&&a!=xt.DWT.EnumDWT_ImageType.IT_PDF)return sE(o),u(e);var c=[];return Et.isArray(e)&&Et.each(e,(function(e){var t=o._ImgManager.convertClientIndexToServerId(e);-1!=t&&c.push(t)})),Et.isFunction(r)?(bt.cancelFrom=aG.ConvertToBlob,o._innerConvertToBlobWithUI("ConvertToBlob",a,c,false,(function(e,n){return Et.isFunction(r)&&AF(r,e,n,t,s),e=n=null,!0}),u),!0):MG(o,LG,GG).call(o,c,a,false)}},{key:"_getDefaultDevice",value:function(){var e=this;if(e._resetErr(),!e._isValid())return null;var t="",r=Px.TWAINSCANNER,n=e._innerFun("GetDefaultSourceName");if(n.length>0)try{var i=JSON.parse(n);r=i.type,t=Et.base64.decode(i.ProductName)}catch(a){t=""}var o=new FD;return o.name=t,o.deviceType=r,o.isSystemDefaultPrinter=!1,r==Px.TWAINX64SCANNER&&t.length>0?o.displayName="Twain64-"+t:r==Px.WIASCANNER&&t.length>0?o.displayName="WIA-"+t:r==Px.ESCLSCANNER&&t.length>0?o.displayName="ESCL-"+t:r==Px.ICASCANNER&&e.__serverPlatform==OC.enumMac&&t.length>0?o.displayName="ICA-"+t:o.displayName=t,o}},{key:"_getDefaultDeviceAsync",value:(l=eA(g.mark((function h(){var e,t,r,n,i,o;return g.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if((e=this)._resetErr(),e._isValid()){a.next=4;break}return a.abrupt("return",null);case 4:return t="",r=Px.TWAINSCANNER,a.next=8,e._sendDataByHttpAsync("GetDefaultSourceName");case 8:if((n=a.sent).length>0)try{i=JSON.parse(n),r=i.type,t=Et.base64.decode(i.ProductName)}catch(s){t=""}return(o=new FD).name=t,o.deviceType=r,o.isSystemDefaultPrinter=!1,r==Px.TWAINX64SCANNER&&t.length>0?o.displayName="Twain64-"+t:r==Px.ICASCANNER&&e.__serverPlatform==OC.enumMac&&t.length>0?o.displayName="ICA-"+t:o.displayName=t,a.abrupt("return",o);case 16:case"end":return a.stop()}}),h,this)}))),function(){return l.apply(this,arguments)})},{key:"_getSources",value:function(e,t,r){return WD(this,this._innerFun("GetSources",Rx(e,null!=t&&t,null!=r&&r)))}},{key:"_getSourceCountAsync",value:(c=eA(g.mark((function p(e){var t,r,n,i,o,a,s,u;return g.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if((t=this)._resetErr(),t._isValid()){c.next=4;break}return c.abrupt("return",tC.Promise.reject({code:t._errorCode,message:t._errorString}));case 4:return MG(t,UG,jG).call(t),zx("GetSourceCountAsync",t),r=[],c.prev=7,e&&(t._driverType=e),n=iC,i=iC,o=iC,a=iC,t._bRemoteMode?t.__serverPlatform==OC.enumWindow?o=!0:t.__serverPlatform==OC.enumLinux?i=!0:t.__serverPlatform==OC.enumMac?n=!0:t.__serverPlatform==OC.enumAndroid&&(a=!0):(n=K.bMac,i=K.bLinux,o=K.bWin,a=K.bAndroid),s=IF(t._driverType,o,i,n,a),u=oC,c.next=15,this._getDevices(s,u,void 0);case 15:r=c.sent,c.next=21;break;case 18:throw c.prev=18,c.t0=c["catch"](7),c.t0;case 21:return c.prev=21,Kx("GetSourceCountAsync"),c.finish(21);case 24:return c.abrupt("return",t._setDevices(r));case 25:case"end":return c.stop()}}),p,this,[[7,18,21,24]])}))),function(e){return c.apply(this,arguments)})},{key:"_setDevices",value:function(e){var t,r=this;return r.__devices=e,t=e.length,r.__sourceCount=t,t<=0?(r.__defaultSourceName="",r.__sourceCount=0,0):t}},{key:"_getSourceNameByIndex",value:function(e){var t=this.__devices.length;return e<0||e>=t?"":this.__devices[e].displayName}},{key:"_dwtConvertToBlobSync",value:function(e,t,r,n,i,o){var a=r,s=",";Et.isString(a)&&""!=a||(a="",s="");var u=["[",e,',"',t.join(","),'"',s,a,"]"].join(""),c=this._innerFunRaw("ConvertToBlob",u,!1,!0,!1),l="";return 0==this._errorCode?(c&&"md5"in c&&(l=c.md5),n(c,l,o)):(i(),!1)}},{key:"_getSourceCountSync",value:function(){var e,t=this,r=iC,n=iC,i=iC,o=iC;if(t._bRemoteMode?t.__serverPlatform==OC.enumWindow?i=!0:t.__serverPlatform==OC.enumLinux?n=!0:t.__serverPlatform==OC.enumMac?r=!0:t.__serverPlatform==OC.enumAndroid&&(o=!0):(r=K.bMac,n=K.bLinux,i=K.bWin,o=K.bAndroid),e=IF(this._driverType,i,n,r,o),t._resetErr(),!t._isValid())return 0;if(!bP.checkProductKey(t,{Core:!0}))return 0;MG(t,UG,jG).call(t);var a=oC,s=t._getSources(e,a,undefined);return t._setDevices(s)}},{key:"_OnActiveUI",value:(u=eA(g.mark((function m(e){var t;return g.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=this,e&&e.length>2&&(t.__strProductName=e[2]),r.next=4,xF(cA(f.prototype),"_OnActiveUI",this).call(this,e);case 4:return r.next=6,t._setConvertModeAsync(t._pdfConvertMode)["catch"]((function(){}));case 6:case"end":return r.stop()}}),m,this)}))),function(e){return u.apply(this,arguments)})},{key:"_OnReady",value:(s=eA(g.mark((function _(){var e,t,r,n,i;return g.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return Aw((e=this)._serverInfo.server)&&(HD.item("DWT_port",e._serverInfo.port),HD.item("DWT_ssl",e._serverInfo.ssl?"true":"false")),e._bNoMask||zx("OnReady",e),o.prev=3,o.next=6,xF(cA(f.prototype),"_OnReady",this).call(this);case 6:if(!Ew()){o.next=12;break}if(e._uuidForActiveUI){o.next=12;break}return o.next=10,xt.DWT.lgcuid(xt.DWT.EnumInstance.dwt_desktop,"");case 10:t=o.sent,e._uuidForActiveUI=t;case 12:return o.next=14,e._innerActiveUI(e._uuidForActiveUI);case 14:return r=o.sent,o.next=17,e._OnActiveUI(r);case 17:if(Mk("Changing Map..."),(n=e._id)&&!xt.DWT.WebTwainIdMap[n]&&(xt.DWT.WebTwainIdMap[n]=e),RG(e),i=!1,e._bRemoteMode||(i=bt.attachAddon(e)),xt.DWT.IfDisableDefaultSettings){o.next=29;break}return Mk("Configuring the WebTwain instance..."),o.next=27,zG(e);case 27:o.next=32;break;case 29:if(!i){o.next=32;break}return o.next=32,new tC.Promise((function(e){setTimeout(e,300)}));case 32:o.next=39;break;case 34:throw o.prev=34,o.t0=o["catch"](3),o.t0&&(e._errorCode=o.t0.code,e._errorString=o.t0.message),e.dispose(),o.t0;case 39:return o.prev=39,e._bNoMask||Kx("OnReady"),o.finish(39);case 42:case"end":return o.stop()}}),_,this,[[3,34,39,42]])}))),function(){return s.apply(this,arguments)})},{key:"_OnWSClose",value:function(e){xF(cA(f.prototype),"_OnWSClose",this).call(this,e),bt.detect.bOK=!1;this.__bAcquireImageNow=!1}},{key:"_OnWSTimeout",value:function(e){xF(cA(f.prototype),"_OnWSTimeout",this).call(this,e),bt.detect.bOK=!1}},{key:"_setConvertModeAsync",value:function(e){var t,r=this,n=1*e;if(isNaN(n))return jE(r),tC.Promise.reject({code:r._errorCode,message:r._errorString});if(!r._checkConvertModeInner(n))return tC.Promise.reject({code:r._errorCode,message:r._errorString});t=this._mixSavedPdfReaderOptions({convertMode:n,renderOptions:{renderAnnotations:!!r._pdfOptions.renderOptions.renderAnnotations}}),r._resetPdfOptionsWhenSetConvertMode(t);var i=r._getPdfDllname(),o=["[",Et.stringify(t),',"',i,'"',"]"].join("");return r._innerFunV2("SetPDFReaderOptions",o).then((function(){if(r._pdfConvertMode=n,r._pdfOptions.convertMode=t.convertMode,r._pdfOptions.renderOptions.renderAnnotations=t.renderOptions.renderAnnotations,r._pdfOptions.convertMode==Lk.CM_IMAGEONLY&&r._pdfConvertMode==Lk.CM_RENDERALL||r._pdfOptions.convertMode==Lk.CM_IMAGEONLY&&r._pdfConvertMode==Lk.CM_RENDERALLWITHANNOTATION)throw r._pdfConvertMode=Lk.CM_IMAGEONLY,$w(r),{code:r._errorCode,message:r._errorString};return!0}))}},{key:"_getConvertMode",value:function(){return this._pdfConvertMode}},{key:"_setConvertMode",value:function(e){var t,r=this,n=1*e;if(isNaN(n))return jE(r),!1;if(!r._checkConvertModeInner(n))return!1;t=this._mixSavedPdfReaderOptions({convertMode:n,renderOptions:{renderAnnotations:!!r._pdfOptions.renderOptions.renderAnnotations}}),r._resetPdfOptionsWhenSetConvertMode(t);var i=r._setReaderOptions(t,!1);return i&&(r._pdfConvertMode=n,r._pdfOptions.convertMode=t.convertMode,r._pdfOptions.renderOptions.renderAnnotations=t.renderOptions.renderAnnotations,r._pdfOptions.convertMode==Lk.CM_IMAGEONLY&&r._pdfConvertMode==Lk.CM_RENDERALL||r._pdfOptions.convertMode==Lk.CM_IMAGEONLY&&r._pdfConvertMode==Lk.CM_RENDERALLWITHANNOTATION)?(r._pdfConvertMode=Lk.CM_IMAGEONLY,$w(r),!1):i}},{key:"_checkConvertModeInner",value:function(e){var t=this;return!!bP.checkProductKey(t,{Core:!0})&&(t._resetErr(),!!t._isValid()&&(e==Lk.CM_RENDERALL||e==Lk.CM_IMAGEONLY||e==Lk.CM_AUTO||e==Lk.CM_RENDERALLWITHANNOTATION||(jE(t),!1)))}},{key:"_resetPdfOptionsWhenSetConvertMode",value:function(e){var t=e.convertMode;t==Lk.CM_IMAGEONLY||bP.hasPDFRProductKey(this)?e.convertMode=t:e.convertMode=Lk.CM_IMAGEONLY,e.convertMode==Lk.CM_IMAGEONLY||e.convertMode==Lk.CM_RENDERALL?e.renderOptions.renderAnnotations=!1:e.convertMode==Lk.CM_RENDERALLWITHANNOTATION&&(e.renderOptions.renderAnnotations=!0)}},{key:"_mixSavedPdfReaderOptions",value:function(e){var t;return t=Et.clone(this._pdfOptions),e||(e={}),e.convertMode&&(t.convertMode=e.convertMode),e.password&&(t.password=e.password),e.renderOptions&&(t.renderOptions=Et.mix(this._pdfOptions.renderOptions,e.renderOptions)),t}},{key:"_setReaderOptions",value:function(e,t){var r,n,i=this,o=-1;if(i._resetErr(),e&&e.renderOptions){var a=e.renderOptions.resolution,s=e.renderOptions.maxWidth,u=e.renderOptions.maxHeight,c=e.renderOptions.renderGrayscale;if(!Et.isUndefined(a)&&(!xt.Lib.isNumber(a)||a<=0))return kw(i,-2830,"The PDF resolution must be a positive number."),!1;if(!Et.isUndefined(s)&&(!xt.Lib.isNumber(s)||s<0))return function(e){kw(e,-2831,"The PDF max width must be a positive number.")}(i),!1;if(!Et.isUndefined(u)&&(!xt.Lib.isNumber(u)||u<0))return function(e){kw(e,-2832,"The PDF max height must be a positive number.")}(i),!1;if(!Et.isUndefined(c)&&!xt.Lib.isBoolean(c))return function(e){kw(e,-2833,"The PDF render grayscale must be a boolean.")}(i),!1}if(t){r={},e||(e={}),e.convertMode?r.convertMode=e.convertMode:r.convertMode=Lk.CM_AUTO,o=r.convertMode,Et.isString(e.password)?r.password=e.password:Et.isNumber(e.password)?r.password=""+e.password:r.password="",r.renderOptions=Et.mix({renderAnnotations:!1,resolution:200,maxWidth:0,maxHeight:0,renderGrayscale:!1},e.renderOptions);var l=r.renderOptions.renderAnnotations;Et.isBoolean(l)||Et.isString(l)&&(r.renderOptions.renderAnnotations="true"==l.toLowerCase());var d=r.renderOptions.renderGrayscale;if(Et.isBoolean(d)||Et.isString(d)&&(r.renderOptions.renderGrayscale="true"==d.toLowerCase()),Et.isNumber(r.convertMode)){if(!i._checkConvertModeInner(r.convertMode))return!1;bP.hasPDFRProductKey(i)||(r.convertMode=Lk.CM_IMAGEONLY),r.convertMode==Lk.CM_IMAGEONLY?r.renderOptions.renderAnnotations=!1:r.convertMode==Lk.CM_RENDERALLWITHANNOTATION&&(r.renderOptions.renderAnnotations=!0)}}else{if(Et.isUndefined(e))return function(e){kw(e,-2834,"The PDF reader options is invalid.")}(i),!1;if(r=e,Et.isString(e.password)||Et.isUndefined(e.password));else{if(!Et.isNumber(e.password))return function(e){kw(e,-2829,"The type of the PDF password must be a string.")}(i),!1;e.password=""+e.password}}var f=i._getPdfDllname();n=["[",Et.stringify(r),',"',f,'"',"]"].join("");var h=i._innerFun("SetPDFReaderOptions",n);return h&&t&&(i._pdfOptions=Et.clone(r),Et.isNumber(r.convertMode)&&(r.convertMode==Lk.CM_RENDERALL&&r.renderOptions.renderAnnotations&&(r.convertMode=Lk.CM_RENDERALLWITHANNOTATION),i._pdfConvertMode=r.convertMode,i._pdfOptions.convertMode==Lk.CM_IMAGEONLY&&o==Lk.CM_RENDERALL||i._pdfOptions.convertMode==Lk.CM_IMAGEONLY&&o==Lk.CM_RENDERALLWITHANNOTATION))?(i._pdfConvertMode=Lk.CM_IMAGEONLY,$w(i),!1):h}},{key:"_getPdfDllname",value:function(){var e=this,t=!1,r=!1;return e._bRemoteMode?e.__serverPlatform==OC.enumWindow||(e.__serverPlatform==OC.enumLinux?r=!0:e.__serverPlatform==OC.enumMac&&(t=!0)):(t=K.bMac,r=K.bLinux,K.bWin),t?e._b64bit?"libDynamicPdfCorex64_"+uw.PdfVersion+".dylib":"libDynamicPdfCore_"+uw.PdfVersion+".dylib":r?"libDynamicPdfCore_"+uw.PdfVersion+".so":e._b64bit?"DynamicPdfCorex64_"+uw.PdfVersion+".dll":"DynamicPdfCore_"+uw.PdfVersion+".dll"}},{key:"_unload_viewer",value:function(){}},{key:"__innerDeleteInMap",value:function(){return this._id,delete xt.DWT.WebTwainIdMap[this._id],oC}},{key:"__unload",value:(a=eA(g.mark((function v(){var e,t,r;return g.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e=this,t=Et.clone(xt.DWT.licenseException),e.__closeRemoteScanUI(!0),!e._destroy&&!e._destroying){n.next=5;break}return n.abrupt("return");case 5:if(e._destroying=!0,this.__innerDeleteInMap(),e.__addon&&e.__addon.Camera&&e.__addon.Camera._viewer&&(""!=e.__addon.Camera.getStatus()&&e.__addon.Camera.closeSource()["catch"]((function(){})),e.__addon.Camera._viewer.dispose(),e.__addon.Camera._viewer=null),e._unload_viewer(),e._containerElement=null,e._ImgManager&&e._ImgManager.clear(),!e._bReady||bt.page.bUnload){n.next=20;break}if(!e._wsClient){n.next=20;break}return n.prev=13,n.next=16,e._innerDisposeWSClient();case 16:n.next=20;break;case 18:n.prev=18,n.t0=n["catch"](13);case 20:e._wsClient&&(e._wsClient.removeEvent("close",e._clientId),e._wsClient.removeEvent("error",e._clientId),e._wsClient.removeEvent("timeout",e._clientId),e._wsClient.dispose(),delete e._wsClient,e._wsClient=null),e._bReady=!1,xt.DWT.lremoveDWTObj(e),e.__bAcquireImageNow=!1,e._destroying=!1,e._destroy=!0,(r=xt.DWT.licenseException).code=t.code,r.message=t.message,r.fromLTS=t.fromLTS;case 30:case"end":return n.stop()}}),v,this,[[13,18]])}))),function(){return a.apply(this,arguments)})},{key:"_setIfShowUI",value:function(e){this._resetErr(),this._isValid()&&(Et.isBoolean(e)?this._innerFun("IfShowUI",Rx(e)):Fw(self))}},{key:"_setIfShowFileDialog",value:function(e){this._resetErr(),this._isValid()&&(Et.isBoolean(e)?this._innerFun("IfShowFileDialog",Rx(e)):Fw(self))}},{key:"_getDevicesAsync",value:(o=eA(g.mark((function y(e,t,r,n){var i,o,a,s,u;return g.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(i=this,o=[],!t||Et.isNumber(t)){c.next=4;break}return gE(i),c.abrupt("return",tC.Promise.reject({code:i._errorCode,message:i._errorString}));case 4:if(a=i._bRemoteMode?Mx:K.bAndroid?Bx:Mx,s=null!=t?t:a,i._resetErr(),i._isValid()){c.next=8;break}return c.abrupt("return",tC.Promise.reject({code:i._errorCode,message:i._errorString}));case 8:return zx(e,i),c.prev=9,c.next=12,i._getDevices(s,r,n);case 12:u=c.sent,Et.isArray(u)&&u.length>0&&(o=o.concat(u)),c.next=19;break;case 16:throw c.prev=16,c.t0=c["catch"](9),c.t0;case 19:return c.prev=19,Kx(e),c.finish(19);case 22:return o.length>0&&this._setDevices(o),c.abrupt("return",o);case 24:case"end":return c.stop()}}),y,this,[[9,16,19,22]])}))),function(e,t,r,n){return o.apply(this,arguments)})},{key:"_openSourceAsync",value:function(e){var t=this;return t._resetErr(),t._isValid()?(t._bRemoteMode&&t._initRemoteDiv(),t._innerFunV2("OpenSource").then((function(e){return t.__closeRemoteScanUI(!0),e}),(function(e){return t.__closeRemoteScanUI(!0),tC.Promise.reject(e)}))):tC.Promise.reject({code:t._errorCode,message:t._errorString})}},{key:"_closeSourceAsync",value:function(e){var t=this;return t._resetErr(),t._isValid()?t._innerFunV2("CloseSource").then((function(){return t._curDevice=null,!0})):tC.Promise.reject({code:t._errorCode,message:t._errorString})}},{key:"_selectSourceAsync",value:function(e,t,r){var n=this;return n._resetErr(),n._isValid()?n._getDevicesAsync(e,t).then((function(t){var i,o,a=document,s=t?t.length:0;tC.dialog.selectsourcedlg&&(tC.dialog.selectsourcedlg.close(),document.body.removeChild(tC.dialog.selectsourcedlg),tC.dialog.selectsourcedlg=!1);var u,c,l,d,f=-1;for((o=a.createElement("dialog")).className="dynamsoft-dialog-selectsource",K.bIE&&(o.style.width="300px"),o.setAttribute("closed","closed"),(u=[]).push('<ul id="dynamsoft-dialog-selectsource-sourcelist-ul">'),i=0;i<s;i++){var h="",g=n._getSourceNameByIndex(i);(""==n.__defaultSourceName&&0==i||n.__defaultSourceName==g)&&(h=" dynamsoft-dialog-selectsource-sourcelist-li-selected",f=i),u.push('<li class="dynamsoft-dialog-selectsource-item'+h+'" sourceindex='+i+">"+g+"</li>")}u.push("</ul>"),u=u.join(""),Et.isArray(r)&&r.length>=3?(c=r[0],l=r[1],d=r[2]):(c="Select Source:",l="Select",d="Cancel");var p=["<p>",c,"</p>",'<div id="dynamsoft-dialog-selectsource-sourcelist">',u,"</div>",'<div><input type="button" value="',l,'" class="dynamsoft-dialog-selectsource-button-select">','<input type="button" value="',d,'" class="dynamsoft-dialog-selectsource-button-cancel"></div>'].join("");return o.innerHTML=p,tC.dialog.selectsourcedlg=o,a.body.appendChild(tC.dialog.selectsourcedlg),Et.each(Et.sizzle(".dynamsoft-dialog-selectsource-item"),(function(e,t){Et.addEventListener(e,"click",(function(e){for(var t=e.target,r=t.attributes.sourceindex.value,n=t.parentElement.children,i=0;i<n.length;i++)n[i].className="dynamsoft-dialog-selectsource-item";t.className="dynamsoft-dialog-selectsource-item dynamsoft-dialog-selectsource-sourcelist-li-selected",Et.get("dynamsoft-dialog-selectsource-sourcelist-ul").setAttribute("selectedSourceIndex",r)}))})),Et.get("dynamsoft-dialog-selectsource-sourcelist-ul").setAttribute("selectedSourceIndex",f.toString()),tC.dialog.setup(tC.dialog.selectsourcedlg),tC.dialog.selectsourcedlg&&tC.dialog.selectsourcedlg.showModal(),"CSS1Compat"==a.compatMode?a.documentElement.scrollTop:a.body.scrollTop,new tC.Promise((function(t,r){Et.removeEventListener(tC.one(".dynamsoft-dialog-selectsource-button-select")[0],"click"),Et.removeEventListener(tC.one(".dynamsoft-dialog-selectsource-button-cancel")[0],"click"),s>0&&Et.addEventListener(tC.one(".dynamsoft-dialog-selectsource-button-select")[0],"click",(function(){var r=parseInt(Et.get("dynamsoft-dialog-selectsource-sourcelist-ul").getAttribute("selectedSourceIndex"));r<0||n._selectSourceByIndexAsync(e,r).then((function(){tC.dialog.selectsourcedlg&&(tC.dialog.selectsourcedlg.close(),document.body.removeChild(tC.dialog.selectsourcedlg),tC.dialog.selectsourcedlg=!1),t(r)}))})),Et.addEventListener(tC.one(".dynamsoft-dialog-selectsource-button-cancel")[0],"click",(function(){tC.dialog.selectsourcedlg&&(tC.dialog.selectsourcedlg.close(),document.body.removeChild(tC.dialog.selectsourcedlg),tC.dialog.selectsourcedlg=!1);var e={};kE(e),r({code:e._errorCode,message:e._errorString})}))}))})):tC.Promise.reject({code:n._errorCode,message:n._errorString})}},{key:"_dwtGetCapabilities",value:function(e,t){var r=this,n=function(){Et.isFunction(t)&&t(r._errorCode,r._errorString)};return r._sendDataByHttpAsync("GetCapabilities",null).then((function(t){try{var i,o;t.length>0&&(o=t[0]),Et.isString(o)?(o=bt.removeNonPrintableChar(o),o=Et.replaceAll(o,"\\\\","\\\\"),0==(i=JSON.parse(o)).errorCode?Et.isFunction(e)&&e(i.response):(r._errorCode=i.errorCode,r._errorString=i.errorString,n())):(NE(r),n())}catch(a){r._errorCode=-2302,r._errorString=a,n()}}),n),!0}},{key:"_dwtSetCapabilities",value:function(e,t,r){var n=this;if(!Et.isObject(e)||Et.isArray(e))return gE(n),Et.isFunction(r)&&r(n._errorCode,n._getErrorString()),!1;var i=["[",Et.stringify(e),"]"].join("");return n._innerSend("SetCapabilities",i,0,(function(e){Et.isFunction(t)&&t(e)}),r),!0}},{key:"_selectDeviceAsync",value:(n=eA(g.mark((function I(e,t,r){var n,i;return g.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return n=this,zx(e,this),o.prev=2,o.next=5,xF(cA(f.prototype),"_innerSelectDeviceAsync",this).call(this,t,r);case 5:(i=o.sent)&&(n._curDevice=t,n._bSelectedSourceByServer=!1),o.next=12;break;case 9:throw o.prev=9,o.t0=o["catch"](2),o.t0;case 12:return o.prev=12,Kx(e),o.finish(12);case 15:return o.abrupt("return",i);case 16:case"end":return o.stop()}}),I,this,[[2,9,12,15]])}))),function(e,t,r){return n.apply(this,arguments)})},{key:"_selectSourceByIndexAsync",value:(r=eA(g.mark((function S(e,t){var r,n,i;return g.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(n=1*t,(r=this)._resetErr(),r._isValid()){o.next=4;break}return o.abrupt("return",tC.Promise.reject({code:r._errorCode,message:r._errorString}));case 4:if(!Et.isNaN(n)){o.next=7;break}return Dw(r),o.abrupt("return",tC.Promise.reject({code:r._errorCode,message:r._errorString}));case 7:if(r.__devices){o.next=10;break}return o.next=10,r._getDevicesAsync(e,null);case 10:if(!(n<0||n>=r.__devices.length)){o.next=13;break}return oE(r),o.abrupt("return",tC.Promise.reject({code:r._errorCode,message:r._errorString}));case 13:return i=r.__devices[n],o.abrupt("return",r._selectDeviceAsync(e,i));case 15:case"end":return o.stop()}}),S,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"_removeAllImages",value:function(e){var t=this,r=!0;if(t._resetErr(),!t._isValid())return!1;var n,i=[];for(n=t._getHowManyImagesInBuffer()-1;n>=0;n--){var o=t._imageBufferWrapper.convertClientIndexToServerId(n);o>-1&&i.push(o)}if(i.length>0){if(t._OnBitmapChanged(["0",i.join(","),3,t._ImgManager.getCurrentImageIndex(),t._ImgManager.count()]),r=t._innerFunRaw("RemoveAllImages",Rx(i.join(",")),!1,!1,!1,(function(){}),(function(){})),Et.isArray(r))return r[0]}else r=!0;return r}},{key:"_removeImage",value:function(e,t){var r,n=this,i=parseInt(t);if(!EF(n,i))return!1;var o=n._ImgManager.convertClientIndexToServerId(i);return-1==o?(oE(n),!1):(((r=n._innerFun("RemoveImage",Rx(o)))||-1033==n._errorCode)&&n._OnBitmapChanged(["0",""+o,3,n._ImgManager.getCurrentImageIndex(),n._ImgManager.count()]),r)}},{key:"__innerAcquireOrLoadImageAsync",value:function(e,t,r,n){var i=this;return new tC.Promise((function(r,n){var o="LoadImage"==e||"LoadImageEx"==e||"GenerateURLForUploadData"==e,a=o||"LoadDibFromClipboard"==e;o?bt.showProgress(i,e,!1):zx(e,i),i._innerSend(e,t,!0,(function(t){if(i.__bLoadingImage=!1,i.__bOpenFileNow=!1,i.__closeRemoteScanUI(!0),o){if(bt.closeProgress(null,e),i._isBindViewer()){var n=i._ImgManager.getCurrentImageIndex();n>=0&&i._innerRefreshUI(n)}}else Kx(e);a&&i._blts&&xt.DWT.lcvrf(i),Et.isFunction(r)&&r(t)}),(function(t){o?bt.closeProgress(null,""):Kx(e),i.__bLoadingImage=!1,i.__bAcquireImageNow=!1,i.__bOpenFileNow=!1,i.__closeRemoteScanUI(!0);var r=i._ImgManager.getCurrentImageIndex();r>=0&&i._innerRefreshUI(r),zE(i._errorCode)&&$w(i),Et.isFunction(n)&&n({code:i._errorCode,message:i._getErrorString()}),o?bt.closeProgress(null,e):Kx(e),t&&Et.error(t)}))}))}},{key:"_innerLoadImageFromBinary",value:function(e,t,r,n,i){var o,a,s=this,u=t;if(!bP.checkProductKey(s,{Core:!0}))return Et.isFunction(i)&&i(s._errorCode,s._getErrorString()),!1;if(!e||""==e)return Qw(s),Et.isFunction(i)&&i(s._errorCode,s._getErrorString()),!1;if(Et.isString(e))return gE(s),Et.isFunction(i)&&i(s._errorCode,s._getErrorString()),!1;if(e instanceof Blob)a=e.size;else if(Nx(e))a=e.byteLength;else if(e instanceof Array)a=e.length;else{var c=e;a=c.size||c.byteLength||c.length}if(!a||""==a)return gE(s),Et.isFunction(i)&&i(s._errorCode,s._getErrorString()),!1;var l=e.currentFileName;l||(l=s._getCurrentDocumentName());var d=e.currentTagName;if(d||!Et.isUndefined(e.bNeedClearCurrentTagName)&&e.bNeedClearCurrentTagName||(d=s._getCurrentDefaultTagName()),e instanceof FileList){if(1==e.length)return e[0].currentFileName=l,e[0].currentTagName=d,s._innerLoadImageFromBinary(e[0],u,r,n,i);if(e.length>1){var f;for(Et.asyncQueue.stop(),f=0;f<e.length;f++)e[f].currentFileName=l,e[f].currentTagName=d,f==e.length-1?Et.asyncQueue.pushToDo(s,"_innerLoadImageFromBinary",[e[f],u,r,n,i]):Et.asyncQueue.pushToDo(s,"_innerLoadImageFromBinary",[e[f],u,r,null,i]);return Et.asyncQueue.start(),!0}return Qw(s),Et.isFunction(i)&&i(s._errorCode,s._getErrorString()),!1}if(window.ReadableStream&&e instanceof ReadableStream?o=new Response(e):window.Response&&e instanceof Response&&(o=e),o)o.arrayBuffer().then((function(e){var t=new Blob([e]),o=0;r&&(o=s.__GetLoadEventsNum()),s.__LoadImageFromBytesV1(t,-1,"",o,!0,n,i)}));else{var h=e;Nx(h)&&((h=new Blob([e])).currentFileName=e.currentFileName,h.currentTagName=e.currentTagName);var g=-1,p=xt.DWT.EnumDWT_ImageType;Et.isString(h.type)&&("application/pdf"==h.type?g=p.IT_PDF:"image/png"==h.type?g=p.IT_PNG:"image/jpeg"==h.type||"image/jpg"==h.type?g=p.IT_JPG:"image/bmp"==h.type?g=p.IT_BMP:"image/tiff"==h.type||"image/tif"==h.type?g=p.IT_TIF:"image/jp2"==h.type&&(g=p.IT_J2K));var m=0;r&&(m=s.__GetLoadEventsNum()),s.__LoadImageFromBytesV1(h,g,"",m,!0,n,i)}return!0}},{key:"__LoadImageFromBytes",value:function(e,t,r,n,i,o,a,s){return this.__LoadImageFromBytesV2(e,t,r,n,a,s,!1,0,i,o)}},{key:"__LoadImageFromBytesV1",value:function(e,t,r,n,i,o,a){return this.__LoadImageFromBytesV2(e,t,r,i,0,0,!1,n,o,a)}},{key:"_isMobileMode",value:function(){return!1}},{key:"ErrorCode",get:function(){return this._errorCode}},{key:"ErrorString",get:function(){return this._getErrorString()}},{key:"HowManyImagesInBuffer",get:function(){return this._getHowManyImagesInBuffer()}}]),f}(kG);function GG(e,t,r){var n=this,i=function(e){return!1};return n._dwtConvertToBlobSync(t,e,r,(function(e){if(!e||e.size<=0)return hE(n),!1;var t=n.__maxUploadImageSize;return e.size>t&&-1!=t?(Jw(n),!1):e}),i)}function jG(){this.__defaultSourceName="",this.__sourceCount=0}var HG=function(e,t){if(Ax.bDiscardBlankImage){var r=e._ImgManager.getCurrentImageIndex();e.IsBlankImage(r)&&e.RemoveImage(r);var n=["Blank Discard (",t,"): ",e.ErrorString].join("");Et.isFunction(e.__OnPrintMsg)&&e.__OnPrintMsg(n)}};function zG(e){return KG.apply(this,arguments)}function KG(){return(KG=eA(g.mark((function e(t){var r,n,i,o;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t,!xt.DWT.ConnectWithSocket){e.next=6;break}return e.next=4,new tC.Promise((function(e,t){r._sendData("IfDisableSourceAfterAcquire","[1]",!1,e,t)}));case 4:e.next=8;break;case 6:return e.next=8,t._innerFunV2("IfDisableSourceAfterAcquire","[1]");case 8:n=gF.TWAIN,i=!1,o=!1,r._bRemoteMode?r.__serverPlatform==OC.enumWindow||(r.__serverPlatform==OC.enumLinux?o=!0:r.__serverPlatform==OC.enumMac&&(i=!0)):(i=K.bMac,o=K.bLinux,K.bWin),i?n=gF.TWAIN_AND_ICA:o&&(n=gF.SANE),t._driverType=n,t._bRemoteMode&&(t._setIfShowUI(!1),t._setIfShowFileDialog(!1));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function JG(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(VV){return!1}}();return function(){var r,n=cA(e);if(t){var i=cA(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return uA(this,r)}}function QG(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function qG(e,t,r){if(!t.has(e));return r}var YG=new WeakSet,XG=new WeakSet,ZG=new WeakSet,$G=new WeakSet,ej=new WeakSet,tj=function(e){sA(o,e);var r,n=JG(o);function o(){var e;t(this,o);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return QG(oA(e=n.call.apply(n,[this].concat(i))),ej),QG(oA(e),$G),QG(oA(e),ZG),QG(oA(e),XG),QG(oA(e),YG),e}return i(o,[{key:"SaveAsGIF",value:function(e,t,r,n){var i=this;if(i._resetErr(),!i._isValid())return!1;if(!(bP.checkProductKey(i,{Core:!0})||K.bWin&&bP.checkProductKey(i,{Webcam:!0},!0)))return bP.checkProductKey(i,{Core:!0},!1),Et.isFunction(n)&&n(i._errorCode,i._getErrorString()),!1;var o,a=yF.replaceLocalFilename(e);if(!bF(i,t,n))return!1;if(-1==(o=i._ImgManager.convertClientIndexToServerId(t)))return oE(i),Et.isFunction(n)&&kF(n,i),!1;var s=i.__GetLoadEventsNum();return i.__innerSaveImage("SaveAsGIF",Rx(a,o,s),r,n)}},{key:"SaveSelectedImagesToBase64Binary",value:function(e,t){var r=this;if(r._resetErr(),!r._isValid())return!1;if(!(bP.checkProductKey(r,{Core:!0})||K.bWin&&bP.checkProductKey(r,{Webcam:!0},!0)))return bP.checkProductKey(r,{Core:!0},!1),Et.isFunction(t)&&t(r._errorCode,r._getErrorString()),!1;var n=CF(r);return Et.isFunction(e)?(r._innerSend("SaveSelectedImagesToBase64Binary",Rx(n.join(",")),!0,e,t),!0):r._innerFun("SaveSelectedImagesToBase64Binary",Rx(n.join(",")))}},{key:"ShowFileDialog",value:function(e,t,r,n,i,o,a,s){var u=this;if(u._resetErr(),!u._isValid())return!1;var c,l=yF.replaceLocalFilename(i);return c=u.__GetLoadEventsNum(),u._innerSend("ShowFileDialog",Rx(e,t,r,n,l,o,a,s,c),!0),!0}},{key:"FTPDownload",value:function(e,t,r,n){var i=this;if(i._resetErr(),!i._isValid())return!1;if(!e)return gE(i),Et.isFunction(n)&&n(i._errorCode,i._getErrorString()),!1;var o=yF.getImageType(t);return qG(i,ej,aj).call(i,"FTPDownload",Rx(e,t),o,r,n)}},{key:"FTPDownloadEx",value:function(e,t,r,n,i){var o=this;return o._resetErr(),!!o._isValid()&&(e?qG(o,ej,aj).call(o,"FTPDownloadEx",Rx(e,t,r),r,n,i):(gE(o),Et.isFunction(i)&&i(o._errorCode,o._getErrorString()),!1))}},{key:"FTPUpload",value:function(e,t,r,n,i){var o=this;if(o._resetErr(),!o._isValid())return!1;var a=o._ImgManager.convertClientIndexToServerId(t);return!!bF(o,t,i)&&(-1==a?(oE(o),Et.isFunction(i)&&kF(i,o),!1):o.__innerFTPUpload("FTPUpload",Rx(e,a,r),n,i))}},{key:"FTPUploadEx",value:function(e,t,r,n,i,o){var a,s=this;return s._resetErr(),!!s._isValid()&&(!!bF(s,t,o)&&(-1==(a=s._ImgManager.convertClientIndexToServerId(t))?(oE(s),Et.isFunction(o)&&kF(o,s),!1):s.__innerFTPUpload("FTPUploadEx",Rx(e,a,r,n),i,o)))}},{key:"FTPUploadAllAsMultiPageTIFF",value:function(e,t,r,n){var i=this;if(i._resetErr(),!i._isValid())return!1;var o=[];return SF(i,o),this.__innerFTPUpload("FTPUploadAsMultiPageTIFF",Rx(e,t,o.join(",")),r,n)}},{key:"FTPUploadAllAsPDF",value:function(e,t,r,n){var i=this;if(i._resetErr(),!i._isValid())return!1;var o=[];return SF(i,o),i.__innerFTPUpload("FTPUploadAsMultiPagePDF",Rx(e,t,o.join(",")),r,n)}},{key:"FTPUploadAsMultiPagePDF",value:function(e,t,r,n){var i=this;if(i._resetErr(),!i._isValid())return!1;var o=CF(i);return i.__innerFTPUpload("FTPUploadAsMultiPagePDF",Rx(e,t,o.join(",")),r,n)}},{key:"FTPUploadAsMultiPageTIFF",value:function(e,t,r,n){var i=this;if(i._resetErr(),!i._isValid())return!1;var o=CF(i);return this.__innerFTPUpload("FTPUploadAsMultiPageTIFF",Rx(e,t,o.join(",")),r,n)}},{key:"HTTPDownloadDirectly",value:function(e,t,r,n,i){var o,a=this;if(a._resetErr(),!a._isValid())return!1;if(!bP.checkProductKey(a,{Core:!0}))return Et.isFunction(i)&&i(a._errorCode,a._getErrorString()),!1;var s,u,c=a._GetHttpHeadersAndClear(),l=yF.combineUrl(a,e,t);if(l===undefined)return Qw(a),!1;if(!r||""==r)return function(e,t){kw(e,-2309,"The LocalFile is empty in the name "+t+" Function.")}(a,"HTTPDownloadDirectly"),Et.isFunction(i)&&kF(i,a),!1;if(s=yF.getImageType(r),!bP.checkPDFProductKeyWhenNeeds(a,s))return Et.isFunction(i)&&i(a._errorCode,a._errorString),!1;bt.cancelFrom=aG.HTTPDownload,u=yF.replaceLocalFilename(r),a.IfShowProgressBar?bt.showProgress(a,"HTTPDownloadDirectly",!1):bt.hideProgress();var d=null===(o=bt.progressContext)||void 0===o?void 0:o.IfShowCancelDialogWhenImageTransfer,f=!0,h=function(){return a.IfShowProgressBar&&bt.closeProgress(null,"HTTPDownloadDirectly"),Et.isFunction(n)&&n(),!0},g=function(){return bt.progressContext&&(bt.progressContext.IfShowCancelDialogWhenImageTransfer=d),a.IfShowProgressBar&&bt.closeProgress(null,"HTTPDownloadDirectly"),Et.isFunction(i)&&kF(i,a),!1};a._OnPercentDone([0,-1,fx.Downloading,"http"]),Et.isFunction(n)||(f=!1),bt.progressContext&&(bt.progressContext.IfShowCancelDialogWhenImageTransfer=!0);var p=yF.loadHttpBlob(a,"get",l,f,(function(e){bt.progressContext&&(bt.progressContext.IfShowCancelDialogWhenImageTransfer=d),a._OnPercentDone([0,-1,fx.Loading]);var t=a.__GetLoadEventsNum();return a.__LoadImageFromBytesV1(e,3,u,t,f,h,g)}),g,(function(e){var t=0===e.total?100:Math.round(100*e.loaded/e.total);[e.loaded," / ",e.total].join(""),t>=100&&e.loaded<e.total&&(t=99),a._OnPercentDone([0,t,"","http"])}),c);return p}},{key:"HTTPUploadThroughPostDirectly",value:function(e,t,r,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return!1;var s=yF.combineUrl(a,e,r),u=function(){Et.isFunction(o)&&kF(o,a,a.__HTTPPostResponseString)};if(a.__HTTPPostResponseString="",!t)return qw(a),u(),!1;if(!e)return Lw(a),u(),!1;var c=this.IfShowProgressBar;return a._innerUploadDirectly(s,t,n,c,!1,0,!0,!1,i,u)}},{key:"_innerUploadDirectly",value:function(e,t,r,n,i,o,a,s,u,c){var l,d=this,f=d._GetHttpHeadersAndClear(),h="HTTPUploadThroughPostDirectly",g=!0;if(e===undefined||!1===e||""===e)return Qw(d),Et.isFunction(c)&&c(),!1;if(Et.isFunction(u)||(g=!1),!bP.checkProductKey(d,{Core:!0}))return Et.isFunction(c)&&c(),!1;bt.cancelFrom=aG.HTTPUpload;var p=function(e,t,r){return 0!=e&&t&&(d._errorCode=e,d._errorString=t),r&&(d.__HTTPPostResponseString=r),bt.needShowTwiceShowDialog=!1,n&&bt.closeProgress(null,h),Et.isFunction(c)&&c(),!1};return bt.needShowTwiceShowDialog=!0,n?bt.showProgress(d,h,!1):bt.hideProgress(),(l=yF.replaceLocalFilename(t))&&""!=l?s&&s.bCancel?(s.st=2,kE(d),p(d._errorCode,d._errorString)):qG(d,XG,nj).call(d,l,g,i,(function(t){if(bt.needShowTwiceShowDialog=!1,s&&s.bCancel)return s.st=2,kE(d),p(d._errorCode,d._errorString);if(t&&(!n||n&&bt.dlgRef>0||0==g)){t instanceof File?t.fileName=r:t.name=r,n&&_G(d.__IfShowCancelDialogWhenImageTransfer);var i=new yG,c=d._createHttpUploaderConfig(),l=new IG;return d.__remoteFilename&&""!=d.__remoteFilename&&(l.remoteFilename=d.__remoteFilename),c.objUploadStatus=s,l.url=e,l.method=h,l.content=t,t=null,l.contentType=d._strHttpContentTypeFieldValue,l.headers=f,l.bAsync=g,l.httpFormData=uj(d.httpFormFields),l.retry=o,l.bOnlyResponseEmptyIsOK=a,l.blockSize=d._moduleSize,i.httpPostUpload(c,l,(function(e){n&&bt.closeProgress(null,h),Et.isFunction(u)&&AF(u,e)}),p)}return qw(d),p(d._errorCode,d._errorString)}),p):(qw(d),p(d._errorCode,d._errorString))}},{key:"_innerUploadFilesDirectly",value:function(e,t,r,n,i,o,a,s,u){var c,l=this,d=l._GetHttpHeadersAndClear(),f="HTTPUploadThroughPostDirectly",h=!0,g=[];if(!1===e||""===e)return Qw(l),Et.isFunction(u)&&u({code:l._errorCode,message:l._getErrorString(),files:t}),!1;if(Et.isFunction(s)||(h=!1),!bP.checkProductKey(l,{Core:!0}))return Et.isFunction(u)&&u({code:l._errorCode,message:l._getErrorString(),files:t}),!1;bt.cancelFrom=aG.HTTPUpload;var p=function(e,r,i){return 0!=e&&r&&(l._errorCode=e,l._errorString=r),i&&(l.__HTTPPostResponseString=i),bt.needShowTwiceShowDialog=!1,n&&bt.closeProgress(null,f),Et.isFunction(u)&&u({code:l._errorCode,message:l._errorString,response:i,files:t}),!1};bt.needShowTwiceShowDialog=!0,n?bt.showProgress(l,f,!1):bt.hideProgress(),Et.each(t,(function(e){var t=yF.replaceLocalFilename(e);if(!t||""==t)return qw(l),p(l._errorCode,l._errorString),!1;g.push(t)}));var m=[],_=g.length,v=0;return Et.each(g,(function(t,u){c=qG(l,XG,nj).call(l,t,h,i,(function(t){if(bt.needShowTwiceShowDialog=!1,!t||n&&!(n&&bt.dlgRef>0)&&0!=h)return n&&bt.closeProgress(null,f),Vw(l),Et.isFunction(p)&&p(l._errorCode,l._errorString),!1;var i=hG(r,u+1);if(t instanceof File?t.fileName=i:t.name=i,m[u]=t,t=null,++v==_){n&&_G(l.__IfShowCancelDialogWhenImageTransfer);var c=l._createHttpUploaderConfig(),g=new IG;return l.__remoteFilename&&""!=l.__remoteFilename&&(g.remoteFilename=l.__remoteFilename),g.url=e,g.method=f,g.content=m,m=null,g.contentType=l._strHttpContentTypeFieldValue,g.headers=d,g.bAsync=h,g.httpFormData=uj(l.httpFormFields),g.retry=o,g.bOnlyResponseEmptyIsOK=a,g.blockSize=l._moduleSize,mG(c,g,(function(e){n&&bt.closeProgress(null,f),Et.isFunction(s)&&AF(s,e)}),(function(e,t,r){n&&bt.closeProgress(null,f),Et.isFunction(p)&&p(e,t,r)}))}}),(function(){n&&bt.closeProgress(null,f),Et.isFunction(p)&&p()}))})),c}},{key:"_createHttpUploaderConfig",value:function(){var e=this,t=new SG;return t.IfShowProgressBar=e.IfShowProgressBar,t.IfShowCancelDialogWhenImageTransfer=e.__IfShowCancelDialogWhenImageTransfer,t.MaxUploadImageSize=e.MaxUploadImageSize,t.HTTPRequestswithCredentials=e.HTTPRequestswithCredentials,t.onPercent=function(t){e._OnPercentDone(t)},t.onHttpUploadStatus=function(t){Et.isFunction(e.__OnHttpUploadStatus)&&e.__OnHttpUploadStatus(t)},t}},{key:"SetUploadSegment",value:function(e,t){var r=this;return r._resetErr(),!!r._isValid()&&(!Et.isNumber(e)||e<0?(kw(r,-2367,"Invalid value for the parameter segmentUploadThreshold."),!1):!Et.isNumber(t)||t<=0?(function(e){kw(e,-2368,"Invalid value for the parameter moduleSize.")}(r),!1):(r._segementUploadThreshold=1024*e*1024,r._moduleSize=1024*t,!0))}},{key:"ConvertToBase64",value:function(e,t,r,n){var i=this;if(i._resetErr(),!i._isValid())return!1;var o=[],a=arguments,s=parseInt(t);if(!bP.checkProductKey(i,{Core:!0}))return Et.isFunction(n)&&n(i._errorCode,i._getErrorString()),!1;if(!i._checkIndices(e))return Et.isFunction(n)&&PF(n,i,e,t,a),!1;if(s==xt.DWT.EnumDWT_ImageType.IT_BMP||s==xt.DWT.EnumDWT_ImageType.IT_JPG||s==xt.DWT.EnumDWT_ImageType.IT_PNG){if(e.length>1)return kw(i,-2361,"You cannot convert more than one image to base64 string when the format is BMP, JPG or PNG."),Et.isFunction(n)&&PF(n,i,e,t,a),!1}else if(s!=xt.DWT.EnumDWT_ImageType.IT_TIF&&s!=xt.DWT.EnumDWT_ImageType.IT_PDF)return sE(i),Et.isFunction(n)&&PF(n,i,e,t,a),!1;Et.isArray(e)&&Et.each(e,(function(e){var t=i._ImgManager.convertClientIndexToServerId(e);-1!=t&&o.push(t)}));return bt.cancelFrom=aG.ConvertToBlob,i._convertToBase64ByServerIdsWithUI("ConvertToBase64",o,s,!1,3,(function(e){var n=[];return Et.isArray(o)&&Et.each(o,(function(e){var t=i._ImgManager.convertServerIdToClientIndex(e);t>-1&&n.push(t)})),Et.isFunction(r)&&AF(r,e,n,t,a),!1}),(function(){var e=[];return Et.isArray(o)&&Et.each(o,(function(t){var r=i._ImgManager.convertServerIdToClientIndex(t);r>-1&&e.push(r)})),Et.isFunction(n)&&PF(n,i,e,t,a),!1}))}},{key:"ClearAllHTTPFormField",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&(e.httpFormFields={},!0)}},{key:"SetHTTPFormField",value:function(e,t,r){var n=this;if(n._resetErr(),!n._isValid())return!1;var i=e;return Et.isString(i)||(i=""+i),t instanceof Blob&&(t.name=r),n.httpFormFields[i]=t,!0}},{key:"HTTPDownloadThroughPost",value:function(e,t,r,n,i,o){var a,s,u=this,c=u._GetHttpHeadersAndClear(),l=yF.combineUrl(u,e,t);if(l===undefined)return Qw(u),iC;if(!bP.checkProductKey(u,{Core:!0}))return Et.isFunction(i)&&kF(i,u,""),iC;if(!bP.checkPDFProductKeyWhenNeeds(u,r))return Et.isFunction(i)&&kF(i,u,""),iC;bt.cancelFrom=aG.HTTPDownload,u.IfShowProgressBar?bt.showProgress(u,"HttpDownloadThroughPost",!1):bt.hideProgress();var d=oC;u._OnPercentDone([0,-1,fx.Downloading,"http"]),Et.isFunction(n)||(d=iC);var f=null===(a=bt.progressContext)||void 0===a?void 0:a.IfShowCancelDialogWhenImageTransfer,h=function(){u.IfShowProgressBar&&bt.closeProgress(null,"HttpDownloadThroughPost"),Et.isFunction(n)&&n()},g=function(){bt.progressContext&&(bt.progressContext.IfShowCancelDialogWhenImageTransfer=f),u.IfShowProgressBar&&bt.closeProgress(null,"HttpDownloadThroughPost"),Et.isFunction(i)&&kF(i,u,u.__HTTPPostResponseString)};return bt.progressContext&&(bt.progressContext.IfShowCancelDialogWhenImageTransfer=!0),s=yF.loadHttpBlob(u,"post",l,d,(function(e){bt.progressContext&&(bt.progressContext.IfShowCancelDialogWhenImageTransfer=f),u._OnPercentDone([0,-1,fx.Loading]);var t=r;t!=xt.DWT.EnumDWT_ImageType.IT_BMP&&t!=xt.DWT.EnumDWT_ImageType.IT_JPG&&t!=xt.DWT.EnumDWT_ImageType.IT_TIF&&t!=xt.DWT.EnumDWT_ImageType.IT_PNG&&t!=xt.DWT.EnumDWT_ImageType.IT_PDF&&t!=xt.DWT.EnumDWT_ImageType.IT_J2K&&(t=-1);var n=u.__GetLoadEventsNum();u.__LoadImageFromBytesV1(e,t,"",n,d,h,g)}),g,(function(e){var t=0===e.total?100:Math.round(100*e.loaded/e.total);[e.loaded," / ",e.total].join(""),t>=100&&e.loaded<e.total&&(t=99),u._OnPercentDone([0,t,"","http"])}),c),s}},{key:"HTTPDownloadThroughGet",value:function(e,t,r,n,i){return this._innerHTTPDownloadThroughGet("HTTPDownload",e,t,r,n,i)}},{key:"HTTPUploadThroughPut",value:function(e,t,r,n,i){var o=yF.getImageType(r);return this.HTTPUploadThroughPutEx(e,t,r,o,n,i)}},{key:"HTTPUploadThroughPutEx",value:function(e,t,r,n,i,o){var a=this,s=a._GetHttpHeadersAndClear(),u="HTTPUploadThroughPutEx",c=yF.combineUrl(a,e,r),l=!0,d=[],f=!1,h=this.IfShowProgressBar;if(c===undefined)return Qw(a),Et.isFunction(o)&&PF(o,a,"",[t],r,n),!1;Et.isFunction(i)||(l=!1),bt.cancelFrom=aG.HTTPPut;var g,p=function(){return bt.needShowTwiceShowDialog=!1,h&&bt.closeProgress(null,u),Et.isFunction(o)&&PF(o,a,a.__HTTPPostResponseString,d,r,n),!1};switch(bt.needShowTwiceShowDialog=!0,h?bt.showProgress(a,u,!1):bt.hideProgress(),t){case-1:for(var m=0;m<a._ImgManager.count();m++)d.push(m);break;case-2:d=a._ImgManager.getSelectedClientIndexArray();break;default:if(d.push(t),!(t>=0))return oE(a),p()}if(""===e)return Lw(a),p();var _=[];Et.isArray(d)&&Et.each(d,(function(e){var t=a._ImgManager.convertClientIndexToServerId(e);-1!=t&&_.push(t)}));a._OnPercentDone([0,-1,fx.Encoding,"http"]);var v=function(e,t,o){if(xt.DWT.IfAddMD5InUploadHeader&&t&&""!=t&&(s["dwt-md5"]=t),bt.needShowTwiceShowDialog=!1,e&&(!h||h&&bt.dlgRef>0||0==l)){var d=a.__maxUploadImageSize;return e.size>d&&-1!=d?(Jw(a),p()):(g=function(e){var t=0===e.total?100:Math.round(100*e.loaded/e.total);[e.loaded," / ",e.total].join(""),t>=100&&e.loaded<e.total&&(t=99),a._OnPercentDone([0,t,"","http"])},a._OnPercentDone([0,-1,fx.Uploading,"http"]),h&&_G(a.__IfShowCancelDialogWhenImageTransfer),bt.cancelFrom=aG.HTTPPut,f=yF.httpPutImage(a,c,e,l,(function(e){if(e&&(a.__HTTPPostResponseString=e),h&&bt.closeProgress(null,u),Et.isFunction(i)){var t=[];Et.isArray(_)&&Et.each(_,(function(e){var r=a._ImgManager.convertServerIdToClientIndex(e);r>-1&&t.push(r)})),AF(i,a.__HTTPPostResponseString,t,r,n)}return!0}),p,g),e=null,f)}return e=null,h&&bt.closeProgress(null,u),!1};return l?(a._convertToBlobForUpload(n,_,false,4,v,p),f=!0):f=a._dwtConvertToBlobSync(n,_,false,v,p),f}},{key:"HTTPUploadAllThroughPutAsMultiPageTIFF",value:function(e,t,r,n){return this.HTTPUploadThroughPutEx(e,-1,t,2,r,n)}},{key:"HTTPUploadThroughPutAsMultiPageTIFF",value:function(e,t,r,n){return this.HTTPUploadThroughPutEx(e,-2,t,2,r,n)}},{key:"HTTPUploadAllThroughPutAsPDF",value:function(e,t,r,n){return this.HTTPUploadThroughPutEx(e,-1,t,4,r,n)}},{key:"HTTPUploadThroughPutAsMultiPagePDF",value:function(e,t,r,n){return this.HTTPUploadThroughPutEx(e,-2,t,4,r,n)}},{key:"GetSelectedImagesSize",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return!1;var r=CF(t);return t._innerFun("GetSelectedImagesSize",Rx(e,r.join(",")))}},{key:"SetHTTPHeader",value:function(e,t){var r=this;if(r._resetErr(),!r._isValid())return!1;var n,i,o=e;if(r.__httpHeaderMap||(r.__httpHeaderMap={}),!o||!Et.isString(o))return Et.isUndefined(o)?kw(r,-2356,"The header name cannot be undefined."):""===o?function(e){kw(e,-2354,"The header name cannot be empty.")}(r):null===o?function(e){kw(e,-2355,"The header name cannot be null.")}(r):function(e){kw(e,-2357,"The header name you entered is invalid.")}(r),!1;for(n=["if-modified-since","if-none-match","if-range","range","accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"],o=o.toLowerCase(),i=0;i<n.length;i++)if(n[i]==o)return nE(r),!1;return Et.isUndefined(t)||null===t||""===t?(e in r.__httpHeaderMap&&delete r.__httpHeaderMap[e],!0):(Et.isNumber(t)&&(t=""+t),r.__httpHeaderMap[e]=t,!0)}},{key:"ConvertToBlob",value:function(e,t,r,n,i){return this._convertToBlobByIndices(e,t,r,n,i)}},{key:"_asyncUploadFilesCmd",value:function(e,t,r,n,i,o,a,s,u,c,l,d){var f=this,h=parseInt(i),g="HTTPUpload",p=e,m=!0,_=[];f.__HTTPPostResponseString="",bt.cancelFrom=aG.HTTPUpload;var v=function(e,r,n){var i=[];if(Et.isArray(t)&&Et.each(t,(function(e){var t=f._ImgManager.convertServerIdToClientIndex(e);t>-1&&i.push(t)})),0!=e&&r&&(f._errorCode=e,f._errorString=r),n&&(f.__HTTPPostResponseString=n),f._bServerPercentDone=!0,bt.needShowTwiceShowDialog=!1,s&&bt.closeProgress(null,g),_.slice(0),_=null,Et.isFunction(d))try{d({code:f._errorCode,message:f._errorString,response:n,indices:i})}catch(o){}return!1};bt.needShowTwiceShowDialog=!0,s?bt.showProgress(f,g,!1):bt.hideProgress();var y=t.length,I=0,S=0,T="";return f._bServerPercentDone=!1,f._OnPercentDone([0,-1,fx.Encoding,"http"]),Et.each(t,(function(e,i){f._convertToBlobForUpload(h,[e],a,4,(function(e,a,d){if(!e||e.size<=0)return zw(f),v(f._errorCode,f._errorString);var h=f.__maxUploadImageSize;if(e.size>h&&-1!=h)return Jw(f),v(f._errorCode,f._errorString);var b=hG(o,i+1);if(S=(I+1)/y*100,T=[I+1,"/",y].join(""),f._OnPercentDone([0,S,T,"http",b]),e.name=b,_.push(e),++I>=y){xt.DWT.IfAddMD5InUploadHeader&&a&&""!=a&&(r["dwt-md5"]=a);var C=f._createHttpUploaderConfig(),w=new IG;f.__remoteFilename&&""!=f.__remoteFilename&&(w.remoteFilename=f.__remoteFilename),w.url=p,w.method=g,w.content=_,w.contentType=f._strHttpContentTypeFieldValue,w.headers=r,w.httpFormData=n,w.retry=u,w.bOnlyResponseEmptyIsOK=c,w.blockSize=f._moduleSize,m=mG(C,w,(function(e){f.__HTTPPostResponseString=C.HTTPPostResponse,function(e){if(f._bServerPercentDone=!0,bt.needShowTwiceShowDialog=!1,s&&bt.closeProgress(null,g),_.slice(0),_=null,Et.isFunction(l)){var r=[];Et.isArray(t)&&Et.each(t,(function(e){var t=f._ImgManager.convertServerIdToClientIndex(e);t>-1&&r.push(t)})),AF(l,e,r)}}(e)}),v)}e=null}),v,[e,i])})),m}},{key:"_getVersionInfoAsync",value:function(){return Cw.versionInfoFromServer?tC.Promise.resolve(Cw.versionInfoFromServer):this._innerFunV2("VersionInfo")}},{key:"__innerLoadImage",value:function(e,t,r,n,i,o,a){var s=this;if(!bP.checkProductKey(s,{Core:!0}))return Et.isFunction(a)&&a(s._errorCode,s._getErrorString()),!1;if(!bP.checkPDFProductKeyWhenNeeds(s,r))return Et.isFunction(a)&&a(s._errorCode,s._getErrorString()),!1;if(Et.isFunction(o)||xt.DWT.ConnectWithSocket){if(s._bRemoteMode&&s._getIfShowFileDialog())return EE(s),{code:s._errorCode,message:s._getErrorString()};var u=s.IfShowCancelDialogWhenImageTransfer;return s.IfShowCancelDialogWhenImageTransfer=!1,s.__innerAcquireOrLoadImageAsync(e,t,n,!0).then((function(){s.IfShowCancelDialogWhenImageTransfer=u,o()}),(function(e){s.IfShowCancelDialogWhenImageTransfer=u,s._errorCode=e.code,s._errorString=e.message,a(e)})),!0}if(s._bRemoteMode&&s._getIfShowFileDialog())return EE(s),{code:s._errorCode,message:s._getErrorString()};var c=s._getCurrentDocumentName();return s.__innerLoadImageFun(e,t,i,c)}},{key:"__innerLoadImageFun",value:function(e,t,r,n){var i,o=this,a=!0;if(i=o._innerFunRaw(e,t,!1,!1,!0),o.__bOpenFileNow=!1,Et.isArray(i.result)&&i.result.length>0){var s="",u=[];if(r){var c=i.result[0];Et.isObject(c)?(s=c.ids,u=c.metaData):-1!=c||"LoadImage"!=e&&"LoadImageEx"!=e&&"FTPDownloadEx"!=e&&"FTPDownload"!=e&&"LoadImageFromBase64Binary"!=e||(a=!1)}else s=i.result.join(",");if(a)return Et.isArray(u)||(u=[]),o._OnBitmapChanged(["c2",s,1,o._ImgManager.getCurrentImageIndex(),o._ImgManager.count(),u],null,n),o._blts&&xt.DWT.lcvrf(o),!0}return zE(o._errorCode)&&$w(o),!1}},{key:"__innerSaveImage",value:function(e,t,r,n){var i,o=this;if(o._OnPercentDone([0,-1,fx.Encoding]),o._bRemoteMode||(xt.DWT.IfAlwaysFocusOnPopupWindow?o._OnPageFocus(!0):o._OnPageBlur(!0)),!Et.isFunction(n))return o._bRemoteMode?o._serviceSyncMethodNotSupport(e):this._innerFun(e,t);if(o._bRemoteMode&&o._getIfShowFileDialog())return EE(o),{code:o._errorCode,message:o._getErrorString()};var a=null===(i=bt.progressContext)||void 0===i?void 0:i.IfShowCancelDialogWhenImageTransfer;return o.IfShowProgressBar?bt.showProgress(o,e,!1):bt.hideProgress(),bt.progressContext&&(bt.progressContext.IfShowCancelDialogWhenImageTransfer=!1),this._innerSend(e,t,!0,(function(){bt.progressContext&&(bt.progressContext.IfShowCancelDialogWhenImageTransfer=a),bt.closeProgress(null,e),Et.isFunction(r)&&r()}),(function(t){return bt.progressContext&&(bt.progressContext.IfShowCancelDialogWhenImageTransfer=a),Et.isFunction(n)&&n(o._errorCode,o._getErrorString()),bt.closeProgress(null,e),t&&Et.error(t),!0})),!0}},{key:"__captureImage",value:function(e,t,r,n){var i=this.__GetLoadEventsNum();return this.__LoadImageFromBytesV2(e,t,"",!0,0,0,!0,i,r,n)}},{key:"_getIfShowFileDialog",value:function(){return this._resetErr(),this._isValid()?this._innerFun("IfShowFileDialog"):iC}},{key:"SaveAsBMP",value:function(e,t,r,n){var i=this;if(i._resetErr(),!i._isValid())return!1;if(!(bP.checkProductKey(i,{Core:!0})||K.bWin&&bP.checkProductKey(i,{Webcam:!0},!0)))return bP.checkProductKey(i,{Core:!0},!1),Et.isFunction(n)&&n(i._errorCode,i._getErrorString()),!1;var o,a=yF.replaceLocalFilename(e);if(!bF(i,t,n))return!1;if(K.bAndroid){if(0==i._ImgManager.count())return Ww(i),Et.isFunction(n)&&n(i._errorCode,i._getErrorString()),!1;var s=[];return s.push(t),i._saveImages("SaveAsBMP",a,s,xD.IT_BMP).then((function(){Et.isFunction(r)&&r()}))["catch"]((function(e){Et.isFunction(n)&&n(e.code,e.message)})),!0}if(-1==(o=i._ImgManager.convertClientIndexToServerId(t)))return oE(i),Et.isFunction(n)&&kF(n,i),!1;var u=i.__GetLoadEventsNum();return i.__innerSaveImage("SaveAsBMP",Rx(a,o,u),r,n)}},{key:"SaveAsJPEG",value:function(e,t,r,n){var i=this;if(i._resetErr(),!i._isValid())return!1;if(!(bP.checkProductKey(i,{Core:!0})||K.bWin&&bP.checkProductKey(i,{Webcam:!0},!0)))return bP.checkProductKey(i,{Core:!0},!1),Et.isFunction(n)&&n(i._errorCode,i._getErrorString()),!1;if(!bF(i,t,n))return!1;var o,a=yF.replaceLocalFilename(e);if(K.bAndroid){if(0==i._ImgManager.count())return Ww(i),Et.isFunction(n)&&n(i._errorCode,i._getErrorString()),!1;var s=[];return s.push(t),i._saveImages("SaveAsJPEG",a,s,xD.IT_JPG).then((function(){Et.isFunction(r)&&r()}))["catch"]((function(e){Et.isFunction(n)&&n(e.code,e.message)})),!0}if(-1==(o=i._ImgManager.convertClientIndexToServerId(t)))return oE(i),Et.isFunction(n)&&kF(n,i),!1;var u=i.__GetLoadEventsNum();return i.__innerSaveImage("SaveAsJPEG",Rx(a,o,u),r,n)}},{key:"SaveAsPDF",value:function(e,t,r,n){var i=this;if(i._resetErr(),!i._isValid())return!1;if(!(bP.checkProductKey(i,{Core:!0})||K.bWin&&bP.checkProductKey(i,{Webcam:!0},!0)))return bP.checkProductKey(i,{Core:!0},!1),Et.isFunction(n)&&n(i._errorCode,i._getErrorString()),!1;if(!bF(i,t,n))return!1;var o,a=yF.replaceLocalFilename(e);if(K.bAndroid){if(0==i._ImgManager.count())return Ww(i),Et.isFunction(n)&&n(i._errorCode,i._getErrorString()),!1;var s=[];return s.push(t),i._saveImages("SaveAsPDF",a,s,xD.IT_PDF).then((function(){Et.isFunction(r)&&r()}))["catch"]((function(e){Et.isFunction(n)&&n(e.code,e.message)})),!0}if(-1==(o=i._ImgManager.convertClientIndexToServerId(t)))return oE(i),Et.isFunction(n)&&kF(n,i),!1;var u=i.__GetLoadEventsNum();return i.__innerSaveImage("SaveAsPDF",Rx(a,o,u),r,n)}},{key:"SaveAsPNG",value:function(e,t,r,n){var i=this;if(i._resetErr(),!i._isValid())return!1;if(!(bP.checkProductKey(i,{Core:!0})||K.bWin&&bP.checkProductKey(i,{Webcam:!0},!0)))return bP.checkProductKey(i,{Core:!0},!1),Et.isFunction(n)&&n(i._errorCode,i._getErrorString()),!1;if(!bF(i,t,n))return!1;var o,a=yF.replaceLocalFilename(e);if(K.bAndroid){if(0==i._ImgManager.count())return Ww(i),Et.isFunction(n)&&n(i._errorCode,i._getErrorString()),!1;var s=[];return s.push(t),i._saveImages("SaveAsPNG",a,s,xD.IT_PNG).then((function(){Et.isFunction(r)&&r()}))["catch"]((function(e){Et.isFunction(n)&&n(e.code,e.message)})),!0}if(-1==(o=i._ImgManager.convertClientIndexToServerId(t)))return oE(i),Et.isFunction(n)&&kF(n,i),!1;var u=i.__GetLoadEventsNum();return i.__innerSaveImage("SaveAsPNG",Rx(a,o,u),r,n)}},{key:"SaveAsTIFF",value:function(e,t,r,n){var i=this;if(i._resetErr(),!i._isValid())return!1;if(!(bP.checkProductKey(i,{Core:!0})||K.bWin&&bP.checkProductKey(i,{Webcam:!0},!0)))return bP.checkProductKey(i,{Core:!0},!1),Et.isFunction(n)&&n(i._errorCode,i._getErrorString()),!1;if(!bF(i,t,n))return!1;var o,a=yF.replaceLocalFilename(e);if(K.bAndroid){if(0==i._ImgManager.count())return Ww(i),Et.isFunction(n)&&n(i._errorCode,i._getErrorString()),!1;var s=[];return s.push(t),i._saveImages("SaveAsTIFF",a,s,xD.IT_TIF).then((function(){Et.isFunction(r)&&r()}))["catch"]((function(e){Et.isFunction(n)&&n(e.code,e.message)})),!0}if(-1==(o=i._ImgManager.convertClientIndexToServerId(t)))return oE(i),Et.isFunction(n)&&kF(n,i),!1;var u=i.__GetLoadEventsNum();return i.__innerSaveImage("SaveAsTIFF",Rx(a,o,u),r,n)}},{key:"SaveSelectedImagesAsMultiPagePDF",value:function(e,t,r){var n=this;if(n._resetErr(),!n._isValid())return!1;if(!(bP.checkProductKey(n,{Core:!0})||K.bWin&&bP.checkProductKey(n,{Webcam:!0},!0)))return bP.checkProductKey(n,{Core:!0},!1),Et.isFunction(r)&&r(n._errorCode,n._getErrorString()),!1;var i=yF.replaceLocalFilename(e);if(K.bAndroid){if(0==n._ImgManager.count())return Ww(n),Et.isFunction(r)&&r(n._errorCode,n._getErrorString()),!1;var o=wF(n);return n._saveImages("SaveSelectedImagesAsMultiPagePDF",i,o,xD.IT_PDF).then((function(){Et.isFunction(t)&&t()}))["catch"]((function(e){Et.isFunction(r)&&r(e.code,e.message)})),!0}var a=CF(n),s=n.__GetLoadEventsNum();return n.__innerSaveImage("SaveSelectedImagesAsMultiPagePDF",Rx(i,a.join(","),s),t,r)}},{key:"SaveSelectedImagesAsMultiPageTIFF",value:function(e,t,r){var n=this;if(n._resetErr(),!n._isValid())return!1;if(!(bP.checkProductKey(n,{Core:!0})||K.bWin&&bP.checkProductKey(n,{Webcam:!0},!0)))return bP.checkProductKey(n,{Core:!0},!1),Et.isFunction(r)&&r(n._errorCode,n._getErrorString()),!1;var i=yF.replaceLocalFilename(e);if(K.bAndroid){if(0==n._ImgManager.count())return Ww(n),Et.isFunction(r)&&r(n._errorCode,n._getErrorString()),!1;var o=wF(n);return n._saveImages("SaveSelectedImagesAsMultiPageTIFF",i,o,xD.IT_TIF).then((function(){Et.isFunction(t)&&t()}))["catch"]((function(e){Et.isFunction(r)&&r(e.code,e.message)})),!0}var a=CF(n),s=n.__GetLoadEventsNum();return n.__innerSaveImage("SaveSelectedImagesAsMultiPageTIFF",Rx(i,a.join(","),s),t,r)}},{key:"SaveAllAsMultiPageTIFF",value:function(e,t,r){var n=this;if(n._resetErr(),!n._isValid())return!1;if(!(bP.checkProductKey(n,{Core:!0})||K.bWin&&bP.checkProductKey(n,{Webcam:!0},!0)))return bP.checkProductKey(n,{Core:!0},!1),Et.isFunction(r)&&r(n._errorCode,n._getErrorString()),!1;if(!TF(n,r))return!1;var i=[],o=yF.replaceLocalFilename(e);if(K.bAndroid){if(0==n._ImgManager.count())return Ww(n),Et.isFunction(r)&&r(n._errorCode,n._getErrorString()),!1;for(var a=[],s=0;s<this._ImgManager.count();s++)a.push(s);return n._saveImages("SaveAllAsMultiPageTIFF",o,a,xD.IT_TIF).then((function(){Et.isFunction(t)&&t()}))["catch"]((function(e){Et.isFunction(r)&&r(e.code,e.message)})),!0}SF(n,i);var u=n.__GetLoadEventsNum();return n.__innerSaveImage("SaveSelectedImagesAsMultiPageTIFF",Rx(o,i.join(","),u),t,r)}},{key:"SaveAllAsPDF",value:function(e,t,r){var n=this;if(n._resetErr(),!n._isValid())return!1;if(!(bP.checkProductKey(n,{Core:!0})||K.bWin&&bP.checkProductKey(n,{Webcam:!0},!0)))return bP.checkProductKey(n,{Core:!0},!1),Et.isFunction(r)&&r(n._errorCode,n._getErrorString()),!1;if(!TF(n,r))return!1;var i=[],o=yF.replaceLocalFilename(e);if(K.bAndroid){if(0==n._ImgManager.count())return Ww(n),Et.isFunction(r)&&r(n._errorCode,n._getErrorString()),!1;for(var a=[],s=0;s<this._ImgManager.count();s++)a.push(s);return n._saveImages("SaveAllAsPDF",o,a,xD.IT_PDF).then((function(){Et.isFunction(t)&&t()}))["catch"]((function(e){Et.isFunction(r)&&r(e.code,e.message)})),!0}SF(n,i);var u=n.__GetLoadEventsNum();return n.__innerSaveImage("SaveSelectedImagesAsMultiPagePDF",Rx(o,i.join(","),u),t,r)}},{key:"HTTPUpload",value:function(e,t,r,n,i,o,a){var s=this,u=null!=i?i:"RemoteFile",c=s._GetHttpHeadersAndClear(),l=o,d=a;if(s._resetErr(),!s._isValid())return!1;if(arguments.length<=3)return l=t,d=r,this._innerFormFieldHTTPUpload(e,c,l,d);Et.isFunction(arguments[4])&&Et.isFunction(arguments[5])&&(u="RemoteFile",l=arguments[4],arguments.length>5&&(d=arguments[5]));var f,h=arguments,g=function(e){Et.isFunction(d)&&PF(d,s,s.__HTTPPostResponseString,e,h)};if(Et.isUndefined(e)||""===e)return Qw(s),g&&g(t),!1;if(!Et.isString(e))return cE(s),g&&g(t),!1;if(!s._checkIndices(t))return g&&g(t),!1;var p=[];if(Et.isArray(t)&&Et.each(t,(function(e){var t=s._imageBufferWrapper.convertClientIndexToServerId(e);-1!=t&&p.push(t)})),0==p.length)return Dw(s),g&&g(t),!1;if(Et.isUndefined(r))return sE(s),g&&g(t),!1;if(r==xt.DWT.EnumDWT_ImageType.IT_BMP||r==xt.DWT.EnumDWT_ImageType.IT_JPG||r==xt.DWT.EnumDWT_ImageType.IT_PNG){if(p.length>1)return tE(s),g(t),!1}else if(r!=xt.DWT.EnumDWT_ImageType.IT_TIF&&r!=xt.DWT.EnumDWT_ImageType.IT_PDF)return sE(s),g(t),!1;return Et.isUndefined(n)||n!=xt.DWT.EnumDWT_UploadDataFormat.Binary&&n!=xt.DWT.EnumDWT_UploadDataFormat.Base64?(uE(s),g(t),!1):(f={method:"HTTPUpload",url:e,serverIds:p,headers:c,formData:uj(s.httpFormFields),enumImageType:r,saveSetup:!1,dataFormat:n,fileName:u,retry:0,bOnlyResponseEmptyIsOK:!0,objUploadFileStatus:!1,asyncSuccessFunc:function(e,t){Et.isFunction(l)&&AF(l,s.__HTTPPostResponseString,t,h)},asyncFailureFunc:g},this._asyncUploadCmd(f),!0)}},{key:"_innerFormFieldHTTPUpload",value:function(e,t,r,n){var i,o=this,a="HTTPUpload",s=e,u=o.IfShowProgressBar;if(o.__HTTPPostResponseString="",i=function(e,t,r){return 0!=e&&t&&(o._errorCode=e,o._errorString=t),r&&(o.__HTTPPostResponseString=r),bt.needShowTwiceShowDialog=!1,bt.closeProgress(null,a),Et.isFunction(n)&&PF(n,o,o.__HTTPPostResponseString),!1},Et.isUndefined(s)||""===s)return Qw(o),i(o._errorCode,o._getErrorString()),!1;if(!Et.isString(s))return cE(o),i(o._errorCode,o._getErrorString()),!1;0!=s.indexOf("http://")&&0!=s.indexOf("https://")&&(s=bt.detect.ssl?"https://"+s:"http://"+s),o.__HTTPPostResponseString="",bt.cancelFrom=aG.HTTPUpload,u?bt.showProgress(o,a,!1):bt.hideProgress(),bt.needShowTwiceShowDialog=!0,o._OnPercentDone([0,-1,fx.Uploading,"http"]);var c=o._createHttpUploaderConfig(),l=new IG;return o.__remoteFilename&&""!=o.__remoteFilename&&(l.remoteFilename=o.__remoteFilename),l.url=s,l.method=a,l.content=[],l.headers=t,l.httpFormData=uj(o.httpFormFields),l.blockSize=o._moduleSize,(new yG).httpPostUpload(c,l,(function(t){bt.needShowTwiceShowDialog=!1,bt.closeProgress(null,a),Et.isFunction(r)&&AF(r,t,e,[e,r,n])}),i)}},{key:"HTTPUploadThroughPost",value:function(e,t,r,n,i,o,a){var s=this;if(s._resetErr(),!s._isValid())return!1;var u=yF.getImageType(n),c=arguments,l=!1,d=function(e){return Et.isFunction(o)&&PF(o,s,s.__HTTPPostResponseString,e,c),!1};return Et.isString(n)&&""!=n?(i&&Et.isFunction(i)&&(l=function(e,t){return AF(i,s.__HTTPPostResponseString,t,c),!0}),!!sj(s,t,u,d)&&qG(s,YG,rj).call(s,e,t,r,n,u,l,d,a)):(zw(s),d())}},{key:"HTTPUploadThroughPostEx",value:function(e,t,r,n,i,o,a,s){var u=this;if(u._resetErr(),!u._isValid())return!1;var c=arguments,l=!1,d=function(e){return Et.isFunction(a)&&PF(a,u,u.__HTTPPostResponseString,e,c),!1};return Et.isString(n)&&""!=n?(o&&Et.isFunction(o)&&(l=function(e,t){return AF(o,u.__HTTPPostResponseString,t,c),!0}),!!sj(u,t,i,d)&&qG(u,YG,rj).call(u,e,t,r,n,i,l,d,s)):(zw(u),d())}},{key:"HTTPUploadAllThroughPostAsMultiPageTIFF",value:function(e,t,r,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return!1;var s=arguments,u=!1,c=function(e){return Et.isFunction(i)&&PF(i,a,a.__HTTPPostResponseString,e,s),!1};return Et.isString(r)&&""!=r?(n&&Et.isFunction(n)&&(u=function(e,t){return AF(n,a.__HTTPPostResponseString,t,s),!0}),qG(a,YG,rj).call(a,e,-1,t,r,2,u,c,o)):(zw(a),c())}},{key:"HTTPUploadAllThroughPostAsPDF",value:function(e,t,r,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return!1;var s=arguments,u=!1,c=function(e){return Et.isFunction(i)&&PF(i,a,a.__HTTPPostResponseString,e,s),!1};return Et.isString(r)&&""!=r?(n&&Et.isFunction(n)&&(u=function(e,t){return AF(n,a.__HTTPPostResponseString,t,s),!0}),qG(a,YG,rj).call(a,e,-1,t,r,4,u,c,o)):(zw(a),c())}},{key:"HTTPUploadThroughPostAsMultiPagePDF",value:function(e,t,r,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return!1;var s=arguments,u=!1,c=function(e){return Et.isFunction(i)&&PF(i,a,a.__HTTPPostResponseString,e,s),!1};return Et.isString(r)&&""!=r?(n&&Et.isFunction(n)&&(u=function(e,t){return AF(n,a.__HTTPPostResponseString,t,s),!0}),qG(a,YG,rj).call(a,e,-2,t,r,4,u,c,o)):(zw(a),c())}},{key:"HTTPUploadThroughPostAsMultiPageTIFF",value:function(e,t,r,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return!1;var s=arguments,u=!1,c=function(e){return Et.isFunction(i)&&PF(i,a,a.__HTTPPostResponseString,e,s),!1};return Et.isString(r)&&""!=r?(n&&Et.isFunction(n)&&(u=function(e,t){return AF(n,a.__HTTPPostResponseString,t,s),!0}),qG(a,YG,rj).call(a,e,-2,t,r,2,u,c,o)):(zw(a),c())}},{key:"_innerHTTPDownloadThroughGet",value:function(e,t,r,n,i,o){var a,s,u=this,c=u._GetHttpHeadersAndClear(),l=u.IfShowProgressBar,d=yF.combineUrl(u,t,r);if(d===undefined)return Qw(u),Et.isFunction(o)&&kF(o,u),iC;if(!bP.checkProductKey(u,{Core:!0}))return Et.isFunction(o)&&kF(o,u),iC;if(!bP.checkPDFProductKeyWhenNeeds(u,n))return Et.isFunction(o)&&kF(o,u),iC;bt.cancelFrom=aG.HTTPDownload;var f=null===(a=bt.progressContext)||void 0===a?void 0:a.IfShowCancelDialogWhenImageTransfer,h=oC;Et.isFunction(i)||(h=iC);var g=u._getCurrentDocumentName(),p=u._getCurrentDefaultTagName();return Et.log("_innerHTTPDownloadThroughGet.currentFileName:"+g+", tag="+p),l&&h?bt.showProgress(u,e,!1):h&&bt.hideProgress(),u._OnPercentDone([0,-1,fx.Downloading,"http"]),bt.progressContext&&(bt.progressContext.IfShowCancelDialogWhenImageTransfer=!0),s=yF.loadHttpBlob(u,"get",d,h,(function(t){bt.progressContext&&(bt.progressContext.IfShowCancelDialogWhenImageTransfer=f),l&&h&&_G(!1),u._OnPercentDone([0,-1,fx.Loading]);var r=n;r!=xt.DWT.EnumDWT_ImageType.IT_BMP&&r!=xt.DWT.EnumDWT_ImageType.IT_JPG&&r!=xt.DWT.EnumDWT_ImageType.IT_TIF&&r!=xt.DWT.EnumDWT_ImageType.IT_PNG&&r!=xt.DWT.EnumDWT_ImageType.IT_PDF&&r!=xt.DWT.EnumDWT_ImageType.IT_J2K&&(r=-1),t.currentFileName=g,t.currentTagName=p;var a=u.__GetLoadEventsNum();u.__LoadImageFromBytesV1(t,r,"",a,h,(function(){l&&h&&bt.closeProgress(null,e),Et.isFunction(i)&&i()}),(function(){l&&h&&bt.closeProgress(null,e),Et.isFunction(o)&&kF(o,u)}))}),(function(){bt.progressContext&&(bt.progressContext.IfShowCancelDialogWhenImageTransfer=f),l&&h&&bt.closeProgress(null,e),Et.isFunction(o)&&kF(o,u)}),(function(e){var t=0===e.total?100:Math.round(100*e.loaded/e.total);[e.loaded," / ",e.total].join(""),t>=100&&e.loaded<e.total&&(t=99),u._OnPercentDone([0,t,"","http"])}),c),s}},{key:"LoadImage",value:function(e,t,r){var n=this;if(n._resetErr(),!n._isValid())return!1;var i,o,a,s=yF.replaceLocalFilename(e),u=yF.getImageType(s);return t&&Et.isFunction(t)&&(o=function(e){t()}),r&&Et.isFunction(r)&&(a=function(e){r(e.code,e.message)}),i=n.__GetLoadEventsNum(),""==s&&(n.__bOpenFileNow=!0),n.__innerLoadImage("LoadImage",Rx(s,i,1),u,!0,1,o,a)}},{key:"LoadImageEx",value:function(e,t,r,n){var i=this;if(i._resetErr(),!i._isValid())return!1;var o,a,s,u=yF.replaceLocalFilename(e),c=t;if(r&&Et.isFunction(r)&&(a=function(e){r()}),n&&Et.isFunction(n)&&(s=function(e){n(e.code,e.message)}),K.bAndroid){var l=tC.one(".d-loadImage");if(0==l.length){var d=document.createElement("input");d._stwain=i,d.setAttribute("type","file"),d.setAttribute("multiple","multiple"),d.style="position:absolute;top:-2px;left:-2px;width:1px;height:1px;",d.className="d-loadImage",t==xt.DWT.EnumDWT_ImageType.IT_BMP?d.setAttribute("accept","image/bmp"):t==xt.DWT.EnumDWT_ImageType.IT_JPG?d.setAttribute("accept","image/jpeg"):t==xt.DWT.EnumDWT_ImageType.IT_TIF?d.setAttribute("accept","image/tiff"):t==xt.DWT.EnumDWT_ImageType.IT_PNG?d.setAttribute("accept","image/png"):t==xt.DWT.EnumDWT_ImageType.IT_PDF?d.setAttribute("accept",".pdf"):t==xt.DWT.EnumDWT_ImageType.IT_J2K?d.setAttribute("accept",".jp2,.j2k,.j2c"):Ax.bMobile?d.setAttribute("accept","image/jpeg,image/png,image/tiff,image/tif"):d.setAttribute("accept","image/*,.pdf,.jp2,.j2k,.j2c"),d.ondoubleclick=function(){this.files.length>0&&this._stwain.LoadImageFromBinary(this.files,a,s),this.value="",this._stwain=null,d&&d.parentElement.removeChild(d)},d.onchange=function(){this.files.length>0&&this._stwain.LoadImageFromBinary(this.files,a,s),this.value="",this._stwain=null,d&&d.parentElement.removeChild(d)},document.body.appendChild(d),d.click()}else t==xt.DWT.EnumDWT_ImageType.IT_BMP?l[0].setAttribute("accept","image/bmp"):t==xt.DWT.EnumDWT_ImageType.IT_JPG?l[0].setAttribute("accept","image/jpeg"):t==xt.DWT.EnumDWT_ImageType.IT_TIF?l[0].setAttribute("accept","image/tiff"):t==xt.DWT.EnumDWT_ImageType.IT_PNG?l[0].setAttribute("accept","image/png"):t==xt.DWT.EnumDWT_ImageType.IT_PDF?l[0].setAttribute("accept",".pdf"):t==xt.DWT.EnumDWT_ImageType.IT_J2K?l[0].setAttribute("accept",".jp2,.j2k,.j2c"):Ax.bMobile?l[0].setAttribute("accept","image/jpeg,image/png,image/tiff,image/tif"):l[0].setAttribute("accept","image/*,.pdf,.jp2,.j2k,.j2c"),l[0].value="",l[0]._stwain=i,l[0].click();return!0}c==xt.DWT.EnumDWT_ImageType.IT_ALL&&(c=-1),o=i.__GetLoadEventsNum(),""==u&&(i.__bOpenFileNow=!0);return i.__innerLoadImage("LoadImageEx",Rx(u,c,o,1),c,!0,1,a,s)}},{key:"HTTPDownload",value:function(e,t,r,n){var i=this;if(i._resetErr(),!i._isValid())return tC.Promise.reject({code:i._errorCode,message:i._getErrorString()});var o=yF.getImageType(t);return i._innerHTTPDownloadThroughGet("HTTPDownload",e,t,o,r,n)}},{key:"HTTPDownloadEx",value:function(e,t,r,n,i){var o=this;return o._resetErr(),o._isValid()?o._innerHTTPDownloadThroughGet("HTTPDownloadEx",e,t,r,n,i):tC.Promise.reject({code:o._errorCode,message:o._getErrorString()})}},{key:"getFormateDate",value:function(){var e=new Date,t=e.getFullYear(),r=e.getMonth()+1,n=e.getDate(),i=e.getHours(),o=e.getMinutes(),a=e.getSeconds();return r<=9&&(r="0"+r),n<=9&&(n="0"+n),i<=9&&(i="0"+i),o<=9&&(o="0"+o),a<=9&&(a="0"+a),{currentTime_title:t+"-"+r+"-"+n+" "+i+":"+o+":"+a,currentTime_info:r+"/"+n+"/"+t+" "+i+":"+o+":"+a}}},{key:"__shareImagesInner",value:function(e,t,r,n){var i=navigator;i.canShare&&i.canShare({files:e})&&i.share({files:e,title:t,text:this.getFormateDate().currentTime_info}).then((function(){Et.isFunction(r)&&r()}))["catch"]((function(e){Et.isFunction(n)&&n(e)}))}},{key:"ShareImages",value:(r=eA(g.mark((function a(e,t,r){var n,i,o,s,u,c,l,d,f;return g.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=this,!K.bAndroid){a.next=39;break}if(r!=xD.IT_ALL&&r!=xD.IT_MULTIPAGE_PDF&&r!=xD.IT_MULTIPAGE_TIF){a.next=5;break}throw WE(n),{code:n._errorCode,message:n._errorString};case 5:if(i=t.sort((function(e,t){return e-t})),!(i.length>0)){a.next=37;break}if(o="IMAGE File",r==xD.IT_PDF&&(o="PDF File"),s=gG(e,r),Et.isUndefined(s)&&(s=e),r!=xD.IT_PDF&&r!=xD.IT_TIF){a.next=15;break}return a.abrupt("return",new tC.Promise((function(e,t){n.ConvertToBlob(i,r,(function(r,i,a){var u=[new File([r],s,{type:r.type})];n.__shareImagesInner(u,o,(function(){e()}),(function(e){t({code:0!=e.code?e.code:2201,message:e.message})}))}),(function(){t({code:n._errorCode,message:n._errorString})}))})));case 15:u=[],c=s,a.t0=r,a.next=a.t0===xD.IT_BMP?20:a.t0===xD.IT_JPG?22:a.t0===xD.IT_PNG?24:26;break;case 20:return l=".bmp",a.abrupt("break",27);case 22:return l=".jpg",a.abrupt("break",27);case 24:return l=".png",a.abrupt("break",27);case 26:l=".jpg";case 27:s&&s.lastIndexOf(".")>0&&(c=s.substring(0,s.lastIndexOf(".")),l=s.substring(s.lastIndexOf("."),s.length)),d=g.mark((function h(e){return g.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new tC.Promise((function(t,o){n.ConvertToBlob([i[e]],r,(function(r,n,i){0==e?u.push(new File([r],c+l,{type:r.type})):u.push(new File([r],c+e+l,{type:r.type})),t()}),(function(){o({code:n._errorCode,message:n._errorString})}))}));case 2:case"end":return t.stop()}}),h)})),f=0;case 31:if(!(f<i.length)){a.next=36;break}return a.delegateYield(d(f),"t1",33);case 33:f++,a.next=31;break;case 36:n.__shareImagesInner(u,o);case 37:a.next=41;break;case 39:throw kw(n,-2617,"ShareImages is only supported on Android devices."),{code:n._errorCode,message:n._errorString};case 41:case"end":return a.stop()}}),a,this)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"Addon",get:function(){return this.__addon}},{key:"LoadDibFromClipboard",value:function(e,t){var r,n,i=this;if(i._resetErr(),!i._isValid())return!1;if(i._bRemoteMode)return kw(i,-2609,"LoadDibFromClipboard is not supported when Object is created by CreateRemoteScanObjectAsync."),{code:i._errorCode,message:i._getErrorString()};e&&Et.isFunction(e)&&(r=function(t){e()}),t&&Et.isFunction(t)&&(n=function(e){t(e.code,e.message)});var o;return o=i.__GetLoadEventsNum(),i.__innerLoadImage("LoadDibFromClipboard",Rx(o,1),-1,!0,1,r,n)}},{key:"__innerGetBarcodeResultAsyncFunction",value:function(e){var t=bt.NewBarcodeResult();return e&&(t._errorCode=e.exception,t._errorString=e.description,t._resultlist=e.result,t._Count=e.result.length),t}},{key:"__innerGetOCRResultAsyncFunction",value:function(e){var t=bt.NewOCRResult(this);return e&&(t._errorCode=e.exception,t._errorString=e.description,t._resultlist=e.result),t}},{key:"__innerFTPDownloadDirectly",value:function(e,t,r,n,i){var o=this;return bP.checkProductKey(o,{Core:!0})&&bP.checkPDFProductKeyWhenNeeds(o,r)?(bt.cancelFrom=aG.FTPDownload,qG(o,$G,oj).call(o,e,t,!0,n,i)):(Et.isFunction(i)&&i(o._errorCode,o._errorString),!1)}},{key:"__innerFTPUpload",value:function(e,t,r,n){return bt.cancelFrom=aG.FTPUpload,qG(this,$G,oj).call(this,e,t,!0,r,n)}},{key:"_GetHttpHeadersAndClear",value:function(){var e=this.__httpHeaderMap;return this.__httpHeaderMap={},e||(e={}),e}},{key:"_asyncUploadCmd",value:function(e){var t,r=this,n=e.url,i=e.asyncSuccessFunc,a=e.asyncFailureFunc,s=r.IfShowCancelDialogWhenImageTransfer,u=null===(t=bt.progressContext)||void 0===t?void 0:t.IfShowCancelDialogWhenImageTransfer,c=e.method,l=e.serverIds,d=e.headers,f=e.formData,h=e.enumImageType,g=e.dataFormat,p=e.fileName,m=e.saveSetup,_=e.retry,v=e.bOnlyResponseEmptyIsOK,y=e.objUploadFileStatus,I=function(e,t,n){r.IfShowCancelDialogWhenImageTransfer=s,bt.progressContext&&(bt.progressContext.IfShowCancelDialogWhenImageTransfer=u);var i=[];if(Et.isArray(l)&&Et.each(l,(function(e){var t=r._ImgManager.convertServerIdToClientIndex(e);t>-1&&i.push(t)})),0!=e&&t&&(r._errorCode=e,r._errorString=t),n&&(r.__HTTPPostResponseString=n),Et.isFunction(a))try{a(i)}catch(o){}return!1};return Et.isNumber(_)&&_>0||(_=0),0!=r._errorCode?I(r._errorCode,r._errorString,r.__HTTPPostResponseString):(r.__HTTPPostResponseString="",r.IfShowCancelDialogWhenImageTransfer=!0,bt.progressContext.IfShowCancelDialogWhenImageTransfer=r.IfShowCancelDialogWhenImageTransfer,o._innerHTTPUpload(r,c,n,d,f,l,h,g,p,m,_,v,y,(function(e){if(r.IfShowCancelDialogWhenImageTransfer=s,bt.progressContext&&(bt.progressContext.IfShowCancelDialogWhenImageTransfer=u),Et.isFunction(i)){var t=[];Et.isArray(l)&&Et.each(l,(function(e){var n=r._ImgManager.convertServerIdToClientIndex(e);n>-1&&t.push(n)}));try{AF(i,e,t)}catch(n){}e=null}return!0}),I))}}],[{key:"_innerHTTPUpload",value:function(e,t,r,n,i,o,a,s,u,c,l,d,f,h,g){var p=parseInt(a),m=parseInt(s),_=u,v=r,y=e._segementUploadThreshold;if(Et.isUndefined(a))return sE(e),Et.isFunction(g)&&g(e._errorCode,e._errorString,""),!1;e._resetErr(),bt.cancelFrom=aG.HTTPUpload;var I,S=function(r,n,i){return 0!=r&&n&&(e._errorCode=r,e._errorString=n),i&&(e.__HTTPPostResponseString=i),bt.needShowTwiceShowDialog=!1,e.IfShowProgressBar&&bt.closeProgress(null,t),Et.isFunction(g)&&g(e._errorCode,e._errorString,e.__HTTPPostResponseString),!1},T=e._createHttpUploaderConfig();if(T.objUploadStatus=f,_=gG(_,p),bt.needShowTwiceShowDialog=!0,e.IfShowProgressBar?(bt.showProgress(e,t,!1),bt.progressContext&&(bt.progressContext._onPercent=function(e){var t=0;if(e){var r,n;r=e.loaded,n=e.total,(t=Math.floor(r/n*100))>100&&(t=100)}bt.progressBarOnPercentDone(-1,"Transferring...","",t,"")})):bt.hideProgress(),m==xt.DWT.EnumDWT_UploadDataFormat.Binary){if(f&&f.bCancel)return f.st=2,kE(e),S(e._errorCode,e._errorString);e._OnPercentDone([0,-1,fx.Encoding,"http"]),e._convertToBlobForUpload(p,o,c,4,(function(r,o,a){if(I=function(r){return bt.needShowTwiceShowDialog=!1,e.IfShowProgressBar&&bt.closeProgress(null,t),Et.isFunction(h)&&AF(h,r),!0},f&&f.bCancel)return f.st=2,kE(e),S(e._errorCode,e._errorString);if(!r||r.size<=0)return zw(e),S(e._errorCode,e._errorString);var s=e.__maxUploadImageSize;if(r.size>s&&-1!=s)return Jw(e),S(e._errorCode,e._errorString);if(0!=e._errorCode)return S(e._errorCode,e._errorString);if(xt.DWT.IfAddMD5InUploadHeader&&o&&""!=o&&(n["dwt-md5"]=o),y>0&&r.size>y){e._OnPercentDone([0,-1,fx.Uploading,"http",_]);var u=new yG,c=new IG;return e.__remoteFilename&&""!=e.__remoteFilename&&(c.remoteFilename=e.__remoteFilename),c.url=v,c.method=t,c.content=r,r=null,c.contentType=e._strHttpContentTypeFieldValue,c.headers=n,c.fileName=_,c.httpFormData=i,c.retry=l,c.bOnlyResponseEmptyIsOK=d,c.blockSize=e._moduleSize,u.httpPostUploadFragment(T,c,I,S)}var g=new yG,p=new IG;e.__remoteFilename&&""!=e.__remoteFilename&&(p.remoteFilename=e.__remoteFilename),p.url=v,p.method=t,p.content=r,r=null,p.contentType=e._strHttpContentTypeFieldValue,p.headers=n,p.fileName=_,p.httpFormData=i,p.retry=l,p.bOnlyResponseEmptyIsOK=d,p.blockSize=e._moduleSize,T.objUploadStatus=f,g.httpPostUpload(T,p,I,S)}),S)}else if(m==xt.DWT.EnumDWT_UploadDataFormat.Base64){e._convertToBase64ByServerIdsWithUI(t,o,p,c,4,(function(r){var o;if(!r||r.getLength()<=0)return zw(e),S(e._errorCode,e._errorString);if(I=function(){return bt.needShowTwiceShowDialog=!1,e.IfShowProgressBar&&bt.closeProgress(null,t),Et.isFunction(h)&&AF(h,r),!0},y>0&&r.getLength()>y){o=r.getMD5(),xt.DWT.IfAddMD5InUploadHeader&&(n["dwt-md5"]=o),e._OnPercentDone([0,-1,fx.Uploading,"http"]);var a=new IG;e.__remoteFilename&&""!=e.__remoteFilename&&(a.remoteFilename=e.__remoteFilename),a.url=v,a.method=t,a.content=r.getData(0,r.getLength()),a.headers=n,a.fileName=_,a.httpFormData=i,a.retry=l,a.bOnlyResponseEmptyIsOK=d,a.blockSize=e._moduleSize,a.offset=0,(new yG).httpPostUploadFragment(T,a,I,S)}else{var s;if(o=r.getMD5(),xt.DWT.IfAddMD5InUploadHeader&&(n["dwt-md5"]=o),!(s=r.getData(0,r.getLength()))||""==s)return zw(e),S(e._errorCode,e._errorString);var u=new IG;e.__remoteFilename&&""!=e.__remoteFilename&&(u.remoteFilename=e.__remoteFilename),u.url=v,u.method=t,u.content=s,u.headers=n,u.fileName=_,u.httpFormData=i,u.retry=l,u.bOnlyResponseEmptyIsOK=d,u.blockSize=e._moduleSize,(new yG).httpPostUpload(T,u,I,S)}}),S)}return!0}}]),o}(VG);function rj(e,t,r,n,i,o,a,s){var u,c,l=this,d="HTTPUploadThroughPostEx",f=l._GetHttpHeadersAndClear(),h=yF.combineUrl(l,e,r),g=!0,p=!1,m=[],_=function(e){return Et.isFunction(a)&&a(e),!1};if(l.__HTTPPostResponseString="",Et.isNumber(t)){if(t<-2)return oE(l),_(t)}else if(!Et.isArray(t))return oE(l),_(t);if(!Et.isString(n)||""==n)return zw(l),_();if(Et.isUndefined(i))return sE(l),_(t);if(i==xt.DWT.EnumDWT_ImageType.IT_BMP||i==xt.DWT.EnumDWT_ImageType.IT_JPG||i==xt.DWT.EnumDWT_ImageType.IT_PNG||i==xt.DWT.EnumDWT_ImageType.IT_J2K){if(-1==t&&l._ImgManager.count()>1||Et.isArray(t)&&t.length>1)return tE(l),_(t);Et.isArray(t)?m.push(t[0]):-1==t?m.push(0):m.push(t)}else{if(i!=xt.DWT.EnumDWT_ImageType.IT_TIF&&i!=xt.DWT.EnumDWT_ImageType.IT_PDF)return sE(l),_(t);if(-1==t){if(0==l._ImgManager.count())return Ww(l),_();for(c=0;c<l._ImgManager.count();c++)m.push(c)}else if(-2==t)m=l._ImgManager.getSelectedClientIndexArray();else if(Et.isArray(t))for(c=0;c<t.length;c++)m.push(t[c]);else m.push(t)}if(Et.isFunction(o)||(g=!1),""===e)return Lw(l),_(m);if(Et.isUndefined(h)||""===h)return Qw(l),_(m);if(!Et.isString(h))return cE(l),_(m);if(0!=h.indexOf("http://")&&0!=h.indexOf("https://")&&(h=bt.detect.ssl?"https://"+h:"http://"+h),!l._checkIndices(m)&&-1!=m)return _(m);var v=[];if(Et.isArray(m)&&Et.each(m,(function(e){var t=l._ImgManager.convertClientIndexToServerId(e);-1!=t&&v.push(t)})),l._resetErr(),!l._isValid())return!1;if(g)return u={method:"HTTPUploadThroughPostEx",url:h,serverIds:v,headers:f,formData:uj(l.httpFormFields),enumImageType:i,saveSetup:false,fileName:n,retry:0,bOnlyResponseEmptyIsOK:!0,objUploadFileStatus:!1,dataFormat:xt.DWT.EnumDWT_UploadDataFormat.Binary,asyncSuccessFunc:o,asyncFailureFunc:_},this._asyncUploadCmd(u),!0;bt.cancelFrom=aG.HTTPUpload;var y=this.IfShowProgressBar,I=function(e,t,r){return 0!=e&&t&&(l._errorCode=e,l._errorString=t),r&&(l.__HTTPPostResponseString=r),bt.needShowTwiceShowDialog=!1,y&&bt.closeProgress(null,d),_(m),!1};return bt.needShowTwiceShowDialog=!0,y?bt.showProgress(l,d,!1):bt.hideProgress(),l._OnPercentDone([0,-1,fx.Encoding,"http"]),l._dwtConvertToBlobSync(i,v,false,(function(e,t){if(bt.needShowTwiceShowDialog=!1,e){var r=l.__maxUploadImageSize;if(e.size>r&&-1!=r)return Jw(l),I(l._errorCode,l._errorString);xt.DWT.IfAddMD5InUploadHeader&&t&&""!=t&&(f["dwt-md5"]=t),e instanceof File?e.fileName=n:e.name=n,y&&_G(l.__IfShowCancelDialogWhenImageTransfer);var i=l._createHttpUploaderConfig(),o=new IG;return l.__remoteFilename&&""!=l.__remoteFilename&&(o.remoteFilename=l.__remoteFilename),o.url=h,o.method=d,o.content=e,o.contentType=l._strHttpContentTypeFieldValue,o.headers=f,o.bAsync=g,o.httpFormData=uj(l.httpFormFields),o.blockSize=l._moduleSize,(new yG).httpPostUpload(i,o,(function(e){return y&&bt.closeProgress(null,d),p=!0,!0}),I)}var a={};return Vw(a),I(a._errorCode,a._errorString)}),I),p}function nj(e,t,r,n,i){var o=this;if(t)return o._innerFunRaw("SaveSelectedImagesToBytes",Rx(0,0,e,r),t,true,!0,(function(e){if(Et.isFunction(n)){var t=new Blob([e],{type:o._strHttpContentTypeFieldValue});n(t),t=null}}),i),!0;var a=o._innerFunRaw("SaveSelectedImagesToBytes",Rx(0,0,e,r),t,true,!1);if(0==o._errorCode){var s=n(a);return a=null,s}return a=null,i(),!1}function ij(){return this._resetErr(),!!this._isValid()&&(this._innerSend("SetCancel",null,!0),!0)}function oj(e,t,r,n,i){var o=this;if(!Et.isFunction(i))return this._innerFun(e,t);return o.IfShowProgressBar?(bt.showProgress(o,e,r),r&&bt.progressContext&&bt.progressContext.on("cancel",(function(){qG(o,ZG,ij).call(o)}))):bt.hideProgress(),this._innerSend(e,t,!0,(function(){bt.closeProgress(null,e),Et.isFunction(n)&&n()}),(function(t){return Et.isFunction(i)&&i(o._errorCode,o._getErrorString()),bt.closeProgress(null,e),t&&Et.error(t),!0})),!0}function aj(e,t,r,n,i){var o,a=this;if(!bP.checkProductKey(a,{Core:!0}))return Et.isFunction(i)&&i(a._errorCode,a._errorString),!1;if(!bP.checkPDFProductKeyWhenNeeds(a,r))return Et.isFunction(i)&&i(a._errorCode,a._errorString),!1;if(bt.cancelFrom=aG.FTPDownload,Et.isFunction(i))return qG(a,$G,oj).call(a,e,t,!0,(function(){var e=a._ImgManager.getCurrentImageIndex();e>=0&&a._innerRefreshUI(e),a._blts&&xt.DWT.lcvrf(a),Et.isFunction(n)&&n()}),i);var s=a._getCurrentDocumentName();(o=a.__innerLoadImageFun(e,t,0,s))&&a._blts&&xt.DWT.lcvrf(a);var u=a._ImgManager.getCurrentImageIndex();return u>=0&&a._innerRefreshUI(u),o}function sj(e,t,r,n){if(0==e._ImgManager.count())return Ww(e),Et.isFunction(n)&&n(t),!1;if(Et.isNumber(t)){if(isNaN(t)||t<-2||t>=e._ImgManager.count())return oE(e),Et.isFunction(n)&&n(t),!1}else{if(!Et.isArray(t))return oE(e),Et.isFunction(n)&&n(t),!1;var i;for(i=0;i<t.length;i++){var o=t[i];if(isNaN(o)||!Et.isNumber(o)||o<0||o>=e._ImgManager.count())return rE(e),Et.isFunction(n)&&n(t),!1}}if(r==xt.DWT.EnumDWT_ImageType.IT_BMP||r==xt.DWT.EnumDWT_ImageType.IT_JPG||r==xt.DWT.EnumDWT_ImageType.IT_PNG||r==xt.DWT.EnumDWT_ImageType.IT_J2K)(-1==t&&e._ImgManager.count()>1||Et.isArray(t)&&t.length>1)&&(tE(e),Et.isFunction(n)&&n(t));else if(r!=xt.DWT.EnumDWT_ImageType.IT_TIF&&r!=xt.DWT.EnumDWT_ImageType.IT_PDF)return sE(e),Et.isFunction(n)&&n(t),!1;return!0}function uj(e){var t;return e&&(t=new FormData,Et.each(e,(function(e,r){if(e instanceof Blob){var n=e.name;t.append(r,e,n)}else t.append(r,e)}))),t}function cj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(VV){return!1}}();return function(){var r,n=cA(e);if(t){var i=cA(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return uA(this,r)}}var lj,dj=function(e){sA(s,e);var r,n,o,a=cj(s);function s(){return t(this,s),a.apply(this,arguments)}return i(s,[{key:"Viewer",get:function(){return this._viewer}},{key:"BindViewer",value:function(e){var t=this,r=e;return xt.DWT.UseDefaultViewer?(Et.isString(e)&&(r=Et.get(e),Et.show(r)),t._config.container!=r&&(t._config.container=r,RG(t)),t._UIView.BindView(e)):(kw(t,-2439,"You cannot call the method bindViewer() when Dynamsoft.DWT.UseDefaultViewer is set to false."),!1)}},{key:"UnbindViewer",value:function(){return this._innerUnbindViewer(!1)}},{key:"AddText",value:function(e,t,r,n,i,o,a,s){var u=this,c=parseInt(e);if(!EF(u,c))return!1;var l=rC.RGB2BGR(i),d=rC.RGB2BGR(o),f=u._ImgManager.convertClientIndexToServerId(c);return-1==f?(oE(u),!1):u._innerFun("AddText",Rx(f,t,r,n,l,d,a,s))}},{key:"CreateTextFont",value:function(e,t,r,n,i,o,a,s,u,c,l,d,f,h){return this._resetErr(),!!this._isValid()&&this._innerFun("CreateTextFont",Rx(e,t,r,n,i,o,a,s,u,c,l,d,f,h))}},{key:"CopyToClipboard",value:function(e){var t=parseInt(e);return!!EF(this,t)&&fj(this,"CopyToClipboard",t,null,null,!1,!1)}},{key:"CopyToClipboardAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return tC.Promise.reject({code:t._errorCode,message:t._errorString});var r=parseInt(e);return isNaN(r)?(Dw(t),tC.Promise.reject({code:t._errorCode,message:t._errorString})):r<0||r>=t._ImgManager.count()?(oE(t),tC.Promise.reject({code:t._errorCode,message:t._errorString})):function(e,t,r){var n=e._ImgManager.convertClientIndexToServerId(r);if(-1==n)return oE(e),tC.Promise.reject({code:e._errorCode,message:e._errorString});return e._innerFunV2(t,Rx(n))}(t,"CopyToClipboard",r)}},{key:"getView",value:function(){return this._UIView}},{key:"Erase",value:function(e,t,r,n,i,o,a){var s=this;if(Et.isFunction(o))return s.EraseAsync(e,t,r,n,i).then(o,(function(e){s._wrappeAsyncFailed(s,e,a)})),!0;var u,c=parseInt(e);if(!EF(s,c,a))return!1;var l=s._ImgManager.convertClientIndexToServerId(c);return-1==l?(oE(s),Et.isFunction(a)&&a(s._errorCode,s._getErrorString()),!1):(s.getView().ClearSelectedAreas(),(u=1==s._innerFun("Erase",Rx(l,t,r,n,i)))?Et.isFunction(o)&&o():Et.isFunction(a)&&a(s._errorCode,s._getErrorString()),u)}},{key:"EraseAsync",value:function(e,t,r,n,i){var o=this;if(o._resetErr(),!o._isValid())return tC.Promise.reject({code:o._errorCode,message:o._errorString});var a=parseInt(e);if(isNaN(a))return Dw(o),tC.Promise.reject({code:o._errorCode,message:o._errorString});if(a<0||a>=o._ImgManager.count())return oE(o),tC.Promise.reject({code:o._errorCode,message:o._errorString});var s=o._ImgManager.convertClientIndexToServerId(a);return-1==s?(oE(o),tC.Promise.reject({code:o._errorCode,message:o._errorString})):(o.getView().ClearSelectedAreas(),o._innerFunV2("Erase",Rx(s,t,r,n,i),!0).then((function(e){if(1!=e)throw{code:o._errorCode,message:o._errorString}})))}},{key:"GetImageBitDepth",value:function(e){var t=this,r=parseInt(e);if(!EF(t,r))return!1;var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(oE(t),!1):t._innerFun("GetImageBitDepth",Rx(n))}},{key:"GetImageWidth",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return!1;var r=parseInt(e);if(isNaN(r))return Dw(t),-1;if(r<0||r>=t._ImgManager.count())return oE(t),-1;var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(oE(t),-1):t._innerFun("GetImageWidth",Rx(n))}},{key:"GetImageHeight",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return!1;var r=parseInt(e);if(isNaN(r))return Dw(t),-1;if(r<0||r>=t._ImgManager.count())return oE(t),-1;var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(oE(t),-1):t._innerFun("GetImageHeight",Rx(n))}},{key:"GetImageSize",value:function(e,t,r){var n=this;if(n._resetErr(),!n._isValid())return!1;var i=parseInt(e);if(isNaN(i))return Dw(n),-1;if(i<0||i>=n._ImgManager.count())return oE(n),-1;var o=n._ImgManager.convertClientIndexToServerId(i);return-1==o?(oE(n),-1):n._innerFun("GetImageSize",Rx(o,t,r))}},{key:"GetImageSizeWithSpecifiedType",value:function(e,t){var r=this;if(r._resetErr(),!r._isValid())return!1;var n=parseInt(e);if(isNaN(n))return Dw(r),-1;if(n<0||n>=r._ImgManager.count())return oE(r),-1;var i=r._ImgManager.convertClientIndexToServerId(n);return-1==i?(oE(r),-1):r._innerFun("GetImageSizeWithSpecifiedType",Rx(i,t))}},{key:"GetImageXResolution",value:function(e){var t=this,r=parseInt(e);if(!EF(t,r))return!1;var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(oE(t),!1):t._innerFun("GetImageXResolution",Rx(n))}},{key:"GetImageYResolution",value:function(e){var t=this,r=parseInt(e);if(!EF(t,r))return!1;var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(oE(t),!1):t._innerFun("GetImageYResolution",Rx(n))}},{key:"SelectAllImages",value:function(){var e,t=this,r=t._getHowManyImagesInBuffer(),n=[];if(t._resetErr(),!t._isValid())return!1;for(e=0;e<r;e++)n.push(e);return t._ImgManager.setSelectedClientIndexArray(n),n}},{key:"SelectImages",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&t._ImgManager.setSelectedClientIndexArray(e)}},{key:"GetSkewAngle",value:function(e,t,r){var n,i=this;if(Et.isFunction(t))return i.GetSkewAngleAsync(e).then(t,(function(e){i._wrappeAsyncFailed(i,e,r)})),!0;var o=parseInt(e);return!!EF(i,o,r)&&(n=fj(i,"GetSkewAngle",o,t,r,!0,!1),0==i._errorCode?(yF.refreshImageAfterInvokeFun(i,o),Et.isFunction(t)&&t(n),n):(Et.isFunction(r)&&r(i._errorCode,i._errorString),0))}},{key:"GetSkewAngleAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return tC.Promise.reject({code:t._errorCode,message:t._errorString});var r=parseInt(e);if(isNaN(r))return Dw(t),tC.Promise.reject({code:t._errorCode,message:t._errorString});if(r<0||r>=t._ImgManager.count())return oE(t),tC.Promise.reject({code:t._errorCode,message:t._errorString});var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(oE(t),tC.Promise.reject({code:t._errorCode,message:t._errorString})):t._innerFunV2("GetSkewAngle",Rx(n),!0).then((function(e){var n=e;return Et.isArray(e)&&(n=e.length>0?e[0]:0),yF.refreshImageAfterInvokeFun(t,r),n}))}},{key:"GetSkewAngleEx",value:function(e,t,r,n,i){var o=this,a=parseInt(e);if(!EF(o,a))return!1;var s=o._ImgManager.convertClientIndexToServerId(a);return-1==s?(oE(o),!1):o._innerFun("GetSkewAngleEx",Rx(s,t,r,n,i))}},{key:"GetSkewAngleFromBinaryAsync",value:function(e,t,r,n){var i=this;if(i._resetErr(),!i._isValid())return tC.Promise.reject({code:i._errorCode,message:i._errorString});var o=this._imageBufferWrapper.getMetadataByIndex(e),a={imageId:this._ImgManager.convertClientIndexToServerId(e),bufferLen:t.size,imageType:xD.IT_BMP,width:o.width,height:o.height,bit:o.bitDepth,xres:o.resolutionX,yres:o.resolutionY},s=Et.stringify([Et.stringify(a)]);return this._innerSendBlob("GetSkewAngleFromBinary",s,t,!0,!0,r,n)}},{key:"IsBlankImageEx",value:function(e,t,r,n,i,o){var a,s=this;if(!EF(s,a=parseInt(e)))return!1;var u=s._ImgManager.convertClientIndexToServerId(a);return-1==u?(oE(s),!1):s._innerFun("IsBlankImageEx",Rx(u,t,r,n,i,o))}},{key:"MirrorAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return tC.Promise.reject({code:t._errorCode,message:t._errorString});var r=parseInt(e);if(isNaN(r))return Dw(t),tC.Promise.reject({code:t._errorCode,message:t._errorString});if(r<0||r>=t._ImgManager.count())return oE(t),tC.Promise.reject({code:t._errorCode,message:t._errorString});var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(oE(t),tC.Promise.reject({code:t._errorCode,message:t._errorString})):t._innerFunV2("Mirror",Rx(n),!0).then((function(e){if(1!=e)throw{code:t._errorCode,message:t._errorString};yF.refreshImageAfterInvokeFun(t,r),t.getView().ClearSelectedAreas()}))}},{key:"Mirror",value:function(e,t,r){var n=this;if(Et.isFunction(t))return n.MirrorAsync(e).then(t,(function(e){n._wrappeAsyncFailed(n,e,r)})),!0;var i=parseInt(e);return!!EF(n,i,r)&&fj(n,"Mirror",i,t,r,!1,!0)}},{key:"RemoveAllImages",value:function(){return this._removeAllImages("RemoveAllImages")}},{key:"RemoveAllImagesAsync",value:function(){return this._removeAllImagesAsync("RemoveAllImagesAsync",!0)}},{key:"RemoveImageAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return tC.Promise.reject({code:t._errorCode,message:t._errorString});var r=parseInt(e);if(isNaN(r))return Dw(t),tC.Promise.reject({code:t._errorCode,message:t._errorString});if(r<0||r>=t._ImgManager.count())return oE(t),tC.Promise.reject({code:t._errorCode,message:t._errorString});var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(oE(t),tC.Promise.reject({code:t._errorCode,message:t._errorString})):t._innerFunV2("RemoveImage",Rx(n),!0).then((function(e){return!(!e&&-1033!=t._errorCode)&&(t._OnBitmapChanged(["0",""+n,3,t._ImgManager.getCurrentImageIndex(),t._ImgManager.count()]),!0)}))}},{key:"Rotate",value:function(e,t,r,n,i){return this.RotateEx(e,t,r,-1,n,i)}},{key:"_wrappeAsyncFailed",value:function(e,t,r){t&&(e._errorCode=t.code,e._errorString=t.message),Et.isFunction(r)&&r(e._errorCode,e._getErrorString())}},{key:"RotateEx",value:function(e,t,r,n,i,o){var a=this;if(Et.isFunction(i))return a.RotateExAsync(e,t,r,n).then(i,(function(e){a._wrappeAsyncFailed(a,e,o)})),!0;if(a._resetErr(),!a._isValid())return!1;var s,u=parseInt(e);if(isNaN(u))return Dw(a),Et.isFunction(o)&&o(a._errorCode,a._getErrorString()),!1;if(u<0||u>=a._ImgManager.count())return oE(a),Et.isFunction(o)&&o(a._errorCode,a._getErrorString()),!1;var c=a._ImgManager.convertClientIndexToServerId(u);return-1==c?(oE(a),Et.isFunction(o)&&o(a._errorCode,a._getErrorString()),!1):((s=1==a._innerFun("RotateEx",Rx(c,t,r,n)))?(yF.refreshImageAfterInvokeFun(a,u),a.getView().ClearSelectedAreas(),Et.isFunction(i)&&i()):Et.isFunction(o)&&o(a._errorCode,a._getErrorString()),s)}},{key:"RotateLeft",value:function(e,t,r){return this.RotateEx(e,-90,!0,-1,t,r)}},{key:"RotateRight",value:function(e,t,r){return this.RotateEx(e,90,!0,-1,t,r)}},{key:"RotateAsync",value:function(e,t,r){return this.RotateExAsync(e,t,r,-1)}},{key:"RotateExAsync",value:function(e,t,r,n){var i=this;if(i._resetErr(),!i._isValid())return tC.Promise.reject({code:i._errorCode,message:i._errorString});var o=parseInt(e);if(isNaN(o))return Dw(i),tC.Promise.reject({code:i._errorCode,message:i._errorString});if(o<0||o>=i._ImgManager.count())return oE(i),tC.Promise.reject({code:i._errorCode,message:i._errorString});var a=i._ImgManager.convertClientIndexToServerId(o);return-1==a?(oE(i),tC.Promise.reject({code:i._errorCode,message:i._errorString})):i._innerFunV2("RotateEx",Rx(a,t,r,n),!0).then((function(e){if(1!=e&&1!=e)throw{code:i._errorCode,message:i._errorString};yF.refreshImageAfterInvokeFun(i,o),i.getView().ClearSelectedAreas()}))}},{key:"RotateLeftAsync",value:function(e){return this.RotateExAsync(e,-90,!0,-1)}},{key:"RotateRightAsync",value:function(e){return this.RotateExAsync(e,90,!0,-1)}},{key:"ChangeImageSize",value:function(e,t,r,n,i,o){var a=this;if(Et.isFunction(i))return a.ChangeImageSizeAsync(e,t,r,n).then(i,(function(e){a._wrappeAsyncFailed(a,e,o)})),!0;var s,u=parseInt(e),c=1*t,l=1*r;if(!EF(a,u,o))return!1;if(c<=0||l<=0)return Kw(a),Et.isFunction(o)&&o(a._errorCode,a._getErrorString()),!1;var d=a._ImgManager.convertClientIndexToServerId(u);return-1==d?(oE(a),Et.isFunction(o)&&o(a._errorCode,a._getErrorString()),!1):((s=1==a._innerFun("ChangeImageSize",Rx(d,c,l,n)))?(yF.refreshImageAfterInvokeFun(a,u),Et.isFunction(i)&&i()):Et.isFunction(o)&&o(a._errorCode,a._getErrorString()),s)}},{key:"ChangeImageSizeAsync",value:function(e,t,r,n){var i=this,o=parseInt(e),a=1*t,s=1*r;if(i._resetErr(),!i._isValid())return tC.Promise.reject({code:i._errorCode,message:i._errorString});if(isNaN(o))return Dw(i),tC.Promise.reject({code:i._errorCode,message:i._errorString});if(o<0||o>=i._ImgManager.count())return oE(i),tC.Promise.reject({code:i._errorCode,message:i._errorString});if(a<=0||s<=0)return Kw(i),tC.Promise.reject({code:i._errorCode,message:i._errorString});var u=i._ImgManager.convertClientIndexToServerId(o);return-1==u?(oE(i),tC.Promise.reject({code:i._errorCode,message:i._errorString})):i._innerFunV2("ChangeImageSize",Rx(u,a,s,n),!0).then((function(e){if(1!=e)throw{code:i._errorCode,message:i._errorString};yF.refreshImageAfterInvokeFun(i,o)}))}},{key:"Flip",value:function(e,t,r){var n=this;if(Et.isFunction(t))return n.FlipAsync(e).then(t,(function(e){n._wrappeAsyncFailed(n,e,r)})),!0;var i=parseInt(e);return!!EF(n,i,r)&&fj(n,"Flip",i,t,r,!1,!0)}},{key:"FlipAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return tC.Promise.reject({code:t._errorCode,message:t._errorString});var r=parseInt(e);if(isNaN(r))return Dw(t),tC.Promise.reject({code:t._errorCode,message:t._errorString});if(r<0||r>=t._ImgManager.count())return oE(t),tC.Promise.reject({code:t._errorCode,message:t._errorString});var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(oE(t),tC.Promise.reject({code:t._errorCode,message:t._errorString})):t._innerFunV2("Flip",Rx(n),!0).then((function(e){if(1!=e)throw{code:t._errorCode,message:t._errorString};yF.refreshImageAfterInvokeFun(t,r),t.getView().ClearSelectedAreas()}))}},{key:"OutputSelectedAreaAsync",value:(o=eA(g.mark((function u(e,t,r,n){var i,o,a,s,c,l,d,f,h,p,m,_,v,y;return g.wrap((function(u){for(;;)switch(u.prev=u.next){case 0:if(a="OutputSelectedArea",(o=this)._resetErr(),o._isValid()){u.next=4;break}throw{code:o._errorCode,message:o._errorString};case 4:if(s=0,c=0,l=0,d=0,!isNaN(e)){u.next=8;break}throw Dw(o),{code:o._errorCode,message:o._errorString};case 8:if(r==xD.IT_BMP||r==xD.IT_JPG||r==xD.IT_TIF||r==xD.IT_PNG||r==xD.IT_PDF){u.next=11;break}throw gE(o),{code:o._errorCode,message:o._errorString};case 11:if(n==vG.Blob||n==vG.Base64){u.next=14;break}throw gE(o),{code:o._errorCode,message:o._errorString};case 14:if(!(e<0||e>=o._ImgManager.count())){u.next=17;break}throw oE(o),{code:o._errorCode,message:o._errorString};case 17:if(-1!=(f=o._ImgManager.convertClientIndexToServerId(e))){u.next=21;break}throw oE(o),{code:o._errorCode,message:o._errorString};case 21:return h=n==vG.Base64,p=h?"text":"arraybuffer",t&&(bt.isNumber(t.x)&&(s=t.x),bt.isNumber(t.y)&&(c=t.y),bt.isNumber(t.width)&&(l=t.width),bt.isNumber(t.height)&&(d=t.height)),_=Et.stringify([{index:f,left:s,top:c,width:l,height:d}]),v="["+_+","+r+","+n+"]",y=null===(i=bt.progressContext)||void 0===i?void 0:i.IfShowCancelDialogWhenImageTransfer,u.prev=27,o.IfShowProgressBar?bt.showProgress(o,a,!1):bt.hideProgress(),h?o._OnPercentDone([0,-1,fx.ConvertingToBase64]):o._OnPercentDone([0,-1,fx.ConvertingToBlob]),bt.progressContext&&(bt.progressContext.IfShowCancelDialogWhenImageTransfer=!1),u.next=33,o._sendDataByHttpAsync(a,v,p,!0);case 33:m=u.sent;case 34:return u.prev=34,bt.progressContext&&(bt.progressContext.IfShowCancelDialogWhenImageTransfer=y),o.IfShowProgressBar&&bt.closeProgress(null,a),u.finish(34);case 38:if(!h){u.next=51;break}if(!m){u.next=48;break}if(!gA(m)){u.next=44;break}return o._errorCode=m.exception,o._errorString=m.description,u.abrupt("return","");case 44:if(!(Et.isArray(m.result)&&m.result.length>0&&Et.isString(m.result[0]))){u.next=46;break}return u.abrupt("return",m.result[0]);case 46:u.next=49;break;case 48:return u.abrupt("return","");case 49:u.next=52;break;case 51:return u.abrupt("return",new Blob([m],{type:jD(r)}));case 52:case"end":return u.stop()}}),u,this,[[27,,34,38]])}))),function(e,t,r,n){return o.apply(this,arguments)})},{key:"Crop",value:function(e,t,r,n,i,o,a){var s=this;if(Et.isFunction(o))return s.CropAsync(e,t,r,n,i).then(o,(function(e){s._wrappeAsyncFailed(s,e,a)})),!0;var u,c=parseInt(e);if(!EF(s,c,a))return!1;var l,d,f=s._ImgManager.convertClientIndexToServerId(c);return-1==f?(oE(s),Et.isFunction(a)&&a(s._errorCode,s._getErrorString()),!1):(u=1==s._innerFun("Crop",Rx(f,t,r,n,i)),l=s._errorCode,d=s._getErrorString(),s.getView().ClearSelectedAreas(),s._errorCode=l,s._errorString=d,u?(yF.refreshImageAfterInvokeFun(s,c),Et.isFunction(o)&&o()):Et.isFunction(a)&&a(l,d),u)}},{key:"CropAsync",value:function(e,t,r,n,i){var o=this;if(o._resetErr(),!o._isValid())return tC.Promise.reject({code:o._errorCode,message:o._errorString});var a=parseInt(e);if(isNaN(a))return Dw(o),tC.Promise.reject({code:o._errorCode,message:o._errorString});if(a<0||a>=o._ImgManager.count())return oE(o),tC.Promise.reject({code:o._errorCode,message:o._errorString});var s=o._ImgManager.convertClientIndexToServerId(a);return-1==s?(oE(o),tC.Promise.reject({code:o._errorCode,message:o._errorString})):o._innerFunV2("Crop",Rx(s,t,r,n,i),!0).then((function(e){var t,r;if(t=o._errorCode,r=o._getErrorString(),o.getView().ClearSelectedAreas(),o._errorCode=t,o._errorString=r,1!=e)throw{code:o._errorCode,message:o._errorString};return yF.refreshImageAfterInvokeFun(o,a),!0}))}},{key:"CropToClipboard",value:function(e,t,r,n,i){var o,a=this,s=parseInt(e);if(!EF(a,s))return!1;var u=a._ImgManager.convertClientIndexToServerId(s);return-1==u?(oE(a),!1):(a.getView().ClearSelectedAreas(),(o=1==a._innerFun("CropToClipboard",Rx(u,t,r,n,i)))&&yF.refreshImageAfterInvokeFun(a,s),o)}},{key:"CutFrameToClipboard",value:function(e,t,r,n,i){var o,a=this,s=parseInt(e);if(!EF(a,s))return!1;var u=a._ImgManager.convertClientIndexToServerId(s);return-1==u?(oE(a),!1):(a.getView().ClearSelectedAreas(),(o=1==a._innerFun("CutFrameToClipboard",Rx(u,t,r,n,i)))&&yF.refreshImageAfterInvokeFun(a,s),o)}},{key:"CutToClipboard",value:function(e){var t,r=this,n=parseInt(e);if(!EF(r,n))return!1;var i=r._ImgManager.convertClientIndexToServerId(n);return-1==i?(oE(r),!1):((t=1==r._innerFun("CutToClipboard",Rx(i)))&&r._OnBitmapChanged(["0",""+i,3,r._ImgManager.getCurrentImageIndex(),r._ImgManager.count()]),t)}},{key:"CutFrameToClipboardAsync",value:function(e,t,r,n,i){var o=this;if(o._resetErr(),!o._isValid())return tC.Promise.reject({code:o._errorCode,message:o._errorString});var a=parseInt(e);if(isNaN(a))return Dw(o),tC.Promise.reject({code:o._errorCode,message:o._errorString});if(a<0||a>=o._ImgManager.count())return oE(o),tC.Promise.reject({code:o._errorCode,message:o._errorString});var s=o._ImgManager.convertClientIndexToServerId(a);return-1==s?(oE(o),tC.Promise.reject({code:o._errorCode,message:o._errorString})):o._innerFunV2("CutFrameToClipboard",Rx(s,t,r,n,i)).then((function(e){var t=1==e;if(!t)throw{code:o._errorCode,message:o._errorString};return yF.refreshImageAfterInvokeFun(o,a),t}))}},{key:"CropToClipboardAsync",value:function(e,t,r,n,i){var o=this;if(o._resetErr(),!o._isValid())return tC.Promise.reject({code:o._errorCode,message:o._errorString});var a=parseInt(e);if(isNaN(a))return Dw(o),tC.Promise.reject({code:o._errorCode,message:o._errorString});if(a<0||a>=o._ImgManager.count())return oE(o),tC.Promise.reject({code:o._errorCode,message:o._errorString});var s=o._ImgManager.convertClientIndexToServerId(a);return-1==s?(oE(o),tC.Promise.reject({code:o._errorCode,message:o._errorString})):o._innerFunV2("CropToClipboard",Rx(s,t,r,n,i)).then((function(e){var t=1==e;if(!t)throw{code:o._errorCode,message:o._errorString};return yF.refreshImageAfterInvokeFun(o,a),t}))}},{key:"CutToClipboardAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return tC.Promise.reject({code:t._errorCode,message:t._errorString});var r=parseInt(e);if(isNaN(r))return Dw(t),tC.Promise.reject({code:t._errorCode,message:t._errorString});if(r<0||r>=t._ImgManager.count())return oE(t),tC.Promise.reject({code:t._errorCode,message:t._errorString});var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(oE(t),tC.Promise.reject({code:t._errorCode,message:t._errorString})):t._innerFunV2("CutToClipboard",Rx(n)).then((function(e){var r=1==e;if(!r)throw{code:t._errorCode,message:t._errorString};return t._OnBitmapChanged(["0",""+n,3,t._ImgManager.getCurrentImageIndex(),t._ImgManager.count()]),r}))}},{key:"SetDPI",value:function(e,t,r,n,i,o,a){var s,u=this,c=parseInt(e);if(!EF(u,c,a))return!1;var l=u._ImgManager.convertClientIndexToServerId(c);return-1==l?(oE(u),Et.isFunction(a)&&a(u._errorCode,u._getErrorString()),!1):((s=1==u._innerFun("SetDPI",Rx(l,t,r,n,i)))?Et.isFunction(o)&&o():Et.isFunction(a)&&a(u._errorCode,u._getErrorString()),s)}},{key:"MoveImage",value:function(e,t){var r=this;if(r._resetErr(),!r._isValid())return!1;var n=parseInt(e),i=parseInt(t);return isNaN(n)||isNaN(i)?(Dw(r),!1):n<0||n>=r._ImgManager.count()||i<0||i>=r._ImgManager.count()?(oE(r),!1):r._ImgManager.moveImage(n,i)}},{key:"SwitchImage",value:function(e,t){var r=this;if(r._resetErr(),!r._isValid())return!1;var n=parseInt(e),i=parseInt(t);return isNaN(n)||isNaN(i)?(Dw(r),!1):n<0||n>=r._ImgManager.count()||i<0||i>=r._ImgManager.count()?(oE(r),!1):r._ImgManager.switchImage(n,i)}},{key:"CloseWorkingProcess",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._innerFun("CloseWorkerProcess")}},{key:"RemoveAllSelectedImages",value:function(){var e=this;if(e._resetErr(),!e._isValid())return!1;var t=!0,r=e._ImgManager.getCurrentImageIndex(),n=e._ImgManager.getSelectedClientIndexArray(),i=[];if(Et.isArray(n)&&Et.each(n,(function(t){var r=e._ImgManager.convertClientIndexToServerId(t);-1!=r&&i.push(r)})),0==i.length&&r>=0){var o=e._ImgManager.convertClientIndexToServerId(r);i.push(o)}return i.length>0&&(t=e._innerFun("RemoveAllSelectedImages",Rx(i.join(",")))),t&&Et.each(i,(function(t){e._OnBitmapChanged(["0",""+t,3,e._ImgManager.getCurrentImageIndex(),e._ImgManager.count()])})),t}},{key:"RemoveAllSelectedImagesAsync",value:function(){var e=this;if(e._resetErr(),!e._isValid())return tC.Promise.reject({code:e._errorCode,message:e._errorString});var t=e._ImgManager.getCurrentImageIndex(),r=e._ImgManager.getSelectedClientIndexArray(),n=[];if(Et.isArray(r)&&Et.each(r,(function(t){var r=e._ImgManager.convertClientIndexToServerId(t);-1!=r&&n.push(r)})),0==n.length&&t>=0){var i=e._ImgManager.convertClientIndexToServerId(t);n.push(i)}return n.length>0?e._innerFunV2("RemoveAllSelectedImages",Rx(n.join(","),!0)).then((function(t){t&&Et.each(n,(function(t){e._OnBitmapChanged(["0",""+t,3,e._ImgManager.getCurrentImageIndex(),e._ImgManager.count()])}))})):tC.Promise.resolve()}},{key:"TagImages",value:function(e,t){var r=this;if(r._resetErr(),!r._isValid())return!1;var n=!0,i=r._ImgManager.count();return Et.isArray(e)?Et.isString(t)&&""!=t?(Et.each(e,(function(e){if(isNaN(e)||e<0||e>=i)return oE(r),n=!1})),n?r._ImgManager.addImageTag(e,t):n):(kw(r,-2394,"Invalid tag name."),!1):(iE(r),!1)}},{key:"ClearImageTags",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&(-1==e||e>=t._getHowManyImagesInBuffer()?(oE(t),!1):t._ImgManager.removeImageTag(e))}},{key:"SetDefaultTag",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&t._ImgManager.setDefaultTag(e)}},{key:"FilterImagesByTag",value:function(e,t,r){var n=this;return n._resetErr(),!!n._isValid()&&n._ImgManager.showImagesByFilter(e,t,r)}},{key:"ClearFilter",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._ImgManager.clearFilter()}},{key:"CreateDocument",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&(e&&""!=e?Et.isString(e)?t._ImgManager.CreateFile(e):(yE(t),!1):(Et.isNumber(e)?yE(t):vE(t),!1))}},{key:"OpenDocument",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&(e&&""!=e?Et.isString(e)?t._ImgManager.OpenFile(e):(yE(t),!1):(Et.isNumber(e)?yE(t):vE(t),!1))}},{key:"RemoveDocument",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return!1;var r=t._ImgManager.GetImageIdsByFileName(e);return r.length>0&&t._innerFun("RemoveAllSelectedImages",Rx(r.join(","))),t._ImgManager.RemoveFile(e)}},{key:"RenameDocument",value:function(e,t){var r=this;return r._resetErr(),!!r._isValid()&&(Et.isString(e)&&Et.isString(t)?e&&""!=e&&t&&""!=t?r._ImgManager.RenameFile(e,t):(vE(r),!1):(yE(r),!1))}},{key:"GetDocumentInfoList",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._ImgManager.GetFileInfoList()}},{key:"MoveToDocumentAsync",value:(n=eA(g.mark((function c(e,t,r,n){var i,o,a,s,u,l,d,f,h,p;return g.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if((i=this)._resetErr(),i._isValid()){c.next=4;break}throw{code:i._errorCode,message:i._errorString};case 4:if(!Et.isUndefined(e)&&0!=e.length){c.next=7;break}throw KE(i),{code:i._errorCode,message:i._errorString};case 7:if(!Et.isUndefined(t)&&0!=t.length){c.next=10;break}throw JE(i),{code:i._errorCode,message:i._errorString};case 10:o=i._ImgManager.GetFileInfoList(),u=0;case 12:if(!(u<o.length)){c.next=20;break}if(o[u].name!=e){c.next=17;break}return a=o[u],c.abrupt("break",20);case 17:u++,c.next=12;break;case 20:l=0;case 21:if(!(l<o.length)){c.next=29;break}if(o[l].name!=t){c.next=26;break}return s=o[l],c.abrupt("break",29);case 26:l++,c.next=21;break;case 29:if(!Et.isUndefined(a)){c.next=32;break}throw KE(i),{code:i._errorCode,message:i._errorString};case 32:if(!Et.isUndefined(s)){c.next=35;break}throw JE(i),{code:i._errorCode,message:i._errorString};case 35:if(d=[],!Et.isUndefined(r)){c.next=40;break}if(a.imageIds.length>0)for(h=0;h<a.imageIds.length;h++)d.push(h);c.next=60;break;case 40:if(!Et.isArray(r)){c.next=53;break}if(i._checkIndices(r,a.imageIds.length)){c.next=43;break}throw{code:i._errorCode,message:i._errorString};case 43:if(d=r,Et.isUndefined(n)){c.next=51;break}if(!Et.isNumber(n)){c.next=49;break}n<0?f=0:s.imageIds.length>n&&(f=n),c.next=51;break;case 49:throw gE(i),{code:i._errorCode,message:i._errorString};case 51:c.next=60;break;case 53:if(!Et.isNumber(r)){c.next=58;break}if(a.imageIds.length>0)for(p=0;p<a.imageIds.length;p++)d.push(p);r<0?f=0:s.imageIds.length>r&&(f=r),c.next=60;break;case 58:throw gE(i),{code:i._errorCode,message:i._errorString};case 60:return c.abrupt("return",new tC.Promise((function(r,n){0==d.length||i._ImgManager.MoveImageToFile(e,d,t,f)?r():n({code:i._errorCode,message:i._errorString})})));case 61:case"end":return c.stop()}}),c,this)}))),function(e,t,r,i){return n.apply(this,arguments)})},{key:"CopyToDocumentAsync",value:(r=eA(g.mark((function l(e,t,r,n){var i,o,a,s,u,c,d,f;return g.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:if((i=this)._resetErr(),i._isValid()){l.next=4;break}throw{code:i._errorCode,message:i._errorString};case 4:if(!Et.isUndefined(e)&&0!=e.length){l.next=7;break}throw KE(i),{code:i._errorCode,message:i._errorString};case 7:if(!Et.isUndefined(t)&&0!=t.length){l.next=10;break}throw JE(i),{code:i._errorCode,message:i._errorString};case 10:o=i._ImgManager.GetFileInfoList(),u=0;case 12:if(!(u<o.length)){l.next=20;break}if(o[u].name!=e){l.next=17;break}return a=o[u],l.abrupt("break",20);case 17:u++,l.next=12;break;case 20:c=0;case 21:if(!(c<o.length)){l.next=29;break}if(o[c].name!=t){l.next=26;break}return s=o[c],l.abrupt("break",29);case 26:c++,l.next=21;break;case 29:if(!Et.isUndefined(a)){l.next=32;break}throw KE(i),{code:i._errorCode,message:i._errorString};case 32:if(!Et.isUndefined(s)){l.next=35;break}throw JE(i),{code:i._errorCode,message:i._errorString};case 35:if(d=[],!Et.isUndefined(r)){l.next=40;break}a.imageIds.length>0&&Et.isArray(a.imageIds)&&Et.each(a.imageIds,(function(e){var t=i._convertGuidToServerId(e);-1!=t&&d.push(t)})),l.next=60;break;case 40:if(!Et.isArray(r)){l.next=53;break}if(i._checkIndices(r,a.imageIds.length)){l.next=43;break}throw{code:i._errorCode,message:i._errorString};case 43:if(Et.each(r,(function(e){var t=i._convertGuidToServerId(a.imageIds[e]);-1!=t&&d.push(t)})),Et.isUndefined(n)){l.next=51;break}if(!Et.isNumber(n)){l.next=49;break}n<0?f=0:s.imageIds.length>n&&(f=n),l.next=51;break;case 49:throw gE(i),{code:i._errorCode,message:i._errorString};case 51:l.next=60;break;case 53:if(!Et.isNumber(r)){l.next=58;break}a.imageIds.length>0&&Et.isArray(a.imageIds)&&Et.each(a.imageIds,(function(e){var t=i._convertGuidToServerId(e);-1!=t&&d.push(t)})),r<0?f=0:s.imageIds.length>r&&(f=r),l.next=60;break;case 58:throw gE(i),{code:i._errorCode,message:i._errorString};case 60:return l.abrupt("return",new tC.Promise((function(e,r){var n="copyToDocument",o=s.imageIds.length;if(0==d.length)e();else{i.IfShowProgressBar?ZE(!1):bt.hideProgress();var a=i.IfShowCancelDialogWhenImageTransfer;bt.cancelFrom=aG.LoadImage,i.IfShowCancelDialogWhenImageTransfer=!1,bt.progressContext&&(bt.progressContext.IfShowCancelDialogWhenImageTransfer=!1),bt.cancelFrom=aG.Other,i._innerConvertToBlobWithUI(n,xt.DWT.EnumDWT_ImageType.IT_PDF,d,!1,(function(s,u){var c;s.currentFileName=t,s.currentTagName="",s.bNeedClearCurrentTagName=!0,i.IfShowProgressBar?(ZE(!1),bt.showProgress(i,n,!1),bt.progressContext&&(bt.progressContext.IfShowCancelDialogWhenImageTransfer=!1)):bt.hideProgress(),bt.cancelFrom=aG.LoadImage,i.Addon&&i.Addon.PDF&&(c=i.Addon.PDF.GetReaderOptions(),i.Addon.PDF.SetReaderOptions({convertMode:xt.DWT.EnumDWT_ConvertMode.CM_IMAGEONLY})),i._innerLoadImageFromBinary(s,0,!0,(function(){if(i.Addon&&i.Addon.PDF&&c&&i.Addon.PDF.SetReaderOptions(c),i.IfShowCancelDialogWhenImageTransfer=a,i.IfShowProgressBar&&bt.closeProgress(null,n),Et.isUndefined(f))e();else{for(var s=[],u=0;u<d.length;u++)s.push(o+u);0==s.length||i._ImgManager.MoveImageToFile(t,s,t,f)?e():r({code:i._errorCode,message:i._errorString})}}),(function(){i.Addon&&i.Addon.PDF&&c&&i.Addon.PDF.SetReaderOptions(c),i.IfShowCancelDialogWhenImageTransfer=a,i.IfShowProgressBar&&bt.closeProgress(null,n),r({code:i._errorCode,message:i._errorString})}))}),(function(){i.IfShowCancelDialogWhenImageTransfer=a,r({code:i._errorCode,message:i._errorString})}))}})));case 61:case"end":return l.stop()}}),l,this)}))),function(e,t,n,i){return r.apply(this,arguments)})},{key:"Invert",value:function(e,t,r){var n=this;if(Et.isFunction(t))return n.InvertAsync(e).then(t,(function(e){n._wrappeAsyncFailed(n,e,r)})),!0;var i=parseInt(e);return!!EF(n,i,r)&&fj(n,"Invert",i,t,r,!1,!0)}},{key:"InvertAsync",value:function(e){return this._invert(e)}},{key:"RenameTag",value:function(e,t){var r=this;return r._resetErr(),!!r._isValid()&&(Et.isUndefined(e)?(Qw(r),!1):0==e.length?(kw(r,-2517,"Old tag name is required."),!1):Et.isUndefined(t)||0==t.length?(function(e){kw(e,-2518,"New tag name is required.")}(r),!1):r._ImgManager.renameTag(e,t))}},{key:"RemoveTag",value:function(e,t){var r=this;return r._resetErr(),!!r._isValid()&&(Et.isUndefined(e)||0==e.length?(Qw(r),!1):Et.isUndefined(t)||Et.isArray(t)?r._ImgManager.removeTag(e,t):(iE(r),!1))}},{key:"GetTagList",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._ImgManager.getTagList()}},{key:"GetTagListByIndex",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&t._ImgManager.getTagListByIndex(e)}},{key:"GetImageBitDepthAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return tC.Promise.reject({code:t._errorCode,message:t._errorString});var r=parseInt(e);if(isNaN(r))return Dw(t),tC.Promise.reject({code:t._errorCode,message:t._errorString});if(r<0||r>=t._ImgManager.count())return oE(t),tC.Promise.reject({code:t._errorCode,message:t._errorString});var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(oE(t),tC.Promise.reject({code:t._errorCode,message:t._errorString})):t._innerFunV2("GetImageBitDepth",Rx(n))}},{key:"GetImageWidthAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return tC.Promise.reject({code:t._errorCode,message:t._errorString});var r=parseInt(e);if(isNaN(r))return Dw(t),tC.Promise.reject({code:t._errorCode,message:t._errorString});if(r<0||r>=t._ImgManager.count())return oE(t),tC.Promise.reject({code:t._errorCode,message:t._errorString});var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(oE(t),tC.Promise.reject({code:t._errorCode,message:t._errorString})):t._innerFunV2("GetImageWidth",Rx(n))}},{key:"GetImageHeightAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return tC.Promise.reject({code:t._errorCode,message:t._errorString});var r=parseInt(e);if(isNaN(r))return Dw(t),tC.Promise.reject({code:t._errorCode,message:t._errorString});if(r<0||r>=t._ImgManager.count())return oE(t),tC.Promise.reject({code:t._errorCode,message:t._errorString});var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(oE(t),tC.Promise.reject({code:t._errorCode,message:t._errorString})):t._innerFunV2("GetImageHeight",Rx(n))}},{key:"GetImageSizeAsync",value:function(e,t,r){var n=this;if(n._resetErr(),!n._isValid())return tC.Promise.reject({code:n._errorCode,message:n._errorString});var i=parseInt(e);if(isNaN(i))return Dw(n),tC.Promise.reject({code:n._errorCode,message:n._errorString});if(i<0||i>=n._ImgManager.count())return oE(n),tC.Promise.reject({code:n._errorCode,message:n._errorString});var o=n._ImgManager.convertClientIndexToServerId(i);return-1==o?(oE(n),tC.Promise.reject({code:n._errorCode,message:n._errorString})):n._innerFunV2("GetImageSize",Rx(o,t,r))}},{key:"GetImageSizeWithSpecifiedTypeAsync",value:function(e,t){var r=this;if(r._resetErr(),!r._isValid())return tC.Promise.reject({code:r._errorCode,message:r._errorString});var n=parseInt(e);if(isNaN(n))return Dw(r),tC.Promise.reject({code:r._errorCode,message:r._errorString});if(n<0||n>=r._ImgManager.count())return oE(r),tC.Promise.reject({code:r._errorCode,message:r._errorString});var i=r._ImgManager.convertClientIndexToServerId(n);return-1==i?(oE(r),tC.Promise.reject({code:r._errorCode,message:r._errorString})):r._innerFunV2("GetImageSizeWithSpecifiedType",Rx(i,t))}},{key:"GetImageXResolutionAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return tC.Promise.reject({code:t._errorCode,message:t._errorString});var r=parseInt(e);if(isNaN(r))return Dw(t),tC.Promise.reject({code:t._errorCode,message:t._errorString});if(r<0||r>=t._ImgManager.count())return oE(t),tC.Promise.reject({code:t._errorCode,message:t._errorString});var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(oE(t),tC.Promise.reject({code:t._errorCode,message:t._errorString})):t._innerFunV2("GetImageXResolution",Rx(n))}},{key:"GetImageYResolutionAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return tC.Promise.reject({code:t._errorCode,message:t._errorString});var r=parseInt(e);if(isNaN(r))return Dw(t),tC.Promise.reject({code:t._errorCode,message:t._errorString});if(r<0||r>=t._ImgManager.count())return oE(t),tC.Promise.reject({code:t._errorCode,message:t._errorString});var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(oE(t),tC.Promise.reject({code:t._errorCode,message:t._errorString})):t._innerFunV2("GetImageYResolution",Rx(n))}},{key:"ChangeBrightnessAsync",value:function(e,t){var r=this,n=parseInt(e);if(!r._isValid())return tC.Promise.reject({code:r._errorCode,message:r._errorString});if(t<-1e3||t>1e3)return Fw(r),tC.Promise.reject({code:r._errorCode,message:r._errorString});var i=r._ImgManager.convertClientIndexToServerId(n);return-1==i?(oE(r),tC.Promise.reject({code:r._errorCode,message:r._errorString})):r._innerFunV2("ChangeBrightness",Rx(i,t))}},{key:"ChangeContrastAsnyc",value:function(e,t){var r=this,n=parseInt(e);if(!r._isValid())return tC.Promise.reject({code:r._errorCode,message:r._errorString});if(t<-1e3||t>1e3)return Fw(r),tC.Promise.reject({code:r._errorCode,message:r._errorString});var i=r._ImgManager.convertClientIndexToServerId(n);return-1==i?(oE(r),tC.Promise.reject({code:r._errorCode,message:r._errorString})):r._innerFunV2("ChangeContrast",Rx(i,t))}},{key:"GetImageAsync",value:function(e,t,r,n,i){var o=this;if(o._resetErr(),!o._isValid())return tC.Promise.reject({code:o._errorCode,message:o._errorString});var a=parseInt(e);if(isNaN(a))return Dw(o),tC.Promise.reject({code:o._errorCode,message:o._errorString});if(a<0||a>=o._ImgManager.count())return oE(o),tC.Promise.reject({code:o._errorCode,message:o._errorString});var s,u=o._ImgManager.convertClientIndexToServerId(a);return-1==u?(oE(o),tC.Promise.reject({code:o._errorCode,message:o._errorString})):(Et.isNumber(t)?s=Rx(u,t):Et.isNumber(r)&&Et.isNumber(n)?s=Rx(u,r,n):Et.isNumber(i)&&(s=Rx(u,-1,-1,i)),o._sendDataByHttpAsync("GetImageByIndex",s,"blob"))}},{key:"GetImageInfoAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return tC.Promise.reject({code:t._errorCode,message:t._errorString});var r=parseInt(e);if(isNaN(r))return Dw(t),tC.Promise.reject({code:t._errorCode,message:t._errorString});if(r<0||r>=t._ImgManager.count())return oE(t),tC.Promise.reject({code:t._errorCode,message:t._errorString});var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(oE(t),tC.Promise.reject({code:t._errorCode,message:t._errorString})):t._innerFunV2("GetImageInfo",Rx(n)).then((function(e){var t=0,r=0,n=e;if(Et.isArray(e)&&1==e.length&&(n=e[0]),Et.isString(n)){var i=n.split(",");t=parseInt(i[0]),r=parseInt(i[1])}return{width:t,height:r}}))}},{key:"IfShowUI",get:function(){return this._resetErr(),this._isValid()?this._innerFun("IfShowUI"):iC},set:function(e){this._setIfShowUI(e)}},{key:"IfShowFileDialog",get:function(){return this._getIfShowFileDialog()},set:function(e){this._setIfShowFileDialog(e)}},{key:"checkErrorString",value:function(){var e=this._errorCode;if(-2115===e)return!0;if(-2003===e&&!xt.DWT.IfHttpPostErrorNoWindow){var t=window.open("","ErrorMessage","height=500,width=750,top=0,left=0,toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no");null==t||t.document.writeln(this.__HTTPPostResponseString)}return 0===e}},{key:"OverlayRectangle",value:function(e,t,r,n,i,o,a){var s,u=this;return u._resetErr(),!!u._isValid()&&(u._isNoViewer()?u._nouiNotSupport("OverlayRectangle"):t>n||r>i||t==n&&r==i?(kw(u,-2375,"The left or top or right or bottom you entered is invalid."),!1):(s=Et.isNumber(o)?rC.getColor(o):o,u._UIView.OverlayRectangle(e,t,r,n,i,s,a)))}},{key:"SetViewMode",value:function(e,t){var r=this;if(r._resetErr(),!r._isValid())return!1;if(r._isNoViewer())return r._nouiNotSupport("SetViewMode");if(Et.isString(e)||Et.isString(t)||e<-1&&t<-1)return Fw(r),iC;var n=Math.floor(e),i=Math.floor(t);return r._UIView.SetViewMode(n,i),!0}},{key:"ShowImageEditor",value:function(e,t,r,n){var i=this;return i._resetErr(),!!i._isValid()&&(i._isNoViewer()?i._nouiNotSupport("ShowImageEditor"):eF.isServerInvalid(i)?iC:i._UIView.GetWebViewer().webViewer.imageEditor?i.ShowImageEditorEx(-1,-1,-1,-1,3):e&&t&&r?i.ShowImageEditorEx(-1,-1,t,r,0,!0,e,n):i.ShowImageEditorEx(-1,-1,-1,-1,0,!1))}},{key:"ShowImageEditorEx",value:function(e,t,r,n,i,o,a,s){var u=this;return u._resetErr(),!!u._isValid()&&(u._isNoViewer()?u._nouiNotSupport("ShowImageEditorEx"):u._UIView.ShowImageEditorEx(e,t,r,n,i,o,a,s))}},{key:"SetSelectedImageArea",value:function(e,t,r,n,i){var o=this;if(o._resetErr(),!o._isValid())return!1;if(o._isNoViewer())return o._nouiNotSupport("SetSelectedImageArea");var a=parseInt(e);return isNaN(a)||a<0||a>=o._ImgManager.count()?(oE(o),!1):!eF.isServerInvalid(o)&&o._UIView.SetSelectedImageArea(t,r,n,i)}},{key:"first",value:function(){var e=this,t=e._ImgManager.count();return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("first"):(t>0&&(e._UIView.Go(0),DG.__innerRefreshFromUIView(e,e._ImgManager.getCurrentImageIndex())),oC))}},{key:"previous",value:function(){var e=this,t=e._ImgManager.count();return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("previous"):(t>0&&(e._UIView.__Previous(),DG.__innerRefreshFromUIView(e,e._ImgManager.getCurrentImageIndex())),oC))}},{key:"next",value:function(){var e=this,t=e._ImgManager.count();return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("next"):(t>0&&(e._UIView.__Next(),DG.__innerRefreshFromUIView(e,e._ImgManager.getCurrentImageIndex())),oC))}},{key:"last",value:function(){var e=this,t=e._ImgManager.count();return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("last"):(t>0&&(e._UIView.Go(t-1),DG.__innerRefreshFromUIView(e,e._ImgManager.getCurrentImageIndex())),oC))}},{key:"_isBindViewer",value:function(){return!(!this._viewer||!this._viewer.webViewer)&&this._viewer.webViewer.bindViewUI}},{key:"_isNoViewer",value:function(){return!this._isBindViewer()}},{key:"_innerUnbindViewer",value:function(e){var t=this;t.__funResize&&(Et.removeEventListener(window,"resize",t.__funResize),t.__funResize=iC),t._viewer&&(e?t._viewer.webViewer.dispose():t._viewer.unbind()),t._config.container=null}},{key:"_unload_viewer",value:function(){var e=this;if(e._isBindViewer())e._innerUnbindViewer(!0);else{var t,r=null===(t=e._containerElement)||void 0===t?void 0:t.id;r&&delete xt.DWT.ContainerMap[r]}e._ImgManager&&(e._ImgManager.dispose(),e._ImgManager=null),e._UIView&&(e._UIView.dispose(),e._UIView=null),e._viewer=null}},{key:"_innerRefreshUI",value:function(e,t,r,n,i){var o=this;return 4==i&&o._isBindViewer()&&(0==o._ImgManager.bImageJustChangedInEditor?o._ImgManager.bImageChangedInViewer=!0:(o._ImgManager.bImageJustChangedInEditor=!1,o._ImgManager.bImageChangedInViewer=!1)),r&&o._ImgManager.refresh(e,o._ImgManager.count(),!0,n),Et.isFunction(o.__OnRefreshUI)&&o.__OnRefreshUI(o._ImgManager.getCurrentImageIndex(),o._ImgManager.count()),!0}}],[{key:"ProcessGetBlobByQueue",value:function(){if(s._getblob_queue.length>0&&!s._processing_getblob_queue){s._processing_getblob_queue=!0;var e=s._getblob_queue.shift(),t=e[0],r=e[1],n=e[2];t._convertToBlobForUpload(xt.DWT.EnumDWT_ImageType.IT_PNG,[r],!1,4,(function(e,r,i){var o=i[1][0],a={imageId:o,uuid:t._ImgManager.convertServerIdToUUID(o),imageUrl:URL.createObjectURL(e),minImageUrl:URL.createObjectURL(e)};e=null,t._ImgManager.UpdateImage(a,n),s._processing_getblob_queue=!1,setTimeout(s.ProcessGetBlobByQueue,0)}),(function(e){s._processing_getblob_queue=!1,setTimeout(s.ProcessGetBlobByQueue,0)}))}}},{key:"_getContainer",value:function(e){return e._containerElement}},{key:"_setContainer",value:function(e,t){return e._containerElement=t}},{key:"_closeImageEditorUI",value:function(e){if(Et.isFunction(e.__CloseImageEditorUI))try{e.__CloseImageEditorUI()}catch(t){vA(t)}}}]),s}(tj);function fj(e,t,r,n,i,o,a){var s,u=e._ImgManager.convertClientIndexToServerId(r);if(-1==u)return oE(e),Et.isFunction(i)&&i(e._errorCode,e._errorString),!1;if(s=e._innerFun(t,Rx(u)),o)return s;var c=1==s;return c?(a&&(yF.refreshImageAfterInvokeFun(e,r),e.getView().ClearSelectedAreas()),Et.isFunction(n)&&n()):Et.isFunction(i)&&i(e._errorCode,e._errorString),c}nC(dj,"_processing_getblob_queue",!1),nC(dj,"_getblob_queue",[]),function(e){e.normal=0,e.balance=1}(lj||(lj={}));var hj="data:image/gif;base64,R0lGODlhZABkAKUAAPyOFPzKjPyuVPzmxPy+dPyeNPzarPz27PzSnPy2ZPymRPzGhPyWJPzu3PzixPzOnPyyZPzChPyiRPzevPz+/PzWrPy6dPyqVPzOlPyyXPzq1PzCfPyiPPzetPz69PzWpPy6bPyqTPyaLPySHPzKlPyuXPzmzPy+fPyePPzatPz29PzSpPy2bPymTPzGjPyWLPzy5P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQJCQAxACwAAAAAZABkAAAG/sCYcEgsGo/IpHLJbDqf0Kh0Sq1ar9hslXI4aEwHFUVLLicpjUBrBACMFKTG2Ewne1Khtl4fSnnqgFYUFSJ7hgAiFXOBjE8mDIeHIyaNlUweGZGRGX+WnkYTL5qHIhOfp0MubKN7Iy6oUhQwDSYmDTBPHiyshyydsEwUJgslCiIFCgkPcpcJvIYJv8BJBy4okW8r0kceIM97LIvTRw0Cq5ojBNtGqt9uC08qGisnBA9g4loHAt8jESpKJhT6VqqJMALn3AiYsE7QAneIFCVRkelbiYZFKDhooanAinxWHFyDKABXEhMJ0VFiAkMBqwITQE6hEAGinhRKBg3UlEim/pENzwQcyAKDn00AJ3wKucMxUogKGIsc2DlqhIMsGjgcBRBC6dI0Cla9IaHBKxEHKTWRyGKCqjsUZpeqOFArTFwiK9JGIsDW7TcOd7FU0HuIL5asWwVELfPo2wOiELYuCHzFQ4FnIzRkoYCBsCYGVz3lZZVuMRQNLiGyGOrpQORRClZuHv2tgAPKWNBA0KvgdhkPJzzrYfDBNB0uKwowYDCCQYETMHA78RDB7x6P42J4MFFhhQPWgA4YKJGWAQgHxrObkdXhhAAOHDK4wKd+GgUKHu5Lr8+/v///AAYo4IAEAgODBhNoYFKBdVCgAQkKMDdCcwq40EB6DDoBAwbW/rUhwgMLZlhFA7vxMkICmolIxQEhCLeHUCpK4YEzNvkiIhomOGACDKYNdhQDFWR4wAMCiMKAAA+AZ8QBFR2VgZIBwsACJHswwEKIRAi0FSKmDEjBLtiEYwQFJGzZBgb7eWICabIN4QEBZiKFISxAsRLBkmBumQCU/pXASwZL0rjlagMaNQqgRbwZpzoDnsDLnRmVaSYJaVoygGeTHKHlVgV5mWcvMjG5JQR8/icllcOBgCURKaDqDgM4MXgAAgJAciQCpbopqDs2ZugBDDnaYhwMF7jYxggwxihFAxm4OAIEKSq77AMdIoJBA9JW4UEDLkQ4IYUWzpmtEgcmuOq4/uimq+66/qHhwAQfVDABGOxGodECFyjnBgMoZBAAM/UuAcMJl6HDAQniZiuMVt9AAHDAQ1AwAcPuCIAtxENo0JRNECTs664QjUApxg7EycHFp/x64XpNbjVCAJVS4cAGJQhggR9kaFCtRecCsqmHk2mxgqtbFdAmIw5Y94EWNcUJAKyWeFDnISF4fIQFTrcRZCUw+BmJCNFagXXWWzdSFE9HUzG1mQwYYIkKYx+iQK5RPGAsKyKEVkkK1r2SRdJOh4ByIx48ZEgJdEfhwcYuJ/UJBSu0UIAIEriQuBQVxFnAALBsR68ZBzBuEwExC0hBBzt31LMRKqRAAAEpAESgYgfU2sSB3kscsOueBXqQnDshxOTECocsXeDpokeCImWv7QFBhlxUEIIIEx7LgAgQoBeF13sgeqMJD7gAAgEurPAwFHYb8hjGT4iqB6nsPyELkSWAWHr8+Oev//789+8/u0EAACH5BAkJADEALAAAAABkAGQAAAb+wJhwSCwaj8ikcslsOp/QqHRKrVqv2Kx2y+0uPY1JJ+XQeLxob2OhYAAAjNaika5fKYPL6M0HjC4DFHaDUSYofYgAKCaEjUweAomJAmeOlkYOe5J9Iw6Xn0MEm4kEoJ8UCqOICoKmUB4aJiYNrU4UHKp9HLWuSwcBAhwoBQolFZVMFC25fC28vUceFQWSIyEOz0gWzG8W0EoeLm6jIilNmdyeUBQNsg3IXhXjqhyMX5G5lK8uF8IKJ3S8HKDGjQU8JA5wjeKgzkmDEprejECBrYsLbm/KJXOgJ9Gfik5g4EtUwJ4WSBjfLDiIpEGENm8YKIgQ0NaKiKRYVtGgEGP+Ahi2NExIkWKChmy+QKgKUROLA4IYBTQddCCEqpJbBhxKKQCoowMXVC3aokFCSgAsDljycELVhalWUKZ0gTQNBQPzEI2IUJdKBZxiB3xSsQHwm65dPFhlNmKDzkEwXIjowwAC3CxPmbXwCspDCgICLrBYoRYNhRRQPba4bImChwMHPPTVYoLFZEQcInD+tjbFAgglSrAgYeIxb0KvYcA4MPu48+fQo0ufTr269evYs1t3DaOBdxiytXOB8VnBixEiJJwwsFt8lQEl8vJhUEKweyoUKvTcxMFA8/tG5HdbLiJU8B+AQzSwXy4csDYdBTBoAMOBF521gHYutcBBCBv+OCgEDANiVEB70lHgQAs4tRBIEvKcBUcF1x1QgiQllHbEAi6+EcF16HjUkBHb5OiNdRiMgkESSgl5HQmjkJAEji7uxaNhfvxYRItnMQCjdQeM1IcANhoBoosjXodHKn2oOBuUKV2YXQMnhCBBCAAxoWBKDYoHoYQHCshNgQciKER+CybCgYGCRuFAfJLQZ2WiIVVAgAQijPCCBARUQCKktnjQ3XfhcSrqqKSWauqpqBbhqSwTppqMCScoUIAIBRTQAgm0uGqEBw5AQCUcAAWaKAUPpLaJAiClSsEKL2AkwaOknmZsLkyl2oCXGFkgrHb5/aoKAx7aQcG2T3gwY47+ALgAigoYXCBHuFIc4G0urDThGmyhTqHCYm+gYJ8WDqD7RgHhHjABBhFYAEIEGEwQ5hMBJFICuUoYIDAAIpi06wolTFtACSsYF80yej1sRQUXZ3wEOyHIhwgDTAXqAZqImFzFBBcTvOsEhW6CwgSBioIbxUnAcLEEB5loFp7JKqHBVhkhelLP3IAgJrbcXGDzEb3uEUIKIktBAQnzbjLCv0NEIPCOnXqQ7xYN0JwSBM+Mia4Im4JCrMtXPfpA2aOM8IBzB5wAeEYrPENBAhcDkADRaHhAAN+IFBCymCQLvNlzKjygwK8jCJACUnderAC8l7CDweecQKBpXWU1zoFdBiWCYUIFKZgQ22xxN346qR6EdbEAKpQqtMCllDrB4dVMYCoF/LoYAuTVpUD5t+acKnmOJ4QtKAwgMD8CC3mPWvj180WwdakeIICi2S0g4P2o7KwgAE6hr5ArKEEAACH5BAkJADAALAAAAABkAGQAhfyOFPzKjPyuVPzmxPyeNPzarPy+dPz27PzSnPymRPy2ZPzGhPyWJPzu3PzixPzOnPyiRPzevPzChPz+/PzWrPyqVPy6dPzOlPyyXPzq1PyiPPzetPzCfPz69PzWpPyqTPy6bPyaLPySHPzKlPyuXPzmzPyePPzatPy+fPz29PzSpPymTPy2bPzGjPyWLPzy5P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAb+QJhwSCwaj8ikcslsOp/QqHRKrVqv2Kx2y+16v+CweAydRCyVjyUyIbujkwYGQK9jGu23Xtkg1f8AJA17hEYdLSKAdSItHYWPMA0Jin8Jg5CEA4mUdCIlmIQRnH8OoGUvJSUHeVAlm5yepkwTLyMaIrgMCQWrT5KjAJaySh0OK5QiGBmsS4evgCIBjsNHZhrAApdNfZyCVRPTYS/HwAAszEq0JM8iguhNcQYrGiwO71oj5XQMEWURIAIqrLk36wSDPyIWhNsy4Zo+ACgIisngEGG/Lg0OPqxwoFCAZ3a8OAA5StieDhY4aViYxdXDYNreTDDACQJLLC806hPQkdD+A5IAQHiZ8OGhCAkSxZFDmOELBaCAQjR91KCCRhEJ2Hw5oKAcI1AHEKBA8QAPmAkZKowSAaInqAlJtcRhobNOiBYvqOkxY0FAghUCUMTUK/NAhgYp4hJezLix48eQI0ueTLmy5cuYM397kaFEhheKNS+Z4ICDAA0mNAjgYE/0lA4oQigSEQLFTdd8BJTLhrvJCxZQF7HI2zvJBA/B/zBQEVov3OYHILwM5jZyBw8QQkDwcLuIg+l0SklOseBVwhRL8oEfMdmB7D8ELiahCd6A5AkXKD1IigI8APuRTfCAfkkF4B97kkXwnl3yIfEdeOJFdoAE5klQ3REHTPJSAhf+PnZddtt1R8QEKtQ1ynLNUQNOir8lB4AIwxW3RAO6YTOYjEd0YMCCf9QmIo5EFCOBABBoAIEAEjjwI5BF0JJKCaAxKeWUVFZp5ZVYPgHOCy8kluURL5yAAgYkCICBAWWN8VwHHcAFSgoPJGDiiyZIEGUXHTSgAgYmMMCABiBEcKceHZSgITAhULBkFAdcIN1sHyi61wmP6sPAA4s68ducPbaQ4hUlVPRQCB58ikQHfujDSKZXZOgfAARESEUHC0yXqKlwGPgqABiwikQJJoAnAHFgvFCpf7HMKgGyJ4hBAacvcVBFA0X5ZwGuTsy0ax0QYAtDCTy+tBIYB8yxLaz+Nzox0qsMZFqMCi20oIKSS7yg1rkhfDLFusj+SIstDOCSiwYjDFoEjecCkC8VA7jwKgESdUCBqIpowB2GqW4bQrrbHDqdAgR18AC0yu1nSErnjjvFASC8ylw1Jb7kQqlGjOAiMBhYcUK45ZjUpAPBTmdCa0RkQMC5DUrRQcsvMXDBPSnQVx9L2u66gq9INHAsMCx0KEQGPOvjwo0NhF0OAxR4S4ShXmFArBEIbIuAESTejBAKXk/RAAhhi0CABOglwcK2LOT4gNmzWZA3FSkUYEECIYjAQAgfJLlkta9WcKoKR59t4Rd5luCAAyWYxcRS/q1g3AAKBFfBCVi7kbFpfyQ0U0ILkIcQAgH0OODlYhxsK20THXAGZeyhbJt0cS9Q/JAGb8sooN2LmCzlC+a+pED0QJaw9SgQTEVlHB8kJ8IKplv5ggS3zKaBnV/CUOgICiRAAAEJKDBCCcj3NsEBDThMA3qBiSAAACH5BAkJAC8ALAAAAABkAGQAhfyOFPzKjPyuVPzmxPyeNPy+dPzarPz27PzSnPymRPy2ZPzGhPyWJPzu3PzOnPyiRPzChPzixPz+/PzWrPyqVPy6dPzOlPyyXPzq1PyiPPzCfPzevPz69PzWpPyqTPy6bPyaLPySHPzKlPyuXPzmzPyePPy+fPzatPz29PzSpPymTPy2bPzGjPyWLPzy5P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAb+wJdwSCwaj8ikcslsOp/QqHRKrVqv2Kx2y+16v+CweEwum4sS1yYg2rgk53gzIgDYQ5SIfI9sJOyAAAkNfIVCEgWBgSZwhnsNKoqAKoSOchh/koIYlnKQmoKVnU4SHByNUoghmoyjTRwRDiwBKSSoUA0PkoOuTC4VBKsAIRkWKFN0gHh6vUouI5ohEAepaiIBbreppdpeHB+gww7dcQ0LCSUFtmERBOEAKtSFB3WADwNgEg7vw5yFKZJWkMPCYQE/ABsMXZAEYuAVDiwOJiwETlEJh1YkpBAGKoSoPScktfpCIsM7AfL4cFgRiMLHLhJEMAAFYgNGMhIiFKgwISX+GBQaOAICkYJDszIHHCQQFmLEBqNHy0g4QGJDhAYHbkbdyrWr169gw4odS7as2bNow3BwgcEF1LRVOJwoQCHBgwQUCpx4C7fJ1BPBopXoqRWuBAwrhEZbgaEw1QEkfH5t4EFxRw8v0TQokAGE5wcFGhR2hKLeQUAjJA9BkcKdJAIpVPfiUMAyvxAF+AopaPvOAt29NoA4zXDiEAkTZr5r0WF0HBQmeh80wZfyacxRG5gkLimDKAknpAcKccK5mQjcoxmXYJD4AvNlEKTXlGLISu4rgFuKOF9RAPsVnfaBfo6I0J8iLBwHAXcQEGgIQAcCUt8h4Z1GHnxkoBfhMMz+CGHdQS5lt92B3hGBXAv8MIchGSgkEqEJkvEWTgi/cSXcgQQYRwRrrikC2zFc0dZfCBUQKMFmnXmWQWgrxnEABfN5IFsRLpAQAQkujPXhQSF44E9fSByW2G2MNSmWBChMUIJtIQyWFZhOyEVXAhngpZeDcCpxAFsuTJnnn4AGKuigUJRyAgsfrLDABG+MUYoLDTTgliMSkGCCcoooEAGQXhyQQgEjJKDCBRA8pVIKI2oCwjQwRTACpoAQ8EFmY3AgAoq3KYBnFBykMFw4GXSIkwOwvhMCdVqcUKwmJdBKUgnpMdAcFgek+s6AZHBgQn8jZHmFBdzVRMYBy3Kp4xT+B0TCHbJiTPCimS+Q0ONp3Y6x4IEe7LrEjdzxIkaA82WgrxIn/Eqcv0uU0kAEKaRw1SlMsHRgCQMn0U56FHjrzAkCCBWCACf4KcS2+FaMhAuZEFeByC808EG5ADAwqxIQ9odtFYhwx0AKGLmggnjwaGxEAxFOAG/LBvOTmp6m8YNSmAvNl8CXVlgANAAgCGuErVffIcJA/BIXgggmKwGdeAwggNGW1zl7NncXCH3FASIkrUwGey1RIXfkJeGCAl2X2EUDJqhQAggElOCBBXIfAVF/LDhIG8x2MHCBs1hMNcAGG5DA6RLf9FekEr2+KkkICYjQeCcoSJzeCiynsYFdBgJkUIIABUzQQNlnCDkfu0yUYoopR4uhT3/jDBqB3fxkTegBUROnAMtwXXxajoQe4sDVISSf/QsQUR5z5N/bd4IKyzKgQt7lE+GpAnXhpUBs7YcJKQYH8F6/IUEAACH5BAkJADAALAAAAABkAGQAhfyOFPzKjPyuVPzmxPy+dPyeNPzarPz27Py2ZPymRPzSnPzGhPyWJPzu3PzixPzOnPyyZPzChPyiRPzevPz+/Py6dPyqVPzOlPyyXPzq1PzCfPyiPPzetPz69Py6bPyqTPzWrPyaLPySHPzKlPyuXPzmzPy+fPyePPzatPz29Py2bPymTPzSpPzGjPyWLPzy5P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAb+QJhwSCwaj8ikcslsOp/QqHRKrVqv2Kx2y+16v+CweEwum5EUynkd7Uwuo0mHTVemTCEAIGRK1f9FFyJ6eiIjUhQdBygBJgQLIA0daoBPFAWEhCeUTm4qDJmFJCAHnJVKBy6hAAwHTwcLeauEDCoNp0yXq5tOLxWDs6EfGbhLI8CFh00HHsHBw6bFRAd4enyuuQHOzirYXB0ZICgN0VEHb3FzTS+y26sMIOVWvgUMLgUt8lBpUC3uzgLUZWmAKRQGb2QObPjn7FaWDghmGdLnxUE7hqFYaMlwMROJF2ZAgMK4SoMWFKpmJSBW5gEykoRUaOEwctVKMw9qwtTjQQv+wWAQEIoRuTPTAi0UTMxiwIJilxIdYYLY0gGCThcBnHbp8KGoHgYgtxx4IGBDAggG6LDwCkCFQKQvSmQoRUdh0RATtErbR5SkiAhv92LpkBOjiApCBWMZqzPY4bCKvxk4sS1EgMSRs1AYKyCECwagQyRoQS6zGAoZULB4AKKEH9OwY8ueTbu27duyOzRAYQJDAgwmxgXGHYVCgxYFQ+ErTbz4BAHuBOS1xM82BQ7JtxWYroTCCwcXTDxw8EJvsRIpGYYo0X0CBmQMMHCH3YHETgzDh6DITqgAB9koNPYPAyggwY4zIUAWGUReITAcBRq4o4F5dWQggVc3FXHACu7+rIBZMRNEpd4ERmSw0DYbsBSZAenB5EJaRZjozgkqKhagVwzAOE0C7iTwIS4heoWXERC6YwKFdGTAY1EZFnFgMAnSB0GD+cGw3ywFFBjbjTDBkwQF7tUU33ymHWAfTCRUKYR3DoygwQjkIVlJCQIiyF4TaciJC5j8BbOdnriBacFLoYhgAZnN4dnAAn0CsBygicKgGwe9/RbcC2pGqummnHbq6aeghlpcnqJa8p0CLWjwwASSkKFbBhmUd8oLCghA6AYBZAApniAgkIAEG6ygwp11NGCVYxY4sOuXDRBA6B6XLUtFA0tWxoG0RVDgQLWzfLTGC2f+E4JDWbxgwT/+BGBrSWEYEZApFC7944IDZrwAHUknDPBQo7OooG4TEzzrTj5YZCCwSgqCQcEDRXnwmhUoHLzKBsSGQUEERXl7RcQYUYyInEllnPAUJUgcSgLkMnFACRMowAIHJfxIBAUjFNXNYiLOAsG7QnTggAonIHOCB3IwEfBOC/DcRAUMiaAREx2MwO8JF7wrI0khaInFT9Hp1UEEJgMAWHcthJ3JzkiBwK8eTSrBsTsi/KdEBueO+A0HXa0iggoD6HVA3v98IDOYOWcyURfe4SHC4gwUwAJdTIDQ4jYvLsFnZSMoTYXPE0xQApJFkjSh5RlU0GcIGCibWQcqwORWEz4HUAFdBhioAMnDkaUQEUkOWpLCCy8coDkgFDBNUgX/mnaMYQGUOgRUGK3n/JqtM+TB8IkesDYhG4wsKpjc2oSo8xSUAMGzIkBQAvabJsIB0CGEcIIKciTf3AHeT69/qUEAACH5BAkJADAALAAAAABkAGQAhfyOFPzKjPyuVPzmxPy+dPzarPyeNPz27PzSnPy2ZPymRPzGhPyWJPzu3PzixPzOnPyyZPzChPzevPyiRPz+/PzWrPy6dPzOlPyyXPzq1PzCfPzetPyiPPz69PzWpPy6bPyqTPyaLPySHPzKlPyuXPzmzPy+fPzatPyePPz29PzSpPy2bPymTPzGjPyWLPzy5P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAb+QJhwSCwaj0gk5dDYPBaRx6ZxoCSv2Kx2yx2mThYDYExGfU6prnrN5r5WIbKcHFq92vg8m1ICzf9kLCVWeoWGRnwTgIsACoOHkIYHAoyMAgeRmXgPlZUPmqBdL3GdiyF3oalXDyKliyKfqrJFFBiujBiEs7MvLLeLLKhYFMS6u2olHL+AHCVXFC8lJw8PFQ4NxsdZJSjLfyjOSC8qGKRjDCAB2Npayd5zzUgZAgyvCifZ7EYvCu9yCsKGUHAgphODB/n0CbTlbwyEbIluicCnEAmnhrCMHFjR6haLBqAodMjQoEPCfea8nTIiod4vEQE6ZDrQwqUBFSeLXPSWkVb+gncfI1Fo0fGcBC0HSLy7ZKSDi3cMHERK4VIOiZwCSyj6pcBBvgYNcUIqwQxkFj5+SolwlJCsvxFY1WRgFhDLm5R/6tQl4vbdhbhdOhSUswIwkQMbLCiDZ+EEpiQvGlYwvIWCh6IAGJjtsiSDhCcLpGSogkXwuxBShUrAwGHChwwKKUR4h2HvoRePKw7AaxBhxVkdZv8SYPu3phckMDMyANv4rgYClP/hcNT5sQYmeJ9b8cj6sQ4lIgwGECKBBNLe2RE7kCHDC5Pp48ufT7++/fv48+vfn17kAfj8aQKNBAGY8IEJI2zwAmUBnlWBAE/J4QIJHsjUYB4paFDVHwz+RJDbhWq88FMpdmxxgAMbOFCcfR0Q5YoILViYBAUFgGBACAYIQNF+DWhnymZHdPBAhGQcJCN+wv2iwRUlaBdCOPh10M0yKBxZRAuMtKBfBj4yEkJzRyi1CAn6ObChK1ElwRAgGJR5ZilpIoHlIlrmx6VKYBrRJCBP6ielN1UmISSRY7jwgJX2aeDNks8UIMCNKAhQAIPO9fhLCEBC5oAEKjbYonSAwIgoiFgckACocohQIqlqZPhmkRp8yCoXFKgA4RwuCCDWrHu8sMEIBByY4IK86uEfgMUmq+yyzDbr7LPQRqveqNIicYAEF0SgwQgnZFotER2sFkJRISiAQBr+qXQQzQMqjEZpJiks8CoAqq6jyQEBTDnGPejq08ECpdR2nAWAMDCCrLtsMO8cdULy6SIM7HjMAWt2shIkBFWiAMKqnNDlHw0XQsEIpUA5y8ioAvLQIR0QUEoF2gS3DAj96tEBwZ2oELOiv4DAMRsdBFBKaruMvMxVkLRUiQErItGBA9kucIEE1B5RwcJ/RBDJARBUMkLVR5RQTkciGICByVc00M+LaBfSQFpziGBB00V04IGPIagA9hCsuFKYJhlAkJIBC9BNBAUeLy2xoCuUokCeW//6gQUPOLB33WtrfDkMDVT8R1fvqtFBCshyccItJ2gBTQvjxv1a6No07ndgFw2MgAEIIJCwQHf3UZB5JwqEnsLP9VGwWCkcwH4hJa6Q+S0Mc5YSsrQZpEyGCJBHS8EHpVigPIgvQICqCBAY3mwDFrzJgAXZP39ABQmQUkcFxH/r3wH4l/78/vz3T0QQACH5BAkJADAALAAAAABkAGQAhfyOFPzKjPyuVPzmxPy+dPzarPyeNPz27PzSnPy2ZPymRPzGhPyWJPzu3PzixPzOnPyyZPzChPzevPz+/PzWrPy6dPyqVPzOlPyyXPzq1PzCfPzetPyiPPz69PzWpPy6bPyqTPyaLPySHPzKlPyuXPzmzPy+fPzatPyePPz29PzSpPy2bPymTPzGjPyWLPzy5P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAb+QJhwSCwaj8ikcslsOp9QZad08lBOpUN0y+1CDyoMx8UQhVAYldbLbnMnDpAIQK/TRSDJxM3vIzsUDHaDdQwUHX6JfRMUIYSPACEUe4qVXSUKkJAKJZaeUB0EmpoEiJ+nShkuo5AMGahsGRQBEREXFGtLCKyaKrBREx0nJCFlcyIMKCslpkgQvJAQv09wAnOaIgQNlEYc0I8c003CBt8CA9xEjt+DBuMlFA8PHg4pihMn5ewsr0Yo7IPCKZlQYgUHYwwMWDiRjg0cfQBZ5BqCAaAdDEoORBD0SESCbW5SWLBYR0NDFSTp+EJyQBQrCw3cFEhJx0AnIhk4AnSFZML+iGusEjR7I4AmABER0nWoQJKAvSMlvEETcYJNiXU0BcTEKfUbpz8RAIKYGEWFzpQoBhRhhJWVpIZDGoAAaMCBlwVAUzLYYATQ2VaHkmRoy4vBSi4mjN6hcGSCBBZ57YhgoUdJicisRIzwklixiAJJwGBAYcwFBxJqmJT4m3lzlwCYAbqQsOQAFQoeTgx4yiQDRGiGvARSzOGmpRdF2RX30uA3SQxkE/mMDWnFUGAJjIp4ADdRAxbfGKhl44A6Lw5bP00owPpR0jYdVqTc3l1Rhwft62SLzqVBcnYirFBfJcIoEBsHI/DWBhzgfSMCBun9MkEDD5BgAAMJWRBBCQP+vpFBJrwECJI4QkzwQgYllJDBiJUcsAAK1DHAgQodkojKBBksIMAYyITAQQIPsGjjkEO8UIIEJ5wgQQkKEunkk1BGKeWUVFZp5ZVYZvlGCjVq6UcHDrTwAQQftODAdV76QRAGIQBlBgYcpplIBwWYZwiacr5xAmGEhFBAlyUaKWSe30HDQoQ9NbAChgysMKiWEwTAzgg1vlDRRS/kCcMBXZ3X5FoqRCYCjXm+YB4hImSaRAedDWICnleWYJFxR4TySCl5ZmBRPz2ZNYhhgEZpKoCqJvECCYOQUGyaKYAIjQL8EWFiBYxW8EKwUU7QwqSATujAtZrG1SArh4brxXr+fA7iJ6zmjjMcYOy228SabZkBQZzytpFCmBWQ2YIEn+br0AHxCmzwwQgnrPDCDDfs8MMQRywxlPhoAAEGBKQ28R8SyCGZASoU7EYHDaQI7pMdqJDuURFEy0cDC4DAAQcCjCDyJxKsTAcDNltygMf6vUrkBHOxYgCifMTXEaVDnnBqHRFUchUkAiw7jQlP06FAJe8SshyJE1xaGLZO+PqITTaGHR7ZTTiwMghIw8IUNAIlcsB/kkVwsyIUZA0AAZasRgjcRB7gXEd2VUKQAMUwEEICLg/UwAgGiqDACI8qEeooIgjtyb5WMPOGA+PWwYID2HawESQiQBC3lRkUTQhgP1+MwGfnr1fJ6iieO0FyBCxgyIEJZ+b6jyYo8LoxDOVxnvjyzPPy/PKCa8IArRsjN0rV0AtxX34McNe9EAd8gJkIH0QesbYw3oFCC2wzjOMDC0TwQAbxj6///vz3v38QACH5BAkJADAALAAAAABkAGQAhfyOFPzKjPyuVPzmxPy+dPyeNPzarPz27Py2ZPymRPzSpPzGhPyWJPzu3PzixPzOnPyyZPzChPyiRPzevPz+/Py6dPyqVPzOlPyyXPzq1PzCfPyiPPzetPz69Py6bPyqTPzWpPyaLPySHPzKlPyuXPzmzPy+fPyePPzatPz29Py2bPymTPzGjPyWLPzy5PzWrP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAb+QJhwSCwaj8ikcslsOp/QqHRKrUI7pcmk1LF6v9ZOxlNgmBmFSqYLbruRjQgDQK/TGZrGe/92YeyAdCIkLnyGYRWBigAVbIePThQXc4uADBcUkJpLDR+Vih96m6NGKJSfdgwopFMUHQcZEw4NBx2ZSx0LqIoLjqxMFA0KAiKpHigut0gHCLuBCAe/TR0vFsWKDBgOSgckzoAk0dJKFAstuxsoykXM33bQTi4vASwKa3wdLNe7IS/rQx0iuKvTawmFEipEFFMoIsEEX14ogDjnbkMJJKYGqsKloMAiBgsKgWmwYiAdBP+EdBoYasmLEJ9EsIDY6sE+dyIyHKEw4ub+JwYjUhJx4REVgwlfOpQ0SccEkg4evnmgSYSCiW8JhEI54NPdCqowXJDoameQyCQulu4ScdFKCaZ1Cpw10kDDKUsmRClxUHTtAy8c4NIpoDOJGBVlzhTwUEJrkZfuFniZIBgA4SYHsmwR5wQFTGcyvWSofGKuoRInvolQ4OXAXZaO2xzwBFovlQ7N4F4YZdOZii8UXrx2xsD2oxS0PxVo60UsUw2x3zhIXamFArBRKPAdKMA4JAoZMAwHcOIF9ikGPu/6wJxVBwUWToQIUWCFBtNggm/YJaDxOCEHDIACCrNEV8VBHpAFQAgRePcfKeAtsMIJBRRwwgcKNGDgg5r+UOBCA7RsyOGIJJZoIoQUiHjiHh5OcMECESwwwgTJrDiKCyYkEMI+IoSQgAn42ejGARf0pUiPF3AmZBsuRAVaBUEuOcUBEJgEj5RhaKBgJSJocJ6JWJiwwgYrmOAAWMGpN1AL/mB5kDeAiNBfSgf8IRgGStpYwn6LWGTEBFuuhdSSDViASndFEFAZHQQsmU+gAIiwwDrUVbYBoQk4s4JtkK6lIikTUGTUNkMsWkeeJaLgziqlmgoAqiSq+g2rQnSKighfjuPAeIGEQKoQfJJGqFqfJGBbIos2KuSjt7KwDqCViTCokA0IcKhxdVaGJ5YDBBvIBgMYkSZc/Xz6y0H+xMQ55xEB2VpWBLmS2IEDJnywwQdmntfOQCrAimUUDSQImgcO/ivFASMYGUiPI/hr8BQuaLBCCKcwEEKZDj9MhYccPMDCAiw8gIy5GkORIsklp6zyyiy37PLLMMcs88wcvvKhC7bQLAV4ERQVQgUToCyFGA3E26EDxNIRggJCR4KCAAVsgEFhHGaQHCAFcPAIBQrcxADV43SgwScCRPlFCgoDgIDRfBxQqSIhTLvHW98WvEkDkL5wCGWBXPZfA7uwZohrgQjA9h4uqBkIA1obUk6cckvTAbKLtHTIASxQUgDTHFIwgeJ1iBDUdwfIckDTQlBwwOkbd7S4CaifW0JlACp4EIB/Oz/9GQMfjJ7yC2+XV4ULE7wAAgpFq7wdICG0pzMuuT1z+MwNZKqIsc83kYEEi0gAdvbLXG2HBRmDL4Q+C7NgPhPOAVL2+kwEzEAxDBAMfzxamH3//vz37///AFxREAAAO2l6MlNnMjJPaEJTY1lvVkpORFI0dmF6ek1tK1ZrditmL1VXWmxseUxSc0NPYk4vVU5kVVRWeThHRmlpUWNqNWQ=",gj={loaderBarClassName:"ds-dwt-loaderBar",loaderBarBackgroundColor:"",loaderBarSource:K.bIE?hj:bt.loaderBarSource,loaderBarSourceIE:hj,loaderBarWidth:120,loaderBarHeight:120,errorMessages:{limitReachedForZoomIn:"Error: You have reached the limit for zooming in",limitReachedForZoomOut:"Error: You have reached the limit for zooming out",insufficientParas:"Error: Not enough parameters.",invalidAngle:"Error: The angle you entered is invalid.",invalidIndex:"Error: The index you entered is invalid.",invalidHeightOrWidth:"Error: The height or width you entered is invalid.",imageNotChanged:"Error: You have not changed the current image."},generalMessages:{checkingDWTVersion:"Checking WebTwain version ...",updatingDService:"Dynamsoft Service is updating ...",downloadingDWTModule:"Downloading the Dynamic Web TWAIN module.",refreshNeeded:"Please REFRESH your browser.",downloadNeeded:"Please download and install the Dynamic Web TWAIN.",DWTmoduleLoaded:"The Dynamic Web TWAIN module is loaded."},customProgressText:{upload:"Uploading...",download:"Downloading...",load:"Loading...",decode:"Processing...",decodeTIFF:"Processing tiff...",decodePDF:"Processing pdf...",encode:"Processing...",encodeTIFF:"Processing tiff...",encodePDF:"Processing pdf...",transfer:"Transferring...",canvasLoading:"Loading ..."},buttons:{titles:{previous:"Previous Image",next:"Next Image",print:"Print Image",scan:"Scan Documents",load:"Load Local Images",rotateleft:"Rotate Left",rotate:"Rotate",rotateright:"Rotate Right",deskew:"Deskew",crop:"Crop Selected Area",cut:"Cut Selected Area",changeimagesize:"Change Image Size",flip:"Flip Image",mirror:"Mirror Image",zoomin:"Zoom In",originalsize:"Show Original Size",zoomout:"Zoom Out",stretch:"Stretch Mode",fit:"Fit Window",fitw:"Fit Horizontally",fith:"Fit Vertically",hand:"Hand Mode",rectselect:"Select Mode",zoom:"Click to Zoom In",restore:"Restore Original Image",save:"Save Changes",close:"Close the Editor",removeall:"Remove All Images",removeselected:"Remove All Selected Images"},bShowAllButtons:!0,visibility:{scan:!0,load:!0,print:!0,removeall:!0,removeselected:!0,rotateleft:!0,rotate:!0,rotateright:!0,deskew:!0,crop:!0,cut:!0,changeimagesize:!0,flip:!0,mirror:!0,zoomin:!0,originalsize:!0,zoomout:!0,stretch:!0,fit:!0,fitw:!0,fith:!0,hand:!0,rectselect:!0,zoom:!0,restore:!0,save:!0,close:!0}},dialogText:{dlgRotateAnyAngle:["Angle :","Interpolation:","Keep size","  OK  ","Cancel"],dlgChangeImageSize:["New Height :","New Width :","Interpolation:","  OK  ","Cancel"],saveChangedImage:["You have changed the image. Do you want to keep the change(s)?","  Yes  ","  No  "],selectSource:["Select Source:","Select","Cancel","There is no source available!"]}},pj=Et.mix({},gj);function mj(){var e;xt.DWT&&(e=xt.DWT.CustomizableDisplayInfo),e&&(Et.isString(e.loaderBarSource)&&""!=e.loaderBarSource?bt.loaderBarSource=e.loaderBarSource:K.bIE?(bt.loaderBarSource=gj.loaderBarSourceIE,bt.loaderBarSourceIE=gj.loaderBarSourceIE):bt.loaderBarSource=gj.loaderBarSource,Et.isString(e.loaderBarClassName)&&""!=e.loaderBarClassName?bt.loaderBarClassName=e.loaderBarClassName:bt.loaderBarClassName=gj.loaderBarClassName,Et.isString(e.loaderBarBackgroundColor)?bt.loaderBarBackgroundColor=e.loaderBarBackgroundColor:bt.loaderBarBackgroundColor=gj.loaderBarBackgroundColor,e.loaderBarWidth?bt.loaderBarWidth=e.loaderBarWidth:bt.loaderBarWidth=gj.loaderBarWidth,e.loaderBarHeight?bt.loaderBarHeight=e.loaderBarHeight:bt.loaderBarHeight=gj.loaderBarHeight)}var _j=!0;function vj(){var e;_j&&(pj=Et.mix({},gj),xt.DWT&&(e=xt.DWT.CustomizableDisplayInfo),e&&(e.errorMessages&&Et.mix(pj.errorMessages,e.errorMessages),e.generalMessages&&Et.mix(pj.generalMessages,e.generalMessages),e.customProgressText&&Et.mix(pj.customProgressText,e.customProgressText),e.buttons&&(e.buttons.titles&&Et.mix(pj.buttons.titles,e.buttons.titles),e.buttons.bShowAllButtons&&Et.mix(pj.buttons.bShowAllButtons,e.buttons.bShowAllButtons),e.buttons.visibility&&Et.mix(pj.buttons.visibility,e.buttons.visibility)),e.dialogText&&Et.mix(pj.dialogText,e.dialogText)),mj(),_j=!1)}function yj(e){var t=e,r=window;if(r.ShadowRoot)for(;t;){if(t instanceof r.ShadowRoot)return t;t=t.parentNode}return null}function Ij(e){var t=window;return!!(t.ShadowRoot&&e instanceof t.ShadowRoot)}bt._funsAfterConfigLoaded=[],bt._safePromptCustomMsg=function(e){e&&e()};var Sj=kx;xt.DWT;var Tj={background:"#434246",topMenuBorder:"",innerBorder:"",promptToSaveChange:!0,buttons:pj.buttons,dialogText:pj.dialogText},bj=function(){function e(r,n){t(this,e);var i=this;i._stwain=r,i._ImgManager=r._ImgManager,i.zoomInStep=1.2,i.zoomOutStep=.8,i.MIN_ZOOM=.02,i.MAX_ZOOM=65,i.MAX_ROWS=128,i.MAX_COLUMNS=128,i.__MousewheelValue=0,this._Init(n)}var r;return i(e,[{key:"_Init",value:function(e){var t=this;if(t.borderWidth=Et.isUndefined(e.borderWidth)?1:e.borderWidth,e.BackgroundColor?t.BackgroundColorByDefault=e.BackgroundColor:t.BackgroundColorByDefault="#FFFFFF",e.BackgroundColor=t.BackgroundColorByDefault,t.BackgroundFillColor=t.BackgroundColorByDefault,e.onTopImageInTheViewChanged=function(e){Et.isFunction(t._stwain.__OnTopImageInTheViewChanged)&&t._stwain.__OnTopImageInTheViewChanged(e.index,e.bByScrollBar)},e.onGetImageInfo=function(e){return{width:t._stwain.GetImageWidth(e),height:-1}},!t._stwain._viewer&&xt.DWT.UseDefaultViewer){var r={viewerContainer:{},viewerEvents:{topPageChanged:function(e,r){t.__topPageChanged(e,r,t)},click:function(e){t.__click(e,t)},rightclick:function(e){t.__rightclick(e,t)},dblclick:function(e){t.__dblclick(e,t)},mousemove:function(e){t.__mousemove(e,t)},pageAreaSelected:function(e,r){t.__pageAreaSelected(e,r,t)},pageAreaUnselected:function(e){t.__pageAreaUnselected(e,t)},dragdone:function(e){t.__dragdone(e,t)},onDrop:function(e){t.__onDrop(e,t)},pageChange:function(e){t.__pageChange(e,t)},bufferChanged:function(e,r){t.__bufferChanged(t,e,r)},onBind:function(e){t.__onBindViewer(e)},onUnBind:function(e){t.__onUnBindViewer(e)},save:function(e,r,n,i){return t.__save(t,e,r,n,i)}},viewerError:{setError:function(e,r){t.__setError(e,r,t)}},imageEditorEvents:{acquire:function(e){t.__acquire(t,e)},loadImage:function(){t.__loadImage(t)},deskew:function(e,r){t.__deskew(t,e,r)},removeImage:function(){t.__remove(t)},removeAllImage:function(){t.__removeAll(t)},close:function(){t.__close(t)}},imageEditorServerCallback:{rotateRight:function(){t.__rotateRightForServer(t)},rotate:function(e,r,n){t.__rotateForServer(t,e,r,n)},rotateLeft:function(){t.__rotateLeftForServer(t)},deskew:function(e){t.__deskewForServer(t)},crop:function(e){t.__cropForServer(t,e)},erase:function(e){t.__eraseForServer(t,e)},changeImageSize:function(e,r,n){t.__changeImageSizeForServer(t,e,r,n)},flip:function(){t.__flipForServer(t)},mirror:function(){t.__mirrorForServer(t)},restore:function(e){t.__restoreForServer(t,e)},save:function(e){return t.__saveForServer(t,e)}}};e.Container&&(tC.isNodeList(e.Container)||Et.isArray(e.Container)&&e.Container.length>0)&&(r.viewerContainer={container:e.Container[0],width:Dt(e.Width),height:Dt(e.Height)}),t._stwain._viewer=new xt.DWTViewer(nG._getBuffer(t._ImgManager),r)}else e.Container&&(tC.isNodeList(e.Container)||Et.isArray(e.Container)&&e.Container.length>0)&&t.__onBindViewer(e.Container[0]);t.__InitEvents(e)}},{key:"dispose",value:function(){this._stwain._viewer}},{key:"__InitEvents",value:function(e){var t=this;Et.isFunction(e.onTopImageInTheViewChanged)&&(t.onTopImageInTheViewChanged=e.onTopImageInTheViewChanged),Et.isFunction(e.onGetImageInfo)&&(t.onGetImageInfo=e.onGetImageInfo),Et.isFunction(e.onZoomChanged)&&(t.onZoomChanged=e.onZoomChanged),Et.isFunction(e.onMouseMove)&&(t.onMouseMove=e.onMouseMove),Et.isFunction(e.onMouseClick)&&(t.onMouseClick=e.onMouseClick),Et.isFunction(e.onMouseRightClick)&&(t.onMouseRightClick=e.onMouseRightClick),Et.isFunction(e.onMouseDoubleClick)&&(t.onMouseDoubleClick=e.onMouseDoubleClick),Et.isFunction(e.onImageAreaDeSelected)&&(t.onImageAreaDeSelected=e.onImageAreaDeSelected),Et.isFunction(e.onImageAreaSelected)&&(t.onImageAreaSelected=e.onImageAreaSelected),Et.isFunction(e.onBufferChanged)&&(t.onBufferChanged=e.onBufferChanged),Et.isFunction(e.onSelected)&&(t.onSelected=e.onSelected),Et.isFunction(e.onRefreshUI)&&(t.onRefreshUI=e.onRefreshUI),Et.isFunction(e.onResetCurrentIndex)&&(t.onResetCurrentIndex=e.onResetCurrentIndex)}},{key:"GetWebViewer",value:function(){return this._stwain._viewer}},{key:"SetSelectedImageArea",value:function(e,t,r,n){if(null!=this.GetWebViewer()){var i=[],o={};return o.left=e,o.top=t,o.right=r,o.bottom=n,i.push(o),this.GetWebViewer().setSelectedAreas(i)}return!1}},{key:"OverlayRectangle",value:function(e,t,r,n,i,o,a){var s=this;return!!s._stwain._isNoViewer()||null!=s.GetWebViewer()&&s.GetWebViewer().webViewer.overlayRectangle(e,t,r,n,i,o,a)}},{key:"ChangeImageViewSize",value:function(e,t){var r=this;return e>=0&&(r.GetWebViewer().width,r.GetWebViewer().width=e),t>=0&&(r.GetWebViewer().height,r.GetWebViewer().height=t),!0}},{key:"ChangeSize",value:function(e,t){var r=this;return r.GetWidth()!=e&&r.SetWidth(e),r.GetHeight()!=t&&r.SetHeight(t),!0}},{key:"GetWidth",value:function(){return this.GetWebViewer().width}},{key:"SetWidth",value:function(e){var t=e;return this._stwain._isNoViewer()||(this.GetWebViewer().width=t),!0}},{key:"GetHeight",value:function(){return this.GetWebViewer().height}},{key:"SetHeight",value:function(e){var t=e;return this._stwain._isNoViewer()||(this.GetWebViewer().height=t),!0}},{key:"SetViewMode",value:function(e,t){var r=this;return r._stwain._isNoViewer()?r._stwain._nouiNotSupport("SetViewMode"):r.GetWebViewer().setViewMode(e,t)}},{key:"SetIfFitWindowAndType",value:function(e){var t;if(null!=this.GetWebViewer()){switch(e){case 1:t="height";break;case 2:t="width";break;default:t="window"}this.GetWebViewer().fitWindow(t)}return!0}},{key:"GetAllowMultiSelect",value:function(){return!this._stwain._isNoViewer()&&this.GetWebViewer().selectionMode}},{key:"SetAllowMultiSelect",value:function(e){var t=this;return t._stwain._isNoViewer()||(t.GetWebViewer().selectionMode=e?1:0),!0}},{key:"GetFitWindowType",value:function(){return this._stwain._isNoViewer(),0}},{key:"SetSelectionRectAspectRatio",value:function(e){return this.GetWebViewer().selectionRectAspectRatio=e,!0}},{key:"GetSelectionRectAspectRatio",value:function(){return this.GetWebViewer().selectionRectAspectRatio}},{key:"SetFitWindowType",value:function(e){return this._stwain._isNoViewer()||this.SetIfFitWindowAndType(e),!0}},{key:"GetIfFitWindow",value:function(){return this._stwain._isNoViewer(),!0}},{key:"SetIfFitWindow",value:function(e){var t=this;return t._stwain._isNoViewer()||(e?t.GetWebViewer().fitWindow("window"):t.GetWebViewer().zoom=1),!0}},{key:"GetImageMargin",value:function(){return this._stwain._isNoViewer()?0:this.GetWebViewer().pageMargin}},{key:"SetImageMargin",value:function(e){return this._stwain._isNoViewer()||(this.GetWebViewer().pageMargin=e),!0}},{key:"GetSelectionImageBorderColor",value:function(){return this.GetWebViewer().selectedPageBorder}},{key:"SetSelectionImageBorderColor",value:function(e){var t=e;return Et.isNumber(t)&&(t=rC.getColor(t)),-1==t.indexOf("1px solid")&&(t="1px solid "+t),this.GetWebViewer().selectedPageBorder=t,!0}},{key:"GetZoom",value:function(){return this.GetWebViewer().zoom}},{key:"SetZoom",value:function(e,t,r){var n=this;return e<n.MIN_ZOOM&&(e=n.MIN_ZOOM),e>n.MAX_ZOOM&&(e=n.MAX_ZOOM),null!=n.GetWebViewer()&&(n.GetWebViewer().zoom=e),!0}},{key:"ZoomIn",value:function(e,t){var r=this,n=r._ImgManager.getImageIdMap(r._ImgManager.convertClientIndexToServerId(r._ImgManager.getCurrentImageIndex())),i=r.GetWebViewer().zoom,o=Math.floor(100*i*r.zoomInStep)+1;return 1<o&&o<2501?Dt(n.imageWidth*i)>15e3||Dt(n.imageHeight*i)>15e3?(kx.output(r,pj.errorMessages.limitReachedForZoomIn),alert(pj.errorMessages.limitReachedForZoomIn),!1):(r.SetZoom(o/100,e,t),!0):(kx.output(r,pj.errorMessages.limitReachedForZoomIn),alert(pj.errorMessages.limitReachedForZoomIn),!1)}},{key:"ZoomOut",value:function(){var e=this,t=e.GetWebViewer().zoom,r=Math.floor(100*t*e.zoomOutStep)-1;return 1<r&&r<6501?(e.SetZoom(r/100),!0):(kx.output(e,pj.errorMessages.limitReachedForZoomOut),alert(pj.errorMessages.limitReachedForZoomOut),!1)}},{key:"GetMouseShape",value:function(){return this._stwain._isNoViewer()?0:"crosshair"!=this.GetWebViewer().cursor}},{key:"SetMouseShape",value:function(e){var t=this;return t._stwain._isNoViewer()||(t.GetWebViewer().cursor=e?"pointer":"crosshair"),!0}},{key:"GetShowPageNumber",value:function(){return!this._stwain._isNoViewer()&&this.GetWebViewer().showPageNumber}},{key:"SetShowPageNumber",value:function(e){return this._stwain._isNoViewer()||(this.GetWebViewer().showPageNumber=e),!0}},{key:"SetBackgroundFillColor",value:function(e){var t=e;return this.BackgroundFillColor=t,!0}},{key:"GetBackgroundColor",value:function(){return this.GetWebViewer().background}},{key:"SetBackgroundColor",value:function(e){var t=e;return this._stwain._isNoViewer()||(this.GetWebViewer().background=t),!0}},{key:"Go",value:function(e){return this.GetWebViewer().gotoPage(e)}},{key:"__Previous",value:function(){return this.Go(this._ImgManager.getCurrentImageIndex()-1),!0}},{key:"__Next",value:function(){return this.Go(this._ImgManager.getCurrentImageIndex()+1),!0}},{key:"__fireEvent",value:function(e,t){if(Et.isFunction(this[e]))try{return this[e](t)}catch(r){vA(r)}return!0}},{key:"GetIfAutoScroll",value:function(){return this.GetWebViewer().ifAutoScroll}},{key:"SetIfAutoScroll",value:function(e){return this.GetWebViewer().ifAutoScroll=e,!0}},{key:"BindView",value:function(e){var t,r=e;return Et.isString(e)?r=Et.get(e):Et.isDOM(r)&&(r.id&&""!=r.id||(r.id=["dwt_",Et.getRandom()].join(""))),(t=this.GetWebViewer().bind(r))&&this.GetWebViewer().show(),t}},{key:"GetIfShowVideoContainer",value:function(){var e=this,t=e.GetWebViewer();return Et.isUndefined(t)?(xt.DWT.UseDefaultViewer?SE(e._stwain):IE(e._stwain),!1):t.webViewer.getIfShowVideoContainer()}},{key:"ShowVideoContainer",value:function(e){var t=this,r=t.GetWebViewer();return Et.isUndefined(r)?(xt.DWT.UseDefaultViewer?SE(t._stwain):IE(t._stwain),!1):r.webViewer.showVideoContainer(e)}},{key:"UpdateVideoContainer",value:function(e){var t=this,r=t.GetWebViewer();return Et.isUndefined(r)?(xt.DWT.UseDefaultViewer?SE(t._stwain):IE(t._stwain),!1):r.webViewer.updateVideoImage(e)}},{key:"ClearSelectedAreas",value:function(){var e=this.GetWebViewer();if(e)return e.clearSelectedAreas()}},{key:"OnCloseImageEditor",value:function(){return!!this.GetWebViewer().webViewer.imageEditor&&(this.GetWebViewer().createImageEditor().dispose(),!0)}},{key:"ShowImageEditorEx",value:function(e,t,r,n,i,o,a,s){var u=this;if(this._stwain._isNoViewer())return u._stwain._nouiNotSupport("ShowImageEditorEx");switch(i){case 0:case 1:case 2:break;case 3:if(u.OnCloseImageEditor())return!0}var c,l=document;if(dj._getContainer(u._stwain)==a&&(o=!1),a){var d=xt.DWT.ContainerMap;if(d){var f,h=Object.keys(d);for(f=0;f<h.length;f++)if(h[f]==a.id){o=!1;break}}}if(o&&a&&(Et.isDOM(a)?c=a:Ij(a)?(c=document.createElement("div"),a.appendChild(c)):(c=l.getElementById(a))&&"DIV"!=c.nodeName&&(o=!1)),o&&a&&Et.isDOM(a)){var g=yj(a);if(g){var p,m,_=bt.timestamp;return(p=l.createElement("link")).href=[xt.DWT.ResourcesPath,"/src/dynamsoft.webtwain.viewer.css",_].join(""),p.rel="stylesheet",p.async=!0,(m=l.createElement("link")).href=[xt.DWT.ResourcesPath,"/src/dynamsoft.webtwain.css",_].join(""),m.rel="stylesheet",m.async=!0,Et.scriptOnload(p,(function(){Et.scriptOnload(m,(function(){return u.ShowImageEditor(c,o,r,n)})),g.appendChild(m)})),g.appendChild(p),!0}}return u.ShowImageEditor(c,o,r,n)}},{key:"ShowImageEditor",value:function(e,t,r,n){var i=this;return e&&r&&n?(Tj.element=e,Tj.width=r,Tj.height=n):(Tj.element=undefined,Tj.width=undefined,Tj.height=undefined),Tj.border=i.GetWebViewer().border,Tj.selectionRectAspectRatio=i.GetWebViewer().selectionRectAspectRatio,Tj.workMode=lj.normal,i.GetWebViewer().createImageEditor(Tj),0!=i._stwain.ErrorCode&&(i.GetWebViewer().webViewer.imageEditor&&i.GetWebViewer().webViewer.imageEditor.dispose(),i.GetWebViewer().createImageEditor(Tj)),i.GetWebViewer().webViewer.imageEditor&&i.GetWebViewer().webViewer.imageEditor.show(),!0}},{key:"__topPageChanged",value:function(e,t,r){r.__fireEvent("onTopImageInTheViewChanged",{index:e,bByScrollBar:t})}},{key:"__click",value:function(e,t){var r=t;r.__fireEvent("onMouseClick",{e:e,x:e.imageX,y:e.imageY,index:r._ImgManager.getCurrentImageIndex()})}},{key:"__rightclick",value:function(e,t){var r=t;r.__fireEvent("onMouseRightClick",{e:e,x:e.imageX,y:e.imageY,index:r._ImgManager.getCurrentImageIndex()})}},{key:"__dblclick",value:function(e,t){var r=t;r.__fireEvent("onMouseDoubleClick",{e:e,x:e.imageX,y:e.imageY,index:r._ImgManager.getCurrentImageIndex()})}},{key:"__mousemove",value:function(e,t){var r=t;r.__fireEvent("onMouseMove",{e:e,x:e.imageX,y:e.imageY,index:r._ImgManager.getCurrentImageIndex()})}},{key:"__pageAreaSelected",value:function(e,t,r){var n=r,i=1;if(t&&t.length>0){var o=t[t.length-1];o.index&&(i=Dt(o.index)+1),n.__fireEvent("onImageAreaSelected",{index:e,left:Dt(o.x),top:Dt(o.y),right:Dt(o.x+o.width),bottom:Dt(o.y+o.height),areaIndex:i})}}},{key:"__pageAreaUnselected",value:function(e,t){t.__fireEvent("onImageAreaDeSelected",e)}},{key:"__dragdone",value:function(e,t){var r=t;Et.isFunction(r._stwain.__OnIndexChangeDragDropDone)&&r._stwain.__OnIndexChangeDragDropDone(e)}},{key:"__onDrop",value:function(e,t){var r=t;r.GetWebViewer().webViewer.acceptDrop&&r.__dropEvent(e,r)}},{key:"__dropEvent",value:function(e,t){var r,n,i=t,o=function(e){i._stwain._bIfShowProgressBar&&bt.closeProgress(null),e&&kx.output(null,e+" was loaded successfully!")},a=function(e,t,r){i._stwain._bIfShowProgressBar&&bt.closeProgress(null),i._stwain._errorCode=e,i._stwain._errorString=t,mD({code:e,message:t}),r&&kx.output(null,r+" failed to load. Error code: "+e+"Error String: "+t)};try{for(var s=e.dataTransfer.files,u=0;u<s.length;u++){if(0==(r=s[u]).type.length){var c=void 0,l=r.name.indexOf(".");switch(l>0&&(c=r.name.substring(l+1)),c){case"bmp":n=xt.DWT.EnumDWT_ImageType.IT_BMP;break;case"jpg":case"jpeg":n=xt.DWT.EnumDWT_ImageType.IT_JPG;break;case"tif":case"tiff":n=xt.DWT.EnumDWT_ImageType.IT_TIF;break;case"png":n=xt.DWT.EnumDWT_ImageType.IT_PNG;break;case"pdf":n=xt.DWT.EnumDWT_ImageType.IT_PDF;break;case"jp2":case"j2k":case"j2c":n=xt.DWT.EnumDWT_ImageType.IT_J2K;break;default:kx.output(null,r.name+" failed to load because the file type is not supported!"),n=-1,Rw(i._stwain)}}else switch(r.type){case"image/bmp":n=xt.DWT.EnumDWT_ImageType.IT_BMP;break;case"image/jpg":case"image/jpeg":n=xt.DWT.EnumDWT_ImageType.IT_JPG;break;case"image/tif":case"image/tiff":n=xt.DWT.EnumDWT_ImageType.IT_TIF;break;case"image/png":n=xt.DWT.EnumDWT_ImageType.IT_PNG;break;case"application/pdf":n=xt.DWT.EnumDWT_ImageType.IT_PDF;break;case"image/jp2":n=xt.DWT.EnumDWT_ImageType.IT_J2K;break;default:kx.output(null,r.name+" failed to load because the file type is not supported!"),n=-1,Rw(i._stwain)}if(-1!=n){if(i._stwain._bIfShowProgressBar?bt.showProgress(i._stwain,"DropLoading",i._stwain.IfShowCancelDialogWhenImageTransfer):bt.hideProgress(),i._stwain._OnPercentDone([0,-1,fx.Loading]),i._stwain.Addon&&i._stwain.Addon.PDF){bP.checkProductKey(i._stwain,{PDFRasterizer:!0},!0)}!function(e){var t=new FileReader;t.readAsDataURL(e),t.onload=function(){var t=i._stwain.__GetLoadEventsNum();i._stwain.__LoadImageFromBytesV2(e,n,"",!0,0,e.size,!1,t,o,a)},t.onerror=function(e){qw(i._stwain),i._stwain._errorString=this.error,a(i._stwain._errorCode,i._stwain._getErrorString())}}(s[u])}}}catch(d){Et.error(d.stack||d,"error"),setTimeout((function(){throw d}),0)}}},{key:"__pageChange",value:function(e,t){var r,n=t,i=n._ImgManager.count();if(Et.log("OnPagination"),i<=0)Ww(n._stwain);else if(1!=i){!/^\d+$/.test(e)||e<=0?alert(pj.errorMessages.invalidIndex):((r=Dt(e)-1)<0?r=0:r>=i&&(r=i-1),r!=n._ImgManager.getCurrentImageIndex()&&n.GetWebViewer().gotoPage(r))}}},{key:"__bufferChanged",value:function(e,t,r){var n,i=e,o=[],a=-1,s=[];t.operation&&(t.action=t.operation);for(var u=0;u<i._ImgManager.count();u++)(n=i._ImgManager.getCustomDataByIndex(u))&&n.imageId&&o.push(bG(n.imageId));if(t.imageIds=o,t.curIndex>=0&&(n=i._ImgManager.getCustomDataByIndex(t.curIndex))&&n.imageId&&(a=bG(n.imageId)),t.currentId=a,t.afterStatus.selectedUids)for(var c=0;c<t.afterStatus.selectedUids.length;c++){if(t.afterStatus.selectedUids[c]){var l=i._ImgManager.getIndexByUid(t.afterStatus.selectedUids[c]);l>=0&&(n=i._ImgManager.getCustomDataByIndex(l))&&n.imageId&&s.push(bG(n.imageId))}}t.selectedIds=s,Et.mix(t,{}),delete t.uids,delete t.currentUid,delete t.selectedUids,delete t.afterStatus,delete t.beforeStatus,delete t.operation,delete t.curIndex,delete t.docUid,i.__fireEvent("onBufferChanged",t)}},{key:"__setError",value:function(e,t,r){var n=r;n._stwain._errorCode=e,n._stwain._errorString=t}},{key:"__acquire",value:function(e,t){var r=e;try{var n=!1;1==xt.DWT.IfConfineMaskWithinTheViewer&&(xt.DWT.IfConfineMaskWithinTheViewer=!1,n=!0);var i;i=Et.isArray(t)&&t.length>=3?t:pj.dialogText.selectSource,r._stwain._selectSourceAsync("SelectSourceAsync",null,i).then((function(){return r._stwain.AcquireImageAsync({IfShowUI:!0,IfCloseSourceAfterAcquire:!0})})).then((function(){n&&(xt.DWT.IfConfineMaskWithinTheViewer=!0)}))["catch"]((function(e){Et.log("User did not select a source"),n&&(xt.DWT.IfConfineMaskWithinTheViewer=!0)}))}catch(o){}}},{key:"__loadImage",value:function(e){try{var t=e,r=null;xt.DWT.IfConfineMaskWithinTheViewer&&(r=!0,xt.DWT.IfConfineMaskWithinTheViewer=!1),t._stwain._containerElement=undefined;if(t._stwain.IfShowFileDialog=!0,t._stwain.Addon&&t._stwain.Addon.PDF){bP.checkProductKey(t._stwain,{PDFRasterizer:!0},!0)}t._stwain.LoadImageEx("",5,(function(){Et.log("Loaded an image successfully."),null!=r&&(xt.DWT.IfConfineMaskWithinTheViewer=r)}),(function(e,t){Et.log("Loading failed with the error: "+t),null!=r&&(xt.DWT.IfConfineMaskWithinTheViewer=r)}))}catch(n){}}},{key:"__print",value:function(e){var t=e;TE(t._stwain),t._ImgManager.getCurrentImageIndex()<0||t._ImgManager.PrintCurrentImage()}},{key:"__save",value:(r=eA(g.mark((function n(e,t,r,i,o){var a,s,u,c,l;return g.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s="save",TE((a=e)._stwain),!(a._ImgManager.count()<=0||a._ImgManager.getCurrentImageIndex()<0)){n.next=4;break}return n.abrupt("return");case 4:return a._stwain._containerElement=undefined,u=a.__getViewerElement(a,o),zx(s,u),n.prev=7,c=this._ImgManager.getIndexByUid(t),l=this._ImgManager.convertClientIndexToServerId(c),n.next=12,a._stwain._updateImage(l,r,i);case 12:if(!n.sent){n.next=19;break}return n.next=16,a._stwain.__saveToViewerAfterUpdate(t,i);case 16:n.next=20;break;case 19:a._errorCode,a._errorString;case 20:n.next=24;break;case 22:n.prev=22,n.t0=n["catch"](7);case 24:return n.prev=24,r=null,Kx(s),n.finish(24);case 28:return n.abrupt("return",void 0);case 29:case"end":return n.stop()}}),n,this,[[7,22,24,28]])}))),function(e,t,n,i,o){return r.apply(this,arguments)})},{key:"__getViewerElement",value:function(e,t){var r,n=e;if(t)if(n.GetWebViewer().webViewer.imageEditor){var i=n.GetWebViewer().createImageEditor();r="dwt-viewer-imageEditor-fullScreen"==i.inner.containerElement.className?{_containerElement:document.body}:{_containerElement:i.inner.containerElement}}else r=n._stwain;else r=n._stwain;return r}},{key:"__deskew",value:function(e,t,r){var n=this,i="deskew";TE(n._stwain);var o=n._ImgManager.getCurrentImageIndex();if(n._ImgManager.count()<=0||o<0)Sj.output(n,"No image in Buffer");else{var a=n.__getViewerElement(n,!0);zx(i,a);n._stwain.GetSkewAngleFromBinaryAsync(o,t,(function(e){r(e[0]),Kx(i)}),(function(){Kx(i)}))}}},{key:"__remove",value:function(e){var t=this;TE(t._stwain),t._ImgManager.count()<=0||t._ImgManager.getCurrentImageIndex()<0?Sj.output(t,"No image in Buffer"):t._stwain.RemoveAllSelectedImages()}},{key:"__removeAll",value:function(e){var t=this;TE(t._stwain),t._ImgManager.count()<=0||t._ImgManager.getCurrentImageIndex()<0?Sj.output(t,"No image in Buffer"):t._stwain.RemoveAllImages()}},{key:"__onBindViewer",value:function(e){e&&(dj._setContainer(this._stwain,e),e.id&&(xt.DWT.ContainerMap[e.id]=this._stwain))}},{key:"__onUnBindViewer",value:function(e){if(e){var t=dj._getContainer(this._stwain);if(t&&(t.innerHTML=""),dj._setContainer(this._stwain,null),e.id){var r=xt.DWT.ContainerMap;e.id in r&&delete xt.DWT.ContainerMap[e.id]}}}},{key:"__close",value:function(e){TE(this._stwain),dj._closeImageEditorUI(this._stwain)}},{key:"__rotateRightForServer",value:function(e){var t=this;TE(t._stwain);var r=t._ImgManager.getCurrentImageIndex();t._ImgManager.count()<=0||r<0?Sj.output(t,"No image in Buffer"):t._stwain.RotateRight(r)}},{key:"__rotateForServer",value:function(e,t,r,n){var i=this;TE(i._stwain);var o=i._ImgManager.getCurrentImageIndex();i._ImgManager.count()<=0||o<0?Sj.output(i,"No image in Buffer"):i._stwain.RotateEx(o,t,n,r)}},{key:"__rotateLeftForServer",value:function(e){var t=this;TE(t._stwain);var r=t._ImgManager.getCurrentImageIndex();t._ImgManager.count()<=0||r<0?Sj.output(t,"No image in Buffer"):t._stwain.RotateLeft(r)}},{key:"__deskewForServer",value:function(e){var t=this;TE(t._stwain);var r=t._ImgManager.getCurrentImageIndex();t._ImgManager.count()<=0||r<0?Sj.output(t,"No image in Buffer"):t._stwain.GetSkewAngleAsync(r).then((function(e){t._stwain.RotateEx(r,e,!0,1,(function(){}),(function(){}))}))}},{key:"__cropForServer",value:function(e,t){var r=this;TE(r._stwain);var n=r._ImgManager.getCurrentImageIndex();if(r._ImgManager.count()<=0||n<0)Sj.output(r,"No image in Buffer");else{var i=t.left,o=t.top,a=i+t.width,s=o+t.height;r._stwain.Crop(n,Dt(i),Dt(o),Dt(a),Dt(s))}}},{key:"__eraseForServer",value:function(e,t){var r=this;TE(r._stwain);var n=r._ImgManager.getCurrentImageIndex();if(r._ImgManager.count()<=0||n<0)Sj.output(r,"No image in Buffer");else{var i=t.left,o=t.top,a=i+t.width,s=o+t.height;r._stwain.CutFrameToClipboard(n,Dt(i),Dt(o),Dt(a),Dt(s))}}},{key:"__changeImageSizeForServer",value:function(e,t,r,n){var i=this;TE(i._stwain);var o=i._ImgManager.getCurrentImageIndex();i._ImgManager.count()<=0||o<0?Sj.output(i,"No image in Buffer"):i._stwain.ChangeImageSize(o,t,r,n)}},{key:"__flipForServer",value:function(e){var t=this;TE(t._stwain);var r=t._ImgManager.getCurrentImageIndex();t._ImgManager.count()<=0||r<0?Sj.output(t,"No image in Buffer"):t._stwain.Flip(r)}},{key:"__mirrorForServer",value:function(e){var t=this;TE(t._stwain);var r=t._ImgManager.getCurrentImageIndex();t._ImgManager.count()<=0||r<0?Sj.output(t,"No image in Buffer"):t._stwain.Mirror(r)}},{key:"__restoreForServer",value:function(e,t){var r=e;if(TE(r._stwain),r._ImgManager.count()<=0||r._ImgManager.getCurrentImageIndex()<0)Sj.output(r,"No image in Buffer");else{var n=r._ImgManager.getIndexByUid(t);n>=0&&r.__RestoreImageInner(r,n)}}},{key:"__saveForServer",value:function(e,t){var r=e;return new tC.Promise((function(e,n){TE(r._stwain),(r._ImgManager.count()<=0||r._ImgManager.getCurrentImageIndex()<0)&&(Sj.output(r,"No image in Buffer"),e());var i=r._ImgManager.getIndexByUid(t);i>=0?r.__SaveImageInner(r,i,!0,(function(){e()})):e()}))}},{key:"__RestoreImageInner",value:function(e,t,r){var n=e,i=n._ImgManager.getImageIdMap(n._ImgManager.convertClientIndexToServerId(t));n.__OnGetImageFromServerForEdit(i,t,1,(function(e,t,i){if(e&&(Et.log("__RestoreImageInner: "+[e.guid].join(",")),n._ImgManager.UpdateImage(e,i)),-1==(e&&e.imageId))return r&&r(),!1;r&&r()}))}},{key:"__SaveImageInner",value:function(e,t,r,n){var i=e,o=i._ImgManager.getImageIdMap(i._ImgManager.convertClientIndexToServerId(t));return i.__OnGetImageFromServerForEdit(o,t,2,(function(e,t,o){if(e&&(1==r&&(Et.log("__SaveImageInner: "+[e.guid].join(",")),i._ImgManager.getCurrentImageIndex()==t&&i._ImgManager.UpdateImage(e,o)),-1==e.imageId))return n&&n(),!1;return n&&n(),!0})),!0}},{key:"__OnGetImageFromServerForEdit",value:function(e,t,r,n){var i=this;if(n&&i._ImgManager.getBaseUrl){var o=i._ImgManager.convertClientIndexToServerId(t);if(-1==o)return!1;xt.DWT.ConnectWithSocket?n():RC({method:"GET",xhrFields:{withCredentials:!0},url:kx.getUrlByAct(i._ImgManager.getBaseUrl,o,r),onSuccess:function(r){var a;e.ticks=Date.now(),a=xt.navInfoSync.bMobile?kx.getImageUrl(i._ImgManager.getBaseUrl,o,Math.round(e.iImageControlWidth*devicePixelRatio),Math.round(e.iImageControlHeight*devicePixelRatio),e.ticks):kx.getImageUrl(i._ImgManager.getBaseUrl,o,Dt(e.iImageControlWidth),Dt(e.iImageControlHeight),e.ticks),e.imageUrl=kx.getImageUrl(i._ImgManager.getBaseUrl,o,-1,-1,e.ticks),e.minImageUrl=a;var s=i._ImgManager.GetMetaDataByIndex(t);if(s){var u=i._ImgManager.getImageIdMap(o);u&&u.width?s.width=u.width:s.width=i._stwain.GetImageWidth(t),u&&u.height?s.height=u.height:s.height=i._stwain.GetImageHeight(t)}n(e,t,s)},onError:function(){}})}return!0}}]),e}();function Cj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(VV){return!1}}();return function(){var r,n=cA(e);if(t){var i=cA(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return uA(this,r)}}var wj,Ej,Aj,kj,Pj,xj,Dj,Fj,Wj,Rj,Nj,Oj,Mj,Lj,Bj,Uj,Vj,Gj,jj,Hj,zj,Kj,Jj,Qj,qj=function(e){sA(n,e);var r=Cj(n);function n(e,i){var o;t(this,n);var a=oA(o=r.call(this,i));return a._stwain=e,a.bImageJustChangedInEditor=!1,a.bImageChangedInViewer=!1,o}return i(n,[{key:"getUidByIndex",value:function(e){return this._buffer.getUidByIndex(e)}},{key:"dispose",value:function(){return!0}},{key:"unshift",value:function(e,t,r){return 0,this._updateUIAfterAdd(0,t,r)}},{key:"append",value:function(e,t,r,n){var i,o,a,s,u=this;o=(this._buffer.isActiveFile||!Et.isUndefined(n))&&r.currentFileName&&r.currentFileName.length>0?u.getCountByDocumentName(r.currentFileName):u.count(),a=u.getCurrentImageIndex();for(var c=o-1;c>=e;c--)s=u.convertClientIndexToServerId(c),u.removeByServerId(s,c);return o<e?(i=o,u._updateUIAfterAdd(i,t,r,!0)):(i=a>=o-1?0:a+1,s=u.convertClientIndexToServerId(i),u.removeByServerId(s,i),i==e-1?u._updateUIAfterAdd(i,t,r,!0):u._updateUIAfterAdd(i,t,r,!1))}},{key:"insertBefore",value:function(e,t,r,n){var i,o=1*e;return(o<0||o>t)&&(o=-1),o>=(i=this.count())&&(o=i),this._updateUIAfterAdd(o,r,n,!1)}},{key:"exists",value:function(e){return!Et.isUndefined(this.getImageIdMap(e))}},{key:"insert",value:function(e,t,r,n){var i,o=1*e;return(o<0||o>t)&&(o=-1),o>=(i=this.count())&&(o=i),this._updateUIAfterAdd(o,r,n,!1)}},{key:"moveImage",value:function(e,t,r){return this._buffer.moveImage(e,t)}},{key:"switchImage",value:function(e,t){return this._buffer.switchImage(e,t)}},{key:"refresh",value:function(e,t,r,n){var i,o=this,a=1*e;if(r){var s=o.count();if(a<0||a>s)return!1;i=o.convertClientIndexToServerId(a),o.SetDataImageControl(a,i,n)}return!0}},{key:"setSelectedClientIndexArray",value:function(e){return this._buffer.selectImages(e)}},{key:"getSelectedClientIndexArray",value:function(e){return this._buffer.getSelectedImagesIndices()}},{key:"showImagesByFilter",value:function(e,t,r){return this._buffer.filterImagesByTag(e,t,r)}},{key:"clearFilter",value:function(){return this._buffer.clearFilter()}},{key:"removeImageTag",value:function(e){return this._buffer.removeImageTag(e)}},{key:"addImageTag",value:function(e,t){return this._buffer.tagImages(e,t)}},{key:"getCurrentTag",value:function(){var e;return 0==(e=this._buffer.getCurrentTag())?"":e}},{key:"renameTag",value:function(e,t){return this._buffer.renameTag(e,t)}},{key:"removeTag",value:function(e,t){return this._buffer.removeTag(e,t)}},{key:"getTagList",value:function(){return this._buffer.getTagList()}},{key:"getTagListByIndex",value:function(e){return this._buffer.getTagListByIndex(e)}},{key:"OpenFile",value:function(e){return this._buffer.openDocument(e)}},{key:"CreateFile",value:function(e){return this._buffer.createDocument(e)}},{key:"GetCurrentFileName",value:function(){return this._buffer.getCurrentFileName()}},{key:"RemoveFile",value:function(e){return this._buffer.removeDocument(e)}},{key:"RenameFile",value:function(e,t){return this._buffer.renameDocument(e,t)}},{key:"GetFileInfoList",value:function(){return this._buffer.getDocumentInfoList()}},{key:"MoveImageToFile",value:function(e,t,r,n){return this._buffer.moveImageToFile(e,t,r,n)}},{key:"GetImageIdsByFileName",value:function(e){var t,r=this,n=[];return(t=r.GetFileInfoList())?Et.each(t,(function(t){if(e==t.name){if(t.imageIds)for(var i=0;i<t.imageIds.length;i++){var o=t.imageIds[i];if(o){var a=r._stwain._convertGuidToServerId(o);-1!=a&&n.push(a)}}return!1}})):n=[],n}},{key:"insertImage",value:function(e,t,r){this._buffer.insertImage(t,e,r)}},{key:"GetMetaDataByIndex",value:function(e){return this._buffer.getMetadataByUid(this._buffer.getUidByIndex(e))}},{key:"RefreshAllImages",value:function(e,t){for(var r,n,i,o=this,a=0;a<o.count();a++){r=o.convertClientIndexToServerId(a);var s=o.getImageIdMap(r);s&&(n=xt.navInfoSync.bMobile?kx.getImageUrl(o._baseUrl,r,Math.round(e*devicePixelRatio),Math.round(t*devicePixelRatio),Date.now()):kx.getImageUrl(o._baseUrl,r,e,t,Date.now()),s.minImageUrl=n,i=o.GetMetaDataByIndex(a),o._buffer.updateImage(s,i))}}},{key:"UpdateData",value:function(e,t){var r=e,n=this.getImageIdMap(r);return n&&this._buffer.updateImage(n,t),!0}},{key:"UpdateImage",value:function(e,t){return this._buffer.updateImage(e,t),!0}},{key:"SetDataImageControl",value:function(e,t,r){var n,i=this;return-1!=t&&((n=i.getImageIdMap(t))||((n=new WF).imageId=t,i._imageIdMap[t]=n),null!=n&&(n.bIsDirty=!0),i.__GetImageAndAttach(n,t,!0,!1,!1,e,r),!0)}},{key:"__AttachImages",value:function(){var e,t,r,n=this;t=n.count();for(var i=0;i<t;i++)(e=n.convertClientIndexToServerId(i))>=0&&(r=n.getImageIdMap(e),n.__GetImageAndAttach(r,e,!0,!1,!1,0))}},{key:"AddImage",value:function(e,t,r,n){var i,o=1*e;return-1!=t&&((i=new WF).bIsDirty=!0,i.imageId=t,this._imageIdMap[t]=i,t>=0&&this.__GetImageAndAttach(i,t,!1,!0,n,o,r),!0)}},{key:"OnGetImageByURL",value:function(e,t,r,n,i,o,a,s){return t.imageUrl&&""!=t.imageUrl?(t.iImageControlWidth=r,t.iImageControlHeight=n,t.bAddImage=i,t.bAppendImage=o,t.index=a,this._attachImagesForControl(t,s),!0):this.OnGetImageFromServer(e,t,r,n,i,o,a,s)}},{key:"OnGetImageFromServer",value:function(e,t,r,n,i,o,a,s){var u,c,l=this,d=l._baseUrl;if(d){if(-1==e)return!1;t.bIsDirty&&(t.ticks=Date.now()),Et.isUndefined(r)&&(r=-1),Et.isUndefined(n)&&(n=-1),t.iImageControlWidth=r,t.iImageControlHeight=n,t.bAddImage=i,t.bAppendImage=o,t.index=a,xt.DWT.ConnectWithSocket&&l._stwain._isBindViewer()?(l._attachImagesForControl(t,s),dj._getblob_queue.push([l._stwain,e,s]),dj.ProcessGetBlobByQueue()):(u=kx.getImageUrl(d,e,-1,-1,t.ticks),c=xt.navInfoSync.bMobile?kx.getImageUrl(d,e,Math.round(r*devicePixelRatio),Math.round(n*devicePixelRatio),t.ticks):kx.getImageUrl(d,e,r,n,t.ticks),t.imageUrl=u,t.minImageUrl=c,l._attachImagesForControl(t,s))}return!0}},{key:"getBaseUrl",get:function(){return this._baseUrl}},{key:"_attachImagesForControl",value:function(e,t){var r=this;return e.bAddImage?t.currentFileName.length>0?r._buffer.addImage(e,t,t.currentFileName):r._buffer.addImage(e,t):r._buffer.updateImage(e,t),!0}},{key:"_updateUIAfterAdd",value:function(e,t,r,n){return!(t<0)&&this.AddImage(e,t,r,n)}},{key:"__GetImageAndAttach",value:function(e,t,r,n,i,o,a){var s,u,c=this;c._stwain._isBindViewer()?(u=c._stwain.Viewer.height>=400?c._stwain.Viewer.height:400,s=c._stwain.Viewer.width>=400?c._stwain.Viewer.width:400):(s=-1,u=-1);var l=!1;l=!!r||1==e.bIsDirty;var d=c.getImageIdMap(t).uuid;d&&e.iImageControlWidth==s&&e.iImageControlHeight==u&&0==e.bIsDirty||c.__SetArrayControlLoadImage(d,t,e,s,u,c._attachImagesForControl,l,n,i,o,a)}},{key:"__SetArrayControlLoadImage",value:function(e,t,r,n,i,o,a,s,u,c,l){a?this.OnGetImageFromServer(t,r,n,i,s,u,c,l):this.OnGetImageByURL(t,r,n,i,s,u,c,l)}},{key:"GetServerIdList",value:function(){var e,t,r,n=this,i=[];if(e=n._buffer.getDocumentContents(n._buffer.getCurrentDocument()))for(var o=0;o<e.length;o++)(t=e[o])&&(r=n._buffer.getCustomDataByUid(t))&&i.push(r.imageId);return i}}]),n}(nG),Yj=function(e){var t=e||window.event,r=!0;return Et.each(tC.Events.registedObjs,(function(e){Et.each(tC.Events.registedClass,(function(n){if(e instanceof n&&e.bFocus&&e.handlerKeyDown&&!(r=e.handlerKeyDown(t)))return!1}))})),r};function Xj(e,t){for(var r in t)t.hasOwnProperty(r)&&!Et.isUndefined(t[r])&&(e.hasOwnProperty(r)&&!Et.isUndefined(e[r])||(e[r]=t[r]));return e}Ok((function(){Et.addEventListener(document.documentElement,"keydown",Yj)})),Xj(xt.DWT,uw),Xj(xt.DWT,cw),xt.DWT.CertificateConfig?Xj(xt.DWT.CertificateConfig,fw):xt.DWT.CertificateConfig=fw,xt.DWT.RegisterEvent=function(e,t){return Et.isFunction(t)&&("OnWebTwainReady"!==e&&"OnWebTwainError"!==e&&"OnWebTwainInitMessage"!==e||(xt.DWT[e]=t)),!0},function(e){e.CAP_NONE=0,e.CAP_XFERCOUNT=1,e.ICAP_COMPRESSION=256,e.ICAP_PIXELTYPE=257,e.ICAP_UNITS=258,e.ICAP_XFERMECH=259,e.CAP_AUTHOR=4096,e.CAP_CAPTION=4097,e.CAP_FEEDERENABLED=4098,e.CAP_FEEDERLOADED=4099,e.CAP_TIMEDATE=4100,e.CAP_SUPPORTEDCAPS=4101,e.CAP_EXTENDEDCAPS=4102,e.CAP_AUTOFEED=4103,e.CAP_CLEARPAGE=4104,e.CAP_FEEDPAGE=4105,e.CAP_REWINDPAGE=4106,e.CAP_INDICATORS=4107,e.CAP_SUPPORTEDCAPSEXT=4108,e.CAP_PAPERDETECTABLE=4109,e.CAP_UICONTROLLABLE=4110,e.CAP_DEVICEONLINE=4111,e.CAP_AUTOSCAN=4112,e.CAP_THUMBNAILSENABLED=4113,e.CAP_DUPLEX=4114,e.CAP_DUPLEXENABLED=4115,e.CAP_ENABLEDSUIONLY=4116,e.CAP_CUSTOMDSDATA=4117,e.CAP_ENDORSER=4118,e.CAP_ALARMS=4120,e.CAP_ALARMVOLUME=4121,e.CAP_AUTOMATICCAPTURE=4122,e.CAP_TIMEBEFOREFIRSTCAPTURE=4123,e.CAP_TIMEBETWEENCAPTURES=4124,e.CAP_CLEARBUFFERS=4125,e.CAP_MAXBATCHBUFFERS=4126,e.CAP_DEVICETIMEDATE=4127,e.CAP_POWERSUPPLY=4128,e.CAP_CAMERAPREVIEWUI=4129,e.CAP_SERIALNUMBER=4132,e.CAP_PRINTER=4134,e.CAP_PRINTERENABLED=4135,e.CAP_PRINTERINDEX=4136,e.CAP_PRINTERMODE=4137,e.CAP_PRINTERSTRING=4138,e.CAP_PRINTERSUFFIX=4139,e.CAP_LANGUAGE=4140,e.CAP_FEEDERALIGNMENT=4141,e.CAP_FEEDERORDER=4142,e.CAP_REACQUIREALLOWED=4144,e.CAP_BATTERYMINUTES=4146,e.CAP_BATTERYPERCENTAGE=4147,e.CAP_CAMERASIDE=4148,e.CAP_SEGMENTED=4149,e.CAP_CAMERAENABLED=4150,e.CAP_CAMERAORDER=4151,e.CAP_MICRENABLED=4152,e.CAP_FEEDERPREP=4153,e.CAP_FEEDERPOCKET=4154,e.CAP_AUTOMATICSENSEMEDIUM=4155,e.CAP_CUSTOMINTERFACEGUID=4156,e.ICAP_AUTOBRIGHT=4352,e.ICAP_BRIGHTNESS=4353,e.ICAP_CONTRAST=4355,e.ICAP_CUSTHALFTONE=4356,e.ICAP_EXPOSURETIME=4357,e.ICAP_FILTER=4358,e.ICAP_FLASHUSED=4359,e.ICAP_GAMMA=4360,e.ICAP_HALFTONES=4361,e.ICAP_HIGHLIGHT=4362,e.ICAP_IMAGEFILEFORMAT=4364,e.ICAP_LAMPSTATE=4365,e.ICAP_LIGHTSOURCE=4366,e.ICAP_ORIENTATION=4368,e.ICAP_PHYSICALWIDTH=4369,e.ICAP_PHYSICALHEIGHT=4370,e.ICAP_SHADOW=4371,e.ICAP_FRAMES=4372,e.ICAP_XNATIVERESOLUTION=4374,e.ICAP_YNATIVERESOLUTION=4375,e.ICAP_XRESOLUTION=4376,e.ICAP_YRESOLUTION=4377,e.ICAP_MAXFRAMES=4378,e.ICAP_TILES=4379,e.ICAP_BITORDER=4380,e.ICAP_CCITTKFACTOR=4381,e.ICAP_LIGHTPATH=4382,e.ICAP_PIXELFLAVOR=4383,e.ICAP_PLANARCHUNKY=4384,e.ICAP_ROTATION=4385,e.ICAP_SUPPORTEDSIZES=4386,e.ICAP_THRESHOLD=4387,e.ICAP_XSCALING=4388,e.ICAP_YSCALING=4389,e.ICAP_BITORDERCODES=4390,e.ICAP_PIXELFLAVORCODES=4391,e.ICAP_JPEGPIXELTYPE=4392,e.ICAP_TIMEFILL=4394,e.ICAP_BITDEPTH=4395,e.ICAP_BITDEPTHREDUCTION=4396,e.ICAP_UNDEFINEDIMAGESIZE=4397,e.ICAP_EXTIMAGEINFO=4399,e.ICAP_MINIMUMHEIGHT=4400,e.ICAP_MINIMUMWIDTH=4401,e.ICAP_AUTODISCARDBLANKPAGES=4404,e.ICAP_FLIPROTATION=4406,e.ICAP_BARCODEDETECTIONENABLED=4407,e.ICAP_SUPPORTEDBARCODETYPES=4408,e.ICAP_BARCODEMAXSEARCHPRIORITIES=4409,e.ICAP_BARCODESEARCHPRIORITIES=4410,e.ICAP_BARCODESEARCHMODE=4411,e.ICAP_BARCODEMAXRETRIES=4412,e.ICAP_BARCODETIMEOUT=4413,e.ICAP_ZOOMFACTOR=4414,e.ICAP_PATCHCODEDETECTIONENABLED=4415,e.ICAP_SUPPORTEDPATCHCODETYPES=4416,e.ICAP_PATCHCODEMAXSEARCHPRIORITIES=4417,e.ICAP_PATCHCODESEARCHPRIORITIES=4418,e.ICAP_PATCHCODESEARCHMODE=4419,e.ICAP_PATCHCODEMAXRETRIES=4420,e.ICAP_PATCHCODETIMEOUT=4421,e.ICAP_FLASHUSED2=4422,e.ICAP_IMAGEFILTER=4423,e.ICAP_NOISEFILTER=4424,e.ICAP_OVERSCAN=4425,e.ICAP_AUTOMATICBORDERDETECTION=4432,e.ICAP_AUTOMATICDESKEW=4433,e.ICAP_AUTOMATICROTATE=4434,e.ICAP_JPEGQUALITY=4435,e.ICAP_FEEDERTYPE=4436,e.ICAP_ICCPROFILE=4437,e.ICAP_AUTOSIZE=4438,e.ICAP_AUTOMATICCROPUSESFRAME=4439,e.ICAP_AUTOMATICLENGTHDETECTION=4440,e.ICAP_AUTOMATICCOLORENABLED=4441,e.ICAP_AUTOMATICCOLORNONCOLORPIXELTYPE=4442,e.ICAP_COLORMANAGEMENTENABLED=4443,e.ICAP_IMAGEMERGE=4444,e.ICAP_IMAGEMERGEHEIGHTTHRESHOLD=4445,e.ICAP_SUPPORTEDEXTIMAGEINFO=4446}(wj||(wj={})),function(e){e.TWLG_DAN=0,e.TWLG_DUT=1,e.TWLG_ENG=2,e.TWLG_FCF=3,e.TWLG_FIN=4,e.TWLG_FRN=5,e.TWLG_GER=6,e.TWLG_ICE=7,e.TWLG_ITN=8,e.TWLG_NOR=9,e.TWLG_POR=10,e.TWLG_SPA=11,e.TWLG_SWE=12,e.TWLG_USA=13,e.TWLG_USERLOCALE=-1,e.TWLG_AFRIKAANS=14,e.TWLG_ALBANIA=15,e.TWLG_ARABIC=16,e.TWLG_ARABIC_ALGERIA=17,e.TWLG_ARABIC_BAHRAIN=18,e.TWLG_ARABIC_EGYPT=19,e.TWLG_ARABIC_IRAQ=20,e.TWLG_ARABIC_JORDAN=21,e.TWLG_ARABIC_KUWAIT=22,e.TWLG_ARABIC_LEBANON=23,e.TWLG_ARABIC_LIBYA=24,e.TWLG_ARABIC_MOROCCO=25,e.TWLG_ARABIC_OMAN=26,e.TWLG_ARABIC_QATAR=27,e.TWLG_ARABIC_SAUDIARABIA=28,e.TWLG_ARABIC_SYRIA=29,e.TWLG_ARABIC_TUNISIA=30,e.TWLG_ARABIC_UAE=31,e.TWLG_ARABIC_YEMEN=32,e.TWLG_BASQUE=33,e.TWLG_BYELORUSSIAN=34,e.TWLG_BULGARIAN=35,e.TWLG_CATALAN=36,e.TWLG_CHINESE=37,e.TWLG_CHINESE_HONGKONG=38,e.TWLG_CHINESE_PRC=39,e.TWLG_CHINESE_SINGAPORE=40,e.TWLG_CHINESE_SIMPLIFIED=41,e.TWLG_CHINESE_TAIWAN=42,e.TWLG_CHINESE_TRADITIONAL=43,e.TWLG_CROATIA=44,e.TWLG_CZECH=45,e.TWLG_DANISH=0,e.TWLG_DUTCH=1,e.TWLG_DUTCH_BELGIAN=46,e.TWLG_ENGLISH=2,e.TWLG_ENGLISH_AUSTRALIAN=47,e.TWLG_ENGLISH_CANADIAN=48,e.TWLG_ENGLISH_IRELAND=49,e.TWLG_ENGLISH_NEWZEALAND=50,e.TWLG_ENGLISH_SOUTHAFRICA=51,e.TWLG_ENGLISH_UK=52,e.TWLG_ENGLISH_USA=13,e.TWLG_ESTONIAN=53,e.TWLG_FAEROESE=54,e.TWLG_FARSI=55,e.TWLG_FINNISH=4,e.TWLG_FRENCH=5,e.TWLG_FRENCH_BELGIAN=56,e.TWLG_FRENCH_CANADIAN=3,e.TWLG_FRENCH_LUXEMBOURG=57,e.TWLG_FRENCH_SWISS=58,e.TWLG_GERMAN=6,e.TWLG_GERMAN_AUSTRIAN=59,e.TWLG_GERMAN_LUXEMBOURG=60,e.TWLG_GERMAN_LIECHTENSTEIN=61,e.TWLG_GERMAN_SWISS=62,e.TWLG_GREEK=63,e.TWLG_HEBREW=64,e.TWLG_HUNGARIAN=65,e.TWLG_ICELANDIC=7,e.TWLG_INDONESIAN=66,e.TWLG_ITALIAN=8,e.TWLG_ITALIAN_SWISS=67,e.TWLG_JAPANESE=68,e.TWLG_KOREAN=69,e.TWLG_KOREAN_JOHAB=70,e.TWLG_LATVIAN=71,e.TWLG_LITHUANIAN=72,e.TWLG_NORWEGIAN=9,e.TWLG_NORWEGIAN_BOKMAL=73,e.TWLG_NORWEGIAN_NYNORSK=74,e.TWLG_POLISH=75,e.TWLG_PORTUGUESE=10,e.TWLG_PORTUGUESE_BRAZIL=76,e.TWLG_ROMANIAN=77,e.TWLG_RUSSIAN=78,e.TWLG_SERBIAN_LATIN=79,e.TWLG_SLOVAK=80,e.TWLG_SLOVENIAN=81,e.TWLG_SPANISH=11,e.TWLG_SPANISH_MEXICAN=82,e.TWLG_SPANISH_MODERN=83,e.TWLG_SWEDISH=12,e.TWLG_THAI=84,e.TWLG_TURKISH=85,e.TWLG_UKRANIAN=86,e.TWLG_ASSAMESE=87,e.TWLG_BENGALI=88,e.TWLG_BIHARI=89,e.TWLG_BODO=90,e.TWLG_DOGRI=91,e.TWLG_GUJARATI=92,e.TWLG_HARYANVI=93,e.TWLG_HINDI=94,e.TWLG_KANNADA=95,e.TWLG_KASHMIRI=96,e.TWLG_MALAYALAM=97,e.TWLG_MARATHI=98,e.TWLG_MARWARI=99,e.TWLG_MEGHALAYAN=100,e.TWLG_MIZO=101,e.TWLG_NAGA=102,e.TWLG_ORISSI=103,e.TWLG_PUNJABI=104,e.TWLG_PUSHTU=105,e.TWLG_SERBIAN_CYRILLIC=106,e.TWLG_SIKKIMI=107,e.TWLG_SWEDISH_FINLAND=108,e.TWLG_TAMIL=109,e.TWLG_TELUGU=110,e.TWLG_TRIPURI=111,e.TWLG_URDU=112,e.TWLG_VIETNAMESE=113}(Ej||(Ej={})),function(e){e.TWSS_NONE=0,e.TWSS_A4LETTER=1,e.TWSS_B5LETTER=2,e.TWSS_USLETTER=3,e.TWSS_USLEGAL=4,e.TWSS_A5=5,e.TWSS_B4=6,e.TWSS_B6=7,e.TWSS_USLEDGER=9,e.TWSS_USEXECUTIVE=10,e.TWSS_A3=11,e.TWSS_B3=12,e.TWSS_A6=13,e.TWSS_C4=14,e.TWSS_C5=15,e.TWSS_C6=16,e.TWSS_4A0=17,e.TWSS_2A0=18,e.TWSS_A0=19,e.TWSS_A1=20,e.TWSS_A2=21,e.TWSS_A4=1,e.TWSS_A7=22,e.TWSS_A8=23,e.TWSS_A9=24,e.TWSS_A10=25,e.TWSS_ISOB0=26,e.TWSS_ISOB1=27,e.TWSS_ISOB2=28,e.TWSS_ISOB3=12,e.TWSS_ISOB4=6,e.TWSS_ISOB5=29,e.TWSS_ISOB6=7,e.TWSS_ISOB7=30,e.TWSS_ISOB8=31,e.TWSS_ISOB9=32,e.TWSS_ISOB10=33,e.TWSS_JISB0=34,e.TWSS_JISB1=35,e.TWSS_JISB2=36,e.TWSS_JISB3=37,e.TWSS_JISB4=38,e.TWSS_JISB5=2,e.TWSS_JISB6=39,e.TWSS_JISB7=40,e.TWSS_JISB8=41,e.TWSS_JISB9=42,e.TWSS_JISB10=43,e.TWSS_C0=44,e.TWSS_C1=45,e.TWSS_C2=46,e.TWSS_C3=47,e.TWSS_C7=48,e.TWSS_C8=49,e.TWSS_C9=50,e.TWSS_C10=51,e.TWSS_USSTATEMENT=52,e.TWSS_BUSINESSCARD=53,e.TWSS_MAXSIZE=54}(Aj||(Aj={})),function(e){e.TWON_NONE=0,e.TWON_ARRAY=3,e.TWON_ENUMERATION=4,e.TWON_ONEVALUE=5,e.TWON_RANGE=6}(kj||(kj={})),function(e){e.TWTY_INT8=0,e.TWTY_INT16=1,e.TWTY_INT32=2,e.TWTY_UINT8=3,e.TWTY_UINT16=4,e.TWTY_int=5,e.TWTY_BOOL=6,e.TWTY_FIX32=7,e.TWTY_FRAME=8,e.TWTY_STR32=9,e.TWTY_STR64=10,e.TWTY_STR128=11,e.TWTY_STR255=12}(Pj||(Pj={})),function(e){e.TWFA_NONE=0,e.TWFA_LEFT=1,e.TWFA_CENTER=2,e.TWFA_RIGHT=3}(xj||(xj={})),function(e){e.TWFO_FIRSTPAGEFIRST=0,e.TWFO_LASTPAGEFIRST=1}(Dj||(Dj={})),function(e){e.TWPR_IMPRINTERTOPBEFORE=0,e.TWPR_IMPRINTERTOPAFTER=1,e.TWPR_IMPRINTERBOTTOMBEFORE=2,e.TWPR_IMPRINTERBOTTOMAFTER=3,e.TWPR_ENDORSERTOPBEFORE=4,e.TWPR_ENDORSERTOPAFTER=5,e.TWPR_ENDORSERBOTTOMBEFORE=6,e.TWPR_ENDORSERBOTTOMAFTER=7}(Fj||(Fj={})),function(e){e.TWPM_SINGLESTRING=0,e.TWPM_MULTISTRING=1,e.TWPM_COMPOUNDSTRING=2}(Wj||(Wj={})),function(e){e.TWBR_THRESHOLD=0,e.TWBR_HALFTONE=1,e.TWBR_CUSTHALFTONE=2,e.TWBR_DIFFUSION=3}(Rj||(Rj={})),function(e){e.TWBO_LSBFIRST=0,e.TWBO_MSBFIRST=1}(Nj||(Nj={})),function(e){e.TWFT_RED=0,e.TWFT_GREEN=1,e.TWFT_BLUE=2,e.TWFT_NONE=3,e.TWFT_WHITE=4,e.TWFT_CYAN=5,e.TWFT_MAGENTA=6,e.TWFT_YELLOW=7,e.TWFT_BLACK=8}(Oj||(Oj={})),function(e){e.TWFL_NONE=0,e.TWFL_OFF=1,e.TWFL_ON=2,e.TWFL_AUTO=3,e.TWFL_REDEYE=4}(Mj||(Mj={})),function(e){e.TWFR_BOOK=0,e.TWFR_FANFOLD=1}(Lj||(Lj={})),function(e){e.TWIF_NONE=0,e.TWIF_AUTO=1,e.TWIF_LOWPASS=2,e.TWIF_BANDPASS=3,e.TWIF_HIGHPASS=4,e.TWIF_TEXT=3,e.TWIF_FINELINE=4}(Bj||(Bj={})),function(e){e.TWLP_REFLECTIVE=0,e.TWLP_TRANSMISSIVE=1}(Uj||(Uj={})),function(e){e.TWLS_RED=0,e.TWLS_GREEN=1,e.TWLS_BLUE=2,e.TWLS_NONE=3,e.TWLS_WHITE=4,e.TWLS_UV=5,e.TWLS_IR=6}(Vj||(Vj={})),function(e){e.TWNF_NONE=0,e.TWNF_AUTO=1,e.TWNF_LONEPIXEL=2,e.TWNF_MAJORITYRULE=3}(Gj||(Gj={})),function(e){e.TWOR_ROT0=0,e.TWOR_ROT90=1,e.TWOR_ROT180=2,e.TWOR_ROT270=3,e.TWOR_PORTRAIT=0,e.TWOR_LANDSCAPE=3,e.TWOR_AUTO=4,e.TWOR_AUTOTEXT=5,e.TWOR_AUTOPICTURE=6}(jj||(jj={})),function(e){e.TWOV_NONE=0,e.TWOV_AUTO=1,e.TWOV_TOPBOTTOM=2,e.TWOV_LEFTRIGHT=3,e.TWOV_ALL=4}(Hj||(Hj={})),function(e){e.TWPF_CHOCOLATE=0,e.TWPF_VANILLA=1}(zj||(zj={})),function(e){e.TWPC_CHUNKY=0,e.TWPC_PLANAR=1}(Kj||(Kj={})),function(e){e.Info=1,e.Error=2,e.NotInstalledError=3}(Jj||(Jj={})),function(e){e.Binary=0,e.Base64=1}(Qj||(Qj={})),Et.mix(xt.DWT,{EnumDWT_DeviceType:Px,EnumDWT_Cap:wj,EnumDWT_CapLanguage:Ej,EnumDWT_CapSupportedSizes:Aj,EnumDWT_CapType:kj,EnumDWT_CapValueType:Pj,EnumDWT_CapFeederAlignment:xj,EnumDWT_CapFeederOrder:Dj,EnumDWT_CapPrinter:Fj,EnumDWT_CapPrinterMode:Wj,EnumDWT_CapBitdepthReduction:Rj,EnumDWT_CapBitOrder:Nj,EnumDWT_CapFilterType:Oj,EnumDWT_CapFlash:Mj,EnumDWT_CapFlipRotation:Lj,EnumDWT_CapImageFilter:Bj,EnumDWT_CapLightPath:Uj,EnumDWT_CapLightSource:Vj,EnumDWT_CapNoiseFilter:Gj,EnumDWT_CapORientation:jj,EnumDWT_CapOverscan:Hj,EnumDWT_CapPixelFlavor:zj,EnumDWT_CapPlanarChunky:Kj,EnumDWT_ImageType:xD,EnumDWT_ImageFormatType:vG,EnumDWT_ResponseType:oG,EnumDWT_SourceMatchField:PD,EnumDWT_UploadDataFormat:Qj,EnumDWT_WorkMode:lj,EnumDWT_ConvertMode:Lk});var Zj,$j,eH,tH,rH,nH,iH=xt.DWT;iH.EnumPDF_Page={Page_Default:0,Page_Custom:1,Page_A4:2,Page_A4_Reverse:3,Page_A3:4,Page_A3_Reverse:5,Page_Letter:6,Page_Letter_Reverse:7,Page_Legal:8,Page_Legal_Reverse:9},iH.EnumDWT_PixelType={TWPT_BW:0,TWPT_GRAY:1,TWPT_RGB:2,TWPT_PALLETE:3,TWPT_CMY:4,TWPT_CMYK:5,TWPT_YUV:6,TWPT_YUVK:7,TWPT_CIEXYZ:8,TWPT_LAB:9,TWPT_SRGB:10,TWPT_SCRGB:11,TWPT_INFRARED:16},iH.EnumDWT_BorderStyle={TWBS_NONE:0,TWBS_SINGLEFLAT:1,TWBS_SINGLE3D:2},iH.EnumDWT_MessageType={TWQC_GET:1,TWQC_SET:2,TWQC_GETDEFAULT:4,TWQC_GETCURRENT:8,TWQC_RESET:16},iH.EnumDWT_TransferMode={TWSX_NATIVE:0,TWSX_FILE:1,TWSX_MEMORY:2},iH.EnumDWT_FileFormat={TWFF_TIFF:0,TWFF_PICT:1,TWFF_BMP:2,TWFF_XBM:3,TWFF_JFIF:4,TWFF_FPX:5,TWFF_TIFFMULTI:6,TWFF_PNG:7,TWFF_SPIFF:8,TWFF_EXIF:9,TWFF_PDF:10,TWFF_JP2:11,TWFF_JPN:12,TWFF_JPX:13,TWFF_DEJAVU:14,TWFF_PDFA:15,TWFF_PDFA2:16},iH.EnumDWT_TIFFCompressionType={TIFF_AUTO:0,TIFF_NONE:1,TIFF_RLE:2,TIFF_FAX3:3,TIFF_T4:3,TIFF_FAX4:4,TIFF_T6:4,TIFF_LZW:5,TIFF_JPEG:7,TIFF_PACKBITS:32773},iH.EnumDWT_InterpolationMethod={IM_NEARESTNEIGHBOUR:1,IM_BILINEAR:2,IM_BICUBIC:3,IM_BESTQUALITY:5},iH.EnumDWT_PDFCompressionType={PDF_AUTO:0,PDF_FAX3:1,PDF_FAX4:2,PDF_LZW:3,PDF_RLE:4,PDF_JPEG:5,PDF_JP2000:6,PDF_JBIG2:7},iH.EnumDWT_ShowMode={SW_ACTIVE:0,SW_MAX:1,SW_MIN:2,SW_CLOSE:3,SW_IFLIVE:4},iH.EnumDWT_UnitType={TWUN_INCHES:0,TWUN_CENTIMETERS:1,TWUN_PICAS:2,TWUN_POINTS:3,TWUN_TWIPS:4,TWUN_PIXELS:5,TWUN_MILLIMETERS:6},iH.EnumDWT_DUPLEX={TWDX_NONE:0,TWDX_1PASSDUPLEX:1,TWDX_2PASSDUPLEX:2},iH.EnumDWT_MagType={TWMD_MICR:0,TWMD_RAW:1,TWMD_INVALID:2},iH.EnumDWT_DataSourceStatus={TWDSS_CLOSED:0,TWDSS_OPENED:1,TWDSS_ENABLED:2,TWDSS_ACQUIRING:3},function(e){e.enumFitWindow=0,e.enumFitWindowHeight=1,e.enumFitWindowWidth=2}(Zj||(Zj={})),iH.EnumDWT_FitWindowType={enumFitWindow:Zj.enumFitWindow,enumFitWindowHeight:Zj.enumFitWindowHeight,enumFitWindowWidth:Zj.enumFitWindowWidth},iH.EnumDWT_PlatformType={enumUnknown:OC.enumUnknown,enumWindow:OC.enumWindow,enumMac:OC.enumMac,enumLinux:OC.enumLinux,enumEmbed:OC.enumEmbed,enumChromeOS:OC.enumChromeOS,enumHarmonyOS:OC.enumHarmonyOS,enumAndroid:OC.enumAndroid,enumiOS:OC.enumiOS},function(e){e.Default=0,e.Hand=1,e.Crosshair=2,e.Zoom=3,e.NWResize=4,e.EResize=5,e.NResize=6,e.Resize=7,e.Move=8}($j||($j={})),iH.EnumDWT_MouseShape={Default:$j.Default,Hand:$j.Hand,Crosshair:$j.Crosshair,Zoom:$j.Zoom,NWResize:$j.NWResize,EResize:$j.EResize,NResize:$j.NResize,Resize:$j.Resize,Move:$j.Move},iH.EnumDWT_Language={English:0,French:1,Arabic:2,Spanish:3,Portuguese:4,German:5,Italian:6,Russian:7,Chinese:8},iH.EnumDWT_InitMsg={Info:Jj.Info,Error:Jj.Error,NotInstalledError:Jj.NotInstalledError},iH.EnumDWT_Driver={TWAIN:gF.TWAIN,ICA:gF.ICA,SANE:gF.SANE,TWAIN_AND_ICA:gF.TWAIN_AND_ICA,TWAIN_AND_TWAIN64:gF.TWAIN_AND_TWAIN64,TWAIN64:gF.TWAIN64},iH.EnumDWT_CompressionType={TWCP_NONE:0,TWCP_PACKBITS:1,TWCP_GROUP31D:2,TWCP_GROUP31DEOL:3,TWCP_GROUP32D:4,TWCP_GROUP4:5,TWCP_JPEG:6,TWCP_LZW:7,TWCP_JBIG:8,TWCP_PNG:9,TWCP_RLE4:10,TWCP_RLE8:11,TWCP_BITFIELDS:12,TWCP_ZIP:13,TWCP_JPEG2000:14},function(e){e.Single=0,e.Multiple=1}(eH||(eH={})),iH.EnumDWT_SelectionMode={Single:eH.Single,Multiple:eH.Multiple},iH.EnumDWT_ConfirmExitType={Cancel:0,Exit:1,SaveAndExit:2},iH.EnumDWT_WebsocketReadyState={CONNECTING:SD.CONNECTING,OPEN:SD.OPEN,CLOSING:SD.CLOSING,CLOSED:SD.CLOSED},function(e){e.TwainService=1}(tH||(tH={})),iH.EnumDWT_ServiceType={TwainService:tH.TwainService},function(e){e["default"]=0,e.standard=1,e.supported=2}(rH||(rH={})),iH.EnumDWT_ExtImageInfo={"default":rH["default"],standard:rH.standard,supported:rH.supported};var oH,aH=20230506,sH=function(){if(xt.dcp){var e=xt.dcp.dcpJSVer;if(Et.isNumber(e))return e>=aH}return!1};if(sH())sH=nH,aH=nH;else{var uH=Tw.detect,cH={_checkService:function(e,t){uH.dcpStatus=uH.EnumDCP_DetectStatus.CheckingServiceVer,lH(null,"DSVersion").then(e,t)},_checkUpdateFile:function(e,t){lH(null,"CheckUpdateFile").then(e,t)},_updateService:function(e,t){lH(null,"UpdateService").then(e,t)},loadZip:(oH=eA(g.mark((function e(t,r){var n,i,o,a;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=!1,100===(n=r)&&(n=0,i=!0),xt.DWT.IfUpdateService?[rw(),"/LoadZipFromBytes?type=",n,"&dsver=",tw().join(""),"&ts=",Et.now()].join(""):["dcp/",Tw.oldDWASMVerStr,"/LoadZipFromBytes?type=0","&dsver=",tw().join(""),"&ts=",Et.now()].join(""),o=pk.getHttpClientForDcp(),e.next=6,o.request(t,void 0,{},3e4);case 6:return a=e.sent,i&&Et.isString(a)&&(a=a.replace('"result" : [ 0,','"result" : [ 100,')),e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)}))),function(e,t){return oH.apply(this,arguments)}),_getDSUpdateZipUrl:function(){var e,t,r="";return e="Win",K.bMac?e="Mac":K.bLinux&&(e="Linux"),t=K.bFileSystem?"":"?t="+Et.now(),K.bWin&&Tw.b64bit&&(r="_x64"),[xt.DWT.ResourcesPath,"/dist/serviceupdate/",e,"DSUpdate_",ew().join("."),r,".zip",t].join("")},getPorts:function(e,t){var r="GetPorts",n="dwasm2_"+nw();return dH(e,r,{id:Et.now(),method:r,version:n,parameter:[t]},ww)},_checkUpdateZip:function(e,t,r,n,i){var o,a,s,u,c,l,d,f=3;o=function(e,t,r){var n=-1;if(r&&(n=r.status),0==n)return setTimeout((function(){cH._checkService(l,d)}),5e3),!0;var i=cH._getDSUpdateZipUrl();return XE(i,{mode:"cors",dataType:"arraybuffer"}).then(u,a),!0},a=function(e){t&&t();var i="The update package can't be downloaded. The error code is "+e.httpCode+".";return r&&r(!0,i),cH._sendStatusEvent(!0,i),setTimeout(n,0),!0},s=function(e){if(!(Et.isArray(e)&&e.length>1))return!1;if(1==e[1])uH.dcpStatus=uH.EnumDCP_DetectStatus.VerifiedZip,cH._sendStatusEvent(),uH.dcpStatus=uH.EnumDCP_DetectStatus.UpdatingService,cH._sendStatusEvent(),setTimeout((function(){cH._checkService(l,d)}),5e3);else{var i=0;if("exception"in e&&(i=e.exception),-2373==i)return cH._funUpdateFailed(t,r,e,200),setTimeout(n,0),!0;setTimeout(o,0)}return!0},u=function(e){xt.dcp.loadZip(e,1).then((function(e){var i,o;try{Et.isString(e)&&"result"in(o=Et.parse(e.replace(/\0/g,"")))&&(i=o.result)}catch(a){}Et.isArray(i)&&i.length>2&&1==i[2]?setTimeout((function(){cH._checkService(l,d)}),5e3):(cH._funUpdateFailed(t,r,e,200),setTimeout(n,0))}),c),e=null},c=function(e,i,o){var a=-1;return o&&(a=o.status),0==a?setTimeout((function(){cH._checkService(l,d)}),5e3):(cH._funUpdateFailed(t,r,e,o.status),setTimeout(n,0)),!0},l=function(e){return!!(Et.isArray(e)&&e.length>0&&e[0])&&(!!function(e,t){if(!Aw(lw()))return!0;if(Et.isArray(e)&&4==e.length&&Et.isArray(t)&&t.length>=4)return e[0]>t[0]||e[0]==t[0]&&e[1]>t[1]||e[0]==t[0]&&e[1]==t[1]&&e[2]>t[2]||e[0]==t[0]&&e[1]==t[1]&&e[2]==t[2]&&parseInt(e[3])>=parseInt(t[3]);if(Et.isArray(e)&&1==e.length&&Et.isArray(t)&&t.length>=1)return parseInt(e[0])>=parseInt(t[0]);return!1}(e[0].split(","),tw())&&(uH.bConnected=!0,t&&t(),uH.dcpStatus=uH.EnumDCP_DetectStatus.CheckedService,cH._sendStatusEvent(!1,e[0]),uH.dcpStatus=uH.EnumDCP_DetectStatus.UpdateSucceed,cH._sendStatusEvent(),setTimeout(n,0),!0))},d=function(e,i){var o=1e3;return f<3&&(o=500),--f<0?(cH._funShowUpgradeDialogWhenUpdateFailed(t,r),setTimeout(n,0),!0):(setTimeout((function(){cH._checkService(l,d)}),o),!0)},e&&e(),uH.dcpStatus=uH.EnumDCP_DetectStatus.VerifyingZip,cH._sendStatusEvent(),cH._checkUpdateFile(s,o)},_getStatusString:function(e,t){var r,n,i="";return e==uH.EnumDCP_DetectStatus.Init?"Getting manager version":e==uH.EnumDCP_DetectStatus.Connected?(t&&(i=t),"Getting manager version succeeded and the version is "+i):e==uH.EnumDCP_DetectStatus.CheckingManagerVer?"Getting manager version":e==uH.EnumDCP_DetectStatus.CheckingServiceVer?"Getting service version":e==uH.EnumDCP_DetectStatus.NotInstalled?"Dynamsoft Service Not Installed":e==uH.EnumDCP_DetectStatus.UpdateSkipped?"Update skipped":e==uH.EnumDCP_DetectStatus.CheckedService?(t&&(i=t),"Getting service version succeeded and the version is "+i):e==uH.EnumDCP_DetectStatus.VerifyingZip?"Verifying the update package":e==uH.EnumDCP_DetectStatus.VerifiedZip?"Update package verified":e==uH.EnumDCP_DetectStatus.UpdatingService?"Updating the service":e==uH.EnumDCP_DetectStatus.UpdateSucceed?"Update succeeded":e==uH.EnumDCP_DetectStatus.UpdateFailed?(n=".",t&&t.length>0?("."==t.slice(t.length-1)&&(n=""),r=" with the error: "+t):r="","The update failed"+r+n):""},_sendStatusEvent:function(e,t){var r=!!e,n=window;Et.isFunction(n.OnGetServiceUpdateStatus)&&n.OnGetServiceUpdateStatus(r,uH.dcpStatus,cH._getStatusString(uH.dcpStatus,t))},_getErr:function(e){var t,r="";try{Et.isString(e)?(t=e.replace(/\0/g,""),t=Et.parse(t)):e&&(t=e),"description"in t&&(r=t.description)}catch(n){}return r},_funShowUpgradeDialogWhenUpdateFailed:function(e,t){return uH.bConnected=!0,uH.dcpStatus=uH.EnumDCP_DetectStatus.UpdateFailed,e&&e(),t&&t(),cH._sendStatusEvent(!0),!0},_funUpdateFailed:function(e,t,r,n){var i,o;return uH.bConnected=!0,uH.dcpStatus=uH.EnumDCP_DetectStatus.UpdateFailed,e&&e(),200==n?(i="The update failed.",o=cH._getStatusString(uH.dcpStatus,cH._getErr(r))):o=i="The update failed. The error code is "+n,t&&t(!0,i),cH._sendStatusEvent(!0,o),!0},getDSPath:function(e,t){return aw.getDSPath(t)},getLinuxHTML5DebPath:function(){return aw.getDSPath(".deb")},getLinuxHTML5RpmPath:function(){return aw.getDSPath(".rpm")},getBinaryFileInfo:function(e,t){var r="GetBinaryFileInfo",n={id:(new Date).getTime().toString(),method:r,version:"dwasm2_"+nw(),parameter:[]},i=Et.stringify(n),o=function(r,n,i){var o;r&&(o=Et.parse(r)),o?e(o):t(r,n,i)};if(xt.DWT.ConnectWithSocket&&K.bHTML5Edition){var a=kD.getWsUrl(xt.DWT.Host,K.bSSL?Tw.SSLPort:Tw.Port);return kD.postStringDataByWSUrl(a,i).then(o,t),!0}var s=[rw(),"/",r,"?type=1&dsver=",tw().join(""),"&ts=",Et.now()].join("");pk.getHttpClientForDcp().request(i,s,{},500).then(o,t)}};Et.mix(Tw,cH),xt.dcp=Tw,xt.dcp.dcpJSVer=aH,sH=nH,aH=nH}function lH(e,t,r,n){var i;return i={id:(new Date).getTime().toString(),method:t,version:"dwasm2_"+nw(),parameter:[]},"VersionInfo"==t&&(i.version="dwasm2_"+Cw.getVersionStrForCheck()),bP.isLongKey(r)&&(i.productKey=r),dH(e,t,i,ww,n)}function dH(e,t,r,n,i){return fH.apply(this,arguments)}function fH(){return fH=eA(g.mark((function e(t,r,n,i,o){var a,s,u,c,l,d,f,h,p;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Et.stringify(n),Tw.detect.bConnected=!1,s=[rw(),"/",r,"?type=1&dsver=",tw().join(""),"&ts=",Et.now()].join(""),c=K.bSSL,l=c?Tw.SSLPort:Tw.Port,u=pk.getHttpClient(t,l,c),d={},o&&!K.bSSL&&(d.redirect="manual"),e.prev=8,e.next=11,u.request(a,s,d,i);case 11:f=e.sent,e.next=21;break;case 14:if(e.prev=14,e.t0=e["catch"](8),!o||K.bSSL){e.next=20;break}if((e.t0&&e.t0.code)!=yw.HTTPRedirected){e.next=20;break}throw VE();case 20:throw e.t0;case 21:if(f&&(h=Et.parse(f)),!(h&&"exception"in h&&"description"in h)){e.next=24;break}throw{code:h.exception,message:h.description};case 24:if(!h||!("result"in h)){e.next=30;break}if(!Tw.detect.bConnected){e.next=27;break}return e.abrupt("return",h.result);case 27:return Tw.detect.bConnected=!0,Tw.detect.dcpStatus=Tw.detect.EnumDCP_DetectStatus.Connected,e.abrupt("return",h.result);case 30:throw NE(p={}),hA(p);case 33:case"end":return e.stop()}}),e,null,[[8,14]])}))),fH.apply(this,arguments)}function hH(e){var t=Date.parse(e+"T00:00:00");return""!=e&&!isNaN(t)&&(!!xt.DWT.CheckCertExpired&&(new Date).getTime()>=t-864e5*xt.DWT.CertificateConfig.UpdateDaysBeforeExpired)}xt.DWT.__innerCheckCertDate=function(e){hH(e)&&(Et.isFunction(xt.OnCertExpired)&&xt.OnCertExpired(e),setTimeout((function(){xt.DWT.UpdateCert(xt.DWT.CertificateConfig.URL,xt.OnUpdateCertSuccess,xt.OnUpdateCertFailure)}),5e3))},xt.DWT.__innerUpdateCert=function(e,t,r,n){var i=[rw(),"/LoadZipFromBytes?type=",4,"&dsver=",tw().join(""),"&ts=",Et.now()].join("");pk.getHttpClientForDcp(null,t).request(e,i,{},3e4).then(r,(function(e){Et.isFunction(n)&&n(e)}))},xt.DWT.__innerReboot=function(e,t){var r=[rw(),"/admin?ts=",Et.now()].join(""),n='{"id":"'+(new Date).getTime().toString()+'","method":"Reboot","parameter":[],"version":"dwasm2_'+nw()+'"}';pk.getHttpClientForDcp().request(n,r,{},3e4).then(e,t)},xt.DWT.UpdateCert=function(e,t,r){Et.isString(e)&&""!=e?XE(e,{mode:"cors",dataType:"arraybuffer"}).then((function(e){xt.DWT.__innerUpdateCert(e,!1,(function(res){var resObj=Et.parse(res);if(resObj.description){Et.isFunction(r)&&r({code:resObj.exception,message:resObj.description});return;}xt.DWT.CheckCertExpired=!1,Et.isFunction(t)&&t()}),(function(n){K.bSSL?xt.DWT.__innerUpdateCert(e,!0,t,r):Et.isFunction(r)&&r(n)}))}),r):Et.isFunction(r)&&r()};var gH={Errors:{FilePathSyntaxIncorrect:function(e){e._errorCode=-3123,e._errorString="The filename, directory name, or volume label syntax is incorrect."}},checkFilePath:function(e,t){return Et.isString(t)&&0!=t.length?Et.startsWith(t,"http://")||Et.startsWith(t,"https://")||Et.startsWith(t,"ftp://")?(bt.File.Errors.FilePathSyntaxIncorrect(e),iC):oC:(qw(e),iC)}};gH.checkFolder=gH.checkFilePath,bt.File=gH,bt.showProgress=function(){},bt.closeProgress=function(){};var pH,mH=document.location.protocol,_H=location.hostname,vH=K.bSSL,yH={detect:{ssl:vH,dcpStatus:0,dcpCallbackType:0,arySTwains:[],bFirst:oC,bOK:iC,__dialog:iC,cssLoaded:iC,viewerScriptLoaded:iC,bNoControlEvent:iC,bNeedUpgradeEvent:iC,bPromptJSOrServerOutdated:iC,detectType:vH?1:"http:"===mH||""===_H?0:-1,tryTimes:0,ports:[{port:xt.DWT.SSLPort,ssl:oC},{port:xt.DWT.Port,ssl:iC}],cUrlIndex:0,urls:[],onNoControl:iC,needUpgrade:iC,OnDetectNext:iC,OnCreatWS:iC,bMaskShow:iC},page:{bUnload:iC,OnUnload:iC}};function IH(){var e=fw;if(xt.DWT.CertificateConfig){var t=xt.DWT.CertificateConfig;Et.isString(t.URL)||(t.URL=e.URL),(!Et.isNumber(t.UpdateDaysBeforeExpired)||t.UpdateDaysBeforeExpired<=0)&&(t.UpdateDaysBeforeExpired=e.UpdateDaysBeforeExpired)}else xt.DWT.CertificateConfig=e;vj(),Et.isString(xt.DWT.ProductKey)&&(xt.DWT.ProductKey=Et.trim(xt.DWT.ProductKey)),xt.navInfo&&(K.bMac||K.bWin)&&(xt.navInfo.bEmbed=!1,xt.navInfo.bArm64=!1,xt.navInfo.bMips64=!1),xt.DWT.Debug&&(Et.debug=!0)}function SH(){if(bt.detect.cssLoaded)return bt.Promise.resolve();var e=xt.DWT.ResourcesPath,t="";K.bFileSystem||(t=bt.timestamp);var r=[[e,"/src/dynamsoft.webtwain.css",t].join("")];return bw.bHTML5Edition&&xt.DWT.UseDefaultViewer&&r.push([e,"/src/dynamsoft.webtwain.viewer.css",t].join("")),bw.bHTML5Edition&&!Dynamsoft.navInfoSync.bFileSystem&&function(e){TH.apply(this,arguments)}(r),new bt.Promise((function(e,t){var n=!0;K.bSafari?(Et.addAllCss(r,!1,(function(e){e||n&&(t({code:-2804,message:"Loading the WebTwain css files has failed."}),n=!1)})),bt.detect.cssLoaded=oC,e()):Et.addAllCss(r,!1,(function(r){if(r)return bt.detect.cssLoaded=oC,void e();n&&(n=!1,t({code:-2804,message:"Loading the WebTwain css files has failed."}))}))}))}function TH(){return TH=eA(g.mark((function e(t){var r;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,r=0,r=0;case 3:if(!(r<t.length)){e.next=14;break}return e.next=6,bt.fetch(t[r]);case 6:if(!(e.sent.indexOf("* Author: Dynamsoft Support Team")>0)){e.next=9;break}return e.abrupt("continue",11);case 9:mD(HE(t[r]));case 11:r++,e.next=3;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e["catch"](0),mD(e.t0);case 19:case"end":return e.stop()}}),e,null,[[0,16]])}))),TH.apply(this,arguments)}function bH(){if(bw.loadResourcePath||!bw.loadingResourcePath)return pH&&pH(),void(pH=null);setTimeout(bH,100)}function CH(e){if(Mk("Loading css..."),IH(),bw.loadResourcePath||bw.loadingResourcePath)return bw.loadResourcePath?SH():bw.loadResourcePath||!bw.loadingResourcePath?bt.Promise.resolve():(pH=null,new bt.Promise((function(e){pH=e,setTimeout(bH,100)})));bw.loadingResourcePath=!0,(xt.DWT.Port>0||xt.DWT.SSLPort>0)&&(bt.detect.ports=[{port:xt.DWT.Port,ssl:!1},{port:xt.DWT.SSLPort,ssl:!0}],HD.removeItem("DWT_port"),HD.removeItem("DWT_ssl")),Et.each(bt._funsAfterConfigLoaded,(function(e){try{Et.isFunction(e)&&e()}catch(t){}}));var t=Et.sizzle(".dynamsoft_waiting");if(t&&t.length>0){var r=t[0];r.parentNode&&r.parentNode.removeChild(r)}var n=xt.DWT.ResourcesPath,i="";K.bFileSystem||(i=bt.timestamp);var o=oC,a=[];return K.bSafari&&(o=iC),a.push([n,"/dynamsoft.webtwain.install.js",i].join("")),xt.DWT.bNpm&&(a=[]),bw.bHTML5Edition&&xt.DWT.UseDefaultViewer&&(Mk("Loading the viewer script..."),a.push([n,"/src/dynamsoft.webtwain.viewer.js",i].join(""))),xt.DWT.bChromeExtension&&(a=[]),SH().then((function(){return 0==a.length?(wH(),bw.loadResourcePath=!0,void(bw.loadingResourcePath=!1)):new bt.Promise((function(e,t){Et.addScripts(a,o,!1,(function(r){var n=r;if(bw.bHTML5Edition&&xt.DWT.UseDefaultViewer&&!Et.isFunction(xt.DWTViewer)&&(n=!1),K.bIE&&bw.bActiveXEdition&&(Et.isFunction(xt.DWT._innerLoad)||(n=!1)),!n)return bw.loadingResourcePath=!1,void t({code:-2803,message:"Loading the WebTwain JavaScript source files has failed."});wH(),bw.loadResourcePath=!0,bw.loadingResourcePath=!1,xt.DWT.OnWebTwainWillInit&&xt.DWT.OnWebTwainWillInit(),e()}))}))}))}function wH(){if(bt.bNode||K.bJSDom);else if(Et.isArray(xt.aryAddonReadyFun)){for(var e=0,t=function(){var t=xt.aryAddonReadyFun[e];if(Et.isFunction(t))try{t(bt)}catch(VV){Et.log(VV.stack||VV,"error"),setTimeout((function(){throw VV}),0)}};e<xt.aryAddonReadyFun.length;e++)t();xt.aryAddonReadyFun=[]}}Et.mix(bt,yH),bt.Addon_Events=[],bt.Addon_Sendback_Events=[];var EH=[],AH=[];function kH(){var e,t=EH.length;for(e=0;e<t;e++)EH[e]();EH.splice(0),AH.splice(0),FH=0}function PH(){if(FH>0&&(new Date).getTime()-FH>DH){var e,t={code:-2802,message:"The file dynamsoft.webtwain.config.js timed out while loading."},r=xt.DWT.Containers;r&&0!==r.length||(FE(e={}),t={code:e._errorCode,message:e._errorString}),function(e){var t,r=AH.length;for(t=0;t<r;t++)AH[t](e);EH.splice(0),AH.splice(0),FH=0}(t)}else if(xt.DWT.Containers||xt.DWT.ProductKey||xt.DWT.bNpm||0==xt.DWT.AutoLoad){if(bw.dwtConfigLoading)return;if(bw.dwtConfigLoaded)return void kH();bw.dwtConfigLoading=!0;var n=K.bFileSystem,i=Ax.basePath,o=xt.DWT.ResourcesPath,a="";if(Et.isArray(xt.DWT.Containers)||(xt.DWT.Containers=[]),!n){void 0!==o&&""!=o||(o=i),o.length>0&&"/"==o.charAt(o.length-1)&&(o=o.substr(0,o.length-1)),a=bt.timestamp,xt.DWT.ResourcesPath=o}if(K.bIE){var s=K.IEVersion;if((""===s||s>=10)&&xt.DWT.IfUseActiveXForIE10Plus){var u=iC;K.bHTML5Edition=u,bw.bHTML5Edition=u,bw.bActiveXEdition=!u,bw.bChromeEdition=bw.bHTML5Edition}}bw.bActiveXEdition?Et.addScript([o,"/src/dynamsoft.webtwain.activex.js",a].join(""),!0,!1,(function(){bw.dwtConfigLoaded=!0,bw.dwtConfigLoading=!1,kH()})):(bw.dwtConfigLoaded=!0,bw.dwtConfigLoading=!1,kH())}else setTimeout(PH,100)}var xH,DH=3e3,FH=0;function WH(e){return Mk("Loading the config script..."),bw.dwtConfigLoaded?bt.Promise.resolve():(e&&(DH=1e3*parseInt(e))<1&&(DH=1),new bt.Promise((function(e,t){EH.push(e),AH.push(t),Ok((function(){FH=(new Date).getTime(),setTimeout(PH,100)}))})))}function RH(){var e;(e=xt.DWT.WebTwainIdMap)&&Et.each(e,(function(e,t){e&&e._OnPageBlur&&e._OnPageBlur()}))}if(bw.bActiveXEdition){var NH=function(){var e,t,r,n,i;if(xt.DWT.lunload(),bt.closeAll&&bt.closeAll(),n=xt.DWT.ContainerMap)for(i=Object.keys(n),e=0;e<i.length;e++)(r=i[e])&&r in n&&(t=n[r])&&(t.__unload(),delete n[r]);if(n=xt.DWT.WebTwainIdMap)for(i=Object.keys(n),e=0;e<i.length;e++)(r=i[e])&&r in n&&(t=n[r])&&(t.__unload(),delete n[r]);for(e=0;e<bt.product.unloadQueue.length;e++){var o=bt.product.unloadQueue[e];bt.isFunction(o)&&o()}return bt.product.unloadQueue.splice(0),bt.detect.arySTwains.splice(0),bt.Promise.resolve()},OH=!1;xt.DWT.Unload=function(){NH();try{xt.DWT.CloseDialog(),bt._zdgb_xkz_dhk(),bt.closeProgress(null,""),bt.hideMask()}catch(e){}},xt.DWT.Load=function(){if(!bt.product.bDWTLoading)return bt.product.bDWTLoading=true,bt.detect.axAutoLoadDone=!1,WH().then(CH).then(NH).then((function(){return xt.DWT._innerLoad()})).then((function(){bt.product.bDWTLoading=!1,bt.detect.axAutoLoadDone=!0}),(function(e){bt.product.bDWTLoading=!1,bt.detect.axAutoLoadDone=!1,pD(e)}))},xt.DWT.ConnectToTheService=xt.DWT.Load,xt.DWT.CheckConnectToTheService=function(e,t,r,n){bt.product.bActiveXEdition?bt.isFunction(n)&&n():bt.isFunction(r)&&r()},xt.DWT.CreateDWTObject=function(e,t,r,n,i,o){return bt._safePromptCustomMsg((function(){o&&o(MC.ErrStr_BROWSER_NOT_SUPPORT)})),OH},xt.DWT.CreateDWTObjectEx=function(e,t,r){return bt._safePromptCustomMsg((function(){r&&r(MC.ErrStr_BROWSER_NOT_SUPPORT)})),OH},xt.DWT.CreateRemoteScanObjectAsync=function(){var e={};return kw(e,-2433,"The ActiveX edition does not support this method or property."),bt.Promise.reject({code:e._errorCode,message:e._errorString})},xt.DWT.DeleteDWTObject=function(e){return OH}}function MH(){return!(function(e){if(Et.isString(e)){if("localhost"==e||"127.0.0.1"==e)return!0;var t=e.split(".");if(4==t.length&&/^(([1-9]?\d|1\d{2}|2[0-4]\d|25[0-5])\.){3}([1-9]?\d|1\d{2}|2[0-4]\d|25[0-5])$/.test(e)){var r=parseInt(t[0]),n=parseInt(t[1]);if(127==r||10==r||169==r&&254==n||172==r&&n>=16&&n<=31||192==r&&168==n)return!0}}return!1}(location.hostname)||K.bSSL||K.bFileSystem||!((K.bChrome||K.bEdge)&&parseInt(K.strBrowserVersion)>=94))}function LH(e,t,r,n){return BH.apply(this,arguments)}function BH(){return BH=eA(g.mark((function e(t,r,n,i){var o,a;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r!=pA.GET_TASKID){e.next=4;break}return e.abrupt("return",i.taskId);case 4:if(r!=pA.ONMESSAGE_PROCESS_DATA){e.next=8;break}return e.abrupt("return",Et.parse(t));case 8:if(r!=pA.ONMESSAGE_GET_TASKID){e.next=13;break}if(!i||!i.client){e.next=11;break}return e.abrupt("return",i.client.getRequestTaskId());case 11:e.next=20;break;case 13:if(r!=pA.HANDLE_RAW_MESSAGE){e.next=20;break}if(o=null==i?void 0:i.userData){e.next=17;break}return e.abrupt("return",!1);case 17:return(a=t).indexOf("Version not found")>=0||a.indexOf("Function not found")>=0?Et.isFunction(o.fFun)&&o.fFun():Et.isFunction(o.sFun)&&o.sFun(a),e.abrupt("return",a);case 20:case"end":return e.stop()}}),e)}))),BH.apply(this,arguments)}function UH(e,t,r,n){var i,o=Et.now(),a=Et.guid(),s={id:a,method:"VersionInfo",version:[bw.getDWTPrefix(),Cw.getVersionStrForCheck()].join("")},u=LH,c=ww;i={client:e,userData:{cmdId:a,cmd:null,sFun:t,fFun:r,rawData:!0},taskId:o},e.setRetry(0),e.request(Et.stringify(s),u,i,c).then((function(t){return e.dispose(),t}),(function(){Et.isFunction(n)&&n(),e.dispose()}))}function VH(){bw.loadResourcePath?(Mk(Bk),xH()):setTimeout(VH,100)}function GH(){return bw.loadResourcePath?(Mk(Bk),bt.Promise.resolve()):new bt.Promise((function(e,t){xH=e,setTimeout(VH,100)}))}function jH(e){var t,r,n=e.WebTwainId,i=e.Host,o=e.Port,a=e.PortSSL;return r={},Et.isString(n)&&""!==n?r.id=n:r.id=n=jx(),Et.isDOM(e.Container)?(t=e.Container,Et.isString(t.id)&&""!==t.id||(t.id=["dwt_node_",Et.getRandom()].join("")),r.container=t,r.bNoViewer=!1):r.bNoViewer=!0,r.bNoViewer?(r.width=0,r.height=0):(Et.isUndefined(e.Width)?t.style.width?r.width=t.style.width:r.width=300:r.width=e.Width,Et.isUndefined(e.Height)?t.style.height?r.height=t.style.height:r.height=300:r.height=e.Height),r.dmService=e.dmService,Et.isString(i)&&""!=i||(i=lw()),r.host=i,K.bSSL?(a||(a=xt.DWT.SSLPort),r.port=a):(o||(o=xt.DWT.Port),r.port=o),r}xt.DWT.GetWebTwain=xt.DWT.GetWebTwainEx=function(e){var t=e,r=xt.DWT.WebTwainIdMap;if(!t){var n=Object.keys(r);return n.length>0?r[t=n[0]]:void 0}if(t in r)return r[t];var i=xt.DWT.ContainerMap;return t in i?i[t]:void 0},xt.DWT.NeedCheckWebTwainBySocket=MH,xt.DWT.CheckWebTwainBySocket=function(e,t,r){var n,i,o,a=bt.detect.urls;if(a&&a.length>0){var s=a[0];n=s.host||lw(),i=s.port,o=s.ssl}else Aw(n=lw())?(o=!(!K.bSSL||!K.bSafari),n=Cw.hostForCheckCert):o=K.bSSL,i=o?xt.DWT.SSLPort:xt.DWT.Port;UH(pk.getWsClient(n,i,o,!0),e,t,r)},xt.DWT.IsLocalServiceConnected=function(){return new bt.Promise((function(e,t){var r,n=lw();Et.each(bt.detect.ports,(function(e){K.bSSL?e.ssl&&(r=e.port):e.ssl||(r=e.port)})),xt.DWT.CheckConnectToTheService(n,r,(function(t,r,n){e(!0)}),(function(){t(!1)}))}))};var HH,zH=2,KH=3;function JH(e,t){Aw(e)&&(HD.item("DWT_port",t),HD.item("DWT_ssl",K.bSSL?"true":"false"))}function QH(e,t,r,n){return qH.apply(this,arguments)}function qH(){return(qH=eA(g.mark((function e(t,r,n,i){var o,a,s,u,c,l,d,f,h,p,m,_,v,y,I,S,T,b,C,w,E,A,k;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(xt.DWT.OnWebTwainInitMessage&&(o=LC,xt.DWT.OnWebTwainInitMessage(o,Jj.Info)),s=!1,u=!1,c=!1,i&&(i.bFromCreate&&(u=!0),i.bRemoteServer&&(c=!0)),l=Et.now(),d=['{"id":"',Et.guid(),'","method":"VersionInfo","version":"',bw.getDWTPrefix(),Cw.getVersionStrForCheck(),'"}'].join(""),f=!K.bSSL,e.prev=6,!xt.DWT.ConnectWithSocket){e.next=14;break}return h=Et.startsWith(t,"wss://")||Et.startsWith(t,"ws://")?t:kD.getWsUrl(t,r),e.next=11,kD.postStringDataByWSUrl(h,d);case 11:a=e.sent,e.next=21;break;case 14:return p="fa/VersionInfo?ts="+l,m=pk.getHttpClient(t,r,bt.detect.ssl),_={},f&&(_.redirect="manual"),e.next=20,m.request(d,p,_,n);case 20:a=e.sent;case 21:e.next=39;break;case 23:if(e.prev=23,e.t0=e["catch"](6),Et.log(["check DWT Version failed",Et.stringify(e.t0)]),!s){e.next=29;break}e.next=39;break;case 29:if(!f){e.next=33;break}if((e.t0&&e.t0.code)!=yw.HTTPRedirected){e.next=33;break}throw VE();case 33:throw LE(v={}),0,xt.DWT.OnWebTwainInitMessage&&xt.DWT.OnWebTwainInitMessage(v._errorString,Jj.Error),{code:v._errorCode,message:v._errorString};case 39:if(y="","",S={},T=!1,a&&(b=Et.parse(a)),!b||!("result"in b)){e.next=74;break}if(b=b.result,!(Et.isArray(b)&&b.length>0)){e.next=71;break}if(C=b[0],y=b.length>1?b[1]:"",w=b.length>2?b[2]:0,E=b.length>3?b[3]:"",I=b.length>4?b[4]:"",""!==y){e.next=68;break}if(A="The WebTwain version is: "+C,xt.DWT.OnWebTwainInitMessage&&xt.DWT.OnWebTwainInitMessage(A,Jj.Info),"32"==w&&Aw(t)&&(Tw.b64bit=!1),Aw(t)&&(xt.DWT.li({instanceMode:xt.DWT.EnumInstance.dwt_desktop},"")||""!=E&&(xt.DWT.lsmid(E,""),xt.DWT.lsmid2b(E))),Et.isFunction(xt.OnSSLCertInfo)&&(""!=I&&(k=Date.parse(I+"T00:00:00"),k=isNaN(k)?null:new Date(k)),xt.OnSSLCertInfo(k)),!Et.isString(C)||""==C){e.next=65;break}if(u&&Mk(zk),!c&&!QD(C,bw.getServerVersionInfo(!0))){e.next=61;break}return e.abrupt("return",{host:t,port:r,version:C});case 61:Mk(Jk),Ow(S);case 63:e.next=66;break;case 65:T=!0;case 66:e.next=69;break;case 68:OE(S,y);case 69:e.next=72;break;case 71:T=!0;case 72:e.next=75;break;case 74:T=!0;case 75:throw T&&NE(S),xt.DWT.OnWebTwainInitMessage&&xt.DWT.OnWebTwainInitMessage(S._errorString,Jj.Error),{code:S._errorCode,message:S._errorString};case 78:case"end":return e.stop()}}),e,null,[[6,23]])})))).apply(this,arguments)}function YH(e,t,r){return XH.apply(this,arguments)}function XH(){return(XH=eA(g.mark((function e(t,r,n){var i,o,a;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Mk(Hk),r||Et.each(bt.detect.ports,(function(e){K.bSSL?e.ssl&&(r=e.port):e.ssl||(r=e.port)})),e.prev=2,e.next=5,QH(t,r,ww,{bFromCreate:!0});case 5:return i=e.sent,o=i.host,a=i.port,bt.detect.dcpStatus=zH,JH(o,a),e.next=11,CP(!1,!0);case 11:if(!Ew()||!Aw(t)){e.next=15;break}if(xt.DWT.li({instanceMode:xt.DWT.EnumInstance.dwt_desktop},"")){e.next=15;break}throw{code:-2827,message:"Failed to get Machine ID."};case 15:Mk(Kk),e.next=27;break;case 18:if(e.prev=18,e.t0=e["catch"](2),!n){e.next=25;break}throw bt.detect.dcpStatus=KH,e.t0;case 25:throw bt.detect.dcpStatus=KH,e.t0;case 27:return!Cw.versionInfoFromServer&&Aw(i.host)&&(Cw.versionInfoFromServer=i.version),e.abrupt("return",i);case 29:case"end":return e.stop()}}),e,null,[[2,18]])})))).apply(this,arguments)}function ZH(e,t){return $H.apply(this,arguments)}function $H(){return $H=eA(g.mark((function e(t,r){var n,i,o,a,s,u;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t,i=r,o=K.bSSL,a=tz(t),!Aw(t)){e.next=9;break}if(!MH()){e.next=6;break}throw u={code:yw.CORSError,message:'The Connection from the insecure (HTTP) web page to the local "Dynamsoft Service" failed!'},Et.isFunction(xt.OnHTTPCorsError)&&xt.OnHTTPCorsError(u.message),u;case 6:n=Cw.hostForCheckCert,i=o?xt.DWT.SSLPort:xt.DWT.Port,a==HH.Check127&&(K.bSafari||(o=!1,i=xt.DWT.Port));case 9:if(Cw.bFullEdition||!Ax.bMobile||K.bAndroid){e.next=15;break}return Et.isFunction(xt.OnMobileNotSupportCallback)?xt.OnMobileNotSupportCallback():Et.isFunction(xt.MobileNotSupportCallback)&&xt.MobileNotSupportCallback(),e.abrupt("return",{upgrade:!1,socket:!1});case 15:!Cw.bFullEdition&&Ax.bMobile&&K.bAndroid&&(a=HH.CheckLocalDynamsoftCert,o=!1,i=xt.DWT.Port);case 16:return e.next=19,ez(n,i,o,a);case 19:if(s=e.sent,o&&s&&s.retry,!(o&&s&&s.checkWithNoneSSL)){e.next=29;break}return o=!1,i=xt.DWT.Port,e.next=26,ez(n,i,o,a);case 26:if(!(s=e.sent)||!s.cert){e.next=29;break}throw{code:-2824,message:"The Connection from the web page failed. Please make sure the Dynamsoft Service is running."};case 29:return e.abrupt("return",s);case 30:case"end":return e.stop()}}),e)}))),$H.apply(this,arguments)}function ez(e,t,r,n){return new bt.Promise((function(i,o){if(n==HH.Check127){var a,s,u=Cw.hostForCheckCert;K.bSafari?(a=Tw.SSLPort,s=!0):(a=Tw.Port,s=!1);var c=pk.getWsClient(u,a,s);return c&&c.connected?(c.dispose(),i({upgrade:!1,socket:!0})):void function(e,t,r,n){var i,o=Et.now(),a={id:o,method:"GetServerInfo",parameter:[1],version:["dwasm2_",Cw.getVersionStrForCheck()].join("")},s=LH,u=ww;i={client:e,userData:{cmdId:o,cmd:null,sFun:t,fFun:r,rawData:!0},taskId:o},e.setRetry(0),e.request(Et.stringify(a),s,i,u).then((function(t){return e.dispose(),t}),(function(){Et.isFunction(n)&&n(),e.dispose()}))}(c,(function(e){var t,r=e;if(Et.isString(e))try{r=Et.parse(e)}catch(n){}if(r&&r.dcp){if(r.dcp.port&&r.dcp.sslPort)return void i({upgrade:!1,socket:!0,retry:!0});if(r.dcp.port&&!r.dcp.sslPort)return void o({code:-2819,message:"The Dynamsoft Service SSL certificate is invalid."})}throw NE(t={}),hA(t)}),(function(){i({upgrade:!0,socket:!0})}),(function(){i({upgrade:!1,socket:!1})}))}UH(pk.getWsClient(e,t,r,!0),(function(e){if(n==HH.CheckLocalDynamsoftCert){var t=e;if(Et.isString(e))try{t=Et.parse(e)}catch(u){}if(t&&Et.isArray(t.result)){var r=t.result;if(r.length>4){var a=r[4];return""==a?void o({code:-2819,message:"The Dynamsoft Service SSL certificate is invalid."}):hH(a)?void o({code:-2818,message:"The Dynamsoft Service SSL certificate has expired."}):void i({cert:!0,upgrade:!1,socket:!0})}return void i({cert:!1,upgrade:!1,socket:!0})}}var s;throw NE(s={}),hA(s)}),(function(){i({cert:!1,upgrade:!0,socket:!0})}),(function(){!r||K.bSafari?i({cert:!1,upgrade:!1,socket:!1}):i({cert:!1,checkWithNoneSSL:!0})}))}))}function tz(e){var t=HH.DoNotCheck;return K.bSSL&&("127.0.0.1"==e?t=HH.Check127:"local.dynamsoft.com"!=e&&"local.dynamsoftwebtwain.com"!=e||(t=HH.CheckLocalDynamsoftCert)),t}function rz(e,t,r,n,i){var o=0,a=e,s=t,u=n,c=i;if(Et.isFunction(a)&&Et.isFunction(s))for(u=a,c=s,a=lw(),o=0;o<bt.detect.ports.length;o++)if(K.bSSL&&bt.detect.ports[o].ssl||!K.bSSL&&!bt.detect.ports[o].ssl){s=bt.detect.ports[o].port;break}a||(a=lw()),QH(a,s,ww,r).then((function(e){var t=e.host,r=e.port,n=e.version;Et.isFunction(u)&&u(t,r,n)}),(function(e){Et.isFunction(c)&&c(e)}))}function nz(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(VV){return!1}}();return function(){var r,n=cA(e);if(t){var i=cA(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return uA(this,r)}}!function(e){e.DoNotCheck=0,e.Check127=1,e.CheckLocalDynamsoftCert=2}(HH||(HH={}));var iz=function(e){sA(o,e);var r,n=nz(o);function o(){return t(this,o),n.apply(this,arguments)}return i(o,[{key:"SetCookie",value:function(e){return this._cookie=e,document.cookie=e,oC}},{key:"LoadImageFromBase64Binary",value:function(e,t,r,n){var i=this;if(i._resetErr(),!i._isValid())return!1;if(!e)return gE(i),Et.isFunction(n)&&n(i._errorCode,i._getErrorString()),!1;var o,a,s,u,c,l=e,d=iC,f="LoadImageFromBase64Binary",h=t,g=1;if(l instanceof EG&&Et.isFunction(l.getLength)&&Et.isFunction(l.getData)&&(l=l.getData(0,l.getLength())),Et.isString(l))if(-1!=l.indexOf("data:image/bmp"))h=0;else if(-1!=l.indexOf("data:image/jpeg"))h=1;else if(-1!=l.indexOf("data:image/tif"))h=2;else if(-1!=l.indexOf("data:image/png"))h=3;else if(-1!=l.indexOf("data:application/pdf"))h=4;else if(-1!=l.indexOf("data:image/jp2"))h=14;else{var p=l.substr(0,64),m=Et.base64.decode(p,!0);s=m,u=xt.DWT.EnumDWT_ImageType,c=s,(s instanceof ArrayBuffer||s instanceof Array)&&(c=new Uint8Array(s.slice(0,12))),h=function(e){return 37==e[0]&&80==e[1]&&68==e[2]&&70==e[3]}(c)?u.IT_PDF:function(e){return 73==e[0]&&73==e[1]&&42==e[2]&&0==e[3]||77==e[0]&&77==e[1]&&0==e[2]&&42==e[3]}(c)?u.IT_TIF:function(e){return 137==e[0]&&80==e[1]&&78==e[2]&&71==e[3]}(c)?u.IT_PNG:function(e){return 255==e[0]&&216==e[1]}(c)?u.IT_JPG:function(e){return 66==e[0]&&77==e[1]}(c)?u.IT_BMP:function(e){return 0==e[0]&&0==e[1]&&0==e[2]&&12==e[3]&&106==e[4]&&80==e[5]&&32==e[6]&&32==e[7]||255==e[0]&&79==e[1]&&255==e[2]&&81==e[3]}(c)?u.IT_J2K:u.IT_PNG}if(h!=xt.DWT.EnumDWT_ImageType.IT_BMP&&h!=xt.DWT.EnumDWT_ImageType.IT_JPG&&h!=xt.DWT.EnumDWT_ImageType.IT_TIF&&h!=xt.DWT.EnumDWT_ImageType.IT_PNG&&h!=xt.DWT.EnumDWT_ImageType.IT_PDF&&h!=xt.DWT.EnumDWT_ImageType.IT_J2K&&(h=-1),!bP.checkProductKey(i,{Core:!0}))return Et.isFunction(n)&&n(i._errorCode,i._getErrorString()),iC;if(!bP.checkPDFProductKeyWhenNeeds(i,h))return Et.isFunction(n)&&n(i._errorCode,i._getErrorString()),iC;var _=i._getCurrentDocumentName();return Et.isFunction(r)&&(d=oC),Et.isString(l)&&-1!=l.indexOf("base64,")&&(l=l.substr(l.indexOf("base64,")+7)),a=i.__GetLoadEventsNum(),d?(bt.cancelFrom=aG.LoadImage,i.IfShowProgressBar?bt.showProgress(i,f,i.__IfShowCancelDialogWhenImageTransfer):bt.hideProgress(),i.__bLoadingImage=oC,g=0,o=i._innerSend(f,Rx(l,h,a,g),oC,(function(){if(bt.closeProgress(null,f),i.__bLoadingImage=!1,i._isBindViewer()){var e=i._ImgManager.getCurrentImageIndex();e>=0&&i._innerRefreshUI(e)}return i._blts&&xt.DWT.lcvrf(i),r&&r(l,t),!0}),(function(){bt.closeProgress(null,f),i.__bLoadingImage=!1,Et.isFunction(n)&&n(i._errorCode,i._getErrorString(),l,t)}))):(o=i.__innerLoadImageFun(f,Rx(l,h,a,g),g,_))&&i._blts&&xt.DWT.lcvrf(i),o}},{key:"SaveSelectedImagesToBytes",value:function(e,t){return Mw(this),iC}},{key:"LoadImageFromBytes",value:function(e,t,r){return Mw(this),iC}},{key:"SetImageWidth",value:function(e,t,r,n){var i,o=this;if(o._resetErr(),!o._isValid())return!1;var a=parseInt(e);if(isNaN(a))return Dw(o),Et.isFunction(n)&&n(o._errorCode,o._getErrorString()),!1;if(a<0||a>=o._ImgManager.count())return oE(o),Et.isFunction(n)&&n(o._errorCode,o._getErrorString()),!1;if(Et.isUndefined(t))return gE(o),Et.isFunction(n)&&n(o._errorCode,o._getErrorString()),!1;var s=o._ImgManager.convertClientIndexToServerId(a);return-1==s?(oE(o),Et.isFunction(n)&&n(o._errorCode,o._getErrorString()),!1):((i=1==o._innerFun("SetImageWidth",Rx(s,t)))?Et.isFunction(r)&&r():Et.isFunction(n)&&n(o._errorCode,o._getErrorString()),i)}},{key:"HTTPDownloadStreamThroughPost",value:function(e,t){return Mw(this),iC}},{key:"HTTPUploadStreamThroughPost",value:function(e,t,r,n,i){return Mw(this),iC}},{key:"HTTPUploadThroughPutDirectly",value:function(e,t,r,n,i){return Mw(this),!1}},{key:"SetCustomDSDataEx",value:function(e){return this._resetErr(),!!this._isValid()&&this._innerFun("SetCustomDSDataEx",Rx(e))}},{key:"SetCustomDSData",value:function(e){if(this._resetErr(),!this._isValid())return!1;var t=yF.replaceLocalFilename(e);return this._innerFun("SetCustomDSData",Rx(t))}},{key:"GetCustomDSDataEx",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._innerFun("GetCustomDSDataEx")}},{key:"GetCustomDSData",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return!1;var r=yF.replaceLocalFilename(e);return t._innerFun("GetCustomDSData",Rx(r))}},{key:"on",value:function(e,t){return this.registerEvent(e,t)}},{key:"off",value:function(e,t){return this.unregisterEvent(e,t)}},{key:"ConvertToBW",value:function(e,t,r){var n=this;if(n._resetErr(),!n._isValid())return!1;if(!bP.checkProductKey(n,{Core:!0}))return Et.isFunction(r)&&r(n._errorCode,n._getErrorString()),!1;var i=parseInt(e);if(isNaN(i))return Dw(n),Et.isFunction(r)&&r(n._errorCode,n._getErrorString()),!1;if(i<0||i>=n._ImgManager.count())return oE(n),Et.isFunction(r)&&r(n._errorCode,n._getErrorString()),!1;var o=n.ChangeBitDepth(e,1,!0);return o?Et.isFunction(t)&&t():Et.isFunction(r)&&r(n._errorCode,n._getErrorString()),o}},{key:"LoadImageFromBinary",value:function(e,t,r){var n,i=this,o="LoadImageFromBinary",a=null===(n=bt.progressContext)||void 0===n?void 0:n.IfShowCancelDialogWhenImageTransfer;Et.isFunction(t)&&(i.IfShowProgressBar?(bt.showProgress(i,o,!1),bt.progressContext&&(bt.progressContext.IfShowCancelDialogWhenImageTransfer=!1)):bt.hideProgress());return i._innerLoadImageFromBinary(e,0,!0,(function(){bt.progressContext&&(bt.progressContext.IfShowCancelDialogWhenImageTransfer=a),Et.isFunction(t)&&(i.IfShowProgressBar&&bt.closeProgress(null,o),t())}),(function(e,n){bt.progressContext&&(bt.progressContext.IfShowCancelDialogWhenImageTransfer=a),Et.isFunction(t)&&i.IfShowProgressBar&&bt.closeProgress(null,o),Et.isFunction(r)&&r(e,n)}))}},{key:"EnableSourceUI",value:function(e,t){var r=this;return r._resetErr(),!!r._isValid()&&(r._innerSend("EnableSourceUI",null,!0,e,t),!0)}},{key:"GetIfShowVideoContainer",value:function(){return this._UIView.GetIfShowVideoContainer()}},{key:"ShowVideoContainer",value:function(e){return this._UIView.ShowVideoContainer(e)}},{key:"UpdateVideoContainer",value:function(e){return this._UIView.UpdateVideoContainer(e)}},{key:"ChangeBitDepth",value:function(e,t,r){var n,i=this;if(i._resetErr(),!i._isValid())return!1;if(n=parseInt(e),isNaN(n))return Dw(i),!1;if(n<0||n>=i._ImgManager.count())return oE(i),!1;var o=i._ImgManager.convertClientIndexToServerId(n);return-1==o?(oE(i),!1):i._innerFun("ChangeBitDepth",Rx(o,t,r))}},{key:"ConvertToGrayScale",value:function(e,t,r){var n,i=this;if(i._resetErr(),!i._isValid())return!1;var o=parseInt(e);if(isNaN(o))return Dw(i),Et.isFunction(r)&&r(i._errorCode,i._getErrorString()),!1;if(o<0||o>=i._ImgManager.count())return oE(i),Et.isFunction(r)&&r(i._errorCode,i._getErrorString()),!1;var a=i._ImgManager.convertClientIndexToServerId(o);return-1==a?(oE(i),Et.isFunction(r)&&r(i._errorCode,i._getErrorString()),!1):((n=1==i._innerFun("ConvertToGrayScale",Rx(a)))?(yF.refreshImageAfterInvokeFun(i,o),Et.isFunction(t)&&t()):Et.isFunction(r)&&r(i._errorCode,i._getErrorString()),n)}},{key:"ClearTiffCustomTag",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&(e._aryTiffTag.splice(0,e._aryTiffTag.length),e._innerFun("ClearTiffCustomTag"))}},{key:"SetTiffCustomTag",value:function(e,t,r){var n=this;if(n._resetErr(),!n._isValid())return!1;if(Et.isUndefined(e)||Et.isUndefined(t))return gE(n),!1;var i,o=1*e;if(i=Et.isString(t)?Et.replaceAll(t,'"','\\"'):t,o<=0||o>2147483647)return kw(n,-2378,"Invalid value for the tiff tag code."),!1;var a,s=0,u=!1,c=n._aryTiffTag.length;for(s=0;s<c;s++)(a=n._aryTiffTag[s]).tag==o&&(a.Content=t,a.UseBase64Encoding=r,u=!0);return!u&&c>=32?(function(e){kw(e,-2428,"Tiff tag count has exceeded the limit.")}(n),!1):n._innerFun("SetTiffCustomTag",Rx(o,i,r))}},{key:"IsBlankImage",value:function(e){var t,r=this;if(r._resetErr(),!r._isValid())return!1;if(t=parseInt(e),isNaN(t))return Dw(r),!1;if(t<0||t>=r._ImgManager.count())return oE(r),!1;var n=r._ImgManager.convertClientIndexToServerId(t);return-1==n?(oE(r),!1):r._innerFun("IsBlankImage",Rx(n,iC))}},{key:"IsBlankImageExpress",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return!1;var r=parseInt(e);if(isNaN(r))return Dw(t),!1;if(r<0||r>=t._ImgManager.count())return oE(t),!1;var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(oE(t),!1):t._innerFun("IsBlankImage",Rx(n,oC))}},{key:"SetOpenSourceTimeout",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&t._innerFun("SetOpenSourceTimeout",Rx(e))}},{key:"GetImageURL",value:function(e,t,r,n,i){var o=this;if(o._resetErr(),!o._isValid())return!1;var a,s,u,c,l=e,d=parseInt(t),f=parseInt(r);if(n?(a="",s="dwt://"):(a=o._httpUrl,s="dwt/"),c=o._bScanForProxyRemote?Cw.getVersionStrForCheck():bw.getServerVersionInfo(),u=[a,s,bw.getDWTPrefix(),c,"/img?id=",o._clientId],Et.isUndefined(l)||null===l)return aE(o),"";if(i)u.push("&index=-1&width=-1&height=-1&webcam="),u.push(i);else{if(l=parseInt(l),isNaN(l))return Dw(o),"";if(l<-1||l>=o._ImgManager.count())return oE(o),"";var h=o._ImgManager.convertClientIndexToServerId(l);if(-1==h)return"";u.push("&index="),u.push(h),d>0&&f>0?(u.push("&width="),u.push(d),u.push("&height="),u.push(f)):u.push("&width=-1&height=-1"),Ax.bMobile&&u.push("&type=1&quality=85")}if(u.push("&t="),u.push((new Date).getTime()),u=u.join(""),K.bFileSystem&&u.indexOf("dwt://")<0){var g=new Image;g.crossOrigin="anonymous",g.src=u,g=null}return u}},{key:"GetImagePartURL",value:function(e,t,r){var n=this;if(n._resetErr(),!n._isValid())return!1;var i=parseInt(e);return isNaN(i)?(Dw(n),""):i<0||i>=n._ImgManager.count()?(oE(n),""):this.GetImageURL(i,t,r,!0)}},{key:"SetLanguage",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&t._innerFun("SetLanguageForSecurity",Rx(e))}},{key:"GetLicenseInfo",value:function(e,t){var r=this;return r.__licenseInfo?Et.isFunction(e)&&e(r.__licenseInfo):r._innerFunRaw("GetLicenseInfo",null,oC,iC,oC,(function(n){n?n.exception?Et.isFunction(t)&&t(n.exception):(gD(r,n),Et.isFunction(e)&&e(r.__licenseInfo)):Et.isFunction(t)&&t()}),t),oC}},{key:"SetProductKeyAsync",value:function(e){return this._setProductKeyAsync(e)}},{key:"GetVersionInfoAsync",value:function(){return tC.Promise.resolve(Cw.versionInfoFromServer)}},{key:"isUsingActiveX",value:function(){return!1}},{key:"SetLTSLicenseAsync",value:function(e){return this._setLTSLicenseAsync(e)}},{key:"Print",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return!1;if(t._isNoViewer())return t._nouiNotSupport("Print");if(e){return t._innerSend("PrintEx",Rx(!0),!0,(function(){}),(function(){})),!0}return t._ImagePrint.Print(),!0}},{key:"PrintEx",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&(Et.isArray(e)?t._isNoViewer()?t._nouiNotSupport("Print"):!!t._checkIndices(e)&&(t._ImagePrint.PrintEx(e),!0):(iE(t),!1))}},{key:"IsBlankImageAsync",value:(r=eA(g.mark((function a(e,t){var r,n,i,o;return g.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r=this,aw.getEnumPlatform()==OC.enumWindow){a.next=5;break}throw kw(r,-2905,"This API is not supported on the current operating system. Please contact your system administrator."),{code:this._errorCode,message:this._getErrorString()};case 5:return i={minBlockHeight:20,maxBlockHeight:30},t&&(Et.isNumber(t.minBlockHeight)&&t.minBlockHeight>=0&&(i.minBlockHeight=t.minBlockHeight),Et.isNumber(t.maxBlockHeight)&&t.maxBlockHeight>=0&&(i.maxBlockHeight=t.maxBlockHeight)),n={command:"isBlankImage",parameter:{index:e,minHeight:i.minBlockHeight,maxHeight:i.maxBlockHeight}},a.next=10,r.RunCommandAsync(n);case 10:if(!((o=a.sent)&&bt.isArray(o.result)&&o.result.length>0)){a.next=13;break}return a.abrupt("return",o.result[0]);case 13:return a.abrupt("return",!1);case 14:case"end":return a.stop()}}),a,this)}))),function(e,t){return r.apply(this,arguments)})}]),o}(dj),oz=0,az=1,sz=1,uz=2;function cz(e,t,r,n){var i;r!==oz&&r!==az?i=r:(i={},r&&(i.set=n==sz?function(r){var n=1*r;return!Et.isNumber(n)||isNaN(n)?(Fw(e),iC):(e._resetErr(),!!e._isValid()&&e._innerFun(t,Rx(n)))}:n==uz?function(r){return Et.isBoolean(r)?(e._resetErr(),!!e._isValid()&&e._innerFun(t,Rx(r))):(Fw(e),iC)}:function(r){return Et.isString(r)?(e._resetErr(),!!e._isValid()&&e._innerFun(t,Rx(r))):(Fw(e),iC)})),i.get||(i.get=function(){return e._resetErr(),!!e._isValid()&&e._innerFun(t)}),t in e||Object.defineProperty(e,t,i)}function lz(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return dz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dz(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r["return"]||r["return"]()}finally{if(s)throw o}}}}function dz(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function fz(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(VV){return!1}}();return function(){var r,n=cA(e);if(t){var i=cA(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return uA(this,r)}}function hz(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function gz(e,t,r){if(!t.has(e));return r}var pz=new WeakSet,mz=function(){function e(r,n,i,o){t(this,e),hz(this,pz),nC(this,"serverUrl",undefined),this.serverUrl=r,this.bLocal=Aw(r),this.clientId=null!=i?i:Et.guid(),this.bGlobal=n,this.serverName=o,this.bLicenseOK=!1}var r,n;return i(e,[{key:"checkSource",value:function(e){if(!e)throw{code:-1003,message:"Source Manager unable to find the specified Source"}}},{key:"parseResultDefault",value:function(e){var t;if(Et.isObject(e)&&e.exception&&0!=e.exception)throw{code:e.exception,message:null!==(t=e.description)&&void 0!==t?t:"general error"};if(e&&Et.isArray(e.result)&&e.result.length>0){var r=e.result[e.result.length-1];try{return JSON.parse(r)}catch(VV){return r}}throw e}},{key:"_requestAsync",value:(n=eA(g.mark((function o(e,t,r){var n,i,a,s,u,c,l,d,f,h;return g.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(!xt.DWT.ConnectWithSocket){o.next=12;break}return o.next=3,gz(this,pz,_z).call(this);case 3:return n=o.sent,i=0,e&&(i=e.cmdId),a={client:n,userData:{command:e},taskId:i},s=Tz,o.next=9,n.request(Et.stringify(e),s,a);case 9:return u=o.sent,Et.isString(u)&&(u=Et.parse(u)),o.abrupt("return",u);case 12:return c=[Tk(),"/",e.method].join(""),t&&(d=t),f=(h=this).serverUrl?kD.getDDMUrl(h.serverUrl,h.bGlobal,[Ik,e.method].join("")):kD.getModuleUrl(c),o.prev=16,o.next=19,XE(f,{method:"post",dataType:"json",body:Et.stringify(e),fetchRaw:null!=r&&r,timeout:d});case 19:l=o.sent,o.next=25;break;case 22:throw o.prev=22,o.t0=o["catch"](16),o.t0;case 25:return o.abrupt("return",l);case 26:case"end":return o.stop()}}),o,this,[[16,22]])}))),function(e,t,r){return n.apply(this,arguments)})},{key:"_resetLicense",value:(r=eA(g.mark((function a(e,t,r){return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),a)}))),function(e,t,n){return r.apply(this,arguments)})}]),e}();function _z(){return vz.apply(this,arguments)}function vz(){return(vz=eA(g.mark((function e(){var t,r,n,i,o,a,s,u,c;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=this)._wsClient){e.next=10;break}return r=new iA,(n=this.serverUrl)?(i=bt.detect.ssl,a="/",o=i?"ddm/18626/":"ddm/18625/",Et.endsWith(n,"/")&&(a=""),Et.startsWith(n,"https://")||Et.startsWith(n,"wss://")?(r.ssl=!0,s=Et.startsWith(n,"https://")?Et.replaceAll(n,"https://",""):Et.replaceAll(n,"wss://",""),n=s+a+o):Et.startsWith(n,"http://")||Et.startsWith(n,"ws://")?(r.ssl=!1,u=Et.startsWith(n,"http://")?Et.replaceAll(n,"http://",""):Et.replaceAll(n,"ws://",""),n=u+a+o):(r.ssl=bt.detect.ssl,r.port=r.ssl?Tw.SSLPort:Tw.Port),r.server=n):(r.ssl=bt.detect.ssl,r.server=lw(),r.port=r.ssl?Tw.SSLPort:Tw.Port),r.useWS=!0,r.protocol=Tw.wsProtocol,c=fk.Instance.getClient(r),e.next=9,c.testConnection();case 9:t._wsClient=c;case 10:return e.abrupt("return",t._wsClient);case 11:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}nC(mz,"logLevel",-1);var yz,Iz=function(e){sA(o,e);var r,n=fz(o);function o(){var e;t(this,o);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return nC(oA(e=n.call.apply(n,[this].concat(i))),"_bInited",!1),e}return i(o,[{key:"getDynamsoftService",value:(r=eA(g.mark((function a(e,t,r,n){var i,o,s,u,c,l,d,f,h,p,m,_,v,y,I;return g.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r=null!==(i=r)&&void 0!==i&&i,n=null!==(o=n)&&void 0!==o?o:30,s={id:this.clientId,cmdId:Et.guid(),method:"SearchScanner",parameter:[1,"_privet._tcp.local.",!1,!0,r,n,e,t],version:Sk},a.prev=5,a.next=8,this._requestAsync(s,3e4,!1);case 8:u=a.sent,this._bInited=!0,a.next=19;break;case 12:if(a.prev=12,a.t0=a["catch"](5),!this.bLocal){a.next=18;break}throw AE(c={}),{code:c._errorCode,message:c._errorString};case 18:throw{code:-2604,message:"Failed to connect to the Proxy Service. Please make sure the Proxy Service is configured successfully, Dynamsoft Service is running, or the certificate is valid."};case 19:l=[],d=this.parseResultDefault(u),f=lz(d),a.prev=22,f.s();case 24:if((h=f.n()).done){a.next=40;break}if(!((p=h.value).service_type&&p.service_type==AD.ST_UNKNOWN||p.type&&"dynamsoft_private_cloud_scan"!=p.type&&"twaindirect"!=p.type)){a.next=30;break}return a.abrupt("continue",38);case 30:if(!p.service_type){a.next=38;break}a.t1=p.service_type,a.next=a.t1===AD.ST_DYNAMSOFT_SERVICE?34:38;break;case 34:return(m=p.modules)&&Et.isArray(m)&&Et.isString(m[0])&&(_=m[0].split(",")).length>=3&&_[0]>=1&&_[1]>=8&&_[2]>0&&(p.bGlobalFind=!0,v=Sz(this.serverUrl,p),l.push(v)),p.bGlobalFind||(I=null!==(y=null==p?void 0:p.ty)&&void 0!==y?y:"",Et.warn(["The Dynamsoft Service on [",I,"] is old version."].join(""))),a.abrupt("break",38);case 38:a.next=24;break;case 40:a.next=45;break;case 42:a.prev=42,a.t2=a["catch"](22),f.e(a.t2);case 45:return a.prev=45,f.f(),a.finish(45);case 48:return a.abrupt("return",l);case 49:case"end":return a.stop()}}),a,this,[[5,12],[22,42,45,48]])}))),function(e,t,n,i){return r.apply(this,arguments)})},{key:"dispose",value:function(){var e={id:this.clientId,cmdId:Et.guid(),method:"dispose",version:Sk};this._requestAsync(e,500)}}]),o}(mz);function Sz(e,t){var r=new TD;return r.server=e,r.attrs=t,r}function Tz(e,t,r,n){return bz.apply(this,arguments)}function bz(){return bz=eA(g.mark((function e(t,r,n,i){var o,a;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r!=pA.GET_TASKID){e.next=4;break}return e.abrupt("return",i.taskId);case 4:if(r!=pA.ONMESSAGE_PROCESS_DATA){e.next=8;break}return e.abrupt("return",Et.parse(t));case 8:if(r!=pA.ONMESSAGE_GET_TASKID){e.next=13;break}if(!i||!i.client){e.next=11;break}return e.abrupt("return",i.client.getRequestTaskId());case 11:e.next=20;break;case 13:if(r!=pA.HANDLE_RAW_MESSAGE){e.next=20;break}if(o=null==i?void 0:i.userData){e.next=17;break}return e.abrupt("return",!1);case 17:return(a=t).indexOf("Version not found")>=0||a.indexOf("Function not found")>=0?Et.isFunction(o.fFun)&&o.fFun():Et.isFunction(o.sFun)&&o.sFun(a),e.abrupt("return",a);case 20:case"end":return e.stop()}}),e)}))),bz.apply(this,arguments)}function Cz(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return wz(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wz(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r["return"]||r["return"]()}finally{if(s)throw o}}}}function wz(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ez(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(VV){return!1}}();return function(){var r,n=cA(e);if(t){var i=cA(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return uA(this,r)}}function Az(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function kz(e,t,r){if(!t.has(e));return r}function Pz(e){var t,r=AD.ST_UNKNOWN;return e==Px.ESCLSCANNER?r=AD.ST_ESCL:e==Px.WIFIDIRECTSCANNER?r=AD.ST_WIFI_DIRECT:((t=e)==Px.TWAINSCANNER||t==Px.WIATWAINSCANNER||t==Px.TWAINX64SCANNER||t==Px.ICASCANNER||t==Px.SANESCANNER)&&(r=AD.ST_DYNAMSOFT_SERVICE),r}!function(e){e.SAM_ANONYMOUS=0,e.SAM_PWD=1}(yz||(yz={}));var xz=new WeakSet,Dz=new WeakSet,Fz=function(e){sA(f,e);var r,n,o,a,s,u,c,l,d=Ez(f);function f(){var e;t(this,f);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Az(oA(e=d.call.apply(d,[this].concat(n))),Dz),Az(oA(e),xz),nC(oA(e),"_bInited",!1),nC(oA(e),"_currentDevice",undefined),e}return i(f,[{key:"getSources",value:(l=eA(g.mark((function h(e,t,r){var n,i,o,a,s,u,c,l,d,f,p,m,_,v;return g.wrap((function(h){for(;;)switch(h.prev=h.next){case 0:if(o="",a=!1,s=[],u=!1,((c=null!=e?e:Bx)&Px.ESCLSCANNER)==Px.ESCLSCANNER&&(o="_uscan._tcp.local."),(c&Px.WIFIDIRECTSCANNER)==Px.WIFIDIRECTSCANNER&&(a=!0),0!=o.length||a){h.next=9;break}return h.abrupt("return",[]);case 9:return t=null!==(n=t)&&void 0!==n&&n,r=null!==(i=r)&&void 0!==i?i:30,l={id:this.clientId,cmdId:Et.guid(),method:"SearchScanner",parameter:[1,o,a,u,t,r],version:Sk},h.next=14,this._requestAsync(l,3e4,!1);case 14:if(d=h.sent,this._bInited=!0,f=this.parseResultDefault(d),Et.isArray(f)){h.next=19;break}throw{code:-2612,message:"The devices must be an Array."};case 19:p=Cz(f),h.prev=20,p.s();case 22:if((m=p.n()).done){h.next=48;break}if(!((_=m.value).service_type&&_.service_type==AD.ST_UNKNOWN||_.type&&"dynamsoft_private_cloud_scan"!=_.type&&"twaindirect"!=_.type)){h.next=28;break}return h.abrupt("continue",46);case 28:if(!_.service_type){h.next=46;break}h.t0=_.service_type,h.next=h.t0===AD.ST_DYNAMSOFT_SERVICE?32:h.t0===AD.ST_ESCL||h.t0===AD.ST_WIFI_DIRECT?33:46;break;case 32:return h.abrupt("break",46);case 33:return(v=new FD).name="",v.displayName="",v.deviceType=0,v.isSystemDefaultPrinter=!1,_.service_type==AD.ST_ESCL?v.deviceType=Px.ESCLSCANNER:_.service_type==AD.ST_WIFI_DIRECT&&(v.deviceType=Px.WIFIDIRECTSCANNER),v.name=_.ty,_.hostname&&_.hostname.length>_.ty.length&&(v.name=_.hostname),v.displayName=(_.service_type==AD.ST_ESCL?"eSCL-":"")+v.name,this.bGlobal||(_.url=this.serverUrl,this.serverName&&(v.displayName=v.displayName+" on ["+this.serverName+"]")),v.serviceInfo=Sz(this.serverUrl,_),s.push(v),h.abrupt("break",46);case 46:h.next=22;break;case 48:h.next=53;break;case 50:h.prev=50,h.t1=h["catch"](20),p.e(h.t1);case 53:return h.prev=53,p.f(),h.finish(53);case 56:return h.abrupt("return",s);case 57:case"end":return h.stop()}}),h,this,[[20,50,53,56]])}))),function(e,t,r){return l.apply(this,arguments)})},{key:"getCapabilitiesAsync",value:(c=eA(g.mark((function p(e){var t,r,n;return g.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return this.checkSource(e),(e.deviceType&Px.ESCLSCANNER)!=Px.ESCLSCANNER&&(e.deviceType&Px.WIFIDIRECTSCANNER)!=Px.WIFIDIRECTSCANNER||(this._currentDevice=e),t=Pz(e.deviceType),r={id:this.clientId,cmdId:Et.guid(),method:"SendRequestToScanner",parameter:["getCapabilities",Et.stringify({UUID:e.serviceInfo.attrs.UUID,service_type:t,ty:e.name})],version:Sk},i.next=6,this._requestAsync(r,0);case 6:return n=i.sent,i.abrupt("return",this.parseResultDefault(n));case 8:case"end":return i.stop()}}),p,this)}))),function(e){return c.apply(this,arguments)})},{key:"selectSourceAsync",value:(u=eA(g.mark((function m(e){var t;return g.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.getCapabilitiesAsync(e);case 2:if(!(t=r.sent)&&""!=t){r.next=5;break}return r.abrupt("return",!0);case 5:case"end":return r.stop()}}),m,this)}))),function(e){return u.apply(this,arguments)})},{key:"versionInfo",value:(s=eA(g.mark((function _(){var e,t;return g.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return e={id:this.clientId,cmdId:Et.guid(),method:"VersionInfo",version:Sk},r.next=3,this._requestAsync(e,5e3);case 3:return t=r.sent,this._bInited=!0,r.abrupt("return",t);case 6:case"end":return r.stop()}}),_,this)}))),function(){return s.apply(this,arguments)})},{key:"getLicenseInfo",value:function(e,t,r){return this._resetLicense(e,t,r)}},{key:"getImageAsArrayBuffer",value:(a=eA(g.mark((function v(e,t){return g.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",kz(this,xz,Wz).call(this,e,t));case 1:case"end":return r.stop()}}),v,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"getImageToDWT",value:(o=eA(g.mark((function y(e,t,r){return g.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",kz(this,xz,Wz).call(this,e,t,r));case 1:case"end":return n.stop()}}),y,this)}))),function(e,t,r){return o.apply(this,arguments)})},{key:"acquireImage",value:(n=eA(g.mark((function I(e,t,r){var n,i,o,a,s,u,c,l;return g.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:e=null!==(n=e)&&void 0!==n?n:this._currentDevice,this.checkSource(e),this._currentDevice=e,i=Pz(e.deviceType),o=["scan",Et.stringify({UUID:e.serviceInfo.attrs.UUID,service_type:i})],a=kz(this,Dz,Nz).call(this,t),o[2]=Et.stringify(a),s={id:this.clientId,cmdId:Et.guid(),method:"SendRequestToScanner",parameter:o,version:Sk},u=0;case 10:if(!(u<5)){r.next=33;break}return r.prev=11,r.next=14,this._requestAsync(s,0);case 14:return l=r.sent,c=this.parseResultDefault(l),Et.isObject(c)&&(c.device=e,c.scanOptions=a),r.abrupt("break",33);case 20:if(r.prev=20,r.t0=r["catch"](11),-1004!=r.t0.code&&-1001!=r.t0.code){r.next=29;break}if(!(u>=4)){r.next=25;break}throw r.t0;case 25:return r.next=27,new bt.Promise((function(e,t){setTimeout(e,2e3)}));case 27:r.next=30;break;case 29:throw r.t0;case 30:u++,r.next=10;break;case 33:return r.abrupt("return",c);case 34:case"end":return r.stop()}}),I,this,[[11,20]])}))),function(e,t,r){return n.apply(this,arguments)})},{key:"_resetLicense",value:(r=eA(g.mark((function S(e,t,r){var n,i,o,a;return g.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return this.longKeyOrShortkey=e,this.cu=t,Oz(),n=null!=t?t:"",i={id:this.clientId,cmdId:Et.guid(),method:"GetLicenseInfo",parameter:[e,f.logLevel,n,r],version:Sk},s.prev=5,s.next=8,this._requestAsync(i,1e4);case 8:return o=s.sent,this._bInited=!0,s.abrupt("return",this.parseResultDefault(o));case 13:if(s.prev=13,s.t0=s["catch"](5),!this.bLocal){s.next=19;break}throw AE(a={}),{code:a._errorCode,message:a._errorString};case 19:throw{code:-2604,message:"Failed to connect to the Proxy Service. Please make sure the Proxy Service is configured successfully, Dynamsoft Service is running, or the certificate is valid."};case 20:case"end":return s.stop()}}),S,this,[[5,13]])}))),function(e,t,n){return r.apply(this,arguments)})}]),f}(Iz);function Wz(e,t,r){return Rz.apply(this,arguments)}function Rz(){return(Rz=eA(g.mark((function e(t,r,n){var i,o,a,s,u,c;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t&&t.device){e.next=2;break}throw{code:-1011,message:"Operation out of expected sequence"};case 2:return n=null!==(i=n)&&void 0!==i?i:{ver:"",clientId:""},(o=["getImage",Et.stringify({UUID:t.device.serviceInfo.attrs.UUID,service_type:r})])[2]=Et.stringify(t.scanOptions),o[3]=t.scanJobs,o[4]=t.scanId,o[5]=n._clientId,o[6]=n._ver,a={id:this.clientId,cmdId:Et.guid(),method:"SendRequestToScanner",parameter:o,version:Sk},e.next=12,this._requestAsync(a,0,!0);case 12:if(s=e.sent,!(s.headers.get("content-type").indexOf("image/")>=0)){e.next=20;break}return e.next=17,s.arrayBuffer();case 17:return e.abrupt("return",e.sent);case 20:return e.next=22,s.json();case 22:if(u=e.sent,"boolean"!=typeof(c=this.parseResultDefault(u))){e.next=28;break}return e.abrupt("return",null);case 28:return e.abrupt("return",c);case 29:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function Nz(e){var t=[];if(e){Et.isNumber(e.PixelType)&&(t.push({capability:wj.ICAP_PIXELTYPE,curValue:e.PixelType}),xt.DWT.EnumDWT_PixelType.TWPT_BW==e.PixelType&&(t.push({capability:32771,curValue:"application/octet-stream"}),t.push({capability:32772,curValue:"application/octet-stream"})));var r=e.Resolution;r||(r=300),t.push({capability:wj.ICAP_XRESOLUTION,curValue:r}),t.push({capability:wj.ICAP_YRESOLUTION,curValue:r}),e.Brightness!==undefined&&t.push({capability:wj.ICAP_BRIGHTNESS,curValue:e.Brightness}),e.XferCount!==undefined&&t.push({capability:wj.CAP_XFERCOUNT,curValue:e.XferCount}),e.Contrast!==undefined&&t.push({capability:wj.ICAP_CONTRAST,curValue:e.Contrast}),e.TransferMode!==undefined&&t.push({capability:wj.ICAP_XFERMECH,curValue:e.TransferMode}),e.IfFeederEnabled!==undefined&&t.push({capability:wj.CAP_FEEDERENABLED,curValue:e.IfFeederEnabled?1:0}),e.IfDuplexEnabled!==undefined&&t.push({capability:wj.CAP_DUPLEXENABLED,curValue:e.IfDuplexEnabled?1:0})}return t}function Oz(){var e=Fz.logLevel;Et.isNumber(e)||(Fz.logLevel=-1)}bt.removeNonPrintableChar;var Mz=function(e,t,r){r==uz&&Et.each(t,(function(t,r){FG(e,t,{get:function(){return e._resetErr(),e._isValid()?oC:iC},set:function(t){return e._resetErr(),e._isValid()?oC:iC}})}))},Lz=function(e,t){Et.each(t,(function(t,r){cz(e,t,az,uz)}))},Bz=function(e,t){Et.each(t,(function(t,r){cz(e,t,az,sz)}))},Uz=function(e,t){Et.each(t,(function(t,r){cz(e,t,oz)}))},Vz=function(e,t){Et.each(t,(function(t,r){cz(e,t,az)}))};function Gz(e){var t=e;if(!t._bRemoteMode){FG(t,"ProductKey",{get:function(){return xt.DWT.ProductKey},set:function(e){return Et.isString(e)?(t._resetErr(),!!t._isValid()&&t._setProductKey(e,!1)):(Fw(t),iC)}}),FG(t,"ProductName",{get:function(){return t.__strProductName},set:function(e){return t._resetErr(),Et.isString(e)?(t.__strProductName=e,oC):(Fw(t),iC)}}),FG(t,"VersionInfo",{get:function(){return uw.JSVersion}}),FG(t,"DefaultSourceName",{get:function(){var e=t._getDefaultDevice();return e?e.displayName:""}}),FG(t,"ImageCaptureDriverType",{get:function(){return t._resetErr(),t._isValid()?t._driverType:0},set:function(e){var r=!1,n=!1,i=!1;if(t._bRemoteMode?t.__serverPlatform==OC.enumWindow?i=!0:t.__serverPlatform==OC.enumLinux?n=!0:t.__serverPlatform==OC.enumMac&&(r=!0):(r=K.bMac,n=K.bLinux,i=K.bWin),t._resetErr(),!t._isValid())return!1;if(""!==e){var o=1*e,a=!1;if(o<gF.TWAIN||o>gF.TWAIN64)return dE(t),iC;if(i){if(o===gF.TWAIN_AND_TWAIN64)t._b64bit&&(t._driverType=o);else if(o!=gF.TWAIN&&o!=gF.TWAIN64)return dE(t),iC;t._b64bit||(o=gF.TWAIN),t._driverType=o,a=!0}else if(n)o=gF.SANE,t._driverType=o,a=!0;else if(r){if(o===gF.TWAIN_AND_ICA);else if(o!=gF.ICA&&o!=gF.TWAIN&&o!=gF.TWAIN64)return dE(t),iC;t._driverType=o,a=!0}return a&&(t._curDevice=null,t.__devices=null),!0}return dE(t),iC}}),FG(t,"HTTPPostResponseString",{get:function(){return t._resetErr(),t._isValid()&&t.__HTTPPostResponseString?t.__HTTPPostResponseString:""}}),FG(t,"IfAppendImage",{get:function(){return t._resetErr(),!!t._isValid()&&t.__IfAppendImage},set:function(e){return t._resetErr(),!!t._isValid()&&(Et.isBoolean(e)?t.__IfAppendImage=e:(Fw(t),iC))}}),FG(t,"FTPPort",{get:function(){return t._resetErr(),t._isValid()?t._innerFun("FTPPort"):0},set:function(e){if(t._resetErr(),!t._isValid())return!1;if(""!==e){var r=1*e;return t._innerFun("FTPPort",Rx(r))}}}),FG(t,"JPEGQuality",{get:function(){return t._resetErr(),t._isValid()?t._innerFun("JPEGQuality"):0},set:function(e){var r=1*e;return r>=100?r=100:r<0&&(r=0),t._resetErr(),!!t._isValid()&&t._innerFun("JPEGQuality",Rx(r))}}),cz(t,"TIFFCompressionType",az,sz),cz(t,"BufferMemoryLimit",az,sz),FG(t,"LogLevel",{get:function(){return t._resetErr(),t._isValid()?t._innerFun("LogLevel"):0},set:function(e){if(t._resetErr(),!t._isValid())return!1;var r=1*e;return t._logLevel=r,Fz.logLevel=t._logLevel,t._innerFun("LogLevel",Rx(r))}}),FG(t,"HttpContentTypeFieldValue",{get:function(){return t._resetErr(),t._isValid()?t._strHttpContentTypeFieldValue:""},set:function(e){return t._resetErr(),!!t._isValid()&&(t._strHttpContentTypeFieldValue=e,e)}}),FG(t,"BrokerProcessType",{get:function(){return t._resetErr(),t._isValid()?1:0},set:function(e){return t._resetErr(),!!t._isValid()}}),FG(t,"BorderStyle",{get:function(){return t._resetErr(),!!t._isValid()&&0},set:function(e){return t._resetErr(),t._isValid(),!1}}),FG(t,"HttpFieldNameOfUploadedImage",{get:function(){return t._resetErr(),t._isValid()?t.__remoteFilename:""},set:function(e){return t._resetErr(),t._isValid()?t.__remoteFilename=e:""}}),FG(t,"style",{get:function(){return t._isValid()?t.__style:""}}),FG(t,"ScaleDownThreshold",{get:function(){return t._resetErr(),t._isValid()?t._scaleDownThreshold:0},set:function(e){var r=1*e;return!Et.isNumber(r)||isNaN(r)?(Fw(self),iC):(t._resetErr(),!!t._isValid()&&(t._scaleDownThreshold=e))}}),FG(t,"CurrentImageIndexInBuffer",{get:function(){return t._isValid()?t._ImgManager.getCurrentImageIndex():0},set:function(e){var r=1*e;return t._resetErr(),!!t._isValid()&&(r>=0&&r<t._ImgManager.count()&&(t._ImgManager.setSelectedClientIndexArray([r]),t._isBindViewer()&&DG.__innerRefreshFromUIView(t,t._ImgManager.getCurrentImageIndex())),!0)}}),FG(t,"SelectedImagesIndices",{get:function(){return t._resetErr(),t._isValid()?t._ImgManager.count()<=0?[]:t._ImgManager.getSelectedClientIndexArray():[]}}),FG(t,"MaxImagesInBuffer",{get:function(){return t._resetErr(),t._isValid()?t.__maxImagesInBuffer:0},set:function(e){var r=1*e;return t._resetErr(),!!t._isValid()&&(r>0&&r<32768?t.__maxImagesInBuffer=r:kw(t,-1010,"Data parameter out of supported range."),t.__maxImagesInBuffer)}}),FG(t,"IfSSL",{get:function(){return t._bSSL},set:function(e){return t._bSSL=e,t._innerFun("IfSSL",Rx(e)),!0}}),cz(t,"IfAllowLocalCache",az,uz),FG(t,"UseLocalService",{get:function(){return!0}}),FG(t,"PDFCompressionType",{get:function(){return t._resetErr(),!!t._isValid()&&t._innerFun("PDFCompressionType")},set:function(e){var r=1*e;return r==xt.DWT.EnumDWT_PDFCompressionType.PDF_FAX3&&(r=xt.DWT.EnumDWT_PDFCompressionType.PDF_FAX4),t._resetErr(),!!t._isValid()&&t._innerFun("PDFCompressionType",Rx(r))}}),t._setProductKey=function(e,r,n,i){var o=!0,a=e,s=function(e){e||(t.__licenseInfo=undefined);var r=!0;return i||(r=bP.checkProductKey(t,{Core:!0})),Et.isFunction(n)&&n(),r};if(t._resetErr(),!t._isValid())return!1;if(a=Et.isString(a)?Et.trim(a):"",xt.DWT.ProductKey=a,""==a)o=!1,s();else{bP.reparseProductKey();var u=xt.DWT.licenseException;if(0!=u.code)return t.__licenseInfo=undefined,t._errorCode=u.code,t._errorString=u.message,Et.isFunction(n)&&n(),!1;t._innerFunRaw("ProductKey",Rx(a),r,!1,!1,(function(e){var n=!1;n=Et.isArray(e)?e[0]:e,Et.isArray(e)&&e.length>=3&&"1"===e[1]&&Et.isFunction(xt.DWT.ShowMessage)&&xt.DWT.ShowMessage(e[2],{width:510,height:272,headerStyle:1,seconds:10}),r||(o=n),t.__licenseInfo=undefined,t.GetLicenseInfo((function(){t._setConvertMode(t._pdfConvertMode),s(!0)}),s)}),(function(){r||(o=!1),s()}))}return o},Vz(t,["ProxyServer"]);Vz(t,["CapValueString","CapDescription","FTPPassword","FTPUserName","Manufacturer","ProductFamily","PDFAuthor","PDFCreationDate","PDFCreator","PDFKeywords","PDFModifiedDate","PDFProducer","PDFSubject","PDFTitle","PDFVersion"]),Uz(t,["ImageBitsPerPixel","ImageLength","ImageWidth","ImageXResolution","ImageYResolution"]);Uz(t,["BlankImageCurrentStdDev","CapDefaultIndex","CapDefaultValue","DataSourceStatus","Duplex","PendingXfers","ImageLayoutDocumentNumber","ImageLayoutFrameBottom","ImageLayoutFrameLeft","ImageLayoutFrameNumber","ImageLayoutFrameRight","ImageLayoutFrameTop","ImageLayoutPageNumber","ImagePixelType","MagData","MagType","IfFeederLoaded","IfPaperDetectable","IfUIControllable"]),Lz(t,["AllowPluginAuthentication","IfModalUI","IfScanInNewThread","_AutoCropMethod"]);Lz(t,["IfDisableSourceAfterAcquire","IfDuplexEnabled","IfFeederEnabled","IfPASVMode","IfAutoBright","IfAutoDiscardBlankpages","IfAutoFeed","IfAutomaticBorderDetection","IfAutomaticDeskew","IfAutoScan","IfShowIndicator","IfUseTwainDSM","IfTiffMultiPage"]),Bz(t,["MaxInternetTransferThreads"]);Bz(t,["BlankImageMaxStdDev","BlankImageThreshold","BitDepth","Brightness","PageSize","PixelType","Resolution","Capability","CapCurrentIndex","CapCurrentValue","CapMaxValue","CapMinValue","CapNumItems","CapStepSize","CapType","CapValue","CapValueType","Contrast","PixelFlavor","TransferMode","Unit","XferCount"]),Mz(t,["AsyncMode","EnableInteractiveZoom","IfThrowException","ImageEditorIfEnableEnumerator","ImageEditorIfReadonly","ImageEditorIfModal","ImageEditorWindowTitle","IfShowPrintUI","VScrollBar"],uz);Mz(t,["IfOpenImageWithGDIPlus"])}}bt.DynamicLoadAddonFuns=[],bt.attachAddon=function(e){var t=!1;return Et.each(bt.DynamicLoadAddonFuns,(function(r){Et.isFunction(r)&&(r(e),t=!0)})),!Cw.bFullEdition&&e.__addon&&delete e.__addon.Camera,t};var jz=i((function cJ(e,r,n){t(this,cJ),this.Url=e,this.Width=r,this.Height=n})),Hz=function(){function e(r){t(this,e),this._stwain=r,this._ImgManager=r._ImgManager}return i(e,[{key:"Print",value:function(){var e=this;if(e.count()<=0)return!1;var t,r=[];for(t=0;t<e.count();t++)r.push(t);return e.PrintEx(r)}},{key:"PrintCurrentImage",value:function(){var e,t,r,n=this;if(!((e=n._ImgManager.getCurrentImageIndex())<0))return-1==(r=n._ImgManager.convertClientIndexToServerId(e))?(oE(n),!1):(t=kx.getImageUrl(n._ImgManager.getBaseUrl,r,-1,-1),n.__PrintInner(t,r,e))}},{key:"PrintEx",value:function(e){var t=this;if(!(t.count()<=0)){var r=[];return xt.DWT.ConnectWithSocket?t.__GetPrintUrlforSocket(e,r):t.__GetPrintUrlforHttp(e,r),!0}}},{key:"__PrintInner",value:function(e,t,r){var n=this,i=n._ImgManager.getImageIdMap(t),o=[];if(!i)return!1;var a=i.width;(Et.isUndefined(i.width)||i.width<=0)&&(i.width=n.getImageWidthFromServer(r));var s=i.height;(Et.isUndefined(i.height)||i.height<=0)&&(i.height=n.getImageHeightFromServer(r));var u=new jz(e,i.width,i.height);return o.push(u),i.width=a,i.height=s,kx.print(o),!0}},{key:"__GetPrintUrl",value:function(e,t,r){var n,i,o=this,a=0,s=0;return(n=o._ImgManager.getImageIdMap(t))&&(!n.width||n.width<=0?n.width=o.getImageWidthFromServer(r):a=n.width,!n.height||n.height<=0?n.height=o.getImageHeightFromServer(r):s=n.height,i=new jz(e,n.width,n.height),n.width=a,n.height=s),i}},{key:"__GetPrintUrlforHttp",value:function(e,t){var r=this;Et.each(e,(function(e){var n=r._ImgManager.convertClientIndexToServerId(e);if(-1!=n){var i=kx.getImageUrl(r._ImgManager.getBaseUrl,n,-1,-1),o=r.__GetPrintUrl(i,n,e);t.push(o)}})),kx.print(t)}},{key:"__GetPrintUrlforSocket",value:function(e,t){var r,n=this,i=tC.Promise.resolve(0),o=0;return Et.each(e,(function(a){i=i.then((function(){var i=n._ImgManager.convertClientIndexToServerId(a);-1!=i&&n._ImgManager.getImageData(a).then((function(s){if(o++,!s){var u={};return Dw(u),void vA(u._errorString)}r=Nx(s.oriData)?URL.createObjectURL(new Blob([s.oriData])):s.oriData instanceof Blob?URL.createObjectURL(s.oriData):s.oriData;var c=n.__GetPrintUrl(r,i,a);t.push(c),e.length==o&&kx.print(t)}))}))})),!0}},{key:"__GetPrintUrlforMobileEx",value:function(e,t){var r,n=this,i=tC.Promise.resolve(0),o=0;return Et.each(e,(function(a){i=i.then((function(){var i=n._ImgManager.convertClientIndexToServerId(a);-1!=i&&n._ImgManager.getImageData(a).then((function(s){if(o++,!s){var u={};return Dw(u),void vA(u._errorString)}r=Nx(s.oriData)?URL.createObjectURL(new Blob([s.oriData])):s.oriData instanceof Blob?URL.createObjectURL(s.oriData):s.oriData;var c=n.__GetPrintUrl(r,i,a);t.push(c),e.length==o&&kx.print(t)}))}))})),!0}},{key:"count",value:function(){return this._ImgManager.count()}},{key:"getImageHeightFromServer",value:function(e){var t,r,n,i=this,o=1*e;return t=i.count(),o<0||o>t?0:(n=i._ImgManager.convertClientIndexToServerId(o),(r=i._ImgManager.getImageIdMap(n))&&r.imageHeight?r.imageHeight:i._stwain.GetImageHeight(o))}},{key:"getImageWidthFromServer",value:function(e){var t,r,n,i=this,o=1*e;return t=i.count(),o<0||o>t?0:(n=i._ImgManager.convertClientIndexToServerId(o),(r=i._ImgManager.getImageIdMap(n))&&r.imageWidth?r.imageWidth:i._stwain.GetImageWidth(o))}}]),e}();function zz(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(VV){return!1}}();return function(){var r,n=cA(e);if(t){var i=cA(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return uA(this,r)}}function Kz(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function Jz(e,t,r){if(!t.has(e));return r}bt.detect.viewerScriptLoaded=oC;var Qz=new WeakSet,qz=new WeakSet,Yz=new WeakSet,Xz=new WeakSet,Zz=new WeakSet,$z=new WeakSet,eK=function(e){sA(a,e);var r,n,o=zz(a);function a(e){var r;t(this,a),Kz(oA(r=o.call(this,e)),$z),Kz(oA(r),Zz),Kz(oA(r),Xz),Kz(oA(r),Yz),Kz(oA(r),qz),Kz(oA(r),Qz),r._ImgManager=new qj(oA(r),r._imageBufferWrapper),r._imageBufferWrapper=r._ImgManager,r._ImagePrint=new Hz(oA(r));var n,i=e||{};return r._config=i,r._destroying=iC,r._iServiceType=tH.TwainService,r.__addon={},r._bNoMask=i.bNoMask?oC:iC,r._bNotShowMessage=i.bNotShowMessage?oC:iC,r._bSelectedSourceByServer=iC,r._bKeepAwake=i.keepAwake,r._bAx=iC,i.container?r._containerElement=i.container:i.containerId&&(r._containerElement=Et.get(i.containerId)),r.__IfShowCancelDialogWhenImageTransfer=oC,r._errorCode=0,r._errorString="",r.__bLoadingImage=iC,r.__bAcquireImageNow=iC,r.__bOpenFileNow=iC,r.__defaultSourceName="",r.__sourceCount=0,r._bConnecting=iC,r.__licenseInfo=undefined,r.__strProductName=xt.DWT.ProductName,r.__productKey="",r._moduleSize=1048576,r._driverType=gF.TWAIN,r.__maxUploadImageSize=-1,r._bServerPercentDone=oC,r._bSSL=K.bSSL,r._bRegistedLoad=!1,r._logLevel=0,r._scaleDownThreshold=0,r._pdfWriteSetting={},r.__serverPlatform=OC.enumUnknown,r._reconnectTimeSpan=Cw.LocaleReconnectTimeSpan,r._bRemoteMode||(r.httpFormFields={},r.HTTPPassword=i.HTTPPassword||"",r.HTTPPort=bt.detect.ssl?443:80,r.HTTPUserName=i.HTTPUserName||"",r.__HTTPPostResponseString="",r.__remoteFilename="RemoteFile",r.__httpHeaderMap=iC,r._b64bit?r._segementUploadThreshold=4294967296:r._segementUploadThreshold=524288e3,r._aryTiffTag=[],r._tiffCompressionType=xt.DWT.EnumDWT_TIFFCompressionType.TIFF_AUTO,r._jpgQuality=80,r._pdfConvertMode=3,r._pdfOptions={convertMode:Lk.CM_AUTO,password:"",renderOptions:{renderAnnotations:!1,resolution:200,maxWidth:0,maxHeight:0,renderGrayscale:!1}}),Gz(oA(r)),FG(n=oA(r),"Width",{get:function(){return n._resetErr(),n._isValid()?n._isNoViewer()?(n._nouiNotSupport("Width"),""):n._UIView.GetWidth():""},set:function(e){return n._resetErr(),!!n._isValid()&&(n._isNoViewer()?n._nouiNotSupport("Width"):n._UIView.SetWidth(e))}}),FG(n,"Height",{get:function(){return n._resetErr(),n._isValid()?n._isNoViewer()?(n._nouiNotSupport("Height"),""):n._UIView.GetHeight():""},set:function(e){return n._resetErr(),!!n._isValid()&&(n._isNoViewer()?n._nouiNotSupport("Height"):n._UIView.SetHeight(e))}}),FG(n,"AllowMultiSelect",{get:function(){return n._resetErr(),n._isValid()?n._isNoViewer()?n._nouiNotSupport("AllowMultiSelect"):n._UIView.GetAllowMultiSelect():""},set:function(e){return n._resetErr(),!!n._isValid()&&(n._isNoViewer()?n._nouiNotSupport("AllowMultiSelect"):void n._UIView.SetAllowMultiSelect(e))}}),FG(n,"BackgroundColor",{get:function(){return n._resetErr(),n._isValid()?n._isNoViewer()?(n._nouiNotSupport("BackgroundColor"),""):n._UIView.GetBackgroundColor():""},set:function(e){return n._resetErr(),!!n._isValid()&&(n._isNoViewer()?n._nouiNotSupport("BackgroundColor"):n._UIView.SetBackgroundColor(e))}}),FG(n,"BackgroundFillColor",{get:function(){if(n._resetErr(),!n._isValid())return"";if(n._isNoViewer())return n._nouiNotSupport("BackgroundFillColor"),"";var e=n._innerFun("BackgroundFillColor");return rC.BGR2RGB(e)},set:function(e){if(n._resetErr(),!n._isValid())return!1;if(n._isNoViewer())return n._nouiNotSupport("BackgroundFillColor");var t,r=1*e;return!Et.isNumber(r)||Et.isNaN(r)?(Fw(n),iC):(t=rC.RGB2BGR(r),n._innerFun("BackgroundFillColor",Rx(t)))}}),FG(n,"FitWindowType",{get:function(){return n._resetErr(),!!n._isValid()&&(n._isNoViewer()?(n._nouiNotSupport("FitWindowType"),0):n._UIView.GetFitWindowType())},set:function(e){if(n._resetErr(),!n._isValid())return!1;if(n._isNoViewer())return n._nouiNotSupport("FitWindowType");var t=1*e;return n._UIView.SetFitWindowType(t)}}),FG(n,"IfFitWindow",{get:function(){return n._resetErr(),!!n._isValid()&&(n._isNoViewer()?n._nouiNotSupport("IfFitWindow"):n._UIView.GetIfFitWindow())},set:function(e){return n._resetErr(),!!n._isValid()&&(n._isNoViewer()?n._nouiNotSupport("IfFitWindow"):e?n._UIView.SetIfFitWindow(!0):n._UIView.SetIfFitWindow(!1))}}),FG(n,"ImageMargin",{get:function(){return n._resetErr(),n._isValid()?n._isNoViewer()?(n._nouiNotSupport("ImageMargin"),0):n._UIView.GetImageMargin():0},set:function(e){if(n._resetErr(),!n._isValid())return!1;if(n._isNoViewer())return n._nouiNotSupport("ImageMargin");var t=parseInt(e);return!isNaN(t)&&n._UIView.SetImageMargin(t)}}),FG(n,"MouseX",{get:function(){return n._resetErr(),n._isValid()?n._isNoViewer()?(n._nouiNotSupport("MouseX"),0):n.__MouseX:0}}),FG(n,"MouseY",{get:function(){return n._resetErr(),n._isValid()?n._isNoViewer()?(n._nouiNotSupport("MouseY"),0):n.__MouseY:0}}),FG(n,"SelectionImageBorderColor",{get:function(){return n._resetErr(),n._isValid()?n._isNoViewer()?(n._nouiNotSupport("SelectionImageBorderColor"),""):n._UIView.GetSelectionImageBorderColor():""},set:function(e){return n._resetErr(),!!n._isValid()&&(n._isNoViewer()?n._nouiNotSupport("SelectionImageBorderColor"):n._UIView.SetSelectionImageBorderColor(e))}}),FG(n,"Zoom",{get:function(){return n._resetErr(),n._isValid()?n._isNoViewer()?(n._nouiNotSupport("Zoom"),0):n._UIView.GetZoom():0},set:function(e){return n._resetErr(),!!n._isValid()&&(n._isNoViewer()?n._nouiNotSupport("Zoom"):n._UIView.SetZoom(e))}}),FG(n,"MouseShape",{get:function(){return n._resetErr(),!!n._isValid()&&(n._isNoViewer()?n._nouiNotSupport("MouseShape"):n._UIView.GetMouseShape())},set:function(e){return n._resetErr(),!!n._isValid()&&(n._isNoViewer()?n._nouiNotSupport("MouseShape"):n._UIView.SetMouseShape(e))}}),FG(n,"SelectionRectAspectRatio",{get:function(){return n._resetErr(),n._isValid()?n._isNoViewer()?(n._nouiNotSupport("SelectionRectAspectRatio"),0):n._UIView.GetSelectionRectAspectRatio():0},set:function(e){if(n._resetErr(),!n._isValid())return!1;if(n._isNoViewer())return n._nouiNotSupport("SelectionRectAspectRatio");var t=parseFloat(e);return t>=0&&(n._UIView.SetSelectionRectAspectRatio(t),!0)}}),FG(n,"ShowPageNumber",{get:function(){return n._resetErr(),!!n._isValid()&&(n._isNoViewer()?n._nouiNotSupport("ShowPageNumber"):n._UIView.GetShowPageNumber())},set:function(e){return n._resetErr(),!!n._isValid()&&(n._isNoViewer()?n._nouiNotSupport("ShowPageNumber"):n._UIView.SetShowPageNumber(e))}}),FG(n,"IfAutoScroll",{get:function(){return n._resetErr(),!!n._isValid()&&(n._isNoViewer()?n._nouiNotSupport("IfAutoScroll"):n._UIView.GetIfAutoScroll())},set:function(e){return n._resetErr(),!!n._isValid()&&(n._isNoViewer()?n._nouiNotSupport("IfAutoScroll"):n._UIView.SetIfAutoScroll(e))}}),r._innerInitEvents(i),r}return i(a,[{key:"GetImageDataAsync",value:function(e){return this._ImgManager.getImageData(e)}},{key:"SetCustomDataAsync",value:function(e,t){return this._ImgManager.setCustomData(e,t)}},{key:"style",get:function(){return this.__style}},{key:"GetSourceNamesAsync",value:(n=eA(g.mark((function s(e){var t;return g.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if((t=this)._resetErr(),t._isValid()){r.next=4;break}throw{code:t._errorCode,message:t._errorString};case 4:return zx("GetSourceNamesAsync",t),r.prev=5,r.next=8,t._getSourceCountAsync(t._driverType);case 8:r.next=13;break;case 10:throw r.prev=10,r.t0=r["catch"](5),r.t0;case 13:return r.prev=13,Kx("GetSourceNamesAsync"),r.finish(13);case 16:if(!e){r.next=20;break}return r.abrupt("return",Jz(t,Qz,tK).call(t));case 20:return r.abrupt("return",Jz(t,qz,rK).call(t));case 21:case"end":return r.stop()}}),s,this,[[5,10,13,16]])}))),function(e){return n.apply(this,arguments)})},{key:"SelectSourceAsync",value:function(e){var t;return t=pj.dialogText.selectSource,this._selectSourceAsync("SelectSourceAsync",e,t)}},{key:"SelectSourceByIndexAsync",value:function(e){return this._selectSourceByIndexAsync("SelectSourceByIndex",e)}},{key:"OpenSourceAsync",value:function(){return this._openSourceAsync("OpenSourceAsync")}},{key:"CloseSourceAsync",value:function(){return this._closeSourceAsync("CloseSourceAsync")}},{key:"OpenSourceManagerAsync",value:function(){var e=this;return e._resetErr(),e._isValid()?e._innerFunV2("OpenSourceManager"):bt.Promise.reject({code:e._errorCode,message:e._errorString})}},{key:"CloseSourceManagerAsync",value:function(){var e=this;return e._resetErr(),e._isValid()?e._innerFunV2("CloseSourceManager"):bt.Promise.reject({code:e._errorCode,message:e._errorString})}},{key:"AcquireImage",value:function(e,t,r){var n,i=this,o=null,a=null;return i._resetErr(),!!i._isValid()&&(Et.isUndefined(r)&&(Et.isFunction(e)&&Et.isFunction(t)||Et.isFunction(e)&&Et.isUndefined(t)||Et.isFunction(e)&&null==t||null==e&&Et.isFunction(t))?(n={},Et.isFunction(e)&&(o=e),Et.isFunction(t)&&(a=function(e){e&&e.code&&(i._errorCode=e.code,i._errorString=e.message),t(i._errorCode,i._errorString)})):(n=Et.isUndefined(e)||null==e?{}:Et.clone(e),Et.isFunction(t)&&(o=function(){t(n)}),Et.isFunction(r)&&(a=function(e){e&&e.code&&(i._errorCode=e.code,i._errorString=e.message),r(n,i._errorCode,i._errorString)})),o||(o=function(){}),a||(a=function(e){e&&e.code&&(i._errorCode=e.code,i._errorString=e.message)}),i.AcquireImageAsync(n).then(o,a),!eF.isServerInvalid(i))}},{key:"GetDevicesAsync",value:function(e,t,r){return this._getDevicesAsync("GetDevicesAsync",e,t,r)}},{key:"SelectDeviceAsync",value:function(e,t){var r=this;return r._resetErr(),r._isValid()?this._selectDeviceAsync("SelectDeviceAsync",e,t):bt.Promise.reject({code:r._errorCode,message:r._errorString})}},{key:"AcquireImageAsync",value:function(e){return xF(cA(a.prototype),"_acquireImage",this).call(this,this._curDevice,e)}},{key:"ImageIDToIndex",value:function(e){return this._imageIDToIndex(e)}},{key:"IndexToImageID",value:function(e){return this._indexToImageID(e)}},{key:"RemoveImage",value:function(e){return this._removeImage("RemoveImage",e)}},{key:"_innerGetSourceNamesSync",value:function(e){var t=this;return t._getSourceCountSync(),e?Jz(t,Qz,tK).call(t):Jz(t,qz,rK).call(t)}},{key:"getCapabilities",value:function(e,t){return this._dwtGetCapabilities(e,t)}},{key:"setCapabilities",value:function(e,t,r){return this._dwtSetCapabilities(e,t,r)}},{key:"CancelAllPendingTransfers",value:function(){return this._resetErr(),!!this._isValid()&&this._innerFun("CancelAllPendingTransfers")}},{key:"CloseSource",value:function(){var e=this;if(e._resetErr(),!e._isValid())return!1;var t=e._innerFun("CloseSource");return t&&(e._curDevice=null),t}},{key:"CloseSourceManager",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._innerFun("CloseSourceManager")}},{key:"SelectDevice",value:function(e,t){var r,n=this;if(e&&e.deviceType,n._resetErr(),xt.DWT.ConnectWithSocket)return kw(n,-2400,"SelectDevice"+" doesn't work under current settings."),!1;var i,o=null===(r=this._dmService.attrs)||void 0===r?void 0:r.UUID;if(o)if((null===(i=e.serviceInfo.attrs)||void 0===i?void 0:i.UUID)==o);else{var a,s=(null===(a=e.serviceInfo.attrs)||void 0===a?void 0:a.url)||e.serviceInfo.server;if(!(s&&s.indexOf(o)>-1))return wE(n),!1}var u=!1;try{(u=Jz(this,Yz,nK).call(this,e.strDevice,t))&&(this._curDevice=e,this._bSelectedSourceByServer=!1)}catch(c){u=!1,this._errorCode=yw.CommonError,c&&c.message&&(this._errorString=c.message)}return u}},{key:"DisableSource",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._innerFun("DisableSource")}},{key:"FeedPage",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._innerFun("FeedPage")}},{key:"GetDeviceType",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._innerFun("GetDeviceType")}},{key:"GetSourceNameItems",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&(t.__sourceCount<0&&(t.__sourceCount=0),e<t.__sourceCount&&e>=0?t._getSourceNameByIndex(e):"")}},{key:"SourceNameItems",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&t.GetSourceNameItems(e)}},{key:"GetSourceNames",value:function(e){return this._innerGetSourceNamesSync(e)}},{key:"getSourceCount",value:function(e){return this._getSourceCountAsync(e)}},{key:"GetSourceCountAsync",value:function(e){return this._getSourceCountAsync(e)}},{key:"GetSourceType",value:function(e){var t=this,r=parseInt(e);if(t._resetErr(),isNaN(r))return gE(t),!1;if(null==t.__devices&&t.GetSourceNames(!1),r>=t.__devices.length||r<0)return oE(t),!1;var n,i,o,a=t.__devices[r];return n=a.deviceType,i=gF.TWAIN,(o=n&Lx)==Px.TWAINSCANNER||o==Px.WIATWAINSCANNER||(o==Px.TWAINX64SCANNER?i=gF.TWAIN64:o==Px.ICASCANNER?i=gF.ICA:o==Px.SANESCANNER?i=gF.SANE:(o&Px.TWAINX64SCANNER)==Px.TWAINX64SCANNER?(o&Px.TWAINSCANNER)!=Px.TWAINSCANNER&&(o&Px.WIATWAINSCANNER)!=Px.WIATWAINSCANNER||(i=gF.TWAIN_AND_TWAIN64):(o&Px.ICASCANNER)==Px.ICASCANNER&&((o&Px.TWAINSCANNER)!=Px.TWAINSCANNER&&(o&Px.WIATWAINSCANNER)!=Px.WIATWAINSCANNER||(i=gF.TWAIN_AND_ICA))),i}},{key:"OpenSource",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&(e._bRemoteMode?(kw(e,-2610,"OpenSource is not supported when Object is created by CreateRemoteScanObjectAsync. Please use OpenSourceAsync instead."),!1):e._innerFun("OpenSource"))}},{key:"OpenSourceManager",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._innerFun("OpenSourceManager")}},{key:"ResetImageLayout",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._innerFun("ResetImageLayout")}},{key:"RewindPage",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._innerFun("RewindPage")}},{key:"SelectSource",value:function(e,t){var r=this;if(r._resetErr(),!r._isValid())return!1;var n=gF.TWAIN;if(Et.isUndefined(e)){if(r._bRemoteMode)return kw(r,-2438,"SelectSource cannot be used synchronously when Object is created by CreateRemoteScanObjectAsync. Please use SelectSourceAsync instead."),!1;if(r._driverType==gF.TWAIN_AND_TWAIN64)return function(e){kw(e,-2429,"The method SelectSource() must be invoked asynchronously (i.e. with callback functions) when ImageCaptureDriverType is set to TWAIN_AND_ICA or TWAIN_AND_TWAIN64.")}(r),!1;r._driverType!=gF.ICA&&r._driverType!=gF.SANE&&r._driverType!=gF.TWAIN64||(n=r._driverType);var i=K.bMac,o=K.bLinux,a=IF(n,K.bWin,o,i,K.bAndroid);return r._bSelectedSourceByServer=!0,r._curDevice=null,r._innerFun("SelectSource",Rx(a))}r._driverType!=gF.ICA&&r._driverType!=gF.SANE&&r._driverType!=gF.TWAIN64&&r._driverType!=gF.TWAIN_AND_TWAIN64||(n=r._driverType);var s=K.bMac,u=K.bLinux,c=IF(n,K.bWin,u,s,K.bAndroid);return r.SelectSourceAsync(c).then((function(){Et.isFunction(e)&&e()}),(function(){Et.isFunction(t)&&t(r._errorCode,r._getErrorString())})),!0}},{key:"GetSourceTypeAsync",value:function(e){var t=this,r=1*e;return t._resetErr(),t._isValid()?bt.Promise.resolve(t.GetSourceType(r)):bt.Promise.reject({code:t._errorCode,message:t._errorString})}},{key:"SetFileXferInfo",value:function(e,t){var r,n,i=this;return i._resetErr(),!!i._isValid()&&(r=K.bFileSystem?e.replace(/<%/g,"<%25"):e,n=yF.replaceLocalFilename(r),i._innerFun("SetFileXferInfo",Rx(n,t)))}},{key:"SetImageLayout",value:function(e,t,r,n){var i=this;return i._resetErr(),!!i._isValid()&&i._innerFun("SetImageLayout",Rx(e,t,r,n))}},{key:"CapGet",value:function(){return this._resetErr(),!!this._isValid()&&this._innerFun("CapGet")}},{key:"CapGetCurrent",value:function(){return this._resetErr(),!!this._isValid()&&this._innerFun("CapGetCurrent")}},{key:"CapGetDefault",value:function(){return this._resetErr(),!!this._isValid()&&this._innerFun("CapGetDefault")}},{key:"CapGetFrameBottom",value:function(e){return this._resetErr(),!!this._isValid()&&this._innerFun("CapGetFrameBottom",Rx(e))}},{key:"CapGetFrameLeft",value:function(e){return this._resetErr(),!!this._isValid()&&this._innerFun("CapGetFrameLeft",Rx(e))}},{key:"CapGetFrameRight",value:function(e){return this._resetErr(),!!this._isValid()&&this._innerFun("CapGetFrameRight",Rx(e))}},{key:"CapGetFrameTop",value:function(e){return this._resetErr(),!!this._isValid()&&this._innerFun("CapGetFrameTop",Rx(e))}},{key:"CapGetHelp",value:function(){return this._resetErr(),!!this._isValid()&&this._innerFun("CapGetHelp")}},{key:"CapGetLabel",value:function(){return this._resetErr(),!!this._isValid()&&this._innerFun("CapGetLabel")}},{key:"CapGetLabels",value:function(){return this._resetErr(),!!this._isValid()&&this._innerFun("CapGetLabels")}},{key:"CapIfSupported",value:function(e){return this._resetErr(),!!this._isValid()&&this._innerFun("CapIfSupported",Rx(e))}},{key:"CapReset",value:function(){return this._resetErr(),!!this._isValid()&&this._innerFun("CapReset")}},{key:"CapSet",value:function(){return this._resetErr(),!!this._isValid()&&this._innerFun("CapSet")}},{key:"CapSetFrame",value:function(e,t,r,n,i){return this._resetErr(),!!this._isValid()&&this._innerFun("CapSetFrame",Rx(e,t,r,n,i))}},{key:"GetCapItems",value:function(e){return this._resetErr(),!!this._isValid()&&this._innerFun("GetCapItems",Rx(e))}},{key:"GetCapItemsString",value:function(e){return this._resetErr(),!!this._isValid()&&this._innerFun("GetCapItemsString",Rx(e))}},{key:"SetCapItems",value:function(e,t){return this._resetErr(),!!this._isValid()&&this._innerFun("SetCapItems",Rx(e,t))}},{key:"SetCapItemsString",value:function(e,t){return this._resetErr(),!!this._isValid()&&this._innerFun("SetCapItemsString",Rx(e,t))}},{key:"GenerateURLForUploadData",value:function(e,t,r,n,i){var o=this,a=[];if(t==xt.DWT.EnumDWT_ImageType.IT_BMP||t==xt.DWT.EnumDWT_ImageType.IT_JPG||t==xt.DWT.EnumDWT_ImageType.IT_PNG){if(!Et.isArray(e))return iE(o),Et.isFunction(n)&&n(o._errorCode,o._getErrorString(),"",e,t),"";if(e.length>1)return tE(o),Et.isFunction(n)&&n(o._errorCode,o._getErrorString(),"",e,t),"";if(!o._checkIndices(e))return n(o._errorCode,o._getErrorString(),"",e,t),!1;var s=o._ImgManager.convertClientIndexToServerId(e[0]);-1!=s&&a.push(s)}else{if(t!=xt.DWT.EnumDWT_ImageType.IT_TIF&&t!=xt.DWT.EnumDWT_ImageType.IT_PDF)return Et.isArray(e)?sE(o):iE(o),Et.isFunction(n)&&n(o._errorCode,o._getErrorString(),o.__HTTPPostResponseString,e,t),"";var u,c;if(Et.isArray(e)){if(!o._checkIndices(e))return n(o._errorCode,o._getErrorString(),"",e,t),!1;u=e}else{if(-1!=e)return iE(o),Et.isFunction(n)&&n(o._errorCode,o._getErrorString(),o.__HTTPPostResponseString,e,t),"";for(u=[],c=0;c<o._ImgManager.count();c++)u.push(c)}Et.each(u,(function(e){var t=o._ImgManager.convertClientIndexToServerId(e);-1!=t&&a.push(t)}))}if(Et.isFunction(r)&&Et.isFunction(n)){return o._asyncGenerateURLForUploadData(a,t,i,r,(function(e){n(o._errorCode,o._getErrorString(),o.__HTTPPostResponseString,e,t)})),!0}return this._syncGenerateURLForUploadData(a,t,i)}},{key:"_syncGenerateURLForUploadData",value:function(e,t,r){var n,i=this,o=!1,a=Tw.managerVersion.join(""),s=r,u=",";Et.isString(s)&&""!=s||(s="",u="");var c=["[",'"dcp","dwasm_'+a,'",',t,',"',e.join(","),'"',u,s,"]"].join("");if((n=this._innerFunRaw("GenerateURLForUploadData",c,!1,!1,!0))&&Et.isArray(n.result)&&n.result.length>1){var l=n.result[0],d=n.result[1];1==l&&(o=["dcp://dwasm_",a,"/file/",d].join(""))}return Et.isArray(e)&&Et.each(e,(function(e){i._ImgManager.convertServerIdToClientIndex(e)})),0==o?(lE(i),""):o}},{key:"_asyncGenerateURLForUploadData",value:function(e,t,r,n,i){var o=this,a=t,s=function(){if(Et.isFunction(i)){var t=[];Et.isArray(e)&&Et.each(e,(function(e){var r=o._ImgManager.convertServerIdToClientIndex(e);r>-1&&t.push(r)})),i(t)}return""},u=",";if(a==xt.DWT.EnumDWT_ImageType.IT_BMP||a==xt.DWT.EnumDWT_ImageType.IT_JPG||a==xt.DWT.EnumDWT_ImageType.IT_PNG){if(e.length>1)return tE(o),s(),""}else if(a!=xt.DWT.EnumDWT_ImageType.IT_TIF&&a!=xt.DWT.EnumDWT_ImageType.IT_PDF)return sE(o),s(),"";var c=!1,l=Tw.managerVersion.join(""),d=r;Et.isString(d)&&""!=d||(d="",u="");var f=["[",'"dcp","dwasm_'+l,'",',a,',"',e.join(","),'"',u,d,"]"].join("");return this._innerFunRaw("GenerateURLForUploadData",f,!0,!1,!0,(function(r){if(r&&Et.isArray(r.result)&&r.result.length>0)if(1==r.result[0]&&r.result.length>1){var i=r.result[1];c=["dcp://dwasm_",l,"/file/",i].join("")}else r.exception!==undefined&&r.description!==undefined?(o._errorCode=r.exception,o._errorString=r.description):lE(o);else lE(o);if(0==c)return s(),"";if(Et.isFunction(n)){var a=[];Et.isArray(e)&&Et.each(e,(function(e){var t=o._ImgManager.convertServerIdToClientIndex(e);t>-1&&a.push(t)})),n(c,a,t)}return c}),s)}},{key:"SelectSourceByIndex",value:function(e){var t=this,r=parseInt(e);if(t._resetErr(),isNaN(r))return gE(t),!1;if(null==t.__devices&&t.GetSourceNames(!1),r>=t.__devices.length||r<0)return oE(t),!1;var n=t.__devices[r];return t.SelectDevice(n)}},{key:"EnableSource",value:function(e,t,r){var n=this;return n._resetErr(),!!n._isValid()&&n.AcquireImage(e,t,r)}},{key:"SourceCount",get:function(){return this._getSourceCountSync()}},{key:"CurrentSourceName",get:function(){return this._curDevice?this._curDevice.displayName:""}},{key:"checkStartScanParams",value:function(e,t){var r=this;if(!e)return kw(r,-2381,"scanSetup is invalid."),!1;if(!Et.isUndefined(t.transferMode)&&0!=e.transferMode&&1!=e.transferMode&&2!=e.transferMode)return function(e){kw(e,-2382,"Scanner setup error: Invalid Transfer Mode.")}(r),!1;if(e.transferMode==xt.DWT.EnumDWT_TransferMode.TWSX_FILE){if(!e.fileXfer)return function(e){kw(e,-2383,"Scanner setup error: fileXfer is invalid.")}(r),!1;if(!Et.isString(e.fileXfer.fileName)||""==e.fileXfer.fileName)return function(e){kw(e,-2384,"Scanner setup error: Invalid fileName in fileXfer.")}(r),!1;if(!Et.isNumber(e.fileXfer.fileFormat)||e.fileXfer.fileFormat<0||e.fileXfer.fileFormat>16)return function(e){kw(e,-2385,"Scanner setup error: Invalid fileFormat in fileXfer.")}(r),!1}if(t){if(!Et.isString(t.type)||""==t.type)return function(e){kw(e,-2387,"Output setup error: Invalid type in outputSetup.")}(r),!1;if(!t.httpParams)return function(e){kw(e,-2386,"Output setup error: Invalid httpParams in outputSetup.")}(r),!1;if(e.transferMode!=xt.DWT.EnumDWT_TransferMode.TWSX_FILE&&Et.isUndefined(t.format))return function(e){kw(e,-2390,"Output setup error: Invalid format in outputSetup.")}(r),!1;if(!Et.isString(t.httpParams.url)||""==t.httpParams.url)return function(e){kw(e,-2388,"Output setup error: Invalid url in outputSetup.httpParams.")}(r),!1;if(!Et.isString(t.httpParams.fileName)||""==t.httpParams.fileName)return function(e){kw(e,-2389,"Output setup error: Invalid fileName in outputSetup.httpParams.")}(r),!1}return!0}},{key:"startScan",value:function(e){var t=this,r=e;if(t._resetErr(),!t._isValid())return!1;if(1==t._startScanFlag)return kw(t,-2432,"Operation in progress, please try again when the current operation has finished."),bt.Promise.reject({code:t._errorCode,message:t._getErrorString()});t._startScanFlag=!0,Et.isObject(r)||(r={});var n,i,o,a=!1,s=!1,u=!0,c=!0,l=!0,d=!1,f=r.onFinally,h=[],g=[],p=0,m=1,_=[],v={type:"http",format:xt.DWT.EnumDWT_ImageType.IT_PDF,reTries:3,useUploader:!1,singlePost:!0,showProgressBar:!0,removeAfterOutput:!0,httpParams:{url:"",headers:{},formFields:{},remoteName:"RemoteFile",fileName:""}},y=Et.clone(r),I=r;if(o=y.funcScanStatus,delete y.funcScanStatus,Et.isFunction(o)?y.bfuncScanStatus=!0:y.bfuncScanStatus=!1,y.outputSetup){var S={pdfSetup:{},tiffSetup:{}};uK(y.outputSetup,v),i=y.outputSetup,delete y.outputSetup,i.pdfSetup&&(i.format!=xt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF&&i.format!=xt.DWT.EnumDWT_ImageType.IT_PDF||Et.mix(S.pdfSetup,i.pdfSetup)),i.tiffSetup&&(i.format!=xt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_TIF&&i.format!=xt.DWT.EnumDWT_ImageType.IT_TIF||Et.mix(S.tiffSetup,i.tiffSetup)),i.format!=xt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF&&i.format!=xt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_TIF||(i.singlePost=!0),Et.isNumber(i.httpParams.threads)&&(m=i.httpParams.threads),a=Et.stringify(S),s=t.checkStartScanParams(y,i)}else(i=v).type="",s=t.checkStartScanParams(y,!1);if(!s)return new bt.Promise((function(e,r){u&&(r({code:t._errorCode,message:t._getErrorString(),response:""}),u=!1,t._startScanFlag=!1)}));i.funcHttpUploadStatus&&(d=i.funcHttpUploadStatus);var T,b,C,w,E,A=t.__remoteFilename,k=t.MaxUploadImageSize,P=t.IfShowProgressBar,x=t.__OnPostTransferAsync,D=t.__OnPostAllTransfers,F=t.__OnHttpUploadStatus,W=t.__insertingIndex,R=t.__IfAppendImage,N=t.httpFormFields,O=t._tiffCompressionType,M=!1,L=i.showProgressBar;if((T=function(e){var t=!0;Et.each(_,(function(e,r){-1==e.st&&(t=!1)})),t?b(e):setTimeout((function(){T(e)}),200)},b=function(e){e.__OnPostTransferAsync=x,e.__OnPostAllTransfers=D,e.__OnHttpUploadStatus=F,e.__remoteFilename=A,e.__maxUploadImageSize=k,e.IfShowProgressBar=P,e.__insertingIndex=W,e.__IfAppendImage=R,e.httpFormFields=N,e._tiffCompressionType=O,xt.FileUploader&&(xt.FileUploader.nextLoopTime=600),e._startScanFlag=!1},C=function(e,t,r){c?(t(r),T(e)):setTimeout((function(){C(e,t,r)}),200)},w=function(e,r){M=!0,u&&(u=!1,c||t._innerSendCmd("CancelAllPendingTransfers"),C(t,e,r))},E=function(e,t,r,n){if(Et.isFunction(d)){var i,o=t,a=0;Et.isNumber(n)&&n>0&&(a=n),i={fileName:o,percentage:r,statusCode:a,responseString:e.__HTTPPostResponseString},setTimeout((function(){d(i)}),10)}},t.__HTTPPostResponseString="",t.IfShowProgressBar=L,Et.isNumber(y.insertingIndex)&&y.insertingIndex>-1&&(t.__insertingIndex=y.insertingIndex,t.__IfAppendImage=!1),Et.isFunction(d)?t.__OnHttpUploadStatus=d:t.__OnHttpUploadStatus=!1,i.useUploader)&&!xt.FileUploader)return new bt.Promise((function(e,r){kw(t,-2380,"Please make sure the Uploader Module has been installed.");var n={code:t._errorCode,message:t._getErrorString(),response:""};c=!0,w(r,n)}));if(n=i.reTries,i.useUploader){var B=i.httpParams.url;if(!Et.startsWith(B,"http://")&&!Et.startsWith(B,"https://")){var U=window.location.href,V=U.lastIndexOf("/");U=U.substring(0,V+1),i.httpParams.url=U+B}}else Et.each(i.httpParams.headers,(function(e,r){t.SetHTTPHeader(r,e)})),Et.each(i.httpParams.formFields,(function(e,r){t.SetHTTPFormField(r,e)}));return""!==i.httpParams.remoteName&&(t.__remoteFilename=i.httpParams.remoteName),new bt.Promise((function(e,r){i.useUploader?xt.FileUploader.Init(0,(function(t){e({uploadManager:t})}),(function(e,n){t._errorCode=e,t._errorString=n;var i={code:e,message:n,response:t.__HTTPPostResponseString};c=!0,w(r,i)})):e({})})).then((function(e){return new bt.Promise((function(r,s){var u=function S(){(y.transferMode==xt.DWT.EnumDWT_TransferMode.TWSX_FILE?p==g.length:p==h.length)?(bt.closeProgress(null,"Scan Upload"),M=!0,r(I),b(t)):setTimeout(S,100)};o&&Et.isFunction(o)&&(t.__OnPreAllTransfersAsync=function(e){o(e)}),t.registerEvent("OnPostTransferAsync",(function(r){var u,f,v,I,S,T,b=i.httpParams.url,C=t._convertGuidToServerId(r.imageId),A=i.singlePost,k=y.transferMode==xt.DWT.EnumDWT_TransferMode.TWSX_FILE,P=i.removeAfterOutput,x=0;if(l&&(c=!1,l=!1),k?(x=g.length,g.push(r.path)):(x=h.length,h.push(C)),o&&Et.isFunction(o)){var D={event:"postTransfer",bScanCompleted:!1,result:{currentPageNum:x+1}};setTimeout((function(){o(D)}),10)}if(M)return!1;if("http"==i.type)if(f=hG(i.httpParams.fileName,x+1),v=hG(i.httpParams.remoteName,x+1),A||"http"!=i.type)!A&&i.type;else if(Et.isNumber(i.httpParams.maxSizeLimit)&&(t.__maxUploadImageSize=i.httpParams.maxSizeLimit),i.useUploader){L?(xt.FileUploader.nextLoopTime=300,bt.showProgress(t,"Scan Upload",t.__IfShowCancelDialogWhenImageTransfer)):bt.hideProgress(),I=function(e,r){return t.__HTTPPostResponseString=r,E(t,e._fileName,100,200),t._OnPercentDone([0,100,"","http",e._fileName]),L&&bt.closeProgress(null,"Scan Upload"),!k&&i.removeAfterOutput?setTimeout((function(){t._ImgManager.convertServerIdToClientIndex(C)>-1?Jz(t,Zz,oK).call(t,C,(function(){p++}),(function(){p++})):p++}),100):p++,!0};var F,W=e.uploadManager;if(S=function(){if(L){var e,r=0;for(r=k?g.length:h.length,e=0;e<r;e++)bt.closeProgress(null,"Scan Upload")}!k&&i.removeAfterOutput&&setTimeout((function(){t._ImgManager.convertServerIdToClientIndex(C)>-1&&Jz(t,Zz,oK).call(t,C)}),100),W.CancelAllUpload();var n={code:t._errorCode,message:t._getErrorString(),response:t.__HTTPPostResponseString};return w(s,n),!1},T=function(e,r,n,i){var o=303;r==sK.TRANS_SERVICE_ERROR_404?o=404:r==sK.TRANS_SERVICE_ERROR_500?o=500:r==sK.TRANS_SERVICE_ERROR_503&&(o=503),t._errorCode=r,t._errorString=n,t.__HTTPPostResponseString=i,E(t,f,100,o),S()},F=function(){t.__HTTPPostResponseString="",E(t,f,100,303),S()},k){var R=W.CreateJob(),N=R.FormField;Et.each(i.httpParams.headers,(function(e,t){R.HttpHeader[t]=e})),Et.each(i.httpParams.formFields,(function(e,t){N.Add(t,e)})),R.ServerUrl=b,R.bDeleteFile=P,R.reTries=n,Et.isNumber(i.httpParams.maxSizeLimit)&&(R.maxSizeLimit=i.httpParams.maxSizeLimit),R._fileName=f,R.SourceValue.Add(r.path,f,v),R.ImageType=y.fileXfer.fileFormat,R.ThreadNum=m,R.OnRunSuccess=I,R.OnRunFailure=T,(L||Et.isFunction(d))&&(R.OnUploadTransferPercentage=function(e,r){r>0&&r<=100&&(t._OnPercentDone([0,r,"","http",e._fileName]),Et.isFunction(d)&&E(t,e._fileName,r,0))},bt.cancelFrom=aG.Scan,L&&Jz(t,$z,aK).call(t,S),t._OnPercentDone([0,-1,fx.Uploading,"http",f]),E(t,f,0,0)),W.Run(R)}else(u=i.format)==xt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF?u=xt.DWT.EnumDWT_ImageType.IT_PDF:u==xt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_TIF&&(u=xt.DWT.EnumDWT_ImageType.IT_TIF),bt.cancelFrom=aG.Scan,L&&Jz(t,$z,aK).call(t,S),t._OnPercentDone([0,-1,fx.Encoding,"http",f]),t._asyncGenerateURLForUploadData([C],u,a,(function(e){var r=W.CreateJob(),o=r.FormField;Et.each(i.httpParams.headers,(function(e,t){r.HttpHeader[t]=e})),Et.each(i.httpParams.formFields,(function(e,t){o.Add(t,e)})),r.ServerUrl=b,r.bDeleteFile=P,r.reTries=n,Et.isNumber(i.httpParams.maxSizeLimit)&&(r.maxSizeLimit=i.httpParams.maxSizeLimit),r._fileName=f,r.SourceValue.Add(e,f,v),r.ImageType=u,r.ThreadNum=m,r.OnRunSuccess=I,r.OnRunFailure=T,(L||Et.isFunction(d))&&(r.OnUploadTransferPercentage=function(e,r){r>0&&r<=100&&(t._OnPercentDone([0,r,"","http",e._fileName]),Et.isFunction(d)&&E(t,e._fileName,r,0))},t._OnPercentDone([0,-1,fx.Uploading,"http",f]),E(t,f,0,0)),W.Run(r)}),F)}else{var O={id:C,st:-1,bCancel:!1};if(_.push(O),0==x&&(L?bt.showProgress(t,"Scan Upload",t.__IfShowCancelDialogWhenImageTransfer):bt.hideProgress()),k)I=function(e){return O.st=0,!k&&i.removeAfterOutput?setTimeout((function(){t._ImgManager.convertServerIdToClientIndex(C)>-1?Jz(t,Zz,oK).call(t,C,(function(){p++}),(function(){p++})):p++}),100):p++,!0},S=function(){!k&&i.removeAfterOutput&&setTimeout((function(){t._ImgManager.convertServerIdToClientIndex(C)>-1&&Jz(t,Zz,oK).call(t,C)}),100);var e={code:t._errorCode,message:t._getErrorString(),response:t.__HTTPPostResponseString};return bt.closeProgress(null,"Scan Upload"),2==O.st||(O.st=1,Et.each(_,(function(e,t){-1==e.st&&(e.bCancel=!0)})),w(s,e)),!1},t._innerUploadDirectly(b,r.path,f,L,P,n,!1,O,I,S);else{if(I=function(e,r){return O.st=0,!k&&i.removeAfterOutput?setTimeout((function(){t._ImgManager.convertServerIdToClientIndex(C)>-1?Jz(t,Zz,oK).call(t,C,(function(){p++}),(function(){p++})):p++}),100):p++,!0},S=function(e){!k&&i.removeAfterOutput&&setTimeout((function(){t._ImgManager.convertServerIdToClientIndex(C)>-1&&Jz(t,Zz,oK).call(t,C)}),100);var r={code:t._errorCode,message:t._getErrorString(),response:t.__HTTPPostResponseString};return bt.closeProgress(null,"Scan Upload"),2==O.st||(O.st=1,Et.each(_,(function(e,t){-1==e.st&&(e.bCancel=!0)})),w(s,r)),!1},u=i.format,Et.isUndefined(u)){var B=t._ImgManager.convertServerIdToClientIndex(C);return sE(t),S([B]),!1}u==xt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF?u=xt.DWT.EnumDWT_ImageType.IT_PDF:u==xt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_TIF&&(u=xt.DWT.EnumDWT_ImageType.IT_TIF);var U={method:"startScan",url:b,serverIds:[C],headers:t._GetHttpHeadersAndClear(),formData:uj(t.httpFormFields),enumImageType:u,saveSetup:a,fileName:f,dataFormat:Qj.Binary,retry:n,bOnlyResponseEmptyIsOK:!1,objUploadFileStatus:O,asyncSuccessFunc:I,asyncFailureFunc:S};t._asyncUploadCmd(U)}}})),t.__OnPostAllTransfers=function(){var l,_,v=-1,S=Qj.Binary,T=i.httpParams.url,C=i.singlePost,A=y.transferMode==xt.DWT.EnumDWT_TransferMode.TWSX_FILE,k=i.removeAfterOutput;o&&Et.isFunction(o)&&(v=A?g.length:h.length,_={event:"postTransfer",bScanCompleted:!0,result:{currentPageNum:v}},setTimeout((function(){o(_)}),10));if(0==v)return function(e){kw(e,-1029,"Source has nothing to capture.")}(t),void setTimeout((function(){c=!0,f&&Et.isFunction(f)&&f();var e={code:t._errorCode,message:t._getErrorString(),response:t.__HTTPPostResponseString};w(s,e)}),1e3);if(v>0&&-1029==t._errorCode)t._errorCode=0;else if(0!=t._errorCode){c=!0,f&&Et.isFunction(f)&&f();var P={code:t._errorCode,message:t._getErrorString(),response:t.__HTTPPostResponseString};return void w(s,P)}if("http"==i.type){if(C&&"http"==i.type){var x,D,F,W=h;if(Et.isNumber(i.httpParams.maxSizeLimit)&&(t.__maxUploadImageSize=i.httpParams.maxSizeLimit),i.useUploader){var R,N=e.uploadManager,O=N.CreateJob(),B=O.FormField;if(L?(xt.FileUploader.nextLoopTime=300,bt.showProgress(t,"Scan Upload",t.__IfShowCancelDialogWhenImageTransfer)):bt.hideProgress(),x=function(e,n){var o=e._fileName;return o||(o=""),t._bServerPercentDone=!0,t.__HTTPPostResponseString=n,E(t,o,100,200),t._OnPercentDone([0,100,"","http"]),L&&bt.closeProgress(null,"Scan Upload"),!A&&i.removeAfterOutput?setTimeout((function(){p=0,Et.each(W,(function(e){t._ImgManager.convertServerIdToClientIndex(e)>-1?Jz(t,Zz,oK).call(t,e,(function(){p++}),(function(){p++})):p++})),setTimeout(u,100)}),100):(M=!0,r(I),b(t)),!0},D=function(){L&&bt.closeProgress(null,"Scan Upload"),N.CancelAllUpload(),t._bServerPercentDone=!0;var e={code:t._errorCode,message:t._getErrorString(),response:t.__HTTPPostResponseString};return w(s,e),!A&&i.removeAfterOutput&&setTimeout((function(){Et.each(W,(function(e){t._ImgManager.convertServerIdToClientIndex(e)>-1&&Jz(t,Zz,oK).call(t,e)}))}),100),!1},F=function(e,r,n,i){var o=303;r==sK.TRANS_SERVICE_ERROR_404?o=404:r==sK.TRANS_SERVICE_ERROR_500?o=500:r==sK.TRANS_SERVICE_ERROR_503&&(o=503),t._errorCode=r,t._errorString=n,t.__HTTPPostResponseString=i,E(t,"",100,o),D()},R=function(){t.__HTTPPostResponseString="",E(t,"",100,303),D()},L&&(bt.cancelFrom=aG.Scan,Jz(t,$z,aK).call(t,D)),A)Et.each(i.httpParams.headers,(function(e,t){O.HttpHeader[t]=e})),Et.each(i.httpParams.formFields,(function(e,t){B.Add(t,e)})),O.ServerUrl=T,O.bDeleteFile=k,O.reTries=n,Et.isNumber(i.httpParams.maxSizeLimit)&&(O.maxSizeLimit=i.httpParams.maxSizeLimit),Et.each(g,(function(e,t){var r=hG(i.httpParams.fileName,t+1),n=hG(i.httpParams.remoteName,t+1);O.SourceValue.Add(e,r,n)})),O.ImageType=y.fileXfer.fileFormat,O.ThreadNum=m,O.OnRunSuccess=x,O.OnRunFailure=F,(L||Et.isFunction(d))&&(O.OnUploadTransferPercentage=function(e,r){r>0&&r<=100&&(t._OnPercentDone([0,r,"","http"]),Et.isFunction(d)&&E(t,"",r,0))},t._OnPercentDone([0,-1,fx.Uploading,"http"]),E(t,"",0,0)),N.Run(O);else if((l=i.format)==xt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF||l==xt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_TIF)l==xt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF?l=xt.DWT.EnumDWT_ImageType.IT_PDF:l==xt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_TIF&&(l=xt.DWT.EnumDWT_ImageType.IT_TIF),t._OnPercentDone([0,-1,fx.Encoding,"http"]),t._asyncGenerateURLForUploadData(W,l,a,(function(e){Et.each(i.httpParams.headers,(function(e,t){O.HttpHeader[t]=e})),Et.each(i.httpParams.formFields,(function(e,t){B.Add(t,e)})),O.ServerUrl=T,O.bDeleteFile=k,O.reTries=n,Et.isNumber(i.httpParams.maxSizeLimit)&&(O.maxSizeLimit=i.httpParams.maxSizeLimit);var r=hG(i.httpParams.fileName,1),o=hG(i.httpParams.remoteName,1);O._fileName=r,O.SourceValue.Add(e,r,o),O.ImageType=l,O.ThreadNum=m,O.OnRunSuccess=x,O.OnRunFailure=F,(L||Et.isFunction(d))&&(O.OnUploadTransferPercentage=function(e,n){n>0&&n<=100&&(t._OnPercentDone([0,n,"","http",r]),Et.isFunction(d)&&E(t,r,n,0))},t._OnPercentDone([0,-1,fx.Uploading,"http",r])),N.Run(O)}),R);else{var U=W.length,V=0,G=0,j="";L&&(t._bServerPercentDone=!1),t._OnPercentDone([0,-1,fx.Encoding,"http"]),Et.each(W,(function(e,r){var o=hG(i.httpParams.fileName,r+1),s=hG(i.httpParams.remoteName,r+1);t._asyncGenerateURLForUploadData([e],l,a,(function(e){G=(V+1)/U*100,j=[V+1,"/",U].join(""),t._OnPercentDone([0,G,j,"http"]),O.SourceValue.Add(e,o,s),++V>=U&&(L&&(t._bServerPercentDone=!0),Et.each(i.httpParams.headers,(function(e,t){O.HttpHeader[t]=e})),Et.each(i.httpParams.formFields,(function(e,t){B.Add(t,e)})),O.ServerUrl=T,O.bDeleteFile=k,O.reTries=n,Et.isNumber(i.httpParams.maxSizeLimit)&&(O.maxSizeLimit=i.httpParams.maxSizeLimit),O.ImageType=l,O.ThreadNum=m,O.OnRunSuccess=x,O.OnRunFailure=F,(L||Et.isFunction(d))&&(O.OnUploadTransferPercentage=function(e,r){r>0&&r<=100&&(t._OnPercentDone([0,r,"","http"]),Et.isFunction(d)&&E(t,"",r,0))},t._OnPercentDone([0,-1,fx.Uploading,"http"])),N.Run(O))}),R)}))}}else if(A)x=function(e){return t._bServerPercentDone=!0,!A&&i.removeAfterOutput?setTimeout((function(){p=0,Et.each(W,(function(e){t._ImgManager.convertServerIdToClientIndex(e)>-1?Jz(t,Zz,oK).call(t,e,(function(){p++}),(function(){p++})):p++})),setTimeout(u,100)}),100):(M=!0,r(I),b(t)),!0},D=function(e){t._bServerPercentDone=!0;var r={code:t._errorCode,message:t._getErrorString(),response:t.__HTTPPostResponseString};return w(s,r),!A&&i.removeAfterOutput&&setTimeout((function(){Et.each(W,(function(e){t._ImgManager.convertServerIdToClientIndex(e)>-1&&Jz(t,Zz,oK).call(t,e)}))}),100),!1},t._innerUploadFilesDirectly(T,g,i.httpParams.fileName,L,k,n,!1,x,D);else{x=function(e,n){return t._bServerPercentDone=!0,!A&&i.removeAfterOutput?setTimeout((function(){p=0,Et.each(W,(function(e){t._ImgManager.convertServerIdToClientIndex(e)>-1?Jz(t,Zz,oK).call(t,e,(function(){p++}),(function(){p++})):p++})),setTimeout(u,100)}),100):(M=!0,r(I),b(t)),!0},D=function(e){t._bServerPercentDone=!0;var r={code:t._errorCode,message:t._getErrorString(),response:t.__HTTPPostResponseString};return w(s,r),!A&&i.removeAfterOutput&&setTimeout((function(){Et.each(W,(function(e){t._ImgManager.convertServerIdToClientIndex(e)>-1&&Jz(t,Zz,oK).call(t,e)}))}),100),!1},l=i.format;var H=t._GetHttpHeadersAndClear(),z=uj(t.httpFormFields);if(l==xt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF||l==xt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_TIF){l==xt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF?l=xt.DWT.EnumDWT_ImageType.IT_PDF:l==xt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_TIF&&(l=xt.DWT.EnumDWT_ImageType.IT_TIF);var K=hG(i.httpParams.fileName,1);hG(i.httpParams.remoteName,1);var J={method:"startScan",url:T,headers:H,formData:z,serverIds:W,enumImageType:l,saveSetup:a,fileName:K,dataFormat:S,retry:n,bOnlyResponseEmptyIsOK:!1,objUploadFileStatus:!1,asyncSuccessFunc:x,asyncFailureFunc:D};t._asyncUploadCmd(J)}else W.length>0&&t._asyncUploadFilesCmd(T,W,H,z,l,i.httpParams.fileName,a,L,n,!1,x,D)}}C&&i.type}c=!0,f&&Et.isFunction(f)&&f()};var v=function(){"http"!=i.type?(M=!0,r(I),b(t)):i.singlePost||setTimeout(u,100)};Jz(t,Xz,iK).call(t,y,v,(function(e){if(-1029==t._errorCode){if(y.transferMode==xt.DWT.EnumDWT_TransferMode.TWSX_FILE?g.length>0:h.length>0)return t._errorCode=0,v()}var r={code:t._errorCode,message:t._getErrorString(),response:t.__HTTPPostResponseString};w(s,r)}))}))}))}},{key:"_innerInitEvents",value:function(e){this.__OnWSReconnect=e.onWSReconnect||null,this.__OnWSClose=e.onWSClose||null,this.__OnWSMessage=e.onWSMessage||null,this.__OnWSError=e.onWSError||null,this.__OnPercentDone=e.onPercentDone||"",this.__OnPrintMsg=e.onPrintMsg||"",this.__OnResult=e.onResult||"",this.__OnAfterOperate=e.onAfterOperate||"",this.__OnBeforeOperate=e.onBeforeOperate||"",this.__OnOperateStatus=e.onOperateStatus||"",this.__OnBitmapChanged=e.onBitmapChanged||"",this.__OnGetFilePath=e.onGetFilePath||"",this.__OnPreAllTransfers=e.onPreAllTransfers||"",this.__OnPreTransfer=e.onPreTransfer||"",this.__OnPostLoad=e.onPostLoad||"",this.__OnPostTransfer=e.onPostTransfer||"",this.__OnPostAllTransfers=e.onPostAllTransfers||"",this.__OnSourceUIClose=e.onSourceUIClose||"",this.__OnTransferCancelled=e.onTransferCancelled||"",this.__OnTransferError=e.onTransferError||"",this.__OnInternetTransferPercentage=e.onInternetTransferPercentage||"",this.__OnInternetTransferPercentageEx=e.onInternetTransferPercentageEx||"",this.__OnRemoteScanStatusAsync=e.onRemoteScanStatusAsync||""}}],[{key:"create",value:(r=eA(g.mark((function u(e){var t;return g.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=new a(e),r.next=3,eF.STwainConnectToServer(t);case 3:return r.abrupt("return",t);case 4:case"end":return r.stop()}}),u)}))),function(e){return r.apply(this,arguments)})}]),a}(iz);function tK(){var e,t,r=[],n=this.__devices.length;for(e=0;e<n;e++){var i=this.__devices[e],o=i.deviceType,a={ProductName:"",DeviceInfo:{},DriverType:"",IsCurrentSource:!1,IsDefaultSource:!1,Manufacturer:"",ProductFamily:"",ProtocolMajor:0,ProtocolMinor:0,SupportedGroups:0,Version:{Country:0,Info:"",Language:0,MajorNum:0,MinorNum:0}},s=void 0,u=Et.clone(i.deviceInfo);(t=o)==Px.TWAINSCANNER||t==Px.WIATWAINSCANNER||t==Px.TWAINX64SCANNER?(o==Px.TWAINSCANNER?s="TWAIN":o==Px.WIATWAINSCANNER?s="WIATWAIN":o==Px.TWAINX64SCANNER&&(s="TWAIN64"),a.Manufacturer=u.Manufacturer,a.ProductFamily=u.ProductFamily,a.ProtocolMajor=u.ProtocolMajor,a.ProtocolMinor=u.ProtocolMinor,a.SupportedGroups=u.SupportedGroups,a.Version=u.Version):o==Px.SANESCANNER?(s="SANE",a.DeviceInfo=u):o==Px.ICASCANNER?(s="ICA",a.DeviceInfo=u):o==Px.ESCLSCANNER?(s="eSCL",a.DeviceInfo=u):o==Px.WIFIDIRECTSCANNER?(s="WiFiScanner",a.DeviceInfo=u):o==Px.WIASCANNER&&(s="WIA",a.DeviceInfo=u),a.ProductName=i.displayName,a.DriverType=s,r.push(a)}return r}function rK(){var e,t=[],r=this.__devices.length;for(e=0;e<r;e++){var n=this.__devices[e];t.push(n.displayName)}return t}function nK(e,t){var r=["[",e,",",null!=t?t:PD.SMF_NAME,"]"].join("");return this._innerFun("SelectSourceEx",r)}function iK(e,t,r){var n,i,o=this,a=null,s=null;if(i=Et.isUndefined(e)||null==e?{}:e,o._resetErr(),!o._isValid())return!1;if(Et.isFunction(t)&&(a=function(){t(i)}),Et.isFunction(r)&&(s=function(e,t){r(e,t,i)}),!bP.checkProductKey(o,{Core:!0}))return Et.isFunction(s)&&s(o._errorCode,o._errorString),!1;for(var u=0,c=0;c<fF.length;c++){var l=["__",fF[c]].join("");Et.isFunction(o[l])&&(u|=1<<c)}return i.EnableEvents=u,n=["[",Et.stringify(i),"]"].join(""),o.__bAcquireImageNow=!0,o.__innerAcquireOrLoadImageAsync("StartScan",n,!1,!0).then(a,(function(e){o._errorCode=e.code,o._errorString=e.message,Et.isFunction(s)&&s(e.code,e.message)})),!0}function oK(e,t,r){var n=this;return n._innerFunRaw("RemoveImage",Rx(e),!0,!1,!0,(function(){n._OnBitmapChanged(["0",""+e,3,n._ImgManager.getCurrentImageIndex(),n._ImgManager.count()]),Et.isFunction(t)&&t()}),r)}function aK(e){var t=this;t.IfShowCancelDialogWhenImageTransfer?(bt.progressContext&&bt.progressContext.on("cancel",(function(){kE(t),e()})),_G(!0)):_G(!1)}var sK={TRANS_SERVICE_ERROR_404:12,TRANS_SERVICE_ERROR_500:13,TRANS_SERVICE_ERROR_503:14},uK=function lJ(t,r){if(!Et.isUndefined(t)&&!Et.isUndefined(r)&&null!=t&&null!=r){for(var n in r)t.hasOwnProperty(n)?"object"===e(t[n])&&lJ(t[n],r[n]):t[n]=r[n];return t}};function cK(e,t,r){if(e){var n=null!=t?t:270,i=null!=r?r:350;n<=0&&(n=270),i<=0&&(i=350),tC.one(e).before(bt.install._strNonInstallDIV);var o=Et.get(bt.install._divDWTNonInstallContainerID);o&&(o.style.width=n,o.style.height=i),Et.show(bt.install._divDWTNonInstallContainerID)}}function lK(e,t){return dK.apply(this,arguments)}function dK(){return dK=eA(g.mark((function e(t,r){var n,i,o,a;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Aw(t)){e.next=14;break}return n=K.bSSL?xt.DWT.SSLPort:xt.DWT.Port,e.next=4,ZH(t,n);case 4:if(!(i=e.sent)){e.next=9;break}fK(i.upgrade,i.socket),e.next=12;break;case 9:throw NE(o={}),hA(o);case 12:e.next=15;break;case 14:Et.isFunction(xt.OnRemoteWebTwainNotFoundCallback)&&(a=K.bSSL,xt.OnRemoteWebTwainNotFoundCallback(bw.name,t,r,a,Ax.bMobile));case 15:case"end":return e.stop()}}),e)}))),dK.apply(this,arguments)}function fK(e,t){var r=aw.getDSPath();if(""!=bt.install._divDWTemessageContainer&&Et.hide(bt.install._divDWTemessageContainer),K.bMac)e?Et.isFunction(xt.OnWebTwainNeedUpgradeCallback)&&xt.OnWebTwainNeedUpgradeCallback(bw.name,{"default":r},bw.bHTML5Edition,OC.enumMac,K.bIE,K.bSafari,bt.detect.ssl,Ax.strIEVersion):Et.isFunction(xt.OnWebTwainNotFoundOnMacCallback)&&xt.OnWebTwainNotFoundOnMacCallback(bw.name,r,bw.bHTML5Edition,K.bIE,K.bSafari,bt.detect.ssl,Ax.strIEVersion,t);else if(K.bLinux||xt.navInfo.bEmbed||K.bChromeOS||Ax.bMobile){var n,i,o=aw.getEnumPlatform();if(xt.navInfo.bEmbed||K.bAndroid||K.bChromeOS||K.bHarmonyOS?n=r:(n=aw.getLinuxHTML5DebPath(),i=aw.getLinuxHTML5RpmPath()),e){if(K.bAndroid)Et.isFunction(xt.OnWebTwainNeedUpgradeOnAndroidCallback)&&xt.OnWebTwainNeedUpgradeOnAndroidCallback(bw.name,r,bt.detect.ssl);else if(Et.isFunction(xt.OnWebTwainNeedUpgradeCallback)){var a={"default":n};K.bLinux&&(a.deb=n,a.rpm=i),xt.OnWebTwainNeedUpgradeCallback(bw.name,a,bw.bHTML5Edition,o,K.bIE,K.bSafari,bt.detect.ssl,Ax.strIEVersion)}}else K.bAndroid?Et.isFunction(xt.OnWebTwainNotFoundOnAndroidCallback)&&xt.OnWebTwainNotFoundOnAndroidCallback(bw.name,r,bt.detect.ssl,!1):Et.isFunction(xt.OnWebTwainNotFoundOnLinuxCallback)&&xt.OnWebTwainNotFoundOnLinuxCallback(bw.name,n,i,bw.bHTML5Edition,K.bIE,K.bSafari,bt.detect.ssl,Ax.strIEVersion,o,t)}else if(K.bChrome||K.bSafari||K.bFirefox||K.bOpera||xt.DWT.IfUseActiveXForIE10Plus==B||!xt.DWT.ActiveXInstallWithCAB&&K.bIE)if(e){if(Et.isFunction(xt.OnWebTwainNeedUpgradeCallback)){var s={"default":r};xt.OnWebTwainNeedUpgradeCallback(bw.name,s,bw.bHTML5Edition,OC.enumWindow,K.bIE,K.bSafari,bt.detect.ssl,Ax.strIEVersion)}}else Et.isFunction(xt.OnWebTwainNotFoundOnWindowsCallback)&&xt.OnWebTwainNotFoundOnWindowsCallback(bw.name,r,bw.bHTML5Edition,K.bIE,K.bSafari,bt.detect.ssl,Ax.strIEVersion,t)}function hK(e){return gK.apply(this,arguments)}function gK(){return gK=eA(g.mark((function e(t){var r,n,i,o,a,s,u,c,l,d,f;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.id,a=t.host,s=t.port,u=null===(r=t.Container)||void 0===r?void 0:r.id,c=window,!(n=xt.DWT.GetWebTwain(o))&&u&&(i=xt.DWT.GetWebTwain(u)),!n&&!i){e.next=8;break}throw l={},n?ME(l):BE(l),{code:l._errorCode,message:l._errorString};case 8:return xt.DWT.UseDefaultViewer||(t.container=null),((h=t.container)&&!Et.isString(h)?oC:iC)?t.bNoViewer=!1:t.bNoViewer=!0,e.prev=10,e.next=13,eK.create(t);case 13:d=e.sent,e.next=22;break;case 16:throw e.prev=16,e.t0=e["catch"](10),(f=e.t0&&e.t0.code)==yw.ResponseDataTypeError||f==yw.HTSTError||f==yw.CORSError||(f==yw.MustUpgrade?fK(!0,!1):f==yw.ModuleNotExists&&vK(a,s,d)),d&&d.dispose(),e.t0;case 22:return e.prev=22,c.DCP_DWT_OnClickCloseInstall&&c.DCP_DWT_OnClickCloseInstall(!1,!0),e.finish(22);case 25:return mK(d),e.abrupt("return",d);case 27:case"end":return e.stop()}var h}),e,null,[[10,16,22,25]])}))),gK.apply(this,arguments)}function pK(e,t){if(Et.isFunction(xt.OnWebTwainNeedUpgradeCallback)){var r,n,i={};if(n=aw.getDSPath(),K.bWin)r=OC.enumWindow;else if(xt.navInfo.bEmbed||K.bAndroid||K.bChromeOS||K.bHarmonyOS||K.biPhone||K.biPad)K.bAndroid?r=OC.enumAndroid:(i.deb=n,r=K.biPhone||K.biPad?OC.enumiOS:K.bChromeOS?OC.enumChromeOS:K.bHarmonyOS?OC.enumHarmonyOS:OC.enumEmbed);else if(K.bLinux){var o=aw.getLinuxHTML5DebPath(),a=aw.getLinuxHTML5RpmPath();n=o,i.deb=o,i.rpm=a,r=OC.enumLinux}else r=OC.enumMac;i["default"]=n;var s=tC.one(".dynamsoft-dialog-license");s&&s.getEL()&&(s.getEL().style.display="none"),bt.detect.needUpgrade=oC,xt.OnWebTwainNeedUpgradeCallback(bw.name,i,bw.bHTML5Edition,r,K.bIE,K.bSafari,bt.detect.ssl,Ax.strIEVersion,bt.detect.bPromptJSOrServerOutdated,e,t)}}function mK(e){return _K.apply(this,arguments)}function _K(){return _K=eA(g.mark((function e(t){var r,n,i;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&!t._blts){e.next=2;break}return e.abrupt("return");case 2:if(-2207==t.ErrorCode&&(bt.detect.bPromptJSOrServerOutdated=oC,Et.isFunction(xt.DWT.OnWebTwainNeedUpgradeWebJavascript)&&xt.DWT.OnWebTwainNeedUpgradeWebJavascript(t.ErrorString)),!Cw.versionInfoFromServer){e.next=7;break}r=Cw.versionInfoFromServer,e.next=10;break;case 7:return e.next=9,t._getVersionInfoAsync();case 9:r=e.sent;case 10:if(bt.detect.bNeedUpgradeEvent||JD(r)){e.next=19;break}if(bt.detect.bNeedUpgradeEvent=oC,!Et.isFunction(xt.DWT.OnWebTwainNeedUpgrade)){e.next=15;break}if(!xt.DWT.OnWebTwainNeedUpgrade()){e.next=15;break}return e.abrupt("return");case 15:if(!t._bRemoteMode){e.next=18;break}return Et.isFunction(xt.OnRemoteWebTwainNeedUpgradeCallback)&&(n=t._serverInfo.port,xt.OnRemoteWebTwainNeedUpgradeCallback(bw.name,t._serverInfo.server,n,t._serverInfo.ssl)),e.abrupt("return");case 18:(bw.bHTML5Edition&&t._isBindViewer()||!bw.bHTML5Edition)&&((i=t._containerElement)&&(tC.one(i).before(bt.install._strNonInstallDIV),Et.show(bt.install._divDWTNonInstallContainerID)),""!=bt.install._divDWTemessageContainer&&Et.hide(bt.install._divDWTemessageContainer),pK());case 19:case"end":return e.stop()}}),e)}))),_K.apply(this,arguments)}function vK(e,t,r){if(!bt.detect.bNoControlEvent){var n,i=0,o=0;r&&(i=r._width,o=r._height,n=r._containerElement),r&&r._bRemoteMode?r._bNotShowMessage||Et.isFunction(xt.OnRemoteWebTwainNotFoundCallback)&&xt.OnRemoteWebTwainNotFoundCallback(bw.name,r._serverInfo.server,r._serverInfo.port,r._serverInfo.ssl,Ax.bMobile):ZH(e,t).then((function(e){var t;if(cK(n,i,o),!e)throw NE(t={}),hA(t);fK(e.upgrade,e.socket)}),(function(e){vA(e)})),bt.detect.bNoControlEvent=!0}}function yK(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(VV){return!1}}();return function(){var r,n=cA(e);if(t){var i=cA(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return uA(this,r)}}bt.detect.onNoControl=function(e,t,r,n){n&&n._bRemoteMode&&!n._bNotShowMessage?Et.isFunction(xt.OnRemoteWebTwainNotFoundCallback)&&xt.OnRemoteWebTwainNotFoundCallback(bw.name,n._serverInfo.server,n._serverInfo.port,n._serverInfo.ssl,Ax.bMobile):(cK(e,t,r),fK(!1,!1))};var IK=function(e){sA(p,e);var r,n,o,a,s,u,c,l,d,f,h=yK(p);function p(e){var r;t(this,p),(r=h.call(this,e))._bServerPercentDone=!0,r._bScanForProxyRemote=oC;var n=eF.getServerImageUrlPrefix(oA(r));return nG._setBaseUrl(r._imageBufferWrapper,n),r}return i(p,[{key:"getDevices",value:function(e,t,r){return this._getDevices(e,t,r)}},{key:"_connnect",value:(f=eA(g.mark((function m(){var e;return g.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this,t.abrupt("return",new bt.Promise((function(t,r){var n,i;n=e._serverInfo.server,i=e._serverInfo.port,rz(n,i,{bRemoteServer:!0},(function(r,n,i){e._strRemoteServiceVer=i,t()}),r)})));case 2:case"end":return t.stop()}}),m,this)}))),function(){return f.apply(this,arguments)})},{key:"acquireImage",value:function(e,t){return xF(cA(p.prototype),"_acquireImage",this).call(this,e,t)}},{key:"_acquireImageForSendTo",value:function(e,t,r,n){return xF(cA(p.prototype),"_acquireImageForSendTo",this).call(this,e,t,r,n)}},{key:"getCapabilities",value:function(e,t){return this._getCapabilities(e,t)}},{key:"setCapabilities",value:function(e,t,r){return this._setCapabilities(e,t,r)}},{key:"closeSource",value:function(){return this._closeSource()}},{key:"setBufferMemoryLimit",value:(d=eA(g.mark((function _(e){var t,r;return g.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=this,Et.isNumber(e)&&!isNaN(e)){n.next=4;break}throw Fw(t),{code:t._errorCode,message:t._errorString};case 4:if(t._resetErr(),t._isValid()){n.next=7;break}throw{code:t._errorCode,message:t._errorString};case 7:return n.next=9,t._innerFunV2("BufferMemoryLimit",Rx(e));case 9:return r=n.sent,n.abrupt("return",r);case 11:case"end":return n.stop()}}),_,this)}))),function(e){return d.apply(this,arguments)})},{key:"setIfAllowLocalCache",value:(l=eA(g.mark((function v(e){var t,r;return g.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=this,Et.isBoolean(e)){n.next=4;break}throw Fw(self),{code:t._errorCode,message:t._errorString};case 4:if(t._resetErr(),t._isValid()){n.next=7;break}throw{code:t._errorCode,message:t._errorString};case 7:return n.next=9,t._innerFunV2("IfAllowLocalCache",Rx(e));case 9:return r=n.sent,n.abrupt("return",r);case 11:case"end":return n.stop()}}),v,this)}))),function(e){return l.apply(this,arguments)})},{key:"howManyImagesInBuffer",get:function(){return this._imageBufferWrapper.count()}},{key:"currentImageIndexInBuffer",get:function(){return this._imageBufferWrapper.getCurrentImageIndex()},set:function(e){this._imageBufferWrapper.setCurrentImageIndex(e)}},{key:"saveImages",value:(c=eA(g.mark((function y(e,t,r,n){var i;return g.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(i="saveImages",this._checkIndices(t)){o.next=3;break}throw{code:this._errorCode,message:this._getErrorString()};case 3:return this._containerElement=n,o.next=6,this._saveImages(i,e,t,r);case 6:case"end":return o.stop()}}),y,this)}))),function(e,t,r,n){return c.apply(this,arguments)})},{key:"getImages",value:function(e,t,r,n){if(!this._checkIndices(e))throw{code:this._errorCode,message:this._getErrorString()};return this._containerElement=n,this._getImages("getImages",e,t,r)}},{key:"removeImages",value:(u=eA(g.mark((function I(e){var t,r,n,i,o;return g.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(this._checkIndices(e)){a.next=2;break}throw{code:this._errorCode,message:this._getErrorString()};case 2:for(t=e.sort((function(e,t){return t-e})),r=[],n=0;n<t.length;n++)i=t[n],(o=this._imageBufferWrapper.convertClientIndexToServerId(i))>0&&r.push(o);if(0!=r.length){a.next=7;break}return a.abrupt("return");case 7:return a.next=9,this._innerFunV2("RemoveAllImages",Rx(r.join(",")));case 9:if(!a.sent&&-1033!=this._errorCode){a.next=16;break}if(this._imageBufferWrapper.removeImages(t)){a.next=14;break}throw this._imageBufferWrapper.getError();case 14:a.next=17;break;case 16:throw{code:this._errorCode,message:this._errorString};case 17:case"end":return a.stop()}}),I,this)}))),function(e){return u.apply(this,arguments)})},{key:"updateImage",value:function(e,t,r){var n=this._imageBufferWrapper.getIndexByUid(e),i=this._imageBufferWrapper.convertClientIndexToServerId(n);return xF(cA(p.prototype),"_updateImage",this).call(this,i,t,r)}},{key:"getSkewAngleFromBinaryAsync",value:function(e,t,r,n){var i=this;if(i._resetErr(),!i._isValid())return bt.Promise.reject({code:i._errorCode,message:i._errorString});var o=this._imageBufferWrapper.getMetadataByIndex(e),a={imageId:this._imageBufferWrapper.convertClientIndexToServerId(e),bufferLen:t.size,imageType:xD.IT_BMP,width:o.width,height:o.height,bit:o.bitDepth,xres:o.resolutionX,yres:o.resolutionY},s=Et.stringify([Et.stringify(a)]);return this._innerSendBlob("GetSkewAngleFromBinary",s,t,!0,!0,r,n)}},{key:"httpUpload",value:(s=eA(g.mark((function S(e,t,r,n,i,o,a){var s,u;return g.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if((s=this)._resetErr(),s._isValid()){c.next=4;break}throw{code:s._errorCode,message:s._errorString};case 4:if(!Et.isUndefined(e)&&""!==e){c.next=9;break}throw Qw(s),{code:s._errorCode,message:s._errorString};case 9:if(Et.isString(e)){c.next=12;break}throw cE(s),{code:s._errorCode,message:s._errorString};case 12:if(s._checkIndices(t)){c.next=14;break}throw{code:s._errorCode,message:s._errorString};case 14:if(u=[],Et.isArray(t)&&Et.each(t,(function(e){var t=s._imageBufferWrapper.convertClientIndexToServerId(e);-1!=t&&u.push(t)})),0!=u.length){c.next=19;break}throw Dw(s),{code:s._errorCode,message:s._errorString};case 19:if(!Et.isUndefined(r)){c.next=22;break}throw sE(s),{code:s._errorCode,message:s._errorString};case 22:if(r!=xt.DWT.EnumDWT_ImageType.IT_BMP&&r!=xt.DWT.EnumDWT_ImageType.IT_JPG&&r!=xt.DWT.EnumDWT_ImageType.IT_PNG){c.next=28;break}if(!(u.length>1)){c.next=26;break}throw tE(s),{code:s._errorCode,message:s._errorString};case 26:c.next=33;break;case 28:if(r!=xt.DWT.EnumDWT_ImageType.IT_TIF&&r!=xt.DWT.EnumDWT_ImageType.IT_PDF){c.next=31;break}c.next=33;break;case 31:throw sE(s),{code:s._errorCode,message:s._errorString};case 33:if(!(Et.isUndefined(n)||n!=xt.DWT.EnumDWT_UploadDataFormat.Binary&&n!=xt.DWT.EnumDWT_UploadDataFormat.Base64)){c.next=36;break}throw uE(s),{code:s._errorCode,message:s._errorString};case 36:return c.next=38,new bt.Promise((function(t,c){var l,d,f=parseInt(r),h=parseInt(n);null!=o&&o.formFields&&(l=new FormData,Et.each(null==o?void 0:o.formFields,(function(e,t){var r=e.name,n=e.value;Et.isString(r)&&(n instanceof Blob?l.append(r,n,e.fileName):l.append(r,n))}))),null!=o&&o.headers&&(d={},Et.each(null==o?void 0:o.headers,(function(e,t){Et.isString(e.name)&&(d[e.name]=e.value)}))),s._containerElement=a,p._innerHTTPUpload(s,"httpUpload",e,null==o?void 0:o.responseType,d,l,u,f,h,i,void 0,0,!1,void 0,(function(e){if(Et.isFunction(t)){var r=[];Et.isArray(u)&&Et.each(u,(function(e){var t=s._imageBufferWrapper.convertServerIdToClientIndex(e);t>-1&&r.push(t)}));try{AF(t,e,r)}catch(n){}}return e=null,!0}),(function(e){if(Et.isFunction(c))try{c(e)}catch(t){}return!1}))}));case 38:return c.abrupt("return",c.sent);case 39:case"end":return c.stop()}}),S,this)}))),function(e,t,r,n,i,o,a){return s.apply(this,arguments)})},{key:"getCustomDataByIndex",value:function(e){return this._imageBufferWrapper.getCustomDataByIndex(e)}},{key:"getIndexByUid",value:function(e){return this._imageBufferWrapper.getIndexByUid(e)}},{key:"getProfile",value:function(e){return xF(cA(p.prototype),"_getProfile",this).call(this,e)}},{key:"setProfile",value:function(e,t){return xF(cA(p.prototype),"_setProfile",this).call(this,e,t)}},{key:"imageIDToIndex",value:function(e){return this._imageIDToIndex(e)}},{key:"indexToImageID",value:function(e){return this._indexToImageID(e)}},{key:"rotate",value:function(e,t,r,n){var i=this;if(i._resetErr(),!i._isValid())return bt.Promise.reject({code:i._errorCode,message:i._errorString});var o=parseInt(e);if(isNaN(o))return Dw(i),bt.Promise.reject({code:i._errorCode,message:i._errorString});if(o<0||o>=i.howManyImagesInBuffer)return oE(i),bt.Promise.reject({code:i._errorCode,message:i._errorString});var a=i._imageBufferWrapper.convertClientIndexToServerId(o);return-1==a?(oE(i),bt.Promise.reject({code:i._errorCode,message:i._errorString})):i._innerFunV2("RotateEx",Rx(a,t,r,n),!0).then((function(e){}))}},{key:"crop",value:function(e,t){var r=this;if(r._resetErr(),!r._isValid())return bt.Promise.reject({code:r._errorCode,message:r._errorString});var n=parseInt(e);if(isNaN(n))return Dw(r),bt.Promise.reject({code:r._errorCode,message:r._errorString});if(n<0||n>=r.howManyImagesInBuffer)return oE(r),bt.Promise.reject({code:r._errorCode,message:r._errorString});var i=r._imageBufferWrapper.convertClientIndexToServerId(n);if(-1==i)return oE(r),bt.Promise.reject({code:r._errorCode,message:r._errorString});var o=t.x,a=t.y,s=t.x+t.width,u=t.y+t.height;return r._innerFunV2("Crop",Rx(i,o,a,s,u),!0).then((function(e){}))}},{key:"_createHttpUploaderConfig",value:function(){var e=this,t=new SG;return t.IfShowProgressBar=e.IfShowProgressBar,t.IfShowCancelDialogWhenImageTransfer=e.IfShowCancelDialogWhenImageTransfer,t.MaxUploadImageSize=e.MaxUploadImageSize,t.HTTPRequestswithCredentials=e.HTTPRequestswithCredentials,t.onPercent=function(t){e._OnPercentDone(t)},t.onHttpUploadStatus=function(e){},t}},{key:"_OnReady",value:(a=eA(g.mark((function T(){var e,t,r;return g.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return Aw((e=this)._serverInfo.server)&&(HD.item("DWT_port",e._serverInfo.port),HD.item("DWT_ssl",e._serverInfo.ssl?"true":"false")),e._bNoMask||zx("OnReady",e),n.prev=3,n.next=6,xF(cA(p.prototype),"_OnReady",this).call(this);case 6:return n.next=8,e._innerActiveUI(e._uuidForActiveUI);case 8:return t=n.sent,n.next=11,e._OnActiveUI(t);case 11:(r=e._id)&&!xt.DWT.WebTwainIdMap[r]&&(xt.DWT.WebTwainIdMap[r]=e),n.next=20;break;case 15:throw n.prev=15,n.t0=n["catch"](3),n.t0&&(e._errorCode=n.t0.code,e._errorString=n.t0.message),e.dispose(),n.t0;case 20:return n.prev=20,e._bNoMask||Kx("OnReady"),n.finish(20);case 23:case"end":return n.stop()}}),T,this,[[3,15,20,23]])}))),function(){return a.apply(this,arguments)})},{key:"_isBindViewer",value:function(){return this._bBindViewer}},{key:"_isNoViewer",value:function(){return!this._isBindViewer()}},{key:"getServiceInfo",value:function(){return xF(cA(p.prototype),"getServiceInfo",this).call(this)}},{key:"setViewerInfo",value:function(e){this._bBindViewer=e}},{key:"setViewerControlInfo",value:function(e){this._controlWidth=e.width,this._controlHeight=e.height}}],[{key:"create",value:(o=eA(g.mark((function b(e){var t;return g.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=new p(e),r.next=3,eF.STwainConnectToServer(t);case 3:return r.abrupt("return",t);case 4:case"end":return r.stop()}}),b)}))),function(e){return o.apply(this,arguments)})},{key:"_getBuffer",value:function(e){return nG._getBuffer(e._imageBufferWrapper)}},{key:"_setError",value:function(e,t,r){e._errorCode=t,e._errorString=r}},{key:"createByServiceInfo",value:(n=eA(g.mark((function C(e,t,r){var n,i,o;return g.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return i={id:Et.guid(),dmService:t,bNoViewer:!0,bNoMask:null==t||null===(n=t.attrs)||void 0===n?void 0:n.bNoMask,bNotShowMessage:!0},(o=new p(i))._uuidForActiveUI=e,o._bLicenseErrorDispose=!1,r&&(o._containerElement=r),a.next=7,o._connnect();case 7:return a.next=9,eF.STwainConnectToServer(o);case 9:return a.abrupt("return",o);case 10:case"end":return a.stop()}}),C)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"checkOnlineByServiceInfo",value:(r=eA(g.mark((function w(e){var t,r;return g.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t={id:Et.guid(),dmService:e,bNoViewer:!0,bNoMask:!0,bNotShowMessage:!0},n.prev=1,r=new p(t),n.next=5,r._connnect();case 5:return r._bReady=!0,r._wsClient||(r._wsClient=new JA(null)),r.dispose(),n.abrupt("return",!0);case 11:return n.prev=11,n.t0=n["catch"](1),Et.warn(n.t0),n.abrupt("return",!1);case 15:case"end":return n.stop()}}),w,null,[[1,11]])}))),function(e){return r.apply(this,arguments)})},{key:"_isReady",value:function(e){return e._bReady}},{key:"_innerHTTPUpload",value:function(e,t,r,n,i,o,a,s,u,c,l,d,f,h,g,p){var m=c,_=r,v=!1;if(Et.isUndefined(s))return sE(e),Et.isFunction(p)&&p({code:e._errorCode,message:e._errorString}),!1;bt.cancelFrom=aG.HTTPUpload;var y,I=function(r,n,i){return bt.needShowTwiceShowDialog=!1,e.IfShowProgressBar&&bt.closeProgress(null,t),Et.isFunction(p)&&p({code:r,message:n,response:i}),!1},S=e._createHttpUploaderConfig();if(S.objUploadStatus=h,m=gG(m,s),bt.needShowTwiceShowDialog=!0,e.IfShowProgressBar?(bt.showProgress(e,t,!1),bt.progressContext&&(bt.progressContext._onPercent=function(e){var t=0;if(e){var r,n;r=e.loaded,n=e.total,(t=Math.floor(r/n*100))>100&&(t=100)}bt.progressBarOnPercentDone(-1,"Transferring...","",t,"")})):bt.hideProgress(),u==xt.DWT.EnumDWT_UploadDataFormat.Binary){if(h&&h.bCancel)return h.st=2,kE(e),I(e._errorCode,e._errorString);S.onPercent([0,-1,fx.Encoding,"http"]),e._convertToBlobForUpload(s,a,l,4,(function(r,a,s){if(y=function(r){return bt.needShowTwiceShowDialog=!1,e.IfShowProgressBar&&bt.closeProgress(null,t),Et.isFunction(g)&&AF(g,r),r=null,!0},h&&h.bCancel)return h.st=2,kE(e),I(e._errorCode,e._errorString);if(!r||r.size<=0)return zw(e),I(e._errorCode,e._errorString);var u=e.__maxUploadImageSize;if(r.size>u&&-1!=u)return Jw(e),I(e._errorCode,e._errorString);if(0!=e._errorCode)return I(e._errorCode,e._errorString);xt.DWT.IfAddMD5InUploadHeader&&a&&""!=a&&(i["dwt-md5"]=a);var c=new yG,l=new IG;l.url=_,l.method=t,l.content=r,r=null,l.contentType=e._strHttpContentTypeFieldValue,l.headers=i,l.fileName=m,l.httpFormData=o,l.retry=d,l.bOnlyResponseEmptyIsOK=f,l.responseType=n,S.objUploadStatus=h,v=c.httpPostUpload(S,l,y,I)}),I),v=!0}else if(u==xt.DWT.EnumDWT_UploadDataFormat.Base64){e._convertToBase64ByServerIdsWithUI(t,a,s,l,4,(function(r){var a,s;if(!r||r.getLength()<=0)return zw(e),I(e._errorCode,e._errorString);if(y=function(r){return bt.needShowTwiceShowDialog=!1,e.IfShowProgressBar&&bt.closeProgress(null,t),Et.isFunction(g)&&AF(g,r),!0},a=r.getMD5(),xt.DWT.IfAddMD5InUploadHeader&&(i["dwt-md5"]=a),!(s=r.getData(0,r.getLength()))||""==s)return zw(e),I(e._errorCode,e._errorString);var u=new IG;u.url=_,u.method=t,u.content=s,s=null,u.headers=i,u.fileName=m,u.httpFormData=o,u.retry=d,u.bOnlyResponseEmptyIsOK=f,u.responseType=n,(new yG).httpPostUpload(S,u,y,I)}),I)}return v}}]),p}(kG),SK=kx,TK=function(){function e(r){var n=this;if(t(this,e),this._serverUrl=r,this._defaultDSScanClient=null,this._dsScanClientsMap={},this._serviceInfos=null,this._id=Et.guid(),this.onBufferChanged=null,this.onPostTransferAsync=null,this._errorCode=0,this._errorString="",this._bDispose=!1,this._needSetLogLevel=!1,this._logLevel=-1,this._showProgressBar=!0,this._checkServerUrl(),this._id&&!xt.DWT.RemoteScanIdMap[this._id]&&(xt.DWT.RemoteScanIdMap[this._id]=this),this._uuidForRemoteScanObject="",bt.dlgProgress||bt.initProgress(null),xt.DWT.UseDefaultViewer){var i={viewerEvents:{bufferChanged:function(e,t){n.__bufferChanged(n,e,t)},save:function(e,t,r,i){return n.__save(e,t,r,i)},rotate:function(e,t,r){return n.__rotate(e,t,r)},crop:function(e,t,r,i,o){return n.__crop(e,{x:t,y:r,width:i,height:o})}},viewerError:{setError:function(e,t){n._defaultDSScanClient?IK._setError(n._defaultDSScanClient,e,t):0==e&&""==t||(n._errorCode=e,n._errorString=t)}},imageEditorEvents:{deskew:function(e,t){n.__deskew(n,e,t)},removeImage:function(){n.__remove(n)},removeAllImage:function(){n.__removeAll(n)},close:function(){n.__close(n)}},imageEditorUiConfig:{buttons:{visibility:{scan:!1,load:!1}}}};this._viewer=new xt.DWTViewerEx(null,i)}else this._viewer=null}var r,n,o,a,s,u,c,l,d,f,h,p,m,_,v,y,I,S,T,b,C,w;return i(e,[{key:"Viewer",get:function(){return this._viewer}},{key:"_disposeDSClientByKey",value:function(e){var t=this._dsScanClientsMap[e];t&&(t.isDestroy||t.dispose(),delete this._dsScanClientsMap[e])}},{key:"_checkServerUrl",value:function(){var e=this._serverUrl;if(e&&Et.isString(e)&&Et.startsWith(location.href,"https://")&&Et.startsWith(e,"http://")){var t={};throw function(e,t,r){kw(e,-2436,'Mixed Content: The page at "'+t+'" was loaded over HTTPS, but requested an insecure resource "'+r+'/ddm/18625/ddm/SearchScanner". This request has been blocked; the content must be served over HTTPS.')}(t,location.href,e),hA(t)}if(!Et.isString(e)||""==e){var r={};throw kw(r,-2545,"The  proxy server URL is invalid."),hA(r)}}},{key:"getDynamsoftService",value:(w=eA(g.mark((function E(e){var t,r,n,i,o,a,s,u,c,l,d,f,h,p,m,_,v,y,I;return g.wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(!this._bDispose){g.next=4;break}throw DE(t={}),hA(t);case 4:if(r=this._serverUrl,this._checkServerUrl(),n=new Fz(r,!0),zx("getDynamsoftService",this.getViewerElement()),g.prev=8,!e&&this._serviceInfos){g.next=68;break}if(i=null,o=this._serviceInfos,this._serviceInfos=[],a="",s="",!Ew()){g.next=30;break}return g.next=16,this._setRemoteUuid();case 16:return g.prev=16,g.next=19,dD(xt.DWT.EnumInstance.dwt_desktop,"");case 19:(u=g.sent)&&(a=u.ar,s=this._uuidForRemoteScanObject),g.next=28;break;case 23:throw g.prev=23,g.t0=g["catch"](16),cF(c={},g.t0),{code:c._errorCode,message:c._errorString};case 28:g.next=31;break;case 30:a=bw.refProductKey;case 31:return g.next=33,n.getDynamsoftService(a,s,e);case 33:if(!(i=g.sent)){g.next=68;break}d=[],l=0;case 37:if(!(l<i.length)){g.next=65;break}return p=bD(i[l]),m=null!==(f=null==p||null===(h=p.attrs)||void 0===h?void 0:h.ty)&&void 0!==f?f:"",g.next=42,IK.checkOnlineByServiceInfo(p);case 42:if(!g.sent){g.next=60;break}if(p.attrs=p.attrs||{},p.attrs.bNoMask=!0,p.attrs.bNotShowMessage=!0,!o){g.next=57;break}_=void 0,_=0;case 50:if(!(_<o.length)){g.next=57;break}if(!this.isSameService(p,o[_])){g.next=54;break}return o.splice(_,1),g.abrupt("break",57);case 54:_++,g.next=50;break;case 57:this._serviceInfos.push(p),g.next=61;break;case 60:m+="(x)";case 61:d.push(m);case 62:l++,g.next=37;break;case 65:if(Et.log("Find Dynamsoft Services:"),Et.log(d.join(", ")),o)for(v=0;v<o.length;v++)(I=null===(y=o[v])||void 0===y||null===(y=y.attrs)||void 0===y?void 0:y.UUID)&&this._disposeDSClientByKey(I);case 68:this._needSetLogLevel&&-1!=this._logLevel&&this.setLogLevel(this._logLevel),g.next=74;break;case 71:throw g.prev=71,g.t1=g["catch"](8),g.t1;case 74:g.prev=74,Kx("getDynamsoftService");try{n._bInited&&n.dispose()}catch(S){}return g.finish(74);case 78:return g.abrupt("return",this._serviceInfos);case 79:case"end":return g.stop()}}),E,this,[[8,71,74,78],[16,23]])}))),function(e){return w.apply(this,arguments)})},{key:"getDefaultDynamsoftService",value:function(){if(this._bDispose){var e={};throw DE(e),hA(e)}return this._defaultDSScanClient?this._defaultDSScanClient.getServiceInfo():null}},{key:"setDefaultDynamsoftService",value:(C=eA(g.mark((function A(e){var t,r,n,i;return g.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(!this._bDispose){o.next=4;break}throw DE(t={}),hA(t);case 4:if(null!==e){o.next=7;break}return this._defaultDSScanClient=null,o.abrupt("return");case 7:if(e&&e instanceof TD){o.next=11;break}throw gE(r={}),{code:r._errorCode,message:r._errorString};case 11:return n=this.getViewerElement(),o.next=14,this._createDSClientByServiceInfo(e,!0,n._containerElement);case 14:if(!(i=o.sent)){o.next=18;break}return o.next=18,this._innerSetDefault(i);case 18:case"end":return o.stop()}}),A,this)}))),function(e){return C.apply(this,arguments)})},{key:"_innerSetDefault",value:(b=eA(g.mark((function k(e){var t,r,n;return g.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!e){i.next=11;break}if(IK._isReady(e)){i.next=5;break}throw n=null!==(t=null===(r=e.getServiceInfo())||void 0===r||null===(r=r.attrs)||void 0===r?void 0:r.name)&&void 0!==t?t:"",AE(e,n),{code:e._getErrorCode(),message:e._getErrorString()};case 5:this._defaultDSScanClient=e,this._defaultDSScanClient.IfShowProgressBar=this._showProgressBar,this.Viewer&&this.Viewer.webViewer&&this.Viewer.webViewer.bindViewUI&&this._defaultDSScanClient.setViewerInfo(this.Viewer.webViewer.bindViewUI),this.__setViewerControlInfo(),this._registEventToDefaultDS(),this._viewer&&this._viewer.webViewer.setBufferService(IK._getBuffer(this._defaultDSScanClient));case 11:case"end":return i.stop()}}),k,this)}))),function(e){return b.apply(this,arguments)})},{key:"__setViewerControlInfo",value:function(){this.Viewer.webViewer.bindViewUI&&this.Viewer.width&&this.Viewer.width>0&&this.Viewer.height&&this.Viewer.height>0&&this._defaultDSScanClient.setViewerControlInfo({width:this.Viewer.width,height:this.Viewer.height})}},{key:"__bufferChanged",value:function(e,t,r){var n,i=e,o=[],a=-1,s=[];t.operation&&(t.action=t.operation);for(var u=0;u<i.howManyImagesInBuffer;u++)(n=i._defaultDSScanClient.getCustomDataByIndex(u))&&n.imageId&&o.push(bG(n.imageId));if(t.imageIds=o,t.curIndex>=0&&(n=i._defaultDSScanClient.getCustomDataByIndex(t.curIndex))&&n.imageId&&(a=bG(n.imageId)),t.currentId=a,t.afterStatus.selectedUids)for(var c=0;c<t.afterStatus.selectedUids.length;c++){if(t.afterStatus.selectedUids[c]){var l=i._defaultDSScanClient.getIndexByUid(t.afterStatus.selectedUids[c]);l>=0&&(n=i._defaultDSScanClient.getCustomDataByIndex(l))&&n.imageId&&s.push(bG(n.imageId))}}t.selectedIds=s,Et.mix(t,{}),delete t.uids,delete t.currentUid,delete t.selectedUids,delete t.afterStatus,delete t.beforeStatus,delete t.operation,delete t.curIndex,delete t.docUid,i.__fireEvent("onBufferChanged",t)}},{key:"__acquire",value:function(e,t){var r=e;r._stwain.SelectSource((function(){r._stwain.CloseSource(),r._stwain.OpenSource(),r._stwain.IfShowUI=!0,1==xt.DWT.IfConfineMaskWithinTheViewer?(xt.DWT.IfConfineMaskWithinTheViewer=!1,r._stwain.AcquireImage({},(function(){xt.DWT.IfConfineMaskWithinTheViewer=!0}),(function(){}))):r._stwain.AcquireImage()}),(function(){Et.log("User did not select a source")}))}},{key:"__remove",value:(T=eA(g.mark((function P(e){var t,r;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this,!this._defaultDSScanClient){e.next=10;break}if(TE(this._defaultDSScanClient),!(t.howManyImagesInBuffer<=0||t.currentImageIndexInBuffer<0)){e.next=6;break}return SK.output(t,"No image in Buffer"),e.abrupt("return",!0);case 6:return r=IK._getBuffer(this._defaultDSScanClient),e.next=9,this._defaultDSScanClient.removeImages(r.getSelectedImagesIndices());case 9:return e.abrupt("return",e.sent);case 10:return e.abrupt("return",!1);case 11:case"end":return e.stop()}}),P,this)}))),function(e){return T.apply(this,arguments)})},{key:"__removeAll",value:(S=eA(g.mark((function x(e){return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._defaultDSScanClient){e.next=4;break}return TE(this._defaultDSScanClient),e.next=4,this._defaultDSScanClient._removeAllImagesAsync("removeAllImages",!0);case 4:return e.abrupt("return",!1);case 5:case"end":return e.stop()}}),x,this)}))),function(e){return S.apply(this,arguments)})},{key:"__save",value:(I=eA(g.mark((function D(e,t,r,n){var i,o,a;return g.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(o="save",a=(i=this).__getViewerElementForViewer(i,n),zx(o,a),s.prev=3,TE(i._defaultDSScanClient),!(i.howManyImagesInBuffer<=0||i.currentImageIndexInBuffer<0)){s.next=8;break}return SK.output(i,"No image in Buffer"),s.abrupt("return");case 8:return s.next=10,i._defaultDSScanClient.updateImage(e,t,r);case 10:return s.sent,s.next=13,i._defaultDSScanClient.__saveToViewerAfterUpdate(e,r);case 13:s.next=17;break;case 15:s.prev=15,s.t0=s["catch"](3);case 17:return s.prev=17,Kx(o),s.finish(17);case 20:case"end":return s.stop()}}),D,this,[[3,15,17,20]])}))),function(e,t,r,n){return I.apply(this,arguments)})},{key:"__getViewerElementForViewer",value:function(e,t){var r,n=e;if(t)if(n._viewer.webViewer.imageEditor){var i=n._viewer.createImageEditor();r="dwt-viewer-imageEditor-fullScreen"==i.inner.containerElement.className?{_containerElement:document.body}:{_containerElement:i.inner.containerElement}}else r=n.getViewerElement();else r=n.getViewerElement();return r}},{key:"__close",value:function(e){var t=e;if(Et.isFunction(t.__CloseImageEditorUI))try{t.__CloseImageEditorUI()}catch(r){vA(r)}}},{key:"__deskew",value:function(e,t,r){var n=this,i="deskew";if(TE(n._defaultDSScanClient),n.howManyImagesInBuffer<=0||n.currentImageIndexInBuffer<0)SK.output(n,"No image in Buffer");else{var o=n.__getViewerElementForViewer(n,!0);zx(i,o);n._defaultDSScanClient.getSkewAngleFromBinaryAsync(n.currentImageIndexInBuffer,t,(function(e){r(e[0]),Kx(i)}),(function(){Kx(i)}))}}},{key:"__rotate",value:(y=eA(g.mark((function F(e,t,r){var n;return g.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return TE(this._defaultDSScanClient),i.next=4,this._makeSureDefaultServiceInfo();case 4:if(this._defaultDSScanClient){i.next=6;break}throw{code:-2825,message:"Failed to setup the Default Dynamsoft Service."};case 6:return i.next=8,this._defaultDSScanClient.rotate(e,t,r,-1);case 8:return n=i.sent,i.abrupt("return",n);case 10:case"end":return i.stop()}}),F,this)}))),function(e,t,r){return y.apply(this,arguments)})},{key:"__crop",value:(v=eA(g.mark((function W(e,t){var r;return g.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return TE(this._defaultDSScanClient),n.next=4,this._makeSureDefaultServiceInfo();case 4:if(this._defaultDSScanClient){n.next=6;break}throw{code:-2825,message:"Failed to setup the Default Dynamsoft Service."};case 6:return n.next=8,this._defaultDSScanClient.crop(e,t);case 8:return r=n.sent,n.abrupt("return",r);case 10:case"end":return n.stop()}}),W,this)}))),function(e,t){return v.apply(this,arguments)})},{key:"__fireEvent",value:function(e,t){return!Et.isFunction(this[e])||this[e](t)}},{key:"getDevices",value:(_=eA(g.mark((function R(e){var t,r,n,i,o,a,s,u,c,l,d,f,h,p,m,_,v,y,I,S,T,b,C;return g.wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(!this._bDispose){g.next=4;break}throw DE(r={}),hA(r);case 4:if(n=[],i="getDevices",o=this.getViewerElement(),a=!1,u=null==e?void 0:e.serviceInfo,c=null!==(t=null==e?void 0:e.deviceType)&&void 0!==t?t:Mx,zx(i,o),g.prev=6,d=!1,f=[],this._serviceInfos){g.next=12;break}return g.next=12,this.getDynamsoftService();case 12:if(!u){g.next=25;break}return g.next=15,this._createDSClientByServiceInfo(u,!0);case 15:if(!(p=g.sent)){g.next=21;break}f.push(p),d=!1,g.next=23;break;case 21:throw GE(null==u||null===(m=u.attrs)||void 0===m?void 0:m.ty);case 23:g.next=37;break;case 25:if(!this._serviceInfos){g.next=37;break}h=0;case 27:if(!(h<this._serviceInfos.length)){g.next=36;break}return _=this._serviceInfos[h],g.next=31,this._createDSClientByServiceInfo(_);case 31:(v=g.sent)&&f.push(v);case 33:h++,g.next=27;break;case 36:d=!0;case 37:h=0;case 38:if(!(h<f.length)){g.next=60;break}return y=void 0,g.prev=40,g.next=43,f[h].getDevices(c,null==e?void 0:e.refresh,a);case 43:if(y=g.sent,Et.isArray(y)&&y.length>0)for(s=0;s<y.length;s++)n.push(y[s]);g.next=52;break;case 47:if(g.prev=47,g.t0=g["catch"](40),!a){g.next=51;break}throw g.t0;case 51:l=g.t0;case 52:return g.prev=52,I=null,this._defaultDSScanClient&&(I=null===(S=this._defaultDSScanClient.getServiceInfo())||void 0===S||null===(S=S.attrs)||void 0===S?void 0:S.UUID,this._defaultDSScanClient.isDestroy&&(this._disposeDSClientByKey(I),this._defaultDSScanClient=null,I=null)),d&&(b=f[h].getServiceInfo(),(C=null==b||null===(T=b.attrs)||void 0===T?void 0:T.UUID)&&C!=I&&this._disposeDSClientByKey(C)),g.finish(52);case 57:h++,g.next=38;break;case 60:g.next=65;break;case 62:throw g.prev=62,g.t1=g["catch"](6),g.t1;case 65:return g.prev=65,Kx(i),l&&xt.DWT.lsetException(l.code,l.message),g.finish(65);case 69:return g.abrupt("return",n);case 70:case"end":return g.stop()}}),R,this,[[6,62,65,69],[40,47,52,57]])}))),function(e){return _.apply(this,arguments)})},{key:"acquireImage",value:(m=eA(g.mark((function N(e,t){var r,n,i,o,a,s,u,c,l,d,f,h,p,m;return g.wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(!(r=this)._bDispose){g.next=5;break}throw DE(n={}),hA(n);case 5:if(e&&e instanceof FD){g.next=9;break}throw gE(i={}),{code:i._errorCode,message:i._errorString};case 9:return a="acquireImage",s=r.getViewerElement(),u=[],zx(a,s),g.prev=12,Et.isUndefined(t)&&(t={}),Et.isUndefined(t.IfShowUI)&&(t.IfShowUI=!1),Et.isUndefined(t.IfCloseSourceAfterAcquire)&&(t.IfCloseSourceAfterAcquire=!0),c=e.serviceInfo,g.next=19,this._createDSClientByServiceInfo(c,!0);case 19:if(!(o=g.sent)){g.next=47;break}if(r._defaultDSScanClient){g.next=24;break}return g.next=24,r._innerSetDefault(o);case 24:u.push(o),o!=r._defaultDSScanClient&&u.push(r._defaultDSScanClient),l=0;case 27:if(!(l<u.length)){g.next=36;break}if(d=u[l],IK._isReady(d)){g.next=33;break}throw p=null!==(f=null===(h=d.getServiceInfo())||void 0===h||null===(h=h.attrs)||void 0===h?void 0:h.name)&&void 0!==f?f:"",AE(d,p),{code:d._getErrorCode(),message:d._getErrorString()};case 33:l++,g.next=27;break;case 36:if(r.onPostTransferAsync?o.registerEvent("OnPostTransferAsync",r.onPostTransferAsync):o.unregisterEvent("OnPostTransferAsync"),this.__setViewerControlInfo(),o!=r._defaultDSScanClient){g.next=43;break}return g.next=41,o.acquireImage(e,t);case 41:g.next=45;break;case 43:return g.next=45,o._acquireImageForSendTo(a,e,t,r._defaultDSScanClient);case 45:g.next=49;break;case 47:throw bE(null==c||null===(m=c.attrs)||void 0===m?void 0:m.name);case 49:g.next=54;break;case 51:throw g.prev=51,g.t0=g["catch"](12),g.t0;case 54:return g.prev=54,o&&o.__closeRemoteScanUI(!0),Kx(a),g.finish(54);case 58:case"end":return g.stop()}}),N,this,[[12,51,54,58]])}))),function(e,t){return m.apply(this,arguments)})},{key:"_waitForDSValid",value:function(e,t){for(var r=0,n=e.length,i=this;r<n;r++)if(!IK._isReady(e[r]))return void setTimeout((function(){i._waitForDSValid(e,t)}),Cw.RemoteReconnectTimeSpan);Et.isFunction(i[t.command])&&i[t.command].apply(i,t.parmas)}},{key:"getCapabilities",value:(p=eA(g.mark((function O(e){var t,r,n,i,o,a,s;return g.wrap((function(u){for(;;)switch(u.prev=u.next){case 0:if(!this._bDispose){u.next=4;break}throw DE(t={}),hA(t);case 4:if(e&&e instanceof FD){u.next=8;break}throw gE(r={}),hA(r);case 8:return i="getCapabilities",o=[],a=this.getViewerElement(),zx(i,a),u.prev=10,s=e.serviceInfo,u.next=14,this._createDSClientByServiceInfo(s,!0);case 14:if(n=u.sent,!(n=this._findDSClientByServiceInfo(s))){u.next=20;break}return u.next=19,n.getCapabilities(e);case 19:o=u.sent;case 20:u.next=25;break;case 22:throw u.prev=22,u.t0=u["catch"](10),u.t0;case 25:return u.prev=25,n&&n.__closeRemoteScanUI(!0),Kx(i),u.finish(25);case 29:return u.abrupt("return",o);case 30:case"end":return u.stop()}}),O,this,[[10,22,25,29]])}))),function(e){return p.apply(this,arguments)})},{key:"setCapabilities",value:(h=eA(g.mark((function M(e,t){var r,n,i,o,a,s;return g.wrap((function(u){for(;;)switch(u.prev=u.next){case 0:if(!this._bDispose){u.next=4;break}throw DE(r={}),hA(r);case 4:if(e&&e instanceof FD){u.next=8;break}throw gE(n={}),hA(n);case 8:return o="setCapabilities",a=this.getViewerElement(),zx(o,a),u.prev=10,s=e.serviceInfo,u.next=14,this._createDSClientByServiceInfo(s,!0);case 14:if(!(i=u.sent)){u.next=18;break}return u.next=18,i.setCapabilities(e,t);case 18:u.next=23;break;case 20:throw u.prev=20,u.t0=u["catch"](10),u.t0;case 23:return u.prev=23,i&&i.__closeRemoteScanUI(!0),Kx(o),u.finish(23);case 27:case"end":return u.stop()}}),M,this,[[10,20,23,27]])}))),function(e,t){return h.apply(this,arguments)})},{key:"closeSource",value:(f=eA(g.mark((function L(e){var t,r,n,i,o,a;return g.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(!this._bDispose){s.next=4;break}throw DE(t={}),hA(t);case 4:if(e&&e instanceof FD){s.next=8;break}throw gE(r={}),hA(r);case 8:return n="closeSource",i=this.getViewerElement(),zx(n,i),s.prev=10,o=e.serviceInfo,a=this._findDSClientByServiceInfo(o),s.next=15,a.closeSource();case 15:s.next=20;break;case 17:throw s.prev=17,s.t0=s["catch"](10),s.t0;case 20:return s.prev=20,Kx(n),s.finish(20);case 23:case"end":return s.stop()}}),L,this,[[10,17,20,23]])}))),function(e){return f.apply(this,arguments)})},{key:"_putDSClientToMap",value:function(e,t){var r,n=null==e||null===(r=e.attrs)||void 0===r?void 0:r.UUID;n&&(this._dsScanClientsMap[n]=t)}},{key:"_getDSClientFromMap",value:function(e){var t,r=null==e||null===(t=e.attrs)||void 0===t?void 0:t.UUID;return r?this._dsScanClientsMap[r]:null}},{key:"_createDSClientByServiceInfo",value:(d=eA(g.mark((function B(e,t,r){var n,i,o,a;return g.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(this._serviceInfos){s.next=3;break}return s.next=3,this.getDynamsoftService();case 3:if(n=this._findDSClientByServiceInfo(e)){s.next=20;break}return s.next=7,this._setRemoteUuid();case 7:return s.prev=7,s.next=10,IK.createByServiceInfo(this._uuidForRemoteScanObject,e,r);case 10:(n=s.sent)&&this._putDSClientToMap(e,n),s.next=20;break;case 14:if(s.prev=14,s.t0=s["catch"](7),s.t0.code==yw.MustUpgrade&&(o=null==e||null===(i=e.attrs)||void 0===i?void 0:i.ty)&&(Ow(a={},o),s.t0.message=a._errorString),!t){s.next=19;break}throw s.t0;case 19:Et.warn(s.t0);case 20:return s.abrupt("return",n);case 21:case"end":return s.stop()}}),B,this,[[7,14]])}))),function(e,t,r){return d.apply(this,arguments)})},{key:"_makeSureDefaultServiceInfo",value:(l=eA(g.mark((function U(){var e;return g.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._serviceInfos){t.next=3;break}return t.next=3,this.getDynamsoftService();case 3:if(!(this._serviceInfos&&this._serviceInfos.length>0)){t.next=8;break}return e=this._serviceInfos[0],t.next=7,this._createDSClientByServiceInfo(e);case 7:return t.abrupt("return",t.sent);case 8:return t.abrupt("return",null);case 9:case"end":return t.stop()}}),U,this)}))),function(){return l.apply(this,arguments)})},{key:"httpUpload",value:(c=eA(g.mark((function V(e,t,r,n,i,o){var a,s,u,c;return g.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:if(!this._bDispose){l.next=4;break}return DE(a={}),l.abrupt("return",bt.Promise.reject(hA(a)));case 4:return u=this.getViewerElement(),c=u._containerElement,l.next=7,this._makeSureDefaultServiceInfo();case 7:if(this._defaultDSScanClient){l.next=9;break}throw{code:-2825,message:"Failed to setup the Default Dynamsoft Service."};case 9:return l.next=11,this._defaultDSScanClient.httpUpload(e,t,r,n,i,o,c);case 11:return s=l.sent,l.abrupt("return",s);case 13:case"end":return l.stop()}}),V,this)}))),function(e,t,r,n,i,o){return c.apply(this,arguments)})},{key:"runCommand",value:function(e){return this._defaultDSScanClient.RunCommandAsync(e)}},{key:"removeImages",value:(u=eA(g.mark((function G(e){var t,r,n,i,o;return g.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!this._bDispose){a.next=4;break}return DE(t={}),a.abrupt("return",bt.Promise.reject(hA(t)));case 4:return r="removeImages",i=this.getViewerElement(),zx(r,i),a.prev=6,a.next=9,this._makeSureDefaultServiceInfo();case 9:if(this._defaultDSScanClient){a.next=11;break}throw{code:-2825,message:"Failed to setup the Default Dynamsoft Service."};case 11:if(!this._defaultDSScanClient){a.next=17;break}return a.next=14,this._defaultDSScanClient.removeImages(e);case 14:n=a.sent,a.next=21;break;case 17:if(0!=this.howManyImagesInBuffer){a.next=21;break}if(o={},this._checkIndices(e,o)){a.next=21;break}throw{code:o._errorCode,message:o._errorString};case 21:a.next=26;break;case 23:throw a.prev=23,a.t0=a["catch"](6),a.t0;case 26:return a.prev=26,Kx(r),a.finish(26);case 29:return a.abrupt("return",n);case 30:case"end":return a.stop()}}),G,this,[[6,23,26,29]])}))),function(e){return u.apply(this,arguments)})},{key:"_checkIndices",value:function(e,t){var r,n;if(!Et.isArray(e))return iE(t),!1;if(0==e.length)return eE(t),!1;if(xt.DWT.ConnectWithSocket)return!0;for(r=this.howManyImagesInBuffer,n=0;n<e.length;n++){var i=e[n];if(Et.isUndefined(i)||null===i)return aE(t),!1;if(i=parseInt(i),isNaN(i))return Dw(t),!1;if(i<0||i>=r)return rE(t),!1}return!0}},{key:"saveImages",value:(s=eA(g.mark((function j(e,t,r){var n,i,o,a;return g.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(n={},!this._bDispose){s.next=4;break}return DE(n),s.abrupt("return",bt.Promise.reject(hA(n)));case 4:if(0!=this.howManyImagesInBuffer){s.next=7;break}return Ww(n),s.abrupt("return",bt.Promise.reject(hA(n)));case 7:if(Et.isNumber(r)){s.next=10;break}return gE(n),s.abrupt("return",bt.Promise.reject(hA(n)));case 10:if(r!=xD.IT_BMP&&r!=xD.IT_JPG&&r!=xD.IT_PNG){s.next=16;break}if(!(t.length>1)){s.next=14;break}return kw(n,-2623,"Saving multiple images is not allowable when the selected output format is BMP, JPG or PNG."),s.abrupt("return",bt.Promise.reject(hA(n)));case 14:s.next=26;break;case 16:if(r!=xD.IT_TIF&&r!=xD.IT_PDF){s.next=19;break}s.next=26;break;case 19:if(r!=xD.IT_ALL&&r!=xD.IT_MULTIPAGE_PDF&&r!=xD.IT_MULTIPAGE_TIF){s.next=24;break}return WE(n),s.abrupt("return",bt.Promise.reject(hA(n)));case 24:return sE(n),s.abrupt("return",bt.Promise.reject(hA(n)));case 26:return o=this.getViewerElement(),a=o._containerElement,s.next=29,this._makeSureDefaultServiceInfo();case 29:if(this._defaultDSScanClient){s.next=31;break}throw{code:-2825,message:"Failed to setup the Default Dynamsoft Service."};case 31:return s.next=33,this._defaultDSScanClient.saveImages(e,t,r,a);case 33:return i=s.sent,s.abrupt("return",i);case 35:case"end":return s.stop()}}),j,this)}))),function(e,t,r){return s.apply(this,arguments)})},{key:"getImages",value:(a=eA(g.mark((function H(e,t,r){var n,i,o,a;return g.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(n={},!this._bDispose){s.next=4;break}return DE(n),s.abrupt("return",bt.Promise.reject(hA(n)));case 4:if(0!=this.howManyImagesInBuffer){s.next=7;break}return Ww(n),s.abrupt("return",bt.Promise.reject(hA(n)));case 7:if(Et.isNumber(t)&&Et.isNumber(r)){s.next=10;break}return gE(n),s.abrupt("return",bt.Promise.reject(hA(n)));case 10:return o=this.getViewerElement(),a=o._containerElement,s.next=13,this._makeSureDefaultServiceInfo();case 13:if(this._defaultDSScanClient){s.next=15;break}throw{code:-2825,message:"Failed to setup the Default Dynamsoft Service."};case 15:return s.next=17,this._defaultDSScanClient.getImages(e,t,r,a);case 17:return i=s.sent,s.abrupt("return",i);case 19:case"end":return s.stop()}}),H,this)}))),function(e,t,r){return a.apply(this,arguments)})},{key:"dispose",value:function(){if(this._viewer&&this._viewer.unbind(),this._dsScanClientsMap){var e,t=this._dsScanClientsMap,r=Object.keys(t);for(e=0;e<r.length;e++){var n=r[e];this._disposeDSClientByKey(n)}}return this._dsScanClientsMap=null,this._bDispose=!0,!0}},{key:"setLogLevel",value:function(e){var t,r=this._dsScanClientsMap;if(r){var n=Object.keys(r);for(t=0;t<n.length;t++)r[n[t]]._setLogLevel(e);this._needSetLogLevel=!1,this._logLevel=-1}else this._needSetLogLevel=!0,this._logLevel=e;return!0}},{key:"getProfile",value:(o=eA(g.mark((function z(e){var t,r,n,i;return g.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(t="",e&&e instanceof FD){o.next=5;break}throw gE(r={}),{code:r._errorCode,message:r._errorString};case 5:return o.prev=5,n=e.serviceInfo,o.next=9,this._createDSClientByServiceInfo(n,!0);case 9:if(!(i=o.sent)){o.next=14;break}return o.next=13,i.getProfile(e);case 13:t=o.sent;case 14:o.next=19;break;case 16:throw o.prev=16,o.t0=o["catch"](5),o.t0;case 19:return o.abrupt("return",t);case 20:case"end":return o.stop()}}),z,this,[[5,16]])}))),function(e){return o.apply(this,arguments)})},{key:"setProfile",value:(n=eA(g.mark((function K(e,t){var r,n,i,o;return g.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r="",e&&e instanceof FD){a.next=5;break}throw gE(n={}),{code:n._errorCode,message:n._errorString};case 5:return a.prev=5,i=e.serviceInfo,a.next=9,this._createDSClientByServiceInfo(i,!0);case 9:if(!(o=a.sent)){a.next=14;break}return a.next=13,o.setProfile(e,t);case 13:r=a.sent;case 14:a.next=19;break;case 16:throw a.prev=16,a.t0=a["catch"](5),a.t0;case 19:return a.abrupt("return",r);case 20:case"end":return a.stop()}}),K,this,[[5,16]])}))),function(e,t){return n.apply(this,arguments)})},{key:"imageIDToIndex",value:function(e){return this._defaultDSScanClient?this._defaultDSScanClient.imageIDToIndex(e):0}},{key:"indexToImageID",value:function(e){return this._defaultDSScanClient?this._defaultDSScanClient.indexToImageID(e):0}},{key:"howManyImagesInBuffer",get:function(){return this._defaultDSScanClient?this._defaultDSScanClient.howManyImagesInBuffer:0}},{key:"currentImageIndexInBuffer",get:function(){return this._defaultDSScanClient?this._defaultDSScanClient.currentImageIndexInBuffer:-1},set:function(e){this._defaultDSScanClient&&(this._defaultDSScanClient.currentImageIndexInBuffer=e)}},{key:"showProgressBar",get:function(){return this._defaultDSScanClient?this._defaultDSScanClient.IfShowProgressBar:this._showProgressBar},set:function(e){this._defaultDSScanClient?(this._showProgressBar=e,this._defaultDSScanClient.IfShowProgressBar=e):this._showProgressBar}},{key:"registerEvent",value:function(e,t){if(this._bDispose){var r={};return DE(r),bt.Promise.reject(hA(r))}if(!Et.isFunction(t)){var n={};return mE(n),bt.Promise.reject(hA(n))}if("onBufferChanged"==e||"OnBufferChanged"==e)this.onBufferChanged=t;else{if("onPostTransferAsync"!=e&&"OnPostTransferAsync"!=e){var i={};return fE(i),bt.Promise.reject(hA(i))}this.onPostTransferAsync=t}return this._registEventToDefaultDS(),!0}},{key:"unregisterEvent",value:function(e,t){if(this._bDispose){var r={};return DE(r),bt.Promise.reject(hA(r))}if("onBufferChanged"==e||"OnBufferChanged"==e){if(this.onBufferChanged=null,this._defaultDSScanClient)return this._defaultDSScanClient.unregisterEvent("OnBufferChanged",t)}else{if("onPostTransferAsync"!=e&&"OnPostTransferAsync"!=e){var n={};return fE(n),bt.Promise.reject(hA(n))}if(this.onPostTransferAsync=null,this._defaultDSScanClient)return this._defaultDSScanClient.unregisterEvent("OnPostTransferAsync",t)}}},{key:"getViewerElement",value:function(){return this.Viewer&&this.Viewer.webViewer&&this.Viewer.webViewer.containerElement?{_containerElement:this.Viewer.webViewer.containerElement}:{_containerElement:document.body}}},{key:"isSameService",value:function(e,t){return!(!e||!t)&&(e.server==t.server&&e.attrs.UUID==t.attrs.UUID&&e.attrs.accessmode==t.attrs.accessmode&&e.attrs.name==t.attrs.name&&e.attrs.os==t.attrs.os&&e.attrs.service_type==t.attrs.service_type&&e.attrs.tags==t.attrs.tags&&e.attrs.ty==t.attrs.ty&&e.attrs.type==t.attrs.type&&e.attrs.txtvers==t.attrs.txtvers)}},{key:"_findDSClientByServiceInfo",value:function(e){var t,r=this._serviceInfos;if(r)for(t=0;t<r.length;t++){var n=r[t];if(this.isSameService(e,n)){var i=this._getDSClientFromMap(n);if(i){var o;if(IK._isReady(i))return i;i.isDestroy||i.dispose();var a=null==n||null===(o=n.attrs)||void 0===o?void 0:o.UUID;a&&delete this._dsScanClientsMap[a]}break}}return null}},{key:"_setRemoteUuid",value:(r=eA(g.mark((function J(){var e;return g.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Ew()){t.next=8;break}if(this._uuidForRemoteScanObject){t.next=6;break}return t.next=4,xt.DWT.lgcuid(xt.DWT.EnumInstance.dwt_desktop,"");case 4:e=t.sent,this._uuidForRemoteScanObject=e;case 6:t.next=8;break;case 8:case"end":return t.stop()}}),J,this)}))),function(){return r.apply(this,arguments)})},{key:"_registEventToDefaultDS",value:function(){this._defaultDSScanClient&&(this.onBufferChanged&&this._defaultDSScanClient.registerEvent("OnBufferChanged",this.onBufferChanged),this.onPostTransferAsync&&this._defaultDSScanClient.registerEvent("OnPostTransferAsync",this.onPostTransferAsync))}}]),e}(),bK=!1;function CK(e,t){return wK.apply(this,arguments)}function wK(){return wK=eA(g.mark((function e(t,r){var n,i;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r&&Mk(Uk),bP.isLicenseMixed(null,!0)||bP.reparseProductKey(r),0==(n=xt.DWT.licenseException).code){e.next=6;break}throw t&&yD(n),{code:n.code,message:n.message};case 6:if(bK){e.next=14;break}if(i=!1,K.bIE&&(i=K.IEVersion<=7),i||!Ew()){e.next=14;break}if(!xt.DWT.bChromeExtension){e.next=13;break}return bK=!0,e.abrupt("return");case 13:return e.abrupt("return",new bt.Promise((function(e,t){var r=xt.DWT.ResourcesPath,n="";K.bFileSystem||(n=bt.timestamp),Et.addScript([r,"/src/dynamsoft.lts.js",n].join(""),!0,!1,(function(){bK=!0,e()}))})));case 14:case"end":return e.stop()}}),e)}))),wK.apply(this,arguments)}var EK,AK=3;function kK(e,t){return PK.apply(this,arguments)}function PK(){return PK=eA(g.mark((function e(t,r){var n,i,o;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Mk(Vk),e.next=3,FK(t,eA(g.mark((function s(){return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,lK(t,r);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e["catch"](0),EK=e.t0;case 8:case"end":return e.stop()}}),s,null,[[0,5]])}))));case 3:if(!Tw.bEnhancedMode){e.next=12;break}return Mk(Gk),i=bt.install._dlgInstall,o=500,i&&i.open||(o=0),e.next=9,new bt.Promise((function(e,r){setTimeout((function(){xK=0,Mk(jk),DK(t,e,r)}),o)}));case 9:n=e.sent,e.next=13;break;case 12:n={host:t,port:r};case 13:return a=n.port,bt.detect.urls.splice(0),bt.detect.urls.push({port:a,ssl:K.bSSL}),bt.detect.ports=[{port:a,ssl:K.bSSL}],bt.detect.cUrlIndex=0,K.bSSL?xt.DWT.SSLPort=a:xt.DWT.Port=a,e.abrupt("return",n);case 15:case"end":return e.stop()}var a}),e)}))),PK.apply(this,arguments)}var xK=0;function DK(e,t,r){if(xK>10){bt.detect.dcpStatus=AK;var n={code:yw.EnhancedPortNotReady,message:"The Dynamsoft Service is not ready, please try again later."};r(n)}else{var i,o;i=function(n){if(Et.isArray(n)&&n.length>1){var i,a,s=n[1];if(s&&(Tw.currentUserPorts=s,s.dwt)){if(i=s.dwt.port,a=s.dwt.sslPort,0==i||0==a){var u=1500;return++xK<3&&(u=3e3),setTimeout((function(){DK(e,t,r)}),u),!0}return t({host:e,port:K.bSSL?a:i}),!0}}var c;return NE(c={}),o(hA(c))},o=function(t){bt.detect.dcpStatus=AK,function(t){var n=K.bSSL?xt.DWT.SSLPort:xt.DWT.Port;ZH(e,n).then((function(e){e&&fK(e.upgrade,e.socket)}),(function(e){vA(e)})),r(t)}(t)},xt.dcp.getPorts(e,Tw.strSID).then(i,o)}}function FK(e,t){return WK.apply(this,arguments)}function WK(){return WK=eA(g.mark((function e(t,r){var n,i,o,a,s,u;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=bw.refProductKey,EK=null,i=0,(o=Tw.detect).bConnected=!1;case 4:if(!(i<o.MaxManagerModuleConnectCount)){e.next=32;break}return a=0==i,e.prev=6,e.next=9,RK(t,n,a);case 9:return OK(e.sent),o.bConnected=!0,e.abrupt("return");case 15:if(e.prev=15,e.t0=e["catch"](6),!e.t0){e.next=26;break}if((s=e.t0.code)!=yw.ResponseDataTypeError&&s!=yw.HTSTError&&s!=yw.CORSError){e.next=23;break}throw e.t0;case 23:if(s!=yw.MustUpgrade){e.next=26;break}throw fK(!0,!1),e.t0;case 26:if(!a){e.next=29;break}return e.next=29,r();case 29:++i,e.next=4;break;case 32:if(o.bConnected=!1,o.dcpStatus=o.EnumDCP_DetectStatus.NotInstalled,xt.dcp._sendStatusEvent(),!EK){e.next=37;break}throw EK;case 37:throw RE(u={}),{code:u._errorCode,message:u._errorString};case 40:case"end":return e.stop()}}),e,null,[[6,15]])}))),WK.apply(this,arguments)}function RK(e,t,r){return NK.apply(this,arguments)}function NK(){return(NK=eA(g.mark((function e(t,r,n){var i,o,a,s,u,c,l;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!xt.DWT.ConnectWithSocket||!K.bHTML5Edition){e.next=10;break}return o=Et.startsWith(t,"wss://")||Et.startsWith(t,"ws://")?t:kD.getWsUrl(t,K.bSSL?Tw.SSLPort:Tw.Port),a={id:(new Date).getTime().toString(),method:"VersionInfo",version:"dwasm2_"+Cw.getVersionStrForCheck(),parameter:[]},bP.isLongKey(r)&&(a.productKey=r),e.next=6,kD.postStringDataByWSUrl(o,Et.stringify(a));case 6:s=e.sent;try{(u=Et.parse(s))&&"result"in u&&(i=u.result)}catch(d){}e.next=16;break;case 10:if(Tw.detect.dcpStatus=Tw.detect.EnumDCP_DetectStatus.CheckingManagerVer,!Tw.detect.bConnected||""==Tw.detect.connectedResult){e.next=13;break}return e.abrupt("return",Tw.detect.connectedResult);case 13:return e.next=15,lH(t,"VersionInfo",r,!0);case 15:i=e.sent;case 16:if(c={},!(Et.isArray(i)&&i.length>0&&i[0])){e.next=32;break}if(l=i[0],!Et.isString(l)||""==l){e.next=32;break}if(n&&Mk(zk),!QD(l,bw.getServerVersionInfo(!0))){e.next=27;break}return Tw.detect.dcpStatus=Tw.detect.EnumDCP_DetectStatus.UpdateSkipped,xt.dcp._sendStatusEvent(),e.abrupt("return",i);case 27:throw Mk(Jk),Ow(c),hA(c);case 30:e.next=32;break;case 32:throw NE(c),hA(c);case 34:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function OK(e){var t="",r=!1,n=!1,i={};if(e.length>4&&(t=Et.isString(e[2])?e[2]:"",r=Et.isString(e[3])&&"true"===e[3],n=Et.isString(e[4])&&"64"===e[4]),e.length>5&&(i=e[5]),Tw.detect.connectedResult=e,Tw.strSID=t,Tw.bEnhancedMode=r,Tw.b64bit=n,Tw.objEnhancedPorts=i,r&&i){if(i.dcp){var o=i.dcp;Tw.SSLPort=o.sslPort,Tw.Port=o.port}if(i.ddm){var a=i.ddm;a?K.bSSL?Tw.detect.ddmPort=a.sslPort:Tw.detect.ddmPort=a.port:Tw.detect.ddmPort=0}if(i.dwt){var s=i.dwt;s?K.bSSL?Tw.detect.dwtPort=s.sslPort:Tw.detect.dwtPort=s.port:Tw.detect.dwtPort=0}}}function MK(e,t){return LK.apply(this,arguments)}function LK(){return LK=eA(g.mark((function e(t,r){var n,i,o,a,s,u,c,l,d,f;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=xt.DWT.Containers,i=0;case 2:if(!(i<n.length)){e.next=42;break}if(!(o=Et.clone(n[i])).ContainerId){e.next=8;break}if(!xt.DWT.ContainerMap[o.ContainerId]){e.next=8;break}return e.abrupt("continue",39);case 8:if(!o.WebTwainId){e.next=12;break}if(!xt.DWT.WebTwainIdMap[o.WebTwainId]){e.next=12;break}return e.abrupt("continue",39);case 12:if(o.Host=t,K.bSSL?o.PortSSL=r:o.Port=r,Et.isDOM(o.Container)||o.ContainerId&&(o.Container=Et.get(o.ContainerId)),!Ij(o.Container)){e.next=22;break}return u=document.createElement("div"),o.Container.appendChild(u),o.Container=u,c=yj(u),e.next=22,VD(c);case 22:return MD(l=jH(o)),d=void 0,e.prev=25,e.next=28,eK.create(l);case 28:d=e.sent,e.next=35;break;case 31:throw e.prev=31,e.t0=e["catch"](25),d&&d.dispose(),e.t0;case 35:if(0===(s=xt.DWT.licenseException).code){e.next=38;break}throw{code:s.code,message:s.message};case 38:a=d;case 39:i++,e.next=2;break;case 42:f=window,a&&(f.DCP_DWT_OnClickCloseInstall&&f.DCP_DWT_OnClickCloseInstall(!1,!0),mK(a),xG(a)),setTimeout((function(){try{Et.isFunction(xt.DWT.OnWebTwainReady)?xt.DWT.OnWebTwainReady():Et.isFunction(f.Dynamsoft_OnReady)&&f.Dynamsoft_OnReady()}catch(e){vA(e)}}),100);case 45:case"end":return e.stop()}}),e,null,[[25,31]])}))),LK.apply(this,arguments)}function BK(){return UK.apply(this,arguments)}function UK(){return UK=eA(g.mark((function e(){var t,r,n,i,o,a,s,u;return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(bt.page.bUnload=iC,bw.bHTML5Edition){e.next=3;break}return e.abrupt("return",xt.DWT._innerLoad());case 3:return e.next=5,CK(!0,!0);case 5:if((t=xt.DWT.Containers)&&0!==t.length){e.next=10;break}throw FE(r={}),{code:r._errorCode,message:r._errorString};case 10:if(n=xt.DWT.Host,i=xt.DWT.Port,i=K.bSSL?xt.DWT.SSLPort:xt.DWT.Port,!xt.DWT.IfCheckDCP){e.next=25;break}return e.next=16,kK(n,i);case 16:if(!(o=e.sent)){e.next=22;break}n=o.host,i=o.port,e.next=25;break;case 22:throw NE(a={}),hA(a);case 25:return e.prev=25,e.next=28,YH(n,i,iC);case 28:s=e.sent,e.next=44;break;case 31:if(e.prev=31,e.t0=e["catch"](25),(u=e.t0.code)!=yw.ResponseDataTypeError&&u!=yw.HTSTError&&u!=yw.CORSError){e.next=37;break}e.next=43;break;case 37:if(u!=yw.MustUpgrade){e.next=41;break}fK(!0,!1),e.next=43;break;case 41:return e.next=43,lK(n,i);case 43:throw e.t0;case 44:if(!s){e.next=48;break}return Mk(qk),e.next=48,MK(s.host,s.port);case 48:case"end":return e.stop()}}),e,null,[[25,31]])}))),UK.apply(this,arguments)}xt.DWT.NetManager.checkModuleManager=function(e,t){bP.isLicenseMixed(null,!0)||bP.reparseProductKey();var r=xt.DWT.licenseException;if(0!=r.code)return yD(r),!!Et.isFunction(t)&&t(r);FK(lw(),eA(g.mark((function n(){return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,lK(lw(),bt.detect.ssl?xt.DWT.SSLPort:xt.DWT.Port);case 3:e.next=7;break;case 5:e.prev=5,e.t0=e["catch"](0);case 7:case"end":return e.stop()}}),n,null,[[0,5]])})))).then(e,t)};var VK=new(function(){function e(){t(this,e)}return i(e,[{key:"InvalidValue",value:function(e){Fw(e)}},{key:"ParameterCannotEmpty",value:function(e){Qw(e)}},{key:"Webcam_InvalidIndex",value:function(e,t){kw(e,-2315,"The index is out of range.")}},{key:"Webcam_InvalidRemoteFilename",value:function(e){kw(e,-2316,"The RemoteFile field is empty in the Webcam Download Function.")}},{key:"InvalidDestination",value:function(e){kw(e,-2318,"Invalid destination file.")}},{key:"InvalidSourceFile",value:function(e){kw(e,-2319,"Invalid source file.")}},{key:"InvalidFile",value:function(e){qw(e)}},{key:"OCR_InvalidIndex",value:function(e,t){kw(e,-2321,"The index is out of range.")}},{key:"OCR_InvalidLeftOrTopOrRightOrBottom",value:function(e){kw(e,-2322,"The left or top or right or bottom you entered is invalid.")}},{key:"OCR_InvalidOutputFormat",value:function(e){kw(e,-2323,"The OCR output format is not supported.")}},{key:"OCR_InvalidPageSetMode",value:function(e){kw(e,-2324,"The OCR page set mode is not supported.")}},{key:"IndexOutOfRange",value:function(e){oE(e)}},{key:"OCR_InvalidRemoteFilename",value:function(e){kw(e,-2379,"The RemoteFile field is empty in the OCR Download Function.")}},{key:"ImageEditorOpenCannotPlayVideo",value:function(e){kw(e,-2437,"The video can not be played while the Image Editor is open.")}},{key:"EventNotExist",value:function(e){kw(e,-2509,"The specified event doesn't exist.")}},{key:"CallbackNotAFunction",value:function(e){mE(e)}},{key:"WasmNotLoaded",value:function(e){kw(e,-2537,"The wasm not loaded.")}},{key:"WasmNotLoaded_UseWasmFalse",value:function(e){kw(e,-2538,"The wasm not loaded when Dynamsoft.DWT.UseCameraAddonWasm is set to false.")}},{key:"CannotDoWhenNoViewerJS",value:function(e){IE(e)}},{key:"LicenseNoDbr",value:function(e){kw(e,-2611,"The license for the Barcode module is invalid."),Pw(e)}}]),e}());if(bw.bHTML5Edition){var GK=function(){var e=eA(g.mark((function t(e){var r,n,i,o,a,s,u;return g.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return IH(),t.next=3,CK(!0,!1);case 3:if(xt.DWT.UseDefaultViewer||(e.Container=null),!Ij(e.Container)){t.next=11;break}return n=document.createElement("div"),e.Container.appendChild(n),e.Container=n,i=yj(n),t.next=11,VD(i);case 11:return r=jH(e),t.next=14,CH();case 14:return t.next=16,GH();case 16:if(!xt.DWT.IfCheckDCP){t.next=28;break}return t.next=19,kK(r.host,r.port);case 19:if(!(o=t.sent)){t.next=25;break}r.host=o.host,r.port=o.port,t.next=28;break;case 25:throw NE(a={}),hA(a);case 28:return t.prev=28,t.next=31,YH(r.host,r.port,iC);case 31:t.next=47;break;case 33:if(t.prev=33,t.t0=t["catch"](28),Et.log(["check DWT Version failed",t.t0]),(s=t.t0.code)!=yw.ResponseDataTypeError&&s!=yw.HTSTError&&s!=yw.CORSError){t.next=40;break}t.next=46;break;case 40:if(s!=yw.MustUpgrade){t.next=44;break}fK(!0,!1),t.next=46;break;case 44:return t.next=46,lK(r.host,r.port);case 46:throw t.t0;case 47:return Mk("Creating a WebTwain instance..."),t.next=50,hK(r);case 50:return u=t.sent,t.abrupt("return",u);case 52:case"end":return t.stop()}}),t,null,[[28,33]])})));return function(t){return e.apply(this,arguments)}}(),jK=window;jK.addEventListener("beforeunload",(function(){bt.page.bUnload=!0,xt.DWT.Unload(),bt.page.OnUnload&&bt.page.OnUnload()})),jK.addEventListener("unload",(function(){xt.DWT.Unload()})),xt.DWT.Unload=function(){if(!bw.bDWTLoading){HK(!1,!0);try{KK(),xt.DWT.CloseDialog(),bt._zdgb_xkz_dhk(),bt.closeProgress(null,""),bt.hideMask(),function(){for(var e,t,r,n=["dynamsoft.webtwain.install.js","dynamsoft.webtwain.viewer.js","dynamsoft.lts.js","dynamsoft.webtwain.viewer.css","dynamsoft.webtwain.css"],i=document.head.childNodes,o=i.length-1;o>=0;o--)if("LINK"==(t=i[o]).tagName?r=t.href:"SCRIPT"==t.tagName&&(r=t.src),r)for(e=0;e<n.length;e++)r.indexOf(n[e])>=0&&t.remove();bt.detect.cssLoaded=!1}()}catch(e){}bw.bDWTLoading=!1}},xt.DWT.Load=eA(g.mark((function e(){return g.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!bw.bDWTLoading){e.next=2;break}return e.abrupt("return");case 2:return bw.bDWTLoading=!0,zK(),e.prev=4,e.next=7,WH();case 7:return e.next=9,CH();case 9:return e.next=11,GH();case 11:return e.next=13,HK(!0,!0);case 13:return xt.DWT.CloseDialog(),e.next=16,BK();case 16:e.next=30;break;case 18:return e.prev=18,e.t0=e["catch"](4),_D(e.t0.code)||bt.detect.bOK||Et.asyncQueue.pushToDo(null,xt.DWT.Load),pD(e.t0),e.prev=23,e.next=26,HK();case 26:e.next=30;break;case 28:e.prev=28,e.t1=e["catch"](23);case 30:return e.prev=30,bw.bDWTLoading=!1,KK(),e.finish(30);case 34:case"end":return e.stop()}}),e,null,[[4,18,30,34],[23,28]])}))),xt.DWT.CheckConnectToTheService=function(e,t,r,n){rz(e,t,null,r,n)},xt.DWT.ConnectToTheService=function(){Et.asyncQueue.start()},xt.DWT.CreateDWTObject=function(e,t,r,n,i,o){var a,s=i,u=o;Et.isFunction(t)&&Et.isFunction(r)?(s=t,u=r,a={}):a={Host:t,Port:r,PortSSL:n};var c,l=e;if(Et.isString(l)&&!(l=Et.get(l)))return function(e){kw(e,-2813,MC.ErrStr_CreateID_NotContainer)}(c={}),u&&u({code:c._errorCode,message:c._errorString}),iC;if(Et.isDOM(l))a.Container=l;else{if(!Et.isString(e)){var d={code:-2806,message:'Error: The argument passed to the parameter "conatinerId" is not a string.'};return Et.isFunction(u)&&u(d),iC}if(!Et.get(e)){var f={code:-2807,message:'Error: The element specified by the id "'+e+"\" doesn't exist."};return Et.isFunction(u)&&u(f),iC}}return a.WebTwainId=jx(),xt.DWT.CreateDWTObjectEx(a,s,u)},xt.DWT.CreateDWTObjectEx=function(e,t,r){var n=arguments;return bw.loadResourcePath?Et.isString(e.WebTwainId)?(zK(),GK(e).then((function(e){KK(),xG(e),Et.isFunction(t)&&t(e)}),(function(e){if(KK(),!bt.detect.bOK){var t=e&&e.code,i=xt.DWT.licenseException;(t&&!_D(t)||0==i.code)&&(Et.asyncQueue.stop(),Et.asyncQueue.pushToDo(null,xt.DWT.CreateDWTObjectEx,n))}Et.isFunction(r)&&r(e)})),!0):(r&&r({code:-2805,message:'Error: The "WebTwainId" is not a string.'}),iC):(zK(),void WH().then(CH).then((function(){KK(),setTimeout((function(){xt.DWT.CreateDWTObjectEx(e,t,r)}),100)}),(function(e){KK(),r(e)})))},xt.DWT.CreateRemoteScanObjectAsync=function(){var e=eA(g.mark((function t(e){var r,n;return g.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=null,e){t.next=5;break}throw gE(n={}),{code:n._errorCode,message:n._errorString};case 5:return bw.bDWTLoading=!0,zK(),t.prev=7,t.next=10,CH();case 10:return t.next=12,GH();case 12:return t.next=14,CK(!1,!1);case 14:r=new TK(e),Object.preventExtensions(r);case 16:return t.prev=16,bw.bDWTLoading=!1,KK(),t.finish(16);case 20:return t.abrupt("return",r);case 21:case"end":return t.stop()}}),t,null,[[7,,16,20]])})));return function(t){return e.apply(this,arguments)}}(),xt.DWT.DeleteDWTObject=function(e){var t,r=e;return bw.bHTML5Edition&&r?!!(t=Et.isString(r)?xt.DWT.GetWebTwain(r):r)&&(t.dispose(),!0):iC}}function HK(e,t){var r,n,i,o,a;if(e&&Mk("Unload..."),t&&xt.DWT.lunload(),bt.dlgProgress=!1,bt.detect.bOK=!1,bt.detect.bFirst=!0,o=xt.DWT.WebTwainIdMap)for(a=Object.keys(o),r=0;r<a.length;r++)(i=a[r])&&i in o&&(n=o[i])&&n.dispose();if(o=xt.DWT.ContainerMap)for(a=Object.keys(o),r=0;r<a.length;r++)(i=a[r])&&i in o&&(n=o[i])&&n.dispose();if(o=xt.DWT.RemoteScanIdMap)for(a=Object.keys(o),r=0;r<a.length;r++)(i=a[r])&&i in o&&(n=o[i])&&n.dispose();for(r=0;r<bw.unloadQueue.length;r++){var s=bw.unloadQueue[r];Et.isFunction(s)&&s()}return bw.unloadQueue.splice(0),tC.Promise.resolve()}function zK(){bw.bHTML5Edition&&mj()}function KK(){bw.bHTML5Edition&&Kx("closeLoadingMsg:")}function JK(e,t){var r,n=this,i=0;r=Et.isString(e)?document.getElementById(e):e,n.isLoaded=!1,n.displayType=0,n.progress=0,n.progressPosition=0,n.borderWidth={left:0,right:0,top:0,bottom:0},n.orientation=t.orientation||JK.Orientation.Horizontal,n.direction=t.direction||JK.Direction.LeftToRight,n.creationType=t.creationType||JK.CreationType.Replace,n.value=0,n.initialValue=t.value||0,n.minValue=t.minValue||0,n.maxValue=t.maxValue||100,n.showLabel="undefined"==typeof t.showLabel||t.showLabel,n.labelText=t.labelText||"",n.width=t.width||280,n.height=t.height||20,n.borderRadius=t.borderRadius||10,n.orientation==JK.Orientation.Horizontal&&n.borderRadius>n.height/2&&(n.borderRadius=Math.round(n.height/2)),n.orientation==JK.Orientation.Vertical&&n.borderRadius>n.width/2&&(n.borderRadius=Math.round(n.width/2)),n.backColor=t.backColor||"",n.color=t.color||"#50a8e1",n.animationStyle=0,n.animationInterval=t.animationInterval||100;var o=["parent","background","wrapper","left","middle","right","horizontalText","verticalText","marker"];for(n.extraClassName={},i=0;i<o.length;i++)t.extraClassName?"string"==typeof t.extraClassName?n.extraClassName[o[i]]=t.extraClassName:n.extraClassName[o[i]]=t.extraClassName[o[i]]||"":n.extraClassName[o[i]]="";n.onLoad=t.onLoad||null,n.onValueChanged=t.onValueChanged||null,n.onAnimate=t.onAnimate||null,n.creationType==JK.CreationType.Replace?n.parentElement=r:(n.parentElement=document.createElement("DIV"),r.appendChild(n.parentElement)),n.finishLoading()}bt.Errors=VK,Ok(eA(g.mark((function dJ(){var e,t;return g.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e=window,K.bIE&&e.addEventListener&&e.addEventListener("unload",xt.DWT.Unload,!1),e&&(Et.addEventListener(e,"focus",(function(){var e;(e=xt.DWT.WebTwainIdMap)&&Et.each(e,(function(e,t){e&&e._OnPageFocus&&e._OnPageFocus()}))})),Et.addEventListener(e,"blur",(function(){K.bWin&&RH()})),t=e.document,Et.addEventListener(t,"visibilitychange",(function(){K.bWin&&"hidden"==t.visibilityState&&RH()}))),xt.navInfo){r.next=12;break}return r.prev=4,r.next=7,wk();case 7:xt.navInfo=r.sent,r.next=12;break;case 10:r.prev=10,r.t0=r["catch"](4);case 12:if(!1!==xt.DWT.AutoLoad&&!bw.bDWTLoading){r.next=14;break}return r.abrupt("return");case 14:return r.prev=14,r.next=17,WH();case 17:if(!(xt.DWT.Containers&&xt.DWT.Containers.length>0&&xt.DWT.AutoLoad)||bw.bDWTLoading){r.next=32;break}return bw.bDWTLoading=!0,zK(),r.prev=21,r.next=24,CH();case 24:return r.next=26,GH();case 26:return r.next=28,BK();case 28:return r.prev=28,bw.bDWTLoading=!1,KK(),r.finish(28);case 32:r.next=46;break;case 34:return r.prev=34,r.t1=r["catch"](14),_D(r.t1.code)||bt.detect.bOK||Et.asyncQueue.pushToDo(null,xt.DWT.Load),pD(r.t1),r.prev=39,r.next=42,HK();case 42:r.next=46;break;case 44:r.prev=44,r.t2=r["catch"](39);case 46:case"end":return r.stop()}}),dJ,null,[[4,10],[14,34],[21,,28,32],[39,44]])})))),JK.Orientation={Horizontal:0,Vertical:1},JK.Direction={LeftToRight:0,RightToLeft:1,TopToBottom:0,BottomToTop:1},JK.CreationType={Replace:0,AppendChild:1},JK.AnimationStyle={None:0,Static:1,StaticFull:2,Custom:3,CustomFull:4,Flickering1:10,Flickering2:11,Flickering3:12,LeftToRight1:20,LeftToRight2:21,RightToLeft1:22,RightToLeft2:23,TwoWay:24},JK.prototype.finishLoading=function(){var e,t=this;t.wrapperElement=null,t.backgroundElement=null,t.valueElement=null,t.leftElement=null,t.middleElement=null,t.rightElement=null,t.backgroundElement=document.createElement("DIV"),t.backgroundElement.className="progressbar_background"+(t.extraClassName.background?" ":"")+t.extraClassName.background,t.backgroundElement.style.cssText=t.backgroundElement.style.cssText+JK._createBorderRadiusCss(t.borderRadius),t.parentElement.appendChild(t.backgroundElement);var r=["border-radius","border-bottom-right-radius","-moz-border-radius-bottomright","-webkit-border-bottom-right-radius","-khtml-border-radius-bottomright","-khtml-border-bottom-right-radius"],n=0,i="";for(n=0;n<r.length&&(!(i=JK._elementCurrentStyle(t.backgroundElement,r[n]))&&"string"!=typeof i);n++);""!=i&&JK._parseInt(i)!=t.borderRadius&&(t.borderRadius=JK._parseInt(i)),t.orientation==JK.Orientation.Horizontal||t.orientation==JK.Orientation.Vertical?t.displayType=0:t.displayType=1,t.parentElement.className=(""!=t.parentElement.className?" ":"")+"progressbar_parent dynamsoft-progressBar"+(t.extraClassName.parent?" ":"")+t.extraClassName.parent,0==t.displayType?((e=t.wrapperElement=document.createElement("DIV")).style.border="1px solid #A0A0A0",e.style.cssFloat="left",e.style.display="inline-block",e.style.width=t.width+"px",e.style.height=t.height+"px",e.style.left="0px",e.style.top=-t.height+"px",e.style.backgroundColor=t.backColor,e.style.backgroundRepeat="no-repeat",e.style.position="relative",e.style.cssText=e.style.cssText+JK._createBorderRadiusCss(t.borderRadius),t.parentElement.appendChild(e),t.borderWidth={left:JK._parseInt(JK._elementCurrentStyle(e,"border-left-width")),right:JK._parseInt(JK._elementCurrentStyle(e,"border-right-width")),top:JK._parseInt(JK._elementCurrentStyle(e,"border-top-width")),bottom:JK._parseInt(JK._elementCurrentStyle(e,"border-bottom-width"))}):1==t.displayType&&(t.orientation==JK.Orientation.Horizontal?t.borderRadius>t.width/2&&(t.borderRadius=t.width):t.orientation==JK.Orientation.Vertical&&t.borderRadius>t.height/2&&(t.borderRadius=t.height),t.valueElement=document.createElement("DIV"),t.valueElement.className="",t.leftElement=document.createElement("DIV"),t.middleElement=document.createElement("DIV"),t.rightElement=document.createElement("DIV"),t.leftElement.style.border="1px solid #A0A0A0",t.leftElement.style.cssFloat="left",t.leftElement.style.display="inline-block",t.leftElement.style.backgroundColor=t.backColor,t.leftElement.style.backgroundRepeat="no-repeat",t.leftElement.style.position="relative",t.rightElement.style.border="1px solid #A0A0A0",t.rightElement.style.cssFloat="left",t.rightElement.style.display="inline-block",t.rightElement.style.backgroundColor=t.backColor,t.rightElement.style.backgroundRepeat="no-repeat",t.rightElement.style.position="relative",t.middleElement.style.border="1px solid #A0A0A0",t.middleElement.style.cssFloat="left",t.middleElement.style.display="inline-block",t.middleElement.style.overflow="hidden",t.middleElement.style.position="relative",t.valueElement.style.backgroundColor=t.backColor,t.valueElement.style.position="relative",t.orientation==JK.Orientation.Horizontal?(t.leftElement.style.width=t.borderRadius+"px",t.leftElement.style.height=t.height+"px",t.leftElement.style.top=-t.height+"px",t.leftElement.style.left="0px",t.leftElement.style.borderRight="none",t.leftElement.style.cssText=t.leftElement.style.cssText+JK._createBorderRadiusCss(t.borderRadius,0,0,t.borderRadius),t.rightElement.style.width=t.borderRadius+"px",t.rightElement.style.height=t.height+"px",t.rightElement.style.top=-t.height+"px",t.rightElement.style.borderLeft="none",t.rightElement.style.cssText=t.rightElement.style.cssText+JK._createBorderRadiusCss(0,t.borderRadius,t.borderRadius,0),t.middleElement.style.width=t.width-2*t.borderRadius+"px",t.middleElement.style.height=t.height+"px",t.middleElement.style.top=-t.height+"px",t.middleElement.style.borderLeft="none",t.middleElement.style.borderRight="none",t.valueElement.style.width="0px",t.valueElement.style.height=t.height+"px"):t.orientation==JK.Orientation.Vertical&&(t.leftElement.style.width=t.width+"px",t.leftElement.style.height=t.borderRadius+"px",t.leftElement.style.top=-t.height+"px",t.leftElement.style.left="0px",t.leftElement.style.borderBottom="none",t.leftElement.style.cssText=t.leftElement.style.cssText+JK._createBorderRadiusCss(t.borderRadius,t.borderRadius,0,0),t.rightElement.style.width=t.width+"px",t.rightElement.style.height=t.borderRadius+"px",t.rightElement.style.top=-t.height+"px",t.rightElement.style.left="0px",t.rightElement.style.borderTop="none",t.rightElement.style.cssText=t.rightElement.style.cssText+JK._createBorderRadiusCss(0,0,t.borderRadius,t.borderRadius),t.middleElement.style.width=t.width+"px",t.middleElement.style.height=t.height-2*t.borderRadius+"px",t.middleElement.style.top=-t.height+"px",t.middleElement.style.left="0px",t.middleElement.style.borderTop="none",t.middleElement.style.borderBottom="none",t.valueElement.style.width=t.width+"px",t.valueElement.style.height="0px"),t.middleElement.appendChild(t.valueElement),t.parentElement.appendChild(t.leftElement),t.parentElement.appendChild(t.middleElement),t.parentElement.appendChild(t.rightElement),t.orientation==JK.Orientation.Horizontal?t.borderWidth={left:JK._parseInt(JK._elementCurrentStyle(t.leftElement,"border-left-width")),right:JK._parseInt(JK._elementCurrentStyle(t.rightElement,"border-right-width")),top:JK._parseInt(JK._elementCurrentStyle(t.middleElement,"border-top-width")),bottom:JK._parseInt(JK._elementCurrentStyle(t.middleElement,"border-bottom-width"))}:t.orientation==JK.Orientation.Vertical&&(t.borderWidth={left:JK._parseInt(JK._elementCurrentStyle(t.middleElement,"border-left-width")),right:JK._parseInt(JK._elementCurrentStyle(t.middleElement,"border-right-width")),top:JK._parseInt(JK._elementCurrentStyle(t.leftElement,"border-top-width")),bottom:JK._parseInt(JK._elementCurrentStyle(t.rightElement,"border-bottom-width"))})),t.parentElement.style.width=t.width+t.borderWidth.left+t.borderWidth.right+"px",t.parentElement.style.height=t.height+t.borderWidth.top+t.borderWidth.bottom+"px",t.backgroundElement.style.cssFloat="left",t.backgroundElement.style.display="inline-block",t.backgroundElement.style.width=t.width+t.borderWidth.left+t.borderWidth.right+"px",t.backgroundElement.style.height=t.height+"px",t.backgroundElement.style.backgroundColor="#FFFFFF",t.backgroundElement.style.position="relative",0==t.displayType&&(t.backgroundElement.style.width=t.width+t.borderWidth.left+t.borderWidth.right+"px"),t.backgroundElement.style.top=t.borderWidth.top+"px",t.markerElement=document.createElement("DIV"),t.markerElement.style.display="inline-block",t.markerElement.style.zoom="1.0",t.markerElement.style.width=t.width+"px",t.markerElement.style.height=t.height+"px",t.markerElement.style.top=2*-t.height-t.borderWidth.top+"px",t.markerElement.style.left=t.borderWidth.left+"px",t.markerElement.style.backgroundColor=t.color,t.markerElement.style.lineHeight=t.height+"px",t.markerElement.style.position="relative",t.parentElement.appendChild(t.markerElement),t.isLoaded=!0,t.setValue(t.initialValue),null!=t.onLoad&&t.onLoad()},JK.prototype.setValue=function(e){var t=this;if(null!==e&&e<t.minValue&&(e=t.minValue),null!==e&&e>t.maxValue&&(e=t.maxValue),null===e||(t.value=e),t.isLoaded){var r,n=0;if(t.orientation==JK.Orientation.Horizontal){n=t.value/t.maxValue*t.width,t.progressPosition=n,0==t.displayType?(t.direction,JK.Direction.LeftToRight):1==t.displayType&&(t.direction==JK.Direction.LeftToRight?n<=t.borderRadius?t.valueElement.style.width="0px":n>=t.width-t.borderRadius?t.valueElement.style.width=t.middleElement.style.width:t.valueElement.style.width=n-t.borderRadius+"px":n<=t.borderRadius?t.valueElement.style.width="0px":n>=t.width-t.borderRadius?(t.valueElement.style.left="0px",t.valueElement.style.width=t.middleElement.style.width):(t.valueElement.style.left=t.width-n-t.borderRadius+"px",t.valueElement.style.width=n-t.borderRadius+"px")),n>0?(t.animationStyle!=JK.AnimationStyle.StaticFull&&t.animationStyle!=JK.AnimationStyle.CustomFull?t.markerElement.style.width=n+"px":t.markerElement.style.width=t.width+"px",t.markerElement.style.visibility="visible"):(t.markerElement.style.width=t.width+"px",t.animationStyle!=JK.AnimationStyle.StaticFull&&t.animationStyle!=JK.AnimationStyle.CustomFull&&(t.markerElement.style.visibility="hidden")),t.animationStyle!=JK.AnimationStyle.StaticFull&&t.animationStyle!=JK.AnimationStyle.CustomFull?t.direction==JK.Direction.LeftToRight?t.markerElement.style.left=t.borderWidth.left+"px":t.markerElement.style.left=t.width-n+t.borderWidth.left+"px":t.markerElement.style.left=t.borderWidth.left+"px",t.height,t.height,t.borderWidth.top;var i=2*-t.height-t.borderWidth.top;if(0==n||t.width==n)t.markerElement.style.top=i+"px",t.markerElement.style.height=t.height+"px",t.markerElement.style.cssText=t.markerElement.style.cssText+JK._createBorderRadiusCss(t.borderRadius);else if(n<t.borderRadius){var o=t.height-2.25*(t.borderRadius-Math.sqrt(Math.pow(t.borderRadius,2)-Math.pow(t.borderRadius-n,2))),a=i+t.height/2-o/2;t.markerElement.style.top=a+"px",t.markerElement.style.height=o+"px",t.direction==JK.Direction.LeftToRight?t.markerElement.style.cssText=t.markerElement.style.cssText+JK._createBorderRadiusCss(t.borderRadius,0,0,t.borderRadius):t.markerElement.style.cssText=t.markerElement.style.cssText+JK._createBorderRadiusCss(0,t.borderRadius,t.borderRadius,0)}else t.width-n<t.borderRadius?(r=(2*(t.borderRadius-(t.width-n))+(t.borderRadius-Math.sqrt(Math.pow(t.borderRadius,2)-Math.pow(t.borderRadius-(t.width-n),2))))/3,t.direction==JK.Direction.LeftToRight?t.markerElement.style.cssText=t.markerElement.style.cssText+JK._createBorderRadiusCss(t.borderRadius,r,r,t.borderRadius):t.markerElement.style.cssText=t.markerElement.style.cssText+JK._createBorderRadiusCss(r,t.borderRadius,t.borderRadius,r)):(t.markerElement.style.top=i+"px",t.markerElement.style.height=t.height+"px",t.direction==JK.Direction.LeftToRight?t.markerElement.style.cssText=t.markerElement.style.cssText+JK._createBorderRadiusCss(t.borderRadius,0,0,t.borderRadius):t.markerElement.style.cssText=t.markerElement.style.cssText+JK._createBorderRadiusCss(0,t.borderRadius,t.borderRadius,0))}else if(t.orientation==JK.Orientation.Vertical){n=t.value/t.maxValue*t.height,t.progressPosition=n,0==t.displayType?(t.direction,JK.Direction.TopToBottom):1==t.displayType&&(t.direction==JK.Direction.TopToBottom?n<=t.borderRadius?t.valueElement.style.height="0px":n>=t.height-t.borderRadius?t.valueElement.style.height=t.middleElement.style.height:t.valueElement.style.height=n-t.borderRadius+"px":n<=t.borderRadius?t.valueElement.style.height="0px":n>=t.height-t.borderRadius?(t.valueElement.style.top="0px",t.valueElement.style.height=t.middleElement.style.height):(t.valueElement.style.top=t.height-n-t.borderRadius+"px",t.valueElement.style.height=n+2*t.borderRadius+"px")),n>0?(t.animationStyle!=JK.AnimationStyle.StaticFull&&t.animationStyle!=JK.AnimationStyle.CustomFull?t.markerElement.style.height=n+"px":(t.markerElement.style.height=t.height+"px",t.markerElement.style.cssText=t.markerElement.style.cssText+JK._createBorderRadiusCss(t.borderRadius)),t.markerElement.style.visibility="visible"):(t.markerElement.style.height="0px",t.animationStyle!=JK.AnimationStyle.StaticFull&&t.animationStyle!=JK.AnimationStyle.CustomFull&&(t.markerElement.style.visibility="hidden")),t.borderWidth.left;var s=t.borderWidth.left;if(0==n||t.height==n)t.markerElement.style.left=s+"px",t.markerElement.style.width=t.width+"px",t.markerElement.style.cssText=t.markerElement.style.cssText+JK._createBorderRadiusCss(t.borderRadius);else if(n<t.borderRadius){var u=2.5*n;u>t.width&&(u=t.width);var c=s+t.width/2-u/2;t.markerElement.style.left=c+"px",t.markerElement.style.width=u+"px",t.direction==JK.Direction.BottomToTop?t.markerElement.style.cssText=t.markerElement.style.cssText+JK._createBorderRadiusCss(0,0,t.borderRadius,t.borderRadius):t.markerElement.style.cssText=t.markerElement.style.cssText+JK._createBorderRadiusCss(t.borderRadius,t.borderRadius,0,0)}else t.height-n<t.borderRadius?(r=(2*(t.borderRadius-(t.height-n))+(t.borderRadius-Math.sqrt(Math.pow(t.borderRadius,2)-Math.pow(t.borderRadius-(t.height-n),2))))/3,t.direction==JK.Direction.BottomToTop?t.markerElement.style.cssText=t.markerElement.style.cssText+JK._createBorderRadiusCss(r,r,t.borderRadius,t.borderRadius):t.markerElement.style.cssText=t.markerElement.style.cssText+JK._createBorderRadiusCss(t.borderRadius,t.borderRadius,r,r)):(t.markerElement.style.left=s+"px",t.markerElement.style.width=t.width+"px",t.direction==JK.Direction.BottomToTop?t.markerElement.style.cssText=t.markerElement.style.cssText+JK._createBorderRadiusCss(0,0,t.borderRadius,t.borderRadius):t.markerElement.style.cssText=t.markerElement.style.cssText+JK._createBorderRadiusCss(t.borderRadius,t.borderRadius,0,0));t.animationStyle!=JK.AnimationStyle.StaticFull&&t.animationStyle!=JK.AnimationStyle.CustomFull?t.direction==JK.Direction.TopToBottom?t.markerElement.style.top=2*-t.height-t.borderWidth.top+"px":t.markerElement.style.top=-t.height-n-t.borderWidth.top+"px":t.markerElement.style.top=2*-t.height-t.borderWidth.top+"px"}t.progress=t.value/t.maxValue}null!=t.onValueChanged&&t.onValueChanged()},JK._elementCurrentStyle=function(e,t){if(e.currentStyle){var r=0,n="",i=!1;for(r=0;r<t.length;r++)"-"!=t[r].toString()?(n+=i?t[r].toString().toUpperCase():t[r].toString(),i=!1):i=!0;return t=n,e.currentStyle[t]}return getComputedStyle(e,null).getPropertyValue(t)},JK._parseInt=function(e){var t=parseInt(e);return isNaN(t)&&(t=0),t},JK._createBorderRadiusCss=function(e,t,r,n){return null!=e&&null==t&&null==r&&null==n?"; -moz-border-radius: "+e+"px; -ms-border-radius: "+e+"px; -o-border-radius: "+e+"px; -webkit-border-radius: "+e+"px; -khtml-border-radius: "+e+"px; border-radius: "+e+"px;":"; -moz-border-radius: "+(e=e||0)+"px "+(t=t||0)+"px "+(r=r||0)+"px "+(n=n||0)+"px; -ms-border-radius: "+e+"px "+t+"px "+r+"px "+n+"px; -o-border-radius: "+e+"px "+t+"px "+r+"px "+n+"px; -webkit-border-radius: "+e+"px "+t+"px "+r+"px "+n+"px; -khtml-border-radius: "+e+"px "+t+"px "+r+"px "+n+"px; border-radius: "+e+"px "+t+"px "+r+"px "+n+"px;"};var QK=function(){function e(){t(this,e),nC(this,"handlers",{})}return i(e,[{key:"on",value:function(e,t){var r=Et.guid();return this.handlers[e]||(this.handlers[e]=[]),this.handlers[e].push({id:r,handler:t}),r}},{key:"off",value:function(e,t){if(this.handlers[e]){var r,n=this.handlers[e];if(t){for(r=0;r<n.length;r++)if(n[r].id==t){n.splice(r,1);break}}else n.splice(0)}}},{key:"fire",value:function(e){if(this.handlers[e]){var t,r=this.handlers[e];for(t=0;t<r.length;t++)r[t].handler();return r.length}return 0}},{key:"clear",value:function(){this.handlers={}}}]),e}();function qK(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(VV){return!1}}();return function(){var r,n=cA(e);if(t){var i=cA(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return uA(this,r)}}var YK=xt.DWT;bt.ProgressBar=JK,bt.progressMessage="",bt.dialogShowStatus=!1,bt.needShowTwiceShowDialog=!1,bt.dlgProgress=!1,bt.cancelFrom=aG.Other,bt.dlgRef=0,bt.initProgress=function(e){var t,r;if(!bt.dlgProgress){(r=[]).push('<dialog class="dynamsoft-dwt-dialogProgress" closed="closed" style="top:30%"><div class="ds-dwt-progressWrap">'),r.push('<h3 class="dynamsoft-finalMessage"> </h3>'),r.push('<p class="dynamsoft-desc"> </p><p class="dynamsoft-status">0%</p>'),K.bIE?r.push('<div class="dynamsoft-progressBar" value="" max="100"></div>'):r.push('<progress class="dynamsoft-progressBar" value="" max="100"></progress>'),r.push('<br /><div style="width:100%;text-align:center"><button class="dynamsoft-btnCancel" value="cancel" autofcus>cancel</button></div>'),r.push("</div></dialog>"),(t=tC.one(".dynamsoft-dwt-dialogProgress"))&&t.getEL()&&t.remove();var n=bt.parseHTML(r.join(""));if(n&&n.length>0&&document.body.appendChild(n[0]),K.bIE){var i=tC.one(".dynamsoft-progressBar"),o=i&&i.getEL();o&&(o.objProgressBar=new JK(o,{width:280,height:20}))}(t=tC.one(".dynamsoft-dwt-dialogProgress"))&&t.getEL()&&(bt.dlgProgress=t[0],tC.dialog.setup(bt.dlgProgress)),bt.dlgRef=0,bt.dialogShowStatus=!1,bt.cancelFrom=aG.Other}},bt.showProgressMsg=function(){};var XK=function(e){sA(n,e);var r=qK(n);function n(){return t(this,n),r.apply(this,arguments)}return i(n)}(QK);bt.progressContext=new XK;var ZK=function(){var e=bt.progressContext;if(e){var t,r=e.fire("cancel");for(t=0;t<r;t++)bt.closeProgress(null,"")}};bt.hideProgress=function(){var e=bt.progressContext;e&&(e.IfShowProgressBar=!1,e.IfShowCancelDialogWhenImageTransfer=!1,e.off("cancel"),e._onPercent=null)},bt.showProgress=function(e,t,r){var n,i=e;if(i.IfShowProgressBar)if(bt.progressContext&&(bt.progressContext.IfShowProgressBar=!0,bt.progressContext.IfShowCancelDialogWhenImageTransfer=i.IfShowCancelDialogWhenImageTransfer),bt.dlgRef>0)bt.dlgRef++;else{var o;if((n=xt.DWT.IfConfineMaskWithinTheViewer)?i._isNoViewer&&i._isNoViewer()?o=document.body:i._containerElement?o=i._containerElement:xt.DWT.Containers&&xt.DWT.Containers.length>0&&xt.DWT.Containers[0].ContainerId&&(o=Et.get(xt.DWT.Containers[0].ContainerId))||(o=document.body):o=document.body,o&&o!==document.body){var a=!1,s=o.firstElementChild;if(s&&s!==bt.dlgProgress&&"dvs-root dvs-web-viewer"==s.className&&(o=s,a=!0),0==a)for(var u=0;u<o.children.length;u++)if((s=o.children[u])&&s!==bt.dlgProgress&&"dvs-root dvs-web-viewer"==s.className){o=s;break}var c=bt.progressContext;""!==o.style.position&&"static"!==o.style.position||(o.style.position="relative",c.progressContainer={el:o})}Et.log("showProgress:"+t+",bCancel:"+r),bt.dlgProgress&&o.appendChild(bt.dlgProgress),ZE(r);var l=tC.one(".dynamsoft-btnCancel");if(l&&l.getEL()&&(Et.removeEventListener(l[0],"click",ZK),Et.addEventListener(l[0],"click",ZK)),0==bt.dialogShowStatus){bt.dlgProgress&&(n&&o&&o!==document.body?tC.dialog.setup(bt.dlgProgress,!0):tC.dialog.setup(bt.dlgProgress),bt.dlgProgress.showModal()),bt.dialogShowStatus=!0;var d=tC.one(".dynamsoft-finalMessage"),f=tC.one(".dynamsoft-progressBar"),h=f&&f.getEL(),g=tC.one(".dynamsoft-status");d&&d.getEL()&&d.html(""),g&&g.getEL()&&g.html("0%"),h&&(K.bIE&&h.objProgressBar?h.objProgressBar.setValue(0):h.value=0)}bt.dlgRef++}else bt.hideProgress()},bt.closeProgress=function(e,t){var r=bt.progressContext;Et.log("closeProgress:"+t),r&&r.IfShowProgressBar?(bt.dlgRef--,bt.dlgRef<=0&&(bt.dlgRef=0)):bt.dlgRef=0,0==bt.dlgRef&&(r.off("cancel"),r._onPercent=null,1==bt.dialogShowStatus&&(bt.dlgProgress&&(bt.dlgProgress.close(),bt.dlgProgress&&document.body.appendChild(bt.dlgProgress),r&&r.progressContainer&&r.progressContainer.el&&(r.progressContainer.el.style.position="",r.progressContainer=null)),bt.dialogShowStatus=!1),bt.cancelFrom=aG.Other)},YK.RemoveAllAuthorizations=function(){var e=HD.item("DWT_port"),t="http://";return"true"==HD.item("DWT_ssl")&&(t="https://"),RC({method:"GET",xhrFields:{withCredentials:!0},url:[t,lw(),":",e,"/dwt/",bw.getDWTPrefix(),bw.getServerVersionInfo(),"/RemoveAllAuthorizations?t=",Et.now()].join(""),async:!0}),!0};var $K={upload:"Uploading...",download:"Downloading...",load:"Processing...",decode:"Processing...",decodeTIFF:"Processing tiff...",decodePDF:"Processing pdf...",encodeTIFF:"Processing tiff...",encodePDF:"Processing pdf...",encode:"Processing...",transfer:"Transferring..."};bt.progressBarOnPercentDone=function(e,t,r,n,i,o){var a,s=tC.one(".dynamsoft-progressBar"),u=tC.one(".dynamsoft-status"),c=tC.one(".dynamsoft-finalMessage"),l=tC.one(".dynamsoft-desc");if(xt.DWT.UseDefaultViewer&&xt.DWT.IfConfineMaskWithinTheViewer&&o&&(s=tC.one(".dynamsoft-progressBar",o),u=tC.one(".dynamsoft-status",o),c=tC.one(".dynamsoft-finalMessage",o),l=tC.one(".dynamsoft-desc",o)),bt.cancelFrom==aG.FTPUpload||bt.cancelFrom==aG.FTPDownload){var d=r;0==d?bt.setBtnCancelVisibleForProgress(!1):1==d&&bt.setBtnCancelVisibleForProgress(!0)}else bt.cancelFrom==aG.HTTPUpload||bt.cancelFrom==aG.LoadImage||bt.cancelFrom==aG.HTTPPut?"Processing..."==t&&bt.setBtnCancelVisibleForProgress(!1):bt.cancelFrom==aG.ConvertToBlob&&(-1==e||bt.setBtnCancelVisibleForProgress(!1),100==n&&(t="",bt.progressMessage="Processing..."));if(e<0?(bt.progressMessage=t,a=bt.progressMessage):a=""!=t&&"1/1"!=t?bt.progressMessage+"("+t+")":bt.progressMessage,c&&c.getEL()){var f="",h="";a.indexOf(" ...")&&(a=a.replace(" ...","...")),-1!=a.indexOf("(")?(f=a.substr(0,a.indexOf("(")),h=a.substr(a.indexOf("("))):f=a,Et.each($K,(function(e,t){-1!=e.indexOf(f)&&(a=pj.customProgressText[t]+h)})),""==a&&(a="&nbsp;"),c.html(a)}if(i?(""==i||Et.isUndefined(i)?i="&nbsp;":Et.isString(i)&&i.length>30&&(i=i.substring(0,30)+"..."),l.html(i)):l.html("&nbsp;"),(n||0===n)&&(u&&u.getEL()&&u.html(n+"%"),s&&s.getEL())){var g=n;g>99&&(g=99),K.bIE?s[0].objProgressBar?s[0].objProgressBar.setValue(g):s[0].value=g:K.bEdge?(s[0].style.display="",s[0].value=g):s[0].value=g}bt.dlgRef<=0&&setTimeout((function(){s&&s.getEL()&&(K.bIE?s[0].objProgressBar?s[0].objProgressBar.setValue(0):s[0].value=0:K.bEdge?(s[0].style.display="none",s[0].value=0):s[0].value=0)}),1e3)};var eJ=xt.DWT;eJ.CloseDialog=function(){var e=bt.install._dlgInstall;if(e){var t=Et.sizzle(".dynamsoft-dialog-close");Et.each(t,(function(e,t){Et.removeEventListener(e,"click",eJ.CloseDialog)})),e.open&&e.close(),document.body.removeChild(e),bt.install._dlgInstall=!1}},eJ.ShowDialog=function(e,t,r,n,i){if(!1!==r){var o,a={width:e,height:t,position:"absolute"};n?(o=['<div class="dynamsoft-dwt-dialog-body">',r,"</div>"].join(""),a.closeButton=!1):o=['<div class="ds-dwt-ui-showdlg">','<div class="dynamsoft-dwt-dialog-body">','<div class="dynamsoft-dwt-dlg-header">',i?"":'<div class="dynamsoft-dialog-close"></div>',"</div>",r,"</div>","</div>"].join(""),i&&(a.closeButton=!1),eJ.ShowMessage(o,a)}},eJ.ShowMessage=function(e,t){var r,n,i,o,a,s=bt.install,u="ds-dwt-ui-dlg",c="ds-dwt-ui-dlg-wrap",l=screen.width,d=!0,f=0,h=!0,g=!0,p=0,m="fixed",_="Error",v=bw.bActiveXEdition,y=!1,I=null;if(t&&(r=t.width,n=t.height,t.seconds&&(f=t.seconds),t.headerStyle&&(p=t.headerStyle),1==t.backgroundStyle&&(y=!0),!1===t.closeButton&&(h=!1),t.bAutoClose&&(i=t.bAutoClose,h=!0),0==t.bReadyClosed&&(d=!1),t.position&&(m=t.position),t.caption&&(_=t.caption),Et.isFunction(t.onClose)&&(I=t.onClose)),r?r>l-10&&(r=l-10):r=l>600?600:l-10,n||(n="100%"),1==p?e=['<div class="dynamsoft-dialog">','<div class="dynamsoft-dwt-dialog-body">','<div class="dynamsoft-dwt-dlg-header">',h?'<div class="dynamsoft-dialog-close"></div>':"","</div>",e,"</div></div>"].join(""):2==p&&(e=['<div class="dynamsoft-dialog">','<div class="dynamsoft-dwt-ltsdlg-header"><span style="color:#FFF;line-height:35px;margin-left:15px">',_,"</span>",h?'<div class="dynamsoft-dialog-close"></div>':"","</div>",'<div class="dynamsoft-dwt-ltsdlg-body" style="padding:25px 50px 20px 50px;">',e,"</div></div>"].join("")),0==Et.sizzle("."+u).length){var S=document.createElement("div"),T=document.createElement("div"),b=document.createElement("div");if(S.className=u,T.className=c,T.style.margin="auto",T.style.zIndex="9999",T.style.position="relative",T.style.border="0",i&&((o=document.createElement("div")).className="dynamsoft-dialog-close",T.insertBefore(o,T.firstElementChild),(a=document.createElement("div")).className="dynamsoft-dialog-closeTimer",a.style.width="100%",a.style.height="2px",a.style.marginTop="-2px",a.style.backgroundColor="#fe8e14",T.insertBefore(a,T.firstElementChild)),T.appendChild(b),b.innerHTML=e,S.appendChild(T),document.body.appendChild(S),I){var C=tC.one(".dynamsoft-dialog-close",tC.one(S));C&&((C=C[0]).onClose=function(){Et.removeEventListener(C,"click",C.onClose),C.onClose=null,I()},Et.addEventListener(C,"click",C.onClose))}if(y?tC.setBackOpacity({opacity:.4,grayHex:0}):tC.setBackOpacity({}),S.bTopmost=!0,s._dlgInstall=S,tC.dialog.setup(s._dlgInstall,!1),K.bIE){var w=document.createElement("iframe");w.frameborder="0",w.marginheight="0",w.marginwidth="0",w.style.border="0",w.style.backgroundColor="transparent",w.style.position="absolute",w.style.left=0,w.style.top=0,w.style.width="100%",w.style.height=document.body.clientHeight+"px",w.style.margin="0 auto",w.style.zIndex="10000",w.src=["javas","cript:",'""'].join("");var E=tC.one(".dynamsoft-backdrop");E&&E.length>0&&(E[0].innerHTML="",E[0].style.zIndex="10000",E[0].appendChild(w))}}else g=!1;var A=tC.one("."+c);if(A&&A.getEL()&&(A[0].style.width=r+"px",Et.isNumber(n)&&n>0?A[0].style.height=n+"px":A[0].style.height="100%",g||Et.each(A[0].childNodes,(function(t){if("DIV"==t.tagName&&"dynamsoft-dialog-close"!=t.className&&"dynamsoft-dialog-closeTimer"!=t.className)return t.innerHTML=e,!1}))),v){var k=tC.one(".dynamsoft-dialog");k&&k.getEL()&&(k.getEL().style.border="1px solid #999")}if(s._dlgInstall.open&&s._dlgInstall.close(),s._dlgInstall.showModal({position:m}),s._dlgInstall.bReadyClosed=d,y&&tC.setBackOpacity({}),h){var P=Et.sizzle(".dynamsoft-dialog-close");Et.each(P,(function(e,t){Et.addEventListener(e,"click",eJ.CloseDialog)})),P.length>0&&i&&f>0&&setTimeout(bt._zdgb_xkz_dhk,100)}},eJ.OnWebTwainPreExecute||(eJ.OnWebTwainPreExecute=function(e,t){var r,n,i=xt.DWT.IfConfineMaskWithinTheViewer;if(i&&(e&&(n=e._containerElement),n||xt.DWT.Containers&&xt.DWT.Containers.length>0&&xt.DWT.Containers[0].ContainerId&&(n=Et.get(xt.DWT.Containers[0].ContainerId)),n)){r=n.getBoundingClientRect();for(var o=0;o<n.children.length;o++){var a=n.children[o];if(a&&"dvs-root dvs-web-viewer"==a.className){for(a=a.firstElementChild;a;){if(Et.isFunction(a.getBoundingClientRect)){r=a.getBoundingClientRect();break}a=a.nextSibling}n=a;break}}}(n===document.body||r==undefined||xt.DWT.Containers&&xt.DWT.Containers.length>1||xt.DWT.Containers&&1==xt.DWT.Containers.length&&(0==r.width||0==r.height))&&(i=!1,n=null);var s=null!=t?t:{};i&&(s={confined:i,wrapperEl:n}),bt.showMask(s)}),eJ.OnWebTwainPostExecute||(eJ.OnWebTwainPostExecute=function(){tC.hideMask()});window.DCP_DWT_OnClickCloseInstall=function(e,t){t||xt.DWT.CloseDialog();var r=Et.get(bt.install._divDWTNonInstallContainerID);if(r&&r.parentNode&&r.parentNode.removeChild(r),e&&Et.isDOM(e)&&Et.show(e),e&&Et.isString(e))Et.show(e);else{var n=xt.DWT.WebTwainIdMap;if(n){var i,o,a=Object.keys(n);for(i=0;i<a.length;i++)n[o=a[i]]._containerElement&&Et.show(n[o]._containerElement)}}""!=bt.install._divDWTemessageContainer&&Et.show(bt.install._divDWTemessageContainer)},(bt.__ver||0)<At&&(Et.mix(bt,tC),bt.__ver=At),bt.bNode=kt,bt._defaultAgent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36",bt._defaultPlatform="Win64",bt.timestamp="?t=20230919165843",Et.mix(bt,rC),bt.ajax=RC,bt.fetch=XE,bt.detect.showMask=hx,bt.detect.hideMask=gx,bt.env=Ax,bt.product=bw,bt.scannerInfo=Cw,bt.License=bP,bt.BIO=sx,bt.UI.ImageUIView=bj,bt.UI.ImageManager=qj,xt.MSG=fx,xt.navInfoSync=K,bt.domReady=Ok,function(){var e=document;if(e&&e.readyState!==Fk)if(Wk(window,Dk,Nk),kk){Wk(e,Pk,(function t(){Rk(e,Pk,t),Nk()}))}else{var t,r,n;Wk(e,xk,(function i(){e.readyState===Fk&&(Rk(e,xk,i),Nk())})),r=e&&e.documentElement,n=r&&r.doScroll;try{t=null===window.frameElement}catch(VV){t=!1}if(n&&t){!function e(){try{n("left"),setTimeout(Nk,30)}catch(t){setTimeout(e,40)}}()}}else Nk()}(),Ok((function(){if(xt.DWT.CustomizableDisplayInfo||(xt.DWT.CustomizableDisplayInfo=pj),K.bIE){xt.DWT.CustomizableDisplayInfo.loaderBarSourceIE||(xt.DWT.CustomizableDisplayInfo.loaderBarSourceIE=gj.loaderBarSourceIE);try{document.execCommand("BackgroundImageCache",!1,!0)}catch(VV){}}})),xt.Ready=function(e){if(!xt.navInfo)return wk().then((function(t){xt.navInfo=t;try{e()}catch(VV){throw Et.log(VV.stack||VV,"error"),VV}}));try{e()}catch(VV){throw Et.log(VV.stack||VV,"error"),VV}}}();

if(Dynamsoft.navInfoSync.bIE){
/* @preserve
 * The MIT License (MIT)
 * 
 * Copyright (c) 2013-2018 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
/**
 * bluebird build version 3.7.2
 * Features enabled: core, race, call_get, generators, map, nodeify, promisify, props, reduce, settle, some, using, timers, filter, any, each
*/
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.Promise=t()}}(function(){var t,e,n;return function r(t,e,n){function i(s,a){if(!e[s]){if(!t[s]){var c="function"==typeof _dereq_&&_dereq_;if(!a&&c)return c(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=e[s]={exports:{}};t[s][0].call(l.exports,function(e){var n=t[s][1][e];return i(n?n:e)},l,l.exports,r,t,e,n)}return e[s].exports}for(var o="function"==typeof _dereq_&&_dereq_,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(t,e,n){"use strict";e.exports=function(t){function e(t){var e=new n(t),r=e.promise();return e.setHowMany(1),e.setUnwrap(),e.init(),r}var n=t._SomePromiseArray;t.any=function(t){return e(t)},t.prototype.any=function(){return e(this)}}},{}],2:[function(t,e,n){"use strict";function r(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new f(16),this._normalQueue=new f(16),this._haveDrainedQueues=!1;var t=this;this.drainQueues=function(){t._drainQueues()},this._schedule=p}function i(t,e,n){this._lateQueue.push(t,e,n),this._queueTick()}function o(t,e,n){this._normalQueue.push(t,e,n),this._queueTick()}function s(t){this._normalQueue._pushOne(t),this._queueTick()}function a(t){for(;t.length()>0;)c(t)}function c(t){var e=t.shift();if("function"!=typeof e)e._settlePromises();else{var n=t.shift(),r=t.shift();e.call(n,r)}}var u;try{throw new Error}catch(l){u=l}var p=t("./schedule"),f=t("./queue");r.prototype.setScheduler=function(t){var e=this._schedule;return this._schedule=t,this._customScheduler=!0,e},r.prototype.hasCustomScheduler=function(){return this._customScheduler},r.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},r.prototype.fatalError=function(t,e){e?(process.stderr.write("Fatal "+(t instanceof Error?t.stack:t)+"\n"),process.exit(2)):this.throwLater(t)},r.prototype.throwLater=function(t,e){if(1===arguments.length&&(e=t,t=function(){throw e}),"undefined"!=typeof setTimeout)setTimeout(function(){t(e)},0);else try{this._schedule(function(){t(e)})}catch(n){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},r.prototype.invokeLater=i,r.prototype.invoke=o,r.prototype.settlePromises=s,r.prototype._drainQueues=function(){a(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,a(this._lateQueue)},r.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},r.prototype._reset=function(){this._isTickUsed=!1},e.exports=r,e.exports.firstLineError=u},{"./queue":26,"./schedule":29}],3:[function(t,e,n){"use strict";e.exports=function(t,e,n,r){var i=!1,o=function(t,e){this._reject(e)},s=function(t,e){e.promiseRejectionQueued=!0,e.bindingPromise._then(o,o,null,this,t)},a=function(t,e){0===(50397184&this._bitField)&&this._resolveCallback(e.target)},c=function(t,e){e.promiseRejectionQueued||this._reject(t)};t.prototype.bind=function(o){i||(i=!0,t.prototype._propagateFrom=r.propagateFromFunction(),t.prototype._boundValue=r.boundValueFunction());var u=n(o),l=new t(e);l._propagateFrom(this,1);var p=this._target();if(l._setBoundTo(u),u instanceof t){var f={promiseRejectionQueued:!1,promise:l,target:p,bindingPromise:u};p._then(e,s,void 0,l,f),u._then(a,c,void 0,l,f),l._setOnCancel(u)}else l._resolveCallback(p);return l},t.prototype._setBoundTo=function(t){void 0!==t?(this._bitField=2097152|this._bitField,this._boundTo=t):this._bitField=-2097153&this._bitField},t.prototype._isBound=function(){return 2097152===(2097152&this._bitField)},t.bind=function(e,n){return t.resolve(n).bind(e)}}},{}],4:[function(t,e,n){"use strict";function r(){try{Promise===o&&(Promise=i)}catch(t){}return o}var i;"undefined"!=typeof Promise&&(i=Promise);var o=t("./promise")();o.noConflict=r,e.exports=o},{"./promise":22}],5:[function(t,e,n){"use strict";var r=Object.create;if(r){var i=r(null),o=r(null);i[" size"]=o[" size"]=0}e.exports=function(e){function n(t,n){var r;if(null!=t&&(r=t[n]),"function"!=typeof r){var i="Object "+a.classString(t)+" has no method '"+a.toString(n)+"'";throw new e.TypeError(i)}return r}function r(t){var e=this.pop(),r=n(t,e);return r.apply(t,this)}function i(t){return t[this]}function o(t){var e=+this;return 0>e&&(e=Math.max(0,e+t.length)),t[e]}var s,a=t("./util"),c=a.canEvaluate;a.isIdentifier;e.prototype.call=function(t){var e=[].slice.call(arguments,1);return e.push(t),this._then(r,void 0,void 0,e,void 0)},e.prototype.get=function(t){var e,n="number"==typeof t;if(n)e=o;else if(c){var r=s(t);e=null!==r?r:i}else e=i;return this._then(e,void 0,void 0,t,void 0)}}},{"./util":36}],6:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){var o=t("./util"),s=o.tryCatch,a=o.errorObj,c=e._async;e.prototype["break"]=e.prototype.cancel=function(){if(!i.cancellation())return this._warn("cancellation is disabled");for(var t=this,e=t;t._isCancellable();){if(!t._cancelBy(e)){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}var n=t._cancellationParent;if(null==n||!n._isCancellable()){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}t._isFollowing()&&t._followee().cancel(),t._setWillBeCancelled(),e=t,t=n}},e.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},e.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},e.prototype._cancelBy=function(t){return t===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),this._enoughBranchesHaveCancelled()?(this._invokeOnCancel(),!0):!1)},e.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},e.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),c.invoke(this._cancelPromises,this,void 0))},e.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},e.prototype._unsetOnCancel=function(){this._onCancelField=void 0},e.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},e.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},e.prototype._doInvokeOnCancel=function(t,e){if(o.isArray(t))for(var n=0;n<t.length;++n)this._doInvokeOnCancel(t[n],e);else if(void 0!==t)if("function"==typeof t){if(!e){var r=s(t).call(this._boundValue());r===a&&(this._attachExtraTrace(r.e),c.throwLater(r.e))}}else t._resultCancelled(this)},e.prototype._invokeOnCancel=function(){var t=this._onCancel();this._unsetOnCancel(),c.invoke(this._doInvokeOnCancel,this,t)},e.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},e.prototype._resultCancelled=function(){this.cancel()}}},{"./util":36}],7:[function(t,e,n){"use strict";e.exports=function(e){function n(t,n,a){return function(c){var u=a._boundValue();t:for(var l=0;l<t.length;++l){var p=t[l];if(p===Error||null!=p&&p.prototype instanceof Error){if(c instanceof p)return o(n).call(u,c)}else if("function"==typeof p){var f=o(p).call(u,c);if(f===s)return f;if(f)return o(n).call(u,c)}else if(r.isObject(c)){for(var h=i(p),_=0;_<h.length;++_){var d=h[_];if(p[d]!=c[d])continue t}return o(n).call(u,c)}}return e}}var r=t("./util"),i=t("./es5").keys,o=r.tryCatch,s=r.errorObj;return n}},{"./es5":13,"./util":36}],8:[function(t,e,n){"use strict";e.exports=function(t){function e(){this._trace=new e.CapturedTrace(r())}function n(){return i?new e:void 0}function r(){var t=o.length-1;return t>=0?o[t]:void 0}var i=!1,o=[];return t.prototype._promiseCreated=function(){},t.prototype._pushContext=function(){},t.prototype._popContext=function(){return null},t._peekContext=t.prototype._peekContext=function(){},e.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,o.push(this._trace))},e.prototype._popContext=function(){if(void 0!==this._trace){var t=o.pop(),e=t._promiseCreated;return t._promiseCreated=null,e}return null},e.CapturedTrace=null,e.create=n,e.deactivateLongStackTraces=function(){},e.activateLongStackTraces=function(){var n=t.prototype._pushContext,o=t.prototype._popContext,s=t._peekContext,a=t.prototype._peekContext,c=t.prototype._promiseCreated;e.deactivateLongStackTraces=function(){t.prototype._pushContext=n,t.prototype._popContext=o,t._peekContext=s,t.prototype._peekContext=a,t.prototype._promiseCreated=c,i=!1},i=!0,t.prototype._pushContext=e.prototype._pushContext,t.prototype._popContext=e.prototype._popContext,t._peekContext=t.prototype._peekContext=r,t.prototype._promiseCreated=function(){var t=this._peekContext();t&&null==t._promiseCreated&&(t._promiseCreated=this)}},e}},{}],9:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){function o(t,e){return{promise:e}}function s(){return!1}function a(t,e,n){var r=this;try{t(e,n,function(t){if("function"!=typeof t)throw new TypeError("onCancel must be a function, got: "+B.toString(t));r._attachCancellationCallback(t)})}catch(i){return i}}function c(t){if(!this._isCancellable())return this;var e=this._onCancel();void 0!==e?B.isArray(e)?e.push(t):this._setOnCancel([e,t]):this._setOnCancel(t)}function u(){return this._onCancelField}function l(t){this._onCancelField=t}function p(){this._cancellationParent=void 0,this._onCancelField=void 0}function f(t,e){if(0!==(1&e)){this._cancellationParent=t;var n=t._branchesRemainingToCancel;void 0===n&&(n=0),t._branchesRemainingToCancel=n+1}0!==(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)}function h(t,e){0!==(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)}function _(){var t=this._boundTo;return void 0!==t&&t instanceof e?t.isFulfilled()?t.value():void 0:t}function d(){this._trace=new V(this._peekContext())}function v(t,e){if(q(t)){var n=this._trace;if(void 0!==n&&e&&(n=n._parent),void 0!==n)n.attachExtraTrace(t);else if(!t.__stackCleaned__){var r=F(t);B.notEnumerableProp(t,"stack",r.message+"\n"+r.stack.join("\n")),B.notEnumerableProp(t,"__stackCleaned__",!0)}}}function y(){this._trace=void 0}function g(t,e,n,r,i){if(void 0===t&&null!==e&&Z){if(void 0!==i&&i._returnedNonUndefined())return;if(0===(65535&r._bitField))return;n&&(n+=" ");var o="",s="";if(e._trace){for(var a=e._trace.stack.split("\n"),c=k(a),u=c.length-1;u>=0;--u){var l=c[u];if(!Q.test(l)){var p=l.match(G);p&&(o="at "+p[1]+":"+p[2]+":"+p[3]+" ");break}}if(c.length>0)for(var f=c[0],u=0;u<a.length;++u)if(a[u]===f){u>0&&(s="\n"+a[u-1]);break}}var h="a promise was created in a "+n+"handler "+o+"but was not returned from it, see http://goo.gl/rRqMUw"+s;r._warn(h,!0,e)}}function m(t,e){var n=t+" is deprecated and will be removed in a future version.";return e&&(n+=" Use "+e+" instead."),b(n)}function b(t,n,r){if(lt.warnings){var i,o=new U(t);if(n)r._attachExtraTrace(o);else if(lt.longStackTraces&&(i=e._peekContext()))i.attachExtraTrace(o);else{var s=F(o);o.stack=s.message+"\n"+s.stack.join("\n")}ot("warning",o)||x(o,"",!0)}}function w(t,e){for(var n=0;n<e.length-1;++n)e[n].push("From previous event:"),e[n]=e[n].join("\n");return n<e.length&&(e[n]=e[n].join("\n")),t+"\n"+e.join("\n")}function C(t){for(var e=0;e<t.length;++e)(0===t[e].length||e+1<t.length&&t[e][0]===t[e+1][0])&&(t.splice(e,1),e--)}function j(t){for(var e=t[0],n=1;n<t.length;++n){for(var r=t[n],i=e.length-1,o=e[i],s=-1,a=r.length-1;a>=0;--a)if(r[a]===o){s=a;break}for(var a=s;a>=0;--a){var c=r[a];if(e[i]!==c)break;e.pop(),i--}e=r}}function k(t){for(var e=[],n=0;n<t.length;++n){var r=t[n],i="    (No stack trace)"===r||z.test(r),o=i&&at(r);i&&!o&&(W&&" "!==r.charAt(0)&&(r="    "+r),e.push(r))}return e}function E(t){for(var e=t.stack.replace(/\s+$/g,"").split("\n"),n=0;n<e.length;++n){var r=e[n];if("    (No stack trace)"===r||z.test(r))break}return n>0&&"SyntaxError"!=t.name&&(e=e.slice(n)),e}function F(t){var e=t.stack,n=t.toString();return e="string"==typeof e&&e.length>0?E(t):["    (No stack trace)"],{message:n,stack:"SyntaxError"==t.name?e:k(e)}}function x(t,e,n){if("undefined"!=typeof console){var r;if(B.isObject(t)){var i=t.stack;r=e+X(i,t)}else r=e+String(t);"function"==typeof I?I(r,n):("function"==typeof console.log||"object"==typeof console.log)&&console.log(r)}}function T(t,e,n,r){var i=!1;try{"function"==typeof e&&(i=!0,"rejectionHandled"===t?e(r):e(n,r))}catch(o){N.throwLater(o)}"unhandledRejection"===t?ot(t,n,r)||i||x(n,"Unhandled rejection "):ot(t,r)}function P(t){var e;if("function"==typeof t)e="[function "+(t.name||"anonymous")+"]";else{e=t&&"function"==typeof t.toString?t.toString():B.toString(t);var n=/\[object [a-zA-Z0-9$_]+\]/;if(n.test(e))try{var r=JSON.stringify(t);e=r}catch(i){}0===e.length&&(e="(empty array)")}return"(<"+R(e)+">, no stack trace)"}function R(t){var e=41;return t.length<e?t:t.substr(0,e-3)+"..."}function S(){return"function"==typeof ut}function O(t){var e=t.match(ct);return e?{fileName:e[1],line:parseInt(e[2],10)}:void 0}function A(t,e){if(S()){for(var n,r,i=(t.stack||"").split("\n"),o=(e.stack||"").split("\n"),s=-1,a=-1,c=0;c<i.length;++c){var u=O(i[c]);if(u){n=u.fileName,s=u.line;break}}for(var c=0;c<o.length;++c){var u=O(o[c]);if(u){r=u.fileName,a=u.line;break}}0>s||0>a||!n||!r||n!==r||s>=a||(at=function(t){if($.test(t))return!0;var e=O(t);return e&&e.fileName===n&&s<=e.line&&e.line<=a?!0:!1})}}function V(t){this._parent=t,this._promisesCreated=0;var e=this._length=1+(void 0===t?0:t._length);ut(this,V),e>32&&this.uncycle()}var H,D,I,L,N=e._async,U=t("./errors").Warning,B=t("./util"),M=t("./es5"),q=B.canAttachTrace,$=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,Q=/\((?:timers\.js):\d+:\d+\)/,G=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,z=null,X=null,W=!1,K=!(0==B.env("BLUEBIRD_DEBUG")||!B.env("BLUEBIRD_DEBUG")&&"development"!==B.env("NODE_ENV")),J=!(0==B.env("BLUEBIRD_WARNINGS")||!K&&!B.env("BLUEBIRD_WARNINGS")),Y=!(0==B.env("BLUEBIRD_LONG_STACK_TRACES")||!K&&!B.env("BLUEBIRD_LONG_STACK_TRACES")),Z=0!=B.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(J||!!B.env("BLUEBIRD_W_FORGOTTEN_RETURN"));!function(){function t(){for(var t=0;t<r.length;++t)r[t]._notifyUnhandledRejection();n()}function n(){r.length=0}var r=[];L=function(e){r.push(e),setTimeout(t,1)},M.defineProperty(e,"_unhandledRejectionCheck",{value:t}),M.defineProperty(e,"_unhandledRejectionClear",{value:n})}(),e.prototype.suppressUnhandledRejections=function(){var t=this._target();t._bitField=-1048577&t._bitField|524288},e.prototype._ensurePossibleRejectionHandled=function(){0===(524288&this._bitField)&&(this._setRejectionIsUnhandled(),L(this))},e.prototype._notifyUnhandledRejectionIsHandled=function(){T("rejectionHandled",H,void 0,this)},e.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},e.prototype._returnedNonUndefined=function(){return 0!==(268435456&this._bitField)},e.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var t=this._settledValue();this._setUnhandledRejectionIsNotified(),T("unhandledRejection",D,t,this)}},e.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},e.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},e.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},e.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},e.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},e.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},e.prototype._warn=function(t,e,n){return b(t,e,n||this)},e.onPossiblyUnhandledRejection=function(t){var n=e._getContext();D=B.contextBind(n,t)},e.onUnhandledRejectionHandled=function(t){var n=e._getContext();H=B.contextBind(n,t)};var tt=function(){};e.longStackTraces=function(){if(N.haveItemsQueued()&&!lt.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!lt.longStackTraces&&S()){var t=e.prototype._captureStackTrace,r=e.prototype._attachExtraTrace,i=e.prototype._dereferenceTrace;lt.longStackTraces=!0,tt=function(){if(N.haveItemsQueued()&&!lt.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");e.prototype._captureStackTrace=t,e.prototype._attachExtraTrace=r,e.prototype._dereferenceTrace=i,n.deactivateLongStackTraces(),lt.longStackTraces=!1},e.prototype._captureStackTrace=d,e.prototype._attachExtraTrace=v,e.prototype._dereferenceTrace=y,n.activateLongStackTraces()}},e.hasLongStackTraces=function(){return lt.longStackTraces&&S()};var et={unhandledrejection:{before:function(){var t=B.global.onunhandledrejection;return B.global.onunhandledrejection=null,t},after:function(t){B.global.onunhandledrejection=t}},rejectionhandled:{before:function(){var t=B.global.onrejectionhandled;return B.global.onrejectionhandled=null,t},after:function(t){B.global.onrejectionhandled=t}}},nt=function(){var t=function(t,e){if(!t)return!B.global.dispatchEvent(e);var n;try{return n=t.before(),!B.global.dispatchEvent(e)}finally{t.after(n)}};try{if("function"==typeof CustomEvent){var e=new CustomEvent("CustomEvent");return B.global.dispatchEvent(e),function(e,n){e=e.toLowerCase();var r={detail:n,cancelable:!0},i=new CustomEvent(e,r);return M.defineProperty(i,"promise",{value:n.promise}),M.defineProperty(i,"reason",{value:n.reason}),t(et[e],i)}}if("function"==typeof Event){var e=new Event("CustomEvent");return B.global.dispatchEvent(e),function(e,n){e=e.toLowerCase();var r=new Event(e,{cancelable:!0});return r.detail=n,M.defineProperty(r,"promise",{value:n.promise}),M.defineProperty(r,"reason",{value:n.reason}),t(et[e],r)}}var e=document.createEvent("CustomEvent");return e.initCustomEvent("testingtheevent",!1,!0,{}),B.global.dispatchEvent(e),function(e,n){e=e.toLowerCase();var r=document.createEvent("CustomEvent");return r.initCustomEvent(e,!1,!0,n),t(et[e],r)}}catch(n){}return function(){return!1}}(),rt=function(){return B.isNode?function(){return process.emit.apply(process,arguments)}:B.global?function(t){var e="on"+t.toLowerCase(),n=B.global[e];return n?(n.apply(B.global,[].slice.call(arguments,1)),!0):!1}:function(){return!1}}(),it={promiseCreated:o,promiseFulfilled:o,promiseRejected:o,promiseResolved:o,promiseCancelled:o,promiseChained:function(t,e,n){return{promise:e,child:n}},warning:function(t,e){return{warning:e}},unhandledRejection:function(t,e,n){return{reason:e,promise:n}},rejectionHandled:o},ot=function(t){var e=!1;try{e=rt.apply(null,arguments)}catch(n){N.throwLater(n),e=!0}var r=!1;try{r=nt(t,it[t].apply(null,arguments))}catch(n){N.throwLater(n),r=!0}return r||e};e.config=function(t){if(t=Object(t),"longStackTraces"in t&&(t.longStackTraces?e.longStackTraces():!t.longStackTraces&&e.hasLongStackTraces()&&tt()),"warnings"in t){var n=t.warnings;lt.warnings=!!n,Z=lt.warnings,B.isObject(n)&&"wForgottenReturn"in n&&(Z=!!n.wForgottenReturn)}if("cancellation"in t&&t.cancellation&&!lt.cancellation){if(N.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");e.prototype._clearCancellationData=p,e.prototype._propagateFrom=f,e.prototype._onCancel=u,e.prototype._setOnCancel=l,e.prototype._attachCancellationCallback=c,e.prototype._execute=a,st=f,lt.cancellation=!0}if("monitoring"in t&&(t.monitoring&&!lt.monitoring?(lt.monitoring=!0,e.prototype._fireEvent=ot):!t.monitoring&&lt.monitoring&&(lt.monitoring=!1,e.prototype._fireEvent=s)),"asyncHooks"in t&&B.nodeSupportsAsyncResource){var o=lt.asyncHooks,h=!!t.asyncHooks;o!==h&&(lt.asyncHooks=h,h?r():i())}return e},e.prototype._fireEvent=s,e.prototype._execute=function(t,e,n){try{t(e,n)}catch(r){return r}},e.prototype._onCancel=function(){},e.prototype._setOnCancel=function(t){},e.prototype._attachCancellationCallback=function(t){},e.prototype._captureStackTrace=function(){},e.prototype._attachExtraTrace=function(){},e.prototype._dereferenceTrace=function(){},e.prototype._clearCancellationData=function(){},e.prototype._propagateFrom=function(t,e){};var st=h,at=function(){return!1},ct=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;B.inherits(V,Error),n.CapturedTrace=V,V.prototype.uncycle=function(){var t=this._length;if(!(2>t)){for(var e=[],n={},r=0,i=this;void 0!==i;++r)e.push(i),i=i._parent;t=this._length=r;for(var r=t-1;r>=0;--r){var o=e[r].stack;void 0===n[o]&&(n[o]=r)}for(var r=0;t>r;++r){var s=e[r].stack,a=n[s];if(void 0!==a&&a!==r){a>0&&(e[a-1]._parent=void 0,e[a-1]._length=1),e[r]._parent=void 0,e[r]._length=1;var c=r>0?e[r-1]:this;t-1>a?(c._parent=e[a+1],c._parent.uncycle(),c._length=c._parent._length+1):(c._parent=void 0,c._length=1);for(var u=c._length+1,l=r-2;l>=0;--l)e[l]._length=u,u++;return}}}},V.prototype.attachExtraTrace=function(t){if(!t.__stackCleaned__){this.uncycle();for(var e=F(t),n=e.message,r=[e.stack],i=this;void 0!==i;)r.push(k(i.stack.split("\n"))),i=i._parent;j(r),C(r),B.notEnumerableProp(t,"stack",w(n,r)),B.notEnumerableProp(t,"__stackCleaned__",!0)}};var ut=function(){var t=/^\s*at\s*/,e=function(t,e){return"string"==typeof t?t:void 0!==e.name&&void 0!==e.message?e.toString():P(e)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,z=t,X=e;var n=Error.captureStackTrace;return at=function(t){return $.test(t)},function(t,e){Error.stackTraceLimit+=6,n(t,e),Error.stackTraceLimit-=6}}var r=new Error;if("string"==typeof r.stack&&r.stack.split("\n")[0].indexOf("stackDetection@")>=0)return z=/@/,X=e,W=!0,function(t){t.stack=(new Error).stack};var i;try{throw new Error}catch(o){i="stack"in o}return"stack"in r||!i||"number"!=typeof Error.stackTraceLimit?(X=function(t,e){return"string"==typeof t?t:"object"!=typeof e&&"function"!=typeof e||void 0===e.name||void 0===e.message?P(e):e.toString()},null):(z=t,X=e,function(t){Error.stackTraceLimit+=6;try{throw new Error}catch(e){t.stack=e.stack}Error.stackTraceLimit-=6})}([]);"undefined"!=typeof console&&"undefined"!=typeof console.warn&&(I=function(t){console.warn(t)},B.isNode&&process.stderr.isTTY?I=function(t,e){var n=e?"[33m":"[31m";console.warn(n+t+"[0m\n")}:B.isNode||"string"!=typeof(new Error).stack||(I=function(t,e){console.warn("%c"+t,e?"color: darkorange":"color: red")}));var lt={warnings:J,longStackTraces:!1,cancellation:!1,monitoring:!1,asyncHooks:!1};return Y&&e.longStackTraces(),{asyncHooks:function(){return lt.asyncHooks},longStackTraces:function(){return lt.longStackTraces},warnings:function(){return lt.warnings},cancellation:function(){return lt.cancellation},monitoring:function(){return lt.monitoring},propagateFromFunction:function(){return st},boundValueFunction:function(){return _},checkForgottenReturns:g,setBounds:A,warn:b,deprecated:m,CapturedTrace:V,fireDomEvent:nt,fireGlobalEvent:rt}}},{"./errors":12,"./es5":13,"./util":36}],10:[function(t,e,n){"use strict";e.exports=function(t){function e(){return this.value}function n(){throw this.reason}t.prototype["return"]=t.prototype.thenReturn=function(n){return n instanceof t&&n.suppressUnhandledRejections(),this._then(e,void 0,void 0,{value:n},void 0)},t.prototype["throw"]=t.prototype.thenThrow=function(t){return this._then(n,void 0,void 0,{reason:t},void 0)},t.prototype.catchThrow=function(t){if(arguments.length<=1)return this._then(void 0,n,void 0,{reason:t},void 0);var e=arguments[1],r=function(){throw e};return this.caught(t,r)},t.prototype.catchReturn=function(n){if(arguments.length<=1)return n instanceof t&&n.suppressUnhandledRejections(),this._then(void 0,e,void 0,{value:n},void 0);var r=arguments[1];r instanceof t&&r.suppressUnhandledRejections();var i=function(){return r};return this.caught(n,i)}}},{}],11:[function(t,e,n){"use strict";e.exports=function(t,e){function n(){return o(this)}function r(t,n){return i(t,n,e,e)}var i=t.reduce,o=t.all;t.prototype.each=function(t){return i(this,t,e,0)._then(n,void 0,void 0,this,void 0)},t.prototype.mapSeries=function(t){return i(this,t,e,e)},t.each=function(t,r){return i(t,r,e,0)._then(n,void 0,void 0,t,void 0)},t.mapSeries=r}},{}],12:[function(t,e,n){"use strict";function r(t,e){function n(r){return this instanceof n?(p(this,"message","string"==typeof r?r:e),p(this,"name",t),void(Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this))):new n(r)}return l(n,Error),n}function i(t){return this instanceof i?(p(this,"name","OperationalError"),p(this,"message",t),this.cause=t,this.isOperational=!0,void(t instanceof Error?(p(this,"message",t.message),p(this,"stack",t.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor))):new i(t)}var o,s,a=t("./es5"),c=a.freeze,u=t("./util"),l=u.inherits,p=u.notEnumerableProp,f=r("Warning","warning"),h=r("CancellationError","cancellation error"),_=r("TimeoutError","timeout error"),d=r("AggregateError","aggregate error");try{o=TypeError,s=RangeError}catch(v){o=r("TypeError","type error"),s=r("RangeError","range error")}for(var y="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),g=0;g<y.length;++g)"function"==typeof Array.prototype[y[g]]&&(d.prototype[y[g]]=Array.prototype[y[g]]);a.defineProperty(d.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),d.prototype.isOperational=!0;var m=0;d.prototype.toString=function(){var t=Array(4*m+1).join(" "),e="\n"+t+"AggregateError of:\n";m++,t=Array(4*m+1).join(" ");for(var n=0;n<this.length;++n){for(var r=this[n]===this?"[Circular AggregateError]":this[n]+"",i=r.split("\n"),o=0;o<i.length;++o)i[o]=t+i[o];r=i.join("\n"),e+=r+"\n"}return m--,e},l(i,Error);var b=Error.__BluebirdErrorTypes__;b||(b=c({CancellationError:h,TimeoutError:_,OperationalError:i,RejectionError:i,AggregateError:d}),a.defineProperty(Error,"__BluebirdErrorTypes__",{value:b,writable:!1,enumerable:!1,configurable:!1})),e.exports={Error:Error,TypeError:o,RangeError:s,CancellationError:b.CancellationError,OperationalError:b.OperationalError,TimeoutError:b.TimeoutError,AggregateError:b.AggregateError,Warning:f}},{"./es5":13,"./util":36}],13:[function(t,e,n){var r=function(){"use strict";return void 0===this}();if(r)e.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:r,propertyIsWritable:function(t,e){var n=Object.getOwnPropertyDescriptor(t,e);return!(n&&!n.writable&&!n.set)}};else{var i={}.hasOwnProperty,o={}.toString,s={}.constructor.prototype,a=function(t){var e=[];for(var n in t)i.call(t,n)&&e.push(n);return e},c=function(t,e){return{value:t[e]}},u=function(t,e,n){return t[e]=n.value,t},l=function(t){return t},p=function(t){try{return Object(t).constructor.prototype}catch(e){return s}},f=function(t){try{return"[object Array]"===o.call(t)}catch(e){return!1}};e.exports={isArray:f,keys:a,names:a,defineProperty:u,getDescriptor:c,freeze:l,getPrototypeOf:p,isES5:r,propertyIsWritable:function(){return!0}}}},{}],14:[function(t,e,n){"use strict";e.exports=function(t,e){var n=t.map;t.prototype.filter=function(t,r){return n(this,t,r,e)},t.filter=function(t,r,i){return n(t,r,i,e)}}},{}],15:[function(t,e,n){"use strict";e.exports=function(e,n,r){function i(t,e,n){this.promise=t,this.type=e,this.handler=n,this.called=!1,this.cancelPromise=null}function o(t){this.finallyHandler=t}function s(t,e){return null!=t.cancelPromise?(arguments.length>1?t.cancelPromise._reject(e):t.cancelPromise._cancel(),t.cancelPromise=null,!0):!1}function a(){return u.call(this,this.promise._target()._settledValue())}function c(t){return s(this,t)?void 0:(f.e=t,f)}function u(t){var i=this.promise,u=this.handler;if(!this.called){this.called=!0;var l=this.isFinallyHandler()?u.call(i._boundValue()):u.call(i._boundValue(),t);if(l===r)return l;if(void 0!==l){i._setReturnedNonUndefined();var h=n(l,i);if(h instanceof e){if(null!=this.cancelPromise){if(h._isCancelled()){var _=new p("late cancellation observer");return i._attachExtraTrace(_),f.e=_,f}h.isPending()&&h._attachCancellationCallback(new o(this))}return h._then(a,c,void 0,this,void 0)}}}return i.isRejected()?(s(this),f.e=t,f):(s(this),t)}var l=t("./util"),p=e.CancellationError,f=l.errorObj,h=t("./catch_filter")(r);return i.prototype.isFinallyHandler=function(){return 0===this.type},o.prototype._resultCancelled=function(){s(this.finallyHandler)},e.prototype._passThrough=function(t,e,n,r){return"function"!=typeof t?this.then():this._then(n,r,void 0,new i(this,e,t),void 0)},e.prototype.lastly=e.prototype["finally"]=function(t){return this._passThrough(t,0,u,u)},e.prototype.tap=function(t){return this._passThrough(t,1,u)},e.prototype.tapCatch=function(t){var n=arguments.length;if(1===n)return this._passThrough(t,1,void 0,u);var r,i=new Array(n-1),o=0;for(r=0;n-1>r;++r){var s=arguments[r];if(!l.isObject(s))return e.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+l.classString(s)));i[o++]=s}i.length=o;var a=arguments[r];return this._passThrough(h(i,a,this),1,void 0,u)},i}},{"./catch_filter":7,"./util":36}],16:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,s){function a(t,n,r){for(var o=0;o<n.length;++o){r._pushContext();var s=h(n[o])(t);if(r._popContext(),s===f){r._pushContext();var a=e.reject(f.e);return r._popContext(),a}var c=i(s,r);if(c instanceof e)return c}return null}function c(t,n,i,o){if(s.cancellation()){var a=new e(r),c=this._finallyPromise=new e(r);this._promise=a.lastly(function(){return c}),a._captureStackTrace(),a._setOnCancel(this)}else{var u=this._promise=new e(r);u._captureStackTrace()}this._stack=o,this._generatorFunction=t,this._receiver=n,this._generator=void 0,this._yieldHandlers="function"==typeof i?[i].concat(_):_,this._yieldedPromise=null,this._cancellationPhase=!1}var u=t("./errors"),l=u.TypeError,p=t("./util"),f=p.errorObj,h=p.tryCatch,_=[];p.inherits(c,o),c.prototype._isResolved=function(){return null===this._promise},c.prototype._cleanup=function(){this._promise=this._generator=null,s.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},c.prototype._promiseCancelled=function(){if(!this._isResolved()){var t,n="undefined"!=typeof this._generator["return"];if(n)this._promise._pushContext(),t=h(this._generator["return"]).call(this._generator,void 0),this._promise._popContext();else{var r=new e.CancellationError("generator .return() sentinel");e.coroutine.returnSentinel=r,this._promise._attachExtraTrace(r),this._promise._pushContext(),t=h(this._generator["throw"]).call(this._generator,r),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(t)}},c.prototype._promiseFulfilled=function(t){this._yieldedPromise=null,this._promise._pushContext();var e=h(this._generator.next).call(this._generator,t);this._promise._popContext(),this._continue(e)},c.prototype._promiseRejected=function(t){this._yieldedPromise=null,this._promise._attachExtraTrace(t),this._promise._pushContext();var e=h(this._generator["throw"]).call(this._generator,t);this._promise._popContext(),this._continue(e)},c.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof e){var t=this._yieldedPromise;this._yieldedPromise=null,t.cancel()}},c.prototype.promise=function(){return this._promise},c.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},c.prototype._continue=function(t){var n=this._promise;if(t===f)return this._cleanup(),this._cancellationPhase?n.cancel():n._rejectCallback(t.e,!1);var r=t.value;if(t.done===!0)return this._cleanup(),this._cancellationPhase?n.cancel():n._resolveCallback(r);
var o=i(r,this._promise);if(!(o instanceof e)&&(o=a(o,this._yieldHandlers,this._promise),null===o))return void this._promiseRejected(new l("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",String(r))+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")));o=o._target();var s=o._bitField;0===(50397184&s)?(this._yieldedPromise=o,o._proxy(this,null)):0!==(33554432&s)?e._async.invoke(this._promiseFulfilled,this,o._value()):0!==(16777216&s)?e._async.invoke(this._promiseRejected,this,o._reason()):this._promiseCancelled()},e.coroutine=function(t,e){if("function"!=typeof t)throw new l("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var n=Object(e).yieldHandler,r=c,i=(new Error).stack;return function(){var e=t.apply(this,arguments),o=new r(void 0,void 0,n,i),s=o.promise();return o._generator=e,o._promiseFulfilled(void 0),s}},e.coroutine.addYieldHandler=function(t){if("function"!=typeof t)throw new l("expecting a function but got "+p.classString(t));_.push(t)},e.spawn=function(t){if(s.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof t)return n("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var r=new c(t,this),i=r.promise();return r._run(e.spawn),i}}},{"./errors":12,"./util":36}],17:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o){var s=t("./util");s.canEvaluate,s.tryCatch,s.errorObj;e.join=function(){var t,e=arguments.length-1;if(e>0&&"function"==typeof arguments[e]){t=arguments[e];var r}var i=[].slice.call(arguments);t&&i.pop();var r=new n(i).promise();return void 0!==t?r.spread(t):r}}},{"./util":36}],18:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,s){function a(t,n,r,i){this.constructor$(t),this._promise._captureStackTrace();var s=e._getContext();if(this._callback=u.contextBind(s,n),this._preservedValues=i===o?new Array(this.length()):null,this._limit=r,this._inFlight=0,this._queue=[],f.invoke(this._asyncInit,this,void 0),u.isArray(t))for(var a=0;a<t.length;++a){var c=t[a];c instanceof e&&c.suppressUnhandledRejections()}}function c(t,n,i,o){if("function"!=typeof n)return r("expecting a function but got "+u.classString(n));var s=0;if(void 0!==i){if("object"!=typeof i||null===i)return e.reject(new TypeError("options argument must be an object but it is "+u.classString(i)));if("number"!=typeof i.concurrency)return e.reject(new TypeError("'concurrency' must be a number but it is "+u.classString(i.concurrency)));s=i.concurrency}return s="number"==typeof s&&isFinite(s)&&s>=1?s:0,new a(t,n,s,o).promise()}var u=t("./util"),l=u.tryCatch,p=u.errorObj,f=e._async;u.inherits(a,n),a.prototype._asyncInit=function(){this._init$(void 0,-2)},a.prototype._init=function(){},a.prototype._promiseFulfilled=function(t,n){var r=this._values,o=this.length(),a=this._preservedValues,c=this._limit;if(0>n){if(n=-1*n-1,r[n]=t,c>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(c>=1&&this._inFlight>=c)return r[n]=t,this._queue.push(n),!1;null!==a&&(a[n]=t);var u=this._promise,f=this._callback,h=u._boundValue();u._pushContext();var _=l(f).call(h,t,n,o),d=u._popContext();if(s.checkForgottenReturns(_,d,null!==a?"Promise.filter":"Promise.map",u),_===p)return this._reject(_.e),!0;var v=i(_,this._promise);if(v instanceof e){v=v._target();var y=v._bitField;if(0===(50397184&y))return c>=1&&this._inFlight++,r[n]=v,v._proxy(this,-1*(n+1)),!1;if(0===(33554432&y))return 0!==(16777216&y)?(this._reject(v._reason()),!0):(this._cancel(),!0);_=v._value()}r[n]=_}var g=++this._totalResolved;return g>=o?(null!==a?this._filter(r,a):this._resolve(r),!0):!1},a.prototype._drainQueue=function(){for(var t=this._queue,e=this._limit,n=this._values;t.length>0&&this._inFlight<e;){if(this._isResolved())return;var r=t.pop();this._promiseFulfilled(n[r],r)}},a.prototype._filter=function(t,e){for(var n=e.length,r=new Array(n),i=0,o=0;n>o;++o)t[o]&&(r[i++]=e[o]);r.length=i,this._resolve(r)},a.prototype.preservedValues=function(){return this._preservedValues},e.prototype.map=function(t,e){return c(this,t,e,null)},e.map=function(t,e,n,r){return c(t,e,n,r)}}},{"./util":36}],19:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o){var s=t("./util"),a=s.tryCatch;e.method=function(t){if("function"!=typeof t)throw new e.TypeError("expecting a function but got "+s.classString(t));return function(){var r=new e(n);r._captureStackTrace(),r._pushContext();var i=a(t).apply(this,arguments),s=r._popContext();return o.checkForgottenReturns(i,s,"Promise.method",r),r._resolveFromSyncValue(i),r}},e.attempt=e["try"]=function(t){if("function"!=typeof t)return i("expecting a function but got "+s.classString(t));var r=new e(n);r._captureStackTrace(),r._pushContext();var c;if(arguments.length>1){o.deprecated("calling Promise.try with more than 1 argument");var u=arguments[1],l=arguments[2];c=s.isArray(u)?a(t).apply(l,u):a(t).call(l,u)}else c=a(t)();var p=r._popContext();return o.checkForgottenReturns(c,p,"Promise.try",r),r._resolveFromSyncValue(c),r},e.prototype._resolveFromSyncValue=function(t){t===s.errorObj?this._rejectCallback(t.e,!1):this._resolveCallback(t,!0)}}},{"./util":36}],20:[function(t,e,n){"use strict";function r(t){return t instanceof Error&&l.getPrototypeOf(t)===Error.prototype}function i(t){var e;if(r(t)){e=new u(t),e.name=t.name,e.message=t.message,e.stack=t.stack;for(var n=l.keys(t),i=0;i<n.length;++i){var o=n[i];p.test(o)||(e[o]=t[o])}return e}return s.markAsOriginatingFromRejection(t),t}function o(t,e){return function(n,r){if(null!==t){if(n){var o=i(a(n));t._attachExtraTrace(o),t._reject(o)}else if(e){var s=[].slice.call(arguments,1);t._fulfill(s)}else t._fulfill(r);t=null}}}var s=t("./util"),a=s.maybeWrapAsError,c=t("./errors"),u=c.OperationalError,l=t("./es5"),p=/^(?:name|message|stack|cause)$/;e.exports=o},{"./errors":12,"./es5":13,"./util":36}],21:[function(t,e,n){"use strict";e.exports=function(e){function n(t,e){var n=this;if(!o.isArray(t))return r.call(n,t,e);var i=a(e).apply(n._boundValue(),[null].concat(t));i===c&&s.throwLater(i.e)}function r(t,e){var n=this,r=n._boundValue(),i=void 0===t?a(e).call(r,null):a(e).call(r,null,t);i===c&&s.throwLater(i.e)}function i(t,e){var n=this;if(!t){var r=new Error(t+"");r.cause=t,t=r}var i=a(e).call(n._boundValue(),t);i===c&&s.throwLater(i.e)}var o=t("./util"),s=e._async,a=o.tryCatch,c=o.errorObj;e.prototype.asCallback=e.prototype.nodeify=function(t,e){if("function"==typeof t){var o=r;void 0!==e&&Object(e).spread&&(o=n),this._then(o,i,void 0,this,t)}return this}}},{"./util":36}],22:[function(t,e,n){"use strict";e.exports=function(){function n(){}function r(t,e){if(null==t||(t.constructor!==i&&"undefined"!=typeof Promise&&t.constructor!==Promise))throw new E("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof e)throw new E("expecting a function but got "+f.classString(e))}function i(t){t!==x&&r(this,t),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(t),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function o(t){this.promise._resolveCallback(t)}function s(t){this.promise._rejectCallback(t,!1)}function a(t){var e=new i(x);e._fulfillmentHandler0=t,e._rejectionHandler0=t,e._promise0=t,e._receiver0=t}var c=function(){return new E("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},u=function(){return new i.PromiseInspection(this._target())},l=function(t){return i.reject(new E(t))},p={},f=t("./util");f.setReflectHandler(u);var h=function(){var t=process.domain;return void 0===t?null:t},_=function(){return null},d=function(){return{domain:h(),async:null}},v=f.isNode&&f.nodeSupportsAsyncResource?t("async_hooks").AsyncResource:null,y=function(){return{domain:h(),async:new v("Bluebird::Promise")}},g=f.isNode?d:_;f.notEnumerableProp(i,"_getContext",g);var m=function(){g=y,f.notEnumerableProp(i,"_getContext",y)},b=function(){g=d,f.notEnumerableProp(i,"_getContext",d)},w=t("./es5"),C=t("./async"),j=new C;w.defineProperty(i,"_async",{value:j});var k=t("./errors"),E=i.TypeError=k.TypeError;i.RangeError=k.RangeError;var F=i.CancellationError=k.CancellationError;i.TimeoutError=k.TimeoutError,i.OperationalError=k.OperationalError,i.RejectionError=k.OperationalError,i.AggregateError=k.AggregateError;var x=function(){},T={},P={},R=t("./thenables")(i,x),S=t("./promise_array")(i,x,R,l,n),O=t("./context")(i),A=O.create,V=t("./debuggability")(i,O,m,b),H=(V.CapturedTrace,t("./finally")(i,R,P)),D=t("./catch_filter")(P),I=t("./nodeback"),L=f.errorObj,N=f.tryCatch;return i.prototype.toString=function(){return"[object Promise]"},i.prototype.caught=i.prototype["catch"]=function(t){var e=arguments.length;if(e>1){var n,r=new Array(e-1),i=0;for(n=0;e-1>n;++n){var o=arguments[n];if(!f.isObject(o))return l("Catch statement predicate: expecting an object but got "+f.classString(o));r[i++]=o}if(r.length=i,t=arguments[n],"function"!=typeof t)throw new E("The last argument to .catch() must be a function, got "+f.toString(t));return this.then(void 0,D(r,t,this))}return this.then(void 0,t)},i.prototype.reflect=function(){return this._then(u,u,void 0,this,void 0)},i.prototype.then=function(t,e){if(V.warnings()&&arguments.length>0&&"function"!=typeof t&&"function"!=typeof e){var n=".then() only accepts functions but was passed: "+f.classString(t);arguments.length>1&&(n+=", "+f.classString(e)),this._warn(n)}return this._then(t,e,void 0,void 0,void 0)},i.prototype.done=function(t,e){var n=this._then(t,e,void 0,void 0,void 0);n._setIsFinal()},i.prototype.spread=function(t){return"function"!=typeof t?l("expecting a function but got "+f.classString(t)):this.all()._then(t,void 0,void 0,T,void 0)},i.prototype.toJSON=function(){var t={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(t.fulfillmentValue=this.value(),t.isFulfilled=!0):this.isRejected()&&(t.rejectionReason=this.reason(),t.isRejected=!0),t},i.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new S(this).promise()},i.prototype.error=function(t){return this.caught(f.originatesFromRejection,t)},i.getNewLibraryCopy=e.exports,i.is=function(t){return t instanceof i},i.fromNode=i.fromCallback=function(t){var e=new i(x);e._captureStackTrace();var n=arguments.length>1?!!Object(arguments[1]).multiArgs:!1,r=N(t)(I(e,n));return r===L&&e._rejectCallback(r.e,!0),e._isFateSealed()||e._setAsyncGuaranteed(),e},i.all=function(t){return new S(t).promise()},i.cast=function(t){var e=R(t);return e instanceof i||(e=new i(x),e._captureStackTrace(),e._setFulfilled(),e._rejectionHandler0=t),e},i.resolve=i.fulfilled=i.cast,i.reject=i.rejected=function(t){var e=new i(x);return e._captureStackTrace(),e._rejectCallback(t,!0),e},i.setScheduler=function(t){if("function"!=typeof t)throw new E("expecting a function but got "+f.classString(t));return j.setScheduler(t)},i.prototype._then=function(t,e,n,r,o){var s=void 0!==o,a=s?o:new i(x),c=this._target(),u=c._bitField;s||(a._propagateFrom(this,3),a._captureStackTrace(),void 0===r&&0!==(2097152&this._bitField)&&(r=0!==(50397184&u)?this._boundValue():c===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,a));var l=g();if(0!==(50397184&u)){var p,h,_=c._settlePromiseCtx;0!==(33554432&u)?(h=c._rejectionHandler0,p=t):0!==(16777216&u)?(h=c._fulfillmentHandler0,p=e,c._unsetRejectionIsUnhandled()):(_=c._settlePromiseLateCancellationObserver,h=new F("late cancellation observer"),c._attachExtraTrace(h),p=e),j.invoke(_,c,{handler:f.contextBind(l,p),promise:a,receiver:r,value:h})}else c._addCallbacks(t,e,a,r,l);return a},i.prototype._length=function(){return 65535&this._bitField},i.prototype._isFateSealed=function(){return 0!==(117506048&this._bitField)},i.prototype._isFollowing=function(){return 67108864===(67108864&this._bitField)},i.prototype._setLength=function(t){this._bitField=-65536&this._bitField|65535&t},i.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},i.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},i.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},i.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},i.prototype._isFinal=function(){return(4194304&this._bitField)>0},i.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},i.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},i.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},i.prototype._setAsyncGuaranteed=function(){if(!j.hasCustomScheduler()){var t=this._bitField;this._bitField=t|(536870912&t)>>2^134217728}},i.prototype._setNoAsyncGuarantee=function(){this._bitField=-134217729&(536870912|this._bitField)},i.prototype._receiverAt=function(t){var e=0===t?this._receiver0:this[4*t-4+3];return e===p?void 0:void 0===e&&this._isBound()?this._boundValue():e},i.prototype._promiseAt=function(t){return this[4*t-4+2]},i.prototype._fulfillmentHandlerAt=function(t){return this[4*t-4+0]},i.prototype._rejectionHandlerAt=function(t){return this[4*t-4+1]},i.prototype._boundValue=function(){},i.prototype._migrateCallback0=function(t){var e=(t._bitField,t._fulfillmentHandler0),n=t._rejectionHandler0,r=t._promise0,i=t._receiverAt(0);void 0===i&&(i=p),this._addCallbacks(e,n,r,i,null)},i.prototype._migrateCallbackAt=function(t,e){var n=t._fulfillmentHandlerAt(e),r=t._rejectionHandlerAt(e),i=t._promiseAt(e),o=t._receiverAt(e);void 0===o&&(o=p),this._addCallbacks(n,r,i,o,null)},i.prototype._addCallbacks=function(t,e,n,r,i){var o=this._length();if(o>=65531&&(o=0,this._setLength(0)),0===o)this._promise0=n,this._receiver0=r,"function"==typeof t&&(this._fulfillmentHandler0=f.contextBind(i,t)),"function"==typeof e&&(this._rejectionHandler0=f.contextBind(i,e));else{var s=4*o-4;this[s+2]=n,this[s+3]=r,"function"==typeof t&&(this[s+0]=f.contextBind(i,t)),"function"==typeof e&&(this[s+1]=f.contextBind(i,e))}return this._setLength(o+1),o},i.prototype._proxy=function(t,e){this._addCallbacks(void 0,void 0,e,t,null)},i.prototype._resolveCallback=function(t,e){if(0===(117506048&this._bitField)){if(t===this)return this._rejectCallback(c(),!1);var n=R(t,this);if(!(n instanceof i))return this._fulfill(t);e&&this._propagateFrom(n,2);var r=n._target();if(r===this)return void this._reject(c());var o=r._bitField;if(0===(50397184&o)){var s=this._length();s>0&&r._migrateCallback0(this);for(var a=1;s>a;++a)r._migrateCallbackAt(this,a);this._setFollowing(),this._setLength(0),this._setFollowee(n)}else if(0!==(33554432&o))this._fulfill(r._value());else if(0!==(16777216&o))this._reject(r._reason());else{var u=new F("late cancellation observer");r._attachExtraTrace(u),this._reject(u)}}},i.prototype._rejectCallback=function(t,e,n){var r=f.ensureErrorObject(t),i=r===t;if(!i&&!n&&V.warnings()){var o="a promise was rejected with a non-error: "+f.classString(t);this._warn(o,!0)}this._attachExtraTrace(r,e?i:!1),this._reject(t)},i.prototype._resolveFromExecutor=function(t){if(t!==x){var e=this;this._captureStackTrace(),this._pushContext();var n=!0,r=this._execute(t,function(t){e._resolveCallback(t)},function(t){e._rejectCallback(t,n)});n=!1,this._popContext(),void 0!==r&&e._rejectCallback(r,!0)}},i.prototype._settlePromiseFromHandler=function(t,e,n,r){var i=r._bitField;if(0===(65536&i)){r._pushContext();var o;e===T?n&&"number"==typeof n.length?o=N(t).apply(this._boundValue(),n):(o=L,o.e=new E("cannot .spread() a non-array: "+f.classString(n))):o=N(t).call(e,n);var s=r._popContext();i=r._bitField,0===(65536&i)&&(o===P?r._reject(n):o===L?r._rejectCallback(o.e,!1):(V.checkForgottenReturns(o,s,"",r,this),r._resolveCallback(o)))}},i.prototype._target=function(){for(var t=this;t._isFollowing();)t=t._followee();return t},i.prototype._followee=function(){return this._rejectionHandler0},i.prototype._setFollowee=function(t){this._rejectionHandler0=t},i.prototype._settlePromise=function(t,e,r,o){var s=t instanceof i,a=this._bitField,c=0!==(134217728&a);0!==(65536&a)?(s&&t._invokeInternalOnCancel(),r instanceof H&&r.isFinallyHandler()?(r.cancelPromise=t,N(e).call(r,o)===L&&t._reject(L.e)):e===u?t._fulfill(u.call(r)):r instanceof n?r._promiseCancelled(t):s||t instanceof S?t._cancel():r.cancel()):"function"==typeof e?s?(c&&t._setAsyncGuaranteed(),this._settlePromiseFromHandler(e,r,o,t)):e.call(r,o,t):r instanceof n?r._isResolved()||(0!==(33554432&a)?r._promiseFulfilled(o,t):r._promiseRejected(o,t)):s&&(c&&t._setAsyncGuaranteed(),0!==(33554432&a)?t._fulfill(o):t._reject(o))},i.prototype._settlePromiseLateCancellationObserver=function(t){var e=t.handler,n=t.promise,r=t.receiver,o=t.value;"function"==typeof e?n instanceof i?this._settlePromiseFromHandler(e,r,o,n):e.call(r,o,n):n instanceof i&&n._reject(o)},i.prototype._settlePromiseCtx=function(t){this._settlePromise(t.promise,t.handler,t.receiver,t.value)},i.prototype._settlePromise0=function(t,e,n){var r=this._promise0,i=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(r,t,i,e)},i.prototype._clearCallbackDataAtIndex=function(t){var e=4*t-4;this[e+2]=this[e+3]=this[e+0]=this[e+1]=void 0},i.prototype._fulfill=function(t){var e=this._bitField;if(!((117506048&e)>>>16)){if(t===this){var n=c();return this._attachExtraTrace(n),this._reject(n)}this._setFulfilled(),this._rejectionHandler0=t,(65535&e)>0&&(0!==(134217728&e)?this._settlePromises():j.settlePromises(this),this._dereferenceTrace())}},i.prototype._reject=function(t){var e=this._bitField;if(!((117506048&e)>>>16))return this._setRejected(),this._fulfillmentHandler0=t,this._isFinal()?j.fatalError(t,f.isNode):void((65535&e)>0?j.settlePromises(this):this._ensurePossibleRejectionHandled())},i.prototype._fulfillPromises=function(t,e){for(var n=1;t>n;n++){var r=this._fulfillmentHandlerAt(n),i=this._promiseAt(n),o=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(i,r,o,e)}},i.prototype._rejectPromises=function(t,e){for(var n=1;t>n;n++){var r=this._rejectionHandlerAt(n),i=this._promiseAt(n),o=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(i,r,o,e)}},i.prototype._settlePromises=function(){var t=this._bitField,e=65535&t;if(e>0){if(0!==(16842752&t)){var n=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,n,t),this._rejectPromises(e,n)}else{var r=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,r,t),this._fulfillPromises(e,r)}this._setLength(0)}this._clearCancellationData()},i.prototype._settledValue=function(){var t=this._bitField;return 0!==(33554432&t)?this._rejectionHandler0:0!==(16777216&t)?this._fulfillmentHandler0:void 0},"undefined"!=typeof Symbol&&Symbol.toStringTag&&w.defineProperty(i.prototype,Symbol.toStringTag,{get:function(){return"Object"}}),i.defer=i.pending=function(){V.deprecated("Promise.defer","new Promise");var t=new i(x);return{promise:t,resolve:o,reject:s}},f.notEnumerableProp(i,"_makeSelfResolutionError",c),t("./method")(i,x,R,l,V),t("./bind")(i,x,R,V),t("./cancel")(i,S,l,V),t("./direct_resolve")(i),t("./synchronous_inspection")(i),t("./join")(i,S,R,x,j),i.Promise=i,i.version="3.7.2",t("./call_get.js")(i),t("./generators.js")(i,l,x,R,n,V),t("./map.js")(i,S,l,R,x,V),t("./nodeify.js")(i),t("./promisify.js")(i,x),t("./props.js")(i,S,R,l),t("./race.js")(i,x,R,l),t("./reduce.js")(i,S,l,R,x,V),t("./settle.js")(i,S,V),t("./some.js")(i,S,l),t("./timers.js")(i,x,V),t("./using.js")(i,l,R,A,x,V),t("./any.js")(i),t("./each.js")(i,x),t("./filter.js")(i,x),f.toFastProperties(i),f.toFastProperties(i.prototype),a({a:1}),a({b:2}),a({c:3}),a(1),a(function(){}),a(void 0),a(!1),a(new i(x)),V.setBounds(C.firstLineError,f.lastLineError),i}},{"./any.js":1,"./async":2,"./bind":3,"./call_get.js":5,"./cancel":6,"./catch_filter":7,"./context":8,"./debuggability":9,"./direct_resolve":10,"./each.js":11,"./errors":12,"./es5":13,"./filter.js":14,"./finally":15,"./generators.js":16,"./join":17,"./map.js":18,"./method":19,"./nodeback":20,"./nodeify.js":21,"./promise_array":23,"./promisify.js":24,"./props.js":25,"./race.js":27,"./reduce.js":28,"./settle.js":30,"./some.js":31,"./synchronous_inspection":32,"./thenables":33,"./timers.js":34,"./using.js":35,"./util":36,async_hooks:void 0}],23:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o){function s(t){switch(t){case-2:return[];case-3:return{};case-6:return new Map}}function a(t){var r=this._promise=new e(n);t instanceof e&&(r._propagateFrom(t,3),t.suppressUnhandledRejections()),r._setOnCancel(this),this._values=t,this._length=0,this._totalResolved=0,this._init(void 0,-2)}var c=t("./util");c.isArray;return c.inherits(a,o),a.prototype.length=function(){return this._length},a.prototype.promise=function(){return this._promise},a.prototype._init=function u(t,n){var o=r(this._values,this._promise);if(o instanceof e){o=o._target();var a=o._bitField;if(this._values=o,0===(50397184&a))return this._promise._setAsyncGuaranteed(),o._then(u,this._reject,void 0,this,n);if(0===(33554432&a))return 0!==(16777216&a)?this._reject(o._reason()):this._cancel();o=o._value()}if(o=c.asArray(o),null===o){var l=i("expecting an array or an iterable object but got "+c.classString(o)).reason();return void this._promise._rejectCallback(l,!1)}return 0===o.length?void(-5===n?this._resolveEmptyArray():this._resolve(s(n))):void this._iterate(o)},a.prototype._iterate=function(t){var n=this.getActualLength(t.length);this._length=n,this._values=this.shouldCopyValues()?new Array(n):this._values;for(var i=this._promise,o=!1,s=null,a=0;n>a;++a){var c=r(t[a],i);c instanceof e?(c=c._target(),s=c._bitField):s=null,o?null!==s&&c.suppressUnhandledRejections():null!==s?0===(50397184&s)?(c._proxy(this,a),this._values[a]=c):o=0!==(33554432&s)?this._promiseFulfilled(c._value(),a):0!==(16777216&s)?this._promiseRejected(c._reason(),a):this._promiseCancelled(a):o=this._promiseFulfilled(c,a)}o||i._setAsyncGuaranteed()},a.prototype._isResolved=function(){return null===this._values},a.prototype._resolve=function(t){this._values=null,this._promise._fulfill(t)},a.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},a.prototype._reject=function(t){this._values=null,this._promise._rejectCallback(t,!1)},a.prototype._promiseFulfilled=function(t,e){this._values[e]=t;var n=++this._totalResolved;return n>=this._length?(this._resolve(this._values),!0):!1},a.prototype._promiseCancelled=function(){return this._cancel(),!0},a.prototype._promiseRejected=function(t){return this._totalResolved++,this._reject(t),!0},a.prototype._resultCancelled=function(){if(!this._isResolved()){var t=this._values;if(this._cancel(),t instanceof e)t.cancel();else for(var n=0;n<t.length;++n)t[n]instanceof e&&t[n].cancel()}},a.prototype.shouldCopyValues=function(){return!0},a.prototype.getActualLength=function(t){return t},a}},{"./util":36}],24:[function(t,e,n){"use strict";e.exports=function(e,n){function r(t){return!C.test(t)}function i(t){try{return t.__isPromisified__===!0}catch(e){return!1}}function o(t,e,n){var r=h.getDataPropertyOrDefault(t,e+n,b);return r?i(r):!1}function s(t,e,n){for(var r=0;r<t.length;r+=2){var i=t[r];if(n.test(i))for(var o=i.replace(n,""),s=0;s<t.length;s+=2)if(t[s]===o)throw new g("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",e))}}function a(t,e,n,r){for(var a=h.inheritedDataKeys(t),c=[],u=0;u<a.length;++u){var l=a[u],p=t[l],f=r===j?!0:j(l,p,t);"function"!=typeof p||i(p)||o(t,l,e)||!r(l,p,t,f)||c.push(l,p)}return s(c,e,n),c}function c(t,r,i,o,s,a){function c(){var i=r;r===f&&(i=this);var o=new e(n);o._captureStackTrace();var s="string"==typeof l&&this!==u?this[l]:t,c=_(o,a);try{s.apply(i,d(arguments,c))}catch(p){o._rejectCallback(v(p),!0,!0)}return o._isFateSealed()||o._setAsyncGuaranteed(),o}var u=function(){return this}(),l=t;return"string"==typeof l&&(t=o),h.notEnumerableProp(c,"__isPromisified__",!0),c}function u(t,e,n,r,i){for(var o=new RegExp(k(e)+"$"),s=a(t,e,o,n),c=0,u=s.length;u>c;c+=2){var l=s[c],p=s[c+1],_=l+e;if(r===E)t[_]=E(l,f,l,p,e,i);else{var d=r(p,function(){return E(l,f,l,p,e,i)});h.notEnumerableProp(d,"__isPromisified__",!0),t[_]=d}}return h.toFastProperties(t),t}function l(t,e,n){return E(t,e,void 0,t,null,n)}var p,f={},h=t("./util"),_=t("./nodeback"),d=h.withAppended,v=h.maybeWrapAsError,y=h.canEvaluate,g=t("./errors").TypeError,m="Async",b={__isPromisified__:!0},w=["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"],C=new RegExp("^(?:"+w.join("|")+")$"),j=function(t){return h.isIdentifier(t)&&"_"!==t.charAt(0)&&"constructor"!==t},k=function(t){return t.replace(/([$])/,"\\$")},E=y?p:c;e.promisify=function(t,e){if("function"!=typeof t)throw new g("expecting a function but got "+h.classString(t));if(i(t))return t;e=Object(e);var n=void 0===e.context?f:e.context,o=!!e.multiArgs,s=l(t,n,o);return h.copyDescriptors(t,s,r),s},e.promisifyAll=function(t,e){if("function"!=typeof t&&"object"!=typeof t)throw new g("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");e=Object(e);var n=!!e.multiArgs,r=e.suffix;"string"!=typeof r&&(r=m);var i=e.filter;"function"!=typeof i&&(i=j);var o=e.promisifier;if("function"!=typeof o&&(o=E),!h.isIdentifier(r))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var s=h.inheritedDataKeys(t),a=0;a<s.length;++a){var c=t[s[a]];"constructor"!==s[a]&&h.isClass(c)&&(u(c.prototype,r,i,o,n),u(c,r,i,o,n))}return u(t,r,i,o,n)}}},{"./errors":12,"./nodeback":20,"./util":36}],25:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){function o(t){var e,n=!1;if(void 0!==a&&t instanceof a)e=p(t),n=!0;else{var r=l.keys(t),i=r.length;e=new Array(2*i);for(var o=0;i>o;++o){var s=r[o];e[o]=t[s],e[o+i]=s}}this.constructor$(e),this._isMap=n,this._init$(void 0,n?-6:-3)}function s(t){var n,s=r(t);return u(s)?(n=s instanceof e?s._then(e.props,void 0,void 0,void 0,void 0):new o(s).promise(),s instanceof e&&n._propagateFrom(s,2),n):i("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}var a,c=t("./util"),u=c.isObject,l=t("./es5");"function"==typeof Map&&(a=Map);var p=function(){function t(t,r){this[e]=t,this[e+n]=r,e++}var e=0,n=0;return function(r){n=r.size,e=0;var i=new Array(2*r.size);return r.forEach(t,i),i}}(),f=function(t){for(var e=new a,n=t.length/2|0,r=0;n>r;++r){var i=t[n+r],o=t[r];e.set(i,o)}return e};c.inherits(o,n),o.prototype._init=function(){},o.prototype._promiseFulfilled=function(t,e){this._values[e]=t;var n=++this._totalResolved;if(n>=this._length){var r;if(this._isMap)r=f(this._values);else{r={};for(var i=this.length(),o=0,s=this.length();s>o;++o)r[this._values[o+i]]=this._values[o]}return this._resolve(r),!0}return!1},o.prototype.shouldCopyValues=function(){return!1},o.prototype.getActualLength=function(t){return t>>1},e.prototype.props=function(){return s(this)},e.props=function(t){return s(t)}}},{"./es5":13,"./util":36}],26:[function(t,e,n){"use strict";function r(t,e,n,r,i){for(var o=0;i>o;++o)n[o+r]=t[o+e],t[o+e]=void 0}function i(t){this._capacity=t,this._length=0,this._front=0}i.prototype._willBeOverCapacity=function(t){return this._capacity<t},i.prototype._pushOne=function(t){var e=this.length();this._checkCapacity(e+1);var n=this._front+e&this._capacity-1;this[n]=t,this._length=e+1},i.prototype.push=function(t,e,n){var r=this.length()+3;if(this._willBeOverCapacity(r))return this._pushOne(t),this._pushOne(e),void this._pushOne(n);var i=this._front+r-3;this._checkCapacity(r);var o=this._capacity-1;this[i+0&o]=t,this[i+1&o]=e,this[i+2&o]=n,this._length=r},i.prototype.shift=function(){var t=this._front,e=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,e},i.prototype.length=function(){return this._length},i.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<1)},i.prototype._resizeTo=function(t){var e=this._capacity;this._capacity=t;var n=this._front,i=this._length,o=n+i&e-1;r(this,0,this,e,o)},e.exports=i},{}],27:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){function o(t,o){var c=r(t);if(c instanceof e)return a(c);if(t=s.asArray(t),null===t)return i("expecting an array or an iterable object but got "+s.classString(t));var u=new e(n);void 0!==o&&u._propagateFrom(o,3);for(var l=u._fulfill,p=u._reject,f=0,h=t.length;h>f;++f){var _=t[f];(void 0!==_||f in t)&&e.cast(_)._then(l,p,void 0,u,null)}return u}var s=t("./util"),a=function(t){return t.then(function(e){return o(e,t)})};e.race=function(t){return o(t,void 0)},e.prototype.race=function(){return o(this,void 0)}}},{"./util":36}],28:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,s){function a(t,n,r,i){this.constructor$(t);var s=e._getContext();this._fn=f.contextBind(s,n),void 0!==r&&(r=e.resolve(r),r._attachCancellationCallback(this)),this._initialValue=r,this._currentCancellable=null,i===o?this._eachValues=Array(this._length):0===i?this._eachValues=null:this._eachValues=void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function c(t,e){this.isFulfilled()?e._resolve(t):e._reject(t)}function u(t,e,n,i){if("function"!=typeof e)return r("expecting a function but got "+f.classString(e));var o=new a(t,e,n,i);return o.promise()}function l(t){this.accum=t,this.array._gotAccum(t);var n=i(this.value,this.array._promise);return n instanceof e?(this.array._currentCancellable=n,n._then(p,void 0,void 0,this,void 0)):p.call(this,n)}function p(t){var n=this.array,r=n._promise,i=h(n._fn);r._pushContext();var o;o=void 0!==n._eachValues?i.call(r._boundValue(),t,this.index,this.length):i.call(r._boundValue(),this.accum,t,this.index,this.length),o instanceof e&&(n._currentCancellable=o);var a=r._popContext();return s.checkForgottenReturns(o,a,void 0!==n._eachValues?"Promise.each":"Promise.reduce",r),o}var f=t("./util"),h=f.tryCatch;f.inherits(a,n),a.prototype._gotAccum=function(t){void 0!==this._eachValues&&null!==this._eachValues&&t!==o&&this._eachValues.push(t)},a.prototype._eachComplete=function(t){return null!==this._eachValues&&this._eachValues.push(t),this._eachValues},a.prototype._init=function(){},a.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},a.prototype.shouldCopyValues=function(){return!1},a.prototype._resolve=function(t){this._promise._resolveCallback(t),this._values=null},a.prototype._resultCancelled=function(t){return t===this._initialValue?this._cancel():void(this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof e&&this._currentCancellable.cancel(),this._initialValue instanceof e&&this._initialValue.cancel()))},a.prototype._iterate=function(t){this._values=t;var n,r,i=t.length;void 0!==this._initialValue?(n=this._initialValue,r=0):(n=e.resolve(t[0]),r=1),this._currentCancellable=n;for(var o=r;i>o;++o){var s=t[o];s instanceof e&&s.suppressUnhandledRejections()}if(!n.isRejected())for(;i>r;++r){var a={accum:null,value:t[r],index:r,length:i,array:this};n=n._then(l,void 0,void 0,a,void 0),0===(127&r)&&n._setNoAsyncGuarantee()}void 0!==this._eachValues&&(n=n._then(this._eachComplete,void 0,void 0,this,void 0)),n._then(c,c,void 0,n,this)},e.prototype.reduce=function(t,e){return u(this,t,e,null)},e.reduce=function(t,e,n,r){return u(t,e,n,r)}}},{"./util":36}],29:[function(t,e,n){"use strict";var r,i=t("./util"),o=function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")},s=i.getNativePromise();if(i.isNode&&"undefined"==typeof MutationObserver){var a=global.setImmediate,c=process.nextTick;r=i.isRecentNode?function(t){a.call(global,t)}:function(t){c.call(process,t)}}else if("function"==typeof s&&"function"==typeof s.resolve){
var u=s.resolve();r=function(t){u.then(t)}}else r="undefined"!=typeof MutationObserver&&("undefined"==typeof window||!window.navigator||!window.navigator.standalone&&!window.cordova)&&"classList"in document.documentElement?function(){var t=document.createElement("div"),e={attributes:!0},n=!1,r=document.createElement("div"),i=new MutationObserver(function(){t.classList.toggle("foo"),n=!1});i.observe(r,e);var o=function(){n||(n=!0,r.classList.toggle("foo"))};return function(n){var r=new MutationObserver(function(){r.disconnect(),n()});r.observe(t,e),o()}}():"undefined"!=typeof setImmediate?function(t){setImmediate(t)}:"undefined"!=typeof setTimeout?function(t){setTimeout(t,0)}:o;e.exports=r},{"./util":36}],30:[function(t,e,n){"use strict";e.exports=function(e,n,r){function i(t){this.constructor$(t)}var o=e.PromiseInspection,s=t("./util");s.inherits(i,n),i.prototype._promiseResolved=function(t,e){this._values[t]=e;var n=++this._totalResolved;return n>=this._length?(this._resolve(this._values),!0):!1},i.prototype._promiseFulfilled=function(t,e){var n=new o;return n._bitField=33554432,n._settledValueField=t,this._promiseResolved(e,n)},i.prototype._promiseRejected=function(t,e){var n=new o;return n._bitField=16777216,n._settledValueField=t,this._promiseResolved(e,n)},e.settle=function(t){return r.deprecated(".settle()",".reflect()"),new i(t).promise()},e.allSettled=function(t){return new i(t).promise()},e.prototype.settle=function(){return e.settle(this)}}},{"./util":36}],31:[function(t,e,n){"use strict";e.exports=function(e,n,r){function i(t){this.constructor$(t),this._howMany=0,this._unwrap=!1,this._initialized=!1}function o(t,e){if((0|e)!==e||0>e)return r("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var n=new i(t),o=n.promise();return n.setHowMany(e),n.init(),o}var s=t("./util"),a=t("./errors").RangeError,c=t("./errors").AggregateError,u=s.isArray,l={};s.inherits(i,n),i.prototype._init=function(){if(this._initialized){if(0===this._howMany)return void this._resolve([]);this._init$(void 0,-5);var t=u(this._values);!this._isResolved()&&t&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}},i.prototype.init=function(){this._initialized=!0,this._init()},i.prototype.setUnwrap=function(){this._unwrap=!0},i.prototype.howMany=function(){return this._howMany},i.prototype.setHowMany=function(t){this._howMany=t},i.prototype._promiseFulfilled=function(t){return this._addFulfilled(t),this._fulfilled()===this.howMany()?(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0):!1},i.prototype._promiseRejected=function(t){return this._addRejected(t),this._checkOutcome()},i.prototype._promiseCancelled=function(){return this._values instanceof e||null==this._values?this._cancel():(this._addRejected(l),this._checkOutcome())},i.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var t=new c,e=this.length();e<this._values.length;++e)this._values[e]!==l&&t.push(this._values[e]);return t.length>0?this._reject(t):this._cancel(),!0}return!1},i.prototype._fulfilled=function(){return this._totalResolved},i.prototype._rejected=function(){return this._values.length-this.length()},i.prototype._addRejected=function(t){this._values.push(t)},i.prototype._addFulfilled=function(t){this._values[this._totalResolved++]=t},i.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},i.prototype._getRangeError=function(t){var e="Input array must contain at least "+this._howMany+" items but contains only "+t+" items";return new a(e)},i.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},e.some=function(t,e){return o(t,e)},e.prototype.some=function(t){return o(this,t)},e._SomePromiseArray=i}},{"./errors":12,"./util":36}],32:[function(t,e,n){"use strict";e.exports=function(t){function e(t){void 0!==t?(t=t._target(),this._bitField=t._bitField,this._settledValueField=t._isFateSealed()?t._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}e.prototype._settledValue=function(){return this._settledValueField};var n=e.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},r=e.prototype.error=e.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},i=e.prototype.isFulfilled=function(){return 0!==(33554432&this._bitField)},o=e.prototype.isRejected=function(){return 0!==(16777216&this._bitField)},s=e.prototype.isPending=function(){return 0===(50397184&this._bitField)},a=e.prototype.isResolved=function(){return 0!==(50331648&this._bitField)};e.prototype.isCancelled=function(){return 0!==(8454144&this._bitField)},t.prototype.__isCancelled=function(){return 65536===(65536&this._bitField)},t.prototype._isCancelled=function(){return this._target().__isCancelled()},t.prototype.isCancelled=function(){return 0!==(8454144&this._target()._bitField)},t.prototype.isPending=function(){return s.call(this._target())},t.prototype.isRejected=function(){return o.call(this._target())},t.prototype.isFulfilled=function(){return i.call(this._target())},t.prototype.isResolved=function(){return a.call(this._target())},t.prototype.value=function(){return n.call(this._target())},t.prototype.reason=function(){var t=this._target();return t._unsetRejectionIsUnhandled(),r.call(t)},t.prototype._value=function(){return this._settledValue()},t.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},t.PromiseInspection=e}},{}],33:[function(t,e,n){"use strict";e.exports=function(e,n){function r(t,r){if(l(t)){if(t instanceof e)return t;var i=o(t);if(i===u){r&&r._pushContext();var c=e.reject(i.e);return r&&r._popContext(),c}if("function"==typeof i){if(s(t)){var c=new e(n);return t._then(c._fulfill,c._reject,void 0,c,null),c}return a(t,i,r)}}return t}function i(t){return t.then}function o(t){try{return i(t)}catch(e){return u.e=e,u}}function s(t){try{return p.call(t,"_promise0")}catch(e){return!1}}function a(t,r,i){function o(t){a&&(a._resolveCallback(t),a=null)}function s(t){a&&(a._rejectCallback(t,p,!0),a=null)}var a=new e(n),l=a;i&&i._pushContext(),a._captureStackTrace(),i&&i._popContext();var p=!0,f=c.tryCatch(r).call(t,o,s);return p=!1,a&&f===u&&(a._rejectCallback(f.e,!0,!0),a=null),l}var c=t("./util"),u=c.errorObj,l=c.isObject,p={}.hasOwnProperty;return r}},{"./util":36}],34:[function(t,e,n){"use strict";e.exports=function(e,n,r){function i(t){this.handle=t}function o(t){return clearTimeout(this.handle),t}function s(t){throw clearTimeout(this.handle),t}var a=t("./util"),c=e.TimeoutError;i.prototype._resultCancelled=function(){clearTimeout(this.handle)};var u=function(t){return l(+this).thenReturn(t)},l=e.delay=function(t,o){var s,a;return void 0!==o?(s=e.resolve(o)._then(u,null,null,t,void 0),r.cancellation()&&o instanceof e&&s._setOnCancel(o)):(s=new e(n),a=setTimeout(function(){s._fulfill()},+t),r.cancellation()&&s._setOnCancel(new i(a)),s._captureStackTrace()),s._setAsyncGuaranteed(),s};e.prototype.delay=function(t){return l(t,this)};var p=function(t,e,n){var r;r="string"!=typeof e?e instanceof Error?e:new c("operation timed out"):new c(e),a.markAsOriginatingFromRejection(r),t._attachExtraTrace(r),t._reject(r),null!=n&&n.cancel()};e.prototype.timeout=function(t,e){t=+t;var n,a,c=new i(setTimeout(function(){n.isPending()&&p(n,e,a)},t));return r.cancellation()?(a=this.then(),n=a._then(o,s,void 0,c,void 0),n._setOnCancel(c)):n=this._then(o,s,void 0,c,void 0),n}}},{"./util":36}],35:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,s){function a(t){setTimeout(function(){throw t},0)}function c(t){var e=r(t);return e!==t&&"function"==typeof t._isDisposable&&"function"==typeof t._getDisposer&&t._isDisposable()&&e._setDisposable(t._getDisposer()),e}function u(t,n){function i(){if(s>=u)return l._fulfill();var o=c(t[s++]);if(o instanceof e&&o._isDisposable()){try{o=r(o._getDisposer().tryDispose(n),t.promise)}catch(p){return a(p)}if(o instanceof e)return o._then(i,a,null,null,null)}i()}var s=0,u=t.length,l=new e(o);return i(),l}function l(t,e,n){this._data=t,this._promise=e,this._context=n}function p(t,e,n){this.constructor$(t,e,n)}function f(t){return l.isDisposer(t)?(this.resources[this.index]._setDisposable(t),t.promise()):t}function h(t){this.length=t,this.promise=null,this[t-1]=null}var _=t("./util"),d=t("./errors").TypeError,v=t("./util").inherits,y=_.errorObj,g=_.tryCatch,m={};l.prototype.data=function(){return this._data},l.prototype.promise=function(){return this._promise},l.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():m},l.prototype.tryDispose=function(t){var e=this.resource(),n=this._context;void 0!==n&&n._pushContext();var r=e!==m?this.doDispose(e,t):null;return void 0!==n&&n._popContext(),this._promise._unsetDisposable(),this._data=null,r},l.isDisposer=function(t){return null!=t&&"function"==typeof t.resource&&"function"==typeof t.tryDispose},v(p,l),p.prototype.doDispose=function(t,e){var n=this.data();return n.call(t,t,e)},h.prototype._resultCancelled=function(){for(var t=this.length,n=0;t>n;++n){var r=this[n];r instanceof e&&r.cancel()}},e.using=function(){var t=arguments.length;if(2>t)return n("you must pass at least 2 arguments to Promise.using");var i=arguments[t-1];if("function"!=typeof i)return n("expecting a function but got "+_.classString(i));var o,a=!0;2===t&&Array.isArray(arguments[0])?(o=arguments[0],t=o.length,a=!1):(o=arguments,t--);for(var c=new h(t),p=0;t>p;++p){var d=o[p];if(l.isDisposer(d)){var v=d;d=d.promise(),d._setDisposable(v)}else{var m=r(d);m instanceof e&&(d=m._then(f,null,null,{resources:c,index:p},void 0))}c[p]=d}for(var b=new Array(c.length),p=0;p<b.length;++p)b[p]=e.resolve(c[p]).reflect();var w=e.all(b).then(function(t){for(var e=0;e<t.length;++e){var n=t[e];if(n.isRejected())return y.e=n.error(),y;if(!n.isFulfilled())return void w.cancel();t[e]=n.value()}C._pushContext(),i=g(i);var r=a?i.apply(void 0,t):i(t),o=C._popContext();return s.checkForgottenReturns(r,o,"Promise.using",C),r}),C=w.lastly(function(){var t=new e.PromiseInspection(w);return u(c,t)});return c.promise=C,C._setOnCancel(c),C},e.prototype._setDisposable=function(t){this._bitField=131072|this._bitField,this._disposer=t},e.prototype._isDisposable=function(){return(131072&this._bitField)>0},e.prototype._getDisposer=function(){return this._disposer},e.prototype._unsetDisposable=function(){this._bitField=-131073&this._bitField,this._disposer=void 0},e.prototype.disposer=function(t){if("function"==typeof t)return new p(t,this,i());throw new d}}},{"./errors":12,"./util":36}],36:[function(t,e,n){"use strict";function r(){try{var t=P;return P=null,t.apply(this,arguments)}catch(e){return T.e=e,T}}function i(t){return P=t,r}function o(t){return null==t||t===!0||t===!1||"string"==typeof t||"number"==typeof t}function s(t){return"function"==typeof t||"object"==typeof t&&null!==t}function a(t){return o(t)?new Error(v(t)):t}function c(t,e){var n,r=t.length,i=new Array(r+1);for(n=0;r>n;++n)i[n]=t[n];return i[n]=e,i}function u(t,e,n){if(!F.isES5)return{}.hasOwnProperty.call(t,e)?t[e]:void 0;var r=Object.getOwnPropertyDescriptor(t,e);return null!=r?null==r.get&&null==r.set?r.value:n:void 0}function l(t,e,n){if(o(t))return t;var r={value:n,configurable:!0,enumerable:!1,writable:!0};return F.defineProperty(t,e,r),t}function p(t){throw t}function f(t){try{if("function"==typeof t){var e=F.names(t.prototype),n=F.isES5&&e.length>1,r=e.length>0&&!(1===e.length&&"constructor"===e[0]),i=A.test(t+"")&&F.names(t).length>0;if(n||r||i)return!0}return!1}catch(o){return!1}}function h(t){function e(){}function n(){return typeof r.foo}e.prototype=t;var r=new e;return n(),n(),t}function _(t){return V.test(t)}function d(t,e,n){for(var r=new Array(t),i=0;t>i;++i)r[i]=e+i+n;return r}function v(t){try{return t+""}catch(e){return"[no string representation]"}}function y(t){return t instanceof Error||null!==t&&"object"==typeof t&&"string"==typeof t.message&&"string"==typeof t.name}function g(t){try{l(t,"isOperational",!0)}catch(e){}}function m(t){return null==t?!1:t instanceof Error.__BluebirdErrorTypes__.OperationalError||t.isOperational===!0}function b(t){return y(t)&&F.propertyIsWritable(t,"stack")}function w(t){return{}.toString.call(t)}function C(t,e,n){for(var r=F.names(t),i=0;i<r.length;++i){var o=r[i];if(n(o))try{F.defineProperty(e,o,F.getDescriptor(t,o))}catch(s){}}}function j(t){return N?process.env[t]:void 0}function k(){if("function"==typeof Promise)try{var t=new Promise(function(){});if("[object Promise]"===w(t))return Promise}catch(e){}}function E(t,e){if(null===t||"function"!=typeof e||e===U)return e;null!==t.domain&&(e=t.domain.bind(e));var n=t.async;if(null!==n){var r=e;e=function(){var t=new Array(2).concat([].slice.call(arguments));return t[0]=r,t[1]=this,n.runInAsyncScope.apply(n,t)}}return e}var F=t("./es5"),x="undefined"==typeof navigator,T={e:{}},P,R="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0!==this?this:null,S=function(t,e){function n(){this.constructor=t,this.constructor$=e;for(var n in e.prototype)r.call(e.prototype,n)&&"$"!==n.charAt(n.length-1)&&(this[n+"$"]=e.prototype[n])}var r={}.hasOwnProperty;return n.prototype=e.prototype,t.prototype=new n,t.prototype},O=function(){var t=[Array.prototype,Object.prototype,Function.prototype],e=function(e){for(var n=0;n<t.length;++n)if(t[n]===e)return!0;return!1};if(F.isES5){var n=Object.getOwnPropertyNames;return function(t){for(var r=[],i=Object.create(null);null!=t&&!e(t);){var o;try{o=n(t)}catch(s){return r}for(var a=0;a<o.length;++a){var c=o[a];if(!i[c]){i[c]=!0;var u=Object.getOwnPropertyDescriptor(t,c);null!=u&&null==u.get&&null==u.set&&r.push(c)}}t=F.getPrototypeOf(t)}return r}}var r={}.hasOwnProperty;return function(n){if(e(n))return[];var i=[];t:for(var o in n)if(r.call(n,o))i.push(o);else{for(var s=0;s<t.length;++s)if(r.call(t[s],o))continue t;i.push(o)}return i}}(),A=/this\s*\.\s*\S+\s*=/,V=/^[a-z$_][a-z$_0-9]*$/i,H=function(){return"stack"in new Error?function(t){return b(t)?t:new Error(v(t))}:function(t){if(b(t))return t;try{throw new Error(v(t))}catch(e){return e}}}(),D=function(t){return F.isArray(t)?t:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var I="function"==typeof Array.from?function(t){return Array.from(t)}:function(t){for(var e,n=[],r=t[Symbol.iterator]();!(e=r.next()).done;)n.push(e.value);return n};D=function(t){return F.isArray(t)?t:null!=t&&"function"==typeof t[Symbol.iterator]?I(t):null}}var L="undefined"!=typeof process&&"[object process]"===w(process).toLowerCase(),N="undefined"!=typeof process&&"undefined"!=typeof process.env,U,B={setReflectHandler:function(t){U=t},isClass:f,isIdentifier:_,inheritedDataKeys:O,getDataPropertyOrDefault:u,thrower:p,isArray:F.isArray,asArray:D,notEnumerableProp:l,isPrimitive:o,isObject:s,isError:y,canEvaluate:x,errorObj:T,tryCatch:i,inherits:S,withAppended:c,maybeWrapAsError:a,toFastProperties:h,filledRange:d,toString:v,canAttachTrace:b,ensureErrorObject:H,originatesFromRejection:m,markAsOriginatingFromRejection:g,classString:w,copyDescriptors:C,isNode:L,hasEnvVariables:N,env:j,global:R,getNativePromise:k,contextBind:E};B.isRecentNode=B.isNode&&function(){var t;return process.versions&&process.versions.node?t=process.versions.node.split(".").map(Number):process.version&&(t=process.version.split(".").map(Number)),0===t[0]&&t[1]>10||t[0]>0}(),B.nodeSupportsAsyncResource=B.isNode&&function(){var e=!1;try{var n=t("async_hooks").AsyncResource;e="function"==typeof n.prototype.runInAsyncScope}catch(r){e=!1}return e}(),B.isNode&&B.toFastProperties(process);try{throw new Error}catch(M){B.lastLineError=M}e.exports=B},{"./es5":13,async_hooks:void 0}]},{},[4])(4)}),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise);
}
 
Dynamsoft.DWT.bNpm=true;Dynamsoft.DWT.dbrCanvasMaxWH=4096; 
 
Dynamsoft.aryAddonReadyFun=[];Dynamsoft.AddonReady=function(fn){Dynamsoft.aryAddonReadyFun.push(fn);}; 
 
/*! 20230310201709
* Dynamsoft JavaScript Library
* Product: Dynamsoft Web Twain
* Web Site: https://www.dynamsoft.com
*
* Copyright 2023, Dynamsoft Corporation
* Author: Dynamsoft Support Team
*
* Module: BarcodeReader
* Version: 18.4
* 
*/
var Dynamsoft=self.Dynamsoft||{};Dynamsoft.DWT=Dynamsoft.DWT||{},Dynamsoft.DBR=Dynamsoft.DBR||{},Dynamsoft.aryAddonReadyFun=Dynamsoft.aryAddonReadyFun||[],Dynamsoft.AddonReady=Dynamsoft.AddonReady||function(e){Dynamsoft.aryAddonReadyFun.push(e)},function(){Dynamsoft.BarcodeReaderAddon=Dynamsoft.BarcodeReaderAddon||{};var n=Dynamsoft.BarcodeReaderAddon;n.Version="9.4.0.1025",n._decoding=!1,n._decodeQueue=[],n._decodeNext=function(){var e,t;0==n._decodeQueue.length?n._decoding=!1:(e=(t=n._decodeQueue[0]).method,t=t.args,n._decodeQueue.splice(0,1),e.apply(null,t))},n._defaultRuntimeSettingsStr="",n._defaultTemplateStr="",n._activeXInstance=!1,n.BarcodeReaderException=function(){var e=arguments[0],t=Dynamsoft.DBR.EnumErrorCode.DBR_UNKNOWN,e="number"==typeof e?(t=e,new Error(arguments[1])):new Error(e);return e.code=t,e},n.RemoveNonPrintableChar=function(e){return Dynamsoft.Lib.isString(e)?e.replace(/[^\x20-\x7E]|(\\")/g,""):e},n.errors={webcamNotInstalled:"The Webcam add-on not installed.",nonServiceNotSupportWebcamDecode:"The BarcodeReader add-on does not support reading barcodes from video streams.",decodeResultEmpty:"decode result is empty.",ServiceEditionNotSupportDbr:"The BarcodeReader add-on does not support your Operating System.",ServiceEditionNotSupportWasmMode:"You cannot call this method on this WebTwain instance."},n._activeXMaxIEVersion=9,n.logLevel=3,Dynamsoft.DBR.EnumAccompanyingTextRecognitionMode={ATRM_GENERAL:1,ATRM_SKIP:0},Dynamsoft.DBR.EnumBarcodeColourMode={BICM_DARK_ON_LIGHT:1,BICM_LIGHT_ON_DARK:2,BICM_DARK_ON_DARK:4,BICM_LIGHT_ON_LIGHT:8,BICM_DARK_LIGHT_MIXED:16,BICM_DARK_ON_LIGHT_DARK_SURROUNDING:32,BICM_SKIP:0},Dynamsoft.DBR.EnumBarcodeComplementMode={BCM_AUTO:1,BCM_GENERAL:2,BCM_SKIP:0},Dynamsoft.DBR.EnumBarcodeFormat={BF_ALL:-32505857,BF_ONED:2047,BF_GS1_DATABAR:260096,BF_CODE_39:1,BF_CODE_128:2,BF_CODE_93:4,BF_CODABAR:8,BF_ITF:16,BF_EAN_13:32,BF_EAN_8:64,BF_UPC_A:128,BF_UPC_E:256,BF_INDUSTRIAL_25:512,BF_CODE_39_EXTENDED:1024,BF_GS1_DATABAR_OMNIDIRECTIONAL:2048,BF_GS1_DATABAR_TRUNCATED:4096,BF_GS1_DATABAR_STACKED:8192,BF_GS1_DATABAR_STACKED_OMNIDIRECTIONAL:16384,BF_GS1_DATABAR_EXPANDED:32768,BF_GS1_DATABAR_EXPANDED_STACKED:65536,BF_GS1_DATABAR_LIMITED:131072,BF_PATCHCODE:262144,BF_PDF417:33554432,BF_QR_CODE:67108864,BF_DATAMATRIX:134217728,BF_AZTEC:268435456,BF_MAXICODE:536870912,BF_MICRO_QR:1073741824,BF_MICRO_PDF417:524288,BF_GS1_COMPOSITE:-2147483648,BF_NULL:0},Dynamsoft.DBR.EnumBarcodeFormat_2={BF2_NULL:0,BF2_POSTALCODE:32505856,BF2_NONSTANDARD_BARCODE:1,BF2_USPSINTELLIGENTMAIL:1048576,BF2_POSTNET:2097152,BF2_PLANET:4194304,BF2_AUSTRALIANPOST:8388608,BF2_RM4SCC:16777216,BF2_DOTCODE:2},Dynamsoft.DBR.EnumBinarizationMode={BM_AUTO:1,BM_LOCAL_BLOCK:2,BM_SKIP:0},Dynamsoft.DBR.EnumClarityCalculationMethod={ECCM_CONTRAST:1},Dynamsoft.DBR.EnumClarityFilterMode={CFM_GENERAL:1},Dynamsoft.DBR.EnumColourClusteringMode={CCM_AUTO:1,CCM_GENERAL_HSV:2,CCM_SKIP:0},Dynamsoft.DBR.EnumColourConversionMode={CICM_GENERAL:1,CICM_SKIP:0},Dynamsoft.DBR.EnumConflictMode={CM_IGNORE:1,CM_OVERWRITE:2},Dynamsoft.DBR.EnumDeformationResistingMode={DRM_AUTO:1,DRM_GENERAL:2,DRM_SKIP:0},Dynamsoft.DBR.EnumDPMCodeReadingMode={DPMCRM_AUTO:1,DPMCRM_GENERAL:2,DPMCRM_SKIP:0},Dynamsoft.DBR.EnumErrorCode={DBR_SYSTEM_EXCEPTION:1,DBR_SUCCESS:0,DBR_UNKNOWN:-1e4,DBR_NO_MEMORY:-10001,DBR_NULL_REFERENCE:-10002,DBR_LICENSE_INVALID:-10003,DBR_LICENSE_EXPIRED:-10004,DBR_FILE_NOT_FOUND:-10005,DBR_FILETYPE_NOT_SUPPORTED:-10006,DBR_BPP_NOT_SUPPORTED:-10007,DBR_INDEX_INVALID:-10008,DBR_BARCODE_FORMAT_INVALID:-10009,DBR_CUSTOM_REGION_INVALID:-10010,DBR_MAX_BARCODE_NUMBER_INVALID:-10011,DBR_IMAGE_READ_FAILED:-10012,DBR_TIFF_READ_FAILED:-10013,DBR_QR_LICENSE_INVALID:-10016,DBR_1D_LICENSE_INVALID:-10017,DBR_DIB_BUFFER_INVALID:-10018,DBR_PDF417_LICENSE_INVALID:-10019,DBR_DATAMATRIX_LICENSE_INVALID:-10020,DBR_PDF_READ_FAILED:-10021,DBR_PDF_DLL_MISSING:-10022,DBR_PAGE_NUMBER_INVALID:-10023,DBR_CUSTOM_SIZE_INVALID:-10024,DBR_CUSTOM_MODULESIZE_INVALID:-10025,DBR_RECOGNITION_TIMEOUT:-10026,DBR_JSON_PARSE_FAILED:-10030,DBR_JSON_TYPE_INVALID:-10031,DBR_JSON_KEY_INVALID:-10032,DBR_JSON_VALUE_INVALID:-10033,DBR_JSON_NAME_KEY_MISSING:-10034,DBR_JSON_NAME_VALUE_DUPLICATED:-10035,DBR_TEMPLATE_NAME_INVALID:-10036,DBR_JSON_NAME_REFERENCE_INVALID:-10037,DBR_PARAMETER_VALUE_INVALID:-10038,DBR_DOMAIN_NOT_MATCHED:-10039,DBR_RESERVEDINFO_NOT_MATCHED:-10040,DBR_AZTEC_LICENSE_INVALID:-10041,DBR_LICENSE_DLL_MISSING:-10042,DBR_LICENSEKEY_NOT_MATCHED:-10043,DBR_REQUESTED_FAILED:-10044,DBR_LICENSE_INIT_FAILED:-10045,DBR_PATCHCODE_LICENSE_INVALID:-10046,DBR_POSTALCODE_LICENSE_INVALID:-10047,DBR_DPM_LICENSE_INVALID:-10048,DBR_FRAME_DECODING_THREAD_EXISTS:-10049,DBR_STOP_DECODING_THREAD_FAILED:-10050,DBR_SET_MODE_ARGUMENT_ERROR:-10051,DBR_LICENSE_CONTENT_INVALID:-10052,DBR_LICENSE_KEY_INVALID:-10053,DBR_LICENSE_DEVICE_RUNS_OUT:-10054,DBR_GET_MODE_ARGUMENT_ERROR:-10055,DBR_IRT_LICENSE_INVALID:-10056,DBR_MAXICODE_LICENSE_INVALID:-10057,DBR_GS1_DATABAR_LICENSE_INVALID:-10058,DBR_GS1_COMPOSITE_LICENSE_INVALID:-10059,DBR_DOTCODE_LICENSE_INVALID:-10061,DMERR_FAILED_TO_REACH_LTS:-20200},Dynamsoft.DBR.EnumGrayscaleTransformationMode={GTM_INVERTED:1,GTM_ORIGINAL:2,GTM_SKIP:0},Dynamsoft.DBR.EnumImagePixelFormat={IPF_Binary:0,IPF_BinaryInverted:1,IPF_GrayScaled:2,IPF_NV21:3,IPF_RGB_565:4,IPF_RGB_555:5,IPF_RGB_888:6,IPF_ARGB_8888:7,IPF_RGB_161616:8,IPF_ARGB_16161616:9,IPF_ABGR_8888:10,IPF_ABGR_16161616:11,IPF_BGR_888:12},Dynamsoft.DBR.EnumImagePreprocessingMode={IPM_AUTO:1,IPM_GENERAL:2,IPM_GRAY_EQUALIZE:4,IPM_GRAY_SMOOTH:8,IPM_SHARPEN_SMOOTH:16,IPM_MORPHOLOGY:32,IPM_SKIP:0},Dynamsoft.DBR.EnumIMResultDataType={IMRDT_IMAGE:1,IMRDT_CONTOUR:2,IMRDT_LINESEGMENT:4,IMRDT_LOCALIZATIONRESULT:8,IMRDT_REGIONOFINTEREST:16,IMRDT_QUADRILATERAL:32},Dynamsoft.DBR.EnumIntermediateResultSavingMode={IRSM_MEMORY:1,IRSM_FILESYSTEM:2,IRSM_BOTH:4},Dynamsoft.DBR.EnumIntermediateResultType={IRT_NO_RESULT:0,IRT_ORIGINAL_IMAGE:1,IRT_COLOUR_CLUSTERED_IMAGE:2,IRT_COLOUR_CONVERTED_GRAYSCALE_IMAGE:4,IRT_TRANSFORMED_GRAYSCALE_IMAGE:8,IRT_PREDETECTED_REGION:16,IRT_PREPROCESSED_IMAGE:32,IRT_BINARIZED_IMAGE:64,IRT_TEXT_ZONE:128,IRT_CONTOUR:256,IRT_LINE_SEGMENT:512,IRT_FORM:1024,IRT_SEGMENTATION_BLOCK:2048,IRT_TYPED_BARCODE_ZONE:4096,IRT_PREDETECTED_QUADRILATERAL:8192},Dynamsoft.DBR.EnumLocalizationMode={LM_SKIP:0,LM_AUTO:1,LM_CONNECTED_BLOCKS:2,LM_LINES:8,LM_STATISTICS:4,LM_SCAN_DIRECTLY:16,LM_STATISTICS_MARKS:32,LM_STATISTICS_POSTAL_CODE:64},Dynamsoft.DBR.EnumPDFReadingMode={PDFRM_RASTER:1,PDFRM_AUTO:2,PDFRM_VECTOR:4},Dynamsoft.DBR.EnumQRCodeErrorCorrectionLevel={QRECL_ERROR_CORRECTION_H:0,QRECL_ERROR_CORRECTION_L:1,QRECL_ERROR_CORRECTION_M:2,QRECL_ERROR_CORRECTION_Q:3},Dynamsoft.DBR.EnumRegionPredetectionMode={RPM_AUTO:1,RPM_GENERAL:2,RPM_GENERAL_RGB_CONTRAST:4,RPM_GENERAL_GRAY_CONTRAST:8,RPM_GENERAL_HSV_CONTRAST:16,RPM_SKIP:0},Dynamsoft.DBR.EnumResultCoordinateType={RCT_PIXEL:1,RCT_PERCENTAGE:2},Dynamsoft.DBR.EnumResultType={RT_STANDARD_TEXT:0,RT_RAW_TEXT:1,RT_CANDIDATE_TEXT:2,RT_PARTIAL_TEXT:3},Dynamsoft.DBR.EnumScaleUpMode={SUM_AUTO:1,SUM_LINEAR_INTERPOLATION:2,SUM_NEAREST_NEIGHBOUR_INTERPOLATION:4,SUM_SKIP:0},Dynamsoft.DBR.EnumTerminatePhase={TP_REGION_PREDETECTED:1,TP_IMAGE_PREPROCESSED:2,TP_IMAGE_BINARIZED:4,TP_BARCODE_LOCALIZED:8,TP_BARCODE_TYPE_DETERMINED:16,TP_BARCODE_RECOGNIZED:32},Dynamsoft.DBR.EnumTextAssistedCorrectionMode={TACM_AUTO:1,TACM_VERIFYING:2,TACM_VERIFYING_PATCHING:4,TACM_SKIP:0},Dynamsoft.DBR.EnumTextFilterMode={TFM_AUTO:1,TFM_GENERAL_CONTOUR:2,TFM_SKIP:0},Dynamsoft.DBR.EnumTextResultOrderMode={TROM_CONFIDENCE:1,TROM_POSITION:2,TROM_FORMAT:4,TROM_SKIP:0},Dynamsoft.DBR.EnumTextureDetectionMode={TDM_AUTO:1,TDM_GENERAL_WIDTH_CONCENTRATION:2,TDM_SKIP:0}}(),Dynamsoft.AddonReady(function(T,e){var t,u=Dynamsoft.BarcodeReaderAddon;function M(e){return e&&e instanceof ArrayBuffer}u.Class=function(){function e(e){this._runtimeSettings=null,this._initSettingsContent=null,this._tplContentArr=[],this._stwain=e}var E;e.prototype._decodeBlob=function(t,e){var n=this;return new T.Promise(function(e){if(!(t instanceof Blob))throw TypeError("'_decodeBlob(blob, templateName)': Type of 'blob' should be 'Blob'.");e()}).then(function(){return n._innerDecode(0,t,e)})},e.prototype._decodeArrayBuffer=function(t,e){var n=this;return new T.Promise(function(e){if(!(t instanceof ArrayBuffer))throw TypeError("'_decodeBlob(arrayBuffer, templateName)': Type of 'arrayBuffer' should be 'ArrayBuffer'.");e()}).then(function(){return n._innerDecode(0,t,e)})},e.prototype._decodeUint8Array=function(t,e){var n=this;return new T.Promise(function(e){if(!(t instanceof Uint8Array||self.Uint8ClampedArray&&t instanceof Uint8ClampedArray))throw TypeError("'_decodeBlob(uint8Array, templateName)': Type of 'uint8Array' should be 'Uint8Array'.");e()}).then(function(){return n._innerDecode(0,t,e)})},e.prototype._decodeImage=function(t,n){var o=this;return new T.Promise(function(e){if(!(t instanceof HTMLImageElement))throw TypeError("'_decodeImage(image, templateName)': Type of 'image' should be 'HTMLImageElement'.");if(t.crossOrigin&&"anonymous"!=t.crossOrigin)throw"cors";n=n||"",e()}).then(function(){return"data:image/"==t.src.substring(0,11)?o._decodeBase64(t.src,n):o._decodeUrl(t.src,n).catch(function(e){return 3<=u.logLevel&&console&&console.warn&&(console.warn("'_decodeImage(image, templateName)': Image src not available. Use '_decodeCanvas' instead."),console.warn(e)),self.HTMLCanvasElement?((e=document.createElement("canvas")).width=t.naturalWidth,e.height=t.naturalHeight,e.getContext("2d").drawImage(t,0,0),o._decodeCanvas(e,n)):T.Promise.reject(Error("'_decodeImage(image, templateName)': Browser not support HTMLCanvasElement."))})})},e.prototype._decodeCanvas=function(n,o){var t=this;return new T.Promise(function(t){if(!(n instanceof HTMLCanvasElement))throw TypeError("'_decodeCanvas(canvas, templateName)': Type of 'canvas' should be 'HTMLCanvasElement'.");if(n.crossOrigin&&"anonymous"!=n.crossOrigin)throw"cors";o=o||"",n.toBlob?n.toBlob(function(e){t(e)}):n.msToBlob?n.msToBlob(function(e){t(e)}):t(n.toDataURL())}).then(function(e){return n.toBlob||n.msToBlob?t._decodeBlob(e,o):t._decodeBase64(e,o)})},e.prototype._decodeVideo=function(d){var s,t=this,c=arguments;return new T.Promise(function(e){if(!(d instanceof HTMLVideoElement))throw TypeError("'_decodeVideo(video [ [, sx, sy, sWidth, sHeight], dWidth, dHeight] [, templateName] )': Type of 'video' should be 'HTMLVideoElement'.");if(d.crossOrigin&&"anonymous"!=d.crossOrigin)throw"cors";c.length<=2?(t=n=0,o=i=d.videoWidth,r=a=d.videoHeight):a=c.length<=4?(t=n=0,o=d.videoWidth,r=d.videoHeight,i=c[1],c[2]):(t=c[1],n=c[2],o=c[3],r=c[4],i=c[5],c[6]),s="string"==typeof c[c.length-1]?c[c.length-1]:"";var t,n,o,r,i,a,_=document.createElement("canvas");_.width=i,_.height=a,_.getContext("2d").drawImage(d,t,n,o,r,0,0,i,a),e(_)}).then(function(e){return t._decodeCanvas(e,s)})},e.prototype._decodeBase64=e.prototype.decodeBase64String=function(t,e){var n=this;return new T.Promise(function(e){if(!("string"==typeof t||"object"==typeof t&&t instanceof String))throw TypeError("'decodeBase64(base64Str, templateName)': Type of 'base64Str' should be 'String'.");"data:image/"==t.substring(0,11)&&(t=t.substring(t.indexOf(",")+1)),e()}).then(function(){return n._innerDecode(1,t,e)})},e.prototype._decodeUrl=function(o,r){var t=this;return o&&o.indexOf&&(0==o.indexOf("dwt://")||0==o.indexOf("dcs://"))?t._decodeDynamsoftServiceInnerUrl(o,r):new T.Promise(function(e,t){var n;if(!("string"==typeof o||"object"==typeof o&&o instanceof String))throw TypeError("'_decodeUrl(url, templateName)': Type of 'url' should be 'String'.");r=r||"",u._activeXInstance?((n=new ActiveXObject("MSXML2.XMLHTTP")).open("GET",o,!0),n.overrideMimeType?n.overrideMimeType("text/plain; charset=x-user-defined"):n.setRequestHeader("Accept-Charset","x-user-defined"),n.onreadystatechange=function(){4==n.readyState&&e(new VBArray(n.responseBody).toArray())},n.send("")):((n=new XMLHttpRequest).open("GET",o,!0),n.responseType="arraybuffer",n.send(),n.onloadend=function(){e(this.response)},n.onerror=function(){t(Error(n.error))})}).then(function(e){return u._activeXInstance?t._activeXDecodeArray(e,r):t._decodeArrayBuffer(e,r)})},e.prototype._decodeDynamsoftServiceInnerUrl=function(t,e){var n=this;return new T.Promise(function(e){if(!("string"==typeof t||"object"==typeof t&&t instanceof String))throw TypeError("'_decodeUrl(url, templateName)': Type of 'innerUrl' should be 'String'.");if(0!=t.indexOf("dwt://")&&0!=t.indexOf("dcs://"))throw TypeError("'_decodeDynamsoftServiceInnerUrl(innerUrl, templateName)': 'innerUrl' should start with 'dwt://' or 'dcs://'.");e()}).then(function(){return n._innerDecode(4e3,t,e)})},e.prototype._activeXDecodeArray=function(n,o){var t=this;return new T.Promise(function(e,t){if(!(n instanceof Array))throw TypeError("'_activeXDecodeArray(array, templateName)': Type of 'array' should be 'Array'.");o=o||"";try{e(Dynamsoft.Lib.btoa(String.fromCharCode.apply(String,n)))}catch(e){t(e)}}).then(function(e){return t._decodeBase64(e,o)})},e.prototype._activeXDecodeHandle=function(e,t){var n=this;return new T.Promise(function(e){t=t||"",e()}).then(function(){return n._innerDecode(4001,e,t)})},e.prototype._decode=e.prototype.decode=function(e,t){return u._activeXInstance?"string"==typeof e||e instanceof String?this._activeXDecodeHandle(e,t):T.Promise.reject(TypeError("'_decode(source, templateName)' in activeX: Type of 'source' should be 'String(partUrl)'.")):self.Blob&&e instanceof Blob?this._decodeBlob(e,t):self.ArrayBuffer&&e instanceof ArrayBuffer?this._decodeArrayBuffer(e,t):self.Uint8Array&&e instanceof Uint8Array||self.Uint8ClampedArray&&e instanceof Uint8ClampedArray?this._decodeUint8Array(e,t):e instanceof Array?this._activeXDecodeArray(e,t):self.HTMLImageElement&&e instanceof HTMLImageElement?this._decodeImage(e,t):self.HTMLCanvasElement&&e instanceof HTMLCanvasElement?this._decodeCanvas(e,t):self.HTMLVideoElement&&e instanceof HTMLVideoElement?this._decodeVideo(e,t):isNaN(e)?"string"==typeof e||e instanceof String?"data:image/"==e.substring(0,11)?this._decodeBase64(e,t):this._decodeUrl(e,t):T.Promise.reject(TypeError("'_decode(source, templateName)' in H5: Type of 'source' should be 'Blob', 'ArrayBuffer', 'Uint8Array', 'HTMLImageElement', 'HTMLCanvasElement', 'HTMLVideoElement', 'String(base64 with image mime)' or 'String(url)'.")):this._activeXDecodeHandle(e,t)},e.prototype._innerServiceCmd=function(r,i){var a=this._stwain;return new T.Promise(function(t,n){var e,o={method:"ReadBarcode",parameter:[Dynamsoft.Lib.product.refProductKey,4002,"",""],updateSettings:r,initSettingsContent:i};u._activeXInstance?t(u._activeXInstance.Process(T.stringify(o),location.protocol+"//"+location.host)):(a._blts?(e="",a&&a._bRemoteMode&&a._dmService&&a._dmService.attrs&&a._dmService.attrs.UUID&&(e=a._dmService.attrs.UUID),Dynamsoft.DWT.lglic(Dynamsoft.DWT.EnumInstance.dwt_desktop,e).then(function(e){return o.parameter.push(e.ar),o.parameter.push(e.cu),o.parameter.push(0),o.parameter.push(""),T.stringify(o)})):T.Promise.resolve(T.stringify(o))).then(function(e){return T.fetch(a._dbrUrlRoot+"ReadBarcode",{mode:"cors",method:"post",body:e,dataType:"arrayBuffer"})}).then(function(e){M(e)?t(String.fromCharCode.apply(null,new Uint8Array(e))):t(e)},function(e){var t="Init template & runtimeSettings failed.";e&&(t=[t," Http info: ",e.errorString," (",e.httpCode,")"].join("")),n(t)})})},e.prototype._innerDecode=function(i,a,_,d){var R=this;return R._runtimeSettings&&0==R._runtimeSettings.expectedBarcodesCount&&(R._runtimeSettings.expectedBarcodesCount=512),new T.Promise(function(s,c){function o(e,t,n){try{var o,r,i,a,_=E&&E(e);for(_&&_.textResults||c(new u.BarcodeReaderException(_.exception,_.description)),T.product.bHTML5Edition&&n&&n.config.data&&(o=T.parse(n.config.data),T.isArray(o.parameter))&&2<o.parameter.length&&4e3==o.parameter[1]&&(4<o.parameter.length&&o.parameter[4]?_.textResults.imageid=o.parameter[4]:0<=(a=(i=o.parameter[2]).indexOf("&index="))&&(_.textResults.imageid=i.substring(a+7,i.indexOf("&t=")))),r=0;r<_.textResults.length;r++){var d=_.textResults[r];d.BarcodeText=d.barcodeText,_.exception!=Dynamsoft.DBR.EnumErrorCode.DBR_SUCCESS&&(d.exception=_.exception)}_.exception!=Dynamsoft.DBR.EnumErrorCode.DBR_SUCCESS&&(_.textResults.exception=_.exception,_.textResults.description=_.description),u._activeXInstance&&_.records&&(Dynamsoft.Lib.each(_.records,function(e,t){Dynamsoft.DWT.lavrf(t,e,Dynamsoft.DWT.EnumInstance.dwt_desktop)}),Dynamsoft.DWT.lavrf_(1,Dynamsoft.DWT.EnumInstance.dwt_desktop)),s(_.textResults)}catch(e){c(e)}}var t,e,n={method:"ReadBarcode",parameter:[Dynamsoft.Lib.product.refProductKey,i,0!=i?a:null,_||""],updateSettings:R._runtimeSettings,conflictMode:1==R.conflictMode?"ignore":"overwrite",initSettingsContent:R._initSettingsContent,tplContent:function(){if(_)for(var e=0;e<R._tplContentArr.length;++e)if(_==R._tplContentArr[e].ImageParameter.Name)return T.stringify(R._tplContentArr[e]);return null}()},r=R._stwain;u._activeXInstance?r._blts?Dynamsoft.DWT.lglic(Dynamsoft.DWT.EnumInstance.dwt_desktop,"").then(function(e){n.parameter.push(e.ar),n.parameter.push(e.cu),n.parameter.push(0),n.parameter.push(""),o(u._activeXInstance.Process(T.stringify(n),location.protocol+"//"+location.host))}):o(u._activeXInstance.Process(T.stringify(n),location.protocol+"//"+location.host)):(t=r._dbrUrlRoot+"ReadBarcode",0==i&&(t+="/LoadZipFromBytes?cmd="+encodeURIComponent(T.stringify(n))),(0==i?T.Promise.resolve(a):r._blts?(e="",r&&r._bRemoteMode&&r._dmService&&r._dmService.attrs&&r._dmService.attrs.UUID&&(e=r._dmService.attrs.UUID),Dynamsoft.DWT.lglic(Dynamsoft.DWT.EnumInstance.dwt_desktop,e).then(function(e){return n.parameter.push(e.ar),n.parameter.push(e.cu),n.parameter.push(0),n.parameter.push([T.product.getDWTPrefix(),T.product.getServerVersionInfo(),"/verify?id=",d,"&t=",T.getRandom()].join("")),T.stringify(n)})):T.Promise.resolve(T.stringify(n))).then(function(e){return T.fetch(t,{mode:"cors",method:"post",body:e,dataType:"arrayBuffer"})}).then(function(e,t,n){M(e)?o(String.fromCharCode.apply(null,new Uint8Array(e)),0,n):o(e,0,n)},function(e){var t="ReadBarcode request fail.";e&&(t=[t," Http info: ",e.errorString," (",e.httpCode,")"].join("")),c(Error(t))}))})},E=u._handleRetJsonString=function(t){var n;if("string"==typeof t||"object"==typeof t&&t instanceof String)try{n=T.parse(t)}catch(e){n=T.parse(u.RemoveNonPrintableChar(t))}else n=t;if(!n)throw u.BarcodeReaderException(Dynamsoft.DBR.EnumErrorCode.DBR_UNKNOWN,u.errors.decodeResultEmpty);if("textResults"in n&&T.isArray(n.textResults)||n.exception==Dynamsoft.DBR.EnumErrorCode.DBR_SUCCESS)return n;throw u.BarcodeReaderException(n.exception,n.description)},e.prototype.getAllParameterTemplateNames=function(){for(var e=[],t=0;t<this._tplContentArr.length;++t)e.push(this._tplContentArr[t].ImageParameter.Name);return e},e.prototype.getRuntimeSettings=function(){return this._runtimeSettings||(this._runtimeSettings=T.parse(u._defaultRuntimeSettingsStr)),T.Promise.resolve(this._runtimeSettings)};return e.prototype.updateRuntimeSettings=function(e){var t,n=this;if("string"==typeof e||"object"==typeof e&&e instanceof String){if("speed"==e||"balance"==e||"coverage"==e||"default"==e)return n.initRuntimeSettingsWithString("speed"==e?'{"ImageParameter":{"AccompanyingTextRecognitionModes":[{"Mode":"ATRM_SKIP"}],"BarcodeColourModes":[{"LightReflection":1,"Mode":"BICM_DARK_ON_LIGHT"}],"BarcodeComplementModes":[{"Mode":"BCM_SKIP"}],"BarcodeFormatIds":["BF_ALL"],"BarcodeFormatIds_2":["BF2_POSTALCODE","BF2_DOTCODE"],"BinarizationModes":[{"BlockSizeX":0,"BlockSizeY":0,"EnableFillBinaryVacancy":1,"ImagePreprocessingModesIndex":-1,"Mode":"BM_LOCAL_BLOCK","ThreshValueCoefficient":10}],"ColourClusteringModes":[{"Mode":"CCM_SKIP"}],"ColourConversionModes":[{"BlueChannelWeight":-1,"GreenChannelWeight":-1,"Mode":"CICM_GENERAL","RedChannelWeight":-1}],"DPMCodeReadingModes":[{"Mode":"DPMCRM_SKIP"}],"DeblurLevel":3,"DeformationResistingModes":[{"Mode":"DRM_SKIP"}],"Description":"","ExpectedBarcodesCount":512,"FormatSpecificationNameArray":null,"GrayscaleTransformationModes":[{"Mode":"GTM_ORIGINAL"}],"ImagePreprocessingModes":[{"Mode":"IPM_GENERAL"}],"IntermediateResultSavingMode":{"Mode":"IRSM_MEMORY"},"IntermediateResultTypes":["IRT_NO_RESULT"],"LocalizationModes":[{"Mode":"LM_CONNECTED_BLOCKS"},{"Mode":"LM_STATISTICS_MARKS"},{"Mode":"LM_STATISTICS_POSTAL_CODE"}],"MaxAlgorithmThreadCount":4,"Name":"bestSpeed","PDFRasterDPI":300,"PDFReadingMode":{"Mode":"PDFRM_AUTO"},"Pages":"","RegionDefinitionNameArray":null,"RegionPredetectionModes":[{"Mode":"RPM_GENERAL"}],"ResultCoordinateType":"RCT_PIXEL","ReturnBarcodeZoneClarity":0,"ScaleDownThreshold":2300,"ScaleUpModes":[{"Mode":"SUM_AUTO"}],"TerminatePhase":"TP_BARCODE_RECOGNIZED","TextAssistedCorrectionMode":{"BottomTextPercentageSize":0,"LeftTextPercentageSize":0,"Mode":"TACM_VERIFYING","RightTextPercentageSize":0,"TopTextPercentageSize":0},"TextFilterModes":[{"Mode":"TFM_SKIP"}],"TextResultOrderModes":[{"Mode":"TROM_CONFIDENCE"},{"Mode":"TROM_POSITION"},{"Mode":"TROM_FORMAT"}],"TextureDetectionModes":[{"Mode":"TDM_GENERAL_WIDTH_CONCENTRATION","Sensitivity":5}],"Timeout":10000},"Version":"3.0"}':"balance"==e?'{"ImageParameter":{"AccompanyingTextRecognitionModes":[{"Mode":"ATRM_SKIP"}],"BarcodeColourModes":[{"LightReflection":1,"Mode":"BICM_DARK_ON_LIGHT"}],"BarcodeComplementModes":[{"Mode":"BCM_SKIP"}],"BarcodeFormatIds":["BF_ALL"],"BarcodeFormatIds_2":["BF2_POSTALCODE","BF2_DOTCODE"],"BinarizationModes":[{"BlockSizeX":0,"BlockSizeY":0,"EnableFillBinaryVacancy":1,"ImagePreprocessingModesIndex":-1,"Mode":"BM_LOCAL_BLOCK","ThreshValueCoefficient":10}],"ColourClusteringModes":[{"Mode":"CCM_SKIP"}],"ColourConversionModes":[{"BlueChannelWeight":-1,"GreenChannelWeight":-1,"Mode":"CICM_GENERAL","RedChannelWeight":-1}],"DPMCodeReadingModes":[{"Mode":"DPMCRM_SKIP"}],"DeblurLevel":5,"DeformationResistingModes":[{"Mode":"DRM_SKIP"}],"Description":"","ExpectedBarcodesCount":512,"FormatSpecificationNameArray":null,"GrayscaleTransformationModes":[{"Mode":"GTM_ORIGINAL"}],"ImagePreprocessingModes":[{"Mode":"IPM_GENERAL"}],"IntermediateResultSavingMode":{"Mode":"IRSM_MEMORY"},"IntermediateResultTypes":["IRT_NO_RESULT"],"LocalizationModes":[{"Mode":"LM_CONNECTED_BLOCKS"},{"Mode":"LM_STATISTICS"},{"Mode":"LM_STATISTICS_MARKS"},{"Mode":"LM_STATISTICS_POSTAL_CODE"}],"MaxAlgorithmThreadCount":4,"Name":"balance","PDFRasterDPI":300,"PDFReadingMode":{"Mode":"PDFRM_AUTO"},"Pages":"","RegionDefinitionNameArray":null,"RegionPredetectionModes":[{"Mode":"RPM_GENERAL"}],"ResultCoordinateType":"RCT_PIXEL","ReturnBarcodeZoneClarity":0,"ScaleDownThreshold":2300,"ScaleUpModes":[{"Mode":"SUM_AUTO"}],"TerminatePhase":"TP_BARCODE_RECOGNIZED","TextAssistedCorrectionMode":{"BottomTextPercentageSize":0,"LeftTextPercentageSize":0,"Mode":"TACM_VERIFYING","RightTextPercentageSize":0,"TopTextPercentageSize":0},"TextFilterModes":[{"MinImageDimension":65536,"Mode":"TFM_GENERAL_CONTOUR","Sensitivity":0}],"TextResultOrderModes":[{"Mode":"TROM_CONFIDENCE"},{"Mode":"TROM_POSITION"},{"Mode":"TROM_FORMAT"}],"TextureDetectionModes":[{"Mode":"TDM_GENERAL_WIDTH_CONCENTRATION","Sensitivity":5}],"Timeout":10000},"Version":"3.0"}':"coverage"==e?'{"ImageParameter":{"AccompanyingTextRecognitionModes":[{"Mode":"ATRM_SKIP"}],"BarcodeColourModes":[{"LightReflection":1,"Mode":"BICM_DARK_ON_LIGHT"}],"BarcodeComplementModes":[{"Mode":"BCM_SKIP"}],"BarcodeFormatIds":["BF_ALL"],"BarcodeFormatIds_2":["BF2_POSTALCODE","BF2_DOTCODE"],"BinarizationModes":[{"BlockSizeX":0,"BlockSizeY":0,"EnableFillBinaryVacancy":1,"ImagePreprocessingModesIndex":-1,"Mode":"BM_LOCAL_BLOCK","ThreshValueCoefficient":10}],"ColourClusteringModes":[{"Mode":"CCM_SKIP"}],"ColourConversionModes":[{"BlueChannelWeight":-1,"GreenChannelWeight":-1,"Mode":"CICM_GENERAL","RedChannelWeight":-1}],"DPMCodeReadingModes":[{"Mode":"DPMCRM_SKIP"}],"DeblurLevel":9,"DeformationResistingModes":[{"Mode":"DRM_SKIP"}],"Description":"","ExpectedBarcodesCount":512,"FormatSpecificationNameArray":null,"GrayscaleTransformationModes":[{"Mode":"GTM_ORIGINAL"},{"Mode":"GTM_INVERTED"}],"ImagePreprocessingModes":[{"Mode":"IPM_GENERAL"}],"IntermediateResultSavingMode":{"Mode":"IRSM_MEMORY"},"IntermediateResultTypes":["IRT_NO_RESULT"],"LocalizationModes":[{"Mode":"LM_CONNECTED_BLOCKS"},{"Mode":"LM_SCAN_DIRECTLY","ScanDirection":0,"ScanStride":0},{"Mode":"LM_STATISTICS"},{"Mode":"LM_LINES"},{"Mode":"LM_STATISTICS_MARKS"},{"Mode":"LM_STATISTICS_POSTAL_CODE"}],"MaxAlgorithmThreadCount":4,"Name":"coverage","PDFRasterDPI":300,"PDFReadingMode":{"Mode":"PDFRM_AUTO"},"Pages":"","RegionDefinitionNameArray":null,"RegionPredetectionModes":[{"Mode":"RPM_GENERAL"}],"ResultCoordinateType":"RCT_PIXEL","ReturnBarcodeZoneClarity":0,"ScaleDownThreshold":214748347,"ScaleUpModes":[{"Mode":"SUM_AUTO"}],"TerminatePhase":"TP_BARCODE_RECOGNIZED","TextAssistedCorrectionMode":{"BottomTextPercentageSize":0,"LeftTextPercentageSize":0,"Mode":"TACM_VERIFYING","RightTextPercentageSize":0,"TopTextPercentageSize":0},"TextFilterModes":[{"MinImageDimension":65536,"Mode":"TFM_GENERAL_CONTOUR","Sensitivity":0}],"TextResultOrderModes":[{"Mode":"TROM_CONFIDENCE"},{"Mode":"TROM_POSITION"},{"Mode":"TROM_FORMAT"}],"TextureDetectionModes":[{"Mode":"TDM_GENERAL_WIDTH_CONCENTRATION","Sensitivity":5}],"Timeout":10000},"Version":"3.0"}':'{"ImageParameter":{"AccompanyingTextRecognitionModes":[{"Mode":"ATRM_SKIP"}],"BarcodeColourModes":[{"LightReflection":1,"Mode":"BICM_DARK_ON_LIGHT"}],"BarcodeComplementModes":[{"Mode":"BCM_SKIP"}],"BarcodeFormatIds":["BF_ALL"],"BarcodeFormatIds_2":null,"BinarizationModes":[{"BlockSizeX":0,"BlockSizeY":0,"EnableFillBinaryVacancy":1,"ImagePreprocessingModesIndex":-1,"Mode":"BM_LOCAL_BLOCK","ThreshValueCoefficient":10}],"ColourClusteringModes":[{"Mode":"CCM_SKIP"}],"ColourConversionModes":[{"BlueChannelWeight":-1,"GreenChannelWeight":-1,"Mode":"CICM_GENERAL","RedChannelWeight":-1}],"DPMCodeReadingModes":[{"Mode":"DPMCRM_SKIP"}],"DeblurLevel":9,"DeformationResistingModes":[{"Mode":"DRM_SKIP"}],"Description":"","ExpectedBarcodesCount":512,"FormatSpecificationNameArray":null,"GrayscaleTransformationModes":[{"Mode":"GTM_ORIGINAL"}],"ImagePreprocessingModes":[{"Mode":"IPM_GENERAL"}],"IntermediateResultSavingMode":{"Mode":"IRSM_MEMORY"},"IntermediateResultTypes":["IRT_NO_RESULT"],"LocalizationModes":[{"Mode":"LM_CONNECTED_BLOCKS"},{"Mode":"LM_SCAN_DIRECTLY","ScanDirection":0,"ScanStride":0},{"Mode":"LM_STATISTICS"},{"Mode":"LM_LINES"}],"MaxAlgorithmThreadCount":4,"Name":"default","PDFRasterDPI":300,"PDFReadingMode":{"Mode":"PDFRM_AUTO"},"Pages":"","RegionDefinitionNameArray":null,"RegionPredetectionModes":[{"Mode":"RPM_GENERAL"}],"ResultCoordinateType":"RCT_PIXEL","ReturnBarcodeZoneClarity":0,"ScaleDownThreshold":2300,"ScaleUpModes":[{"Mode":"SUM_AUTO"}],"TerminatePhase":"TP_BARCODE_RECOGNIZED","TextAssistedCorrectionMode":{"BottomTextPercentageSize":0,"LeftTextPercentageSize":0,"Mode":"TACM_VERIFYING","RightTextPercentageSize":0,"TopTextPercentageSize":0},"TextFilterModes":[{"MinImageDimension":65536,"Mode":"TFM_GENERAL_CONTOUR","Sensitivity":0}],"TextResultOrderModes":[{"Mode":"TROM_CONFIDENCE"},{"Mode":"TROM_POSITION"},{"Mode":"TROM_FORMAT"}],"TextureDetectionModes":[{"Mode":"TDM_GENERAL_WIDTH_CONCENTRATION","Sensitivity":5}],"Timeout":10000},"Version":"3.0"}');t=e}else{if("object"!=typeof e)throw TypeError("'setTemplateSettings(settings)': Type of 'settings' should be 'String' or 'PlainObject'.");t=T.stringify(e)}e=T.parse(t);return n._runtimeSettings=e,n._initSettingsContent=null,n._innerServiceCmd(n._runtimeSettings,null).then(function(e){e=u._handleRetJsonString(e);return n._runtimeSettings=e.settings,n._runtimeSettings||(n._runtimeSettings=T.parse(u._defaultRuntimeSettingsStr)),e.settings})},e.prototype.resetRuntimeSettings=function(){var t=this;return t._runtimeSettings=T.parse(u._defaultRuntimeSettingsStr),t._initSettingsContent=null,t._innerServiceCmd(t._runtimeSettings,null).then(function(e){e=u._handleRetJsonString(e);return t._runtimeSettings=e.settings,t._runtimeSettings||(t._runtimeSettings=T.parse(u._defaultRuntimeSettingsStr)),e.settings})},e.prototype.outputSettingsToString=function(e){if(!e)return u._defaultTemplateStr;for(var t=0;t<this._tplContentArr.length;++t)if(e==this._tplContentArr[t].ImageParameter.Name)return T.stringify(this._tplContentArr[t])},e.prototype.initRuntimeSettingsWithString=function(e){var t=this;if(T.isString(e))return t._runtimeSettings=null,t._initSettingsContent=T.parse(e),t._innerServiceCmd(null,t._initSettingsContent).then(function(e){e=u._handleRetJsonString(e);return t._runtimeSettings=e.settings,t._runtimeSettings||(t._runtimeSettings=T.parse(u._defaultRuntimeSettingsStr)),e.settings});throw TypeError("'initRuntimeSettingsWithString(settings)': Type of 'settings' should be 'String'.")},e}(),u._dbr_ax=!1,u._dbr=!1,u._initH5=function(r,n,o){return new T.Promise(function(e,t){r._bRemoteMode&&r._dmService&&r._dmService.attrs&&r._dmService.attrs.url&&(r._dbrUrlRoot=r._dmService.attrs.url+"dcp/dbr_"+u.Version.replace(/\./g,"")+"/"),r._dbrUrlRoot||(r._dbrUrlRoot=Dynamsoft.DWT.NetManager.getModuleUrl("dcp/dbr_"+u.Version.replace(/\./g,"")+"/"));var n=5,o={method:"POST",url:r._dbrUrlRoot+"VersionInfo?t="+T.getRandom(),data:'{"method":"VersionInfo"}',onSuccess:function(){e()},onError:function(){if(--n<=0)return t("Failed to connect to the Barcode Reader Add-on, the library may be missing in the Dynamsoft Service directory.");setTimeout(function(){T.ajax(o)},300)},dataType:"json",async:!0,timeout:800};T.ajax(o)}).then(function(){return u._dbr=new u.Class(r),u._dbr._innerServiceCmd(null,null)}).then(function(e){try{var t=u._handleRetJsonString(e);u._dbr._runtimeSettings=t.settings,u._defaultRuntimeSettingsStr=T.stringify(t.settings),u._defaultTemplateStr=T.stringify(t.outputSettings),n(u._dbr)}catch(e){o(Error("Init template & runtimeSettings failed: "+e.message)||e)}},function(e){o(e)})},u.dbrInitPromiseFun=function(n){return new T.Promise(function(e,t){u.innerDbrInit(n,e,t)})},u.innerDbrInit=function(e,t,n){var o=!1,r=!1,i=(T.product.bHTML5Edition?o=!0:r=!0,Dynamsoft.BarcodeReaderAddon);if(o){if(i._dbr)return void t(i._dbr)}else if(r&&i._dbr_ax)return void t(i._dbr_ax);if(o&&i._initH5(e,t,n),r){o=Dynamsoft.navInfoSync,r={method:"ReadBarcode",parameter:[Dynamsoft.Lib.product.refProductKey,4002,"",""]};if(!o.bIE)return n(Error("The DBR init error."));try{i._activeXInstance=new ActiveXObject("DBRModule.AtlDBR");var a,_=i._activeXInstance.Process(T.stringify(r),location.protocol+"//"+location.host),d=T.parse(_);return d?"settings"in d?(i._dbr_ax=new i.Class(e),i._dbr_ax._runtimeSettings=d.settings,i._defaultRuntimeSettingsStr=T.stringify(d.settings),"outputSettings"in d&&(i._defaultTemplateStr=T.stringify(d.outputSettings)),void t(i._dbr_ax)):(a=d.description||"The DBR init error.",n(Error(a))):n(Error("The DBR init error."))}catch(e){return n(Error("The DBR .dll is missing or not accessible: "+(e.message||e)))}}},T.DynamicLoadAddonFuns&&T.DynamicLoadAddonFuns.push(function(a){if(t=a._b64bit?"dbrx64_"+Dynamsoft.BarcodeReaderAddon.Version+".dll":"dbr_"+Dynamsoft.BarcodeReaderAddon.Version+".dll",T.product.bHTML5Edition)try{a._innerSend("GetAddOnVersion",T.html5.Funs.makeParams("barcodereader",t),!0,!1,!1).catch(function(){})}catch(e){}function n(e){return!T.License.checkProductKey(e,{Core:!0})||!!(Dynamsoft.navInfoSync.bMac||Dynamsoft.navInfoSync.bLinux||Dynamsoft.Lib.env.bMobile)&&(e._errorCode=Dynamsoft.DBR.EnumErrorCode.DBR_UNKNOWN,e._errorString=u.errors.ServiceEditionNotSupportDbr,!0)}var e={BarcodeReader:{decode:function(t){return n(a)?T.Promise.reject(u.BarcodeReaderException(a._errorCode,a._errorString)):!T.isNumber(t)||t<0||t>=a.HowManyImagesInBuffer?(T.Errors.IndexOutOfRange(a),T.Promise.reject(u.BarcodeReaderException(a._errorCode,a._errorString))):new T.Promise(function(e){u._decoding?u._decodeQueue.push({method:e,args:[t]}):(u._decoding=!0,e(t))}).then(function(e){var i;if(T.product.bHTML5Edition){if(-1==(i=a._ImgManager.convertClientIndexToServerId(e)))throw T.Errors.IndexOutOfRange(a),setTimeout(u._decodeNext,0),u.BarcodeReaderException(a._errorCode,a._errorString)}else i=e;return new T.Promise(function(o,r){u.dbrInitPromiseFun(a).then(function(e){var t;if(!T.product.bHTML5Edition)return t=i,n=a.GetImagePartURL(t,-1,-1),e._innerDecode(4001,n,"").then(function(e){e.imageid=a.IndexToImageID(t),setTimeout(u._decodeNext,0),o(e)},function(e){setTimeout(u._decodeNext,0),r(e)});t=a._ImgManager.convertServerIdToClientIndex(i);var n=a.GetImagePartURL(t,-1,-1);return e._innerDecode(4e3,n,"",a._clientId).then(function(e){e.imageid=a.IndexToImageID(t),setTimeout(u._decodeNext,0),o(e),a._blts&&Dynamsoft.DWT.lcvrf(a)},function(e){setTimeout(u._decodeNext,0),r(e)})},function(e){setTimeout(u._decodeNext,0),r(e)})})})},resetRuntimeSettings:function(){return n(a)?T.Promise.reject(u.BarcodeReaderException(a._errorCode,a._errorString)):u.dbrInitPromiseFun(a).then(function(e){return e.resetRuntimeSettings()})},getRuntimeSettings:function(e){return n(a)?T.Promise.reject(u.BarcodeReaderException(a._errorCode,a._errorString)):!T.isString(e)||"speed"!=e&&"balance"!=e&&"coverage"!=e&&"default"!=e?u.dbrInitPromiseFun(a).then(function(e){return e.getRuntimeSettings()}):this.updateRuntimeSettings(e)},updateRuntimeSettings:function(t){return n(a)?T.Promise.reject(u.BarcodeReaderException(a._errorCode,a._errorString)):u.dbrInitPromiseFun(a).then(function(e){return e.updateRuntimeSettings(t)})},initRuntimeSettingsWithString:function(t){return n(a)?T.Promise.reject(u.BarcodeReaderException(a._errorCode,a._errorString)):u.dbrInitPromiseFun(a).then(function(e){return e.initRuntimeSettingsWithString(t)})}}};T.product.bHTML5Edition?(a.__addon=a.__addon||{},T.mix(a.__addon,e)):(a.Addon=a.Addon||{},T.mix(a.Addon,e))})}); 
/*! 20230919170045
* Dynamsoft JavaScript Library
* Product: Dynamsoft Web TWAIN
* Web Site: https://www.dynamsoft.com
*
* Copyright 2023, Dynamsoft Corporation
* Author: Dynamsoft Support Team
*
* Module: PDF
* Version: 18.4
* 
*/
var Dynamsoft=self.Dynamsoft||{};Dynamsoft.DWT=Dynamsoft.DWT||{},Dynamsoft.aryAddonReadyFun=Dynamsoft.aryAddonReadyFun||[],Dynamsoft.AddonReady=Dynamsoft.AddonReady||function(n){Dynamsoft.aryAddonReadyFun.push(n)},function(){Dynamsoft.DWT.EnumDWT_ConvertMode={CM_RENDERALL:1,CM_IMAGEONLY:2,CM_AUTO:3,CM_RENDERALLWITHANNOTATION:4},Dynamsoft.DWT.EnumDWT_PDFCompressionType={PDF_AUTO:0,PDF_FAX3:1,PDF_FAX4:2,PDF_LZW:3,PDF_RLE:4,PDF_JPEG:5,PDF_JP2000:6,PDF_JBIG2:7}}(),Dynamsoft.AddonReady(function(t,n){var o,e;t.product.bHTML5Edition&&(o={code:-2830,message:"The PDF resolution must be a positive number."},t.DynamicLoadAddonFuns)&&t.DynamicLoadAddonFuns.push(function(i){var n,a=t.html5.Funs;e=i.__serverPlatform==Dynamsoft.DWT.EnumDWT_PlatformType.enumMac?i._b64bit?"libDynamicPdfCorex64_"+Dynamsoft.DWT.PdfVersion+".dylib":"libDynamicPdfCore_"+Dynamsoft.DWT.PdfVersion+".dylib":i.__serverPlatform==Dynamsoft.DWT.EnumDWT_PlatformType.enumLinux||i.__serverPlatform==Dynamsoft.DWT.EnumDWT_PlatformType.enumEmbed||i.__serverPlatform==Dynamsoft.DWT.EnumDWT_PlatformType.enumChromeOS?"libDynamicPdfCore_"+Dynamsoft.DWT.PdfVersion+".so":i._b64bit?"DynamicPdfCorex64_"+Dynamsoft.DWT.PdfVersion+".dll":"DynamicPdfCore_"+Dynamsoft.DWT.PdfVersion+".dll";try{i._innerSend("GetAddOnVersion",a.makeParams("pdf",e),!0,!1,!1).catch(function(){})}catch(n){}n={PDF:{IsModuleInstalled:function(){var n=i;return n._resetErr(),""!=n._innerFun("GetAddOnVersion",a.makeParams("pdf",e))},IsModuleInstalledAsync:function(){var n=i;return n._resetErr(),n._innerFunV2("GetAddOnVersion",a.makeParams("pdf",e)).then(function(n){return""!=n})},ConvertToImage:function(n,e,r,o){var n=a.replaceLocalFilename(n),t="ConvertPDFToImage",s=i;return s._resetErr(),a.showMask(t),s._innerSend(t,a.makeParams(n,e),!0,function(n){return a.hideMask(t),r&&r(),!0},function(n){return a.hideMask(t),o&&o(),!1}),!0},SetPassword:function(n){var e=i,r=n||"";return e._resetErr(),r=e._mixSavedPdfReaderOptions({password:r}),(r=e._setReaderOptions(r,!1))&&(e._pdfOptions.password=n),r},SetConvertMode:function(n){return i._setConvertMode(n)},SetConvertModeAsync:function(n){return i._setConvertModeAsync(n)},GetConvertMode:function(){var n=i;return n._resetErr(),n._pdfConvertMode},SetResolution:function(n){var e=i,r=n;return e._resetErr(),r=e._mixSavedPdfReaderOptions({renderOptions:{resolution:r}}),(r=e._setReaderOptions(r,!1))&&(e._pdfOptions.renderOptions.resolution=n),r},SetResolutionAsync:function(e){var r=i;return r._resetErr(),!Dynamsoft.Lib.isNumber(e)||e<=0?Dynamsoft.Lib.Promise.reject(o):r._innerFunV2("SetPDFResolution",a.makeParams(e)).then(function(n){n&&(r._pdfOptions.renderOptions.resolution=e)})},SetReaderOptions:function(n){return i._setReaderOptions(n,!0)},GetReaderOptions:function(){var n,e=i;return e._resetErr(),n=i._innerFun("GetPDFReaderOptions"),n=Dynamsoft.Lib.parse(n),e._pdfOptions=e._mixSavedPdfReaderOptions(n),Dynamsoft.Lib.clone(e._pdfOptions)},IsTextBasedPDF:function(n,e,r){var o=i,n=(o._resetErr(),a.replaceLocalFilename(n)),n=i._innerFun("IsTextBasedPDF",a.makeParams(n));return 0==o.ErrorCode?t.isFunction(e)&&e(n):t.isFunction(r)&&r(o.ErrorCode,o.ErrorString),n},Write:{Setup:function(n){var n=(n=n)||{version:15},e=(2<t.stringify(n).length&&(t.isNumber(n.version)?1<=n.version&&n.version<2&&(n.version=parseInt(10*n.version)):n.version=15),t.isNumber(n.compression)&&n.compression==Dynamsoft.DWT.EnumDWT_PDFCompressionType.PDF_FAX3&&(n.compression=Dynamsoft.DWT.EnumDWT_PDFCompressionType.PDF_FAX4),i),n=(e._resetErr(),t.stringify(n)),n=t.replaceAll(n,'"','\\"');return e._innerFun("SetPDFSettings",['["',n,'"]'].join(""))}}}},i.__addon=i.__addon||{},t.mix(i.__addon,n)})}),Dynamsoft.AddonReady(function(i,n){i.product.bActiveXEdition&&i.DynamicLoadAddonFuns&&i.DynamicLoadAddonFuns.push(function(t){var n,s,e;if(!t.getSWebTwain()||!t.getSWebTwain().Addon)return!1;Dynamsoft.navInfoSync.bWin&&(e=!Dynamsoft.navInfo.bOSx64||Dynamsoft.navInfo.bWOW64?"DynamicPdfCore_"+Dynamsoft.DWT.PdfVersion+".dll":"DynamicPdfCorex64_"+Dynamsoft.DWT.PdfVersion+".dll"),s=t.getSWebTwain(),n={PDF:{IsModuleInstalled:function(){var n=s.GetAddOnVersion("pdf",e);return i.setErrorString(t),""!=n},IsModuleInstalledAsync:function(){var n=s.GetAddOnVersion("pdf",e);return i.setErrorString(t),i.Promise.resolve(""!=n)},ConvertToImage:function(n,e,r,o){n=s.ConvertPDFToImage(n,e);return i.wrapperRet(t,n,r,o)},SetPassword:function(n){n=s.SetPDFPassword(n);return i.wrapperRet(t,n)},SetConvertMode:function(n){return t._setConvertMode(n)},SetConvertModeAsync:function(n){return Promise.resolve(t._setConvertMode(n))},GetConvertMode:function(){return t._resetErr(),t._pdfConvertMode},SetResolution:function(n){n=s.SetPDFResolution(n);return i.wrapperRet(t,n)},SetResolutionAsync:function(n){n=s.SetPDFResolution(n);return i.Promise.resolve(i.wrapperRet(t,n))},SetReaderOptions:function(){return!1},GetReaderOptions:function(){return{}},IsTextBasedPDF:function(n){n=s.IsTextBasedPDF(n);return i.wrapperRet(t,n)}}},t.Addon=t.Addon||{},i.mix(t.Addon,n)})}); 
/*! 20230919170045
* Dynamsoft JavaScript Library
* Product: Dynamsoft Web TWAIN
* Web Site: https://www.dynamsoft.com
*
* Copyright 2023, Dynamsoft Corporation
* Author: Dynamsoft Support Team
*
* Module: OCR
* Version: 18.4
* 
*/
var Dynamsoft=self.Dynamsoft||{};Dynamsoft.DWT=Dynamsoft.DWT||{},Dynamsoft.aryAddonReadyFun=Dynamsoft.aryAddonReadyFun||[],Dynamsoft.AddonReady=Dynamsoft.AddonReady||function(t){Dynamsoft.aryAddonReadyFun.push(t)},Dynamsoft.DWT.OCRVerInName="10.0.0.0618",function(){for(var t=[Dynamsoft.DWT],e=0;e<1;e++){var n=t[e];n.EnumDWT_OCRLanguage={OCRL_ENG:"eng",OCRL_ARA:"ara",OCRL_CHI_SIM:"chi_sim",OCRL_CHI_TRA:"chi_tra",OCRL_HIN:"hin",OCRL_URD:"urd",OCRL_SPA:"spa",OCRL_FRA:"fra",OCRL_MSA:"msa",OCRL_IND:"ind",OCRL_RUS:"rus",OCRL_BEN:"ben",OCRL_POR:"por",OCRL_PAN:"pan",OCRL_DEU:"deu",OCRL_JPN:"jpn",OCRL_FAS:"fas",OCRL_SWA:"swa",OCRL_JAV:"jav",OCRL_TEL:"tel",OCRL_TUR:"tur",OCRL_KOR:"kor",OCRL_MAR:"mar",OCRL_TAM:"tam",OCRL_VIE:"vie",OCRL_ITA:"ita",OCRL_THA:"tha"},n.EnumDWT_OCRPageSetMode={OCRPSM_OSD_ONLY:0,PSM_AUTO_OSD:1,PSM_AUTO_ONLY:2,PSM_AUTO:3,PSM_SINGLE_COLUMN:4,PSM_SINGLE_BLOCK_VERT_TEXT:5,PSM_SINGLE_BLOCK:6,PSM_SINGLE_LINE:7,PSM_SINGLE_WORD:8,PSM_CIRCLE_WORD:9,PSM_SINGLE_CHAR:10},n.EnumDWT_OCROutputFormat={OCROF_TEXT:0,OCROF_PDFPLAINTEXT:1,OCROF_PDFIMAGEOVERTEXT:2,OCROF_PDFPLAINTEXT_PDFX:3,OCROF_PDFIMAGEOVERTEXT_PDFX:4},n.EnumDWT_OCRDownloadType={OCRDT_Dll:0,OCRDT_LANGUAGE:1}}}(),Dynamsoft.DWT.OCRLanguageData_eng="4113088",Dynamsoft.DWT.OCRLanguageData_ara="1432056",Dynamsoft.DWT.OCRLanguageData_chi_sim="2469156",Dynamsoft.DWT.OCRLanguageData_chi_tra="2366642",Dynamsoft.DWT.OCRLanguageData_hin="1122751",Dynamsoft.DWT.OCRLanguageData_urd="1398718",Dynamsoft.DWT.OCRLanguageData_spa="2294433",Dynamsoft.DWT.OCRLanguageData_fra="1130365",Dynamsoft.DWT.OCRLanguageData_msa="1747801",Dynamsoft.DWT.OCRLanguageData_ind="1122661",Dynamsoft.DWT.OCRLanguageData_rus="3861738",Dynamsoft.DWT.OCRLanguageData_ben="855841",Dynamsoft.DWT.OCRLanguageData_por="1982756",Dynamsoft.DWT.OCRLanguageData_pan="497721",Dynamsoft.DWT.OCRLanguageData_deu="1525436",Dynamsoft.DWT.OCRLanguageData_jpn="2471260",Dynamsoft.DWT.OCRLanguageData_fas="431500",Dynamsoft.DWT.OCRLanguageData_swa="2167651",Dynamsoft.DWT.OCRLanguageData_jav="2982741",Dynamsoft.DWT.OCRLanguageData_tel="2769654",Dynamsoft.DWT.OCRLanguageData_tur="4550554",Dynamsoft.DWT.OCRLanguageData_kor="1677415",Dynamsoft.DWT.OCRLanguageData_mar="2118233",Dynamsoft.DWT.OCRLanguageData_tam="3237963",Dynamsoft.DWT.OCRLanguageData_vie="531275",Dynamsoft.DWT.OCRLanguageData_ita="2701314",Dynamsoft.DWT.OCRLanguageData_tha="1072600",Dynamsoft.DWT.OCRLanguageData={},Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_ENG]=Dynamsoft.DWT.OCRLanguageData_eng,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_ARA]=Dynamsoft.DWT.OCRLanguageData_ara,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_CHI_TRA]=Dynamsoft.DWT.OCRLanguageData_chi_tra,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_CHI_SIM]=Dynamsoft.DWT.OCRLanguageData_chi_sim,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_HIN]=Dynamsoft.DWT.OCRLanguageData_hin,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_URD]=Dynamsoft.DWT.OCRLanguageData_urd,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_SPA]=Dynamsoft.DWT.OCRLanguageData_spa,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_FRA]=Dynamsoft.DWT.OCRLanguageData_fra,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_MSA]=Dynamsoft.DWT.OCRLanguageData_msa,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_IND]=Dynamsoft.DWT.OCRLanguageData_ind,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_RUS]=Dynamsoft.DWT.OCRLanguageData_rus,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_BEN]=Dynamsoft.DWT.OCRLanguageData_ben,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_POR]=Dynamsoft.DWT.OCRLanguageData_por,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_PAN]=Dynamsoft.DWT.OCRLanguageData_pan,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_DEU]=Dynamsoft.DWT.OCRLanguageData_deu,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_JPN]=Dynamsoft.DWT.OCRLanguageData_jpn,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_FAS]=Dynamsoft.DWT.OCRLanguageData_fas,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_SWA]=Dynamsoft.DWT.OCRLanguageData_swa,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_JAV]=Dynamsoft.DWT.OCRLanguageData_jav,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_TEL]=Dynamsoft.DWT.OCRLanguageData_tel,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_TUR]=Dynamsoft.DWT.OCRLanguageData_tur,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_KOR]=Dynamsoft.DWT.OCRLanguageData_kor,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_MAR]=Dynamsoft.DWT.OCRLanguageData_mar,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_TAM]=Dynamsoft.DWT.OCRLanguageData_tam,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_VIE]=Dynamsoft.DWT.OCRLanguageData_vie,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_ITA]=Dynamsoft.DWT.OCRLanguageData_ita,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_THA]=Dynamsoft.DWT.OCRLanguageData_tha,function(t){function e(){var t=this;t._text="",t._fontName="",t._fontSize="",t._left=0,t._top=0,t._right=0,t._bottom=0}e.prototype.GetText=function(){return this._text},e.prototype.GetFontName=function(){return this._fontName},e.prototype.GetFontSize=function(){return this._fontSize},e.prototype.GetWordRect=function(){var t=this;return t._left+","+t._top+","+t._right+","+t._bottom},t.NewWordBasicResult=function(){return new e}}(Dynamsoft.Lib),function(t){function e(){var t=this;t._count=0,t._left=0,t._top=0,t._right=0,t._bottom=0,t._wordlist=[]}e.prototype.GetWordCount=function(){return this._count},e.prototype.GetLineRect=function(){var t=this;return t._left+","+t._top+","+t._right+","+t._bottom},e.prototype.GetWordContent=function(t){var e=this,n=e._wordlist.length;return e._errorCode<0?"":null==t||n<=t||t<0?(Dynamsoft.Lib.Errors.OCR_InvalidIndex(e,"GetWordContent"),""):((n=Dynamsoft.Lib.NewWordBasicResult())._text=e._wordlist[t].text,n._fontName=e._wordlist[t].fontname,n._fontSize=e._wordlist[t].fontsize,n._left=e._wordlist[t].rect[0],n._top=e._wordlist[t].rect[1],n._right=e._wordlist[t].rect[2],n._bottom=e._wordlist[t].rect[3],n)},t.NewLineBasicResult=function(){return new e}}(Dynamsoft.Lib),function(t){function e(){this._count=0,this._linelist=[]}e.prototype.GetLineCount=function(){return this._count},e.prototype.GetLineContent=function(t){var e=this,n=e._linelist.length;return e._errorCode<0?"":null==t||n<=t||t<0?(Dynamsoft.Lib.Errors.OCR_InvalidIndex(e,"GetLineContent"),""):((n=Dynamsoft.Lib.NewLineBasicResult())._count=e._linelist[t].words.length,n._left=e._linelist[t].rect[0],n._top=e._linelist[t].rect[1],n._right=e._linelist[t].rect[2],n._bottom=e._linelist[t].rect[3],n._wordlist=e._linelist[t].words,n)},t.NewPageBasicResult=function(){return new e}}(Dynamsoft.Lib),function(t){function e(){this._count=0,this._pagelist=[]}e.prototype.GetPageCount=function(){return this._count},e.prototype.GetPageContent=function(t){var e=this,n=e._pagelist.length;return e._errorCode<0?"":null==t||n<=t||t<0?(Dynamsoft.Lib.Errors.OCR_InvalidIndex(e,"GetPageContent"),""):((n=Dynamsoft.Lib.NewPageBasicResult())._count=e._pagelist[t].lines.length,n._linelist=e._pagelist[t].lines,n)},t.NewPageSetBasicResult=function(){return new e}}(Dynamsoft.Lib),function(e){function n(t){var e=this;e._errorCode=0,e._errorString="",e._resultlist=[],e._stwain=t}n.prototype.GetErrorCode=function(){return this._errorCode},n.prototype.GetErrorString=function(){return this._errorString},n.prototype.GetFormat=function(){return this._resultlist[0].format},n.prototype.GetInput=function(){var t=this._resultlist[0].input;if(t){var e=Number(t);if(!isNaN(e))return this._stwain._ImgManager.convertServerIdToClientIndex(e)}return t},n.prototype.GetPageSetCount=function(){return this._resultlist[0].pagesets.length},n.prototype.GetPageSetContent=function(t){var e=this,n=e._resultlist[0].pagesets.length;return e._errorCode<0?"":null==t||n<=t||t<0?(Dynamsoft.Lib.Errors.OCR_InvalidIndex(e,"GetPageSetContent"),""):((n=Dynamsoft.Lib.NewPageSetBasicResult())._count=e._resultlist[0].pagesets[t].pages.length,n._pagelist=e._resultlist[0].pagesets[t].pages,n)},n.prototype.Get=function(){return this._stwain._innerFun("GetOCRRestult")},n.prototype.Save=function(t){t=e.html5.Funs.replaceLocalFilename(t);return this._stwain._innerFun("SaveOCRRestult",e.html5.Funs.makeParams(t))},e.NewOCRBasicResult=function(t){return new n(t)}}(Dynamsoft.Lib),function(e){function t(){var t=this;t.UnicodeFontName="",t.UseDetectedFont=!0,t.MinFontSizeforMoreAccurateResult=0,t.OCRLanguage=Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_ENG,t.PageSetMode=Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_AUTO,t.OutputFormat=Dynamsoft.DWT.EnumDWT_OCROutputFormat.OCROF_PDFIMAGEOVERTEXT}t.prototype.GetUnicodeFontName=function(){return this.UnicodeFontName},t.prototype.SetUnicodeFontName=function(t){return e.isString(t)||(t=""),this.UnicodeFontName=t,!0},t.prototype.GetUseDetectedFont=function(){return!!this.UseDetectedFont},t.prototype.SetUseDetectedFont=function(t){return this.UseDetectedFont=!!t,!0},t.prototype.GetMinFontSizeforMoreAccurateResult=function(){return this.MinFontSizeforMoreAccurateResult},t.prototype.SetMinFontSizeforMoreAccurateResult=function(t){t=+t;return this.MinFontSizeforMoreAccurateResult=t=t<0?0:t,!0},t.prototype.GetOCRLanguage=function(){return this.OCRLanguage},t.prototype.SetOCRLanguage=function(t){return e.isString(t)||(t=""),this.OCRLanguage=t,!0},t.prototype.GetPageSetMode=function(){return this.PageSetMode},t.prototype.SetPageSetMode=function(t){t=+t;return(t<0||t>Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_SINGLE_CHAR)&&(t=Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_AUTO),this.PageSetMode=t,!0},t.prototype.GetOutputFormat=function(){return this.OutputFormat},t.prototype.SetOutputFormat=function(t){t=+t;return(t<0||t>Dynamsoft.DWT.EnumDWT_OCROutputFormat.OCROF_PDFIMAGEOVERTEXT_PDFX)&&(t=Dynamsoft.DWT.EnumDWT_OCROutputFormat.OCROF_PDFIMAGEOVERTEXT),this.OutputFormat=t,!0},e.NewOptions=function(){return new t}}(Dynamsoft.Lib),Dynamsoft.AddonReady(function(C,t){var g;C.product.bHTML5Edition&&C.DynamicLoadAddonFuns&&C.DynamicLoadAddonFuns.push(function(i){var t,O,m,_=C.html5.Funs,R=C.NewOptions();O=i,m=C.html5.Funs,g=C.env.bMac?"DynamicOCR_"+Dynamsoft.DWT.OCRVerInName+".dylib":C.env.bLinux?"DynamicOCR_"+Dynamsoft.DWT.OCRVerInName+".so":Dynamsoft.dcp.b64bit?"DynamicOCRx64_"+Dynamsoft.DWT.OCRVerInName+".dll":"DynamicOCR_"+Dynamsoft.DWT.OCRVerInName+".dll",O._isMobileMode()||O._innerSend("GetAddOnVersion",m.makeParams("ocr",g),!0,!1,!1),O.__innerOCRBasicReadFunction=function(t,e,n,a,o,r,u,D,s,i,_){return C.isFunction(i)?this.__innerOCRBasicAsyncReadFunction(t,e,n,a,o,r,u,D,s,i,_):this.__innerOCRSyncReadFunction(t,s)},O.__innerGetOCRBasicResultAsyncFunction=function(t){var e=Dynamsoft.Lib.NewOCRBasicResult(this);return t&&(e._errorCode=t.exception,e._errorString=t.description,e._resultlist=t.result),e},O.__innerOCRBasicAsyncReadFunction=function(n,a,o,r,u,D,s,i,t,_,R){var g=this;return m.showMask(n),g._innerSend(n,t,!0,function(t){var e;0==t.exception?(C.isFunction(_)&&(-1!=a?(e=g._convertServerIdToGuid(a),1==r?_(e,u,D,s,i,g.__innerGetOCRBasicResultAsyncFunction(t)):_(e,g.__innerGetOCRBasicResultAsyncFunction(t))):""!=o?_(o,g.__innerGetOCRBasicResultAsyncFunction(t)):_(g.__innerGetOCRBasicResultAsyncFunction(t))),C.License.isLTS()&&Dynamsoft.DWT.lcvrf(O)):C.isFunction(R)&&R(t.exception,t.description),m.hideMask(n)},function(t){m.hideMask(n)}),!0},O.__innerOCRSyncReadFunction=function(t,e){t=this._innerFunRaw(t,e,!1,!1),e=C.NewOCRBasicResult();return e._errorCode=this._errorCode,e._errorString=this._errorString,t&&C.isArray(t)&&(e._resultlist=t,e._Count=t.length,C.License.isLTS())&&Dynamsoft.DWT.lcvrf(O),e},O.__IsOCRBasicModuleInstalled=function(){return""!=O._innerFun("GetAddOnVersion",m.makeParams("ocr",g)).split("|")[0]},O.__innerBasicDownload=function(t,n,e,a,o){function r(){return D.IfShowProgressBar&&C.closeProgress(null,"Download"),C.isFunction(a)&&a(),!0}function u(){return D.IfShowProgressBar&&C.closeProgress(null,"Download"),C.isFunction(o)&&o(D.ErrorCode,D.ErrorString),!1}var D=O;C.cancelFrome=2,t=t.toString();if(!C.License.checkProductKey(D,{Core:!0}))return u();if(!C.License.checkProductKey(D,{OCR:!0},!0))return u();n!=Dynamsoft.DWT.EnumDWT_OCRDownloadType.OCRDT_Dll&&D._innerFun("SetOCRLanguage",m.makeParams(e));var s=D._innerFun("GetAddOnVersion",m.makeParams("ocr",g)).split("|");if(n==Dynamsoft.DWT.EnumDWT_OCRDownloadType.OCRDT_Dll){if(""!=s[0])return r(),!0}else{e=Dynamsoft.DWT.OCRLanguageData[e];if(e&&s[1]==e)return r(),!0}if(!t||""==t)return C.Errors.OCR_InvalidRemoteFilename(D),u(),!1;if(m.isServerInvalid(D))return u(),!1;D.IfShowProgressBar&&C.showProgress(D,"Download",!0);var i=!0;n==Dynamsoft.DWT.EnumDWT_OCRDownloadType.OCRDT_Dll?D._OnPercentDone([0,-1,"Downloading OCR Module...","http"]):D._OnPercentDone([0,-1,"Downloading OCR Language Data...","http"]),C.isFunction(a)||(i=!1),m.loadHttpBlob(D,"get",t,i,function(t){D._OnPercentDone([0,-1,"Loading..."]);var e=100;n==Dynamsoft.DWT.EnumDWT_OCRDownloadType.OCRDT_LANGUAGE&&(e=101),D.__LoadImageFromBytes(t,e,"",i,r,u)},function(){D.IfShowProgressBar&&C.closeProgress(null,"Download"),u()},function(t){var e=0===t.total?100:Math.round(100*t.loaded/t.total);[t.loaded," / ",t.total].join("");D._OnPercentDone([0,e,"","http"])})},t={OCR:{SetUnicodeFontName:function(t){var e=i;return e._resetErr(),e._isMobileMode()?e._mobileNotSupport("Addon.OCR.SetUnicodeFontName"):R.SetUnicodeFontName(t)},GetUnicodeFontName:function(){var t=i;return t._resetErr(),t._isMobileMode()?t._mobileNotSupport("Addon.OCR.GetUnicodeFontName"):R.GetUnicodeFontName()},SetIfUseDetectedFont:function(t){var e=i;return e._resetErr(),e._isMobileMode()?e._mobileNotSupport("Addon.OCR.SetIfUseDetectedFont"):R.SetUseDetectedFont(t)},GetIfUseDetectedFont:function(){var t=i;return t._resetErr(),t._isMobileMode()?t._mobileNotSupport("Addon.OCR.GetIfUseDetectedFont"):R.GetUseDetectedFont()},SetMinFontSizeforMoreAccurateResult:function(t){var e=i;return e._resetErr(),e._isMobileMode()?e._mobileNotSupport("Addon.OCR.SetMinFontSizeforMoreAccurateResult"):R.SetMinFontSizeforMoreAccurateResult(t)},GetMinFontSizeforMoreAccurateResult:function(){var t=i;return t._resetErr(),t._isMobileMode()?t._mobileNotSupport("Addon.OCR.GetMinFontSizeforMoreAccurateResult"):R.GetMinFontSizeforMoreAccurateResult()},SetLanguage:function(t){var e=i;return e._resetErr(),e._isMobileMode()?e._mobileNotSupport("Addon.OCR.SetLanguage"):R.SetOCRLanguage(t)},IsModuleInstalled:function(){var t=i;return t._resetErr(),t._isMobileMode()?t._mobileNotSupport("Addon.OCR.IsModuleInstalled"):t.__IsOCRBasicModuleInstalled()},SetPageSetMode:function(t){var e=i;return e._resetErr(),e._isMobileMode()?e._mobileNotSupport("Addon.OCR.SetPageSetMode"):(t=+t)==Dynamsoft.DWT.EnumDWT_OCRPageSetMode.OCRPSM_OSD_ONLY||t==Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_AUTO_OSD||t==Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_AUTO_ONLY||t==Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_AUTO||t==Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_SINGLE_COLUMN||t==Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_SINGLE_BLOCK_VERT_TEXT||t==Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_SINGLE_BLOCK||t==Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_SINGLE_LINE||t==Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_SINGLE_WORD||t==Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_CIRCLE_WORD||t==Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_SINGLE_CHAR?R.SetPageSetMode(t):(Dynamsoft.Lib.Errors.OCR_InvalidPageSetMode(e),!1)},SetOutputFormat:function(t){var e=i;return e._resetErr(),e._isMobileMode()?e._mobileNotSupport("Addon.OCR.SetOutputFormat"):(t=+t)==Dynamsoft.DWT.EnumDWT_OCROutputFormat.OCROF_TEXT||t==Dynamsoft.DWT.EnumDWT_OCROutputFormat.OCROF_PDFPLAINTEXT||t==Dynamsoft.DWT.EnumDWT_OCROutputFormat.OCROF_PDFIMAGEOVERTEXT||t==Dynamsoft.DWT.EnumDWT_OCROutputFormat.OCROF_PDFPLAINTEXT_PDFX||t==Dynamsoft.DWT.EnumDWT_OCROutputFormat.OCROF_PDFIMAGEOVERTEXT_PDFX?R.SetOutputFormat(t):(Dynamsoft.Lib.Errors.OCR_InvalidOutputFormat(e),!1)},Recognize:function(t,e,n){var a=i;return a._resetErr(),a._isMobileMode()?a._mobileNotSupport("Addon.OCR.Recognize"):C.License.checkProductKey(a,{OCR:!0},!0)?(t=a._ImgManager.convertClientIndexToServerId(t),a.__innerOCRBasicReadFunction("OCRRecognize",t,"",0,0,0,0,0,_.makeParams(0,t,"",0,0,0,0,R.GetUnicodeFontName(),R.GetUseDetectedFont(),R.GetMinFontSizeforMoreAccurateResult(),R.GetOCRLanguage(),R.GetPageSetMode(),R.GetOutputFormat(),""),e,n)):(C.isFunction(n)&&n(a._errorCode,a._errorString),!1)},RecognizeRect:function(t,e,n,a,o,r,u){var D,s=i;return s._resetErr(),s._isMobileMode()?s._mobileNotSupport("Addon.OCR.RecognizeRect"):!e&&0!=e||!n&&0!=n||!a&&0!=a||!o&&0!=o?(D=Dynamsoft.Lib.NewOCRBasicResult(s),Dynamsoft.Lib.Errors.OCR_InvalidLeftOrTopOrRightOrBottom(D,"RecognizeRect"),void u(D.GetErrorCode(),D.GetErrorString())):C.License.checkProductKey(s,{OCR:!0},!0)?(D=s._ImgManager.convertClientIndexToServerId(t),s.__innerOCRBasicReadFunction("OCRRecognize",D,"",1,e,n,a,o,_.makeParams(0,D,"",e,n,a,o,R.GetUnicodeFontName(),R.GetUseDetectedFont(),R.GetMinFontSizeforMoreAccurateResult(),R.GetOCRLanguage(),R.GetPageSetMode(),R.GetOutputFormat(),""),r,u)):(C.isFunction(u)&&u(s._errorCode,s._errorString),!1)},RecognizeFile:function(t,e,n){var a=i;return a._resetErr(),a._isMobileMode()?a._mobileNotSupport("Addon.OCR.RecognizeFile"):(t=_.replaceLocalFilename(t),C.License.checkProductKey(a,{OCR:!0},!0)?a.__innerOCRBasicReadFunction("OCRRecognize",-1,t,0,0,0,0,0,_.makeParams(1,-1,t,0,0,0,0,R.GetUnicodeFontName(),R.GetUseDetectedFont(),R.GetMinFontSizeforMoreAccurateResult(),R.GetOCRLanguage(),R.GetPageSetMode(),R.GetOutputFormat(),""),e,n):(C.isFunction(n)&&n(a._errorCode,a._errorString),!1))},RecognizeSelectedImages:function(t,e){var n,a,o,r=i;return r._resetErr(),r._isMobileMode()?r._mobileNotSupport("Addon.OCR.RecognizeSelectedImages"):C.License.checkProductKey(r,{OCR:!0},!0)?(o=[],(n=r)._ImgManager.count()<=0||(a=n._ImgManager.getCurrentImageIndex(),n._ImgManager.convertClientIndexToServerId(a),a=n._ImgManager.getSelectedClientIndexArray(),C.isArray(a)&&C.each(a,function(t){t=n._ImgManager.convertClientIndexToServerId(t);o.push(t)})),a=o,r.__innerOCRBasicReadFunction("OCRRecognize",-1,"",0,0,0,0,0,_.makeParams(2,-1,"",0,0,0,0,R.GetUnicodeFontName(),R.GetUseDetectedFont(),R.GetMinFontSizeforMoreAccurateResult(),R.GetOCRLanguage(),R.GetPageSetMode(),R.GetOutputFormat(),a.join(",")),t,e)):(C.isFunction(e)&&e(r._errorCode,r._errorString),!1)}}},i.__addon=i.__addon||{},C.mix(i.__addon,t)})}); 
/*! 20220215
* Dynamsoft JavaScript Library
* Product: Dynamsoft Web Twain
* Web Site: https://www.dynamsoft.com
*
* Copyright 2022, Dynamsoft Corporation 
* Author: Dynamsoft R&D Department
*
* Version: 17.2.1
* 
* Module: addon/ocrpro
* final js: build\addon\dynamsoft.webtwain.addon.ocrpro.js
*/
;var Dynamsoft=self.Dynamsoft||{};Dynamsoft.DWT=Dynamsoft.DWT||{};Dynamsoft.aryAddonReadyFun=Dynamsoft.aryAddonReadyFun||[];Dynamsoft.AddonReady=Dynamsoft.AddonReady||function(a){Dynamsoft.aryAddonReadyFun.push(a)};Dynamsoft.ProOCRVerInName="1.2.0.0806";(function(b){function a(){var c=this;c._text="";c._left=0;c._top=0;c._right=0;c._bottom=0}a.prototype.GetText=function(){var c=this;return c._text};a.prototype.GetLetterRect=function(){var c=this;return c._left+","+c._top+","+c._right+","+c._bottom};b.NewLetterResult=function(){return new a()}})(Dynamsoft.Lib);(function(b){function a(){var c=this;c._count=0;c._letterlist=[];c._zoneCount=0;c._zoneWords=[]}a.prototype.GetLettersCount=function(){var c=this;return c._count};a.prototype.GetZoneCount=function(){var c=this;return c._zoneCount};a.prototype.GetLetterContent=function(d){var f=this,c=f._count;if(f._errorCode<0){return""}if(d==null||d>=c||d<0){Dynamsoft.Lib.Errors.OCR_InvalidIndex(f,"GetLetterContent");return""}var e=Dynamsoft.Lib.NewLetterResult();e._text=f._letterlist[d].letter;e._left=f._letterlist[d].boundary[0];e._top=f._letterlist[d].boundary[1];e._right=f._letterlist[d].boundary[2];e._bottom=f._letterlist[d].boundary[3];return e};a.prototype.GetZoneContent=function(d){var e=this,c=e._zoneCount;if(e._errorCode<0){return""}if(d==null||d>=c||d<0){Dynamsoft.Lib.Errors.OCR_InvalidIndex(e,"GetZoneContent");return""}return e._zoneWords[d]};b.NewPageResult=function(){return new a()}})(Dynamsoft.Lib);(function(a){function b(){var c=this;c._input=0;c._message="";c._page=-1}b.prototype.GetInput=function(){var c=this;return c._input};b.prototype.GetMessage=function(){var c=this;return c._message};b.prototype.GetPage=function(){var c=this;return c._page};a.NewErrorInfo=function(){return new b()}})(Dynamsoft.Lib);(function(a){function b(c){var d=this;d._errorCode=0;d._errorString="";d._errorlist=[];d._request="";d._ocrTotalCount=0;d._alreadyOCRCount=0;d._resultlist=[];d._resultZoneDetail=[];d._stwain=c}b.prototype.GetErrorCode=function(){var c=this;return c._errorCode};b.prototype.GetErrorString=function(){var c=this;return c._errorString};b.prototype.GetInput=function(){var e=this;if(e._request&&e._request.input){var d=e._request.input;if(d){var c=Number(d);if(!isNaN(c)){return e._stwain._ImgManager.convertServerIdToClientIndex(c)}}return d}else{return""}};b.prototype.GetErrorDetailList=function(){var g=this,c=0;if(g._errorlist){c=g._errorlist.length}var e=[];for(var d=0;d<c;d++){var f=Dynamsoft.Lib.NewErrorInfo();f._input=g._errorlist[d].input;f._message=g._errorlist[d].message;f._page=g._errorlist[d].page;e.push(f)}return e};b.prototype.GetOCRTotalCount=function(){var c=this;if(c._ocrTotalCount){return c._ocrTotalCount}else{return 0}};b.prototype.GetAlreadyOCRCount=function(){var c=this;if(c._alreadyOCRCount){return c._alreadyOCRCount}else{return 0}};b.prototype.GetPageCount=function(){var c=this;if(c._resultlist&&c._resultlist.length){return c._resultlist.length}else{return 0}};b.prototype.GetPageContent=function(d){var f=this,c=0;if(f._resultlist){c=f._resultlist.length}if(d==null||d>=c||d<0){Dynamsoft.Lib.Errors.OCR_InvalidIndex(f,"GetPageContent");return""}var e=Dynamsoft.Lib.NewPageResult();if(f._resultlist){e._count=f._resultlist[d].length;e._letterlist=f._resultlist[d]}else{e._count=0}if(f._resultZoneDetail){e._zoneCount=f._resultZoneDetail[d].length;e._zoneWords=f._resultZoneDetail[d]}else{e._zoneCount=0}return e};b.prototype.Get=function(){var c=this;return c._stwain._innerFun("GetOCRRestult")};b.prototype.Save=function(c){var e=this,d=a.html5.Funs.replaceLocalFilename(c);return e._stwain._innerFun("SaveOCRRestult",a.html5.Funs.makeParams(d))};a.NewOCRProResult=function(c){return new b(c)}})(Dynamsoft.Lib);(function(c){var d=[Dynamsoft.DWT],b=0;for(;b<1;b++){var a=d[b];a.EnumDWT_OCRProRecognitionModule={OCRPM_AUTO:"AUTO",OCRPM_MOSTACCURATE:"MOSTACCURATE",OCRPM_BALANCED:"BALANCED",OCRPM_FASTEST:"FASTEST"};a.EnumDWT_OCRProOutputFormat={OCRPFT_TXTS:"TXTS",OCRPFT_TXTCSV:"TXTCSV",OCRPFT_TXTF:"TXTF",OCRPFT_XML:"XML",OCRPFT_IOTPDF:"IOTPDF",OCRPFT_IOTPDF_MRC:"IOTPDF_MRC"};a.EnumDWT_OCRProPDFVersion={OCRPPDFV_0:"1.0",OCRPPDFV_1:"1.1",OCRPPDFV_2:"1.2",OCRPPDFV_3:"1.3",OCRPPDFV_4:"1.4",OCRPPDFV_5:"1.5",OCRPPDFV_6:"1.6",OCRPPDFV_7:"1.7"};a.EnumDWT_OCRProPDFAVersion={OCRPPDFAV_1A:"pdf/a-1a",OCRPPDFAV_1B:"pdf/a-1b",OCRPPDFAV_2A:"pdf/a-2a",OCRPPDFAV_2B:"pdf/a-2b",OCRPPDFAV_2U:"pdf/a-2u",OCRPPDFAV_3A:"pdf/a-3a",OCRPPDFAV_3B:"pdf/a-3b",OCRPPDFAV_3U:"pdf/a-3u"};a.EnumDWT_OCRProType={OCRDT_File:0,OCRDT_Index:1};a.EnumDWT_OCRFindTextFlags={OCRFT_WHOLEWORD:1,OCRFT_MATCHCASE:2,OCRFT_FUZZYMATCH:4};a.EnumDWT_OCRFindTextAction={OCRFT_HIGHLIGHT:0,OCRFT_STRIKEOUT:1,OCRFT_MARKFORREDACT:2}}})(typeof window!=="undefined"?window:this);(function(a){function b(){var c=this;c.FindText="";c.FindTextFlags=Dynamsoft.DWT.EnumDWT_OCRFindTextFlags.OCRFT_WHOLEWORD;c.FindTextAction=Dynamsoft.DWT.EnumDWT_OCRFindTextAction.OCRFT_MARKFORREDACT}a.NewRedaction=function(){return new b()}})(Dynamsoft.Lib);Dynamsoft.WebTwain={Addon:{OCRPro:{}}};(function(a){function b(){var c=this;c.RecognitionModule="";c.Languages="eng";c.OutputFormat="";c.PDFVersion="";c.PDFAVersion="";c.LicenseChecker="";c.Redaction=Dynamsoft.Lib.NewRedaction()}a.NewSettings=function(){return new b()}})(Dynamsoft.WebTwain.Addon.OCRPro);(function(){function a(f,e,c,b){var d=this;d.left=f;d.top=e;d.right=c;d.bottom=b}Dynamsoft.WebTwain.Addon.OCRPro.NewOCRZone=function(e,d,c,b){return new a(e,d,c,b)}})();Dynamsoft.AddonReady(function(m,h){if(!m.product.bHTML5Edition){return}var n=1000,q=function(){return n++};function o(y){var z=m.html5.Funs;y.__innerGetOCRProResultAsyncFunction=function(B){var A=Dynamsoft.Lib.NewOCRProResult(this);if(B){A._errorCode=B.code;A._errorString=B.message;A._request=B.request;A._errorlist=B.errorList;A._ocrTotalCount=B.ocrTotalCount;A._alreadyOCRCount=B.alreadyOCRCount;A._resultlist=B.resultDetail;A._resultZoneDetail=B.resultZoneDetail}return A};y.__innerIsOCRTrial=function(A,B){var D=this,C=function(){var F=false;if(D.__licenseInfo.Detail){for(var E=0;E<D.__licenseInfo.Detail.length;E++){if(D.__licenseInfo.Detail[E].EnumLicenseType=="10"){if(D.__licenseInfo.Detail[E].Trial=="TRUE"){F=true}}}}return A(F)};if(D.__licenseInfo&&D.__licenseInfo.Detail){return C()}else{return D.GetLicenseInfo(C,B)}};y.__innerOCRReadFunction=function(D,I,E,H,A,B,G,C){var F=this;return F.__innerOCRAsyncReadFunction(D,I,E,H,A,B,G,C)};y.__innerOCRAsyncReadFunction=function(D,K,E,I,A,B,H,C){var G=this;var F=function(L){if(L.code==0){if(m.isFunction(H)){if(K!=-1){if(I==1){H(K,A,G.__innerGetOCRProResultAsyncFunction(L))}else{H(K,G.__innerGetOCRProResultAsyncFunction(L))}}else{if(E!=""){H(E,G.__innerGetOCRProResultAsyncFunction(L))}else{H(G.__innerGetOCRProResultAsyncFunction(L))}}}if(m.License.isLTS()){Dynamsoft.DWT.lcvrf(y)}}else{if(m.isFunction(C)){C(L.code,L.message,G.__innerGetOCRProResultAsyncFunction(L))}}z.hideMask(D)},J=function(L){z.hideMask(D)};z.showMask(D);G._innerSend(D,B,true,F,J);return true};y.__innerGetRequestJson=function(G,I,A,K,B){var F=y,C;var E="[{";E+='"id":"'+y.clientId+'",';E+='"method":"OCRProRecognize",';E+='"dllName":"'+B+'",';E+='"productkey":"'+Dynamsoft.DWT.ProductKey+'",';if(G==Dynamsoft.DWT.EnumDWT_OCRProType.OCRDT_File){E+='"inputType":"file",'}else{E+='"inputType":"index",'}E+='"input":[';for(C=0;C<I.length;C++){if(G==Dynamsoft.DWT.EnumDWT_OCRProType.OCRDT_File){E+='"'+I[C]+'"'}else{E+=I[C]}if(C+1<I.length){E+="|"}}E+="],";E+='"settings":{';E+='"recognitionMethod": "Page"';if(A){if(A.RecognitionModule&&A.RecognitionModule.length>0){E+=',"recognitionModule":"'+A.RecognitionModule+'"'}if(A.Languages&&A.Languages.length>0){E+=',"languages":"'+A.Languages+'"'}if(A.OutputFormat&&A.OutputFormat.length>0){E+=',"outputFormat":"'+A.OutputFormat+'"'}if(A.PDFVersion&&A.PDFVersion.length>0){E+=',"pdfVersion":"'+A.PDFVersion+'"'}if(A.PDFAVersion&&A.PDFAVersion.length>0){E+=',"pdfAVersion":"'+A.PDFAVersion+'"'}if(A.Redaction&&A.Redaction.FindText&&A.Redaction.FindText.length>0){var J=parseInt(A.Redaction.FindTextFlags),H=parseInt(A.Redaction.FindTextAction);if(!isNaN(J)&&!isNaN(H)){E+=',"redaction":{';var D=A.Redaction.FindText;D=D.replace(/\"/g,'\\"');E+='"findText":"'+D+'"';E+=',"findTextFlags":'+J;E+=',"findTextAction":'+H;E+="}"}}}E+="},";E+='"zones":[';for(C=0;C<K.length;C++){E+="["+K[C].left+","+K[C].top+","+K[C].right+","+K[C].bottom+"]";if(C+1<K.length){E+=","}}E+="],";E+='"outputFile":""';E+="}]";return E};y.__LoadImageFromBytesForDownloadInner=function(E,K,O,J,L,B,H,M,D){var I=y;var A,C,G;if(E>=J){A=B*J;G=K.slice(A,L)}else{A=E*B;C=(E+1)*B;G=K.slice(A,C)}var N=function(){if(Dynamsoft.Lib.isFunction(D)){D()}};var F=function(){if(E>=J){if(Dynamsoft.Lib.isFunction(M)){M()}return}E=E+1;I.__LoadImageFromBytesForDownloadInner(E,K,O,J,L,B,H,M,D)};I.__LoadImageFromBytes(G,O,"",H,F,N,A,L)};y.__LoadImageFromBytesForDownload=function(H,B,G,D,C,J){var F=y;var A=2*1000*1000;var I=H.size||H.length;var E=parseInt(I/A);var K=I%A;if(K==0){E=E-1}F.__LoadImageFromBytesForDownloadInner(0,H,B,E,I,A,D,C,J)}}var e=function(B){var C=[],z,y,A;if(B._ImgManager.count()<=0){return C}y=B._ImgManager.getCurrentImageIndex();z=B._ImgManager.convertClientIndexToServerId(y);A=B._ImgManager.getSelectedClientIndexArray();if(m.isArray(A)){m.each(A,function(D){var E=B._ImgManager.convertClientIndexToServerId(D);C.push(E)})}return C},v=function(C,A,z,B){var y=m.NewOCRProResult(C);y._errorCode=A;y._errorString=z;var D=m.NewErrorInfo();D.input=B;D.message=y._errorString;D.page=0;y._errorlist=[D];return y},g=function(A){var B=m.html5.Funs,z,y;if(m.env.bMac){y="DynamicOCRPro_"+Dynamsoft.ProOCRVerInName+".dylib"}else{if(m.env.bLinux){y="DynamicOCRPro_"+Dynamsoft.ProOCRVerInName+".so"}else{if(Dynamsoft.dcp.b64bit){y="DynamicOCRProx64_"+Dynamsoft.ProOCRVerInName+".dll"}else{y="DynamicOCRPro_"+Dynamsoft.ProOCRVerInName+".dll"}}}o(A);z={OCRPro:{Settings:false,Recognize:function(N,K,D){var J=[],H,O,L,I;var G=A;G._resetErr();if(G._isMobileMode()){return G._mobileNotSupport("Addon.OCRPro.Recognize")}H=parseInt(N);if(m.isNaN(H)||!m.isNumber(H)){O=v(A,-2201,"Invalid parameter type.",N);if(m.isFunction(D)){D(O._errorCode,O._errorString,O)}else{m.Errors.WebviewerError(A,O._errorString,O._errorCode)}return false}var F=A._ImgManager.convertClientIndexToServerId(H);if(F==-1){if(m.isFunction(D)){m.Errors.IndexOutOfRange(A);O=v(A,A._errorCode,A._errorString,N);D(O._errorCode,O._errorString,O)}return false}if(!m.License.checkProductKey(A,{OCRPro:true},true)){if(m.isFunction(D)){O=v(A,A._errorCode,A._errorString,N);D(O._errorCode,O._errorString,O)}return false}J.push(F);var M=[],C=this.Settings;var E=A.__innerGetRequestJson(Dynamsoft.DWT.EnumDWT_OCRProType.OCRDT_Index,J,C,M,y);return A.__innerIsOCRTrial(function(P){if(P||m.License.isLTS()){return A.__innerOCRReadFunction("OCRProRecognize",N,"",0,M,E,K,D)}else{return w(C.LicenseChecker,A,"OCRProRecognize",N,"",0,M,E,K,D)}},D)},RecognizeRect:function(X,P,R,G){var N=[],K,M,F,L;var S=A;S._resetErr();if(S._isMobileMode()){return S._mobileNotSupport("Addon.OCRPro.RecognizeRect")}K=parseInt(X);if(m.isNaN(K)||!m.isNumber(K)){M=v(A,-2201,"Invalid parameter type.",X);if(m.isFunction(G)){G(M._errorCode,M._errorString,M)}else{m.Errors.WebviewerError(A,M._errorString,M._errorCode)}return false}var Q=A._ImgManager.convertClientIndexToServerId(K),T=A._ImgManager.GetImageWidth(K),J=A.GetImageHeight(K);if(Q==-1){if(m.isFunction(G)){m.Errors.IndexOutOfRange(A);M=v(A,A._errorCode,A._errorString,X);G(M._errorCode,M._errorString,M)}return false}if(!m.License.checkProductKey(A,{OCRPro:true},true)){if(m.isFunction(G)){M=v(A,A._errorCode,A._errorString,X);G(M._errorCode,M._errorString,M)}return false}if(T>0&&J>0){var V,E,U,W,I,D;for(var O=0;O<P.length;O++){V=P[O];E=V.left;U=V.top;W=V.right;I=V.bottom;if(E<0){E=0}if(U<0){U=0}if(W<0){W=0}if(I<0){I=0}if(E>W){D=E;E=W;W=D}if(U>I){D=U;U=I;I=D}if(W>T){W=T}if(I>J){I=J}V.left=E;V.top=U;V.right=W;V.bottom=I}}N.push(Q);var C=this.Settings;var H=A.__innerGetRequestJson(Dynamsoft.DWT.EnumDWT_OCRProType.OCRDT_Index,N,C,P,y);return A.__innerIsOCRTrial(function(Y){if(Y||m.License.isLTS()){return A.__innerOCRReadFunction("OCRProRecognize",X,"",1,P,H,R,G)}else{return w(C.LicenseChecker,A,"OCRProRecognize",X,"",1,P,H,R,G)}},G)},RecognizeFile:function(D,M,G){var I=A;I._resetErr();if(I._isMobileMode()){return I._mobileNotSupport("Addon.OCRPro.RecognizeFile")}var P,N,K;if(D.length==0){if(m.isFunction(G)){P=Dynamsoft.Lib.NewOCRProResult(A);P._errorCode=-2201;P._errorString="File name cannot be empty.";K=[];N=Dynamsoft.Lib.NewErrorInfo();N.input=D;N.message=P._errorString;N.page=0;K.push(N);P._errorlist=K;G(P._errorCode,P._errorString,P)}return false}if(!m.License.checkProductKey(A,{OCRPro:true},true)){if(m.isFunction(G)){P=Dynamsoft.Lib.NewOCRProResult(A);P._errorCode=A._errorCode;P._errorString=A._errorString;K=[];N=Dynamsoft.Lib.NewErrorInfo();N.input=D;N.message=P._errorString;N.page=0;K.push(N);P._errorlist=K;G(P._errorCode,P._errorString,P)}return false}var J=B.replaceLocalFilename(D);var C=[];if(J.indexOf("|")>0){C=J.split("|")}else{if(J.indexOf(";")>0){C=J.split(";")}else{if(J.indexOf(",")>0){C=J.split(",")}}}var L=[];if(C.length>0){for(var F=0;F<C.length;F++){L.push(C[F])}}else{L.push(J)}var O=[],E=this.Settings;var H=A.__innerGetRequestJson(Dynamsoft.DWT.EnumDWT_OCRProType.OCRDT_File,L,E,O,y);A.__innerIsOCRTrial(function(Q){if(Q||m.License.isLTS()){return A.__innerOCRReadFunction("OCRProRecognize",-1,D,0,O,H,M,G)}else{return w(E.LicenseChecker,A,"OCRProRecognize",-1,D,0,O,H,M,G)}},G)},RecognizeSelectedImages:function(J,D){var G,H,K;var F=A;F._resetErr();if(F._isMobileMode()){return F._mobileNotSupport("Addon.OCRPro.RecognizeSelectedImages")}if(!m.License.checkProductKey(A,{OCRPro:true},true)){if(m.isFunction(D)){var M=Dynamsoft.Lib.NewOCRProResult(A);M._errorCode=A._errorCode;M._errorString=A._errorString;H=[];K=Dynamsoft.Lib.NewErrorInfo();K.input="";K.message=M._errorString;K.page=0;H.push(K);M._errorlist=H;D(M._errorCode,M._errorString,M)}return false}var L=[],C=this.Settings,I=e(A),E=A.__innerGetRequestJson(Dynamsoft.DWT.EnumDWT_OCRProType.OCRDT_Index,I,C,L,y);A.__innerIsOCRTrial(function(N){if(N||m.License.isLTS()){G=A.__innerOCRReadFunction("OCRProRecognize",-1,"",0,L,E,J,D)}else{G=w(C.LicenseChecker,A,"OCRProRecognize",-1,"",0,L,E,J,D)}},D);return G},IsModuleInstalled:function(){var D=A;D._resetErr();if(D._isMobileMode()){return D._mobileNotSupport("Addon.OCRPro.IsModuleInstalled")}var C=D._innerFun("GetAddOnVersion",B.makeParams("proocr",y));return(C!="")}}};A.__addon=A.__addon||{};m.mix(A.__addon,z)};if(m.DynamicLoadAddonFuns){m.DynamicLoadAddonFuns.push(g)}function p(E,H,z,I,B,G,y,C,F,A){var D=this;D.STWAIN=H;D.AjaxFunctionUrl=E;D.FunctionName=z;D.ImageIndex=I;D.FileNames=B;D.Type=G;D.AryZone=y;D.JsonString=C;D.OnSuccess=F;D.OnFailure=A}Dynamsoft.WebTwain.Addon.OCRPro.NewOCRReadPara=function(D,G,z,H,B,F,y,C,E,A){return new p(D,G,z,H,B,F,y,C,E,A)};function s(C,B){var D="";var E=C.responseText;if(E.length==0){var A=Dynamsoft.WebTwain.Addon.OCRPro.NewOCRError();Dynamsoft.Lib.Errors.OCR_LicenseCheckerError(A,B.AjaxFunctionUrl);E=A.responseText}D=f(E);var z=D.split(";");if(z.length==1){B.OnFailure(-1,E,Dynamsoft.Lib.NewOCRProResult())}else{if(z[0]=="true"){var y=function(G,F,H){if(Dynamsoft.Lib.isUndefined(H)){if(Dynamsoft.Lib.isUndefined(F)){B.OnSuccess(G);x(B.AjaxFunctionUrl,G.GetPageCount())}else{B.OnSuccess(G,F);x(B.AjaxFunctionUrl,F.GetPageCount())}}else{B.OnSuccess(G,F,H);x(B.AjaxFunctionUrl,H.GetPageCount())}};B.STWAIN.__innerOCRReadFunction(B.FunctionName,B.ImageIndex,B.FileNames,B.Type,B.AryZone,B.JsonString,y,B.OnFailure)}else{B.OnFailure(z[1],z[2],Dynamsoft.Lib.NewOCRProResult())}}}function w(G,J,z,K,D,I,y,E,H,A){var B=G;var F="DTW_AjaxMethod=CheckLicense&Productkey="+j(Dynamsoft.DWT.ProductKey);var C=Dynamsoft.WebTwain.Addon.OCRPro.NewOCRReadPara(G,J,z,K,D,I,y,E,H,A);return d(B,F,s,C)}function x(A,B){var z=A;var y="DTW_AjaxMethod=WriteOCRCount&OCRCount="+j(B+"");d(z,y,b,null)}function b(z,y){}function a(){var y=this;y.responseText="";y.errorString=""}Dynamsoft.WebTwain.Addon.OCRPro.NewOCRError=function(){return new a()};Dynamsoft.Lib.mix(Dynamsoft.Lib.Errors,{OCR_LicenseCheckerEmpty:function(z){var A=-2601;var y="LicenseChecker cannot be empty.";z.errorString=y;z.responseText=j("false;"+A+";"+y+";")},OCR_LicenseCheckerNotConnect:function(z){var A=-2602;var y="Cannot connect to the LicenseChecker, please check and make sure it's set correctly.";z.errorString=y;z.responseText=j("false;"+A+";"+y+";")},OCR_AccessDenied:function(z){var A=-2603;var y="Access denied.";z.errorString=y;z.responseText=j("false;"+A+";"+y+";")},OCR_LicenseCheckerError:function(z,B){var A=-2604;var y="Error occured in '"+B+"'.";z.errorString=y;z.responseText=j("false;"+A+";"+y+";")},OCR_HTTPError:function(z,A){var B=-2605;var y="HTTP Error "+A+".";z.errorString=y;z.responseText=j("false;"+B+";"+y+";")},OCR_LicenseCheckerUnauthorized:function(z,B){var A=-2606;var y="You do not have permission to view this directory or page using the credentials you supplied (access denied due to Access Control Lists). Ask the Web server's administrator to give you access to '"+B+"'.";z.errorString=y;z.responseText=j("false;"+A+";"+y+";")},__last:false});function i(){var y=null,A=window;try{y=new A.ActiveXObject("Msxml2.XMLHTTP")}catch(z){try{y=new A.ActiveXObject("Microsoft.XMLHTTP")}catch(z){y=new XMLHttpRequest()}}return y}function d(z,y,D,C){var A=Dynamsoft.WebTwain.Addon.OCRPro.NewOCRError();if(z==""){Dynamsoft.Lib.Errors.OCR_LicenseCheckerEmpty(A);alert(A.errorString);D(A,C);return false}var B=i();B.open("POST",z,true);B.setRequestHeader("Content-Type","application/x-www-form-urlencoded");B.onreadystatechange=function(){if(B.readyState==4){if(B.status==200){if(D!=null&&typeof(D)=="function"){D(B,C)}}else{if(B.status==401){Dynamsoft.Lib.Errors.OCR_LicenseCheckerUnauthorized(A,C.AjaxFunctionUrl);D(A,C);return false}else{if(B.status==404){Dynamsoft.Lib.Errors.OCR_LicenseCheckerNotConnect(A);alert(A.errorString);D(A,C);return false}else{if(B.status==403){Dynamsoft.Lib.Errors.OCR_AccessDenied(A);D(A,C);return false}else{Dynamsoft.Lib.Errors.OCR_HTTPError(A,B.status);D(A,C);return false}}}}}};if(B&&y){B.send(y)}return true}var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var r=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);function k(E){var A,C,y;var D,B,z;y=E.length;C=0;A="";while(C<y){D=E.charCodeAt(C++)&255;if(C==y){A+=c.charAt(D>>2);A+=c.charAt((D&3)<<4);A+="==";break}B=E.charCodeAt(C++);if(C==y){A+=c.charAt(D>>2);A+=c.charAt(((D&3)<<4)|((B&240)>>4));A+=c.charAt((B&15)<<2);A+="=";break}z=E.charCodeAt(C++);A+=c.charAt(D>>2);A+=c.charAt(((D&3)<<4)|((B&240)>>4));A+=c.charAt(((B&15)<<2)|((z&192)>>6));A+=c.charAt(z&63)}return A}function t(F){var E,D,B,z;var C,y,A;y=F.length;C=0;A="";while(C<y){do{E=r[F.charCodeAt(C++)&255]}while(C<y&&E==-1);if(E==-1){break}do{D=r[F.charCodeAt(C++)&255]}while(C<y&&D==-1);if(D==-1){break}A+=String.fromCharCode((E<<2)|((D&48)>>4));do{B=F.charCodeAt(C++)&255;if(B==61){return A}B=r[B]}while(C<y&&B==-1);if(B==-1){break}A+=String.fromCharCode(((D&15)<<4)|((B&60)>>2));do{z=F.charCodeAt(C++)&255;if(z==61){return A}z=r[z]}while(C<y&&z==-1);if(z==-1){break}A+=String.fromCharCode(((B&3)<<6)|z)}return A}function u(B){var z,A,y,C;z="";y=B.length;for(A=0;A<y;A++){C=B.charCodeAt(A);if((C>=1)&&(C<=127)){z+=B.charAt(A)}else{if(C>2047){z+=String.fromCharCode(224|((C>>12)&15));z+=String.fromCharCode(128|((C>>6)&63));z+=String.fromCharCode(128|((C>>0)&63))}else{z+=String.fromCharCode(192|((C>>6)&31));z+=String.fromCharCode(128|((C>>0)&63))}}}return z}function l(D){var z,B,y,E;var C,A;z="";y=D.length;B=0;while(B<y){E=D.charCodeAt(B++);switch(E>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:z+=D.charAt(B-1);break;case 12:case 13:C=D.charCodeAt(B++);z+=String.fromCharCode(((E&31)<<6)|(C&63));break;case 14:C=D.charCodeAt(B++);A=D.charCodeAt(B++);z+=String.fromCharCode(((E&15)<<12)|((C&63)<<6)|((A&63)<<0));break}}return z}function j(y){return k(u(y))}function f(y){return l(t(y))}}); 
/*! 20230919170045
* Dynamsoft JavaScript Library
* Product: Dynamsoft Web TWAIN
* Web Site: https://www.dynamsoft.com
*
* Copyright 2023, Dynamsoft Corporation
* Author: Dynamsoft Support Team
*
* Module: Webcam
* Version: 18.4
* 
*/
var Dynamsoft=self.Dynamsoft||{};Dynamsoft.DWT=Dynamsoft.DWT||{},Dynamsoft.aryAddonReadyFun=Dynamsoft.aryAddonReadyFun||[],Dynamsoft.AddonReady=Dynamsoft.AddonReady||function(e){Dynamsoft.aryAddonReadyFun.push(e)},Dynamsoft.WebcamVerForActiveX="15.0.0.0625",Dynamsoft.WebcamVerInName="15.0.0.0625",function(){for(var e=[Dynamsoft.DWT],t=0;t<1;t++){var r=e[t];r.EnumDWT_VideoRotateMode={VRM_NONE:0,VRM_90_DEGREES_CLOCKWISE:1,VRM_180_DEGREES_CLOCKWISE:2,VRM_270_DEGREES_CLOCKWISE:3,VRM_FLIP_VERTICAL:4,VRM_FLIP_HORIZONTAL:5},r.EnumDWT_VideoProperty={VP_BRIGHTNESS:0,VP_CONTRAST:1,VP_HUE:2,VP_SATURATION:3,VP_SHARPNESS:4,VP_GAMMA:5,VP_COLORENABLE:6,VP_WHITEBALANCE:7,VP_BACKLIGHTCOMPENSATION:8,VP_GAIN:9},r.EnumDWT_CameraControlProperty={CCP_PAN:0,CCP_TILT:1,CCP_ROLL:2,CCP_ZOOM:3,CCP_EXPOSURE:4,CCP_IRIS:5,CCP_FOCUS:6}}}(),function(){Dynamsoft.Lib.WebcamErrors={InvalidParameter:function(e){e._errorCode=-10001,e._errorString="The parameter is invalid."},VideoNotPlayingWhenCapture:function(e){e._errorCode=-10002,e._errorString="To capture an image, the video must be playing."},VideoNotPlayingWhenGetURL:function(e){e._errorCode=-10003,e._errorString="To get the url for the current frame, the video must be playing."},Success:function(e){e._errorCode=0,e._errorString="Successful."}}}(),function(r){function t(e){var t=this;t._Count=0,t._resultlist=[],t._stwain=e}t.prototype.GetCount=function(){return r.WebcamErrors.Success(this._stwain),this._Count-1},t.prototype.Get=function(e){var t=this;return t._resultlist.length-1<=e||e<0?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(t._stwain,"Get"),""):(r.WebcamErrors.Success(t._stwain),t._resultlist[e])},t.prototype.GetCurrent=function(){var e=this,t=e._resultlist.length;return 0==t?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(e._stwain,"GetCurrent"),""):(r.WebcamErrors.Success(e._stwain),e._resultlist[t-1])},r.NewWebcamValue=function(e){return new t(e)}}(Dynamsoft.Lib),function(t){function r(e){var t=this;t._Count=0,t._resultlist=[],t._stwain=e}r.prototype.GetValue=function(){var e=this;return 0==e._resultlist.length?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(e._stwain,""),""):(t.WebcamErrors.Success(e._stwain),e._resultlist[0].current)},r.prototype.GetIfAuto=function(){var e=this;return 0==e._resultlist.length?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(e._stwain,""),!1):(t.WebcamErrors.Success(e._stwain),"true"==e._resultlist[0].auto)},t.NewWebcamSetting=function(e){return new r(e)}}(Dynamsoft.Lib),function(e){function t(e){var t=this;t._Count=0,t._resultlist=[],t._stwain=e}t.prototype.GetMinValue=function(){var e=this;return 0==e._resultlist.length?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(e._stwain,""),""):e._resultlist[0].min},t.prototype.GetMaxValue=function(){var e=this;return 0==e._resultlist.length?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(e._stwain,""),""):e._resultlist[0].max},t.prototype.GetSteppingDelta=function(){var e=this;return 0==e._resultlist.length?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(e._stwain,""),0):e._resultlist[0].step},t.prototype.GetDefaultValue=function(){var e=this;return 0==e._resultlist.length?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(e._stwain,""),0):e._resultlist[0].defaultValue},t.prototype.GetIfAuto=function(){var e=this;return 0==e._resultlist.length?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(e._stwain,""),!1):"true"==e._resultlist[0].auto},e.NewWebcamMoreSetting=function(e){return new t(e)}}(Dynamsoft.Lib),Dynamsoft.AddonReady(function(n,e){n.DynamicLoadAddonFuns&&n.DynamicLoadAddonFuns.push(function(r){r._innerSetWebcamValue=function(e){var t=n.NewWebcamValue(r);return e&&n.isArray(e)&&(t._resultlist=e,t._Count=e.length),t},r._innerSetWebcamSetting=function(e){var t=n.NewWebcamSetting(r);return e&&n.isArray(e)&&(t._resultlist=e,t._Count=e.length),t},r._innerSetWebcamMoreSetting=function(e){var t=n.NewWebcamMoreSetting(r);return e&&n.isArray(e)&&(t._resultlist=e,t._Count=e.length),t}}),n.Addon_Events.push("OnFrameCaptured"),n.Addon_Events.push("OnCaptureSuccess"),n.Addon_Events.push("OnCaptureError")}),Dynamsoft.AddonReady(function(l,e){l.product.bHTML5Edition&&l.DynamicLoadAddonFuns&&l.DynamicLoadAddonFuns.push(function(m){var e,c=l.html5.Funs,t=l.env.bMac?"DynamicWebcam_"+Dynamsoft.WebcamVerInName+".dylib":l.env.bLinux?"DynamicWebcam_"+Dynamsoft.WebcamVerInName+".so":m._b64bit?"DynamicWebcamx64_"+Dynamsoft.WebcamVerInName+".dll":"DynamicWebcam_"+Dynamsoft.WebcamVerInName+".dll";try{m._innerSend("GetAddOnVersion",c.makeParams("webcam",t),!0,!1,!1)}catch(e){}(e=m)._innerWebcamValueFunction=function(e,t){e=this._innerFunRaw(e,t,!1,!1);return this._innerSetWebcamValue(e)},e._innerWebcamSettingFunction=function(e,t){e=this._innerFunRaw(e,t,!1,!1);return this._innerSetWebcamSetting(e)},e._innerWebcamMoreSettingFunction=function(e,t){e=this._innerFunRaw(e,t,!1,!1);return this._innerSetWebcamMoreSetting(e)},e._OnCaptureSuccess=function(e){Dynamsoft.Lib.isFunction(this.__OnCaptureSuccess)&&this.__OnCaptureSuccess()},e._OnCaptureError=function(e){var t=e[1],e=e[2];Dynamsoft.Lib.isFunction(this.__OnCaptureError)&&this.__OnCaptureError(t,e)},e._OnFrameCaptured=function(e){var t,r=this,n=Dynamsoft.Lib;r.__videoPause||(t=(t=r.__videoQuality)||60,r.__videoDest&&r.__videoDest.UpdateVideoContainer(r.GetImageURL(-1,-1,-1,0,t))),n.isFunction(r.__OnFrameCaptured)&&r.__OnFrameCaptured(e)},e={Webcam:{IsModuleInstalled:function(){var e=m;return e._resetErr(),""!=e._innerFun("GetAddOnVersion",c.makeParams("webcam",t))},Download:function(e,t,r){function n(){return m.IfShowProgressBar&&l.closeProgress(null,"Download"),Dynamsoft.Lib.isFunction(t)&&t(),!0}function i(){return m.IfShowProgressBar&&l.closeProgress(null,"Download"),Dynamsoft.Lib.isFunction(r)&&r(m._errorCode,m._errorString),!1}var o=m;o._resetErr(),Dynamsoft.Lib.cancelFrome=2;if(!l.License.checkProductKey(m,{Webcam:!0},!0))return i();if(this.IsModuleInstalled())return n();if(!e||""==e)return Dynamsoft.Lib.Errors.Webcam_InvalidRemoteFilename(o),i();if(c.isServerInvalid(o))return i(),!1;m.IfShowProgressBar&&l.showProgress(o,"Download",!0);var a=!0;return o._OnPercentDone([0,-1,"Downloading Webcam Module...","http"]),Dynamsoft.Lib.isFunction(t)||(a=!1),c.loadHttpBlob(o,"get",e,a,function(e){o._OnPercentDone([0,-1,"Loading..."]);o.__LoadImageFromBytesV1(e,100,"",0,a,n,i)},function(){i()},function(e){var t=0===e.total?100:Math.round(100*e.loaded/e.total);[e.loaded," / ",e.total].join("");o._OnPercentDone([0,t,"","http"])})},GetSourceList:function(){var e,t=m;return t._resetErr(),l.License.checkProductKey(t,{Webcam:!0},!0)?(e=t._innerFunRaw("GetWebcamSourceList"),0==t.ErrorCode&&e.splice(e.length-1,1),e):[]},SelectSource:function(e){var t=m;return t._resetErr(),!!l.License.checkProductKey(t,{Webcam:!0},!0)&&t._innerFun("SelectWebcam",c.makeParams(e))},CloseSource:function(){var e=m;return e._resetErr(),this._clear(),e._innerFun("StopCapture")},GetFramePartURL:function(){var e=m;return e._resetErr(),this._isPlaying()?e.GetImageURL(-1,-1,-1,!0,e.__videoQuality):(l.WebcamErrors.VideoNotPlayingWhenGetURL(e),"")},GetFrameURL:function(){var e=m;return e._resetErr(),this._isPlaying()?e.GetImageURL(-1,-1,-1,0,e.__videoQuality):(l.WebcamErrors.VideoNotPlayingWhenGetURL(e),"")},PlayVideo:function(e,t,r,n,i){var o=m;o._resetErr();function a(){return s._clear(),Dynamsoft.Lib.isFunction(i)&&i(m._errorCode,m._errorString),!1}var u=60,s=this;return Dynamsoft.DWT.UseDefaultViewer?e?l.License.checkProductKey(m,{Webcam:!0},!0)?(o.__videoDest=e,o.__videoDest.ShowVideoContainer(!0),Dynamsoft.Lib.isFunction(r)&&(m.__OnFrameCaptured=r),m.__videoPause?(m.__videoPause=!1,l.isFunction(n)&&n()):(m.__videoPause=!1,m.__videoQuality=t?u=(u=+t)<1?60:u:u,m._innerSend("PlayVideo",c.makeParams(!0),!0,n,a)),!0):a():(Dynamsoft.Lib.Errors.ParameterCannotEmpty(m),a()):(Dynamsoft.Lib.Errors.CannotDoWhenNoViewerJS(m),!1)},PauseVideo:function(){var e=m;return e._resetErr(),this._isPlaying()&&(e.__videoPause=!0),!0},_clear:function(){var e=m;e.__videoPause=!1,e.__OnFrameCaptured=!1,e.__videoQuality=60,e.__videoDest&&e.__videoDest.ShowVideoContainer(!1),e.__videoDest=!1},_isPlaying:function(){return m.GetIfShowVideoContainer()},StopVideo:function(){var e=m,t=(e._resetErr(),this._clear(),e._innerFun("PlayVideo",c.makeParams(!1,0)));return e._innerFun("StopCapture"),t},CaptureImage:function(e,t){var r,n,i=m;return i._resetErr(),l.License.checkProductKey(i,{Webcam:!0},!0)?(r="CaptureImage",n=function(){c.hideMask(r),l.isFunction(t)&&t(i._errorCode,i._errorString)},c.showMask(r),i.__OnCaptureError=n,i._innerSend(r,c.makeParams(!1),!0,function(){c.hideMask(),0==i.ErrorCode?(c.hideMask(r),l.isFunction(e)&&setTimeout(e,0),l.License.isLTS()&&Dynamsoft.DWT.lcvrf(m)):n(i.ErrorCode,i.ErrorString)},n),!0):(l.isFunction(t)&&t(i._errorCode,i._errorString),!1)},GetMediaType:function(){var e=m;return e._resetErr(),e._innerWebcamValueFunction("GetMediaType")},SetMediaType:function(e){var t=m;return t._resetErr(),l.isString(e)?t._innerFun("SetMediaType",c.makeParams(e)):(l.Errors.InvalidValue(t),!1)},GetResolution:function(){var e=m,e=(e._resetErr(),e._innerWebcamValueFunction("GetResolution"));if(e&&e._resultlist){var t,r,n=e._resultlist,i=[],o=[];for(""==(r=0<n.length?n[n.length-1]:r)&&0<n.length&&(r=n[0]),t=0;t<n.length-1;t++){for(var a,u=(a=n[t]).toLowerCase().split("x"),s=(l=c=s=void 0,{value:a,p1:parseInt(u[0]),p2:parseInt(u[1])}),c=i,l=c.length-1;0<=l&&c[l].p1>=s.p1&&!(c[l].p1==s.p1&&c[l].p2<s.p2);)c[l+1]=c[l],l--;c[l+1]=s}for(t=0;t<i.length;t++)a=i[t].value,o.push(a);r&&o.push(r),e._resultlist=o,o=i=null}return e},SetResolution:function(e){var t=m;return t._resetErr(),l.isNumber(e)||l.isString(e)?t._innerFun("SetResolution",c.makeParams(e)):(l.Errors.InvalidValue(t),!1)},GetFrameRate:function(){var e=m;return e._resetErr(),e._innerWebcamValueFunction("GetFrameRate")},SetFrameRate:function(e){var t=m;return t._resetErr(),l.isNumber(e)?m._innerFun("SetFrameRate",c.makeParams(e)):(l.Errors.InvalidValue(t),!1)},GetVideoPropertySetting:function(e){var t=m;return t._resetErr(),t._innerWebcamSettingFunction("GetWebcamVideoPropertySetting",c.makeParams(e))},GetVideoPropertyMoreSetting:function(e){var t=m;return t._resetErr(),t._innerWebcamMoreSettingFunction("GetWebcamVideoPropertyMoreSetting",c.makeParams(e))},SetVideoPropertySetting:function(e,t,r){var n=m;return n._resetErr(),n._innerFun("SetWebcamVideoPropertySetting",c.makeParams(e,t,r))},SetVideoRotateMode:function(e){var t=m;return t._resetErr(),t._innerFun("SetVideoRotateMode",c.makeParams(e))},GetCameraControlPropertySetting:function(e){var t=m;return t._resetErr(),t._innerWebcamSettingFunction("GetWebcamCameraControlSetting",c.makeParams(e))},GetCameraControlPropertyMoreSetting:function(e){var t=m;return t._resetErr(),t._innerWebcamMoreSettingFunction("GetWebcamCameraControlMoreSetting",c.makeParams(e))},SetCameraControlPropertySetting:function(e,t,r){var n=m;return n._resetErr(),n._innerFun("SetWebcamCameraControlPropertySetting",c.makeParams(e,t,r))}}},m.__addon=m.__addon||{},l.mix(m.__addon,e)})}),Dynamsoft.AddonReady(function(d,e){var r;d.product.bActiveXEdition&&d.DynamicLoadAddonFuns&&d.DynamicLoadAddonFuns.push(function(m){var _,e,t;if(!m.getSWebTwain()||!m.getSWebTwain().Addon)return!1;Dynamsoft.navInfoSync.bWin&&(t=!Dynamsoft.navInfo.bOSx64||Dynamsoft.navInfo.bWOW64,r=t?"DynamicWebcam_"+Dynamsoft.WebcamVerForActiveX+".dll":"DynamicWebcamx64_"+Dynamsoft.WebcamVerForActiveX+".dll"),_=m.getSWebTwain();try{_.GetAddOnVersion("webcam",r)}catch(e){}(t=m)._innerRead=function(e){var t;try{t=Dynamsoft.Lib.parse(e)}catch(e){}return t.result},t._innerWebcamValueFunctionPlugin=function(e){e=this._innerRead(e);return this._innerSetWebcamValue(e)},t._innerWebcamSettingFunctionPlugin=function(e){e=this._innerRead(e);return this._innerSetWebcamSetting(e)},t._innerWebcamMoreSettingFunctionPlugin=function(e){e=this._innerRead(e);return this._innerSetWebcamMoreSetting(e)},e={Webcam:{IsModuleInstalled:function(){var e=_.GetAddOnVersion("webcam",r);return d.setErrorString(m),""!=e},Download:function(e,t,r){function n(){return Dynamsoft.Lib.isFunction(t)&&t(),!0}function i(){return Dynamsoft.Lib.isFunction(r)&&r(m._errorCode,m._errorString),!1}return d.License.checkProductKey(m,{Webcam:!0},!0)?this.IsModuleInstalled()?n():e&&""!=e?(e=_.DownloadAddon(e),d.wrapperRet(m,e,n,i)):(Dynamsoft.Lib.Errors.Webcam_InvalidRemoteFilename(m),i()):i()},GetSourceList:function(){var e,t;return d.License.checkProductKey(m,{Webcam:!0},!0)?(e=_.GetWebcamSourceList(),t=[],d.setErrorString(m),0==m._errorCode&&(t=m._innerRead(e))&&1<t.length&&t.splice(t.length-1,1),t):[]},SelectSource:function(e){return!!d.License.checkProductKey(m,{Webcam:!0},!0)&&(e=_.SelectWebcam(e),d.setErrorString(m),e)},CloseSource:function(){m._playVideoDWT=null;var e=_.StopCapture();return d.setErrorString(m),e},GetFramePartURL:function(){var e;return this._isPlaying()?(e=_.GetDIB(-1),d.setErrorString(m),e):(d.WebcamErrors.VideoNotPlayingWhenGetURL(m),"")},GetFrameURL:function(){return""},PlayVideo:function(e,t,r,n,i){function o(){return m._playVideoDWT=null,Dynamsoft.Lib.isFunction(i)&&i(m.ErrorCode,m.ErrorString),!1}var a;return e&&e.getSWebTwain()?d.License.checkProductKey(m,{Webcam:!0},!0)?(a=e.getSWebTwain().CurrentHWND)?(m._playVideoDWT=e,setTimeout(function(){var e=_.RunWebcamCmd("PlayVideo",a,null,null,r);d.wrapperRet(m,e,n,o)},0),!0):(d.WebcamErrors.InvalidParameter(m),o()):o():(Dynamsoft.Lib.WebcamErrors.InvalidParameter(m),o())},PauseVideo:function(){return!0},StopVideo:function(){m._playVideoDWT=null;var e=_.RunWebcamCmd("StopVideo",0,null,null,null);return d.setErrorString(m),_.StopCapture(),e},CaptureImage:function(e,t){function r(){return Dynamsoft.Lib.isFunction(t)&&t(m.ErrorCode,m.ErrorString),!1}var n;return d.License.checkProductKey(m,{Webcam:!0},!0)?(n=_.RunWebcamCmd("Capture",0,function(){d.isFunction(e)&&setTimeout(e,0),d.License.isLTS()&&Dynamsoft.DWT.lcvrf(m)},r,null),d.setErrorString(m),n):r()},GetMediaType:function(){var e=m._innerWebcamValueFunctionPlugin(_.GetMediaType());return d.setErrorString(m),e},SetMediaType:function(e){return d.isString(e)?(e=_.SetMediaType(e),d.setErrorString(m),e):(d.Errors.InvalidValue(m),!1)},GetResolution:function(){var e=m._innerWebcamValueFunctionPlugin(_.GetResolution());if(d.setErrorString(m),e&&e._resultlist){var t,r,n=e._resultlist,i=[],o=[];for(0<n.length&&(r=n[n.length-1]),t=0;t<n.length-1;t++){for(var a,u=(a=n[t]).toLowerCase().split("x"),s=(l=c=s=void 0,{value:a,p1:parseInt(u[0]),p2:parseInt(u[1])}),c=i,l=c.length-1;0<=l&&c[l].p1>=s.p1&&!(c[l].p1==s.p1&&c[l].p2<s.p2);)c[l+1]=c[l],l--;c[l+1]=s}for(t=0;t<i.length;t++)a=i[t].value,o.push(a);r&&o.push(r),e._resultlist=o,o=i=null}return e},SetResolution:function(e){return d.isNumber(e)||d.isString(e)?(e=_.SetResolution(e),d.setErrorString(m),e):(d.Errors.InvalidValue(m),!1)},GetFrameRate:function(){var e=m._innerWebcamValueFunctionPlugin(_.GetFrameRate());return d.setErrorString(m),e},SetFrameRate:function(e){return d.isNumber(e)?(e=_.SetFrameRate(e),d.setErrorString(m),e):(d.Errors.InvalidValue(m),!1)},GetVideoPropertySetting:function(e){e=_.GetWebcamVideoPropertySetting(e);return d.setErrorString(m),m._innerWebcamSettingFunctionPlugin(e)},GetVideoPropertyMoreSetting:function(e){e=_.GetWebcamVideoPropertyMoreSetting(e);return d.setErrorString(m),m._innerWebcamMoreSettingFunctionPlugin(e)},SetVideoPropertySetting:function(e,t,r){e=_.SetWebcamVideoPropertySetting(e,t,r);return d.setErrorString(m),e},SetVideoRotateMode:function(e){e=_.SetVideoRotateMode(e);return d.setErrorString(m),e},GetCameraControlPropertySetting:function(e){e=_.GetWebcamCameraControlSetting(e);return d.setErrorString(m),m._innerWebcamSettingFunctionPlugin(e)},GetCameraControlPropertyMoreSetting:function(e){e=_.GetWebcamCameraControlMoreSetting(e);return d.setErrorString(m),m._innerWebcamMoreSettingFunctionPlugin(e)},SetCameraControlPropertySetting:function(e,t,r){e=_.SetWebcamCameraControlPropertySetting(e,t,r);return d.setErrorString(m),e},_isPlaying:function(){return!!m._playVideoDWT}}},m.Addon=m.Addon||{},d.mix(m.Addon,e)})}); 
/*! 20230919170045
* Dynamsoft JavaScript Library
* Product: Dynamsoft Web TWAIN
* Web Site: https://www.dynamsoft.com
*
* Copyright 2023, Dynamsoft Corporation
* Author: Dynamsoft Support Team
*
* Module: Upload
* Version: 18.4
* 
*/
var Dynamsoft=window.Dynamsoft||{};!function(e){e.DWT||(e.DWT={}),e.Lib||(e.Lib={})}(Dynamsoft),Dynamsoft.aryAddonReadyFun=Dynamsoft.aryAddonReadyFun||[],Dynamsoft.AddonReady=Dynamsoft.AddonReady||function(e){Dynamsoft.aryAddonReadyFun.push(e)},Dynamsoft.AddonReady(function(u,e){Dynamsoft.DWT.EnumTransferErrorCode={TRANS_OK:0,TRANS_URL_MALFFORMAT:1,TRANS_FAILED_RESOLVE_PROXY:2,TRANS_FAILED_RESOLVE_HOST:3,TRANS_FAILED_CONNECT:4,TRANS_REMOTE_ACCESS_DENIED:5,TRANS_PARTIAL_FILE:6,TRANS_UPLOAD_FAILED:7,TRANS_READ_FAILED:8,TRANS_OUT_OF_MEMORY:9,TRANS_REMOTE_FULL_DISK:10,TRANS_OPERATION_TIMEOUT:11,TRANS_SERVICE_ERROR_404:12,TRANS_SERVICE_ERROR_500:13,TRANS_SERVICE_ERROR_503:14,TRANS_SERVICE_ERROR:15,TRANS_NOT_SEND:16,TRANS_WAITFOR_SEND:17,TRANS_SENDING:18,TRANS_PAUSE:19,TRANS_FINISHED:20,TRANS_NULL_POINTER:21,TRANS_INVALID_ID:22,TRANS_Failed:23,TRANS_SERVICE_ERROR_MORE_THAN_500:24,TRANS_SERVICE_ERROR_LESS_THAN_200:25,TRANS_SERVICE_ERROR_MORE_THAN_300:26,TRANS_CANNOT_FINDFILE:27,TRANS_ABORT:28,TRANS_NOT_FINISHED:29,TRANS_TASK_PREPARE_INIT:30,TRANS_TASK_INIT:31,TRANS_BEYOND_MAXSIZE:32};var c=Dynamsoft,r=Dynamsoft.dcp,a=[1,7,2,"1026"],f="upload_"+a.join(""),n={Version:"1.0",HttpVersion:"1.1",ServerUrl:"",FileName:"",VERIFYPEER:!1,VERIFYHOST:!1,BlockSize:10240,ThreadNum:1,OnUploadTransferPercentage:function(e,n){},OnRunSuccess:function(e){},OnRunFailure:function(e,n,t){}},p=0,m="",i=function(){p=-1,m="The zip file that contains the upload library (.dll) is invalid."},E=function(){p=-2,m="Upload failed because the url to upload to is invalid."},l=function(e,n,t){p=-3,e?m="Upload cancelled.":(m=n&&""!=n?"Upload failed with error: "+n:"Upload failed.",n&&""!=n&&(m=m+"("+t+")"))},F=function(){p=-4,m="Upload failed because the file to upload has invalid content."},t=function(){p=-5,m="Invalid upload job id."},R=function(){p=-6,m="Cannot create an upload job."},S=function(){p=-7,m="The file name is incorrect in the upload job."},o=function(){p=-8,m="Can not cancel all jobs when at least one job is still being created."},d=function(){p=-9,m="The zip file that contains the upload library (.dll) download failed."},s=function(){p=0,m=""};function T(){}function D(e){this.job=e}function _(e){this.job=e}T.prototype={runWaiting:0,CreateJob:function(){var e={HttpHeader:{},documents:[],formFields:[],bEvent:!1};return u.mix(e,n),e.SourceValue=new D(e),e.FormField=new _(e),e},Run:function(o){var e,r=this,n='""',t=o.ServerUrl,a="";if(!u.isString(t)||""==t)return o.id=-1,E(),!o.bEvent&&u.isFunction(o.OnRunFailure)&&(o.bEvent=!0,o.OnRunFailure(o,p,m),o.bEvent=!1),!1;if(!o.documents||!u.isArray(o.documents)||o.documents.length<=0)return o.id=-1,F(),!o.bEvent&&u.isFunction(o.OnRunFailure)&&(o.bEvent=!0,o.OnRunFailure(o,p,m),o.bEvent=!1),!1;if(!o.ar||!o.cu){Dynamsoft.Lib.License.isLicenseMixed(null,!0)||Dynamsoft.Lib.License.reparseProductKey();var i=Dynamsoft.DWT.licenseException;if(0!=i.code)return o.id=-1,p=i.code,m=i.message,!o.bEvent&&u.isFunction(o.OnRunFailure)&&(o.bEvent=!0,o.OnRunFailure(o,p,m),o.bEvent=!1),!1;if(Dynamsoft.Lib.License.isLTS())return Dynamsoft.DWT.lglic(Dynamsoft.DWT.EnumInstance.dwt_desktop,"").then(function(e){o.ar=e.ar,o.cu=e.cu,r.Run(o)}),!0;u.product.refProductKey&&(n='"'+u.product.refProductKey+'"')}for(o.Url=t,delete o.ServerUrl,e=0;e<o.documents;e++){var l=o.documents[e];if(!u.isString(l.files)||""==l.files)return o.id=-1,S(),!o.bEvent&&u.isFunction(o.OnRunFailure)&&(o.bEvent=!0,o.OnRunFailure(o,p,m),o.bEvent=!1),!1;u.isString(l.remoteName)&&""!=l.remoteName||(l.remoteName="RemoteFile")}var i=o.SourceValue,d=(delete o.SourceValue,o.FormField),s=(delete o.FormField,u.stringify(o)),s=u.replaceAll(s,'"',"'");o.ServerUrl=t,delete o.Url,o.SourceValue=i,o.FormField=d,t=['{"id":"',1,'","method":"RunUploadFile","version":"',f,'","parameter":[',n,',"',s,'"'],o.ar&&o.cu?(a=[',"',o.ar,'","',o.cu,'",0]}'].join(""),delete o.ar,delete o.cu,t.push(a)):t.push("]}"),i=t.join(""),r.runWaiting++;return Dynamsoft.FileUploader._sendCmd("RunUploadFile",i,function(e){var n;r.runWaiting--,e&&((n=e.UploadId)&&0<n?(o.id=n,c.FileUploader.map[o.id]=o,c.FileUploader.ids.push(e.UploadId),o.OnUploadTransferPercentage&&o.OnUploadTransferPercentage(o,0)):(n=e.errorcode,e=e.errorstring,n&&e?(p=n,m=e):R(),!o.bEvent&&u.isFunction(o.OnRunFailure)&&(o.bEvent=!0,o.OnRunFailure(o,p,m),o.bEvent=!1)))},function(e,n,t){r.runWaiting--,c.FileUploader.parseHttpErrors(e,n,t),!o.bEvent&&u.isFunction(o.OnRunFailure)&&(o.bEvent=!0,o.OnRunFailure(o,p,m),o.bEvent=!1)}),!0},Cancel:function(o){var e;return!o.id||o.id<0?(t(),!o.bEvent&&u.isFunction(o.OnRunFailure)&&(o.bEvent=!0,o.OnRunFailure(o,p,m),o.bEvent=!1),!1):(e='{"id":"1","method":"DeleteUploadTask","version":"'+f+'","parameter":["'+o.id+'"]}',Dynamsoft.FileUploader._sendCmd("DeleteUploadTask",e,function(e){c.FileUploader.deleteJobById(o.id)},function(e,n,t){c.FileUploader.parseHttpErrors(e,n,t),!o.bEvent&&u.isFunction(o.OnRunFailure)&&(o.bEvent=!0,o.OnRunFailure(o,p,m),o.bEvent=!1)}),!0)},CancelAllUpload:function(){var t=c.FileUploader.ids,e='{"id":"1","method":"DeleteUploadTask","version":"'+f+'","parameter":["'+t.join(",")+'"]}';return 0<this.runWaiting?(o(),!1):(this.runWaiting<0&&(this.runWaiting=0),t.length<=0||Dynamsoft.FileUploader._sendCmd("DeleteUploadTask",e,function(e){for(var n=0;n<t.length;n++)c.FileUploader.deleteJobById(t[n]);c.FileUploader.ids=[],c.FileUploader.map=[]},function(e,n,t){c.FileUploader.parseHttpErrors(e,n,t)}),!0)},OnUploadTransferPercentage:function(e,n){},OnRunSuccess:function(e){},OnRunFailure:function(e,n,t){}},(c.SourceValue=D).prototype.Add=function(e,n,t){var o=this.job;u.isString(e)&&""!=e?(t=t||"RemoteFile",e=Dynamsoft.Lib.replaceAll(e,"\\\\","\\\\"),o.documents.push({files:[e],fileName:n,remoteName:t})):(S(),!o.bEvent&&u.isFunction(o.OnRunFailure)&&(o.bEvent=!0,o.OnRunFailure(o,p,m),o.bEvent=!1))},c.FormField=_,c.FileUploader={ids:[],map:{},port:18625,protocol:"https://",ip:"127.0.0.1",wsUrl:"",running:!(_.prototype.Add=function(e,n){var t,o,r=n,a=e;if(null==r&&(r=""),!u.isString(a)||""==a||!u.isString(r))return!1;if(r=encodeURI(r),-1<(a=encodeURI(a)).indexOf("'")||-1<r.indexOf("'"))return!1;for(t=0;t<this.job.formFields.length;t++)if((o=this.job.formFields[t]).name==a)return o.value=r,!0;return this.job.formFields.push({name:a,value:r}),!0}),ws:null,nextLoopTime:600,deleteJobById:function(e){var n;if(s(),e){for(n=0;n<c.FileUploader.ids.length;n++)if(e==c.FileUploader.ids[n]){c.FileUploader.ids.splice(n,1);break}var t=c.FileUploader.map[e];for(t.SourceValue.job=null,delete t.SourceValue,t.FormField.job=null,delete t.FormField,delete c.FileUploader.map[e],n=t.documents.length-1;0<=n;n--)t.documents.splice(n,1);for(n=t.formFields.length-1;0<=n;n--)t.formFields.splice(n,1);var o='{"id":"1","method":"DeleteUploadTask","version":"'+f+'","parameter":["'+e+'"]}';Dynamsoft.FileUploader._sendCmd("DeleteUploadTask",o)}},_sendCmdByWS:function(e,n,t){var o=c.FileUploader.ws;return o&&o.readyState!=Dynamsoft.DWT.EnumDWT_WebsocketReadyState.CLOSING&&o.readyState!=Dynamsoft.DWT.EnumDWT_WebsocketReadyState.CLOSED||(o=Dynamsoft.DWT.NetManager.newWebsocket(c.FileUploader.wsUrl),c.FileUploader.ws=o),Dynamsoft.DWT.NetManager.postStringDataByWS(o,e).then(function(e){e=u.parse(e);e&&"result"in e?u.isFunction(n)&&n(e.result):u.isFunction(t)&&t()},t),!0},_sendCmd:function(e,n,t,o){return Dynamsoft.DWT.ConnectWithSocket?c.FileUploader._sendCmdByWS(n,t,o):(e=[c.FileUploader.protocol,c.FileUploader.ip,":",c.FileUploader.port,"/dcp/",f,"/",e,"?type=1&dsver=",a.join(""),"&ts=",u.now()].join(""),u.ajax({url:e,method:"post",dataType:"json",processData:!1,data:n,onSuccess:t,onError:o}))},parseHttpErrors:function(e,n,t){var o,e=e&&u.isArray(e)&&2<e.length?(o=e[1],e[2]):(o=n,t);2==e.state&&0==e.status?"abort"===e.statusText?l(!0):E():l(!1,o,e.status)},loadHttpBlob:function(e,n,t,o,r,a,i){e={method:e,url:n,dataType:"blob",async:t,onSuccess:o,onError:function(e,n,t){c.FileUploader.parseHttpErrors(e,n,t),u.isFunction(r)&&r()}};u.isFunction(a)&&(e.beforeSend=function(e){e.addEventListener("progress",function(e){delete e.totalSize,delete e.position,a(e)},!1)}),u.ajax(e)},_OnPercentDone:function(){},Download:function(e,n,t){var o;return u.isString(e)?c.FileUploader.loadHttpBlob("get",e,!!(o=function(){return d(),u.isFunction(t)&&t(p,m),!1}),function(e){r.loadZip(e,100,n,o)},o,!1):(i(),u.isFunction(t)&&t(p,m),!1)},Init:function(e,t,n){s();function o(){var e,n=Dynamsoft.navInfoSync.bSSL?(e="https://",Dynamsoft.dcp.SSLPort):(e="http://",Dynamsoft.dcp.Port);c.FileUploader.port=n,c.FileUploader.protocol=e,c.FileUploader.ip=Dynamsoft.DWT.Host,c.FileUploader.wsUrl=Dynamsoft.DWT.NetManager.getWsUrl(Dynamsoft.DWT.Host,n),c.FileUploader.running=!0,t(new T),setTimeout(c.FileUploader.StatusLoop,500)}Dynamsoft.dcp.detect.bConnected=true;o()},Close:function(){var e;Dynamsoft.DWT.ConnectWithSocket&&(e=Dynamsoft.FileUploader.ws)&&(e.readyState!=Dynamsoft.DWT.EnumDWT_WebsocketReadyState.CLOSED&&e.readyState!=Dynamsoft.DWT.EnumDWT_WebsocketReadyState.CLOSING&&e.close(),Dynamsoft.FileUploader.ws=null),Dynamsoft.FileUploader.running=!1},VersionInfo:function(e,o){s();var n='{"id":"1","method":"VersionInfo","version":"'+f+'","parameter":[]}';return Dynamsoft.FileUploader._sendCmd("VersionInfo",n,e,function(e,n,t){c.FileUploader.parseHttpErrors(e,n,t),u.isFunction(o)&&o(p,m)}),!0},StatusLoop:function(){return s(),c.FileUploader.GetUploadStatus(),c.FileUploader.running&&setTimeout(c.FileUploader.StatusLoop,c.FileUploader.nextLoopTime),!0},GetUploadStatus:function(){var e;return s(),c.FileUploader.ids.length<=0||(e='{"id":"1","method":"GetUploadStatus","version":"'+f+'","parameter":["'+c.FileUploader.ids.join(",")+'"]}',Dynamsoft.FileUploader._sendCmd("GetUploadStatus",e,function(e){if(u.isArray(e))for(var n=0;n<e.length;n++){var t=(l=e[n]).id,o=c.FileUploader.map[t],r=l.percentage,a=l.errorcode,i=l.response,l=l.errorstring;o&&(a==Dynamsoft.DWT.EnumTransferErrorCode.TRANS_FINISHED?(o.OnUploadTransferPercentage(o,100,y(i)),!o.bEvent&&u.isFunction(o.OnRunSuccess)&&(o.bEvent=!0,o.OnRunSuccess(o,y(i)),o.bEvent=!1),c.FileUploader.deleteJobById(t)):a==Dynamsoft.DWT.EnumTransferErrorCode.TRANS_OK||a==Dynamsoft.DWT.EnumTransferErrorCode.TRANS_NOT_SEND||a==Dynamsoft.DWT.EnumTransferErrorCode.TRANS_WAITFOR_SEND||a==Dynamsoft.DWT.EnumTransferErrorCode.TRANS_SENDING||a==Dynamsoft.DWT.EnumTransferErrorCode.TRANS_PAUSE||a==Dynamsoft.DWT.EnumTransferErrorCode.TRANS_TASK_PREPARE_INIT||a==Dynamsoft.DWT.EnumTransferErrorCode.TRANS_TASK_INIT?o.OnUploadTransferPercentage(o,r,y(i)):(!o.bEvent&&u.isFunction(o.OnRunFailure)&&(o.bEvent=!0,o.OnRunFailure(o,a,l,y(i)),o.bEvent=!1),c.FileUploader.deleteJobById(t)))}},function(e,n,t){})),!0}};var U=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);function y(e){for(var n,t,o,r,a=e.length,i=0,l="";i<a;){for(;n=U[255&e.charCodeAt(i++)],i<a&&-1==n;);if(-1==n)break;for(;t=U[255&e.charCodeAt(i++)],i<a&&-1==t;);if(-1==t)break;l+=String.fromCharCode(n<<2|(48&t)>>4);do{if(61==(o=255&e.charCodeAt(i++)))return l}while(o=U[o],i<a&&-1==o);if(-1==o)break;l+=String.fromCharCode((15&t)<<4|(60&o)>>2);do{if(61==(r=255&e.charCodeAt(i++)))return l}while(r=U[r],i<a&&-1==r);if(-1==r)break;l+=String.fromCharCode((3&o)<<6|r)}return l}}); 
/*! 20230315181423333
* Dynamsoft JavaScript Library
* Product: Dynamsoft Web TWAIN
* Web Site: https://www.dynamsoft.com
*
* Copyright 2023, Dynamsoft Corporation
* Author: Dynamsoft Support Team
* Version: 18.4
*/
//Dynamsoft.On{actionName} It is a callback function called by Web-TWAIN product. The contents of this function are the default templates of the WebTWAIN. Users can modify the fucntions, but be aware that the function name itself cannot be modified
//Dynamsoft._{functionName} It is a private function used by Dynamsoft.On{actionName}. Users can modify and delete according to their needs.
(function () {
  "use strict";
  var screenW = screen.width,
    promptDlgWidth = screenW > 550 ? 550 : (screenW - 10),
    promptDlgWidth2 = screenW > 680 ? 680 : (screenW - 10);


  //----------------------start Install Dialog---------------------------

  //Web TWAIN Service is not detected dialogs
  //Windows
  Dynamsoft.OnWebTwainNotFoundOnWindowsCallback = function (ProductName, InstallerUrl, bHTML5, bIE, bSafari, bSSL, strIEVersion) {
    var _this = Dynamsoft,
      objUrl = {
        'default': InstallerUrl
      };
    _this._show_install_dialog(ProductName, objUrl, bHTML5, Dynamsoft.DWT.EnumDWT_PlatformType.enumWindow, bIE, bSafari, bSSL, strIEVersion, false);
  };

  //Linux
  Dynamsoft.OnWebTwainNotFoundOnLinuxCallback = function (ProductName, strDebUrl, strRpmUrl, bHTML5, bIE, bSafari, bSSL, strIEVersion, iPlatform) {
    var _this = Dynamsoft,
      objUrl = {
        'default': strDebUrl,
        'deb': strDebUrl,
        'rpm': strRpmUrl
      };
    if (!iPlatform) iPlatform = Dynamsoft.DWT.EnumDWT_PlatformType.enumLinux;
    if (iPlatform == Dynamsoft.DWT.EnumDWT_PlatformType.enumAndroid) {
      objUrl.default = "intent://dynamsoft.com/#Intent;scheme=http;package=com.dynamsoft.mobilescan;end";
    }
    _this._show_install_dialog(ProductName, objUrl, bHTML5, iPlatform, bIE, bSafari, bSSL, strIEVersion, false);
  };

  //MacOS
  Dynamsoft.OnWebTwainNotFoundOnMacCallback = function (ProductName, InstallerUrl, bHTML5, bIE, bSafari, bSSL, strIEVersion) {
    var _this = Dynamsoft,
      objUrl = {
        'default': InstallerUrl
      };
    _this._show_install_dialog(ProductName, objUrl, bHTML5, Dynamsoft.DWT.EnumDWT_PlatformType.enumMac, bIE, bSafari, bSSL, strIEVersion, false);
  };

  //Android
  Dynamsoft.OnWebTwainNotFoundOnAndroidCallback = function (ProductName, InstallerUrl, bSSL, bUpgrade) {
    var objUrl = {
      'default': 'https://demo.dynamsoft.com/DWT/Resources/dist/DynamsoftServiceSetup.apk'
    }, dt = Math.random();

    var _path = Dynamsoft.DWT.ServiceInstallerLocation;
    if (Dynamsoft.Lib.isString(_path) && _path.length > 0) {
      var sep = '';

      if (_path[_path.length - 1] != '/') {
        sep = '/';
      }

      objUrl.default = [_path, sep, 'DynamsoftServiceSetup.apk'].join('');
    }

    objUrl.openService = "intent://dynamsoft.com/#Intent;scheme=http;package=com.dynamsoft.mobilescan;S.timestamp=" + dt + ";end";
    Dynamsoft.DWT.Host = 'local.dynamsoft.com';
    Dynamsoft._show_android_install_dialog(objUrl, bUpgrade);
  };

  //Web TWAIN Service is not supported dialogs
  //Mobile Browsers
  Dynamsoft.OnMobileNotSupportCallback = function () {
    var ObjString = [];

    if (Dynamsoft.DWT) {

      ObjString.push('<div class="ds-dwt-ui-dlg-android" style="padding-bottom:30px">');
      ObjString.push('Service Mode does not support your Operating System, please contact the site administrator.');
      ObjString.push('</div>');

      Dynamsoft.DWT.ShowMessage(ObjString.join(''), {
        width: 335,
        headerStyle: 1,
        backgroundStyle: 1
      });
    } else {
      console.log("The Dynamsoft namespace is missing");
    }

  };

  //Error Message - HTTPS is required to allow CORS to function. This error appears when HTTP is detected. (See: https://www.dynamsoft.com/web-twain/docs/faq/http-insecure-websites-in-chromium-browser.html?ver=latest)
  Dynamsoft.OnHTTPCorsError = function (msg) {

    var ObjString = [
      "<div>", msg, "</div>",
      '<div style="margin-top:10px">To fix the issue, please update your website to HTTPS or refer to <br /><a target="_blank" href="https://www.dynamsoft.com/web-twain/docs/faq/http-insecure-websites-in-chromium-browser.html?ver=latest">this article</a> for other workarounds.</div>'
    ].join('');

    Dynamsoft.DWT.ShowMessage(ObjString, {
      width: promptDlgWidth2,
      headerStyle: 2
    });
  };

  Dynamsoft._show_install_dialog = function (ProductName, objInstallerUrl, bHTML5, iPlatform, bIE, bSafari, bSSL, strIEVersion, bNeedUpgrade) {
    var _this = Dynamsoft,
      ObjString, title, browserActionNeeded,
      EnumPlatform = Dynamsoft.DWT.EnumDWT_PlatformType,
      bAndroid = (iPlatform == EnumPlatform.enumAndroid),
      bMobile = bAndroid,
      bUnix = (iPlatform == EnumPlatform.enumLinux || iPlatform == EnumPlatform.enumEmbed ||
        iPlatform == EnumPlatform.enumChromeOS || iPlatform == EnumPlatform.enumHarmonyOS ||
        bAndroid),
      imagesInBase64 = {
        icn_download: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAgCAYAAAAMq2gFAAABOklEQVRIie2WTW6DMBCFH4h1l22VqmqPVUEvEJa9gRt6FDhDpfx0FdJj+Arx3nldhEjEdchgWlaM9CSwMZ/fzMgQvX0TwvA+ePOpIsniRIwZGIl/n/8AGs3RWKB4JA4STjUKBo1EivLtGakEkP7Ru6vbpcpONzFxPFsazQloZyxEmkDepsYk0JIhkZGwzngfWRKvd0u1Pwf93k1NoBjg5uN+pbZuHn0gEFgQ2AVAdgTefQVzU9e2nzaplKbMkEhnK2W9oAOAC9IHIO+Yd5U/rJX2QbocnVSSqARuqse1Ki9BumrUp+U1gXkXRAoyBDIC1jNnCWRPG2Wug2SFrkkUnvHieaPqaxCpo3bL104rLySQviDbpNA0Sgl4W9kXfU9vjWPho+ZaHCHfo6r/kumfYUBEL1/jeJpqFBw/d5aBU2kHOMQAAAAASUVORK5CYII=',
        icn_install: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAaCAYAAACpSkzOAAAA+klEQVRIid2SMWoCQRiFv3GnW7BII6ZPqeAlorewtBELsZdFOz2Q0VYkXQ6QA9iaIqU+mx2Y3QRd12WKffCY4WdmPt5jzPRT5PQOfOSHnky6/rnoqd/cJFt/0FB6I3UkWOVmZbz+GcyjLEjgeSjRzc3KuCMxzIC8fQwsbtTxqJan/jz+r7qZ4LWC2pzbgpkDmclBAG3gO011T0U+g9Mv8PayTY4u0UIQV5jGORYsAcz4oA7wBWR+SUWJAM5Az17E6gFIGUXA2goGJR8wAK1dUuiwVdECnpQZ7cOggiWy5zCcgIkCcbCX2iUKB6pfdfVLFAwUiNS4f6QaXQHE5K75dPBEiQAAAABJRU5ErkJggg==',
        icn_scan: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAADI0lEQVRIibWXTUhUURTHf+/NsxRCp3QGwhKT/MDoAyNo1apmNhYkodGmaFOWmUXQcpgo2gRN5kerllEGLWqjBqZGFH2BlSRJRVqCjpNjYOaUc1q80fnovZmnMx34w+Odc+///u+9595zlbPPBAuWBbiBPcAOoASwR3xB4BPwAngIdOV2en+n6lA5k5zYDjQBJwCHlRECk0Ar4Mvr9AbNglQRMMFBEYZE8IjgSBKXiIJIm6Gg23PQVHHT038U24DrQL1FhamsHThl7/LOxysGYmAT6BCoT/ifDuoFOqbcHlsyYp9ATQZJF1AjcC2OOMZbh9CQacYYnPzu8tQlKrYLNP8/zkU0B1weeyxxk4AzkySqYvjfKXp6opx8IiuAr1jP05S2bQ3sL4a29zA++4/bD6xTBVwCjkwp3eGAo+WQnw1b8w1jHAIuTQRXppTuWgt1JaAA90egc9Q01K0JVGWCdHch1BTr33c/Q89Y0vAqLQxl6ZJWF8He9RAWuPURHo+nbFKqiZC3XEIFOLAB9hTqpDc/wHO/paZ5ahgwQtEqOFIGNtXYD3Boo076R+DGe3jmN441gibCNAmplKXA8QooyAb7CmgZhLlw1G9T4GgZ7HRCKAytg/DO9AI0tGlVYDhxy4cEmgdhOgSVdjizGXI03acpcKxCJ/01D1ffwdvgktNuWBV4ZeQc/QmX30BgDkpz4dxmWL0SGjbB9gKY+QNX3sLQ9LLy/bVyuE+qgQdmc5K/Es5vAWcO/A5Dlgo/QjrpyMySpjfW9qkC3QIBs9FNzsGlARj7qZNOzcHlAfgys+zTzS/QpYq+pC3JgqdCOvnLSbg4AN9m0zpW20oeeUMLNZdPhIlktdSPEFwbhIlZ8xgL8Ivgg+i1GBRoTEOFVTRu7NUrz9gq844IrWmoSYXW0l7v7YXdpUn8bjsNrAVqLO9Pa3Yv0veiJRZ78wK1Au0ZnN52gdryvvjyVjMY3Tz6y6EfvTJ0LlPlBHC6oi86vfGKzdfktgjlIlwQIbCEtQxE2pSbkQIotT1i5ou1hUebi+ijbXXEN0X00dYNdFf2e0OpOvwLFunYK2i9bNwAAAAASUVORK5CYII='
      };

    // npm file mode
    if (bNeedUpgrade)
      title = 'Please update your document scanning service'; //'Please follow the steps below to upgrade your local document scanning service.';
    else
      title = 'Please complete one-time setup';
    ObjString = [
      '<div class="dynamsoft-dwt-dlg-title">',
      title,
      '</div>'
    ];

    if (_this.DWT) {

      var bFirefox = Dynamsoft.navInfoSync.bFirefox;
      if (bUnix || bFirefox) {
        browserActionNeeded = 'RESTART';
      } else {
        browserActionNeeded = 'REFRESH';
      }
      ObjString.push('<div class="dynamsoft-dwt-installdlg-iconholder"> ');

      var left = '125px';
      if (bMobile) {
        left = '60px';
      }
      ObjString.push('<div class="dynamsoft-dwt-installdlg-splitline" style="left: ' + left + '"></div>');

      if (!bMobile) {
        ObjString.push('<div class="dynamsoft-dwt-installdlg-splitline" style="left: 283px"></div>');
      }

      var marginRight = '133px';
      if (bMobile) {
        marginRight = '50px';
      }
      ObjString.push('<img style="margin: 0px ' + marginRight + ' 0px 0px" src=' + imagesInBase64.icn_download + ' alt="download">');
      ObjString.push('<img style="margin: 2px ' + marginRight + ' 2px 0px" src=' + imagesInBase64.icn_install + ' alt="install">');
      ObjString.push('<img src=' + imagesInBase64.icn_scan + ' alt="scan">');
      ObjString.push('<div><span class="dynamsoft-dwt-installdlg-text" style="right: 125px">Download</span>');
      ObjString.push('<span class="dynamsoft-dwt-installdlg-text" style="right: 18px">Install</span>');
      ObjString.push('<span class="dynamsoft-dwt-installdlg-text" style="left: 105px">Scan</span>');
      ObjString.push('</div>');
      ObjString.push('</div>');

      if (bHTML5 && bUnix) {
        ObjString.push('<div style="margin:10px 0 0 60px;">');
        ObjString.push('<div id="dwt-install-url-div">');

        var arm64 = Dynamsoft.navInfo.bArm64,
          mips64 = Dynamsoft.navInfo.bMips64,
          chromeOS = Dynamsoft.navInfoSync.bChromeOS,
          harmonyOS = Dynamsoft.navInfoSync.bHarmonyOS;

        if (arm64 || mips64 || chromeOS || harmonyOS || bAndroid) { } else {
          ObjString.push('<div><input id="dwt-install-url-deb" name="dwt-install-url" type="radio" onclick="Dynamsoft._dwt_change_install_url(\'' + objInstallerUrl.deb + '\')" checked="checked" /><label for="dwt-install-url-deb">64 bit .deb (For Ubuntu/Debian)</label></div>');
          ObjString.push('<div><input id="dwt-install-url-rpm" name="dwt-install-url" type="radio" onclick="Dynamsoft._dwt_change_install_url(\'' + objInstallerUrl.rpm + '\')" /><label for="dwt-install-url-rpm">64 bit .rpm (For Fedora)</label></div>');
        }
        ObjString.push('</div></div>');
      }

      ObjString.push('<div><a id="dwt-btn-install" target="_blank" href="');
      ObjString.push(objInstallerUrl['default']);
      ObjString.push('"');
      if (bHTML5) {
        ObjString.push(' html5="1"');
      } else {
        ObjString.push(' html5="0"');
      }

      ObjString.push(' onclick="Dynamsoft._dcp_dwt_onclickInstallButton()"><div class="dynamsoft-dwt-dlg-button">Download</div></a></div>');
      if (bHTML5) {
        if (bIE) {
          ObjString.push('<div class="dynamsoft-dwt-dlg-tail" style="text-align:left; padding-left: 80px">');
          ObjString.push('If you still see the dialog after installing the Dynamsoft Service, please<br />');
          ObjString.push('1. Add the website to the zone of trusted sites.<br />');
          ObjString.push('IE | Tools | Internet Options | Security | Trusted Sites.<br />');
          ObjString.push('2. Refresh your browser.');
          ObjString.push('</div>');

        } else {

          if (bUnix) {
            ObjString.push('<div class="dynamsoft-dwt-dlg-tail">');
            ObjString.push('<div class="dynamsoft-dwt-dlg-red">After the installation, please <strong>' + browserActionNeeded + '</strong>  your browser.</div>');
            ObjString.push('</div>');
          } else if (bAndroid) {

            ObjString.push('<div class="dynamsoft-dwt-dlg-tail">');
            ObjString.push('<div class="dynamsoft-dwt-dlg">Failed to connect to the service, have you finished the setup?</div>');
            ObjString.push('<div class="dynamsoft-dwt-dlg">Please make sure the setup is done and <a href="#">click here</a> to connect again.</div>');
            ObjString.push('<div class="dynamsoft-dwt-dlg">If the connection continues to fail, please refer to <a href="#">this article</a>.</div>');
            ObjString.push('</div>');

          }

        }

      } else {
        ObjString.push('<div class="dynamsoft-dwt-dlg-tail" style="text-align:left; padding-left: 80px">');
        if (bIE) {
          ObjString.push('After the installation, please<br />');
          ObjString.push('1. Restart the browser<br />');
          ObjString.push('2. Allow "DynamicWebTWAIN" add-on to run by right clicking on the Information Bar in the browser.');
        } else {
          ObjString.push('<div class="dynamsoft-dwt-dlg-red">After installation, please <strong>REFRESH</strong> your browser.</div>');
        }
        ObjString.push('</div>');
      }
      _this.DWT.ShowMessage(ObjString.join(''), {
        width: promptDlgWidth,
        headerStyle: 1
      });
    } else {
      console.log("The Dynamsoft namespace is missing");
    }

    if (Dynamsoft.DWT && Dynamsoft.DWT.OnWebTwainNotFound) {
      Dynamsoft.DWT.OnWebTwainNotFound();
    }
  };

  Dynamsoft._dwt_change_install_url = function (url) {
    var install = document.getElementById('dwt-btn-install');
    if (install)
      install.href = url;
  };

  var reconnectTime = 0;
  Dynamsoft._dcp_dwt_onclickInstallButton = function () {
    var btnInstall = document.getElementById('dwt-btn-install');
    if (btnInstall) {
      setTimeout(function () {
        var install = document.getElementById('dwt-install-url-div');
        if (install)
          install.style.display = 'none';
        var el = document.getElementById('dwt-btn-install');
        if (el && el.getAttribute("html5") == "1") {
          var pel = el.parentNode,
            newDiv = document.createElement('div');
          newDiv.id = 'dwt-btn-install';
          newDiv.style.textAlign = "center";
          newDiv.style.paddingBottom = '15px';
          newDiv.innerHTML = 'Connecting to the service...';
          newDiv.setAttribute("html5", "1");
          pel.removeChild(el);
          pel.appendChild(newDiv);
          reconnectTime = new Date();
          setTimeout(Dynamsoft._dwt_Reconnect, 10);
        } else {
          var pel = el.parentNode;
          pel.removeChild(el);
        }
      }, 10);
    }
    return true;
  };

  Dynamsoft._dwt_Reconnect = function () {
    var _this = Dynamsoft;
    if (((new Date() - reconnectTime) / 1000) > 30) {
      // change prompt
      var el = document.getElementById('dwt-btn-install');
      if (el) {
        el.innerHTML = 'Failed to connect to the service, have you run the setup?<br />If not, please run the setup and <a href="javascript:void(0)" onclick="Dynamsoft._dcp_dwt_onclickInstallButton()">click here to connect again</a>.';
      }
      return;
    }
    if (_this.DWT) {

      var _timeSpan = 500;
      if (navigator.userAgent.indexOf("Safari") > -1) {
        _timeSpan = 2000;
      }

      _this.DWT.CheckConnectToTheService(function () {
        Dynamsoft.DWT.CloseDialog();
        Dynamsoft.DWT.ConnectToTheService();
      }, function () {
        if (Dynamsoft.DWT.NeedCheckWebTwainBySocket()) {
          Dynamsoft.DWT.CheckWebTwainBySocket(function () {
            Dynamsoft.OnHTTPCorsError();
          }, function () {
            setTimeout(Dynamsoft._dwt_Reconnect, _timeSpan);
          }, function () {
            setTimeout(Dynamsoft._dwt_Reconnect, _timeSpan);
          });
          return;
        }
        setTimeout(Dynamsoft._dwt_Reconnect, _timeSpan);
      });
    } else {
      console.log("The Dynamsoft namespace is missing");
    }
  };

  Dynamsoft._show_android_install_dialog = function (objInstallerUrl, bUpgrade) {
    var ObjString;

    if (Dynamsoft.DWT.bNpm && Dynamsoft.navInfoSync.bFileSystem) {
      return Dynamsoft._show_online_download_dialog(objInstallerUrl, bHTML5, iPlatform);
    }

    ObjString = [];

    if (Dynamsoft.DWT) {

      ObjString.push('<div class="ds-dwt-ui-dlg-android">');

      ObjString.push('<div>Please download and ');

      if(bUpgrade) {
        ObjString.push('update');
      } else {
        ObjString.push('install');
      }

      ObjString.push(' the <strong>DYNAMSOFT SERVICE</strong> app via the </div>');

      ObjString.push('<div><a target="_blank" href="');
      ObjString.push(objInstallerUrl['default']);
      ObjString.push('" onclick="Dynamsoft._dwt_ReconnectForAndroid()">direct APK download link</a>.</div>');
      ObjString.push('</div>');

      ObjString.push('<div class="dynamsoft-dwt-dlg-tail" style="text-align:left">');
      ObjString.push('If you have ');
      
      if(bUpgrade) {
        ObjString.push('updated');
      } else {
        ObjString.push('installed');
      }
      
      ObjString.push(' it, please click on the button below to initiate the connection.');

      ObjString.push('<a target="_blank" href="');
      ObjString.push(objInstallerUrl.openService);
      ObjString.push('" onclick="Dynamsoft._dwt_ReconnectForAndroid()"><div class="dynamsoft-dwt-dlg-button-android">Open Service</div></a>');

      ObjString.push('</div>');

      ObjString.push('</div>');

      Dynamsoft.DWT.ShowMessage(ObjString.join(''), {
        width: 335,
        headerStyle: 1,
        backgroundStyle: 1
      });
    } else {
      console.log("The Dynamsoft namespace is missing");
    }

    if (Dynamsoft.DWT && Dynamsoft.DWT.OnWebTwainNotFound) {
      Dynamsoft.DWT.OnWebTwainNotFound();
    }
  };

  Dynamsoft._dwt_ReconnectForAndroid = function () {
    Dynamsoft.DWT.CheckConnectToTheService(function (bConnected) {
      if (bConnected) {
        Dynamsoft.DWT.CloseDialog();
        Dynamsoft.DWT.ConnectToTheService();
      } else {
        setTimeout(Dynamsoft._dwt_ReconnectForAndroid, 500);
      }

    }, function () {
      setTimeout(Dynamsoft._dwt_ReconnectForAndroid, 500);
    });
  }

  //Dynamsoft.OnWebTwainNotFoundOnAndroidCallback = Dynamsoft.MobileNotSupportCallback;
  //------------------------end Install Dilaog---------------------------


  //----------------------start Upgrade Dialog---------------------------

  Dynamsoft.OnWebTwainNeedUpgradeCallback = function (ProductName, objInstallerUrl, bHTML5, iPlatform, bIE, bSafari, bSSL, strIEVersion) {
    Dynamsoft._show_install_dialog(ProductName, objInstallerUrl, bHTML5, iPlatform, bIE, bSafari, bSSL, strIEVersion, true, true);
  };

  Dynamsoft.OnWebTwainNeedUpgradeOnAndroidCallback = function (ProductName, InstallerUrl, bSSL) {
    Dynamsoft.OnWebTwainNotFoundOnAndroidCallback(ProductName, InstallerUrl, bSSL, true);
  };

  //----------------------end Upgrade Dialog---------------------------

  //----------------------start DLS License -----------------------
  Dynamsoft.OnLTSLicenseError = function (message, code) {

    var addMessage = '',
      ObjString;

    if (code == -2440 || // NetworkError
      code == -2441 || // Timedout
      code == -2443 || // CorsError
      code == -2446 || // LtsJsLoadError
      message.indexOf('Internet connection') > -1 ||
      message.indexOf('Storage') > -1) {

      var purchaseUrl = 'https://www.dynamsoft.com/customer/license/trialLicense?product=dwt&deploymenttype=js';
      addMessage = '<div>You can register for a free 30-day trial <a href="' + purchaseUrl + '" target="_blank" class="dynamsoft-major-color">here</a>. Make sure to select the product Dynamic Web TWAIN.</div>';
    }

    ObjString = [
      message,
      addMessage
    ];

    Dynamsoft.DWT.ShowMessage(ObjString.join(''), {
      width: promptDlgWidth2,
      headerStyle: 2
    });
  };

  Dynamsoft.OnLTSConnectionWarning = function () {

    var ObjString = [
      'Warning: You are seeing this dialog because Dynamic Web TWAIN has failed to connect to the License Tracking Server. ',
      'A cached authorization is being used, and you can continue to use the software as usual. ',
      'Please get connected to the network as soon as possible. ',
      Dynamsoft.DWT.isPublicLicense() ? '<a class="dynamsoft-major-color" href="https://www.dynamsoft.com/company/contact/">Contact Dynamsoft</a> ' : 'Contact the site administrator ',
      'for more information.'
    ].join('');

    Dynamsoft.DWT.ShowMessage(ObjString, {
      width: promptDlgWidth2,
      caption: 'Warning',
      headerStyle: 2
    });
  };

  Dynamsoft.OnLTSPublicLicenseWarning = function (message) {

    Dynamsoft.DWT.ShowMessage(message, {
      width: promptDlgWidth2,
      caption: 'Warning',
      headerStyle: 2
    });
  };

  //--------------------end DLS License-------------------------------

  //----------------------start Product Key -----------------------
  Dynamsoft.OnLicenseExpiredWarning = function (strExpiredDate, remain, trial) {

    var ObjString, strCaption,
      a_contact_us = '<a target="_blank" href="https://www.dynamsoft.com/company/contact/">contact us</a>',
      a_online_store = '<a target="_blank" href="https://www.dynamsoft.com/store/dynamic-web-twain/#DynamicWebTWAIN">online store</a>',
      a_new_key_href = 'https://www.dynamsoft.com/customer/license/trialLicense?product=dwt&utm_source=in-product',
      a_renew_key_href = 'https://www.dynamsoft.com/customer/order/renewalList';

    if (remain > 5) {

    } else if (trial && remain > 0) { // 1~5

      var strDays;

      if (remain <= 1) {
        strDays = '1 day';
      } else {
        strDays = parseInt(remain) + ' days';
      }

      strCaption = 'Warning';
      ObjString = [
        '<div style="padding:0 0 10px 0">Kindly note your trial key is expiring in ', strDays, '. Two quick steps to extend your trial:</div>',
        '<div style="margin:0 0 0 10px">1. <a target="_blank" href="', a_new_key_href, '">Request a new trial key</a> and follow the instructions to set the new key</div>',
        '<div style="margin:0 0 0 10px">2. Refresh your scan page and try again</div>',
        '<div style="padding:10px 0 0 0">If you run into any issues, please ', a_contact_us, '.</div>',
        '<div style="padding:0">If you are ready to purchase a full license, please go to the ', a_online_store, ' or ', a_contact_us, '.</div>'
      ].join('');

    } else {
      
      if(trial) {
        // Trial remain<=0 Expired
        ObjString = [
          '<div style="padding:0">Sorry. Your product key has expired on ', strExpiredDate, '. You can purchase a full license at the ', a_online_store, '.</div>',
          '<div style="padding:0">Or, you can try requesting a new product key at <a target="_blank" href="', a_new_key_href, '">this page</a>.</div>',
          '<div style="padding:0">If you need any help, please ', a_contact_us, '.</div>'
        ].join('');
      } else {

        ObjString = [
          '<div style="padding:0">You are seeing this message because the license for doc scanning support has expired on ', strExpiredDate, '.</div>',
          '<div style="padding:0"><ul>',
          "<li><strong>If you are the owner of the website</strong>, please <a class='dynamsoft-major-color' href='", a_renew_key_href, "' target='_blank'>renew your license</a> and follow the instructions to set the new key. ",
          'Please ', a_contact_us, ' if you need any help.</li>',
          '<li><strong>If you are an end-user</strong>, please inform the owner or developer of this website.</li>',
          '</ul></div>'
        ].join('');
      }

    }

    if (ObjString) {
      Dynamsoft.DWT.ShowMessage(ObjString, {
        width: promptDlgWidth2,
        caption: strCaption,
        headerStyle: 2
      });
    }
  };

  Dynamsoft.OnLicenseError = Dynamsoft.OnLicenseError || function (message, errorCode) {

    Dynamsoft.DWT.ShowMessage(message, {
      width: promptDlgWidth2,
      headerStyle: 2
    });

  };
  //--------------------end Product Key-------------------------------



  // -- npm start
  Dynamsoft._show_online_download_dialog = function (objInstallerUrl, bHTML5, iPlatform) {
    var ObjString,
      vers = Dynamsoft.DWT.JSVersion.split(','),
      strV = vers[0] + '.' + vers[1],
      page_path = location.pathname,
      online_url, local_file_path, ext;
    page_path = page_path.substring(0, page_path.lastIndexOf('/') + 1);

    if (iPlatform == Dynamsoft.DWT.EnumDWT_PlatformType.enumLinux) {
      if (arm64 || mips64) {
        if (arm64)
          objInstallerUrl['default'] = getDebPath('arm64');
        else if (mips64)
          objInstallerUrl['default'] = getDebPath('mips64el');
      } else {
      }
    }
    ext = objInstallerUrl['default'].substr(objInstallerUrl['default'].length - 3);

    online_url = ['https://www.dynamsoft.com/web-twain/install-dynamsoft-service/?productId=1000001',
      '&downloadLink=https://demo.dynamsoft.com/DWT/Resources/dist/DynamsoftServiceSetup_',
      strV, '.',
      ext].join('');

    local_file_path = Dynamsoft.Lib.Path.normalize([
      page_path,
      objInstallerUrl['default']
    ].join(''));

    if (iPlatform == Dynamsoft.DWT.EnumDWT_PlatformType.enumWindow) {
      if (local_file_path.indexOf('/') == 0) {
        local_file_path = local_file_path.substr(1);
      }
    }

    ObjString = [
      '<div class="dynamsoft-dwt-ltsdlg-body" style="padding:0 20px 20px 20px">',
      '<div>To support document scanning, please complete one-time installation of the DynamsoftServiceSetup.', ext, ' on this machine.</div>',
      '<div>You can download the file via this trust site:</div>',
      '<div><a id="dwt-btn-install" target="_blank" href="',
      online_url,
      '"><div class="dynamsoft-dwt-dlg-button">Open Site</div></a></div>',
      '<div style="word-break: break-word;">Or, go to <br />',
      local_file_path,
      ' if the file exists.</div>',
      '<div>After the installation, please <strong>REFRESH</strong>  your browser.<br /></div>',
      '</div>'
    ];

    Dynamsoft.DWT.ShowMessage(ObjString.join(''), { width: promptDlgWidth, headerStyle: 1, closeButton: false });
  };
  // -- npm end

})(); 
/**
 * Basic Configuration (config.js with differences)
 */
Dynamsoft.DWT.AutoLoad = false;
Dynamsoft.DWT.IfAddMD5InUploadHeader = false;
Dynamsoft.DWT.IfConfineMaskWithinTheViewer = false;
