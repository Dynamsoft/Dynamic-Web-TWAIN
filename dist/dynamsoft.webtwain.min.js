// @Thursday 05/29/2023 165807 
/*
* @name: dwt all-in-one package
* @version: 18.2
* @components:
*   + Dynamsoft Dynamic Web TWAIN version: 18.2
*   + Dynamsoft Barcode Reader Addon for DWT version 18.2 (DBR version 9.6.20)
*   + Dynamsoft PDF Rasterizer Addon for DWT version: 18.2
*   + Dynamsoft OCR Basic Addon for DWT version: 18.2
*   + Dynamsoft OCR Pro Addon for DWT version: 18.2
*   + Dynamsoft Webcam Addon for DWT version: 18.2
*   + Dynamsoft File Uploader version: 18.2
*/

 
/*! 20230427145534 - 20221201
* Dynamsoft JavaScript Library
* Product: Dynamsoft Web Twain
* Web Site: https://www.dynamsoft.com
*
* Copyright 2023, Dynamsoft Corporation
* Author: Dynamsoft Support Team
* Version: 18.2
*/
/// Dynamsoft JavaScript Core, version 6.2.8 20230418130827

var bNode=!!("object"==typeof global&&global.process&&global.process.release&&global.process.release.name&&"undefined"==typeof HTMLCanvasElement),globalThis=bNode?global:self||{},Dynamsoft=globalThis.Dynamsoft||{Lib:{}};!function(o){o.Lib||(o.Lib={}),o.DWT||(o.DWT={});o=o.Lib;o.bNode=bNode,o.noop=function(){},o._defaultAgent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36",o._defaultPlatform="Win64",globalThis&&(globalThis.Dynamsoft=Dynamsoft)}(Dynamsoft);!function(){"use strict";var X=globalThis.Dynamsoft,z=!1;function e(e,t){var i,s,n,o,e=e.toLowerCase(),t=t.toLowerCase(),r=/harmonyos/g.test(e),a=("linux"==t&&0<=e.indexOf("windows nt")&&(t="harmonyos",r=!0),!r&&/cros/.test(e)),d=!r&&/android/g.test(e)||/android/g.test(t),b=/iphone/g.test(e)||/iphone/g.test(t),c=/macintosh/.test(e),l=navigator.maxTouchPoints||0,c=/ipad/g.test(e)||(c||"macintel"==t)&&1<l,l=/ucweb|ucbrowser/g.test(e),f=!l&&/nexus/g.test(e)&&/version\/[\d.]+.*safari\//g.test(e),g=/playbook/g.test(e),x=/hp-tablet/g.test(e),m=/blackberry|bb10/g.test(e),w=/symbian/g.test(e),O=/windows phone/g.test(e),h=/mobile/g.test(e),u=/arm64|aarch64/g.test(e),p=/mips64/g.test(e),v=/huaweibrowser/g.test(e),y=/jsdom/g.test(e),x=g||c||x,h=!x&&!a&&(b||f||m||w||O||d||r||h),S=!h&&!x&&!a,L=S&&/win32|win64|windows/.test(t),U=L&&/win64|x64/.test(e),A=S&&/mac68k|macppc|macintosh|macintel/.test(e),S=S&&/linux/.test(t),t="win64"==t||/wow64|x86_64|win64|x64/.test(e)||u||p,H=/wow64/g.test(e),E=z,M=/opera|opr/g.test(e),F=/360se/g.test(e),V=/maxthon/g.test(e),_=/tencenttraveler|qqbrowser/g.test(e),j=/the world/g.test(e),N=/metasr/g.test(e),q=/avant/g.test(e),C=/firefox|fxios/g.test(e),J=/gecko/g.test(e),I=!(C||v)&&/edge\/|edga\/|edgios\/|edg\//g.test(e),P=!(m||g||l||M||I||v||y)&&/chrome|crios/g.test(e),T=!0,k=!1,W="",B=0,G=0,D="";return!L||I||C||P||(s=e.indexOf("msie "),n=e.indexOf("trident"),o=e.indexOf("rv:"),k=-1!=s||-1!=n||-1!=o),!(A||b||c||L||m||g||f)||l||M||I||k||C||(i=e.match(/version\/([\d.]+).*safari\//))&&(m||g||f||(E=!0,P=z),D=i[1]),I?(-1<(s=e.indexOf("edge/"))?s+=5:-1<(s=e.indexOf("edg/"))?s+=4:-1<(s=e.indexOf("edga/"))?s+=5:-1<(s=e.indexOf("edgios/"))&&(s+=7),-1<s&&-1<(i=(D=e.slice(s)).indexOf(" "))&&(D=D.slice(0,i))):C?-1<(i=e.indexOf("firefox/"))?(i=-1<(n=(D=i=-1<(n=(i=e.slice(i+8)).indexOf(" "))?i.slice(0,n):i).indexOf("."))?D.slice(0,n):i)<27&&(T=z):(b||c)&&-1<(i=e.indexOf("fxios/"))&&(D=i=(i=e.slice(i+6)).slice(0,i.indexOf(" "))):k?(o=e.indexOf("msie "),m=e.indexOf("trident"),g=e.indexOf("rv:"),-1!=o?W=i=(i=e.slice(o+5)).slice(0,i.indexOf(";")):-1!=g?W=i=(i=(i=e.slice(g+3)).slice(0,i.indexOf(";"))).slice(0,i.indexOf(")")):-1!=m&&(W=i=(i=e.slice(m+7)).slice(0,i.indexOf(";"))),(!(""===W||10<=parseInt(W))||X&&X.DWT&&X.DWT.IfUseActiveXForIE10Plus)&&(T=z),D=i):E?-1<(i=D.indexOf("."))&&(i=D.slice(0,i))<7&&(T=z):l?-1<(i=e.indexOf("ucweb"))?D=e.slice(i+5):-1<(i=e.indexOf("ucbrowser/"))&&-1<(i=(D=e.slice(i+10)).indexOf(" "))&&(D=D.slice(0,i)):M?-1<(i=e.indexOf("version/"))?D=e.slice(i+8):-1<(i=e.indexOf("opr/"))&&(D=e.slice(i+4)):w?-1<(i=e.indexOf("browserng/"))&&(D=e.slice(i+10)):O?-1<(i=e.indexOf("iemobile/"))&&(D=e.slice(i+9)):P?(-1<(s=e.indexOf("chrome/"))?-1<(i=(D=e.slice(s+7)).indexOf(" "))&&(D=D.slice(0,i)):-1<(s=e.indexOf("crios/"))&&-1<(i=(D=e.slice(s+6)).indexOf(" "))&&(D=D.slice(0,i)),-1<(i=D.indexOf("."))&&(i=D.slice(0,i))<27&&(T=z)):v?-1<(n=e.indexOf("huaweibrowser"))&&-1<(i=(D=e.slice(n+14)).indexOf(" "))&&(D=D.slice(0,i)):y&&-1<(o=e.indexOf("jsdom"))&&-1<(i=(D=e.slice(o+6)).indexOf(" "))&&(D=D.slice(0,i)),(I||k)&&((g=window&&window.document)&&g.documentMode?B=g.documentMode:(B=5,g.compatMode&&"CSS1Compat"==g.compatMode&&(B=7)),k&&(G=parseInt(D))),(A||S)&&(t=!0,A&&(i=e.match(/mac os x (\d+)(_|\.)(\d+)/))&&3<i.length&&(10==i[1]&&i[3]<14||i[1]<10)&&(t=!1)),{bUseUserAgent:!0,bWin:L,bMac:A,bLinux:S,bMobile:h=L||A||S||u||p?h:!0,bPad:x,bChromeOS:a,bHarmonyOS:r,bArm64:u,bMips64:p,bEmbed:u||p,bAndroid:d,biPhone:b,biPad:c,bWin64:U,bWOW64:H,bOSx64:t,bIE:k,bEdge:I,bChrome:P,bFirefox:C,bSafari:E,bOpera:M,bNexus:f,bUC:l,b360SE:F,bMaxthon:V,bTencentTraveler:_,bTheWorld:j,bMetaSr:N,bAvant:q,bHuaWeiBrowser:v,bJSDom:y,bGecko:J,bHTML5Edition:T,strBrowserVersion:D,IEVersion:G,IEMode:B}}function t(){}var i,s,n,o,r,a=X.Lib,d=navigator;a.bNode?(a.win=global,r=e(a._defaultAgent,a._defaultPlatform),X.navInfo=r):("object"==typeof window?(a.win=window,a.doc=window.document):a.win={},i=!(b=void 0),"userAgentData"in d&&(n=[],(s=d.userAgentData).platform&&""!=s.platform&&("brands"in s&&Array.isArray(s.brands)&&0<s.brands.length?n=s.brands:"uaList"in s&&Array.isArray(s.uaList)&&0<s.uaList.length&&(n=s.uaList),0<n.length&&(i=!1,b=s.platform.toLowerCase(),r=function(e,t,i){for(var s,n,o,r,a,d=!1,b=!1,c=!1,l=e.mobile,f=!1,g="",x=navigator.maxTouchPoints||0,m=t.length,w=0;w<m;w++){var O=t[w].brand.toLowerCase();if(0<=O.indexOf("chrome")){c=!0,g=t[w].version;break}if(0<=O.indexOf("edge")){d=!0,g=t[w].version;break}if(0<=O.indexOf("opera")){b=!0,g=t[w].version;break}}return c||d||b||(c=!0,g="100"),{bUseUserAgent:!1,bWin:s=/windows/g.test(i),bMac:/mac/g.test(i),bLinux:n=/linux/g.test(i),bAndroid:o=/android/g.test(i),bHarmonyOS:r=/harmony/g.test(i),bChromeOS:/(chromeos|chrome\sos)/g.test(i),bIE:!1,bEdge:d,bUC:!1,bPlaybook:!1,bBlackBerry:!1,bHuaWeiBrowser:!1,bOpera:b,bFirefox:!1,bChrome:c,bJSDom:!1,biPhone:a=/iphone/g.test(i),biPad:f=s||o||n||a?f:/macintel/g.test(i)&&1<x,bPad:o&&!e.mobile,bSafari:!1,bMobile:l=o||r||a||f?!0:l,strBrowserVersion:g,bHTML5Edition:!0,IEVersion:0,IEMode:0}}(s,n,b)))),i&&(r=e(void 0||d.userAgent.toLowerCase(),o=o||d.platform.toLowerCase()),X.navInfo=r)),a.doc||(a.doc={getElementById:t,getElementsByTagName:t,styleSheets:[]});var b=(b=null==(n=null==(s=a.win)?void 0:s.location)?void 0:n.protocol)||"http:";r.protocol=b,r.bSSL="https:"===b,r.bFileSystem="https:"!==b&&"http:"!==b,X.navInfoSync=r}();if(Dynamsoft.navInfoSync.bIE){
/* @preserve
 * The MIT License (MIT)
 * 
 * Copyright (c) 2013-2018 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
/**
 * bluebird build version 3.7.2
 * Features enabled: core, race, call_get, generators, map, nodeify, promisify, props, reduce, settle, some, using, timers, filter, any, each
*/
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.Promise=t()}}(function(){var t,e,n;return function r(t,e,n){function i(s,a){if(!e[s]){if(!t[s]){var c="function"==typeof _dereq_&&_dereq_;if(!a&&c)return c(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=e[s]={exports:{}};t[s][0].call(l.exports,function(e){var n=t[s][1][e];return i(n?n:e)},l,l.exports,r,t,e,n)}return e[s].exports}for(var o="function"==typeof _dereq_&&_dereq_,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(t,e,n){"use strict";e.exports=function(t){function e(t){var e=new n(t),r=e.promise();return e.setHowMany(1),e.setUnwrap(),e.init(),r}var n=t._SomePromiseArray;t.any=function(t){return e(t)},t.prototype.any=function(){return e(this)}}},{}],2:[function(t,e,n){"use strict";function r(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new f(16),this._normalQueue=new f(16),this._haveDrainedQueues=!1;var t=this;this.drainQueues=function(){t._drainQueues()},this._schedule=p}function i(t,e,n){this._lateQueue.push(t,e,n),this._queueTick()}function o(t,e,n){this._normalQueue.push(t,e,n),this._queueTick()}function s(t){this._normalQueue._pushOne(t),this._queueTick()}function a(t){for(;t.length()>0;)c(t)}function c(t){var e=t.shift();if("function"!=typeof e)e._settlePromises();else{var n=t.shift(),r=t.shift();e.call(n,r)}}var u;try{throw new Error}catch(l){u=l}var p=t("./schedule"),f=t("./queue");r.prototype.setScheduler=function(t){var e=this._schedule;return this._schedule=t,this._customScheduler=!0,e},r.prototype.hasCustomScheduler=function(){return this._customScheduler},r.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},r.prototype.fatalError=function(t,e){e?(process.stderr.write("Fatal "+(t instanceof Error?t.stack:t)+"\n"),process.exit(2)):this.throwLater(t)},r.prototype.throwLater=function(t,e){if(1===arguments.length&&(e=t,t=function(){throw e}),"undefined"!=typeof setTimeout)setTimeout(function(){t(e)},0);else try{this._schedule(function(){t(e)})}catch(n){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},r.prototype.invokeLater=i,r.prototype.invoke=o,r.prototype.settlePromises=s,r.prototype._drainQueues=function(){a(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,a(this._lateQueue)},r.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},r.prototype._reset=function(){this._isTickUsed=!1},e.exports=r,e.exports.firstLineError=u},{"./queue":26,"./schedule":29}],3:[function(t,e,n){"use strict";e.exports=function(t,e,n,r){var i=!1,o=function(t,e){this._reject(e)},s=function(t,e){e.promiseRejectionQueued=!0,e.bindingPromise._then(o,o,null,this,t)},a=function(t,e){0===(50397184&this._bitField)&&this._resolveCallback(e.target)},c=function(t,e){e.promiseRejectionQueued||this._reject(t)};t.prototype.bind=function(o){i||(i=!0,t.prototype._propagateFrom=r.propagateFromFunction(),t.prototype._boundValue=r.boundValueFunction());var u=n(o),l=new t(e);l._propagateFrom(this,1);var p=this._target();if(l._setBoundTo(u),u instanceof t){var f={promiseRejectionQueued:!1,promise:l,target:p,bindingPromise:u};p._then(e,s,void 0,l,f),u._then(a,c,void 0,l,f),l._setOnCancel(u)}else l._resolveCallback(p);return l},t.prototype._setBoundTo=function(t){void 0!==t?(this._bitField=2097152|this._bitField,this._boundTo=t):this._bitField=-2097153&this._bitField},t.prototype._isBound=function(){return 2097152===(2097152&this._bitField)},t.bind=function(e,n){return t.resolve(n).bind(e)}}},{}],4:[function(t,e,n){"use strict";function r(){try{Promise===o&&(Promise=i)}catch(t){}return o}var i;"undefined"!=typeof Promise&&(i=Promise);var o=t("./promise")();o.noConflict=r,e.exports=o},{"./promise":22}],5:[function(t,e,n){"use strict";var r=Object.create;if(r){var i=r(null),o=r(null);i[" size"]=o[" size"]=0}e.exports=function(e){function n(t,n){var r;if(null!=t&&(r=t[n]),"function"!=typeof r){var i="Object "+a.classString(t)+" has no method '"+a.toString(n)+"'";throw new e.TypeError(i)}return r}function r(t){var e=this.pop(),r=n(t,e);return r.apply(t,this)}function i(t){return t[this]}function o(t){var e=+this;return 0>e&&(e=Math.max(0,e+t.length)),t[e]}var s,a=t("./util"),c=a.canEvaluate;a.isIdentifier;e.prototype.call=function(t){var e=[].slice.call(arguments,1);return e.push(t),this._then(r,void 0,void 0,e,void 0)},e.prototype.get=function(t){var e,n="number"==typeof t;if(n)e=o;else if(c){var r=s(t);e=null!==r?r:i}else e=i;return this._then(e,void 0,void 0,t,void 0)}}},{"./util":36}],6:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){var o=t("./util"),s=o.tryCatch,a=o.errorObj,c=e._async;e.prototype["break"]=e.prototype.cancel=function(){if(!i.cancellation())return this._warn("cancellation is disabled");for(var t=this,e=t;t._isCancellable();){if(!t._cancelBy(e)){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}var n=t._cancellationParent;if(null==n||!n._isCancellable()){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}t._isFollowing()&&t._followee().cancel(),t._setWillBeCancelled(),e=t,t=n}},e.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},e.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},e.prototype._cancelBy=function(t){return t===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),this._enoughBranchesHaveCancelled()?(this._invokeOnCancel(),!0):!1)},e.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},e.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),c.invoke(this._cancelPromises,this,void 0))},e.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},e.prototype._unsetOnCancel=function(){this._onCancelField=void 0},e.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},e.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},e.prototype._doInvokeOnCancel=function(t,e){if(o.isArray(t))for(var n=0;n<t.length;++n)this._doInvokeOnCancel(t[n],e);else if(void 0!==t)if("function"==typeof t){if(!e){var r=s(t).call(this._boundValue());r===a&&(this._attachExtraTrace(r.e),c.throwLater(r.e))}}else t._resultCancelled(this)},e.prototype._invokeOnCancel=function(){var t=this._onCancel();this._unsetOnCancel(),c.invoke(this._doInvokeOnCancel,this,t)},e.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},e.prototype._resultCancelled=function(){this.cancel()}}},{"./util":36}],7:[function(t,e,n){"use strict";e.exports=function(e){function n(t,n,a){return function(c){var u=a._boundValue();t:for(var l=0;l<t.length;++l){var p=t[l];if(p===Error||null!=p&&p.prototype instanceof Error){if(c instanceof p)return o(n).call(u,c)}else if("function"==typeof p){var f=o(p).call(u,c);if(f===s)return f;if(f)return o(n).call(u,c)}else if(r.isObject(c)){for(var h=i(p),_=0;_<h.length;++_){var d=h[_];if(p[d]!=c[d])continue t}return o(n).call(u,c)}}return e}}var r=t("./util"),i=t("./es5").keys,o=r.tryCatch,s=r.errorObj;return n}},{"./es5":13,"./util":36}],8:[function(t,e,n){"use strict";e.exports=function(t){function e(){this._trace=new e.CapturedTrace(r())}function n(){return i?new e:void 0}function r(){var t=o.length-1;return t>=0?o[t]:void 0}var i=!1,o=[];return t.prototype._promiseCreated=function(){},t.prototype._pushContext=function(){},t.prototype._popContext=function(){return null},t._peekContext=t.prototype._peekContext=function(){},e.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,o.push(this._trace))},e.prototype._popContext=function(){if(void 0!==this._trace){var t=o.pop(),e=t._promiseCreated;return t._promiseCreated=null,e}return null},e.CapturedTrace=null,e.create=n,e.deactivateLongStackTraces=function(){},e.activateLongStackTraces=function(){var n=t.prototype._pushContext,o=t.prototype._popContext,s=t._peekContext,a=t.prototype._peekContext,c=t.prototype._promiseCreated;e.deactivateLongStackTraces=function(){t.prototype._pushContext=n,t.prototype._popContext=o,t._peekContext=s,t.prototype._peekContext=a,t.prototype._promiseCreated=c,i=!1},i=!0,t.prototype._pushContext=e.prototype._pushContext,t.prototype._popContext=e.prototype._popContext,t._peekContext=t.prototype._peekContext=r,t.prototype._promiseCreated=function(){var t=this._peekContext();t&&null==t._promiseCreated&&(t._promiseCreated=this)}},e}},{}],9:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){function o(t,e){return{promise:e}}function s(){return!1}function a(t,e,n){var r=this;try{t(e,n,function(t){if("function"!=typeof t)throw new TypeError("onCancel must be a function, got: "+B.toString(t));r._attachCancellationCallback(t)})}catch(i){return i}}function c(t){if(!this._isCancellable())return this;var e=this._onCancel();void 0!==e?B.isArray(e)?e.push(t):this._setOnCancel([e,t]):this._setOnCancel(t)}function u(){return this._onCancelField}function l(t){this._onCancelField=t}function p(){this._cancellationParent=void 0,this._onCancelField=void 0}function f(t,e){if(0!==(1&e)){this._cancellationParent=t;var n=t._branchesRemainingToCancel;void 0===n&&(n=0),t._branchesRemainingToCancel=n+1}0!==(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)}function h(t,e){0!==(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)}function _(){var t=this._boundTo;return void 0!==t&&t instanceof e?t.isFulfilled()?t.value():void 0:t}function d(){this._trace=new V(this._peekContext())}function v(t,e){if(q(t)){var n=this._trace;if(void 0!==n&&e&&(n=n._parent),void 0!==n)n.attachExtraTrace(t);else if(!t.__stackCleaned__){var r=F(t);B.notEnumerableProp(t,"stack",r.message+"\n"+r.stack.join("\n")),B.notEnumerableProp(t,"__stackCleaned__",!0)}}}function y(){this._trace=void 0}function g(t,e,n,r,i){if(void 0===t&&null!==e&&Z){if(void 0!==i&&i._returnedNonUndefined())return;if(0===(65535&r._bitField))return;n&&(n+=" ");var o="",s="";if(e._trace){for(var a=e._trace.stack.split("\n"),c=k(a),u=c.length-1;u>=0;--u){var l=c[u];if(!Q.test(l)){var p=l.match(G);p&&(o="at "+p[1]+":"+p[2]+":"+p[3]+" ");break}}if(c.length>0)for(var f=c[0],u=0;u<a.length;++u)if(a[u]===f){u>0&&(s="\n"+a[u-1]);break}}var h="a promise was created in a "+n+"handler "+o+"but was not returned from it, see http://goo.gl/rRqMUw"+s;r._warn(h,!0,e)}}function m(t,e){var n=t+" is deprecated and will be removed in a future version.";return e&&(n+=" Use "+e+" instead."),b(n)}function b(t,n,r){if(lt.warnings){var i,o=new U(t);if(n)r._attachExtraTrace(o);else if(lt.longStackTraces&&(i=e._peekContext()))i.attachExtraTrace(o);else{var s=F(o);o.stack=s.message+"\n"+s.stack.join("\n")}ot("warning",o)||x(o,"",!0)}}function w(t,e){for(var n=0;n<e.length-1;++n)e[n].push("From previous event:"),e[n]=e[n].join("\n");return n<e.length&&(e[n]=e[n].join("\n")),t+"\n"+e.join("\n")}function C(t){for(var e=0;e<t.length;++e)(0===t[e].length||e+1<t.length&&t[e][0]===t[e+1][0])&&(t.splice(e,1),e--)}function j(t){for(var e=t[0],n=1;n<t.length;++n){for(var r=t[n],i=e.length-1,o=e[i],s=-1,a=r.length-1;a>=0;--a)if(r[a]===o){s=a;break}for(var a=s;a>=0;--a){var c=r[a];if(e[i]!==c)break;e.pop(),i--}e=r}}function k(t){for(var e=[],n=0;n<t.length;++n){var r=t[n],i="    (No stack trace)"===r||z.test(r),o=i&&at(r);i&&!o&&(W&&" "!==r.charAt(0)&&(r="    "+r),e.push(r))}return e}function E(t){for(var e=t.stack.replace(/\s+$/g,"").split("\n"),n=0;n<e.length;++n){var r=e[n];if("    (No stack trace)"===r||z.test(r))break}return n>0&&"SyntaxError"!=t.name&&(e=e.slice(n)),e}function F(t){var e=t.stack,n=t.toString();return e="string"==typeof e&&e.length>0?E(t):["    (No stack trace)"],{message:n,stack:"SyntaxError"==t.name?e:k(e)}}function x(t,e,n){if("undefined"!=typeof console){var r;if(B.isObject(t)){var i=t.stack;r=e+X(i,t)}else r=e+String(t);"function"==typeof I?I(r,n):("function"==typeof console.log||"object"==typeof console.log)&&console.log(r)}}function T(t,e,n,r){var i=!1;try{"function"==typeof e&&(i=!0,"rejectionHandled"===t?e(r):e(n,r))}catch(o){N.throwLater(o)}"unhandledRejection"===t?ot(t,n,r)||i||x(n,"Unhandled rejection "):ot(t,r)}function P(t){var e;if("function"==typeof t)e="[function "+(t.name||"anonymous")+"]";else{e=t&&"function"==typeof t.toString?t.toString():B.toString(t);var n=/\[object [a-zA-Z0-9$_]+\]/;if(n.test(e))try{var r=JSON.stringify(t);e=r}catch(i){}0===e.length&&(e="(empty array)")}return"(<"+R(e)+">, no stack trace)"}function R(t){var e=41;return t.length<e?t:t.substr(0,e-3)+"..."}function S(){return"function"==typeof ut}function O(t){var e=t.match(ct);return e?{fileName:e[1],line:parseInt(e[2],10)}:void 0}function A(t,e){if(S()){for(var n,r,i=(t.stack||"").split("\n"),o=(e.stack||"").split("\n"),s=-1,a=-1,c=0;c<i.length;++c){var u=O(i[c]);if(u){n=u.fileName,s=u.line;break}}for(var c=0;c<o.length;++c){var u=O(o[c]);if(u){r=u.fileName,a=u.line;break}}0>s||0>a||!n||!r||n!==r||s>=a||(at=function(t){if($.test(t))return!0;var e=O(t);return e&&e.fileName===n&&s<=e.line&&e.line<=a?!0:!1})}}function V(t){this._parent=t,this._promisesCreated=0;var e=this._length=1+(void 0===t?0:t._length);ut(this,V),e>32&&this.uncycle()}var H,D,I,L,N=e._async,U=t("./errors").Warning,B=t("./util"),M=t("./es5"),q=B.canAttachTrace,$=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,Q=/\((?:timers\.js):\d+:\d+\)/,G=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,z=null,X=null,W=!1,K=!(0==B.env("BLUEBIRD_DEBUG")||!B.env("BLUEBIRD_DEBUG")&&"development"!==B.env("NODE_ENV")),J=!(0==B.env("BLUEBIRD_WARNINGS")||!K&&!B.env("BLUEBIRD_WARNINGS")),Y=!(0==B.env("BLUEBIRD_LONG_STACK_TRACES")||!K&&!B.env("BLUEBIRD_LONG_STACK_TRACES")),Z=0!=B.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(J||!!B.env("BLUEBIRD_W_FORGOTTEN_RETURN"));!function(){function t(){for(var t=0;t<r.length;++t)r[t]._notifyUnhandledRejection();n()}function n(){r.length=0}var r=[];L=function(e){r.push(e),setTimeout(t,1)},M.defineProperty(e,"_unhandledRejectionCheck",{value:t}),M.defineProperty(e,"_unhandledRejectionClear",{value:n})}(),e.prototype.suppressUnhandledRejections=function(){var t=this._target();t._bitField=-1048577&t._bitField|524288},e.prototype._ensurePossibleRejectionHandled=function(){0===(524288&this._bitField)&&(this._setRejectionIsUnhandled(),L(this))},e.prototype._notifyUnhandledRejectionIsHandled=function(){T("rejectionHandled",H,void 0,this)},e.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},e.prototype._returnedNonUndefined=function(){return 0!==(268435456&this._bitField)},e.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var t=this._settledValue();this._setUnhandledRejectionIsNotified(),T("unhandledRejection",D,t,this)}},e.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},e.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},e.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},e.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},e.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},e.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},e.prototype._warn=function(t,e,n){return b(t,e,n||this)},e.onPossiblyUnhandledRejection=function(t){var n=e._getContext();D=B.contextBind(n,t)},e.onUnhandledRejectionHandled=function(t){var n=e._getContext();H=B.contextBind(n,t)};var tt=function(){};e.longStackTraces=function(){if(N.haveItemsQueued()&&!lt.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!lt.longStackTraces&&S()){var t=e.prototype._captureStackTrace,r=e.prototype._attachExtraTrace,i=e.prototype._dereferenceTrace;lt.longStackTraces=!0,tt=function(){if(N.haveItemsQueued()&&!lt.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");e.prototype._captureStackTrace=t,e.prototype._attachExtraTrace=r,e.prototype._dereferenceTrace=i,n.deactivateLongStackTraces(),lt.longStackTraces=!1},e.prototype._captureStackTrace=d,e.prototype._attachExtraTrace=v,e.prototype._dereferenceTrace=y,n.activateLongStackTraces()}},e.hasLongStackTraces=function(){return lt.longStackTraces&&S()};var et={unhandledrejection:{before:function(){var t=B.global.onunhandledrejection;return B.global.onunhandledrejection=null,t},after:function(t){B.global.onunhandledrejection=t}},rejectionhandled:{before:function(){var t=B.global.onrejectionhandled;return B.global.onrejectionhandled=null,t},after:function(t){B.global.onrejectionhandled=t}}},nt=function(){var t=function(t,e){if(!t)return!B.global.dispatchEvent(e);var n;try{return n=t.before(),!B.global.dispatchEvent(e)}finally{t.after(n)}};try{if("function"==typeof CustomEvent){var e=new CustomEvent("CustomEvent");return B.global.dispatchEvent(e),function(e,n){e=e.toLowerCase();var r={detail:n,cancelable:!0},i=new CustomEvent(e,r);return M.defineProperty(i,"promise",{value:n.promise}),M.defineProperty(i,"reason",{value:n.reason}),t(et[e],i)}}if("function"==typeof Event){var e=new Event("CustomEvent");return B.global.dispatchEvent(e),function(e,n){e=e.toLowerCase();var r=new Event(e,{cancelable:!0});return r.detail=n,M.defineProperty(r,"promise",{value:n.promise}),M.defineProperty(r,"reason",{value:n.reason}),t(et[e],r)}}var e=document.createEvent("CustomEvent");return e.initCustomEvent("testingtheevent",!1,!0,{}),B.global.dispatchEvent(e),function(e,n){e=e.toLowerCase();var r=document.createEvent("CustomEvent");return r.initCustomEvent(e,!1,!0,n),t(et[e],r)}}catch(n){}return function(){return!1}}(),rt=function(){return B.isNode?function(){return process.emit.apply(process,arguments)}:B.global?function(t){var e="on"+t.toLowerCase(),n=B.global[e];return n?(n.apply(B.global,[].slice.call(arguments,1)),!0):!1}:function(){return!1}}(),it={promiseCreated:o,promiseFulfilled:o,promiseRejected:o,promiseResolved:o,promiseCancelled:o,promiseChained:function(t,e,n){return{promise:e,child:n}},warning:function(t,e){return{warning:e}},unhandledRejection:function(t,e,n){return{reason:e,promise:n}},rejectionHandled:o},ot=function(t){var e=!1;try{e=rt.apply(null,arguments)}catch(n){N.throwLater(n),e=!0}var r=!1;try{r=nt(t,it[t].apply(null,arguments))}catch(n){N.throwLater(n),r=!0}return r||e};e.config=function(t){if(t=Object(t),"longStackTraces"in t&&(t.longStackTraces?e.longStackTraces():!t.longStackTraces&&e.hasLongStackTraces()&&tt()),"warnings"in t){var n=t.warnings;lt.warnings=!!n,Z=lt.warnings,B.isObject(n)&&"wForgottenReturn"in n&&(Z=!!n.wForgottenReturn)}if("cancellation"in t&&t.cancellation&&!lt.cancellation){if(N.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");e.prototype._clearCancellationData=p,e.prototype._propagateFrom=f,e.prototype._onCancel=u,e.prototype._setOnCancel=l,e.prototype._attachCancellationCallback=c,e.prototype._execute=a,st=f,lt.cancellation=!0}if("monitoring"in t&&(t.monitoring&&!lt.monitoring?(lt.monitoring=!0,e.prototype._fireEvent=ot):!t.monitoring&&lt.monitoring&&(lt.monitoring=!1,e.prototype._fireEvent=s)),"asyncHooks"in t&&B.nodeSupportsAsyncResource){var o=lt.asyncHooks,h=!!t.asyncHooks;o!==h&&(lt.asyncHooks=h,h?r():i())}return e},e.prototype._fireEvent=s,e.prototype._execute=function(t,e,n){try{t(e,n)}catch(r){return r}},e.prototype._onCancel=function(){},e.prototype._setOnCancel=function(t){},e.prototype._attachCancellationCallback=function(t){},e.prototype._captureStackTrace=function(){},e.prototype._attachExtraTrace=function(){},e.prototype._dereferenceTrace=function(){},e.prototype._clearCancellationData=function(){},e.prototype._propagateFrom=function(t,e){};var st=h,at=function(){return!1},ct=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;B.inherits(V,Error),n.CapturedTrace=V,V.prototype.uncycle=function(){var t=this._length;if(!(2>t)){for(var e=[],n={},r=0,i=this;void 0!==i;++r)e.push(i),i=i._parent;t=this._length=r;for(var r=t-1;r>=0;--r){var o=e[r].stack;void 0===n[o]&&(n[o]=r)}for(var r=0;t>r;++r){var s=e[r].stack,a=n[s];if(void 0!==a&&a!==r){a>0&&(e[a-1]._parent=void 0,e[a-1]._length=1),e[r]._parent=void 0,e[r]._length=1;var c=r>0?e[r-1]:this;t-1>a?(c._parent=e[a+1],c._parent.uncycle(),c._length=c._parent._length+1):(c._parent=void 0,c._length=1);for(var u=c._length+1,l=r-2;l>=0;--l)e[l]._length=u,u++;return}}}},V.prototype.attachExtraTrace=function(t){if(!t.__stackCleaned__){this.uncycle();for(var e=F(t),n=e.message,r=[e.stack],i=this;void 0!==i;)r.push(k(i.stack.split("\n"))),i=i._parent;j(r),C(r),B.notEnumerableProp(t,"stack",w(n,r)),B.notEnumerableProp(t,"__stackCleaned__",!0)}};var ut=function(){var t=/^\s*at\s*/,e=function(t,e){return"string"==typeof t?t:void 0!==e.name&&void 0!==e.message?e.toString():P(e)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,z=t,X=e;var n=Error.captureStackTrace;return at=function(t){return $.test(t)},function(t,e){Error.stackTraceLimit+=6,n(t,e),Error.stackTraceLimit-=6}}var r=new Error;if("string"==typeof r.stack&&r.stack.split("\n")[0].indexOf("stackDetection@")>=0)return z=/@/,X=e,W=!0,function(t){t.stack=(new Error).stack};var i;try{throw new Error}catch(o){i="stack"in o}return"stack"in r||!i||"number"!=typeof Error.stackTraceLimit?(X=function(t,e){return"string"==typeof t?t:"object"!=typeof e&&"function"!=typeof e||void 0===e.name||void 0===e.message?P(e):e.toString()},null):(z=t,X=e,function(t){Error.stackTraceLimit+=6;try{throw new Error}catch(e){t.stack=e.stack}Error.stackTraceLimit-=6})}([]);"undefined"!=typeof console&&"undefined"!=typeof console.warn&&(I=function(t){console.warn(t)},B.isNode&&process.stderr.isTTY?I=function(t,e){var n=e?"[33m":"[31m";console.warn(n+t+"[0m\n")}:B.isNode||"string"!=typeof(new Error).stack||(I=function(t,e){console.warn("%c"+t,e?"color: darkorange":"color: red")}));var lt={warnings:J,longStackTraces:!1,cancellation:!1,monitoring:!1,asyncHooks:!1};return Y&&e.longStackTraces(),{asyncHooks:function(){return lt.asyncHooks},longStackTraces:function(){return lt.longStackTraces},warnings:function(){return lt.warnings},cancellation:function(){return lt.cancellation},monitoring:function(){return lt.monitoring},propagateFromFunction:function(){return st},boundValueFunction:function(){return _},checkForgottenReturns:g,setBounds:A,warn:b,deprecated:m,CapturedTrace:V,fireDomEvent:nt,fireGlobalEvent:rt}}},{"./errors":12,"./es5":13,"./util":36}],10:[function(t,e,n){"use strict";e.exports=function(t){function e(){return this.value}function n(){throw this.reason}t.prototype["return"]=t.prototype.thenReturn=function(n){return n instanceof t&&n.suppressUnhandledRejections(),this._then(e,void 0,void 0,{value:n},void 0)},t.prototype["throw"]=t.prototype.thenThrow=function(t){return this._then(n,void 0,void 0,{reason:t},void 0)},t.prototype.catchThrow=function(t){if(arguments.length<=1)return this._then(void 0,n,void 0,{reason:t},void 0);var e=arguments[1],r=function(){throw e};return this.caught(t,r)},t.prototype.catchReturn=function(n){if(arguments.length<=1)return n instanceof t&&n.suppressUnhandledRejections(),this._then(void 0,e,void 0,{value:n},void 0);var r=arguments[1];r instanceof t&&r.suppressUnhandledRejections();var i=function(){return r};return this.caught(n,i)}}},{}],11:[function(t,e,n){"use strict";e.exports=function(t,e){function n(){return o(this)}function r(t,n){return i(t,n,e,e)}var i=t.reduce,o=t.all;t.prototype.each=function(t){return i(this,t,e,0)._then(n,void 0,void 0,this,void 0)},t.prototype.mapSeries=function(t){return i(this,t,e,e)},t.each=function(t,r){return i(t,r,e,0)._then(n,void 0,void 0,t,void 0)},t.mapSeries=r}},{}],12:[function(t,e,n){"use strict";function r(t,e){function n(r){return this instanceof n?(p(this,"message","string"==typeof r?r:e),p(this,"name",t),void(Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this))):new n(r)}return l(n,Error),n}function i(t){return this instanceof i?(p(this,"name","OperationalError"),p(this,"message",t),this.cause=t,this.isOperational=!0,void(t instanceof Error?(p(this,"message",t.message),p(this,"stack",t.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor))):new i(t)}var o,s,a=t("./es5"),c=a.freeze,u=t("./util"),l=u.inherits,p=u.notEnumerableProp,f=r("Warning","warning"),h=r("CancellationError","cancellation error"),_=r("TimeoutError","timeout error"),d=r("AggregateError","aggregate error");try{o=TypeError,s=RangeError}catch(v){o=r("TypeError","type error"),s=r("RangeError","range error")}for(var y="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),g=0;g<y.length;++g)"function"==typeof Array.prototype[y[g]]&&(d.prototype[y[g]]=Array.prototype[y[g]]);a.defineProperty(d.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),d.prototype.isOperational=!0;var m=0;d.prototype.toString=function(){var t=Array(4*m+1).join(" "),e="\n"+t+"AggregateError of:\n";m++,t=Array(4*m+1).join(" ");for(var n=0;n<this.length;++n){for(var r=this[n]===this?"[Circular AggregateError]":this[n]+"",i=r.split("\n"),o=0;o<i.length;++o)i[o]=t+i[o];r=i.join("\n"),e+=r+"\n"}return m--,e},l(i,Error);var b=Error.__BluebirdErrorTypes__;b||(b=c({CancellationError:h,TimeoutError:_,OperationalError:i,RejectionError:i,AggregateError:d}),a.defineProperty(Error,"__BluebirdErrorTypes__",{value:b,writable:!1,enumerable:!1,configurable:!1})),e.exports={Error:Error,TypeError:o,RangeError:s,CancellationError:b.CancellationError,OperationalError:b.OperationalError,TimeoutError:b.TimeoutError,AggregateError:b.AggregateError,Warning:f}},{"./es5":13,"./util":36}],13:[function(t,e,n){var r=function(){"use strict";return void 0===this}();if(r)e.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:r,propertyIsWritable:function(t,e){var n=Object.getOwnPropertyDescriptor(t,e);return!(n&&!n.writable&&!n.set)}};else{var i={}.hasOwnProperty,o={}.toString,s={}.constructor.prototype,a=function(t){var e=[];for(var n in t)i.call(t,n)&&e.push(n);return e},c=function(t,e){return{value:t[e]}},u=function(t,e,n){return t[e]=n.value,t},l=function(t){return t},p=function(t){try{return Object(t).constructor.prototype}catch(e){return s}},f=function(t){try{return"[object Array]"===o.call(t)}catch(e){return!1}};e.exports={isArray:f,keys:a,names:a,defineProperty:u,getDescriptor:c,freeze:l,getPrototypeOf:p,isES5:r,propertyIsWritable:function(){return!0}}}},{}],14:[function(t,e,n){"use strict";e.exports=function(t,e){var n=t.map;t.prototype.filter=function(t,r){return n(this,t,r,e)},t.filter=function(t,r,i){return n(t,r,i,e)}}},{}],15:[function(t,e,n){"use strict";e.exports=function(e,n,r){function i(t,e,n){this.promise=t,this.type=e,this.handler=n,this.called=!1,this.cancelPromise=null}function o(t){this.finallyHandler=t}function s(t,e){return null!=t.cancelPromise?(arguments.length>1?t.cancelPromise._reject(e):t.cancelPromise._cancel(),t.cancelPromise=null,!0):!1}function a(){return u.call(this,this.promise._target()._settledValue())}function c(t){return s(this,t)?void 0:(f.e=t,f)}function u(t){var i=this.promise,u=this.handler;if(!this.called){this.called=!0;var l=this.isFinallyHandler()?u.call(i._boundValue()):u.call(i._boundValue(),t);if(l===r)return l;if(void 0!==l){i._setReturnedNonUndefined();var h=n(l,i);if(h instanceof e){if(null!=this.cancelPromise){if(h._isCancelled()){var _=new p("late cancellation observer");return i._attachExtraTrace(_),f.e=_,f}h.isPending()&&h._attachCancellationCallback(new o(this))}return h._then(a,c,void 0,this,void 0)}}}return i.isRejected()?(s(this),f.e=t,f):(s(this),t)}var l=t("./util"),p=e.CancellationError,f=l.errorObj,h=t("./catch_filter")(r);return i.prototype.isFinallyHandler=function(){return 0===this.type},o.prototype._resultCancelled=function(){s(this.finallyHandler)},e.prototype._passThrough=function(t,e,n,r){return"function"!=typeof t?this.then():this._then(n,r,void 0,new i(this,e,t),void 0)},e.prototype.lastly=e.prototype["finally"]=function(t){return this._passThrough(t,0,u,u)},e.prototype.tap=function(t){return this._passThrough(t,1,u)},e.prototype.tapCatch=function(t){var n=arguments.length;if(1===n)return this._passThrough(t,1,void 0,u);var r,i=new Array(n-1),o=0;for(r=0;n-1>r;++r){var s=arguments[r];if(!l.isObject(s))return e.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+l.classString(s)));i[o++]=s}i.length=o;var a=arguments[r];return this._passThrough(h(i,a,this),1,void 0,u)},i}},{"./catch_filter":7,"./util":36}],16:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,s){function a(t,n,r){for(var o=0;o<n.length;++o){r._pushContext();var s=h(n[o])(t);if(r._popContext(),s===f){r._pushContext();var a=e.reject(f.e);return r._popContext(),a}var c=i(s,r);if(c instanceof e)return c}return null}function c(t,n,i,o){if(s.cancellation()){var a=new e(r),c=this._finallyPromise=new e(r);this._promise=a.lastly(function(){return c}),a._captureStackTrace(),a._setOnCancel(this)}else{var u=this._promise=new e(r);u._captureStackTrace()}this._stack=o,this._generatorFunction=t,this._receiver=n,this._generator=void 0,this._yieldHandlers="function"==typeof i?[i].concat(_):_,this._yieldedPromise=null,this._cancellationPhase=!1}var u=t("./errors"),l=u.TypeError,p=t("./util"),f=p.errorObj,h=p.tryCatch,_=[];p.inherits(c,o),c.prototype._isResolved=function(){return null===this._promise},c.prototype._cleanup=function(){this._promise=this._generator=null,s.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},c.prototype._promiseCancelled=function(){if(!this._isResolved()){var t,n="undefined"!=typeof this._generator["return"];if(n)this._promise._pushContext(),t=h(this._generator["return"]).call(this._generator,void 0),this._promise._popContext();else{var r=new e.CancellationError("generator .return() sentinel");e.coroutine.returnSentinel=r,this._promise._attachExtraTrace(r),this._promise._pushContext(),t=h(this._generator["throw"]).call(this._generator,r),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(t)}},c.prototype._promiseFulfilled=function(t){this._yieldedPromise=null,this._promise._pushContext();var e=h(this._generator.next).call(this._generator,t);this._promise._popContext(),this._continue(e)},c.prototype._promiseRejected=function(t){this._yieldedPromise=null,this._promise._attachExtraTrace(t),this._promise._pushContext();var e=h(this._generator["throw"]).call(this._generator,t);this._promise._popContext(),this._continue(e)},c.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof e){var t=this._yieldedPromise;this._yieldedPromise=null,t.cancel()}},c.prototype.promise=function(){return this._promise},c.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},c.prototype._continue=function(t){var n=this._promise;if(t===f)return this._cleanup(),this._cancellationPhase?n.cancel():n._rejectCallback(t.e,!1);var r=t.value;if(t.done===!0)return this._cleanup(),this._cancellationPhase?n.cancel():n._resolveCallback(r);
var o=i(r,this._promise);if(!(o instanceof e)&&(o=a(o,this._yieldHandlers,this._promise),null===o))return void this._promiseRejected(new l("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",String(r))+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")));o=o._target();var s=o._bitField;0===(50397184&s)?(this._yieldedPromise=o,o._proxy(this,null)):0!==(33554432&s)?e._async.invoke(this._promiseFulfilled,this,o._value()):0!==(16777216&s)?e._async.invoke(this._promiseRejected,this,o._reason()):this._promiseCancelled()},e.coroutine=function(t,e){if("function"!=typeof t)throw new l("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var n=Object(e).yieldHandler,r=c,i=(new Error).stack;return function(){var e=t.apply(this,arguments),o=new r(void 0,void 0,n,i),s=o.promise();return o._generator=e,o._promiseFulfilled(void 0),s}},e.coroutine.addYieldHandler=function(t){if("function"!=typeof t)throw new l("expecting a function but got "+p.classString(t));_.push(t)},e.spawn=function(t){if(s.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof t)return n("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var r=new c(t,this),i=r.promise();return r._run(e.spawn),i}}},{"./errors":12,"./util":36}],17:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o){var s=t("./util");s.canEvaluate,s.tryCatch,s.errorObj;e.join=function(){var t,e=arguments.length-1;if(e>0&&"function"==typeof arguments[e]){t=arguments[e];var r}var i=[].slice.call(arguments);t&&i.pop();var r=new n(i).promise();return void 0!==t?r.spread(t):r}}},{"./util":36}],18:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,s){function a(t,n,r,i){this.constructor$(t),this._promise._captureStackTrace();var s=e._getContext();if(this._callback=u.contextBind(s,n),this._preservedValues=i===o?new Array(this.length()):null,this._limit=r,this._inFlight=0,this._queue=[],f.invoke(this._asyncInit,this,void 0),u.isArray(t))for(var a=0;a<t.length;++a){var c=t[a];c instanceof e&&c.suppressUnhandledRejections()}}function c(t,n,i,o){if("function"!=typeof n)return r("expecting a function but got "+u.classString(n));var s=0;if(void 0!==i){if("object"!=typeof i||null===i)return e.reject(new TypeError("options argument must be an object but it is "+u.classString(i)));if("number"!=typeof i.concurrency)return e.reject(new TypeError("'concurrency' must be a number but it is "+u.classString(i.concurrency)));s=i.concurrency}return s="number"==typeof s&&isFinite(s)&&s>=1?s:0,new a(t,n,s,o).promise()}var u=t("./util"),l=u.tryCatch,p=u.errorObj,f=e._async;u.inherits(a,n),a.prototype._asyncInit=function(){this._init$(void 0,-2)},a.prototype._init=function(){},a.prototype._promiseFulfilled=function(t,n){var r=this._values,o=this.length(),a=this._preservedValues,c=this._limit;if(0>n){if(n=-1*n-1,r[n]=t,c>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(c>=1&&this._inFlight>=c)return r[n]=t,this._queue.push(n),!1;null!==a&&(a[n]=t);var u=this._promise,f=this._callback,h=u._boundValue();u._pushContext();var _=l(f).call(h,t,n,o),d=u._popContext();if(s.checkForgottenReturns(_,d,null!==a?"Promise.filter":"Promise.map",u),_===p)return this._reject(_.e),!0;var v=i(_,this._promise);if(v instanceof e){v=v._target();var y=v._bitField;if(0===(50397184&y))return c>=1&&this._inFlight++,r[n]=v,v._proxy(this,-1*(n+1)),!1;if(0===(33554432&y))return 0!==(16777216&y)?(this._reject(v._reason()),!0):(this._cancel(),!0);_=v._value()}r[n]=_}var g=++this._totalResolved;return g>=o?(null!==a?this._filter(r,a):this._resolve(r),!0):!1},a.prototype._drainQueue=function(){for(var t=this._queue,e=this._limit,n=this._values;t.length>0&&this._inFlight<e;){if(this._isResolved())return;var r=t.pop();this._promiseFulfilled(n[r],r)}},a.prototype._filter=function(t,e){for(var n=e.length,r=new Array(n),i=0,o=0;n>o;++o)t[o]&&(r[i++]=e[o]);r.length=i,this._resolve(r)},a.prototype.preservedValues=function(){return this._preservedValues},e.prototype.map=function(t,e){return c(this,t,e,null)},e.map=function(t,e,n,r){return c(t,e,n,r)}}},{"./util":36}],19:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o){var s=t("./util"),a=s.tryCatch;e.method=function(t){if("function"!=typeof t)throw new e.TypeError("expecting a function but got "+s.classString(t));return function(){var r=new e(n);r._captureStackTrace(),r._pushContext();var i=a(t).apply(this,arguments),s=r._popContext();return o.checkForgottenReturns(i,s,"Promise.method",r),r._resolveFromSyncValue(i),r}},e.attempt=e["try"]=function(t){if("function"!=typeof t)return i("expecting a function but got "+s.classString(t));var r=new e(n);r._captureStackTrace(),r._pushContext();var c;if(arguments.length>1){o.deprecated("calling Promise.try with more than 1 argument");var u=arguments[1],l=arguments[2];c=s.isArray(u)?a(t).apply(l,u):a(t).call(l,u)}else c=a(t)();var p=r._popContext();return o.checkForgottenReturns(c,p,"Promise.try",r),r._resolveFromSyncValue(c),r},e.prototype._resolveFromSyncValue=function(t){t===s.errorObj?this._rejectCallback(t.e,!1):this._resolveCallback(t,!0)}}},{"./util":36}],20:[function(t,e,n){"use strict";function r(t){return t instanceof Error&&l.getPrototypeOf(t)===Error.prototype}function i(t){var e;if(r(t)){e=new u(t),e.name=t.name,e.message=t.message,e.stack=t.stack;for(var n=l.keys(t),i=0;i<n.length;++i){var o=n[i];p.test(o)||(e[o]=t[o])}return e}return s.markAsOriginatingFromRejection(t),t}function o(t,e){return function(n,r){if(null!==t){if(n){var o=i(a(n));t._attachExtraTrace(o),t._reject(o)}else if(e){var s=[].slice.call(arguments,1);t._fulfill(s)}else t._fulfill(r);t=null}}}var s=t("./util"),a=s.maybeWrapAsError,c=t("./errors"),u=c.OperationalError,l=t("./es5"),p=/^(?:name|message|stack|cause)$/;e.exports=o},{"./errors":12,"./es5":13,"./util":36}],21:[function(t,e,n){"use strict";e.exports=function(e){function n(t,e){var n=this;if(!o.isArray(t))return r.call(n,t,e);var i=a(e).apply(n._boundValue(),[null].concat(t));i===c&&s.throwLater(i.e)}function r(t,e){var n=this,r=n._boundValue(),i=void 0===t?a(e).call(r,null):a(e).call(r,null,t);i===c&&s.throwLater(i.e)}function i(t,e){var n=this;if(!t){var r=new Error(t+"");r.cause=t,t=r}var i=a(e).call(n._boundValue(),t);i===c&&s.throwLater(i.e)}var o=t("./util"),s=e._async,a=o.tryCatch,c=o.errorObj;e.prototype.asCallback=e.prototype.nodeify=function(t,e){if("function"==typeof t){var o=r;void 0!==e&&Object(e).spread&&(o=n),this._then(o,i,void 0,this,t)}return this}}},{"./util":36}],22:[function(t,e,n){"use strict";e.exports=function(){function n(){}function r(t,e){if(null==t||(t.constructor!==i&&"undefined"!=typeof Promise&&t.constructor!==Promise))throw new E("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof e)throw new E("expecting a function but got "+f.classString(e))}function i(t){t!==x&&r(this,t),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(t),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function o(t){this.promise._resolveCallback(t)}function s(t){this.promise._rejectCallback(t,!1)}function a(t){var e=new i(x);e._fulfillmentHandler0=t,e._rejectionHandler0=t,e._promise0=t,e._receiver0=t}var c=function(){return new E("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},u=function(){return new i.PromiseInspection(this._target())},l=function(t){return i.reject(new E(t))},p={},f=t("./util");f.setReflectHandler(u);var h=function(){var t=process.domain;return void 0===t?null:t},_=function(){return null},d=function(){return{domain:h(),async:null}},v=f.isNode&&f.nodeSupportsAsyncResource?t("async_hooks").AsyncResource:null,y=function(){return{domain:h(),async:new v("Bluebird::Promise")}},g=f.isNode?d:_;f.notEnumerableProp(i,"_getContext",g);var m=function(){g=y,f.notEnumerableProp(i,"_getContext",y)},b=function(){g=d,f.notEnumerableProp(i,"_getContext",d)},w=t("./es5"),C=t("./async"),j=new C;w.defineProperty(i,"_async",{value:j});var k=t("./errors"),E=i.TypeError=k.TypeError;i.RangeError=k.RangeError;var F=i.CancellationError=k.CancellationError;i.TimeoutError=k.TimeoutError,i.OperationalError=k.OperationalError,i.RejectionError=k.OperationalError,i.AggregateError=k.AggregateError;var x=function(){},T={},P={},R=t("./thenables")(i,x),S=t("./promise_array")(i,x,R,l,n),O=t("./context")(i),A=O.create,V=t("./debuggability")(i,O,m,b),H=(V.CapturedTrace,t("./finally")(i,R,P)),D=t("./catch_filter")(P),I=t("./nodeback"),L=f.errorObj,N=f.tryCatch;return i.prototype.toString=function(){return"[object Promise]"},i.prototype.caught=i.prototype["catch"]=function(t){var e=arguments.length;if(e>1){var n,r=new Array(e-1),i=0;for(n=0;e-1>n;++n){var o=arguments[n];if(!f.isObject(o))return l("Catch statement predicate: expecting an object but got "+f.classString(o));r[i++]=o}if(r.length=i,t=arguments[n],"function"!=typeof t)throw new E("The last argument to .catch() must be a function, got "+f.toString(t));return this.then(void 0,D(r,t,this))}return this.then(void 0,t)},i.prototype.reflect=function(){return this._then(u,u,void 0,this,void 0)},i.prototype.then=function(t,e){if(V.warnings()&&arguments.length>0&&"function"!=typeof t&&"function"!=typeof e){var n=".then() only accepts functions but was passed: "+f.classString(t);arguments.length>1&&(n+=", "+f.classString(e)),this._warn(n)}return this._then(t,e,void 0,void 0,void 0)},i.prototype.done=function(t,e){var n=this._then(t,e,void 0,void 0,void 0);n._setIsFinal()},i.prototype.spread=function(t){return"function"!=typeof t?l("expecting a function but got "+f.classString(t)):this.all()._then(t,void 0,void 0,T,void 0)},i.prototype.toJSON=function(){var t={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(t.fulfillmentValue=this.value(),t.isFulfilled=!0):this.isRejected()&&(t.rejectionReason=this.reason(),t.isRejected=!0),t},i.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new S(this).promise()},i.prototype.error=function(t){return this.caught(f.originatesFromRejection,t)},i.getNewLibraryCopy=e.exports,i.is=function(t){return t instanceof i},i.fromNode=i.fromCallback=function(t){var e=new i(x);e._captureStackTrace();var n=arguments.length>1?!!Object(arguments[1]).multiArgs:!1,r=N(t)(I(e,n));return r===L&&e._rejectCallback(r.e,!0),e._isFateSealed()||e._setAsyncGuaranteed(),e},i.all=function(t){return new S(t).promise()},i.cast=function(t){var e=R(t);return e instanceof i||(e=new i(x),e._captureStackTrace(),e._setFulfilled(),e._rejectionHandler0=t),e},i.resolve=i.fulfilled=i.cast,i.reject=i.rejected=function(t){var e=new i(x);return e._captureStackTrace(),e._rejectCallback(t,!0),e},i.setScheduler=function(t){if("function"!=typeof t)throw new E("expecting a function but got "+f.classString(t));return j.setScheduler(t)},i.prototype._then=function(t,e,n,r,o){var s=void 0!==o,a=s?o:new i(x),c=this._target(),u=c._bitField;s||(a._propagateFrom(this,3),a._captureStackTrace(),void 0===r&&0!==(2097152&this._bitField)&&(r=0!==(50397184&u)?this._boundValue():c===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,a));var l=g();if(0!==(50397184&u)){var p,h,_=c._settlePromiseCtx;0!==(33554432&u)?(h=c._rejectionHandler0,p=t):0!==(16777216&u)?(h=c._fulfillmentHandler0,p=e,c._unsetRejectionIsUnhandled()):(_=c._settlePromiseLateCancellationObserver,h=new F("late cancellation observer"),c._attachExtraTrace(h),p=e),j.invoke(_,c,{handler:f.contextBind(l,p),promise:a,receiver:r,value:h})}else c._addCallbacks(t,e,a,r,l);return a},i.prototype._length=function(){return 65535&this._bitField},i.prototype._isFateSealed=function(){return 0!==(117506048&this._bitField)},i.prototype._isFollowing=function(){return 67108864===(67108864&this._bitField)},i.prototype._setLength=function(t){this._bitField=-65536&this._bitField|65535&t},i.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},i.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},i.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},i.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},i.prototype._isFinal=function(){return(4194304&this._bitField)>0},i.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},i.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},i.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},i.prototype._setAsyncGuaranteed=function(){if(!j.hasCustomScheduler()){var t=this._bitField;this._bitField=t|(536870912&t)>>2^134217728}},i.prototype._setNoAsyncGuarantee=function(){this._bitField=-134217729&(536870912|this._bitField)},i.prototype._receiverAt=function(t){var e=0===t?this._receiver0:this[4*t-4+3];return e===p?void 0:void 0===e&&this._isBound()?this._boundValue():e},i.prototype._promiseAt=function(t){return this[4*t-4+2]},i.prototype._fulfillmentHandlerAt=function(t){return this[4*t-4+0]},i.prototype._rejectionHandlerAt=function(t){return this[4*t-4+1]},i.prototype._boundValue=function(){},i.prototype._migrateCallback0=function(t){var e=(t._bitField,t._fulfillmentHandler0),n=t._rejectionHandler0,r=t._promise0,i=t._receiverAt(0);void 0===i&&(i=p),this._addCallbacks(e,n,r,i,null)},i.prototype._migrateCallbackAt=function(t,e){var n=t._fulfillmentHandlerAt(e),r=t._rejectionHandlerAt(e),i=t._promiseAt(e),o=t._receiverAt(e);void 0===o&&(o=p),this._addCallbacks(n,r,i,o,null)},i.prototype._addCallbacks=function(t,e,n,r,i){var o=this._length();if(o>=65531&&(o=0,this._setLength(0)),0===o)this._promise0=n,this._receiver0=r,"function"==typeof t&&(this._fulfillmentHandler0=f.contextBind(i,t)),"function"==typeof e&&(this._rejectionHandler0=f.contextBind(i,e));else{var s=4*o-4;this[s+2]=n,this[s+3]=r,"function"==typeof t&&(this[s+0]=f.contextBind(i,t)),"function"==typeof e&&(this[s+1]=f.contextBind(i,e))}return this._setLength(o+1),o},i.prototype._proxy=function(t,e){this._addCallbacks(void 0,void 0,e,t,null)},i.prototype._resolveCallback=function(t,e){if(0===(117506048&this._bitField)){if(t===this)return this._rejectCallback(c(),!1);var n=R(t,this);if(!(n instanceof i))return this._fulfill(t);e&&this._propagateFrom(n,2);var r=n._target();if(r===this)return void this._reject(c());var o=r._bitField;if(0===(50397184&o)){var s=this._length();s>0&&r._migrateCallback0(this);for(var a=1;s>a;++a)r._migrateCallbackAt(this,a);this._setFollowing(),this._setLength(0),this._setFollowee(n)}else if(0!==(33554432&o))this._fulfill(r._value());else if(0!==(16777216&o))this._reject(r._reason());else{var u=new F("late cancellation observer");r._attachExtraTrace(u),this._reject(u)}}},i.prototype._rejectCallback=function(t,e,n){var r=f.ensureErrorObject(t),i=r===t;if(!i&&!n&&V.warnings()){var o="a promise was rejected with a non-error: "+f.classString(t);this._warn(o,!0)}this._attachExtraTrace(r,e?i:!1),this._reject(t)},i.prototype._resolveFromExecutor=function(t){if(t!==x){var e=this;this._captureStackTrace(),this._pushContext();var n=!0,r=this._execute(t,function(t){e._resolveCallback(t)},function(t){e._rejectCallback(t,n)});n=!1,this._popContext(),void 0!==r&&e._rejectCallback(r,!0)}},i.prototype._settlePromiseFromHandler=function(t,e,n,r){var i=r._bitField;if(0===(65536&i)){r._pushContext();var o;e===T?n&&"number"==typeof n.length?o=N(t).apply(this._boundValue(),n):(o=L,o.e=new E("cannot .spread() a non-array: "+f.classString(n))):o=N(t).call(e,n);var s=r._popContext();i=r._bitField,0===(65536&i)&&(o===P?r._reject(n):o===L?r._rejectCallback(o.e,!1):(V.checkForgottenReturns(o,s,"",r,this),r._resolveCallback(o)))}},i.prototype._target=function(){for(var t=this;t._isFollowing();)t=t._followee();return t},i.prototype._followee=function(){return this._rejectionHandler0},i.prototype._setFollowee=function(t){this._rejectionHandler0=t},i.prototype._settlePromise=function(t,e,r,o){var s=t instanceof i,a=this._bitField,c=0!==(134217728&a);0!==(65536&a)?(s&&t._invokeInternalOnCancel(),r instanceof H&&r.isFinallyHandler()?(r.cancelPromise=t,N(e).call(r,o)===L&&t._reject(L.e)):e===u?t._fulfill(u.call(r)):r instanceof n?r._promiseCancelled(t):s||t instanceof S?t._cancel():r.cancel()):"function"==typeof e?s?(c&&t._setAsyncGuaranteed(),this._settlePromiseFromHandler(e,r,o,t)):e.call(r,o,t):r instanceof n?r._isResolved()||(0!==(33554432&a)?r._promiseFulfilled(o,t):r._promiseRejected(o,t)):s&&(c&&t._setAsyncGuaranteed(),0!==(33554432&a)?t._fulfill(o):t._reject(o))},i.prototype._settlePromiseLateCancellationObserver=function(t){var e=t.handler,n=t.promise,r=t.receiver,o=t.value;"function"==typeof e?n instanceof i?this._settlePromiseFromHandler(e,r,o,n):e.call(r,o,n):n instanceof i&&n._reject(o)},i.prototype._settlePromiseCtx=function(t){this._settlePromise(t.promise,t.handler,t.receiver,t.value)},i.prototype._settlePromise0=function(t,e,n){var r=this._promise0,i=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(r,t,i,e)},i.prototype._clearCallbackDataAtIndex=function(t){var e=4*t-4;this[e+2]=this[e+3]=this[e+0]=this[e+1]=void 0},i.prototype._fulfill=function(t){var e=this._bitField;if(!((117506048&e)>>>16)){if(t===this){var n=c();return this._attachExtraTrace(n),this._reject(n)}this._setFulfilled(),this._rejectionHandler0=t,(65535&e)>0&&(0!==(134217728&e)?this._settlePromises():j.settlePromises(this),this._dereferenceTrace())}},i.prototype._reject=function(t){var e=this._bitField;if(!((117506048&e)>>>16))return this._setRejected(),this._fulfillmentHandler0=t,this._isFinal()?j.fatalError(t,f.isNode):void((65535&e)>0?j.settlePromises(this):this._ensurePossibleRejectionHandled())},i.prototype._fulfillPromises=function(t,e){for(var n=1;t>n;n++){var r=this._fulfillmentHandlerAt(n),i=this._promiseAt(n),o=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(i,r,o,e)}},i.prototype._rejectPromises=function(t,e){for(var n=1;t>n;n++){var r=this._rejectionHandlerAt(n),i=this._promiseAt(n),o=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(i,r,o,e)}},i.prototype._settlePromises=function(){var t=this._bitField,e=65535&t;if(e>0){if(0!==(16842752&t)){var n=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,n,t),this._rejectPromises(e,n)}else{var r=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,r,t),this._fulfillPromises(e,r)}this._setLength(0)}this._clearCancellationData()},i.prototype._settledValue=function(){var t=this._bitField;return 0!==(33554432&t)?this._rejectionHandler0:0!==(16777216&t)?this._fulfillmentHandler0:void 0},"undefined"!=typeof Symbol&&Symbol.toStringTag&&w.defineProperty(i.prototype,Symbol.toStringTag,{get:function(){return"Object"}}),i.defer=i.pending=function(){V.deprecated("Promise.defer","new Promise");var t=new i(x);return{promise:t,resolve:o,reject:s}},f.notEnumerableProp(i,"_makeSelfResolutionError",c),t("./method")(i,x,R,l,V),t("./bind")(i,x,R,V),t("./cancel")(i,S,l,V),t("./direct_resolve")(i),t("./synchronous_inspection")(i),t("./join")(i,S,R,x,j),i.Promise=i,i.version="3.7.2",t("./call_get.js")(i),t("./generators.js")(i,l,x,R,n,V),t("./map.js")(i,S,l,R,x,V),t("./nodeify.js")(i),t("./promisify.js")(i,x),t("./props.js")(i,S,R,l),t("./race.js")(i,x,R,l),t("./reduce.js")(i,S,l,R,x,V),t("./settle.js")(i,S,V),t("./some.js")(i,S,l),t("./timers.js")(i,x,V),t("./using.js")(i,l,R,A,x,V),t("./any.js")(i),t("./each.js")(i,x),t("./filter.js")(i,x),f.toFastProperties(i),f.toFastProperties(i.prototype),a({a:1}),a({b:2}),a({c:3}),a(1),a(function(){}),a(void 0),a(!1),a(new i(x)),V.setBounds(C.firstLineError,f.lastLineError),i}},{"./any.js":1,"./async":2,"./bind":3,"./call_get.js":5,"./cancel":6,"./catch_filter":7,"./context":8,"./debuggability":9,"./direct_resolve":10,"./each.js":11,"./errors":12,"./es5":13,"./filter.js":14,"./finally":15,"./generators.js":16,"./join":17,"./map.js":18,"./method":19,"./nodeback":20,"./nodeify.js":21,"./promise_array":23,"./promisify.js":24,"./props.js":25,"./race.js":27,"./reduce.js":28,"./settle.js":30,"./some.js":31,"./synchronous_inspection":32,"./thenables":33,"./timers.js":34,"./using.js":35,"./util":36,async_hooks:void 0}],23:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o){function s(t){switch(t){case-2:return[];case-3:return{};case-6:return new Map}}function a(t){var r=this._promise=new e(n);t instanceof e&&(r._propagateFrom(t,3),t.suppressUnhandledRejections()),r._setOnCancel(this),this._values=t,this._length=0,this._totalResolved=0,this._init(void 0,-2)}var c=t("./util");c.isArray;return c.inherits(a,o),a.prototype.length=function(){return this._length},a.prototype.promise=function(){return this._promise},a.prototype._init=function u(t,n){var o=r(this._values,this._promise);if(o instanceof e){o=o._target();var a=o._bitField;if(this._values=o,0===(50397184&a))return this._promise._setAsyncGuaranteed(),o._then(u,this._reject,void 0,this,n);if(0===(33554432&a))return 0!==(16777216&a)?this._reject(o._reason()):this._cancel();o=o._value()}if(o=c.asArray(o),null===o){var l=i("expecting an array or an iterable object but got "+c.classString(o)).reason();return void this._promise._rejectCallback(l,!1)}return 0===o.length?void(-5===n?this._resolveEmptyArray():this._resolve(s(n))):void this._iterate(o)},a.prototype._iterate=function(t){var n=this.getActualLength(t.length);this._length=n,this._values=this.shouldCopyValues()?new Array(n):this._values;for(var i=this._promise,o=!1,s=null,a=0;n>a;++a){var c=r(t[a],i);c instanceof e?(c=c._target(),s=c._bitField):s=null,o?null!==s&&c.suppressUnhandledRejections():null!==s?0===(50397184&s)?(c._proxy(this,a),this._values[a]=c):o=0!==(33554432&s)?this._promiseFulfilled(c._value(),a):0!==(16777216&s)?this._promiseRejected(c._reason(),a):this._promiseCancelled(a):o=this._promiseFulfilled(c,a)}o||i._setAsyncGuaranteed()},a.prototype._isResolved=function(){return null===this._values},a.prototype._resolve=function(t){this._values=null,this._promise._fulfill(t)},a.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},a.prototype._reject=function(t){this._values=null,this._promise._rejectCallback(t,!1)},a.prototype._promiseFulfilled=function(t,e){this._values[e]=t;var n=++this._totalResolved;return n>=this._length?(this._resolve(this._values),!0):!1},a.prototype._promiseCancelled=function(){return this._cancel(),!0},a.prototype._promiseRejected=function(t){return this._totalResolved++,this._reject(t),!0},a.prototype._resultCancelled=function(){if(!this._isResolved()){var t=this._values;if(this._cancel(),t instanceof e)t.cancel();else for(var n=0;n<t.length;++n)t[n]instanceof e&&t[n].cancel()}},a.prototype.shouldCopyValues=function(){return!0},a.prototype.getActualLength=function(t){return t},a}},{"./util":36}],24:[function(t,e,n){"use strict";e.exports=function(e,n){function r(t){return!C.test(t)}function i(t){try{return t.__isPromisified__===!0}catch(e){return!1}}function o(t,e,n){var r=h.getDataPropertyOrDefault(t,e+n,b);return r?i(r):!1}function s(t,e,n){for(var r=0;r<t.length;r+=2){var i=t[r];if(n.test(i))for(var o=i.replace(n,""),s=0;s<t.length;s+=2)if(t[s]===o)throw new g("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",e))}}function a(t,e,n,r){for(var a=h.inheritedDataKeys(t),c=[],u=0;u<a.length;++u){var l=a[u],p=t[l],f=r===j?!0:j(l,p,t);"function"!=typeof p||i(p)||o(t,l,e)||!r(l,p,t,f)||c.push(l,p)}return s(c,e,n),c}function c(t,r,i,o,s,a){function c(){var i=r;r===f&&(i=this);var o=new e(n);o._captureStackTrace();var s="string"==typeof l&&this!==u?this[l]:t,c=_(o,a);try{s.apply(i,d(arguments,c))}catch(p){o._rejectCallback(v(p),!0,!0)}return o._isFateSealed()||o._setAsyncGuaranteed(),o}var u=function(){return this}(),l=t;return"string"==typeof l&&(t=o),h.notEnumerableProp(c,"__isPromisified__",!0),c}function u(t,e,n,r,i){for(var o=new RegExp(k(e)+"$"),s=a(t,e,o,n),c=0,u=s.length;u>c;c+=2){var l=s[c],p=s[c+1],_=l+e;if(r===E)t[_]=E(l,f,l,p,e,i);else{var d=r(p,function(){return E(l,f,l,p,e,i)});h.notEnumerableProp(d,"__isPromisified__",!0),t[_]=d}}return h.toFastProperties(t),t}function l(t,e,n){return E(t,e,void 0,t,null,n)}var p,f={},h=t("./util"),_=t("./nodeback"),d=h.withAppended,v=h.maybeWrapAsError,y=h.canEvaluate,g=t("./errors").TypeError,m="Async",b={__isPromisified__:!0},w=["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"],C=new RegExp("^(?:"+w.join("|")+")$"),j=function(t){return h.isIdentifier(t)&&"_"!==t.charAt(0)&&"constructor"!==t},k=function(t){return t.replace(/([$])/,"\\$")},E=y?p:c;e.promisify=function(t,e){if("function"!=typeof t)throw new g("expecting a function but got "+h.classString(t));if(i(t))return t;e=Object(e);var n=void 0===e.context?f:e.context,o=!!e.multiArgs,s=l(t,n,o);return h.copyDescriptors(t,s,r),s},e.promisifyAll=function(t,e){if("function"!=typeof t&&"object"!=typeof t)throw new g("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");e=Object(e);var n=!!e.multiArgs,r=e.suffix;"string"!=typeof r&&(r=m);var i=e.filter;"function"!=typeof i&&(i=j);var o=e.promisifier;if("function"!=typeof o&&(o=E),!h.isIdentifier(r))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var s=h.inheritedDataKeys(t),a=0;a<s.length;++a){var c=t[s[a]];"constructor"!==s[a]&&h.isClass(c)&&(u(c.prototype,r,i,o,n),u(c,r,i,o,n))}return u(t,r,i,o,n)}}},{"./errors":12,"./nodeback":20,"./util":36}],25:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){function o(t){var e,n=!1;if(void 0!==a&&t instanceof a)e=p(t),n=!0;else{var r=l.keys(t),i=r.length;e=new Array(2*i);for(var o=0;i>o;++o){var s=r[o];e[o]=t[s],e[o+i]=s}}this.constructor$(e),this._isMap=n,this._init$(void 0,n?-6:-3)}function s(t){var n,s=r(t);return u(s)?(n=s instanceof e?s._then(e.props,void 0,void 0,void 0,void 0):new o(s).promise(),s instanceof e&&n._propagateFrom(s,2),n):i("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}var a,c=t("./util"),u=c.isObject,l=t("./es5");"function"==typeof Map&&(a=Map);var p=function(){function t(t,r){this[e]=t,this[e+n]=r,e++}var e=0,n=0;return function(r){n=r.size,e=0;var i=new Array(2*r.size);return r.forEach(t,i),i}}(),f=function(t){for(var e=new a,n=t.length/2|0,r=0;n>r;++r){var i=t[n+r],o=t[r];e.set(i,o)}return e};c.inherits(o,n),o.prototype._init=function(){},o.prototype._promiseFulfilled=function(t,e){this._values[e]=t;var n=++this._totalResolved;if(n>=this._length){var r;if(this._isMap)r=f(this._values);else{r={};for(var i=this.length(),o=0,s=this.length();s>o;++o)r[this._values[o+i]]=this._values[o]}return this._resolve(r),!0}return!1},o.prototype.shouldCopyValues=function(){return!1},o.prototype.getActualLength=function(t){return t>>1},e.prototype.props=function(){return s(this)},e.props=function(t){return s(t)}}},{"./es5":13,"./util":36}],26:[function(t,e,n){"use strict";function r(t,e,n,r,i){for(var o=0;i>o;++o)n[o+r]=t[o+e],t[o+e]=void 0}function i(t){this._capacity=t,this._length=0,this._front=0}i.prototype._willBeOverCapacity=function(t){return this._capacity<t},i.prototype._pushOne=function(t){var e=this.length();this._checkCapacity(e+1);var n=this._front+e&this._capacity-1;this[n]=t,this._length=e+1},i.prototype.push=function(t,e,n){var r=this.length()+3;if(this._willBeOverCapacity(r))return this._pushOne(t),this._pushOne(e),void this._pushOne(n);var i=this._front+r-3;this._checkCapacity(r);var o=this._capacity-1;this[i+0&o]=t,this[i+1&o]=e,this[i+2&o]=n,this._length=r},i.prototype.shift=function(){var t=this._front,e=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,e},i.prototype.length=function(){return this._length},i.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<1)},i.prototype._resizeTo=function(t){var e=this._capacity;this._capacity=t;var n=this._front,i=this._length,o=n+i&e-1;r(this,0,this,e,o)},e.exports=i},{}],27:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){function o(t,o){var c=r(t);if(c instanceof e)return a(c);if(t=s.asArray(t),null===t)return i("expecting an array or an iterable object but got "+s.classString(t));var u=new e(n);void 0!==o&&u._propagateFrom(o,3);for(var l=u._fulfill,p=u._reject,f=0,h=t.length;h>f;++f){var _=t[f];(void 0!==_||f in t)&&e.cast(_)._then(l,p,void 0,u,null)}return u}var s=t("./util"),a=function(t){return t.then(function(e){return o(e,t)})};e.race=function(t){return o(t,void 0)},e.prototype.race=function(){return o(this,void 0)}}},{"./util":36}],28:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,s){function a(t,n,r,i){this.constructor$(t);var s=e._getContext();this._fn=f.contextBind(s,n),void 0!==r&&(r=e.resolve(r),r._attachCancellationCallback(this)),this._initialValue=r,this._currentCancellable=null,i===o?this._eachValues=Array(this._length):0===i?this._eachValues=null:this._eachValues=void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function c(t,e){this.isFulfilled()?e._resolve(t):e._reject(t)}function u(t,e,n,i){if("function"!=typeof e)return r("expecting a function but got "+f.classString(e));var o=new a(t,e,n,i);return o.promise()}function l(t){this.accum=t,this.array._gotAccum(t);var n=i(this.value,this.array._promise);return n instanceof e?(this.array._currentCancellable=n,n._then(p,void 0,void 0,this,void 0)):p.call(this,n)}function p(t){var n=this.array,r=n._promise,i=h(n._fn);r._pushContext();var o;o=void 0!==n._eachValues?i.call(r._boundValue(),t,this.index,this.length):i.call(r._boundValue(),this.accum,t,this.index,this.length),o instanceof e&&(n._currentCancellable=o);var a=r._popContext();return s.checkForgottenReturns(o,a,void 0!==n._eachValues?"Promise.each":"Promise.reduce",r),o}var f=t("./util"),h=f.tryCatch;f.inherits(a,n),a.prototype._gotAccum=function(t){void 0!==this._eachValues&&null!==this._eachValues&&t!==o&&this._eachValues.push(t)},a.prototype._eachComplete=function(t){return null!==this._eachValues&&this._eachValues.push(t),this._eachValues},a.prototype._init=function(){},a.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},a.prototype.shouldCopyValues=function(){return!1},a.prototype._resolve=function(t){this._promise._resolveCallback(t),this._values=null},a.prototype._resultCancelled=function(t){return t===this._initialValue?this._cancel():void(this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof e&&this._currentCancellable.cancel(),this._initialValue instanceof e&&this._initialValue.cancel()))},a.prototype._iterate=function(t){this._values=t;var n,r,i=t.length;void 0!==this._initialValue?(n=this._initialValue,r=0):(n=e.resolve(t[0]),r=1),this._currentCancellable=n;for(var o=r;i>o;++o){var s=t[o];s instanceof e&&s.suppressUnhandledRejections()}if(!n.isRejected())for(;i>r;++r){var a={accum:null,value:t[r],index:r,length:i,array:this};n=n._then(l,void 0,void 0,a,void 0),0===(127&r)&&n._setNoAsyncGuarantee()}void 0!==this._eachValues&&(n=n._then(this._eachComplete,void 0,void 0,this,void 0)),n._then(c,c,void 0,n,this)},e.prototype.reduce=function(t,e){return u(this,t,e,null)},e.reduce=function(t,e,n,r){return u(t,e,n,r)}}},{"./util":36}],29:[function(t,e,n){"use strict";var r,i=t("./util"),o=function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")},s=i.getNativePromise();if(i.isNode&&"undefined"==typeof MutationObserver){var a=global.setImmediate,c=process.nextTick;r=i.isRecentNode?function(t){a.call(global,t)}:function(t){c.call(process,t)}}else if("function"==typeof s&&"function"==typeof s.resolve){
var u=s.resolve();r=function(t){u.then(t)}}else r="undefined"!=typeof MutationObserver&&("undefined"==typeof window||!window.navigator||!window.navigator.standalone&&!window.cordova)&&"classList"in document.documentElement?function(){var t=document.createElement("div"),e={attributes:!0},n=!1,r=document.createElement("div"),i=new MutationObserver(function(){t.classList.toggle("foo"),n=!1});i.observe(r,e);var o=function(){n||(n=!0,r.classList.toggle("foo"))};return function(n){var r=new MutationObserver(function(){r.disconnect(),n()});r.observe(t,e),o()}}():"undefined"!=typeof setImmediate?function(t){setImmediate(t)}:"undefined"!=typeof setTimeout?function(t){setTimeout(t,0)}:o;e.exports=r},{"./util":36}],30:[function(t,e,n){"use strict";e.exports=function(e,n,r){function i(t){this.constructor$(t)}var o=e.PromiseInspection,s=t("./util");s.inherits(i,n),i.prototype._promiseResolved=function(t,e){this._values[t]=e;var n=++this._totalResolved;return n>=this._length?(this._resolve(this._values),!0):!1},i.prototype._promiseFulfilled=function(t,e){var n=new o;return n._bitField=33554432,n._settledValueField=t,this._promiseResolved(e,n)},i.prototype._promiseRejected=function(t,e){var n=new o;return n._bitField=16777216,n._settledValueField=t,this._promiseResolved(e,n)},e.settle=function(t){return r.deprecated(".settle()",".reflect()"),new i(t).promise()},e.allSettled=function(t){return new i(t).promise()},e.prototype.settle=function(){return e.settle(this)}}},{"./util":36}],31:[function(t,e,n){"use strict";e.exports=function(e,n,r){function i(t){this.constructor$(t),this._howMany=0,this._unwrap=!1,this._initialized=!1}function o(t,e){if((0|e)!==e||0>e)return r("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var n=new i(t),o=n.promise();return n.setHowMany(e),n.init(),o}var s=t("./util"),a=t("./errors").RangeError,c=t("./errors").AggregateError,u=s.isArray,l={};s.inherits(i,n),i.prototype._init=function(){if(this._initialized){if(0===this._howMany)return void this._resolve([]);this._init$(void 0,-5);var t=u(this._values);!this._isResolved()&&t&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}},i.prototype.init=function(){this._initialized=!0,this._init()},i.prototype.setUnwrap=function(){this._unwrap=!0},i.prototype.howMany=function(){return this._howMany},i.prototype.setHowMany=function(t){this._howMany=t},i.prototype._promiseFulfilled=function(t){return this._addFulfilled(t),this._fulfilled()===this.howMany()?(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0):!1},i.prototype._promiseRejected=function(t){return this._addRejected(t),this._checkOutcome()},i.prototype._promiseCancelled=function(){return this._values instanceof e||null==this._values?this._cancel():(this._addRejected(l),this._checkOutcome())},i.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var t=new c,e=this.length();e<this._values.length;++e)this._values[e]!==l&&t.push(this._values[e]);return t.length>0?this._reject(t):this._cancel(),!0}return!1},i.prototype._fulfilled=function(){return this._totalResolved},i.prototype._rejected=function(){return this._values.length-this.length()},i.prototype._addRejected=function(t){this._values.push(t)},i.prototype._addFulfilled=function(t){this._values[this._totalResolved++]=t},i.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},i.prototype._getRangeError=function(t){var e="Input array must contain at least "+this._howMany+" items but contains only "+t+" items";return new a(e)},i.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},e.some=function(t,e){return o(t,e)},e.prototype.some=function(t){return o(this,t)},e._SomePromiseArray=i}},{"./errors":12,"./util":36}],32:[function(t,e,n){"use strict";e.exports=function(t){function e(t){void 0!==t?(t=t._target(),this._bitField=t._bitField,this._settledValueField=t._isFateSealed()?t._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}e.prototype._settledValue=function(){return this._settledValueField};var n=e.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},r=e.prototype.error=e.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},i=e.prototype.isFulfilled=function(){return 0!==(33554432&this._bitField)},o=e.prototype.isRejected=function(){return 0!==(16777216&this._bitField)},s=e.prototype.isPending=function(){return 0===(50397184&this._bitField)},a=e.prototype.isResolved=function(){return 0!==(50331648&this._bitField)};e.prototype.isCancelled=function(){return 0!==(8454144&this._bitField)},t.prototype.__isCancelled=function(){return 65536===(65536&this._bitField)},t.prototype._isCancelled=function(){return this._target().__isCancelled()},t.prototype.isCancelled=function(){return 0!==(8454144&this._target()._bitField)},t.prototype.isPending=function(){return s.call(this._target())},t.prototype.isRejected=function(){return o.call(this._target())},t.prototype.isFulfilled=function(){return i.call(this._target())},t.prototype.isResolved=function(){return a.call(this._target())},t.prototype.value=function(){return n.call(this._target())},t.prototype.reason=function(){var t=this._target();return t._unsetRejectionIsUnhandled(),r.call(t)},t.prototype._value=function(){return this._settledValue()},t.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},t.PromiseInspection=e}},{}],33:[function(t,e,n){"use strict";e.exports=function(e,n){function r(t,r){if(l(t)){if(t instanceof e)return t;var i=o(t);if(i===u){r&&r._pushContext();var c=e.reject(i.e);return r&&r._popContext(),c}if("function"==typeof i){if(s(t)){var c=new e(n);return t._then(c._fulfill,c._reject,void 0,c,null),c}return a(t,i,r)}}return t}function i(t){return t.then}function o(t){try{return i(t)}catch(e){return u.e=e,u}}function s(t){try{return p.call(t,"_promise0")}catch(e){return!1}}function a(t,r,i){function o(t){a&&(a._resolveCallback(t),a=null)}function s(t){a&&(a._rejectCallback(t,p,!0),a=null)}var a=new e(n),l=a;i&&i._pushContext(),a._captureStackTrace(),i&&i._popContext();var p=!0,f=c.tryCatch(r).call(t,o,s);return p=!1,a&&f===u&&(a._rejectCallback(f.e,!0,!0),a=null),l}var c=t("./util"),u=c.errorObj,l=c.isObject,p={}.hasOwnProperty;return r}},{"./util":36}],34:[function(t,e,n){"use strict";e.exports=function(e,n,r){function i(t){this.handle=t}function o(t){return clearTimeout(this.handle),t}function s(t){throw clearTimeout(this.handle),t}var a=t("./util"),c=e.TimeoutError;i.prototype._resultCancelled=function(){clearTimeout(this.handle)};var u=function(t){return l(+this).thenReturn(t)},l=e.delay=function(t,o){var s,a;return void 0!==o?(s=e.resolve(o)._then(u,null,null,t,void 0),r.cancellation()&&o instanceof e&&s._setOnCancel(o)):(s=new e(n),a=setTimeout(function(){s._fulfill()},+t),r.cancellation()&&s._setOnCancel(new i(a)),s._captureStackTrace()),s._setAsyncGuaranteed(),s};e.prototype.delay=function(t){return l(t,this)};var p=function(t,e,n){var r;r="string"!=typeof e?e instanceof Error?e:new c("operation timed out"):new c(e),a.markAsOriginatingFromRejection(r),t._attachExtraTrace(r),t._reject(r),null!=n&&n.cancel()};e.prototype.timeout=function(t,e){t=+t;var n,a,c=new i(setTimeout(function(){n.isPending()&&p(n,e,a)},t));return r.cancellation()?(a=this.then(),n=a._then(o,s,void 0,c,void 0),n._setOnCancel(c)):n=this._then(o,s,void 0,c,void 0),n}}},{"./util":36}],35:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,s){function a(t){setTimeout(function(){throw t},0)}function c(t){var e=r(t);return e!==t&&"function"==typeof t._isDisposable&&"function"==typeof t._getDisposer&&t._isDisposable()&&e._setDisposable(t._getDisposer()),e}function u(t,n){function i(){if(s>=u)return l._fulfill();var o=c(t[s++]);if(o instanceof e&&o._isDisposable()){try{o=r(o._getDisposer().tryDispose(n),t.promise)}catch(p){return a(p)}if(o instanceof e)return o._then(i,a,null,null,null)}i()}var s=0,u=t.length,l=new e(o);return i(),l}function l(t,e,n){this._data=t,this._promise=e,this._context=n}function p(t,e,n){this.constructor$(t,e,n)}function f(t){return l.isDisposer(t)?(this.resources[this.index]._setDisposable(t),t.promise()):t}function h(t){this.length=t,this.promise=null,this[t-1]=null}var _=t("./util"),d=t("./errors").TypeError,v=t("./util").inherits,y=_.errorObj,g=_.tryCatch,m={};l.prototype.data=function(){return this._data},l.prototype.promise=function(){return this._promise},l.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():m},l.prototype.tryDispose=function(t){var e=this.resource(),n=this._context;void 0!==n&&n._pushContext();var r=e!==m?this.doDispose(e,t):null;return void 0!==n&&n._popContext(),this._promise._unsetDisposable(),this._data=null,r},l.isDisposer=function(t){return null!=t&&"function"==typeof t.resource&&"function"==typeof t.tryDispose},v(p,l),p.prototype.doDispose=function(t,e){var n=this.data();return n.call(t,t,e)},h.prototype._resultCancelled=function(){for(var t=this.length,n=0;t>n;++n){var r=this[n];r instanceof e&&r.cancel()}},e.using=function(){var t=arguments.length;if(2>t)return n("you must pass at least 2 arguments to Promise.using");var i=arguments[t-1];if("function"!=typeof i)return n("expecting a function but got "+_.classString(i));var o,a=!0;2===t&&Array.isArray(arguments[0])?(o=arguments[0],t=o.length,a=!1):(o=arguments,t--);for(var c=new h(t),p=0;t>p;++p){var d=o[p];if(l.isDisposer(d)){var v=d;d=d.promise(),d._setDisposable(v)}else{var m=r(d);m instanceof e&&(d=m._then(f,null,null,{resources:c,index:p},void 0))}c[p]=d}for(var b=new Array(c.length),p=0;p<b.length;++p)b[p]=e.resolve(c[p]).reflect();var w=e.all(b).then(function(t){for(var e=0;e<t.length;++e){var n=t[e];if(n.isRejected())return y.e=n.error(),y;if(!n.isFulfilled())return void w.cancel();t[e]=n.value()}C._pushContext(),i=g(i);var r=a?i.apply(void 0,t):i(t),o=C._popContext();return s.checkForgottenReturns(r,o,"Promise.using",C),r}),C=w.lastly(function(){var t=new e.PromiseInspection(w);return u(c,t)});return c.promise=C,C._setOnCancel(c),C},e.prototype._setDisposable=function(t){this._bitField=131072|this._bitField,this._disposer=t},e.prototype._isDisposable=function(){return(131072&this._bitField)>0},e.prototype._getDisposer=function(){return this._disposer},e.prototype._unsetDisposable=function(){this._bitField=-131073&this._bitField,this._disposer=void 0},e.prototype.disposer=function(t){if("function"==typeof t)return new p(t,this,i());throw new d}}},{"./errors":12,"./util":36}],36:[function(t,e,n){"use strict";function r(){try{var t=P;return P=null,t.apply(this,arguments)}catch(e){return T.e=e,T}}function i(t){return P=t,r}function o(t){return null==t||t===!0||t===!1||"string"==typeof t||"number"==typeof t}function s(t){return"function"==typeof t||"object"==typeof t&&null!==t}function a(t){return o(t)?new Error(v(t)):t}function c(t,e){var n,r=t.length,i=new Array(r+1);for(n=0;r>n;++n)i[n]=t[n];return i[n]=e,i}function u(t,e,n){if(!F.isES5)return{}.hasOwnProperty.call(t,e)?t[e]:void 0;var r=Object.getOwnPropertyDescriptor(t,e);return null!=r?null==r.get&&null==r.set?r.value:n:void 0}function l(t,e,n){if(o(t))return t;var r={value:n,configurable:!0,enumerable:!1,writable:!0};return F.defineProperty(t,e,r),t}function p(t){throw t}function f(t){try{if("function"==typeof t){var e=F.names(t.prototype),n=F.isES5&&e.length>1,r=e.length>0&&!(1===e.length&&"constructor"===e[0]),i=A.test(t+"")&&F.names(t).length>0;if(n||r||i)return!0}return!1}catch(o){return!1}}function h(t){function e(){}function n(){return typeof r.foo}e.prototype=t;var r=new e;return n(),n(),t}function _(t){return V.test(t)}function d(t,e,n){for(var r=new Array(t),i=0;t>i;++i)r[i]=e+i+n;return r}function v(t){try{return t+""}catch(e){return"[no string representation]"}}function y(t){return t instanceof Error||null!==t&&"object"==typeof t&&"string"==typeof t.message&&"string"==typeof t.name}function g(t){try{l(t,"isOperational",!0)}catch(e){}}function m(t){return null==t?!1:t instanceof Error.__BluebirdErrorTypes__.OperationalError||t.isOperational===!0}function b(t){return y(t)&&F.propertyIsWritable(t,"stack")}function w(t){return{}.toString.call(t)}function C(t,e,n){for(var r=F.names(t),i=0;i<r.length;++i){var o=r[i];if(n(o))try{F.defineProperty(e,o,F.getDescriptor(t,o))}catch(s){}}}function j(t){return N?process.env[t]:void 0}function k(){if("function"==typeof Promise)try{var t=new Promise(function(){});if("[object Promise]"===w(t))return Promise}catch(e){}}function E(t,e){if(null===t||"function"!=typeof e||e===U)return e;null!==t.domain&&(e=t.domain.bind(e));var n=t.async;if(null!==n){var r=e;e=function(){var t=new Array(2).concat([].slice.call(arguments));return t[0]=r,t[1]=this,n.runInAsyncScope.apply(n,t)}}return e}var F=t("./es5"),x="undefined"==typeof navigator,T={e:{}},P,R="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0!==this?this:null,S=function(t,e){function n(){this.constructor=t,this.constructor$=e;for(var n in e.prototype)r.call(e.prototype,n)&&"$"!==n.charAt(n.length-1)&&(this[n+"$"]=e.prototype[n])}var r={}.hasOwnProperty;return n.prototype=e.prototype,t.prototype=new n,t.prototype},O=function(){var t=[Array.prototype,Object.prototype,Function.prototype],e=function(e){for(var n=0;n<t.length;++n)if(t[n]===e)return!0;return!1};if(F.isES5){var n=Object.getOwnPropertyNames;return function(t){for(var r=[],i=Object.create(null);null!=t&&!e(t);){var o;try{o=n(t)}catch(s){return r}for(var a=0;a<o.length;++a){var c=o[a];if(!i[c]){i[c]=!0;var u=Object.getOwnPropertyDescriptor(t,c);null!=u&&null==u.get&&null==u.set&&r.push(c)}}t=F.getPrototypeOf(t)}return r}}var r={}.hasOwnProperty;return function(n){if(e(n))return[];var i=[];t:for(var o in n)if(r.call(n,o))i.push(o);else{for(var s=0;s<t.length;++s)if(r.call(t[s],o))continue t;i.push(o)}return i}}(),A=/this\s*\.\s*\S+\s*=/,V=/^[a-z$_][a-z$_0-9]*$/i,H=function(){return"stack"in new Error?function(t){return b(t)?t:new Error(v(t))}:function(t){if(b(t))return t;try{throw new Error(v(t))}catch(e){return e}}}(),D=function(t){return F.isArray(t)?t:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var I="function"==typeof Array.from?function(t){return Array.from(t)}:function(t){for(var e,n=[],r=t[Symbol.iterator]();!(e=r.next()).done;)n.push(e.value);return n};D=function(t){return F.isArray(t)?t:null!=t&&"function"==typeof t[Symbol.iterator]?I(t):null}}var L="undefined"!=typeof process&&"[object process]"===w(process).toLowerCase(),N="undefined"!=typeof process&&"undefined"!=typeof process.env,U,B={setReflectHandler:function(t){U=t},isClass:f,isIdentifier:_,inheritedDataKeys:O,getDataPropertyOrDefault:u,thrower:p,isArray:F.isArray,asArray:D,notEnumerableProp:l,isPrimitive:o,isObject:s,isError:y,canEvaluate:x,errorObj:T,tryCatch:i,inherits:S,withAppended:c,maybeWrapAsError:a,toFastProperties:h,filledRange:d,toString:v,canAttachTrace:b,ensureErrorObject:H,originatesFromRejection:m,markAsOriginatingFromRejection:g,classString:w,copyDescriptors:C,isNode:L,hasEnvVariables:N,env:j,global:R,getNativePromise:k,contextBind:E};B.isRecentNode=B.isNode&&function(){var t;return process.versions&&process.versions.node?t=process.versions.node.split(".").map(Number):process.version&&(t=process.version.split(".").map(Number)),0===t[0]&&t[1]>10||t[0]>0}(),B.nodeSupportsAsyncResource=B.isNode&&function(){var e=!1;try{var n=t("async_hooks").AsyncResource;e="function"==typeof n.prototype.runInAsyncScope}catch(r){e=!1}return e}(),B.isNode&&B.toFastProperties(process);try{throw new Error}catch(M){B.lastLineError=M}e.exports=B},{"./es5":13,async_hooks:void 0}]},{},[4])(4)}),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise);
}
!function(){"use strict";var e,t=globalThis.Dynamsoft;function n(t){return t===e}function r(t){return t!==e}function i(e){return null===e}var o={"[object Function]":"function","[object String]":"string","[object Object]":"object","[object Boolean]":"boolean","[object Number]":"number","[object Array]":"array"};function s(e){return i(e)||n(e)?String(e):o[{}.toString.call(e)]||"object"}function a(e){return"function"===s(e)}function c(e){return"string"===s(e)}function l(e){return"object"===s(e)}function u(e){return"boolean"===s(e)}function A(e){return"number"===s(e)}function f(e){return Array.isArray?Array.isArray(e):"array"===s(e)}var h=!0,d=!1;function p(e,t,r){if(e){var i=void 0,o=void 0,s=void 0,c=0,l=e.length;if(r=r||null,n(l)||a(e))for(s=Object.keys(e);c<s.length&&(i=s[c],t.call(r,e[i],i,e)!==d);c++);else for(o=e[0];c<l&&t.call(r,o,c,e)!==d;o=e[++c]);}return e}var g={}.hasOwnProperty;function y(e){if(!e||"object"!==s(e)||e.nodeType||e.window==e)return d;var t,r;try{if((r=e.constructor)&&!g(e,"constructor")&&!g(r.prototype,"isPrototypeOf"))return d}catch(i){return d}for(t in e);return n(t)||g(e,t)}var m="object"==typeof HTMLElement;function C(e){return m?e instanceof HTMLElement:e&&"object"==typeof e&&(1===e.nodeType||9===e.nodeType)&&"string"==typeof e.nodeName}function b(e){var t=e;if(C(e))for(;!t&&t!=document.body;)t=t.parentNode;else t=0;return!!t}var w="",v=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,P=String.prototype,I=P.trim;function E(e,t){return 0===e.lastIndexOf(t,0)}function S(e,t){var n=e.length-t.length;return n>=0&&e.indexOf(t,n)===n}function B(e){return null==e?w:I.call(e)}function x(e){if(null==e)return[];if(f(e))return e;var t=typeof e.length,n=typeof e;if("number"!==t||e.alert||"string"===n||"function"===n&&(!("item"in e)||"number"!==t))return[e];for(var r=[],i=0,o=e.length;i<o;i++)r[i]=e[i];return r}I||(I=P.trim=function(){return this.replace(v,w)});var k=t.Lib,z=k.bNode,Q=k.Promise||(z?global.Promise:window.Promise);function L(){if(t.navInfo)return Q.resolve(t.navInfo);var e,n,r=k.bNode||t.navInfoSync.bJSDom?undefined:navigator;if(r&&"userAgentData"in r){var i=navigator.userAgentData;if(i.platform&&""!=i.platform){var o=[];if("brands"in i&&k.isArray(i.brands)&&i.brands.length>0?o=i.brands:"uaList"in i&&k.isArray(i.uaList)&&i.uaList.length>0&&(o=i.uaList),o.length>0)return(n=function(e){var n=t.navInfoSync,r=e.architecture.toLowerCase(),i="64"==e.bitness,o=r.indexOf("arm")>-1,s=r.indexOf("mips")>-1;return{bUseUserAgent:!1,bWin:n.bWin,bMac:n.bMac,bLinux:n.bLinux,bAndroid:n.bAndroid,bMobile:n.bMobile,bPad:n.bPad,bChromeOS:n.bChromeOS,bHarmonyOS:n.bHarmonyOS,bArm64:o,bMips64:s,bEmbed:o||s,bOSx64:i,bIE:!1,bEdge:n.bEdge,bChrome:n.bChrome,bFirefox:n.bFirefox,bSafari:n.bSafari,bOpera:n.bOpera,bGecko:!0,bHuaWeiBrowser:!1,bHTML5Edition:!0,strBrowserVersion:n.strBrowserVersion,IEMode:0}},e?Q.resolve((function(){return n(e)})):navigator.userAgentData.getHighEntropyValues(["platform","platformVersion","architecture","bitness"]).then(n)).then((function(e){return t.navInfo=e,e}))}}return t.navInfo=t.navInfoSync,Q.resolve(t.navInfo)}function F(e){var n,r;if(!t.Lib.bNode&&!t.navInfoSync.bJSDom){var i=t.Lib.doc;if(i&&c(r=e.body)&&r!=w){(n=i.createElement("script")).charset="utf-8",t.navInfoSync.bIE?n.text=r:n.appendChild(i.createTextNode(r)),e.language?n.language=e.language:n.language="javascript",e.type?n.type=e.type:n.type="text/javascript";var o=i&&i.documentElement,s=i.getElementsByTagName("head")[0]||o;s.insertBefore(n,s.firstChild)}}}function T(e){F({body:e})}function D(e){F({body:e,language:"vbscript",type:"text/vbscript"})}function M(e){var t=e?new Date(e):new Date,n="yyyy-MM-dd HH:mm:ss.SSSZ",r={"M+":t.getUTCMonth()+1,"d+":t.getUTCDate(),"H+":t.getUTCHours(),"h+":t.getUTCHours()%12||12,"m+":t.getUTCMinutes(),"s+":t.getUTCSeconds(),"q+":Math.floor((t.getUTCMonth()+3)/3),"S+":t.getUTCMilliseconds()};for(var i in/(y+)/.test(n)&&(n=n.replace(RegExp.$1,(t.getUTCFullYear()+"").substr(4-RegExp.$1.length))),r)new RegExp("("+i+")").test(n)&&(n=n.replace(RegExp.$1,1==RegExp.$1.length?r[i]:("000"+r[i]).substr(("000"+r[i]).length-RegExp.$1.length)));return n}var j,R,N=t.Lib,H=N.win;function U(e,t,n,r){if(N.debug&&R&&a(R.log)){var i=M((new Date).getTime()),o=x(arguments);R.log(["[",i,"] ",o].join(""))}}function J(e,t,n,r){if((N.debug||N.showConsoleError)&&R&&a(R.error)){var i=M((new Date).getTime()),o=x(arguments);R.error(["[",i,"] ",o].join(""))}}function K(e,t,n,r){if(N.debug&&R&&a(R.warn)){var i=M((new Date).getTime()),o=x(arguments);R.warn(["[",i,"] ",o].join(""))}}function O(e,t,n,r){if(N.debug&&R&&a(R.info)){var i=M((new Date).getTime()),o=x(arguments);R.info(["[",i,"] ",o].join(""))}}H&&r(H.console)&&(a((R=H.console).log)&&a(R.error)?j={log:U,error:J,info:O,warn:K,debug:function(e,t,n,r){if(N.debug&&R&&a(R.debug)){var i=M((new Date).getTime()),o=x(arguments);R.debug(["[",i,"] ",o].join(""))}}}:(R=!1,j=!1)),N.showConsoleError=!1;var Y,G=undefined,W=function(e){return"function"==typeof e},Z=function(e){return Array.isArray?Array.isArray(e):e instanceof Array},V=function(e){return!1===e||e===G||null===e},q="undefined",X=typeof TypeError===q?Error:TypeError;if(typeof process!==q&&process.nextTick)Y=process.nextTick;else if(typeof MessageChannel!==q){var _=new MessageChannel,$=[];_.port1.onmessage=function(){$.length&&$.shift()()},Y=function(e){$.push(e),_.port2.postMessage(0)}}else Y=function(e){setTimeout(e,0)};function ee(e){Y((function(){throw e}))}function te(e){return this.then(e,G)}function ne(e){return this.then(G,e)}function re(e,t){return this.then((function(t){return W(e)?e.apply(null,Z(t)?t:[t]):ae.onlyFuncs?t:e}),t||G)}function ie(e){function t(){e()}return this.then(t,t),this}function oe(e){return this.then((function(t){return W(e)?e.apply(null,Z(t)?t.splice(0,0,undefined)&&t:[undefined,t]):ae.onlyFuncs?t:e}),(function(t){return e(t)}))}function se(e){return this.then(G,e?function(t){throw e(t),t}:ee)}var ae=function(){function e(t){this.alwaysAsyncFn=null,this.status=0,this.pendings=[],this.promise={then:function(t,n){var r=new e;return this.pendings.push([function(n){try{V(t)?r.resolve(n):r.resolve(W(t)?t(n):e.onlyFuncs?n:t)}catch(i){r.reject(i)}},function(t){if((V(n)||!W(n)&&e.onlyFuncs)&&r.reject(t),n)try{r.resolve(W(n)?n(t):n)}catch(i){r.reject(i)}}]),0!==this.status&&this.alwaysAsyncFn(this.execCallbacks),r.promise},success:te,error:ne,otherwise:ne,apply:re,spread:re,ensure:ie,nodify:oe,rethrow:se,isPending:function(){return 0===this.status},getStatus:function(){return this.status}},this.alwaysAsyncFn=(G!==t?t:e.alwaysAsync)?Y:function(e){e()},this.promise.toSource=this.promise.toString=this.promise.valueOf=function(){return this.value===undefined?this:this.value}}return e.prototype.resolve=function(e){var t,n=!1;function r(e){return function(t){return n?undefined:(n=!0,e(t))}}if(this.status)return this;try{var i=!(!(t=e)||!(typeof t).match(/function|object/))&&e.then;if(W(i)){if(e===this.promise)throw new X("Promise can't resolve itself");return i.call(e,r(this.resolve),r(this.reject)),this}}catch(o){return r(this.reject)(o),this}return this.alwaysAsyncFn((function(){this.value=e,this.status=1,this.execCallbacks()})),this},e.prototype.reject=function(e){return this.status||this.alwaysAsyncFn((function(){try{throw e}catch(t){this.value=t}this.status=-1,this.execCallbacks()})),this},e.prototype.execCallbacks=function(){if(0!==this.status){var e,t=this.pendings,n=0,r=t.length,i=~this.status?0:1;for(this.pendings=[];n<r;n++)(e=t[n][i])&&e(this.value)}},e.deferred=e,e.defer=e,e.nextTick=Y,e.alwaysAsync=!0,e.onlyFuncs=!0,e.resolve=function(t){return new e(!0).resolve(t).promise},e.resolved=e.resolve,e.fulfilled=e.resolve,e.reject=function(t){return new e(!0).reject(t).promise},e.rejected=e.reject,e}();var ce=t.Lib,le=/^(\/?)([\s\S]+\/(?!$)|\/)?((?:\.{1,2}$|[\s\S]+?)?(\.[^.\/]*)?)$/;function ue(e,t){var n,r=[];for(n=0;n<e.length;n++){var i=e[n];i&&"."!==i&&(".."===i?r.length&&".."!==r[r.length-1]?r.pop():t&&r.push(".."):r.push(i))}return r}function Ae(e){var t="/"===e.charAt(0),n="/"===e.slice(-1);return(e=ue(ce.filter(e.split("/"),(function(e){return!!e})),!t).join("/"))||t||(e="."),e&&n&&(e+="/"),(t?"/":"")+e}var fe=function(){function e(){}return e.prototype.resolve=function(){var e,t,n="",r=arguments,i=!1;for(e=r.length-1;e>=0&&!i;e--)c(t=r[e])&&t&&(n=t+"/"+n,i="/"===t.charAt(0));return(i?"/":"")+ue(ce.filter(n.split("/"),(function(e){return!!e})),!i).join("/")||"."},e.prototype.join=function(){var e=x(arguments);return Ae(ce.filter(e,(function(e){return e&&c(e)})).join("/"))},e.prototype.relative=function(e,t){e=Ae(e),t=Ae(t);var n,r,i=ce.filter(e.split("/"),(function(e){return!!e})),o=[],s=ce.filter(t.split("/"),(function(e){return!!e})),a=Math.min(i.length,s.length);for(n=0;n<a&&i[n]===s[n];n++);for(r=n;n<i.length;)o.push(".."),n++;return(o=o.concat(s.slice(r))).join("/")},e.prototype.basename=function(e,t){var n;return n=(e.match(le)||[])[3]||"",t&&n&&n.slice(-1*t.length)===t&&(n=n.slice(0,-1*t.length)),n},e.prototype.dirname=function(e){var t=e.match(le)||[],n=t[1]||"",r=t[2]||"";return n||r?(r&&(r=r.substring(0,r.length-1)),n+r):"."},e.prototype.extname=function(e){return(e.match(le)||[])[4]||""},e}();function he(e){if(null==e||"object"!=typeof e)return e;var t,n,r;if(e instanceof Date)return(t=new Date).setTime(e.getTime()),t;if(e instanceof Array){for(t=[],r=e.length,n=0;n<r;n++)t[n]=he(e[n]);return t}if(e instanceof Object){for(n in t={},e)e.hasOwnProperty(n)&&(t[n]=he(e[n]));return t}return 0}var de=/[#\/\?@]/g,pe=/[#\?]/g,ge={scheme:1,userInfo:2,hostname:3,port:4,path:5},ye=new RegExp("^(?:([\\w\\d+.-]+):)?(?://(?:([^/?#@]*)@)?([\\w\\d\\-\\u0100-\\uffff.+%]*|\\[[^\\]]+\\])(?::([0-9]+))?)?(.+)?$");function me(e,t){return c(e)&&c(t)?e.toLowerCase()===t.toLowerCase():e===t}function Ce(e,t){return encodeURI(e).replace(t,(function(e){return"%"+function(e){return 1===e.length?"0"+e:e}(e.charCodeAt(0).toString(16))}))}var be=function(){function e(t){if(this.scheme="",this.userInfo="",this.hostname="",this.port="",this.path="",t instanceof e)return he(t);e.getComponents(t,this)}return e.prototype.clone=function(){var t=new e,n=this;return p(ge,(function(e,r){t[r]=n[r]})),t},e.prototype.getScheme=function(){return this.scheme},e.prototype.setScheme=function(e){return this.scheme=e,this},e.prototype.getHostname=function(){return this.hostname},e.prototype.setHostname=function(e){return this.hostname=e,this},e.prototype.setUserInfo=function(e){return this.userInfo=e,this},e.prototype.getUserInfo=function(){return this.userInfo},e.prototype.setPort=function(e){return this.port=e,this},e.prototype.getPort=function(){return this.port},e.prototype.setPath=function(e){return this.path=e,this},e.prototype.getPath=function(){return this.path},e.prototype.isSameOriginAs=function(e){var t=this;return me(t.hostname,e.hostname)&&me(t.scheme,e.scheme)&&me(t.port,e.port)},e.prototype.toString=function(e){var t,n,r,i,o,s=[],a=this;return(t=a.scheme)&&(s.push(Ce(t,de)),s.push(":")),(n=a.hostname)&&(s.push("//"),(o=a.userInfo)&&(s.push(Ce(o,de)),s.push("@")),s.push(encodeURIComponent(n)),(i=a.port)&&(s.push(":"),s.push(i))),(r=a.path)&&(n&&!E(r,"/")&&(r="/"+r),s.push(Ce(r,pe))),s.join("")},e.getComponents=function(e,t){var n=(e=e||w).match(ye)||[],r=t||{};return p(ge,(function(e,t){r[t]=n[e]})),r},e}();function we(e){return decodeURIComponent(e.replace(/\+/g," "))}function ve(e){return encodeURIComponent(String(e))}var Pe,Ie=t.Lib;function Ee(e){var t=typeof e;return null==e||"object"!==t&&"function"!==t}function Se(e,t,i,o){t=t||"&",i=i||"=",n(o)&&(o=h);var s=[];return p(e,(function(e,n){var a=ve(n);Ee(e)?(s.push(a),r(e)&&s.push(i,ve(e+w)),s.push(t)):f(e)&&e.length&&p(e,(function(e){Ee(e)&&(s.push(a,o?ve("[]"):w),r(e)&&s.push(i,ve(e+w)),s.push(t))}))})),s.pop(),s.join(w)}function Be(e,t,n){if(!c(e)||!(e=B(e)))return{};t=t||"&",n=n||"=";for(var r,i,o,s={},a=we,l=e.split(t),u=0,A=l.length;u<A;++u){if(-1===(r=Ie.indexOf(n,l[u])))i=a(l[u]),o=undefined;else{i=a(l[u].substring(0,r)),o=l[u].substring(r+1);try{o=a(o)}catch(h){J("decodeURIComponent error : "+o),J(h)}S(i,"[]")&&(i=i.substring(0,i.length-2))}i in s?f(s[i])?s[i].push(o):s[i]=[s[i],o]:s[i]=o}return s}function xe(e){e._queryMap||(e._queryMap=Be(e._query))}p({"&amp;":"&","&gt;":">","&lt;":"<","&#x60;":"`","&#x2F;":"/","&quot;":'"',"&#x27;":"'"},(function(e,t){}));var ke=function(){function e(e){this._query=e||""}return e.prototype.clone=function(){return new e(this.toString())},e.prototype.reset=function(e){var t=this;return t._query=e||"",t._queryMap=null,t},e.prototype.count=function(){var e=0;return xe(this),p(this._queryMap,(function(t){f(t)?e+=t.length:e++})),e},e.prototype.has=function(e){var t;return xe(this),t=this._queryMap,e?e in t:!function(e){var t;if(e)for(t in e)if(!n(t))return!1;return!0}(t)},e.prototype.get=function(e){var t;return xe(this),t=this._queryMap,e?t[e]:t},e.prototype.keys=function(){return xe(this),Object.keys(this._queryMap)},e.prototype.set=function(t,n){var r,i=this;return xe(i),r=i._queryMap,c(t)?i._queryMap[t]=n:(t instanceof e&&(t=t.get()),p(t,(function(e,t){r[t]=e}))),i},e.prototype.remove=function(e){var t=this;return xe(t),e?delete t._queryMap[e]:t._queryMap={},t},e.prototype.add=function(t,r){var i,o,s=this;return c(t)?(xe(s),o=n(o=(i=s._queryMap)[t])?r:[].concat(o).concat(r),i[t]=o):(t instanceof e&&(t=t.get()),p(t,(function(e,t){s.add(t,e)}))),s},e.prototype.toString=function(e){return xe(this),Se(this._queryMap,Pe,Pe,e)},e}();function ze(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}var Qe,Le,Fe=t.Lib,Te=/[\-#$\^*()+\[\]{}|\\,.?\s]/g,De={"&amp;":"&","&gt;":">","&lt;":"<","&#x60;":"`","&#x2F;":"/","&quot;":'"',"&#x27;":"'"},Me={};p(De,(function(e,t){Me[e]=t}));var je=function(){function e(e){var t=e.createElement("div"),n=e.createElement("div");n.style&&(this.div=n,this.container=t,this.docElem=e.documentElement,n.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",this.leadingWhitespace=3===n.firstChild.nodeType,this.tbody=!n.getElementsByTagName("tbody").length,this.htmlSerialize=!!n.getElementsByTagName("link").length,n.style.cssText="float:left;opacity:.5",this.opacity="0.5"===n.style.opacity,this.cssFloat=!!n.style.cssFloat,n.style.backgroundClip="content-box",n.cloneNode(!0).style.backgroundClip="",this.clearCloneStyle="content-box"===n.style.backgroundClip,(t=document.createElement("div")).style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",n.innerHTML="",t.appendChild(n),this.boxSizing=""===n.style.boxSizing||""===n.style.MozBoxSizing||""===n.style.WebkitBoxSizing)}return e.prototype.reliableHiddenOffsets=function(){return null==this.pixelPositionVal&&this.computeStyleTests(),this.reliableHiddenOffsetsVal},e.prototype.boxSizingReliable=function(){return null==this.pixelPositionVal&&this.computeStyleTests(),this.boxSizingReliableVal},e.prototype.pixelMarginRight=function(){return null==this.pixelPositionVal&&this.computeStyleTests(),this.pixelMarginRightVal},e.prototype.pixelPosition=function(){return null==this.pixelPositionVal&&this.computeStyleTests(),this.pixelPositionVal},e.prototype.reliableMarginRight=function(){return null==this.pixelPositionVal&&this.computeStyleTests(),this.reliableMarginRightVal},e.prototype.reliableMarginLeft=function(){return null==this.pixelPositionVal&&this.computeStyleTests(),this.reliableMarginLeftVal},e.prototype.computeStyleTests=function(){var e,t,n=this.div;this.docElem&&this.docElem.appendChild(this.container),n.style.cssText="-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",this.pixelPositionVal=this.boxSizingReliableVal=this.reliableMarginLeftVal=!1,this.pixelMarginRightVal=this.reliableMarginRightVal=!0,window.getComputedStyle&&(t=window.getComputedStyle(n),this.pixelPositionVal="1%"!==(t||{}).top,this.reliableMarginLeftVal="2px"===(t||{}).marginLeft,this.boxSizingReliableVal="4px"===(t||{width:"4px"}).width,n.style.marginRight="50%",this.pixelMarginRightVal="4px"===(t||{marginRight:"4px"}).marginRight,(e=n.appendChild(document.createElement("div"))).style.cssText=n.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",e.style.marginRight=e.style.width="0",n.style.width="1px",this.reliableMarginRightVal=!parseFloat((window.getComputedStyle(e)||{}).marginRight),n&&n.removeChild(e)),n.style.display="none",this.reliableHiddenOffsetsVal=0===n.getClientRects().length,this.reliableHiddenOffsetsVal&&(n.style.display="",n.innerHTML="<table><tr><td></td><td>t</td></tr></table>",n.childNodes[0].style.borderCollapse="separate",(e=n.getElementsByTagName("td"))[0].style.cssText="margin:0;border:0;padding:0;display:none",this.reliableHiddenOffsetsVal=0===e[0].offsetHeight,this.reliableHiddenOffsetsVal&&(e[0].style.display="",e[1].style.display="none",this.reliableHiddenOffsetsVal=0===e[0].offsetHeight)),this.docElem&&this.docElem.removeChild(this.container)},e}();function Re(e){return Math.random().toString(16).substring(2,2+e)}var Ne=Date.now||function(){return+new Date};function He(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r["throw"](e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}function Ue(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),"throw":a(1),"return":a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(a){o=[6,a],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}var Je=!1;"wakeLock"in navigator&&(Je=!0);var Ke,Oe,Ye=null;function Ge(){Je&&(null==Ye?function(){He(this,void 0,void 0,(function(){return Ue(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,navigator.wakeLock.request("screen")];case 1:return Ye=e.sent(),[3,3];case 2:return e.sent(),Ye=null,[3,3];case 3:return[2]}}))}))}():Ye.release().then((function(){Ye=null})))}function We(){return Ye}var Ze,Ve=20221111,qe=t.Lib,Xe=!1;qe&&qe.__ver&&qe.isNumber(qe.__ver)&&qe.__ver>=Ve&&(Xe=!0),Xe||((Ze=globalThis)&&!Ze.Map&&(Ze.Map=function(){this.keys=[],this.data={},this.set=function(e,t){null==this.data[e]&&-1==this.keys.indexOf(e)&&this.keys.push(e),this.data[e]=t},this.get=function(e){return this.data[e]}}),ze(t.Lib,{debug:!1,nil:undefined,mix:ze,clone:he,keys:Object.keys,now:Ne,getRandom:function(){for(var e,t=Ne()%1e4,n=[],r=0;r<5;r++)e=Math.floor(10*Math.random()),0!=r||0!=e?n.push(e):r=-1;return t<10?n.push("000"):t<100?n.push("00"):t<1e3&&n.push("0"),n.push(t),n.join("")},guid:function(e){var t=[Re(8),"-",Re(4),"-",Re(4),"-",Re(4),"-",Re(8)];return e&&t.unshift(e),t.join("")},stringify:null===(Ke=globalThis.JSON)||void 0===Ke?void 0:Ke.stringify,parse:null===(Oe=globalThis.JSON)||void 0===Oe?void 0:Oe.parse,__ver:Ve}),function(e){var t=e.Lib;t.mix(t,{isDef:r,isUndef:n,isUndefined:n,isNull:i,isNaN:isNaN,isFunction:a,isString:c,isObject:l,isBoolean:u,isNumber:A,isArray:f,type:s,isPlainObject:y,isDOM:C,isDOMInBody:b,each:p})}(t),ze(t.Lib,{getFormatedNow:M,getLogger:function(){return j},setLogger:function(e){j=e},log:U,error:J,warn:K,info:O}),function(e){var t=e.Lib,n=Array.prototype;t.mix(t,{filter:function(e,t,r){return n.filter.call(e,t,r||this)},indexOf:function(e,t){return n.indexOf.call(t,e)},uniq:function(e){var t,n,r=[],i=e.length;for(t=0;t<i;t++){for(n=t+1;n<i;n++)e[t]===e[n]&&(n=++t);r.push(e[t])}return r}})}(t),function(e){var t=e.Lib;t.mix(t,{startsWith:E,endsWith:S,replaceAll:function(e,t,n){return e.replace(new RegExp(t,"gi"),n)},upperCaseFirst:function(e){return e.charAt(0).toUpperCase()+e.substr(1)},removeNonPrintableChar:function(e){return t.isString(e)?e.replace(/[^\x20-\x7E]/g,""):e},makeArray:x,trim:B})}(t),function(e){var t=e.Lib;t.extend=function(e,n){var r=function(){e.apply(this,arguments),n&&n.apply(this,arguments)};return t.each(e.prototype,(function(e,t){r.prototype[t]=e})),r.prototype.constructor=r,r}}(t),function(e){var t=e.Lib;function n(e){var n=this,r=n.constructor;for(n.__attrs={},n.__attrVals={},n.userConfig=e;r;)n.addAttrs(r.ATTRS),r=r.superclass?r.superclass.constructor:null;t.mix(n.__attrs,e)}t.mix(n.prototype,{get:function(e){return e in this.__attrs?this.__attrs[e]:""},set:function(e,t){e in this.__attrs&&(this.__attrs[e]=t)},addAttrs:function(e){t.mix(this.__attrs,e)}}),n.extend=function(e){var n,r;return(e=e||{}).constructor&&(n=e.constructor),r=t.extend(this,n),t.mix(r,e),r},t.Attributes=n}(t),ze(Fe,{urlEncode:ve,urlDecode:we,fromUnicode:function(e){return e.replace(/\\u([a-f\d]{4})/gi,(function(e,t){return String.fromCharCode(parseInt(t,16))}))},escapeHtml:function(e){return(e+"").replace(function(){if(Qe)return Qe;var e=w;return p(De,(function(t){e+=t+"|"})),e=e.slice(0,-1),Qe=new RegExp(e,"g")}(),(function(e){return Me[e]}))},escapeRegExp:function(e){return e.replace(Te,"\\$&")},unEscapeHtml:function(e){return e.replace(function(){if(Le)return Le;var e=w;return p(Me,(function(t){e+=t+"|"})),e+="&#(\\d{1,5});",Le=new RegExp(e,"g")}(),(function(e,t){return De[e]||String.fromCharCode(+t)}))},param:Se,unparam:Be}),t.Lib.Path=new fe,t.Lib.uriQuery=ke,t.Lib.Uri=be,function(e){var t=e.Lib,n=t.win,r=20220622;if(!(t._promise_ver&&t.isNumber(t._promise_ver)&&t._promise_ver>=r)){if(t._promise_ver=r,n&&t.isFunction(n.__zone_symbol__Promise)&&(t.nativePromise=n.__zone_symbol__Promise),self&&self.Promise)return t.Promise=self.Promise,void(t.nativePromise||(t.nativePromise=t.Promise));if(n&&n.Promise)return t.Promise=n.Promise,void(t.nativePromise||(t.nativePromise=t.Promise));t.Promise=ae,t.nativePromise||(t.nativePromise=t.Promise)}}(t),t.Lib.asyncGetNavInfo=L,function(e){var t=e.Lib,n=e.navInfoSync,r=!1,i=!1;if(t.bNode||n.bJSDom||n.bEdge&&n.bFileSystem||n.bIE&&n.IEVersion<8);else try{i=window.localStorage,r=!!i}catch(o){i=!1}t.LS={isSupportLS:function(){return r},item:function(e,t,n){var r=null;return this.isSupportLS()?(t?(i.setItem(e,t),r=t):r=i.getItem(e),null===r?n:r):n},removeItem:function(e){return!!this.isSupportLS()&&(i.removeItem(e),!0)}}}(t),function(e){var t=e.Lib,n=t.win,r=t.doc,i=0,o=[],s=/\S/,a=!(!r||!r.addEventListener),c="DOMContentLoaded",l="readystatechange",u="load",A="complete",f=a?function(e,t,n){e.addEventListener(t,n,!1)}:function(e,t,n){e.attachEvent("on"+t,n)},h=a?function(e,t,n){e.removeEventListener(t,n,!1)}:function(e,t,n){e.detachEvent("on"+t,n)};function d(){for(var e=0;e<o.length;e++)try{o[e](t)}catch(n){t.log(n,"error"),setTimeout((function(){throw n}),0)}}function p(){if(!i){if(i=1,t.bNode||e.navInfoSync.bJSDom)return void d();L().then((function(){r&&h(n,u,p),d()}))}}if(t.mix(t,{isWindow:function(e){return null!=e&&e==e.window},globalEval:function(e){e&&s.test(e)&&(n.execScript?n.execScript(e):function(e){n.eval.call(n,e)}(e))},domReady:function(e){if(i)try{e(t)}catch(n){t.log(n,"error"),setTimeout((function(){throw n}),0)}else o.push(e);return this}}),t.ready=t.domReady,t.bNode||e.navInfoSync.bJSDom)p();else if(function(){if(r&&r.readyState!==A)if(f(n,u,p),a){var e=function(){h(r,c,e),p()};f(r,c,e)}else{var t=function(){r.readyState===A&&(h(r,l,t),p())};f(r,l,t);var i=void 0,o=r&&r.documentElement,s=o&&o.doScroll;try{i=null===n.frameElement}catch(g){i=!1}if(s&&i){var d=function(){try{s("left"),setTimeout(p,30)}catch(e){setTimeout(d,40)}};d()}}else p()}(),e.navInfoSync.bIE)try{r.execCommand("BackgroundImageCache",!1,!0)}catch(g){}}(t),function(e){var t=e.Lib,n="none";t.mix(t,{get:function(e){return t.doc.getElementById(e)},hide:function(e){var r=t.isString(e)?t.get(e):e;r&&(r.length>0&&(r=r[0]),r.style.display=n)},show:function(e){var n=t.isString(e)?t.get(e):e;n&&(n.length>0&&(n=n[0]),n.style.display=w)},toggle:function(e){var r=t.isString(e)?t.get(e):e;r&&(r.length>0&&(r=r[0]),r.style.display===n?r.style.display=w:r.style.display=n)},empty:function(e){if(e)for(;e.firstChild;)e.removeChild(e.firstChild)}})}(t),function(e){var t=e.Lib;t.colorStrToInt=function(e){var t,n,r="0x";if(/^(rgb|RGB)/.test(e)){var i=e.replace(/[^\d,.]/g,"").split(",");for(n=0;n<3;++n)1==(t=Number(i[n]).toString(16)).length&&(t="0"+t),r+=t;4==i.length?(1==(t=Math.round(255*Number(i[n])).toString(16)).length&&(t="0"+t),r+=t):r+="ff"}else if("transparent"==e)r+="00000000";else if(/^#[0-9a-fA-f]{6}$/.test(e))r+=e.replace(/#/,"")+"ff";else if(/^#[0-9a-fA-f]{3}$/.test(e)){for(n=0;n<3;++n)r+=e[n]+e[n];r+="ff"}else r="-1";return Number(r)},t.IntToColorStr=function(t){if(t>4294967295||t<0)return null;var n;if(e.navInfoSync.bHTML5Edition)n="rgba("+Math.floor(t/16777216)+","+Math.floor(t/65536)%256+","+Math.floor(t/256)%256+","+t%256/255+")";else if(t%256==0)n="transparent";else{for(n=Math.floor(t/256).toString(16);6!=n.length;)n="0"+n;n="#"+n}return n}}(t),function(e){var n=t.Lib,r=n.doc,i=r&&r.documentElement,o=r.getElementsByTagName("head")[0]||i,s=r.createElement("script").readyState?function(e,t){var n=e.onreadystatechange;e.onreadystatechange=function(){var r=e.readyState;"loaded"===r||"complete"===r?(e.onreadystatechange=null,n&&n(),t.call(this,{type:"load",path:[e]})):"loading"===r||t.call(this,{type:"error",path:[e]})}}:function(e,t){e.addEventListener("load",t,d),e.addEventListener("error",t,d)};n.scriptOnload=s,n.getScript=function(e,t,r){return n.addScript(e,t,!1,r)},n.addScript=function(e,i,a,c){var l,u,A=c;if(n.isFunction(A)||(A=function(){}),n.bNode||t.navInfoSync.bJSDom)A();else{if(n.isString(e)&&e!=w)return l=r.createElement("script"),u=["",e].join(w),l.src=u,i&&(l.async=!0),l.charset="utf-8",s(l,A),a?o.appendChild(l):o.insertBefore(l,o.firstChild),l;A()}},n.getScripts=function(e,t,r){return n.addScripts(e,t,!1,r)},n.addScripts=function(e,r,i,o){var s=o;if(n.isFunction(s)||(s=function(){}),n.bNode||t.navInfoSync.bJSDom)s("ok");else if(n.isArray(e)){var a=e.length,c=function(e){e&&"load"==e.type?a--:(e&&"error"==e.type&&n.error(["Failed to load resource: ",e.target.src,"."].join("")),s()),a<=0&&s("ok")};a<=0?s("ok"):n.each(e,(function(e){n.addScript(e,r,i,c)}))}else s()},n.getCss=function(e,t){return n.addCss(e,!1,t)},n.addCss=function(e,i,a){var c,l=a;if(n.isFunction(l)||(l=!1),n.isString(e)&&e!=w){if(!n.bNode&&!t.navInfoSync.bJSDom)return(c=r.createElement("link")).href=e,c.rel="stylesheet",c.async=!0,l&&s(c,l),i?o.appendChild(c):o.insertBefore(c,o.firstChild),c;l&&l()}else l&&l()},n.getAllCss=function(e,t){return n.addAllCss(e,!1,t)},n.addAllCss=function(e,r,i){if(n.bNode||t.navInfoSync.bJSDom)i&&i("ok");else if(n.isArray(e)){var o=e.length,s=function(e){var t;if(e&&"load"==e.type){var r=null===(t=null===window||void 0===window?void 0:window.location)||void 0===t?void 0:t.protocol;"https:"!==r&&"http:"!==r||this.sheet&&true?o--:e.type="error"}e&&"load"!=e.type&&(e&&"error"==e.type&&n.error(["Failed to load resource: ",e.target.href,"."].join("")),i()),o<=0&&i("ok")};n.each(e,(function(e){n.addCss(e,r,s)}))}else i&&i()},n.addJS=T,n.addVBS=D}(),function(e){var t=e.Lib,n={fire:function(e){var n,r=this;r.exec=r.exec||{},e=e.toLowerCase(),n=Array.prototype.slice.call(arguments,1),t.each(r.exec[e]||[],(function(e){var i=e.f,o=e.c||r;try{i.apply(o,n)}catch(s){t.log(s)}}))},on:function(e,t,n){var r=this;r.exec=r.exec||{},e=e.toLowerCase(),r.exec[e]=r.exec[e]||[],r.exec[e].push({f:t,c:n})},off:function(e,t,n){var r=this.exec;if(r)if(e)if(e=e.toLowerCase(),t)for(var i=r[e]||[],o=i.length-1;o>=0;o--)i[o]===t&&i.splice(o,1);else r[e]=null;else this.exec=null}};t.obj={customEvent:n}}(t),function(e){var t,n=e.Lib;t=function(t){return e.navInfoSync.bGecko&&"mousewheel"===t?"DOMMouseScroll":t},n.mix(n,{addEventListener:function(e,n,r){var i=t(n);e&&e.addEventListener(i,r,!1)},removeEventListener:function(e,n,r){var i=t(n);e&&e.removeEventListener(i,r,!1)},stopPropagation:function(e){var t=e||n.win.event;t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.returnValue=!1,t.cancelBubble=!0},fireEvent:function(e,t){var r=n.win.document.createEvent("HTMLEvents");r.initEvent(e,h,h),t.dispatchEvent&&t.dispatchEvent(r)}})}(t),function(e){var t=e.Lib,n={encodeChars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",decodeChars:[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1]};t.base64={UTF16ToUTF8:function(e){for(var t,n,r=[],i=e.length,o=0;o<i;o++){var s=e.charCodeAt(o);if(s>0&&s<=127)r.push(e.charAt(o));else if(s>=128&&s<=2047)t=192|s>>6&31,n=128|63&s,r.push(String.fromCharCode(t),String.fromCharCode(n));else if(s>=2048&&s<=65535){t=224|s>>12&15,n=128|s>>6&63;var a=128|63&s;r.push(String.fromCharCode(t),String.fromCharCode(n),String.fromCharCode(a))}}return r.join("")},UTF8ToUTF16:function(e){var t,n,r,i,o=[],s=e.length;for(t=0;t<s;t++)0==((n=e.charCodeAt(t))>>7&255)?o.push(e.charAt(t)):6==(n>>5&255)?(i=(31&n)<<6|63&(r=e.charCodeAt(++t)),o.push(String.fromCharCode(i))):14==(n>>4&255)&&(i=(255&(n<<4|(r=e.charCodeAt(++t))>>2&15))<<8|(3&r)<<6|63&e.charCodeAt(++t),o.push(String.fromCharCode(i)));return o.join("")},encode:function(e){for(var t,r,i,o=this.UTF16ToUTF8(e),s=[],a=0,c=o.length;a<c;){if(t=255&o.charCodeAt(a++),a==c){s.push(n.encodeChars.charAt(t>>2)),s.push(n.encodeChars.charAt((3&t)<<4)),s.push("==");break}if(r=o.charCodeAt(a++),a==c){s.push(n.encodeChars.charAt(t>>2)),s.push(n.encodeChars.charAt((3&t)<<4|(240&r)>>4)),s.push(n.encodeChars.charAt((15&r)<<2)),s.push("=");break}i=o.charCodeAt(a++),s.push(n.encodeChars.charAt(t>>2)),s.push(n.encodeChars.charAt((3&t)<<4|(240&r)>>4)),s.push(n.encodeChars.charAt((15&r)<<2|(192&i)>>6)),s.push(n.encodeChars.charAt(63&i))}return s.join("")},encodeArray:function(e){for(var t,r,i,o=[],s=0,a=e.length;s<a;){if(t=255&e[s++],s==a){o.push(n.encodeChars.charAt(t>>2)),o.push(n.encodeChars.charAt((3&t)<<4)),o.push("==");break}if(r=255&e[s++],s==a){o.push(n.encodeChars.charAt(t>>2)),o.push(n.encodeChars.charAt((3&t)<<4|(240&r)>>4)),o.push(n.encodeChars.charAt((15&r)<<2)),o.push("=");break}i=255&e[s++],o.push(n.encodeChars.charAt(t>>2)),o.push(n.encodeChars.charAt((3&t)<<4|(240&r)>>4)),o.push(n.encodeChars.charAt((15&r)<<2|(192&i)>>6)),o.push(n.encodeChars.charAt(63&i))}return o.join("")},decode:function(e,t){for(var r,i,o,s,a=this,c=[],l=0,u=e.length;l<u;){do{r=n.decodeChars[255&e.charCodeAt(l++)]}while(l<u&&-1==r);if(-1==r)break;do{i=n.decodeChars[255&e.charCodeAt(l++)]}while(l<u&&-1==i);if(-1==i)break;t?c.push(r<<2|(48&i)>>4):c.push(String.fromCharCode(r<<2|(48&i)>>4));do{if(61==(o=255&e.charCodeAt(l++)))return t?c:a.UTF8ToUTF16(c.join(""));o=n.decodeChars[o]}while(l<u&&-1==o);if(-1==o)break;t?c.push((15&i)<<4|(60&o)>>2):c.push(String.fromCharCode((15&i)<<4|(60&o)>>2));do{if(61==(s=255&e.charCodeAt(l++)))return t?c:a.UTF8ToUTF16(c.join(""));s=n.decodeChars[s]}while(l<u&&-1==s);if(-1==s)break;t?c.push((3&o)<<6|s):c.push(String.fromCharCode((3&o)<<6|s))}return t?c:a.UTF8ToUTF16(c.join(""))}},t.utf8={fromUTF16:function(e){for(var t,n=[],r=0,i=e.length;r<i;)(t=e.charCodeAt(r))>=1&&t<=127?n.push(e.charAt(r)):t>2047?(n.push(String.fromCharCode(224|t>>12&15)),n.push(String.fromCharCode(128|t>>6&63)),n.push(String.fromCharCode(128|t>>0&63))):(n.push(String.fromCharCode(192|t>>6&31)),n.push(String.fromCharCode(128|t>>0&63))),r++;return n.join("")},toUTF16:function(e){for(var t,n,r,i=[],o=0,s=e.length;o<s;)switch((t=e.charCodeAt(o++))>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:i.push(e.charAt(o-1));break;case 12:case 13:n=e.charCodeAt(o++),i.push(String.fromCharCode((31&t)<<6|63&n));break;case 14:n=e.charCodeAt(o++),r=e.charCodeAt(o++),i.push(String.fromCharCode((15&t)<<12|(63&n)<<6|(63&r)<<0))}return i.join("")}};var r="undefined"!=typeof self?self:global;function i(e){this.message=e}i.prototype=new Error,i.prototype.name="InvalidCharacterError",t.btoa=r.btoa?function(e){return r.btoa(e)}:function(e){var t,r,o=String(e),s=0,a=n.encodeChars,c="";for(s=0,a=n.encodeChars,c="";o.charAt(0|s)||(a="=",s%1);c+=a.charAt(63&t>>8-s%1*8)){if((r=o.charCodeAt(s+=3/4))>255)throw new i("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");t=t<<8|r}return c},t.atob=r.atob?function(e){return r.atob(e)}:function(e){var t,r,o=String(e).replace(/[=]+$/,""),s=0,a=0,c="";if(o.length%4==1)throw new i("'atob' failed: The string to be decoded is not correctly encoded.");for(s=0,a=0,c="";r=o.charAt(a++);~r&&(t=s%4?64*t+r:r,s++%4)?c+=String.fromCharCode(255&t>>(-2*s&6)):0)r=n.encodeChars.indexOf(r);return c}}(t),function(e){var t=e.Lib,n={queue:[],doNextStarted:!1,timer:null,pushToDo:function(e,t,r){n.queue.push({obj:e,method:t,args:r})},doNext:function(){if(n.doNextStarted)if(0!=n.queue.length){var e=n.queue[0],r=e.obj,i=e.method,o=e.args;if(n.queue.splice(0,1),r&&t.isFunction(r[i])){var s=!1;if(o.length>2){var a=o[o.length-2],c=o[o.length-1];t.isFunction(a)&&t.isFunction(c)&&(o[o.length-2]=function(){try{a.apply(r,arguments)}catch(e){}n.timer=setTimeout(n.doNext,0)},o[o.length-1]=function(){try{c.apply(r,arguments)}catch(e){}n.timer=setTimeout(n.doNext,0)},s=!0)}try{r[i].apply(r,o)}catch(l){}s||(n.timer=setTimeout(n.doNext,0))}else if(null===r&&t.isFunction(i)){try{i.apply(null,o)}catch(u){}n.timer=setTimeout(n.doNext,0)}else t.log("not invoke a function: "+i),n.timer=setTimeout(n.doNext,0)}else n.stop();else n.stop()},start:function(){n.doNextStarted||(n.doNextStarted=!0,n.timer=setTimeout(n.doNext,0))},stop:function(){clearTimeout(n.timer),n.timer=null,n.doNextStarted=!1,n.queue=[]}};t.asyncQueue=n}(t),function(e){var t,n=e.Lib,r={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function i(e,t){if(n.isFunction("_".repeat))return e.repeat(t);for(var r=0,i=[];r<t;r++)i.push(e);return i.join("")}function o(e,n){var o,s,a,c,l,u,A,f,h,d=1,p=e.length,g="";for(s=0;s<p;s++)if("string"==typeof e[s])g+=e[s];else if("object"==typeof e[s]){if((c=e[s]).keys)for(o=n[d],a=0;a<c.keys.length;a++){if(o==undefined)throw new Error(t('[sprintf] Cannot access property "%s" of undefined value "%s"',c.keys[a],c.keys[a-1]));o=o[c.keys[a]]}else o=c.param_no?n[c.param_no]:n[d++];if(r.not_type.test(c.type)&&r.not_primitive.test(c.type)&&o instanceof Function&&(o=o()),r.numeric_arg.test(c.type)&&"number"!=typeof o&&isNaN(o))throw new TypeError(t("[sprintf] expecting number but found %T",o));switch(r.number.test(c.type)&&(f=o>=0),c.type){case"b":o=parseInt(o,10).toString(2);break;case"c":o=String.fromCharCode(parseInt(o,10));break;case"d":case"i":o=parseInt(o,10);break;case"j":o=JSON.stringify(o,null,c.width?parseInt(c.width):0);break;case"e":o=c.precision?parseFloat(o).toExponential(c.precision):parseFloat(o).toExponential();break;case"f":o=c.precision?parseFloat(o).toFixed(c.precision):parseFloat(o);break;case"g":o=c.precision?String(Number(o.toPrecision(c.precision))):parseFloat(o);break;case"o":o=(parseInt(o,10)>>>0).toString(8);break;case"s":o=String(o),o=c.precision?o.substring(0,c.precision):o;break;case"t":o=String(!!o),o=c.precision?o.substring(0,c.precision):o;break;case"T":o=Object.prototype.toString.call(o).slice(8,-1).toLowerCase(),o=c.precision?o.substring(0,c.precision):o;break;case"u":o=parseInt(o,10)>>>0;break;case"v":o=o.valueOf(),o=c.precision?o.substring(0,c.precision):o;break;case"x":o=(parseInt(o,10)>>>0).toString(16);break;case"X":o=(parseInt(o,10)>>>0).toString(16).toUpperCase()}r.json.test(c.type)?g+=o:(!r.number.test(c.type)||f&&!c.sign?h="":(h=f?"+":"-",o=o.toString().replace(r.sign,"")),u=c.pad_char?"0"===c.pad_char?"0":c.pad_char.charAt(1):" ",A=c.width-(h+o).length,l=c.width&&A>0?i(u,A):"",g+=c.align?h+o+l:"0"===u?h+l+o:l+h+o)}return g}var s=Object.create?Object.create(null):{};function a(e){if(s[e])return s[e];for(var t,n=e,i=[],o=0;n;){if(null!==(t=r.text.exec(n)))i.push(t[0]);else if(null!==(t=r.modulo.exec(n)))i.push("%");else{if(null===(t=r.placeholder.exec(n)))throw new SyntaxError("[sprintf] unexpected placeholder");if(t[2]){o|=1;var a=[],c=t[2],l=[];if(null===(l=r.key.exec(c)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(a.push(l[1]);""!==(c=c.substring(l[0].length));)if(null!==(l=r.key_access.exec(c)))a.push(l[1]);else{if(null===(l=r.index_access.exec(c)))throw new SyntaxError("[sprintf] failed to parse named argument key");a.push(l[1])}t[2]=a}else o|=2;if(3===o)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");i.push({placeholder:t[0],param_no:t[1],keys:t[2],sign:t[3],pad_char:t[4],align:t[5],width:t[6],precision:t[7],type:t[8]})}n=n.substring(t[0].length)}return s[e]=i,i}t=function(e){return o(a(e),arguments)},n.sprintf=t,n.vsprintf=function(e,n){return t.apply(null,[e].concat(n||[]))}}(t),function(e){var t=e.Lib,n=t.doc;t.Events={registedClass:[],registedObjs:[]};var r=function(e){var n=e||window.event,r=!0;return t.each(t.Events.registedObjs,(function(e){t.each(t.Events.registedClass,(function(t){if(e instanceof t&&e.bFocus&&e.handlerKeyDown&&!(r=e.handlerKeyDown(n)))return!1}))})),r};t.ready((function(){t.addEventListener(n.documentElement,"keydown",r)})),t.mix(t,{getWheelDelta:function(e){var t,n=(e=e||window.event).wheelDelta,r=e.detail;return n&&(t=n/120),r&&(t=-(r%3==0?r/3:r)),t}});var i={LEFT:0,MIDDLE:1,RIGHT:2};t.EnumMouseButton=i,t.detectButton=function(e){var t=e||window.event;return null==t.which?t.button<2?i.LEFT:4==t.button?i.MIDDLE:i.RIGHT:t.which<2?i.LEFT:2==t.which?i.MIDDLE:i.RIGHT}}(t),function(e){e.Lib.switchEvent=function(e){return null==(e=e||window.event).which?e.which=e.button<2?1:4==e.button?2:3:e.which=e.which<2?1:2==e.which?2:3,e}}(t),function(e){var t=e.Lib;t.currentStyle=function(e,n){var r=t.win,i=r.doc;return e.currentStyle?e.currentStyle[n]:r.getComputedStyle?(n.replace(/([A-Z])/g,"-$1"),n.toLowerCase(),i.defaultView.getComputedStyle(e,null)[n]):null}}(t),function(e){var t=Array.prototype,r=e.Lib,i=e.navInfoSync,o=r.isString,s=r.each,a=t.slice,c=" ",l=i.bIE&&i.IEMode<10,u=/[\n\t\r\.]/g,A=function(){function e(t,n,i){this.isNodeList=!0,this.length=0;var o=this;return o instanceof e?t?"string"==typeof t?(r.error("Err 4001."),o):r.isArray(t)||t.isNodeList?(Array.prototype.push.apply(o,x(t)),o):(o[0]=t,o.length=1,o):o:new e(t)}return e.prototype.item=function(t){return r.isNumber(t)?t>=this.length?null:new e(this[t]):new e(t)},e.prototype.slice=function(){return new e(a.apply(this,arguments))},e.prototype.getDOMNodes=function(){return a.call(this)},e.prototype.each=function(t,n){var r=this;return s(r,(function(i,o){return i=new e(i),t.call(n||i,i,o,r)})),r},e.prototype.getEL=function(){return this.length>0?this[0]:void 0},e.prototype.all=function(t){return this.length>0?r.all(t,this):new e},e.prototype.one=function(e){var t=this.all(e);return t.length?t.slice(0,1):t},e}();function f(e){return o(e)&&(e=r.trim(e))&&e.length>=3&&r.startsWith(e,"<")&&r.endsWith(e,">")}function p(e){return(c+e+c).replace(u,c)}function g(e){return e.replace(u,"")}function y(e,t){var n=t;return n&&n.isNodeList&&(n=n.getEL()),o(e)?(f(e)&&r.err("Err 4002."),new A(r.sizzle(e,n))):e.isNodeList?e:new A(e)}r.mix(A.prototype,{before:function(e){var t=this.getEL(),n=[e];t&&(f(e)&&(n=r.parseHTML(e)),s(n,(function(e){t.insertBefore(e,t.childNodes[0])})))},append:function(e){var t=this.getEL(),n=[e];t&&(f(e)&&(n=r.parseHTML(e)),s(n,(function(e){t.appendChild(e)})))},html:function(e){var t,i=this.getEL();if(i){if(n(e))return t=i.innerHTML,document.all?(t=t.replace(/(\s+\w+)\s*=\s*([^<>"\s]+)(?=[^<>]*\/>)/gi,'$1="$2"').replace(/"'([^'"]*)'"/gi,'"$1"')).replace(/<(\/?)(\w+)([^>]*)>/g,(function(e,t,n,r){return t?"</"+n.toLowerCase()+">":("<"+n.toLowerCase()+r+">").replace(/=(("[^"]*?")|('[^']*?')|([\w\-\.]+))([\s>])/g,(function(e,t,n,r,i,o,s,a){return i?'="'+i+'"'+o:e}))})).replace(/<\/?([^>]+)>/g,(function(e){return e})):t;i.innerHTML="",s(r.parseHTML(e),(function(e){i.appendChild(e)}))}},attr:function(e,t){var r=this.getEL();if(r){if(n(t))return"readonly"===e?r.readOnly?"readonly":"":("style"!==e&&l?r=r[e]:(r=r.attributes[e])&&(r=r.value),r);"class"==e?r.className=t:r[e]=t}},style:function(e,t){var n=this.getEL();if(n)return r.style(n,e,t)},css:function(e){s(this,(function(t){s(e,(function(e,n){r.style(t,n,e)}))}))},addClass:function(e){var t=this.getEL();t&&function(e,t){var n,i,o,s,a=e.className,l=t.length;if(a){for(n=p(a),i=a,o=0;o<l;o++)s=g(t[o]),n.indexOf(c+s+c)<0&&(i+=c+s);i=r.trim(i)}else i=t.join(" ");e.className=i}(t,e.split(c))},removeClass:function(e){var t=this.getEL();t&&function(e,t){var n,i,o,s=e.className,a=t.length;if(s&&a){for(n=p(s),i=0;i<a;i++)for(o=c+g(t[i])+c;n.indexOf(o)>=0;)n=n.replace(o,c);e.className=r.trim(n)}}(t,e.split(c))},hasClass:function(e){var t=this.getEL();if(t)return function(e,t){var n,r,i,o=e.className,s=t.length;if(o&&s){for(n=p(o),r=0;r<s;r++)if(i=c+g(t[r])+c,n.indexOf(i)<0)return d;return h}return d}(t,e.split(c))},parent:function(){var e=this.getEL();return e&&(e=e.parentNode),new A(e)},remove:function(){var e=this.getEL();e&&e.parentNode&&e.parentNode.removeChild(e)},offset:function(){var e=this.getEL();return r.DOM.getElDimensions(e,h)}}),r.mix(r,{all:y,one:function(e,t){var n=y(e,t);return n.length?n.slice(0,1):n},isNodeList:function(e){return e instanceof A}}),r.ready((function(){r.all=y}))}(t),function(e){var t=e.Lib,n=t.win,r=isNaN;t.DOM={getOffset:function(e,i,o){var s,a;e=e||n.event;for(var c,l,u=o||e.target,A=0,f=0,h=0,d=0,p=!1,g=t.doc;u&&!r(u.offsetLeft)&&!r(u.offsetTop);)l=u.scrollLeft,c=u.scrollTop,"BODY"===u.tagName?p?(l=0,c=0):(l|=null===(s=g.documentElement)||void 0===s?void 0:s.scrollLeft,c|=null===(a=g.documentElement)||void 0===a?void 0:a.scrollTop):"fixed"===u.style.position&&(p=!0),A+=u.offsetLeft-l,f+=u.offsetTop-c,u=u.offsetParent;return i&&(h=i.Left,d=i.Top),{x:A=e.clientX-A-h,y:f=e.clientY-f-d}},getElDimensions:function(e,t){var n,r;return e?(n=e.style.display,e.style.display="",r=t?{offsetTop:e.offsetTop,offsetLeft:e.offsetLeft,offsetWidth:e.offsetWidth,offsetHeight:e.offsetHeight}:{clientTop:e.clientTop,clientLeft:e.clientLeft,clientWidth:e.clientWidth?e.clientWidth:parseInt(e.style.width)?parseInt(e.style.width):0,clientHeight:e.clientHeight?e.clientHeight:parseInt(e.style.height)?parseInt(e.style.height):0},e.style.display=n,r):{offsetTop:0,offsetLeft:0,offsetWidth:0,offsetHeight:0}}},t.getElDimensions=t.DOM.getElDimensions}(t),function(e){var t,n=e.Lib;n.loaderBarClassName="ds-dwt-loaderBar",n.loaderBarSource="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjAiIHdpZHRoPSIxMDBweCIgaGVpZ2h0PSIxMDBweCIgdmlld0JveD0iMCAwIDEyOCAxMjgiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxnPjxjaXJjbGUgY3g9IjE2IiBjeT0iNjQiIHI9IjE2IiBmaWxsPSIjZmU4ZTE0Ii8+PGNpcmNsZSBjeD0iMTYiIGN5PSI2NCIgcj0iMTQuMzQ0IiBmaWxsPSIjZmU4ZTE0IiB0cmFuc2Zvcm09InJvdGF0ZSg0NSA2NCA2NCkiLz48Y2lyY2xlIGN4PSIxNiIgY3k9IjY0IiByPSIxMi41MzEiIGZpbGw9IiNmZThlMTQiIHRyYW5zZm9ybT0icm90YXRlKDkwIDY0IDY0KSIvPjxjaXJjbGUgY3g9IjE2IiBjeT0iNjQiIHI9IjEwLjc1IiBmaWxsPSIjZmU4ZTE0IiB0cmFuc2Zvcm09InJvdGF0ZSgxMzUgNjQgNjQpIi8+PGNpcmNsZSBjeD0iMTYiIGN5PSI2NCIgcj0iMTAuMDYzIiBmaWxsPSIjZmU4ZTE0IiB0cmFuc2Zvcm09InJvdGF0ZSgxODAgNjQgNjQpIi8+PGNpcmNsZSBjeD0iMTYiIGN5PSI2NCIgcj0iOC4wNjMiIGZpbGw9IiNmZThlMTQiIHRyYW5zZm9ybT0icm90YXRlKDIyNSA2NCA2NCkiLz48Y2lyY2xlIGN4PSIxNiIgY3k9IjY0IiByPSI2LjQzOCIgZmlsbD0iI2ZlOGUxNCIgdHJhbnNmb3JtPSJyb3RhdGUoMjcwIDY0IDY0KSIvPjxjaXJjbGUgY3g9IjE2IiBjeT0iNjQiIHI9IjUuMzc1IiBmaWxsPSIjZmU4ZTE0IiB0cmFuc2Zvcm09InJvdGF0ZSgzMTUgNjQgNjQpIi8+PGFuaW1hdGVUcmFuc2Zvcm0gYXR0cmlidXRlTmFtZT0idHJhbnNmb3JtIiB0eXBlPSJyb3RhdGUiIHZhbHVlcz0iNDUgNjQgNjQ7OTAgNjQgNjQ7MTM1IDY0IDY0OzE4MCA2NCA2NDsyMjUgNjQgNjQ7MjcwIDY0IDY0OzMxNSA2NCA2NDswIDY0IDY0IiBjYWxjTW9kZT0iZGlzY3JldGUiIGR1cj0iNzIwbXMiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIj48L2FuaW1hdGVUcmFuc2Zvcm0+PC9nPjwvc3ZnPg==",n.loaderBarSourceIE="data:image/gif;base64,R0lGODlhZABkAKUAAPyOFPzKjPyuVPzmxPy+dPyeNPzarPz27PzSnPy2ZPymRPzGhPyWJPzu3PzixPzOnPyyZPzChPyiRPzevPz+/PzWrPy6dPyqVPzOlPyyXPzq1PzCfPyiPPzetPz69PzWpPy6bPyqTPyaLPySHPzKlPyuXPzmzPy+fPyePPzatPz29PzSpPy2bPymTPzGjPyWLPzy5P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQJCQAxACwAAAAAZABkAAAG/sCYcEgsGo/IpHLJbDqf0Kh0Sq1ar9hslXI4aEwHFUVLLicpjUBrBACMFKTG2Ewne1Khtl4fSnnqgFYUFSJ7hgAiFXOBjE8mDIeHIyaNlUweGZGRGX+WnkYTL5qHIhOfp0MubKN7Iy6oUhQwDSYmDTBPHiyshyydsEwUJgslCiIFCgkPcpcJvIYJv8BJBy4okW8r0kceIM97LIvTRw0Cq5ojBNtGqt9uC08qGisnBA9g4loHAt8jESpKJhT6VqqJMALn3AiYsE7QAneIFCVRkelbiYZFKDhooanAinxWHFyDKABXEhMJ0VFiAkMBqwITQE6hEAGinhRKBg3UlEim/pENzwQcyAKDn00AJ3wKucMxUogKGIsc2DlqhIMsGjgcBRBC6dI0Cla9IaHBKxEHKTWRyGKCqjsUZpeqOFArTFwiK9JGIsDW7TcOd7FU0HuIL5asWwVELfPo2wOiELYuCHzFQ4FnIzRkoYCBsCYGVz3lZZVuMRQNLiGyGOrpQORRClZuHv2tgAPKWNBA0KvgdhkPJzzrYfDBNB0uKwowYDCCQYETMHA78RDB7x6P42J4MFFhhQPWgA4YKJGWAQgHxrObkdXhhAAOHDK4wKd+GgUKHu5Lr8+/v///AAYo4IAEAgODBhNoYFKBdVCgAQkKMDdCcwq40EB6DDoBAwbW/rUhwgMLZlhFA7vxMkICmolIxQEhCLeHUCpK4YEzNvkiIhomOGACDKYNdhQDFWR4wAMCiMKAAA+AZ8QBFR2VgZIBwsACJHswwEKIRAi0FSKmDEjBLtiEYwQFJGzZBgb7eWICabIN4QEBZiKFISxAsRLBkmBumQCU/pXASwZL0rjlagMaNQqgRbwZpzoDnsDLnRmVaSYJaVoygGeTHKHlVgV5mWcvMjG5JQR8/icllcOBgCURKaDqDgM4MXgAAgJAciQCpbopqDs2ZugBDDnaYhwMF7jYxggwxihFAxm4OAIEKSq77AMdIoJBA9JW4UEDLkQ4IYUWzpmtEgcmuOq4/uimq+66/qHhwAQfVDABGOxGodECFyjnBgMoZBAAM/UuAcMJl6HDAQniZiuMVt9AAHDAQ1AwAcPuCIAtxENo0JRNECTs664QjUApxg7EycHFp/x64XpNbjVCAJVS4cAGJQhggR9kaFCtRecCsqmHk2mxgqtbFdAmIw5Y94EWNcUJAKyWeFDnISF4fIQFTrcRZCUw+BmJCNFagXXWWzdSFE9HUzG1mQwYYIkKYx+iQK5RPGAsKyKEVkkK1r2SRdJOh4ByIx48ZEgJdEfhwcYuJ/UJBSu0UIAIEriQuBQVxFnAALBsR68ZBzBuEwExC0hBBzt31LMRKqRAAAEpAESgYgfU2sSB3kscsOueBXqQnDshxOTECocsXeDpokeCImWv7QFBhlxUEIIIEx7LgAgQoBeF13sgeqMJD7gAAgEurPAwFHYb8hjGT4iqB6nsPyELkSWAWHr8+Oev//789+8/u0EAACH5BAkJADEALAAAAABkAGQAAAb+wJhwSCwaj8ikcslsOp/QqHRKrVqv2Kx2y+0uPY1JJ+XQeLxob2OhYAAAjNaika5fKYPL6M0HjC4DFHaDUSYofYgAKCaEjUweAomJAmeOlkYOe5J9Iw6Xn0MEm4kEoJ8UCqOICoKmUB4aJiYNrU4UHKp9HLWuSwcBAhwoBQolFZVMFC25fC28vUceFQWSIyEOz0gWzG8W0EoeLm6jIilNmdyeUBQNsg3IXhXjqhyMX5G5lK8uF8IKJ3S8HKDGjQU8JA5wjeKgzkmDEprejECBrYsLbm/KJXOgJ9Gfik5g4EtUwJ4WSBjfLDiIpEGENm8YKIgQ0NaKiKRYVtGgEGP+Ahi2NExIkWKChmy+QKgKUROLA4IYBTQddCCEqpJbBhxKKQCoowMXVC3aokFCSgAsDljycELVhalWUKZ0gTQNBQPzEI2IUJdKBZxiB3xSsQHwm65dPFhlNmKDzkEwXIjowwAC3CxPmbXwCspDCgICLrBYoRYNhRRQPba4bImChwMHPPTVYoLFZEQcInD+tjbFAgglSrAgYeIxb0KvYcA4MPu48+fQo0ufTr269evYs1t3DaOBdxiytXOB8VnBixEiJJwwsFt8lQEl8vJhUEKweyoUKvTcxMFA8/tG5HdbLiJU8B+AQzSwXy4csDYdBTBoAMOBF521gHYutcBBCBv+OCgEDANiVEB70lHgQAs4tRBIEvKcBUcF1x1QgiQllHbEAi6+EcF16HjUkBHb5OiNdRiMgkESSgl5HQmjkJAEji7uxaNhfvxYRItnMQCjdQeM1IcANhoBoosjXodHKn2oOBuUKV2YXQMnhCBBCAAxoWBKDYoHoYQHCshNgQciKER+CybCgYGCRuFAfJLQZ2WiIVVAgAQijPCCBARUQCKktnjQ3XfhcSrqqKSWauqpqBbhqSwTppqMCScoUIAIBRTQAgm0uGqEBw5AQCUcAAWaKAUPpLaJAiClSsEKL2AkwaOknmZsLkyl2oCXGFkgrHb5/aoKAx7aQcG2T3gwY47+ALgAigoYXCBHuFIc4G0urDThGmyhTqHCYm+gYJ8WDqD7RgHhHjABBhFYAEIEGEwQ5hMBJFICuUoYIDAAIpi06wolTFtACSsYF80yej1sRQUXZ3wEOyHIhwgDTAXqAZqImFzFBBcTvOsEhW6CwgSBioIbxUnAcLEEB5loFp7JKqHBVhkhelLP3IAgJrbcXGDzEb3uEUIKIktBAQnzbjLCv0NEIPCOnXqQ7xYN0JwSBM+Mia4Im4JCrMtXPfpA2aOM8IBzB5wAeEYrPENBAhcDkADRaHhAAN+IFBCymCQLvNlzKjygwK8jCJACUnderAC8l7CDweecQKBpXWU1zoFdBiWCYUIFKZgQ22xxN346qR6EdbEAKpQqtMCllDrB4dVMYCoF/LoYAuTVpUD5t+acKnmOJ4QtKAwgMD8CC3mPWvj180WwdakeIICi2S0g4P2o7KwgAE6hr5ArKEEAACH5BAkJADAALAAAAABkAGQAhfyOFPzKjPyuVPzmxPyeNPzarPy+dPz27PzSnPymRPy2ZPzGhPyWJPzu3PzixPzOnPyiRPzevPzChPz+/PzWrPyqVPy6dPzOlPyyXPzq1PyiPPzetPzCfPz69PzWpPyqTPy6bPyaLPySHPzKlPyuXPzmzPyePPzatPy+fPz29PzSpPymTPy2bPzGjPyWLPzy5P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAb+QJhwSCwaj8ikcslsOp/QqHRKrVqv2Kx2y+16v+CweAydRCyVjyUyIbujkwYGQK9jGu23Xtkg1f8AJA17hEYdLSKAdSItHYWPMA0Jin8Jg5CEA4mUdCIlmIQRnH8OoGUvJSUHeVAlm5yepkwTLyMaIrgMCQWrT5KjAJaySh0OK5QiGBmsS4evgCIBjsNHZhrAApdNfZyCVRPTYS/HwAAszEq0JM8iguhNcQYrGiwO71oj5XQMEWURIAIqrLk36wSDPyIWhNsy4Zo+ACgIisngEGG/Lg0OPqxwoFCAZ3a8OAA5StieDhY4aViYxdXDYNreTDDACQJLLC806hPQkdD+A5IAQHiZ8OGhCAkSxZFDmOELBaCAQjR91KCCRhEJ2Hw5oKAcI1AHEKBA8QAPmAkZKowSAaInqAlJtcRhobNOiBYvqOkxY0FAghUCUMTUK/NAhgYp4hJezLix48eQI0ueTLmy5cuYM397kaFEhheKNS+Z4ICDAA0mNAjgYE/0lA4oQigSEQLFTdd8BJTLhrvJCxZQF7HI2zvJBA/B/zBQEVov3OYHILwM5jZyBw8QQkDwcLuIg+l0SklOseBVwhRL8oEfMdmB7D8ELiahCd6A5AkXKD1IigI8APuRTfCAfkkF4B97kkXwnl3yIfEdeOJFdoAE5klQ3REHTPJSAhf+PnZddtt1R8QEKtQ1ynLNUQNOir8lB4AIwxW3RAO6YTOYjEd0YMCCf9QmIo5EFCOBABBoAIEAEjjwI5BF0JJKCaAxKeWUVFZp5ZVYPgHOCy8kluURL5yAAgYkCICBAWWN8VwHHcAFSgoPJGDiiyZIEGUXHTSgAgYmMMCABiBEcKceHZSgITAhULBkFAdcIN1sHyi61wmP6sPAA4s68ducPbaQ4hUlVPRQCB58ikQHfujDSKZXZOgfAARESEUHC0yXqKlwGPgqABiwikQJJoAnAHFgvFCpf7HMKgGyJ4hBAacvcVBFA0X5ZwGuTsy0ax0QYAtDCTy+tBIYB8yxLaz+Nzox0qsMZFqMCi20oIKSS7yg1rkhfDLFusj+SIstDOCSiwYjDFoEjecCkC8VA7jwKgESdUCBqIpowB2GqW4bQrrbHDqdAgR18AC0yu1nSErnjjvFASC8ylw1Jb7kQqlGjOAiMBhYcUK45ZjUpAPBTmdCa0RkQMC5DUrRQcsvMXDBPSnQVx9L2u66gq9INHAsMCx0KEQGPOvjwo0NhF0OAxR4S4ShXmFArBEIbIuAESTejBAKXk/RAAhhi0CABOglwcK2LOT4gNmzWZA3FSkUYEECIYjAQAgfJLlkta9WcKoKR59t4Rd5luCAAyWYxcRS/q1g3AAKBFfBCVi7kbFpfyQ0U0ILkIcQAgH0OODlYhxsK20THXAGZeyhbJt0cS9Q/JAGb8sooN2LmCzlC+a+pED0QJaw9SgQTEVlHB8kJ8IKplv5ggS3zKaBnV/CUOgICiRAAAEJKDBCCcj3NsEBDThMA3qBiSAAACH5BAkJAC8ALAAAAABkAGQAhfyOFPzKjPyuVPzmxPyeNPy+dPzarPz27PzSnPymRPy2ZPzGhPyWJPzu3PzOnPyiRPzChPzixPz+/PzWrPyqVPy6dPzOlPyyXPzq1PyiPPzCfPzevPz69PzWpPyqTPy6bPyaLPySHPzKlPyuXPzmzPyePPy+fPzatPz29PzSpPymTPy2bPzGjPyWLPzy5P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAb+wJdwSCwaj8ikcslsOp/QqHRKrVqv2Kx2y+16v+CweEwum4sS1yYg2rgk53gzIgDYQ5SIfI9sJOyAAAkNfIVCEgWBgSZwhnsNKoqAKoSOchh/koIYlnKQmoKVnU4SHByNUoghmoyjTRwRDiwBKSSoUA0PkoOuTC4VBKsAIRkWKFN0gHh6vUouI5ohEAepaiIBbreppdpeHB+gww7dcQ0LCSUFtmERBOEAKtSFB3WADwNgEg7vw5yFKZJWkMPCYQE/ABsMXZAEYuAVDiwOJiwETlEJh1YkpBAGKoSoPScktfpCIsM7AfL4cFgRiMLHLhJEMAAFYgNGMhIiFKgwISX+GBQaOAICkYJDszIHHCQQFmLEBqNHy0g4QGJDhAYHbkbdyrWr169gw4odS7as2bNow3BwgcEF1LRVOJwoQCHBgwQUCpx4C7fJ1BPBopXoqRWuBAwrhEZbgaEw1QEkfH5t4EFxRw8v0TQokAGE5wcFGhR2hKLeQUAjJA9BkcKdJAIpVPfiUMAyvxAF+AopaPvOAt29NoA4zXDiEAkTZr5r0WF0HBQmeh80wZfyacxRG5gkLimDKAknpAcKccK5mQjcoxmXYJD4AvNlEKTXlGLISu4rgFuKOF9RAPsVnfaBfo6I0J8iLBwHAXcQEGgIQAcCUt8h4Z1GHnxkoBfhMMz+CGHdQS5lt92B3hGBXAv8MIchGSgkEqEJkvEWTgi/cSXcgQQYRwRrrikC2zFc0dZfCBUQKMFmnXmWQWgrxnEABfN5IFsRLpAQAQkujPXhQSF44E9fSByW2G2MNSmWBChMUIJtIQyWFZhOyEVXAhngpZeDcCpxAFsuTJnnn4AGKuigUJRyAgsfrLDABG+MUYoLDTTgliMSkGCCcoooEAGQXhyQQgEjJKDCBRA8pVIKI2oCwjQwRTACpoAQ8EFmY3AgAoq3KYBnFBykMFw4GXSIkwOwvhMCdVqcUKwmJdBKUgnpMdAcFgek+s6AZHBgQn8jZHmFBdzVRMYBy3Kp4xT+B0TCHbJiTPCimS+Q0ONp3Y6x4IEe7LrEjdzxIkaA82WgrxIn/Eqcv0uU0kAEKaRw1SlMsHRgCQMn0U56FHjrzAkCCBWCACf4KcS2+FaMhAuZEFeByC808EG5ADAwqxIQ9odtFYhwx0AKGLmggnjwaGxEAxFOAG/LBvOTmp6m8YNSmAvNl8CXVlgANAAgCGuErVffIcJA/BIXgggmKwGdeAwggNGW1zl7NncXCH3FASIkrUwGey1RIXfkJeGCAl2X2EUDJqhQAggElOCBBXIfAVF/LDhIG8x2MHCBs1hMNcAGG5DA6RLf9FekEr2+KkkICYjQeCcoSJzeCiynsYFdBgJkUIIABUzQQNlnCDkfu0yUYoopR4uhT3/jDBqB3fxkTegBUROnAMtwXXxajoQe4sDVISSf/QsQUR5z5N/bd4IKyzKgQt7lE+GpAnXhpUBs7YcJKQYH8F6/IUEAACH5BAkJADAALAAAAABkAGQAhfyOFPzKjPyuVPzmxPy+dPyeNPzarPz27Py2ZPymRPzSnPzGhPyWJPzu3PzixPzOnPyyZPzChPyiRPzevPz+/Py6dPyqVPzOlPyyXPzq1PzCfPyiPPzetPz69Py6bPyqTPzWrPyaLPySHPzKlPyuXPzmzPy+fPyePPzatPz29Py2bPymTPzSpPzGjPyWLPzy5P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAb+QJhwSCwaj8ikcslsOp/QqHRKrVqv2Kx2y+16v+CweEwum5EUynkd7Uwuo0mHTVemTCEAIGRK1f9FFyJ6eiIjUhQdBygBJgQLIA0daoBPFAWEhCeUTm4qDJmFJCAHnJVKBy6hAAwHTwcLeauEDCoNp0yXq5tOLxWDs6EfGbhLI8CFh00HHsHBw6bFRAd4enyuuQHOzirYXB0ZICgN0VEHb3FzTS+y26sMIOVWvgUMLgUt8lBpUC3uzgLUZWmAKRQGb2QObPjn7FaWDghmGdLnxUE7hqFYaMlwMROJF2ZAgMK4SoMWFKpmJSBW5gEykoRUaOEwctVKMw9qwtTjQQv+wWAQEIoRuTPTAi0UTMxiwIJilxIdYYLY0gGCThcBnHbp8KGoHgYgtxx4IGBDAggG6LDwCkCFQKQvSmQoRUdh0RATtErbR5SkiAhv92LpkBOjiApCBWMZqzPY4bCKvxk4sS1EgMSRs1AYKyCECwagQyRoQS6zGAoZULB4AKKEH9OwY8ueTbu27duyOzRAYQJDAgwmxgXGHYVCgxYFQ+ErTbz4BAHuBOS1xM82BQ7JtxWYroTCCwcXTDxw8EJvsRIpGYYo0X0CBmQMMHCH3YHETgzDh6DITqgAB9koNPYPAyggwY4zIUAWGUReITAcBRq4o4F5dWQggVc3FXHACu7+rIBZMRNEpd4ERmSw0DYbsBSZAenB5EJaRZjozgkqKhagVwzAOE0C7iTwIS4heoWXERC6YwKFdGTAY1EZFnFgMAnSB0GD+cGw3ywFFBjbjTDBkwQF7tUU33ymHWAfTCRUKYR3DoygwQjkIVlJCQIiyF4TaciJC5j8BbOdnriBacFLoYhgAZnN4dnAAn0CsBygicKgGwe9/RbcC2pGqummnHbq6aeghlpcnqJa8p0CLWjwwASSkKFbBhmUd8oLCghA6AYBZAApniAgkIAEG6ygwp11NGCVYxY4sOuXDRBA6B6XLUtFA0tWxoG0RVDgQLWzfLTGC2f+E4JDWbxgwT/+BGBrSWEYEZApFC7944IDZrwAHUknDPBQo7OooG4TEzzrTj5YZCCwSgqCQcEDRXnwmhUoHLzKBsSGQUEERXl7RcQYUYyInEllnPAUJUgcSgLkMnFACRMowAIHJfxIBAUjFNXNYiLOAsG7QnTggAonIHOCB3IwEfBOC/DcRAUMiaAREx2MwO8JF7wrI0khaInFT9Hp1UEEJgMAWHcthJ3JzkiBwK8eTSrBsTsi/KdEBueO+A0HXa0iggoD6HVA3v98IDOYOWcyURfe4SHC4gwUwAJdTIDQ4jYvLsFnZSMoTYXPE0xQApJFkjSh5RlU0GcIGCibWQcqwORWEz4HUAFdBhioAMnDkaUQEUkOWpLCCy8coDkgFDBNUgX/mnaMYQGUOgRUGK3n/JqtM+TB8IkesDYhG4wsKpjc2oSo8xSUAMGzIkBQAvabJsIB0CGEcIIKciTf3AHeT69/qUEAACH5BAkJADAALAAAAABkAGQAhfyOFPzKjPyuVPzmxPy+dPzarPyeNPz27PzSnPy2ZPymRPzGhPyWJPzu3PzixPzOnPyyZPzChPzevPyiRPz+/PzWrPy6dPzOlPyyXPzq1PzCfPzetPyiPPz69PzWpPy6bPyqTPyaLPySHPzKlPyuXPzmzPy+fPzatPyePPz29PzSpPy2bPymTPzGjPyWLPzy5P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAb+QJhwSCwaj0gk5dDYPBaRx6ZxoCSv2Kx2yx2mThYDYExGfU6prnrN5r5WIbKcHFq92vg8m1ICzf9kLCVWeoWGRnwTgIsACoOHkIYHAoyMAgeRmXgPlZUPmqBdL3GdiyF3oalXDyKliyKfqrJFFBiujBiEs7MvLLeLLKhYFMS6u2olHL+AHCVXFC8lJw8PFQ4NxsdZJSjLfyjOSC8qGKRjDCAB2Npayd5zzUgZAgyvCifZ7EYvCu9yCsKGUHAgphODB/n0CbTlbwyEbIluicCnEAmnhrCMHFjR6haLBqAodMjQoEPCfea8nTIiod4vEQE6ZDrQwqUBFSeLXPSWkVb+gncfI1Fo0fGcBC0HSLy7ZKSDi3cMHERK4VIOiZwCSyj6pcBBvgYNcUIqwQxkFj5+SolwlJCsvxFY1WRgFhDLm5R/6tQl4vbdhbhdOhSUswIwkQMbLCiDZ+EEpiQvGlYwvIWCh6IAGJjtsiSDhCcLpGSogkXwuxBShUrAwGHChwwKKUR4h2HvoRePKw7AaxBhxVkdZv8SYPu3phckMDMyANv4rgYClP/hcNT5sQYmeJ9b8cj6sQ4lIgwGECKBBNLe2RE7kCHDC5Pp48ufT7++/fv48+vfn17kAfj8aQKNBAGY8IEJI2zwAmUBnlWBAE/J4QIJHsjUYB4paFDVHwz+RJDbhWq88FMpdmxxgAMbOFCcfR0Q5YoILViYBAUFgGBACAYIQNF+DWhnymZHdPBAhGQcJCN+wv2iwRUlaBdCOPh10M0yKBxZRAuMtKBfBj4yEkJzRyi1CAn6ObChK1ElwRAgGJR5ZilpIoHlIlrmx6VKYBrRJCBP6ielN1UmISSRY7jwgJX2aeDNks8UIMCNKAhQAIPO9fhLCEBC5oAEKjbYonSAwIgoiFgckACocohQIqlqZPhmkRp8yCoXFKgA4RwuCCDWrHu8sMEIBByY4IK86uEfgMUmq+yyzDbr7LPQRqveqNIicYAEF0SgwQgnZFotER2sFkJRISiAQBr+qXQQzQMqjEZpJiks8CoAqq6jyQEBTDnGPejq08ECpdR2nAWAMDCCrLtsMO8cdULy6SIM7HjMAWt2shIkBFWiAMKqnNDlHw0XQsEIpUA5y8ioAvLQIR0QUEoF2gS3DAj96tEBwZ2oELOiv4DAMRsdBFBKaruMvMxVkLRUiQErItGBA9kucIEE1B5RwcJ/RBDJARBUMkLVR5RQTkciGICByVc00M+LaBfSQFpziGBB00V04IGPIagA9hCsuFKYJhlAkJIBC9BNBAUeLy2xoCuUokCeW//6gQUPOLB33WtrfDkMDVT8R1fvqtFBCshyccItJ2gBTQvjxv1a6No07ndgFw2MgAEIIJCwQHf3UZB5JwqEnsLP9VGwWCkcwH4hJa6Q+S0Mc5YSsrQZpEyGCJBHS8EHpVigPIgvQICqCBAY3mwDFrzJgAXZP39ABQmQUkcFxH/r3wH4l/78/vz3T0QQACH5BAkJADAALAAAAABkAGQAhfyOFPzKjPyuVPzmxPy+dPzarPyeNPz27PzSnPy2ZPymRPzGhPyWJPzu3PzixPzOnPyyZPzChPzevPz+/PzWrPy6dPyqVPzOlPyyXPzq1PzCfPzetPyiPPz69PzWpPy6bPyqTPyaLPySHPzKlPyuXPzmzPy+fPzatPyePPz29PzSpPy2bPymTPzGjPyWLPzy5P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAb+QJhwSCwaj8ikcslsOp9QZad08lBOpUN0y+1CDyoMx8UQhVAYldbLbnMnDpAIQK/TRSDJxM3vIzsUDHaDdQwUHX6JfRMUIYSPACEUe4qVXSUKkJAKJZaeUB0EmpoEiJ+nShkuo5AMGahsGRQBEREXFGtLCKyaKrBREx0nJCFlcyIMKCslpkgQvJAQv09wAnOaIgQNlEYc0I8c003CBt8CA9xEjt+DBuMlFA8PHg4pihMn5ewsr0Yo7IPCKZlQYgUHYwwMWDiRjg0cfQBZ5BqCAaAdDEoORBD0SESCbW5SWLBYR0NDFSTp+EJyQBQrCw3cFEhJx0AnIhk4AnSFZML+iGusEjR7I4AmABER0nWoQJKAvSMlvEETcYJNiXU0BcTEKfUbpz8RAIKYGEWFzpQoBhRhhJWVpIZDGoAAaMCBlwVAUzLYYATQ2VaHkmRoy4vBSi4mjN6hcGSCBBZ57YhgoUdJicisRIzwklixiAJJwGBAYcwFBxJqmJT4m3lzlwCYAbqQsOQAFQoeTgx4yiQDRGiGvARSzOGmpRdF2RX30uA3SQxkE/mMDWnFUGAJjIp4ADdRAxbfGKhl44A6Lw5bP00owPpR0jYdVqTc3l1Rhwft62SLzqVBcnYirFBfJcIoEBsHI/DWBhzgfSMCBun9MkEDD5BgAAMJWRBBCQP+vpFBJrwECJI4QkzwQgYllJDBiJUcsAAK1DHAgQodkojKBBksIMAYyITAQQIPsGjjkEO8UIIEJ5wgQQkKEunkk1BGKeWUVFZp5ZVYZvlGCjVq6UcHDrTwAQQftODAdV76QRAGIQBlBgYcpplIBwWYZwiacr5xAmGEhFBAlyUaKWSe30HDQoQ9NbAChgysMKiWEwTAzgg1vlDRRS/kCcMBXZ3X5FoqRCYCjXm+YB4hImSaRAedDWICnleWYJFxR4TySCl5ZmBRPz2ZNYhhgEZpKoCqJvECCYOQUGyaKYAIjQL8EWFiBYxW8EKwUU7QwqSATujAtZrG1SArh4brxXr+fA7iJ6zmjjMcYOy228SabZkBQZzytpFCmBWQ2YIEn+br0AHxCmzwwQgnrPDCDDfs8MMQRywxlPhoAAEGBKQ28R8SyCGZASoU7EYHDaQI7pMdqJDuURFEy0cDC4DAAQcCjCDyJxKsTAcDNltygMf6vUrkBHOxYgCifMTXEaVDnnBqHRFUchUkAiw7jQlP06FAJe8SshyJE1xaGLZO+PqITTaGHR7ZTTiwMghIw8IUNAIlcsB/kkVwsyIUZA0AAZasRgjcRB7gXEd2VUKQAMUwEEICLg/UwAgGiqDACI8qEeooIgjtyb5WMPOGA+PWwYID2HawESQiQBC3lRkUTQhgP1+MwGfnr1fJ6iieO0FyBCxgyIEJZ+b6jyYo8LoxDOVxnvjyzPPy/PKCa8IArRsjN0rV0AtxX34McNe9EAd8gJkIH0QesbYw3oFCC2wzjOMDC0TwQAbxj6///vz3v38QACH5BAkJADAALAAAAABkAGQAhfyOFPzKjPyuVPzmxPy+dPyeNPzarPz27Py2ZPymRPzSpPzGhPyWJPzu3PzixPzOnPyyZPzChPyiRPzevPz+/Py6dPyqVPzOlPyyXPzq1PzCfPyiPPzetPz69Py6bPyqTPzWpPyaLPySHPzKlPyuXPzmzPy+fPyePPzatPz29Py2bPymTPzGjPyWLPzy5PzWrP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAb+QJhwSCwaj8ikcslsOp/QqHRKrUI7pcmk1LF6v9ZOxlNgmBmFSqYLbruRjQgDQK/TGZrGe/92YeyAdCIkLnyGYRWBigAVbIePThQXc4uADBcUkJpLDR+Vih96m6NGKJSfdgwopFMUHQcZEw4NBx2ZSx0LqIoLjqxMFA0KAiKpHigut0gHCLuBCAe/TR0vFsWKDBgOSgckzoAk0dJKFAstuxsoykXM33bQTi4vASwKa3wdLNe7IS/rQx0iuKvTawmFEipEFFMoIsEEX14ogDjnbkMJJKYGqsKloMAiBgsKgWmwYiAdBP+EdBoYasmLEJ9EsIDY6sE+dyIyHKEw4ub+JwYjUhJx4REVgwlfOpQ0SccEkg4evnmgSYSCiW8JhEI54NPdCqowXJDoameQyCQulu4ScdFKCaZ1Cpw10kDDKUsmRClxUHTtAy8c4NIpoDOJGBVlzhTwUEJrkZfuFniZIBgA4SYHsmwR5wQFTGcyvWSofGKuoRInvolQ4OXAXZaO2xzwBFovlQ7N4F4YZdOZii8UXrx2xsD2oxS0PxVo60UsUw2x3zhIXamFArBRKPAdKMA4JAoZMAwHcOIF9ikGPu/6wJxVBwUWToQIUWCFBtNggm/YJaDxOCEHDIACCrNEV8VBHpAFQAgRePcfKeAtsMIJBRRwwgcKNGDgg5r+UOBCA7RsyOGIJJZoIoQUiHjiHh5OcMECESwwwgTJrDiKCyYkEMI+IoSQgAn42ejGARf0pUiPF3AmZBsuRAVaBUEuOcUBEJgEj5RhaKBgJSJocJ6JWJiwwgYrmOAAWMGpN1AL/mB5kDeAiNBfSgf8IRgGStpYwn6LWGTEBFuuhdSSDViASndFEFAZHQQsmU+gAIiwwDrUVbYBoQk4s4JtkK6lIikTUGTUNkMsWkeeJaLgziqlmgoAqiSq+g2rQnSKighfjuPAeIGEQKoQfJJGqFqfJGBbIos2KuSjt7KwDqCViTCokA0IcKhxdVaGJ5YDBBvIBgMYkSZc/Xz6y0H+xMQ55xEB2VpWBLmS2IEDJnywwQdmntfOQCrAimUUDSQImgcO/ivFASMYGUiPI/hr8BQuaLBCCKcwEEKZDj9MhYccPMDCAiw8gIy5GkORIsklp6zyyiy37PLLMMcs88wcvvKhC7bQLAV4ERQVQgUToCyFGA3E26EDxNIRggJCR4KCAAVsgEFhHGaQHCAFcPAIBQrcxADV43SgwScCRPlFCgoDgIDRfBxQqSIhTLvHW98WvEkDkL5wCGWBXPZfA7uwZohrgQjA9h4uqBkIA1obUk6cckvTAbKLtHTIASxQUgDTHFIwgeJ1iBDUdwfIckDTQlBwwOkbd7S4CaifW0JlACp4EIB/Oz/9GQMfjJ7yC2+XV4ULE7wAAgpFq7wdICG0pzMuuT1z+MwNZKqIsc83kYEEi0gAdvbLXG2HBRmDL4Q+C7NgPhPOAVL2+kwEzEAxDBAMfzxamH3//vz37///AFxREAAAO2l6MlNnMjJPaEJTY1lvVkpORFI0dmF6ek1tK1ZrditmL1VXWmxseUxSc0NPYk4vVU5kVVRWeThHRmlpUWNqNWQ=",n.createShowMaskContent=function(e){var t,r,i,o="",s="230px",a="240px",c="",l="";return e&&(e.background&&(o=";background:"+e.background),e.width&&(s=e.width),e.height&&(a=e.height),e.imageSource&&(t=e.imageSource)),t||(t=n.loaderBarSource),i=parseInt(s)/2,n.isNumber(i)&&i>0&&(l=";width:"+i+"px"),r=parseInt(a)/2,n.isNumber(r)&&r>0&&(c=";height:"+r+"px"),['<div align="center" ','class="',n.loaderBarClassName,'" ','style="margin:0 auto;max-width:',s,";max-height:",a,";line-height:",a,o,'"><img style="user-select:none',c,l,';max-width:230px;max-height:240px;vertical-align:middle" src="',t,'" draggable="false" /></div>'].join("")};var r,i=n.win,o=n.doc,s=5e5;function a(e,t){for(var n=0;n<e.length;++n)if(e[n]==t)return h;return d}function c(e){var t;return i.getComputedStyle?t=i.getComputedStyle(e):e.currentStyle&&(t=e.currentStyle),t&&"absolute"!=t.position||"auto"!=e.style.top&&""!=e.style.top||"auto"!=e.style.bottom&&""!=e.style.bottom?d:!function(e){for(var t=0;t<o.styleSheets.length;++t){var n=o.styleSheets[t],r=[],i=void 0,s=void 0,c=void 0;try{r=n.cssRules,i=o.querySelectorAll}catch(f){}if(r&&i)for(var l=0;l<r.length;++l){s=r[l],c=d;try{c=i(s.selectorText)}catch(f){}if(c&&a(c,e)){var u=s.style.getPropertyValue("top"),A=s.style.getPropertyValue("bottom");if(u&&"auto"!=u||A&&"auto"!=A)return h}}}return d}(e)}function l(e){var t=o.createEvent("MouseEvents");return null==t||t.initMouseEvent(e.type,e.bubbles,e.cancelable,i,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),t}function u(e){var t;null===(t=o.body)||void 0===t||t.dispatchEvent(l(e))}function A(e,t){if(r){var n=r.style;n.backgroundColor=["rgba(",t,",",t,",",t,",",e,")"].join(""),n.filter=["alpha(opacity=",100*e,")"].join(""),n.opacity=n.MozOpacity=e}}function f(i,a){r===t?function(t,i){if(r=o.createElement("div")){var a=r.style;a.position="fixed",a.display="block",a.left=a.top=a.margin=a.padding=0,A(t,i),a.zIndex=s,a.width=a.height="100%",e.navInfoSync.bIE&&(r.innerHTML='<iframe src="javascript:\'\'" style="background:none;margin:0px auto;border:0;width:100%;height:100%;position:relative;z-index:9999;"></iframe>'),o.createEvent&&n.addEventListener(r,"click",u)}}(i,a):A(i,a),o.body&&!o.body.contains(r)&&o.body.appendChild(r)}var p={pendingDialogStack:[],opacity:.1,grayHex:128,_updateStacking:function(e){var i,a;0!=(i=this.pendingDialogStack).length?(1!=e&&f(p.opacity,p.grayHex),a=s,n.each(i,(function(e){a++,e._dlgInfo.mask&&(e._dlgInfo.mask.style.zIndex=a++),e.style.zIndex=a}))):r!==t&&(n.removeEventListener(r,"click",u),o&&o.body&&o.body.removeChild(r),r=t)},pushDialog:function(e,t){var r,i=this;e.getBoundingClientRect(),i.pendingDialogStack.length>=1e3?n.error("Too many modal dialogs."):((r=o.createElement("div")).className="dynamsoft-backdrop",1==t?(r.style.left=0,r.style.top=0,r.style.position="absolute"):(r.style.left=0,r.style.top=0,r.style.width="100%",r.style.height="100%",r.style.position="fixed"),o.createEvent&&n.addEventListener(r,"click",(function(t){if(e.dispatchEvent){var n=l(t);e.dispatchEvent(n)}})),e.parentNode.insertBefore(r,e.nextSibling),e._dlgInfo.mask=r,i.pendingDialogStack.push(e),i._updateStacking(t))},removeDialog:function(e){var t,r,i=this;-1!=(t=n.isArray(i.pendingDialogStack)?n.indexOf(e,i.pendingDialogStack):-1)&&(i.pendingDialogStack.splice(t,1),(r=e._dlgInfo.mask).parentNode&&r.parentNode.removeChild(r),e._dlgInfo.mask=null,i._updateStacking())}};function g(e,t){var r,s=this,a=!0,l=1==t?"absolute":"fixed",u="50%",A="50%",f="",d="",g=null;if(s._dlgInfo&&s._dlgInfo.styleConfig){var y=s._dlgInfo.styleConfig;n.isString(y.style)?(r=y.style,a=!1):(n.isString(y.position)&&(l=y.position,a=!1),(n.isString(y.left)||n.isNumber(y.left))&&(A=y.left,a=!1),(n.isString(y.top)||n.isNumber(y.top))&&(u=y.top,a=!1),(n.isString(y.width)||n.isNumber(y.width))&&(f=y.width,a=!1),(n.isString(y.height)||n.isNumber(y.height))&&(d=y.height,a=!1),n.isString(y.transform)&&(g=y.transform,a=!1))}if(s.open)n.error("showDialog called on open dialog.");else{if(s.open=h,s.removeAttribute("closed"),s.setAttribute("open","open"),r)s.setAttribute("style",r);else{var m=void 0;a?m=["display:block;position:",l,";left:50%;top:50%;transform:translate(-50%,-50%)"]:(m=["display:block;position:",l,";left:",A,";top:",u,";width:",f,";height:",d],g&&(m.push(";transform:"),m.push(g))),"DIALOG"==s.tagName?m.push(";margin:0;border-radius:6px;box-shadow:2px 2px 0 0 rgba(0,0,0,.05);-webkit-box-sizing:border-box;box-sizing:border-box;"):m.push(";border:0;margin:0;-webkit-box-sizing:border-box;box-sizing:border-box;"),s.setAttribute("style",m.join(""))}c(s)&&function(e){var t,n,r,s;s=((null===(t=o.body)||void 0===t?void 0:t.scrollTop)||(null===(n=o.documentElement)||void 0===n?void 0:n.scrollTop)||0)+((i.innerHeight?i.innerHeight:null===(r=o.documentElement)||void 0===r?void 0:r.clientHeight)-e.offsetHeight)/2,e.style.top=s+"px",e._dlgInfo.isTopOverridden=h}(s),e&&(s._dlgInfo.modal=h,p.pushDialog(s,t))}}function y(e){var t=this;return t.open||n.error("closeDialog called on closed dialog."),t.open=d,t.removeAttribute("open"),t.setAttribute("closed","closed"),t.style.display="none",void 0!==e&&(t.returnValue=e),t._dlgInfo.isTopOverridden&&(t.style.top="auto"),t._dlgInfo.modal&&p.removeDialog(t),t.returnValue}n.dialog={setup:function(e,t){e.show=g.bind(e,d,t),e.showModal=g.bind(e,h,t),e.close=y.bind(e),e._dlgInfo={}}},n.mask={dlgMask:!1,preOnresize:!1,preOnscroll:!1},n.setBackOpacity=function(e){n.isNumber(e.opacity)?p.opacity=e.opacity:p.opacity=.1,n.isNumber(e.grayHex)?p.grayHex=e.grayHex:p.grayHex=128},n.showMask=function(t){var r,i,s,a,c;if(!n.mask.dlgMask&&!n.dlgLoadingShowStatus){var l,u,A,f,h=!1;if(t&&(f={},t.style?f.style=t.style:((n.isString(t.top)||n.isNumber(t.top))&&(f.top=t.top),(n.isString(t.left)||n.isNumber(t.left))&&(f.left=t.left),n.isString(t.position)&&(f.position=t.position)),t.confined&&(h=t.confined),(n.isString(t.width)||n.isNumber(t.width))&&(i=t.width),(n.isString(t.height)||n.isNumber(t.height))&&(s=t.height),n.isString(t.background)&&(a=t.background),n.isString(t.imageSource)&&(c=t.imageSource),n.setBackOpacity(t),h&&t.wrapperEl&&(u=t.wrapperEl,n.isString(u)&&(u=o.getElementById(u)))),!c){var d=void 0;e.DWT&&e.DWT.CustomizableDisplayInfo&&(d=e.DWT.CustomizableDisplayInfo),c=d&&n.isString(d.loaderBarSource)&&""!=d.loaderBarSource?d.loaderBarSource:e.navInfoSync.bIE?n.loaderBarSourceIE:n.loaderBarSource}u&&(A=u.getBoundingClientRect(),u.style.position="relative"),(l=o.createElement("div"))&&(l.className="dynamsoft-dialog-wrap",l.innerHTML=n.createShowMaskContent({width:i,height:s,backgroundColor:a,imageSource:c}),u?(u.appendChild(l),l.style.position="absolute",l.style.top="50%",l.style.left="50%",l.style.transform="translate(-50%, -50%)"):null===(r=o.body)||void 0===r||r.appendChild(l),h&&A&&(window.onresize?n.mask.preOnresize=window.onresize:n.mask.preOnresize=!1,window.onscroll?n.mask.preOnscroll=window.onscroll:n.mask.preOnscroll=!1),n.mask.dlgMask=l,n.dialog.setup(l,h),f&&(l._dlgInfo.styleConfig=f),u&&(l._dlgInfo.wrapperEl=u),l.showModal())}},n.hideMask=function(){var e,t=n.mask.dlgMask;t&&(t.close(),t._dlgInfo&&t._dlgInfo.wrapperEl?(t._dlgInfo.wrapperEl.removeChild(t),t._dlgInfo.wrapperEl=null):null===(e=o.body)||void 0===e||e.removeChild(t),n.mask.dlgMask=!1),n.mask.preOnresize?window.onresize=n.mask.preOnresize:window.onresize=null,n.mask.preOnresize=!1,n.mask.preOnscroll?window.onscroll=n.mask.preOnscroll:window.onscroll=null,n.mask.preOnscroll=!1}}(t),function(e){var t,n,r,i,o=e.Lib,s=window.document,a=[],c=a.push,l=a.slice,u=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,A=function(){n()};try{c.apply(l.call(s.childNodes),s.childNodes)}catch(h){return}function f(e,t,o,a){var l,A,f,h=t&&t.ownerDocument,d=t?t.nodeType:9;if(o=o||[],"string"!=typeof e||!e||1!==d&&9!==d&&11!==d)return o;if(!a&&((t?t.ownerDocument||t:s)!==r&&n(t),t=t||r,11!==d&&(f=u.exec(e))))if(l=f[1]){if(9===d){if(!(A=t.getElementById(l)))return o;if(A.id===l)return o.push(A),o}else if(h&&(A=h.getElementById(l))&&i(t,A)&&A.id===l)return o.push(A),o}else{if(f[2])return c.apply(o,t.getElementsByTagName(e)),o;if((l=f[3])&&t.getElementsByClassName)return c.apply(o,t.getElementsByClassName(l)),o}return o}n=f.setDocument=function(e){var t,n=e?e.ownerDocument||e:s;return n!==r&&9===n.nodeType&&n.documentElement?(s!==(r=n)&&(t=r.defaultView)&&t.top!==t&&(t.addEventListener?t.addEventListener("unload",A,!1):t.attachEvent&&t.attachEvent("onunload",A)),i=function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},r):r},f.contains=function(e,t){return(e.ownerDocument||e)!==r&&n(e),i(e,t)},f.error=function(e){throw new Error("Syntax error: "+e)},t=f.getText=function(e){var n,r="",i=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)r+=t(e)}else if(3===o||4===o)return e.nodeValue}else for(;n=e[i++];)r+=t(n);return r},n(),o.sizzle=f}(t),function(e){var t,n,r=e.Lib,i=r.doc,o=r.each,s=new je(i),a=s.docElem,c=r.sizzle,l=/^margin/,u=/^(top|right|bottom|left)$/,A=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,f=new RegExp("^("+A+")(?!px)[a-z%]+$","i"),h=new RegExp("^("+A+")(.*)$","i");window.getComputedStyle?(t=function(e){var t,n;return(n=(t=r.isFunction(e.getEL)?e.getEL():e).ownerDocument.defaultView)&&n.opener||(n=window),n.getComputedStyle(t)},n=function(e,n,i){var o,a,u,A,h=e.style;return""!==(A=(i=i||t(e))?i.getPropertyValue(n)||i[n]:undefined)&&A!==undefined||c.contains(e.ownerDocument,e)||(A=r.style(e,n)),i&&!s.pixelMarginRight()&&f.test(A)&&l.test(n)&&(o=h.width,a=h.minWidth,u=h.maxWidth,h.minWidth=h.maxWidth=h.width=A,A=i.width,h.width=o,h.minWidth=a,h.maxWidth=u),A===undefined?A:A+""}):a&&a.currentStyle&&(t=function(e){return e.currentStyle},n=function(e,n,r){var i,o,s,a,c=e.style;return null==(a=(r=r||t(e))?r[n]:undefined)&&c&&c[n]&&(a=c[n]),f.test(a)&&!u.test(n)&&(i=c.left,(s=(o=e.runtimeStyle)&&o.left)&&(o.left=e.currentStyle.left),c.left="fontSize"===n?"1em":a,a=c.pixelLeft+"px",c.left=i,s&&(o.left=s)),a===undefined?a:a+""||"auto"});var d,p=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,g=/<([\w:-]+)/,y=/^\s+/,m=/<|&#?\w+;/,C=/<tbody/i,b=/^-ms-/,w=/-([\da-z])/gi,v=/^(none|table(?!-c[ea]).+)/,P=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,I={position:"absolute",visibility:"hidden",display:"block"},E={letterSpacing:"0",fontWeight:"400"},S=["Top","Right","Bottom","Left"],B={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:s.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},x=["Webkit","O","Moz","ms"],k="abbr|article|aside|audio|bdi|canvas|data|datalist|details|dialog|figcaption|figure|footer|header|hgroup|main|mark|meter|nav|output|picture|progress|section|summary|template|time|video",z=document.createElement("div");if(z.style){d=z.style,s.cssFloat=!!z.style.cssFloat;var Q=function(e,t){return t.toUpperCase()},L={type:r.type,cssHooks:{},htmlPrefilter:function(e){return e.replace(p,"<$1></$2>")},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;)e[i++]=t[r++];if(n!=n)for(;t[r]!==undefined;)e[i++]=t[r++];return e.length=i,e},camelCase:function(e){return e.replace(b,"ms-").replace(w,Q)},cssProps:{},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0}},F=["flo","at"].join("");L.cssProps[F]=s.cssFloat?"cssFloat":"styleFloat",o(["height","width"],(function(e,n){L.cssHooks[e]={get:function(t,n,i){if(n)return v.test(r.css(t,"display"))&&0===t.offsetWidth?function(e,t,n,r){var i,s={};return o(t,(function(n,r){s[r]=e.style[r],e.style[r]=t[r]})),i=n.apply(e,r||[]),o(t,(function(t,n){e.style[n]=s[n]})),i}(t,I,(function(){return j(t,e,i)})):j(t,e,i)},set:function(n,i,o){var a=o&&t(n);return function(e,t,n){var r=h.exec(t);return r?Math.max(0,parseInt(r[1])-(n||0))+(r[2]||"px"):t}(0,i,o?M(n,e,o,s.boxSizing&&"border-box"===r.css(n,"boxSizing",!1,a),a):0)}}})),r.style=function(e,t,n,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,a,c,l=L.camelCase(t),u=e.style;if(t=L.cssProps[l]||(L.cssProps[l]=T(l)||l),c=L.cssHooks[t]||L.cssHooks[l],n===undefined)return c&&"get"in c&&(o=c.get(e,!1,i))!==undefined?o:u[t]+"";"string"==(a=typeof n)&&(o=R(n))&&o[1]&&(n=function(e,t,n,i){var o,s=1,a=20,c=i?function(){return i.cur()}:function(){return r.css(e,t,"")},l=c(),u=n&&n[3]||(L.cssNumber[t]?"":"px"),A=(L.cssNumber[t]||"px"!==u&&+l)&&R(r.css(e,t));if(A&&A[3]!==u){u=u||A[3],n=n||[],A=+l||1;do{A/=s=s||".5",r.style(e,t,A+u)}while(s!==(s=c()/l)&&1!==s&&--a)}return n&&(A=+A||+l||0,o=n[1]?A+(n[1]+1)*n[2]:+n[2],i&&(i.unit=u,i.start=A,i.end=o)),o}(e,t,o),a="number"),null!=n&&n==n&&("number"===a&&(n+=o&&o[3]||(L.cssNumber[l]?"":"px")),s.clearCloneStyle||""!==n||0!==t.indexOf("background")||(u[t]="inherit"),c&&"set"in c&&(n=c.set(e,n,i))===undefined||(u[t]=n))}},r.css=function(e,t,r,i){var o,s,a,c=L.camelCase(t);return t=L.cssProps[c]||(L.cssProps[c]=T(c)||c),(a=L.cssHooks[t]||L.cssHooks[c])&&"get"in a&&(s=a.get(e,!0,r)),s===undefined&&(s=n(e,t,i)),"normal"===s&&t in E&&(s=E[t]),""===r||r?(o=parseFloat(s),!0===r||isFinite(o)?o||0:s):s},r.parseHTML=function(e,t){if(!e||"string"!=typeof e)return[];"boolean"==typeof t&&(t=!1),t=t||document;var n=P.exec(e);return n?[t.createElement(n[1])]:(n=D([e],t),L.merge([],n.childNodes))},r.support=s}function T(e){if(e in d)return e;for(var t=e.charAt(0).toUpperCase()+e.slice(1),n=x.length;n--;)if((e=x[n]+t)in d)return e}function D(e,t){for(var n,i,o,a,l,u,A=e.length,f=function(e){var t=k.split("|"),n=e.createDocumentFragment();if(n.createElement)for(;t.length;)n.createElement(t.pop());return n}(t),h=[],d=0;d<A;d++)if((i=e[d])||0===i)if("object"===r.type(i))L.merge(h,i.nodeType?[i]:i);else if(m.test(i)){if(o=o||f.appendChild(t.createElement("div"))){for(a=(g.exec(i)||["",""])[1].toLowerCase(),u=B[a]||B._default,o.innerHTML=u[1]+L.htmlPrefilter(i)+u[2],n=u[0];n--;)o=o.lastChild;if(!s.leadingWhitespace&&y.test(i)){var p=y.exec(i);p&&p.length>0&&h.push(t.createTextNode(p[0]))}if(!s.tbody&&(n=(i="table"!==a||C.test(i)?"<table>"!==u[1]||C.test(i)?0:o:o.firstChild)&&i.childNodes.length,i))for(;n--;)L.nodeName(l=i.childNodes[n],"tbody")&&!l.childNodes.length&&i.removeChild(l);for(L.merge(h,o.childNodes),o.textContent="";o.firstChild;)o.removeChild(o.firstChild);o=f.lastChild}}else h.push(t.createTextNode(i));for(o&&f&&f.removeChild(o),d=0;i=h[d++];)"SCRIPT"!==i.tagName&&(c.contains(i.ownerDocument,i),f.appendChild(i));return o=null,f}function M(e,t,n,i,o){for(var s=n===(i?"border":"content")?4:"width"===t?1:0,a=0;s<4;s+=2)"margin"===n&&(a+=r.css(e,n+S[s],!0,o)),i?("content"===n&&(a-=r.css(e,"padding"+S[s],!0,o)),"margin"!==n&&(a-=r.css(e,"border"+S[s]+"Width",!0,o))):(a+=r.css(e,"padding"+S[s],!0,o),"padding"!==n&&(a+=r.css(e,"border"+S[s]+"Width",!0,o)));return a}function j(e,i,o){var a=!0,c="width"===i?e.offsetWidth:e.offsetHeight,l=t(e),u=s.boxSizing&&"border-box"===r.css(e,"boxSizing",!1,l);if(c<=0||null==c){if(((c=n(e,i,l))<0||null==c)&&(c=e.style[i]),f.test(c))return c;a=u&&(s.boxSizingReliable()||c===e.style[i]),c=parseFloat(c)||0}return c+M(e,i,o||(u?"border":"content"),a,l)}function R(e){return new RegExp("^(?:([+-])=|)("+A+")([a-z%]*)$","i").exec(e)}}(t),t.Lib.wakeLock={toggle:Ge,getWakeLock:We})}();
!function(e){"object"==typeof module&&"object"==typeof module.exports&&("function"==typeof Object.create?Object.defineProperty(module.exports,"__esModule",{value:!0}):module.exports.__esModule=!0,module.exports.default=e)}(globalThis.Dynamsoft);
(function(b){if(!b.DWT){b.DWT={}}if(!b.DWT.LTS){b.DWT.LTS={}}if(!b.Lib.UI){b.Lib.UI={}}if(!b.Lib.html5){b.Lib.html5={}}})(Dynamsoft);
(function(e){if(!e.WeakSet){e.WeakSet=b;var c=Date.now()%1E9;function b(a){this.name="__st"+(1E9*Math.random()>>>0)+(c++ +"__");a&&a.forEach&&a.forEach(this.add,this)}var z=b.prototype;z.add=function(a){var d=this.name;a[d]||Object.defineProperty(a,d,{value:!0,writable:!0});return this};z["delete"]=function(a){if(!a[this.name])return!1;a[this.name]=void 0;return!0};z.has=function(a){return!!a[this.name]};}
if(!e.WeakMap){var r=Object.prototype.hasOwnProperty;var n=Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{value:1}).x===1}catch(e){}}();var i=function(e,t,r){if(n){Object.defineProperty(e,t,{configurable:true,writable:true,value:r})}else{e[t]=r}};e.WeakMap=function(){function WeakMap(){if(this===void 0){throw new TypeError("Constructor WeakMap requires 'new'")}i(this,"_id",genId("_WeakMap"));if(arguments.length>0){throw new TypeError("WeakMap iterable is not supported")}}i(WeakMap.prototype,"delete",function(e){checkInstance(this,"delete");if(!isObject(e)){return false}var t=e[this._id];if(t&&t[0]===e){delete e[this._id];return true}return false});i(WeakMap.prototype,"get",function(e){checkInstance(this,"get");if(!isObject(e)){return void 0}var t=e[this._id];if(t&&t[0]===e){return t[1]}return void 0});i(WeakMap.prototype,"has",function(e){checkInstance(this,"has");if(!isObject(e)){return false}var t=e[this._id];if(t&&t[0]===e){return true}return false});i(WeakMap.prototype,"set",function(e,t){checkInstance(this,"set");if(!isObject(e)){throw new TypeError("Invalid value used as weak map key")}var r=e[this._id];if(r&&r[0]===e){r[1]=t;return this}i(e,this._id,[e,t]);return this});function checkInstance(e,t){if(!isObject(e)||!r.call(e,"_id")){throw new TypeError(t+" method called on incompatible receiver "+typeof e)}}function genId(e){return e+"_"+rand()+"."+rand()}function rand(){return Math.random().toString().substring(2)}i(WeakMap,"_polyfill",true);return WeakMap}();function isObject(e){return Object(e)===e}}})(typeof globalThis!=="undefined"?globalThis:typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof global!=="undefined"?global:this);
(function(factory){if(typeof exports==="object"){module.exports=factory()}else if(typeof define==="function"&&define.amd){define(factory)}else{var glob;try{glob=window}catch(e){glob=self}glob.SparkMD5=factory()}})(function(undefined){"use strict";var add32=function(a,b){return a+b&4294967295},hex_chr=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function cmn(q,a,b,x,s,t){a=add32(add32(a,q),add32(x,t));return add32(a<<s|a>>>32-s,b)}function md5cycle(x,k){var a=x[0],b=x[1],c=x[2],d=x[3];a+=(b&c|~b&d)+k[0]-680876936|0;a=(a<<7|a>>>25)+b|0;d+=(a&b|~a&c)+k[1]-389564586|0;d=(d<<12|d>>>20)+a|0;c+=(d&a|~d&b)+k[2]+606105819|0;c=(c<<17|c>>>15)+d|0;b+=(c&d|~c&a)+k[3]-1044525330|0;b=(b<<22|b>>>10)+c|0;a+=(b&c|~b&d)+k[4]-176418897|0;a=(a<<7|a>>>25)+b|0;d+=(a&b|~a&c)+k[5]+1200080426|0;d=(d<<12|d>>>20)+a|0;c+=(d&a|~d&b)+k[6]-1473231341|0;c=(c<<17|c>>>15)+d|0;b+=(c&d|~c&a)+k[7]-45705983|0;b=(b<<22|b>>>10)+c|0;a+=(b&c|~b&d)+k[8]+1770035416|0;a=(a<<7|a>>>25)+b|0;d+=(a&b|~a&c)+k[9]-1958414417|0;d=(d<<12|d>>>20)+a|0;c+=(d&a|~d&b)+k[10]-42063|0;c=(c<<17|c>>>15)+d|0;b+=(c&d|~c&a)+k[11]-1990404162|0;b=(b<<22|b>>>10)+c|0;a+=(b&c|~b&d)+k[12]+1804603682|0;a=(a<<7|a>>>25)+b|0;d+=(a&b|~a&c)+k[13]-40341101|0;d=(d<<12|d>>>20)+a|0;c+=(d&a|~d&b)+k[14]-1502002290|0;c=(c<<17|c>>>15)+d|0;b+=(c&d|~c&a)+k[15]+1236535329|0;b=(b<<22|b>>>10)+c|0;a+=(b&d|c&~d)+k[1]-165796510|0;a=(a<<5|a>>>27)+b|0;d+=(a&c|b&~c)+k[6]-1069501632|0;d=(d<<9|d>>>23)+a|0;c+=(d&b|a&~b)+k[11]+643717713|0;c=(c<<14|c>>>18)+d|0;b+=(c&a|d&~a)+k[0]-373897302|0;b=(b<<20|b>>>12)+c|0;a+=(b&d|c&~d)+k[5]-701558691|0;a=(a<<5|a>>>27)+b|0;d+=(a&c|b&~c)+k[10]+38016083|0;d=(d<<9|d>>>23)+a|0;c+=(d&b|a&~b)+k[15]-660478335|0;c=(c<<14|c>>>18)+d|0;b+=(c&a|d&~a)+k[4]-405537848|0;b=(b<<20|b>>>12)+c|0;a+=(b&d|c&~d)+k[9]+568446438|0;a=(a<<5|a>>>27)+b|0;d+=(a&c|b&~c)+k[14]-1019803690|0;d=(d<<9|d>>>23)+a|0;c+=(d&b|a&~b)+k[3]-187363961|0;c=(c<<14|c>>>18)+d|0;b+=(c&a|d&~a)+k[8]+1163531501|0;b=(b<<20|b>>>12)+c|0;a+=(b&d|c&~d)+k[13]-1444681467|0;a=(a<<5|a>>>27)+b|0;d+=(a&c|b&~c)+k[2]-51403784|0;d=(d<<9|d>>>23)+a|0;c+=(d&b|a&~b)+k[7]+1735328473|0;c=(c<<14|c>>>18)+d|0;b+=(c&a|d&~a)+k[12]-1926607734|0;b=(b<<20|b>>>12)+c|0;a+=(b^c^d)+k[5]-378558|0;a=(a<<4|a>>>28)+b|0;d+=(a^b^c)+k[8]-2022574463|0;d=(d<<11|d>>>21)+a|0;c+=(d^a^b)+k[11]+1839030562|0;c=(c<<16|c>>>16)+d|0;b+=(c^d^a)+k[14]-35309556|0;b=(b<<23|b>>>9)+c|0;a+=(b^c^d)+k[1]-1530992060|0;a=(a<<4|a>>>28)+b|0;d+=(a^b^c)+k[4]+1272893353|0;d=(d<<11|d>>>21)+a|0;c+=(d^a^b)+k[7]-155497632|0;c=(c<<16|c>>>16)+d|0;b+=(c^d^a)+k[10]-1094730640|0;b=(b<<23|b>>>9)+c|0;a+=(b^c^d)+k[13]+681279174|0;a=(a<<4|a>>>28)+b|0;d+=(a^b^c)+k[0]-358537222|0;d=(d<<11|d>>>21)+a|0;c+=(d^a^b)+k[3]-722521979|0;c=(c<<16|c>>>16)+d|0;b+=(c^d^a)+k[6]+76029189|0;b=(b<<23|b>>>9)+c|0;a+=(b^c^d)+k[9]-640364487|0;a=(a<<4|a>>>28)+b|0;d+=(a^b^c)+k[12]-421815835|0;d=(d<<11|d>>>21)+a|0;c+=(d^a^b)+k[15]+530742520|0;c=(c<<16|c>>>16)+d|0;b+=(c^d^a)+k[2]-995338651|0;b=(b<<23|b>>>9)+c|0;a+=(c^(b|~d))+k[0]-198630844|0;a=(a<<6|a>>>26)+b|0;d+=(b^(a|~c))+k[7]+1126891415|0;d=(d<<10|d>>>22)+a|0;c+=(a^(d|~b))+k[14]-1416354905|0;c=(c<<15|c>>>17)+d|0;b+=(d^(c|~a))+k[5]-57434055|0;b=(b<<21|b>>>11)+c|0;a+=(c^(b|~d))+k[12]+1700485571|0;a=(a<<6|a>>>26)+b|0;d+=(b^(a|~c))+k[3]-1894986606|0;d=(d<<10|d>>>22)+a|0;c+=(a^(d|~b))+k[10]-1051523|0;c=(c<<15|c>>>17)+d|0;b+=(d^(c|~a))+k[1]-2054922799|0;b=(b<<21|b>>>11)+c|0;a+=(c^(b|~d))+k[8]+1873313359|0;a=(a<<6|a>>>26)+b|0;d+=(b^(a|~c))+k[15]-30611744|0;d=(d<<10|d>>>22)+a|0;c+=(a^(d|~b))+k[6]-1560198380|0;c=(c<<15|c>>>17)+d|0;b+=(d^(c|~a))+k[13]+1309151649|0;b=(b<<21|b>>>11)+c|0;a+=(c^(b|~d))+k[4]-145523070|0;a=(a<<6|a>>>26)+b|0;d+=(b^(a|~c))+k[11]-1120210379|0;d=(d<<10|d>>>22)+a|0;c+=(a^(d|~b))+k[2]+718787259|0;c=(c<<15|c>>>17)+d|0;b+=(d^(c|~a))+k[9]-343485551|0;b=(b<<21|b>>>11)+c|0;x[0]=a+x[0]|0;x[1]=b+x[1]|0;x[2]=c+x[2]|0;x[3]=d+x[3]|0}function md5blk(s){var md5blks=[],i;for(i=0;i<64;i+=4){md5blks[i>>2]=s.charCodeAt(i)+(s.charCodeAt(i+1)<<8)+(s.charCodeAt(i+2)<<16)+(s.charCodeAt(i+3)<<24)}return md5blks}function md5blk_array(a){var md5blks=[],i;for(i=0;i<64;i+=4){md5blks[i>>2]=a[i]+(a[i+1]<<8)+(a[i+2]<<16)+(a[i+3]<<24)}return md5blks}function md51(s){var n=s.length,state=[1732584193,-271733879,-1732584194,271733878],i,length,tail,tmp,lo,hi;for(i=64;i<=n;i+=64){md5cycle(state,md5blk(s.substring(i-64,i)))}s=s.substring(i-64);length=s.length;tail=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(i=0;i<length;i+=1){tail[i>>2]|=s.charCodeAt(i)<<(i%4<<3)}tail[i>>2]|=128<<(i%4<<3);if(i>55){md5cycle(state,tail);for(i=0;i<16;i+=1){tail[i]=0}}tmp=n*8;tmp=tmp.toString(16).match(/(.*?)(.{0,8})$/);lo=parseInt(tmp[2],16);hi=parseInt(tmp[1],16)||0;tail[14]=lo;tail[15]=hi;md5cycle(state,tail);return state}function md51_array(a){var n=a.length,state=[1732584193,-271733879,-1732584194,271733878],i,length,tail,tmp,lo,hi;for(i=64;i<=n;i+=64){md5cycle(state,md5blk_array(a.subarray(i-64,i)))}a=i-64<n?a.subarray(i-64):new Uint8Array(0);length=a.length;tail=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(i=0;i<length;i+=1){tail[i>>2]|=a[i]<<(i%4<<3)}tail[i>>2]|=128<<(i%4<<3);if(i>55){md5cycle(state,tail);for(i=0;i<16;i+=1){tail[i]=0}}tmp=n*8;tmp=tmp.toString(16).match(/(.*?)(.{0,8})$/);lo=parseInt(tmp[2],16);hi=parseInt(tmp[1],16)||0;tail[14]=lo;tail[15]=hi;md5cycle(state,tail);return state}function rhex(n){var s="",j;for(j=0;j<4;j+=1){s+=hex_chr[n>>j*8+4&15]+hex_chr[n>>j*8&15]}return s}function hex(x){var i;for(i=0;i<x.length;i+=1){x[i]=rhex(x[i])}return x.join("")}if(hex(md51("hello"))!=="5d41402abc4b2a76b9719d911017c592"){add32=function(x,y){var lsw=(x&65535)+(y&65535),msw=(x>>16)+(y>>16)+(lsw>>16);return msw<<16|lsw&65535}}if(typeof ArrayBuffer!=="undefined"&&!ArrayBuffer.prototype.slice){(function(){function clamp(val,length){val=val|0||0;if(val<0){return Math.max(val+length,0)}return Math.min(val,length)}ArrayBuffer.prototype.slice=function(from,to){var length=this.byteLength,begin=clamp(from,length),end=length,num,target,targetArray,sourceArray;if(to!==undefined){end=clamp(to,length)}if(begin>end){return new ArrayBuffer(0)}num=end-begin;target=new ArrayBuffer(num);targetArray=new Uint8Array(target);sourceArray=new Uint8Array(this,begin,num);targetArray.set(sourceArray);return target}})()}function toUtf8(str){if(/[\u0080-\uFFFF]/.test(str)){str=unescape(encodeURIComponent(str))}return str}function utf8Str2ArrayBuffer(str,returnUInt8Array){var length=str.length,buff=new ArrayBuffer(length),arr=new Uint8Array(buff),i;for(i=0;i<length;i+=1){arr[i]=str.charCodeAt(i)}return returnUInt8Array?arr:buff}function arrayBuffer2Utf8Str(buff){return String.fromCharCode.apply(null,new Uint8Array(buff))}function concatenateArrayBuffers(first,second,returnUInt8Array){var result=new Uint8Array(first.byteLength+second.byteLength);result.set(new Uint8Array(first));result.set(new Uint8Array(second),first.byteLength);return returnUInt8Array?result:result.buffer}function hexToBinaryString(hex){var bytes=[],length=hex.length,x;for(x=0;x<length-1;x+=2){bytes.push(parseInt(hex.substr(x,2),16))}return String.fromCharCode.apply(String,bytes)}function SparkMD5(){this.reset()}SparkMD5.prototype.append=function(str){this.appendBinary(toUtf8(str));return this};SparkMD5.prototype.appendBinary=function(contents){this._buff+=contents;this._length+=contents.length;var length=this._buff.length,i;for(i=64;i<=length;i+=64){md5cycle(this._hash,md5blk(this._buff.substring(i-64,i)))}this._buff=this._buff.substring(i-64);return this};SparkMD5.prototype.end=function(raw){var buff=this._buff,length=buff.length,i,tail=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ret;for(i=0;i<length;i+=1){tail[i>>2]|=buff.charCodeAt(i)<<(i%4<<3)}this._finish(tail,length);ret=hex(this._hash);if(raw){ret=hexToBinaryString(ret)}this.reset();return ret};SparkMD5.prototype.reset=function(){this._buff="";this._length=0;this._hash=[1732584193,-271733879,-1732584194,271733878];return this};SparkMD5.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}};SparkMD5.prototype.setState=function(state){this._buff=state.buff;this._length=state.length;this._hash=state.hash;return this};SparkMD5.prototype.destroy=function(){delete this._hash;delete this._buff;delete this._length};SparkMD5.prototype._finish=function(tail,length){var i=length,tmp,lo,hi;tail[i>>2]|=128<<(i%4<<3);if(i>55){md5cycle(this._hash,tail);for(i=0;i<16;i+=1){tail[i]=0}}tmp=this._length*8;tmp=tmp.toString(16).match(/(.*?)(.{0,8})$/);lo=parseInt(tmp[2],16);hi=parseInt(tmp[1],16)||0;tail[14]=lo;tail[15]=hi;md5cycle(this._hash,tail)};SparkMD5.hash=function(str,raw){return SparkMD5.hashBinary(toUtf8(str),raw)};SparkMD5.hashBinary=function(content,raw){var hash=md51(content),ret=hex(hash);return raw?hexToBinaryString(ret):ret};SparkMD5.ArrayBuffer=function(){this.reset()};SparkMD5.ArrayBuffer.prototype.append=function(arr){var buff=concatenateArrayBuffers(this._buff.buffer,arr,true),length=buff.length,i;this._length+=arr.byteLength;for(i=64;i<=length;i+=64){md5cycle(this._hash,md5blk_array(buff.subarray(i-64,i)))}this._buff=i-64<length?new Uint8Array(buff.buffer.slice(i-64)):new Uint8Array(0);return this};SparkMD5.ArrayBuffer.prototype.end=function(raw){var buff=this._buff,length=buff.length,tail=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],i,ret;for(i=0;i<length;i+=1){tail[i>>2]|=buff[i]<<(i%4<<3)}this._finish(tail,length);ret=hex(this._hash);if(raw){ret=hexToBinaryString(ret)}this.reset();return ret};SparkMD5.ArrayBuffer.prototype.reset=function(){this._buff=new Uint8Array(0);this._length=0;this._hash=[1732584193,-271733879,-1732584194,271733878];return this};SparkMD5.ArrayBuffer.prototype.getState=function(){var state=SparkMD5.prototype.getState.call(this);state.buff=arrayBuffer2Utf8Str(state.buff);return state};SparkMD5.ArrayBuffer.prototype.setState=function(state){state.buff=utf8Str2ArrayBuffer(state.buff,true);return SparkMD5.prototype.setState.call(this,state)};SparkMD5.ArrayBuffer.prototype.destroy=SparkMD5.prototype.destroy;SparkMD5.ArrayBuffer.prototype._finish=SparkMD5.prototype._finish;SparkMD5.ArrayBuffer.hash=function(arr,raw){var hash=md51_array(new Uint8Array(arr)),ret=hex(hash);return raw?hexToBinaryString(ret):ret};return SparkMD5});
!function(){"use strict";var e=globalThis.Dynamsoft,r=e.Lib;function t(e){return Math.floor(e)}var n="18",i="2",o="0328",a="2",s=e.navInfoSync.bAndroid?"local.dynamsoft.com":"127.0.0.1",u="".concat(n,",").concat(i,",").concat("0",",").concat(o),c={JSVersion:"".concat(n,",").concat(a,",").concat("0",",").concat("0328"),ServerVersionInfo:u,ServerLinuxVersionInfo:u,ServerMacVersionInfo:u,ActiveXVersion:"18,0,0,1025",ActiveXPdfVersion:"11.4.1.1025",PdfVersion:"11.4.1.1025",ProductName:"Dynamic Web TWAIN "+[n,a].join("."),Containers:undefined,ContainerMap:{},WebTwainIdMap:{},RemoteScanIdMap:{},Trial:!1,ResourcesPath:"Resources",Debug:!1,IfUpdateService:!1,AutoLoad:!0,ReConnectToService:!0,OnWebTwainReady:!1,OnWebTwainNotFound:!1,OnWebTwainOldPluginNotAllowed:!1,OnWebTwainNeedUpgrade:!1,OnWebTwainNeedUpgradeWebJavascript:!1,OnWebTwainInitMessage:!1,ViewerJSIntegerited:!0,ActiveXInstallWithCAB:!1,IfUseActiveXForIE10Plus:!1,IfUseEmbeddedDownloadNoticeForActiveX:!1,IfCheckDCP:!1,IfDisableDefaultSettings:!1,OnWebTwainWillInit:!1,IfAddMD5InUploadHeader:!1,IfAlwaysFocusOnPopupWindow:!0,IfConfineMaskWithinTheViewer:!1,fetchOptions:{mode:"cors",credentials:"same-origin"},HideTrialMessage:!1,CheckCertExpired:!0,ConnectWithSocket:!1,SSLPort:18623,Port:18622,showLoadingMsgDialog:!0,licenseServer:undefined,sessionPassword:undefined,organizationID:undefined,handshakeCode:undefined,UseDefaultViewer:!0,Host:s},l={URL:"",UpdateDaysBeforeExpired:30},d={loaderBarClassName:"ds-dwt-loaderBar",loaderBarBackgroundColor:"",loaderBarSource:e.navInfoSync.bIE?e.Lib.loaderBarSourceIE:e.Lib.loaderBarSource,errorMessages:{ERR_MODULE_NOT_INSTALLED:"Error: The Dynamic Web TWAIN module is not installed.",ERR_BROWSER_NOT_SUPPORT:"Error: This browser is currently not supported.",ERR_CreateID_MustNotInContainers:"Error: Duplicate ContainerId detected while creating a Dynamic Web TWAIN object.",ERR_CreateID_WebTwainIdDuplicated:"Error: Duplicate ID detected while creating a Dynamic Web TWAIN object.",ERR_CreateID_NotContainer:"Error: The ID of the target DIV for the new DWT object is invalid.",limitReachedForZoomIn:"Error: You have reached the limit for zooming in",limitReachedForZoomOut:"Error: You have reached the limit for zooming out",insufficientParas:"Error: Not enough parameters.",invalidAngle:"Error: The angle you entered is invalid.",invalidIndex:"Error: The index you entered is invalid.",invalidHeightOrWidth:"Error: The height or width you entered is invalid.",imageNotChanged:"Error: You have not changed the current image."},generalMessages:{checkingDWTVersion:"Checking WebTwain version ..."},customProgressText:{upload:"Uploading...",download:"Downloading...",load:"Loading...",decode:"Processing...",decodeTIFF:"Processing tiff...",decodePDF:"Processing pdf...",encode:"Processing...",encodeTIFF:"Processing tiff...",encodePDF:"Processing pdf...",transfer:"Transferring...",canvasLoading:"Loading ..."},buttons:{titles:{previous:"Previous Image",next:"Next Image",print:"Print Image",scan:"Scan Documents",load:"Load Local Images",rotateleft:"Rotate Left",rotate:"Rotate",rotateright:"Rotate Right",deskew:"Deskew",crop:"Crop Selected Area",cut:"Cut Selected Area",changeimagesize:"Change Image Size",flip:"Flip Image",mirror:"Mirror Image",zoomin:"Zoom In",originalsize:"Show Original Size",zoomout:"Zoom Out",stretch:"Stretch Mode",fit:"Fit Window",fitw:"Fit Horizontally",fith:"Fit Vertically",hand:"Hand Mode",rectselect:"Select Mode",zoom:"Click to Zoom In",restore:"Restore Original Image",save:"Save Changes",close:"Close the Editor",removeall:"Remove All Images",removeselected:"Remove All Selected Images"},bShowAllButtons:!0,visibility:{scan:!0,load:!0,print:!0,removeall:!0,removeselected:!0,rotateleft:!0,rotate:!0,rotateright:!0,deskew:!0,crop:!0,cut:!0,changeimagesize:!0,flip:!0,mirror:!0,zoomin:!0,originalsize:!0,zoomout:!0,stretch:!0,fit:!0,fitw:!0,fith:!0,hand:!0,rectselect:!0,zoom:!0,restore:!0,save:!0,close:!0}},dialogText:{dlgRotateAnyAngle:["Angle :","Interpolation:","Keep size","  OK  ","Cancel"],dlgChangeImageSize:["New Height :","New Width :","Interpolation:","  OK  ","Cancel"],saveChangedImage:["You have changed the image. Do you want to keep the change(s)?","  Yes  ","  No  "],selectSource:["Select Source:","Select","Cancel","There is no source available!"]}};function f(){var t=e.DWT.Host;return r.isString(t)&&""!=t||(e.DWT.Host=t=s),t}function h(){var t=300,n=e.DWT.RemoteScanConfig;return n&&r.isNumber(n.sessionTimeout)&&n.sessionTimeout>0&&(t=n.sessionTimeout),t}var g={CertificateConfig:{},CustomizableDisplayInfo:{}},p=e.DWT;g.RegisterEvent=function(t,n){return r.isFunction(n)&&("OnWebTwainReady"!==t&&"OnWebTwainError"!==t&&"OnWebTwainInitMessage"!==t||(e.DWT[t]=n)),!0},r.mix(g,c),r.mix(g.CertificateConfig,l),r.mix(g.CustomizableDisplayInfo,d),r.mix(g,p),e.DWT=g;var m=e.DWT;m.EnumPDF_Page={Page_Default:0,Page_Custom:1,Page_A4:2,Page_A4_Reverse:3,Page_A3:4,Page_A3_Reverse:5,Page_Letter:6,Page_Letter_Reverse:7,Page_Legal:8,Page_Legal_Reverse:9},m.EnumDWT_PixelType={TWPT_BW:0,TWPT_GRAY:1,TWPT_RGB:2,TWPT_PALLETE:3,TWPT_CMY:4,TWPT_CMYK:5,TWPT_YUV:6,TWPT_YUVK:7,TWPT_CIEXYZ:8,TWPT_LAB:9,TWPT_SRGB:10,TWPT_SCRGB:11,TWPT_INFRARED:16},m.EnumDWT_BorderStyle={TWBS_NONE:0,TWBS_SINGLEFLAT:1,TWBS_SINGLE3D:2},m.EnumDWT_MessageType={TWQC_GET:1,TWQC_SET:2,TWQC_GETDEFAULT:4,TWQC_GETCURRENT:8,TWQC_RESET:16},m.EnumDWT_CapType={TWON_NONE:0,TWON_ARRAY:3,TWON_ENUMERATION:4,TWON_ONEVALUE:5,TWON_RANGE:6},m.EnumDWT_TransferMode={TWSX_NATIVE:0,TWSX_FILE:1,TWSX_MEMORY:2},m.EnumDWT_FileFormat={TWFF_TIFF:0,TWFF_PICT:1,TWFF_BMP:2,TWFF_XBM:3,TWFF_JFIF:4,TWFF_FPX:5,TWFF_TIFFMULTI:6,TWFF_PNG:7,TWFF_SPIFF:8,TWFF_EXIF:9,TWFF_PDF:10,TWFF_JP2:11,TWFF_JPN:12,TWFF_JPX:13,TWFF_DEJAVU:14,TWFF_PDFA:15,TWFF_PDFA2:16},m.EnumDWT_TIFFCompressionType={TIFF_AUTO:0,TIFF_NONE:1,TIFF_RLE:2,TIFF_FAX3:3,TIFF_T4:3,TIFF_FAX4:4,TIFF_T6:4,TIFF_LZW:5,TIFF_JPEG:7,TIFF_PACKBITS:32773},m.EnumDWT_InterpolationMethod={IM_NEARESTNEIGHBOUR:1,IM_BILINEAR:2,IM_BICUBIC:3,IM_BESTQUALITY:5},m.EnumDWT_PDFCompressionType={PDF_AUTO:0,PDF_FAX3:1,PDF_FAX4:2,PDF_LZW:3,PDF_RLE:4,PDF_JPEG:5,PDF_JP2000:6,PDF_JBIG2:7},m.EnumDWT_ShowMode={SW_ACTIVE:0,SW_MAX:1,SW_MIN:2,SW_CLOSE:3,SW_IFLIVE:4},m.EnumDWT_CapValueType={TWTY_INT8:0,TWTY_INT16:1,TWTY_INT32:2,TWTY_UINT8:3,TWTY_UINT16:4,TWTY_int:5,TWTY_BOOL:6,TWTY_FIX32:7,TWTY_FRAME:8,TWTY_STR32:9,TWTY_STR64:10,TWTY_STR128:11,TWTY_STR255:12},m.EnumDWT_UnitType={TWUN_INCHES:0,TWUN_CENTIMETERS:1,TWUN_PICAS:2,TWUN_POINTS:3,TWUN_TWIPS:4,TWUN_PIXELS:5,TWUN_MILLIMETERS:6},m.EnumDWT_DUPLEX={TWDX_NONE:0,TWDX_1PASSDUPLEX:1,TWDX_2PASSDUPLEX:2},m.EnumDWT_CapFeederAlignment={TWFA_NONE:0,TWFA_LEFT:1,TWFA_CENTER:2,TWFA_RIGHT:3},m.EnumDWT_CapFeederOrder={TWFO_FIRSTPAGEFIRST:0,TWFO_LASTPAGEFIRST:1},m.EnumDWT_CapPrinter={TWPR_IMPRINTERTOPBEFORE:0,TWPR_IMPRINTERTOPAFTER:1,TWPR_IMPRINTERBOTTOMBEFORE:2,TWPR_IMPRINTERBOTTOMAFTER:3,TWPR_ENDORSERTOPBEFORE:4,TWPR_ENDORSERTOPAFTER:5,TWPR_ENDORSERBOTTOMBEFORE:6,TWPR_ENDORSERBOTTOMAFTER:7},m.EnumDWT_CapPrinterMode={TWPM_SINGLESTRING:0,TWPM_MULTISTRING:1,TWPM_COMPOUNDSTRING:2},m.EnumDWT_CapBitdepthReduction={TWBR_THRESHOLD:0,TWBR_HALFTONE:1,TWBR_CUSTHALFTONE:2,TWBR_DIFFUSION:3},m.EnumDWT_CapBitOrder={TWBO_LSBFIRST:0,TWBO_MSBFIRST:1},m.EnumDWT_CapFilterType={TWFT_RED:0,TWFT_GREEN:1,TWFT_BLUE:2,TWFT_NONE:3,TWFT_WHITE:4,TWFT_CYAN:5,TWFT_MAGENTA:6,TWFT_YELLOW:7,TWFT_BLACK:8},m.EnumDWT_CapFlash={TWFL_NONE:0,TWFL_OFF:1,TWFL_ON:2,TWFL_AUTO:3,TWFL_REDEYE:4},m.EnumDWT_CapFlipRotation={TWFR_BOOK:0,TWFR_FANFOLD:1},m.EnumDWT_CapImageFilter={TWIF_NONE:0,TWIF_AUTO:1,TWIF_LOWPASS:2,TWIF_BANDPASS:3,TWIF_HIGHPASS:4,TWIF_TEXT:3,TWIF_FINELINE:4},m.EnumDWT_CapLightPath={TWLP_REFLECTIVE:0,TWLP_TRANSMISSIVE:1},m.EnumDWT_CapLightSource={TWLS_RED:0,TWLS_GREEN:1,TWLS_BLUE:2,TWLS_NONE:3,TWLS_WHITE:4,TWLS_UV:5,TWLS_IR:6},m.EnumDWT_MagType={TWMD_MICR:0,TWMD_RAW:1,TWMD_INVALID:2},m.EnumDWT_CapNoiseFilter={TWNF_NONE:0,TWNF_AUTO:1,TWNF_LONEPIXEL:2,TWNF_MAJORITYRULE:3},m.EnumDWT_CapORientation={TWOR_ROT0:0,TWOR_ROT90:1,TWOR_ROT180:2,TWOR_ROT270:3,TWOR_PORTRAIT:0,TWOR_LANDSCAPE:3,TWOR_AUTO:4,TWOR_AUTOTEXT:5,TWOR_AUTOPICTURE:6},m.EnumDWT_CapOverscan={TWOV_NONE:0,TWOV_AUTO:1,TWOV_TOPBOTTOM:2,TWOV_LEFTRIGHT:3,TWOV_ALL:4},m.EnumDWT_CapPixelFlavor={TWPF_CHOCOLATE:0,TWPF_VANILLA:1},m.EnumDWT_CapPlanarChunky={TWPC_CHUNKY:0,TWPC_PLANAR:1},m.EnumDWT_DataSourceStatus={TWDSS_CLOSED:0,TWDSS_OPENED:1,TWDSS_ENABLED:2,TWDSS_ACQUIRING:3};var _=0,v=1,y=2;m.EnumDWT_FitWindowType={enumFitWindow:_,enumFitWindowHeight:v,enumFitWindowWidth:y};var I={enumUnknown:-1,enumWindow:0,enumMac:1,enumLinux:2,enumEmbed:3,enumChromeOS:4,enumHarmonyOS:5,enumAndroid:6,enumiOS:7};m.EnumDWT_PlatformType={enumUnknown:I.enumUnknown,enumWindow:I.enumWindow,enumMac:I.enumMac,enumLinux:I.enumLinux,enumEmbed:I.enumEmbed,enumChromeOS:I.enumChromeOS,enumHarmonyOS:I.enumHarmonyOS,enumAndroid:I.enumAndroid,enumiOS:I.enumiOS};var S=0,T=1,b=2,E=3,C=4,w=5,k=6,D=7,x=8;m.EnumDWT_MouseShape={Default:S,Hand:T,Crosshair:b,Zoom:E,NWResize:C,EResize:w,NResize:k,Resize:D,Move:x},m.EnumDWT_Language={English:0,French:1,Arabic:2,Spanish:3,Portuguese:4,German:5,Italian:6,Russian:7,Chinese:8};var P={Info:1,Error:2,NotInstalledError:3};m.EnumDWT_InitMsg={Info:P.Info,Error:P.Error,NotInstalledError:P.NotInstalledError};var F={TWAIN:0,ICA:3,SANE:3,TWAIN_AND_ICA:4,TWAIN_AND_TWAIN64:4,TWAIN64:5};m.EnumDWT_Driver={TWAIN:F.TWAIN,ICA:F.ICA,SANE:F.SANE,TWAIN_AND_ICA:F.TWAIN_AND_ICA,TWAIN_AND_TWAIN64:F.TWAIN_AND_TWAIN64,TWAIN64:F.TWAIN64},m.EnumDWT_CompressionType={TWCP_NONE:0,TWCP_PACKBITS:1,TWCP_GROUP31D:2,TWCP_GROUP31DEOL:3,TWCP_GROUP32D:4,TWCP_GROUP4:5,TWCP_JPEG:6,TWCP_LZW:7,TWCP_JBIG:8,TWCP_PNG:9,TWCP_RLE4:10,TWCP_RLE8:11,TWCP_BITFIELDS:12,TWCP_ZIP:13,TWCP_JPEG2000:14};var W=0,A=1;m.EnumDWT_SelectionMode={Single:W,Multiple:A},m.EnumDWT_ConfirmExitType={Cancel:0,Exit:1,SaveAndExit:2};var R=0,O=1,L=2,N=3;m.EnumDWT_WebsocketReadyState={CONNECTING:R,OPEN:O,CLOSING:L,CLOSED:N};var M=1;m.EnumDWT_ServiceType={TwainService:M};var U=0,B=2,V=3,G=4,j=0,H=1,z=2;m.EnumDWT_ExtImageInfo={"default":j,standard:H,supported:z};var K,q={Other:0,HTTPUpload:1,HTTPDownload:2,FTPUpload:3,FTPDownload:4,Scan:5};function X(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function J(e){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},J(e)}function Y(e){var r=function(e,r){if("object"!==J(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(t!==undefined){var n=t.call(e,r||"default");if("object"!==J(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"===J(r)?r:String(r)}function Z(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Y(n.key),n)}}function Q(e,r,t){return r&&Z(e.prototype,r),t&&Z(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function $(r){return e.Lib.isString(r)?r:("errorMessage"in r&&(t=r.errorMessage),"message"in r&&(t=r.message),e.Lib.isString(t)||(t="message"in t?t.message:""),"errorCode"in r&&-1==t.indexOf("(")&&(t+="("+r.errorCode+")"),"code"in r&&-1==t.indexOf("(")&&(t+="("+r.code+")"),t);var t}function ee(e,r,t){e._errorCode=r,e._errorString=t}!function(e){e.LicenseInvalid=-2325,e.LicenseExpired=-2326,e.LicenseParseFailed=-2546,e.LicenseExpiredForDLS=-2808,e.LicenseNoCoreForDLS=-2809,e.LicenseNoCore=-2810,e.LicenseIsFuture=-2396,e.LicenseVersionNotCurrent=-2539}(K||(K={})),e.DWT.EnumDWT_LicenseErrorCode=K,e.DWT.EnumDWT_Error={UserCancelled:-1032,CommonError:-2201,ModuleNotExists:-2371,MustUpgrade:-2207,RemoteDynamsoftServiceStopped:-2613,ResponseDataTypeError:-2801,HTSTError:-2817,CORSError:-2820,EnhancedPortNotReady:-2821,HTTPRedirected:-2823,BboError:-2827};var re=function(){function t(){X(this,t)}return Q(t,[{key:"OutOfRange",value:function(e){ee(e,-1010,"Data parameter out of supported range.")}},{key:"InvalidIndex",value:function(e){ee(e,-1033,"Invalid index.")}},{key:"InvalidValue",value:function(e){ee(e,-1034,"Invalid value.")}},{key:"NoImage",value:function(e){ee(e,-1035,"There is no image.")}},{key:"UnrecognizedExt",value:function(e){ee(e,-1110,"Unrecognized file extension.")}},{key:"LoadTextPDFButSetImageOnly",value:function(e){ee(e,-1119,"The text-based PDF file was not imported correctly because ConvertMode was set to CM_IMAGEONLY, which means PDF Rasterizer is turned off. Please set ConvertMode to Dynamsoft.DWT.EnumDWT_ConvertMode.CM_AUTO to enable it.")}},{key:"SourceHasNothingToCapture",value:function(e){ee(e,-1029,"Source has nothing to capture.")}},{key:"bImageOnlyError_NotPurelyPDF",value:function(e){return-1416==e}},{key:"SystemBusy",value:function(e){ee(e,-2007,"The system is busy, some operations are not completed. Please try later.")}},{key:"MustUpgradeService",value:function(r,t){var n=t?["[",t,"]"].join(""):"your computer";ee(r,e.DWT.EnumDWT_Error.MustUpgrade,"The Dynamsoft Service installed on "+n+" is outdated and no longer works with the JavaScript code on the website.")}},{key:"Server_Restarted",value:function(e){ee(e,-2208,"The connection with the local Dynamsoft Service encountered a problem and has been reset.")}},{key:"HTML5NotSupport",value:function(e){ee(e,-2209,"The HTML5 edition does not support this method or property.")}},{key:"CannotCallUIMethodWhenNotBindDefaultViewer",value:function(e){ee(e,-2210,"You cannot call this method on this WebTwain instance because it does not use the default viewer.")}},{key:"HttpServerCannotEmpty",value:function(e){ee(e,-2300,"Http upload error: the HTTP Server name/ip cannot be empty.")}},{key:"NetworkError",value:function(e){ee(e,-2301,"Network error.")}},{key:"InvalidResultFormat",value:function(e){ee(e,-2302,"The result format is invalid.")}},{key:"UploadError",value:function(e,r,t,n){if(r)this.UserCanceled(e);else if(e._errorCode=-2003,n&&n>0||t){var i=["HTTP process error: "];t&&(t.indexOf("HTTP process error: ")>=0&&(i=[""]),i.push(t)),n&&n>0&&i.push(" ("+n+")");var o=i.toString().lastIndexOf(".");o>=0&&o==i.toString().length-1?e._errorString=i.join(""):e._errorString=i.join("")+"."}else e._errorString="HTTP process error."}},{key:"HttpDownloadUrlError",value:function(e){ee(e,-2304,"Http download error: the url is invalid.")}},{key:"HttpDownloadError",value:function(e,r,t,n){if(r)ee(e,-2305,"User cancelled the operation.");else if(e._errorCode=-2003,n&&n>0||t){var i=["HTTP process error: "];t&&(t.indexOf("HTTP process error: ")>=0&&(i=[""]),i.push(t));var o=i.toString().lastIndexOf(".");o>=0&&o==i.toString().length-1?e._errorString=i.join(""):e._errorString=i.join("")+"."}else e._errorString="HTTP process error."}},{key:"UploadFileCannotEmpty",value:function(e){ee(e,-2306,"Upload Error: the upload file cannot be empty.")}},{key:"InvalidWidthOrHeight",value:function(e){ee(e,-2307,"The width or height you entered is invalid.")}},{key:"Server_Invalid",value:function(e){0==e._errorCode&&ee(e,-2308,"The Dynamsoft Service has been stopped.")}},{key:"InvalidLocalFilename",value:function(e,r){ee(e,-2309,"The LocalFile is empty in the name "+r+" Function.")}},{key:"BarCode_InvalidIndex",value:function(e,r){ee(e,-2310,"The index is out of range.")}},{key:"BarCode_InvalidRemoteFilename",value:function(e){ee(e,-2311,"The RemoteFile field is empty in the Barcode Download Function.")}},{key:"ImageFileLengthCannotZero",value:function(e){ee(e,-2312,"The file length is empty.")}},{key:"UploadExceededMaxSize",value:function(e){ee(e,-2313,"The size of the images you are about to upload has exceeded the limit.")}},{key:"ParameterCannotEmpty",value:function(e){ee(e,-2314,"The parameter cannot be empty.")}},{key:"Webcam_InvalidIndex",value:function(e,r){ee(e,-2315,"The index is out of range.")}},{key:"Webcam_InvalidRemoteFilename",value:function(e){ee(e,-2316,"The RemoteFile field is empty in the Webcam Download Function.")}},{key:"Pdf_InvalidRemoteFilename",value:function(e){ee(e,-2317,"The RemoteFile field is empty in the Pdf Download Function.")}},{key:"InvalidDestination",value:function(e){ee(e,-2318,"Invalid destination file.")}},{key:"InvalidSourceFile",value:function(e){ee(e,-2319,"Invalid source file.")}},{key:"InvalidFile",value:function(e){ee(e,-2320,"Invalid file.")}},{key:"hasLicenseError",value:function(e){return e._errorCode>=-2348&&e._errorCode<=-2325}},{key:"OCR_InvalidIndex",value:function(e,r){ee(e,-2321,"The index is out of range.")}},{key:"OCR_InvalidLeftOrTopOrRightOrBottom",value:function(e){ee(e,-2322,"The left or top or right or bottom you entered is invalid.")}},{key:"OCR_InvalidOutputFormat",value:function(e){ee(e,-2323,"The OCR output format is not supported.")}},{key:"OCR_InvalidPageSetMode",value:function(e){ee(e,-2324,"The OCR page set mode is not supported.")}},{key:"LicenseEmptyOrInvalid",value:function(r){ee(r,K.LicenseInvalid,e.Lib.License.isLTS()?"The license is invalid.":"The current product key is empty or invalid."),e.Lib.Errors.SetLTSException(r)}},{key:"LicenseExpired",value:function(r,t){r._errorCode=K.LicenseExpired;var n="";if(t&&""!=t&&(-1==t.indexOf("on")&&(n=" on "+t),r.__licenseInfo&&(r.__licenseInfo.ExpireDate=t)),e.Lib.License.isLTS()){var i,o,a,s,u;if(i=e.DWT.EnumInstance.dwt_desktop,r._bRemoteMode)o=null!==(a=null===(s=r._dmService)||void 0===s||null===(u=s.attrs)||void 0===u?void 0:u.UUID)&&void 0!==a?a:"";else o="";r._errorString="The license has expired"+n+".",e.DWT.lcexp(i,o).then((function(){r._errorString=e.DWT.licenseException.message}))}else r._errorString="The current product key has expired"+n+". Please contact the site administrator.",e.Lib.Errors.SetLTSException(r)}},{key:"LicenseNoChrome",value:function(r){ee(r,-2327,"The current product key does not support Chrome. Please contact the site administrator."),e.Lib.Errors.SetLTSException(r)}},{key:"LicenseNoFirefox",value:function(r){ee(r,-2328,"The current product key does not support Firefox. Please contact the site administrator."),e.Lib.Errors.SetLTSException(r)}},{key:"LicenseNoIE",value:function(r){ee(r,-2329,"The current product key does not support IE. Please contact the site administrator."),e.Lib.Errors.SetLTSException(r)}},{key:"LicenseNoEdge",value:function(r){ee(r,-2330,"The current product key does not support Edge. Please contact the site administrator."),e.Lib.Errors.SetLTSException(r)}},{key:"LicenseNoSafari",value:function(r){ee(r,-2392,"The current product key does not support Safari. Please contact the site administrator."),e.Lib.Errors.SetLTSException(r)}},{key:"LicenseNoCore",value:function(r,t,i){e.Lib.License.isLTS()?t?111==i?(r._errorCode=K.LicenseExpiredForDLS,r._errorString="The license for v"+n+" WebAssembly Core Module has expired."):(r._errorCode=K.LicenseNoCoreForDLS,r._errorString="The license for v"+n+" WebAssembly Core Module is not found."):111==i?(r._errorCode=K.LicenseExpiredForDLS,r._errorString="The license for v"+n+" Service Core Module has expired."):(r._errorCode=K.LicenseNoCoreForDLS,r._errorString="The license for v"+n+" Service Core Module is not found."):(r._errorCode=K.LicenseNoCore,r._errorString=t?"The current product key is missing the WebAssembly Core license. Please contact the site administrator.":"The current product key is missing the Service Core license. Please contact the site administrator."),e.Lib.Errors.SetLTSException(r)}},{key:"LicenseNoWebcam",value:function(r){r._errorCode=-2338,e.Lib.License.isLTS()?r._errorString="The license for the module direct show is not found or has expired.":r._errorString="The current product key does not support Webcam. Please contact the site administrator.",e.Lib.Errors.SetLTSException(r)}},{key:"LicenseNoPDF",value:function(r){r._errorCode=-2339,e.Lib.License.isLTS()?r._errorString="The license for the module pdf rasterizer is not found or has expired.":r._errorString="The current product key does not support pdf rasterizer. Please contact the site administrator.",e.Lib.Errors.SetLTSException(r)}},{key:"LicenseNoOCR",value:function(r){r._errorCode=-2340,e.Lib.License.isLTS()?r._errorString="The license for the module ocr is not found or has expired.":r._errorString="The current product key does not support OCR. Please contact the site administrator.",e.Lib.Errors.SetLTSException(r)}},{key:"LicenseNoOCRPro",value:function(r){r._errorCode=-2341,e.Lib.License.isLTS()?r._errorString="The license for the module ocr pro is not found or has expired.":r._errorString="The current product key does not support OCR pro. Please contact the site administrator.",e.Lib.Errors.SetLTSException(r)}},{key:"LicenseBadDomain",value:function(r){ee(r,-2342,"The domain of your current site does not match the domain bound in the current product key. Please contact the site administrator."),e.Lib.Errors.SetLTSException(r)}},{key:"LicenseNotSupportBorwser",value:function(r){ee(r,-2343,"The current product key does not support your browser. Please contact the site administrator."),e.Lib.Errors.SetLTSException(r)}},{key:"LicenseNotSupportWindows",value:function(r){ee(r,-2344,"The current product key does not support Windows OS. Please contact the site administrator."),e.Lib.Errors.SetLTSException(r)}},{key:"LicenseNotSupportMAC",value:function(r){ee(r,-2345,"The current product key does not support MAC OS. Please contact the site administrator."),e.Lib.Errors.SetLTSException(r)}},{key:"LicenseNotSupportLinux",value:function(r){ee(r,-2346,"The current product key does not support Linux OS. Please contact the site administrator."),e.Lib.Errors.SetLTSException(r)}},{key:"LicenseNotSupportOS",value:function(r){ee(r,-2347,"The current product key does not support your OS. Please contact the site administrator."),e.Lib.Errors.SetLTSException(r)}},{key:"LicenseLower",value:function(r){ee(r,-2348,"The current product key is invalid because it's generated with the licenses of a different major version."),e.Lib.Errors.SetLTSException(r)}},{key:"BarcodeLicenseEmpty",value:function(r){ee(r,-2349,"The current product key does not include a license for reading barcode. Please contact the site administrator."),e.Lib.Errors.SetLTSException(r)}},{key:"IndicesCannotEmpty",value:function(e){ee(e,-2350,"The indices cannot be empty.")}},{key:"UploadIndexMoreThanOne",value:function(e){ee(e,-2351,"You cannot upload more than one image when the format is BMP, JPG or PNG")}},{key:"IndicesOutOfRange",value:function(e){ee(e,-2352,"The indices are out of range.")}},{key:"HttpHeaderNotAllowed",value:function(e){ee(e,-2353,"The header name being used is a protected keyword and is not allowed.")}},{key:"HttpHeaderIsEmpty",value:function(e){ee(e,-2354,"The header name cannot be empty.")}},{key:"HttpHeaderIsNull",value:function(e){ee(e,-2355,"The header name cannot be null.")}},{key:"HttpHeaderIsUndefined",value:function(e){ee(e,-2356,"The header name cannot be undefined.")}},{key:"HttpHeaderIsInvalid",value:function(e){ee(e,-2357,"The header name you entered is invalid.")}},{key:"IndicesNotArray",value:function(e){ee(e,-2358,"The type of the parameter indices must be an Array.")}},{key:"IndexOutOfRange",value:function(e){ee(e,-2359,"The index is out of range.")}},{key:"IndexNullOrUndefined",value:function(e){ee(e,-2360,"The index is null or undefined.")}},{key:"ConvertBase64IndexMoreThanOne",value:function(e){ee(e,-2361,"You cannot convert more than one image to base64 string when the format is BMP, JPG or PNG.")}},{key:"InvalidImageType",value:function(e){ee(e,-2362,"The image type is not supported.")}},{key:"InvalidDataFormat",value:function(e){ee(e,-2363,"The data format is not supported.")}},{key:"InvalidUploadInSegments",value:function(e){ee(e,-2364,"Please use a Boolean value for the parameter bUploadInSegments.")}},{key:"InvalidUrl",value:function(e){ee(e,-2365,"The url is invalid.")}},{key:"ConvertBase64Failed",value:function(e){ee(e,-2366,"Converting images to a base64 string failed.")}},{key:"InvalidSegmentUploadThreshold",value:function(e){ee(e,-2367,"Invalid value for the parameter segmentUploadThreshold.")}},{key:"InvalidModuleSize",value:function(e){ee(e,-2368,"Invalid value for the parameter moduleSize.")}},{key:"LicenseNotSupportWasm",value:function(r){ee(r,-2369,"The current product key is missing the WASM license. Please contact the site administrator."),e.Lib.Errors.SetLTSException(r)}},{key:"LicenseNotSupportPdfRWasm",value:function(r){r._errorCode=-2370,e.Lib.License.isLTS()?r._errorString="The license for the module pdf rasterizer is not found or has expired.":r._errorString="The current product key does not support Pdf Rasterizer Wasm. Please contact the site administrator.",e.Lib.Errors.SetLTSException(r)}},{key:"WebTwainModuleNotExist",value:function(r){ee(r,e.DWT.EnumDWT_Error.ModuleNotExists,"Dynamic Web TWAIN scanner module is not installed and it is also missing on the server. Please contact the site administrator.")}},{key:"ConvertBinaryIndexMoreThanOne",value:function(e){ee(e,-2372,"You cannot convert more than one image to binary when the format is BMP, JPG or PNG.")}},{key:"Overlay_InvalidLeftOrTopOrRightOrBottom",value:function(e){ee(e,-2375,"The left or top or right or bottom you entered is invalid.")}},{key:"GenerateURL_InvalidRetFromServer",value:function(e){ee(e,-2376,"The generate url failed.")}},{key:"ImageCaptureDriverTypeError",value:function(e){ee(e,-2377,"Failed to set Image Capture Driver Type.")}},{key:"InvalidTiffTagError",value:function(e){ee(e,-2378,"Invalid value for the tiff tag code.")}},{key:"OCR_InvalidRemoteFilename",value:function(e){ee(e,-2379,"The RemoteFile field is empty in the OCR Download Function.")}},{key:"Uploader_ModuleError",value:function(e){ee(e,-2380,"Please make sure the Uploader Module has been installed.")}},{key:"ScanUploader_InvalidScanSetup",value:function(e){ee(e,-2381,"scanSetup is invalid.")}},{key:"ScanUploader_InvalidTransferMode",value:function(e){ee(e,-2382,"Scanner setup error: Invalid Transfer Mode.")}},{key:"ScanUploader_InvalidFileXfer",value:function(e){ee(e,-2383,"Scanner setup error: fileXfer is invalid.")}},{key:"ScanUploader_InvalidFileXferFilename",value:function(e){ee(e,-2384,"Scanner setup error: Invalid fileName in fileXfer.")}},{key:"ScanUploader_InvalidFileXferFileFormat",value:function(e){ee(e,-2385,"Scanner setup error: Invalid fileFormat in fileXfer.")}},{key:"ScanUploader_InvalidHttpParams",value:function(e){ee(e,-2386,"Output setup error: Invalid httpParams in outputSetup.")}},{key:"ScanUploader_InvalidHttpType",value:function(e){ee(e,-2387,"Output setup error: Invalid type in outputSetup.")}},{key:"ScanUploader_InvalidHttpUrl",value:function(e){ee(e,-2388,"Output setup error: Invalid url in outputSetup.httpParams.")}},{key:"ScanUploader_InvalidHttpFilename",value:function(e){ee(e,-2389,"Output setup error: Invalid fileName in outputSetup.httpParams.")}},{key:"ScanUploader_InvalidOutputFormat",value:function(e){ee(e,-2390,"Output setup error: Invalid format in outputSetup.")}},{key:"InvalidImageID",value:function(e){ee(e,-1034,"Invalid image ID.")}},{key:"InvalidEventName",value:function(e){ee(e,-2391,"Invalid event name.")}},{key:"ConvertBlobIsEmpty",value:function(e){ee(e,-2393,"Failed to convert the data to blob.")}},{key:"InvalidTagName",value:function(e){ee(e,-2394,"Invalid tag name.")}},{key:"WebTwainModuleDownloadFailure",value:function(e){ee(e,-2395,"The module for Dynamic Web TWAIN has failed to download.")}},{key:"LicenseIsFuture",value:function(r,t){ee(r,K.LicenseIsFuture,"The current product key is invalid. Please contact the site administrator."),e.Lib.Errors.SetLTSException(r)}},{key:"ServiceNotSupport",value:function(e,r){ee(e,-2397,r+" doesn't work under current settings.")}},{key:"ScannerNotSupport",value:function(e,r){ee(e,-2398,r+" is not supported for the current scanner.")}},{key:"MethodNotWork",value:function(e,r){ee(e,-2400,r+" doesn't work under current settings.")}},{key:"LoadImageFailed",value:function(e,r){ee(e,-2401,"Failed to load image: "+$(r))}},{key:"RotateFailed",value:function(e,r){ee(e,-2402,"Failed to rotate image: "+$(r))}},{key:"FlipFailed",value:function(e,r){ee(e,-2403,"Failed to flip image: "+$(r))}},{key:"MirrorFailed",value:function(e,r){ee(e,-2404,"Failed to mirror image: "+$(r))}},{key:"EraseFailed",value:function(e,r){ee(e,-2405,"Failed to erase image: "+$(r))}},{key:"InvertFailed",value:function(e,r){ee(e,-2406,"Failed to invert image: "+$(r))}},{key:"SaveImageFailed",value:function(e,r){ee(e,-2407,"Failed to save image: "+$(r))}},{key:"ChangeImageSizeFailed",value:function(e,r){ee(e,-2408,"Failed to change image size: "+$(r))}},{key:"CropFailed",value:function(e,r){ee(e,-2409,"Failed to crop image: "+$(r))}},{key:"SkewAngleFailed",value:function(e,r){ee(e,-2410,"Failed to skew angle: "+$(r))}},{key:"ConvertToGrayScaleFailed",value:function(e,r){ee(e,-2411,"Failed to convert to gray scale: "+$(r))}},{key:"ConvertToBWScaleFailed",value:function(e,r){ee(e,-2412,"Failed to convert to black and white scale: "+$(r))}},{key:"SetDPIFailed",value:function(e,r){ee(e,-2413,"Failed to set dpi: "+$(r))}},{key:"SetImageWidthFailed",value:function(e,r){ee(e,-2414,"Failed to set image width: "+$(r))}},{key:"GetLicenseInfoFailed",value:function(e,r){ee(e,-2415,"Failed to get license info: "+$(r))}},{key:"InvalidParameter",value:function(e){ee(e,-2416,"Invalid parameter.")}},{key:"MobileServer_InvalidLeftOrTopOrRightOrBottom",value:function(e){ee(e,-2417,"The left or top or right or bottom you entered is invalid.")}},{key:"MobileServer_InvalidWidth",value:function(e){ee(e,-2418,"The width you entered is invalid.")}},{key:"MobileServer_InvalidHeight",value:function(e){ee(e,-2419,"The height you entered is invalid.")}},{key:"MobileServer_InvalidXResolution",value:function(e){ee(e,-2420,"The x resolution you entered is invalid.")}},{key:"MobileServer_InvalidYResolution",value:function(e){ee(e,-2421,"The y resolution you entered is invalid.")}},{key:"MobileServer_InvalidImage",value:function(e){ee(e,-2422,"The image source is invalid.")}},{key:"MobileServer_InvalidIndex",value:function(e){ee(e,-2423,"The index is invalid.")}},{key:"GetMD5Failed",value:function(e,r){ee(e,-2424,"Failed to get MD5: "+$(r))}},{key:"ConvertFromBase64Failed",value:function(e){ee(e,-2425,"Converting image from a base64 string failed.")}},{key:"LicenseTrialFullMixed",value:function(e){ee(e,-2426,"You have used a full license with a trial license which is not permitted. Please check and update Dynamsoft.DWT.ProductKey.")}},{key:"BarcodeReaderError",value:function(e,r){ee(e,-2427,r)}},{key:"TiffTagCountExceedError",value:function(e){ee(e,-2428,"Tiff tag count has exceeded the limit.")}},{key:"SelectSourceMustAsync",value:function(e){ee(e,-2429,"The method SelectSource() must be invoked asynchronously (i.e. with callback functions) when ImageCaptureDriverType is set to TWAIN_AND_ICA or TWAIN_AND_TWAIN64.")}},{key:"HttpLicenseInvalid",value:function(r){ee(r,-2430,"The current product key is invalid."),e.Lib.Errors.SetLTSException(r)}},{key:"LicenseNotSupportWebcamWasm",value:function(r){r._errorCode=-2431,e.Lib.License.isLTS()?r._errorString="The license for the Camera Addon is not found or has expired.":ee(r,-2431,"The current product key does not support Camera Addon. Please contact the site administrator."),e.Lib.Errors.SetLTSException(r)}},{key:"ActiveXNotSupport",value:function(e){ee(e,-2433,"The ActiveX edition does not support this method or property.")}},{key:"DetectCallbackErr",value:function(e){e._errorCode=-2434}},{key:"PerspectiveCallback",value:function(e){e._errorCode=-2435}},{key:"HTTPSRequired",value:function(e,r,t){ee(e,-2436,'Mixed Content: The page at "'+r+'" was loaded over HTTPS, but requested an insecure resource "'+t+'/ddm/18625/ddm/SearchScanner". This request has been blocked; the content must be served over HTTPS.')}},{key:"StartScanFailed",value:function(e){ee(e,-2432,"Operation in progress, please try again when the current operation has finished.")}},{key:"ImageEditorOpenCannotPlayVideo",value:function(e){ee(e,-2437,"The video can not be played while the Image Editor is open.")}},{key:"SelectSourceMustAsyncWhenRemote",value:function(e){ee(e,-2438,"SelectSource cannot be used synchronously when Object is created by CreateRemoteScanObjectAsync. Please use SelectSourceAsync instead.")}},{key:"CannotBindViewerWhenNoViewerJS",value:function(e){ee(e,-2439,"You cannot call the method bindViewer() when Dynamsoft.DWT.UseDefaultViewer is set to false.")}},{key:"LTSErrors",value:function(e){ee(e,-2440,"")}},{key:"LongKeyShortKeyMixed",value:function(e){ee(e,-2444,"A license can only be specified once and has already been set using the ProductKey API.")}},{key:"ImageEditorExist",value:function(e){ee(e,-2500,"An ImageEditor already exists.")}},{key:"ThumbnailViewerExist",value:function(e){ee(e,-2501,"A ThumbnailViewer already exists.")}},{key:"CustomElementExist",value:function(e){ee(e,-2502,"A CustomElement already exists.")}},{key:"ImageEditorNotExist",value:function(e){ee(e,-2503,"This ImageEditor doesn't exist.")}},{key:"ImageEditorDispose",value:function(e){ee(e,-2504,"The ImageEditor object has been disposed.")}},{key:"ThumbnailViewerNotExist",value:function(e){ee(e,-2505,"This ThumbnailViewer doesn't exist.")}},{key:"ThumbnailViewerDispose",value:function(e){ee(e,-2506,"The ThumbnailViewer object has been disposed.")}},{key:"CustomElementNotExist",value:function(e){ee(e,-2507,"This CustomElement doesn't exist.")}},{key:"CustomElementDispose",value:function(e){ee(e,-2508,"The CustomElement object has been disposed.")}},{key:"EventNotExist",value:function(e){ee(e,-2509,"The specified event doesn't exist.")}},{key:"CallbackNotAFunction",value:function(e){ee(e,-2510,"The callback is not a function.")}},{key:"ElementRequired",value:function(e){ee(e,-2511,"Parameter 'element' is required.")}},{key:"ElementNotExist",value:function(e){ee(e,-2512,"Parameter 'element' doesn't exist.")}},{key:"Destroyed",value:function(e){ee(e,-2513,"The WebTwain instance has been destroyed and can not be used anymore.")}},{key:"InvalidPropertyValue",value:function(e){ee(e,-2514,"Invalid property value.")}},{key:"HostNotAvailable",value:function(e,r){ee(e,-2515,"The Dynamsoft Service is not configured correctly on "+r+". Please check.")}},{key:"CameraRequired",value:function(e){ee(e,-2516,"The camera addon is required.")}},{key:"OldTagNameRequired",value:function(e){ee(e,-2517,"Old tag name is required.")}},{key:"NewTagNameRequired",value:function(e){ee(e,-2518,"New tag name is required.")}},{key:"CursorInvalidMode",value:function(e){ee(e,-2519,"The current mode does not support setting the cursor to zoom-in.")}},{key:"SystemExceptionError",value:function(e,r){ee(e,-2520,r)}},{key:"ChangeContrastFailed",value:function(e,r){ee(e,-2521,"Failed to change contrast: "+$(r))}},{key:"ChangeBrightnessFailed",value:function(e,r){ee(e,-2522,"Failed to change brightening: "+$(r))}},{key:"ConvertToGrayScaleFilterCallbackErr",value:function(e,r){ee(e,-2523,'Failed to apply "gray" filter: '+$(r))}},{key:"ConvertToBWScaleFilterCallbackErr",value:function(e,r){ee(e,-2524,'Failed to apply "black and white" filter: '+$(r))}},{key:"RemoveShadowFilterCallbackErr",value:function(e,r){ee(e,-2525,'Failed to apply "remove shadow" filter: '+$(r))}},{key:"EnhanceAndSharpenFilterCallbackErr",value:function(e,r){ee(e,-2526,'Failed to apply "enhance and sharpen" filter: '+$(r))}},{key:"BrightenFilterCallbackErr",value:function(e,r){ee(e,-2527,'Failed to apply "brightening" filter: '+$(r))}},{key:"SaveTonerCallbackErr",value:function(e,r){ee(e,-2528,'Failed to apply "save toner" filter: '+$(r))}},{key:"GetBlurryScoreErr",value:function(e,r){ee(e,-2529,"Failed to get blurry score: "+$(r))}},{key:"FileNameCannotEmpty",value:function(e){ee(e,-2530,"Document name cannot be empty.")}},{key:"FileNameNotString",value:function(e){ee(e,-2531,"Document name is not a string.")}},{key:"DocumentEditorNotExist",value:function(e){ee(e,-2532,"This documentEditor doesn't exist.")}},{key:"DocumentEditorDispose",value:function(e){ee(e,-2533,"The documentEditor object has been disposed.")}},{key:"DocumentEditorExist",value:function(e){ee(e,-2534,"A documentEditor already exists.")}},{key:"RgbaImageToBlobErr",value:function(e,r){ee(e,-2535,"Failed to convert image data: "+$(r))}},{key:"LoadTextPDFButNoPdfrLicenseErr",value:function(e){ee(e,-2536,"This PDF file is not supported by the Core module. You may need to activate your PDF Rasterizer license to support this PDF file. Please contact support for further information.")}},{key:"LicenseVersionNotCurrent",value:function(r,t){ee(r,K.LicenseVersionNotCurrent,"The current product key is not for version ".concat(t,". Please contact the site administrator.")),e.Lib.Errors.SetLTSException(r)}},{key:"FileNotExist",value:function(e){ee(e,-2540,"The document does not exist.")}},{key:"FileExist",value:function(e){ee(e,-2541,"The document already exists.")}},{key:"LicenseNotSupportMobile",value:function(r){ee(r,-2542,"The current product key is missing the mobile license. Please contact the site administrator."),e.Lib.Errors.SetLTSException(r)}},{key:"LTSLicenseMixedWithOthers",value:function(e){ee(e,-2543,'You are using two different generations of Dynamsoft licenses. Please check the "Dynamsoft.DWT.ProductKey" specified in your application.')}},{key:"SelectScannerMustInvokeBeforeOperation",value:function(e){ee(e,-2544,"The method SelectDeviceAsync() must be invoked before the current operation.")}},{key:"InvalidServerUrl",value:function(e){ee(e,-2545,"The  proxy server URL is invalid.")}},{key:"FailedParseProductKey",value:function(e){ee(e,K.LicenseParseFailed,"The license is invalid.")}},{key:"GetDevicesMustInvokeBeforeAcuireImage",value:function(e){ee(e,-2547,"The method GetDevicesAsync() must be invoked before the current operation.")}},{key:"CannotDoWhenNoViewerJS",value:function(e){ee(e,-2548,"You cannot call this function when Dynamsoft.DWT.UseDefaultViewer is set to false.")}},{key:"CannotDoWhenNoViewer",value:function(e){ee(e,-2549,"You cannot call this function when there is no ui binding.")}},{key:"WebviewerError",value:function(e,r,t){ee(e,t||-2600,r)}},{key:"ClearErrorInfo",value:function(e){ee(e,0,"")}},{key:"SetLTSException",value:function(r){var t=e.DWT.licenseException;t.code=r._errorCode,t.message=r._errorString,t.fromLTS=!1}},{key:"ThrowFailedConnectToRemoteDynamsoftService",value:function(e){var r=e;return r||(r="[]"),{code:-2601,message:"Failed to connect to the Dynamsoft Service on "+r+". Please make sure Dynamsoft Service is running or the certificate is valid."}}},{key:"ThrowInvalidParameterSendTo",value:function(){return{code:-2602,message:'The parameter "SendTo" is invalid.'}}},{key:"ThrowMobileNotSupportOS",value:function(e){return{code:-2603,message:e+" is not supported for your Operating System."}}},{key:"ThrowFailedConnectToProxyServer",value:function(){return{code:-2604,message:"Failed to connect to the Proxy Service. Please make sure the Proxy Service is configured successfully, Dynamsoft Service is running, or the certificate is valid."}}},{key:"ServiceSyncMethodNotSupport",value:function(e,r){ee(e,-2605,'The synchronized method "'+r+'" is not supported under the current settings.')}},{key:"ServiceAsyncMethodNotSupport",value:function(e,r){ee(e,-2606,'The asynchronized method "'+r+'" is not supported under the current settings.')}},{key:"ThrowString_FailedToCreateDWTObject",value:function(e){if(e._bRemoteMode){var t,n,i=null===(t=e._dmService)||void 0===t||null===(n=t.attrs)||void 0===n?void 0:n.name;return r.Errors.ThrowFailedConnectToRemoteDynamsoftService(i).message}return"The Dynamsoft Service has been stopped."}},{key:"DeviceNotFound",value:function(e){ee(e,-2607,"The device selected was not found under the current service object.")}},{key:"RemoteServiceCannotSetShowFileDialog",value:function(e){ee(e,-2608,"IfShowFileDialog cannot be set to true when Object is created by CreateRemoteScanObjectAsync.")}},{key:"RemoteServiceCannotLoadDibFromClipboard",value:function(e){ee(e,-2609,"LoadDibFromClipboard is not supported when Object is created by CreateRemoteScanObjectAsync.")}},{key:"OpenSourceMustAsyncWhenRemote",value:function(e){ee(e,-2610,"OpenSource is not supported when Object is created by CreateRemoteScanObjectAsync. Please use OpenSourceAsync instead.")}},{key:"LicenseNoDbr",value:function(r){ee(r,-2611,"The license for the Barcode module is invalid."),e.Lib.Errors.SetLTSException(r)}},{key:"ThrowDevicesNotArray",value:function(){return{code:-2612,message:"The devices must be an Array."}}},{key:"DynamsoftServiceStopped",value:function(t,n){r.isString(n)&&""!=n?ee(t,e.DWT.EnumDWT_Error.RemoteDynamsoftServiceStopped,"The Dynamsoft Service on ["+n+"] has been stopped."):ee(t,-2308,"The Dynamsoft Service has been stopped.")}},{key:"DynamsoftServiceRestarted",value:function(e){ee(e,-2614,"The Dynamsoft Service has been restarted.")}},{key:"UserCanceled",value:function(e){ee(e,-2615,"User cancelled the operation.")}},{key:"InvalidImageFormatType",value:function(e){ee(e,-2616,"Invalid image format type.")}},{key:"ShareImagesOnlyForAndroid",value:function(e){ee(e,-2617,"ShareImages is only supported on Android devices.")}},{key:"GetImagesIndexMoreThanOne",value:function(e){ee(e,-2618,"Only single index selection is allowed when enumImageType is set to BMP, JPG or PNG.")}},{key:"GetImagesByURLMoreThanOne",value:function(e){ee(e,-2619,"Only single index selection is allowed when enumImageFormatType is set to url.")}},{key:"RemoteScanObjectDispose",value:function(e){ee(e,-2620,"The RemoteScan object has been disposed.")}},{key:"ContainersNotSet",value:function(e){ee(e,-2621,"Dynamsoft.DWT.Containers was not set.")}},{key:"SaveImagesErrorType",value:function(e){ee(e,-2622,'Please do not set enumImageType to "IT_MULTIPAGE_PDF", "IT_MULTIPAGE_TIF" or "IT_ALL".')}},{key:"SaveIndexMoreThanOne",value:function(e){ee(e,-2623,"Saving multiple images is not allowable when the selected output format is BMP, JPG or PNG.")}},{key:"ServiceNotInstalled",value:function(e){ee(e,-2800,"Please make sure the Dynamsoft Service has been installed.")}},{key:"DynamsoftServiceResponseDataTypeError",value:function(r){ee(r,e.DWT.EnumDWT_Error.ResponseDataTypeError,"Invalid response data was returned from the Dynamsoft Service.")}},{key:"ConfigLoadTimedout",value:function(){return{code:-2802,message:"The file dynamsoft.webtwain.config.js timed out while loading."}}},{key:"JsLoadFailed",value:function(){return{code:-2803,message:"Loading the WebTwain JavaScript source files has failed."}}},{key:"CssLoadFailed",value:function(){return{code:-2804,message:"Loading the WebTwain css files has failed."}}},{key:"webtwain_id_not_string",value:function(){return{code:-2805,message:'Error: The "WebTwainId" is not a string.'}}},{key:"container_id_not_string",value:function(){return{code:-2806,message:'Error: The argument passed to the parameter "conatinerId" is not a string.'}}},{key:"container_id_not_exist",value:function(e){return{code:-2807,message:'Error: The element specified by the id "'+e+"\" doesn't exist."}}},{key:"ServiceVersionError",value:function(e,r){ee(e,-2811,r)}},{key:"ERR_CreateID_WebTwainIdDuplicated",value:function(e){ee(e,-2812,r.product.CustomizableDisplayInfo.errorMessages.ERR_CreateID_WebTwainIdDuplicated)}},{key:"ERR_CreateID_NotContainer",value:function(e){ee(e,-2813,r.product.CustomizableDisplayInfo.errorMessages.ERR_CreateID_NotContainer)}},{key:"ERR_MODULE_NOT_INSTALLED",value:function(e){ee(e,-2814,r.product.CustomizableDisplayInfo.errorMessages.ERR_MODULE_NOT_INSTALLED)}},{key:"ERR_CreateID_MustNotInContainers",value:function(e){ee(e,-2815,r.product.CustomizableDisplayInfo.errorMessages.ERR_CreateID_MustNotInContainers)}},{key:"HTTPError",value:function(e,r,t){ee(e,-2816,["HTTP process error: ",t," (",r,")."].join(""))}},{key:"HTSTError",value:function(){return{code:e.DWT.EnumDWT_Error.HTSTError,message:"The Connection from the insecure (HTTP) web page failed for HTST."}}},{key:"ThrowSSLCertExpired",value:function(){return{code:-2818,message:"The Dynamsoft Service SSL certificate has expired."}}},{key:"ThrowSSLCertInvalid",value:function(){return{code:-2819,message:"The Dynamsoft Service SSL certificate is invalid."}}},{key:"ThrowHTTPCORS",value:function(){return{code:e.DWT.EnumDWT_Error.CORSError,message:'The Connection from the insecure (HTTP) web page to the local "Dynamsoft Service" failed!'}}},{key:"ThrowEnhancedPortNotReady",value:function(){return{code:e.DWT.EnumDWT_Error.EnhancedPortNotReady,message:"The Dynamsoft Service is not ready, please try again later."}}},{key:"LtsJsLoadFailed",value:function(){return{code:-2822,message:"The WebTwain JavaScript lts.js load failed."}}},{key:"HTTPRedirected",value:function(){return{code:e.DWT.EnumDWT_Error.HTTPRedirected,message:"The http url redirected."}}},{key:"ConnectToDynamsoftServiceError",value:function(){return{code:-2824,message:"The Connection from the web page failed. Please make sure the Dynamsoft Service is running."}}},{key:"DefaultDynamsoftServiceInvalidError",value:function(){return{code:-2825,message:"Failed to setup the Default Dynamsoft Service."}}},{key:"CreateDynamsoftServiceError",value:function(e){return{code:-2826,message:"Failed to connect the Dynamsoft Service on ["+e+"]."}}},{key:"BboError",value:function(){return{code:-2827,message:"Failed to get Machine ID."}}}]),t}();function te(e,r,t,n,i,o,a){try{var s=e[o](a),u=s.value}catch(Ke){return void t(Ke)}s.done?r(u):Promise.resolve(u).then(n,i)}function ne(e){return function(){var r=this,t=arguments;return new Promise((function(n,i){var o=e.apply(r,t);function a(e){te(o,n,i,a,s,"next",e)}function s(e){te(o,n,i,a,s,"throw",e)}a(undefined)}))}}r.Errors=new re;var ie="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function oe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e["default"]:e}var ae={exports:{}},se={exports:{}};!function(e){function r(t){return e.exports=r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports["default"]=e.exports,r(t)}e.exports=r,e.exports.__esModule=!0,e.exports["default"]=e.exports}(se);var ue=se.exports;!function(e){var r=ue["default"];function t(){e.exports=t=function(){return n},e.exports.__esModule=!0,e.exports["default"]=e.exports;var n={},i=Object.prototype,o=i.hasOwnProperty,a=Object.defineProperty||function(e,r,t){e[r]=t.value},s="function"==typeof Symbol?Symbol:{},u=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function d(e,r,t){return Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{d({},"")}catch(F){d=function(e,r,t){return e[r]=t}}function f(e,r,t,n){var i=r&&r.prototype instanceof p?r:p,o=Object.create(i.prototype),s=new D(n||[]);return a(o,"_invoke",{value:E(e,t,s)}),o}function h(e,r,t){try{return{type:"normal",arg:e.call(r,t)}}catch(F){return{type:"throw",arg:F}}}n.wrap=f;var g={};function p(){}function m(){}function _(){}var v={};d(v,u,(function(){return this}));var y=Object.getPrototypeOf,I=y&&y(y(x([])));I&&I!==i&&o.call(I,u)&&(v=I);var S=_.prototype=p.prototype=Object.create(v);function T(e){["next","throw","return"].forEach((function(r){d(e,r,(function(e){return this._invoke(r,e)}))}))}function b(e,t){function n(i,a,s,u){var c=h(e[i],e,a);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==r(d)&&o.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,s,u)}),(function(e){n("throw",e,s,u)})):t.resolve(d).then((function(e){l.value=e,s(l)}),(function(e){return n("throw",e,s,u)}))}u(c.arg)}var i;a(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(o,o):o()}})}function E(e,r,t){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return P()}for(t.method=i,t.arg=o;;){var a=t.delegate;if(a){var s=C(a,t);if(s){if(s===g)continue;return s}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if("suspendedStart"===n)throw n="completed",t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);n="executing";var u=h(e,r,t);if("normal"===u.type){if(n=t.done?"completed":"suspendedYield",u.arg===g)continue;return{value:u.arg,done:t.done}}"throw"===u.type&&(n="completed",t.method="throw",t.arg=u.arg)}}}function C(e,r){var t=r.method,n=e.iterator[t];if(undefined===n)return r.delegate=null,"throw"===t&&e.iterator["return"]&&(r.method="return",r.arg=undefined,C(e,r),"throw"===r.method)||"return"!==t&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+t+"' method")),g;var i=h(n,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var o=i.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=undefined),r.delegate=null,g):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function w(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function k(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function x(e){if(e){var r=e[u];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var t=-1,n=function r(){for(;++t<e.length;)if(o.call(e,t))return r.value=e[t],r.done=!1,r;return r.value=undefined,r.done=!0,r};return n.next=n}}return{next:P}}function P(){return{value:undefined,done:!0}}return m.prototype=_,a(S,"constructor",{value:_,configurable:!0}),a(_,"constructor",{value:m,configurable:!0}),m.displayName=d(_,l,"GeneratorFunction"),n.isGeneratorFunction=function(e){var r="function"==typeof e&&e.constructor;return!!r&&(r===m||"GeneratorFunction"===(r.displayName||r.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,d(e,l,"GeneratorFunction")),e.prototype=Object.create(S),e},n.awrap=function(e){return{__await:e}},T(b.prototype),d(b.prototype,c,(function(){return this})),n.AsyncIterator=b,n.async=function(e,r,t,i,o){void 0===o&&(o=Promise);var a=new b(f(e,r,t,i),o);return n.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(S),d(S,l,"Generator"),d(S,u,(function(){return this})),d(S,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var r=Object(e),t=[];for(var n in r)t.push(n);return t.reverse(),function i(){for(;t.length;){var e=t.pop();if(e in r)return i.value=e,i.done=!1,i}return i.done=!0,i}},n.values=x,D.prototype={constructor:D,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=undefined,this.done=!1,this.delegate=null,this.method="next",this.arg=undefined,this.tryEntries.forEach(k),!e)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=undefined)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function t(t,n){return a.type="throw",a.arg=e,r.next=t,n&&(r.method="next",r.arg=undefined),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],a=i.completion;if("root"===i.tryLoc)return t("end");if(i.tryLoc<=this.prev){var s=o.call(i,"catchLoc"),u=o.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return t(i.catchLoc,!0);if(this.prev<i.finallyLoc)return t(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return t(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return t(i.finallyLoc)}}}},abrupt:function(e,r){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=r,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),g},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var t=this.tryEntries[r];if(t.finallyLoc===e)return this.complete(t.completion,t.afterLoc),k(t),g}},"catch":function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var t=this.tryEntries[r];if(t.tryLoc===e){var n=t.completion;if("throw"===n.type){var i=n.arg;k(t)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,t){return this.delegate={iterator:x(e),resultName:r,nextLoc:t},"next"===this.method&&(this.arg=undefined),g}},n}e.exports=t,e.exports.__esModule=!0,e.exports["default"]=e.exports}(ae);var ce=(0,ae.exports)(),le=ce;try{regeneratorRuntime=ce}catch(NL){"object"==typeof globalThis?globalThis.regeneratorRuntime=ce:Function("r","regeneratorRuntime = r")(ce)}var de=oe(le);function fe(e,t,n){if(r.isString(e)&&(e.indexOf("Function not found")>0||e.indexOf("Version not found")>0))t&&t(e);else{var i=e.data;if("object"===J(i))return i=null,e=null,void(n&&n());var o=i.replace(/\0/g,"");try{t&&t(o)}catch(a){r.log(i),n&&n()}i=null,e=null}}function he(e,t){e&&e.readyState!=L&&e.readyState!=N?e.readyState==R?(e.onerror=function(t){t&&r.log("websocket error: "+t),e._reject&&(e._reject(),e._reject=null),e.close()},e.onclose=function(r){e.onclose=null,e.onerror=null,e.onmessage=null,e.onopen=null,e._reject=null},e.onopen=function(){e.readyState==O?(e.onopen=null,e.send(t)):e.readyState==R&&(e.onopen?setTimeout(e.onopen,100):e._reject&&(e._reject(),e._reject=null))}):e.readyState==O&&(e.onopen=null,e.send(t)):e._reject&&(e._reject(),e._reject=null)}function ge(r,t,n){var i=n;return i||(i=e.navInfoSync.bSSL?"https://":"http://"),[i,r,":",t,"/"].join("")}var pe=function(){function t(){X(this,t)}return Q(t,null,[{key:"postStringDataByWS",value:function(e,t){return new r.Promise((function(r,n){e.onmessage=function(t){fe(t,(function(t){r(t),e.close(),e=null}),(function(){n(),e.close(),e=null}))},e._reject=n,he(e,t)}))}},{key:"postStringDataByWSUrl",value:function(n,i){var o=new r.Promise((function(e,r){var o=t.newWebsocket(n,!1);o.onmessage=function(t){fe(t,(function(r){e(r),o.close(),o=null}),(function(){r(),o.close(),o=null}))},o._reject=r,he(o,i)}));return e.navInfoSync.bEdge&&o["catch"]((function(){return new r.Promise((function(e,r){var o=t.newWebsocket(n,!0);o.onmessage=function(t){fe(t,(function(r){e(r),o.close(),o=null}),(function(){r(),o.close(),o=null}))},o._reject=r,he(o,i)}))})),o}},{key:"newWebsocket",value:function(r,t){var n,i=e.dcp.wsProtocol,o=window.MozWebSocket;if(void 0!==o)n=i?new o(r,i):new o(r);else{var a=window.WebSocket;if(t){var s=window,u=parent;try{for(;s!=u&&u.WebSocket;)a=u.WebSocket,s=u.window,u=u.parent}catch(c){a=window.WebSocket}}n=i?new a(r,i):new a(r)}return n}},{key:"getWsUrl",value:function(r,t,n){var i=n;return i===undefined&&(i=e.navInfoSync.bSSL),ge(r,t,i?"wss://":"ws://")}},{key:"getDDMUrl",value:function(e,t,n){var i,o,a="/";return r.startsWith(e,"https://")?i=!0:r.startsWith(e,"http://")?i=!1:e=(i=r.detect.ssl)?"https://"+e:"http://"+e,o=i?"18626/":"18625/",r.endsWith(e,"/")&&(a=""),t?[e,a,"ddm/",o,n].join(""):[e,a,n].join("")}},{key:"getModuleUrl",value:function(r){var t,n=e.dcp;return t=ge(f(),e.navInfoSync.bSSL?n.SSLPort:n.Port),r?t+r:t}}]),t}();e.DWT.NetManager=pe;var me=Q((function ML(e,r,t,n,i){X(this,ML),this.server=e,this.port=r,this.ssl=t,this.useWS=n,this.protocol=i}));function _e(e,r,t){return(r=Y(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function ve(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ye(e,r){return ye=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,r){return e.__proto__=r,e},ye(e,r)}function Ie(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&ye(e,r)}function Se(e,r){if(r&&("object"===J(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return ve(e)}function Te(e){return Te=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Te(e)}var be={OK:0,Custom:-1,NWB:-4200,WS_DISCONN:-4201,CB:-5e3,JSON_REQUIRED:-5001,OBJECT_DISPOSED:-5002,INVALID_TASK:-5003,OBJECT_DISPOSING:-5004},Ee="The Web Socket connection failed.",Ce="The input is not a JSON object or JSON styled string.",we="The object has been disposed.",ke="The task is invalid.",De="The object need to be disposed.",xe=function(){function e(){X(this,e)}return Q(e,null,[{key:"message",value:function(e){return this._errorMessage[e]}},{key:"init",value:function(){this._errorMessage[be.OK]="Successful.",this._errorMessage[be.WS_DISCONN]=Ee,this._errorMessage[be.JSON_REQUIRED]=Ce,this._errorMessage[be.OBJECT_DISPOSED]=we,this._errorMessage[be.INVALID_TASK]=ke,this._errorMessage[be.OBJECT_DISPOSING]=De}}]),e}();_e(xe,"_errorMessage",Object.create(null)),xe.init();var Pe,Fe=function(){function e(r,t){X(this,e),_e(this,"_code",be.OK),this.name="DSError",this.message=null!=t?t:"string"==typeof r?r:xe.message(r),this._code="string"==typeof r?be.Custom:r}return Q(e,[{key:"code",get:function(){return this._code}}]),e}();function We(e){return{code:e._errorCode,message:e._errorString}}function Ae(e){return"exception"in e&&"description"in e&&0!=e.exception&&""!=e.description}!function(e){e.NONE=0,e.TRACE=1,e.DEBUG=2,e.INFO=4,e.WARN=8,e.ERROR=16}(Pe||(Pe={}));var Re=r.getLogger(),Oe=function(){function e(){X(this,e)}return Q(e,null,[{key:"LogLevel",get:function(){return this._logLevel},set:function(e){this._logLevel=e}},{key:"LogFunc",set:function(e){this._logFunc=e}},{key:"all",value:function(e,r){if((this._logLevel&e)==e)if(this._logFunc)this._logFunc(r,e);else switch(e){case Pe.DEBUG:Re.debug(r);break;case Pe.ERROR:Re.error(r);break;case Pe.INFO:Re.info(r);break;case Pe.WARN:Re.warn(r);break;case Pe.TRACE:Re.trace(r)}}},{key:"trace",value:function(e){this.all(Pe.TRACE,e)}},{key:"debug",value:function(e){this.all(Pe.DEBUG,e)}},{key:"info",value:function(e){this.all(Pe.INFO,e)}},{key:"warn",value:function(e){this.all(Pe.WARN,e)}},{key:"error",value:function(e){this.all(Pe.ERROR,e)}}]),e}();function Le(e){window.console&&(e instanceof Error||r.isString(e)?window.console.error(e):window.console.error(r.stringify(e)))}_e(Oe,"_logLevel",Pe.ERROR),_e(Oe,"_logFunc",undefined);var Ne,Me={GET_TASKID:0,GET_EVENT_TASKID:1,ONMESSAGE_PROCESS_DATA:2,ONMESSAGE_GET_TASKID:3,ONMESSAGE_GET_EVENT_TASKID:4,HANDLE_RAW_MESSAGE:5,HANDLE_PROCESSED_MESSAGE:6},Ue=function(){function e(r){X(this,e),_e(this,"_serverInfo",undefined),_e(this,"_disposed",!1),this._serverInfo=r,this._ref=1}var r,t;return Q(e,[{key:"serverInfo",get:function(){return this._serverInfo}},{key:"requestSync",value:function(e,r){return Oe.error("requestSync should be implemented in child class"),undefined}},{key:"request",value:function(){var e=ne(de.mark((function r(e,t,n,i){return de.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Oe.error("request should be implemented in child class"),e.abrupt("return",Promise.resolve(null));case 2:case"end":return e.stop()}}),r)})));return function(r,t,n,i){return e.apply(this,arguments)}}()},{key:"send",value:(t=ne(de.mark((function n(e,r,t){return de.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Oe.error("reqsenduestSync should be implemented in child class");case 1:case"end":return e.stop()}}),n)}))),function(e,r,n){return t.apply(this,arguments)})},{key:"testConnection",value:(r=ne(de.mark((function i(e,r,t,n){return de.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Oe.error("testConnection should be implemented in child class"),e.abrupt("return",Promise.resolve(undefined));case 2:case"end":return e.stop()}}),i)}))),function(e,t,n,i){return r.apply(this,arguments)})},{key:"disposed",get:function(){return this._disposed}},{key:"dispose",value:function(){if(this._ref--,this._ref>0)return!1;this._disposed=!0,this._terminate()}},{key:"_terminate",value:function(){}},{key:"addRef",value:function(){this._ref++}}]),e}(),Be=!1,Ve=!0,Ge=0,je=1,He=e.Lib,ze=He.each,Ke=He.error,qe=He.isFunction,Xe=He.isString,Je=e.navInfoSync,Ye=Je.bIE&&parseInt(Je.IEVersion)<=9,Ze=Je.bIE&&parseInt(Je.IEVersion)<=10,Qe=window,$e=new He.Uri(location.href),er=$e&&/^(?:about|app|app\-storage|.+\-extension|file|widget)$/.test($e.getScheme()),rr=!1,tr=function(){try{return new Qe.XMLHttpRequest}catch(e){}},nr=function(){try{var e=Be;return ze(["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.3.0","Msxml3.XMLHTTP"],(function(r){try{if(!e)return e=new Qe.ActiveXObject(r),Be}catch(t){Ke("new xhr error: "+t.message)}})),e}catch(r){}},ir=!(er||!Qe.XMLHttpRequest)&&"withCredentials"in(tr()||[]),or=Qe.ActiveXObject?function(e){return Ye?nr():!er&&tr()||nr()}:tr,ar=function(e){return rr},sr=/^(?:GET|HEAD)$/,ur=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,cr={xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":"*/*"},lr=Ne;Ze&&(lr=He.noop);var dr=function(){function r(){X(this,r),_e(this,"url",!1),_e(this,"onSuccess",!1),_e(this,"onError",!1),_e(this,"onComplete",!1),_e(this,"method","GET"),_e(this,"async",!0),_e(this,"xhrFields",!1),_e(this,"mimeType",!1),_e(this,"username",!1),_e(this,"password",!1),_e(this,"data",!1),_e(this,"dataType","text"),_e(this,"headers",!1),_e(this,"contentType","application/x-www-form-urlencoded; charset=UTF-8"),_e(this,"beforeSend",!1),_e(this,"afterSend",!1),_e(this,"timeout",0),_e(this,"cache",!0),_e(this,"crossDomain",!1),_e(this,"retry",0)}return Q(r,[{key:"setRequestHeader",value:function(e,r){this.headers[e]=r}},{key:"getAllResponseHeaders",value:function(){return 2===this.state?this.responseHeadersString:null}},{key:"getNativeXhr",value:function(){return this.nativeXhr}},{key:"getResponseHeader",value:function(e){var r,t;if(e=e.toLowerCase(),2===this.state){if(!(t=this.responseHeaders))for(t=this.responseHeaders={};r=ur.exec(this.responseHeadersString);)t[r[1].toLowerCase()]=r[2];r=t[e]}return r===undefined?null:r}},{key:"overrideMimeType",value:function(e){return this.state||(this.mimeType=e),this}},{key:"abort",value:function(e){return this.state=3,this.status=0,this.statusText=null!=e?e:"abort",this.nativeXhr&&this.nativeXhr.abort(),this._callback(),this}},{key:"_ioReady",value:function(e,r){var t=!1,n=this;if(2!==this.state&&3!==this.state){1===this.state&&(this.state=2),this.readyState=4,e>=200&&e<300||304===e?304===e?(r="not modified",t=!0):(r="success",t=!0):e<0&&(e=0);try{e>=200&&this.handleResponseData()}catch(i){Ke(i,"error"),r=i.message||"parser error"}if((e<200||!t)&&this.retry>0)return this.retry=this.retry-1,void setTimeout((function(){n.sendInternal()}),200);this.status=e,this.statusText=r,this._callback(t)}}},{key:"_callback",value:function(e){var r=this,t=this.timeoutTimer;t&&(clearTimeout(t),this.timeoutTimer=0),ze([e?this.onSuccess:this.onError,this.onComplete],(function(e){qe(e)&&e.apply(r.context,[r.responseData,r.statusText,r])})),this.responseData=null}},{key:"handleResponseData",value:function(){var r,t=this.dataType,n=this.nativeXhr;if("blob"===t||"arraybuffer"===t)if(Ye){var i,o,a;if("responseBody"in n)i=n.responseBody,o=Qe.dsVbsBinGetLength(i),r=new Qe.VBArray(Qe.dsVbsBinGetBytes(i,0,o)).toArray();else for(r=[],o=(i=n.responseText).length,a=0;a<o;++a)r.push(255&i.charCodeAt(a));i=null}else r=Qe.Blob?n.response:"responseBody"in n?n.responseBody:n.responseText;else if("json"==t)r=n.responseType&&"json"==n.responseType.toLowerCase()?n.response:n.responseText?e.Lib.parse(n.responseText):e.Lib.parse(n.response);else if("user-defined"===t)r=n.response!==undefined?n.response:n.responseText;else{this.responseText=r=n.responseText||"";try{var s=n.responseXML;s&&s.documentElement&&(this.responseXML=s)}catch(u){}}this.responseData=r}},{key:"sendInternal",value:function(e){var r,t,n,i,o,a,s,u,c,l,d,f=this;if(t=(r=this._setup(e)).method,Xe(t)&&(t=t.toUpperCase()),o=r.contentType,n=r.url,i=r.dataType,u=r.mimeType,Xe(n)&&(this.nativeXhr=a=or(r.crossDomain),a)){try{if(this.state=1,r.username?a.open(t,n,r.async,r.username,r.password):a.open(t,n,r.async),(r.async||Je.bIE)&&i&&"user-defined"!=i&&"responseType"in a)try{a.responseType=i}catch(h){}}catch(g){return void(this.state<2?(Ke(g,"error"),this._ioReady(-1,"open error: "+(He.isNumber(g.number)?"("+g.number+")":"")+(g.message||""))):Ke(g))}"withCredentials"in(s=r.xhrFields||{})&&(ir||delete s.withCredentials),ze(s,(function(e,r){try{a[r]=e}catch(h){Ke(h)}})),u&&a.overrideMimeType&&a.overrideMimeType(u),!1===(c=r.headers||{})["X-Requested-With"]&&delete c["X-Requested-With"],"setRequestHeader"in a&&(o&&a.setRequestHeader("Content-Type",r.contentType),a.setRequestHeader("Accept",i&&cr[i]?cr[i]+("*"===i?"":", */*; q=0.01"):cr["*"]),ze(c,(function(e,r){a.setRequestHeader(r,e)}))),r.cache||(a.setRequestHeader("If-Modified-Since","0"),a.setRequestHeader("Cache-Control","no-cache")),d=(l=!sr.test(r.method))&&r.data||null,l&&Ye&&(d=r.data),r.async&&r.timeout>0&&(r.timeout<300&&(r.timeout=300),this.timeoutTimer=setTimeout((function(){f.abort("timeout")}),r.timeout));try{if(this.state=1,qe(this.beforeSend))if(!1===this.beforeSend(a,f))return void this.abort("cancel");a.send(d),d=null,r.data=null,qe(this.afterSend)&&this.afterSend(f)}catch(h){this.state<2?(Ke(h,"error"),this._ioReady(-1,"send error: "+(h.message||""))):Ke(h)}r.async&&4!==a.readyState?a.onreadystatechange=function(){f._xhrCallback()}:f._xhrCallback()}}},{key:"_xhrCallback",value:function(e,r){var t=this.nativeXhr;try{if(4===t.readyState||r)if(ar()||(t.onreadystatechange=lr),r)4!==t.readyState&&t.abort();else{ar()||(this.responseHeadersString=t.getAllResponseHeaders());var n,i=t.status;try{n=t.statusText}catch(o){Ke("xhr statusText error: "),Ke(o),n=""}this._ioReady(i,n)}}catch(o){Ke(o,"error"),t.onreadystatechange=lr,r||this._ioReady(-1,o.message||"process error")}}},{key:"_setup",value:function(e){var t,n,i,o,a;if(e){for(n in this.context=e.context,delete e.context,e instanceof r&&(e=e.config),this.config=e,o=e.url,He.startsWith(o,"//")&&(e.url=o="http:"+o),(He.startsWith(o,"http://")||He.startsWith(o,"https://"))&&(a=new He.Uri(o)),t=e.dataType?e.dataType.toLowerCase():"text",e.dataType=t,e.method?e.method=e.method.toUpperCase():e.method="GET",a&&!("crossDomain"in e)&&(e.crossDomain=!a.isSameOriginAs($e)),i=e.headers)i[n]===Ne&&delete i[n];He.mix(this,e)}return this.state=1,this}},{key:"dispose",value:function(){this.responseHeaders=null,this.responseHeadersString=null,this.responseData=null,this.responseText=null,this.responseXML=null,this.context=null,this.config=null,this.onSuccess=null,this.onError=null,this.onComplete=null,this.xhrFields=null,this.data=null,this.headers=null,this.beforeSend=null,this.afterSend=null}}]),r}();function fr(e){if(e&&Xe(e.url)){var r=new dr;return r.sendInternal(e),r}He.log("the url is error.")}var hr,gr,pr=e.Lib,mr=e.navInfoSync,_r=mr.bIE&&parseInt(mr.IEVersion)<=9;hr=self&&self.fetch?self.fetch:window.fetch;var vr=0;function yr(r,t){var n,i=!1;return vr=t,hr?n=function(n,o){var a=!1,s="text",u=!1;if(o&&(o.dataType&&(s=o.dataType),o.fetchRaw&&(u=!0),o.timeout)){var c=o.timeout;c<300&&(c=300);var l=new AbortController;o.signal=l.signal,setTimeout((function(){a||l.abort()}),c)}i=!1;var d=hr(n,o).then((function(e){if(e.ok){var n,o;if(a=!0,!r)return e;r.IfShowCancelDialogWhenImageTransfer?(Sr(!0),o=r.on("cancel",(function(){i=!0}))):Sr(!1);var s=e.headers.get("Content-Length"),u=0;r._onPercent&&vr==t&&r._onPercent({loaded:u,total:s});var c=null==e||null===(n=e.body)||void 0===n?void 0:n.getReader(),l=new ReadableStream({start:function(e){c?setTimeout((function n(){return c.read().then((function(a){if(a.done||i)return i?c.cancel():o&&r.off("cancel",o),e.close(),void(o=null);var l=a.value;u+=l.length,r._onPercent&&vr==t&&r._onPercent({loaded:u,total:s});try{return e.enqueue(l),n()}catch(d){pr.error(d)}}))}),0):e.close()}}),d=e.headers.get("Content-Type");return d&&""!=d||(d="application/octet-stream"),new Response(l,{headers:{"Content-Type":d}})}if("opaqueredirect"==e.type)throw pr.Errors.HTTPRedirected();var f;throw f={},pr.Errors.HTTPError(f,e.status,e.statusText),{code:f._errorCode,message:f._errorString,httpCode:e.status}}));return u?d:(d="blob"==s?d.then((function(r){var t=r.headers.get("content-type");return"text/json"==t?r.json():e.navInfoSync.bLinux?r.arrayBuffer().then((function(e){return new Blob([e],{type:t})})):r.blob()})):"json"==s?d.then((function(e){return e.json()})):"arraybuffer"==s?d.then((function(e){return"text/json"==e.headers.get("content-type")?e.json():e.arrayBuffer()})):d.then((function(e){return e.text()}))).then((function(e){var r;if(i)throw r={},pr.Errors.UserCanceled(r),{code:r._errorCode,message:r._errorString};return e}))}:(_r&&pr.addVBS(["Function dsVbsBinGetAt(strBinary,iOffset)\r\n"," dsVbsBinGetAt=AscB(MidB(strBinary,iOffset+1,1))\r\n","End Function\r\n","Function dsVbsBinGetBytes(strBinary,iOffset,iLength)\r\n"," Dim aBytes()\r\n"," ReDim aBytes(iLength-1)\r\n"," For i=0 To iLength-1\r\n","  aBytes(i)=dsVbsBinGetAt(strBinary,iOffset+i)\r\n"," Next\r\n"," dsVbsBinGetBytes=aBytes\r\n","End Function\r\n","Function dsVbsBinGetLength(strBinary)\r\n"," dsVbsBinGetLength=LenB(strBinary)\r\n","End Function"].join("")),n=function(e,n){return new(pr.nativePromise||window.Promise)((function(i,o){var a,s=!1;a={url:e,async:!0,onSuccess:function(e,r,t){i(e)},onError:function(e,r,t){var n;n={},pr.Errors.HTTPError(n,t.status,r),o({code:n._errorCode,message:n._errorString,httpCode:t.status})},dataType:"text",method:gr,data:gr,headers:gr,contentType:gr,mimeType:gr},n&&(n.method&&(a.method=n.method),n.body&&(a.data=n.body),n.headers&&(a.headers||(a.headers={}),pr.each(n.headers,(function(e,r){"content-type"==r.toLowerCase()&&(s=!0),a.headers[r]=e}))),n.dataType&&(a.dataType=n.dataType),n.contentType&&(a.contentType=n.contentType)),s&&(a.contentType=!1),"blob"==a.dataType&&_r&&(a.mimeType="text/plain; charset=x-user-defined"),r&&(r._onPercent&&(a.beforeSend=function(e,n,i){e.upload.addEventListener("progress",(function(e){r._onPercent&&vr==t&&r._onPercent(e)}),!1)}),r.IfShowCancelDialogWhenImageTransfer?Sr(!0):Sr(!1));var u=fr(a);r&&r.IfShowCancelDialogWhenImageTransfer&&r.on("cancel",(function(){u.abort()}))}))}),n}var Ir=yr(null,0);function Sr(e){var r=pr.one(".dynamsoft-btnCancel"),t=r&&r.getEL();t&&(t.style.display=e?"":"none")}function Tr(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=Te(e);if(r){var i=Te(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return Se(this,t)}}function br(e,r){!function(e,r){if(r.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,r),r.add(e)}function Er(e,r,t){if(!r.has(e));return t}var Cr=r.getLogger(),wr=new WeakSet,kr=new WeakSet,Dr=function(e){Ie(o,e);var r,t,n,i=Tr(o);function o(){var e;X(this,o);for(var r=arguments.length,t=new Array(r),n=0;n<r;n++)t[n]=arguments[n];return br(ve(e=i.call.apply(i,[this].concat(t))),kr),br(ve(e),wr),e}return Q(o,[{key:"send",value:(n=ne(de.mark((function a(e,r,t){return de.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Cr.error("HTTP Client send not supported");case 1:case"end":return e.stop()}}),a)}))),function(e,r,t){return n.apply(this,arguments)})},{key:"requestSync",value:function(e,r,t){return undefined}},{key:"request",value:(t=ne(de.mark((function s(e,r,t,n){return de.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",Er(this,kr,Pr).call(this,e,r,t,undefined,undefined,n));case 1:case"end":return i.stop()}}),s,this)}))),function(e,r,n,i){return t.apply(this,arguments)})},{key:"testConnection",value:(r=ne(de.mark((function u(e,r,t,n){return de.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",Er(this,kr,Pr).call(this,undefined,undefined,e,r,t,n));case 1:case"end":return i.stop()}}),u,this)}))),function(e,t,n,i){return r.apply(this,arguments)})}]),o}(Ue);function xr(e){var t=this.serverInfo,n="";return n=t.ssl?"https://":"http://",n+=t.server,t.port&&(n+=":",n+=t.port),e&&(r.startsWith(e,"/")||r.endsWith(n,"/")||(n+="/"),r.endsWith(e,"/")?n+=e.slice(0,-1):n+=e),n}function Pr(e,r,t,n,i,o){return Fr.apply(this,arguments)}function Fr(){return Fr=ne(de.mark((function e(r,t,n,i,o,a){var s,u;return de.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=null!=n?n:{},r&&(s.body=r),s.method||(s.method="POST"),a&&(s.timeout=a),u=Er(this,wr,xr).call(this,t),Cr.debug("HTTP URL: "+u),e.next=9,Ir(u,s,i,o);case 9:return e.abrupt("return",e.sent);case 12:if(e.prev=12,e.t0=e["catch"](0),!(e.t0 instanceof Fe||e.t0&&e.t0.code&&e.t0.message)){e.next=18;break}throw e.t0;case 18:throw new Fe(e.t0.message);case 19:case"end":return e.stop()}}),e,this,[[0,12]])}))),Fr.apply(this,arguments)}function Wr(e){try{return"object"===J(e)?e:(e="string"!=typeof e?r.stringify(e):e,r.parse(e))}catch(t){throw t instanceof Fe?t:new Fe(be.JSON_REQUIRED)}}function Ar(e){return Math.random().toString(16).substring(2,2+e)}function Rr(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=Te(e);if(r){var i=Te(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return Se(this,t)}}function Or(e,r){!function(e,r){if(r.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,r),r.add(e)}function Lr(e,r,t){if(!r.has(e));return t}var Nr,Mr=r.getLogger(),Ur=new WeakSet,Br=new WeakSet,Vr=new WeakSet,Gr=new WeakSet,jr=new WeakSet,Hr=new WeakSet,zr=new WeakSet,Kr=function(e){Ie(s,e);var t,n,i,o,a=Rr(s);function s(e){var r;return X(this,s),Or(ve(r=a.call(this,e)),zr),Or(ve(r),Hr),Or(ve(r),jr),Or(ve(r),Gr),Or(ve(r),Vr),Or(ve(r),Br),Or(ve(r),Ur),_e(ve(r),"_defaultRetries",1),_e(ve(r),"_ws",Nr),_e(ve(r),"_events",{}),_e(ve(r),"_bHeartBeatStarted",!1),_e(ve(r),"_heartBeatTicks",6e4),r._ws=Nr,r.bUseParentWS=!1,r._tasks=Object.create(null),r.bReady=!1,r._blob_callbacks=[],r._processing_blob=!1,r}return Q(s,[{key:"ws",get:function(){return this._ws}},{key:"requestSync",value:function(e,r,t){return Mr.error("WebSocket Client requestSync not supported"),undefined}},{key:"send",value:(o=ne(de.mark((function u(e,r,t){var n,i,o,a,s;return de.wrap((function(u){for(;;)switch(u.prev=u.next){case 0:if(n=t.client,u.prev=1,(i=t.taskId)!==undefined){u.next=7;break}return u.next=6,r(e,Me.GET_TASKID,n._requestTaskId,t);case 6:i=u.sent;case 7:if(o=n._tasks[i]){u.next=11;break}throw Mr.error("invalid task id: "+i),new Fe(be.INVALID_TASK);case 11:return u.next=13,Lr(n,jr,$r).call(n,!1);case 13:return u.next=15,Lr(n,Hr,rt).call(n,e,r,t,o);case 15:Mr.debug("begin to send data "+i),n.disposed||n._ws.send(e),e=null,Mr.debug("end to send data "+i),u.next=27;break;case 21:u.prev=21,u.t0=u["catch"](1),Mr.debug("failed to send data."),Mr.error(u.t0),delete n._tasks[i],null===(a=o)||void 0===a||null===(s=a.resolver)||void 0===s||s.reject(u.t0.message);case 27:case"end":return u.stop()}}),u,null,[[1,21]])}))),function(e,r,t){return o.apply(this,arguments)})},{key:"request",value:(i=ne(de.mark((function c(e,r,t,n){var i,o,a;return de.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return i=this._defaultRetries,o=null!=r?r:Lr(this,Gr,Zr),a=null!=t?t:{client:this,userData:this},s.abrupt("return",Lr(this,zr,nt).call(this,e,o,a,i,!1,undefined,n));case 2:case"end":return s.stop()}}),c,this)}))),function(e,r,t,n){return i.apply(this,arguments)})},{key:"connected",get:function(){var e;return(null===(e=this._ws)||void 0===e?void 0:e.readyState)==WebSocket.OPEN}},{key:"testConnection",value:function(e,r,t,n){return Lr(this,jr,$r).call(this,!0,null!=r?r:0,t,n)}},{key:"_terminate",value:(n=ne(de.mark((function l(){var e;return de.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:for(e in Mr.debug("terminate WSClient"),this.fireEvent("disposed"),this._tasks)this._tasks[e]!==undefined&&this._tasks[e].resolver&&this._tasks[e].resolver.reject(new Fe(be.OBJECT_DISPOSING));this._lic_callback=Nr,this._blob_callbacks=[],this._processing_blob=!1,this._ws&&(this._ws.onopen=null,this._ws.onerror=null,this._ws.onmessage=null,this._ws.onclose=null,this._ws.close()),this._ws=Nr,this._tasks=Object.create(null);case 9:case"end":return r.stop()}}),l,this)}))),function(){return n.apply(this,arguments)})},{key:"setRetry",value:function(e){this._defaultRetries=null!=e?e:1}},{key:"addEvent",value:function(e,t,n){var i=this._events[e];i||(this._events[e]={},i=this._events[e]),r.isString(t)&&r.isFunction(n)&&(i[t]=n)}},{key:"removeEvent",value:function(e,t){var n=this._events[e];n&&r.isString(t)&&delete n[t]}},{key:"clearEvent",value:function(e){this._events[e]&&(this._events[e]={})}},{key:"fireEvent",value:function(e){var t,n=this._events[e];if(n){var i=Object.keys(n);for(t=0;t<i.length;t++)r.isFunction(n[i[t]])&&n[i[t]]()}}},{key:"getRequestTaskId",value:function(){return this._requestTaskId?this._requestTaskId:0}}],[{key:"_waitForPreBlob",value:(t=ne(de.mark((function d(e){return de.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!e._processing_blob){r.next=3;break}return setTimeout((function(){s._waitForPreBlob(e)}),500),r.abrupt("return");case 3:s._preBlobResolv&&s._preBlobResolv();case 4:case"end":return r.stop()}}),d)}))),function(e){return t.apply(this,arguments)})}]),s}(Ue);function qr(e){var r="";return r=e.ssl?"wss://":"ws://",r+=e.server,e.port&&(r+=":",r+=e.port),r}function Xr(e,t,n,i){var o=this;return new r.Promise((function(r,a){try{var s,u;if(i&&(u=setTimeout((function(){s&&s.close();var e=new Fe("createWebSocket timed out.");Mr.debug(e.message),a(e)}),i)),e.bUseParentWS){var c=window,l=parent,d=c.WebSocket;try{for(;c!=l&&l&&l.WebSocket;)d=l.WebSocket,c=l.window,l=l.parent}catch(f){d=window.WebSocket}s=n?new d(t,n):new d(t)}else s=n?new WebSocket(t,n):new WebSocket(t);s.onopen=function(){u&&clearTimeout(u),e._ws=s,r(s)},s.onerror=function(r){s.close(),e.bReady=!1,u&&clearTimeout(u),o.fireEvent("error"),a(r)},s.onmessage=function(r){Lr(e,Vr,Jr).call(e,e,r.data)},s.onclose=function(r){e.bReady=!1,u&&clearTimeout(u),o.fireEvent("close"),a(r)}}catch(h){throw h instanceof Fe||h&&h.code&&h.message?h:new Fe(h.message)}}))}function Jr(e,r){return Yr.apply(this,arguments)}function Yr(){return Yr=ne(de.mark((function e(t,n){var i,o,a,s,u,c,l,d,f,h;return de.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t,e.prev=1,s={client:i,userData:undefined},"object"!==J(n)){e.next=17;break}if(!(i._blob_callbacks.length>0)){e.next=17;break}if(!i._processing_blob){e.next=9;break}return e.next=8,new r.Promise((function(e){Kr._preBlobResolv=e,Kr._waitForPreBlob(i)}));case 8:Kr._preBlobResolv=null;case 9:return i._processing_blob=!0,u=i._blob_callbacks.shift(),e.next=13,u(n);case 13:return e.sent,i._processing_blob=!1,e.abrupt("return");case 17:if(!(i.bReady&&r.isString(n)&&(n.indexOf("Function not found")>0||n.indexOf("Version not found")>0))){e.next=19;break}return e.abrupt("return");case 19:if(i._cbToGetTaskId){e.next=21;break}return e.abrupt("return");case 21:return e.next=23,i._cbToGetTaskId(n,Me.ONMESSAGE_PROCESS_DATA,i._requestTaskId,s);case 23:return c=e.sent,l=!1,e.next=27,i._cbToGetTaskId(c,Me.ONMESSAGE_GET_TASKID,i._requestTaskId,s);case 27:if(a=e.sent){e.next=36;break}if(!c.Detail||!c.Domain){e.next=32;break}return i._lic_callback&&i._lic_callback(c),e.abrupt("return");case 32:return e.next=34,i._cbToGetTaskId(c,Me.ONMESSAGE_GET_EVENT_TASKID,i._requestTaskId,s);case 34:(a=e.sent)&&(l=!0);case 36:if(o=i._tasks[a]){e.next=46;break}if(!l){e.next=42;break}o={},e.next=44;break;case 42:return""!=a&&Mr.log("invalid task id: "+a),e.abrupt("return");case 44:e.next=48;break;case 46:if(!o.timedout){e.next=48;break}return e.abrupt("return");case 48:return e.next=50,i._cbToGetTaskId(n,Me.HANDLE_RAW_MESSAGE,i._requestTaskId,o.ctx);case 50:if((d=e.sent)!==undefined){e.next=55;break}return e.next=54,i._cbToGetTaskId(c,Me.HANDLE_PROCESSED_MESSAGE,i._requestTaskId,o.ctx);case 54:d=e.sent;case 55:d&&!l&&(o.tmid&&clearTimeout(o.tmid),delete i._tasks[a],o.resolver&&o.resolver.resolve(d)),e.next=64;break;case 58:e.prev=58,e.t0=e["catch"](1),Mr.debug("failed to handle message."),e.t0 instanceof Error?Mr.error(e.t0):Mr.error(r.stringify(e.t0)),delete i._tasks[a],null===(f=o)||void 0===f||null===(h=f.resolver)||void 0===h||h.reject(e.t0.message);case 64:case"end":return e.stop()}}),e,null,[[1,58]])}))),Yr.apply(this,arguments)}function Zr(e,r,t){return Qr.apply(this,arguments)}function Qr(){return Qr=ne(de.mark((function e(r,t,n){var i,o;return de.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next=e.t0===Me.GET_TASKID?3:e.t0===Me.HANDLE_RAW_MESSAGE?7:9;break;case 3:return(o=Wr(r)).cmdId=null!==(i=o.cmdId)&&void 0!==i?i:(n=void 0,a=void 0,a=[Ar(8),"-",Ar(4),"-",Ar(4),"-",Ar(4),"-",Ar(8)],n&&a.unshift(n),a.join("")),Promise.resolve(["cmdId"]),e.abrupt("break",9);case 7:return Promise.resolve(r),e.abrupt("break",9);case 9:case"end":return e.stop()}var n,a}),e)}))),Qr.apply(this,arguments)}function $r(e,r,t,n){return et.apply(this,arguments)}function et(){return et=ne(de.mark((function e(t,n,i,o){var a,s,u,c;return de.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.connected&&!this.disposed){e.next=2;break}return e.abrupt("return");case 2:if(!(u=this)._connectPromise){e.next=7;break}return e.next=6,u._connectPromise;case 6:return e.abrupt("return");case 7:return n=null!==(a=n)&&void 0!==a?a:this._defaultRetries,i=null!==(s=i)&&void 0!==s?s:100,c=Lr(u,Ur,qr).call(u,u.serverInfo),Mr.debug("WebSocket URL: "+c+", try to create websocket "+n+"/"+i),u._connectPromise=new r.Promise((function(e,r){var t=function(t){Lr(u,Br,Xr).call(u,u,c,u.serverInfo.protocol,o).then((function(r){e(r)}))["catch"]((function(e){Mr.debug("create websocket failed: "+e.message),t<n?a(t):r(e)}))};function a(e,r,n){setTimeout((function(){t(++e)}),i)}t(0)})),e.prev=12,e.next=15,u._connectPromise;case 15:e.next=20;break;case 17:throw e.prev=17,e.t0=e["catch"](12),e.t0;case 20:return e.prev=20,u._connectPromise=null,e.finish(20);case 23:case"end":return e.stop()}}),e,this,[[12,17,20,23]])}))),et.apply(this,arguments)}function rt(e,r,t,n){return tt.apply(this,arguments)}function tt(){return tt=ne(de.mark((function e(r,t,n,i){var o,a,s,u;return de.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this,a=n.eventTaskId,s=n.lastEventTaskId,a!==undefined){e.next=7;break}return e.next=6,t(r,Me.GET_EVENT_TASKID,o._requestTaskId,n);case 6:a=e.sent;case 7:a&&(o._tasks[a]?n&&n.userData&&n.userData.command&&((u=o._tasks[a]).ctx=n,s&&((u=o._tasks[s]).ctx=n)):(u={id:i.id,resolver:null,ctx:n,timedout:!1},o._tasks[a]=u,s&&(o._tasks[s]=u)));case 8:case"end":return e.stop()}}),e,this)}))),tt.apply(this,arguments)}function nt(e,r,t,n,i,o,a){return it.apply(this,arguments)}function it(){return it=ne(de.mark((function e(t,n,i,o,a,s,u){var c,l,d,f;return de.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=this,e.prev=1,i.client=c,e.next=5,Lr(c,jr,$r).call(c,a,o,s,u);case 5:if("0"!=(l=i.taskId)){e.next=12;break}return c.disposed||c._ws.send(t),t=null,e.abrupt("return");case 12:if(l!==undefined){e.next=16;break}return e.next=15,n(t,Me.GET_TASKID,null,i);case 15:l=e.sent;case 16:return l===undefined&&Mr.debug("websocket send: task id is invalid."),(d={}).promise=new r.Promise((function(e,r){d.resolve=e,d.reject=r})),f={id:l,resolver:d,ctx:i,timedout:!1},c._tasks[l]=f,c._requestTaskId=l,e.next=24,Lr(c,Hr,rt).call(c,t,n,i,f);case 24:return c._cbToGetTaskId=n,u&&(f.tmid=setTimeout((function(){Mr.debug("ws request time out."),f.timedout=!0,f.resolver.reject("request timed out.")}),u)),c.disposed||c._ws.send(t),Mr.debug("end to send task "+l),t=null,e.abrupt("return",d.promise);case 32:if(e.prev=32,e.t0=e["catch"](1),l&&delete c._tasks[l],!(e.t0 instanceof Fe||e.t0&&e.t0.code&&e.t0.message)){e.next=39;break}throw e.t0;case 39:throw new Fe(e.t0.message);case 40:return e.prev=40,t=null,e.finish(40);case 43:case"end":return e.stop()}}),e,this,[[1,32,40,43]])}))),it.apply(this,arguments)}function ot(e,r){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,r){if(!e)return;if("string"==typeof e)return at(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return at(e,r)}(e))||r&&e&&"number"==typeof e.length){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==t["return"]||t["return"]()}finally{if(s)throw o}}}}function at(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function st(e,r){!function(e,r){if(r.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,r),r.add(e)}function ut(e,r,t){if(!r.has(e));return t}var ct=new WeakSet,lt=new WeakSet,dt=function(){function e(){X(this,e),st(this,lt),st(this,ct),_e(this,"_maxWebSocketCon",10),_e(this,"_wsClients",[])}return Q(e,[{key:"removeTerminatedWSClient",value:function(){this._wsClients=this._wsClients.filter((function(e){return!e.disposed}))}},{key:"getClient",value:function(e,r){return e.useWS?ut(this,lt,ht).call(this,e,r):new Dr(e)}},{key:"terminate",value:function(){var e=this._wsClients.slice();this._wsClients=[],e.forEach((function(e){e.dispose()}))}}],[{key:"Instance",get:function(){return this._gClientPool||(this._gClientPool=new e),this._gClientPool}}]),e}();function ft(e){this.removeTerminatedWSClient();var r,t,n,i=ot(this._wsClients);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(t=o.serverInfo,n=e,(null==t?void 0:t.port)==(null==n?void 0:n.port)&&(null==t?void 0:t.protocol)==(null==n?void 0:n.protocol)&&(null==t?void 0:t.server)==(null==n?void 0:n.server)&&(null==t?void 0:t.ssl)==(null==n?void 0:n.ssl)&&(null==t?void 0:t.useWS)==(null==n?void 0:n.useWS)&&!o.disposed)return o.addRef(),o}}catch(a){i.e(a)}finally{i.f()}return null}function ht(e,r){var t;return r||(t=ut(this,ct,ft).call(this,e)),t||(this._wsClients.length<this._maxWebSocketCon?((t=new Kr(e)).addEvent("disposed","1",(function(){dt.Instance.removeTerminatedWSClient()})),this._wsClients.push(t),t):null)}_e(dt,"_gClientPool",null);var gt=function(){function t(){X(this,t)}return Q(t,null,[{key:"getHttpClientForDcp",value:function(n,i){var o,a=e.dcp,s=r.detect.ssl;if(i||!e.navInfoSync.bSSL?(o=a.Port,s=!1):(o=a.SSLPort,s=!0),r.isString(n)){var u=new me;return r.startsWith(n,"https://")?(u.ssl=!0,u.server=n.substring(8)):r.startsWith(n,"http://")?(u.ssl=!1,u.server=n.substring(7)):(u.ssl=r.detect.ssl,u.server=n),dt.Instance.getClient(u)}return t.getHttpClient(null,o,s)}},{key:"getHttpClient",value:function(e,r,t){var n=t?"https":"http",i=new me(e||f(),r,t,!1,n);return dt.Instance.getClient(i)}},{key:"getWsClient",value:function(r,t,n,i){var o=new me(r||f(),t,n,!0,e.dcp.wsProtocol);return dt.Instance.getClient(o,i)}}]),t}();r.ClientPool=dt;var pt,mt,_t=e.navInfoSync.bSSL?3e3:1e3,vt=parseInt(n),yt=parseInt(i),It=parseInt("0"),St=o,Tt=o,bt=20220801,Et=function(){if(e.dcp){var t=e.dcp.dcpJSVer;if(r.isNumber(t))return t>=bt}return!1};if(Et())Et=pt,bt=pt;else{var Ct,wt={dcpStatus:0,ddmPort:0,dwtPort:0,bConnected:!1,connectedResult:"",MaxManagerModuleConnectCount:1,EnumDCP_DetectStatus:{Init:0,Connected:1,CheckingManagerVer:15,CheckingServiceVer:16,NotInstalled:17,CheckedService:5,VerifyingZip:6,VerifiedZip:7,UpdatingService:8,UpdateSucceed:9,UpdateFailed:10,UpdateSkipped:11}};e.dcp=Ct={SSLPort:18626,Port:18625,bEnhancedMode:!1,dcpJSVer:bt,oldDWASMVerStr:"dwasm_13000404",oldDWASMVer:[13,0,0,"0404"],wsProtocol:"dwt_command",managerVersion:[vt,yt,It,St],managerVersionMac:[vt,yt,It,St],managerVersionLinux:[vt,yt,It,St],serviceVersion:[1,7,3,Tt],serviceVersionMac:[1,7,3,Tt],serviceVersionLinux:[1,7,3,Tt],detect:wt,strSID:"",b64bit:!0,getManagerVersion:function(){var r=e.navInfoSync;if(r.bWin);else{if(r.bMac)return Ct.managerVersionMac;if(r.bLinux)return Ct.managerVersionLinux}return Ct.managerVersion},getServiceVersion:function(){var r=e.navInfoSync;if(r.bWin);else{if(r.bMac)return Ct.serviceVersionMac;if(r.bLinux)return Ct.serviceVersionLinux}return Ct.serviceVersion},_checkService:function(e,r){wt.dcpStatus=wt.EnumDCP_DetectStatus.CheckingServiceVer,kt(null,"DSVersion").then(e,r)},_checkUpdateFile:function(e,r){kt(null,"CheckUpdateFile").then(e,r)},_updateService:function(e,r){kt(null,"UpdateService").then(e,r)},loadZip:(mt=ne(de.mark((function t(n,i){var o,a,s,u;return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=!1,100===(o=i)&&(o=0,a=!0),e.DWT.IfUpdateService?[Ct._getModuleName_Ver(),"/LoadZipFromBytes?type=",o,"&dsver=",Ct.getServiceVersion().join(""),"&ts=",r.now()].join(""):["dcp/",Ct.oldDWASMVerStr,"/LoadZipFromBytes?type=0","&dsver=",Ct.getServiceVersion().join(""),"&ts=",r.now()].join(""),s=gt.getHttpClientForDcp(),t.next=6,s.request(n,void 0,{},3e4);case 6:return u=t.sent,a&&r.isString(u)&&(u=u.replace('"result" : [ 0,','"result" : [ 100,')),t.abrupt("return",u);case 9:case"end":return t.stop()}}),t)}))),function(e,r){return mt.apply(this,arguments)}),_getModuleName_Ver:function(){return Ct.__getModuleName()+Ct._getModuleVer()},__getModuleName:function(){return"dcp/dwasm2_"},_getModuleVer:function(){return Ct.getManagerVersion().join("")},_compareVersion:function(e,t){return!r.isLocalIP(f())||(r.isArray(e)&&4==e.length&&r.isArray(t)&&t.length>=4?e[0]>t[0]||e[0]==t[0]&&e[1]>t[1]||e[0]==t[0]&&e[1]==t[1]&&e[2]>t[2]||e[0]==t[0]&&e[1]==t[1]&&e[2]==t[2]&&parseInt(e[3])>=parseInt(t[3]):!!(r.isArray(e)&&1==e.length&&r.isArray(t)&&t.length>=1)&&parseInt(e[0])>=parseInt(t[0]))},_getDSUpdateZipUrl:function(){var t,n,i=e.navInfoSync,o="";return t="Win",i.bMac?t="Mac":i.bLinux&&(t="Linux"),n=i.bFileSystem?"":"?t="+r.now(),i.bWin&&Ct.b64bit&&(o="_x64"),[e.DWT.ResourcesPath,"/dist/serviceupdate/",t,"DSUpdate_",Ct.getManagerVersion().join("."),o,".zip",n].join("")},getPorts:function(e,t){var n="GetPorts",i="dwasm2_"+Ct._getModuleVer();return Dt(e,n,{id:r.now(),method:n,version:i,parameter:[t]},_t)},_checkUpdateZip:function(t,n,i,o,a){var s,u,c,l,d,f,h,g=3;s=function(e,r,t){var n=-1;if(t&&(n=t.status),0==n)return setTimeout((function(){Ct._checkService(f,h)}),5e3),!0;var i=Ct._getDSUpdateZipUrl();return Ir(i,{mode:"cors",dataType:"arraybuffer"}).then(l,u),!0},u=function(e){n&&n();var r="The update package can't be downloaded. The error code is "+e.httpCode+".";return i&&i(!0,r),Ct._sendStatusEvent(!0,r),setTimeout(o,0),!0},c=function(e){if(!(r.isArray(e)&&e.length>1))return!1;if(1==e[1])wt.dcpStatus=wt.EnumDCP_DetectStatus.VerifiedZip,Ct._sendStatusEvent(),wt.dcpStatus=wt.EnumDCP_DetectStatus.UpdatingService,Ct._sendStatusEvent(),setTimeout((function(){Ct._checkService(f,h)}),5e3);else{var t=0;if("exception"in e&&(t=e.exception),-2373==t)return Ct._funUpdateFailed(n,i,e,200),setTimeout(o,0),!0;setTimeout(s,0)}return!0},l=function(t){e.dcp.loadZip(t,1).then((function(e){var t,a;try{r.isString(e)&&"result"in(a=r.parse(e.replace(/\0/g,"")))&&(t=a.result)}catch(s){}r.isArray(t)&&t.length>2&&1==t[2]?setTimeout((function(){Ct._checkService(f,h)}),5e3):(Ct._funUpdateFailed(n,i,e,200),setTimeout(o,0))}),d),t=null},d=function(e,r,t){var a=-1;return t&&(a=t.status),0==a?setTimeout((function(){Ct._checkService(f,h)}),5e3):(Ct._funUpdateFailed(n,i,e,t.status),setTimeout(o,0)),!0},f=function(e){if(!(r.isArray(e)&&e.length>0&&e[0]))return!1;var t=e[0].split(",");return!!Ct._compareVersion(t,Ct.getServiceVersion())&&(wt.bConnected=!0,n&&n(),wt.dcpStatus=wt.EnumDCP_DetectStatus.CheckedService,Ct._sendStatusEvent(!1,e[0]),wt.dcpStatus=wt.EnumDCP_DetectStatus.UpdateSucceed,Ct._sendStatusEvent(),setTimeout(o,0),!0)},h=function(e,r){var t=1e3;return g<3&&(t=500),--g<0?(Ct._funShowUpgradeDialogWhenUpdateFailed(n,i),setTimeout(o,0),!0):(setTimeout((function(){Ct._checkService(f,h)}),t),!0)},t&&t(),wt.dcpStatus=wt.EnumDCP_DetectStatus.VerifyingZip,Ct._sendStatusEvent(),Ct._checkUpdateFile(c,s)},_getStatusString:function(e,r){var t,n,i="";return e==wt.EnumDCP_DetectStatus.Init?"Getting manager version":e==wt.EnumDCP_DetectStatus.Connected?(r&&(i=r),"Getting manager version succeeded and the version is "+i):e==wt.EnumDCP_DetectStatus.CheckingManagerVer?"Getting manager version":e==wt.EnumDCP_DetectStatus.CheckingServiceVer?"Getting service version":e==wt.EnumDCP_DetectStatus.NotInstalled?"Dynamsoft Service Not Installed":e==wt.EnumDCP_DetectStatus.UpdateSkipped?"Update skipped":e==wt.EnumDCP_DetectStatus.CheckedService?(r&&(i=r),"Getting service version succeeded and the version is "+i):e==wt.EnumDCP_DetectStatus.VerifyingZip?"Verifying the update package":e==wt.EnumDCP_DetectStatus.VerifiedZip?"Update package verified":e==wt.EnumDCP_DetectStatus.UpdatingService?"Updating the service":e==wt.EnumDCP_DetectStatus.UpdateSucceed?"Update succeeded":e==wt.EnumDCP_DetectStatus.UpdateFailed?(n=".",r&&r.length>0?("."==r.slice(r.length-1)&&(n=""),t=" with the error: "+r):t="","The update failed"+t+n):""},_sendStatusEvent:function(e,t){var n=!!e,i=window;r.isFunction(i.OnGetServiceUpdateStatus)&&i.OnGetServiceUpdateStatus(n,wt.dcpStatus,Ct._getStatusString(wt.dcpStatus,t))},_getErr:function(e){var t,n="";try{r.isString(e)?(t=e.replace(/\0/g,""),t=r.parse(t)):e&&(t=e),"description"in t&&(n=t.description)}catch(i){}return n},_funShowUpgradeDialogWhenUpdateFailed:function(e,r){return wt.bConnected=!0,wt.dcpStatus=wt.EnumDCP_DetectStatus.UpdateFailed,e&&e(),r&&r(),Ct._sendStatusEvent(!0),!0},_funUpdateFailed:function(e,r,t,n){var i,o;return wt.bConnected=!0,wt.dcpStatus=wt.EnumDCP_DetectStatus.UpdateFailed,e&&e(),200==n?(i="The update failed.",o=Ct._getStatusString(wt.dcpStatus,Ct._getErr(t))):o=i="The update failed. The error code is "+n,r&&r(!0,i),Ct._sendStatusEvent(!0,o),!0},getDSPath:function(r,t){var n=e.DWT.ResourcesPath,i=t;if(e.Lib.isString(n)&&n.length>0?"/"!=n[n.length-1]&&(n+="/"):n="Resources/",!i){var o=e.navInfoSync;i=o.bWin?".msi":o.bMac?".pkg":e.navInfo.bArm64?"-arm64.deb":e.navInfo.bMips64?"-mips64el.deb":e.navInfo.bAndroid?".apk":o.bLinux||o.bChromeOS||o.bHarmonyOS?".deb":".msi"}return[n,"dist/DynamsoftServiceSetup",i].join("")},getLinuxHTML5DebPath:function(){return e.dcp.getDSPath(!1,".deb")},getLinuxHTML5RpmPath:function(){return e.dcp.getDSPath(!1,".rpm")},getBinaryFileInfo:function(t,n){var i="GetBinaryFileInfo",o={id:(new Date).getTime().toString(),method:i,version:"dwasm2_"+Ct._getModuleVer(),parameter:[]},a=r.stringify(o),s=function(e,i,o){var a;e&&(a=r.parse(e)),a?t(a):n(e,i,o)};if(e.DWT.ConnectWithSocket&&e.navInfoSync.bHTML5Edition){var u=pe.getWsUrl(e.DWT.Host,e.navInfoSync.bSSL?Ct.SSLPort:Ct.Port);return pe.postStringDataByWSUrl(u,a).then(s,n),!0}var c=[Ct._getModuleName_Ver(),"/",i,"?type=1&dsver=",Ct.getServiceVersion().join(""),"&ts=",r.now()].join("");gt.getHttpClientForDcp().request(a,c,{},500).then(s,n)}},Et=pt,bt=pt}function kt(t,n,i,o){var a;return a={id:(new Date).getTime().toString(),method:n,version:"dwasm2_"+e.dcp._getModuleVer(),parameter:[]},"VersionInfo"==n&&(a.version="dwasm2_"+e.Lib.product.getDWTVersionInfoVer()),r.License.isLongKey(i)&&(a.productKey=i),Dt(t,n,a,_t,o)}function Dt(e,r,t,n,i){return xt.apply(this,arguments)}function xt(){return xt=ne(de.mark((function t(n,i,o,a,s){var u,c,l,d,f,h,g,p,m,_;return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u=r.stringify(o),(c=e.dcp).detect.bConnected=!1,l=[c._getModuleName_Ver(),"/",i,"?type=1&dsver=",c.getServiceVersion().join(""),"&ts=",r.now()].join(""),f=e.navInfoSync.bSSL,h=f?c.SSLPort:c.Port,d=gt.getHttpClient(n,h,f),g={},s&&!e.navInfoSync.bSSL&&(g.redirect="manual"),t.prev=9,t.next=12,d.request(u,l,g,a);case 12:p=t.sent,t.next=22;break;case 15:if(t.prev=15,t.t0=t["catch"](9),!s||e.navInfoSync.bSSL){t.next=21;break}if((t.t0&&t.t0.code)!=e.DWT.EnumDWT_Error.HTTPRedirected){t.next=21;break}throw r.Errors.HTSTError();case 21:throw t.t0;case 22:if(p&&(m=r.parse(p)),!(m&&"exception"in m&&"description"in m)){t.next=25;break}throw{code:m.exception,message:m.description};case 25:if(!m||!("result"in m)){t.next=31;break}if(!c.detect.bConnected){t.next=28;break}return t.abrupt("return",m.result);case 28:return c.detect.bConnected=!0,c.detect.dcpStatus=c.detect.EnumDCP_DetectStatus.Connected,t.abrupt("return",m.result);case 31:throw _={},r.Errors.DynamsoftServiceResponseDataTypeError(_),We(_);case 34:case"end":return t.stop()}}),t,null,[[9,15]])}))),xt.apply(this,arguments)}var Pt=function(){function e(){X(this,e),_e(this,"_exec",{})}return Q(e,[{key:"fire",value:function(e,t){var n,i=this;e=e.toLowerCase(),n=Array.prototype.slice.call(arguments,1),r.each(i._exec[e]||[],(function(e){var t=e.f,o=e.c||i;try{t.apply(o,n)}catch(a){r.error(a)}}))}},{key:"on",value:function(e,r,t){e=e.toLowerCase(),this._exec[e]=this._exec[e]||[],this._exec[e].push({f:r,c:t})}},{key:"off",value:function(e,r,t){if(e&&r){e=e.toLowerCase();for(var n=this._exec[e]||[],i=n.length-1;i>=0;i--)n[i]===r&&n.splice(i,1)}else this._exec={}}}]),e}();function Ft(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=Te(e);if(r){var i=Te(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return Se(this,t)}}function Wt(e,r){!function(e,r){if(r.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,r),r.add(e)}function At(e,r,t){if(!r.has(e));return t}var Rt="[bio]: ",Ot=window,Lt=Ot&&Ot.FormData,Nt=new WeakSet,Mt=new WeakSet,Ut=new WeakSet,Bt=new WeakSet,Vt=new WeakSet,Gt=new WeakSet,jt=new WeakSet,Ht=new WeakSet,zt=function(e){Ie(n,e);var t=Ft(n);function n(e){var i;return X(this,n),Wt(ve(i=t.call(this)),Ht),Wt(ve(i),jt),Wt(ve(i),Gt),Wt(ve(i),Vt),Wt(ve(i),Bt),Wt(ve(i),Ut),Wt(ve(i),Mt),Wt(ve(i),Nt),_e(ve(i),"_attrs",{}),r.mix(i._attrs,{action:"",data:{},bChunkedSendData:Ve,ajaxConfig:{value:{},type:"post",processData:Be,cache:Be,dataType:"text",async:Ve,contentType:Be,retry:0,headers:{"X-Requested-With":Be}},ajax:"",formData:"",CORS:Be,bOnlyResponseEmptyIsOK:Ve}),r.mix(i._attrs,e),At(ve(i),Nt,Kt).call(ve(i)),i}return Q(n,[{key:"get",value:function(e){return e in this._attrs?this._attrs[e]:""}},{key:"set",value:function(e,r){e in this._attrs&&(this._attrs[e]=r)}},{key:"uploadFilesToServer",value:function(e){return At(this,Mt,qt).call(this,e)}},{key:"uploadToServer",value:function(e){var t=this,i=t.get("ajaxConfig");At(t,Ut,Xt).call(t),e&&e.size>0&&(At(t,Bt,Jt).call(t,e),r.isString(e.name)&&""!=e.name?t.name=e.name:t.name=e.fileName,e=null),r.mix(i,{data:t.get(n.PROP.formData),url:t.get(n.PROP.action),beforeSend:function(e,r,i){e.upload.addEventListener("progress",(function(e){t.fire(n.event.PROGRESS,{loaded:e.loaded,total:e.total,name:t.name})}),!1)}}),r.mix(i,{method:"POST",async:!0,onSuccess:function(e){Qt(t.get(n.PROP.data)),Qt(t.get(n.PROP.formData)),t.get(n.PROP.ajax).dispose(),t.set(n.PROP.data,null),t.set(n.PROP.formData,null),t.set(n.PROP.ajax,null);var r=At(t,Ht,Zt).call(t,e);t.fire(n.event.SUCCESS,r)},onError:function(e,i,o){var a,s;Qt(t.get(n.PROP.data)),Qt(t.get(n.PROP.formData)),t.get(n.PROP.ajax).dispose(),t.set(n.PROP.data,null),t.set(n.PROP.formData,null),t.set(n.PROP.ajax,null),e&&r.isArray(e)&&e.length>2?(a=e[1],s=e[2]):(a=i,s=o),At(t,Vt,Yt).call(t,s,a)}});var o=fr(i);return t.set(n.PROP.ajax,o),!0}},{key:"abort",value:function(){var e=this,t=e.get("ajax");return r.isObject(t)?(t.abort(),e.set("ajax",!1),e):(r.log(Rt+"abort(), the value of io invalid!"),e)}},{key:"setRequestHeader",value:function(e,r){var t=this.get("ajaxConfig");return t.headers[e]=r,this.set("ajaxConfig",t),t=null,r}}]),n}(Pt);function Kt(){this.get("CORS");var e=this.get("ajaxConfig");return r.mix(e,{xhrFields:{withCredentials:!1}}),e}function qt(e){var t=this,n=t.get(zt.PROP.ajaxConfig),i=[];At(t,Ut,Xt).call(t),r.each(e,(function(e){e&&e.size>0?(At(t,Bt,Jt).call(t,e),r.isString(e.name)&&""!=e.name?i.push(e.name):i.push(e.fileName)):i.push("")})),r.mix(n,{data:t.get(zt.PROP.formData),url:t.get(zt.PROP.action),beforeSend:function(e,r,n){e.upload.addEventListener("progress",(function(e){t.fire(zt.event.PROGRESS,{loaded:e.loaded,total:e.total,name:""})}),!1)}}),r.mix(n,{method:"POST",async:!0,onSuccess:function(e){var n="";i=[],e&&(e&&r.isArray(e)&&e.length>1?n=e[0]:r.isString(e)&&(n=e)),n=At(t,Ht,Zt).call(t,n),t.fire(zt.event.SUCCESS,n)},onError:function(e,n,o){var a,s;i=[],e&&r.isArray(e)&&e.length>2?(a=e[1],s=e[2]):(a=n,s=o),At(t,Vt,Yt).call(t,s,a)}}),t.name="";var o=fr(n);return t.set(zt.PROP.formData,null),t.set(zt.PROP.ajax,o),!0}function Xt(){var e,t=this,n=t.get("data");if(Lt)if(n instanceof Lt)t.set(zt.PROP.formData,n);else{e=new Lt;try{r.each(n,(function(r,t){e.append(t,r)})),t.set(zt.PROP.formData,e)}catch(i){r.log(Rt+"something error when reset FormData.")}}else r.log(Rt+"the browser does not support ajax.")}function Jt(e){if(!r.isObject(e))return r.log(Rt+"_addFileData(), file parameter invalid!"),!1;var t=this.get(zt.PROP.formData),n=e.name,i=e.remoteFilename;return i||(i="RemoteFile"),t.append(i,e,n),this.set(zt.PROP.formData,t),e=null,t}function Yt(e,r){var t=zt.status.ERROR,n={status:t,msg:r,response:!1,name:this.name};e&&(n.httpStatus=e.status,n.response=e.responseText),this.fire(t,n)}function Zt(e){var t,n,i,o=!1,a=this.name,s=zt.status.SUCCESS,u=zt.event.ERROR;if(r.log("Response from server: "+e),!this.get("bOnlyResponseEmptyIsOK"))return{status:s,msg:!1,json:!1,response:e,name:a};if(r.isUndefined(e)||""===e)t={status:s,msg:!1,json:!1,response:"",name:a};else if(r.isString(e)){try{for(n=0;n<e.length&&!(n>10);n++){if("{"==(i=e[n])){o=!0;break}if(" "!=i&&"\r"!=i&&"\n"!=i&&"\t"!=i)break}if(o){var c=r.parse(e);t=1==c.status?{status:s,msg:!1,json:c,response:e,name:a}:{status:u,msg:!1,json:c,response:e,name:a}}}catch(d){o=!1,r.log(d)}if(!o){var l=String(e);t=""==(l=l.replace(/( |\t|\r|\n)/g,""))?{status:s,msg:!1,json:!1,response:e,name:a}:{status:u,msg:!1,json:!1,response:e,name:a}}}else t={status:s,msg:!1,json:!1,response:"",name:a};return t}function Qt(e){e&&e instanceof Lt&&e.forEach&&e.forEach((function(r,t){t&&e["delete"](t)}))}function $t(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=Te(e);if(r){var i=Te(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return Se(this,t)}}function en(e,r){!function(e,r){if(r.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,r),r.add(e)}function rn(e,r,t){if(!r.has(e));return t}_e(zt,"event",{SUCCESS:"success",ERROR:"error",PROGRESS:"progress"}),_e(zt,"status",{SUCCESS:"success",ERROR:"error"}),_e(zt,"PROP",{action:"action",data:"data",bChunkedSendData:"bChunkedSendData",ajaxConfig:"ajaxConfig",ajax:"ajax",formData:"formData",CORS:"CORS",bOnlyResponseEmptyIsOK:"bOnlyResponseEmptyIsOK"});var tn=new WeakSet,nn=new WeakSet,on=new WeakSet,an=new WeakSet,sn=function(e){Ie(n,e);var t=$t(n);function n(e){var i;return X(this,n),en(ve(i=t.call(this)),an),en(ve(i),on),en(ve(i),nn),en(ve(i),tn),i._attrs={action:"",retry:0,timeout:0,CORS:Be,async:Ve,dataType:"text",fileStatus:"",data:{},bOnlyResponseEmptyIsOK:Ve},r.mix(i._attrs,e),rn(ve(i),nn,cn).call(ve(i)),i}return Q(n,[{key:"get",value:function(e){return e in this._attrs?this._attrs[e]:""}},{key:"set",value:function(e,r){e in this._attrs&&(this._attrs[e]=r)}},{key:"upload",value:function(e){var t;if(e){if(r.isArray(e))return t=this._uploadType.uploadFilesToServer(e),e=null,t;if(r.isObject(e)){var n=e;return n.size?(n.id||(n.id=r.guid("file-")),n.size&&(n.textSize=rn(this,tn,un).call(this,n.size))):n.size=0,t=this._uploadType.uploadToServer(n),n=null,e=null,t}}return t=this._uploadType.uploadToServer(e),e=null,t}},{key:"abort",value:function(e){return this._uploadType&&this._uploadType.abort(),!0}},{key:"setRequestHeader",value:function(e,r){this._uploadType.setRequestHeader(e,r)}}]),n}(Pt);function un(e){var r=-1;do{e/=1024,r++}while(e>99&&r<4);return Math.max(e,.1).toFixed(1)+["KB","MB","GB","TB"][r]}function cn(){var e=this,r={action:e.get(sn.PROP.action),data:e.get(sn.PROP.data),CORS:e.get(sn.PROP.CORS),bOnlyResponseEmptyIsOK:e.get(sn.PROP.bOnlyResponseEmptyIsOK)};this._uploadType=new zt(r);var t=this._uploadType.get(zt.PROP.ajaxConfig);return t&&(t.dataType=e.get(sn.PROP.dataType),t.async=e.get(sn.PROP.async),t.retry=e.get(sn.PROP.retry)),this._uploadType.on(zt.event.SUCCESS,rn(e,an,dn),e),this._uploadType.on(zt.event.ERROR,rn(e,an,dn),e),this._uploadType.on(zt.event.PROGRESS,rn(e,on,ln),e),this._uploadType}function ln(e){this.fire(sn.event.PROGRESS,e)}function dn(e){var t=this,n=e.status,i=e.msg,o=t.get("file");r.mix(e,{file:o}),"success"===n?t.fire(sn.event.SUCCESS,e):(!1===i||("abort"===i?r.mix(e,{canceled:!0}):"timeout"===i&&r.mix(e,{timeout:!0})),t.fire(sn.event.ERROR,e))}function fn(r){var t=Date.parse(r+"T00:00:00");if(""!=r&&!isNaN(t)&&e.DWT.CheckCertExpired)return(new Date).getTime()>=t-864e5*e.DWT.CertificateConfig.UpdateDaysBeforeExpired}_e(sn,"event",{SUCCESS:"success",ERROR:"error",PROGRESS:"progress"}),_e(sn,"PROP",{action:"action",retry:"retry",timeout:"timeout",CORS:"CORS",async:"async",dataType:"dataType",fileStatus:"fileStatus",data:"data",bOnlyResponseEmptyIsOK:"bOnlyResponseEmptyIsOK"}),e.DWT.__innerCheckCertDate=function(t){fn(t)&&(r.isFunction(e.OnCertExpired)&&e.OnCertExpired(t),setTimeout((function(){e.DWT.UpdateCert(e.DWT.CertificateConfig.URL,e.OnUpdateCertSuccess,e.OnUpdateCertFailure)}),5e3))},e.DWT.__innerUpdateCert=function(t,n,i,o){var a=e.dcp,s=[a._getModuleName_Ver(),"/LoadZipFromBytes?type=",2,"&dsver=",a.getServiceVersion().join(""),"&ts=",r.now()].join("");gt.getHttpClientForDcp(null,n).request(t,s,{},3e4).then(i,(function(e){r.isFunction(o)&&o(e)}))},e.DWT.__innerReboot=function(t,n){var i=[e.dcp._getModuleName_Ver(),"/admin?ts=",r.now()].join(""),o='{"id":"'+(new Date).getTime().toString()+'","method":"Reboot","parameter":[],"version":"dwasm2_'+e.dcp._getModuleVer()+'"}';gt.getHttpClientForDcp().request(o,i,{},3e4).then(t,n)},e.DWT.UpdateCert=function(t,n,i){r.isString(t)&&""!=t?Ir(t,{mode:"cors",dataType:"arraybuffer"}).then((function(t){e.DWT.__innerUpdateCert(t,!1,(function(){e.DWT.CheckCertExpired=!1,r.isFunction(n)&&n()}),(function(o){e.navInfoSync.bSSL?e.DWT.__innerUpdateCert(t,!0,n,i):r.isFunction(i)&&i(o)}))}),i):r.isFunction(i)&&i()};var hn={Errors:{FilePathSyntaxIncorrect:function(e){e._errorCode=-3123,e._errorString="The filename, directory name, or volume label syntax is incorrect."}},checkFilePath:function(e,t){return r.isString(t)&&0!=t.length?r.startsWith(t,"http://")||r.startsWith(t,"https://")||r.startsWith(t,"ftp://")?(r.File.Errors.FilePathSyntaxIncorrect(e),Be):Ve:(r.Errors.InvalidFile(e),Be)}};hn.checkFolder=hn.checkFilePath,r.File=hn,r.showProgress=function(){},r.closeProgress=function(){},String.prototype.startsWith||(String.prototype.startsWith=function(e){return 0==this.indexOf(e)});var gn=function(e){var r,t=e,n=t._license||"",i=JSON.parse(JSON.stringify(t._licenseServer)),o=t._sessionPassword,a=0;if(n.startsWith("t")||n.startsWith("f"))a=0;else if(0===n.length||n.startsWith("P")||n.startsWith("L")||n.startsWith("Y")||n.startsWith("A"))a=1;else{a=2;var s=n.indexOf(":");if(-1!=s&&(n=n.substring(s+1)),n.startsWith("DLS2")){var u;try{var c=n.substring(4);c=Dynamsoft.Lib.atob(c),u=JSON.parse(c)}catch(d){throw new Error("Format Error: The license string you specified is invalid, please check to make sure it is correct.")}if("number"==typeof(n=u.handshakeCode?u.handshakeCode:u.organizationID?u.organizationID:"")&&(n=JSON.stringify(n)),0===i.length){var l=[];u.mainServerURL&&(l[0]=u.mainServerURL),u.standbyServerURL&&(l[1]=u.standbyServerURL),i=function(e){if(null==e)e=[];else{e instanceof Array||(e=[e]);for(var r=0;r<e.length;++r){if(document&&document.createElement){var t=document.createElement("a");t.href=e[r],e[r]=t.href}e[r].lastIndexOf("/")!=e[r].length-1&&(e[r]+="/")}}return e}(l)}!o&&u.sessionPassword&&(o=u.sessionPassword),r=u.remark}("200001"===n||n.startsWith("200001-"))&&(i&&i.length||(n="")),n||(a=1)}return 1===a&&(n=""),{lt:a,l:n,ls:i,sp:o,rmk:r}},pn=parseInt(n),mn=parseInt(i),_n=parseInt("0"),vn="ddm/",yn="ddm_"+[pn,mn,_n,o].join("");function In(){return vn+yn}function Sn(e){return Tn.apply(this,arguments)}function Tn(){return(Tn=ne(de.mark((function e(t){var n,i,o,a;return de.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=_t,i=[In(),"/VersionInfo?","ts=",r.now()].join(""),o=['{"id":"',r.guid(),'","method":"VersionInfo"}'].join(""),a=gt.getHttpClientForDcp(t),e.abrupt("return",a.request(o,i,{dataType:"json"},n));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var bn=r.isString,En=r.isArray,Cn=r.each;function wn(e,r){if(bn(r))e.push('"'),e.push(r),e.push('"');else if(En(r)){var t=Ve;e.push("["),Cn(r,(function(r){t?t=Be:e.push(","),wn(e,r)})),e.push("]")}else r===undefined?e.push('""'):e.push(r)}function kn(){for(var e=[],r=arguments.length,t=new Array(r),n=0;n<r;n++)t[n]=arguments[n];if(t.length>0)if(1===t.length){var i=t[0];e.push("["),wn(e,i),e.push("]")}else if(2===t.length){var o=t[0],a=t[1];e.push("["),wn(e,o),e.push(","),wn(e,a),e.push("]")}else wn(e,Array.prototype.slice.call(t));return e.join("")}function Dn(e){return e instanceof ArrayBuffer||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Uint8ClampedArray||e instanceof Float32Array||e instanceof Float64Array}var xn={TWAINSCANNER:16,WIASCANNER:32,TWAINX64SCANNER:64,ICASCANNER:128,SANESCANNER:256,ESCLSCANNER:512,WIFIDIRECTSCANNER:1024,WIATWAINSCANNER:2048},Pn=xn.TWAINSCANNER|xn.WIASCANNER|xn.TWAINX64SCANNER|xn.ICASCANNER|xn.SANESCANNER|xn.ESCLSCANNER|xn.WIFIDIRECTSCANNER|xn.WIATWAINSCANNER,Fn=xn.TWAINSCANNER|xn.WIASCANNER|xn.TWAINX64SCANNER|xn.ICASCANNER|xn.SANESCANNER,Wn=xn.TWAINSCANNER|xn.WIATWAINSCANNER|xn.TWAINX64SCANNER|xn.ICASCANNER|xn.SANESCANNER,An=xn.ESCLSCANNER|xn.WIFIDIRECTSCANNER,Rn=xn.TWAINSCANNER|xn.WIATWAINSCANNER;e.DWT.EnumDWT_DeviceType={TWAINSCANNER:xn.TWAINSCANNER,WIASCANNER:xn.WIASCANNER,TWAINX64SCANNER:xn.TWAINX64SCANNER,ICASCANNER:xn.ICASCANNER,SANESCANNER:xn.SANESCANNER,ESCLSCANNER:xn.ESCLSCANNER,WIFIDIRECTSCANNER:xn.WIFIDIRECTSCANNER,WIATWAINSCANNER:xn.WIATWAINSCANNER};var On=1;function Ln(){return(++On).toString()}function Nn(){return["dwt_",r.getRandom()].join("")}var Mn=Q((function UL(){X(this,UL)}));function Un(e){var t=new Mn;return t.server=e.server,t.normal=!0,e.attrs&&(t.attrs=r.clone(e.attrs)),t}var Bn,Vn=function(){function t(n){X(this,t);var i=this;if(i._id=n.id,i._clientId=r.getRandom(),i._uuidForActiveUI=null,i._bReady=Be,i._destroy=Be,i._bMustUpgradeService=Be,i._wsClient=null,i._wsRetry=0,i._wsFailedTimes=0,i._strHttpContentTypeFieldValue="application/octet-stream",i._bConnecting=Be,i._bNoMask=Be,i._bNotShowMessage=Be,i.__serverPlatform=I.enumWindow,i.__productKey="",i.__licenseInfo=null,i._reconnectTimeSpan=e.Lib.product.RemoteReconnectTimeSpan,i._reconnectShortSpan=300,i._reconnectShortSpanTimes=5,i._bIfShowProgressBar=Ve,i.__IfShowCancelDialogWhenImageTransfer=Ve,n.dmService){var o,a,s,u,c,l,d=Un(n.dmService),h="/",g="";a=d.server;var p=new r.Uri(n.dmService.server),m=p.scheme;m&&(m=m.toLowerCase()),"https"==m?(o=!0,s=a.substring(8)):"http"==m?(o=!1,s=a.substring(7)):(s=a,a=(o=r.detect.ssl)?"https://"+a:"http://"+a),r.isLocalIP(p.hostname||p.scheme)?i._bRemoteMode=Be:i._bRemoteMode=Ve,r.endsWith(a,"/")&&(h="");var _=d.attrs;if(_){var v,y;u=(null===(v=_)||void 0===v?void 0:v.UUID)||"";var S=(null===(y=_.modules)||void 0===y?void 0:y.length)||0;if(""!=u&&S>0){var T;o?S>1&&S>1+(T=_.modules[1])+2&&(c=_.modules[1+T+2]):S>2&&(c=_.modules[2]),r.endsWith(c,"/")&&(h=""),g=[u,"/",c,"/"].join("")}}else _={UUID:"",service_type:B};l=[a,h,g].join(""),_.url=l,i._serverInfo=new me([s,h,g].join(""),null,o,!0,e.dcp.wsProtocol),i._httpUrl=l,i._dmService=d}else{var b,E=n.port,C=r.detect.ssl;b=n.host?n.host:f(),r.isLocalIP(b)?i._bRemoteMode=!1:i._bRemoteMode=!0,E||(E=C?e.dcp.SSLPort:e.dcp.Port),i._serverInfo=new me(b,E,C,!0,e.dcp.wsProtocol),i._httpUrl=function(e){var r=e.server;return r||(r=f()),e.ssl?["https://",r,":",e.port,"/"].join(""):["http://",r,":",e.port,"/"].join("")}(i._serverInfo),i._dmService={server:i._httpUrl,attrs:{url:i._httpUrl,UUID:"",service_type:B},normal:!0}}}var n,i;return Q(t,[{key:"_connnect",value:(i=ne(de.mark((function o(){var t;return de.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=this,n.abrupt("return",new r.Promise((function(r,n){var i,o;i=t._serverInfo.server,o=t._serverInfo.port,e.DWT.CheckConnectToTheService(i,o,r,n)})));case 2:case"end":return n.stop()}}),o,this)}))),function(){return i.apply(this,arguments)})},{key:"_waitForConnect",value:function(){var e=this;return e._wsRetry=0,e._bReady?r.Promise.resolve():new r.Promise((function(r,t){e._wsCheckResolve=r,e._wsCheckReject=t,Hn(e)}))}},{key:"_resetErr",value:function(){this._errorCode=0,this._errorString="";var r=e.DWT.licenseException;r.code=0,r.message=""}},{key:"_isValid",value:function(){return!this._destroy||(r.Errors.Destroyed(this),!1)}},{key:"_getWSCallback",value:function(){return zn}},{key:"_getWSContextData",value:function(){return""}},{key:"_additionalWSCallback",value:function(e,r,t,n){"GetLicenseInfo"==e?r._lic_callback=function(e){return t(e,Me.HANDLE_PROCESSED_MESSAGE,"0",n)}:"ConvertToBlob"==e&&r._blob_callbacks.push((function(e){return t(e,Me.HANDLE_RAW_MESSAGE,"0",n)}))}},{key:"_innerSendByWS",value:function(e,t,n,i,o){var a,s,u,c,l=this,d=this._getWSCallback();n&&n.cmdId?(a=n.cmdId,u=jn(l._clientId,a),c=jn(l._clientId,"")):(a=0,u=0,c=0);var f=Gn(l._clientId,e,t,a),h=l._wsClient;s={client:h,userData:{stwain:l,command:n},taskId:a,eventTaskId:u,lastEventTaskId:c};var g,p,m,_,v,y,I,S,T=0;if(!o){try{h.request(f,d,s)}catch(E){r.log(E)}return Be}if(m=new ArrayBuffer(12),i)if(i instanceof Blob)T=i.size;else if(i instanceof ArrayBuffer||i instanceof Uint8Array)T=i.byteLength;else if(i instanceof Array)T=i.length;else{var b=i;T=b.size||b.byteLength||b.length}for(p=(g=(I=new Blob([f])).size)+T,_=new DataView(m),y=0;y<8&&p;y++)_.setUint8(y,p%256),p=Math.floor(p/256);for(y=0;y<4&&g;y++)_.setUint8(8+y,g%256),g=Math.floor(g/256);return v=new Blob([m,I]),S=h.request(v,d,s),this._additionalWSCallback(e,h,d,s),T>0&&(S=h.request(i,d,s)),m=null,I=null,v=null,_=null,i=null,S}},{key:"_sendDataConnectWithSocket",value:function(e,t,n,i){var o=this;return new r.Promise((function(n,a){o._sendData(e,t,!0,(function(e){var t=!1;try{t=r.isString(e)?r.parse(e):e}catch(a){}if(o._resetErr(),t){if(t instanceof Blob||Dn(t))return void n(t);Ae(t)&&(o._errorCode=t.exception,o._errorString=t.description)}n(i?t:t.result)}),(function(e){a({code:o._errorCode,message:o._errorString})}))}))}},{key:"_sendDataByHttpAsync",value:function(n,i,o,a,s){var u,c=this;if(c._resetErr(),!c._isValid())return r.Promise.reject({code:c._errorCode,message:c._errorString});if(t.isServerInvalid(c))return s?r.Promise.reject({code:c._errorCode,message:c._errorString}):c._waitForConnect().then((function(){return c._sendDataByHttpAsync(n,i,o)}));if(e.DWT.ConnectWithSocket)return c._sendDataConnectWithSocket(n,i,o,a);u={method:"post",async:!0,body:Gn(c._clientId,n,i,0),dataType:null!=o?o:"text"};var l=null,d=r.guid();return c._bIfShowProgressBar&&(l=r.progressContext),yr(l,d)([c._httpUrl,"fa/",n].join(""),u).then((function(t){var n=!1;try{n=r.isString(t)?r.parse(t):t}catch(i){}if(n){if(n instanceof Blob||Dn(n))return n;if(!Ae(n))return c._resetErr(),a?n:n.result;c._errorCode=n.exception,c._errorString=n.description}else e.Lib.Errors.InvalidResultFormat(c);throw{code:c._errorCode,message:c._errorString}}),(function(e){if(c._errorCode=e.code,c._errorString=e.message,!r.page.bUnload)throw e}))}},{key:"_sendData",value:function(e,n,i,o,a){var s=this,u=null,c=null,l=!1,d=!0;if(!s._destroy){if("ActiveUI"==e?d=!1:l=t.isServerInvalid(s),l)return s._waitForConnect().then((function(){s._sendData(e,n,i,o,a)}))["catch"]((function(e){r.isFunction(a)&&a(e.code,e.message)}));var f;r.isFunction(o)&&(c=o),r.isFunction(a)&&(u=a),f="GetLicenseInfo"==e||"ConvertToBlob"==e||"Heartbeat"==e?0:Ln();var h=this._getWSContextData(),g={cmd:e,cmdId:f,sFun:c,fFun:u,contextData:h,rawData:null!=i&&i};return s._innerSendByWS(e,n,g,null,d)}}},{key:"_innerFunV2",value:(n=ne(de.mark((function a(r,t,n){var i,o;return de.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(i=this,!n){a.next=7;break}return a.next=4,i._sendDataConnectWithSocket(r,t,"json",!0);case 4:o=a.sent,a.next=10;break;case 7:return a.next=9,i._sendDataByHttpAsync(r,t,"json",!0);case 9:o=a.sent;case 10:if(!(o&&e.Lib.isArray(o.result)&&o.result.length>0)){a.next=12;break}return a.abrupt("return",o.result[0]);case 12:return a.abrupt("return",o);case 13:case"end":return a.stop()}}),a,this)}))),function(e,r,t){return n.apply(this,arguments)})},{key:"__OnRecieveMsg",value:function(t,n){var i=this;if(t.event)return i._handleEvent(t,n.contextData);if(e.DWT.ConnectWithSocket){var o=t,a=null==n?void 0:n.cmd;return"ActiveUI"==a||"VersionInfo"==a||"ConvertToBase64"==a||"ConvertToBlob"==a?n.sFun&&r.isArray(t.result)&&t.result.length>0?(n.sFun(t.result),!0):(n.fFun&&n.fFun(t.result),!1):(o=n.rawData?t:r.isArray(t.result)&&t.result.length>0?t.result[0]:t.result,n.sFun?n.sFun(o):n.fFun&&n.fFun(o),t=null,!0)}return Ae(t)?(i._errorCode=t.exception,i._errorString=t.description):(i._errorCode=0,i._errorString=""),n.sFun&&r.isArray(t.result)&&t.result.length>0?(n.sFun(t.result),!0):(n.fFun(t.result),!0)}},{key:"dispose",value:function(){this._bReady=Be,this._destroy=Ve}},{key:"isDestroy",get:function(){return this._destroy}},{key:"getServiceInfo",value:function(){return this._dmService}},{key:"_handleOnBitmapChangedEvent",value:function(e,t){var n="_OnBitmapChanged";if(r.isFunction(this[n]))try{this[n](e.result,e,t)}catch(i){Le(i)}return Be}},{key:"_handleEvent",value:function(e,t){var n=["_",e.event].join("");return r.isFunction(this[n])?(this[n](e.result,e),Ve):Be}}],[{key:"isServerInvalid",value:function(e){var t,n;if(t=!e._bReady||null===e._wsClient,n=e._bMustUpgradeService,t){var i,o,a,s;if(e._bRemoteMode)i=null!==(o=null===(a=e.getServiceInfo())||void 0===a||null===(s=a.attrs)||void 0===s?void 0:s.name)&&void 0!==o?o:"";r.Errors.DynamsoftServiceStopped(e,i)}else n?r.Errors.MustUpgradeService(e):e.isDestroy&&r.Errors.Destroyed(e);return t||n||-2208==e._errorCode||e.isDestroy}}]),t}();function Gn(e,t,n,i){var o=[];o.push("{"),o.push('"id":"'),o.push(e),o.push('"'),i&&(o.push(',"cmdId":"'),o.push(i),o.push('"')),o.push(',"method":"'),o.push(t),o.push('"'),o.push(',"module":"dwt","version":"');var a=[r.product.getDWTPrefix(),r.product.getServerVersionInfo()].join("");return o.push(a),o.push('"'),n!==undefined&&null!==n&&(o.push(',"parameter":'),o.push(n)),o.push("}"),o.join("")}function jn(e,r){return["evt",e,r].join("_")}function Hn(t){if(t._bReady)t._wsCheckResolve();else{if(e.DWT.bConnectCanceled)return r.asyncQueue.stop(),r.Errors.UserCanceled(t),void t._wsCheckReject({code:t._errorCode,message:t._errorString});if(t._wsRetry>10)return r.Errors.ThrowString_FailedToCreateDWTObject(t),void t._wsCheckReject({code:t._errorCode,message:t._errorString});t._wsRetry++,setTimeout((function(){Hn(t)}),1100)}}function zn(e,r,t,n){return Kn.apply(this,arguments)}function Kn(){return Kn=ne(de.mark((function t(n,i,o,a){var s,u,c,l,d,f,h;return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i!=Me.GET_TASKID){t.next=4;break}return t.abrupt("return",a.taskId);case 4:if(i!=Me.GET_EVENT_TASKID){t.next=8;break}return t.abrupt("return",a.eventTaskId);case 8:if(i!=Me.ONMESSAGE_PROCESS_DATA){t.next=17;break}if("object"!==J(n)){t.next=11;break}return t.abrupt("return",n);case 11:if(!((l=n).indexOf("Version not found")>=0||l.indexOf("Function not found")>=0)){t.next=14;break}return t.abrupt("return",{cmdId:null!=o?o:0});case 14:return t.abrupt("return",r.parse(n));case 17:if(i!=Me.ONMESSAGE_GET_TASKID){t.next=25;break}if(!n){t.next=22;break}if(!n.event){t.next=21;break}return t.abrupt("return",0);case 21:return t.abrupt("return",n.cmdId);case 22:return t.abrupt("return",n);case 25:if(i!=Me.ONMESSAGE_GET_EVENT_TASKID){t.next=31;break}if(!n||!n.event){t.next=28;break}return t.abrupt("return",jn(n.id,n.cmdId));case 28:return t.abrupt("return",0);case 31:if(i!=Me.HANDLE_RAW_MESSAGE){t.next=59;break}if(s=null==a?void 0:a.userData){t.next=35;break}return t.abrupt("return",!1);case 35:if(u=s.stwain,c=s.command){t.next=39;break}return t.abrupt("return",!1);case 39:if(u&&r.isFunction(u.__OnWSMessage)&&u.__OnWSMessage(n),"object"!==J(n)){t.next=44;break}if(!e.DWT.ConnectWithSocket){t.next=44;break}return"ConvertToBlob"!=c.cmd&&"GetImageByIndex"!=c.cmd||c.sFun(n),t.abrupt("return",!0);case 44:if(!((d=n.replace(/\0/g,"")).indexOf('"method" : "Heartbeat"')>=0)){t.next=47;break}return t.abrupt("return",!0);case 47:if(!(d.indexOf('"method" : "EnableBuffer"')>=0||d.indexOf('"method" : "GetBuffer"')>=0)){t.next=50;break}return e.DWT.lwsproc(d,c),t.abrupt("return",!0);case 50:if(!(d.indexOf("Exception:")>=0||0==d.indexOf("Error"))){t.next=57;break}return f=n,h=!1,r.log(f+"@"+c.cmd),c.fFun&&(h=c.fFun(f)),!h&&u&&r.isFunction(u.__OnPrintMsg)&&u.__OnPrintMsg(f),t.abrupt("return",!0);case 57:t.next=70;break;case 59:if(i!=Me.HANDLE_PROCESSED_MESSAGE){t.next=70;break}if(s=null==a?void 0:a.userData){t.next=63;break}return t.abrupt("return",!1);case 63:if(u=s.stwain){t.next=66;break}return t.abrupt("return",!1);case 66:if(c=s.command){t.next=69;break}return t.abrupt("return",!1);case 69:return t.abrupt("return",u.__OnRecieveMsg(n,c));case 70:case"end":return t.stop()}}),t)}))),Kn.apply(this,arguments)}function qn(t,n){r.detect.bMaskShow=!0,e.DWT.ScanDirectly||r.isFunction(e.DWT.OnWebTwainPreExecute)&&e.DWT.OnWebTwainPreExecute(t,n)}function Xn(){r.detect.bMaskShow=!1,e.DWT.ScanDirectly||r.isFunction(e.DWT.OnWebTwainPostExecute)&&e.DWT.OnWebTwainPostExecute()}!function(e){e.IT_BMP=0,e.IT_JPG=1,e.IT_TIF=2,e.IT_PNG=3,e.IT_PDF=4,e.IT_ALL=5,e.IT_MULTIPAGE_PDF=7,e.IT_MULTIPAGE_TIF=8,e.IT_J2K=14}(Bn||(Bn={})),e.DWT.EnumDWT_ImageType=Bn;var Jn={notSupportProperty:function(e){},notSupportMethod:function(e){},cformat:function(e,t){if(r.isString(e)){var n,i,o,a,s,u=e.indexOf("<%");if(-1==u)return e;if(i=e.substring(0,u),!(u+2<(n=e.indexOf(">",i))))return e;o=e.substring(u+1,n),a=e.substring(n+1);try{s=r.sprintf(o,t)}catch(c){s=""}return[i,s,a].join("")}return""},refreshImageAfterInvokeFun:function(e,r,t){return 1==t},loadHttpBlob:function(t,n,i,o,a,s,u,c){var l,d,f=Be;if(d={method:n,dataType:"blob"},c&&(d.headers=c),""!=t.HTTPUserName&&(d.username=t.HTTPUserName,d.password=t.HTTPPassword),t.__HTTPPostResponseString="",o){if((e.Lib.env.bMobile||e.navInfoSync.bChrome||e.navInfoSync.bFirefox)&&"get"==n){var h=r.guid();return r.progressContext&&(r.progressContext._onPercent=u),yr(r.progressContext,h)(i,d).then((function(e){var r=e.type;if("text/plain"==r||"text/html"==r||"text/json"==r){var n=new FileReader;n.readAsText(e),n.onload=function(){t.__HTTPPostResponseString=n.result,a(e)},n.onerror=function(){a(e)}}else a(e)}),(function(e){e&&e.code?(t._errorCode=e.code,t._errorString=e.message):e&&e.httpCode?r.Errors.HttpDownloadError(t,!1,e.message,e.httpCode):r.Errors.HttpDownloadUrlError(t),r.isFunction(s)&&s({code:t._errorCode,message:t._errorString})})),!0}d.onSuccess=function(e,r,n){if((n?n.getResponseHeader("content-type"):"").indexOf("text/")>=0){var i=new FileReader;i.readAsText(e),i.onload=function(){t.__HTTPPostResponseString=i.result,a(e)},i.onerror=function(){a(e)}}else a(e)},r.isFunction(u)&&(d.beforeSend=function(r){r.addEventListener("progress",(function(r){!e.navInfoSync.bSafari&&r&&(delete r.totalSize,delete r.position),u(r)}),Be)}),f=Ve}else e.navInfoSync.bIE?(d.dataType="arraybuffer",d.onSuccess=function(e,r,n){var i,o;(i=e||n.responseData)&&(o=new Uint8Array(i)),t.__HTTPPostResponseString=n.responseText,t._errorCode=0,t._errorString="",a(o),o=null,f=Ve}):(d.dataType="text",d.contentType="text/plain; charset=x-user-defined",d.mimeType="text/plain; charset=x-user-defined",d.onSuccess=function(e,r,n){var i,o,s;i=n.responseText,t.__HTTPPostResponseString=i,o=i.length,s=new Uint8Array(o);for(var u=0;u<o;u++)s[u]=i.charCodeAt(u);t._errorCode=0,t._errorString="",a(s),s=null,f=Ve}),d.headers?r.mix(d.headers,{"X-Requested-With":Be}):d.headers={"X-Requested-With":Be};if("post"==n){var g,p=t.httpFormFields;if(p)try{g=new FormData,r.each(p,(function(e,r){if(e instanceof Blob){var t=e.name;g.append(r,e,t)}else g.append(r,e)})),r.mix(d,{data:g,processData:Be,contentType:Be})}catch(_){}}l=function(e,n,i){var o,a;if(e&&r.isArray(e)&&e.length>2?(o=e[1],a=e[2]):(o=n,a=i),2!=a.state&&3!=a.state||0!=a.status)r.Errors.HttpDownloadError(t,Be,o,a.status);else if("abort"===a.statusText){var u=Ve;r.Errors.HttpDownloadError(t,u)}else r.Errors.HttpDownloadUrlError(t);r.isFunction(s)&&s()},d.url=i,d.async=o,d.onError=l,d.onComplete=function(){t._cancelableObj=null};var m=fr(d);return o&&r.progressContext&&(r.progressContext._onPercent=u,t.IfShowCancelDialogWhenImageTransfer&&r.progressContext.on("cancel",(function(){m.abort()}))),f},combineUrl:function(e,t,n){var i=[],o=t;return o===undefined||n===undefined?undefined:(r.isString(o)||(o=String(t)),0==o.indexOf("http://")?(o=o.replace("http://",""),i.push("http://")):0==o.indexOf("https://")?(o=o.replace("https://",""),i.push("https://")):(0==o.indexOf("//")&&(o=o.replace("//","")),e.IfSSL?i.push("https://"):i.push("http://")),i.push(o),o.indexOf(":")<0&&(e.HTTPPort||(e.HTTPPort=r.detect.ssl?443:80),(!r.detect.ssl&&80!=e.HTTPPort||r.detect.ssl&&443!=e.HTTPPort)&&(i.push(":"),i.push(e.HTTPPort))),0!==n.indexOf("/")&&i.push("/"),i.push(n),i.join(""))},httpPutImage:function(t,n,i,o,a,s,u){var c=Ve,l={method:"PUT",url:n,hasContent:Ve,processData:Be,async:o,data:i,onSuccess:a,onError:function(){c=Be,r.isFunction(s)&&s()},onComplete:function(){t._cancelableObj=null},beforeSend:function(t){r.isFunction(u)&&t.upload.addEventListener("progress",(function(r){!e.navInfoSync.bSafari&&r&&(delete r.totalSize,delete r.position),u(r)}),Be)}};""!=t.HTTPUserName&&(l.username=t.HTTPUserName,l.password=t.HTTPPassword),o||r.mix(l,{headers:{"X-Requested-With":Be}});var d=fr(l);return r.progressContext&&(r.progressContext._onPercent=u,r.progressContext._onCancel=function(){d.abort()}),c},EVENTS:["OnPostAllTransfers","OnPostTransfer","OnPostLoad","OnPreTransfer","OnPreAllTransfers","OnResult","OnTransferCancelled","OnTransferError","OnSourceUIClose","OnGetFilePath","OnPercentDone","OnPostTransferAsync","OnPreAllTransfersAsync","OnRemoteScanStatusAsync","OnConsumed"],SEND_BACK_EVENTS:["OnPreAllTransfers","OnPreTransfer","OnPostTransfer","OnGetFilePath","OnPostLoad"],GetImageInfo:function(e,t){var n=e._ImgManager.convertClientIndexToServerId(t);return-1==n?(r.Errors.IndexOutOfRange(e),!1):e._innerFun("GetImageInfo",kn(n))},getBlobTypeByImageType:function(e){var r="application/octet-stream";switch(e){case Bn.IT_BMP:r="image/bmp";break;case Bn.IT_JPG:r="image/jpeg";break;case Bn.IT_TIF:r="image/tiff";break;case Bn.IT_PNG:r="image/png";break;case Bn.IT_PDF:r="application/pdf";break;case Bn.IT_J2K:r="image/jp2"}return r},callbacks:[],pushCallback:function(e,r,t){var n={method:e,callback:r,ticks:t};Jn.callbacks.push(n)},refreshUIRef:0,isServerInvalid:function(e){Vn.isServerInvalid(e)},replaceLocalFilename:function(r){var t;return r===undefined?"":(t=(r=String(r)).replace(/\\/g,"\\\\"),e.navInfoSync.bFileSystem&&(t=decodeURI(t)),t)},getImageType:function(r){if(r===undefined)return-1;if(r.length<4)return-1;var t=r.lastIndexOf(".");if(-1===t)return-1;var n=r.slice(t).toLowerCase();return".bmp"===n||".dib"===n?e.DWT.EnumDWT_ImageType.IT_BMP:".jpg"===n||".jpe"===n||".jpeg"===n||".jfif"===n?e.DWT.EnumDWT_ImageType.IT_JPG:".tif"===n||".tiff"===n?e.DWT.EnumDWT_ImageType.IT_TIF:".png"===n?e.DWT.EnumDWT_ImageType.IT_PNG:".pdf"===n?e.DWT.EnumDWT_ImageType.IT_PDF:".jp2"===n||".j2k"===n||".j2c"===n?e.DWT.EnumDWT_ImageType.IT_J2K:-1},makeParams:kn,showMask:Zn,hideMask:Qn};r.html5.Funs=Jn;var Yn=0;function Zn(e,t,n){if(r.log("showMask:"+e+"--"+Yn),0==Yn)if(t){qn(t);var i=r.mask.dlgMask;if(i){i.style.zIndex="10000";var o=r.one(".dynamsoft-backdrop",i.parentNode);o&&o.length>0&&(o[0].style.zIndex="10000")}}else qn(n||{});Yn++}function Qn(e){r.log("hideMask:"+e+"--"+Yn),Yn>1?Yn--:Yn<=1&&(Xn(),Yn=0)}function $n(e,r,t,n,i){var o=0;return e==F.TWAIN&&(o=Rn),e==F.TWAIN64?o=xn.TWAINX64SCANNER:e==F.ICA?t?o=xn.SANESCANNER:n?o=xn.ICASCANNER:(r||i)&&(o=Rn):e==F.TWAIN_AND_TWAIN64&&(t?o=Rn|xn.SANESCANNER:n?o=Rn|xn.ICASCANNER:r?o=Rn|xn.TWAINX64SCANNER:i&&(o=Rn)),o}var ei=["OnPreAllTransfers","OnPreTransfer","OnPostTransfer","OnPostTransferAsync"];function ri(e,r){for(var t=e._ImgManager.GetServerIdList(),n=0;n<t.length;n++)r.push(t[n])}function ti(e,t){return 0!=e._ImgManager.count()||(r.Errors.NoImage(e),r.isFunction(t)&&t(e._errorCode,e._getErrorString()),!1)}function ni(e,t,n){return!!ti(e,n)&&(!(isNaN(t)||!r.isNumber(t)||t<0||t>=e._ImgManager.count())||(r.Errors.IndexOutOfRange(e),r.isFunction(n)&&n(e._errorCode,e._getErrorString()),!1))}function ii(e){var t,n,i,o=[];return e._ImgManager.count()<=0||((n=e._ImgManager.getCurrentImageIndex())>=0&&(t=e._ImgManager.convertClientIndexToServerId(n)),i=e._ImgManager.getSelectedClientIndexArray(),r.isArray(i)&&r.each(i,(function(r){var t=e._ImgManager.convertClientIndexToServerId(r);-1!=t&&o.push(t)})),-1!=t&&0==o.length&&o.push(t)),o}function oi(e){var r,t=[];return e._ImgManager.count()<=0||(r=e._ImgManager.getCurrentImageIndex(),t=e._ImgManager.getSelectedClientIndexArray(),-1!=r&&0==t.length&&t.push(r)),t}function ai(e,t,n){return e._resetErr(),!!e._isValid()&&(isNaN(t)?(r.Errors.InvalidIndex(e),r.isFunction(n)&&n(e._errorCode,e.ErrorString),Be):t<0||t>=e._ImgManager.count()?(r.Errors.IndexOutOfRange(e),r.isFunction(n)&&n(e._errorCode,e.ErrorString),Be):Ve)}var si=function(){function t(r,n){X(this,t),_e(this,"m_server",""),_e(this,"m_iUsingTime",0),_e(this,"m_countMap",{}),_e(this,"m_newConsum",!1),_e(this,"m_mapSavedToDb",!1),this.clearData(),this.m_enumInstance=r,r==e.DWT.EnumInstance.dwt_desktop?(this.m_deploymentType="desktop",this.m_server=n):r==e.DWT.EnumInstance.dbr&&(this.m_deploymentType="browser",this.m_server="")}return Q(t,[{key:"clearData",value:function(){this.m_iUsingTime=0,this.m_jvUsingTime=r.nil,this.m_countMap={},this.m_newConsum=!1,this.m_mapSavedToDb=!1,this.m_minExpiredTime=r.nil,this.m_maxExpiredTime=r.nil,this.m_cu=r.nil,this.m_ar=r.nil,this.m_ltsInstance=r.nil}},{key:"set_cu",value:function(e){this.m_cu=e}},{key:"get_cu",value:function(){return this.m_cu}},{key:"set_ar",value:function(e){this.m_ar=e}},{key:"get_ar",value:function(){return this.m_ar}},{key:"get_ltsInstance",value:function(e){return this.m_ltsInstance||(this.m_ltsInstance=e(this.m_enumInstance)),this.m_ltsInstance}},{key:"inited_ltsInstance",value:function(){return!!this.m_ltsInstance}},{key:"set_maxExpiredTime",value:function(e){this.m_maxExpiredTime=e}},{key:"get_maxExpiredTime",value:function(){return this.m_maxExpiredTime}},{key:"set_minExpiredTime",value:function(e){this.m_minExpiredTime=e}},{key:"get_minExpiredTime",value:function(){return this.m_minExpiredTime}},{key:"get_deploymentType",value:function(){return this.m_deploymentType}},{key:"get_enumDeploymentType",value:function(){return this.m_enumInstance}}]),t}();var ui=e.DWT;ui.LTS=ui.LTS||{},ui.licenseException={code:0,message:"",fromLTS:!1},ui.bLTSOnline=!0,ui.axInstance=undefined,ui.lOnUpdateDWObj=[],ui.EnumInstance={dwt_desktop:0,dwt_browser:1,dbr:2};var ci,li,di,fi=0,hi={},gi=!1,pi=!1,mi=!1,_i=!1,vi=!1;function yi(){var e=r.product.handshakeCode;return r.isString(e)||(e=""),e}function Ii(){var e=r.product.organizationID;return r.isNumber(e)?e=""+e:r.isString(e)||(e=""),e}function Si(){return r.replaceAll(ui.JSVersion,",",".")}function Ti(e,t){var n=e;return n===r.nil&&(n=ui.EnumInstance.dwt_desktop),n==ui.EnumInstance.dbr?(di||(di=new si(n,"")),di):(li||(li=new si(n,"")),li)}ui.lupverfy=function(){Ti(ui.EnumInstance.dwt_desktop).get_ltsInstance(Ci),Ti(ui.EnumInstance.dbr).get_ltsInstance(Ci)},ui.lsmid=function(e,r){Ti(ui.EnumInstance.dwt_desktop).set_cu(e)},ui.lsar=function(e,r){Ti(ui.EnumInstance.dwt_desktop).set_ar(e)},ui.lsmid2b=function(e){Ti(ui.EnumInstance.dwt_desktop).set_cu(e)},ui.lgar=function(e,r){Ti(e).get_ar()},ui.laddDWTObj=function(e){var t=!1;r.each(ui.lOnUpdateDWObj,(function(r){if(r==e)return t=!0,!1})),t||ui.lOnUpdateDWObj.push(e)},ui.lremoveDWTObj=function(e){r.each(ui.lOnUpdateDWObj,(function(r,t){if(r==e)return ui.lOnUpdateDWObj.splice(t,1),!1}))},ui.lsendUpdateEvt=function(e,t){var n=[];if(r.each(ui.lOnUpdateDWObj,(function(r){e==ui.EnumInstance.dwt_desktop&&n.push(r)})),0==n.length)return r.Promise.resolve();var i,o=n[0];return o._bAx?(r.each(n,(function(r){r.SetLTSInfo(Ti(e).get_ar(),Ti(e).get_cu())})),o.GetLicenseInfo().then((function(n){n&&r.isArray(n.Detail)&&n.Detail.length>0&&ui.lsexp(e,n.Detail[0].ExpireDate,t)}))):(i=o.SetLTSLicenseAsync(Ti(e).get_ar()).then((function(n){n&&r.isArray(n.Detail)&&n.Detail.length>0&&ui.lsexp(e,n.Detail[0].ExpireDate,t)})),r.each(n,(function(r,t){0!=t&&r.SetLTSLicenseAsync(Ti(e).get_ar())})),i)},ui.lgcb=function(){var t=e.navInfoSync,n=[];return t.bChrome?n.push("Chrome"):t.bFirefox?n.push("Firefox"):t.bEdge?n.push("Edge"):t.bIE?n.push("IE"):t.bSafari?n.push("Safari"):t.bOpera?n.push("Opera"):t.b360SE?n.push("360SE"):t.bTencentTraveler?n.push("TencentTraveler"):t.bMaxthon?n.push("Maxthon"):t.bMetaSr?n.push("MetaSr"):t.bTheWorld?n.push("TheWorld"):t.bUC?n.push("UC"):t.bHuaWeiBrowser&&n.push("HuaWeiBrowser"),n.push(t.strBrowserVersion),t.bWin?n.push("Windows"):t.bMac?n.push("Mac"):t.bLinux?n.push("Linux"):t.bAndroid?n.push("Android"):t.bChromeOS?n.push("ChromeOS"):t.bHarmonyOS?n.push("HarmonyOS"):r.env.bMobile?n.push("Mobile OS"):e.navInfo.bEmbed&&n.push("Embed OS"),n.join(" ")};var bi,Ei={NetworkError:-2440,Timedout:-2441,JsonError:-2442,CorsError:-2443,Expired:-2445,LtsJsLoadError:-2446,UUIDError:-2447};function Ci(t){var n,i,o=r.product.licenseServer;if(o&&o.length>0)for(n=0;n<o.length;n++)i=o[n],r.endsWith(i,"/")||(o[n]=i+"/");var a={dm:location.origin?r.startsWith(location.origin,"http")?location.origin:"https://localhost":r.startsWith(location.href,"http")?location.href:"https://localhost",lf:r.localforage,btoa:r.btoa,atob:r.atob,sutlcb:function(){r.isFunction(ui.lonsend)&&ui.lonsend()},fol:ui.OnFirstOffline,dwt:!0};if(t==ui.EnumInstance.dwt_browser||t==ui.EnumInstance.dbr?a.feab=ui.lfeab_wasm:a.feab=ui.lfeab_ax,!e.navInfoSync.bIE&&r.product.ltsDebug&&(a.debugLog=console.log),e.LTS&&e.LTS._)return e.LTS._.createLtsInstance(a);var s={},u=function(){return r.Promise.reject({code:Ei.LtsJsLoadError,message:"The dynamsoft.lts.js load failed."})};return s.i=u,s.s=u,s.caret=u,s}function wi(e,t){var n=null!=t?t:"",i=Ti(e),o=i.get_enumDeploymentType();if(ui.lclex(),i.get_ar()&&i.get_cu())return Promise.resolve({ar:i.get_ar(),cu:i.get_cu()});var a={pd:ui.lgpd(e),v:Si(),os:ui.lgcb(),fn:ui.DeviceFriendlyName||"",ls:r.product.licenseServer,sp:r.product.sessionPassword,l:r.License.getLTSLicense(),mnet:function(){return i.get_maxExpiredTime()},mxet:function(){return i.get_minExpiredTime()},fol:ui.OnFirstOffline};return a.dt=i.get_deploymentType(),o==ui.EnumInstance.dwt_desktop?a.lsu=i.get_cu():o==ui.EnumInstance.dbr||(a.dwt=!0,""!=i.get_cu()&&(a.lsu=i.get_cu()),a.updateLicense=function(e){i.set_ar(e.ar),i.get_cu()||i.set_cu(e.cu),ui.lsendUpdateEvt(o,n)}),i.get_ltsInstance(Ci).i(a).then((function(e){return i.get_ar()||i.set_ar(e.ar),i.get_cu()||i.set_cu(e.cu),e}))}function ki(){return Date.now()}function Di(e){var r=e?new Date(e):new Date,t="yyyy-MM-ddTHH:mm:ss.SSSZ",n={"M+":r.getUTCMonth()+1,"d+":r.getUTCDate(),"H+":r.getUTCHours(),"h+":r.getUTCHours()%12||12,"m+":r.getUTCMinutes(),"s+":r.getUTCSeconds(),"q+":Math.floor((r.getUTCMonth()+3)/3),"S+":r.getUTCMilliseconds()};for(var i in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(r.getUTCFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+i+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?n[i]:("000"+n[i]).substr(("000"+n[i]).length-RegExp.$1.length)));return t}function xi(){var t=d,n=e.DWT&&e.DWT.CustomizableDisplayInfo;n&&r.isString(n.loaderBarSource)&&""!=n.loaderBarSource?r.loaderBarSource=n.loaderBarSource:e.navInfoSync.bIE?r.loaderBarSourceIE=t.loaderBarSource:r.loaderBarSource=t.loaderBarSource,n&&r.isString(n.loaderBarClassName)&&""!=n.loaderBarClassName?r.loaderBarClassName=n.loaderBarClassName:r.loaderBarClassName=t.loaderBarClassName,n&&r.isString(n.loaderBarBackgroundColor)?r.loaderBarBackgroundColor=n.loaderBarBackgroundColor:r.loaderBarBackgroundColor=t.loaderBarBackgroundColor}function Pi(e){r.log(e)}function Fi(){return!function(e){if(r.isString(e)){if("localhost"==e||"127.0.0.1"==e)return!0;var t=e.split(".");if(4==t.length&&/^(([1-9]?\d|1\d{2}|2[0-4]\d|25[0-5])\.){3}([1-9]?\d|1\d{2}|2[0-4]\d|25[0-5])$/.test(e)){var n=parseInt(t[0]),i=parseInt(t[1]);if(127==n||10==n||169==n&&254==i||172==n&&i>=16&&i<=31||192==n&&168==i)return!0}}return!1}(location.hostname)&&!e.navInfoSync.bSSL&&!e.navInfoSync.bFileSystem&&!!((e.navInfoSync.bChrome||e.navInfoSync.bEdge)&&parseInt(e.navInfoSync.strBrowserVersion)>=94)}function Wi(e,r,t,n){return Ai.apply(this,arguments)}function Ai(){return Ai=ne(de.mark((function e(t,n,i,o){var a,s;return de.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n!=Me.GET_TASKID){e.next=4;break}return e.abrupt("return",o.taskId);case 4:if(n!=Me.ONMESSAGE_PROCESS_DATA){e.next=8;break}return e.abrupt("return",r.parse(t));case 8:if(n!=Me.ONMESSAGE_GET_TASKID){e.next=13;break}if(!o||!o.client){e.next=11;break}return e.abrupt("return",o.client.getRequestTaskId());case 11:e.next=20;break;case 13:if(n!=Me.HANDLE_RAW_MESSAGE){e.next=20;break}if(a=null==o?void 0:o.userData){e.next=17;break}return e.abrupt("return",!1);case 17:return(s=t).indexOf("Version not found")>=0||s.indexOf("Function not found")>=0?r.isFunction(a.fFun)&&a.fFun():r.isFunction(a.sFun)&&a.sFun(s),e.abrupt("return",s);case 20:case"end":return e.stop()}}),e)}))),Ai.apply(this,arguments)}function Ri(t,n,i,o){var a,s=r.now(),u=r.guid(),c={id:u,method:"VersionInfo",version:[e.Lib.product.getDWTPrefix(),e.Lib.product.getDWTVersionInfoVer()].join("")},l=Wi,d=_t;a={client:t,userData:{cmdId:u,cmd:null,sFun:n,fFun:i,rawData:!0},taskId:s},t.setRetry(0),t.request(r.stringify(c),l,a,d).then((function(e){return t.dispose(),e}),(function(){r.isFunction(o)&&o(),t.dispose()}))}function Oi(){r.product.loadResourcePath?(Pi(e.MSG.Init_AllJsLoaded),bi()):setTimeout(Oi,100)}function Li(){return r.product.loadResourcePath?(Pi(e.MSG.Init_AllJsLoaded),r.Promise.resolve()):new r.Promise((function(e,r){bi=e,setTimeout(Oi,100)}))}function Ni(){var r=e.navInfoSync;return r.bAndroid?I.enumAndroid:r.bMac?I.enumMac:r.bChromeOS?I.enumChromeOS:r.bHarmonyOS?I.enumHarmonyOS:e.navInfo.bEmbed?I.enumEmbed:r.bLinux?I.enumLinux:r.biPhone||r.biPad?I.enumiOS:I.enumWindow}function Mi(t,n){var i=r.product,o=e.navInfoSync,a=e.dcp.getDSPath();if(""!=r.install._divDWTemessageContainer&&r.hide(r.install._divDWTemessageContainer),o.bMac)t?r.isFunction(e.OnWebTwainNeedUpgradeCallback)&&e.OnWebTwainNeedUpgradeCallback(i.name,{"default":a},i.bHTML5Edition,I.enumMac,o.bIE,o.bSafari,r.detect.ssl,r.env.strIEVersion):r.isFunction(e.OnWebTwainNotFoundOnMacCallback)&&e.OnWebTwainNotFoundOnMacCallback(i.name,a,i.bHTML5Edition,o.bIE,o.bSafari,r.detect.ssl,r.env.strIEVersion,n);else if(o.bLinux||e.navInfo.bEmbed||o.bChromeOS||o.bMobile){var s,u,c=Ni();if(e.navInfo.bEmbed||o.bAndroid||o.bChromeOS||o.bHarmonyOS?s=a:(s=e.dcp.getLinuxHTML5DebPath(),u=e.dcp.getLinuxHTML5RpmPath()),t){if(r.isFunction(e.OnWebTwainNeedUpgradeCallback)){var l={"default":s};o.bLinux&&(l.deb=s,l.rpm=u),e.OnWebTwainNeedUpgradeCallback(i.name,l,i.bHTML5Edition,c,o.bIE,o.bSafari,r.detect.ssl,r.env.strIEVersion)}}else o.bAndroid?r.isFunction(e.OnWebTwainNotFoundOnAndroidCallback)&&e.OnWebTwainNotFoundOnAndroidCallback(i.name,a,r.detect.ssl):r.isFunction(e.OnWebTwainNotFoundOnLinuxCallback)&&e.OnWebTwainNotFoundOnLinuxCallback(i.name,s,u,i.bHTML5Edition,o.bIE,o.bSafari,r.detect.ssl,r.env.strIEVersion,c,n)}else if(o.bChrome||o.bSafari||o.bFirefox||o.bOpera||e.DWT.IfUseActiveXForIE10Plus==Be||!e.DWT.ActiveXInstallWithCAB&&o.bIE)if(t){if(r.isFunction(e.OnWebTwainNeedUpgradeCallback)){var d={"default":a};e.OnWebTwainNeedUpgradeCallback(i.name,d,i.bHTML5Edition,I.enumWindow,o.bIE,o.bSafari,r.detect.ssl,r.env.strIEVersion)}}else r.isFunction(e.OnWebTwainNotFoundOnWindowsCallback)&&e.OnWebTwainNotFoundOnWindowsCallback(i.name,a,i.bHTML5Edition,o.bIE,o.bSafari,r.detect.ssl,r.env.strIEVersion,n)}function Ui(t){var n,i,o=e.navInfoSync,a=t.WebTwainId,s=t.Host,u=t.Port,c=t.PortSSL;return i={},r.isString(a)&&""!==a?i.id=a:i.id=a=Nn(),r.isDOM(t.Container)?(n=t.Container,r.isString(n.id)&&""!==n.id||(n.id=["dwt_node_",r.getRandom()].join("")),i.container=n,i.bNoViewer=!1):i.bNoViewer=!0,i.bNoViewer?(i.width=0,i.height=0):(r.isUndefined(t.Width)?n.style.width?i.width=n.style.width:i.width=300:i.width=t.Width,r.isUndefined(t.Height)?n.style.height?i.height=n.style.height:i.height=300:i.height=t.Height),i.dmService=t.dmService,r.isString(s)&&""!=s||(s=f()),i.host=s,o.bSSL?(c||(c=e.DWT.SSLPort),i.port=c):(u||(u=e.DWT.Port),i.port=u),i}function Bi(e,r){!function(e,r){if(r.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,r),r.add(e)}function Vi(e,r,t){if(!r.has(e));return t}ui.lgpd=function(r){return e.navInfoSync.bWin&&r==ui.EnumInstance.dwt_desktop?"dwt|dbr":"dwt"},ui.lglic=wi,ui.lgbuuid=function(){return""},ui.lshow=function(){return{t:ci,t2:fi,m:JSON.stringify(hi)}},ui.lgct=function(e){switch(e){case 0:return"3011";case 1:return"3012";case 2:return"3014";case 3:return"3013";case 4:return"3015";case 14:return"3016";case 3001:return"3001";case 3002:return"3002";case 3003:return"3003";case 3004:return"3004";case 3005:return"3005";case 3006:return"3006";case 3007:return"3007";case 3008:return"3008";case 3009:return"3009";case 5001:return"5001";case 4001:return"4001";case 4002:return"4002";case 4003:return"4003"}return""},ui.lcvrf=function(e){e&&setTimeout((function(){ui.lcvrf_(e)}),1)},ui.lcvrf_=function(t){var n;n=ui.EnumInstance.dwt_desktop;var i,o=ui.DeviceFriendlyName||"",a=ui.lgcb(),s=Ti(n),u={hs:yi(),og:Ii(),cu:s.get_cu(),fn:o,cw:"",os:a,v:Si(),dt:s.get_deploymentType(),ed:"js"},c=function(r,t){var n,i,o=e.Lib,a=0;if(o.isString(r)&&""!=r&&"{}"!=r&&t&&o.isArray(t)&&!(t.length<1)){if(i=Ti(t[0]),n=o.parse(r),ui.lclex(),0==fi){var s=ki(),u="";fi=s,ci=Di(s),hi={},a=0,o.each(n,(function(e,r){(r<a||0==a)&&(a=r,u=e)})),a>0&&i.get_ltsInstance(Ci).s(o.product.licenseServer,u,a,!0).then((function(){}),(function(e){}))}o.each(n,(function(e,r){var t=!1,n=parseInt(r);n>0&&n!=a&&(n+18e4<ki()&&(t=!0),i.get_ltsInstance(Ci).s(o.product.licenseServer,e,r,t).then((function(){}),(function(e){})))}))}};if(u.pd=ui.lgpd(n),i=JSON.stringify(u),!t._bAx){var l="GetBuffer",d=kn(r.replaceAll(i,'"','\\"')),f={cmd:l,cmdId:Ln(),sFun:c,fFun:function(){},params:[n]};return t._innerSendByWS(l,d,f,null,!0)}c(t.GetBuffer(i),[n,""])},ui.lavrf=function(e,r,t,n){var i=1;if(""!=e){r>1&&(i=r);var o=ki();if(fi>0&&fi+18e4<o){pi?(hi={},ui.lavrf__unload()):ui.lavrf__(!0,t,n);var a=ki()+1;fi=a,ci=Di(a),hi={}}gi=!0,pi=!1,hi[e]?hi[e]+=i:hi[e]=i,0==fi&&ui.lavrf__(!0,t,n)}},ui.lavrf_=function(e,r,t){if(gi){var n=1;e&&(n=e),setTimeout((function(){ui.lavrf__(!1,r,t)}),n)}},ui.lavrf__=function(e,t,n){var i,o,a,s=ki(),u=!1,c=!!e,l=0,d=t;r.isUndefined(d)&&(d=ui.EnumInstance.dwt_desktop),a=Ti(d),gi=!1,0==fi&&(u=!0,fi=s,ci=Di(s)),i=fi,o=ci;var f={};f.ut=o;var h={};if(r.each(hi,(function(e,r){h[r]=e,e>0&&l++})),f.cts=h,c||i+18e4<s){c=!0;var g=ki()+1;if(fi=g,ci=Di(g),hi={},pi=!1,0==l)return}else{if(0==l)return;pi=!0}f.dur=u?1:180;var p,m=ui.DeviceFriendlyName||"",_=ui.lgcb(),v={hs:yi(),og:Ii(),cu:a.get_cu(),fn:m,cw:"",os:_,v:Si(),dt:a.get_deploymentType(),ed:"js",rcs:[f]};v.product=ui.lgpd(t),p=JSON.stringify(v),r.product.ltsDebug&&Di(),ui.lclex(),a.get_ltsInstance(Ci).s(r.product.licenseServer,p,""+i,c).then((function(){}),(function(e){}))},ui.lavrf__unload=function(){var e,t=ki(),n=Ti(ui.EnumInstance.dwt_desktop),i=Ti(ui.EnumInstance.dbr);gi=!1,0==fi&&(fi=t,ci=Di(t)),e=fi;var o=ki()+1;fi=o,ci=Di(o),hi={},pi=!1,e+=1,ui.lclex(),n.inited_ltsInstance()&&n.get_ltsInstance(Ci).s(r.product.licenseServer,false,""+e,true).then((function(){}),(function(e){})),i.inited_ltsInstance()&&i.get_ltsInstance(Ci).s(r.product.licenseServer,false,""+e,true).then((function(){}),(function(e){}))},ui.lclex=function(){var e=ui.licenseException;e.code=0,e.message="",e.httpResponse="",e.fromLTS=!1},ui.li=function(e,t){var n;if(e.axInstance&&(ui.axInstance=e.axInstance,ui.axInstance))return n=ui.axInstance.GetUUID(),r.product.ltsDebug&&r.log("ActiveX cu: "+n),Ti(e.instanceMode).set_cu(n),n;return Ti(e.instanceMode).get_cu()},ui.lfeab_ax=function(e){return new r.Promise((function(r,t){var n="";if(ui.axInstance)try{n=ui.axInstance.Encrypt(e,0)}catch(i){}r(n)}))},ui.lfeab_wasm=function(e){return r.Promise.resolve("")},ui.lwsproc=function(e,t){try{e=r.parse(e)}catch(n){return void(t.fFun&&t.fFun(n))}"GetBuffer"==e.method?t.sFun&&e.result.length>0?t.sFun(e.result[0],t.params):t.sFun("",t.params):t.sFun&&t.sFun(e)},ui.lsexp=function(e,t,n){var i,o=t;if(3==(i=(o=r.replaceAll(o,"/","-")).split("-")).length){var a=i[0],s=i[1],u=i[2];s.length<2&&(s=(s="00"+s).substr(s.length-2)),u.length<2&&(u=(u="00"+u).substr(u.length-2)),o=[a,s,u].join("-")}var c=[o,"T23:59:59.999Z"].join("");Ti(e).set_minExpiredTime(c),Ti(e).set_maxExpiredTime(c)},ui.lunload=function(){ui.lavrf__unload();var e=Ti(ui.EnumInstance.dwt_desktop),t=Ti(ui.EnumInstance.dbr);e.clearData(),t.clearData(),fi=0,ci=r.nil,hi={},pi=!1,gi=!1,mi=!1,_i=!1,vi=!1,ui.lclex(),ui.bLTSOnline=!0,ui.axInstance=r.nil,ui.lOnUpdateDWObj=[]},ui.lcexp=function(t,n){return Ti(t).get_ltsInstance(Ci).caret().then((function(){return!1}),(function(t){var n=ui.licenseException,i="";return t instanceof Error||"message"in t?i=t.message:r.isString(t)&&(i=t),ui.lsetException(Ei.Expired,i,!1),_i||(_i=!0,r.error(i),e.OnLTSLicenseError&&e.OnLTSLicenseError(r.License.getPublicLicenseContent(n.message),n.code)),!0}))},ui.OnLicenseException=function(){var t=ui.licenseException,n=t.message;if(r.isString(n)&&(n.indexOf("Error Code")>-1?n=r.replaceAll(n,"Error Code","error code"):n.indexOf("Error code")>-1&&(n=r.replaceAll(n,"Error code","error code"))),n.indexOf("(https://www.dynamsoft.com/purchase-center/)")>-1&&(n=n.replace("(https://www.dynamsoft.com/purchase-center/)","(https://www.dynamsoft.com/store/dynamic-web-twain/)"),t.message=n),n.indexOf("error code:")>-1){var i=n.substr(0,n.indexOf("message")),o=n.substr(n.indexOf("message"));i.indexOf("{")>-1&&(i=i.substr(i.indexOf("{")+1)),o.indexOf("}")>-1&&(o=o.substr(0,o.indexOf("}"))),i=r.replaceAll(i,"error code:",""),o=r.replaceAll(o,"message: ",""),ui.lsetException(parseInt(i),o,!0),r.error(o),e.OnLTSLicenseError&&e.OnLTSLicenseError(r.License.getPublicLicenseContent(n),t.code)}else{if(!t.code){var a=Ei.NetworkError;n.indexOf("timed out")>-1||n.indexOf("timeout")>-1?a=Ei.Timedout:(n.indexOf("access-control-allow-origin")>-1||n.indexOf("cors")>-1)&&(a=Ei.CorsError),ui.lsetException(a,n,!0)}if(r.error(t.message),t.code==Ei.LtsJsLoadError)return;e.OnLTSLicenseError&&e.OnLTSLicenseError(r.License.getPublicLicenseContent(t.message),t.code)}},ui.lol=function(){return ui.bLTSOnline},ui.OnFirstOffline=function(e){ui.bLTSOnline=!1},ui.lpubdlg=function(t,n){if(r.isString(t)&&""!=t){if(t=r.atob(t),console&&console.warn,1==n)return mi||(mi=!0,e.OnLTSPublicLicenseWarning&&e.OnLTSPublicLicenseWarning(r.License.getPublicLicenseContent(t))),!0;2==n&&(mi||(mi=!0))}return!1},ui.lcheckLic=function(t,n,i){var o=!1;if(n){if(r.isArray(n.Detail)&&n.Detail.length>0){var a=n.Detail[0].ExpireDate;return ui.lsexp(t,a,i),ui.lcexp(t,i).then((function(r){var t=!1;r?t=!0:1!=n.Trial&&2!=n.Trial||(t=ui.lpubdlg(n.Message,n.Trial)),t||ui.bLTSOnline||vi||(vi=!0,e.OnLTSConnectionWarning&&e.OnLTSConnectionWarning())}))}1!=n.Trial&&2!=n.Trial||(o=ui.lpubdlg(n.Message,n.Trial))}return o||ui.bLTSOnline||vi||(vi=!0,e.OnLTSConnectionWarning&&e.OnLTSConnectionWarning()),r.Promise.resolve()},ui.lisValidID=function(t){if(r.isString(t)&&""!=t)return!0;var n,i=ui.licenseException;return ui.lsetException(Ei.UUIDError,"Failed to generate an ID for your device to license it: not enough permission.",!0),r.error(i.message),n=i.message,e.OnLTSLicenseError&&e.OnLTSLicenseError(n,i.code),!1},ui.lsetException=function(e,t,n){var i=ui.licenseException;i.code=e,i.message=t,r.isUndefined(n)||(i.fromLTS=n)},ui.lgcuid=function(t){var n=e.DWT.li({instanceMode:t},"");return n?r.Promise.resolve(n):Ti(t).get_ltsInstance(Ci).u().then((function(r){return e.DWT.lsmid(r,""),e.DWT.lsmid2b(r),r}))},r.install={_divDWTNonInstallContainerID:"dwt-NonInstallContainerID",_divDWTemessageContainer:"",_dlgInstall:!1},r.install._strNonInstallDIV=['<div style="text-align:center;" id="',r.install._divDWTNonInstallContainerID,'"></div>'].join(""),r.domReady((function(){var e=document.createElement("style"),r=["dialog[open]{display:block}dialog[closed]{display:none}.dynamsoft-backdrop{position:fixed;background:rgba(128,128,128,0.1);top:0;bottom:0;left:0;right:0;z-index:-99999999;}.dynamsoft-dwt-dialogProgress{width:330px;background:#FFF}.dynamsoft-finalMessage{margin:0;color:#3a3a3a;font:20px Arial,sans-serif}.dynamsoft-desc{margin:7px 0;color:#3a3a3a;font:14px Arial,sans-serif}.dynamsoft-status{color:#555;font:14px/22px Arial,sans-serif;margin-bottom:5px}.dynamsoft-progressBar{-webkit-appearance:none;width:280px;margin-bottom:20px;height:14px}.dynamsoft-progressBar,.dynamsoft-progressBar::-webkit-progress-bar{background-color:#e7e7e7;border-radius:7px}.dynamsoft-progressBar::-webkit-progress-value,.dynamsoft-progressBar::-moz-progress-bar{background-color:#50a8e1;border-radius:7px}.dynamsoft-loadingMsg{width:290px;height:290px;margin:auto;color:#CCC;border-width:1px;background:#FFF}.dynamsoft-loadingMsg-msg{margin:0 0 15px 25px;color:#3a3a3a;font:20px Arial,sans-serif}.dynamsoft-loadingMsg-desc{text-align:center;margin:0 0 15px 0;color:#3a3a3a;font:14px Arial,sans-serif}.ds-dwt-loaderBar-noserver-parent{height:100%;}.ds-dwt-loaderBar-noserver{margin: 0 auto;padding-top: 50px;text-align: center;}.ds-dwt-loaderBar-noserver img{height: 100px}"].join("");e.type="text/css";try{e.appendChild(document.createTextNode(r))}catch(t){e.styleSheet.cssText=r}document.body.appendChild(e)})),r._zdgb_xkz_dhk=function(){var t=r.install._dlgInstall;if(t){var n=r.one(".dynamsoft-dialog-closeTimer",t);if(n.getEL()){var i=parseInt(n.getEL().style.width);(i-=1)<=0?e.DWT.CloseDialog():(n.getEL().style.width=i+"%",setTimeout(r._zdgb_xkz_dhk,100))}}},r.ShowLicenseDialog=e.DWT.ShowMessage,r.createLoadingBarContent=function(){},r.openLoadingMsg=function(){r.product.bHTML5Edition&&xi()},r.closeLoadingMsg=function(e){r.product.bHTML5Edition&&Qn("closeLoadingMsg:"+e)},e.DWT.NeedCheckWebTwainBySocket=Fi,e.DWT.CheckWebTwainBySocket=function(t,n,i){var o,a,s,u=e.Lib.detect.urls;if(u&&u.length>0){var c=u[0];o=c.host||f(),a=c.port,s=c.ssl}else o=f(),r.isLocalIP(o)?(s=!(!e.navInfoSync.bSSL||!e.navInfoSync.bSafari),o=e.Lib.product.hostForCheckCert):s=e.navInfoSync.bSSL,a=s?e.DWT.SSLPort:e.DWT.Port;Ri(gt.getWsClient(o,a,s,!0),t,n,i)},e.DWT.IsLocalServiceConnected=function(){return new r.Promise((function(t,n){var i,o=f();r.each(r.detect.ports,(function(r){e.navInfoSync.bSSL?r.ssl&&(i=r.port):r.ssl||(i=r.port)})),e.DWT.CheckConnectToTheService(o,i,(function(e,r,n){t(!0)}),(function(){n(!1)}))}))};var Gi=n+".",ji=parseInt(n),Hi={ActiveX:0,Plugin:1,HTML5:2,WinMacLinux:3,Barcode1D:4,Barcode2D:5,BarcodeWriter:6,OCR:7,Webcam:8,PDFRasterizer:9,OCRPro:10,QR:50,PDF417:51,DataMatrix:52};function zi(e){return r.isString(e)?r.trim(e):e}var Ki=new WeakSet,qi=new WeakSet,Xi=new WeakSet,Ji=new WeakSet,Yi=new WeakSet,Zi=new WeakSet,Qi=new WeakSet,$i=new WeakSet,eo=new WeakSet,ro=function(){function t(){X(this,t),Bi(this,eo),Bi(this,$i),Bi(this,Qi),Bi(this,Zi),Bi(this,Yi),Bi(this,Ji),Bi(this,Xi),Bi(this,qi),Bi(this,Ki)}return Q(t,[{key:"isLTS",value:function(){return r.isString(e.Lib.product.handshakeCode)||r.isString(e.Lib.product.organizationID)||e.Lib.product.bPublicLTS||r.isString(e.DWT.ProductKey)&&r.startsWith(e.DWT.ProductKey,"DLS2")}},{key:"isLongKey",value:function(e){if(r.isString(e)&&e.length>0){var t=e.charAt(0);if("f"==t||"t"==t)return!0;if(r.startsWith(e,"DLS"))return!1;if(r.isNumber(e))return!1;var n=parseInt(e)+"-";return!r.startsWith(e,n)}return!1}},{key:"isLicenseMixed",value:function(t,n){var i,o=!1,a=t||e.DWT.ProductKey;(e.DWT.lclex(),n)&&((zi(e.DWT.organizationID)||zi(e.DWT.handshakeCode))&&a&&(o=!0,i={},r.Errors.LongKeyShortKeyMixed(i)));if(!o&&r.isString(a))if(a=r.trim(a),r.startsWith(a,"f")||r.startsWith(a,"t"));else if(""==a);else if(r.startsWith(a,"DLS2"))try{Vi(this,qi,no).call(this,a)}catch(u){o=!0,i={},r.Errors.LTSErrors(i),i._errorString=u.message}else{Vi(this,Ki,to).call(this,a).LTS||(o=!0,i={},r.Errors.FailedParseProductKey(i))}if(o&&i){e.Lib.Errors.SetLTSException(i);var s=e.DWT.licenseException;r.error(s.message)}return o}},{key:"reparseProductKey",value:function(t){t&&Pi(e.MSG.Init_ParseProductKey);var n=zi(e.DWT.organizationID),i=zi(e.DWT.handshakeCode),o=n||i,a=r.product,s=r.trim(e.DWT.ProductKey);if(!o){var u=Vi(this,Ki,to).call(this,s);u.LTS&&(i=zi(u.handshakeCode),o=(n=zi(u.organizationID))||i)}if(o)return this._innerResetLicense(),r.isNumber(s)&&(n=s),a.handshakeCode=i,a.organizationID=n,a.licenseServer=e.DWT.licenseServer,a.sessionPassword=e.DWT.sessionPassword,void(a.bPublicLTS=Vi(this,Xi,io).call(this,a.licenseServer,o));var c=!1;if(a.refProductKey!==s&&(this._innerResetLicense(),r.isString(s)&&s.length>0&&(a.refProductKey=s,c=!0)),c)if(this.isLongKey(a.refProductKey))a.bPublicLTS=!1;else{var l,d={_pLoad:{isEmpty:Ve},_license:a.refProductKey,_licenseServer:[]};try{l=gn(d)}catch(h){r.error(h),l=!1}if(l&&r.isString(l.l)){var f=r.trim(l.l);""==f?a.organizationID=f:-1!=f.indexOf("-")?a.handshakeCode=f:a.organizationID=f,r.isArray(l.ls)&&l.ls.length>0&&(a.licenseServer=l.ls),a.bPublicLTS=Vi(this,Xi,io).call(this,a.licenseServer,f),a.sessionPassword=l.sp}else a.bPublicLTS=!1}}},{key:"_innerResetLicense",value:function(){var r=e.Lib.product;r.refProductKey="",r.handshakeCode=undefined,r.organizationID=undefined,r.licenseServer=undefined,r.sessionPassword="",r.bPublicLTS=!0}},{key:"checkOSForAllowCore",value:function(e,t,n){if(r.product.bHTML5Edition){if(e)return Vi(this,eo,lo).call(this,t);var i=n._bRemoteMode,o=n.__serverPlatform;return this.isOSOK(t,i,o)}return Ve}},{key:"checkLocalPlatformForRemoteService",value:function(e){var t,n,i=e.__licenseInfo,o=Ni(),a=!1;for(t=0;t<i.Detail.length;t++)if(n=i.Detail[t],Vi(this,Qi,uo).call(this,n.EnumLicenseType,n.LicenseType).Core&&r.isString(n.Version)&&0==n.Version.indexOf(Gi)){if(a=Vi(this,eo,lo).call(this,n.OS))break;if(a=this.isOSOK(n.OS,true,o))break}return a||(o==I.enumWindow?r.Errors.LicenseNotSupportWindows(e):o==I.enumLinux?r.Errors.LicenseNotSupportLinux(e):o==I.enumMac?r.Errors.LicenseNotSupportMAC(e):r.Errors.LicenseNotSupportOS(e)),a}},{key:"checkProductKey",value:function(r,t,n){var i,o=e.DWT.licenseException;return!t.Camera&&(r.__licenseInfo||(r.__licenseInfo={}),(i=Vi(this,Yi,ao).call(this,r,r.__licenseInfo,Be,t,n))||(o.code=r._errorCode,o.message=r._getErrorString(),o.fromLTS=!1),i)}},{key:"isBindDomainOK",value:function(e){if(r.isUndefined(e)||null==e||""==e||"*"==e||"*.*"==e)return Ve;var t=location.hostname,n=Be;if(""==t)return Ve;for(var i=t.toLowerCase().split("."),o=i.length,a=e.toLowerCase().split(";"),s=0;s<a.length;s++){var u=a[s];if("*.*"==u){n=Ve;break}var c=u.split("."),l=c.length;if(l>0&&l-1<=o){for(var d=Ve,f=l-1;f>0;f--){if(c[f].indexOf("*")>-1){n=Ve;break}if(f+o-l>=0){if(i[f+o-l]!=c[f]){d=Be;break}}else if("*"!=c[f]){d=Be;break}}if(d&&("*"==c[0]||o>=l&&i[o-l]==c[0])){n=Ve;break}}}return n}},{key:"isExpiredOrFuture",value:function(e,r){if(""==e)return Be;if(!r){var t=e.length;if(t>2&&"/"==e[t-2]&&"0"==e[t-1])return Be}var n=vo(e),i=(new Date).getTime(),o=i+5184e6;return n.getTime()<i||r&&n.getTime()>o?Ve:Be}},{key:"willTrialExpire",value:function(e){if(""==e)return Be;var r=vo(e),t=(new Date).getTime();return r.getTime()<t+432e6&&r.getTime()>t?Ve:Be}},{key:"isOSOK",value:function(r,t,n){var i=!1,o=!1,a=!1,s=!1,u=!1,c=!1,l=!1,d=!1;if(""==r||"0"==r)return Ve;if(t)n==I.enumWindow?a=!0:n==I.enumLinux?o=!0:n==I.enumMac?i=!0:n==I.enumEmbed?u=!0:n==I.enumChromeOS?c=!0:n==I.enumAndroid?l=!0:n==I.enumHarmonyOS?d=!0:n==I.enumiOS&&(s=!0);else{var f=e.navInfoSync;i=f.bMac,o=f.bLinux,a=f.bWin,s=f.biPhone||f.biPad,c=f.bChromeOS,u=e.navInfo.bEmbed,l=f.bAndroid,d=f.bHarmonyOS}return(r=r.toLowerCase()).indexOf("windows")>-1&&a||r.indexOf("mac")>-1&&i||r.indexOf("linux")>-1&&(o||c||d)||r.indexOf("android")>-1&&l||r.indexOf("ios")>-1&&s||r.indexOf("embed")>-1&&u?Ve:Be}},{key:"isBrowserOK",value:function(t){if(r.isString(t)){if(""==t||"0"==t)return Ve;var n=(t=t.toLowerCase()).split(";"),i=Be,o=e.navInfoSync;return r.each(n,(function(e){("chrome"==r.trim(e)&&(o.bChrome||o.bSafari||o.bOpera||o.bEdge)||"ie"==r.trim(e)&&o.bIE||"firefox"==r.trim(e)&&o.bFirefox)&&(i=Ve)})),i}return Be}},{key:"isAllowLicenseType",value:function(e,r){return r.Core?e.Core:r.PDFRasterizer?e.PDFRasterizer:r.Webcam||r.Camera?e.Webcam:r.barcode1D?e.barcode1D:r.QR?e.QR:r.PDF417?e.PDF417:r.DataMatrix?e.DataMatrix:r.OCR?e.OCR:r.OCRPro?e.OCRPro:e.Core}},{key:"setNoAllowedLicenseTypeError",value:function(e,t,n){n.Core?r.Errors.LicenseNoCore(e,t):n.Webcam||n.Camera?t||n.Camera?r.Errors.LicenseNotSupportWebcamWasm(e):r.Errors.LicenseNoWebcam(e):n.PDFRasterizer?t?r.Errors.LicenseNotSupportPdfRWasm(e):r.Errors.LicenseNoPDF(e):n.OCR?r.Errors.LicenseNoOCR(e):n.OCRPro?r.Errors.LicenseNoOCRPro(e):r.Errors.LicenseEmptyOrInvalid(e)}},{key:"getLicenseDateString",value:function(e){var r,t=e.getFullYear();return[(r=e.getMonth()+1)>=10?""+r:"0"+r,"/",e.getDate()>=10?""+e.getDate():"0"+e.getDate(),"/",t].join("")}},{key:"hasPDFRProductKey",value:function(e){return!!this.checkProductKey(e,{PDFRasterizer:!0},!0)||(e._resetErr(),!1)}},{key:"checkPDFProductKeyWhenNeeds",value:function(t,n){if(n==e.DWT.EnumDWT_ImageType.IT_PDF||n==e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF){var i;if(r.product.bHTML5Edition?t.__addon&&t.__addon.PDF&&(i=t.__addon.PDF.GetConvertMode()):t.Addon&&t.Addon.PDF&&(i=t.Addon.PDF.GetConvertMode()),1==i||4==i)return this.checkProductKey(t,{PDFRasterizer:!0},!0)}return Ve}},{key:"getPublicLicenseContent",value:function(e){var t=[],n=e;if(!r.isString(n)){if(r.isUndef(n))return"";n=n instanceof Error||"message"in n?n.message:""+n}var i=n.indexOf("["),o=n.indexOf("]",i),a=n.indexOf("(",o),s=n.indexOf(")",a);if(-1==i||-1==o||-1==a||-1==s)return n;i>0&&t.push(n.substring(0,i));var u=n.substring(i+1,o),c=n.substring(a+1,s);return t.push(['<a href="',c,'" target="_blank" class="dynamsoft-major-color">',u,"</a>"].join("")),t.push(n.substring(s+1)),t.join("")}},{key:"getLTSLicense",value:function(){return e.Lib.product.bPublicLTS?"":e.Lib.product.handshakeCode||e.Lib.product.organizationID}}]),t}();function to(e){var r,t,n=e,i=e.indexOf("-"),o=-1!=i;return t={},o&&(n=e.substring(0,i)),r=Number(n),isNaN(r)||String(Number(r))!==n||(o?t.handshakeCode=e:t.organizationID=e,t.LTS=Ve),t}function no(e){gn({_pLoad:{isEmpty:Ve},_license:e,_licenseServer:[]})}function io(e,t){var n=!0;if(r.isArray(e)&&e.length>0){var i=e[0];r.isString(i)&&""!=i&&-1==i.indexOf("https://mlts.dynamsoft.com")&&(n=!1)}return n&&(!t||"200001"===t||r.startsWith(t,"200001-"))}function oo(e,r,t){return this.checkOSForAllowCore(e,r,t)}function ao(t,o,a,s,u){var c;if(o&&o.LTS){if(!o||!r.isArray(o.Detail)||0==o.Detail.length)return this.isLTS()?r.Errors.LicenseNoCore(t,a):r.Errors.LicenseEmptyOrInvalid(t),Be}else if(!o||!r.isArray(o.Detail)||0==o.Detail.length)return this.isLTS()?r.Errors.LicenseNoCore(t,a):r.Errors.LicenseEmptyOrInvalid(t),Be;var l,d,f,h,g=0,p=0,m=[],_=[],v=Be,y=Be,I=Be,S=Be,T=Be;if(!this.isBindDomainOK(o.Domain))return r.Errors.LicenseBadDomain(t),Be;for(o.Detail.length>0&&(c="FALSE"!=(f=o.Detail[0]).Trial),d=1;d<o.Detail.length;d++)if("FALSE"==(f=o.Detail[d]).Trial&&c||"TRUE"==f.Trial&&!c)return r.Errors.LicenseTrialFullMixed(t),Be;if(o.bTrial=c,s.Core||s.Webcam){var b,E=[],C=!1;for(d=0;d<o.Detail.length;d++)if(f=o.Detail[d],h=Vi(this,Qi,uo).call(this,f.EnumLicenseType,f.LicenseType),s.Core&&h.Core&&this.checkOSForAllowCore(a,f.OS,t)||s.Core&&h.Core&&r.product.bActiveXEdition&&h.ActiveX||s.Webcam&&h.Webcam&&!a){if(o.LTS);else if(h.Webcam);else if(!r.isString(f.Version)||0!=f.Version.indexOf(Gi)){E.push(f);continue}if(r.product.bHTML5Edition){if(h.ActiveX&&!h.Html5)continue;_.push(f)}else{if(!h.ActiveX&&h.Html5)continue;_.push(f)}C=!0}if(!C&&E.length>0)return E.splice(0),b=[n,i].join("."),r.Errors.LicenseVersionNotCurrent(t,b),!1;E.splice(0)}else _=o.Detail;for(d=0;d<_.length;d++){var w=Ve;if(f=_[d],h=Vi(this,Qi,uo).call(this,f.EnumLicenseType,f.LicenseType),s.Core&&h.Core||this.isAllowLicenseType(h,s)){l=f.ExpireDate.replace(/-/g,"/");var k="FALSE"!=f.Trial;if(this.isExpiredOrFuture(l,k))m.push(l);else if(k&&h.Core&&this.willTrialExpire(l)&&(o.ExpireDate=l),o.LTS||h.Core&&r.product.bHTML5Edition&&parseInt(f.Version)>=ji||h.Core&&r.product.bActiveXEdition||!h.Core){var D=!1;if(h.Core)(this.checkOSForAllowCore(a,f.OS,t)||r.product.bActiveXEdition&&h.ActiveX)&&(D=!0);else{var x=a;s.Camera&&(x=!0),Vi(this,Ji,oo).call(this,x,f.OS,t)&&(D=!0)}D?this.isBrowserOK(f.Browser)||u?(g++,w=Be):y=Ve:s.Core?v=Ve:s.PDFRasterizer?S=Ve:(s.Webcam||s.Camera)&&(T=Ve)}else I=Ve;w&&p++}}if(g>0)return Ve;if(0==p)return this.setNoAllowedLicenseTypeError(t,a,s),Be;if(m.length>0){var P,F=0,W=1e20,A="",R=(new Date).getTime();for(l="",d=0;d<m.length;d++)(P=vo(m[d])).getTime()<R&&P.getTime()>F?(F=P.getTime(),l=m[d]):P.getTime()>R&&P.getTime()<W&&(W=P.getTime(),A=m[d]);return""!=l?(P=vo(l),l=this.getLicenseDateString(P),r.Errors.LicenseExpired(t,l)):""!=A?(P=vo(A),A=this.getLicenseDateString(P),r.Errors.LicenseIsFuture(t,A)):r.Errors.LicenseExpired(t,""),Be}if(I)return r.Errors.LicenseLower(t),Be;var O=e.navInfoSync;return y?(O.bEdge?r.Errors.LicenseNoEdge(t):O.bChrome?r.Errors.LicenseNoChrome(t):O.bFirefox?r.Errors.LicenseNoFirefox(t):O.bIE?r.Errors.LicenseNoIE(t):O.bSafari?r.Errors.LicenseNoSafari(t):r.Errors.LicenseNotSupportBorwser(t),Be):v?(this.setNoAllowedLicenseTypeError(t,a,{Core:!0}),Be):S?(this.setNoAllowedLicenseTypeError(t,a,{PDFRasterizer:!0}),Be):T?(this.setNoAllowedLicenseTypeError(t,a,{Webcam:!0}),Be):(r.Errors.LicenseEmptyOrInvalid(t),Be)}function so(e){var t=Be,n=Be,i=Be,o=Be,a=Be,s=Be,u=Be,c=Be,l=Be;return r.isString(e)&&""!=e&&r.each(e.split(";"),(function(e){var r=1*e;r==Hi.HTML5||r==Hi.WinMacLinux||r==Hi.ActiveX||r==Hi.Plugin?t=Ve:r==Hi.Barcode1D?n=Ve:r==Hi.QR?i=Ve:r==Hi.PDF417?o=Ve:r==Hi.DataMatrix?a=Ve:r==Hi.OCR?s=Ve:r==Hi.Webcam?u=Ve:r==Hi.PDFRasterizer?c=Ve:r==Hi.OCRPro&&(l=Ve)})),{Core:t,PDFRasterizer:c,Webcam:u,barcode1D:n,QR:i,PDF417:o,DataMatrix:a,OCR:s,OCRPro:l}}function uo(e,t){var n=Vi(this,Zi,so).call(this,e),i=Vi(this,$i,co).call(this,t);return r.each(["Core","Html5","ActiveX","PDFRasterizer","Webcam","barcode1D","QR","PDF417","DataMatrix","OCR","OCRPro"],(function(e){n[e]=n[e]||i[e]})),n}function co(e){var r=Be,t=Be,n=Be,i=Be,o=Be,a=Be,s=Be,u=Be,c=Be,l=Be,d=Be;return e&&""!=e&&("html5;activex;oldie"==(e=e.toLowerCase())?(i=Ve,r=Ve):"html5;activex"==e?(t=Ve,i=Ve,r=Ve):e.indexOf("html5")>-1||"win=(aph) or mac=(ph) or linux(h)"==e?(t=Ve,r=Ve):"1d barcode reader"==e?n=Ve:"2d barcode reader(qrcode)"==e?o=Ve:"2d barcode reader(pdf417)"==e?a=Ve:"2d barcode reader(data matrix)"==e?s=Ve:"ocr"==e?u=Ve:"webcam"==e?c=Ve:"pdf rasterizer"==e?l=Ve:"proocr"==e&&(d=Ve)),{Core:r,Html5:t,ActiveX:i,PDFRasterizer:l,Webcam:c,barcode1D:n,QR:o,PDF417:a,DataMatrix:s,OCR:u,OCRPro:d}}function lo(e){var r=e.toLowerCase();return r.indexOf("wasm")>-1||r.indexOf("mobile")>-1}function fo(e,r){return ho.apply(this,arguments)}function ho(){return(ho=ne(de.mark((function t(n,i){var o;return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.License.isLTS()){t.next=2;break}return t.abrupt("return");case 2:if(t.prev=2,e.DWT.li({instanceMode:e.DWT.EnumInstance.dwt_desktop},"")){t.next=17;break}return i&&Pi(e.MSG.Init_GetMachineID),t.prev=6,t.next=9,Sn();case 9:return o=t.sent,t.next=12,go(o);case 12:t.next=17;break;case 14:t.prev=14,t.t0=t["catch"](6),r.log(t.t0);case 17:t.next=22;break;case 19:t.prev=19,t.t1=t["catch"](2),r.log(t.t1);case 22:case"end":return t.stop()}}),t,null,[[2,19],[6,14]])})))).apply(this,arguments)}function go(e){return po.apply(this,arguments)}function po(){return(po=ne(de.mark((function t(n){var i;return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=7;break}if(!(r.isArray(n.result)&&n.result.length>3)){t.next=5;break}i=n.result[3],t.next=7;break;case 5:if(!n.description){t.next=7;break}return t.abrupt("return",{code:n.exception,message:n.description});case 7:r.isString(i)&&""!=i&&(e.DWT.lsmid(i,""),e.DWT.lsmid2b(i));case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function mo(e,r,t,n){return _o.apply(this,arguments)}function _o(){return(_o=ne(de.mark((function t(n,i,o,a){var s,u,c,l,d;return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Zn("getLicenseInfo",n),t.prev=1,!r.License.isLTS()){t.next=19;break}if(u="",c="",""!=o){t.next=9;break}return l=!!a,n&&(l=n._bRemoteMode),t.next=9,fo(l);case 9:return t.next=11,wi(e.DWT.EnumInstance.dwt_desktop,o);case 11:return d=t.sent,c=d.ar,u=d.cu,t.next=16,i.getLicenseInfo(c,u,a);case 16:s=t.sent,t.next=22;break;case 19:return t.next=21,i.getLicenseInfo(e.DWT.ProductKey,"",a);case 21:s=t.sent;case 22:t.next=27;break;case 24:throw t.prev=24,t.t0=t["catch"](1),t.t0;case 27:return t.prev=27,Qn("getLicenseInfo"),t.finish(27);case 30:return t.abrupt("return",s);case 31:case"end":return t.stop()}}),t,null,[[1,24,27,30]])})))).apply(this,arguments)}function vo(e){var r,t=e;return t=t.replace(/-/g,"/"),r=Date.parse(t),isNaN(r)&&(r=0),(r=new Date(r)).setHours(23,59,59,999),r}r.License=new ro,e.DWT.isPublicLicense=function(){return e.Lib.product.bPublicLTS};var yo,Io=e.navInfoSync,So=!0,To=!1,bo=Io.bHTML5Edition,Eo=0,Co=To;Io.bIE&&(""===(Eo=Io.IEVersion)||Eo>=10?0==e.DWT.IfUseActiveXForIE10Plus?bo=So:(bo=To,Co=So,Io.bHTML5Edition=bo):(bo=To,Eo>=9&&(Co=So))),Co||bo||(bo=So),(yo={name:"Dynamic Web TWAIN",bHTML5Edition:bo,bActiveXEdition:Co,_iImageCaptureDriverType:3,_iBrokerProcessType:1,getChromeEditionPath:e.dcp.getDSPath,getPKGPath:function(){return e.DWT.ResourcesPath+"/dist/mac/DynamicWebTWAINMacEdition.pkg"},getMSIPath:function(){return e.DWT.ResourcesPath+"/dist/win/DynamicWebTWAINPlugIn.msi"},getActiveXCABx86Path:function(){return e.DWT.ResourcesPath+"/dist/win/ActiveX/DynamicWebTWAIN.cab"},getActiveXCABx64Path:function(){return e.DWT.ResourcesPath+"/dist/win/ActiveX/DynamicWebTWAINx64.cab"},onlineResources:"https://demo.dynamsoft.com/DWT/Resources/",strMIMEType:"Application/DynamicWebTwain-Plugin",strFullClassID:"E7DA7F8D-27AB-4EE9-8FC0-3FEC9ECFE758",scripts:{},dwtConfigLoaded:!1,dwtConfigLoading:!1,getServerVersionInfo:function(r){var t=e.DWT.ServerVersionInfo;return Io.bWin||(Io.bMac?t=e.DWT.ServerMacVersionInfo:(Io.bLinux||Io.bAndroid||Io.bChromeOS||Io.bHarmonyOS)&&(t=e.DWT.ServerLinuxVersionInfo)),r?t:e.Lib.replaceAll(t,",","")},getDWTVersionInfoVer:function(){return"".concat(n,"000000")},getDWTPrefix:function(){return!0===e.DWT.CustomMode?"dwtc_":"dwt_"},loadResourcePath:!1,loadingResourcePath:!1,handshakeCode:undefined,organizationID:undefined,licenseServer:undefined,sessionPassword:"",bPublicLTS:!0,refProductKey:undefined,ltsDebug:!1,bDWTLoading:!1,bAndroidConnected:!1,unloadQueue:[],appendBrowserLicenseWhenServiceMode:function(){},CustomizableDisplayInfo:d,bFullEdition:!1,dwtVersionInfo:"",hostForCheckCert:"127.0.0.1",RemoteReconnectMaxTimes:200,RemoteReconnectTimeSpan:5e3,LocalReconnectMaxTimes:60,LocaleReconnectTimeSpan:3e3}).bChromeEdition=yo.bHTML5Edition;var wo=yo,ko=e.navInfoSync,Do=ko.bWin,xo=ko.bMac,Po=ko.bLinux,Fo=ko.bSafari,Wo=ko.bFirefox,Ao=ko.bChrome,Ro=location.hostname,Oo=location.pathname,Lo=0,No=ko.bMobile,Mo=parseFloat(ko.strBrowserVersion);if(ko.bWin||ko.bMac||ko.bLinux||ko.bChromeOS){if(e.navInfo){var Uo=e.navInfo;No=No||Uo.bAndroid||Uo.bPad||Uo.biPhone||Uo.biPad}}else No=!0;""===Ro?Do&&Oo.lastIndexOf("\\")>1?Oo=Oo.substring(1,Oo.lastIndexOf("\\")).replace(/%20/g," "):(Lo=1,Oo=Oo.substring(1,Oo.lastIndexOf("/")).replace(/%20/g," ")):(Lo=1,Oo=Oo.substring(0,Oo.lastIndexOf("/")));var Bo={bChrome:Ao,bFirefox:Wo,bSafari:Fo,bIE:ko.bIE,bEdge:ko.bEdge,bWin:Do,bMac:xo,bLinux:Po,iPluginLength:0,bFileSystem:ko.bFileSystem,bMobile:No,strIEVersion:ko.IEVersion,strChromeVersion:ko.bChrome?Mo:"",strFirefoxVersion:ko.bFirefox?Mo:"",basePath:Oo,pathType:Lo,isDesktopViewer:function(){return e.navInfoSync.bWin||e.navInfoSync.bLinux||e.navInfoSync.bChromeOS||e.navInfoSync.bMac},isPadViewer:function(){return e.navInfoSync.bPad||e.navInfoSync.biPad},isMobileViewer:function(){return e.navInfoSync.bMobile||e.navInfoSync.biPhone||e.navInfoSync.bAndroid||e.navInfoSync.bHarmonyOS}},Vo={getHex:function(e){var r=Number(e).toString(16).toUpperCase();return 1==r.length&&(r=["0",r].join("")),r},getColor:function(e){var r,t,n;return n=e>>16,t=(65280&e)>>8,r=255&e,["#",Vo.getHex(n),Vo.getHex(t),Vo.getHex(r)].join("")},RGB2BGR:function(e){return(255&e)<<16|65280&e|e>>16}};Vo.BGR2RGB=Vo.RGB2BGR;var Go=document.location.protocol,jo=location.hostname,Ho=e.navInfoSync.bSSL;r.env=Bo,r.product=wo,r.mix(r,Vo),r.BIO=sn,e.MSG={Loading:"Processing...",LoadingTiff:"Processing tiff...",LoadingPdf:"Processing pdf...",Encoding:"Processing...",ConvertingToBlob:"Converting to blob...",ConvertingToBase64:"Converting to base64...",SavingPdf:"Saving pdf...",SavingTiff:"Saving tiff...",Downloading:"Downloading...",Uploading:"Uploading...",Init_LoadingConfigJs:"Loading the config script...",Init_LoadingCss:"Loading css...",Init_LoadingViewerJs:"Loading the viewer script...",Init_AllJsLoaded:"All scripts and css loaded.",Init_UnLoad:"Unload...",Init_CheckProductKeyFormat:"Checking Product Key format...",Init_ParseProductKey:"Parsing Product Key...",Init_InitDynamsoftService:"Initializing the service...",Init_CheckEnhancedMode:"Checking the service enhanced module...",Init_GetDWTPort:"Getting the WebTwain port...",Init_CheckDWT:"Checking the WebTwain module...",Init_CheckDWTVersion:"Checking the WebTwain version...",Init_DWTVersionOK:"Check the WebTwain version successfully.",Init_DWTVersionFailed:"The WebTwain version not compatible.",Init_GetMachineID:"Getting Machine ID.",Init_CreatingDWTFromContainers:"Creating WebTwain from Dynamsoft.DWT.Containers...",Init_CreatingDWT:"Creating a WebTwain instance...",Init_ChangeDWTMap:"Changing Map...",Init_ConfiguringDWT:"Configuring the WebTwain instance...",Init_SetLicenseForDWT:"Activating the WebTwain instance...",Init_DecodingLicenseForDWT:"Decoding the license...",Init_CheckingLicense:"Checking the license...",Err_ServiceModeNotSupportMobile:"Service Mode does not support your Operating System. Please contact the site administrator."};var zo={config:{debug:Be,devMode:Be,bDiscardBlankImage:Be,msg:[],msgPrefix:'<span style="color:#cE5E04"><b>',msgSuffix:"</b></span><br />"},detect:{ssl:Ho,dcpStatus:0,dcpCallbackType:0,arySTwains:[],bFirst:Ve,bOK:Be,__dialog:Be,cssLoaded:Be,viewerScriptLoaded:Be,bNoControlEvent:Be,bNeedUpgradeEvent:Be,bPromptJSOrServerOutdated:Be,detectType:Ho?1:"http:"===Go||""===jo?0:-1,tryTimes:0,ports:[{port:e.DWT.SSLPort,ssl:Ve},{port:e.DWT.Port,ssl:Be}],cUrlIndex:0,urls:[],onNoControl:Be,needUpgrade:Be,OnDetectNext:Be,OnCreatWS:Be,bMaskShow:Be,showMask:qn,hideMask:Xn},page:{bUnload:Be,OnUnload:Be},tmp:{IfAllowLocalCache:Ve,EmptyFunction:function(){}}};function Ko(t){var n=e.DWT.licenseException;n.code=t.code,n.message=t.message,r.isFunction(e.DWT.OnWebTwainError)?e.DWT.OnWebTwainError(t):r.isFunction(window.Dynamsoft_OnError)&&window.Dynamsoft_OnError(t),t&&(t instanceof Error?r.error(t):r.error(r.stringify(t)))}function qo(e){return e==K.LicenseExpiredForDLS||e==K.LicenseNoCoreForDLS||e==K.LicenseNoCore||e==K.LicenseInvalid||e==K.LicenseExpired||e==K.LicenseParseFailed||e==K.LicenseIsFuture||e==K.LicenseVersionNotCurrent}function Xo(e){return e==K.LicenseExpired}zo.appendMessage=function(r){"string"==typeof r?zo.config.msg.push(r):"[object Array]"===Object.prototype.toString.call(r)&&e.Lib.each(r,(function(e){zo.appendMessage(e)}))},zo.appendRichMessage=function(e){zo.appendMessage([zo.config.msgPrefix,e,zo.config.msgSuffix])},zo.clearMessage=function(){return zo.config.msg.splice(0),Ve},zo.getRealPath=function(e){return e===undefined?"":1==zo.env.pathType?zo.env.basePath+e:zo.env.basePath+e.replace(new RegExp("/","g"),"\\\\")},zo.isLocalIP=function(e){return e===undefined||e&&("127.0.0.1"===e||"localhost"===e||"local.dynamsoftwebtwain.com"===e||"local.dynamsoft.com"===e)},zo.getShadowRoot=function(e){var r=e,t=window;if(t.ShadowRoot)for(;r;){if(r instanceof t.ShadowRoot)return r;r=r.parentNode}return!1},zo.isShadowRoot=function(e){var r=window;return!!(r.ShadowRoot&&e instanceof r.ShadowRoot)},r.mix(r,zo),r.Addon_Events=[],r.Addon_Sendback_Events=[];var Jo=e.DWT;Jo.CloseDialog=function(){var e=r.install._dlgInstall;if(e){var t=r.all(".dynamsoft-dialog-close");r.each(t,(function(e,t){r.removeEventListener(e,"click",Jo.CloseDialog)})),e.open&&e.close(),document.body.removeChild(e),r.install._dlgInstall=!1}},Jo.ShowDialog=function(e,r,t,n,i){if(!1!==t){var o,a={width:e,height:r,position:"absolute"};n?(o=['<div class="dynamsoft-dwt-dialog-body">',t,"</div>"].join(""),a.closeButton=!1):o=['<div class="ds-dwt-ui-showdlg">','<div class="dynamsoft-dwt-dialog-body">','<div class="dynamsoft-dwt-dlg-header">',i?"":'<div class="dynamsoft-dialog-close"></div>',"</div>",t,"</div>","</div>"].join(""),i&&(a.closeButton=!1),Jo.ShowMessage(o,a)}},Jo.ShowMessage=function(t,n){var i,o,a,s,u,c=r.install,l="ds-dwt-ui-dlg",d="ds-dwt-ui-dlg-wrap",f=screen.width,h=!0,g=0,p=!0,m=!0,_=0,v="fixed",y="Error",I=r.product.bActiveXEdition,S=!1,T=null;if(n&&(i=n.width,o=n.height,n.seconds&&(g=n.seconds),n.headerStyle&&(_=n.headerStyle),1==n.backgroundStyle&&(S=!0),!1===n.closeButton&&(p=!1),n.bAutoClose&&(a=n.bAutoClose,p=!0),0==n.bReadyClosed&&(h=!1),n.position&&(v=n.position),n.caption&&(y=n.caption),r.isFunction(n.onClose)&&(T=n.onClose)),i?i>f-10&&(i=f-10):i=f>600?600:f-10,o||(o="100%"),1==_?t=['<div class="dynamsoft-dialog">','<div class="dynamsoft-dwt-dialog-body">','<div class="dynamsoft-dwt-dlg-header">',p?'<div class="dynamsoft-dialog-close"></div>':"","</div>",t,"</div></div>"].join(""):2==_&&(t=['<div class="dynamsoft-dialog">','<div class="dynamsoft-dwt-ltsdlg-header"><span style="color:#FFF;line-height:35px;margin-left:15px">',y,"</span>",p?'<div class="dynamsoft-dialog-close"></div>':"","</div>",'<div class="dynamsoft-dwt-ltsdlg-body" style="padding:25px 50px 20px 50px;">',t,"</div></div>"].join("")),0==r.one("."+l).length){var b=document.createElement("div"),E=document.createElement("div"),C=document.createElement("div");if(b.className=l,E.className=d,E.style.margin="auto",E.style.zIndex="9999",E.style.position="relative",E.style.border="0",a&&((s=document.createElement("div")).className="dynamsoft-dialog-close",E.insertBefore(s,E.firstElementChild),(u=document.createElement("div")).className="dynamsoft-dialog-closeTimer",u.style.width="100%",u.style.height="2px",u.style.marginTop="-2px",u.style.backgroundColor="#fe8e14",E.insertBefore(u,E.firstElementChild)),E.appendChild(C),C.innerHTML=t,b.appendChild(E),document.body.appendChild(b),T){var w=r.one(".dynamsoft-dialog-close",r.one(b));w&&((w=w[0]).onClose=function(){r.removeEventListener(w,"click",w.onClose),w.onClose=null,T()},r.addEventListener(w,"click",w.onClose))}if(S?r.setBackOpacity({opacity:.4,grayHex:0}):r.setBackOpacity({}),c._dlgInstall=b,r.dialog.setup(c._dlgInstall,!1),e.navInfoSync.bIE){var k=document.createElement("iframe");k.frameborder="0",k.marginheight="0",k.marginwidth="0",k.style.border="0",k.style.backgroundColor="transparent",k.style.position="absolute",k.style.left=0,k.style.top=0,k.style.width="100%",k.style.height=document.body.clientHeight+"px",k.style.margin="0 auto",k.style.zIndex="10000",k.src=["javas","cript:",'""'].join("");var D=r.one(".dynamsoft-backdrop");D&&D.length>0&&(D[0].innerHTML="",D[0].appendChild(k))}}else m=!1;var x=r.one("."+d);if(x&&x.getEL()&&(x[0].style.width=i+"px",r.isNumber(o)&&o>0?x[0].style.height=o+"px":x[0].style.height="100%",m||r.each(x[0].childNodes,(function(e){if("DIV"==e.tagName&&"dynamsoft-dialog-close"!=e.className&&"dynamsoft-dialog-closeTimer"!=e.className)return e.innerHTML=t,!1}))),I){var P=r.one(".dynamsoft-dialog");P&&P.getEL()&&(P.getEL().style.border="1px solid #999")}if(c._dlgInstall.open&&c._dlgInstall.close(),c._dlgInstall.showModal({position:v}),c._dlgInstall.bReadyClosed=h,S&&r.setBackOpacity({}),p){var F=r.all(".dynamsoft-dialog-close");r.each(F,(function(e,t){r.addEventListener(e,"click",Jo.CloseDialog)})),F.length>0&&a&&g>0&&setTimeout(r._zdgb_xkz_dhk,100)}},Jo.OnWebTwainPreExecute||(Jo.OnWebTwainPreExecute=function(t,n){var i,o,a=e.DWT.IfConfineMaskWithinTheViewer;if(a&&(t&&(o=t._containerElement),o||e.DWT.Containers&&e.DWT.Containers.length>0&&e.DWT.Containers[0].ContainerId&&(o=e.Lib.get(e.DWT.Containers[0].ContainerId)),o)){i=o.getBoundingClientRect();for(var s=0;s<o.children.length;s++){var u=o.children[s];if(u&&"dvs-root dvs-web-viewer"==u.className){for(u=u.firstElementChild;u;){if(r.isFunction(u.getBoundingClientRect)){i=u.getBoundingClientRect();break}u=u.nextSibling}o=u;break}}}(o===document.body||i==undefined||e.DWT.Containers&&e.DWT.Containers.length>1||e.DWT.Containers&&1==e.DWT.Containers.length&&(0==i.width||0==i.height))&&(a=!1,o=null);var c=null!=n?n:{};a&&(c={confined:a,wrapperEl:o}),r.showMask(c)}),Jo.OnWebTwainPostExecute||(Jo.OnWebTwainPostExecute=r.hideMask);function Yo(t){var n=0,i=t.message;r.isNumber(t.code)?n=t.code:r.isString(i)&&(n=-1),0!=n&&function(t,n){r.isFunction(e.OnLicenseError)&&e.OnLicenseError(n,t)}(n,i)}function Zo(e){Yo(We(e))}window.DCP_DWT_OnClickCloseInstall=function(r,t){var n=e.Lib;t||e.DWT.CloseDialog();var i=n.get(n.install._divDWTNonInstallContainerID);if(i&&i.parentNode&&i.parentNode.removeChild(i),r&&n.isDOM(r)&&n.show(r),r&&n.isString(r))n.show(r);else{var o=e.DWT.WebTwainIdMap;if(o){var a,s,u=Object.keys(o);for(a=0;a<u.length;a++)o[s=u[a]]._containerElement&&n.show(o[s]._containerElement)}}""!=n.install._divDWTemessageContainer&&n.show(n.install._divDWTemessageContainer)};var Qo=!0;function $o(){if(Qo){var t=e.DWT.CustomizableDisplayInfo,n={};r.mix(n,d),t&&(t.loaderBarClassName&&(n.loaderBarClassName=t.loaderBarClassName),t.loaderBarSource&&(n.loaderBarSource=t.loaderBarSource),t.loaderBarWidth&&(n.loaderBarWidth=t.loaderBarWidth),t.loaderBarHeight&&(n.loaderBarHeight=t.loaderBarHeight),t.errorMessages&&r.mix(n.errorMessages,t.errorMessages),t.generalMessages&&r.mix(n.generalMessages,t.generalMessages),t.customProgressText&&r.mix(n.customProgressText,t.customProgressText),t.buttons&&(t.buttons.titles&&r.mix(n.buttons.titles,t.buttons.titles),t.buttons.bShowAllButtons&&r.mix(n.buttons.bShowAllButtons,t.buttons.bShowAllButtons),t.buttons.visibility&&r.mix(n.buttons.visibility,t.buttons.visibility)),t.dialogText&&r.mix(n.dialogText,t.dialogText)),e.Lib.product.CustomizableDisplayInfo=n,xi(),Qo=!1}}r._funsAfterConfigLoaded=[],r._safePromptCustomMsg=function(e){r.product.loadResourcePath?($o(),e&&e()):e&&r._funsAfterConfigLoaded.push(e)};var ea,ra=e.navInfoSync;function ta(){var t=l;if(e.DWT.CertificateConfig){var n=e.DWT.CertificateConfig;r.isString(n.URL)||(n.URL=t.URL),(!r.isNumber(n.UpdateDaysBeforeExpired)||n.UpdateDaysBeforeExpired<=0)&&(n.UpdateDaysBeforeExpired=t.UpdateDaysBeforeExpired)}else e.DWT.CertificateConfig=t;r.isString(e.DWT.ProductKey)&&(e.DWT.ProductKey=r.trim(e.DWT.ProductKey)),e.navInfo&&(e.navInfoSync.bMac||e.navInfoSync.bWin)&&(e.navInfo.bEmbed=!1,e.navInfo.bArm64=!1,e.navInfo.bMips64=!1),e.DWT.Debug&&(r.debug=!0)}function na(){if(r.detect.cssLoaded)return r.Promise.resolve();var t=e.DWT.ResourcesPath,n="";ra.bFileSystem||(n=r.timestamp);var i=[[t,"/src/dynamsoft.webtwain.css",n].join("")];return r.product.bHTML5Edition&&e.DWT.UseDefaultViewer&&i.push([t,"/src/dynamsoft.webtwain.viewer.css",n].join("")),new r.Promise((function(t,n){var o=!0;e.navInfoSync.bSafari?(r.addAllCss(i,!1,(function(e){if(!e&&o){var t=r.Errors.CssLoadFailed();n(t),o=!1}})),r.detect.cssLoaded=Ve,t()):r.addAllCss(i,!1,(function(e){if(e)return r.detect.cssLoaded=Ve,void t();if(o){o=!1;var i=r.Errors.CssLoadFailed();n(i)}}))}))}function ia(){if(r.product.loadResourcePath||!r.product.loadingResourcePath)return ea&&ea(),void(ea=null);setTimeout(ia,100)}function oa(t){if(Pi(e.MSG.Init_LoadingCss),ta(),r.product.loadResourcePath||r.product.loadingResourcePath)return r.product.loadResourcePath?na():r.product.loadResourcePath||!r.product.loadingResourcePath?r.Promise.resolve():(ea=null,new r.Promise((function(e){ea=e,setTimeout(ia,100)})));r.product.loadingResourcePath=!0,(e.DWT.Port>0||e.DWT.SSLPort>0)&&(r.detect.ports=[{port:e.DWT.Port,ssl:!1},{port:e.DWT.SSLPort,ssl:!0}],r.LS.removeItem("DWT_port"),r.LS.removeItem("DWT_ssl")),$o(),r._safePromptCustomMsg(),r.each(r._funsAfterConfigLoaded,(function(e){try{r.isFunction(e)&&e()}catch(t){}}));var n=r.one(".dynamsoft_waiting").getEL();n&&n.parentNode&&n.parentNode.removeChild(n);var i=e.DWT.ResourcesPath,o="";ra.bFileSystem||(o=r.timestamp);var a=Ve,s=[];return ra.bSafari&&(a=Be),s.push([i,"/dynamsoft.webtwain.install.js",o].join("")),e.DWT.bNpm&&(s=[]),r.product.bHTML5Edition&&e.DWT.UseDefaultViewer&&(Pi(e.MSG.Init_LoadingViewerJs),s.push([i,"/src/dynamsoft.webtwain.viewer.js",o].join(""))),na().then((function(){return new r.Promise((function(t,n){r.addScripts(s,a,!1,(function(i){var o=i;if(ra.bIE&&(r.product.bHTML5Edition?e.DWT.UseDefaultViewer&&!r.isFunction(e.DWTViewer)&&(o=!1):r.product.bActiveXEdition&&(r.isFunction(e.DWT._innerLoad)||(o=!1))),o){if(r.bNode||e.navInfoSync.bJSDom);else if(r.isArray(e.aryAddonReadyFun)){for(var a=0,s=function(){var t=e.aryAddonReadyFun[a];if(r.isFunction(t))try{t(r)}catch(n){r.log(n.stack||n,"error"),setTimeout((function(){throw n}),0)}};a<e.aryAddonReadyFun.length;a++)s();e.aryAddonReadyFun=[]}r.product.loadResourcePath=!0,r.product.loadingResourcePath=!1,e.DWT.OnWebTwainWillInit&&e.DWT.OnWebTwainWillInit(),t()}else{r.product.loadingResourcePath=!1;var u=r.Errors.JsLoadFailed();n(u)}}))}))}))}var aa=[],sa=[];function ua(){var e,r=aa.length;for(e=0;e<r;e++)aa[e]();aa.splice(0),sa.splice(0),da=0}function ca(){if(da>0&&(new Date).getTime()-da>la){var t,n=r.Errors.ConfigLoadTimedout(),i=e.DWT.Containers;i&&0!==i.length||(t={},r.Errors.ContainersNotSet(t),n={code:t._errorCode,message:t._errorString}),function(e){var r,t=sa.length;for(r=0;r<t;r++)sa[r](e);aa.splice(0),sa.splice(0),da=0}(n)}else if(e.DWT.Containers||e.DWT.ProductKey){if(r.product.dwtConfigLoading)return;if(r.product.dwtConfigLoaded)return void ua();r.product.dwtConfigLoading=!0;var o=ra.bFileSystem,a=r.env.basePath,s=e.DWT.ResourcesPath,u="";if(r.isArray(e.DWT.Containers)||(e.DWT.Containers=[]),!o){void 0!==s&&""!=s||(s=a),s.length>0&&"/"==s.charAt(s.length-1)&&(s=s.substr(0,s.length-1)),u=r.timestamp,e.DWT.ResourcesPath=s}if(ra.bIE){var c=ra.IEVersion;if((""===c||c>=10)&&e.DWT.IfUseActiveXForIE10Plus){var l=Be;ra.bHTML5Edition=l,r.product.bHTML5Edition=l,r.product.bActiveXEdition=!l,r.product.bChromeEdition=r.product.bHTML5Edition}}r.product.bActiveXEdition?r.addScript([s,"/src/dynamsoft.webtwain.activex.js",u].join(""),!0,!1,(function(){r.product.dwtConfigLoaded=!0,r.product.dwtConfigLoading=!1,ua()})):(r.product.dwtConfigLoaded=!0,r.product.dwtConfigLoading=!1,ua())}else setTimeout(ca,100)}var la=3e3,da=0;function fa(t){return Pi(e.MSG.Init_LoadingConfigJs),r.product.dwtConfigLoaded?r.Promise.resolve():(t&&(la=1e3*parseInt(t))<1&&(la=1),new r.Promise((function(e,t){aa.push(e),sa.push(t),r.domReady((function(){da=(new Date).getTime(),setTimeout(ca,100)}))})))}function ha(){var t;(t=e.DWT.WebTwainIdMap)&&r.each(t,(function(e,r){e&&e._OnPageBlur&&e._OnPageBlur()}))}if(r.product.bActiveXEdition){var ga=function(){var t,n,i,o,a;if(e.DWT.lunload(),r.closeAll&&r.closeAll(),o=e.DWT.ContainerMap)for(a=Object.keys(o),t=0;t<a.length;t++)(i=a[t])&&i in o&&(n=o[i])&&(n.__unload(),delete o[i]);if(o=e.DWT.WebTwainIdMap)for(a=Object.keys(o),t=0;t<a.length;t++)(i=a[t])&&i in o&&(n=o[i])&&(n.__unload(),delete o[i]);for(t=0;t<r.product.unloadQueue.length;t++){var s=r.product.unloadQueue[t];r.isFunction(s)&&s()}return r.product.unloadQueue.splice(0),r.detect.arySTwains.splice(0),r.Promise.resolve()},pa=!1;e.DWT.Unload=function(){ga();try{r.closeLoadingMsg(),e.DWT.CloseDialog(),r._zdgb_xkz_dhk(),r.closeProgress(null,""),r.hideMask()}catch(AA){}},e.DWT.Load=function(){if(!r.product.bDWTLoading)return r.product.bDWTLoading=true,r.openLoadingMsg(),r.detect.axAutoLoadDone=!1,fa().then(oa).then(ga).then((function(){return e.DWT._innerLoad()})).then((function(){r.product.bDWTLoading=!1,r.detect.axAutoLoadDone=!0,r.closeLoadingMsg()}),(function(e){r.product.bDWTLoading=!1,r.detect.axAutoLoadDone=!1,r.closeLoadingMsg(),Ko(e)}))},e.DWT.ConnectToTheService=e.DWT.Load,e.DWT.CheckConnectToTheService=function(e,t,n,i){r.product.bActiveXEdition?r.isFunction(i)&&i():r.isFunction(n)&&n()},e.DWT.CreateDWTObject=function(t,n,i,o,a,s){return r._safePromptCustomMsg((function(){s&&s(e.Lib.product.CustomizableDisplayInfo.errorMessages.ERR_BROWSER_NOT_SUPPORT)})),pa},e.DWT.CreateDWTObjectEx=function(t,n,i){return r._safePromptCustomMsg((function(){i&&i(e.Lib.product.CustomizableDisplayInfo.errorMessages.ERR_BROWSER_NOT_SUPPORT)})),pa},e.DWT.CreateRemoteScanObjectAsync=function(){var e={};return r.Errors.ActiveXNotSupport(e),r.Promise.reject({code:e._errorCode,message:e._errorString})},e.DWT.DeleteDWTObject=function(e){return pa}}function ma(t){var n=t||{};n.basePath&&(r.env.basePath=n.basePath),n.pathType&&(r.env.pathType=n.pathType),r.isUndefined(n.bDiscardBlankImage)||(r.config.bDiscardBlankImage=n.bDiscardBlankImage),n.msgPrefix&&(r.config.msgPrefix=n.msgPrefix),n.msgSuffix&&(r.config.msgSuffix=n.msgSuffix),n.detectType&&(r.detect.detectType=n.detectType),n.tryTimes&&(r.detect.tryTimes=n.tryTimes);var i=e.DWT.RemoteScanConfig;i||(i={sessionTimeout:300,keepAwake:!0},e.DWT.RemoteScanConfig=i),i.keepAwake===undefined&&(i.keepAwake=!0)}function _a(){return!!r.wakeLock.getWakeLock()}function va(e){return ya.apply(this,arguments)}function ya(){return(ya=ne(de.mark((function e(t){var n;return de.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.wakeLock.getWakeLock(),!t){e.next=7;break}if(null!=n){e.next=5;break}return e.next=5,r.wakeLock.toggle();case 5:e.next=10;break;case 7:if(!n){e.next=10;break}return e.next=10,r.wakeLock.toggle();case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ia(e){return Sa.apply(this,arguments)}function Sa(){return(Sa=ne(de.mark((function t(n){var i;return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n&&((i=document.createElement("style")).innerHTML=['@import url("',e.DWT.ResourcesPath,"/src/dynamsoft.webtwain.viewer.css",r.timestamp,'")'].join(""),n.appendChild(i));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}e.DWT.GetWebTwain=e.DWT.GetWebTwainEx=function(r){var t=r,n=e.DWT.WebTwainIdMap;if(!t){var i=Object.keys(n);return i.length>0?n[t=i[0]]:void 0}if(t in n)return n[t];var o=e.DWT.ContainerMap;return t in o?o[t]:void 0};var Ta=!0,ba=!1;function Ea(t){if(r.isUndefined(t))return ba;var n,i,o,a=t.toString().toLowerCase(),s=(o=a.toLowerCase().replace(r.product.name.toLowerCase()+" ",""),(o=r.replaceAll(o,"[.]",",")).split(","));n=r.product.bActiveXEdition?e.DWT.ActiveXVersion:r.product.getServerVersionInfo(!0),i=(n=r.replaceAll(String(n),"[.]",",")).split(",");for(var u=s.length>i.length?s.length:i.length,c=0;c<u;c++){if(null==s[c]&&(s[c]=0),null==i[c]&&(i[c]=0),parseInt(s[c])<parseInt(i[c]))return ba;if(parseInt(s[c])>parseInt(i[c]))return Ta}return Ta}function Ca(e,t){var n=e.split(","),i=t.split(",");return n.length>3&&r.trim(n[0])==i[0]&&(r.trim(n[1])>i[1]||r.trim(n[1])==i[1]&&r.trim(n[2])>i[2]||r.trim(n[1])==i[1]&&r.trim(n[2])==i[2]&&parseInt(r.trim(n[3]))>=parseInt(i[3]))}var wa,ka={isSupportLS:function(){var r=e.navInfoSync,t=!1;if(r.bEdge&&r.bFileSystem);else try{t=!!window.localStorage}catch(n){}return t},item:function(e,r,t){var n=null;return this.isSupportLS()?(r?(localStorage.setItem(e,r),n=r):n=localStorage.getItem(e),null===n?t:n):t},removeItem:function(e){return!!this.isSupportLS()&&(localStorage.removeItem(e),!0)}},Da=e.navInfoSync,xa=e.dcp,Pa=2,Fa=3;function Wa(e,t){r.isLocalIP(e)&&(r.LS.item("DWT_port",t),r.LS.item("DWT_ssl",Da.bSSL?"true":"false"))}function Aa(e,r,t,n){return Ra.apply(this,arguments)}function Ra(){return(Ra=ne(de.mark((function t(n,i,o,a){var s,u,c,l,d,f,h,g,p,m,_,v,y,I,S,T,b,E,C,w;return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.DWT.OnWebTwainInitMessage&&(s=e.Lib.product.CustomizableDisplayInfo.generalMessages.checkingDWTVersion,e.DWT.OnWebTwainInitMessage(s,P.Info)),c=!1,l=r.now(),d=['{"id":"',r.guid(),'","method":"VersionInfo","version":"',r.product.getDWTPrefix(),r.product.getDWTVersionInfoVer(),'"}'].join(""),f=!e.navInfoSync.bSSL,t.prev=4,!e.DWT.ConnectWithSocket){t.next=11;break}return t.next=8,pe.postStringDataByWSUrl(pe.getWsUrl(n,i),d);case 8:u=t.sent,t.next=18;break;case 11:return h="fa/VersionInfo?ts="+l,g=gt.getHttpClient(n,i,r.detect.ssl),p={},f&&(p.redirect="manual"),t.next=17,g.request(d,h,p,o);case 17:u=t.sent;case 18:t.next=37;break;case 20:if(t.prev=20,t.t0=t["catch"](4),r.log(t.t0),r.log(["check DWT Version failed",r.stringify(t.t0)]),!c){t.next=27;break}t.next=37;break;case 27:if(!f){t.next=31;break}if((t.t0&&t.t0.code)!=e.DWT.EnumDWT_Error.HTTPRedirected){t.next=31;break}throw r.Errors.HTSTError();case 31:throw m={},r.Errors.ERR_MODULE_NOT_INSTALLED(m),0,e.DWT.OnWebTwainInitMessage&&e.DWT.OnWebTwainInitMessage(m._errorString,P.Error),{code:m._errorCode,message:m._errorString};case 37:if(_="","",y={},I=!1,u&&(S=r.parse(u)),!S||!("result"in S)){t.next=72;break}if(S=S.result,!(r.isArray(S)&&S.length>0)){t.next=69;break}if(T=S[0],_=S.length>1?S[1]:"",b=S.length>2?S[2]:0,E=S.length>3?S[3]:"",v=S.length>4?S[4]:"",""!==_){t.next=66;break}if(C="The WebTwain version is: "+T,e.DWT.OnWebTwainInitMessage&&e.DWT.OnWebTwainInitMessage(C,P.Info),"32"==b&&r.isLocalIP(n)&&(e.dcp.b64bit=!1),r.isLocalIP(n)&&(e.DWT.li({instanceMode:e.DWT.EnumInstance.dwt_desktop},"")||""!=E&&(e.DWT.lsmid(E,""),e.DWT.lsmid2b(E))),r.isFunction(e.OnSSLCertInfo)&&(""!=v&&(w=Date.parse(v+"T00:00:00"),w=isNaN(w)?null:new Date(w)),e.OnSSLCertInfo(w)),!r.isString(T)||""==T){t.next=63;break}if(a&&Pi(e.MSG.Init_CheckDWTVersion),!Ca(T,r.product.getServerVersionInfo(!0))){t.next=59;break}return t.abrupt("return",{host:n,port:i,version:T});case 59:Pi(e.MSG.Init_DWTVersionFailed),r.Errors.MustUpgradeService(y);case 61:t.next=64;break;case 63:I=!0;case 64:t.next=67;break;case 66:r.Errors.ServiceVersionError(y,_);case 67:t.next=70;break;case 69:I=!0;case 70:t.next=73;break;case 72:I=!0;case 73:throw I&&r.Errors.DynamsoftServiceResponseDataTypeError(y),e.DWT.OnWebTwainInitMessage&&e.DWT.OnWebTwainInitMessage(y._errorString,P.Error),{code:y._errorCode,message:y._errorString};case 76:case"end":return t.stop()}}),t,null,[[4,20]])})))).apply(this,arguments)}function Oa(e,r,t){return La.apply(this,arguments)}function La(){return(La=ne(de.mark((function t(n,i,o){var a,s,u;return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Pi(e.MSG.Init_CheckDWT),i||r.each(r.detect.ports,(function(e){Da.bSSL?e.ssl&&(i=e.port):e.ssl||(i=e.port)})),t.prev=2,t.next=5,Aa(n,i,_t,!0);case 5:return a=t.sent,s=a.host,u=a.port,r.detect.dcpStatus=Pa,Wa(s,u),t.next=11,fo(!1,!0);case 11:if(!r.License.isLTS()||!r.isLocalIP(n)){t.next=15;break}if(e.DWT.li({instanceMode:e.DWT.EnumInstance.dwt_desktop},"")){t.next=15;break}throw r.Errors.BboError();case 15:Pi(e.MSG.Init_DWTVersionOK),t.next=27;break;case 18:if(t.prev=18,t.t0=t["catch"](2),!o){t.next=25;break}throw r.detect.dcpStatus=Fa,t.t0;case 25:throw r.detect.dcpStatus=Fa,t.t0;case 27:return!r.product.dwtVersionInfo&&r.isLocalIP(a.host)&&(r.product.dwtVersionInfo=a.version),t.abrupt("return",a);case 29:case"end":return t.stop()}}),t,null,[[2,18]])})))).apply(this,arguments)}function Na(e,r){return Ma.apply(this,arguments)}function Ma(){return Ma=ne(de.mark((function t(n,i){var o,a,s;return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Pi(e.MSG.Init_InitDynamsoftService),t.next=3,Ha(n,ne(de.mark((function c(){return de.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ga(n,i);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e["catch"](0),wa=e.t0;case 8:case"end":return e.stop()}}),c,null,[[0,5]])}))));case 3:if(!xa.bEnhancedMode){t.next=12;break}return Pi(e.MSG.Init_CheckEnhancedMode),a=r.install._dlgInstall,s=500,a&&a.open||(s=0),t.next=9,new r.Promise((function(r,t){setTimeout((function(){Ba=0,Pi(e.MSG.Init_GetDWTPort),Va(n,r,t)}),s)}));case 9:o=t.sent,t.next=13;break;case 12:o={host:n,port:i};case 13:return u=o.port,r.detect.urls.splice(0),r.detect.urls.push({port:u,ssl:Da.bSSL}),r.detect.ports=[{port:u,ssl:Da.bSSL}],r.detect.cUrlIndex=0,Da.bSSL?e.DWT.SSLPort=u:e.DWT.Port=u,t.abrupt("return",o);case 15:case"end":return t.stop()}var u}),t)}))),Ma.apply(this,arguments)}r.LS=ka;var Ua,Ba=0;function Va(t,n,i){var o=e.navInfoSync;if(Ba>10){r.detect.dcpStatus=Fa;var a=r.Errors.ThrowEnhancedPortNotReady();i(a)}else{var s,u;s=function(e){if(r.isArray(e)&&e.length>1){var a,s,c=e[1];if(c&&(xa.currentUserPorts=c,c.dwt)){if(a=c.dwt.port,s=c.dwt.sslPort,0==a||0==s){var l=1500;return++Ba<3&&(l=3e3),setTimeout((function(){Va(t,n,i)}),l),!0}return n({host:t,port:o.bSSL?s:a}),!0}}var d;return d={},r.Errors.DynamsoftServiceResponseDataTypeError(d),u(We(d))},u=function(n){r.detect.dcpStatus=Fa,function(r){var n=e.navInfoSync.bSSL?e.DWT.SSLPort:e.DWT.Port;Ya(t,n).then((function(e){e&&Mi(e.upgrade,e.socket)}),(function(e){Le(e)})),i(r)}(n)},xa.getPorts(t,xa.strSID).then(s,u)}}function Ga(e,r){return ja.apply(this,arguments)}function ja(){return ja=ne(de.mark((function t(n,i){var o,a,s,u;return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r.isLocalIP(n)){t.next=14;break}return o=e.navInfoSync.bSSL?e.DWT.SSLPort:e.DWT.Port,t.next=4,Ya(n,o);case 4:if(!(a=t.sent)){t.next=9;break}Mi(a.upgrade,a.socket),t.next=12;break;case 9:throw s={},r.Errors.DynamsoftServiceResponseDataTypeError(s),We(s);case 12:t.next=15;break;case 14:r.isFunction(e.OnRemoteWebTwainNotFoundCallback)&&(u=e.navInfoSync.bSSL,e.OnRemoteWebTwainNotFoundCallback(r.product.name,n,i,u,r.env.bMobile));case 15:case"end":return t.stop()}}),t)}))),ja.apply(this,arguments)}function Ha(e,r){return za.apply(this,arguments)}function za(){return za=ne(de.mark((function t(n,i){var o,a,s,u,c,l,d;return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=r.product.refProductKey,wa=null,a=0,s=e.dcp,(u=s.detect).bConnected=!1;case 4:if(!(a<u.MaxManagerModuleConnectCount)){t.next=32;break}return c=0==a,t.prev=6,t.next=9,Ka(n,o,c);case 9:return Xa(t.sent),u.bConnected=!0,t.abrupt("return");case 15:if(t.prev=15,t.t0=t["catch"](6),!t.t0){t.next=26;break}if((l=t.t0.code)!=e.DWT.EnumDWT_Error.ResponseDataTypeError&&l!=e.DWT.EnumDWT_Error.HTSTError&&l!=e.DWT.EnumDWT_Error.CORSError){t.next=23;break}throw t.t0;case 23:if(l!=e.DWT.EnumDWT_Error.MustUpgrade){t.next=26;break}throw Mi(!0,!1),t.t0;case 26:if(!c){t.next=29;break}return t.next=29,i();case 29:++a,t.next=4;break;case 32:if(u.bConnected=!1,u.dcpStatus=u.EnumDCP_DetectStatus.NotInstalled,s._sendStatusEvent(),!wa){t.next=37;break}throw wa;case 37:throw d={},r.Errors.ServiceNotInstalled(d),{code:d._errorCode,message:d._errorString};case 40:case"end":return t.stop()}}),t,null,[[6,15]])}))),za.apply(this,arguments)}function Ka(e,r,t){return qa.apply(this,arguments)}function qa(){return(qa=ne(de.mark((function t(n,i,o){var a,s,u,c,l,d,f;return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.DWT.ConnectWithSocket||!e.navInfoSync.bHTML5Edition){t.next=10;break}return s=pe.getWsUrl(n,e.navInfoSync.bSSL?xa.SSLPort:xa.Port),u={id:(new Date).getTime().toString(),method:"VersionInfo",version:"dwasm2_"+e.Lib.product.getDWTVersionInfoVer(),parameter:[]},r.License.isLongKey(i)&&(u.productKey=i),t.next=6,pe.postStringDataByWSUrl(s,r.stringify(u));case 6:c=t.sent;try{(l=r.parse(c))&&"result"in l&&(a=l.result)}catch(h){}t.next=16;break;case 10:if(xa.detect.dcpStatus=xa.detect.EnumDCP_DetectStatus.CheckingManagerVer,!xa.detect.bConnected||""==xa.detect.connectedResult){t.next=13;break}return t.abrupt("return",xa.detect.connectedResult);case 13:return t.next=15,kt(n,"VersionInfo",i,!0);case 15:a=t.sent;case 16:if(d={},!(r.isArray(a)&&a.length>0&&a[0])){t.next=32;break}if(f=a[0],!r.isString(f)||""==f){t.next=32;break}if(o&&Pi(e.MSG.Init_CheckDWTVersion),!Ca(f,r.product.getServerVersionInfo(!0))){t.next=27;break}return xa.detect.dcpStatus=xa.detect.EnumDCP_DetectStatus.UpdateSkipped,xa._sendStatusEvent(),t.abrupt("return",a);case 27:throw Pi(e.MSG.Init_DWTVersionFailed),r.Errors.MustUpgradeService(d),We(d);case 30:t.next=32;break;case 32:throw r.Errors.DynamsoftServiceResponseDataTypeError(d),We(d);case 34:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Xa(t){var n="",i=!1,o=!1,a={};if(t.length>4&&(n=r.isString(t[2])?t[2]:"",i=r.isString(t[3])&&"true"===t[3],o=r.isString(t[4])&&"64"===t[4]),t.length>5&&(a=t[5]),xa.detect.connectedResult=t,xa.strSID=n,xa.bEnhancedMode=i,xa.b64bit=o,xa.objEnhancedPorts=a,i&&a){if(a.dcp){var s=a.dcp;xa.SSLPort=s.sslPort,xa.Port=s.port}if(a.ddm){var u=a.ddm;u?e.navInfoSync.bSSL?xa.detect.ddmPort=u.sslPort:xa.detect.ddmPort=u.port:xa.detect.ddmPort=0}if(a.dwt){var c=a.dwt;c?e.navInfoSync.bSSL?xa.detect.dwtPort=c.sslPort:xa.detect.dwtPort=c.port:xa.detect.dwtPort=0}}}function Ja(e,t,n){if(e){var i=null!=t?t:270,o=null!=n?n:350;i<=0&&(i=270),o<=0&&(o=350),r.one(e).before(r.install._strNonInstallDIV);var a=r.get(r.install._divDWTNonInstallContainerID);a&&(a.style.width=i,a.style.height=o),r.show(r.install._divDWTNonInstallContainerID)}}function Ya(e,r){return Za.apply(this,arguments)}function Za(){return Za=ne(de.mark((function t(n,i){var o,a,s,u,c,l;return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=n,a=i,s=e.navInfoSync.bSSL,u=$a(n),!r.isLocalIP(n)){t.next=9;break}if(!Fi()){t.next=6;break}throw l=r.Errors.ThrowHTTPCORS(),r.isFunction(e.OnHTTPCorsError)&&e.OnHTTPCorsError(l.message),l;case 6:o=e.Lib.product.hostForCheckCert,a=s?e.DWT.SSLPort:e.DWT.Port,u==Ua.Check127&&(e.navInfoSync.bSafari||(s=!1,a=e.DWT.Port));case 9:if(r.product.bFullEdition||!r.env.bMobile||e.navInfoSync.bAndroid){t.next=13;break}return r.isFunction(e.OnMobileNotSupportCallback)?e.OnMobileNotSupportCallback():r.isFunction(e.MobileNotSupportCallback)&&e.MobileNotSupportCallback(),t.abrupt("return",{upgrade:!1,socket:!1});case 13:return t.next=16,Qa(o,a,s,u);case 16:if(c=t.sent,s&&c&&c.retry,!(s&&c&&c.checkWithNoneSSL)){t.next=26;break}return s=!1,a=e.DWT.Port,t.next=23,Qa(o,a,s,u);case 23:if(!(c=t.sent)||!c.cert){t.next=26;break}throw r.Errors.ConnectToDynamsoftServiceError();case 26:return t.abrupt("return",c);case 27:case"end":return t.stop()}}),t)}))),Za.apply(this,arguments)}function Qa(t,n,i,o){return new r.Promise((function(a,s){if(o==Ua.Check127){var u,c,l=e.Lib.product.hostForCheckCert;e.navInfoSync.bSafari?(u=e.dcp.SSLPort,c=!0):(u=e.dcp.Port,c=!1);var d=gt.getWsClient(l,u,c);return d&&d.connected?(d.dispose(),a({upgrade:!1,socket:!0})):void function(t,n,i,o){var a,s=r.now(),u={id:s,method:"GetServerInfo",parameter:[1],version:["dwasm2_",e.Lib.product.getDWTVersionInfoVer()].join("")},c=Wi,l=_t;a={client:t,userData:{cmdId:s,cmd:null,sFun:n,fFun:i,rawData:!0},taskId:s},t.setRetry(0),t.request(r.stringify(u),c,a,l).then((function(e){return t.dispose(),e}),(function(){r.isFunction(o)&&o(),t.dispose()}))}(d,(function(e){var t,n=e;if(r.isString(e))try{n=r.parse(e)}catch(AA){}if(n&&n.dcp){if(n.dcp.port&&n.dcp.sslPort)return void a({upgrade:!1,socket:!0,retry:!0});if(n.dcp.port&&!n.dcp.sslPort){var i=r.Errors.ThrowSSLCertInvalid();return void s(i)}}throw t={},r.Errors.DynamsoftServiceResponseDataTypeError(t),We(t)}),(function(){a({upgrade:!0,socket:!0})}),(function(){a({upgrade:!1,socket:!1})}))}Ri(gt.getWsClient(t,n,i,!0),(function(e){if(o==Ua.CheckLocalDynamsoftCert){var t=e;if(r.isString(e))try{t=r.parse(e)}catch(AA){}if(t&&r.isArray(t.result)){var n=t.result;if(n.length>4){var i=n[4];if(""==i){var u=r.Errors.ThrowSSLCertInvalid();return void s(u)}if(fn(i)){var c=r.Errors.ThrowSSLCertExpired();return void s(c)}return void a({cert:!0,upgrade:!1,socket:!0})}return void a({cert:!1,upgrade:!1,socket:!0})}}var l;throw l={},r.Errors.DynamsoftServiceResponseDataTypeError(l),We(l)}),(function(){a({cert:!1,upgrade:!0,socket:!0})}),(function(){!i||e.navInfoSync.bSafari?a({cert:!1,upgrade:!1,socket:!1}):a({cert:!1,checkWithNoneSSL:!0})}))}))}function $a(r){var t=Ua.DoNotCheck;return e.navInfoSync.bSSL&&("127.0.0.1"==r?t=Ua.Check127:"local.dynamsoft.com"!=r&&"local.dynamsoftwebtwain.com"!=r||(t=Ua.CheckLocalDynamsoftCert)),t}function es(){return es="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,r,t){var n=function(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&null!==(e=Te(e)););return e}(e,r);if(n){var i=Object.getOwnPropertyDescriptor(n,r);return i.get?i.get.call(arguments.length<3?e:t):i.value}},es.apply(this,arguments)}function rs(e,r){e.__licenseInfo=r,function(e){e.__calic||(e.__calic=e.__licenseInfo)}(e)}e.DWT.NetManager.checkModuleManager=function(t,n){r.License.isLicenseMixed(null,!0)||e.Lib.License.reparseProductKey();var i=e.DWT.licenseException;if(0!=i.code)return Yo(i),!!r.isFunction(n)&&n(i);Ha(f(),ne(de.mark((function o(){return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Ga(f(),r.detect.ssl?e.DWT.SSLPort:e.DWT.Port);case 3:t.next=7;break;case 5:t.prev=5,t.t0=t["catch"](0);case 7:case"end":return t.stop()}}),o,null,[[0,5]])})))).then(t,n)},r.detect.onNoControl=function(t,n,i,o){o&&o._bRemoteMode&&!o._bNotShowMessage?r.isFunction(e.OnRemoteWebTwainNotFoundCallback)&&e.OnRemoteWebTwainNotFoundCallback(r.product.name,o._serverInfo.server,o._serverInfo.port,o._serverInfo.ssl,r.env.bMobile):(Ja(t,n,i),Mi(!1,!1))},function(e){e.DoNotCheck=0,e.Check127=1,e.CheckLocalDynamsoftCert=2}(Ua||(Ua={}));var ts,ns=function(){function e(r,t,n,i){X(this,e);var o=this;o._md5=n,o._length=t,o._content=i}return Q(e,[{key:"getLength",value:function(){return this._length}},{key:"getMD5",value:function(){return this._md5}},{key:"getData",value:function(e,t){var n=this,i=t;return r.isNumber(e)&&r.isNumber(t)?e<0||t<=0?"":0==e&&i==n._length?n._content:(e+i>n._length&&(i=n._length-e),n._content.substr(e,i)):""}}]),e}();function is(e,r,t,n,i){try{e(r,t,n,i)}catch(o){}r=t=n=i=null}function os(e,r,t){try{e(r._errorCode,r._getErrorString(),t)}catch(n){}r=t=null}function as(e,r,t,n,i,o){try{e(r._errorCode,r._getErrorString(),t,n,i,o)}catch(a){}r=t=n=i=o=null}r.html5.Base64Result=ns,function(e){e.SMF_NAME=1,e.SMF_TWAINVERSION=2,e.SMF_TWAINPROTOCOL=4,e.SMF_ICAUUID=8,e.SMF_ICAMODULEVERSION=16,e.SMF_ICALOCATIONTYPE=32}(ts||(ts={})),e.DWT.EnumDWT_SourceMatchField=ts;var ss=Q((function BL(){X(this,BL)}));function us(e,t){var n,i=[],o=t;if(r.isString(o)&&(o=r.parse(o)),r.isArray(o))for(n=0;n<o.length;n++){var a=ds(o[n]);i.push(a)}for(n=0;n<i.length;n++){var s=i[n],u=s.deviceType;s.strDevice=r.stringify(s),s.name&&(s.name=r.base64.decode(s.name)),u&Pn&&s.deviceInfo&&ls(s.deviceInfo),s.serviceInfo=null==e?void 0:e._dmService,cs(s,null==e?void 0:e._dmService)}return i}function cs(e,t){var n,i=e.name,o="",a=e.deviceType;a==xn.TWAINSCANNER?n="":a==xn.TWAINX64SCANNER?n="Twain64-":a==xn.WIASCANNER?n="WIA-":a==xn.WIATWAINSCANNER?(i=r.replaceAll(i,"WIA-",""),n="WIATWAIN-"):n=a==xn.ICASCANNER?"ICA-":a==xn.SANESCANNER?"Sane-":a==xn.ESCLSCANNER?"eSCL-":(xn.WIFIDIRECTSCANNER,""),t&&t.attrs&&t.attrs.ty&&(o=" on ["+t.attrs.ty+"]"),e.displayName=[n,i,o].join("")}function ls(e){if(e.ProductName){var t=e.ProductName;e.ProductName=r.base64.decode(t)}if(e.ProductFamily){var n=e.ProductFamily;e.ProductFamily=r.base64.decode(n)}if(e.Manufacturer){var i=e.Manufacturer;e.Manufacturer=r.base64.decode(i)}if(e.Version&&e.Version.Info){var o=e.Version.Info;e.Version.Info=r.base64.decode(o)}}function ds(e){var t=new ss;return e.deviceInfo&&(t.deviceInfo=r.clone(e.deviceInfo)),e.deviceType&&(t.deviceType=r.clone(e.deviceType)),e.displayName&&(t.displayName=r.clone(e.displayName)),e.name&&(t.name=r.clone(e.name)),e.serviceInfo&&(t.serviceInfo=Un(e.serviceInfo)),t}function fs(e,r){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,r){if(!e)return;if("string"==typeof e)return hs(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return hs(e,r)}(e))||r&&e&&"number"==typeof e.length){t&&(e=t);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==t["return"]||t["return"]()}finally{if(s)throw o}}}}function hs(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function gs(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=Te(e);if(r){var i=Te(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return Se(this,t)}}function ps(e,r){!function(e,r){if(r.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,r),r.add(e)}function ms(e,r,t){if(!r.has(e));return t}function _s(e){var r,t=U;return e==xn.ESCLSCANNER?t=V:e==xn.WIFIDIRECTSCANNER?t=G:((r=e)==xn.TWAINSCANNER||r==xn.WIATWAINSCANNER||r==xn.TWAINX64SCANNER||r==xn.ICASCANNER||r==xn.SANESCANNER)&&(t=B),t}function vs(e,r){var t=new Mn;return t.server=e,t.attrs=r,t}r.removeNonPrintableChar;var ys=new WeakSet,Is=function(){function t(e,n,i,o){X(this,t),ps(this,ys),_e(this,"serverUrl",undefined),this.serverUrl=e,this.bLocal=r.isLocalIP(e),this.clientId=null!=i?i:r.guid(),this.bGlobal=n,this.serverName=o,this.bLicenseOK=!1}var n,i;return Q(t,[{key:"checkSource",value:function(e){if(!e)throw{code:-1003,message:"Source Manager unable to find the specified Source"}}},{key:"parseResultDefault",value:function(e){var t;if(r.isObject(e)&&e.exception&&0!=e.exception)throw{code:e.exception,message:null!==(t=e.description)&&void 0!==t?t:"general error"};if(e&&r.isArray(e.result)&&e.result.length>0){var n=e.result[e.result.length-1];try{return JSON.parse(n)}catch(i){return n}}throw e}},{key:"_requestAsync",value:(i=ne(de.mark((function o(t,n,i){var a,s,u,c,l,d,f,h;return de.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(a=[In(),"/",t.method].join(""),!e.DWT.ConnectWithSocket){o.next=9;break}return o.next=4,ms(this,ys,Ss).call(this);case 4:return c=o.sent,l=0,t&&(l=t.cmdId),d={client:c,userData:{command:t},taskId:l},o.abrupt("return",c.request(r.stringify(t),null,d));case 9:return n&&(s=n),f=(h=this).serverUrl?pe.getDDMUrl(h.serverUrl,h.bGlobal,[vn,t.method].join("")):pe.getModuleUrl(a),o.prev=12,o.next=15,Ir(f,{method:"post",dataType:"json",body:e.Lib.stringify(t),fetchRaw:null!=i&&i,timeout:s});case 15:u=o.sent,o.next=21;break;case 18:throw o.prev=18,o.t0=o["catch"](12),o.t0;case 21:return o.abrupt("return",u);case 22:case"end":return o.stop()}}),o,this,[[12,18]])}))),function(e,r,t){return i.apply(this,arguments)})},{key:"_resetLicense",value:(n=ne(de.mark((function a(e,r,t){return de.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),a)}))),function(e,r,t){return n.apply(this,arguments)})}]),t}();function Ss(){return Ts.apply(this,arguments)}function Ts(){return(Ts=ne(de.mark((function t(){var n,i,o;return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((n=this)._wsClient){t.next=10;break}return i=new me,this.serverUrl?r.startsWith(this.serverUrl,"wss://")?(i.ssl=!0,i.server=this.serverUrl.substring(8)):r.startsWith(this.serverUrl,"ws://")?(i.ssl=!1,i.server=this.serverUrl.substring(7)):(i.ssl=r.detect.ssl,i.server=this.serverUrl):(i.ssl=r.detect.ssl,i.server=f()),i.port=i.ssl?e.dcp.SSLPort:e.dcp.Port,i.useWS=!0,o=dt.Instance.getClient(i),t.next=9,o.testConnection();case 9:n._wsClient=o;case 10:return t.abrupt("return",n._wsClient);case 11:case"end":return t.stop()}}),t,this)})))).apply(this,arguments)}_e(Is,"logLevel",-1),e.Lib.product._setAndroidConnected=function(){e.Lib.product.bAndroidConnected=!0},e.Lib.product._doCheckAndroidConnected=function(){e.DWT.bConnectCanceled,e.Lib.product.bAndroidConnected,setTimeout(e.Lib.product._doCheckAndroidConnected,1e3)};var bs=new WeakSet,Es=new WeakSet,Cs=function(e){Ie(f,e);var t,n,i,o,a,s,u,c,l,d=gs(f);function f(){var e;X(this,f);for(var r=arguments.length,t=new Array(r),n=0;n<r;n++)t[n]=arguments[n];return ps(ve(e=d.call.apply(d,[this].concat(t))),Es),ps(ve(e),bs),_e(ve(e),"_bInited",!1),_e(ve(e),"_currentDevice",undefined),e}return Q(f,[{key:"getDynamsoftService",value:(l=ne(de.mark((function h(e,t,n,i){var o,a,s,u,c,l,d,f,g,p,m,_,v,y,I;return de.wrap((function(h){for(;;)switch(h.prev=h.next){case 0:return n=null!==(o=n)&&void 0!==o&&o,i=null!==(a=i)&&void 0!==a?a:30,s={id:this.clientId,cmdId:r.guid(),method:"SearchScanner",parameter:[1,"_privet._tcp.local.",!1,!0,n,i,e,t],version:yn},h.prev=5,h.next=8,this._requestAsync(s,3e4,!1);case 8:u=h.sent,this._bInited=!0,h.next=19;break;case 12:if(h.prev=12,h.t0=h["catch"](5),!this.bLocal){h.next=18;break}throw c={},r.Errors.DynamsoftServiceStopped(c),{code:c._errorCode,message:c._errorString};case 18:throw r.Errors.ThrowFailedConnectToProxyServer();case 19:l=[],d=this.parseResultDefault(u),f=fs(d),h.prev=22,f.s();case 24:if((g=f.n()).done){h.next=40;break}if(!((p=g.value).service_type&&p.service_type==U||p.type&&"dynamsoft_private_cloud_scan"!=p.type&&"twaindirect"!=p.type)){h.next=30;break}return h.abrupt("continue",38);case 30:if(!p.service_type){h.next=38;break}h.t1=p.service_type,h.next=h.t1===B?34:38;break;case 34:return(m=p.modules)&&r.isArray(m)&&r.isString(m[0])&&(_=m[0].split(",")).length>=3&&_[0]>=1&&_[1]>=8&&_[2]>0&&(p.bGlobalFind=!0,v=vs(this.serverUrl,p),l.push(v)),p.bGlobalFind||(I=null!==(y=null==p?void 0:p.ty)&&void 0!==y?y:"",r.warn(["The Dynamsoft Service on [",I,"] is old version."].join(""))),h.abrupt("break",38);case 38:h.next=24;break;case 40:h.next=45;break;case 42:h.prev=42,h.t2=h["catch"](22),f.e(h.t2);case 45:return h.prev=45,f.f(),h.finish(45);case 48:return h.abrupt("return",l);case 49:case"end":return h.stop()}}),h,this,[[5,12],[22,42,45,48]])}))),function(e,r,t,n){return l.apply(this,arguments)})},{key:"getSources",value:(c=ne(de.mark((function g(e,t,n){var i,o,a,s,u,c,l,d,f,h,p,m,_,v;return de.wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(a="",s=!1,u=[],c=!1,((l=null!=e?e:An)&xn.ESCLSCANNER)==xn.ESCLSCANNER&&(a="_uscan._tcp.local."),(l&xn.WIFIDIRECTSCANNER)==xn.WIFIDIRECTSCANNER&&(s=!0),0!=a.length||s){g.next=9;break}return g.abrupt("return",[]);case 9:return t=null!==(i=t)&&void 0!==i&&i,n=null!==(o=n)&&void 0!==o?o:30,d={id:this.clientId,cmdId:r.guid(),method:"SearchScanner",parameter:[1,a,s,c,t,n],version:yn},g.next=14,this._requestAsync(d,3e4,!1);case 14:if(f=g.sent,this._bInited=!0,h=this.parseResultDefault(f),r.isArray(h)){g.next=19;break}throw r.Errors.ThrowDevicesNotArray();case 19:p=fs(h),g.prev=20,p.s();case 22:if((m=p.n()).done){g.next=47;break}if(!((_=m.value).service_type&&_.service_type==U||_.type&&"dynamsoft_private_cloud_scan"!=_.type&&"twaindirect"!=_.type)){g.next=28;break}return g.abrupt("continue",45);case 28:if(!_.service_type){g.next=45;break}g.t0=_.service_type,g.next=g.t0===B?32:g.t0===V||g.t0===G?33:45;break;case 32:return g.abrupt("break",45);case 33:return(v=new ss).name="",v.displayName="",v.deviceType=0,_.service_type==V?v.deviceType=xn.ESCLSCANNER:_.service_type==G&&(v.deviceType=xn.WIFIDIRECTSCANNER),v.name=_.ty,_.hostname&&_.hostname.length>_.ty.length&&(v.name=_.hostname),v.displayName=(_.service_type==V?"eSCL-":"")+v.name,this.bGlobal||(_.url=this.serverUrl,this.serverName&&(v.displayName=v.displayName+" on ["+this.serverName+"]")),v.serviceInfo=vs(this.serverUrl,_),u.push(v),g.abrupt("break",45);case 45:g.next=22;break;case 47:g.next=52;break;case 49:g.prev=49,g.t1=g["catch"](20),p.e(g.t1);case 52:return g.prev=52,p.f(),g.finish(52);case 55:return g.abrupt("return",u);case 56:case"end":return g.stop()}}),g,this,[[20,49,52,55]])}))),function(e,r,t){return c.apply(this,arguments)})},{key:"getCapabilitiesAsync",value:(u=ne(de.mark((function p(e){var t,n,i;return de.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return this.checkSource(e),(e.deviceType&xn.ESCLSCANNER)!=xn.ESCLSCANNER&&(e.deviceType&xn.WIFIDIRECTSCANNER)!=xn.WIFIDIRECTSCANNER||(this._currentDevice=e),t=_s(e.deviceType),n={id:this.clientId,cmdId:r.guid(),method:"SendRequestToScanner",parameter:["getCapabilities",JSON.stringify({UUID:e.serviceInfo.attrs.UUID,service_type:t,ty:e.name})],version:yn},o.next=6,this._requestAsync(n,0);case 6:return i=o.sent,o.abrupt("return",this.parseResultDefault(i));case 8:case"end":return o.stop()}}),p,this)}))),function(e){return u.apply(this,arguments)})},{key:"selectSourceAsync",value:(s=ne(de.mark((function m(e){var r;return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getCapabilitiesAsync(e);case 2:if(!(r=t.sent)&&""!=r){t.next=5;break}return t.abrupt("return",!0);case 5:case"end":return t.stop()}}),m,this)}))),function(e){return s.apply(this,arguments)})},{key:"versionInfo",value:(a=ne(de.mark((function _(){var e,t;return de.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e={id:this.clientId,cmdId:r.guid(),method:"VersionInfo",version:yn},n.next=3,this._requestAsync(e,5e3);case 3:return t=n.sent,this._bInited=!0,n.abrupt("return",t);case 6:case"end":return n.stop()}}),_,this)}))),function(){return a.apply(this,arguments)})},{key:"getLicenseInfo",value:function(e,r,t){return this._resetLicense(e,r,t)}},{key:"getImageAsArrayBuffer",value:(o=ne(de.mark((function v(e,r){return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",ms(this,bs,ws).call(this,e,r));case 1:case"end":return t.stop()}}),v,this)}))),function(e,r){return o.apply(this,arguments)})},{key:"getImageToDWT",value:(i=ne(de.mark((function y(e,r,t){return de.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ms(this,bs,ws).call(this,e,r,t));case 1:case"end":return n.stop()}}),y,this)}))),function(e,r,t){return i.apply(this,arguments)})},{key:"acquireImage",value:(n=ne(de.mark((function I(e,t,n){var i,o,a,s,u,c,l,d;return de.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e=null!==(i=e)&&void 0!==i?i:this._currentDevice,this.checkSource(e),this._currentDevice=e,o=_s(e.deviceType),a=["scan",JSON.stringify({UUID:e.serviceInfo.attrs.UUID,service_type:o})],s=ms(this,Es,Ds).call(this,t),a[2]=JSON.stringify(s),u={id:this.clientId,cmdId:r.guid(),method:"SendRequestToScanner",parameter:a,version:yn},c=0;case 10:if(!(c<5)){n.next=33;break}return n.prev=11,n.next=14,this._requestAsync(u,0);case 14:return d=n.sent,l=this.parseResultDefault(d),r.isObject(l)&&(l.device=e,l.scanOptions=s),n.abrupt("break",33);case 20:if(n.prev=20,n.t0=n["catch"](11),-1004!=n.t0.code&&-1001!=n.t0.code){n.next=29;break}if(!(c>=4)){n.next=25;break}throw n.t0;case 25:return n.next=27,new r.Promise((function(e,r){setTimeout(e,2e3)}));case 27:n.next=30;break;case 29:throw n.t0;case 30:c++,n.next=10;break;case 33:return n.abrupt("return",l);case 34:case"end":return n.stop()}}),I,this,[[11,20]])}))),function(e,r,t){return n.apply(this,arguments)})},{key:"dispose",value:function(){var e={id:this.clientId,cmdId:r.guid(),method:"dispose",version:yn};this._requestAsync(e,500)}},{key:"_resetLicense",value:(t=ne(de.mark((function S(e,t,n){var i,o,a,s;return de.wrap((function(u){for(;;)switch(u.prev=u.next){case 0:return this.longKeyOrShortkey=e,this.cu=t,xs(),i=null!=t?t:"",o={id:this.clientId,cmdId:r.guid(),method:"GetLicenseInfo",parameter:[e,f.logLevel,i,n],version:yn},u.prev=5,u.next=8,this._requestAsync(o,1e4);case 8:return a=u.sent,this._bInited=!0,u.abrupt("return",this.parseResultDefault(a));case 13:if(u.prev=13,u.t0=u["catch"](5),!this.bLocal){u.next=19;break}throw s={},r.Errors.DynamsoftServiceStopped(s),{code:s._errorCode,message:s._errorString};case 19:throw r.Errors.ThrowFailedConnectToProxyServer();case 20:case"end":return u.stop()}}),S,this,[[5,13]])}))),function(e,r,n){return t.apply(this,arguments)})}]),f}(Is);function ws(e,r,t){return ks.apply(this,arguments)}function ks(){return(ks=ne(de.mark((function e(t,n,i){var o,a,s,u,c,l;return de.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t&&t.device){e.next=2;break}throw{code:-1011,message:"Operation out of expected sequence"};case 2:return i=null!==(o=i)&&void 0!==o?o:{ver:"",clientId:""},(a=["getImage",JSON.stringify({UUID:t.device.serviceInfo.attrs.UUID,service_type:n})])[2]=JSON.stringify(t.scanOptions),a[3]=t.scanJobs,a[4]=t.scanId,a[5]=i._clientId,a[6]=i._ver,s={id:this.clientId,cmdId:r.guid(),method:"SendRequestToScanner",parameter:a,version:yn},e.next=12,this._requestAsync(s,0,!0);case 12:if(u=e.sent,!(u.headers.get("content-type").indexOf("image/")>=0)){e.next=20;break}return e.next=17,u.arrayBuffer();case 17:return e.abrupt("return",e.sent);case 20:return e.next=22,u.json();case 22:if(c=e.sent,"boolean"!=typeof(l=this.parseResultDefault(c))){e.next=28;break}return e.abrupt("return",null);case 28:return e.abrupt("return",l);case 29:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function Ds(t){var n=[];if(t){r.isNumber(t.PixelType)&&(n.push({capability:e.DWT.EnumDWT_Cap.ICAP_PIXELTYPE,curValue:t.PixelType}),e.DWT.EnumDWT_PixelType.TWPT_BW==t.PixelType&&(n.push({capability:32771,curValue:"application/octet-stream"}),n.push({capability:32772,curValue:"application/octet-stream"})));var i=t.Resolution;i||(i=300),n.push({capability:e.DWT.EnumDWT_Cap.ICAP_XRESOLUTION,curValue:i}),n.push({capability:e.DWT.EnumDWT_Cap.ICAP_YRESOLUTION,curValue:i}),t.Brightness!==undefined&&n.push({capability:e.DWT.EnumDWT_Cap.ICAP_BRIGHTNESS,curValue:t.Brightness}),t.XferCount!==undefined&&n.push({capability:e.DWT.EnumDWT_Cap.CAP_XFERCOUNT,curValue:t.XferCount}),t.Contrast!==undefined&&n.push({capability:e.DWT.EnumDWT_Cap.ICAP_CONTRAST,curValue:t.Contrast}),t.TransferMode!==undefined&&n.push({capability:e.DWT.EnumDWT_Cap.ICAP_XFERMECH,curValue:t.TransferMode}),t.IfFeederEnabled!==undefined&&n.push({capability:e.DWT.EnumDWT_Cap.CAP_FEEDERENABLED,curValue:t.IfFeederEnabled?je:Ge}),t.IfDuplexEnabled!==undefined&&n.push({capability:e.DWT.EnumDWT_Cap.CAP_DUPLEXENABLED,curValue:t.IfDuplexEnabled?je:Ge})}return n}function xs(){var e=Cs.logLevel;r.isNumber(e)||(Cs.logLevel=-1)}function Ps(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function Fs(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,i,o,a,s=[],u=!0,c=!1;try{if(o=(t=t.call(e)).next,0===r){if(Object(t)!==t)return;u=!1}else for(;!(u=(n=o.call(t)).done)&&(s.push(n.value),s.length!==r);u=!0);}catch(l){c=!0,i=l}finally{try{if(!u&&null!=t["return"]&&(a=t["return"](),Object(a)!==a))return}finally{if(c)throw i}}return s}}(e,r)||function(e,r){if(e){if("string"==typeof e)return Ps(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Ps(e,r):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Ws=function(){function e(){X(this,e),_e(this,"bIsDirty",!1),_e(this,"imageWidth",0),_e(this,"imageHeight",0),_e(this,"iImageControlWidth",0),_e(this,"iImageControlHeight",0),_e(this,"imageUrl",""),_e(this,"minImageUrl",""),_e(this,"uuid",-1),_e(this,"imageId",-1),_e(this,"aryOverlayRectangleData",[]),_e(this,"ticks",Date.now())}return Q(e,[{key:"Clear",value:function(){this.imageUrl="",this.minImageUrl="",this.imageId=-1,this.aryOverlayRectangleData=[]}}]),e}(),As=e.navInfoSync,Rs={getImageUrl:function(t,n,i,o,a){var s,u=[t];if(r.isNumber(n)&&n<0)return"";if(n!==undefined&&null!==n&&(u.push("&index="),u.push(n)),u.push("&width="),u.push(i),u.push("&height="),u.push(o),e.navInfoSync.bMobile&&u.push("&type=1&quality=85"),u.push("&ticks="),a?u.push(a):u.push(Date.now()),s=u.join(""),e.navInfoSync.bFileSystem&&s.indexOf("dwt://")<0){var c=new Image;c.crossOrigin="anonymous",c.src=s,c=null}return s},getUrlByAct:function(e,r,t){var n=[e];return r!==undefined&&null!==r&&(n.push("&index="),n.push(r)),t&&(n.push("&act="),n.push(t)),n.push("&ticks="),n.push(Date.now()),n.join("")},output:function(t,n){e.DWT.Debug&&r.log(n)},print:function(e){var t,n=850,i=1120,o=0,a=0,s=0,u="";for(r.product.bHTML5Edition&&(As.bIE&&(i=1160),As.bFirefox&&(i=1150)),o=0;o<e.length;o++){var c=i,l=e[o],d=l.Width,f=l.Height,h=l.Url;d<=0&&(d=n),f<=0&&(f=c);var g=n/d,p=c/f;g<p?c=Math.floor(f*g):g>p&&(n=Math.floor(d*p)),a+=d,s+=f,u=u+'<div style="width:'+n+"px;height:"+c+'px"><img id="D_img'+o+'" src="'+h+'" style="position:relative;left:0px;top:0px;width: '+n+"px;height: "+c+'px" referrerpolicy="strict-origin-when-cross-origin" /></div>'}var m,_=["alwaysRaised=yes,z-look=yes,top=0,left=0,toolbar=no,menubar=no,location=no,status=no,width=",a,",height=",s].join(""),v=window.open("about:blank","_blank",_);t='<html><body id="D_img">'+u+"</body></html>",v&&(v.document.write(t),v.document.close(),v.focus(),(m=v.document.getElementById("D_img"))?m.onload=function(){v&&v.print(),r.log("print image...ok")}:r.log("cannot find image"))}};r.html5.Funs2=Rs;var Os=function(e){return e&&e.Math==Math&&e},Ls=Os("object"==typeof globalThis&&globalThis)||Os("object"==typeof window&&window)||Os("object"==typeof self&&self)||Os("object"==typeof ie&&ie)||function(){return this}()||Function("return this")(),Ns=function(e){try{return!!e()}catch(Ke){return!0}},Ms=!Ns((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})),Us=Ms,Bs=Function.prototype,Vs=Bs.apply,Gs=Bs.call,js="object"==typeof Reflect&&Reflect.apply||(Us?Gs.bind(Vs):function(){return Gs.apply(Vs,arguments)}),Hs=Ms,zs=Function.prototype,Ks=zs.call,qs=Hs&&zs.bind.bind(Ks,Ks),Xs=Hs?qs:function(e){return function(){return Ks.apply(e,arguments)}},Js=Xs,Ys=Js({}.toString),Zs=Js("".slice),Qs=function(e){return Zs(Ys(e),8,-1)},$s=Qs,eu=Xs,ru=function(e){if("Function"===$s(e))return eu(e)},tu="object"==typeof document&&document.all,nu={all:tu,IS_HTMLDDA:void 0===tu&&tu!==undefined},iu=nu.all,ou=nu.IS_HTMLDDA?function(e){return"function"==typeof e||e===iu}:function(e){return"function"==typeof e},au={},su=!Ns((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),uu=Ms,cu=Function.prototype.call,lu=uu?cu.bind(cu):function(){return cu.apply(cu,arguments)},du={},fu={}.propertyIsEnumerable,hu=Object.getOwnPropertyDescriptor,gu=hu&&!fu.call({1:2},1);du.f=gu?function(e){var r=hu(this,e);return!!r&&r.enumerable}:fu;var pu,mu,_u=function(e,r){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:r}},vu=Ns,yu=Qs,Iu=Object,Su=Xs("".split),Tu=vu((function(){return!Iu("z").propertyIsEnumerable(0)}))?function(e){return"String"==yu(e)?Su(e,""):Iu(e)}:Iu,bu=function(e){return null===e||e===undefined},Eu=bu,Cu=TypeError,wu=function(e){if(Eu(e))throw Cu("Can't call method on "+e);return e},ku=Tu,Du=wu,xu=function(e){return ku(Du(e))},Pu=ou,Fu=nu.all,Wu=nu.IS_HTMLDDA?function(e){return"object"==typeof e?null!==e:Pu(e)||e===Fu}:function(e){return"object"==typeof e?null!==e:Pu(e)},Au={},Ru=Au,Ou=Ls,Lu=ou,Nu=function(e){return Lu(e)?e:undefined},Mu=function(e,r){return arguments.length<2?Nu(Ru[e])||Nu(Ou[e]):Ru[e]&&Ru[e][r]||Ou[e]&&Ou[e][r]},Uu=Xs({}.isPrototypeOf),Bu="undefined"!=typeof navigator&&String(navigator.userAgent)||"",Vu=Ls,Gu=Bu,ju=Vu.process,Hu=Vu.Deno,zu=ju&&ju.versions||Hu&&Hu.version,Ku=zu&&zu.v8;Ku&&(mu=(pu=Ku.split("."))[0]>0&&pu[0]<4?1:+(pu[0]+pu[1])),!mu&&Gu&&(!(pu=Gu.match(/Edge\/(\d+)/))||pu[1]>=74)&&(pu=Gu.match(/Chrome\/(\d+)/))&&(mu=+pu[1]);var qu=mu,Xu=qu,Ju=Ns,Yu=!!Object.getOwnPropertySymbols&&!Ju((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&Xu&&Xu<41})),Zu=Yu&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Qu=Mu,$u=ou,ec=Uu,rc=Object,tc=Zu?function(e){return"symbol"==typeof e}:function(e){var r=Qu("Symbol");return $u(r)&&ec(r.prototype,rc(e))},nc=String,ic=function(e){try{return nc(e)}catch(Ke){return"Object"}},oc=ou,ac=ic,sc=TypeError,uc=function(e){if(oc(e))return e;throw sc(ac(e)+" is not a function")},cc=uc,lc=bu,dc=function(e,r){var t=e[r];return lc(t)?undefined:cc(t)},fc=lu,hc=ou,gc=Wu,pc=TypeError,mc={exports:{}},_c=Ls,vc=Object.defineProperty,yc=function(e,r){try{vc(_c,e,{value:r,configurable:!0,writable:!0})}catch(Ke){_c[e]=r}return r},Ic="__core-js_shared__",Sc=Ls[Ic]||yc(Ic,{}),Tc=Sc;(mc.exports=function(e,r){return Tc[e]||(Tc[e]=r!==undefined?r:{})})("versions",[]).push({version:"3.30.1",mode:"pure",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.30.1/LICENSE",source:"https://github.com/zloirock/core-js"});var bc=mc.exports,Ec=wu,Cc=Object,wc=function(e){return Cc(Ec(e))},kc=wc,Dc=Xs({}.hasOwnProperty),xc=Object.hasOwn||function(e,r){return Dc(kc(e),r)},Pc=Xs,Fc=0,Wc=Math.random(),Ac=Pc(1..toString),Rc=function(e){return"Symbol("+(e===undefined?"":e)+")_"+Ac(++Fc+Wc,36)},Oc=bc,Lc=xc,Nc=Rc,Mc=Yu,Uc=Zu,Bc=Ls.Symbol,Vc=Oc("wks"),Gc=Uc?Bc["for"]||Bc:Bc&&Bc.withoutSetter||Nc,jc=function(e){return Lc(Vc,e)||(Vc[e]=Mc&&Lc(Bc,e)?Bc[e]:Gc("Symbol."+e)),Vc[e]},Hc=lu,zc=Wu,Kc=tc,qc=dc,Xc=function(e,r){var t,n;if("string"===r&&hc(t=e.toString)&&!gc(n=fc(t,e)))return n;if(hc(t=e.valueOf)&&!gc(n=fc(t,e)))return n;if("string"!==r&&hc(t=e.toString)&&!gc(n=fc(t,e)))return n;throw pc("Can't convert object to primitive value")},Jc=TypeError,Yc=jc("toPrimitive"),Zc=function(e,r){if(!zc(e)||Kc(e))return e;var t,n=qc(e,Yc);if(n){if(r===undefined&&(r="default"),t=Hc(n,e,r),!zc(t)||Kc(t))return t;throw Jc("Can't convert object to primitive value")}return r===undefined&&(r="number"),Xc(e,r)},Qc=tc,$c=function(e){var r=Zc(e,"string");return Qc(r)?r:r+""},el=Wu,rl=Ls.document,tl=el(rl)&&el(rl.createElement),nl=function(e){return tl?rl.createElement(e):{}},il=nl,ol=!su&&!Ns((function(){return 7!=Object.defineProperty(il("div"),"a",{get:function(){return 7}}).a})),al=su,sl=lu,ul=du,cl=_u,ll=xu,dl=$c,fl=xc,hl=ol,gl=Object.getOwnPropertyDescriptor;au.f=al?gl:function(e,r){if(e=ll(e),r=dl(r),hl)try{return gl(e,r)}catch(Ke){}if(fl(e,r))return cl(!sl(ul.f,e,r),e[r])};var pl=Ns,ml=ou,_l=/#|\.prototype\./,vl=function(e,r){var t=Il[yl(e)];return t==Tl||t!=Sl&&(ml(r)?pl(r):!!r)},yl=vl.normalize=function(e){return String(e).replace(_l,".").toLowerCase()},Il=vl.data={},Sl=vl.NATIVE="N",Tl=vl.POLYFILL="P",bl=vl,El=uc,Cl=Ms,wl=ru(ru.bind),kl=function(e,r){return El(e),r===undefined?e:Cl?wl(e,r):function(){return e.apply(r,arguments)}},Dl={},xl=su&&Ns((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),Pl=Wu,Fl=String,Wl=TypeError,Al=function(e){if(Pl(e))return e;throw Wl(Fl(e)+" is not an object")},Rl=su,Ol=ol,Ll=xl,Nl=Al,Ml=$c,Ul=TypeError,Bl=Object.defineProperty,Vl=Object.getOwnPropertyDescriptor,Gl="enumerable",jl="configurable",Hl="writable";Dl.f=Rl?Ll?function(e,r,t){if(Nl(e),r=Ml(r),Nl(t),"function"==typeof e&&"prototype"===r&&"value"in t&&Hl in t&&!t[Hl]){var n=Vl(e,r);n&&n[Hl]&&(e[r]=t.value,t={configurable:jl in t?t[jl]:n[jl],enumerable:Gl in t?t[Gl]:n[Gl],writable:!1})}return Bl(e,r,t)}:Bl:function(e,r,t){if(Nl(e),r=Ml(r),Nl(t),Ol)try{return Bl(e,r,t)}catch(Ke){}if("get"in t||"set"in t)throw Ul("Accessors not supported");return"value"in t&&(e[r]=t.value),e};var zl=Dl,Kl=_u,ql=su?function(e,r,t){return zl.f(e,r,Kl(1,t))}:function(e,r,t){return e[r]=t,e},Xl=Ls,Jl=js,Yl=ru,Zl=ou,Ql=au.f,$l=bl,ed=Au,rd=kl,td=ql,nd=xc,id=function(e){var r=function(t,n,i){if(this instanceof r){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,i)}return Jl(e,this,arguments)};return r.prototype=e.prototype,r},od=function(e,r){var t,n,i,o,a,s,u,c,l,d=e.target,f=e.global,h=e.stat,g=e.proto,p=f?Xl:h?Xl[d]:(Xl[d]||{}).prototype,m=f?ed:ed[d]||td(ed,d,{})[d],_=m.prototype;for(o in r)n=!(t=$l(f?o:d+(h?".":"#")+o,e.forced))&&p&&nd(p,o),s=m[o],n&&(u=e.dontCallGetSet?(l=Ql(p,o))&&l.value:p[o]),a=n&&u?u:r[o],n&&typeof s==typeof a||(c=e.bind&&n?rd(a,Xl):e.wrap&&n?id(a):g&&Zl(a)?Yl(a):a,(e.sham||a&&a.sham||s&&s.sham)&&td(c,"sham",!0),td(m,o,c),g&&(nd(ed,i=d+"Prototype")||td(ed,i,{}),td(ed[i],o,a),e.real&&_&&(t||!_[o])&&td(_,o,a)))},ad=Qs,sd=Array.isArray||function(e){return"Array"==ad(e)},ud=Math.ceil,cd=Math.floor,ld=Math.trunc||function(e){var r=+e;return(r>0?cd:ud)(r)},dd=ld,fd=function(e){var r=+e;return r!=r||0===r?0:dd(r)},hd=fd,gd=Math.min,pd=function(e){return e>0?gd(hd(e),9007199254740991):0},md=function(e){return pd(e.length)},_d=TypeError,vd=function(e){if(e>9007199254740991)throw _d("Maximum allowed index exceeded");return e},yd=$c,Id=Dl,Sd=_u,Td=function(e,r,t){var n=yd(r);n in e?Id.f(e,n,Sd(0,t)):e[n]=t},bd={};bd[jc("toStringTag")]="z";var Ed="[object z]"===String(bd),Cd=Ed,wd=ou,kd=Qs,Dd=jc("toStringTag"),xd=Object,Pd="Arguments"==kd(function(){return arguments}()),Fd=Cd?kd:function(e){var r,t,n;return e===undefined?"Undefined":null===e?"Null":"string"==typeof(t=function(e,r){try{return e[r]}catch(Ke){}}(r=xd(e),Dd))?t:Pd?kd(r):"Object"==(n=kd(r))&&wd(r.callee)?"Arguments":n},Wd=ou,Ad=Sc,Rd=Xs(Function.toString);Wd(Ad.inspectSource)||(Ad.inspectSource=function(e){return Rd(e)});var Od=Ad.inspectSource,Ld=Xs,Nd=Ns,Md=ou,Ud=Fd,Bd=Od,Vd=function(){},Gd=[],jd=Mu("Reflect","construct"),Hd=/^\s*(?:class|function)\b/,zd=Ld(Hd.exec),Kd=!Hd.exec(Vd),qd=function(e){if(!Md(e))return!1;try{return jd(Vd,Gd,e),!0}catch(Ke){return!1}},Xd=function(e){if(!Md(e))return!1;switch(Ud(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Kd||!!zd(Hd,Bd(e))}catch(Ke){return!0}};Xd.sham=!0;var Jd=!jd||Nd((function(){var e;return qd(qd.call)||!qd(Object)||!qd((function(){e=!0}))||e}))?Xd:qd,Yd=sd,Zd=Jd,Qd=Wu,$d=jc("species"),ef=Array,rf=function(e){var r;return Yd(e)&&(r=e.constructor,(Zd(r)&&(r===ef||Yd(r.prototype))||Qd(r)&&null===(r=r[$d]))&&(r=undefined)),r===undefined?ef:r},tf=function(e,r){return new(rf(e))(0===r?0:r)},nf=Ns,of=qu,af=jc("species"),sf=function(e){return of>=51||!nf((function(){var r=[];return(r.constructor={})[af]=function(){return{foo:1}},1!==r[e](Boolean).foo}))},uf=od,cf=Ns,lf=sd,df=Wu,ff=wc,hf=md,gf=vd,pf=Td,mf=tf,_f=sf,vf=qu,yf=jc("isConcatSpreadable"),If=vf>=51||!cf((function(){var e=[];return e[yf]=!1,e.concat()[0]!==e})),Sf=function(e){if(!df(e))return!1;var r=e[yf];return r!==undefined?!!r:lf(e)};uf({target:"Array",proto:!0,arity:1,forced:!If||!_f("concat")},{concat:function(e){var r,t,n,i,o,a=ff(this),s=mf(a,0),u=0;for(r=-1,n=arguments.length;r<n;r++)if(Sf(o=-1===r?a:arguments[r]))for(i=hf(o),gf(u+i),t=0;t<i;t++,u++)t in o&&pf(s,u,o[t]);else gf(u+1),pf(s,u++,o);return s.length=u,s}});var Tf=Fd,bf=String,Ef=function(e){if("Symbol"===Tf(e))throw TypeError("Cannot convert a Symbol value to a string");return bf(e)},Cf={},wf=fd,kf=Math.max,Df=Math.min,xf=function(e,r){var t=wf(e);return t<0?kf(t+r,0):Df(t,r)},Pf=xu,Ff=xf,Wf=md,Af=function(e){return function(r,t,n){var i,o=Pf(r),a=Wf(o),s=Ff(n,a);if(e&&t!=t){for(;a>s;)if((i=o[s++])!=i)return!0}else for(;a>s;s++)if((e||s in o)&&o[s]===t)return e||s||0;return!e&&-1}},Rf={includes:Af(!0),indexOf:Af(!1)},Of={},Lf=xc,Nf=xu,Mf=Rf.indexOf,Uf=Of,Bf=Xs([].push),Vf=function(e,r){var t,n=Nf(e),i=0,o=[];for(t in n)!Lf(Uf,t)&&Lf(n,t)&&Bf(o,t);for(;r.length>i;)Lf(n,t=r[i++])&&(~Mf(o,t)||Bf(o,t));return o},Gf=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],jf=Vf,Hf=Gf,zf=Object.keys||function(e){return jf(e,Hf)},Kf=su,qf=xl,Xf=Dl,Jf=Al,Yf=xu,Zf=zf;Cf.f=Kf&&!qf?Object.defineProperties:function(e,r){Jf(e);for(var t,n=Yf(r),i=Zf(r),o=i.length,a=0;o>a;)Xf.f(e,t=i[a++],n[t]);return e};var Qf,$f=Mu("document","documentElement"),eh=Rc,rh=bc("keys"),th=function(e){return rh[e]||(rh[e]=eh(e))},nh=Al,ih=Cf,oh=Gf,ah=Of,sh=$f,uh=nl,ch="prototype",lh="script",dh=th("IE_PROTO"),fh=function(){},hh=function(e){return"<"+lh+">"+e+"</"+lh+">"},gh=function(e){e.write(hh("")),e.close();var r=e.parentWindow.Object;return e=null,r},ph=function(){try{Qf=new ActiveXObject("htmlfile")}catch(Ke){}var e,r,t;ph="undefined"!=typeof document?document.domain&&Qf?gh(Qf):(r=uh("iframe"),t="java"+lh+":",r.style.display="none",sh.appendChild(r),r.src=String(t),(e=r.contentWindow.document).open(),e.write(hh("document.F=Object")),e.close(),e.F):gh(Qf);for(var n=oh.length;n--;)delete ph[ch][oh[n]];return ph()};ah[dh]=!0;var mh=Object.create||function(e,r){var t;return null!==e?(fh[ch]=nh(e),t=new fh,fh[ch]=null,t[dh]=e):t=ph(),r===undefined?t:ih.f(t,r)},_h={},vh=Vf,yh=Gf.concat("length","prototype");_h.f=Object.getOwnPropertyNames||function(e){return vh(e,yh)};var Ih={},Sh=xf,Th=md,bh=Td,Eh=Array,Ch=Math.max,wh=function(e,r,t){for(var n=Th(e),i=Sh(r,n),o=Sh(t===undefined?n:t,n),a=Eh(Ch(o-i,0)),s=0;i<o;i++,s++)bh(a,s,e[i]);return a.length=s,a},kh=Qs,Dh=xu,xh=_h.f,Ph=wh,Fh="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];Ih.f=function(e){return Fh&&"Window"==kh(e)?function(e){try{return xh(e)}catch(Ke){return Ph(Fh)}}(e):xh(Dh(e))};var Wh={};Wh.f=Object.getOwnPropertySymbols;var Ah=ql,Rh=function(e,r,t,n){return n&&n.enumerable?e[r]=t:Ah(e,r,t),e},Oh=Dl,Lh=function(e,r,t){return Oh.f(e,r,t)},Nh={},Mh=jc;Nh.f=Mh;var Uh,Bh,Vh,Gh=Au,jh=xc,Hh=Nh,zh=Dl.f,Kh=function(e){var r=Gh.Symbol||(Gh.Symbol={});jh(r,e)||zh(r,e,{value:Hh.f(e)})},qh=lu,Xh=Mu,Jh=jc,Yh=Rh,Zh=function(){var e=Xh("Symbol"),r=e&&e.prototype,t=r&&r.valueOf,n=Jh("toPrimitive");r&&!r[n]&&Yh(r,n,(function(e){return qh(t,this)}),{arity:1})},Qh=Fd,$h=Ed?{}.toString:function(){return"[object "+Qh(this)+"]"},eg=Ed,rg=Dl.f,tg=ql,ng=xc,ig=$h,og=jc("toStringTag"),ag=function(e,r,t,n){if(e){var i=t?e:e.prototype;ng(i,og)||rg(i,og,{configurable:!0,value:r}),n&&!eg&&tg(i,"toString",ig)}},sg=ou,ug=Ls.WeakMap,cg=sg(ug)&&/native code/.test(String(ug)),lg=Ls,dg=Wu,fg=ql,hg=xc,gg=Sc,pg=th,mg=Of,_g="Object already initialized",vg=lg.TypeError,yg=lg.WeakMap;if(cg||gg.state){var Ig=gg.state||(gg.state=new yg);Ig.get=Ig.get,Ig.has=Ig.has,Ig.set=Ig.set,Uh=function(e,r){if(Ig.has(e))throw vg(_g);return r.facade=e,Ig.set(e,r),r},Bh=function(e){return Ig.get(e)||{}},Vh=function(e){return Ig.has(e)}}else{var Sg=pg("state");mg[Sg]=!0,Uh=function(e,r){if(hg(e,Sg))throw vg(_g);return r.facade=e,fg(e,Sg,r),r},Bh=function(e){return hg(e,Sg)?e[Sg]:{}},Vh=function(e){return hg(e,Sg)}}var Tg={set:Uh,get:Bh,has:Vh,enforce:function(e){return Vh(e)?Bh(e):Uh(e,{})},getterFor:function(e){return function(r){var t;if(!dg(r)||(t=Bh(r)).type!==e)throw vg("Incompatible receiver, "+e+" required");return t}}},bg=kl,Eg=Tu,Cg=wc,wg=md,kg=tf,Dg=Xs([].push),xg=function(e){var r=1==e,t=2==e,n=3==e,i=4==e,o=6==e,a=7==e,s=5==e||o;return function(u,c,l,d){for(var f,h,g=Cg(u),p=Eg(g),m=bg(c,l),_=wg(p),v=0,y=d||kg,I=r?y(u,_):t||a?y(u,0):undefined;_>v;v++)if((s||v in p)&&(h=m(f=p[v],v,g),e))if(r)I[v]=h;else if(h)switch(e){case 3:return!0;case 5:return f;case 6:return v;case 2:Dg(I,f)}else switch(e){case 4:return!1;case 7:Dg(I,f)}return o?-1:n||i?i:I}},Pg={forEach:xg(0),map:xg(1),filter:xg(2),some:xg(3),every:xg(4),find:xg(5),findIndex:xg(6),filterReject:xg(7)},Fg=od,Wg=Ls,Ag=lu,Rg=Xs,Og=su,Lg=Yu,Ng=Ns,Mg=xc,Ug=Uu,Bg=Al,Vg=xu,Gg=$c,jg=Ef,Hg=_u,zg=mh,Kg=zf,qg=_h,Xg=Ih,Jg=Wh,Yg=au,Zg=Dl,Qg=Cf,$g=du,ep=Rh,rp=Lh,tp=bc,np=Of,ip=Rc,op=jc,ap=Nh,sp=Kh,up=Zh,cp=ag,lp=Tg,dp=Pg.forEach,fp=th("hidden"),hp="Symbol",gp="prototype",pp=lp.set,mp=lp.getterFor(hp),_p=Object[gp],vp=Wg.Symbol,yp=vp&&vp[gp],Ip=Wg.TypeError,Sp=Wg.QObject,Tp=Yg.f,bp=Zg.f,Ep=Xg.f,Cp=$g.f,wp=Rg([].push),kp=tp("symbols"),Dp=tp("op-symbols"),xp=tp("wks"),Pp=!Sp||!Sp[gp]||!Sp[gp].findChild,Fp=Og&&Ng((function(){return 7!=zg(bp({},"a",{get:function(){return bp(this,"a",{value:7}).a}})).a}))?function(e,r,t){var n=Tp(_p,r);n&&delete _p[r],bp(e,r,t),n&&e!==_p&&bp(_p,r,n)}:bp,Wp=function(e,r){var t=kp[e]=zg(yp);return pp(t,{type:hp,tag:e,description:r}),Og||(t.description=r),t},Ap=function(e,r,t){e===_p&&Ap(Dp,r,t),Bg(e);var n=Gg(r);return Bg(t),Mg(kp,n)?(t.enumerable?(Mg(e,fp)&&e[fp][n]&&(e[fp][n]=!1),t=zg(t,{enumerable:Hg(0,!1)})):(Mg(e,fp)||bp(e,fp,Hg(1,{})),e[fp][n]=!0),Fp(e,n,t)):bp(e,n,t)},Rp=function(e,r){Bg(e);var t=Vg(r),n=Kg(t).concat(Mp(t));return dp(n,(function(r){Og&&!Ag(Op,t,r)||Ap(e,r,t[r])})),e},Op=function(e){var r=Gg(e),t=Ag(Cp,this,r);return!(this===_p&&Mg(kp,r)&&!Mg(Dp,r))&&(!(t||!Mg(this,r)||!Mg(kp,r)||Mg(this,fp)&&this[fp][r])||t)},Lp=function(e,r){var t=Vg(e),n=Gg(r);if(t!==_p||!Mg(kp,n)||Mg(Dp,n)){var i=Tp(t,n);return!i||!Mg(kp,n)||Mg(t,fp)&&t[fp][n]||(i.enumerable=!0),i}},Np=function(e){var r=Ep(Vg(e)),t=[];return dp(r,(function(e){Mg(kp,e)||Mg(np,e)||wp(t,e)})),t},Mp=function(e){var r=e===_p,t=Ep(r?Dp:Vg(e)),n=[];return dp(t,(function(e){!Mg(kp,e)||r&&!Mg(_p,e)||wp(n,kp[e])})),n};Lg||(vp=function(){if(Ug(yp,this))throw Ip("Symbol is not a constructor");var e=arguments.length&&arguments[0]!==undefined?jg(arguments[0]):undefined,r=ip(e),t=function(e){this===_p&&Ag(t,Dp,e),Mg(this,fp)&&Mg(this[fp],r)&&(this[fp][r]=!1),Fp(this,r,Hg(1,e))};return Og&&Pp&&Fp(_p,r,{configurable:!0,set:t}),Wp(r,e)},ep(yp=vp[gp],"toString",(function(){return mp(this).tag})),ep(vp,"withoutSetter",(function(e){return Wp(ip(e),e)})),$g.f=Op,Zg.f=Ap,Qg.f=Rp,Yg.f=Lp,qg.f=Xg.f=Np,Jg.f=Mp,ap.f=function(e){return Wp(op(e),e)},Og&&rp(yp,"description",{configurable:!0,get:function(){return mp(this).description}})),Fg({global:!0,constructor:!0,wrap:!0,forced:!Lg,sham:!Lg},{Symbol:vp}),dp(Kg(xp),(function(e){sp(e)})),Fg({target:hp,stat:!0,forced:!Lg},{useSetter:function(){Pp=!0},useSimple:function(){Pp=!1}}),Fg({target:"Object",stat:!0,forced:!Lg,sham:!Og},{create:function(e,r){return r===undefined?zg(e):Rp(zg(e),r)},defineProperty:Ap,defineProperties:Rp,getOwnPropertyDescriptor:Lp}),Fg({target:"Object",stat:!0,forced:!Lg},{getOwnPropertyNames:Np}),up(),cp(vp,hp),np[fp]=!0;var Up=Yu&&!!Symbol["for"]&&!!Symbol.keyFor,Bp=od,Vp=Mu,Gp=xc,jp=Ef,Hp=bc,zp=Up,Kp=Hp("string-to-symbol-registry"),qp=Hp("symbol-to-string-registry");Bp({target:"Symbol",stat:!0,forced:!zp},{"for":function(e){var r=jp(e);if(Gp(Kp,r))return Kp[r];var t=Vp("Symbol")(r);return Kp[r]=t,qp[t]=r,t}});var Xp=od,Jp=xc,Yp=tc,Zp=ic,Qp=Up,$p=bc("symbol-to-string-registry");Xp({target:"Symbol",stat:!0,forced:!Qp},{keyFor:function(e){if(!Yp(e))throw TypeError(Zp(e)+" is not a symbol");if(Jp($p,e))return $p[e]}});var em=Xs([].slice),rm=sd,tm=ou,nm=Qs,im=Ef,om=Xs([].push),am=od,sm=Mu,um=js,cm=lu,lm=Xs,dm=Ns,fm=ou,hm=tc,gm=em,pm=function(e){if(tm(e))return e;if(rm(e)){for(var r=e.length,t=[],n=0;n<r;n++){var i=e[n];"string"==typeof i?om(t,i):"number"!=typeof i&&"Number"!=nm(i)&&"String"!=nm(i)||om(t,im(i))}var o=t.length,a=!0;return function(e,r){if(a)return a=!1,r;if(rm(this))return r;for(var n=0;n<o;n++)if(t[n]===e)return r}}},mm=Yu,_m=String,vm=sm("JSON","stringify"),ym=lm(/./.exec),Im=lm("".charAt),Sm=lm("".charCodeAt),Tm=lm("".replace),bm=lm(1..toString),Em=/[\uD800-\uDFFF]/g,Cm=/^[\uD800-\uDBFF]$/,wm=/^[\uDC00-\uDFFF]$/,km=!mm||dm((function(){var e=sm("Symbol")();return"[null]"!=vm([e])||"{}"!=vm({a:e})||"{}"!=vm(Object(e))})),Dm=dm((function(){return'"\\udf06\\ud834"'!==vm("\udf06\ud834")||'"\\udead"'!==vm("\udead")})),xm=function(e,r){var t=gm(arguments),n=pm(r);if(fm(n)||e!==undefined&&!hm(e))return t[1]=function(e,r){if(fm(n)&&(r=cm(n,this,_m(e),r)),!hm(r))return r},um(vm,null,t)},Pm=function(e,r,t){var n=Im(t,r-1),i=Im(t,r+1);return ym(Cm,e)&&!ym(wm,i)||ym(wm,e)&&!ym(Cm,n)?"\\u"+bm(Sm(e,0),16):e};vm&&am({target:"JSON",stat:!0,arity:3,forced:km||Dm},{stringify:function(e,r,t){var n=gm(arguments),i=um(km?xm:vm,null,n);return Dm&&"string"==typeof i?Tm(i,Em,Pm):i}});var Fm=Wh,Wm=wc;od({target:"Object",stat:!0,forced:!Yu||Ns((function(){Fm.f(1)}))},{getOwnPropertySymbols:function(e){var r=Fm.f;return r?r(Wm(e)):[]}}),Kh("asyncIterator"),Kh("hasInstance"),Kh("isConcatSpreadable"),Kh("iterator"),Kh("match"),Kh("matchAll"),Kh("replace"),Kh("search"),Kh("species"),Kh("split");var Am=Zh;Kh("toPrimitive"),Am();var Rm=Mu,Om=ag;Kh("toStringTag"),Om(Rm("Symbol"),"Symbol"),Kh("unscopables"),ag(Ls.JSON,"JSON",!0);var Lm,Nm,Mm,Um=Au.Symbol,Bm={},Vm=su,Gm=xc,jm=Function.prototype,Hm=Vm&&Object.getOwnPropertyDescriptor,zm=Gm(jm,"name"),Km={EXISTS:zm,PROPER:zm&&"something"===function(){}.name,CONFIGURABLE:zm&&(!Vm||Vm&&Hm(jm,"name").configurable)},qm=!Ns((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),Xm=xc,Jm=ou,Ym=wc,Zm=qm,Qm=th("IE_PROTO"),$m=Object,e_=$m.prototype,r_=Zm?$m.getPrototypeOf:function(e){var r=Ym(e);if(Xm(r,Qm))return r[Qm];var t=r.constructor;return Jm(t)&&r instanceof t?t.prototype:r instanceof $m?e_:null},t_=Ns,n_=ou,i_=Wu,o_=mh,a_=r_,s_=Rh,u_=jc("iterator"),c_=!1;[].keys&&("next"in(Mm=[].keys())?(Nm=a_(a_(Mm)))!==Object.prototype&&(Lm=Nm):c_=!0);var l_=!i_(Lm)||t_((function(){var e={};return Lm[u_].call(e)!==e}));n_((Lm=l_?{}:o_(Lm))[u_])||s_(Lm,u_,(function(){return this}));var d_={IteratorPrototype:Lm,BUGGY_SAFARI_ITERATORS:c_},f_=d_.IteratorPrototype,h_=mh,g_=_u,p_=ag,m_=Bm,__=function(){return this},v_=function(e,r,t,n){var i=r+" Iterator";return e.prototype=h_(f_,{next:g_(+!n,t)}),p_(e,i,!1,!0),m_[i]=__,e},y_=Xs,I_=uc,S_=ou,T_=String,b_=TypeError,E_=function(e,r,t){try{return y_(I_(Object.getOwnPropertyDescriptor(e,r)[t]))}catch(Ke){}},C_=Al,w_=function(e){if("object"==typeof e||S_(e))return e;throw b_("Can't set "+T_(e)+" as a prototype")},k_=Object.setPrototypeOf||("__proto__"in{}?function(){var e,r=!1,t={};try{(e=E_(Object.prototype,"__proto__","set"))(t,[]),r=t instanceof Array}catch(Ke){}return function(t,n){return C_(t),w_(n),r?e(t,n):t.__proto__=n,t}}():undefined),D_=od,x_=lu,P_=Km,F_=v_,W_=r_,A_=ag,R_=Rh,O_=Bm,L_=d_,N_=P_.PROPER,M_=L_.BUGGY_SAFARI_ITERATORS,U_=jc("iterator"),B_="keys",V_="values",G_="entries",j_=function(){return this},H_=function(e,r,t,n,i,o,a){F_(t,r,n);var s,u,c,l=function(e){if(e===i&&p)return p;if(!M_&&e in h)return h[e];switch(e){case B_:case V_:case G_:return function(){return new t(this,e)}}return function(){return new t(this)}},d=r+" Iterator",f=!1,h=e.prototype,g=h[U_]||h["@@iterator"]||i&&h[i],p=!M_&&g||l(i),m="Array"==r&&h.entries||g;if(m&&(s=W_(m.call(new e)))!==Object.prototype&&s.next&&(A_(s,d,!0,!0),O_[d]=j_),N_&&i==V_&&g&&g.name!==V_&&(f=!0,p=function(){return x_(g,this)}),i)if(u={values:l(V_),keys:o?p:l(B_),entries:l(G_)},a)for(c in u)(M_||f||!(c in h))&&R_(h,c,u[c]);else D_({target:r,proto:!0,forced:M_||f},u);return a&&h[U_]!==p&&R_(h,U_,p,{name:i}),O_[r]=p,u},z_=function(e,r){return{value:e,done:r}},K_=xu,q_=function(){},X_=Bm,J_=Tg,Y_=(Dl.f,H_),Z_=z_,Q_="Array Iterator",$_=J_.set,ev=J_.getterFor(Q_);Y_(Array,"Array",(function(e,r){$_(this,{type:Q_,target:K_(e),index:0,kind:r})}),(function(){var e=ev(this),r=e.target,t=e.kind,n=e.index++;return!r||n>=r.length?(e.target=undefined,Z_(undefined,!0)):Z_("keys"==t?n:"values"==t?r[n]:[n,r[n]],!1)}),"values");X_.Arguments=X_.Array;q_(),q_(),q_();var rv={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},tv=Ls,nv=Fd,iv=ql,ov=Bm,av=jc("toStringTag");for(var sv in rv){var uv=tv[sv],cv=uv&&uv.prototype;cv&&nv(cv)!==av&&iv(cv,av,sv),ov[sv]=ov.Array}var lv=Um;Kh("dispose");var dv=lv;Kh("asyncDispose");var fv=od,hv=Xs,gv=Mu("Symbol"),pv=gv.keyFor,mv=hv(gv.prototype.valueOf);fv({target:"Symbol",stat:!0},{isRegistered:function(e){try{return pv(mv(e))!==undefined}catch(Ke){return!1}}});for(var _v=od,vv=bc,yv=Mu,Iv=Xs,Sv=tc,Tv=jc,bv=yv("Symbol"),Ev=bv.isWellKnown,Cv=yv("Object","getOwnPropertyNames"),wv=Iv(bv.prototype.valueOf),kv=vv("wks"),Dv=0,xv=Cv(bv),Pv=xv.length;Dv<Pv;Dv++)try{var Fv=xv[Dv];Sv(bv[Fv])&&Tv(Fv)}catch(Ke){}_v({target:"Symbol",stat:!0,forced:!0},{isWellKnown:function(e){if(Ev&&Ev(e))return!0;try{for(var r=wv(e),t=0,n=Cv(kv),i=n.length;t<i;t++)if(kv[n[t]]==r)return!0}catch(Ke){}return!1}}),Kh("matcher"),Kh("metadataKey"),Kh("observable"),Kh("metadata"),Kh("patternMatch"),Kh("replaceAll");var Wv=oe(dv),Av=Xs,Rv=fd,Ov=Ef,Lv=wu,Nv=Av("".charAt),Mv=Av("".charCodeAt),Uv=Av("".slice),Bv=function(e){return function(r,t){var n,i,o=Ov(Lv(r)),a=Rv(t),s=o.length;return a<0||a>=s?e?"":undefined:(n=Mv(o,a))<55296||n>56319||a+1===s||(i=Mv(o,a+1))<56320||i>57343?e?Nv(o,a):n:e?Uv(o,a,a+2):i-56320+(n-55296<<10)+65536}},Vv={codeAt:Bv(!1),charAt:Bv(!0)},Gv=Vv.charAt,jv=Ef,Hv=Tg,zv=H_,Kv=z_,qv="String Iterator",Xv=Hv.set,Jv=Hv.getterFor(qv);zv(String,"String",(function(e){Xv(this,{type:qv,string:jv(e),index:0})}),(function(){var e,r=Jv(this),t=r.string,n=r.index;return n>=t.length?Kv(undefined,!0):(e=Gv(t,n),r.index+=e.length,Kv(e,!1))}));var Yv=oe(Nh.f("iterator"));function Zv(e){return Zv="function"==typeof Wv&&"symbol"==typeof Yv?function(e){return typeof e}:function(e){return e&&"function"==typeof Wv&&e.constructor===Wv&&e!==Wv.prototype?"symbol":typeof e},Zv(e)}var Qv={exports:{}},$v=od,ey=su,ry=Dl.f;$v({target:"Object",stat:!0,forced:Object.defineProperty!==ry,sham:!ey},{defineProperty:ry});var ty=Au.Object,ny=Qv.exports=function(e,r,t){return ty.defineProperty(e,r,t)};ty.defineProperty.sham&&(ny.sham=!0);var iy=Qv.exports,oy=oe(iy);od({target:"Object",stat:!0,sham:!su},{create:mh});var ay=Au.Object,sy=function(e,r){return ay.create(e,r)},uy=oe(sy),cy=wc,ly=r_,dy=qm;od({target:"Object",stat:!0,forced:Ns((function(){ly(1)})),sham:!dy},{getPrototypeOf:function(e){return ly(cy(e))}});var fy=oe(Au.Object.getPrototypeOf),hy=Ns,gy=function(e,r){var t=[][e];return!!t&&hy((function(){t.call(null,r||function(){return 1},1)}))},py=Pg.forEach,my=gy("forEach")?[].forEach:function(e){return py(this,e,arguments.length>1?arguments[1]:undefined)};od({target:"Array",proto:!0,forced:[].forEach!=my},{forEach:my});var _y=Au,vy=function(e){return _y[e+"Prototype"]},yy=vy("Array").forEach,Iy=Fd,Sy=xc,Ty=Uu,by=yy,Ey=Array.prototype,Cy={DOMTokenList:!0,NodeList:!0},wy=function(e){var r=e.forEach;return e===Ey||Ty(Ey,e)&&r===Ey.forEach||Sy(Cy,Iy(e))?by:r},ky=oe(wy);od({target:"Object",stat:!0},{setPrototypeOf:k_});var Dy=oe(Au.Object.setPrototypeOf),xy=Mu,Py=_h,Fy=Wh,Wy=Al,Ay=Xs([].concat),Ry=xy("Reflect","ownKeys")||function(e){var r=Py.f(Wy(e)),t=Fy.f;return t?Ay(r,t(e)):r},Oy=xc,Ly=Ry,Ny=au,My=Dl,Uy=Wu,By=ql,Vy=Error,Gy=Xs("".replace),jy=String(Vy("zxcasd").stack),Hy=/\n\s*at [^:]*:[^\n]*/,zy=Hy.test(jy),Ky=_u,qy=!Ns((function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",Ky(1,7)),7!==e.stack)})),Xy=ql,Jy=function(e,r){if(zy&&"string"==typeof e&&!Vy.prepareStackTrace)for(;r--;)e=Gy(e,Hy,"");return e},Yy=qy,Zy=Error.captureStackTrace,Qy=Bm,$y=jc("iterator"),eI=Array.prototype,rI=function(e){return e!==undefined&&(Qy.Array===e||eI[$y]===e)},tI=Fd,nI=dc,iI=bu,oI=Bm,aI=jc("iterator"),sI=function(e){if(!iI(e))return nI(e,aI)||nI(e,"@@iterator")||oI[tI(e)]},uI=lu,cI=uc,lI=Al,dI=ic,fI=sI,hI=TypeError,gI=function(e,r){var t=arguments.length<2?fI(e):r;if(cI(t))return lI(uI(t,e));throw hI(dI(e)+" is not iterable")},pI=lu,mI=Al,_I=dc,vI=function(e,r,t){var n,i;mI(e);try{if(!(n=_I(e,"return"))){if("throw"===r)throw t;return t}n=pI(n,e)}catch(Ke){i=!0,n=Ke}if("throw"===r)throw t;if(i)throw n;return mI(n),t},yI=kl,II=lu,SI=Al,TI=ic,bI=rI,EI=md,CI=Uu,wI=gI,kI=sI,DI=vI,xI=TypeError,PI=function(e,r){this.stopped=e,this.result=r},FI=PI.prototype,WI=function(e,r,t){var n,i,o,a,s,u,c,l=t&&t.that,d=!(!t||!t.AS_ENTRIES),f=!(!t||!t.IS_RECORD),h=!(!t||!t.IS_ITERATOR),g=!(!t||!t.INTERRUPTED),p=yI(r,l),m=function(e){return n&&DI(n,"normal",e),new PI(!0,e)},_=function(e){return d?(SI(e),g?p(e[0],e[1],m):p(e[0],e[1])):g?p(e,m):p(e)};if(f)n=e.iterator;else if(h)n=e;else{if(!(i=kI(e)))throw xI(TI(e)+" is not iterable");if(bI(i)){for(o=0,a=EI(e);a>o;o++)if((s=_(e[o]))&&CI(FI,s))return s;return new PI(!1)}n=wI(e,i)}for(u=f?e.next:n.next;!(c=II(u,n)).done;){try{s=_(c.value)}catch(Ke){DI(n,"throw",Ke)}if("object"==typeof s&&s&&CI(FI,s))return s}return new PI(!1)},AI=Ef,RI=od,OI=Uu,LI=r_,NI=k_,MI=function(e,r,t){for(var n=Ly(r),i=My.f,o=Ny.f,a=0;a<n.length;a++){var s=n[a];Oy(e,s)||t&&Oy(t,s)||i(e,s,o(r,s))}},UI=mh,BI=ql,VI=_u,GI=function(e,r){Uy(r)&&"cause"in r&&By(e,"cause",r.cause)},jI=function(e,r,t,n){Yy&&(Zy?Zy(e,r):Xy(e,"stack",Jy(t,n)))},HI=WI,zI=function(e,r){return e===undefined?arguments.length<2?"":r:AI(e)},KI=jc("toStringTag"),qI=Error,XI=[].push,JI=function(e,r){var t,n=OI(YI,this);NI?t=NI(qI(),n?LI(this):YI):(t=n?this:UI(YI),BI(t,KI,"Error")),r!==undefined&&BI(t,"message",zI(r)),jI(t,JI,t.stack,1),arguments.length>2&&GI(t,arguments[2]);var i=[];return HI(e,XI,{that:i}),BI(t,"errors",i),t};NI?NI(JI,qI):MI(JI,qI,{name:!0});var YI=JI.prototype=UI(qI.prototype,{constructor:VI(1,JI),message:VI(1,""),name:VI(1,"AggregateError")});RI({global:!0,constructor:!0,arity:2},{AggregateError:JI});var ZI,QI,$I,eS,rS="undefined"!=typeof process&&"process"==Qs(process),tS=Mu,nS=Lh,iS=su,oS=jc("species"),aS=Uu,sS=TypeError,uS=function(e,r){if(aS(r,e))return e;throw sS("Incorrect invocation")},cS=Jd,lS=ic,dS=TypeError,fS=function(e){if(cS(e))return e;throw dS(lS(e)+" is not a constructor")},hS=Al,gS=fS,pS=bu,mS=jc("species"),_S=function(e,r){var t,n=hS(e).constructor;return n===undefined||pS(t=hS(n)[mS])?r:gS(t)},vS=TypeError,yS=function(e,r){if(e<r)throw vS("Not enough arguments");return e},IS=/(?:ipad|iphone|ipod).*applewebkit/i.test(Bu),SS=Ls,TS=js,bS=kl,ES=ou,CS=xc,wS=Ns,kS=$f,DS=em,xS=nl,PS=yS,FS=IS,WS=rS,AS=SS.setImmediate,RS=SS.clearImmediate,OS=SS.process,LS=SS.Dispatch,NS=SS.Function,MS=SS.MessageChannel,US=SS.String,BS=0,VS={},GS="onreadystatechange";wS((function(){ZI=SS.location}));var jS=function(e){if(CS(VS,e)){var r=VS[e];delete VS[e],r()}},HS=function(e){return function(){jS(e)}},zS=function(e){jS(e.data)},KS=function(e){SS.postMessage(US(e),ZI.protocol+"//"+ZI.host)};AS&&RS||(AS=function(e){PS(arguments.length,1);var r=ES(e)?e:NS(e),t=DS(arguments,1);return VS[++BS]=function(){TS(r,undefined,t)},QI(BS),BS},RS=function(e){delete VS[e]},WS?QI=function(e){OS.nextTick(HS(e))}:LS&&LS.now?QI=function(e){LS.now(HS(e))}:MS&&!FS?(eS=($I=new MS).port2,$I.port1.onmessage=zS,QI=bS(eS.postMessage,eS)):SS.addEventListener&&ES(SS.postMessage)&&!SS.importScripts&&ZI&&"file:"!==ZI.protocol&&!wS(KS)?(QI=KS,SS.addEventListener("message",zS,!1)):QI=GS in xS("script")?function(e){kS.appendChild(xS("script"))[GS]=function(){kS.removeChild(this),jS(e)}}:function(e){setTimeout(HS(e),0)});var qS={set:AS,clear:RS},XS=function(){this.head=null,this.tail=null};XS.prototype={add:function(e){var r={item:e,next:null},t=this.tail;t?t.next=r:this.head=r,this.tail=r},get:function(){var e=this.head;if(e)return null===(this.head=e.next)&&(this.tail=null),e.item}};var JS,YS,ZS,QS,$S,eT=XS,rT=/ipad|iphone|ipod/i.test(Bu)&&"undefined"!=typeof Pebble,tT=/web0s(?!.*chrome)/i.test(Bu),nT=Ls,iT=kl,oT=au.f,aT=qS.set,sT=eT,uT=IS,cT=rT,lT=tT,dT=rS,fT=nT.MutationObserver||nT.WebKitMutationObserver,hT=nT.document,gT=nT.process,pT=nT.Promise,mT=oT(nT,"queueMicrotask"),_T=mT&&mT.value;if(!_T){var vT=new sT,yT=function(){var e,r;for(dT&&(e=gT.domain)&&e.exit();r=vT.get();)try{r()}catch(Ke){throw vT.head&&JS(),Ke}e&&e.enter()};uT||dT||lT||!fT||!hT?!cT&&pT&&pT.resolve?((QS=pT.resolve(undefined)).constructor=pT,$S=iT(QS.then,QS),JS=function(){$S(yT)}):dT?JS=function(){gT.nextTick(yT)}:(aT=iT(aT,nT),JS=function(){aT(yT)}):(YS=!0,ZS=hT.createTextNode(""),new fT(yT).observe(ZS,{characterData:!0}),JS=function(){ZS.data=YS=!YS}),_T=function(e){vT.head||JS(),vT.add(e)}}var IT=_T,ST=function(e){try{return{error:!1,value:e()}}catch(Ke){return{error:!0,value:Ke}}},TT=Ls.Promise,bT="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,ET=!bT&&!rS&&"object"==typeof window&&"object"==typeof document,CT=Ls,wT=TT,kT=ou,DT=bl,xT=Od,PT=jc,FT=ET,WT=bT,AT=qu,RT=wT&&wT.prototype,OT=PT("species"),LT=!1,NT=kT(CT.PromiseRejectionEvent),MT=DT("Promise",(function(){var e=xT(wT),r=e!==String(wT);if(!r&&66===AT)return!0;if(!RT["catch"]||!RT["finally"])return!0;if(!AT||AT<51||!/native code/.test(e)){var t=new wT((function(e){e(1)})),n=function(e){e((function(){}),(function(){}))};if((t.constructor={})[OT]=n,!(LT=t.then((function(){}))instanceof n))return!0}return!r&&(FT||WT)&&!NT})),UT={CONSTRUCTOR:MT,REJECTION_EVENT:NT,SUBCLASSING:LT},BT={},VT=uc,GT=TypeError,jT=function(e){var r,t;this.promise=new e((function(e,n){if(r!==undefined||t!==undefined)throw GT("Bad Promise constructor");r=e,t=n})),this.resolve=VT(r),this.reject=VT(t)};BT.f=function(e){return new jT(e)};var HT,zT,KT=od,qT=rS,XT=Ls,JT=lu,YT=Rh,ZT=ag,QT=function(e){var r=tS(e);iS&&r&&!r[oS]&&nS(r,oS,{configurable:!0,get:function(){return this}})},$T=uc,eb=ou,rb=Wu,tb=uS,nb=_S,ib=qS.set,ob=IT,ab=function(e,r){},sb=ST,ub=eT,cb=Tg,lb=TT,db=UT,fb=BT,hb="Promise",gb=db.CONSTRUCTOR,pb=db.REJECTION_EVENT,mb=cb.getterFor(hb),_b=cb.set,vb=lb&&lb.prototype,yb=lb,Ib=vb,Sb=XT.TypeError,Tb=XT.document,bb=XT.process,Eb=fb.f,Cb=Eb,wb=!!(Tb&&Tb.createEvent&&XT.dispatchEvent),kb="unhandledrejection",Db=function(e){var r;return!(!rb(e)||!eb(r=e.then))&&r},xb=function(e,r){var t,n,i,o=r.value,a=1==r.state,s=a?e.ok:e.fail,u=e.resolve,c=e.reject,l=e.domain;try{s?(a||(2===r.rejection&&Rb(r),r.rejection=1),!0===s?t=o:(l&&l.enter(),t=s(o),l&&(l.exit(),i=!0)),t===e.promise?c(Sb("Promise-chain cycle")):(n=Db(t))?JT(n,t,u,c):u(t)):c(o)}catch(Ke){l&&!i&&l.exit(),c(Ke)}},Pb=function(e,r){e.notified||(e.notified=!0,ob((function(){for(var t,n=e.reactions;t=n.get();)xb(t,e);e.notified=!1,r&&!e.rejection&&Wb(e)})))},Fb=function(e,r,t){var n,i;wb?((n=Tb.createEvent("Event")).promise=r,n.reason=t,n.initEvent(e,!1,!0),XT.dispatchEvent(n)):n={promise:r,reason:t},!pb&&(i=XT["on"+e])?i(n):e===kb&&ab("Unhandled promise rejection",t)},Wb=function(e){JT(ib,XT,(function(){var r,t=e.facade,n=e.value;if(Ab(e)&&(r=sb((function(){qT?bb.emit("unhandledRejection",n,t):Fb(kb,t,n)})),e.rejection=qT||Ab(e)?2:1,r.error))throw r.value}))},Ab=function(e){return 1!==e.rejection&&!e.parent},Rb=function(e){JT(ib,XT,(function(){var r=e.facade;qT?bb.emit("rejectionHandled",r):Fb("rejectionhandled",r,e.value)}))},Ob=function(e,r,t){return function(n){e(r,n,t)}},Lb=function(e,r,t){e.done||(e.done=!0,t&&(e=t),e.value=r,e.state=2,Pb(e,!0))},Nb=function(e,r,t){if(!e.done){e.done=!0,t&&(e=t);try{if(e.facade===r)throw Sb("Promise can't be resolved itself");var n=Db(r);n?ob((function(){var t={done:!1};try{JT(n,r,Ob(Nb,t,e),Ob(Lb,t,e))}catch(Ke){Lb(t,Ke,e)}})):(e.value=r,e.state=1,Pb(e,!1))}catch(Ke){Lb({done:!1},Ke,e)}}};gb&&(Ib=(yb=function(e){tb(this,Ib),$T(e),JT(HT,this);var r=mb(this);try{e(Ob(Nb,r),Ob(Lb,r))}catch(Ke){Lb(r,Ke)}}).prototype,(HT=function(e){_b(this,{type:hb,done:!1,notified:!1,parent:!1,reactions:new ub,rejection:!1,state:0,value:undefined})}).prototype=YT(Ib,"then",(function(e,r){var t=mb(this),n=Eb(nb(this,yb));return t.parent=!0,n.ok=!eb(e)||e,n.fail=eb(r)&&r,n.domain=qT?bb.domain:undefined,0==t.state?t.reactions.add(n):ob((function(){xb(n,t)})),n.promise})),zT=function(){var e=new HT,r=mb(e);this.promise=e,this.resolve=Ob(Nb,r),this.reject=Ob(Lb,r)},fb.f=Eb=function(e){return e===yb||undefined===e?new zT(e):Cb(e)}),KT({global:!0,constructor:!0,wrap:!0,forced:gb},{Promise:yb}),ZT(yb,hb,!1,!0),QT(hb);var Mb=jc("iterator"),Ub=!1;try{var Bb=0,Vb={next:function(){return{done:!!Bb++}},"return":function(){Ub=!0}};Vb[Mb]=function(){return this},Array.from(Vb,(function(){throw 2}))}catch(Ke){}var Gb=function(e,r){if(!r&&!Ub)return!1;var t=!1;try{var n={};n[Mb]=function(){return{next:function(){return{done:t=!0}}}},e(n)}catch(Ke){}return t},jb=TT,Hb=UT.CONSTRUCTOR||!Gb((function(e){jb.all(e).then(undefined,(function(){}))})),zb=lu,Kb=uc,qb=BT,Xb=ST,Jb=WI;od({target:"Promise",stat:!0,forced:Hb},{all:function(e){var r=this,t=qb.f(r),n=t.resolve,i=t.reject,o=Xb((function(){var t=Kb(r.resolve),o=[],a=0,s=1;Jb(e,(function(e){var u=a++,c=!1;s++,zb(t,r,e).then((function(e){c||(c=!0,o[u]=e,--s||n(o))}),i)})),--s||n(o)}));return o.error&&i(o.value),t.promise}});var Yb=od,Zb=UT.CONSTRUCTOR;TT&&TT.prototype,Yb({target:"Promise",proto:!0,forced:Zb,real:!0},{"catch":function(e){return this.then(undefined,e)}});var Qb=lu,$b=uc,eE=BT,rE=ST,tE=WI;od({target:"Promise",stat:!0,forced:Hb},{race:function(e){var r=this,t=eE.f(r),n=t.reject,i=rE((function(){var i=$b(r.resolve);tE(e,(function(e){Qb(i,r,e).then(t.resolve,n)}))}));return i.error&&n(i.value),t.promise}});var nE=lu,iE=BT;od({target:"Promise",stat:!0,forced:UT.CONSTRUCTOR},{reject:function(e){var r=iE.f(this);return nE(r.reject,undefined,e),r.promise}});var oE=Al,aE=Wu,sE=BT,uE=function(e,r){if(oE(e),aE(r)&&r.constructor===e)return r;var t=sE.f(e);return(0,t.resolve)(r),t.promise},cE=od,lE=TT,dE=UT.CONSTRUCTOR,fE=uE,hE=Mu("Promise"),gE=!dE;cE({target:"Promise",stat:!0,forced:true},{resolve:function(e){return fE(gE&&this===hE?lE:this,e)}});var pE=lu,mE=uc,_E=BT,vE=ST,yE=WI;od({target:"Promise",stat:!0,forced:Hb},{allSettled:function(e){var r=this,t=_E.f(r),n=t.resolve,i=t.reject,o=vE((function(){var t=mE(r.resolve),i=[],o=0,a=1;yE(e,(function(e){var s=o++,u=!1;a++,pE(t,r,e).then((function(e){u||(u=!0,i[s]={status:"fulfilled",value:e},--a||n(i))}),(function(e){u||(u=!0,i[s]={status:"rejected",reason:e},--a||n(i))}))})),--a||n(i)}));return o.error&&i(o.value),t.promise}});var IE=lu,SE=uc,TE=Mu,bE=BT,EE=ST,CE=WI,wE="No one promise resolved";od({target:"Promise",stat:!0,forced:Hb},{any:function(e){var r=this,t=TE("AggregateError"),n=bE.f(r),i=n.resolve,o=n.reject,a=EE((function(){var n=SE(r.resolve),a=[],s=0,u=1,c=!1;CE(e,(function(e){var l=s++,d=!1;u++,IE(n,r,e).then((function(e){d||c||(c=!0,i(e))}),(function(e){d||c||(d=!0,a[l]=e,--u||o(new t(a,wE)))}))})),--u||o(new t(a,wE))}));return a.error&&o(a.value),n.promise}});var kE=od,DE=TT,xE=Ns,PE=Mu,FE=ou,WE=_S,AE=uE,RE=DE&&DE.prototype;kE({target:"Promise",proto:!0,real:!0,forced:!!DE&&xE((function(){RE["finally"].call({then:function(){}},(function(){}))}))},{"finally":function(e){var r=WE(this,PE("Promise")),t=FE(e);return this.then(t?function(t){return AE(r,e()).then((function(){return t}))}:e,t?function(t){return AE(r,e()).then((function(){throw t}))}:e)}});var OE=Au.Promise,LE=OE,NE=BT,ME=ST;od({target:"Promise",stat:!0,forced:!0},{"try":function(e){var r=NE.f(this),t=ME(e);return(t.error?r.reject:r.resolve)(t.value),r.promise}});var UE=oe(LE),BE=od,VE=sd,GE=Xs([].reverse),jE=[1,2];BE({target:"Array",proto:!0,forced:String(jE)===String(jE.reverse())},{reverse:function(){return VE(this)&&(this.length=this.length),GE(this)}});var HE=vy("Array").reverse,zE=Uu,KE=HE,qE=Array.prototype,XE=oe((function(e){var r=e.reverse;return e===qE||zE(qE,e)&&r===qE.reverse?KE:r})),JE=od,YE=sd,ZE=Jd,QE=Wu,$E=xf,eC=md,rC=xu,tC=Td,nC=jc,iC=em,oC=sf("slice"),aC=nC("species"),sC=Array,uC=Math.max;JE({target:"Array",proto:!0,forced:!oC},{slice:function(e,r){var t,n,i,o=rC(this),a=eC(o),s=$E(e,a),u=$E(r===undefined?a:r,a);if(YE(o)&&(t=o.constructor,(ZE(t)&&(t===sC||YE(t.prototype))||QE(t)&&null===(t=t[aC]))&&(t=undefined),t===sC||t===undefined))return iC(o,s,u);for(n=new(t===undefined?sC:t)(uC(u-s,0)),i=0;s<u;s++,i++)s in o&&tC(n,i,o[s]);return n.length=i,n}});var cC=vy("Array").slice,lC=Uu,dC=cC,fC=Array.prototype,hC=function(e){var r=e.slice;return e===fC||lC(fC,e)&&r===fC.slice?dC:r},gC=oe(hC);function pC(){pC=function(){return e};var e={},r=Object.prototype,t=r.hasOwnProperty,n=oy||function(e,r,t){e[r]=t.value},i="function"==typeof Wv?Wv:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(e,r,t){return oy(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{u({},"")}catch(k){u=function(e,r,t){return e[r]=t}}function c(e,r,t,i){var o=r&&r.prototype instanceof f?r:f,a=uy(o.prototype),s=new E(i||[]);return n(a,"_invoke",{value:I(e,t,s)}),a}function l(e,r,t){try{return{type:"normal",arg:e.call(r,t)}}catch(k){return{type:"throw",arg:k}}}e.wrap=c;var d={};function f(){}function h(){}function g(){}var p={};u(p,o,(function(){return this}));var m=fy&&fy(fy(C([])));m&&m!==r&&t.call(m,o)&&(p=m);var _=g.prototype=f.prototype=uy(p);function v(e){var r;ky(r=["next","throw","return"]).call(r,(function(r){u(e,r,(function(e){return this._invoke(r,e)}))}))}function y(e,r){function i(n,o,a,s){var u=l(e[n],e,o);if("throw"!==u.type){var c=u.arg,d=c.value;return d&&"object"==Zv(d)&&t.call(d,"__await")?r.resolve(d.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):r.resolve(d).then((function(e){c.value=e,a(c)}),(function(e){return i("throw",e,a,s)}))}s(u.arg)}var o;n(this,"_invoke",{value:function(e,t){function n(){return new r((function(r,n){i(e,t,r,n)}))}return o=o?o.then(n,n):n()}})}function I(e,r,t){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return w()}for(t.method=i,t.arg=o;;){var a=t.delegate;if(a){var s=S(a,t);if(s){if(s===d)continue;return s}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if("suspendedStart"===n)throw n="completed",t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);n="executing";var u=l(e,r,t);if("normal"===u.type){if(n=t.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:t.done}}"throw"===u.type&&(n="completed",t.method="throw",t.arg=u.arg)}}}function S(e,r){var t=r.method,n=e.iterator[t];if(undefined===n)return r.delegate=null,"throw"===t&&e.iterator["return"]&&(r.method="return",r.arg=undefined,S(e,r),"throw"===r.method)||"return"!==t&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+t+"' method")),d;var i=l(n,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,d;var o=i.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=undefined),r.delegate=null,d):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function T(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function b(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function E(e){this.tryEntries=[{tryLoc:"root"}],ky(e).call(e,T,this),this.reset(!0)}function C(e){if(e){var r=e[o];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function r(){for(;++n<e.length;)if(t.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=undefined,r.done=!0,r};return i.next=i}}return{next:w}}function w(){return{value:undefined,done:!0}}return h.prototype=g,n(_,"constructor",{value:g,configurable:!0}),n(g,"constructor",{value:h,configurable:!0}),h.displayName=u(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var r="function"==typeof e&&e.constructor;return!!r&&(r===h||"GeneratorFunction"===(r.displayName||r.name))},e.mark=function(e){return Dy?Dy(e,g):(e.__proto__=g,u(e,s,"GeneratorFunction")),e.prototype=uy(_),e},e.awrap=function(e){return{__await:e}},v(y.prototype),u(y.prototype,a,(function(){return this})),e.AsyncIterator=y,e.async=function(r,t,n,i,o){void 0===o&&(o=UE);var a=new y(c(r,t,n,i),o);return e.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},v(_),u(_,s,"Generator"),u(_,o,(function(){return this})),u(_,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var r=Object(e),t=[];for(var n in r)t.push(n);return XE(t).call(t),function i(){for(;t.length;){var e=t.pop();if(e in r)return i.value=e,i.done=!1,i}return i.done=!0,i}},e.values=C,E.prototype={constructor:E,reset:function(e){var r;if(this.prev=0,this.next=0,this.sent=this._sent=undefined,this.done=!1,this.delegate=null,this.method="next",this.arg=undefined,ky(r=this.tryEntries).call(r,b),!e)for(var n in this)"t"===n.charAt(0)&&t.call(this,n)&&!isNaN(+gC(n).call(n,1))&&(this[n]=undefined)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(t,n){return a.type="throw",a.arg=e,r.next=t,n&&(r.method="next",r.arg=undefined),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var s=t.call(o,"catchLoc"),u=t.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,r){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&t.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=r&&r<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=r,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(a)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),d},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var t=this.tryEntries[r];if(t.finallyLoc===e)return this.complete(t.completion,t.afterLoc),b(t),d}},"catch":function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var t=this.tryEntries[r];if(t.tryLoc===e){var n=t.completion;if("throw"===n.type){var i=n.arg;b(t)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,t){return this.delegate={iterator:C(e),resultName:r,nextLoc:t},"next"===this.method&&(this.arg=undefined),d}},e}function mC(e,r,t,n,i,o,a){try{var s=e[o](a),u=s.value}catch(Ke){return void t(Ke)}s.done?r(u):UE.resolve(u).then(n,i)}function _C(e){return function(){var r=this,t=arguments;return new UE((function(n,i){var o=e.apply(r,t);function a(e){mC(o,n,i,a,s,"next",e)}function s(e){mC(o,n,i,a,s,"throw",e)}a(undefined)}))}}var vC=wc,yC=zf;od({target:"Object",stat:!0,forced:Ns((function(){yC(1)}))},{keys:function(e){return yC(vC(e))}});var IC=Au.Object.keys,SC=oe(IC),TC=oe(Au.Object.getOwnPropertySymbols),bC=Pg.filter;od({target:"Array",proto:!0,forced:!sf("filter")},{filter:function(e){return bC(this,e,arguments.length>1?arguments[1]:undefined)}});var EC=vy("Array").filter,CC=Uu,wC=EC,kC=Array.prototype,DC=function(e){var r=e.filter;return e===kC||CC(kC,e)&&r===kC.filter?wC:r},xC=oe(DC),PC={exports:{}},FC=od,WC=Ns,AC=xu,RC=au.f,OC=su;FC({target:"Object",stat:!0,forced:!OC||WC((function(){RC(1)})),sham:!OC},{getOwnPropertyDescriptor:function(e,r){return RC(AC(e),r)}});var LC=Au.Object,NC=PC.exports=function(e,r){return LC.getOwnPropertyDescriptor(e,r)};LC.getOwnPropertyDescriptor.sham&&(NC.sham=!0);var MC=oe(PC.exports),UC=Ry,BC=xu,VC=au,GC=Td;od({target:"Object",stat:!0,sham:!su},{getOwnPropertyDescriptors:function(e){for(var r,t,n=BC(e),i=VC.f,o=UC(n),a={},s=0;o.length>s;)(t=i(n,r=o[s++]))!==undefined&&GC(a,r,t);return a}});var jC=oe(Au.Object.getOwnPropertyDescriptors),HC={exports:{}},zC=od,KC=su,qC=Cf.f;zC({target:"Object",stat:!0,forced:Object.defineProperties!==qC,sham:!KC},{defineProperties:qC});var XC=Au.Object,JC=HC.exports=function(e,r){return XC.defineProperties(e,r)};XC.defineProperties.sham&&(JC.sham=!0);var YC=oe(HC.exports),ZC=oe(Nh.f("toPrimitive"));function QC(e){var r=function(e,r){if("object"!==Zv(e)||null===e)return e;var t=e[ZC];if(t!==undefined){var n=t.call(e,r||"default");if("object"!==Zv(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"===Zv(r)?r:String(r)}function $C(e,r,t){return(r=QC(r))in e?oy(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function ew(e,r){var t=SC(e);if(TC){var n=TC(e);r&&(n=xC(n).call(n,(function(r){return MC(e,r).enumerable}))),t.push.apply(t,n)}return t}function rw(e){for(var r=1;r<arguments.length;r++){var t,n,i=null!=arguments[r]?arguments[r]:{};r%2?ky(t=ew(Object(i),!0)).call(t,(function(r){$C(e,r,i[r])})):jC?YC(e,jC(i)):ky(n=ew(Object(i))).call(n,(function(r){oy(e,r,MC(i,r))}))}return e}function tw(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var nw=xc,iw=lu,ow=Wu,aw=Al,sw=function(e){return e!==undefined&&(nw(e,"value")||nw(e,"writable"))},uw=au,cw=r_;od({target:"Reflect",stat:!0},{get:function VL(e,r){var t,n,i=arguments.length<3?e:arguments[2];return aw(e)===i?e[r]:(t=uw.f(e,r))?sw(t)?t.value:t.get===undefined?undefined:iw(t.get,i):ow(n=cw(e))?VL(n,r,i):void 0}});var lw=oe(Au.Reflect.get),dw=Xs,fw=uc,hw=Wu,gw=xc,pw=em,mw=Ms,_w=Function,vw=dw([].concat),yw=dw([].join),Iw={},Sw=mw?_w.bind:function(e){var r=fw(this),t=r.prototype,n=pw(arguments,1),i=function(){var t=vw(n,pw(arguments));return this instanceof i?function(e,r,t){if(!gw(Iw,r)){for(var n=[],i=0;i<r;i++)n[i]="a["+i+"]";Iw[r]=_w("C,a","return new C("+yw(n,",")+")")}return Iw[r](e,t)}(r,t.length,t):r.apply(e,t)};return hw(t)&&(i.prototype=t),i},Tw=Sw;od({target:"Function",proto:!0,forced:Function.bind!==Tw},{bind:Tw});var bw=vy("Function").bind,Ew=Uu,Cw=bw,ww=Function.prototype,kw=oe((function(e){var r=e.bind;return e===ww||Ew(ww,e)&&r===ww.bind?Cw:r}));function Dw(e){var r;return Dw=Dy?kw(r=fy).call(r):function(e){return e.__proto__||fy(e)},Dw(e)}function xw(){var e;"undefined"!=typeof Reflect&&lw?xw=kw(e=lw).call(e):xw=function(e,r,t){var n=function(e,r){for(;!Object.prototype.hasOwnProperty.call(e,r)&&null!==(e=Dw(e)););return e}(e,r);if(n){var i=MC(n,r);return i.get?i.get.call(arguments.length<3?e:t):i.value}};return xw.apply(this,arguments)}function Pw(e,r){var t;return Pw=Dy?kw(t=Dy).call(t):function(e,r){return e.__proto__=r,e},Pw(e,r)}function Fw(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");e.prototype=uy(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),oy(e,"prototype",{writable:!1}),r&&Pw(e,r)}var Ww=od,Aw=js,Rw=Sw,Ow=fS,Lw=Al,Nw=Wu,Mw=mh,Uw=Ns,Bw=Mu("Reflect","construct"),Vw=Object.prototype,Gw=[].push,jw=Uw((function(){function e(){}return!(Bw((function(){}),[],e)instanceof e)})),Hw=!Uw((function(){Bw((function(){}))})),zw=jw||Hw;Ww({target:"Reflect",stat:!0,forced:zw,sham:zw},{construct:function(e,r){Ow(e),Lw(r);var t=arguments.length<3?e:Ow(arguments[2]);if(Hw&&!jw)return Bw(e,r,t);if(e==t){switch(r.length){case 0:return new e;case 1:return new e(r[0]);case 2:return new e(r[0],r[1]);case 3:return new e(r[0],r[1],r[2]);case 4:return new e(r[0],r[1],r[2],r[3])}var n=[null];return Aw(Gw,n,r),new(Aw(Rw,e,n))}var i=t.prototype,o=Mw(Nw(i)?i:Vw),a=Aw(e,o,r);return Nw(a)?a:o}});var Kw=oe(Au.Reflect.construct);function qw(e){var r=function(){if("undefined"==typeof Reflect||!Kw)return!1;if(Kw.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Kw(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=Dw(e);if(r){var i=Dw(this).constructor;t=Kw(n,arguments,i)}else t=n.apply(this,arguments);return function(e,r){if(r&&("object"===Zv(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return tw(e)}(this,t)}}od({target:"Array",stat:!0},{isArray:sd});var Xw=Au.Array.isArray,Jw=oe(Xw);var Yw=oe(sI);var Zw=Al,Qw=vI,$w=kl,ek=lu,rk=wc,tk=function(e,r,t,n){try{return n?r(Zw(t)[0],t[1]):r(t)}catch(Ke){Qw(e,"throw",Ke)}},nk=rI,ik=Jd,ok=md,ak=Td,sk=gI,uk=sI,ck=Array,lk=function(e){var r=rk(e),t=ik(this),n=arguments.length,i=n>1?arguments[1]:undefined,o=i!==undefined;o&&(i=$w(i,n>2?arguments[2]:undefined));var a,s,u,c,l,d,f=uk(r),h=0;if(!f||this===ck&&nk(f))for(a=ok(r),s=t?new this(a):ck(a);a>h;h++)d=o?i(r[h],h):r[h],ak(s,h,d);else for(l=(c=sk(r,f)).next,s=t?new this:[];!(u=ek(l,c)).done;h++)d=o?tk(c,i,[u.value,h],!0):u.value,ak(s,h,d);return s.length=h,s},dk=lk;od({target:"Array",stat:!0,forced:!Gb((function(e){Array.from(e)}))},{from:dk});var fk=Au.Array.from,hk=oe(fk);function gk(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function pk(e,r){var t;if(e){if("string"==typeof e)return gk(e,r);var n=gC(t=Object.prototype.toString.call(e)).call(t,8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?hk(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gk(e,r):void 0}}function mk(e,r){return function(e){if(Jw(e))return e}(e)||function(e,r){var t=null==e?null:void 0!==Wv&&Yw(e)||e["@@iterator"];if(null!=t){var n,i,o,a,s=[],u=!0,c=!1;try{if(o=(t=t.call(e)).next,0===r){if(Object(t)!==t)return;u=!1}else for(;!(u=(n=o.call(t)).done)&&(s.push(n.value),s.length!==r);u=!0);}catch(l){c=!0,i=l}finally{try{if(!u&&null!=t["return"]&&(a=t["return"](),Object(a)!==a))return}finally{if(c)throw i}}return s}}(e,r)||pk(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _k(e){return function(e){if(Jw(e))return gk(e)}(e)||function(e){if(void 0!==Wv&&null!=Yw(e)||null!=e["@@iterator"])return hk(e)}(e)||pk(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vk(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function yk(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),oy(e,QC(n.key),n)}}function Ik(e,r,t){return r&&yk(e.prototype,r),t&&yk(e,t),oy(e,"prototype",{writable:!1}),e}var Sk=oe(Xw),Tk=oe(wy),bk=oe(IC);od({target:"Number",stat:!0},{isNaN:function(e){return e!=e}});var Ek=oe(Au.Number.isNaN),Ck=vy("Array").concat,wk=Uu,kk=Ck,Dk=Array.prototype,xk=oe((function(e){var r=e.concat;return e===Dk||wk(Dk,e)&&r===Dk.concat?kk:r})),Pk=Ns,Fk=jc("iterator"),Wk=!Pk((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),r=e.searchParams,t="";return e.pathname="c%20d",r.forEach((function(e,n){r["delete"]("b"),t+=n+e})),!e.toJSON||!r.size&&true||!r.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==r.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!r[Fk]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://тест").host||"#%D0%B1"!==new URL("http://a#б").hash||"a1c3"!==t||"x"!==new URL("http://x",undefined).host})),Ak=su,Rk=Xs,Ok=lu,Lk=Ns,Nk=zf,Mk=Wh,Uk=du,Bk=wc,Vk=Tu,Gk=Object.assign,jk=Object.defineProperty,Hk=Rk([].concat),zk=!Gk||Lk((function(){if(Ak&&1!==Gk({b:1},Gk(jk({},"a",{enumerable:!0,get:function(){jk(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},r={},t=Symbol(),n="abcdefghijklmnopqrst";return e[t]=7,n.split("").forEach((function(e){r[e]=e})),7!=Gk({},e)[t]||Nk(Gk({},r)).join("")!=n}))?function(e,r){for(var t=Bk(e),n=arguments.length,i=1,o=Mk.f,a=Uk.f;n>i;)for(var s,u=Vk(arguments[i++]),c=o?Hk(Nk(u),o(u)):Nk(u),l=c.length,d=0;l>d;)s=c[d++],Ak&&!Ok(a,u,s)||(t[s]=u[s]);return t}:Gk,Kk=Xs,qk=2147483647,Xk=/[^\0-\u007E]/,Jk=/[.\u3002\uFF0E\uFF61]/g,Yk="Overflow: input needs wider integers to process",Zk=RangeError,Qk=Kk(Jk.exec),$k=Math.floor,eD=String.fromCharCode,rD=Kk("".charCodeAt),tD=Kk([].join),nD=Kk([].push),iD=Kk("".replace),oD=Kk("".split),aD=Kk("".toLowerCase),sD=function(e){return e+22+75*(e<26)},uD=function(e,r,t){var n=0;for(e=t?$k(e/700):e>>1,e+=$k(e/r);e>455;)e=$k(e/35),n+=36;return $k(n+36*e/(e+38))},cD=function(e){var r=[];e=function(e){for(var r=[],t=0,n=e.length;t<n;){var i=rD(e,t++);if(i>=55296&&i<=56319&&t<n){var o=rD(e,t++);56320==(64512&o)?nD(r,((1023&i)<<10)+(1023&o)+65536):(nD(r,i),t--)}else nD(r,i)}return r}(e);var t,n,i=e.length,o=128,a=0,s=72;for(t=0;t<e.length;t++)(n=e[t])<128&&nD(r,eD(n));var u=r.length,c=u;for(u&&nD(r,"-");c<i;){var l=qk;for(t=0;t<e.length;t++)(n=e[t])>=o&&n<l&&(l=n);var d=c+1;if(l-o>$k((qk-a)/d))throw Zk(Yk);for(a+=(l-o)*d,o=l,t=0;t<e.length;t++){if((n=e[t])<o&&++a>qk)throw Zk(Yk);if(n==o){for(var f=a,h=36;;){var g=h<=s?1:h>=s+26?26:h-s;if(f<g)break;var p=f-g,m=36-g;nD(r,eD(sD(g+p%m))),f=$k(p/m),h+=36}nD(r,eD(sD(f))),s=uD(a,d,c==u),a=0,c++}}a++,o++}return tD(r,"")},lD=Rh,dD=wh,fD=Math.floor,hD=function(e,r){var t=e.length,n=fD(t/2);return t<8?gD(e,r):pD(e,hD(dD(e,0,n),r),hD(dD(e,n),r),r)},gD=function(e,r){for(var t,n,i=e.length,o=1;o<i;){for(n=o,t=e[o];n&&r(e[n-1],t)>0;)e[n]=e[--n];n!==o++&&(e[n]=t)}return e},pD=function(e,r,t,n){for(var i=r.length,o=t.length,a=0,s=0;a<i||s<o;)e[a+s]=a<i&&s<o?n(r[a],t[s])<=0?r[a++]:t[s++]:a<i?r[a++]:t[s++];return e},mD=od,_D=Ls,vD=lu,yD=Xs,ID=su,SD=Wk,TD=Rh,bD=Lh,ED=function(e,r,t){for(var n in r)t&&t.unsafe&&e[n]?e[n]=r[n]:lD(e,n,r[n],t);return e},CD=ag,wD=v_,kD=Tg,DD=uS,xD=ou,PD=xc,FD=kl,WD=Fd,AD=Al,RD=Wu,OD=Ef,LD=mh,ND=_u,MD=gI,UD=sI,BD=yS,VD=hD,GD=jc("iterator"),jD="URLSearchParams",HD=jD+"Iterator",zD=kD.set,KD=kD.getterFor(jD),qD=kD.getterFor(HD),XD=Object.getOwnPropertyDescriptor,JD=function(e){if(!ID)return _D[e];var r=XD(_D,e);return r&&r.value},YD=JD("fetch"),ZD=JD("Request"),QD=JD("Headers"),$D=ZD&&ZD.prototype,ex=QD&&QD.prototype,rx=_D.RegExp,tx=_D.TypeError,nx=_D.decodeURIComponent,ix=_D.encodeURIComponent,ox=yD("".charAt),ax=yD([].join),sx=yD([].push),ux=yD("".replace),cx=yD([].shift),lx=yD([].splice),dx=yD("".split),fx=yD("".slice),hx=/\+/g,gx=Array(4),px=function(e){return gx[e-1]||(gx[e-1]=rx("((?:%[\\da-f]{2}){"+e+"})","gi"))},mx=function(e){try{return nx(e)}catch(Ke){return e}},_x=function(e){var r=ux(e,hx," "),t=4;try{return nx(r)}catch(Ke){for(;t;)r=ux(r,px(t--),mx);return r}},vx=/[!'()~]|%20/g,yx={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},Ix=function(e){return yx[e]},Sx=function(e){return ux(ix(e),vx,Ix)},Tx=wD((function(e,r){zD(this,{type:HD,iterator:MD(KD(e).entries),kind:r})}),"Iterator",(function(){var e=qD(this),r=e.kind,t=e.iterator.next(),n=t.value;return t.done||(t.value="keys"===r?n.key:"values"===r?n.value:[n.key,n.value]),t}),!0),bx=function(e){this.entries=[],this.url=null,e!==undefined&&(RD(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===ox(e,0)?fx(e,1):e:OD(e)))};bx.prototype={type:jD,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var r,t,n,i,o,a,s,u=UD(e);if(u)for(t=(r=MD(e,u)).next;!(n=vD(t,r)).done;){if(o=(i=MD(AD(n.value))).next,(a=vD(o,i)).done||(s=vD(o,i)).done||!vD(o,i).done)throw tx("Expected sequence with length 2");sx(this.entries,{key:OD(a.value),value:OD(s.value)})}else for(var c in e)PD(e,c)&&sx(this.entries,{key:c,value:OD(e[c])})},parseQuery:function(e){if(e)for(var r,t,n=dx(e,"&"),i=0;i<n.length;)(r=n[i++]).length&&(t=dx(r,"="),sx(this.entries,{key:_x(cx(t)),value:_x(ax(t,"="))}))},serialize:function(){for(var e,r=this.entries,t=[],n=0;n<r.length;)e=r[n++],sx(t,Sx(e.key)+"="+Sx(e.value));return ax(t,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var Ex=function(){DD(this,Cx);var e=arguments.length>0?arguments[0]:undefined,r=zD(this,new bx(e));ID||(this.length=r.entries.length)},Cx=Ex.prototype;if(ED(Cx,{append:function(e,r){BD(arguments.length,2);var t=KD(this);sx(t.entries,{key:OD(e),value:OD(r)}),ID||this.length++,t.updateURL()},"delete":function(e){BD(arguments.length,1);for(var r=KD(this),t=r.entries,n=OD(e),i=0;i<t.length;)t[i].key===n?lx(t,i,1):i++;ID||(this.length=t.length),r.updateURL()},get:function(e){BD(arguments.length,1);for(var r=KD(this).entries,t=OD(e),n=0;n<r.length;n++)if(r[n].key===t)return r[n].value;return null},getAll:function(e){BD(arguments.length,1);for(var r=KD(this).entries,t=OD(e),n=[],i=0;i<r.length;i++)r[i].key===t&&sx(n,r[i].value);return n},has:function(e){BD(arguments.length,1);for(var r=KD(this).entries,t=OD(e),n=0;n<r.length;)if(r[n++].key===t)return!0;return!1},set:function(e,r){BD(arguments.length,1);for(var t,n=KD(this),i=n.entries,o=!1,a=OD(e),s=OD(r),u=0;u<i.length;u++)(t=i[u]).key===a&&(o?lx(i,u--,1):(o=!0,t.value=s));o||sx(i,{key:a,value:s}),ID||(this.length=i.length),n.updateURL()},sort:function(){var e=KD(this);VD(e.entries,(function(e,r){return e.key>r.key?1:-1})),e.updateURL()},forEach:function(e){for(var r,t=KD(this).entries,n=FD(e,arguments.length>1?arguments[1]:undefined),i=0;i<t.length;)n((r=t[i++]).value,r.key,this)},keys:function(){return new Tx(this,"keys")},values:function(){return new Tx(this,"values")},entries:function(){return new Tx(this,"entries")}},{enumerable:!0}),TD(Cx,GD,Cx.entries,{name:"entries"}),TD(Cx,"toString",(function(){return KD(this).serialize()}),{enumerable:!0}),ID&&bD(Cx,"size",{get:function(){return KD(this).entries.length},configurable:!0,enumerable:!0}),CD(Ex,jD),mD({global:!0,constructor:!0,forced:!SD},{URLSearchParams:Ex}),!SD&&xD(QD)){var wx=yD(ex.has),kx=yD(ex.set),Dx=function(e){if(RD(e)){var r,t=e.body;if(WD(t)===jD)return r=e.headers?new QD(e.headers):new QD,wx(r,"content-type")||kx(r,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),LD(e,{body:ND(0,OD(t)),headers:ND(0,r)})}return e};if(xD(YD)&&mD({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(e){return YD(e,arguments.length>1?Dx(arguments[1]):{})}}),xD(ZD)){var xx=function(e){return DD(this,$D),new ZD(e,arguments.length>1?Dx(arguments[1]):{})};$D.constructor=xx,xx.prototype=$D,mD({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:xx})}}var Px,Fx=od,Wx=su,Ax=Wk,Rx=Ls,Ox=kl,Lx=Xs,Nx=Rh,Mx=Lh,Ux=uS,Bx=xc,Vx=zk,Gx=lk,jx=wh,Hx=Vv.codeAt,zx=function(e){var r,t,n=[],i=oD(iD(aD(e),Jk,"."),".");for(r=0;r<i.length;r++)t=i[r],nD(n,Qk(Xk,t)?"xn--"+cD(t):t);return tD(n,".")},Kx=Ef,qx=ag,Xx=yS,Jx={URLSearchParams:Ex,getState:KD},Yx=Tg,Zx=Yx.set,Qx=Yx.getterFor("URL"),$x=Jx.URLSearchParams,eP=Jx.getState,rP=Rx.URL,tP=Rx.TypeError,nP=Rx.parseInt,iP=Math.floor,oP=Math.pow,aP=Lx("".charAt),sP=Lx(/./.exec),uP=Lx([].join),cP=Lx(1..toString),lP=Lx([].pop),dP=Lx([].push),fP=Lx("".replace),hP=Lx([].shift),gP=Lx("".split),pP=Lx("".slice),mP=Lx("".toLowerCase),_P=Lx([].unshift),vP="Invalid scheme",yP="Invalid host",IP="Invalid port",SP=/[a-z]/i,TP=/[\d+-.a-z]/i,bP=/\d/,EP=/^0x/i,CP=/^[0-7]+$/,wP=/^\d+$/,kP=/^[\da-f]+$/i,DP=/[\0\t\n\r #%/:<>?@[\\\]^|]/,xP=/[\0\t\n\r #/:<>?@[\\\]^|]/,PP=/^[\u0000-\u0020]+/,FP=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,WP=/[\t\n\r]/g,AP=function(e){var r,t,n,i;if("number"==typeof e){for(r=[],t=0;t<4;t++)_P(r,e%256),e=iP(e/256);return uP(r,".")}if("object"==typeof e){for(r="",n=function(e){for(var r=null,t=1,n=null,i=0,o=0;o<8;o++)0!==e[o]?(i>t&&(r=n,t=i),n=null,i=0):(null===n&&(n=o),++i);return i>t&&(r=n,t=i),r}(e),t=0;t<8;t++)i&&0===e[t]||(i&&(i=!1),n===t?(r+=t?":":"::",i=!0):(r+=cP(e[t],16),t<7&&(r+=":")));return"["+r+"]"}return e},RP={},OP=Vx({},RP,{" ":1,'"':1,"<":1,">":1,"`":1}),LP=Vx({},OP,{"#":1,"?":1,"{":1,"}":1}),NP=Vx({},LP,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),MP=function(e,r){var t=Hx(e,0);return t>32&&t<127&&!Bx(r,e)?e:encodeURIComponent(e)},UP={ftp:21,file:null,http:80,https:443,ws:80,wss:443},BP=function(e,r){var t;return 2==e.length&&sP(SP,aP(e,0))&&(":"==(t=aP(e,1))||!r&&"|"==t)},VP=function(e){var r;return e.length>1&&BP(pP(e,0,2))&&(2==e.length||"/"===(r=aP(e,2))||"\\"===r||"?"===r||"#"===r)},GP=function(e){return"."===e||"%2e"===mP(e)},jP={},HP={},zP={},KP={},qP={},XP={},JP={},YP={},ZP={},QP={},$P={},eF={},rF={},tF={},nF={},iF={},oF={},aF={},sF={},uF={},cF={},lF=function(e,r,t){var n,i,o,a=Kx(e);if(r){if(i=this.parse(a))throw tP(i);this.searchParams=null}else{if(t!==undefined&&(n=new lF(t,!0)),i=this.parse(a,null,n))throw tP(i);(o=eP(new $x)).bindURL(this),this.searchParams=o}};lF.prototype={type:"URL",parse:function(e,r,t){var n,i,o,a,s,u=this,c=r||jP,l=0,d="",f=!1,h=!1,g=!1;for(e=Kx(e),r||(u.scheme="",u.username="",u.password="",u.host=null,u.port=null,u.path=[],u.query=null,u.fragment=null,u.cannotBeABaseURL=!1,e=fP(e,PP,""),e=fP(e,FP,"$1")),e=fP(e,WP,""),n=Gx(e);l<=n.length;){switch(i=n[l],c){case jP:if(!i||!sP(SP,i)){if(r)return vP;c=zP;continue}d+=mP(i),c=HP;break;case HP:if(i&&(sP(TP,i)||"+"==i||"-"==i||"."==i))d+=mP(i);else{if(":"!=i){if(r)return vP;d="",c=zP,l=0;continue}if(r&&(u.isSpecial()!=Bx(UP,d)||"file"==d&&(u.includesCredentials()||null!==u.port)||"file"==u.scheme&&!u.host))return;if(u.scheme=d,r)return void(u.isSpecial()&&UP[u.scheme]==u.port&&(u.port=null));d="","file"==u.scheme?c=tF:u.isSpecial()&&t&&t.scheme==u.scheme?c=KP:u.isSpecial()?c=YP:"/"==n[l+1]?(c=qP,l++):(u.cannotBeABaseURL=!0,dP(u.path,""),c=sF)}break;case zP:if(!t||t.cannotBeABaseURL&&"#"!=i)return vP;if(t.cannotBeABaseURL&&"#"==i){u.scheme=t.scheme,u.path=jx(t.path),u.query=t.query,u.fragment="",u.cannotBeABaseURL=!0,c=cF;break}c="file"==t.scheme?tF:XP;continue;case KP:if("/"!=i||"/"!=n[l+1]){c=XP;continue}c=ZP,l++;break;case qP:if("/"==i){c=QP;break}c=aF;continue;case XP:if(u.scheme=t.scheme,i==Px)u.username=t.username,u.password=t.password,u.host=t.host,u.port=t.port,u.path=jx(t.path),u.query=t.query;else if("/"==i||"\\"==i&&u.isSpecial())c=JP;else if("?"==i)u.username=t.username,u.password=t.password,u.host=t.host,u.port=t.port,u.path=jx(t.path),u.query="",c=uF;else{if("#"!=i){u.username=t.username,u.password=t.password,u.host=t.host,u.port=t.port,u.path=jx(t.path),u.path.length--,c=aF;continue}u.username=t.username,u.password=t.password,u.host=t.host,u.port=t.port,u.path=jx(t.path),u.query=t.query,u.fragment="",c=cF}break;case JP:if(!u.isSpecial()||"/"!=i&&"\\"!=i){if("/"!=i){u.username=t.username,u.password=t.password,u.host=t.host,u.port=t.port,c=aF;continue}c=QP}else c=ZP;break;case YP:if(c=ZP,"/"!=i||"/"!=aP(d,l+1))continue;l++;break;case ZP:if("/"!=i&&"\\"!=i){c=QP;continue}break;case QP:if("@"==i){f&&(d="%40"+d),f=!0,o=Gx(d);for(var p=0;p<o.length;p++){var m=o[p];if(":"!=m||g){var _=MP(m,NP);g?u.password+=_:u.username+=_}else g=!0}d=""}else if(i==Px||"/"==i||"?"==i||"#"==i||"\\"==i&&u.isSpecial()){if(f&&""==d)return"Invalid authority";l-=Gx(d).length+1,d="",c=$P}else d+=i;break;case $P:case eF:if(r&&"file"==u.scheme){c=iF;continue}if(":"!=i||h){if(i==Px||"/"==i||"?"==i||"#"==i||"\\"==i&&u.isSpecial()){if(u.isSpecial()&&""==d)return yP;if(r&&""==d&&(u.includesCredentials()||null!==u.port))return;if(a=u.parseHost(d))return a;if(d="",c=oF,r)return;continue}"["==i?h=!0:"]"==i&&(h=!1),d+=i}else{if(""==d)return yP;if(a=u.parseHost(d))return a;if(d="",c=rF,r==eF)return}break;case rF:if(!sP(bP,i)){if(i==Px||"/"==i||"?"==i||"#"==i||"\\"==i&&u.isSpecial()||r){if(""!=d){var v=nP(d,10);if(v>65535)return IP;u.port=u.isSpecial()&&v===UP[u.scheme]?null:v,d=""}if(r)return;c=oF;continue}return IP}d+=i;break;case tF:if(u.scheme="file","/"==i||"\\"==i)c=nF;else{if(!t||"file"!=t.scheme){c=aF;continue}if(i==Px)u.host=t.host,u.path=jx(t.path),u.query=t.query;else if("?"==i)u.host=t.host,u.path=jx(t.path),u.query="",c=uF;else{if("#"!=i){VP(uP(jx(n,l),""))||(u.host=t.host,u.path=jx(t.path),u.shortenPath()),c=aF;continue}u.host=t.host,u.path=jx(t.path),u.query=t.query,u.fragment="",c=cF}}break;case nF:if("/"==i||"\\"==i){c=iF;break}t&&"file"==t.scheme&&!VP(uP(jx(n,l),""))&&(BP(t.path[0],!0)?dP(u.path,t.path[0]):u.host=t.host),c=aF;continue;case iF:if(i==Px||"/"==i||"\\"==i||"?"==i||"#"==i){if(!r&&BP(d))c=aF;else if(""==d){if(u.host="",r)return;c=oF}else{if(a=u.parseHost(d))return a;if("localhost"==u.host&&(u.host=""),r)return;d="",c=oF}continue}d+=i;break;case oF:if(u.isSpecial()){if(c=aF,"/"!=i&&"\\"!=i)continue}else if(r||"?"!=i)if(r||"#"!=i){if(i!=Px&&(c=aF,"/"!=i))continue}else u.fragment="",c=cF;else u.query="",c=uF;break;case aF:if(i==Px||"/"==i||"\\"==i&&u.isSpecial()||!r&&("?"==i||"#"==i)){if(".."===(s=mP(s=d))||"%2e."===s||".%2e"===s||"%2e%2e"===s?(u.shortenPath(),"/"==i||"\\"==i&&u.isSpecial()||dP(u.path,"")):GP(d)?"/"==i||"\\"==i&&u.isSpecial()||dP(u.path,""):("file"==u.scheme&&!u.path.length&&BP(d)&&(u.host&&(u.host=""),d=aP(d,0)+":"),dP(u.path,d)),d="","file"==u.scheme&&(i==Px||"?"==i||"#"==i))for(;u.path.length>1&&""===u.path[0];)hP(u.path);"?"==i?(u.query="",c=uF):"#"==i&&(u.fragment="",c=cF)}else d+=MP(i,LP);break;case sF:"?"==i?(u.query="",c=uF):"#"==i?(u.fragment="",c=cF):i!=Px&&(u.path[0]+=MP(i,RP));break;case uF:r||"#"!=i?i!=Px&&("'"==i&&u.isSpecial()?u.query+="%27":u.query+="#"==i?"%23":MP(i,RP)):(u.fragment="",c=cF);break;case cF:i!=Px&&(u.fragment+=MP(i,OP))}l++}},parseHost:function(e){var r,t,n;if("["==aP(e,0)){if("]"!=aP(e,e.length-1))return yP;if(r=function(e){var r,t,n,i,o,a,s,u=[0,0,0,0,0,0,0,0],c=0,l=null,d=0,f=function(){return aP(e,d)};if(":"==f()){if(":"!=aP(e,1))return;d+=2,l=++c}for(;f();){if(8==c)return;if(":"!=f()){for(r=t=0;t<4&&sP(kP,f());)r=16*r+nP(f(),16),d++,t++;if("."==f()){if(0==t)return;if(d-=t,c>6)return;for(n=0;f();){if(i=null,n>0){if(!("."==f()&&n<4))return;d++}if(!sP(bP,f()))return;for(;sP(bP,f());){if(o=nP(f(),10),null===i)i=o;else{if(0==i)return;i=10*i+o}if(i>255)return;d++}u[c]=256*u[c]+i,2!=++n&&4!=n||c++}if(4!=n)return;break}if(":"==f()){if(d++,!f())return}else if(f())return;u[c++]=r}else{if(null!==l)return;d++,l=++c}}if(null!==l)for(a=c-l,c=7;0!=c&&a>0;)s=u[c],u[c--]=u[l+a-1],u[l+--a]=s;else if(8!=c)return;return u}(pP(e,1,-1)),!r)return yP;this.host=r}else if(this.isSpecial()){if(e=zx(e),sP(DP,e))return yP;if(r=function(e){var r,t,n,i,o,a,s,u=gP(e,".");if(u.length&&""==u[u.length-1]&&u.length--,(r=u.length)>4)return e;for(t=[],n=0;n<r;n++){if(""==(i=u[n]))return e;if(o=10,i.length>1&&"0"==aP(i,0)&&(o=sP(EP,i)?16:8,i=pP(i,8==o?1:2)),""===i)a=0;else{if(!sP(10==o?wP:8==o?CP:kP,i))return e;a=nP(i,o)}dP(t,a)}for(n=0;n<r;n++)if(a=t[n],n==r-1){if(a>=oP(256,5-r))return null}else if(a>255)return null;for(s=lP(t),n=0;n<t.length;n++)s+=t[n]*oP(256,3-n);return s}(e),null===r)return yP;this.host=r}else{if(sP(xP,e))return yP;for(r="",t=Gx(e),n=0;n<t.length;n++)r+=MP(t[n],RP);this.host=r}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"==this.scheme},includesCredentials:function(){return""!=this.username||""!=this.password},isSpecial:function(){return Bx(UP,this.scheme)},shortenPath:function(){var e=this.path,r=e.length;!r||"file"==this.scheme&&1==r&&BP(e[0],!0)||e.length--},serialize:function(){var e=this,r=e.scheme,t=e.username,n=e.password,i=e.host,o=e.port,a=e.path,s=e.query,u=e.fragment,c=r+":";return null!==i?(c+="//",e.includesCredentials()&&(c+=t+(n?":"+n:"")+"@"),c+=AP(i),null!==o&&(c+=":"+o)):"file"==r&&(c+="//"),c+=e.cannotBeABaseURL?a[0]:a.length?"/"+uP(a,"/"):"",null!==s&&(c+="?"+s),null!==u&&(c+="#"+u),c},setHref:function(e){var r=this.parse(e);if(r)throw tP(r);this.searchParams.update()},getOrigin:function(){var e=this.scheme,r=this.port;if("blob"==e)try{return new dF(e.path[0]).origin}catch(Ke){return"null"}return"file"!=e&&this.isSpecial()?e+"://"+AP(this.host)+(null!==r?":"+r:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(Kx(e)+":",jP)},getUsername:function(){return this.username},setUsername:function(e){var r=Gx(Kx(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var t=0;t<r.length;t++)this.username+=MP(r[t],NP)}},getPassword:function(){return this.password},setPassword:function(e){var r=Gx(Kx(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var t=0;t<r.length;t++)this.password+=MP(r[t],NP)}},getHost:function(){var e=this.host,r=this.port;return null===e?"":null===r?AP(e):AP(e)+":"+r},setHost:function(e){this.cannotBeABaseURL||this.parse(e,$P)},getHostname:function(){var e=this.host;return null===e?"":AP(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,eF)},getPort:function(){var e=this.port;return null===e?"":Kx(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(""==(e=Kx(e))?this.port=null:this.parse(e,rF))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+uP(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,oF))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){""==(e=Kx(e))?this.query=null:("?"==aP(e,0)&&(e=pP(e,1)),this.query="",this.parse(e,uF)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){""!=(e=Kx(e))?("#"==aP(e,0)&&(e=pP(e,1)),this.fragment="",this.parse(e,cF)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var dF=function(e){var r=Ux(this,fF),t=Xx(arguments.length,1)>1?arguments[1]:undefined,n=Zx(r,new lF(e,!1,t));Wx||(r.href=n.serialize(),r.origin=n.getOrigin(),r.protocol=n.getProtocol(),r.username=n.getUsername(),r.password=n.getPassword(),r.host=n.getHost(),r.hostname=n.getHostname(),r.port=n.getPort(),r.pathname=n.getPathname(),r.search=n.getSearch(),r.searchParams=n.getSearchParams(),r.hash=n.getHash())},fF=dF.prototype,hF=function(e,r){return{get:function(){return Qx(this)[e]()},set:r&&function(e){return Qx(this)[r](e)},configurable:!0,enumerable:!0}};if(Wx&&(Mx(fF,"href",hF("serialize","setHref")),Mx(fF,"origin",hF("getOrigin")),Mx(fF,"protocol",hF("getProtocol","setProtocol")),Mx(fF,"username",hF("getUsername","setUsername")),Mx(fF,"password",hF("getPassword","setPassword")),Mx(fF,"host",hF("getHost","setHost")),Mx(fF,"hostname",hF("getHostname","setHostname")),Mx(fF,"port",hF("getPort","setPort")),Mx(fF,"pathname",hF("getPathname","setPathname")),Mx(fF,"search",hF("getSearch","setSearch")),Mx(fF,"searchParams",hF("getSearchParams")),Mx(fF,"hash",hF("getHash","setHash"))),Nx(fF,"toJSON",(function(){return Qx(this).serialize()}),{enumerable:!0}),Nx(fF,"toString",(function(){return Qx(this).serialize()}),{enumerable:!0}),rP){var gF=rP.createObjectURL,pF=rP.revokeObjectURL;gF&&Nx(dF,"createObjectURL",Ox(gF,rP)),pF&&Nx(dF,"revokeObjectURL",Ox(pF,rP))}qx(dF,"URL"),Fx({global:!0,constructor:!0,forced:!Ax,sham:!Wx},{URL:dF});var mF=od,_F=Ns,vF=yS,yF=Ef,IF=Wk,SF=Mu("URL");mF({target:"URL",stat:!0,forced:!(IF&&_F((function(){SF.canParse()})))},{canParse:function(e){var r=vF(arguments.length,1),t=yF(e),n=r<2||arguments[1]===undefined?undefined:yF(arguments[1]);try{return!!new SF(t,n)}catch(Ke){return!1}}});var TF=oe(Au.URL),bF=oe(hC),EF=od,CF=Rf.indexOf,wF=gy,kF=ru([].indexOf),DF=!!kF&&1/kF([1],1,-0)<0;EF({target:"Array",proto:!0,forced:DF||!wF("indexOf")},{indexOf:function(e){var r=arguments.length>1?arguments[1]:undefined;return DF?kF(this,e,r)||0:CF(this,e,r)}});var xF=vy("Array").indexOf,PF=Uu,FF=xF,WF=Array.prototype,AF=oe((function(e){var r=e.indexOf;return e===WF||PF(WF,e)&&r===WF.indexOf?FF:r})),RF=su,OF=sd,LF=TypeError,NF=Object.getOwnPropertyDescriptor,MF=RF&&!function(){if(this!==undefined)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(Ke){return Ke instanceof TypeError}}()?function(e,r){if(OF(e)&&!NF(e,"length").writable)throw LF("Cannot set read only .length");return e.length=r}:function(e,r){return e.length=r},UF=ic,BF=TypeError,VF=od,GF=wc,jF=xf,HF=fd,zF=md,KF=MF,qF=vd,XF=tf,JF=Td,YF=function(e,r){if(!delete e[r])throw BF("Cannot delete property "+UF(r)+" of "+UF(e))},ZF=sf("splice"),QF=Math.max,$F=Math.min;VF({target:"Array",proto:!0,forced:!ZF},{splice:function(e,r){var t,n,i,o,a,s,u=GF(this),c=zF(u),l=jF(e,c),d=arguments.length;for(0===d?t=n=0:1===d?(t=0,n=c-l):(t=d-2,n=$F(QF(HF(r),0),c-l)),qF(c+t-n),i=XF(u,n),o=0;o<n;o++)(a=l+o)in u&&JF(i,o,u[a]);if(i.length=n,t<n){for(o=l;o<c-n;o++)s=o+t,(a=o+n)in u?u[s]=u[a]:YF(u,s);for(o=c;o>c-n+t;o--)YF(u,o-1)}else if(t>n)for(o=c-n;o>l;o--)s=o+t-1,(a=o+n-1)in u?u[s]=u[a]:YF(u,s);for(o=0;o<t;o++)u[o+l]=arguments[o+2];return KF(u,c-n+t),i}});var eW=vy("Array").splice,rW=Uu,tW=eW,nW=Array.prototype,iW=oe((function(e){var r=e.splice;return e===nW||rW(nW,e)&&r===nW.splice?tW:r})),oW=od,aW=Pg.findIndex,sW="findIndex",uW=!0;sW in[]&&Array(1)[sW]((function(){uW=!1})),oW({target:"Array",proto:!0,forced:uW},{findIndex:function(e){return aW(this,e,arguments.length>1?arguments[1]:undefined)}});var cW=vy("Array").findIndex,lW=Uu,dW=cW,fW=Array.prototype,hW=oe((function(e){var r=e.findIndex;return e===fW||lW(fW,e)&&r===fW.findIndex?dW:r})),gW=su,pW=Xs,mW=zf,_W=xu,vW=pW(du.f),yW=pW([].push),IW=function(e){return function(r){for(var t,n=_W(r),i=mW(n),o=i.length,a=0,s=[];o>a;)t=i[a++],gW&&!vW(n,t)||yW(s,e?[t,n[t]]:n[t]);return s}},SW={entries:IW(!0),values:IW(!1)}.entries;od({target:"Object",stat:!0},{entries:function(e){return SW(e)}});var TW=oe(Au.Object.entries),bW=oe(OE),EW=od,CW=Pg.find,wW="find",kW=!0;wW in[]&&Array(1)[wW]((function(){kW=!1})),EW({target:"Array",proto:!0,forced:kW},{find:function(e){return CW(this,e,arguments.length>1?arguments[1]:undefined)}});var DW=vy("Array").find,xW=Uu,PW=DW,FW=Array.prototype,WW=oe((function(e){var r=e.find;return e===FW||xW(FW,e)&&r===FW.find?PW:r})),AW=oe(DC),RW=Pg.map;od({target:"Array",proto:!0,forced:!sf("map")},{map:function(e){return RW(this,e,arguments.length>1?arguments[1]:undefined)}});var OW=vy("Array").map,LW=Uu,NW=OW,MW=Array.prototype,UW=oe((function(e){var r=e.map;return e===MW||LW(MW,e)&&r===MW.map?NW:r})),BW="\t\n\x0B\f\r                　\u2028\u2029\ufeff",VW=wu,GW=Ef,jW=BW,HW=Xs("".replace),zW=RegExp("^["+jW+"]+"),KW=RegExp("(^|[^"+jW+"])["+jW+"]+$"),qW=function(e){return function(r){var t=GW(VW(r));return 1&e&&(t=HW(t,zW,"")),2&e&&(t=HW(t,KW,"$1")),t}},XW={start:qW(1),end:qW(2),trim:qW(3)},JW=Ls,YW=Ns,ZW=Xs,QW=Ef,$W=XW.trim,eA=BW,rA=JW.parseInt,tA=JW.Symbol,nA=tA&&tA.iterator,iA=/^[+-]?0x/i,oA=ZW(iA.exec),aA=8!==rA(eA+"08")||22!==rA(eA+"0x16")||nA&&!YW((function(){rA(Object(nA))}))?function(e,r){var t=$W(QW(e));return rA(t,r>>>0||(oA(iA,t)?16:10))}:rA;od({global:!0,forced:parseInt!=aA},{parseInt:aA});var sA=oe(Au.parseInt),uA=oe(fk),cA=vy("Array").keys,lA=Fd,dA=xc,fA=Uu,hA=cA,gA=Array.prototype,pA={DOMTokenList:!0,NodeList:!0},mA=oe((function(e){var r=e.keys;return e===gA||fA(gA,e)&&r===gA.keys||dA(pA,lA(e))?hA:r})),_A=oe(iy),vA=function(e){return Sk?Sk(e):"[object Array]"===function(e){return Object.prototype.toString.call(e)}(e)},yA=function(e){return void 0===e},IA=function(e,r){var t,n;e=null!==(t=e)&&void 0!==t?t:"yyyy-MM-dd hh:mm:ss";var i=yA(r)?new Date:new Date(r),o={"M+":(i.getMonth()+1).toString(),"d+":i.getDate().toString(),"h+":i.getHours().toString(),"m+":i.getMinutes().toString(),"s+":i.getSeconds().toString(),"q+":Math.floor((i.getMonth()+3)/3).toString(),S:i.getMilliseconds().toString()};return/(y+)/.test(e)&&(e=e.replace(RegExp.$1,"".concat(i.getFullYear()).substring(4-RegExp.$1.length))),Tk(n=bk(o)).call(n,(function(r){new RegExp("(".concat(r,")")).test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?o[r]:"00".concat(o[r]).substring("".concat(o[r]).length)))})),e},SA=function(e){return"string"==typeof e},TA=function(e){return"number"==typeof e&&!Ek(e)},bA=function(e){return"function"==typeof e},EA=0,CA=function(){var e;return EA+=1,xk(e="".concat((new Date).getTime().toString(36))).call(e,EA.toString(36))},wA=function(e){var r=TF||window.webkitURL;/^blob:/.test(e)&&r.revokeObjectURL(e)},kA=function(){function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";vk(this,e),$C(this,"prefix",void 0),$C(this,"postfix",void 0),$C(this,"isDestroyed",!1),$C(this,"uid",CA()),$C(this,"cacheEvents",void 0),$C(this,"events",void 0),$C(this,"isCached",void 0),this.cacheEvents=[],this.events={},this.isCached=!1,this.prefix=r,this.postfix=t}return Ik(e,[{key:"save",value:function(){this.isCached=!0}},{key:"restore",value:function(){var e,r=this;this.isCached=!1,Tk(e=this.cacheEvents).call(e,(function(e){var t,n=e.eventName,i=e.param;r.emit.apply(r,xk(t=[n]).call(t,_k(i)))})),this.cacheEvents.length=0}},{key:"destroy",value:function(){var e=this;if(!this.isDestroyed){for(var r in this.events)if(Object.prototype.hasOwnProperty.call(this.events,r)){var t,n=this.events[r];n&&Tk(t=bF(n).call(n)).call(t,(function(r){var t=r.name,n=r.fn,i=r.context,o=r.once;e.off(t,n,i,o)}))}this.events={},this.isDestroyed=!0}}},{key:"on",value:function(e,r,t){var n,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.events,a={name:e=this.format(e),uid:CA(),context:t,once:i,fn:r};return o[e]||(o[e]=[]),AF(n=o[e]).call(n,a)<0&&o[e].push(a),a}},{key:"once",value:function(e,r,t){return this.on(e,r,t,!0)}},{key:"emit",value:function(e){for(var r,t,n=this,i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];if(this.isCached)return this.cacheEvents.push({eventName:e,param:o}),!0;var s=this.events[e=this.format(e)];return!(!s||!s.length||(Tk(r=bF(s).call(s)).call(r,(function(e){var r,t=e.fn,n=e.context;t.call.apply(t,xk(r=[n||null]).call(r,o))})),Tk(t=bF(s).call(s)).call(t,(function(r){var t=r.fn,i=r.context,o=r.once;o&&n.off(e,t,i,o)})),0))}},{key:"off",value:function(e,r,t,n){var i=this.events[e=this.format(e)];if(!i)return!1;if(!arguments.length)return i.length=0,!0;for(var o=i.length-1;o>=0;o--){var a=i[o];r&&a.fn!==r||t&&a.context!==t||n&&a.once!==n||iW(i).call(i,o,1)}return!0}},{key:"removeAllEventListeners",value:function(e){if(e){var r,t;e=this.format(e);var n=hW(r=this.cacheEvents).call(r,(function(r){return r.eventName===e}));n>-1&&iW(t=this.cacheEvents).call(t,n,1),this.events[e]&&delete this.events[e]}else this.cacheEvents=[],this.events={}}},{key:"getAllEvents",value:function(){return this.events}},{key:"format",value:function(e){var r,t;return xk(r=xk(t="".concat(this.prefix||"")).call(t,e)).call(r,this.postfix||"")}}],[{key:"create",value:function(r,t){return new e(r,t)}}]),e}(),DA="default",xA=function(){function e(){vk(this,e),$C(this,"emitter",new kA)}return Ik(e,[{key:"on",value:function(e){this.emitter.on(DA,e)}},{key:"emit",value:function(){for(var e,r,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];(e=this.emitter).emit.apply(e,xk(r=[DA]).call(r,n))}},{key:"off",value:function(e){this.emitter.off(DA,e)}}],[{key:"create",value:function(){return new e}}]),e}(),PA=function(){function e(r){vk(this,e),$C(this,"uid",void 0),$C(this,"children",void 0),this.uid=r.uid,this.children=r.children||[]}return Ik(e,[{key:"append",value:function(e){var r=this.children;return AF(r).call(r,e)<0&&(r.push(e),!0)}},{key:"insert",value:function(e,r){var t=this.children;return!(r<0||r>t.length||(iW(t).call(t,r,0,e),0))}},{key:"remove",value:function(e){var r=this.children,t=AF(r).call(r,e);return!(t<0||(iW(r).call(r,t,1),0))}},{key:"clear",value:function(){return this.children=[],!0}},{key:"move",value:function(e,r){if(e===r)return!0;var t=this.children,n=mk(iW(t).call(t,e,1),1)[0];return iW(t).call(t,r,0,n),!0}},{key:"switch",value:function(e,r){if(e===r)return!0;var t=this.children,n=t[e];return t[e]=t[r],t[r]=n,!0}},{key:"reorder",value:function(e){var r=this.children,t=e.length,n=[],i=0;if(r.length!==t||0===t)return!1;for(var o=0;o<t;o++)e[o]===o&&(i+=1);if(i===t)return!0;for(var a=0;a<t;a++)n[a]=r[e[a]];for(var s=0;s<t;s++)r[s]=n[s];return!0}}]),e}(),FA=function(){function e(r,t){vk(this,e),$C(this,"isDestroyed",!1),$C(this,"data",void 0),$C(this,"table",["database","table","item"]),$C(this,"dbName",void 0),$C(this,"tableName",void 0),this.data={},this.dbName=r,this.tableName=t,this.createDatabase(r,t)}return Ik(e,[{key:"destroy",value:function(){if(!this.isDestroyed){for(var e=0,r=TW(this.data);e<r.length;e++){var t=mk(r[e],2),n=t[0];t[1],this.data[n]=null}this.data=null,this.isDestroyed=!0}}},{key:"createDatabase",value:function(e,r){this.data[e]={},this.data[e][r]={}}},{key:"set",value:function(e,r){var t=this,n=this.dbName,i=this.tableName;return new bW((function(o,a){t.checkId(e)?a(new Error("The ".concat(e," already exists."))):(t.data[n][i][e]=r,o("Save ".concat(e," to database successful.")))}))}},{key:"get",value:function(e){var r=this,t=this.dbName,n=this.tableName;return new bW((function(i,o){r.checkId(e)?i(r.data[t][n][e]):o(r.erMsg(2,e))}))}},{key:"remove",value:function(e){var r=this,t=this.dbName,n=this.tableName;return new bW((function(i,o){delete r.data[t][n][e],i("Remove ".concat(e," successful."))}))}},{key:"update",value:function(e,r){var t=this,n=this.dbName,i=this.tableName;return new bW((function(o,a){t.checkId(e)?(t.data[n][i][e]=r,o("Update ".concat(e," successful."))):a(t.erMsg(2,e))}))}},{key:"checkId",value:function(e){var r=this.dbName,t=this.tableName;return void 0!==this.data[r][t][e]}},{key:"erMsg",value:function(e,r){var t;return xk(t="The ".concat(this.table[e]," ")).call(t,r," does not exist.")}}]),e}(),WA=function(){function e(){vk(this,e),$C(this,"isDestroyed",!1),$C(this,"data",void 0),this.data={}}return Ik(e,[{key:"destroy",value:function(){if(!this.isDestroyed){for(var e=0,r=TW(this.data);e<r.length;e++){var t,n=mk(r[e],2),i=n[0];n[1],null!==(t=this.data[i])&&void 0!==t&&t.destroy(),this.data[i]=null}this.data=null,this.isDestroyed=!0}}},{key:"set",value:function(e,r){return!this.check(e)&&(this.data[e]=r,!0)}},{key:"get",value:function(e){return this.data[e]}},{key:"remove",value:function(e){return!!this.check(e)&&(delete this.data[e],!0)}},{key:"update",value:function(e,r){return!!this.check(e)&&(this.data[e]=r,!0)}},{key:"check",value:function(e){return void 0!==this.data[e]}}]),e}(),AA=function(e){Fw(t,PA);var r=qw(t);function t(e){var n;return vk(this,t),$C(tw(n=r.call(this,e)),"name",void 0),$C(tw(n),"type",void 0),$C(tw(n),"fileType",void 0),$C(tw(n),"createdDate",void 0),$C(tw(n),"modifiedDate",void 0),$C(tw(n),"parent",void 0),$C(tw(n),"isRoot",!1),n.name=e.name,n.type=e.type,n.fileType=e.fileType,n.parent=e.parent||null,n.isRoot=e.isRoot||!1,n.createdDate=IA(),n.modifiedDate=n.createdDate,n}return Ik(t,[{key:"updateDate",value:function(){this.modifiedDate=IA()}},{key:"setName",value:function(e){this.name=e}},{key:"reorder",value:function(e){var r=this.type;return("file"===r||"default"===r)&&xw(Dw(t.prototype),"reorder",this).call(this,e)}}]),t}(),RA=function(){function e(){vk(this,e),$C(this,"root",void 0),$C(this,"currentNode",void 0),$C(this,"selectedUid",void 0),$C(this,"defaultNode",void 0),$C(this,"hooks",{fileChanged:xA.create(),beforeRemoveFile:xA.create(),removeFile:xA.create(),afterRemoveFile:xA.create(),afterRenameFile:xA.create(),destroy:xA.create()}),this.root=new AA({uid:CA(),children:[],name:"root",type:"file",fileType:"folder",parent:void 0,isRoot:!0}),this.defaultNode=this.root,this.currentNode=this.root}return Ik(e,[{key:"appendChildrenToFile",value:function(e,r,t){var n=t,i=OA(this.defaultNode,e);return i||(i=this.createFile(e),this.hooks.fileChanged.emit(this.defaultNode)),Tk(r).call(r,(function(e){yA(n)?i.append(e):(i.insert(e,n),n+=1)})),i}},{key:"removeChildFromFile",value:function(e,r){SA(r)&&(r=[r]);var t=this.getFileByUid(e);t&&Tk(r).call(r,(function(e){t.remove(e)}))}},{key:"findChild",value:function(e,r){var t;return WW(t=e.children).call(t,(function(e){return e.name===r}))}},{key:"createFile",value:function(e){var r=this.defaultNode;r||(r=this.root);var t=OA(r,e);return t&&"file"===t.type||(t=new AA({uid:CA(),children:[],name:e,type:"file",fileType:"file",parent:r,isRoot:!1}),this.currentNode.append(t),this.hooks.fileChanged.emit(this.currentNode.children)),t}},{key:"removeFile",value:function(e){for(var r=this.defaultNode.children,t=0;t<r.length;t++){var n=r[t];if(n.name===e)return this.hooks.beforeRemoveFile.emit(n),iW(r).call(r,t,1),this.hooks.afterRemoveFile.emit(n),this.hooks.fileChanged.emit(n),!0}return!1}},{key:"renameFile",value:function(e,r){var t=this.findChild(this.defaultNode,e),n=this.findChild(this.defaultNode,r);return!!t&&!n&&(t.name=r,this.hooks.afterRenameFile.emit(t),this.hooks.fileChanged.emit(this.currentNode.children),!0)}},{key:"getFile",value:function(e){return this.findChild(this.defaultNode,e)}},{key:"getFileByUid",value:function(e){return WW(this).call(this,e,this.root)}},{key:"getCurrentFileList",value:function(){return this.currentNode.children}},{key:"isFileExist",value:function(e){return!!this.findChild(this.defaultNode,e)}},{key:"createFolder",value:function(){}},{key:"find",value:function(e,r){for(var t=r.children,n=t.length,i=0;i<n;i++){if(t[i].uid===e)return t[i];if(t[i].children){var o=WW(this).call(this,e,t[i]);if(o)return o}}return null}}]),e}();function OA(e,r){var t,n=AW(t=e.children).call(t,(function(e){return e.name===r}));return 0===n.length?null:n[0]}var LA,NA,MA=function(e){Fw(t,PA);var r=qw(t);function t(e){var n;return vk(this,t),$C(tw(n=r.call(this,e)),"name",void 0),$C(tw(n),"type","tag"),n.name=e.name,n.uid=e.uid||CA(),n.type="tag",n}return Ik(t)}(),UA=function(){function e(){vk(this,e),$C(this,"tags",void 0),$C(this,"defaultName",void 0),$C(this,"defaultUid",void 0),$C(this,"selectedUid",void 0),$C(this,"emptyItem",void 0),$C(this,"hooks",{beforeRemoveTag:xA.create(),afterRenameTag:xA.create(),destroy:xA.create(),load:xA.create()}),this.tags=[],this.defaultName=null,this.defaultUid=null,this.selectedUid=null,this.emptyItem=new MA({name:"defaultTag",children:[]})}return Ik(e,[{key:"appendChildToTag",value:function(e,r){var t=this.createTag(e);SA(r)&&(r=[r]);var n=!1;return Tk(r).call(r,(function(e){t.append(e)&&(n=!0)})),n}},{key:"removeChildFromTag",value:function(e,r){var t=this.getTag(e);return!!t&&(SA(r)&&(r=[r]),Tk(r).call(r,(function(e){t.remove(e)})),!0)}},{key:"createTag",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=this.getTag(e);return t||(t=new MA({name:e,children:r}),this.tags.push(t)),t}},{key:"removeTag",value:function(e){var r,t,n=this.getTag(e);if(!n)return!1;this.hooks.beforeRemoveTag.emit(n);var i=hW(r=this.tags).call(r,(function(r){return r.name===e}));return e===this.defaultName&&(this.defaultName=null,this.selectedUid=null),iW(t=this.tags).call(t,i,1),!0}},{key:"renameTag",value:function(e,r){if(!SA(e)||!SA(r))return!1;var t=this.isTagExisted(r),n=this.getTag(e);return!(!n||t||(n.name=r,this.hooks.afterRenameTag.emit(n),0))}},{key:"getTag",value:function(e){var r;return WW(r=this.tags).call(r,(function(r){return r.name===e}))}},{key:"getTagByUid",value:function(e){var r;return WW(r=this.tags).call(r,(function(r){return r.uid===e}))}},{key:"getTagList",value:function(){var e;return bF(e=this.tags).call(e)}},{key:"setDefaultTag",value:function(e){if(!e)return this.defaultName=null,this.defaultUid=null,!0;var r=this.getTag(e);return!!r&&(this.defaultName=e,this.defaultUid=r.uid,!0)}},{key:"getDefaultTag",value:function(){return this.defaultName}},{key:"isTagExisted",value:function(e){return!!this.getTag(e)}}]),e}(),BA=function(){function e(){vk(this,e)}return Ik(e,[{key:"apply",value:function(e){var r=e.hooks,t={beforeStatus:null,afterStatus:null,operation:null,docUid:null},n=function(e){t.beforeStatus={uids:[],selectedUids:[],currentUid:"",modifiedUid:e.modifiedUid,removedUids:e.removedUids}},i=function(r){t.afterStatus={uids:[],selectedUids:[],currentUid:"",modifiedUid:r.modifiedUid,removedUids:r.removedUids},t.docUid="",t.operation=r.operation,e.emit("bufferChanged",rw({},t)),t={beforeStatus:null,afterStatus:null,operation:null,docUid:null}};r.beforeBufferChanged.on(n),r.afterBufferChanged.on(i),r.destroy.on((function(){r.beforeBufferChanged.off(n),r.afterBufferChanged.off(i)}))}}]),e}(),VA=function(){function e(){vk(this,e)}return Ik(e,[{key:"apply",value:function(e){var r=e.hooks;e.customStore=new WA;var t=function(r){var t=r.data;Tk(t).call(t,(function(r){var t=r.customData;t||(t={}),e.customStore.set(r.uid,t)}))},n=function(r){var t=r.removedUids;Tk(t).call(t,(function(r){e.customStore.remove(r)}))},i=function(r){var t=r.data.customData;t&&e.customStore.update(r.modifiedUid,t)};r.loadSource.on(t),r.removeSource.on(n),r.updateSource.on(i),r.destroy.on((function(){r.loadSource.off(t),r.removeSource.off(n),r.updateSource.off(i)}))}}]),e}(),GA=function(e){Fw(t,PA);var r=qw(t);function t(){var e;return vk(this,t),$C(tw(e=r.call(this,{uid:CA(),children:[]})),"name","dvs-default"),$C(tw(e),"isDestroyed",!1),$C(tw(e),"type",void 0),e}return Ik(t,[{key:"destroy",value:function(){this.isDestroyed||(this.isDestroyed=!0)}}]),t}(),jA=function(){function e(){vk(this,e)}return Ik(e,[{key:"apply",value:function(e){e.defaultFile=new GA;var r=e.hooks,t=function(r){var t,n,i,o=r.filename,a=r.index,s=r.data;if(yA(o)){var u=UW(s).call(s,(function(e){return e.uid}));void 0===a?(t=e.defaultFile.children).push.apply(t,_k(u)):iW(n=e.defaultFile.children).apply(n,xk(i=[a,0]).call(i,_k(u)));var c={docUid:e.defaultFile.uid,sourceUids:u,type:"default",index:a};e.hooks.loadToDoc.emit(c)}},n=function(r){var t=r.removedUids,n=[];Tk(t).call(t,(function(r){var t=e.statusStore.get(r);t&&t.ownerDefaultFile&&(e.defaultFile.remove(r),n.push(r))})),n.length&&e.hooks.removeFromDoc.emit({docUid:e.defaultFile.uid,sourceUids:t,type:"default"})};r.loadSource.on(t),r.removeSource.on(n),r.destroy.on((function(){r.loadSource.off(t),r.removeSource.off(n)}))}}]),e}(),HA=function(){function e(){vk(this,e)}return Ik(e,[{key:"apply",value:function(e){e.dir=new RA,this.listenDirectoryHooks(e),this.listenSpaceHooks(e)}},{key:"listenDirectoryHooks",value:function(e){var r=e.dir.hooks,t=function(r){var t;Tk(t=r.children).call(t,(function(t){var n=e.statusStore.get(t);n&&n.ownerFiles.remove(r.uid)})),e.hooks.removeDoc.emit(r)},n=function(r){e.hooks.renameDoc.emit(r)};r.beforeRemoveFile.on(t),r.afterRenameFile.on(n),r.destroy.on((function(){r.beforeRemoveFile.off(t),r.afterRenameFile.off(n)}))}},{key:"listenSpaceHooks",value:function(e){var r=e.hooks,t=function(r){var t=r.data,n=r.filename,i=r.index;if(!yA(n)){var o=UW(t).call(t,(function(e){return e.uid})),a={docUid:e.dir.appendChildrenToFile(n,o,i).uid,sourceUids:o,type:"file",index:i};e.hooks.loadToDoc.emit(a)}},n=function(r){var t=r.removedUids,n={};Tk(t).call(t,(function(r){var t,i,o=e.statusStore.get(r);o&&Tk(t=bF(i=o.ownerFiles.children).call(i)).call(t,(function(e){n[e]||(n[e]=[]),n[e].push(r)}))}));for(var i=0,o=TW(n);i<o.length;i++){var a=mk(o[i],2),s=a[0],u=a[1];e.dir.removeChildFromFile(s,u),e.hooks.removeFromDoc.emit({docUid:s,sourceUids:u})}};r.loadSource.on(t),r.removeSource.on(n),r.destroy.on((function(){r.loadSource.off(t),r.removeSource.off(n)}))}}]),e}(),zA=function(){function e(){vk(this,e)}return Ik(e,[{key:"apply",value:function(e){var r=e.hooks;e.metadataStore=new WA;var t=function(r){var t=r.data;Tk(t).call(t,(function(r){var t=r.metadata;t||(t={width:void 0,height:void 0}),e.metadataStore.set(r.uid,t)}))},n=function(r){var t=r.removedUids;Tk(t).call(t,(function(r){e.metadataStore.remove(r)}))},i=function(r){var t=r.data.metadata;t&&e.metadataStore.update(r.modifiedUid,t)};r.loadSource.on(t),r.removeSource.on(n),r.updateSource.on(i),r.destroy.on((function(){r.loadSource.off(t),r.removeSource.off(n),r.updateSource.off(i)}))}}]),e}(),KA=function(){function e(r){vk(this,e),$C(this,"uid",null),$C(this,"minData",null),$C(this,"oriData",null),$C(this,"customData",{}),$C(this,"activeOri",!1),$C(this,"activeMin",!1),$C(this,"minTask",null),$C(this,"oriTask",null),$C(this,"load",!1),$C(this,"preload",[]),$C(this,"visible",[]),$C(this,"overlays",[]),$C(this,"img",null),$C(this,"owners",[]),$C(this,"oriType",null),$C(this,"minType",null),$C(this,"metadata",null),$C(this,"realTimeWidth",0),$C(this,"realTimeHeight",0),$C(this,"isFromFile",!1),$C(this,"isCached",!1),$C(this,"isDestroyed",!1),$C(this,"isLoading",!1),$C(this,"isSaving",!1),$C(this,"annotations",void 0),$C(this,"ownerFiles",new PA({children:[]})),$C(this,"ownerTags",new PA({children:[]})),$C(this,"ownerDefaultFile",void 0),$C(this,"operations",[]),$C(this,"useFillColor",!1),this.uid=r.uid,this.metadata=rw({},r.metadata),this.setRealTimeSize(this.metadata.width,this.metadata.height)}return Ik(e,[{key:"setRealTimeSize",value:function(e,r){this.realTimeWidth=e,this.realTimeHeight=r}},{key:"destroy",value:function(){this.isDestroyed||(this.customData=null,this.img=null,this.owners=null,this.metadata=null,this.isDestroyed=!0)}},{key:"addOwner",value:function(e){var r=this.owners;AF(r).call(r,e)<0&&r.push(e)}},{key:"removeOwner",value:function(e){var r=this.owners,t=AF(r).call(r,e);t>-1&&iW(r).call(r,t,1)}},{key:"removeViewer",value:function(e){var r=this.owners,t=AF(r).call(r,e);t>-1&&iW(r).call(r,t,1)}},{key:"setVisible",value:function(e){var r;AF(r=this.visible).call(r,e)<0&&this.visible.push(e)}},{key:"cancelVisible",value:function(e){var r,t,n=AF(r=this.visible).call(r,e);n>-1&&iW(t=this.visible).call(t,n,1)}},{key:"setPreload",value:function(e){var r;AF(r=this.preload).call(r,e)<0&&this.preload.push(e)}},{key:"cancelPreload",value:function(e){var r,t,n=AF(r=this.preload).call(r,e);n>-1&&iW(t=this.preload).call(t,n,1)}},{key:"reset",value:function(){this.minData=null,this.oriData=null,this.img=null,this.activeOri=!1,this.activeMin=!1,this.minTask=null,this.oriTask=null,this.operations=[]}}]),e}(),qA=function(){function e(){vk(this,e)}return Ik(e,[{key:"apply",value:function(e){var r=e.hooks;e.statusStore=new WA;var t=function(r){var t=r.data;r.filename,r.index,Tk(t).call(t,(function(r){var t=new KA(r);e.statusStore.set(r.uid,t)}))},n=function(r){var t=r.removedUids;Tk(t).call(t,(function(r){var t,n=e.statusStore.get(r);n&&(wA(n.minData),wA(n.oriData),n.ownerFiles.clear(),n.ownerTags.clear(),n.ownerDefaultFile=!1,null!==(t=n.img)&&void 0!==t&&t.src&&(n.img.src=""),n.img=null),e.statusStore.remove(r)}))},i=function(r){var t=r.modifiedUid,n=r.data,i=r.revoke,o=e.statusStore.get(t);if(o){o.img=null;var a=n.metadata;a&&(o.metadata=rw({},a),o.setRealTimeSize(a.width,a.height)),i&&(wA(o.oriData),wA(o.minData)),o.reset(),e.statusStore.update(t,o)}},o=function(r){var t;Tk(t=r.children).call(t,(function(t){var n=e.statusStore.get(t);n&&("file"===r.type?n.ownerFiles.remove(r.uid):"tag"===r.type&&n.ownerTags.remove(r.uid))}))},a=function(r){var t=r.docUid,n=r.sourceUids,i=r.type;Tk(n).call(n,(function(r){var n=e.statusStore.get(r);n&&("file"===i?n.ownerFiles.append(t):"tag"===i?n.ownerTags.append(t):"default"===i&&(n.ownerDefaultFile=!0))}))},s=function(r){var t=r.docUid,n=r.sourceUids,i=r.type;Tk(n).call(n,(function(r){var n=e.statusStore.get(r);n&&("file"===i?n.ownerFiles.remove(t):"tag"===i?n.ownerTags.remove(t):"default"===i&&(n.ownerDefaultFile=!0))}))};r.loadSource.on(t),r.afterRemoveSource.on(n),r.updateSource.on(i),r.removeDoc.on(o),r.loadToDoc.on(a),r.removeFromDoc.on(s),r.destroy.on((function(){r.loadSource.off(t),r.afterRemoveSource.off(n),r.updateSource.off(i),r.removeDoc.off(o),r.loadToDoc.off(a),r.removeFromDoc.off(s)}))}}]),e}(),XA=function(){function e(){vk(this,e)}return Ik(e,[{key:"apply",value:function(e){var r=e.hooks;e.store=new FA("space_db","space_doc");var t=function(r){var t=r.data;t&&Tk(t).call(t,(function(r){e.store.set(r.uid,r)}))},n=function(r){var t;Tk(t=r.removedUids).call(t,(function(r){e.store.remove(r)}))},i=function(r){e.store.update(r.modifiedUid,r.data)};r.loadSource.on(t),r.removeSource.on(n),r.updateSource.on(i),r.destroy.on((function(){r.loadSource.off(t),r.removeSource.off(n),r.updateSource.off(i)}))}}]),e}(),JA=function(){function e(){vk(this,e)}return Ik(e,[{key:"apply",value:function(e){e.tag=new UA,this.listenSpaceHooks(e),this.listenTagHooks(e)}},{key:"listenTagHooks",value:function(e){var r=e.tag.hooks,t=function(r){var t;Tk(t=r.children).call(t,(function(t){var n=e.statusStore.get(t);n&&n.ownerFiles.remove(r.uid)})),e.hooks.removeDoc.emit(r)},n=function(r){e.hooks.renameDoc.emit(r)};r.beforeRemoveTag.on(t),r.afterRenameTag.on(n),r.destroy.on((function(){r.beforeRemoveTag.off(t),r.afterRenameTag.off(n)}))}},{key:"listenSpaceHooks",value:function(e){var r=e.hooks,t=function(r){var t=r.data,n=e.tag.defaultName;Tk(t).call(t,(function(e){var r;e.tags||(e.tags=[]),n&&AF(r=e.tags).call(r,n)<0&&e.tags.push(n)}))},n=function(r){var t=r.data;Tk(t).call(t,(function(r){var t;null===(t=r.tags)||void 0===t||Tk(t).call(t,(function(t){e.tag.appendChildToTag(t,r.uid);var n={docUid:e.tag.getTag(t).uid,sourceUids:[r.uid],type:"tag"};e.hooks.loadToDoc.emit(n)}))}))},i=function(r){var t=r.removedUids,n={};Tk(t).call(t,(function(r){var t,i,o=e.statusStore.get(r);o&&Tk(t=bF(i=o.ownerTags.children).call(i)).call(t,(function(e){n[e]||(n[e]=[]),n[e].push(r)}))}));for(var i=0,o=TW(n);i<o.length;i++){var a=mk(o[i],2),s=a[0],u=a[1],c=e.tag.getTagByUid(s);c&&e.tag.removeChildFromTag(c.name,u),e.hooks.removeFromDoc.emit({docUid:s,sourceUids:u,type:"tag"})}},o=function(e){"tag"!==e.type&&i({removedUids:e.children})},a=function(r){var t=r.docUid,n=r.sourceUids;if("tag"===r.type){var i=e.tag.getTagByUid(t);i&&Tk(n).call(n,function(){var r=_C(pC().mark((function t(r){var n,o;return pC().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.store.get(r);case 3:if(o=t.sent,t.t0=o&&AF(n=o.tags).call(n,i.name)<0,!t.t0){t.next=9;break}return o.tags.push(i.name),t.next=9,e.store.update(r,o);case 9:t.next=14;break;case 11:t.prev=11,t.t1=t["catch"](0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e){return r.apply(this,arguments)}}())}},s=function(r){var t=r.docUid,n=r.sourceUids;if("tag"===r.type){var i=e.tag.getTagByUid(t);i&&Tk(n).call(n,function(){var r=_C(pC().mark((function t(r){var n,o,a,s;return pC().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.store.get(r);case 3:if(!(n=t.sent)){t.next=9;break}return(s=AF(o=n.tags).call(o,i.name))>-1&&iW(a=n.tags).call(a,s,1),t.next=9,e.store.update(r,n);case 9:t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e){return r.apply(this,arguments)}}())}};r.beforeLoadSource.on(t),r.loadSource.on(n),r.removeSource.on(i),r.removeDoc.on(o),r.loadToDoc.on(a),r.removeFromDoc.on(s),r.destroy.on((function(){r.beforeLoadSource.off(t),r.loadSource.off(n),r.removeSource.off(i),r.removeDoc.off(o),r.loadToDoc.off(a),r.removeFromDoc.off(s)}))}}]),e}(),YA=function(e){Fw(t,kA);var r=qw(t);function t(){var e;return vk(this,t),$C(tw(e=r.call(this)),"uid",CA()),$C(tw(e),"hooks",{init:xA.create(),destroy:xA.create(),beforeLoadSource:xA.create(),loadSource:xA.create(),afterLoadSource:xA.create(),beforeRemoveSource:xA.create(),removeSource:xA.create(),afterRemoveSource:xA.create(),beforeUpdateSource:xA.create(),updateSource:xA.create(),afterUpdateSource:xA.create(),beforeBufferChanged:xA.create(),afterBufferChanged:xA.create(),directoryChanged:xA.create(),tagChanged:xA.create(),openDoc:xA.create(),loadToDoc:xA.create(),removeFromDoc:xA.create(),removeDoc:xA.create(),renameDoc:xA.create(),move:xA.create(),afterMove:xA.create(),"switch":xA.create(),afterSwitch:xA.create(),reorder:xA.create(),afterReorder:xA.create()}),$C(tw(e),"dir",void 0),$C(tw(e),"tag",void 0),$C(tw(e),"store",void 0),$C(tw(e),"customStore",void 0),$C(tw(e),"metadataStore",void 0),$C(tw(e),"statusStore",void 0),$C(tw(e),"defaultFile",void 0),$C(tw(e),"plugins",[]),$C(tw(e),"imageLoader",void 0),e.initPlugins(),e.hooks.init.emit(),e}return Ik(t,[{key:"destroy",value:function(){this.hooks.destroy.emit()}},{key:"initPlugins",value:function(){(new XA).apply(this),(new qA).apply(this),(new VA).apply(this),(new zA).apply(this),(new BA).apply(this),(new jA).apply(this),(new HA).apply(this),(new JA).apply(this)}},{key:"setImageLoader",value:function(e){this.imageLoader=e}},{key:"getCustomData",value:function(e){return this.customStore.get(e)}},{key:"setCustomData",value:function(e,r){return this.customStore.set(e,r)}},{key:"getMetadata",value:function(e){return this.metadataStore.get(e)}},{key:"setMetadata",value:function(e,r){return this.metadataStore.set(e,r)}},{key:"createStore",value:function(e){var r=e.type,t=void 0===r?"sync":r,n=e.tableName,i=e.dbName;return"sync"===t?new WA:i&&n?new FA(i,n):null}},{key:"loadSource",value:function(e){if(yA(e))return[];var r=e.data;if(!vA(r))return[];var t=[];return Tk(r).call(r,(function(e){e.uid=CA(),t.push(e.uid)})),this.hooks.beforeBufferChanged.emit(e),this.hooks.beforeLoadSource.emit(e),this.hooks.loadSource.emit(e),this.hooks.afterLoadSource.emit(e),this.hooks.afterBufferChanged.emit(e),t}},{key:"removeSource",value:function(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];SA(e)&&(e=[e]);var t={removedUids:e,docUid:"",trigger:this.uid,operation:"remove"};return this.hooks.beforeRemoveSource.emit(t),this.hooks.beforeBufferChanged.emit(t),this.hooks.removeSource.emit(t),r&&this.hooks.afterRemoveSource.emit(t),this.hooks.afterBufferChanged.emit(t),!0}},{key:"updateSource",value:function(e,r){var t={modifiedUid:e,data:r,revoke:!(arguments.length>2&&void 0!==arguments[2])||arguments[2],operation:"modify"};return this.hooks.beforeUpdateSource.emit(t),this.hooks.beforeBufferChanged.emit(t),this.hooks.updateSource.emit(t),this.hooks.afterUpdateSource.emit(t),this.hooks.afterBufferChanged.emit(t),!0}},{key:"getSource",value:function(e){return this.store.get(e)}},{key:"openDefault",value:function(e){var r={node:this.defaultFile,type:"default",config:e};this.hooks.openDoc.emit(r)}},{key:"createFile",value:function(e){return this.dir.createFile(e)}},{key:"removeFile",value:function(e){return this.dir.removeFile(e)}},{key:"renameFile",value:function(e,r){return this.dir.renameFile(e,r)}},{key:"openFile",value:function(e,r){var t=this.getFile(e);if(!t)return!1;var n={node:t,type:"file",config:r};return this.hooks.openDoc.emit(n),!0}},{key:"getFile",value:function(e){return this.dir.getFile(e)}},{key:"getFileList",value:function(){return this.dir.getCurrentFileList()}},{key:"isFileExisted",value:function(e){return this.dir.isFileExist(e)}},{key:"createTag",value:function(e){return this.tag.createTag(e)}},{key:"removeTag",value:function(e){return this.tag.removeTag(e)}},{key:"renameTag",value:function(e,r){return this.tag.renameTag(e,r)}},{key:"openTag",value:function(e,r){var t=this.getTag(e);if(!t)return!1;var n={node:t,type:"tag",config:r};return this.hooks.openDoc.emit(n),!0}},{key:"getTag",value:function(e){return this.tag.getTag(e)}},{key:"getTagList",value:function(){return this.tag.getTagList()}},{key:"setDefaultTag",value:function(e){return this.tag.setDefaultTag(e)}},{key:"getDefaultTag",value:function(){return this.tag.getDefaultTag()}},{key:"isTagExisted",value:function(e){return this.tag.isTagExisted(e)}},{key:"addTagToSource",value:function(e,r){if(this.statusStore.get(e)){SA(r)&&(r=[r]);for(var t=0;t<r.length;t++)if(!this.addSourceToTag(r[t],e))return!1;return!0}return!1}},{key:"removeTagFromSource",value:function(e,r){if(this.statusStore.get(e)){var t;yA(r)?r=UW(t=this.tag.tags).call(t,(function(e){return e.name})):SA(r)&&(r=[r]);for(var n=0;n<r.length;n++)if(!this.removeSourceFromTag(r[n],e))return!1;return!0}return!1}},{key:"addSourceToTag",value:function(e,r){var t=this.tag.getTag(e);if(t&&this.tag.appendChildToTag(e,r)){SA(r)&&(r=[r]);var n={sourceUids:r,docUid:t.uid,type:"tag"};return this.hooks.loadToDoc.emit(n),!0}return!1}},{key:"removeSourceFromTag",value:function(e,r){var t=this.tag.getTag(e);if(t){this.tag.removeChildFromTag(e,r),SA(r)&&(r=[r]);var n={docUid:t.uid,sourceUids:r,type:"tag"};return this.hooks.removeFromDoc.emit(n),!0}return!1}},{key:"getSourceTags",value:function(e){var r,t=this,n=this.statusStore.get(e);return n?UW(r=n.ownerTags.children).call(r,(function(e){return t.tag.getTagByUid(e).name})):[]}},{key:"switch",value:function(e){var r=e.one,t=e.other,n=e.type,i=e.docUid,o=e.emit,a=this.getDocNode(i,n);if(a){if(a["switch"](r,t),o||yA(o)){var s={one:r,other:t,docUid:i,type:a.type,trigger:this.uid,operation:"shift"};this.hooks["switch"].emit(s)}return!0}return!1}},{key:"move",value:function(e){var r=e.from,t=e.to,n=e.type,i=e.docUid,o=e.emit,a=this.getDocNode(i,n);if(a){if(a.move(r,t),o||yA(o)){var s={from:r,to:t,docUid:i,type:a.type,trigger:this.uid,operation:"shift"};this.hooks.move.emit(s)}return!0}return!1}},{key:"reorder",value:function(e){var r=e.indexes,t=e.type,n=e.docUid,i=e.emit,o=this.getDocNode(n,t);if(o&&(o.reorder(r),i||yA(i))){var a={indexes:r,docUid:n,type:o.type,trigger:this.uid,operation:"shift"};this.hooks.move.emit(a)}}},{key:"getDocNode",value:function(e,r){switch(r){case"default":return this.defaultFile;case"file":return this.dir.getFileByUid(e);case"tag":return this.tag.getTagByUid(e);default:return e===this.defaultFile.uid?this.defaultFile:this.tag.getTagByUid(e)||this.dir.getFileByUid(e)||null}}}]),t}(),ZA={Successful:{errorCode:0,errorString:"Successful."},InvalidIndex:{errorCode:-1033,errorString:"Invalid index."},InvalidValue:{errorCode:-1034,errorString:"Invalid value."},NoImage:{errorCode:-1035,errorString:"There is no image."},UnBindViewer:{errorCode:-2210,errorString:"You cannot call this method on this WebTwain instance because it does not use the default viewer."},AlReadyBindViewer:{errorCode:-2211,errorString:"The element is already bound to the viewer."},ParameterCannotEmpty:{errorCode:-2314,errorString:"The parameter cannot be empty."},IndicesNotArray:{errorCode:-2358,errorString:"The type of the parameter indices must be an Array."},IndexOutOfRange:{errorCode:-2359,errorString:"The index is out of range."},InvalidTagName:{errorCode:-2394,errorString:"Invalid tag name."},InvalidLeftOrTopOrRightOrBottom:{errorCode:-2417,errorString:"The left or top or right or bottom you entered is invalid."},InvalidWidth:{errorCode:-2418,errorString:"The width you entered is invalid."},InvalidHeight:{errorCode:-2419,errorString:"The height you entered is invalid."},WidthOrHeightOutOfImageSize:{errorCode:-2420,errorString:"The width or height is out of image size."},MobileServer_InvalidIndex:{errorCode:-2423,errorString:"The index is invalid."},ImageEditorExist:{errorCode:-2500,errorString:"An ImageEditor already exists."},ThumbnailViewerExist:{errorCode:-2501,errorString:"A ThumbnailViewer already exists."},CustomElementExist:{errorCode:-2502,errorString:"A CustomElement already exists."},ImageEditorDispose:{errorCode:-2504,errorString:"The ImageEditor object has been disposed."},ThumbnailViewerNotExist:{errorCode:-2505,errorString:"This ThumbnailViewer doesn't exist."},ThumbnailViewerDispose:{errorCode:-2506,errorString:"The ThumbnailViewer object has been disposed."},CallbackNotAFunction:{errorCode:-2510,errorString:"The callback is not a function."},ElementRequired:{errorCode:-2511,errorString:"Parameter 'element' is required."},ElementNotExist:{errorCode:-2512,errorString:"Parameter 'element' doesn't instanceof HTMLDivElement."},InvalidPropertyValue:{errorCode:-2514,errorString:"Invalid property value."},CursorInvalidMode:{errorCode:-2519,errorString:"The current mode does not support setting the cursor to zoom."},OldTagNameRequired:{errorCode:-2517,errorString:"Old tag name is required."},NewTagNameRequired:{errorCode:-2518,errorString:"New tag name is required."},FileNameCannotEmpty:{errorCode:-2530,errorString:"Document name cannot be empty."},FileNameNotString:{errorCode:-2531,errorString:"Document name is not a string."},FileNotExist:{errorCode:-2540,errorString:"The document does not exist."},FileExist:{errorCode:-2541,errorString:"The document already exists."},CustomElementDispose:{errorCode:-2508,errorString:"The CustomElement object has been disposed."},CustomElementNotExist:{errorCode:-2507,errorString:"This CustomElement doesn't exist."},ParameterOutRange:{errorCode:80002,errorString:"The parameter is out of range."},TagNotExist:{errorCode:80009,errorString:"Tag does not exist."},TagExist:{errorCode:80010,errorString:"The tag already exists."},OperationError:{errorCode:80022,errorString:"The operation mode is wrong."}};(NA=LA||(LA={}))[NA.Normal=0]="Normal",NA[NA.Balance=1]="Balance";var QA=function(){function e(r){vk(this,e),$C(this,"space",void 0),$C(this,"webViewer",void 0),$C(this,"isActiveFile",!1),$C(this,"isActiveTag",!1),$C(this,"currentFileName",""),$C(this,"currentTagName",""),$C(this,"bufferConfig",null),$C(this,"currentSelected",[]),this.space=new YA,r&&(this.bufferConfig=r)}return Ik(e,[{key:"e",value:function(){this.setError("Successful")}},{key:"convertServerIdToGuid",value:function(e){return 1*e+239514e3}},{key:"IsFileNameExist",value:function(e){var r=this.space.getFileList();if("dynamsoft-default-document"===e)return!0;if(r)for(var t=0;t<r.length;t++)if(r[t].name===e)return!0;return!1}},{key:"getCurrentDataSet",value:function(){if(this.webViewer){var e=this.webViewer.myViewer.getCurrentTab();if(void 0===e)return!1;var r=e.type;this.isActiveFile="file"===r,this.isActiveTag="tag"===r}if(this.isActiveFile){var t=this.getCurrentFileName(),n=this.space.getFile(t);if(n)return n}if(this.isActiveTag){var i=this.space.getTag(this.currentTagName);if(i)return i}return!1}},{key:"setError",value:function(e){var r;if("Default"!==e){if(this.webViewer)this.webViewer.setError(e);else if(this.bufferConfig&&this.bufferConfig.viewerError){var t=ZA[e],n=t.errorCode,i=t.errorString;this.bufferConfig.viewerError.setError(n,i)}}else null==this||null===(r=this.webViewer)||void 0===r||r.setDefaultError()}},{key:"emitViewerEvent",value:function(){var e,r,t,n;this.webViewer&&0===this.getHowManyImagesInBuffer()&&(null!==(e=this.webViewer)&&void 0!==e&&null!==(r=e.myViewer)&&void 0!==r&&r.emit("topPageChanged",-1),null===(t=this.webViewer)||void 0===t||null===(n=t.myViewer)||void 0===n||n.emit("pageRendered",-1))}},{key:"bindViewer",value:function(e){this.webViewer=e}},{key:"getCurrentTag",value:function(){return this.currentTagName}},{key:"getCurrentDocument",value:function(){return this.currentFileName}},{key:"getCurrentFileName",value:function(){var e=this,r=this.space.getFileList(),t="";return r&&Tk(r).call(r,(function(r){r.name===e.currentFileName&&(t=e.currentFileName)})),t}},{key:"getCurrentIndex",value:function(){if(this.webViewer)return this.webViewer.getCurrentIndex();var e=this.getSelectedImagesIndices().length;if(e<=0){var r=this.getCurrentDataSet();return!!r&&r.children.length-1}return this.getSelectedImagesIndices()[e-1]}},{key:"getHowManyImagesInBuffer",value:function(){if(this.webViewer)return this.webViewer.getHowManyImagesInBuffer();var e=this.getCurrentDataSet();return e?e.children.length:0}},{key:"getSelectedImagesIndices",value:function(){return this.webViewer?this.webViewer.getSelectedImagesIndices():this.currentSelected}},{key:"getIndexByUid",value:function(e){if(!SA(e)||!e)return this.setError("InvalidValue"),!1;if(this.webViewer)return this.webViewer.myViewer.getIndexByUid(e);var r=this.getCurrentDataSet(),t=r.children;return!!(r&&t&&vA(t))&&AF(t).call(t,e)}},{key:"getUidByIndex",value:function(e){if(e<0||e>=this.getHowManyImagesInBuffer())return this.setError("IndexOutOfRange"),!1;if(this.webViewer)return this.webViewer.myViewer.getUidByIndex(e);var r=this.getCurrentDataSet().children;return!(r&&r.length<e)&&r[e]}},{key:"getDataByUid",value:function(e){return this.space.getSource(e)}},{key:"updateDataByUid",value:function(e,r){return this.space.store.set(e,r)}},{key:"setCustomDataByUid",value:function(e,r){return SA(e)&&""!==e?this.space.setCustomData(e,r):(this.setError("InvalidValue"),!1)}},{key:"getCustomDataByUid",value:function(e){return this.space.getCustomData(e)}},{key:"setMetadataByUid",value:function(e,r){return SA(e)&&""!==e?this.space.setMetadata(e,r):(this.setError("InvalidValue"),!1)}},{key:"getMetadataByUid",value:function(e){return this.space.getMetadata(e)}},{key:"addImage",value:function(e,r,t){var n,i,o={},a=this.currentFileName,s="";!yA(t)&&SA(t)?(this.IsFileNameExist(t)||this.createDocument(t),s=t):yA(a)||""===a?(this.space.isFileExisted("dynamsoft-default-document")||this.createDocument("dynamsoft-default-document"),this.webViewer&&(this.webViewer.bEmitBufferChanged=!1),this.openDocument("dynamsoft-default-document"),this.webViewer&&(this.webViewer.bEmitBufferChanged=!0),s="dynamsoft-default-document"):s=a,r&&(delete(i=rw({},r)).oriBlobData,r.oriBlobData&&(n=r.oriBlobData));var u=e.imageUrl,c=e.minImageUrl,l=e.imageId,d=e.index;if(n&&(o=rw({},n)),l&&(o.imageId=l),!yA(d)&&TA(d)){var f=this.getDocumentContents(s).length;d>=f&&(d=f)}var h=this.space.loadSource({data:[{oriData:u,minData:c,metadata:i,customData:o}],filename:s,index:d}),g=mk(h,1)[0];return e.uuid=g,this.currentSelected=!yA(d)&&TA(d)?[d]:[],h}},{key:"insertImage",value:function(e,r,t){var n;return t&&t>=0?(n=this.space.loadSource({data:[e],filename:r,index:t}))[0]&&(this.currentSelected=[t]):(n=this.space.loadSource({data:[e],filename:r}),this.currentSelected=[]),n[0]}},{key:"updateImage",value:function(e,r){var t=e.imageUrl,n=e.minImageUrl,i=e.imageId,o=e.uuid,a=rw({},r);return o&&""!==o&&-1!==o?(this.space.updateSource(o,{oriData:t,minData:n,metadata:a,customData:{imageId:i}}),o):(this.setError("IndexOutOfRange"),!1)}},{key:"removeImageByUid",value:function(e){if(this.e(),this.webViewer){var r=this.webViewer.removePageByUid(e);return this.webViewer.resized(),this.emitViewerEvent(),r}return this.space.removeSource(e)}},{key:"removeImageByIndex",value:function(e){if(this.e(),e<0||e>=this.getHowManyImagesInBuffer())return this.setError("IndexOutOfRange"),!1;var r=this.getCurrentIndex(),t=!1;if(this.webViewer)t=this.webViewer.removePageByIndexes(e),this.webViewer.resized(),this.emitViewerEvent();else{var n=this.getCurrentDataSet();if(!n)return!1;t=this.space.removeSource(n.children[e])}return t||this.setError("Default"),this.currentSelected=e===r&&0===e?this.getHowManyImagesInBuffer()>0?[0]:[]:e<=r?[r-1]:[r],t}},{key:"removeSelectedImages",value:function(e){this.e();var r=this.getSelectedImagesIndices();vA(e)&&e.length>0&&(r=e);var t=!1;if(this.webViewer)t=this.webViewer.removePageByIndexes(r),this.webViewer.resized(),this.emitViewerEvent();else{var n=[],i=this.getCurrentDataSet();if(!i)return!1;Tk(r).call(r,(function(e){i.children[e]&&i.children[e]&&n.push(i.children[e])})),t=this.space.removeSource(n)}return t||this.setError("Default"),t}},{key:"removeImageByIndexArr",value:function(e){if(this.e(),!vA(e))return!1;var r=this.getCurrentDataSet();if(!r)return!1;var t,n=[];return Tk(e).call(e,(function(e){var t=r.children[e];t&&n.push(t)})),(t=this.space.removeSource(n))||this.setError("Default"),this.webViewer&&(this.webViewer.resized(),this.emitViewerEvent()),this.currentSelected=[],t}},{key:"removeAllImages",value:function(){this.e();var e=!1;if(this.webViewer)e=this.webViewer.removeAllPages(),this.webViewer.resized(),this.emitViewerEvent();else{var r=this.getCurrentDataSet();r&&(e=this.space.removeSource(_k(r.children)))}return e||this.setError("Default"),this.currentSelected=[],e}},{key:"tagImages",value:function(e,r){this.e();var t=this.getHowManyImagesInBuffer();if(!vA(e))return this.setError("IndicesNotArray"),!1;if(!SA(r)||""===r)return this.setError("InvalidTagName"),!1;for(var n=0;n<t;n++){var i=e[n];if(Ek(i)||i<0||i>=t)return this.setError("IndexOutOfRange"),!1}this.space.createTag(r);for(var o=0;o<e.length;o++){var a=e[o];if(a>=0){var s=this.getUidByIndex(a);s&&""!==s&&-1!==sA(s,10)&&this.space.addTagToSource(s,r)}}return!0}},{key:"removeImageTag",value:function(e,r){if(this.e(),!TA(e))return this.setError("InvalidValue"),!1;if(e<0||e>this.getHowManyImagesInBuffer())return this.setError("IndexOutOfRange"),!1;var t=this.getUidByIndex(e),n=!1;return t&&""!==t&&-1!==t&&(n=this.space.removeTagFromSource(t,r)),n||this.setError("Default"),n}},{key:"getDefaultTag",value:function(){return this.space.getDefaultTag()}},{key:"setDefaultTag",value:function(e){var r;return this.e(),this.currentTagName=e,this.space.createTag(e),(r=this.space.setDefaultTag(e))||this.setError("Default"),r}},{key:"removeTag",value:function(e,r){var t=this;if(this.e(),!SA(e))return this.setError("InvalidValue"),!1;if(!yA(r)&&!vA(r))return this.setError("IndicesNotArray"),!1;if(!this.space.isTagExisted(e))return this.setError("TagNotExist"),!1;var n=this.currentTagName,i=!1,o=!1;if(n&&(i=n===e),yA(r))o=this.space.removeTag(e),i&&this.clearFilter();else{var a=[];Tk(r).call(r,(function(e){var r=t.getUidByIndex(e);-1!==r&&a.push(r)}));for(var s=0;s<(null==a?void 0:a.length);s++)if(!(o=this.space.removeTagFromSource(a[s],e)))return!1}return o||this.webViewer.setDefaultError(),o}},{key:"renameTag",value:function(e,r){return this.e(),yA(e)||""===e?(this.setError("OldTagNameRequired"),!1):yA(r)||""===r?(this.setError("NewTagNameRequired"),!1):this.space.isTagExisted(e)?this.space.isTagExisted(r)?(this.setError("TagExist"),!1):(this.currentTagName=r,(t=this.space.renameTag(e,r))?this.space.setDefaultTag(r):this.setError("Default"),t):(this.setError("TagNotExist"),!1);var t}},{key:"getTagContents",value:function(e){return this.e(),e&&SA(e)&&""!==e?this.space.getTag(e).children:[]}},{key:"getTagList",value:function(){var e=this;this.e();var r=this.space.getTagList(),t=[];return r?Tk(r).call(r,(function(r){var n,i=[];Tk(n=r.children).call(n,(function(r){var t=e.getCustomDataByUid(r);if(t){var n=e.convertServerIdToGuid(t.imageId);i.push(n)}})),t.push({name:r.name,imageIds:i})})):t=[],t}},{key:"getTagListByIndex",value:function(e){if(!TA(e))return!1;var r=this.getUidByIndex(e);return this.space.getSourceTags(r)}},{key:"clearFilter",value:function(){this.e(),this.currentTagName="";var e,r=this.getCurrentFileName();return""===r&&(r="dynamsoft-default-document"),(e=this.openDocument(r))||this.setError("Default"),e}},{key:"filterImagesByTag",value:function(e,r,t){this.e();var n=!1;if(yA(e)||null===e||""===e){this.currentTagName="";var i=this.getCurrentFileName();""===i&&(i="dynamsoft-default-document"),(n=this.openDocument(i))?bA(r)&&r():(this.setError("Default"),bA(t)&&t())}else{var o,a;if(!this.space.isTagExisted(e))return this.setError("TagNotExist"),bA(t)&&t(),!1;this.currentTagName=e,(n=this.space.openTag(e,null==this||null===(o=this.webViewer)||void 0===o||null===(a=o.myViewer)||void 0===a?void 0:a.uid))?(this.isActiveTag=!0,this.isActiveFile=!1,this.setDefaultTag(e),bA(r)&&r()):(this.setError("Default"),bA(t)&&t())}return this.webViewer&&this.webViewer.render(),n}},{key:"createDocument",value:function(e){if(this.e(),!e||""===e){var r=TA(e)?"FileNameNotString":"FileNameCannotEmpty";return this.setError(r),!1}return SA(e)?this.space.isFileExisted(e)?(this.setError("FileExist"),!1):!!this.space.createFile(e)||(this.setError("Default"),!1):(this.setError("FileNameNotString"),!1)}},{key:"openDocument",value:function(e,r){var t,n;if(this.e(),!e||""===e){var i=TA(e)?"FileNameNotString":"FileNameCannotEmpty";return this.setError(i),!1}if(!SA(e))return this.setError("FileNameNotString"),!1;if(!this.space.isFileExisted(e))return this.setError("FileNotExist"),!1;var o=r&&""!==r?r:null==this||null===(t=this.webViewer)||void 0===t||null===(n=t.myViewer)||void 0===n?void 0:n.uid;return this.space.openFile(e,{viewerUid:o})?(this.currentFileName=e,this.isActiveFile=!0,this.isActiveTag=!1,!0):(this.setError("Default"),!1)}},{key:"getDocumentContents",value:function(e){return this.e(),e&&SA(e)&&""!==e?this.space.getFile(e).children:[]}},{key:"renameDocument",value:function(e,r){return this.e(),SA(e)&&SA(r)?(e&&""!==e&&r&&""!==r||this.setError("FileNameCannotEmpty"),this.space.isFileExisted(e)?this.space.isFileExisted(r)?(this.setError("FileExist"),!1):this.space.renameFile(e,r)?(this.currentFileName=r,!0):(this.setError("Default"),!1):(this.setError("FileNotExist"),!1)):(this.setError("FileNameNotString"),!1)}},{key:"removeDocument",value:function(e){if(this.e(),!e||!SA(e))return this.setError("FileNameNotString"),!1;if(!this.space.isFileExisted(e))return this.setError("FileNotExist"),!1;var r=this.space.removeFile(e);return r?(r&&this.webViewer&&this.webViewer.resized(),this.currentFileName===e&&(this.currentFileName=""),!0):(this.setError("Default"),!1)}},{key:"getDocumentInfoList",value:function(){var e=this;this.e();var r=this.space.getFileList(),t=[];return r?(Tk(r).call(r,(function(r){if(r.children){for(var n=[],i=0;i<r.children.length;i++){var o=r.children[i],a=e.getCustomDataByUid(o);a&&n.push(e.convertServerIdToGuid(a.imageId))}t.push({imageIds:n,name:r.name})}})),t):[]}},{key:"getDocumentInfo",value:function(e){this.e();var r=this.space.getFile(e);if(!r)return{imageIds:[],length:0};for(var t=[],n=0;n<r.children.length;n++){var i=r.children[n],o=this.getCustomDataByUid(i);o&&t.push(this.convertServerIdToGuid(o.imageId))}return{imageIds:t,length:t.length}}},{key:"selectImages",value:function(e){this.e();var r=!0;if(!e||!vA(e))return!1;if(this.webViewer){var t=this.webViewer.getIfAutoScroll();!1===t&&this.webViewer.setIfAutoScroll(!0),r=this.webViewer.myViewer.setSelectedIndexes(e),!1===t&&this.webViewer.setIfAutoScroll(!1)}else{for(var n=this.getHowManyImagesInBuffer(),i=0;i<e.length;i++)if(!TA(e[i])||e[i]<0||e[i]>=n)return this.setError("ParameterOutRange"),!1;r=!0}return r?this.currentSelected=e:this.setError("Default"),r}},{key:"selectAllImages",value:function(){this.e();var e=!0;if(this.webViewer)e=this.webViewer.myViewer.selectAll(),this.currentSelected=this.webViewer.getSelectedImagesIndices();else{var r,t=this.getCurrentDataSet();this.currentSelected=uA(mA(r=new Array(t.children.length)).call(r))}return e||this.setError("Default"),e}},{key:"moveImage",value:function(e,r){this.e();var t=sA(e,10),n=sA(r,10);if(Ek(e)||Ek(r))return this.setError("InvalidIndex"),!1;var i=this.getHowManyImagesInBuffer();if(t<0||t>=i||n<0||n>i)return this.setError("IndexOutOfRange"),!1;var o=!1;if(this.webViewer)o=this.webViewer.myViewer.movePage(e,r);else{var a=this.getCurrentDataSet();if(!a)return!1;o=this.space.move({docUid:a.uid,type:a.type,from:e,to:r})}return o||this.setError("Default"),this.currentSelected=[r],o}},{key:"switchImage",value:function(e,r){this.e();var t=sA(e,10),n=sA(r,10);if(Ek(e)||Ek(r))return this.setError("InvalidIndex"),!1;var i=this.getHowManyImagesInBuffer(),o=this.getCurrentIndex();if(t<0||t>=i||n<0||n>i)return this.setError("IndexOutOfRange"),!1;var a=!1;if(this.webViewer)a=this.webViewer.myViewer.switchPage(e,r);else{var s=this.getCurrentDataSet();if(!s)return!1;a=this.space["switch"]({docUid:s.uid,type:s.type,one:e,other:r})}a||this.setError("Default");var u=o;return t===o?u=n:n===o&&(u=t),this.currentSelected=[u],a}}]),e}();HTMLCanvasElement.prototype.toBlob||_A(HTMLCanvasElement.prototype,"toBlob",{value:function(e,r,t){for(var n=atob(this.toDataURL(r,t).split(",")[1]),i=n.length,o=new Uint8Array(i),a=0;a<i;a++)o[a]=n.charCodeAt(a);e(new Blob([o],{type:r||"image/png"}))}});var $A=function(){function e(t){if(X(this,e),t)this._baseUrl=t._baseUrl,this._buffer=t._buffer,this._imageIdMap=t._imageIdMap;else{var n={viewerError:{setError:function(e,t){r.log(e,t),this._error={code:e,message:t}}}};this._baseUrl="",this._buffer=new QA(n),this._imageIdMap={}}}return Q(e,[{key:"getError",value:function(){return this._error}},{key:"BaseUrl",get:function(){return this._baseUrl}},{key:"getImageUrl",value:function(e){var r=this.convertClientIndexToServerId(e),t=Date.now();return Rs.getImageUrl(this._baseUrl,r,-1,-1,t)}},{key:"getMinImageUrl",value:function(e){var r=this.convertClientIndexToServerId(e),t=Date.now();if(r){var n=this._imageIdMap[r];return Rs.getImageUrl(this._baseUrl,r,parseInt(n.iImageControlWidth),parseInt(n.iImageControlHeight),t)}return""}},{key:"append",value:function(e,r,t){var n,i,o=Date.now(),a=r;if(n={imageUrl:Rs.getImageUrl(this._baseUrl,r,-1,-1,o),imageId:a},i=t.currentFileName.length>0?this._buffer.addImage(n,t,t.currentFileName):this._buffer.addImage(n,t)){var s=Fs(i,1)[0];return this._innerInsertModel(n.imageId,s,n.imageUrl),s}return!1}},{key:"insertBefore",value:function(e,r,t,n){var i,o=Date.now(),a=t;i={imageUrl:Rs.getImageUrl(this._baseUrl,t,-1,-1,o),imageId:a,index:e};var s=this._buffer.addImage(i);if(s){var u=Fs(s,1)[0];return this._innerInsertModel(i.imageId,u,i.imageUrl),this._buffer.openDocument(this.getCurrentFileName()),u}return!1}},{key:"_innerInsertModel",value:function(e,r,t){var n=new Ws;n.imageId=e,n.uuid=r,n.imageUrl=t,this._imageIdMap[e]=n}},{key:"refresh",value:function(e,r,t,n){var i,o=this,a=1*e;if(t){var s=o.count();if(a<0||a>s)return!1;i=o.convertClientIndexToServerId(a),o.__setDataImageControl(a,i,n)}return!0}},{key:"__setDataImageControl",value:function(e,r,t){var n,i,o=this,a=o._baseUrl;return-1!=r&&((n=o.getImageIdMap(r))||((n=new Ws).imageId=r,o._imageIdMap[r]=n),a&&(null!=n&&(n.ticks=Date.now()),i=Rs.getImageUrl(a,r,-1,-1,n.ticks),n.imageUrl=i,o._buffer.updateImage(n,t)),!0)}},{key:"convertIndicesToServerIds",value:function(e){var r,t=e.length,n=[];for(r=0;r<t;r++){var i=this._buffer.getUidByIndex(e[r]);if(i&&-1!=i){var o=this._buffer.getCustomDataByUid(i);n.push(o.imageId)}}return n}},{key:"removeImagesByServerId",value:function(e,t){var n=this,i=null!=t?t:this._buffer.getCurrentDocument(),o=[];return r.each(e,(function(e,r){var t=parseInt(e);n._removeMapModelImageControlByServerId(t);var a=-1;return a=n._buffer.isActiveFile?n._convertServerIdToIndexInFile(i,t):n._convertServerIdToIndex(t),!isNaN(a)&&(!(a<0||a>=n.count())&&void o.push(a))})),o.length>0&&n._buffer.removeImageByIndexArr(o)}},{key:"removeByServerId",value:function(e,r,t){var n=this,i=null!=t?t:this._buffer.getCurrentDocument();n._removeMapModelImageControlByServerId(e);var o=-1;return o=this._buffer.isActiveFile?this._convertServerIdToIndexInFile(i,e):r,!isNaN(o)&&(!(o<0||o>=n.count())&&n._buffer.removeImageByIndex(o))}},{key:"exists",value:function(e){if(this._imageIdMap[e])return!0;var r=-1;if(this._buffer.isActiveFile){var t=this.getCurrentFileName();r=this._convertServerIdToIndexInFile(t,e)}else r=this._convertServerIdToIndex(e);return r>-1}},{key:"removeImages",value:function(e){var r,t,n;for(n=e.length,r=0;r<n;r++)t=this.convertClientIndexToServerId(e[r]),this._removeMapModelImageControlByServerId(t);return this._buffer.removeSelectedImages(e)}},{key:"clear",value:function(){var e,r,t,n=this;for(t=n.count(),e=0;e<t;e++)r=n.convertClientIndexToServerId(e),this._removeMapModelImageControlByServerId(r);return t==Object.keys(n._imageIdMap).length&&(n._imageIdMap={}),n._buffer.removeAllImages()}},{key:"convertServerIdToClientIndex",value:function(e){var t,n,i,o=this;if((i=o._imageIdMap[e])&&(n=i.uuid),n)t=o._buffer.getIndexByUid(n);else if(o._buffer.isActiveFile){var a=this.getCurrentFileName();t=this._convertServerIdToIndexInFile(a,e)}else t=this._convertServerIdToIndex(e);return r.isNumber(t)||(t=-1),t}},{key:"getIndexByUid",value:function(e){var r;return!1===(r=this._buffer.getIndexByUid(e))?-1:r}},{key:"getUidByIndex",value:function(e){return this._buffer.getUidByIndex(e)}},{key:"convertClientIndexToServerId",value:function(e){var r=this.getCustomDataByIndex(e);return r?r.imageId:-1}},{key:"getCurrentImageIndex",value:function(){return this._buffer.getCurrentIndex()}},{key:"setCurrentImageIndex",value:function(e){return this._buffer.selectImages([e])}},{key:"getCurrentFileName",value:function(){return this._buffer.getCurrentFileName()}},{key:"setDefaultTag",value:function(e){return this._buffer.setDefaultTag(e)}},{key:"getDefaultTag",value:function(){return this._buffer.getDefaultTag()}},{key:"count",value:function(){return this._buffer.getHowManyImagesInBuffer()}},{key:"getCountByDocumentName",value:function(e){return this._buffer.getDocumentInfo(e).length}},{key:"dispose",value:function(){this.clear()}},{key:"getImageData",value:function(e){var r=this._buffer.getUidByIndex(e);return r?this._buffer.getDataByUid(r):Promise.resolve(null)}},{key:"getCustomDataByIndex",value:function(e){return this._buffer.getCustomDataByUid(this._buffer.getUidByIndex(e))}},{key:"getMetadataByIndex",value:function(e){return this._buffer.getMetadataByUid(this._buffer.getUidByIndex(e))}},{key:"setCustomData",value:function(e,r){var t=this._buffer.getUidByIndex(e);return!(!t||!r)&&this._buffer.setCustomDataByUid(t,r)}},{key:"openDocument",value:function(e){return this._buffer.openDocument(e)}},{key:"createDocument",value:function(e){return this._buffer.createDocument(e)}},{key:"getImageIdMap",value:function(e){return this._imageIdMap[e]}},{key:"_removeMapModelImageControlByServerId",value:function(e){var r=this;-1!=e&&r._imageIdMap[e]&&(r._imageIdMap[e].Clear(),delete r._imageIdMap[e])}},{key:"_convertServerIdToIndexInFile",value:function(e,r){var t,n,i=-1;for(t=this._buffer.getDocumentContents(e),n=0;n<t.length;n++){var o=t[n];if(o){var a=this._buffer.getCustomDataByUid(o);if(a&&a.imageId==r){i=n;break}}}return i}},{key:"_convertServerIdToIndex",value:function(e){var r,t=-1;for(r=0;r<this.count();r++){var n=this._buffer.getUidByIndex(r);if(n){var i=this._buffer.getCustomDataByUid(n);if(i&&i.imageId==e){t=r;break}}}return t}},{key:"convertServerIdToUUID",value:function(e){var r=this._imageIdMap[e];return r?r.uuid:-1}},{key:"convertUUIDToServerId",value:function(e){var r=this._buffer.getCustomDataByUid(e);return r&&r.imageId?r.imageId:-1}},{key:"UpdateImage",value:function(e,r){return this._buffer.updateImage(e,r),!0}}],[{key:"_setBaseUrl",value:function(e,r){e._baseUrl=r}},{key:"_getBuffer",value:function(e){return e._buffer}}]),e}();function eR(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=Te(e);if(r){var i=Te(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return Se(this,t)}}var rR,tR,nR=function(t){Ie(s,t);var n,i,o,a=eR(s);function s(e){var t;X(this,s),(t=a.call(this,e)).__IfAppendImage=Ve,t.__maxImagesInBuffer=32767,t.__insertingIndex=-1,t._aryBitmapCache=[],t._blts=r.License.isLTS(),t._imageBufferWrapper=new $A;var n=s.getServerImageUrlPrefix(ve(t));return $A._setBaseUrl(t._imageBufferWrapper,n),t}return Q(s,[{key:"registerEvent",value:function(e,r){return!!this._registerEvent(e,r)}},{key:"_registerEvent",value:function(e,r){var t=this;return t._resetErr(),!!t._isValid()&&(t[["__",e].join("")]=r,!0)}},{key:"_unregisterEvent",value:function(e,r){var t=this;return t._resetErr(),!!t._isValid()&&(t[["__",e].join("")]=null,Ve)}},{key:"_registerMultiEvent",value:function(e,t){var n=this;if(n._resetErr(),!n._isValid())return!1;var i=["_$",e].join("");n[i]||(n[i]={});var o=n[i],a=r.guid();return o[a]=t,a}},{key:"_unregisterMultiEvent",value:function(e,t){var n=this;if(n._resetErr(),!n._isValid())return!1;var i=["_$",e].join(""),o=n[i];if(t){var a;if(r.isString(t))return delete o[t],Ve;if(r.isFunction(t))for(a=0;a<o.length;a++)if(t==o[a])return o.splice(a,1),Ve}return n[i]=null,Ve}},{key:"unregisterEvent",value:function(e,r){return this._unregisterEvent(e,r)}},{key:"_getMetadata",value:function(e){return this._imageBufferWrapper.getMetadataByIndex(e)}},{key:"_innerSendBlobByWS",value:function(e,t,n,i,o){var a={cmd:e,cmdId:Ln(),sFun:function(e){r.isFunction(i)&&i(e)},fFun:o,contextData:{document:n.currentFileName,tag:n.currentTagName},rawData:!0};return this._innerSendByWS(e,t,a,n,!0)}},{key:"_updateImage",value:function(e,t,n){var i=this,o={imageId:e,bufferLen:t.byteLength,imageType:15,width:parseInt(n.width),height:parseInt(n.height),bit:n.bitDepth,xres:parseInt(n.resolutionX),yres:parseInt(n.resolutionY)},a=r.stringify([r.stringify(o)]);return new r.Promise((function(e,n){i._innerSendBlobByWS("UpdateImage",a,t,(function(t){r.log("UpdateImage success."),e(t)}),(function(e){r.log("UpdateImage failed."),r.error(e),n(e)}))}))}},{key:"_removeImages",value:function(e){return this._imageBufferWrapper.removeImages(e)}},{key:"_getCurrentDocumentName",value:function(){var e="";return this._imageBufferWrapper&&(e=this._imageBufferWrapper.getCurrentFileName()),e}},{key:"_getCurrentDefaultTagName",value:function(){var e="";return this._imageBufferWrapper&&(e=this._imageBufferWrapper.getDefaultTag()),e}},{key:"_innerRefreshUI",value:function(r,t,n,i,o){var a=this;return n&&a._imageBufferWrapper.refresh(r,a._imageBufferWrapper.count(),!0,i),e.Lib.isFunction(a.__OnRefreshUI)&&a.__OnRefreshUI(a._imageBufferWrapper.getCurrentImageIndex(),a._imageBufferWrapper.count()),!0}},{key:"_getHowManyImagesInBuffer",value:function(){return this._isValid()?this._imageBufferWrapper.count():0}},{key:"_isBindViewer",value:function(){return!1}},{key:"_isNoViewer",value:function(){return!0}},{key:"_OnBitmapChanged",value:function(t,n,i){var o,a,s=this,u=e.navInfoSync,c="10"==t[0],l="0"==t[0],d="c2"==t[0],f=l||d||c,h=t[1].split(","),g=t[2],p=t[3],m=s.__maxImagesInBuffer,_=-1,v=[];if(i&&(o=i.document,a=i.tag),r.log("_OnBitmapChanged.currentFileName="+o+", tag="+a),o||(o=s._getCurrentDocumentName()),a&&s._imageBufferWrapper&&(s._imageBufferWrapper.setDefaultTag(a),r.log("metaDataObj.currentTag="+a)),c);else if(d)t.length>5&&(v=t[5]),r.isArray(v)||(v=[]);else{var y={};if(t.length>5&&(y.width=t[5]),t.length>6&&(y.height=t[6]),t.length>7&&(y.bitDepth=t[7]),t.length>8&&(y.resolutionX=t[8]),t.length>9&&(y.resolutionY=t[9]),t.length>10&&(_=t[10]),v.push(y),_>-1&&s._blts&&(1==g||2==g)){var I=e.DWT.lgct(_);r.isFunction(s.__OnLtsverify)&&s.__OnLtsverify(I,1)}}if(r.log("OnBitmapChanged:"+t),2==g||1==g&&!s.__IfAppendImage)r.each(h,(function(e,r){var t,n=parseInt(e),i=s._imageBufferWrapper.getCurrentImageIndex();if((t=r<v.length&&v[r]?v[r]:{}).currentFileName=o,isNaN(n)||n<0)return!0;if(f)s._aryBitmapCache.push(n);else for(var a=0;a<s._aryBitmapCache.length;a++)if(s._aryBitmapCache[a]==n)return s._aryBitmapCache.splice(a,1),!0;if(s._imageBufferWrapper.exists(n))return!0;s.__insertingIndex>-1&&(i=s.__insertingIndex),-1==i&&(i=0),s._imageBufferWrapper.insertBefore(i,m,n,t),s.__insertingIndex>-1&&(s.__insertingIndex=s.__insertingIndex+1)})),r.isFunction(s.__OnRefreshUI)&&s.__OnRefreshUI(s._imageBufferWrapper.getCurrentImageIndex(),s._imageBufferWrapper.count());else if(1==g&&s.__IfAppendImage)r.each(h,(function(e,t){var n,i=parseInt(e);if(isNaN(i)||i<0)return!0;if((n=t<v.length&&v[t]?v[t]:{}).currentFileName=o,r.log("metaDataObj.currentFileName="+o),f)s._aryBitmapCache.push(i);else for(var a=0;a<s._aryBitmapCache.length;a++)if(s._aryBitmapCache[a]==i)return s._aryBitmapCache.splice(a,1),!0;if(s._imageBufferWrapper.exists(i))return!0;s._imageBufferWrapper.append(m,i,n)})),r.isFunction(s.__OnRefreshUI)&&s.__OnRefreshUI(s._imageBufferWrapper.getCurrentImageIndex(),s._imageBufferWrapper.count());else if(3==g&&f){var S=!1;if(1==h.length&&-1==h[0]&&(S=!0),S)s._imageBufferWrapper.clear();else{var T=[];r.each(h,(function(e,r){var t=parseInt(e);if(isNaN(t)||t<0)return!0;T.push(t)})),s._imageBufferWrapper.removeImagesByServerId(T,o)}r.isFunction(s.__OnRefreshUI)&&s.__OnRefreshUI(s._imageBufferWrapper.getCurrentImageIndex(),s._imageBufferWrapper.count())}else if(4==g)r.each(h,(function(e,r){var t,n=parseInt(e);if(isNaN(n)||n<0)return!0;if((t=r<v.length&&v[r]?v[r]:{}).currentFileName=o,n>=0&&!s.__bLoadingImage){var i=s._imageBufferWrapper.convertServerIdToClientIndex(n);i>-1&&s._innerRefreshUI(i,s._imageBufferWrapper.count(),!0,t,g)}}));else if(5==g){var b;if(p>=0&&!s.__bLoadingImage)(b=0<v.length&&v[0]?v[0]:{}).currentFileName=o,0==s.__IfAppendImage&&s._innerRefreshUI(p,s._imageBufferWrapper.count(),!0,b,g),s._imageBufferWrapper.refresh(p,s._imageBufferWrapper.count(),!1,b)}if(r.isFunction(s.__OnBitmapChanged)){if(!c){if(u.bFirefox&&!f)return!0;if(!u.bFirefox&&f)return!0}var E=[];r.each(h,(function(e){var r,t=parseInt(e);if(isNaN(t)||t<0)return!0;(r=s._imageBufferWrapper.convertServerIdToClientIndex(t))>-1&&E.push(r)}));var C=s._imageBufferWrapper.getCurrentImageIndex(),w=g;1==g&&(w=s.__IfAppendImage?1:2),s.__OnBitmapChanged(E,w,C,s._imageBufferWrapper.count())}}},{key:"_OnRemoteScanStatusAsync",value:function(e){var t,n,i,o,a,s,u,c=this;if(e&&e.length>=2){try{var l=new String(e[1]);t=r.parse(l)}catch(f){r.error(f.message),r.log("parse json failed: "+e[1])}t||(t={sequence:0,screen:[]})}if(t&&t.sequence)if(t.sequence>0&&t.screen&&t.screen.length>0){if(n=t.screen,o=t.sequence,s=t.wnds,u=(i=n[0]).img,r.isString(u)&&""!=u&&(a=i.wnd),o&&a){var d=r.one(".ds-img-screen");d&&c._acquireDivEL&&(c._acquireDivEL.evtFun&&(r.removeEventListener(d[0],"mouseup",c._acquireDivEL.evtFun),c._acquireDivEL.evtFun=null),d[0].src=u,c._acquireDivEL.evtFun=function(e){s||(s="0");var t=r.stringify({sequence:o,wnds:s,wnd:a+"",type:2,x:e.offsetX,y:e.offsetY});c._sendDataByHttpAsync("SendEventToScannerUI",["[",t,"]"].join(""))},r.addEventListener(d[0],"mouseup",c._acquireDivEL.evtFun))}}else c.__closeRemoteScanUI(!1);return r.isFunction(c.__OnRemoteScanStatusAsync)&&c.__OnRemoteScanStatusAsync(t),!0}},{key:"__closeRemoteScanUI",value:function(e){var t=this;if(t._acquireDivEL){var n=r.one(".ds-img-screen");t._acquireDivEL.evtFun?(n&&n.length>0&&r.removeEventListener(n[0],"mouseup",t._acquireDivEL.evtFun),t._acquireDivEL.evtFun=null):n&&n.length>0&&r.removeEventListener(n[0],"mouseup"),n&&n.length>0&&(n[0].src=""),e&&(document.body.removeChild(t._acquireDivEL),t._acquireDivEL=null)}}},{key:"_innerActiveUI",value:(o=ne(de.mark((function u(t){var n,i,o,a,s,c;return de.wrap((function(u){for(;;)switch(u.prev=u.next){case 0:return n=this,i=r.detect.ssl,o=je,a=h(),n._bRemoteMode||(a=5),s=null!=t?t:"",u.next=5,new r.Promise((function(r,t){n._sendData("ActiveUI",kn(e.Lib.env.WSVersion,e.Lib.env.WSSession,1,s,i,o,a),!1,r,t)}));case 5:return c=u.sent,n=null,u.abrupt("return",c);case 8:case"end":return u.stop()}}),u,this)}))),function(e){return o.apply(this,arguments)})},{key:"_removeImageAsync",value:(i=ne(de.mark((function c(e,r){var t,n,i;return de.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this,n=parseInt(r),ai(t,n)){e.next=4;break}return e.abrupt("return",!1);case 4:return i=t._imageBufferWrapper.convertClientIndexToServerId(n),e.next=7,t._removeImageByIdAsync(i);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),c,this)}))),function(e,r){return i.apply(this,arguments)})},{key:"_removeImageByIdAsync",value:(n=ne(de.mark((function l(e){var t,n;return de.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(t=this,-1!=e){i.next=4;break}return r.Errors.IndexOutOfRange(t),i.abrupt("return",!1);case 4:return i.next=6,t._innerFunV2("RemoveImage",kn(e));case 6:return((n=i.sent)||-1033==t._errorCode)&&t._OnBitmapChanged(["0",""+e,3,t._imageBufferWrapper.getCurrentImageIndex(),t._imageBufferWrapper.count()]),i.abrupt("return",n);case 9:case"end":return i.stop()}}),l,this)}))),function(e){return n.apply(this,arguments)})}],[{key:"getServerImageUrlPrefix",value:function(e){return[e._httpUrl,"dwt/",r.product.getDWTPrefix(),r.product.getServerVersionInfo(),"/img?id=",e._clientId].join("")}}]),s}(Vn);function iR(r,t){var n,i=r.substring(r.lastIndexOf(".")).toLowerCase();if(t==e.DWT.EnumDWT_ImageType.IT_BMP){if(".bmp"==i||".dib"==i)return r;n=[r,".bmp"].join("")}else if(t==e.DWT.EnumDWT_ImageType.IT_JPG){if(".jpg"==i||".jpe"==i||".jpeg"==i||".jfif"==i)return r;n=[r,".jpg"].join("")}else if(t==e.DWT.EnumDWT_ImageType.IT_PNG){if(".png"==i)return r;n=[r,".png"].join("")}else if(t==e.DWT.EnumDWT_ImageType.IT_TIF){if(".tif"==i||".tiff"==i)return r;n=[r,".tif"].join("")}else if(t==e.DWT.EnumDWT_ImageType.IT_PDF){if(".pdf"==i)return r;n=[r,".pdf"].join("")}else if(t==e.DWT.EnumDWT_ImageType.IT_J2K){if(".jp2"==i)return r;n=[r,".jp2"].join("")}return n}function oR(t,n,i,o){var a,s,u,c,l=n.url,d=n.headers,f=n.retry,h=n.httpFormData,g=n.bOnlyResponseEmptyIsOK,p=n.bAsync,m=(s=n.responseType)==rR.text?"text":s==rR.json?"json":s==rR.blob?"blob":s==rR.arraybuffer?"arraybuffer":s==rR.xml?"xml":s==rR.userDefined?"user-defined":"text",_=t.IfShowProgressBar,v=t.IfShowCancelDialogWhenImageTransfer,y=t.objUploadStatus;(a=n.content)&&(a.remoteFilename||(a.remoteFilename=n.remoteFilename),a.fileName||(a.fileName=n.fileName||a.name),a.name||(a.name=n.fileName||a.fileName));var I,S=new sn({action:l,data:h,async:p,retry:f,bOnlyResponseEmptyIsOK:g,dataType:m});if(v&&r.progressContext&&(I=r.progressContext.on("cancel",(function(){S.abort(),S=null}))),(u=S._uploadType)&&(c=u.get("ajaxConfig"),d&&c&&c.headers&&d&&r.mix(c.headers,d),t.HTTPRequestswithCredentials&&r.mix(c.xhrFields,{withCredentials:!0}),c=null),S.on(sn.event.SUCCESS,(function(e){if(n.content=null,S=null,I&&r.progressContext.off("cancel",I),e?t.HTTPPostResponse=e.response:n.responseType==rR.arraybuffer?t.HTTPPostResponse=[]:n.responseType==rR.blob?t.HTTPPostResponse=new Blob([]):n.responseType==rR.json?t.HTTPPostResponse={}:t.HTTPPostResponse="",r.isFunction(t.onHttpUploadStatus)){var o;o={fileName:e.name,percentage:100,statusCode:200,responseString:t.HTTPPostResponse},t.onHttpUploadStatus(o)}r.isFunction(i)&&i(t.HTTPPostResponse)})),S.on(sn.event.ERROR,(function(e){n.content=null,S=null;var i=e&&e.canceled;e&&e.timeout;var a=Be,s=0;I&&r.progressContext.off("cancel",I),e&&r.isString(e.response)?t.HTTPPostResponse=e.response:t.HTTPPostResponse="",i||(e&&e.msg&&(a=e.msg),e&&e.httpStatus&&(s=e.httpStatus));var u,c={};(r.Errors.UploadError(c,i,a,s),r.isFunction(t.onHttpUploadStatus))&&(u={fileName:e.name,percentage:100,statusCode:s,responseString:t.HTTPPostResponse},t.onHttpUploadStatus(u));r.isFunction(o)&&o(c._errorCode,c._errorString,t.HTTPPostResponse)})),(_||r.isFunction(t.onHttpUploadStatus))&&(S.on(sn.event.PROGRESS,(function(n){!e.navInfoSync.bSafari&&n&&(delete n.totalSize,delete n.position);var i=0===n.total?100:Math.round(100*n.loaded/n.total);if([n.loaded," / ",n.total].join(""),r.isFunction(t.onHttpUploadStatus)){var o;i>99&&(i=99),o={fileName:n.name,percentage:i,statusCode:0,responseString:""},t.onHttpUploadStatus(o)}_&&t.onPercent([0,i,"","http",n.name])})),_&&t.onPercent([0,-1,e.MSG.Uploading,"http"]),r.isFunction(t.onHttpUploadStatus))){var T="";r.isArray(a)&&a.length>0||(a&&a.name&&""!=a.name?T=a.name:a&&a.fileName&&(T=a.fileName)),!T&&n.fileName&&(T=n.fileName),t.onHttpUploadStatus({fileName:T,percentage:0,statusCode:0,responseString:""})}if(y&&y.bCancel){y.st=2;var b={};return r.Errors.UserCanceled(b),n.content=null,r.isFunction(o)&&o(b._errorCode,b._errorString),!1}var E=S.upload(a);return a=null,E}function aR(e,t,n,i){var o,a,s=e.MaxUploadImageSize,u=0,c=t.content;if(!c||!r.isArray(c)||c.length<=0){t.content=null;var l={};return r.Errors.UploadFileCannotEmpty(l),r.isFunction(i)&&i(l._errorCode,l._errorString),Be}for(o=0;o<c.length;o++){var d=c[o];if(!d||d.size<=0){var f={};return r.Errors.UploadFileCannotEmpty(f),r.isFunction(i)&&i(f._errorCode,f._errorString),Be}var h=d.size,g=d.type;if(u+=h,""===g||g&&g!=t.contentType){var p=d.slice||d.webkitSlice||d.mozSlice,m=d.name,_=p.call(d,0,h,t.contentType);r.isString(m)&&""!=m||(m=d.fileName),_.name=Jn.cformat(m,o+1),c[o]=_}c[o].remoteFilename=Jn.cformat(t.remoteFilename,o+1),d=null}if(u>s&&-1!=s){var v={};return r.Errors.UploadExceededMaxSize(v),r.isFunction(i)&&i(v._errorCode,v._errorString),Be}for(a=oR(e,t,n,i),t=null,o=0;o<c.length;o++)c[o]=null;return c=null,a}function sR(e){r.dlgRef<=0||0==r.dialogShowStatus||Sr(e)}!function(e){e.text=0,e.blob=1,e.arraybuffer=2,e.xml=3,e.json=4,e.userDefined=5}(rR||(rR={})),e.DWT.EnumDWT_ResponseType=rR,function(e){e.Init=-1,e.OK=0,e.Failed=1,e.Cancelled=2}(tR||(tR={})),r.setBtnCancelVisibleForProgress=Sr;var uR=function(){function e(){X(this,e)}return Q(e,[{key:"_onProgress",value:function(e,r,t){var n=0===t.total?100:Math.round(100*t.loaded/t.total);[t.loaded," / ",t.total].join(""),e.onPercent([0,n,"","http",r])}},{key:"_uploadBlobFragment",value:function(e,t,n,i){var o=t.fileName,a=t.blockSize,s=0;t.method;var u,c,l,d=t.offset,f=this,h=function(e,n){t.content=null,r.isFunction(i)&&i(e,n)};if((u=t.content).size<=0){var g={};return r.Errors.UploadFileCannotEmpty(g),h(g._errorCode,g._errorString),Be}if(s=u.size,(c=s-d)>0){var p;if(c>=a&&a>0?(c-=a,l=a):(l=c,c=0),!(p=0==d&&l==s?u:u.slice(d,d+l))){var m={};r.Errors.UploadFileCannotEmpty(m),h(m._errorCode,m._errorString)}if(!e.IfShowProgressBar||e.IfShowProgressBar&&r.dlgRef>0){p.name=o,sR(e.IfShowCancelDialogWhenImageTransfer),t.headers["Content-Range"]=["bytes ",d,"-",d+p.size-1,"/",s].join(""),f._onProgress(e,o,{total:s,loaded:d});var _=r.clone(t);return _.content=p,_.offset=0,f.httpPostUpload(e,_,(function(i){0==c&&(r.needShowTwiceShowDialog=!1),f._onProgress(e,o,{total:s,loaded:d+l}),0==c?(t.content=null,r.isFunction(n)&&is(n,i)):(t.offset=t.offset+l,setTimeout((function(){f._uploadBlobFragment(e,t,n,h)}),100))}),h),!0}var v={};return r.Errors.UserCanceled(v),h(v._errorCode,v._errorString),!1}return r.needShowTwiceShowDialog=!1,t.content=null,r.isFunction(n)&&n(""),!0}},{key:"httpPostUploadFragment",value:function(e,t,n,i){var o;if(!(o=t.content)){var a={};return r.Errors.UploadFileCannotEmpty(a),r.isFunction(i)&&i(a._errorCode,a._errorString),Be}if(r.isString(o)){if(""==o){var s={};return r.Errors.UploadFileCannotEmpty(s),r.isFunction(i)&&i(s._errorCode,s._errorString),Be}var u=new Blob([o],{type:"text/plain"}),c=t.fileName;u.name=c,t.content=u,u=null}return r.cancelFrom=q.HTTPUpload,this._uploadBlobFragment(e,t,n,i)}},{key:"httpPostUpload",value:function(e,t,n,i){var o,a,s=function(n,o){var a;(t.content=null,t=null,r.isFunction(i))&&i(n,o,null!==(a=null==e?void 0:e.HTTPPostResponse)&&void 0!==a?a:"")};if(!(o=t.content)){var u={};return r.Errors.UploadFileCannotEmpty(u),s(u._errorCode,u._errorString),Be}if(r.isString(o)){var c,l=t.fileName;if(""==o){var d={};return r.Errors.UploadFileCannotEmpty(d),s(d._errorCode,d._errorString),Be}if(c=e.MaxUploadImageSize,o.length>c&&-1!=c){var f={};return r.Errors.UploadExceededMaxSize(f),s(f._errorCode,f._errorString),Be}(a=new Blob([o],{type:"text/plain"})).name=l,o=null}else if(o instanceof Blob&&(a=o,o=null,a.size<=0)){var h={};return r.Errors.UploadFileCannotEmpty(h),s(h._errorCode,h._errorString),Be}if(a){var g,p,m=e.MaxUploadImageSize,_=a.size,v=a.type;if(_>m&&-1!=m){var y={};return r.Errors.UploadExceededMaxSize(y),s(y._errorCode,y._errorString),Be}if(""===v||v&&v!=t.contentType)(g=(a.slice||a.webkitSlice||a.mozSlice).call(a,0,_,t.contentType))instanceof File?(p=g.fileName,g.name=p):g.name=a.name||a.fileName;else g=a;a=null,g&&(t.content=g),g=null}return sR(e.IfShowCancelDialogWhenImageTransfer),r.cancelFrom=q.HTTPUpload,oR(e,t,(function(e){t.content=null,t=null,r.isFunction(n)&&n(e),e=null}),s)}}]),e}(),cR=Q((function GL(){X(this,GL),this.method="",this.httpMethod="POST",this.contentType="application/octet-stream",this.remoteFilename="RemoteFile",this.blockSize=0,this.offset=0,this.retry=0,this.bOnlyResponseEmptyIsOK=!0,this.responseType=rR.text})),lR=Q((function jL(){X(this,jL),this.IfShowProgressBar=!1,this.IfShowCancelDialogWhenImageTransfer=!0}));function dR(e,t){var n,i=this,o=0;n=r.isString(e)?document.getElementById(e):e,i.isLoaded=!1,i.displayType=0,i.progress=0,i.progressPosition=0,i.borderWidth={left:0,right:0,top:0,bottom:0},i.orientation=t.orientation||dR.Orientation.Horizontal,i.direction=t.direction||dR.Direction.LeftToRight,i.creationType=t.creationType||dR.CreationType.Replace,i.value=0,i.initialValue=t.value||0,i.minValue=t.minValue||0,i.maxValue=t.maxValue||100,i.showLabel="undefined"==typeof t.showLabel||t.showLabel,i.labelText=t.labelText||"",i.width=t.width||280,i.height=t.height||20,i.borderRadius=t.borderRadius||10,i.orientation==dR.Orientation.Horizontal&&i.borderRadius>i.height/2&&(i.borderRadius=Math.round(i.height/2)),i.orientation==dR.Orientation.Vertical&&i.borderRadius>i.width/2&&(i.borderRadius=Math.round(i.width/2)),i.backColor=t.backColor||"",i.color=t.color||"#50a8e1",i.animationStyle=0,i.animationInterval=t.animationInterval||100;var a=["parent","background","wrapper","left","middle","right","horizontalText","verticalText","marker"];for(i.extraClassName={},o=0;o<a.length;o++)t.extraClassName?"string"==typeof t.extraClassName?i.extraClassName[a[o]]=t.extraClassName:i.extraClassName[a[o]]=t.extraClassName[a[o]]||"":i.extraClassName[a[o]]="";i.onLoad=t.onLoad||null,i.onValueChanged=t.onValueChanged||null,i.onAnimate=t.onAnimate||null,i.creationType==dR.CreationType.Replace?i.parentElement=n:(i.parentElement=document.createElement("DIV"),n.appendChild(i.parentElement)),i.finishLoading()}dR.Orientation={Horizontal:0,Vertical:1},dR.Direction={LeftToRight:0,RightToLeft:1,TopToBottom:0,BottomToTop:1},dR.CreationType={Replace:0,AppendChild:1},dR.AnimationStyle={None:0,Static:1,StaticFull:2,Custom:3,CustomFull:4,Flickering1:10,Flickering2:11,Flickering3:12,LeftToRight1:20,LeftToRight2:21,RightToLeft1:22,RightToLeft2:23,TwoWay:24},dR.prototype.finishLoading=function(){var e,r=this;r.wrapperElement=null,r.backgroundElement=null,r.valueElement=null,r.leftElement=null,r.middleElement=null,r.rightElement=null,r.backgroundElement=document.createElement("DIV"),r.backgroundElement.className="progressbar_background"+(r.extraClassName.background?" ":"")+r.extraClassName.background,r.backgroundElement.style.cssText=r.backgroundElement.style.cssText+dR._createBorderRadiusCss(r.borderRadius),r.parentElement.appendChild(r.backgroundElement);var t=["border-radius","border-bottom-right-radius","-moz-border-radius-bottomright","-webkit-border-bottom-right-radius","-khtml-border-radius-bottomright","-khtml-border-bottom-right-radius"],n=0,i="";for(n=0;n<t.length&&(!(i=dR._elementCurrentStyle(r.backgroundElement,t[n]))&&"string"!=typeof i);n++);""!=i&&dR._parseInt(i)!=r.borderRadius&&(r.borderRadius=dR._parseInt(i)),r.orientation==dR.Orientation.Horizontal||r.orientation==dR.Orientation.Vertical?r.displayType=0:r.displayType=1,r.parentElement.className=(""!=r.parentElement.className?" ":"")+"progressbar_parent dynamsoft-progressBar"+(r.extraClassName.parent?" ":"")+r.extraClassName.parent,0==r.displayType?((e=r.wrapperElement=document.createElement("DIV")).style.border="1px solid #A0A0A0",e.style.cssFloat="left",e.style.display="inline-block",e.style.width=r.width+"px",e.style.height=r.height+"px",e.style.left="0px",e.style.top=-r.height+"px",e.style.backgroundColor=r.backColor,e.style.backgroundRepeat="no-repeat",e.style.position="relative",e.style.cssText=e.style.cssText+dR._createBorderRadiusCss(r.borderRadius),r.parentElement.appendChild(e),r.borderWidth={left:dR._parseInt(dR._elementCurrentStyle(e,"border-left-width")),right:dR._parseInt(dR._elementCurrentStyle(e,"border-right-width")),top:dR._parseInt(dR._elementCurrentStyle(e,"border-top-width")),bottom:dR._parseInt(dR._elementCurrentStyle(e,"border-bottom-width"))}):1==r.displayType&&(r.orientation==dR.Orientation.Horizontal?r.borderRadius>r.width/2&&(r.borderRadius=r.width):r.orientation==dR.Orientation.Vertical&&r.borderRadius>r.height/2&&(r.borderRadius=r.height),r.valueElement=document.createElement("DIV"),r.valueElement.className="",r.leftElement=document.createElement("DIV"),r.middleElement=document.createElement("DIV"),r.rightElement=document.createElement("DIV"),r.leftElement.style.border="1px solid #A0A0A0",r.leftElement.style.cssFloat="left",r.leftElement.style.display="inline-block",r.leftElement.style.backgroundColor=r.backColor,r.leftElement.style.backgroundRepeat="no-repeat",r.leftElement.style.position="relative",r.rightElement.style.border="1px solid #A0A0A0",r.rightElement.style.cssFloat="left",r.rightElement.style.display="inline-block",r.rightElement.style.backgroundColor=r.backColor,r.rightElement.style.backgroundRepeat="no-repeat",r.rightElement.style.position="relative",r.middleElement.style.border="1px solid #A0A0A0",r.middleElement.style.cssFloat="left",r.middleElement.style.display="inline-block",r.middleElement.style.overflow="hidden",r.middleElement.style.position="relative",r.valueElement.style.backgroundColor=r.backColor,r.valueElement.style.position="relative",r.orientation==dR.Orientation.Horizontal?(r.leftElement.style.width=r.borderRadius+"px",r.leftElement.style.height=r.height+"px",r.leftElement.style.top=-r.height+"px",r.leftElement.style.left="0px",r.leftElement.style.borderRight="none",r.leftElement.style.cssText=r.leftElement.style.cssText+dR._createBorderRadiusCss(r.borderRadius,0,0,r.borderRadius),r.rightElement.style.width=r.borderRadius+"px",r.rightElement.style.height=r.height+"px",r.rightElement.style.top=-r.height+"px",r.rightElement.style.borderLeft="none",r.rightElement.style.cssText=r.rightElement.style.cssText+dR._createBorderRadiusCss(0,r.borderRadius,r.borderRadius,0),r.middleElement.style.width=r.width-2*r.borderRadius+"px",r.middleElement.style.height=r.height+"px",r.middleElement.style.top=-r.height+"px",r.middleElement.style.borderLeft="none",r.middleElement.style.borderRight="none",r.valueElement.style.width="0px",r.valueElement.style.height=r.height+"px"):r.orientation==dR.Orientation.Vertical&&(r.leftElement.style.width=r.width+"px",r.leftElement.style.height=r.borderRadius+"px",r.leftElement.style.top=-r.height+"px",r.leftElement.style.left="0px",r.leftElement.style.borderBottom="none",r.leftElement.style.cssText=r.leftElement.style.cssText+dR._createBorderRadiusCss(r.borderRadius,r.borderRadius,0,0),r.rightElement.style.width=r.width+"px",r.rightElement.style.height=r.borderRadius+"px",r.rightElement.style.top=-r.height+"px",r.rightElement.style.left="0px",r.rightElement.style.borderTop="none",r.rightElement.style.cssText=r.rightElement.style.cssText+dR._createBorderRadiusCss(0,0,r.borderRadius,r.borderRadius),r.middleElement.style.width=r.width+"px",r.middleElement.style.height=r.height-2*r.borderRadius+"px",r.middleElement.style.top=-r.height+"px",r.middleElement.style.left="0px",r.middleElement.style.borderTop="none",r.middleElement.style.borderBottom="none",r.valueElement.style.width=r.width+"px",r.valueElement.style.height="0px"),r.middleElement.appendChild(r.valueElement),r.parentElement.appendChild(r.leftElement),r.parentElement.appendChild(r.middleElement),r.parentElement.appendChild(r.rightElement),r.orientation==dR.Orientation.Horizontal?r.borderWidth={left:dR._parseInt(dR._elementCurrentStyle(r.leftElement,"border-left-width")),right:dR._parseInt(dR._elementCurrentStyle(r.rightElement,"border-right-width")),top:dR._parseInt(dR._elementCurrentStyle(r.middleElement,"border-top-width")),bottom:dR._parseInt(dR._elementCurrentStyle(r.middleElement,"border-bottom-width"))}:r.orientation==dR.Orientation.Vertical&&(r.borderWidth={left:dR._parseInt(dR._elementCurrentStyle(r.middleElement,"border-left-width")),right:dR._parseInt(dR._elementCurrentStyle(r.middleElement,"border-right-width")),top:dR._parseInt(dR._elementCurrentStyle(r.leftElement,"border-top-width")),bottom:dR._parseInt(dR._elementCurrentStyle(r.rightElement,"border-bottom-width"))})),r.parentElement.style.width=r.width+r.borderWidth.left+r.borderWidth.right+"px",r.parentElement.style.height=r.height+r.borderWidth.top+r.borderWidth.bottom+"px",r.backgroundElement.style.cssFloat="left",r.backgroundElement.style.display="inline-block",r.backgroundElement.style.width=r.width+r.borderWidth.left+r.borderWidth.right+"px",r.backgroundElement.style.height=r.height+"px",r.backgroundElement.style.backgroundColor="#FFFFFF",r.backgroundElement.style.position="relative",0==r.displayType&&(r.backgroundElement.style.width=r.width+r.borderWidth.left+r.borderWidth.right+"px"),r.backgroundElement.style.top=r.borderWidth.top+"px",r.markerElement=document.createElement("DIV"),r.markerElement.style.display="inline-block",r.markerElement.style.zoom="1.0",r.markerElement.style.width=r.width+"px",r.markerElement.style.height=r.height+"px",r.markerElement.style.top=2*-r.height-r.borderWidth.top+"px",r.markerElement.style.left=r.borderWidth.left+"px",r.markerElement.style.backgroundColor=r.color,r.markerElement.style.lineHeight=r.height+"px",r.markerElement.style.position="relative",r.parentElement.appendChild(r.markerElement),r.isLoaded=!0,r.setValue(r.initialValue),null!=r.onLoad&&r.onLoad()},dR.prototype.setValue=function(e){var r=this;if(null!==e&&e<r.minValue&&(e=r.minValue),null!==e&&e>r.maxValue&&(e=r.maxValue),null===e||(r.value=e),r.isLoaded){var t,n=0;if(r.orientation==dR.Orientation.Horizontal){n=r.value/r.maxValue*r.width,r.progressPosition=n,0==r.displayType?(r.direction,dR.Direction.LeftToRight):1==r.displayType&&(r.direction==dR.Direction.LeftToRight?n<=r.borderRadius?r.valueElement.style.width="0px":n>=r.width-r.borderRadius?r.valueElement.style.width=r.middleElement.style.width:r.valueElement.style.width=n-r.borderRadius+"px":n<=r.borderRadius?r.valueElement.style.width="0px":n>=r.width-r.borderRadius?(r.valueElement.style.left="0px",r.valueElement.style.width=r.middleElement.style.width):(r.valueElement.style.left=r.width-n-r.borderRadius+"px",r.valueElement.style.width=n-r.borderRadius+"px")),n>0?(r.animationStyle!=dR.AnimationStyle.StaticFull&&r.animationStyle!=dR.AnimationStyle.CustomFull?r.markerElement.style.width=n+"px":r.markerElement.style.width=r.width+"px",r.markerElement.style.visibility="visible"):(r.markerElement.style.width=r.width+"px",r.animationStyle!=dR.AnimationStyle.StaticFull&&r.animationStyle!=dR.AnimationStyle.CustomFull&&(r.markerElement.style.visibility="hidden")),r.animationStyle!=dR.AnimationStyle.StaticFull&&r.animationStyle!=dR.AnimationStyle.CustomFull?r.direction==dR.Direction.LeftToRight?r.markerElement.style.left=r.borderWidth.left+"px":r.markerElement.style.left=r.width-n+r.borderWidth.left+"px":r.markerElement.style.left=r.borderWidth.left+"px",r.height,r.height,r.borderWidth.top;var i=2*-r.height-r.borderWidth.top;if(0==n||r.width==n)r.markerElement.style.top=i+"px",r.markerElement.style.height=r.height+"px",r.markerElement.style.cssText=r.markerElement.style.cssText+dR._createBorderRadiusCss(r.borderRadius);else if(n<r.borderRadius){var o=r.height-2.25*(r.borderRadius-Math.sqrt(Math.pow(r.borderRadius,2)-Math.pow(r.borderRadius-n,2))),a=i+r.height/2-o/2;r.markerElement.style.top=a+"px",r.markerElement.style.height=o+"px",r.direction==dR.Direction.LeftToRight?r.markerElement.style.cssText=r.markerElement.style.cssText+dR._createBorderRadiusCss(r.borderRadius,0,0,r.borderRadius):r.markerElement.style.cssText=r.markerElement.style.cssText+dR._createBorderRadiusCss(0,r.borderRadius,r.borderRadius,0)}else r.width-n<r.borderRadius?(t=(2*(r.borderRadius-(r.width-n))+(r.borderRadius-Math.sqrt(Math.pow(r.borderRadius,2)-Math.pow(r.borderRadius-(r.width-n),2))))/3,r.direction==dR.Direction.LeftToRight?r.markerElement.style.cssText=r.markerElement.style.cssText+dR._createBorderRadiusCss(r.borderRadius,t,t,r.borderRadius):r.markerElement.style.cssText=r.markerElement.style.cssText+dR._createBorderRadiusCss(t,r.borderRadius,r.borderRadius,t)):(r.markerElement.style.top=i+"px",r.markerElement.style.height=r.height+"px",r.direction==dR.Direction.LeftToRight?r.markerElement.style.cssText=r.markerElement.style.cssText+dR._createBorderRadiusCss(r.borderRadius,0,0,r.borderRadius):r.markerElement.style.cssText=r.markerElement.style.cssText+dR._createBorderRadiusCss(0,r.borderRadius,r.borderRadius,0))}else if(r.orientation==dR.Orientation.Vertical){n=r.value/r.maxValue*r.height,r.progressPosition=n,0==r.displayType?(r.direction,dR.Direction.TopToBottom):1==r.displayType&&(r.direction==dR.Direction.TopToBottom?n<=r.borderRadius?r.valueElement.style.height="0px":n>=r.height-r.borderRadius?r.valueElement.style.height=r.middleElement.style.height:r.valueElement.style.height=n-r.borderRadius+"px":n<=r.borderRadius?r.valueElement.style.height="0px":n>=r.height-r.borderRadius?(r.valueElement.style.top="0px",r.valueElement.style.height=r.middleElement.style.height):(r.valueElement.style.top=r.height-n-r.borderRadius+"px",r.valueElement.style.height=n+2*r.borderRadius+"px")),n>0?(r.animationStyle!=dR.AnimationStyle.StaticFull&&r.animationStyle!=dR.AnimationStyle.CustomFull?r.markerElement.style.height=n+"px":(r.markerElement.style.height=r.height+"px",r.markerElement.style.cssText=r.markerElement.style.cssText+dR._createBorderRadiusCss(r.borderRadius)),r.markerElement.style.visibility="visible"):(r.markerElement.style.height="0px",r.animationStyle!=dR.AnimationStyle.StaticFull&&r.animationStyle!=dR.AnimationStyle.CustomFull&&(r.markerElement.style.visibility="hidden")),r.borderWidth.left;var s=r.borderWidth.left;if(0==n||r.height==n)r.markerElement.style.left=s+"px",r.markerElement.style.width=r.width+"px",r.markerElement.style.cssText=r.markerElement.style.cssText+dR._createBorderRadiusCss(r.borderRadius);else if(n<r.borderRadius){var u=2.5*n;u>r.width&&(u=r.width);var c=s+r.width/2-u/2;r.markerElement.style.left=c+"px",r.markerElement.style.width=u+"px",r.direction==dR.Direction.BottomToTop?r.markerElement.style.cssText=r.markerElement.style.cssText+dR._createBorderRadiusCss(0,0,r.borderRadius,r.borderRadius):r.markerElement.style.cssText=r.markerElement.style.cssText+dR._createBorderRadiusCss(r.borderRadius,r.borderRadius,0,0)}else r.height-n<r.borderRadius?(t=(2*(r.borderRadius-(r.height-n))+(r.borderRadius-Math.sqrt(Math.pow(r.borderRadius,2)-Math.pow(r.borderRadius-(r.height-n),2))))/3,r.direction==dR.Direction.BottomToTop?r.markerElement.style.cssText=r.markerElement.style.cssText+dR._createBorderRadiusCss(t,t,r.borderRadius,r.borderRadius):r.markerElement.style.cssText=r.markerElement.style.cssText+dR._createBorderRadiusCss(r.borderRadius,r.borderRadius,t,t)):(r.markerElement.style.left=s+"px",r.markerElement.style.width=r.width+"px",r.direction==dR.Direction.BottomToTop?r.markerElement.style.cssText=r.markerElement.style.cssText+dR._createBorderRadiusCss(0,0,r.borderRadius,r.borderRadius):r.markerElement.style.cssText=r.markerElement.style.cssText+dR._createBorderRadiusCss(r.borderRadius,r.borderRadius,0,0));r.animationStyle!=dR.AnimationStyle.StaticFull&&r.animationStyle!=dR.AnimationStyle.CustomFull?r.direction==dR.Direction.TopToBottom?r.markerElement.style.top=2*-r.height-r.borderWidth.top+"px":r.markerElement.style.top=-r.height-n-r.borderWidth.top+"px":r.markerElement.style.top=2*-r.height-r.borderWidth.top+"px"}r.progress=r.value/r.maxValue}null!=r.onValueChanged&&r.onValueChanged()},dR._elementCurrentStyle=function(e,r){if(e.currentStyle){var t=0,n="",i=!1;for(t=0;t<r.length;t++)"-"!=r[t].toString()?(n+=i?r[t].toString().toUpperCase():r[t].toString(),i=!1):i=!0;return r=n,e.currentStyle[r]}return getComputedStyle(e,null).getPropertyValue(r)},dR._parseInt=function(e){var r=parseInt(e);return isNaN(r)&&(r=0),r},dR._createBorderRadiusCss=function(e,r,t,n){return null!=e&&null==r&&null==t&&null==n?"; -moz-border-radius: "+e+"px; -ms-border-radius: "+e+"px; -o-border-radius: "+e+"px; -webkit-border-radius: "+e+"px; -khtml-border-radius: "+e+"px; border-radius: "+e+"px;":"; -moz-border-radius: "+(e=e||0)+"px "+(r=r||0)+"px "+(t=t||0)+"px "+(n=n||0)+"px; -ms-border-radius: "+e+"px "+r+"px "+t+"px "+n+"px; -o-border-radius: "+e+"px "+r+"px "+t+"px "+n+"px; -webkit-border-radius: "+e+"px "+r+"px "+t+"px "+n+"px; -khtml-border-radius: "+e+"px "+r+"px "+t+"px "+n+"px; border-radius: "+e+"px "+r+"px "+t+"px "+n+"px;"};var fR,hR=function(){function e(){X(this,e),_e(this,"handlers",{})}return Q(e,[{key:"on",value:function(e,t){var n=r.guid();return this.handlers[e]||(this.handlers[e]=[]),this.handlers[e].push({id:n,handler:t}),n}},{key:"off",value:function(e,r){if(this.handlers[e]){var t,n=this.handlers[e];if(r){for(t=0;t<n.length;t++)if(n[t].id==r){n.splice(t,1);break}}else n.splice(0)}}},{key:"fire",value:function(e){if(this.handlers[e]){var r,t=this.handlers[e];for(r=0;r<t.length;r++)t[r].handler();return t.length}return 0}},{key:"clear",value:function(){this.handlers={}}}]),e}();function gR(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=Te(e);if(r){var i=Te(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return Se(this,t)}}var pR=e.DWT,mR=e.navInfoSync,_R=r.each;function vR(){var r,t=e.Lib,n=e.dcp,i=t.LS.item("DWT_port"),o=t.LS.item("DWT_ssl");if(n.bEnhancedMode)return!0;t.detect.urls.splice(0),t.detect.cUrlIndex=0,i!==fR&&o!==fR&&(r={port:i,ssl:"true"==o});var a=function(e){return!r||!(!e||e.port==r.port&&e.ssl==r.ssl)};1===t.detect.detectType?(r!==fR&&r.ssl&&t.detect.urls.push(r),_R(t.detect.ports,(function(e){e.ssl&&a(e)&&t.detect.urls.push(e)}))):0===t.detect.detectType?(r===fR||r.ssl||t.detect.urls.push(r),_R(t.detect.ports,(function(e){!1===e.ssl&&a(e)&&t.detect.urls.push(e)}))):(r!==fR&&t.detect.urls.push(r),_R(t.detect.ports,(function(e){a(e)&&t.detect.urls.push(e)})))}function yR(t,n,i){if(!r.detect.bNoControlEvent){var o,a=0,s=0;i&&(a=i._width,s=i._height,o=i._containerElement),i&&i._bRemoteMode?i._bNotShowMessage||r.isFunction(e.OnRemoteWebTwainNotFoundCallback)&&e.OnRemoteWebTwainNotFoundCallback(r.product.name,i._serverInfo.server,i._serverInfo.port,i._serverInfo.ssl,r.env.bMobile):Ya(t,n).then((function(e){var t;if(Ja(o,a,s),!e)throw t={},r.Errors.DynamsoftServiceResponseDataTypeError(t),We(t);Mi(e.upgrade,e.socket)}),(function(e){Le(e)})),r.detect.bNoControlEvent=!0}}r.ProgressBar=dR,r.env.WSVersion="12.0.0",r.env.WSSession=(new Date).getTime(),r.progressMessage="",r.dialogShowStatus=!1,r.needShowTwiceShowDialog=!1,r.dlgProgress=!1,r.cancelFrom=q.Other,r.dlgRef=0,r.initProgress=function(e){var t,n;if(!r.dlgProgress){(n=[]).push('<dialog class="dynamsoft-dwt-dialogProgress" closed="closed" style="top:30%"><div class="ds-dwt-progressWrap">'),n.push('<h3 class="dynamsoft-finalMessage"> </h3>'),n.push('<p class="dynamsoft-desc"> </p><p class="dynamsoft-status">0%</p>'),mR.bIE?n.push('<div class="dynamsoft-progressBar" value="" max="100"></div>'):n.push('<progress class="dynamsoft-progressBar" value="" max="100"></progress>'),n.push('<br /><div style="width:100%;text-align:center"><button class="dynamsoft-btnCancel" value="cancel" autofcus>cancel</button></div>'),n.push("</div></dialog>"),(t=r.one(".dynamsoft-dwt-dialogProgress"))&&t.getEL()&&t.remove();var i=r.parseHTML(n.join(""));if(i&&i.length>0&&document.body.appendChild(i[0]),mR.bIE){var o=r.one(".dynamsoft-progressBar"),a=o&&o.getEL();a&&(a.objProgressBar=new dR(a,{width:280,height:20}))}(t=r.one(".dynamsoft-dwt-dialogProgress"))&&t.getEL()&&(r.dlgProgress=t[0],r.dialog.setup(r.dlgProgress)),r.dlgRef=0,r.dialogShowStatus=!1,r.cancelFrom=q.Other}},r.showProgressMsg=function(){};var IR=function(e){Ie(t,e);var r=gR(t);function t(){return X(this,t),r.apply(this,arguments)}return Q(t)}(hR);r.progressContext=new IR;var SR=function(){var e=r.progressContext;if(e){var t,n=e.fire("cancel");for(t=0;t<n;t++)r.closeProgress(null,"")}};r.hideProgress=function(){var e=r.progressContext;e&&(e.IfShowProgressBar=!1,e.IfShowCancelDialogWhenImageTransfer=!1,e.off("cancel"),e._onPercent=null)},r.showProgress=function(t,n,i){var o,a=t;if(a.IfShowProgressBar)if(r.progressContext&&(r.progressContext.IfShowProgressBar=!0,r.progressContext.IfShowCancelDialogWhenImageTransfer=a.IfShowCancelDialogWhenImageTransfer),r.dlgRef>0)r.dlgRef++;else{var s;if((o=e.DWT.IfConfineMaskWithinTheViewer)?a._isNoViewer&&a._isNoViewer()?s=document.body:a._containerElement?s=a._containerElement:e.DWT.Containers&&e.DWT.Containers.length>0&&e.DWT.Containers[0].ContainerId&&(s=e.Lib.get(e.DWT.Containers[0].ContainerId))||(s=document.body):s=document.body,s&&s!==document.body){var u=!1,c=s.firstElementChild;if(c&&c!==r.dlgProgress&&"dvs-root dvs-web-viewer"==c.className&&(s=c,u=!0),0==u)for(var l=0;l<s.children.length;l++)if((c=s.children[l])&&c!==r.dlgProgress&&"dvs-root dvs-web-viewer"==c.className){s=c;break}var d=r.progressContext;""!==s.style.position&&"static"!==s.style.position||(s.style.position="relative",d.progressContainer={el:s})}r.log("showProgress:"+n+",bCancel:"+i),r.dlgProgress&&s.appendChild(r.dlgProgress),Sr(i);var f=r.one(".dynamsoft-btnCancel");if(f&&f.getEL()&&(r.removeEventListener(f[0],"click",SR),r.addEventListener(f[0],"click",SR)),0==r.dialogShowStatus){r.dlgProgress&&(o&&s&&s!==document.body?r.dialog.setup(r.dlgProgress,!0):r.dialog.setup(r.dlgProgress),r.dlgProgress.showModal()),r.dialogShowStatus=!0;var h=r.one(".dynamsoft-finalMessage"),g=r.one(".dynamsoft-progressBar"),p=g&&g.getEL(),m=r.one(".dynamsoft-status");h&&h.getEL()&&h.html(""),m&&m.getEL()&&m.html("0%"),p&&(mR.bIE&&p.objProgressBar?p.objProgressBar.setValue(0):p.value=0)}r.dlgRef++}else r.hideProgress()},r.closeProgress=function(e,t){var n=r.progressContext;r.log("closeProgress:"+t),n&&n.IfShowProgressBar?(r.dlgRef--,r.dlgRef<=0&&(r.dlgRef=0)):r.dlgRef=0,0==r.dlgRef&&(n.off("cancel"),n._onPercent=null,1==r.dialogShowStatus&&(r.dlgProgress&&(r.dlgProgress.close(),r.dlgProgress&&document.body.appendChild(r.dlgProgress),n&&n.progressContainer&&n.progressContainer.el&&(n.progressContainer.el.style.position="",n.progressContainer=null)),r.dialogShowStatus=!1),r.cancelFrom=q.Other)},pR.RemoveAllAuthorizations=function(){var e=r.LS.item("DWT_port"),t="http://";return"true"==r.LS.item("DWT_ssl")&&(t="https://"),fr({method:"GET",xhrFields:{withCredentials:!0},url:[t,f(),":",e,"/dwt/",r.product.getDWTPrefix(),r.product.getServerVersionInfo(),"/RemoveAllAuthorizations?t=",r.now()].join(""),async:!0}),!0};var TR={upload:"Uploading...",download:"Downloading...",load:"Processing...",decode:"Processing...",decodeTIFF:"Processing tiff...",decodePDF:"Processing pdf...",encodeTIFF:"Processing tiff...",encodePDF:"Processing pdf...",encode:"Processing...",transfer:"Transferring..."};r.progressBarOnPercentDone=function(t,n,i,o,a,s){var u,c=r.one(".dynamsoft-progressBar"),l=r.one(".dynamsoft-status"),d=r.one(".dynamsoft-finalMessage"),f=r.one(".dynamsoft-desc");if(e.DWT.UseDefaultViewer&&e.DWT.IfConfineMaskWithinTheViewer&&s&&(c=r.one(".dynamsoft-progressBar",s),l=r.one(".dynamsoft-status",s),d=r.one(".dynamsoft-finalMessage",s),f=r.one(".dynamsoft-desc",s)),r.cancelFrom==q.FTPUpload||r.cancelFrom==q.FTPDownload){var h=i;0==h?r.setBtnCancelVisibleForProgress(!1):1==h&&r.setBtnCancelVisibleForProgress(!0)}if(t<0?(r.progressMessage=n,u=r.progressMessage):u=""!=n&&"1/1"!=n?r.progressMessage+"("+n+")":r.progressMessage,d&&d.getEL()){var g="",p="";u.indexOf(" ...")&&(u=u.replace(" ...","...")),-1!=u.indexOf("(")?(g=u.substr(0,u.indexOf("(")),p=u.substr(u.indexOf("("))):g=u,r.each(TR,(function(r,t){-1!=r.indexOf(g)&&(u=e.Lib.product.CustomizableDisplayInfo.customProgressText[t]+p)})),""==u&&(u="&nbsp;"),d.html(u)}a?(""==a||r.isUndef(a)?a="&nbsp;":r.isString(a)&&a.length>30&&(a=a.substring(0,30)+"..."),f.html(a)):f.html("&nbsp;"),(o||0===o)&&(l&&l.getEL()&&l.html(o+"%"),c&&c.getEL()&&(mR.bIE?c[0].objProgressBar?c[0].objProgressBar.setValue(o):c[0].value=o:mR.bEdge?(c[0].style.display="",c[0].value=o):c[0].value=o)),r.dlgRef<=0&&setTimeout((function(){c&&c.getEL()&&(mR.bIE?c[0].objProgressBar?c[0].objProgressBar.setValue(0):c[0].value=0:mR.bEdge?(c[0].style.display="none",c[0].value=0):c[0].value=0)}),1e3)};var bR,ER=239514e3;function CR(e){return 1*e+ER}function wR(e){return 1*e-ER}!function(e){e.url=0,e.blob=1,e.base64=2}(bR||(bR={})),e.DWT.EnumDWT_ImageFormatType=bR;var kR=window.SparkMD5;function DR(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=Te(e);if(r){var i=Te(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return Se(this,t)}}function xR(e,r){!function(e,r){if(r.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,r),r.add(e)}function PR(e,r,t){if(!r.has(e));return t}var FR=e.navInfoSync;function WR(e){e.Resolution!==undefined&&(e.Resolution=parseInt(e.Resolution)),e.PixelType!==undefined&&(e.PixelType=parseInt(e.PixelType)),e.SelectSourceByIndex!==undefined&&(e.SelectSourceByIndex=parseInt(e.SelectSourceByIndex))}var AR=new WeakSet,RR=new WeakSet,OR=function(t){Ie(A,t);var n,i,o,a,s,u,c,l,d,f,h,g,p,m,_,v,y,S,T,b,E,C,w,k,D,x,P,F,W=DR(A);function A(e){var r;return X(this,A),xR(ve(r=W.call(this,e)),RR),xR(ve(r),AR),r._bServerAlwaysFocusOnPopupWindow=Ve,r._bPageFocus=Ve,r.__bAcquireImageNow=Be,r.__bOpenFileNow=Be,r.__maxUploadImageSize=-1,r._logLevel=0,r._bLicenseErrorDispose=!0,r}return Q(A,[{key:"_acquireImage",value:(F=ne(de.mark((function R(t,n){var i,o,a,s,u,c;return de.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:if(i=this,o=n?r.clone(n):{},a="acuqireImage",i._resetErr(),i._isValid()){l.next=4;break}return l.abrupt("return",r.Promise.reject({code:i._errorCode,message:i._errorString}));case 4:if(r.License.checkProductKey(i,{Core:!0})&&i._isValid()){l.next=6;break}throw{code:i._errorCode,message:i._errorString};case 6:if(!i.__bAcquireImageNow){l.next=9;break}throw r.Errors.SystemBusy(i),{code:i._errorCode,message:i._getErrorString()};case 9:return i.__bAcquireImageNow=!0,Zn(a,i),s=r.Promise.resolve(),u=e.DWT.RemoteScanConfig,c=_a(),l.prev=13,WR(o),u&&va(u.keepAwake),null!=t&&(o.Device=t.strDevice,o.DeviceMatchField=ts.SMF_NAME),l.next=19,i._acquireImageFromServiceAsync(o);case 19:l.next=24;break;case 21:throw l.prev=21,l.t0=l["catch"](13),l.t0;case 24:return l.prev=24,i.__bAcquireImageNow=!1,l.prev=26,l.next=29,s;case 29:l.next=33;break;case 31:l.prev=31,l.t1=l["catch"](26);case 33:return Qn(a),va(c),l.finish(24);case 36:return l.abrupt("return",!0);case 37:case"end":return l.stop()}}),R,this,[[13,21,24,36],[26,31]])}))),function(e,r){return F.apply(this,arguments)})},{key:"_getSourcesAsync",value:(P=ne(de.mark((function O(e,r,t){var n,i;return de.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return n=this,o.next=3,n._innerFunV2("GetSources",kn(e,null!=r&&r,null!=t&&t));case 3:return i=o.sent,o.abrupt("return",us(this,i));case 5:case"end":return o.stop()}}),O,this)}))),function(e,r,t){return P.apply(this,arguments)})},{key:"_getDevices",value:(x=ne(de.mark((function L(t,n,i){var o,a,s,u,c,l;return de.wrap((function(d){for(;;)switch(d.prev=d.next){case 0:if(a=[],s="getDevices",u=(o=this)._bRemoteMode?Fn:e.navInfoSync.bAndroid?An:Fn,c=null!=t?t:u,o._resetErr(),o._isValid()){d.next=5;break}return d.abrupt("return",r.Promise.reject({code:o._errorCode,message:o._errorString}));case 5:return Zn(s,o),d.prev=6,o._dm&&(o._dm.bLicenseOK=!1),d.next=10,o._getSourcesAsync(c,n,i);case 10:l=d.sent,r.isArray(l)&&l.length>0&&(a=a.concat(l)),d.next=17;break;case 14:throw d.prev=14,d.t0=d["catch"](6),d.t0;case 17:return d.prev=17,Qn(s),d.finish(17);case 20:return d.abrupt("return",a);case 21:case"end":return d.stop()}}),L,this,[[6,14,17,20]])}))),function(e,r,t){return x.apply(this,arguments)})},{key:"_acquireImageFromServiceAsync",value:function(t){var n=this;return new r.Promise((function(r,i){return n._innerAcquireImageFromService(t,(function(){n._blts&&e.DWT.lcvrf(n),r(!0)}),(function(e,r){i({code:e,message:r})}))}))}},{key:"_innerAcquireImageFromService",value:function(t,n,i){var o,a=this;if(!r.License.checkProductKey(a,{Core:!0}))return r.isFunction(i)&&i(a._errorCode,a._getErrorString()),!1;var s=a._bRemoteMode?Ve:Be,u=Be;t.RemoteScan=s?je:Ge,u=r.isUndefined(t.ShowRemoteScanUI)?s:s&&t.ShowRemoteScanUI?Ve:Be,t.ShowRemoteScanUI=u?je:Ge,a._bRemoteMode&&(r.isFunction(a.__OnRemoteScanStatusAsync)||(a.__OnRemoteScanStatusAsync=function(){}),r.isFunction(a.__OnSourceUIClose)||(a.__OnSourceUIClose=function(){}));for(var c=0,l=0;l<ei.length;l++){var d=["__",ei[l]].join("");r.isFunction(a[d])&&(c|=1<<l)}return t.EnableEvents=c,s&&(a._isBindViewer()||u)&&a._initRemoteDiv(),a._bRemoteMode||(a._bPageFocus&&e.DWT.IfAlwaysFocusOnPopupWindow?a._bServerAlwaysFocusOnPopupWindow||a._OnPageFocus(!0):a._bServerAlwaysFocusOnPopupWindow&&a._OnPageBlur(!0)),o=["[",r.stringify(t),"]"].join(""),a._sendData("AcquireImage",o,!0,(function(e){n(e)}),(function(e){i(a._errorCode,a._getErrorString())})),!0}},{key:"_getCapabilities",value:(D=ne(de.mark((function N(e,t){var n,i,o,a;return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return PR(n=this,RR,NR).call(n,e),n._initRemoteDiv(),t.next=5,n._innerSelectDeviceAsync(e);case 5:return t.next=7,n._sendDataByHttpAsync("GetCapabilities",null);case 7:if(i=t.sent,t.prev=8,i.length>0&&(a=i[0]),!r.isString(a)){t.next=21;break}if(a=r.removeNonPrintableChar(a),a=r.replaceAll(a,"\\\\","\\\\"),0!=(o=JSON.parse(a)).errorCode){t.next=16;break}return t.abrupt("return",o.response);case 16:throw n._errorCode=o.errorCode,n._errorString=o.errorString,{code:n._errorCode,message:n._getErrorString()};case 21:throw r.Errors.DynamsoftServiceResponseDataTypeError(n),{code:n._errorCode,message:n._getErrorString()};case 23:t.next=30;break;case 25:throw t.prev=25,t.t0=t["catch"](8),n._errorCode=-2302,n._errorString=t.t0,{code:n._errorCode,message:n._getErrorString()};case 30:case"end":return t.stop()}}),N,this,[[8,25]])}))),function(e,r){return D.apply(this,arguments)})},{key:"_setCapabilities",value:(k=ne(de.mark((function M(e,t,n){var i,o;return de.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(PR(i=this,RR,NR).call(i,e),r.isObject(t)&&!r.isArray(t)){n.next=5;break}throw r.Errors.InvalidParameter(i),{code:i._errorCode,message:i._getErrorString()};case 5:return i._initRemoteDiv(),n.next=8,i._innerSelectDeviceAsync(e);case 8:return o=["[",r.stringify(t),"]"].join(""),n.next=11,i._sendDataByHttpAsync("SetCapabilities",o);case 11:return n.abrupt("return",n.sent);case 12:case"end":return n.stop()}}),M,this)}))),function(e,r,t){return k.apply(this,arguments)})},{key:"_closeSource",value:(w=ne(de.mark((function U(){var e;return de.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return e=this,r.next=3,e._innerFunV2("CloseSource");case 3:case"end":return r.stop()}}),U,this)}))),function(){return w.apply(this,arguments)})},{key:"_saveImages",value:(C=ne(de.mark((function B(r,t,n,i){var o,a,s,u,c,l,d;return de.wrap((function(f){for(;;)switch(f.prev=f.next){case 0:return o=this,a=iR(t,i),s=this._imageBufferWrapper.convertIndicesToServerIds(n),f.next=4,this._innerConvertToArrayBufferWithUIAsync(r,i,s);case 4:if(u=f.sent,c=Jn.getBlobTypeByImageType(i),l=new Blob([u],{type:c}),!e.navInfo.bIE){f.next=13;break}return f.next=11,o._innerSaveLocal(l,a);case 11:f.next=17;break;case 13:return d=URL.createObjectURL(l),f.next=16,o._innerSaveLocal(d,a);case 16:URL.revokeObjectURL(d);case 17:l=null;case 18:case"end":return f.stop()}}),B,this)}))),function(e,r,t,n){return C.apply(this,arguments)})},{key:"_innerSaveLocal",value:(E=ne(de.mark((function V(t,n){return de.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",new r.Promise((function(r,i){var o=window,a=e.navInfo,s=e.navInfoSync,u=o.requestFileSystem||o.webkitRequestFileSystem||o.mozRequestFileSystem;if(!a.biPad&&!a.biPhone||u||!(s.bSafari&&parseFloat(s.strBrowserVersion)<13)&&s.bSafari){var c=document.createElementNS("http://www.w3.org/1999/xhtml","a");if(c.href=t,c.download=n,c.target="_blank",document.body.appendChild(c),a.bEdge)c.click(),t=null,c.href=null;else if(a.bIE){var l;(l=window.navigator)&&"msSaveOrOpenBlob"in l&&l.msSaveOrOpenBlob(t,n)}else{var d=document.createEvent("MouseEvents");d.initMouseEvent("click",!0,!1),c.dispatchEvent(d)}setTimeout((function(){document.body.removeChild(c),c=null,r()}),6e3)}else{var f=o.open(t,"","",!1);setTimeout((function(){f.document.title=n,r()}),6e3)}})));case 2:case"end":return i.stop()}}),V,this)}))),function(e,r){return E.apply(this,arguments)})},{key:"_getErrorCode",value:function(){return this._errorCode}},{key:"_getErrorString",value:function(){return 0!=this._errorCode?this._errorString:"Successful."}},{key:"_OnPageFocus",value:function(t){var n=this;if(n._bPageFocus=!0,n._bReady&&FR.bWin&&e.DWT.IfAlwaysFocusOnPopupWindow){var i=r.stringify({sequence:0,wnds:0,wnd:"0",type:3,x:0,y:0});if(n.__bAcquireImageNow||t||n.__bOpenFileNow){n._bServerAlwaysFocusOnPopupWindow=!0;try{n._isValid()&&n._sendDataByHttpAsync("SendEventToScannerUI",["[",i,"]"].join(""))}catch(AA){}}}}},{key:"_OnPageBlur",value:function(e){var t=this;if(FR.bWin&&t._bReady){var n=r.stringify({sequence:0,wnds:0,wnd:"0",type:4,x:0,y:0});if((0!=t._bPageFocus||e)&&(t._bPageFocus=!1,t.__bAcquireImageNow||e||t.__bOpenFileNow)){t._bServerAlwaysFocusOnPopupWindow=!1;try{t._isValid()&&t._sendDataByHttpAsync("SendEventToScannerUI",["[",n,"]"].join(""))}catch(AA){}}}}},{key:"_OnActiveUI",value:(b=ne(de.mark((function G(t){var n,i,o,a,s,u,c,l,d,f,h,g,p,m,_,v,y,S;return de.wrap((function(T){for(;;)switch(T.prev=T.next){case 0:if(n=this,o=!1,t&&t.length>=6?(t[2],i=t[5],a=!1,s=!1,u=0,t.length>12?(t[6],n._b64bit="64"==t[7],t[8],a=t[9],s=t[10],u=t[11],t[12]):t.length>8&&(a=t[6],s=t[7],u=t[8]),a?s&&u&&(n._bRemoteMode=!0):n._bRemoteMode=!0,r.isString(i)&&("win"==i?n.__serverPlatform=I.enumWindow:"linux"==i?n.__serverPlatform=I.enumLinux:"mac"==i?n.__serverPlatform=I.enumMac:"embed"==i?n.__serverPlatform=I.enumEmbed:"chromeos"==i&&(n.__serverPlatform=I.enumChromeOS))):o=!0,n._bMustUpgradeService=o,o){T.next=65;break}if(Pi(e.MSG.Init_SetLicenseForDWT),c=!1,!n._blts){T.next=43;break}return d=n._bRemoteMode&&null!==(f=null===(h=n._dmService)||void 0===h||null===(g=h.attrs)||void 0===g?void 0:g.UUID)&&void 0!==f?f:"",T.prev=10,T.next=13,wi(e.DWT.EnumInstance.dwt_desktop,d);case 13:l=T.sent,T.next=26;break;case 16:if(T.prev=16,T.t0=T["catch"](10),UR(n,T.t0),!n._bLicenseErrorDispose){T.next=24;break}throw n._bRemoteMode||(Xo(n._errorCode)?this._LicensePromptExpired():Zo(n)),{code:n._errorCode,message:n._errorString};case 24:r.warn(n._errorString),l=null;case 26:if(Pi(e.MSG.Init_DecodingLicenseForDWT),!l){T.next=40;break}return T.next=30,n._setLTSLicenseAsync(l.ar);case 30:return p=T.sent,e.DWT.laddDWTObj(n),d="",n._bRemoteMode&&(d=null!==(m=null===(_=n._dmService)||void 0===_||null===(v=_.attrs)||void 0===v?void 0:v.UUID)&&void 0!==m?m:""),Pi(e.MSG.Init_CheckingLicense),T.next=37,e.DWT.lcheckLic(e.DWT.EnumInstance.dwt_desktop,p,d);case 37:c=0==e.DWT.licenseException.code,T.next=41;break;case 40:c=!1;case 41:T.next=60;break;case 43:return Pi(e.MSG.Init_DecodingLicenseForDWT),y=r.product.refProductKey,T.prev=45,T.next=48,n._setProductKeyAsync(y);case 48:T.sent&&(c=!0),T.next=60;break;case 52:if(T.prev=52,T.t1=T["catch"](45),!n._bLicenseErrorDispose){T.next=58;break}throw T.t1;case 58:r.warn(T.t1.message);case 59:c=!1;case 60:if(c&&(Pi(e.MSG.Init_CheckingLicense),r.License.checkProductKey(n,{Core:!0})||(S={code:n._errorCode,message:n._errorString},n._resetErr(),e.DWT.lclex(),e.navInfoSync.bWin&&r.License.checkProductKey(n,{Webcam:!0},!0)||(n._errorCode=S.code,n._errorString=S.message))),0==n._errorCode){T.next=65;break}if(n._bRemoteMode||(Xo(n._errorCode)?this._LicensePromptExpired():Zo(n)),!n._bLicenseErrorDispose){T.next=65;break}throw{code:n._errorCode,message:n._errorString};case 65:n._bRemoteMode&&A.startHeartBeat(n);case 66:case"end":return T.stop()}}),G,this,[[10,16],[45,52]])}))),function(e){return b.apply(this,arguments)})},{key:"_OnPostTransferAsync",value:function(e,t,n){var i,o=this;if(e&&e.length>=2)try{var a=String(e[1]).replace(/\\/g,"\\\\");i=r.parse(a),!n&&i.imageId&&(i.imageId=o._convertServerIdToGuid(i.imageId))}catch(u){r.log(e)}i||(i={imageId:-1});var s=!1;if(r.isFunction(o.__OnPostTransferAsync))try{s=o.__OnPostTransferAsync(i)}catch(c){Le(c)}if(r.isFunction(o.__OnPostTransferAsync2))try{o.__OnPostTransferAsync2(i)}catch(c){Le(c)}return s}},{key:"_innerSelectDeviceAsync",value:(T=ne(de.mark((function j(t,n){var i,o,a,s,u,c,l,d,f;return de.wrap((function(h){for(;;)switch(h.prev=h.next){case 0:if(o=this,t&&t instanceof ss){h.next=4;break}throw r.Errors.InvalidParameter(o),{code:o._errorCode,message:o._errorString};case 4:if(!(a=null===(i=this._dmService.attrs)||void 0===i?void 0:i.UUID)){h.next=15;break}if((null===(s=t.serviceInfo.attrs)||void 0===s?void 0:s.UUID)!=a){h.next=9;break}h.next=15;break;case 9:if(!((c=(null===(u=t.serviceInfo.attrs)||void 0===u?void 0:u.url)||t.serviceInfo.server)&&c.indexOf(a)>-1)){h.next=13;break}h.next=15;break;case 13:throw r.Errors.DeviceNotFound(o),{code:o._errorCode,message:o._errorString};case 15:return l=null!=n?n:ts.SMF_NAME,d=["[",t.strDevice,",",l,"]"].join(""),h.next=18,o._sendDataByHttpAsync("SelectSourceEx",d,null,!0);case 18:if(!((f=h.sent)&&e.Lib.isArray(f.result)&&f.result.length>0)){h.next=21;break}return h.abrupt("return",f.result[0]);case 21:return h.abrupt("return",f);case 22:case"end":return h.stop()}}),j,this)}))),function(e,r){return T.apply(this,arguments)})},{key:"_initRemoteDiv",value:function(){if(!this._acquireDivEL){var e=document.createElement("div");e.style.position="fixed",e.style.zIndex="510000",e.style.left="0",e.style.top="0";var r=document.createElement("img");r.className="ds-img-screen",e.appendChild(r),document.body.appendChild(e),this._acquireDivEL=e}}},{key:"_getDdmLowLevel",value:(S=ne(de.mark((function H(e){var r,t,n,i,o,a,s,u,c,l;return de.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=this)._dm||(r._bRemoteMode&&(i=null===(o=r._dmService)||void 0===o||null===(a=o.attrs)||void 0===a?void 0:a.url),r._dm=new Cs(i,!1,r._clientId,null===(t=r._dmService)||void 0===t||null===(n=t.attrs)||void 0===n?void 0:n.ty)),r._dm.bLicenseOK){e.next=13;break}return s=r._bRemoteMode&&null!==(u=null===(c=r._dmService)||void 0===c||null===(l=c.attrs)||void 0===l?void 0:l.UUID)&&void 0!==u?u:"",e.prev=4,e.next=7,mo(r,r._dm,s,!1);case 7:r._dm.bLicenseOK=!0,e.next=13;break;case 10:throw e.prev=10,e.t0=e["catch"](4),e.t0;case 13:return e.abrupt("return",this._dm);case 14:case"end":return e.stop()}}),H,this,[[4,10]])}))),function(e){return S.apply(this,arguments)})},{key:"_setProductKeyAsync",value:function(t){var n=this,i=t;return n._resetErr(),n._isValid()?r.isString(i)?r.License.isLicenseMixed(i)?r.Promise.reject(e.DWT.licenseException):r.License.isLongKey(i)?PR(n,AR,LR).call(n,i).then((function(e){var t=e;if(!t||t.message)throw r.Errors.LicenseEmptyOrInvalid(n),t&&t.message&&(n._errorString=t.message),{code:n._errorCode,message:n._errorString};return rs(n,t),t})):(r.Errors.LicenseEmptyOrInvalid(n),r.Promise.reject({code:n._errorCode,message:n._errorString})):(r.Errors.LicenseEmptyOrInvalid(n),r.Promise.reject({code:n._errorCode,message:n._errorString})):r.Promise.reject({code:n._errorCode,message:n._errorString})}},{key:"_setLTSLicenseAsync",value:function(e){var t=this;return t._resetErr(),t._isValid()?r.isString(e)?t._setLTSLic(e).then((function(e){var n=e;if(!n||n.message)throw r.Errors.LicenseEmptyOrInvalid(t),n&&n.message&&(t._errorString=n.message),{code:t._errorCode,message:t._errorString};return rs(t,n),t.__licenseInfo&&(t.__licenseInfo.LTS=!0),n})):(r.Errors.LicenseEmptyOrInvalid(t),r.Promise.reject({code:t._errorCode,message:t._errorString})):r.Promise.reject({code:t._errorCode,message:t._errorString})}},{key:"_setLTSLic",value:function(t){var n=this,i=t;return n._resetErr(),!!n._isValid()&&(r.isString(i)?n._sendDataByHttpAsync("LTSLicense",kn(i),null,!0).then((function(t){if(t){if(Ae(t))throw n._errorCode=t.exception,n._errorString=t.description,{code:n._errorCode,message:n._errorString};var i="GetLicenseInfo";return e.DWT.ConnectWithSocket?n._sendDataConnectWithSocket(i,null,"json",!0):n._sendDataByHttpAsync(i,null,"json",!0)}throw r.Errors.LicenseEmptyOrInvalid(n),{code:n._errorCode,message:n._errorString}})):(r.Errors.LicenseEmptyOrInvalid(n),r.Promise.reject({code:n._errorCode,message:n._errorString})))}},{key:"_checkIndices",value:function(t){var n,i,o=this;if(!r.isArray(t))return r.Errors.IndicesNotArray(o),!1;if(0==t.length)return r.Errors.IndicesCannotEmpty(o),!1;if(e.DWT.ConnectWithSocket)return!0;for(n=this._imageBufferWrapper.count(),i=0;i<t.length;i++){var a=t[i];if(r.isUndefined(a)||null===a)return r.Errors.IndexNullOrUndefined(o),!1;if(a=parseInt(a),isNaN(a))return r.Errors.InvalidIndex(o),!1;if(a<0||a>=n)return r.Errors.IndicesOutOfRange(o),!1}return!0}},{key:"_acquireImageForSendTo",value:(y=ne(de.mark((function z(t,n,i,o){var a,s,u,c,l,d,f,h;return de.wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(a=this,s=i?r.clone(i):{},c=u=o,a._resetErr(),a._isValid()){g.next=4;break}throw{code:a._errorCode,message:a._errorString};case 4:if(r.isString(u._id)){g.next=6;break}throw r.Errors.ThrowInvalidParameterSendTo();case 6:if(!a.__bAcquireImageNow){g.next=9;break}throw r.Errors.SystemBusy(a),{code:a._errorCode,message:a._getErrorString()};case 9:if(a.__bAcquireImageNow=!0,Zn(t,c),l=r.Promise.resolve(),d=e.DWT.RemoteScanConfig,f=_a(),g.prev=13,WR(s),d&&va(d.keepAwake),a._dm&&(a._dm.bLicenseOK=!1),r.License.checkProductKey(a,{Core:!0})&&a._isValid()){g.next=19;break}throw{code:a._errorCode,message:a._errorString};case 19:return A._innerSendHeartBeat(u,!1),h=function(){var t=ne(de.mark((function n(t){return de.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:l=l.then((function(){return new r.Promise((function(n,i){var o=[a._convertGuidToServerId(t.imageId)],s=e.DWT.EnumDWT_ImageType.IT_PNG;a._innerConvertToArrayBufferAsync(s,o).then((function(e){u._blts_tmp=u._blts,u._blts=!1,u.__LoadImageFromBytesV2(e,s,"",!0,0,0,!1,0,function(){var e=ne(de.mark((function i(e,o){var s;return de.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=a._convertGuidToServerId(t.imageId),o?(r.log("LoadImageFromBinary success"),u._blts=u._blts_tmp,t.imageId=u._convertServerIdToGuid(o.ids),r.isFunction(u._OnPostTransferAsync)&&u._OnPostTransferAsync([!0,r.stringify(t)],null,!0)):r.log("LoadImageFromBinary return null."),n(),e.next=5,a._removeImageByIdAsync(s);case 5:case"end":return e.stop()}}),i)})));return function(r,t){return e.apply(this,arguments)}}(),(function(e,t){r.log(t),u._blts=u._blts_tmp,i({code:e,message:t})}))}),(function(e){e&&e.message&&r.log(e.message),i(e)}))}))}));case 1:case"end":return n.stop()}}),n)})));return function(e){return t.apply(this,arguments)}}(),a._registerEvent("OnPostTransferAsync2",h),null!=n&&(s.Device=n.strDevice,s.DeviceMatchField=ts.SMF_NAME),g.next=25,a._acquireImageFromServiceAsync(s);case 25:g.next=30;break;case 27:throw g.prev=27,g.t0=g["catch"](13),g.t0;case 30:return g.prev=30,g.prev=31,g.next=34,l;case 34:g.next=38;break;case 36:g.prev=36,g.t1=g["catch"](31);case 38:return a._unregisterEvent("OnPostTransferAsync2"),a.__bAcquireImageNow=!1,Qn(t),va(f),g.finish(30);case 43:case"end":return g.stop()}}),z,this,[[13,27,30,43],[31,36]])}))),function(e,r,t,n){return y.apply(this,arguments)})},{key:"_imageIDToIndex",value:function(e){var t,n=this,i=-1;return n._resetErr(),!!n._isValid()&&((t=wR(e))>0&&(i=n._imageBufferWrapper.convertServerIdToClientIndex(t)),-1==i&&r.Errors.InvalidImageID(n),i)}},{key:"_indexToImageID",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return!1;var n=parseInt(e);return isNaN(n)?(r.Errors.InvalidIndex(t),-1):n<0||n>=t._imageBufferWrapper.count()?(r.Errors.IndexOutOfRange(t),-1):CR(t._imageBufferWrapper.convertClientIndexToServerId(n))}},{key:"__LoadImageFromBytesV2",value:function(t,n,i,o,a,s,u,c,l,d){var f,h=this,g=n||3,p=0,m=t.name,_=!0,v=1;if(t)if(t instanceof Blob)p=t.size;else if(Dn(t))p=t.byteLength;else if(t instanceof Array)p=t.length;else{var y=t;p=y.size||y.byteLength||y.length}!isNaN(a)&&a>=0&&!isNaN(s)&&s>0?v=0:(a=0,s=0),f=["[",p,",",0,",",g,',"',i,'",',a,",",s,",",c,",",v,",",u?"true":"false","]"].join("");var I=function(){if(h.__bLoadingImage=!1,_){var e=h._imageBufferWrapper.getCurrentImageIndex();e>=0&&h._innerRefreshUI(e)}return r.isFunction(d)&&d(h._errorCode,h._getErrorString(),m),!1};return(r.License.checkProductKey(h,{Core:!0})||e.navInfoSync.bWin&&r.License.checkProductKey(h,{Webcam:!0},!0))&&r.License.checkPDFProductKeyWhenNeeds(h,n)?0===p?(e.Lib.Errors.ImageFileLengthCannotZero(h),_=!1,I()):this._innerSendBlob("LoadImageFromBytes",f,t,o,v,(function(t){if(h.__bLoadingImage=!1,h._isBindViewer()){var n=h._imageBufferWrapper.getCurrentImageIndex();o&&n>=0&&h._innerRefreshUI(n)}if(r.isFunction(l)){var i=t;if(r.isArray(i)&&(i=i.length>0?i[0]:{}),o)setTimeout((function(){l(m,i)}),30);else try{l(m,i)}catch(a){e.Lib.error(a.message)}}return h._blts&&e.DWT.lcvrf(h),!0}),I):(_=!1,I())}},{key:"_innerSendBlob",value:function(t,n,i,o,a,s,u){var c=this;if(Vn.isServerInvalid(c))return c._waitForConnect().then((function(){c._innerSendBlob(t,n,i,o,a,s,u)}));if(!o){var l,d,f,h,g=[],p="";return c._resetErr(),c._isValid()?(d=[c._httpUrl,"f/",t].join(""),f=Gn(c._clientId,t,n,0),f+="\r\n\r\n",h={method:"POST",url:d,processData:!1,data:f+=e.Lib.base64.encodeArray(i),async:!1,onSuccess:function(t,n,i){var o=!1,s=!1;try{o=r.isString(t)&&"text/json"===i.getResponseHeader("content-type")?r.parse(t):t}catch(d){}if(o!==undefined&&null!==o&&(Ae(o)?(c._errorCode=o.exception,c._errorString=o.description):c._resetErr(),(l=o.result)&&r.isArray(l)&&l.length>=1))if(a){var u=l[0];u&&r.isObject(u)&&(p=u.ids,r.isArray(u.metaData)&&(g=u.metaData),s=!0)}else p=l.join(","),g=[],s=!0;s||(e.Lib.Errors.InvalidResultFormat(c),l="",g=[])},onError:function(){e.Lib.Errors.NetworkError(c),l="",g=[]}},r.mix(h,{headers:{"X-Requested-With":!1}}),e.navInfoSync.bFileSystem&&(h.crossDomain=!1),fr(h),0==c._errorCode?(p.length>0&&c._OnBitmapChanged(["c2",p,1,c._imageBufferWrapper.getCurrentImageIndex(),c._imageBufferWrapper.count(),g],null,i.currentFileName),r.isFunction(s)&&s()):r.isFunction(u)&&u(),l):!1}return c._innerSendBlobByWS(t,n,i,s,u),!0}},{key:"_convertToBase64ByServerIdsWithUI",value:function(e,t,n,i,o,a,s){return this._convertToBase64ByServerIdsWithUIAsync(e,n,t,i).then((function(e){r.isFunction(a)&&is(a,e)}),(function(){return r.isFunction(s)&&s(),!1})),!0}},{key:"_OnPercentDone",value:function(r){var t,n,i,o,a,s=this,u=!1,c=e.Lib,l=!1,d=0;c.isArray(r)&&r.length>2&&(n=r[0],d=r[1],i=r[2],r.length>3&&(o=r[3]),r.length>4&&(a=r[4]),r.length>5&&r[5],t=d,d<0?t=0:d>100&&(t=100),t=Math.floor(t),c.cancelFrom!=q.HTTPUpload&&c.cancelFrom!=q.HTTPDownload&&c.cancelFrom!=q.Scan||(l=a)),(s._bServerPercentDone||0==n)&&((d>0||0==d)&&(c.cancelFrom!=q.HTTPUpload&&c.cancelFrom!=q.HTTPDownload&&c.cancelFrom!=q.FTPUpload&&c.cancelFrom!=q.FTPDownload||(u=!0)),s.IfShowProgressBar&&c.progressBarOnPercentDone(d,i,o,t,l,this._containerElement),1==u&&(c.isFunction(s.__OnInternetTransferPercentage)&&s.__OnInternetTransferPercentage(t,!1),c.isFunction(s.__OnInternetTransferPercentageEx)&&s.__OnInternetTransferPercentageEx(t,!1)),c.isFunction(s.__OnPercentDone)&&s.__OnPercentDone())}},{key:"IfShowProgressBar",get:function(){return this._bIfShowProgressBar},set:function(e){this._resetErr(),r.isBoolean(e)?this._bIfShowProgressBar=e:r.Errors.InvalidValue(this)}},{key:"IfShowCancelDialogWhenImageTransfer",get:function(){return this.__IfShowCancelDialogWhenImageTransfer},set:function(e){this._resetErr(),r.isBoolean(e)?this.__IfShowCancelDialogWhenImageTransfer=e:r.Errors.InvalidValue(this)}},{key:"_getLogLevel",value:function(){return this._logLevel}},{key:"_setLogLevel",value:(v=ne(de.mark((function K(e){return de.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return this._logLevel=e,r.next=3,this._innerFunV2("LogLevel",kn(e));case 3:case"end":return r.stop()}}),K,this)}))),function(e){return v.apply(this,arguments)})},{key:"MaxUploadImageSize",get:function(){return this.__maxUploadImageSize},set:function(e){var t=this;t._resetErr();var n=1*e;!r.isNumber(n)||isNaN(n)?r.Errors.InvalidValue(t):t.__maxUploadImageSize=n}},{key:"HTTPRequestswithCredentials",get:function(){return this._resetErr(),this._bWithCredentials},set:function(e){this._resetErr(),r.isBoolean(e)?this._bWithCredentials=e:r.Errors.InvalidValue(this)}},{key:"cancelableObj",get:function(){return this._cancelableObj},set:function(e){this._cancelableObj=e}},{key:"_getProfile",value:(_=ne(de.mark((function J(e){var t,n;return de.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if((t=this)._resetErr(),t._isValid()){i.next=4;break}throw{code:t._errorCode,message:t._errorString};case 4:return e&&(n=r.stringify([e.strDevice])),i.abrupt("return",t._innerFunV2("GetCustomDSDataEx",n));case 6:case"end":return i.stop()}}),J,this)}))),function(e){return _.apply(this,arguments)})},{key:"_setProfile",value:(m=ne(de.mark((function Y(e,t){var n,i;return de.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if((n=this)._resetErr(),n._isValid()){o.next=4;break}throw{code:n._errorCode,message:n._errorString};case 4:return i=e?r.stringify([t,e.strDevice]):kn(t),o.abrupt("return",this._innerFunV2("SetCustomDSDataEx",i));case 6:case"end":return o.stop()}}),Y,this)}))),function(e,r){return m.apply(this,arguments)})},{key:"_removeAllImagesAsync",value:(p=ne(de.mark((function Z(e,r){var t,n,i,o,a,s;return de.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=this)._resetErr(),t._isValid()){e.next=4;break}throw{code:t._errorCode,message:t._errorString};case 4:for(i=[],a=t._getHowManyImagesInBuffer(),o=a-1;o>=0;o--)(s=t._imageBufferWrapper.convertClientIndexToServerId(o))>-1&&i.push(s);if(0!=i.length){e.next=13;break}return e.next=10,t._innerFunV2("RemoveAllImages");case 10:n=e.sent,e.next=23;break;case 13:if(!r){e.next=19;break}return e.next=16,t._innerFunV2("RemoveAllImages",kn(i.join(",")));case 16:n=e.sent,e.next=22;break;case 19:return e.next=21,t._innerFunV2("RemoveAllImages");case 21:n=e.sent;case 22:(n||-1033==t._errorCode)&&t._OnBitmapChanged(["0",i.join(","),3,t._imageBufferWrapper.getCurrentImageIndex(),t._imageBufferWrapper.count()]);case 23:return e.abrupt("return",n);case 24:case"end":return e.stop()}}),Z,this)}))),function(e,r){return p.apply(this,arguments)})},{key:"_OnReady",value:(g=ne(de.mark((function $(){var e,t;return de.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((e=this)._wsRetry=0,e._wsFailedTimes=0,r.detect.starting=!1,e._bRemoteMode||(r.detect.bOK=!0),e._bReady=!0,null!==(t=e._wsClient.ws)){n.next=9;break}return n.abrupt("return");case 9:t.onopen=null,e._wsClient.addEvent("close",e._clientId,(function(t){t&&r.log("websocket close: "+t),e.__bAcquireImageNow=!1,e._OnWSClose(t)})),e._wsClient.addEvent("error",e._clientId,(function(t){t&&r.log("websocket error: "+t),e.__bAcquireImageNow=!1,e._OnWSError(t)})),e._wsClient.addEvent("timeout",e._clientId,(function(t){t&&r.log("websocket timeout: "+t),e._OnWSTimeout(t)}));case 13:case"end":return n.stop()}}),$,this)}))),function(){return g.apply(this,arguments)})},{key:"_OnWSClose",value:function(t){var n,i,o,a,s=this;(s._bReady=!1,s._wsRetry=0,s._bRemoteMode)&&(n=null!==(i=null===(o=s.getServiceInfo())||void 0===o||null===(a=o.attrs)||void 0===a?void 0:a.name)&&void 0!==i?i:"");r.Errors.DynamsoftServiceStopped(s,n),s.__closeRemoteScanUI(!0),s._heartBeatTimer&&(clearTimeout(s._heartBeatTimer),s._heartBeatTimer=null),s._bNoMask||function(e){r.log("hideMask:"+e+"--"+Yn),Xn(),Yn=0}("websocket close"),s.__OnWSClose&&s.__OnWSClose();var u=s._bRemoteMode?e.Lib.product.RemoteReconnectMaxTimes:e.Lib.product.LocalReconnectMaxTimes;if(s._wsFailedTimes<u){var c=s._reconnectTimeSpan;s._wsFailedTimes<s._reconnectShortSpanTimes&&(c=s._reconnectShortSpan),s._heartBeatTimer=setTimeout((function(){A.startDWTReconnect(s)}),c)}}},{key:"_OnWSError",value:function(e){var r=this;r._bReady=!1,r.__OnWSError&&r.__OnWSError()}},{key:"_OnWSTimeout",value:function(t){var n,i,o,a,s=this;(s._bReady=!1,s._wsRetry=0,s._bRemoteMode)&&(n=null!==(i=null===(o=s.getServiceInfo())||void 0===o||null===(a=o.attrs)||void 0===a?void 0:a.name)&&void 0!==i?i:"");r.Errors.DynamsoftServiceStopped(s,n),s.__closeRemoteScanUI(!0),s._heartBeatTimer&&(clearTimeout(s._heartBeatTimer),s._heartBeatTimer=null);var u=s._bRemoteMode?e.Lib.product.RemoteReconnectMaxTimes:e.Lib.product.LocalReconnectMaxTimes;if(s._wsFailedTimes<u){var c=s._reconnectTimeSpan;s._wsFailedTimes<s._reconnectShortSpanTimes&&(c=s._reconnectShortSpan),s._heartBeatTimer=setTimeout((function(){A.startDWTReconnect(s)}),c)}}},{key:"_reconnected",value:(h=ne(de.mark((function ee(t){var n,i,o,a,s,u,c,l,d,f,h,g,p;return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=this)._wsFailedTimes=0,t.next=4,n._innerActiveUI(n._uuidForActiveUI);case 4:if(i=t.sent,o=!1,i&&(i.length>12?(n.__serverId=i[1],o=i[12]):i.length>8?(n.__serverId=i[1],o=i[8]):i.length>=2&&(n.__serverId=i[1])),n._bReady=!0,n._bRemoteMode||(r.detect.bOK=!0),r.detect.starting=!1,!o){t.next=20;break}return t.prev=11,t.next=14,n._removeAllImagesAsync("ActiveUI",!1);case 14:t.next=19;break;case 16:t.prev=16,t.t0=t["catch"](11),n._resetErr();case 19:r.Errors.DynamsoftServiceRestarted(n);case 20:if(t.prev=20,!n._blts){t.next=30;break}return a=n._bRemoteMode&&null!==(s=null===(u=n._dmService)||void 0===u||null===(c=u.attrs)||void 0===c?void 0:c.UUID)&&void 0!==s?s:"",t.next=25,wi(e.DWT.EnumInstance.dwt_desktop,a);case 25:return l=t.sent,t.next=28,n._setLTSLicenseAsync(l.ar);case 28:t.next=33;break;case 30:return d=r.product.refProductKey,t.next=33,n._setProductKeyAsync(d);case 33:t.next=39;break;case 35:throw t.prev=35,t.t1=t["catch"](20),n._bRemoteMode&&(g=null===(f=n._dmService)||void 0===f||null===(h=f.attrs)||void 0===h?void 0:h.name,p=r.Errors.LicenseNoCore(g,!1),n._errorCode=p.code,n._errorString=p.message),{code:n._errorCode,message:n._errorString};case 39:return t.prev=39,n._bRemoteMode&&A.startHeartBeat(n),t.finish(39);case 42:case"end":return t.stop()}}),ee,this,[[11,16],[20,35,39,42]])}))),function(e){return h.apply(this,arguments)})},{key:"__OnRecieveMsg",value:function(t,n){var i=this,o=null==n?void 0:n.cmd;if(t.event)return es(Te(A.prototype),"__OnRecieveMsg",this).call(this,t,n);if(e.DWT.ConnectWithSocket)return es(Te(A.prototype),"__OnRecieveMsg",this).call(this,t,n);if(Ae(t)?(i._errorCode=t.exception,i._errorString=t.description):"StartScan"!=o&&"GetAddOnVersion"!=o&&(i._errorCode=0,i._errorString=""),"ReadBarcode"==o||"OCRRecognize"==o||t.request&&"OCRProRecognize"==t.request.method)return n.sFun?(n.sFun(t),!0):(n.fFun&&n.fFun(t),!0);if("GetLicenseInfo"==o&&r.isArray(t.Detail))return n.sFun?(n.sFun(t),!0):(n.fFun&&n.fFun(t),!0);if("SetCapabilities"==o||"GetSkewAngleFromBinary"==o||"UpdateImage"==o)return"exception"in t&&"0"!=t.exception?(t.result.errorCode&&t.result.errorString?(i._errorCode=t.result.errorCode,i._errorString=t.result.errorString):(i._errorCode=t.exception,i._errorString=t.description),n.fFun&&n.fFun(t.result),t=null,!0):(n.sFun&&n.sFun(t.result),t=null,!0);if(t.result&&t.result.length&&("1"==t.result[0]||1==t.result[0]||"ok"==t.result[0]))return(n.sFun||n.sFun)&&n.sFun(t.result),!0;if(t.exception){var a=!1;n.fFun&&(a=n.fFun(i._errorString)),!a&&t.exception&&t.exception<0&&-2115!=t.exception&&r.isFunction(i.__OnPrintMsg)&&i.__OnPrintMsg(i._errorString)}else{if("LoadImage"==o||"LoadImageEx"==o||"LoadImageFromBytes"==o||"LoadImageFromBase64Binary"==o||"LoadDibFromClipboard"==o||"FTPDownload"==o||"FTPDownloadEx"==o)return n.sFun&&n.sFun(t.result),t=null,!0;n.fFun&&n.fFun(wn(["result:"],t.result))}return!0}},{key:"_handleEvent",value:function(e,t){var n=this,i=e.result[0],o=Be;return"OnBitmapChanged"==e.event?n._handleOnBitmapChangedEvent(e,t):(r.each(Jn.EVENTS,(function(t,i){if(e.event===t){var a=["_",t].join("");return o=Ve,r.isFunction(n[a])&&n[a](e.result,e),Be}})),o?(r.log("handled event:"+e.event),r.each(Jn.SEND_BACK_EVENTS,(function(t,o){if(e.event===t)return r.log("sendback event:"+e.event),n._innerSendByWS(e.event,kn(i),null,null,Ve),Be}))):(r.each(r.Addon_Events,(function(t,i){if(e.event===t){var a=["_",t].join("");return o=Ve,r.isFunction(n[a])&&n[a](e.result),Be}})),o&&(r.log("handled addon event:"+e.event),r.each(r.Addon_Sendback_Events,(function(t,o){if(e.event===t)return r.log("sendback addon event:"+e.event),n._innerSendByWS(e.event,kn(i),null,null,Ve),Be})))),o)}},{key:"_convertServerIdToGuid",value:function(e){return CR(e)}},{key:"_convertGuidToServerId",value:function(e){return wR(e)}},{key:"_innerConvertToBlobWithUI",value:function(e,t,n,i,o,a){var s=this,u=arguments,c=function(e){if(r.needShowTwiceShowDialog=!1,r.isFunction(a)){var t=[];r.isArray(n)&&r.each(n,(function(e){var r=s._imageBufferWrapper.convertServerIdToClientIndex(e);r>-1&&t.push(r)})),e&&(s._errorCode=e.code,s._errorString=e.message),a(t)}return!1};return s._innerConvertToArrayBufferWithUIAsync(e,t,n,i).then((function(e){if(!e||e.byteLength<=0)return r.Errors.ConvertBlobIsEmpty(s),c();var i=s.__maxUploadImageSize;if(e.byteLength>i&&-1!=i)return r.Errors.UploadExceededMaxSize(s),c();if(r.needShowTwiceShowDialog=!1,r.isFunction(o)){var a=[];r.isArray(n)&&r.each(n,(function(e){var r=s._imageBufferWrapper.convertServerIdToClientIndex(e);r>-1&&a.push(r)}));var l=Jn.getBlobTypeByImageType(t),d=new Blob([e],{type:l});try{o(d,a,u)}catch(f){}d=null}return!0}),c),!0}},{key:"convertToBlob",value:(f=ne(de.mark((function re(e,r,t){var n,i,o,a;return de.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return n=this,i=this._imageBufferWrapper.convertIndicesToServerIds(r),s.next=3,n._innerConvertToArrayBufferWithUIAsync("convertToBlob",e,i,t);case 3:return o=s.sent,a=Jn.getBlobTypeByImageType(e),s.abrupt("return",new Blob([o],{type:a}));case 6:case"end":return s.stop()}}),re,this)}))),function(e,r,t){return f.apply(this,arguments)})},{key:"_innerConvertToArrayBufferWithUIAsync",value:(d=ne(de.mark((function te(t,n,i,o,a){var s,u;return de.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return s=this,c.prev=1,s.IfShowProgressBar?r.showProgress(s,t,!1):r.hideProgress(),s._OnPercentDone([0,-1,e.MSG.Encoding]),c.next=6,this._innerConvertToArrayBufferAsync(n,i,o,a);case 6:u=c.sent;case 7:return c.prev=7,s.IfShowProgressBar&&r.closeProgress(null,t),c.finish(7);case 10:return c.abrupt("return",u);case 11:case"end":return c.stop()}}),te,this,[[1,,7,10]])}))),function(e,r,t,n,i){return d.apply(this,arguments)})},{key:"_innerConvertToArrayBufferAsync",value:(l=ne(de.mark((function ie(e,t,n,i){var o,a,s,u,c;return de.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return o=this,a=n,s=null!=i?i:"arraybuffer",u=",",r.isString(a)&&""!=a||(a="",u=""),c=["[",e,',"',t.join(","),'"',u,a,"]"].join(""),l.next=6,o._sendDataByHttpAsync("ConvertToBlob",c,s,!0);case 6:return l.abrupt("return",l.sent);case 7:case"end":return l.stop()}}),ie,this)}))),function(e,r,t,n){return l.apply(this,arguments)})},{key:"_convertToBase64ByServerIdsWithUIAsync",value:(c=ne(de.mark((function oe(t,n,i,o){var a,s,u,c,l,d,f,h,g,p;return de.wrap((function(m){for(;;)switch(m.prev=m.next){case 0:return a=this,m.prev=1,a.IfShowProgressBar?r.showProgress(a,t,!1):r.hideProgress(),a._OnPercentDone([0,-1,e.MSG.Encoding]),s=o,r.isString(s)&&""!=s||(s="{}"),u=["[",n,',"',i.join(","),'",',s,",1]"].join(""),m.next=9,a._sendDataByHttpAsync("ConvertToBase64",u,"text",!0);case 9:if(c=m.sent,l=0,d="",f="",h=c&&c.result,g=[],r.isArray(i)&&r.each(i,(function(e){var r=a._imageBufferWrapper.convertServerIdToClientIndex(e);r>-1&&g.push(r)})),0==a._errorCode){m.next=14;break}throw{code:a._errorCode,message:a._errorString};case 14:if(!h||!r.isArray(h)||3!=h.length){m.next=22;break}return f=h[0],l=h[1],d=h[2],p=new ns(null,l,d,f),m.abrupt("return",p);case 22:throw r.Errors.ConvertBase64Failed(a),{code:a._errorCode,message:a._errorString};case 24:return m.prev=24,a.IfShowProgressBar&&r.closeProgress(null,t),m.finish(24);case 27:case"end":return m.stop()}}),oe,this,[[1,,24,27]])}))),function(e,r,t,n){return c.apply(this,arguments)})},{key:"_convertToBlobForUpload",value:function(t,n,i,o,a,s,u){var c=this,l=arguments;if(e.DWT.ConnectWithSocket){var d=i,f=",";r.isString(d)&&""!=d||(d="",f="");var h=["[",t,',"',n.join(","),'"',f,d,"]"].join("");return c._sendData("ConvertToBlob",h,!0,(function(e){c._resetErr();var r=e;if(r){if(r instanceof Blob||Dn(r))return void a(r,"",l);Ae(r)&&(c._errorCode=r.exception,c._errorString=r.description)}}),(function(e){c._errorCode=e.code,c._errorString=e.message,s(e)})),!0}return c._innerConvertToArrayBufferAsync(t,n,i,"arraybuffer").then((function(t){var n=c._strHttpContentTypeFieldValue,i=new Blob([t],{type:n});if(e.DWT.IfAddMD5InUploadHeader){var o=new kR.ArrayBuffer;o.append(t),r.isFunction(a)&&a(i,o.end(),l)}else r.isFunction(a)&&a(i,"",l);i=null}),(function(e){s(e.code,e.message)}))}},{key:"dispose",value:function(){return this.__unload()}},{key:"_innerDisposeWSClient",value:function(){return this._isValid()?this._sendData("dispose",null,!0,(function(){}),(function(){})):r.Promise.reject()}},{key:"__unload",value:(u=ne(de.mark((function ae(){var e;return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e=this)._bReady||r.page.bUnload){t.next=10;break}if(!e._wsClient){t.next=10;break}return t.prev=3,t.next=6,e._innerDisposeWSClient();case 6:t.next=10;break;case 8:t.prev=8,t.t0=t["catch"](3);case 10:e._wsClient&&(e._wsClient.removeEvent("close",e._clientId),e._wsClient.removeEvent("error",e._clientId),e._wsClient.removeEvent("timeout",e._clientId),e._wsClient.dispose(),delete e._wsClient,e._wsClient=null),this._imageBufferWrapper.dispose(),this._bReady=Be,this._destroy=Ve;case 14:case"end":return t.stop()}}),ae,this,[[3,8]])}))),function(){return u.apply(this,arguments)})},{key:"_getImages",value:(s=ne(de.mark((function se(t,n,i,o){var a,s,u;return de.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(r.isArray(n)){c.next=3;break}throw r.Errors.IndicesNotArray(this),{code:this._errorCode,message:this._errorString};case 3:if(0!=n.length){c.next=6;break}throw r.Errors.IndicesCannotEmpty(this),{code:this._errorCode,message:this._errorString};case 6:if(o!=bR.url){c.next=12;break}if(!(n.length>1)){c.next=10;break}throw r.Errors.GetImagesByURLMoreThanOne(this),{code:this._errorCode,message:this._errorString};case 10:c.next=16;break;case 12:if(i!=e.DWT.EnumDWT_ImageType.IT_BMP&&i!=e.DWT.EnumDWT_ImageType.IT_JPG&&i!=e.DWT.EnumDWT_ImageType.IT_PNG){c.next=16;break}if(!(n.length>1)){c.next=16;break}throw r.Errors.GetImagesIndexMoreThanOne(this),{code:this._errorCode,message:this._errorString};case 16:if(o!=bR.url){c.next=20;break}return c.abrupt("return",this._imageBufferWrapper.getImageUrl(n[0]));case 20:if(a=this._imageBufferWrapper.convertIndicesToServerIds(n),o!=bR.blob){c.next=29;break}return c.next=24,this._innerConvertToArrayBufferWithUIAsync(t,i,a);case 24:return s=c.sent,u=Jn.getBlobTypeByImageType(i),c.abrupt("return",new Blob([s],{type:u}));case 29:if(o!=bR.base64){c.next=33;break}return c.next=32,this._convertToBase64ByServerIdsWithUIAsync(t,i,a);case 32:return c.abrupt("return",c.sent);case 33:throw r.Errors.InvalidImageFormatType(this),{code:this._errorCode,message:this._errorString};case 35:case"end":return c.stop()}}),se,this)}))),function(e,r,t,n){return s.apply(this,arguments)})},{key:"_LicensePromptExpired",value:function(){var t=this,n=t.__licenseInfo.bTrial,i="";t.__licenseInfo&&t.__licenseInfo.ExpireDate&&(i=t.__licenseInfo.ExpireDate);var o=BR(i);o<=0&&r.isFunction(e.OnLicenseExpiredWarning)&&e.OnLicenseExpiredWarning(i,o,n)}},{key:"__saveToViewerAfterUpdate",value:function(e,t){var n=this,i=this,o=this._imageBufferWrapper.getIndexByUid(e),a=this._imageBufferWrapper.convertClientIndexToServerId(o),s=Rs.getUrlByAct(this._imageBufferWrapper.BaseUrl,a,2);return new r.Promise((function(e,r){fr({method:"GET",xhrFields:{withCredentials:!0},url:s,onSuccess:function(r){var s=i._imageBufferWrapper.getMetadataByIndex(o);s||(s={}),s.width=t.width,s.height=t.height;var u=i._imageBufferWrapper.getImageIdMap(a);u.ticks=Date.now(),u.imageUrl=n._imageBufferWrapper.getImageUrl(o),u.minImageUrl=n._imageBufferWrapper.getMinImageUrl(o),u.width=t.width,u.height=t.height,i._imageBufferWrapper.UpdateImage(u,s),e()},onError:function(){e(),Qn("save")}})}))}},{key:"getHeartBeatData",value:function(e){var r,t=Gn(this._clientId,e.cmd,null,e.cmdId),n=t.length,i=n,o=new ArrayBuffer(12+i),a=new DataView(o);for(r=0;r<8&&i;r++)a.setUint8(r,i%256),i=Math.floor(i/256);for(r=0;r<4&&n;r++)a.setUint8(8+r,n%256),n=Math.floor(n/256);for(r=0;r<t.length;r++)a.setUint8(12+r,t.charCodeAt(r));return o}}],[{key:"create",value:(a=ne(de.mark((function ue(e){var r;return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=new A(e),t.next=3,A.STwainConnectToServer(r);case 3:return t.abrupt("return",r);case 4:case"end":return t.stop()}}),ue)}))),function(e){return a.apply(this,arguments)})},{key:"STwainConnectToServer",value:(o=ne(de.mark((function ce(t){var n,i;return de.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(n=t._id,!e.DWT.WebTwainIdMap[n]){o.next=5;break}return o.next=4,t._OnReady();case 4:return o.abrupt("return");case 5:if(!t._bReady&&!t._destroy){o.next=7;break}return o.abrupt("return");case 7:return t._bConnecting=!0,(i=dt.Instance.getClient(t._serverInfo)).setRetry(0),Zn("",t),o.prev=11,o.next=14,fo(t._bRemoteMode);case 14:return o.next=17,i.testConnection(void 0,0,void 0,1e4);case 17:if(t._wsClient=i,t._wsClient.bReady=!0,r.detect.bFirst&&(vR(),r.detect.bFirst=!1),t._bReady){o.next=24;break}return t._bReady=!0,o.next=24,t._OnReady();case 24:o.next=30;break;case 26:throw o.prev=26,o.t0=o["catch"](11),t._bReady=!1,{code:t._errorCode,message:t._errorString};case 30:return o.prev=30,t._bConnecting=!1,Qn(""),o.finish(30);case 34:case"end":return o.stop()}}),ce,null,[[11,26,30,34]])}))),function(e){return o.apply(this,arguments)})},{key:"startDWTReconnect",value:(i=ne(de.mark((function le(e){var r;return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!e._destroy){t.next=3;break}return t.abrupt("return");case 3:return e._bConnecting=!0,(r=dt.Instance.getClient(e._serverInfo)).setRetry(0),t.next=9,r.testConnection(void 0,0,void 0,3e4);case 9:return e._wsClient=r,e._wsClient.bReady=!0,e._wsRetry=0,t.next=14,e._reconnected(r);case 14:t.next=19;break;case 16:t.prev=16,t.t0=t["catch"](0),e._wsFailedTimes++;case 19:return t.prev=19,e._bConnecting=!1,t.finish(19);case 22:case"end":return t.stop()}}),le,null,[[0,16,19,22]])}))),function(e){return i.apply(this,arguments)})},{key:"startHeartBeat",value:function(e){var r=e._wsClient;r&&r.connected&&!r._bHeartBeatStarted&&(r._bHeartBeatStarted=!0,setTimeout((function(){A._innerSendHeartBeat(e,!0)}),r._heartBeatTicks))}},{key:"_innerSendHeartBeat",value:(n=ne(de.mark((function fe(e,r){var t,n,i,o;return de.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,!e.__bAcquireImageNow){a.next=4;break}a.next=14;break;case 4:if(t={client:null,userData:null,taskId:"0",eventTaskId:"0",lastEventTaskId:"0"},n=Ln(),i={cmd:"Heartbeat",cmdId:n,sFun:null,fFun:null,contextData:null,rawData:!0},o=e.getHeartBeatData(i),!e._wsClient){a.next=12;break}return e._wsClient.setRetry(0),a.next=12,e._wsClient.request(o,null,t);case 12:i=null,o=null;case 14:a.next=18;break;case 16:a.prev=16,a.t0=a["catch"](0);case 18:e._wsClient&&e._wsClient.connected&&r&&setTimeout((function(){A._innerSendHeartBeat(e,r)}),e._wsClient._heartBeatTicks);case 19:case"end":return a.stop()}}),fe,null,[[0,16]])}))),function(e,r){return n.apply(this,arguments)})}]),A}(nR);function LR(t){var n,i=this,o=t;return i._resetErr(),i._isValid()?(o=r.isString(o)?r.trim(o):"",n=i._sendDataByHttpAsync("ProductKey",kn(o)),i.__productKey=o,n=n.then((function(t){if(e.Lib.isArray(t)&&t.length>0){if(0!=i._errorCode)throw i.__productKey="",{code:i._errorCode,message:i._errorString};e.DWT.ProductKey=i.__productKey,r.License.reparseProductKey();var o="GetLicenseInfo";return e.DWT.ConnectWithSocket?i._sendDataConnectWithSocket(o,null,"json",!0):i._sendDataByHttpAsync(o,null,"json",!0)}throw r.Errors.LicenseEmptyOrInvalid(i),n.context=null,{code:i._errorCode,message:i._errorString}})),n):r.Promise.reject({code:i._errorCode,message:i._errorString})}function NR(e){return MR.apply(this,arguments)}function MR(){return(MR=ne(de.mark((function e(t){var n;return de.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=this)._resetErr(),n._isValid()){e.next=4;break}return e.abrupt("return",r.Promise.reject({code:n._errorCode,message:n._errorString}));case 4:if(t&&t instanceof ss){e.next=7;break}throw r.Errors.InvalidParameter(n),{code:n._errorCode,message:n._errorString};case 7:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function UR(t,n){if(n){var i=n.code||n.ltsErrorCode,o=n.message;111==i||106==i||108==i?(r.Errors.LicenseNoCore(t,!1,i),111!=i||e.DWT.isPublicLicense()||(t._errorString=o)):(t._errorCode=i,t._errorString=o),e.DWT.lsetException(t._errorCode,t._errorString,!0)}}function BR(e){if(""==e)return 65536;var r=vo(e),t=(new Date).getTime(),n=(r.getTime()-t)/864e5;return r.getTime()<t?0:Math.ceil(n)}function VR(t){var n=t,i="",o=!1;if(n.__licenseInfo&&(n.__licenseInfo.ExpireDate&&(i=n.__licenseInfo.ExpireDate),o=n.__licenseInfo.bTrial),o&&!e.DWT.HideTrialMessage){var a=BR(i);a<=5&&(r.isFunction(e.OnLicenseExpiredWarning)&&e.OnLicenseExpiredWarning(i,a,!0),e.DWT.HideTrialMessage=!0)}}var GR={changeImageUISize:function(e,t,n){var i,o,a,s,u=t,c=n,l=Be;i=r.one(e._containerElement),r.isString(t)&&t.indexOf("%")>=0?(0==(a=r.css(i,"width"))&&(i[0].style.width="100%"),a=r.css(i,"width")*parseInt(t)/100,l=Ve):u=[(a=parseInt(t))+2,"px"].join(""),r.isString(n)&&n.indexOf("%")>=0?(0==(s=r.css(i,"height"))&&(i[0].style.height="100%"),s=r.css(i,"height")*parseInt(n)/100,l=Ve):c=[(s=parseInt(n))+2,"px"].join(""),i&&(o=r.one(".dynamsoft-dwt-container-box",i))&&o.getEL()&&(o.style("width",u),o.style("height",c)),l?(e.__funResize||(e.__funResize=function(){if(e._ImgManager&&e._containerElement){var r=GR.__innerGetUIViewRealSize(e._containerElement,e._width,e._height);return e._UIView.ChangeSize(r.width,r.height)}return Ve}),r.removeEventListener(window,"resize",e.__funResize),r.addEventListener(window,"resize",e.__funResize)):e.__funResize&&(r.removeEventListener(window,"resize",e.__funResize),e.__funResize=Be);var d=GR.__innerGetUIViewRealSize(e._containerElement,a,s);return e._ImgManager?e._UIView.ChangeSize(d.width,d.height):Ve},__innerGetUIViewRealSize:function(e,t,n){var i,o=-1,a=-1;return i=r.one(e),r.isString(t)&&t.indexOf("%")>=0&&(o=r.css(i,"width")*parseInt(t)/100),o<0&&t&&(o=parseInt(t)),r.isString(n)&&n.indexOf("%")>=0&&(a=r.css(i,"height")*parseInt(n)/100),a<0&&n&&(a=parseInt(n)),{width:o,height:a}},bindUIViewEvents:function(e,t){var n=e;t.onSelected=function(e){if(!n._isNoViewer()){var t,i=e.length;i>0&&(n._ImgManager.SetSelectedImageCount(i),t=e[i-1],!0,r.isFunction(n.__OnRefreshUI)&&n.__OnRefreshUI(t))}},t.onRefreshUI=function(e){n._isNoViewer()||GR.__innerRefreshFromUIView(n,e)},t.onResetCurrentIndex=function(e){if(!n._isNoViewer()){var t=n._ImgManager.getCurrentImageIndex();if(e>=0&&e<n._ImgManager.count()&&t!=e&&r.isFunction(n.__OnIndexChangeDuringDragDrop))try{n.__OnIndexChangeDuringDragDrop(t,e)}catch(i){Le(i)}}},t.onMouseMove=function(e){if(!n._isNoViewer()){var t=e.index;if(e){var i=e.x,o=e.y;n.__MouseX=i,n.__MouseY=o}if(r.isFunction(n.__OnMouseMove))try{n.__OnMouseMove(t)}catch(a){Le(a)}}},t.onMouseClick=function(e){if(!n._isNoViewer()){var t=e.index;if(e){var i=e.x,o=e.y;n.__MouseX=i,n.__MouseY=o}if(r.isFunction(n.__OnMouseClick))try{n.__OnMouseClick(t)}catch(a){Le(a)}}},t.onMouseDoubleClick=function(e){if(!n._isNoViewer()){var t=e.index;if(r.isFunction(n.__OnMouseDoubleClick))try{n.__OnMouseDoubleClick(t)}catch(i){Le(i)}}},t.onMouseRightClick=function(e){if(!n._isNoViewer()){var t=e.index;if(e){var i=e.x,o=e.y;n.__MouseX=i,n.__MouseY=o}if(r.isFunction(n.__OnMouseRightClick))try{return n.__OnMouseRightClick(t)}catch(a){Le(a)}return Ve}},t.onImageAreaSelected=function(e){if(!n._isNoViewer()&&r.isFunction(n.__OnImageAreaSelected))try{n.__OnImageAreaSelected(e.index,e.left,e.top,e.right,e.bottom,e.areaIndex)}catch(t){Le(t)}},t.onImageAreaDeSelected=function(e){if(!n._isNoViewer()&&r.isFunction(n.__OnImageAreaDeSelected))try{n.__OnImageAreaDeSelected(e)}catch(t){Le(t)}},t.onBufferChanged=function(e){if(r.isFunction(n.__OnBufferChanged))try{n.__OnBufferChanged(e)}catch(t){Le(t)}}},__innerRefreshFromUIView:function(e,t){var n=e;r.isFunction(n.__OnRefreshUI)&&n.__OnRefreshUI(t)}};function jR(e,r,t){r in e||Object.defineProperty(e,r,t)}var HR,zR=function(){function e(r){X(this,e);var t=this;t._parent=r,jR(t,"width",{get:function(){return this._parent._width},set:function(e){this.SetSize(e,!1)}}),jR(t,"height",{get:function(){return this._parent._height},set:function(e){this.SetSize(!1,e)}})}return Q(e,[{key:"SetSize",value:function(e,t){var n,i=this._parent,o=!1,a=!1;return!!i._isBindViewer()&&(r.isString(e)&&e.length>0&&"%"===e.charAt(e.length-1)&&(o=e),!o&&e&&(n=parseInt(e))&&(o=n+"px"),r.isString(t)&&t.length>0&&"%"===t.charAt(t.length-1)&&(a=t),!a&&t&&(n=parseInt(t))&&(a=n+"px"),o&&(i._width=o),a&&(i._height=a),GR.changeImageUISize(i,o,a))}}]),e}();!function(e){e.normal=0,e.balance=1}(HR||(HR={})),e.DWT.EnumDWT_WorkMode=HR;var KR=Rs;e.DWT;var qR={background:"#434246",topMenuBorder:"",innerBorder:"",promptToSaveChange:!0,buttons:e.Lib.product.CustomizableDisplayInfo.buttons,dialogText:e.Lib.product.CustomizableDisplayInfo.dialogText},XR=function(){function n(e,r){X(this,n);var t=this;t._stwain=e,t._ImgManager=e._ImgManager,t.zoomInStep=1.2,t.zoomOutStep=.8,t.MIN_ZOOM=.02,t.MAX_ZOOM=65,t.MAX_ROWS=128,t.MAX_COLUMNS=128,t.__MousewheelValue=0,this._Init(r)}var i;return Q(n,[{key:"_Init",value:function(t){var n=this;if(n.borderWidth=r.isUndefined(t.borderWidth)?1:t.borderWidth,t.BackgroundColor?n.BackgroundColorByDefault=t.BackgroundColor:n.BackgroundColorByDefault="#FFFFFF",t.BackgroundColor=n.BackgroundColorByDefault,n.BackgroundFillColor=n.BackgroundColorByDefault,t.onTopImageInTheViewChanged=function(r){e.Lib.isFunction(n._stwain.__OnTopImageInTheViewChanged)&&n._stwain.__OnTopImageInTheViewChanged(r.index,r.bByScrollBar)},t.onGetImageInfo=function(e){return{width:n._stwain.GetImageWidth(e),height:-1}},!n._stwain._viewer&&e.DWT.UseDefaultViewer){var i={viewerContainer:{},viewerEvents:{topPageChanged:function(e,r){n.__topPageChanged(e,r,n)},click:function(e){n.__click(e,n)},rightclick:function(e){n.__rightclick(e,n)},dblclick:function(e){n.__dblclick(e,n)},mousemove:function(e){n.__mousemove(e,n)},pageAreaSelected:function(e,r){n.__pageAreaSelected(e,r,n)},pageAreaUnselected:function(e){n.__pageAreaUnselected(e,n)},dragdone:function(e){n.__dragdone(e,n)},onDrop:function(e){n.__onDrop(e,n)},pageChange:function(e){n.__pageChange(e,n)},bufferChanged:function(e,r){n.__bufferChanged(n,e,r)},onBind:function(e){n.__onBindViewer(e)},onUnBind:function(e){n.__onUnBindViewer(e)},save:function(e,r,t,i){return n.__save(n,e,r,t,i)}},viewerError:{setError:function(e,r){n.__setError(e,r,n)}},imageEditorEvents:{acquire:function(){n.__acquire(n)},loadImage:function(){n.__loadImage(n)},deskew:function(e,r){n.__deskew(n,e,r)},removeImage:function(){n.__remove(n)},removeAllImage:function(){n.__removeAll(n)},close:function(){n.__close(n)}},imageEditorServerCallback:{rotateRight:function(){n.__rotateRightForServer(n)},rotate:function(e,r,t){n.__rotateForServer(n,e,r,t)},rotateLeft:function(){n.__rotateLeftForServer(n)},deskew:function(e){n.__deskewForServer(n)},crop:function(e){n.__cropForServer(n,e)},erase:function(e){n.__eraseForServer(n,e)},changeImageSize:function(e,r,t){n.__changeImageSizeForServer(n,e,r,t)},flip:function(){n.__flipForServer(n)},mirror:function(){n.__mirrorForServer(n)},restore:function(e){n.__restoreForServer(n,e)},save:function(e){return n.__saveForServer(n,e)}}};t.Container&&(r.isNodeList(t.Container)||r.isArray(t.Container)&&t.Container.length>0)&&(i.viewerContainer={container:t.Container[0],width:t.Width,height:t.Height}),n._stwain._viewer=new e.DWTViewer($A._getBuffer(n._ImgManager),i)}else t.Container&&(r.isNodeList(t.Container)||r.isArray(t.Container)&&t.Container.length>0)&&n.__onBindViewer(t.Container[0]);n.__InitEvents(t)}},{key:"dispose",value:function(){this._stwain._viewer}},{key:"__InitEvents",value:function(e){var t=this;r.isFunction(e.onTopImageInTheViewChanged)&&(t.onTopImageInTheViewChanged=e.onTopImageInTheViewChanged),r.isFunction(e.onGetImageInfo)&&(t.onGetImageInfo=e.onGetImageInfo),r.isFunction(e.onZoomChanged)&&(t.onZoomChanged=e.onZoomChanged),r.isFunction(e.onMouseMove)&&(t.onMouseMove=e.onMouseMove),r.isFunction(e.onMouseClick)&&(t.onMouseClick=e.onMouseClick),r.isFunction(e.onMouseRightClick)&&(t.onMouseRightClick=e.onMouseRightClick),r.isFunction(e.onMouseDoubleClick)&&(t.onMouseDoubleClick=e.onMouseDoubleClick),r.isFunction(e.onImageAreaDeSelected)&&(t.onImageAreaDeSelected=e.onImageAreaDeSelected),r.isFunction(e.onImageAreaSelected)&&(t.onImageAreaSelected=e.onImageAreaSelected),r.isFunction(e.onBufferChanged)&&(t.onBufferChanged=e.onBufferChanged),r.isFunction(e.onSelected)&&(t.onSelected=e.onSelected),r.isFunction(e.onRefreshUI)&&(t.onRefreshUI=e.onRefreshUI),r.isFunction(e.onResetCurrentIndex)&&(t.onResetCurrentIndex=e.onResetCurrentIndex)}},{key:"GetWebViewer",value:function(){return this._stwain._viewer}},{key:"SetSelectedImageArea",value:function(e,r,t,n){if(null!=this.GetWebViewer()){var i=[],o={};return o.left=e,o.top=r,o.right=t,o.bottom=n,i.push(o),this.GetWebViewer().setSelectedAreas(i)}return!1}},{key:"OverlayRectangle",value:function(e,r,t,n,i,o,a){var s=this;return!!s._stwain._isNoViewer()||null!=s.GetWebViewer()&&s.GetWebViewer().webViewer.overlayRectangle(e,r,t,n,i,o,a)}},{key:"ChangeImageViewSize",value:function(e,r){var t=this;return e>=0&&(t.GetWebViewer().width,t.GetWebViewer().width=e),r>=0&&(t.GetWebViewer().height,t.GetWebViewer().height=r),!0}},{key:"ChangeSize",value:function(e,r){var t=this;return t.GetWidth()!=e&&t.SetWidth(e),t.GetHeight()!=e&&t.SetHeight(e),!0}},{key:"GetWidth",value:function(){return this.GetWebViewer().width}},{key:"SetWidth",value:function(e){var r=e;return this._stwain._isNoViewer()||(this.GetWebViewer().width=r),!0}},{key:"GetHeight",value:function(){return this.GetWebViewer().height}},{key:"SetHeight",value:function(e){var r=e;return this._stwain._isNoViewer()||(this.GetWebViewer().height=r),!0}},{key:"SetViewMode",value:function(e,r){var t=this;return t._stwain._isNoViewer()?t._stwain._nouiNotSupport("SetViewMode"):t.GetWebViewer().setViewMode(e,r)}},{key:"SetIfFitWindowAndType",value:function(e){var r;if(null!=this.GetWebViewer()){switch(e){case 1:r="height";break;case 2:r="width";break;default:r="window"}this.GetWebViewer().fitWindow(r)}return!0}},{key:"GetAllowMultiSelect",value:function(){return!this._stwain._isNoViewer()&&this.GetWebViewer().selectionMode}},{key:"SetAllowMultiSelect",value:function(e){var r=this;return r._stwain._isNoViewer()||(r.GetWebViewer().selectionMode=e?1:0),!0}},{key:"GetFitWindowType",value:function(){return this._stwain._isNoViewer(),0}},{key:"SetSelectionRectAspectRatio",value:function(e){return this.GetWebViewer().selectionRectAspectRatio=e,!0}},{key:"GetSelectionRectAspectRatio",value:function(){return this.GetWebViewer().selectionRectAspectRatio}},{key:"SetFitWindowType",value:function(e){return this._stwain._isNoViewer()||this.SetIfFitWindowAndType(e),!0}},{key:"GetIfFitWindow",value:function(){return this._stwain._isNoViewer(),!0}},{key:"SetIfFitWindow",value:function(e){var r=this;return r._stwain._isNoViewer()||(e?r.GetWebViewer().fitWindow("window"):r.GetWebViewer().zoom=1),!0}},{key:"GetImageMargin",value:function(){return this._stwain._isNoViewer()?0:this.GetWebViewer().pageMargin}},{key:"SetImageMargin",value:function(e){return this._stwain._isNoViewer()||(this.GetWebViewer().pageMargin=e),!0}},{key:"GetSelectionImageBorderColor",value:function(){return this.GetWebViewer().selectedPageBorder}},{key:"SetSelectionImageBorderColor",value:function(r){var t=r;return e.Lib.isNumber(t)&&(t=e.Lib.getColor(t)),-1==t.indexOf("1px solid")&&(t="1px solid "+t),this.GetWebViewer().selectedPageBorder=t,!0}},{key:"GetZoom",value:function(){return this.GetWebViewer().zoom}},{key:"SetZoom",value:function(e,r,t){var n=this;return e<n.MIN_ZOOM&&(e=n.MIN_ZOOM),e>n.MAX_ZOOM&&(e=n.MAX_ZOOM),null!=n.GetWebViewer()&&(n.GetWebViewer().zoom=e),!0}},{key:"ZoomIn",value:function(r,n){var i=this,o=i._ImgManager.getImageIdMap(i._ImgManager.convertClientIndexToServerId(i._ImgManager.getCurrentImageIndex())),a=i.GetWebViewer().zoom,s=Math.floor(100*a*i.zoomInStep)+1;return 1<s&&s<2501?t(o.imageWidth*a)>15e3||t(o.imageHeight*a)>15e3?(Rs.output(i,e.Lib.product.CustomizableDisplayInfo.errorMessages.limitReachedForZoomIn),alert(e.Lib.product.CustomizableDisplayInfo.errorMessages.limitReachedForZoomIn),!1):(i.SetZoom(s/100,r,n),!0):(Rs.output(i,e.Lib.product.CustomizableDisplayInfo.errorMessages.limitReachedForZoomIn),alert(e.Lib.product.CustomizableDisplayInfo.errorMessages.limitReachedForZoomIn),!1)}},{key:"ZoomOut",value:function(){var r=this,t=r.GetWebViewer().zoom,n=Math.floor(100*t*r.zoomOutStep)-1;return 1<n&&n<6501?(r.SetZoom(n/100),!0):(Rs.output(r,e.Lib.product.CustomizableDisplayInfo.errorMessages.limitReachedForZoomOut),alert(e.Lib.product.CustomizableDisplayInfo.errorMessages.limitReachedForZoomOut),!1)}},{key:"GetMouseShape",value:function(){return this._stwain._isNoViewer()?0:"crosshair"!=this.GetWebViewer().cursor}},{key:"SetMouseShape",value:function(e){var r=this;return r._stwain._isNoViewer()||(r.GetWebViewer().cursor=e?"pointer":"crosshair"),!0}},{key:"GetShowPageNumber",value:function(){return!this._stwain._isNoViewer()&&this.GetWebViewer().showPageNumber}},{key:"SetShowPageNumber",value:function(e){return this._stwain._isNoViewer()||(this.GetWebViewer().showPageNumber=e),!0}},{key:"SetBackgroundFillColor",value:function(e){var r=e;return this.BackgroundFillColor=r,!0}},{key:"GetBackgroundColor",value:function(){return this.GetWebViewer().background}},{key:"SetBackgroundColor",value:function(e){var r=e;return this._stwain._isNoViewer()||(this.GetWebViewer().background=r),!0}},{key:"Go",value:function(e){return this.GetWebViewer().gotoPage(e)}},{key:"__Previous",value:function(){return this.Go(this._ImgManager.getCurrentImageIndex()-1),!0}},{key:"__Next",value:function(){return this.Go(this._ImgManager.getCurrentImageIndex()+1),!0}},{key:"__fireEvent",value:function(e,t){if(r.isFunction(this[e]))try{return this[e](t)}catch(n){Le(n)}return!0}},{key:"GetIfAutoScroll",value:function(){return this.GetWebViewer().ifAutoScroll}},{key:"SetIfAutoScroll",value:function(e){return this.GetWebViewer().ifAutoScroll=e,!0}},{key:"BindView",value:function(e){var t,n=e;return r.isString(e)?n=r.get(e):r.isDOM(n)&&(n.id&&""!=n.id||(n.id=["dwt_",r.getRandom()].join(""))),(t=this.GetWebViewer().bind(n))&&this.GetWebViewer().show(),t}},{key:"GetIfShowVideoContainer",value:function(){var t=this,n=t.GetWebViewer();return r.isUndefined(n)?(e.DWT.UseDefaultViewer?r.Errors.CannotDoWhenNoViewer(t._stwain):r.Errors.CannotDoWhenNoViewerJS(t._stwain),!1):n.webViewer.getIfShowVideoContainer()}},{key:"ShowVideoContainer",value:function(t){var n=this,i=n.GetWebViewer();return r.isUndefined(i)?(e.DWT.UseDefaultViewer?r.Errors.CannotDoWhenNoViewer(n._stwain):r.Errors.CannotDoWhenNoViewerJS(n._stwain),!1):i.webViewer.showVideoContainer(t)}},{key:"UpdateVideoContainer",value:function(t){var n=this,i=n.GetWebViewer();return r.isUndefined(i)?(e.DWT.UseDefaultViewer?r.Errors.CannotDoWhenNoViewer(n._stwain):r.Errors.CannotDoWhenNoViewerJS(n._stwain),!1):i.webViewer.updateVideoImage(t)}},{key:"ClearSelectedAreas",value:function(){var e=this.GetWebViewer();if(e)return e.clearSelectedAreas()}},{key:"OnCloseImageEditor",value:function(){return!!this.GetWebViewer().webViewer.imageEditor&&(this.GetWebViewer().createImageEditor().dispose(),!0)}},{key:"ShowImageEditorEx",value:function(t,n,i,o,a,s,u,c){var l=this;if(this._stwain._isNoViewer())return l._stwain._nouiNotSupport("ShowImageEditorEx");switch(a){case 0:case 1:case 2:break;case 3:if(l.OnCloseImageEditor())return!0}var d,f=document;if(l._stwain._containerElement==u&&(s=!1),u){var h=e.DWT.ContainerMap;if(h){var g,p=Object.keys(h);for(g=0;g<p.length;g++)if(p[g]==u.id){s=!1;break}}}if(s&&u&&(r.isDOM(u)?d=u:r.isShadowRoot(u)?(d=document.createElement("div"),u.appendChild(d)):(d=f.getElementById(u))&&"DIV"!=d.nodeName&&(s=!1)),s&&u&&r.isDOM(u)){var m=r.getShadowRoot(u);if(m){var _,v,y=e.Lib.timestamp;return(_=f.createElement("link")).href=[e.DWT.ResourcesPath,"/src/dynamsoft.webtwain.viewer.css",y].join(""),_.rel="stylesheet",_.async=!0,(v=f.createElement("link")).href=[e.DWT.ResourcesPath,"/src/dynamsoft.webtwain.css",y].join(""),v.rel="stylesheet",v.async=!0,r.scriptOnload(_,(function(){r.scriptOnload(v,(function(){return l.ShowImageEditor(d,s,i,o)})),m.appendChild(v)})),m.appendChild(_),!0}}return l.ShowImageEditor(d,s,i,o)}},{key:"ShowImageEditor",value:function(e,r,t,n){var i=this;return e&&t&&n?(qR.element=e,qR.width=t,qR.height=n):(qR.element=undefined,qR.width=undefined,qR.height=undefined),qR.border=i.GetWebViewer().border,qR.selectionRectAspectRatio=i.GetWebViewer().selectionRectAspectRatio,qR.workMode=HR.normal,i.GetWebViewer().createImageEditor(qR),0!=i._stwain.ErrorCode&&(i.GetWebViewer().webViewer.imageEditor&&i.GetWebViewer().webViewer.imageEditor.dispose(),i.GetWebViewer().createImageEditor(qR)),i.GetWebViewer().webViewer.imageEditor&&i.GetWebViewer().webViewer.imageEditor.show(),!0}},{key:"__topPageChanged",value:function(e,r,t){t.__fireEvent("onTopImageInTheViewChanged",{index:e,bByScrollBar:r})}},{key:"__click",value:function(e,r){var t=r;t.__fireEvent("onMouseClick",{e:e,x:e.imageX,y:e.imageY,index:t._ImgManager.getCurrentImageIndex()})}},{key:"__rightclick",value:function(e,r){var t=r;t.__fireEvent("onMouseRightClick",{e:e,x:e.imageX,y:e.imageY,index:t._ImgManager.getCurrentImageIndex()})}},{key:"__dblclick",value:function(e,r){var t=r;t.__fireEvent("onMouseDoubleClick",{e:e,x:e.imageX,y:e.imageY,index:t._ImgManager.getCurrentImageIndex()})}},{key:"__mousemove",value:function(e,r){var t=r;t.__fireEvent("onMouseMove",{e:e,x:e.imageX,y:e.imageY,index:t._ImgManager.getCurrentImageIndex()})}},{key:"__pageAreaSelected",value:function(e,r,n){var i=n,o=1;if(r&&r.length>0){var a=r[r.length-1];a.index&&(o=t(a.index)+1),i.__fireEvent("onImageAreaSelected",{index:e,left:t(a.x),top:t(a.y),right:t(a.x+a.width),bottom:t(a.y+a.height),areaIndex:o})}}},{key:"__pageAreaUnselected",value:function(e,r){r.__fireEvent("onImageAreaDeSelected",e)}},{key:"__dragdone",value:function(e,t){var n=t;r.isFunction(n._stwain.__OnIndexChangeDragDropDone)&&n._stwain.__OnIndexChangeDragDropDone(e)}},{key:"__onDrop",value:function(e,r){var t=r;t.GetWebViewer().webViewer.acceptDrop&&t.__dropEvent(e,t)}},{key:"__dropEvent",value:function(t,n){var i,o,a=n,s=null,u=function(r){a._bIfShowProgressBar&&e.Lib.closeProgress(null),r&&Rs.output(null,r+" was loaded successfully!"),null!=s&&a._stwain.Addon.PDF.SetConvertMode(s)},c=function(r,t,n){a._bIfShowProgressBar&&e.Lib.closeProgress(null),n&&Rs.output(null,n+" failed to load. Error code: "+r+"Error String: "+t),null!=s&&a._stwain.Addon.PDF.SetConvertMode(s)};try{for(var l=t.dataTransfer.files,d=0;d<l.length;d++){if(0==(i=l[d]).type.length){var f=void 0,h=i.name.indexOf(".");switch(h>0&&(f=i.name.substring(h+1)),f){case"bmp":o=e.DWT.EnumDWT_ImageType.IT_BMP;break;case"jpg":case"jpeg":o=e.DWT.EnumDWT_ImageType.IT_JPG;break;case"tif":case"tiff":o=e.DWT.EnumDWT_ImageType.IT_TIF;break;case"png":o=e.DWT.EnumDWT_ImageType.IT_PNG;break;case"pdf":o=e.DWT.EnumDWT_ImageType.IT_PDF;break;case"jp2":case"j2k":case"j2c":o=e.DWT.EnumDWT_ImageType.IT_J2K;break;default:Rs.output(null,i.name+" failed to load because the file type is not supported!"),o=-1,r.Errors.UnrecognizedExt(a._stwain)}}else switch(i.type){case"image/bmp":o=e.DWT.EnumDWT_ImageType.IT_BMP;break;case"image/jpg":case"image/jpeg":o=e.DWT.EnumDWT_ImageType.IT_JPG;break;case"image/tif":case"image/tiff":o=e.DWT.EnumDWT_ImageType.IT_TIF;break;case"image/png":o=e.DWT.EnumDWT_ImageType.IT_PNG;break;case"application/pdf":o=e.DWT.EnumDWT_ImageType.IT_PDF;break;case"image/jp2":o=e.DWT.EnumDWT_ImageType.IT_J2K;break;default:Rs.output(null,i.name+" failed to load because the file type is not supported!"),o=-1,r.Errors.UnrecognizedExt(a._stwain)}if(-1!=o){if(a._bIfShowProgressBar?r.showProgress(a._stwain,"DropLoading",a._stwain.IfShowCancelDialogWhenImageTransfer):r.hideProgress(),a._stwain._OnPercentDone([0,-1,e.MSG.Loading]),a._stwain.Addon&&a._stwain.Addon.PDF){var g=!1,p=void 0;r.License.checkProductKey(a._stwain,{PDFRasterizer:!0},!0)&&(s=a._stwain.Addon.PDF.GetConvertMode(),p=a._stwain._innerFun("GetAddOnVersion",kn("pdf")),(r.env.bMac&&p==e.DWT.PdfMacVersion||r.env.bLinux&&p==e.DWT.PdfLinuxVersion||p==e.DWT.PdfVersion)&&(g=!0),g&&a._stwain.Addon.PDF.SetConvertMode(3))}!function(r){var t=new FileReader;t.readAsDataURL(r),t.onload=function(){var e=a._stwain.__GetLoadEventsNum();a._stwain.__LoadImageFromBytesV2(r,o,"",!0,0,r.size,!1,e,u,c)},t.onerror=function(r){e.Lib.Errors.InvalidFile(a._stwain),a._stwain._errorString=this.error,c(a._stwain._errorCode,a._stwain._getErrorString())}}(l[d])}}}catch(m){r.error(m.stack||m,"error"),setTimeout((function(){throw m}),0)}}},{key:"__pageChange",value:function(n,i){var o,a=i,s=a._ImgManager.count();if(r.log("OnPagination"),s<=0)r.Errors.NoImage(a._stwain);else if(1!=s){!/^\d+$/.test(n)||n<=0?alert(e.Lib.product.CustomizableDisplayInfo.errorMessages.invalidIndex):((o=t(n)-1)<0?o=0:o>=s&&(o=s-1),o!=a._ImgManager.getCurrentImageIndex()&&a.GetWebViewer().gotoPage(o))}}},{key:"__bufferChanged",value:function(e,t,n){var i,o=e,a=[],s=-1,u=[];t.operation&&(t.action=t.operation);for(var c=0;c<o._ImgManager.count();c++)(i=o._ImgManager.getCustomDataByIndex(c))&&i.imageId&&a.push(CR(i.imageId));if(t.imageIds=a,t.curIndex>=0&&(i=o._ImgManager.getCustomDataByIndex(t.curIndex))&&i.imageId&&(s=CR(i.imageId)),t.currentId=s,t.afterStatus.selectedUids)for(var l=0;l<t.afterStatus.selectedUids.length;l++){if(t.afterStatus.selectedUids[l]){var d=o._ImgManager.getIndexByUid(t.afterStatus.selectedUids[l]);d>=0&&(i=o._ImgManager.getCustomDataByIndex(d))&&i.imageId&&u.push(CR(i.imageId))}}t.selectedIds=u,r.mix(t,{}),delete t.uids,delete t.currentUid,delete t.selectedUids,delete t.afterStatus,delete t.beforeStatus,delete t.operation,delete t.curIndex,delete t.docUid,o.__fireEvent("onBufferChanged",t)}},{key:"__setError",value:function(e,r,t){var n=t;n._stwain._errorCode=e,n._stwain._errorString=r}},{key:"__acquire",value:function(t){var n=t;try{var i=!1;1==e.DWT.IfConfineMaskWithinTheViewer&&(e.DWT.IfConfineMaskWithinTheViewer=!1,i=!0),n._stwain.SelectSourceAsync().then((function(){return n._stwain.AcquireImageAsync({IfShowUI:!0,IfCloseSourceAfterAcquire:!0})})).then((function(){i&&(e.DWT.IfConfineMaskWithinTheViewer=!0)}))["catch"]((function(t){r.log("User did not select a source"),i&&(e.DWT.IfConfineMaskWithinTheViewer=!0)}))}catch(o){}}},{key:"__loadImage",value:function(t){try{var n=t,i=null,o=null;e.DWT.IfConfineMaskWithinTheViewer&&(o=!0,e.DWT.IfConfineMaskWithinTheViewer=!1),n._stwain._containerElement=undefined;if(n._stwain.IfShowFileDialog=!0,n._stwain.Addon&&n._stwain.Addon.PDF){var a,s=!1;r.License.checkProductKey(n._stwain,{PDFRasterizer:!0},!0)&&(i=n._stwain.Addon.PDF.GetConvertMode(),a=n._stwain._innerFun("GetAddOnVersion",kn("pdf")),(r.env.bMac&&a==e.DWT.PdfMacVersion||r.env.bLinux&&a==e.DWT.PdfLinuxVersion||a==e.DWT.PdfVersion)&&(s=!0),s&&n._stwain.Addon.PDF.SetConvertMode(3))}n._stwain.LoadImageEx("",5,(function(){r.log("Loaded an image successfully."),null!=o&&(e.DWT.IfConfineMaskWithinTheViewer=o),null!=i&&n._stwain.Addon.PDF.SetConvertMode(i)}),(function(t,a){r.log("Loading failed with the error: "+a),null!=o&&(e.DWT.IfConfineMaskWithinTheViewer=o),null!=i&&n._stwain.Addon.PDF.SetConvertMode(i)}))}catch(u){}}},{key:"__print",value:function(e){var t=e;r.Errors.ClearErrorInfo(t._stwain),t._ImgManager.getCurrentImageIndex()<0||t._ImgManager.PrintCurrentImage()}},{key:"__save",value:(i=ne(de.mark((function o(e,t,n,i,a){var s,u,c,l,d;return de.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(s=e,u="save",r.Errors.ClearErrorInfo(s._stwain),!(s._ImgManager.count()<=0||s._ImgManager.getCurrentImageIndex()<0)){o.next=4;break}return o.abrupt("return");case 4:return s._stwain._containerElement=undefined,c=s.__getViewerElement(s,a),Zn(u,c),o.prev=7,l=this._ImgManager.getIndexByUid(t),d=this._ImgManager.convertClientIndexToServerId(l),o.next=12,s._stwain._updateImage(d,n,i);case 12:if(!o.sent){o.next=19;break}return o.next=16,s._stwain.__saveToViewerAfterUpdate(t,i);case 16:o.next=20;break;case 19:s._errorCode,s._errorString;case 20:o.next=24;break;case 22:o.prev=22,o.t0=o["catch"](7);case 24:return o.prev=24,n=null,Qn(u),o.finish(24);case 28:return o.abrupt("return",void 0);case 29:case"end":return o.stop()}}),o,this,[[7,22,24,28]])}))),function(e,r,t,n,o){return i.apply(this,arguments)})},{key:"__getViewerElement",value:function(e,r){var t,n=e;if(r)if(n.GetWebViewer().webViewer.imageEditor){var i=n.GetWebViewer().createImageEditor();t="dwt-viewer-imageEditor-fullScreen"==i.inner.containerElement.className?{_containerElement:document.body}:{_containerElement:i.inner.containerElement}}else t=n._stwain;else t=n._stwain;return t}},{key:"__deskew",value:function(e,t,n){var i=this,o="deskew";r.Errors.ClearErrorInfo(i._stwain);var a=i._ImgManager.getCurrentImageIndex();if(i._ImgManager.count()<=0||a<0)KR.output(i,"No image in Buffer");else{var s=i.__getViewerElement(i,!0);Zn(o,s);i._stwain.GetSkewAngleFromBinaryAsync(a,t,(function(e){n(e[0]),Qn(o)}),(function(){Qn(o)}))}}},{key:"__remove",value:function(e){var t=this;r.Errors.ClearErrorInfo(t._stwain),t._ImgManager.count()<=0||t._ImgManager.getCurrentImageIndex()<0?KR.output(t,"No image in Buffer"):t._stwain.RemoveAllSelectedImages()}},{key:"__removeAll",value:function(e){var t=this;r.Errors.ClearErrorInfo(t._stwain),t._ImgManager.count()<=0||t._ImgManager.getCurrentImageIndex()<0?KR.output(t,"No image in Buffer"):t._stwain.RemoveAllImages()}},{key:"__onBindViewer",value:function(r){r&&(this._stwain._containerElement=r,r.id&&(e.DWT.ContainerMap[r.id]=this._stwain))}},{key:"__onUnBindViewer",value:function(r){if(r){var t=this._stwain._containerElement;if(t&&(t.innerHTML=""),this._stwain._containerElement=null,r.id){var n=e.DWT.ContainerMap;r.id in n&&delete e.DWT.ContainerMap[r.id]}}}},{key:"__close",value:function(e){var t=this;if(r.Errors.ClearErrorInfo(t._stwain),r.isFunction(t._stwain.__CloseImageEditorUI))try{t._stwain.__CloseImageEditorUI()}catch(n){Le(n)}}},{key:"__rotateRightForServer",value:function(e){var t=this;r.Errors.ClearErrorInfo(t._stwain);var n=t._ImgManager.getCurrentImageIndex();t._ImgManager.count()<=0||n<0?KR.output(t,"No image in Buffer"):t._stwain.RotateRight(n)}},{key:"__rotateForServer",value:function(e,t,n,i){var o=this;r.Errors.ClearErrorInfo(o._stwain);var a=o._ImgManager.getCurrentImageIndex();o._ImgManager.count()<=0||a<0?KR.output(o,"No image in Buffer"):o._stwain.RotateEx(a,t,i,n)}},{key:"__rotateLeftForServer",value:function(e){var t=this;r.Errors.ClearErrorInfo(t._stwain);var n=t._ImgManager.getCurrentImageIndex();t._ImgManager.count()<=0||n<0?KR.output(t,"No image in Buffer"):t._stwain.RotateLeft(n)}},{key:"__deskewForServer",value:function(e){var t=this;r.Errors.ClearErrorInfo(t._stwain);var n=t._ImgManager.getCurrentImageIndex();t._ImgManager.count()<=0||n<0?KR.output(t,"No image in Buffer"):t._stwain.GetSkewAngleAsync(n).then((function(e){t._stwain.RotateEx(n,e,!0,1,(function(){}),(function(){}))}))}},{key:"__cropForServer",value:function(e,n){var i=this;r.Errors.ClearErrorInfo(i._stwain);var o=i._ImgManager.getCurrentImageIndex();if(i._ImgManager.count()<=0||o<0)KR.output(i,"No image in Buffer");else{var a=n.left,s=n.top,u=a+n.width,c=s+n.height;i._stwain.Crop(o,t(a),t(s),t(u),t(c))}}},{key:"__eraseForServer",value:function(e,n){var i=this;r.Errors.ClearErrorInfo(i._stwain);var o=i._ImgManager.getCurrentImageIndex();if(i._ImgManager.count()<=0||o<0)KR.output(i,"No image in Buffer");else{var a=n.left,s=n.top,u=a+n.width,c=s+n.height;i._stwain.CutFrameToClipboard(o,t(a),t(s),t(u),t(c))}}},{key:"__changeImageSizeForServer",value:function(e,t,n,i){var o=this;r.Errors.ClearErrorInfo(o._stwain);var a=o._ImgManager.getCurrentImageIndex();o._ImgManager.count()<=0||a<0?KR.output(o,"No image in Buffer"):o._stwain.ChangeImageSize(a,t,n,i)}},{key:"__flipForServer",value:function(e){var t=this;r.Errors.ClearErrorInfo(t._stwain);var n=t._ImgManager.getCurrentImageIndex();t._ImgManager.count()<=0||n<0?KR.output(t,"No image in Buffer"):t._stwain.Flip(n)}},{key:"__mirrorForServer",value:function(e){var t=this;r.Errors.ClearErrorInfo(t._stwain);var n=t._ImgManager.getCurrentImageIndex();t._ImgManager.count()<=0||n<0?KR.output(t,"No image in Buffer"):t._stwain.Mirror(n)}},{key:"__restoreForServer",value:function(e,t){var n=e;if(r.Errors.ClearErrorInfo(n._stwain),n._ImgManager.count()<=0||n._ImgManager.getCurrentImageIndex()<0)KR.output(n,"No image in Buffer");else{var i=n._ImgManager.getIndexByUid(t);i>=0&&n.__RestoreImageInner(n,i)}}},{key:"__saveForServer",value:function(e,t){var n=e;return new r.Promise((function(e,i){r.Errors.ClearErrorInfo(n._stwain),(n._ImgManager.count()<=0||n._ImgManager.getCurrentImageIndex()<0)&&(KR.output(n,"No image in Buffer"),e());var o=n._ImgManager.getIndexByUid(t);o>=0?n.__SaveImageInner(n,o,!0,(function(){e()})):e()}))}},{key:"__RestoreImageInner",value:function(e,t,n){var i=e,o=i._ImgManager.getImageIdMap(i._ImgManager.convertClientIndexToServerId(t));i.__OnGetImageFromServerForEdit(o,t,1,(function(e,t,o){if(e&&(r.log("__RestoreImageInner: "+[e.guid].join(",")),i._ImgManager.UpdateImage(e,o)),-1==(e&&e.imageId))return n&&n(),!1;n&&n()}))}},{key:"__SaveImageInner",value:function(e,t,n,i){var o=e,a=o._ImgManager.getImageIdMap(o._ImgManager.convertClientIndexToServerId(t));return o.__OnGetImageFromServerForEdit(a,t,2,(function(e,t,a){if(e&&(1==n&&(r.log("__SaveImageInner: "+[e.guid].join(",")),o._ImgManager.getCurrentImageIndex()==t&&o._ImgManager.UpdateImage(e,a)),-1==e.imageId))return i&&i(),!1;return i&&i(),!0})),!0}},{key:"__OnGetImageFromServerForEdit",value:function(r,n,i,o){var a=this;if(o&&a._ImgManager.getBaseUrl){var s=a._ImgManager.convertClientIndexToServerId(n);if(-1==s)return!1;e.DWT.ConnectWithSocket?o():fr({method:"GET",xhrFields:{withCredentials:!0},url:Rs.getUrlByAct(a._ImgManager.getBaseUrl,s,i),onSuccess:function(e){r.ticks=Date.now(),r.imageUrl=Rs.getImageUrl(a._ImgManager.getBaseUrl,s,-1,-1,r.ticks),r.minImageUrl=Rs.getImageUrl(a._ImgManager.getBaseUrl,s,t(r.iImageControlWidth),t(r.iImageControlHeight),r.ticks);var i=a._ImgManager.GetMetaDataByIndex(n);if(i){var u=a._ImgManager.getImageIdMap(s);u&&u.width?i.width=u.width:i.width=a._stwain.GetImageWidth(n),u&&u.height?i.height=u.height:i.height=a._stwain.GetImageHeight(n)}o(r,n,i)},onError:function(){}})}return!0}}]),n}();function JR(e){var t,n,i,o,a=e._config;r.dlgProgress||r.initProgress(e),a.bNoViewer?e._containerElement=null:(a.container?e._containerElement=a.container:a.containerId&&(e._containerElement=r.get(a.containerId)),e._width=a.width,e._height=a.height,t=r.one(e._containerElement)),function(e,t){var n={Stwain:e},i=Be;if(t){var o,a=e._width,s=e._height;o=r.one(e._containerElement),r.isString(a)&&a.indexOf("%")>=0?(a=r.css(o,"width")*parseInt(a)/100,i=Ve):a=parseInt(a),r.isString(s)&&s.indexOf("%")>=0?(s=r.css(o,"height")*parseInt(s)/100,i=Ve):s=parseInt(s),n={Stwain:e,Container:t,Width:a,Height:s}}GR.bindUIViewEvents(e,n),e._UIView?e._UIView._Init(n):e._UIView=new XR(e,n),e.Width<=0&&(e.Width=270),e.Height<=0&&(e.Height=350),i&&GR.changeImageUISize(e,e._width,e._height)}(e,t),e._isBindViewer()&&(n=e,i=e._config,o=i||{},n.__OnImageAreaDeSelected=o.onImageAreaDeSelected||"",n.__OnImageAreaSelected=o.onImageAreaSelected||"",n.__OnMouseClick=o.onMouseClick||"",n.__OnMouseDoubleClick=o.onMouseDoubleClick||"",n.__OnMouseMove=o.onMouseMove||"",n.__OnMouseRightClick=o.onMouseRightClick||"",n.__OnTopImageInTheViewChanged=o.onTopImageInTheViewChanged||"",n.__OnBufferChanged=o.onBufferChanged||"",e.__OnMouseClick=a.onMouseClick||"",e.__OnThumbnailMouseClick="",e.__OnKeyDown=a.onKeyDown||"",e.__OnMouseWheel=a.onMouseWheel||"",e.__OnMouseDoubleClick=a.onMouseDoubleClick||"",e.__OnMouseRightClick=a.onMouseRightClick||"",e.__OnMouseMove=a.onMouseMove||"",e.__OnImageAreaSelected=a.onImageAreaSelected||"",e.__OnImageAreaDeSelected=a.onImageAreaDeSelected||"",e.__OnRefreshUI=a.onRefreshUI||"",e.__OnBufferChanged=a.onBufferChanged||"",e.__MouseX=0,e.__MouseY=0,e.__style=new zR(e),e.__fSelectionRectAspectRatio=0)}function YR(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=Te(e);if(r){var i=Te(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return Se(this,t)}}function ZR(e,r){!function(e,r){if(r.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,r),r.add(e)}function QR(e,r,t){if(!r.has(e));return t}r.UI.ImageUIView=XR;var $R=e.navInfoSync,eO=new WeakSet,rO=new WeakSet,tO=new WeakSet,nO=function(t){Ie(f,t);var n,i,o,a,s,u,c,l,d=YR(f);function f(e){var r;return X(this,f),ZR(ve(r=d.call(this,e)),tO),ZR(ve(r),rO),ZR(ve(r),eO),r}return Q(f,[{key:"_getWSContextData",value:function(){return this._getCurrentDocumentName()}},{key:"_getErrorString",value:function(){var e=this;return-2207==e._errorCode&&e._bMustUpgradeService&&r.Errors.MustUpgradeService(e),0!=e._errorCode?e._errorString:"Successful."}},{key:"_getWebTwainId",value:function(){return this._id}},{key:"_isTwainServiceType",value:function(){return!0}},{key:"_isPC",value:function(){var r=e.navInfoSync;return r.bWin||r.bMac||r.bLinux}},{key:"_serviceSyncMethodNotSupport",value:function(e){var t=this;return r.Errors.ServiceSyncMethodNotSupport(t,e),{code:t._errorCode,message:t._getErrorString()}}},{key:"_serviceAsyncMethodNotSupport",value:function(e){var t=this;return r.Errors.ServiceAsyncMethodNotSupport(t,e),{code:t._errorCode,message:t._getErrorString()}}},{key:"_serviceNotSupportAsync",value:function(e){var t=this;return r.Errors.ServiceNotSupport(t,e),r.Promise.reject({code:t._errorCode,message:t._getErrorString()})}},{key:"_nouiNotSupport",value:function(e,t){var n=this;return r.Errors.CannotCallUIMethodWhenNotBindDefaultViewer(n,e),r.isFunction(t)&&t(n._errorCode,n._getErrorString()),!1}},{key:"_innerFunRaw",value:function(t,n,i,o,a,s,u){var c,l,d,f,h=this,g="f/",p=!1;if(e.DWT.ConnectWithSocket)return this._sendData(t,n,!1,s,u),!0;if(h._resetErr(),!h._isValid())return!1;var m=Vn.isServerInvalid(h);if(i&&m)return h._waitForConnect().then((function(){return h._innerFunRaw(t,n,i,o,a,s,u)}));if(!i&&m)return r.Errors.ThrowString_FailedToCreateDWTObject(h),!1;if(i&&(p=!0,g="fa/"),d={method:"POST",url:c=[h._httpUrl,g,t].join(""),data:l=Gn(h._clientId,t,n,0),async:p,onSuccess:function(e,t,n){var i=!1;try{i=r.isString(e)&&"text/json"===n.getResponseHeader("content-type")?r.parse(e):e}catch(o){}i?(Ae(i)?(h._errorCode=i.exception,h._errorString=i.description):h._resetErr(),f=a?i:i.result):(r.Errors.InvalidResultFormat(h),f=""),r.isFunction(s)&&s(f),p&&(f=null)},onError:function(){r.Errors.NetworkError(h),f="",!r.page.bUnload&&r.isFunction(u)&&u()}},!p&&o)$R.bIE?(d.dataType="arraybuffer",d.onSuccess=function(e,t,n){var i,o,a,u=!1;n.responseHeadersString&&(-1!=n.responseHeadersString.indexOf("text/json")&&(u=!0));if(i=n.responseData,h._resetErr(),f=!1,i&&(o=new Uint8Array(i),u?i=String.fromCharCode.apply(null,o):(f=new Blob([o],{type:h._strHttpContentTypeFieldValue}),(a=new kR.ArrayBuffer).append(o),f.md5=a.end())),!i||u){var c,l=!1;if((c=u?i:n.responseText).length>0){if("{"==c.charAt(0))try{l=r.parse(c),u=!0}catch(d){r.log(c)}u?Ae(l)?(h._errorCode=l.exception,h._errorString=l.description,f=!1):f=!0:(o=new Uint8Array(c),f=new Blob([o],{type:h._strHttpContentTypeFieldValue}),(a=new kR.ArrayBuffer).append(o),f.md5=a.end())}}r.isFunction(s)&&s(f)}):(p||(d.dataType="text",d.contentType="text/plain; charset=x-user-defined",d.mimeType="text/plain; charset=x-user-defined"),d.onSuccess=function(e,t,n){var i,o,a;if(h._resetErr(),(o=(i=n.responseText).length)>0){var u,c=!1;if("{"==i.charAt(0))try{u=r.parse(i),c=!0}catch(g){r.log(i)}if(c)Ae(u)?(h._errorCode=u.exception,h._errorString=u.description,f=!1):f=!0;else{a=new Uint8Array(o);for(var l=0;l<o;l++)a[l]=i.charCodeAt(l);f=new Blob([a],{type:h._strHttpContentTypeFieldValue});var d=new kR.ArrayBuffer;d.append(a),f.md5=d.end()}}else f="";r.isFunction(s)&&s(f)});else if(p&&o){d={method:"POST",body:l},$R.bIE?d.dataType="arraybuffer":d.fetchRaw=!0;var _=Ir(c,d);return $R.bIE||(_=_.then((function(e){var r=e.headers.get("content-type");return r.indexOf("image/")>=0||r.indexOf("application/octet-stream")>=0?e.arrayBuffer():e.json()}))),_=_.then((function(e){if(h._resetErr(),Dn(e))return r.isFunction(s)&&s(e),void(e=null);if(r.isObject(e)){var t=e;if(Ae(t))h._errorCode=t.exception,h._errorString=t.description,r.isFunction(u)&&u();else{var n="";t.result&&(n=t.result),r.isFunction(s)&&s(n)}}else r.Errors.NetworkError(h),!r.page.bUnload&&r.isFunction(u)&&u()}),(function(e){r.Errors.NetworkError(h),!r.page.bUnload&&r.isFunction(u)&&u()})),!0}return p||r.mix(d,{headers:{"X-Requested-With":!1}}),$R.bFileSystem&&(d.crossDomain=!1),fr(d),!!p||f}},{key:"_innerSendCmd",value:function(e,r){this._innerFunRaw(e,r,!0,!1,!0)}},{key:"_innerFun",value:function(e,t){var n;return n=this._innerFunRaw(e,t,!1,!1,!1),r.isArray(n)?n[0]:n}},{key:"__OnRecieveMsg",value:function(t,n){var i=this,o=null==n?void 0:n.cmd;if(t.event)return es(Te(f.prototype),"__OnRecieveMsg",this).call(this,t,n);if(e.DWT.ConnectWithSocket)return es(Te(f.prototype),"__OnRecieveMsg",this).call(this,t,n);if(Ae(t)?(i._errorCode=t.exception,i._errorString=t.description):"StartScan"!=o&&"GetAddOnVersion"!=o&&(i._errorCode=0,i._errorString=""),"ReadBarcode"==o||"OCRRecognize"==o||t.request&&"OCRProRecognize"==t.request.method)return n.sFun?(n.sFun(t),!0):(n.fFun&&n.fFun(t),!1);if("ActiveUI"==o||"VersionInfo"==o||"ConvertToBase64"==o||"SaveSelectedImagesToBase64Binary"==o||"ConvertToBlob"==o)return n.sFun&&r.isArray(t.result)&&t.result.length>0?(n.sFun(t.result),!0):(n.fFun&&n.fFun(t.result),!1);if("ShowFileDialog"==o||"SplitTiff"==o||"SplitPDF"==o||"EncodeAsBase64"==o||"ProductKey"==o||"GetSourceNames"==o||"GetSkewAngle"==o||"GetImageInfo"==o||"GetSkewAngleFromBinary"==o)return n.sFun?(n.sFun(t.result),!0):(n.fFun&&n.fFun(t.result),!1);if("GetLicenseInfo"==o&&r.isArray(t.Detail))return es(Te(f.prototype),"__OnRecieveMsg",this).call(this,t,n);if("SetCapabilities"==o)return es(Te(f.prototype),"__OnRecieveMsg",this).call(this,t,n);if(t.result&&t.result.length&&("1"==t.result[0]||1==t.result[0]||"ok"==t.result[0]))(n.sFun||n.sFun)&&n.sFun(n.rawData?t:t.result);else if(t.exception){var a=!1;n.fFun&&(a=n.fFun(i._errorString)),!a&&t.exception&&t.exception<0&&-2115!=t.exception&&r.isFunction(i.__OnPrintMsg)&&i.__OnPrintMsg(i._errorString)}else{if("LoadImage"==o||"LoadImageEx"==o||"LoadImageFromBytes"==o||"LoadImageFromBase64Binary"==o||"LoadDibFromClipboard"==o||"FTPDownload"==o||"FTPDownloadEx"==o)return n.sFun&&n.sFun(t.result),t=null,!0;n.fFun&&n.fFun(wn(["result:"],t.result))}return!0}},{key:"OnRefreshUI",value:function(e,r,t,n){return this._innerRefreshUI(e,r,t,n)}},{key:"GetCurrentDocumentName",value:function(){return this._resetErr(),!!this._isValid()&&this._getCurrentDocumentName()}},{key:"RegisterEvent",value:function(e,r){return!!this.registerEvent(e,r)}},{key:"UnregisterEvent",value:function(e,r){return this.unregisterEvent(e,r)}},{key:"onEvent",value:function(e,r){this.registerEvent(e,r)}},{key:"on",value:function(e,r){this.registerEvent(e,r)}},{key:"_OnConsumed",value:function(e){}},{key:"_OnPostLoad",value:function(e,t){var n,i,o,a,s=this;t!==undefined&&t.exception!==undefined&&t.description!==undefined&&(s._errorCode=t.exception,s._errorString=t.description),r.log("OnPostLoad Results:"),i=e[1].split(","),n=r.base64.decode(i[0]),o=r.base64.decode(i[1]),r.log(n),r.log(o),r.log(i[2]),aO(s,"On PostLoad"),(a=s._ImgManager.getCurrentImageIndex())>=0&&s._innerRefreshUI(a),r.isFunction(s.__OnPostLoad)&&s.__OnPostLoad(n,o,i[2])}},{key:"_OnPostTransfer",value:function(e){var t=this;if(r.log("On PostTransfer Results:"+e),aO(t,"On PostTransfer"),r.isFunction(t.__OnPostTransfer))try{t.__OnPostTransfer()}catch(n){Le(n)}}},{key:"_OnPreAllTransfersAsync",value:function(e){var t=this;if(r.isFunction(t.__OnPreAllTransfersAsync)){var n={event:"beforeAcquire",result:{}};try{r.isArray(e)&&e.length>1&&(n=r.parse(e[1]))}catch(i){}setTimeout((function(){try{t.__OnPreAllTransfersAsync(n)}catch(e){Le(e)}}),10)}}},{key:"_OnPostAllTransfers",value:function(e){var t=this;if(e.length>=2&&0==t._errorCode&&(t._errorCode=e[1],t._errorString=e[2]),r.log("On PostAllTransfers Results:"+e),t.__bLoadingImage=!1,t.__bAcquireImageNow=!1,t.__closeRemoteScanUI(!0),r.isFunction(t.__OnPostAllTransfers))try{t.__OnPostAllTransfers()}catch(n){Le(n)}}},{key:"_OnResult",value:function(e){var t=e[1];if(r.isFunction(this.__OnResult))try{this.__OnResult(t)}catch(n){Le(n)}}},{key:"_OnTransferCancelled",value:function(e){var t=this;if(t._ImgManager.getCurrentImageIndex(),t._ImgManager.count(),t.__bLoadingImage=!1,t.__bAcquireImageNow=!1,r.isFunction(t.__OnTransferCancelled))try{t.__OnTransferCancelled()}catch(n){Le(n)}}},{key:"_OnTransferError",value:function(e){if(r.isFunction(this.__OnTransferError))try{this.__OnTransferError()}catch(t){Le(t)}}},{key:"_OnSourceUIClose",value:function(e){var t=this;if(t.__closeRemoteScanUI(!0),r.isFunction(t.__OnSourceUIClose))try{t.__OnSourceUIClose()}catch(n){Le(n)}}},{key:"_OnPreTransfer",value:function(e){if(r.isFunction(this.__OnPreTransfer))try{this.__OnPreTransfer()}catch(t){Le(t)}}},{key:"_OnPreAllTransfers",value:function(e){if(r.isFunction(this.__OnPreAllTransfers))try{this.__OnPreAllTransfers()}catch(t){Le(t)}}},{key:"_OnGetFilePath",value:function(e){var t,n,i,o=this;if(t=e[1].split(","),r.log("On GetFilePath Results:"+e),n=r.base64.decode(t[3]),i=r.base64.decode(t[4]),"-1032"==t[2]&&(t[2]="-1",n=i=""),r.isFunction(o.__OnGetFilePath))try{o.__OnGetFilePath(1*t[0],1*t[1],1*t[2],n,i)}catch(a){Le(a)}o.__bOpenFileNow=!1}},{key:"__GetLoadEventsNum",value:function(){var e=0;return r.isFunction(this.__OnPostLoad)&&(e|=1),r.isFunction(this.__OnGetFilePath)&&(e|=2),e}},{key:"_innerSend",value:function(t,n,i,o,a){if(e.DWT.ConnectWithSocket||"SaveSelectedImagesToBytes"!=t&&"ConvertToBlob"!=t)return this._sendData(t,n,i,o,a);var s=Ln(),u=Gn(this._clientId,t,n,s);return this._innerFunRaw(t,u,!0,!0,!0,o,a),r.Promise.resolve(!0)}},{key:"_convertToBlobByIndices",value:function(t,n,i,o,a){var s=this;if(s._resetErr(),!s._isValid())return!1;var u=parseInt(n),c=arguments,l=function(e){return r.isFunction(o)&&as(o,s,e,n,c),e=null,!1};if(!r.License.checkProductKey(s,{Core:!0}))return r.isFunction(o)&&o(s._errorCode,s._getErrorString()),!1;if(!s._checkIndices(t))return l(t);if(u==e.DWT.EnumDWT_ImageType.IT_BMP||u==e.DWT.EnumDWT_ImageType.IT_JPG||u==e.DWT.EnumDWT_ImageType.IT_PNG||u==e.DWT.EnumDWT_ImageType.IT_J2K){if(t.length>1)return r.Errors.ConvertBinaryIndexMoreThanOne(s),l(t)}else if(u!=e.DWT.EnumDWT_ImageType.IT_TIF&&u!=e.DWT.EnumDWT_ImageType.IT_PDF)return r.Errors.InvalidImageType(s),l(t);var d=[];return r.isArray(t)&&r.each(t,(function(e){var r=s._ImgManager.convertClientIndexToServerId(e);-1!=r&&d.push(r)})),r.isFunction(i)?(s._innerConvertToBlobWithUI("ConvertToBlob",u,d,false,(function(e,t){return r.isFunction(i)&&is(i,e,t,n,c),e=t=null,!0}),l),!0):QR(s,eO,iO).call(s,d,u,false)}},{key:"_getDefaultDevice",value:function(){var e=this;if(e._resetErr(),!e._isValid())return null;var t="",n=xn.TWAINSCANNER,i=e._innerFun("GetDefaultSourceName");if(i.length>0)try{var o=JSON.parse(i);n=o.type,t=r.base64.decode(o.ProductName)}catch(s){t=""}var a=new ss;return a.name=t,a.deviceType=n,n==xn.TWAINX64SCANNER&&t.length>0?a.displayName="Twain64-"+t:n==xn.WIASCANNER&&t.length>0?a.displayName="WIA-"+t:n==xn.ESCLSCANNER&&t.length>0?a.displayName="ESCL-"+t:n==xn.ICASCANNER&&e.__serverPlatform==I.enumMac&&t.length>0?a.displayName="ICA-"+t:a.displayName=t,a}},{key:"_getDefaultDeviceAsync",value:(l=ne(de.mark((function h(){var e,t,n,i,o,a;return de.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if((e=this)._resetErr(),e._isValid()){s.next=4;break}return s.abrupt("return",null);case 4:return t="",n=xn.TWAINSCANNER,s.next=8,e._sendDataByHttpAsync("GetDefaultSourceName");case 8:if((i=s.sent).length>0)try{o=JSON.parse(i),n=o.type,t=r.base64.decode(o.ProductName)}catch(u){t=""}return(a=new ss).name=t,a.deviceType=n,n==xn.TWAINX64SCANNER&&t.length>0?a.displayName="Twain64-"+t:n==xn.ICASCANNER&&e.__serverPlatform==I.enumMac&&t.length>0?a.displayName="ICA-"+t:a.displayName=t,s.abrupt("return",a);case 15:case"end":return s.stop()}}),h,this)}))),function(){return l.apply(this,arguments)})},{key:"_getSources",value:function(e,r,t){return us(this,this._innerFun("GetSources",kn(e,null!=r&&r,null!=t&&t)))}},{key:"_getSourceCountAsync",value:(c=ne(de.mark((function g(t){var n,i,o,a,s,u,c,l;return de.wrap((function(d){for(;;)switch(d.prev=d.next){case 0:if((n=this)._resetErr(),n._isValid()){d.next=4;break}return d.abrupt("return",r.Promise.reject({code:n._errorCode,message:n._errorString}));case 4:return QR(n,tO,oO).call(n),Zn("GetSourceCountAsync",n),i=[],d.prev=7,t&&(n._driverType=t),o=Be,a=Be,s=Be,u=Be,n._bRemoteMode?n.__serverPlatform==I.enumWindow?s=!0:n.__serverPlatform==I.enumLinux?a=!0:n.__serverPlatform==I.enumMac?o=!0:n.__serverPlatform==I.enumAndroid&&(u=!0):(o=e.navInfoSync.bMac,a=e.navInfoSync.bLinux,s=e.navInfoSync.bWin,u=e.navInfoSync.bAndroid),c=$n(n._driverType,s,a,o,u),l=Ve,d.next=15,this._getDevices(c,l,void 0);case 15:i=d.sent,d.next=21;break;case 18:throw d.prev=18,d.t0=d["catch"](7),d.t0;case 21:return d.prev=21,Qn("GetSourceCountAsync"),d.finish(21);case 24:return d.abrupt("return",n._setDevices(i));case 25:case"end":return d.stop()}}),g,this,[[7,18,21,24]])}))),function(e){return c.apply(this,arguments)})},{key:"_setDevices",value:function(e){var r,t=this;return t.__devices=e,r=e.length,t.__sourceCount=r,r<=0?(t.__defaultSourceName="",t.__sourceCount=0,0):r}},{key:"_getSourceNameByIndex",value:function(e){var r=this.__devices.length;return e<0||e>=r?"":this.__devices[e].displayName}},{key:"_dwtConvertToBlobSync",value:function(e,t,n,i,o,a){var s=n,u=",";r.isString(s)&&""!=s||(s="",u="");var c=["[",e,',"',t.join(","),'"',u,s,"]"].join(""),l=this._innerFunRaw("ConvertToBlob",c,!1,!0,!1),d="";return 0==this._errorCode?(l&&"md5"in l&&(d=l.md5),i(l,d,a)):(o(),!1)}},{key:"_getSourceCountSync",value:function(){var t,n=this,i=Be,o=Be,a=Be,s=Be;if(n._bRemoteMode?n.__serverPlatform==I.enumWindow?a=!0:n.__serverPlatform==I.enumLinux?o=!0:n.__serverPlatform==I.enumMac?i=!0:n.__serverPlatform==I.enumAndroid&&(s=!0):(i=e.navInfoSync.bMac,o=e.navInfoSync.bLinux,a=e.navInfoSync.bWin,s=e.navInfoSync.bAndroid),t=$n(this._driverType,a,o,i,s),n._resetErr(),!n._isValid())return 0;if(!r.License.checkProductKey(n,{Core:!0}))return 0;QR(n,tO,oO).call(n);var u=Ve,c=n._getSources(t,u,undefined);return n._setDevices(c)}},{key:"_OnActiveUI",value:(u=ne(de.mark((function p(e){var r;return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this,e&&e.length>2&&(r.__strProductName=e[2]),t.next=4,es(Te(f.prototype),"_OnActiveUI",this).call(this,e);case 4:return t.next=6,r._setConvertModeAsync(r._pdfConvertMode)["catch"]((function(){}));case 6:case"end":return t.stop()}}),p,this)}))),function(e){return u.apply(this,arguments)})},{key:"_OnReady",value:(s=ne(de.mark((function m(){var t,n,i,o,a;return de.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return t=this,r.isLocalIP(t._serverInfo.server)&&(r.LS.item("DWT_port",t._serverInfo.port),r.LS.item("DWT_ssl",t._serverInfo.ssl?"true":"false")),t._bNoMask||Zn("OnReady",t),s.prev=3,s.next=6,es(Te(f.prototype),"_OnReady",this).call(this);case 6:if(!r.License.isLTS()){s.next=12;break}if(t._uuidForActiveUI){s.next=12;break}return s.next=10,e.DWT.lgcuid(e.DWT.EnumInstance.dwt_desktop,"");case 10:n=s.sent,t._uuidForActiveUI=n;case 12:return s.next=14,t._innerActiveUI(t._uuidForActiveUI);case 14:return i=s.sent,s.next=17,t._OnActiveUI(i);case 17:if(Pi(e.MSG.Init_ChangeDWTMap),(o=t._id)&&!e.DWT.WebTwainIdMap[o]&&(e.DWT.WebTwainIdMap[o]=t),JR(t),a=!1,t._bRemoteMode||(a=r.attachAddon(t)),e.DWT.IfDisableDefaultSettings){s.next=29;break}return Pi(e.MSG.Init_ConfiguringDWT),s.next=27,sO(t);case 27:s.next=32;break;case 29:if(!a){s.next=32;break}return s.next=32,new r.Promise((function(e){setTimeout(e,300)}));case 32:s.next=39;break;case 34:throw s.prev=34,s.t0=s["catch"](3),s.t0&&(t._errorCode=s.t0.code,t._errorString=s.t0.message),t.dispose(),s.t0;case 39:return s.prev=39,t._bNoMask||Qn("OnReady"),s.finish(39);case 42:case"end":return s.stop()}}),m,this,[[3,34,39,42]])}))),function(){return s.apply(this,arguments)})},{key:"_OnWSClose",value:function(e){es(Te(f.prototype),"_OnWSClose",this).call(this,e),r.detect.bOK=!1;var t=this;t.__bAcquireImageNow=!1,t._dm&&(t._dm.bLicenseOK=!1),t._dmSync&&(t._dmSync.bLicenseOK=!1)}},{key:"_OnWSTimeout",value:function(e){es(Te(f.prototype),"_OnWSTimeout",this).call(this,e),r.detect.bOK=!1}},{key:"_setConvertModeAsync",value:function(e){var t=this;if(!t._setConvertModeInner(e))return r.Promise.reject({code:t._errorCode,message:t._errorString});var n=t._getPdfDllname();return t._innerFunV2("SetPDFConvertMode",kn(t._pdfRealConvertMode,n)).then((function(){if(2==t._pdfRealConvertMode&&1==t._pdfConvertMode||2==t._pdfRealConvertMode&&4==t._pdfConvertMode)throw r.Errors.LicenseNoPDF(t),{code:t._errorCode,message:t._errorString};return!0}))}},{key:"_setConvertMode",value:function(e){var t=this;if(!t._setConvertModeInner(e))return!1;var n=t._getPdfDllname();return t._innerFun("SetPDFConvertMode",kn(t._pdfRealConvertMode,n)),!(2==t._pdfRealConvertMode&&1==t._pdfConvertMode||2==t._pdfRealConvertMode&&4==t._pdfConvertMode)||(r.Errors.LicenseNoPDF(t),!1)}},{key:"_setConvertModeInner",value:function(e){var t=this;if(!r.License.checkProductKey(t,{Core:!0}))return!1;var n=1*e;return t._resetErr(),!!t._isValid()&&(isNaN(n)?(r.Errors.ParameterCannotEmpty(t),!1):1!=n&&2!=n&&3!=n&&4!=n?(r.Errors.InvalidValue(t),!1):(t._pdfConvertMode=n,2==n||r.License.hasPDFRProductKey(t)?t._pdfRealConvertMode=n:t._pdfRealConvertMode=2,!0))}},{key:"_getPdfDllname",value:function(){var r=this,t=!1,n=!1;return r._bRemoteMode?r.__serverPlatform==I.enumWindow||(r.__serverPlatform==I.enumLinux?n=!0:r.__serverPlatform==I.enumMac&&(t=!0)):(t=e.navInfoSync.bMac,n=e.navInfoSync.bLinux,e.navInfoSync.bWin),t?r._b64bit?"libDynamicPdfCorex64_"+e.DWT.PdfVersion+".dylib":"libDynamicPdfCore_"+e.DWT.PdfVersion+".dylib":n?"libDynamicPdfCore_"+e.DWT.PdfVersion+".so":r._b64bit?"DynamicPdfCorex64_"+e.DWT.PdfVersion+".dll":"DynamicPdfCore_"+e.DWT.PdfVersion+".dll"}},{key:"_unload_viewer",value:function(){}},{key:"__innerDeleteInMap",value:function(){return this._id,delete e.DWT.WebTwainIdMap[this._id],Ve}},{key:"__unload",value:(a=ne(de.mark((function _(){var t,n,i;return de.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(t=this,n=r.clone(e.DWT.licenseException),t.__closeRemoteScanUI(!0),!t._destroy&&!t._destroying){o.next=5;break}return o.abrupt("return");case 5:if(t._destroying=!0,this.__innerDeleteInMap(),t.__addon&&t.__addon.Camera&&t.__addon.Camera._viewer&&(""!=t.__addon.Camera.getStatus()&&t.__addon.Camera.closeSource()["catch"]((function(){})),t.__addon.Camera._viewer.dispose(),t.__addon.Camera._viewer=null),t._unload_viewer(),t._containerElement=null,t._ImgManager&&t._ImgManager.clear(),!t._bReady||r.page.bUnload){o.next=36;break}if(!t._dm){o.next=20;break}return o.prev=13,o.next=16,t._dm.dispose();case 16:o.next=20;break;case 18:o.prev=18,o.t0=o["catch"](13);case 20:if(!t._dmSync){o.next=28;break}return o.prev=21,o.next=24,t._dmSync.disposeAsync();case 24:o.next=28;break;case 26:o.prev=26,o.t1=o["catch"](21);case 28:if(!t._wsClient){o.next=36;break}return o.prev=29,o.next=32,t._innerDisposeWSClient();case 32:o.next=36;break;case 34:o.prev=34,o.t2=o["catch"](29);case 36:t._wsClient&&(t._wsClient.removeEvent("close",t._clientId),t._wsClient.removeEvent("error",t._clientId),t._wsClient.removeEvent("timeout",t._clientId),t._wsClient.dispose(),delete t._wsClient,t._wsClient=null),t._bReady=!1,e.DWT.lremoveDWTObj(t),t.__bAcquireImageNow=!1,t._destroying=!1,t._destroy=!0,(i=e.DWT.licenseException).code=n.code,i.message=n.message,i.fromLTS=n.fromLTS;case 46:case"end":return o.stop()}}),_,this,[[13,18],[21,26],[29,34]])}))),function(){return a.apply(this,arguments)})},{key:"_setIfShowUI",value:function(e){this._resetErr(),this._isValid()&&(r.isBoolean(e)?this._innerFun("IfShowUI",kn(e)):r.Errors.InvalidValue(self))}},{key:"_setIfShowFileDialog",value:function(e){this._resetErr(),this._isValid()&&(r.isBoolean(e)?this._innerFun("IfShowFileDialog",kn(e)):r.Errors.InvalidValue(self))}},{key:"_getDevicesAsync",value:(o=ne(de.mark((function v(t,n,i,o){var a,s,u,c,l;return de.wrap((function(d){for(;;)switch(d.prev=d.next){case 0:if(a=this,s=[],!n||r.isNumber(n)){d.next=4;break}return r.Errors.InvalidParameter(a),d.abrupt("return",r.Promise.reject({code:a._errorCode,message:a._errorString}));case 4:if(u=a._bRemoteMode?Fn:e.navInfoSync.bAndroid?An:Fn,c=null!=n?n:u,a._resetErr(),a._isValid()){d.next=8;break}return d.abrupt("return",r.Promise.reject({code:a._errorCode,message:a._errorString}));case 8:return Zn(t,a),d.prev=9,a._dm&&(a._dm.bLicenseOK=!1),d.next=13,a._getDevices(c,i,o);case 13:l=d.sent,r.isArray(l)&&l.length>0&&(s=s.concat(l)),d.next=20;break;case 17:throw d.prev=17,d.t0=d["catch"](9),d.t0;case 20:return d.prev=20,Qn(t),d.finish(20);case 23:return s.length>0&&this._setDevices(s),d.abrupt("return",s);case 25:case"end":return d.stop()}}),v,this,[[9,17,20,23]])}))),function(e,r,t,n){return o.apply(this,arguments)})},{key:"_openSourceAsync",value:function(e){var t=this;return t._resetErr(),t._isValid()?(t._bRemoteMode&&t._initRemoteDiv(),t._innerFunV2("OpenSource").then((function(e){return t.__closeRemoteScanUI(!0),e}),(function(e){return t.__closeRemoteScanUI(!0),r.Promise.reject(e)}))):r.Promise.reject({code:t._errorCode,message:t._errorString})}},{key:"_closeSourceAsync",value:function(e){var t=this;return t._resetErr(),t._isValid()?t._innerFunV2("CloseSource").then((function(){return t._curDevice=null,!0})):r.Promise.reject({code:t._errorCode,message:t._errorString})}},{key:"_selectSourceAsync",value:function(t,n){var i=this;return i._resetErr(),i._isValid()?i._getDevicesAsync(t,n).then((function(n){var o,a,s=document,u=n?n.length:0;if(r.dialog.selectsourcedlg)return r.Errors.SystemBusy(i),r.Promise.reject({code:i._errorCode,message:i._errorString});var c,l=-1;for((a=s.createElement("dialog")).className="dynamsoft-dialog-selectsource",e.navInfoSync.bIE&&(a.style.width="300px"),a.setAttribute("closed","closed"),(c=[]).push('<ul id="dynamsoft-dialog-selectsource-sourcelist-ul">'),o=0;o<u;o++){var d="",f=i._getSourceNameByIndex(o);(""==i.__defaultSourceName&&0==o||i.__defaultSourceName==f)&&(d=" dynamsoft-dialog-selectsource-sourcelist-li-selected",l=o),c.push('<li class="dynamsoft-dialog-selectsource-item'+d+'" sourceindex='+o+">"+f+"</li>")}c.push("</ul>"),c=c.join("");var h=["<p>",r.product.CustomizableDisplayInfo.dialogText.selectSource[0],"</p>",'<div id="dynamsoft-dialog-selectsource-sourcelist">',c,"</div>",'<div><input type="button" value="',r.product.CustomizableDisplayInfo.dialogText.selectSource[1],'" class="dynamsoft-dialog-selectsource-button-select">','<input type="button" value="',r.product.CustomizableDisplayInfo.dialogText.selectSource[2],'" class="dynamsoft-dialog-selectsource-button-cancel"></div>'].join("");return a.innerHTML=h,r.dialog.selectsourcedlg=a,s.body.appendChild(r.dialog.selectsourcedlg),r.each(r.all(".dynamsoft-dialog-selectsource-item"),(function(e,t){r.addEventListener(e,"click",(function(e){for(var t=e.target,n=t.attributes.sourceindex.value,i=t.parentElement.children,o=0;o<i.length;o++)i[o].className="dynamsoft-dialog-selectsource-item";t.className="dynamsoft-dialog-selectsource-item dynamsoft-dialog-selectsource-sourcelist-li-selected",r.get("dynamsoft-dialog-selectsource-sourcelist-ul").setAttribute("selectedSourceIndex",n)}))})),r.get("dynamsoft-dialog-selectsource-sourcelist-ul").setAttribute("selectedSourceIndex",l.toString()),r.dialog.setup(r.dialog.selectsourcedlg),r.dialog.selectsourcedlg&&r.dialog.selectsourcedlg.showModal(),"CSS1Compat"==s.compatMode?s.documentElement.scrollTop:s.body.scrollTop,new r.Promise((function(e,n){r.removeEventListener(r.one(".dynamsoft-dialog-selectsource-button-select")[0],"click"),r.removeEventListener(r.one(".dynamsoft-dialog-selectsource-button-cancel")[0],"click"),u>0&&r.addEventListener(r.one(".dynamsoft-dialog-selectsource-button-select")[0],"click",(function(){var n=parseInt(r.get("dynamsoft-dialog-selectsource-sourcelist-ul").attributes.selectedSourceIndex.value);n<0||i._selectSourceByIndexAsync(t,n).then((function(){r.dialog.selectsourcedlg&&(r.dialog.selectsourcedlg.close(),document.body.removeChild(r.dialog.selectsourcedlg),r.dialog.selectsourcedlg=!1),e(n)}))})),r.addEventListener(r.one(".dynamsoft-dialog-selectsource-button-cancel")[0],"click",(function(){r.dialog.selectsourcedlg&&(r.dialog.selectsourcedlg.close(),document.body.removeChild(r.dialog.selectsourcedlg),r.dialog.selectsourcedlg=!1);var e={};r.Errors.UserCanceled(e),n({code:e._errorCode,message:e._errorString})}))}))})):r.Promise.reject({code:i._errorCode,message:i._errorString})}},{key:"_dwtGetCapabilities",value:function(e,t){var n=this,i=function(){r.isFunction(t)&&t(n._errorCode,n._errorString)};return n._sendDataByHttpAsync("GetCapabilities",null).then((function(t){try{var o,a;t.length>0&&(a=t[0]),r.isString(a)?(a=r.removeNonPrintableChar(a),a=r.replaceAll(a,"\\\\","\\\\"),0==(o=JSON.parse(a)).errorCode?r.isFunction(e)&&e(o.response):(n._errorCode=o.errorCode,n._errorString=o.errorString,i())):(r.Errors.DynamsoftServiceResponseDataTypeError(n),i())}catch(s){n._errorCode=-2302,n._errorString=s,i()}}),i),!0}},{key:"_dwtSetCapabilities",value:function(e,t,n){var i=this;if(!r.isObject(e)||r.isArray(e))return r.Errors.InvalidParameter(i),r.isFunction(n)&&n(i._errorCode,i._getErrorString()),!1;var o=["[",r.stringify(e),"]"].join("");return i._innerSend("SetCapabilities",o,0,(function(e){r.isFunction(t)&&t(e)}),n),!0}},{key:"_selectDeviceAsync",value:(i=ne(de.mark((function y(e,r,t){var n,i;return de.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return n=this,Zn(e,this),o.prev=2,o.next=5,es(Te(f.prototype),"_innerSelectDeviceAsync",this).call(this,r,t);case 5:(i=o.sent)&&(n._curDevice=r,n._bSelectedSourceByServer=!1),o.next=12;break;case 9:throw o.prev=9,o.t0=o["catch"](2),o.t0;case 12:return o.prev=12,Qn(e),o.finish(12);case 15:return o.abrupt("return",i);case 16:case"end":return o.stop()}}),y,this,[[2,9,12,15]])}))),function(e,r,t){return i.apply(this,arguments)})},{key:"_selectSourceByIndexAsync",value:(n=ne(de.mark((function S(e,t){var n,i,o;return de.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(i=1*t,(n=this)._resetErr(),n._isValid()){a.next=4;break}return a.abrupt("return",r.Promise.reject({code:n._errorCode,message:n._errorString}));case 4:if(!r.isNaN(i)){a.next=7;break}return r.Errors.InvalidIndex(n),a.abrupt("return",r.Promise.reject({code:n._errorCode,message:n._errorString}));case 7:if(n.__devices){a.next=10;break}return a.next=10,n._getDevicesAsync(e,null);case 10:if(!(i<0||i>=n.__devices.length)){a.next=13;break}return r.Errors.IndexOutOfRange(n),a.abrupt("return",r.Promise.reject({code:n._errorCode,message:n._errorString}));case 13:return o=n.__devices[i],a.abrupt("return",n._selectDeviceAsync(e,o));case 15:case"end":return a.stop()}}),S,this)}))),function(e,r){return n.apply(this,arguments)})},{key:"_removeAllImages",value:function(e){var t=this,n=!0;if(t._resetErr(),!t._isValid())return!1;var i,o=[];for(i=t._getHowManyImagesInBuffer()-1;i>=0;i--){var a=t._imageBufferWrapper.convertClientIndexToServerId(i);a>-1&&o.push(a)}if(o.length>0){if(t._OnBitmapChanged(["0",o.join(","),3,t._ImgManager.getCurrentImageIndex(),t._ImgManager.count()]),n=t._innerFunRaw("RemoveAllImages",kn(o.join(",")),!1,!1,!1,(function(){}),(function(){})),r.isArray(n))return n[0]}else n=!0;return n}},{key:"_removeImage",value:function(e,t){var n,i=this,o=parseInt(t);if(!ai(i,o))return!1;var a=i._ImgManager.convertClientIndexToServerId(o);return-1==a?(r.Errors.IndexOutOfRange(i),!1):(((n=i._innerFun("RemoveImage",kn(a)))||-1033==i._errorCode)&&i._OnBitmapChanged(["0",""+a,3,i._ImgManager.getCurrentImageIndex(),i._ImgManager.count()]),n)}},{key:"__innerAcquireOrLoadImageAsync",value:function(t,n,i,o){var a=this;return new r.Promise((function(i,o){var s="LoadImage"==t||"LoadImageEx"==t||"GenerateURLForUploadData"==t,u=s||"LoadDibFromClipboard"==t;s?r.showProgress(a,t,!1):Zn(t,a),a._innerSend(t,n,!0,(function(n){if(a.__bLoadingImage=!1,a.__bOpenFileNow=!1,a.__closeRemoteScanUI(!0),s){if(r.closeProgress(null,t),a._isBindViewer()){var o=a._ImgManager.getCurrentImageIndex();o>=0&&a._innerRefreshUI(o)}}else Qn(t);u&&a._blts&&e.DWT.lcvrf(a),r.isFunction(i)&&i(n)}),(function(e){s?r.closeProgress(null,""):Qn(t),a.__bLoadingImage=!1,a.__bAcquireImageNow=!1,a.__bOpenFileNow=!1,a.__closeRemoteScanUI(!0);var n=a._ImgManager.getCurrentImageIndex();n>=0&&a._innerRefreshUI(n),r.Errors.bImageOnlyError_NotPurelyPDF(a._errorCode)&&r.Errors.LicenseNoPDF(a),r.isFunction(o)&&o(a._errorCode,a._getErrorString()),s?r.closeProgress(null,t):Qn(t),e&&r.error(e)}))}))}},{key:"_innerLoadImageFromBinary",value:function(t,n,i,o,a){var s,u=this,c=n;if(!r.License.checkProductKey(u,{Core:!0}))return r.isFunction(a)&&a(u._errorCode,u._getErrorString()),!1;if(!t||""==t)return r.Errors.ParameterCannotEmpty(u),r.isFunction(a)&&a(u._errorCode,u._getErrorString()),!1;var l=t.currentFileName;l||(l=u._getCurrentDocumentName());var d=t.currentTagName;if(d||(d=u._getCurrentDefaultTagName()),t instanceof FileList){if(1==t.length)return t[0].currentFileName=l,t[0].currentTagName=d,u._innerLoadImageFromBinary(t[0],c,i,o,a);if(t.length>1){var f;for(r.asyncQueue.stop(),f=0;f<t.length;f++)t[f].currentFileName=l,t[f].currentTagName=d,f==t.length-1?r.asyncQueue.pushToDo(u,"_innerLoadImageFromBinary",[t[f],c,i,o,a]):r.asyncQueue.pushToDo(u,"_innerLoadImageFromBinary",[t[f],c,i,null,a]);return r.asyncQueue.start(),!0}return r.Errors.ParameterCannotEmpty(u),r.isFunction(a)&&a(u._errorCode,u._getErrorString()),!1}if(window.ReadableStream&&t instanceof ReadableStream?s=new Response(t):window.Response&&t instanceof Response&&(s=t),s)s.arrayBuffer().then((function(e){var r=new Blob([e]),t=0;i&&(t=u.__GetLoadEventsNum()),u.__LoadImageFromBytesV1(r,-1,"",t,!0,o,a)}));else{var h=t;Dn(h)&&((h=new Blob([t])).currentFileName=t.currentFileName,h.currentTagName=t.currentTagName);var g=-1,p=e.DWT.EnumDWT_ImageType;r.isString(h.type)&&("application/pdf"==h.type?g=p.IT_PDF:"image/png"==h.type?g=p.IT_PNG:"image/jpeg"==h.type||"image/jpg"==h.type?g=p.IT_JPG:"image/bmp"==h.type?g=p.IT_BMP:"image/tiff"==h.type||"image/tif"==h.type?g=p.IT_TIF:"image/jp2"==h.type&&(g=p.IT_J2K));var m=0;i&&(m=u.__GetLoadEventsNum()),u.__LoadImageFromBytesV1(h,g,"",m,!0,o,a)}return!0}},{key:"__LoadImageFromBytes",value:function(e,r,t,n,i,o,a,s){return this.__LoadImageFromBytesV2(e,r,t,n,a,s,!1,0,i,o)}},{key:"__LoadImageFromBytesV1",value:function(e,r,t,n,i,o,a){return this.__LoadImageFromBytesV2(e,r,t,i,0,0,!1,n,o,a)}},{key:"_isMobileMode",value:function(){return!1}},{key:"ErrorCode",get:function(){return this._errorCode}},{key:"ErrorString",get:function(){return this._getErrorString()}},{key:"HowManyImagesInBuffer",get:function(){return this._getHowManyImagesInBuffer()}}]),f}(OR);function iO(e,t,n){var i=this,o=function(e){return!1};return i._dwtConvertToBlobSync(t,e,n,(function(e){if(!e||e.size<=0)return r.Errors.ConvertBlobIsEmpty(i),!1;var t=i.__maxUploadImageSize;return e.size>t&&-1!=t?(r.Errors.UploadExceededMaxSize(i),!1):e}),o)}function oO(){this.__defaultSourceName="",this.__sourceCount=0}var aO=function(e,t){if(r.config.bDiscardBlankImage){var n=e._ImgManager.getCurrentImageIndex();e.IsBlankImage(n)&&e.RemoveImage(n);var i=["Blank Discard (",t,"): ",e.ErrorString].join("");r.isFunction(e.__OnPrintMsg)&&e.__OnPrintMsg(i)}};function sO(e){return uO.apply(this,arguments)}function uO(){return uO=ne(de.mark((function t(n){var i,o,a,s,u;return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=n,!e.DWT.ConnectWithSocket){t.next=6;break}return t.next=4,new r.Promise((function(e,r){i._sendData("IfDisableSourceAfterAcquire","[1]",!1,e,r)}));case 4:t.next=8;break;case 6:return t.next=8,n._innerFunV2("IfDisableSourceAfterAcquire","[1]");case 8:o=e.navInfoSync,a=F.TWAIN,s=!1,u=!1,i._bRemoteMode?i.__serverPlatform==I.enumWindow||(i.__serverPlatform==I.enumLinux?u=!0:i.__serverPlatform==I.enumMac&&(s=!0)):(s=o.bMac,u=o.bLinux,o.bWin),s?a=F.TWAIN_AND_ICA:u&&(a=F.SANE),n._driverType=a,n._bRemoteMode&&(n._setIfShowUI(!1),n._setIfShowFileDialog(!1));case 13:case"end":return t.stop()}}),t)}))),uO.apply(this,arguments)}function cO(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=Te(e);if(r){var i=Te(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return Se(this,t)}}function lO(e,r){!function(e,r){if(r.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,r),r.add(e)}function dO(e,r,t){if(!r.has(e));return t}var fO=new WeakSet,hO=new WeakSet,gO=new WeakSet,pO=new WeakSet,mO=new WeakSet,_O=function(t){Ie(o,t);var n,i=cO(o);function o(){var e;X(this,o);for(var r=arguments.length,t=new Array(r),n=0;n<r;n++)t[n]=arguments[n];return lO(ve(e=i.call.apply(i,[this].concat(t))),mO),lO(ve(e),pO),lO(ve(e),gO),lO(ve(e),hO),lO(ve(e),fO),e}return Q(o,[{key:"SaveAsGIF",value:function(t,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return!1;if(!(r.License.checkProductKey(a,{Core:!0})||e.navInfoSync.bWin&&r.License.checkProductKey(a,{Webcam:!0},!0)))return r.isFunction(o)&&o(a._errorCode,a._getErrorString()),!1;var s,u=Jn.replaceLocalFilename(t);return!!ni(a,n,o)&&(-1==(s=a._ImgManager.convertClientIndexToServerId(n))?(r.Errors.IndexOutOfRange(a),r.isFunction(o)&&os(o,a),!1):a.__innerSaveImage("SaveAsGIF",kn(u,s),i,o))}},{key:"SaveSelectedImagesToBase64Binary",value:function(t,n){var i=this;if(i._resetErr(),!i._isValid())return!1;if(!(r.License.checkProductKey(i,{Core:!0})||e.navInfoSync.bWin&&r.License.checkProductKey(i,{Webcam:!0},!0)))return r.isFunction(n)&&n(i._errorCode,i._getErrorString()),!1;var o=ii(i);return r.isFunction(t)?(i._innerSend("SaveSelectedImagesToBase64Binary",kn(o.join(",")),!0,t,n),!0):i._innerFun("SaveSelectedImagesToBase64Binary",kn(o.join(",")))}},{key:"ShowFileDialog",value:function(e,r,t,n,i,o,a,s){var u=this;if(u._resetErr(),!u._isValid())return!1;var c,l=Jn.replaceLocalFilename(i);return c=u.__GetLoadEventsNum(),u._innerSend("ShowFileDialog",kn(e,r,t,n,l,o,a,s,c),!0),!0}},{key:"FTPDownload",value:function(e,t,n,i){var o=this;if(o._resetErr(),!o._isValid())return!1;if(!e)return r.Errors.InvalidParameter(o),r.isFunction(i)&&i(o._errorCode,o._getErrorString()),!1;var a=Jn.getImageType(t);return dO(o,mO,TO).call(o,"FTPDownload",kn(e,t),a,n,i)}},{key:"FTPDownloadEx",value:function(e,t,n,i,o){var a=this;return a._resetErr(),!!a._isValid()&&(e?dO(a,mO,TO).call(a,"FTPDownloadEx",kn(e,t,n),n,i,o):(r.Errors.InvalidParameter(a),r.isFunction(o)&&o(a._errorCode,a._getErrorString()),!1))}},{key:"FTPUpload",value:function(e,t,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return!1;var s=a._ImgManager.convertClientIndexToServerId(t);return!!ni(a,t,o)&&(-1==s?(r.Errors.IndexOutOfRange(a),r.isFunction(o)&&os(o,a),!1):a.__innerFTPUpload("FTPUpload",kn(e,s,n),i,o))}},{key:"FTPUploadEx",value:function(e,t,n,i,o,a){var s,u=this;return u._resetErr(),!!u._isValid()&&(!!ni(u,t,a)&&(-1==(s=u._ImgManager.convertClientIndexToServerId(t))?(r.Errors.IndexOutOfRange(u),r.isFunction(a)&&os(a,u),!1):u.__innerFTPUpload("FTPUploadEx",kn(e,s,n,i),o,a)))}},{key:"FTPUploadAllAsMultiPageTIFF",value:function(e,r,t,n){var i=this;if(i._resetErr(),!i._isValid())return!1;var o=[];return ri(i,o),this.__innerFTPUpload("FTPUploadAsMultiPageTIFF",kn(e,r,o.join(",")),t,n)}},{key:"FTPUploadAllAsPDF",value:function(e,r,t,n){var i=this;if(i._resetErr(),!i._isValid())return!1;var o=[];return ri(i,o),i.__innerFTPUpload("FTPUploadAsMultiPagePDF",kn(e,r,o.join(",")),t,n)}},{key:"FTPUploadAsMultiPagePDF",value:function(e,r,t,n){var i=this;if(i._resetErr(),!i._isValid())return!1;var o=ii(i);return i.__innerFTPUpload("FTPUploadAsMultiPagePDF",kn(e,r,o.join(",")),t,n)}},{key:"FTPUploadAsMultiPageTIFF",value:function(e,r,t,n){var i=this;if(i._resetErr(),!i._isValid())return!1;var o=ii(i);return this.__innerFTPUpload("FTPUploadAsMultiPageTIFF",kn(e,r,o.join(",")),t,n)}},{key:"HTTPDownloadDirectly",value:function(t,n,i,o,a){var s=this;if(s._resetErr(),!s._isValid())return!1;if(!r.License.checkProductKey(s,{Core:!0}))return r.isFunction(a)&&a(s._errorCode,s._getErrorString()),!1;var u,c,l=s._GetHttpHeadersAndClear(),d=Jn.combineUrl(s,t,n);if(d===undefined)return r.Errors.ParameterCannotEmpty(s),!1;if(!i||""==i)return r.Errors.InvalidLocalFilename(s,"HTTPDownloadDirectly"),r.isFunction(a)&&os(a,s),!1;if(u=Jn.getImageType(i),!r.License.checkPDFProductKeyWhenNeeds(s,u))return r.isFunction(a)&&a(s._errorCode,s._errorString),!1;r.cancelFrom=q.HTTPDownload,c=Jn.replaceLocalFilename(i),s.IfShowProgressBar?r.showProgress(s,"HTTPDownloadDirectly",!1):r.hideProgress();var f=!0,h=function(){return s.IfShowProgressBar&&r.closeProgress(null,"HTTPDownloadDirectly"),r.isFunction(o)&&o(),!0},g=function(){return s.IfShowProgressBar&&r.closeProgress(null,"HTTPDownloadDirectly"),r.isFunction(a)&&os(a,s),!1};s._OnPercentDone([0,-1,e.MSG.Downloading,"http"]),r.isFunction(o)||(f=!1);var p=Jn.loadHttpBlob(s,"get",d,f,(function(r){s._OnPercentDone([0,-1,e.MSG.Loading]);var t=s.__GetLoadEventsNum();return s.__LoadImageFromBytesV1(r,3,c,t,f,h,g)}),g,(function(e){var r=0===e.total?100:Math.round(100*e.loaded/e.total);[e.loaded," / ",e.total].join(""),s._OnPercentDone([0,r,"","http"])}),l);return p}},{key:"HTTPUploadThroughPostDirectly",value:function(e,t,n,i,o,a){var s=this;if(s._resetErr(),!s._isValid())return!1;var u=Jn.combineUrl(s,e,n),c=function(){r.isFunction(a)&&os(a,s,s.__HTTPPostResponseString)};if(s.__HTTPPostResponseString="",!t)return r.Errors.InvalidFile(s),c(),!1;if(!e)return r.Errors.HttpServerCannotEmpty(s),c(),!1;var l=this.IfShowProgressBar;return s._innerUploadDirectly(u,t,i,l,!1,0,!0,!1,o,c)}},{key:"_innerUploadDirectly",value:function(e,t,n,i,o,a,s,u,c,l){var d,f=this,h=f._GetHttpHeadersAndClear(),g="HTTPUploadThroughPostDirectly",p=!0;if(e===undefined||!1===e||""===e)return r.Errors.ParameterCannotEmpty(f),r.isFunction(l)&&l(),!1;if(r.isFunction(c)||(p=!1),!r.License.checkProductKey(f,{Core:!0}))return r.isFunction(l)&&l(),!1;r.cancelFrom=q.HTTPUpload;var m=function(e,t,n){return 0!=e&&t&&(f._errorCode=e,f._errorString=t),n&&(f.__HTTPPostResponseString=n),r.needShowTwiceShowDialog=!1,i&&r.closeProgress(null,g),r.isFunction(l)&&l(),!1};return r.needShowTwiceShowDialog=!0,i?r.showProgress(f,g,!1):r.hideProgress(),(d=Jn.replaceLocalFilename(t))&&""!=d?u&&u.bCancel?(u.st=2,r.Errors.UserCanceled(f),m(f._errorCode,f._errorString)):dO(f,hO,yO).call(f,d,p,o,(function(t){if(r.needShowTwiceShowDialog=!1,u&&u.bCancel)return u.st=2,r.Errors.UserCanceled(f),m(f._errorCode,f._errorString);if(t&&(!i||i&&r.dlgRef>0||0==p)){t instanceof File?t.fileName=n:t.name=n,i&&sR(f.__IfShowCancelDialogWhenImageTransfer);var o=new uR,l=f._createHttpUploaderConfig(),d=new cR;return f.__remoteFilename&&""!=f.__remoteFilename&&(d.remoteFilename=f.__remoteFilename),l.objUploadStatus=u,d.url=e,d.method=g,d.content=t,t=null,d.contentType=f._strHttpContentTypeFieldValue,d.headers=h,d.bAsync=p,d.httpFormData=EO(f.httpFormFields),d.retry=a,d.bOnlyResponseEmptyIsOK=s,d.blockSize=f._moduleSize,o.httpPostUpload(l,d,(function(e){i&&r.closeProgress(null,g),r.isFunction(c)&&is(c,e)}),m)}return r.Errors.InvalidFile(f),m(f._errorCode,f._errorString)}),m):(r.Errors.InvalidFile(f),m(f._errorCode,f._errorString))}},{key:"_innerUploadFilesDirectly",value:function(e,t,n,i,o,a,s,u,c){var l,d=this,f=d._GetHttpHeadersAndClear(),h="HTTPUploadThroughPostDirectly",g=!0,p=[];if(!1===e||""===e)return r.Errors.ParameterCannotEmpty(d),r.isFunction(c)&&c({code:d._errorCode,message:d._getErrorString(),files:t}),!1;if(r.isFunction(u)||(g=!1),!r.License.checkProductKey(d,{Core:!0}))return r.isFunction(c)&&c({code:d._errorCode,message:d._getErrorString(),files:t}),!1;r.cancelFrom=q.HTTPUpload;var m=function(e,n,o){return 0!=e&&n&&(d._errorCode=e,d._errorString=n),o&&(d.__HTTPPostResponseString=o),r.needShowTwiceShowDialog=!1,i&&r.closeProgress(null,h),r.isFunction(c)&&c({code:d._errorCode,message:d._errorString,response:o,files:t}),!1};r.needShowTwiceShowDialog=!0,i?r.showProgress(d,h,!1):r.hideProgress(),r.each(t,(function(e){var t=Jn.replaceLocalFilename(e);if(!t||""==t)return r.Errors.InvalidFile(d),m(d._errorCode,d._errorString),!1;p.push(t)}));var _=[],v=p.length,y=0;return r.each(p,(function(t,c){l=dO(d,hO,yO).call(d,t,g,o,(function(t){if(r.needShowTwiceShowDialog=!1,!t||i&&!(i&&r.dlgRef>0)&&0!=g)return i&&r.closeProgress(null,h),r.Errors.UploadError(d),r.isFunction(m)&&m(d._errorCode,d._errorString),!1;var o=Jn.cformat(n,c+1);if(t instanceof File?t.fileName=o:t.name=o,_[c]=t,t=null,++y==v){i&&sR(d.__IfShowCancelDialogWhenImageTransfer);var l=d._createHttpUploaderConfig(),p=new cR;return d.__remoteFilename&&""!=d.__remoteFilename&&(p.remoteFilename=d.__remoteFilename),p.url=e,p.method=h,p.content=_,_=null,p.contentType=d._strHttpContentTypeFieldValue,p.headers=f,p.bAsync=g,p.httpFormData=EO(d.httpFormFields),p.retry=a,p.bOnlyResponseEmptyIsOK=s,p.blockSize=d._moduleSize,aR(l,p,(function(e){i&&r.closeProgress(null,h),r.isFunction(u)&&is(u,e)}),(function(e,t,n){i&&r.closeProgress(null,h),r.isFunction(m)&&m(e,t,n)}))}}),(function(){i&&r.closeProgress(null,h),r.isFunction(m)&&m()}))})),l}},{key:"_createHttpUploaderConfig",value:function(){var e=this,t=new lR;return t.IfShowProgressBar=e.IfShowProgressBar,t.IfShowCancelDialogWhenImageTransfer=e.__IfShowCancelDialogWhenImageTransfer,t.MaxUploadImageSize=e.MaxUploadImageSize,t.HTTPRequestswithCredentials=e.HTTPRequestswithCredentials,t.onPercent=function(r){e._OnPercentDone(r)},t.onHttpUploadStatus=function(t){r.isFunction(e.__OnHttpUploadStatus)&&e.__OnHttpUploadStatus(t)},t}},{key:"SetUploadSegment",value:function(e,t){var n=this;return n._resetErr(),!!n._isValid()&&(!r.isNumber(e)||e<0?(r.Errors.InvalidSegmentUploadThreshold(n),!1):!r.isNumber(t)||t<=0?(r.Errors.InvalidModuleSize(n),!1):(n._segementUploadThreshold=1024*e*1024,n._moduleSize=1024*t,!0))}},{key:"ConvertToBase64",value:function(t,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return!1;var s=[],u=arguments,c=parseInt(n);if(!r.License.checkProductKey(a,{Core:!0}))return r.isFunction(o)&&o(a._errorCode,a._getErrorString()),!1;if(!a._checkIndices(t))return r.isFunction(o)&&as(o,a,t,n,u),!1;if(c==e.DWT.EnumDWT_ImageType.IT_BMP||c==e.DWT.EnumDWT_ImageType.IT_JPG||c==e.DWT.EnumDWT_ImageType.IT_PNG){if(t.length>1)return r.Errors.ConvertBase64IndexMoreThanOne(a),r.isFunction(o)&&as(o,a,t,n,u),!1}else if(c!=e.DWT.EnumDWT_ImageType.IT_TIF&&c!=e.DWT.EnumDWT_ImageType.IT_PDF)return r.Errors.InvalidImageType(a),r.isFunction(o)&&as(o,a,t,n,u),!1;r.isArray(t)&&r.each(t,(function(e){var r=a._ImgManager.convertClientIndexToServerId(e);-1!=r&&s.push(r)}));return a._convertToBase64ByServerIdsWithUI("ConvertToBase64",s,c,!1,3,(function(e){var t=[];return r.isArray(s)&&r.each(s,(function(e){var r=a._ImgManager.convertServerIdToClientIndex(e);r>-1&&t.push(r)})),r.isFunction(i)&&is(i,e,t,n,u),!1}),(function(){var e=[];return r.isArray(s)&&r.each(s,(function(r){var t=a._ImgManager.convertServerIdToClientIndex(r);t>-1&&e.push(t)})),r.isFunction(o)&&as(o,a,e,n,u),!1}))}},{key:"ClearAllHTTPFormField",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&(e.httpFormFields={},!0)}},{key:"SetHTTPFormField",value:function(e,t,n){var i=this;if(i._resetErr(),!i._isValid())return!1;var o=e;return r.isString(o)||(o=""+o),t instanceof Blob&&(t.name=n),i.httpFormFields[o]=t,!0}},{key:"HTTPDownloadThroughPost",value:function(t,n,i,o,a,s){var u,c=this,l=c._GetHttpHeadersAndClear(),d=Jn.combineUrl(c,t,n);if(d===undefined)return r.Errors.ParameterCannotEmpty(c),Be;if(!r.License.checkProductKey(c,{Core:!0}))return r.isFunction(a)&&os(a,c,""),Be;if(!r.License.checkPDFProductKeyWhenNeeds(c,i))return r.isFunction(a)&&os(a,c,""),Be;r.cancelFrom=q.HTTPDownload,c.IfShowProgressBar?r.showProgress(c,"HttpDownloadThroughPost",!1):r.hideProgress();var f=Ve;c._OnPercentDone([0,-1,e.MSG.Downloading,"http"]),r.isFunction(o)||(f=Be);var h=function(){c.IfShowProgressBar&&r.closeProgress(null,"HttpDownloadThroughPost"),r.isFunction(o)&&o()},g=function(){c.IfShowProgressBar&&r.closeProgress(null,"HttpDownloadThroughPost"),r.isFunction(a)&&os(a,c,c.__HTTPPostResponseString)};return u=Jn.loadHttpBlob(c,"post",d,f,(function(r){c._OnPercentDone([0,-1,e.MSG.Loading]);var t=i;t!=e.DWT.EnumDWT_ImageType.IT_BMP&&t!=e.DWT.EnumDWT_ImageType.IT_JPG&&t!=e.DWT.EnumDWT_ImageType.IT_TIF&&t!=e.DWT.EnumDWT_ImageType.IT_PNG&&t!=e.DWT.EnumDWT_ImageType.IT_PDF&&t!=e.DWT.EnumDWT_ImageType.IT_J2K&&(t=-1);var n=c.__GetLoadEventsNum();c.__LoadImageFromBytesV1(r,t,"",n,f,h,g)}),g,(function(e){var r=0===e.total?100:Math.round(100*e.loaded/e.total);[e.loaded," / ",e.total].join(""),c._OnPercentDone([0,r,"","http"])}),l),u}},{key:"HTTPDownloadThroughGet",value:function(e,r,t,n,i){return this._innerHTTPDownloadThroughGet("HTTPDownload",e,r,t,n,i)}},{key:"HTTPUploadThroughPut",value:function(e,r,t,n,i){var o=Jn.getImageType(t);return this.HTTPUploadThroughPutEx(e,r,t,o,n,i)}},{key:"HTTPUploadThroughPutEx",value:function(t,n,i,o,a,s){var u=this,c=u._GetHttpHeadersAndClear(),l="HTTPUploadThroughPutEx",d=Jn.combineUrl(u,t,i),f=!0,h=[],g=!1,p=this.IfShowProgressBar;if(d===undefined)return r.Errors.ParameterCannotEmpty(u),r.isFunction(s)&&as(s,u,"",[n],i,o),!1;r.isFunction(a)||(f=!1),r.cancelFrom=q.HTTPUpload;var m,_=function(){return r.needShowTwiceShowDialog=!1,p&&r.closeProgress(null,l),r.isFunction(s)&&as(s,u,u.__HTTPPostResponseString,h,i,o),!1};switch(r.needShowTwiceShowDialog=!0,p?r.showProgress(u,l,!1):r.hideProgress(),n){case-1:for(var v=0;v<u._ImgManager.count();v++)h.push(v);break;case-2:h=u._ImgManager.getSelectedClientIndexArray();break;default:if(h.push(n),!(n>=0))return r.Errors.IndexOutOfRange(u),_()}if(""===t)return r.Errors.HttpServerCannotEmpty(u),_();var y=[];r.isArray(h)&&r.each(h,(function(e){var r=u._ImgManager.convertClientIndexToServerId(e);-1!=r&&y.push(r)}));p&&u._OnPercentDone([0,-1,e.MSG.Encoding,"http"]);var I=function(t,n,s){if(e.DWT.IfAddMD5InUploadHeader&&n&&""!=n&&(c["dwt-md5"]=n),r.needShowTwiceShowDialog=!1,t&&(!p||p&&r.dlgRef>0||0==f)){var h=u.__maxUploadImageSize;return t.size>h&&-1!=h?(r.Errors.UploadExceededMaxSize(u),_()):(m=function(e){var r=0===e.total?100:Math.round(100*e.loaded/e.total);[e.loaded," / ",e.total].join(""),p&&u._OnPercentDone([0,r,"","http"])},p&&u._OnPercentDone([0,-1,e.MSG.Uploading,"http"]),p&&sR(u.__IfShowCancelDialogWhenImageTransfer),g=Jn.httpPutImage(u,d,t,f,(function(e){if(e&&(u.__HTTPPostResponseString=e),p&&r.closeProgress(null,l),r.isFunction(a)){var t=[];r.isArray(y)&&r.each(y,(function(e){var r=u._ImgManager.convertServerIdToClientIndex(e);r>-1&&t.push(r)})),is(a,u.__HTTPPostResponseString,t,i,o)}return!0}),_,m),t=null,g)}return t=null,p&&r.closeProgress(null,l),!1};return f?(u._convertToBlobForUpload(o,y,false,4,I,_),g=!0):g=u._dwtConvertToBlobSync(o,y,false,I,_),g}},{key:"HTTPUploadAllThroughPutAsMultiPageTIFF",value:function(e,r,t,n){return this.HTTPUploadThroughPutEx(e,-1,r,2,t,n)}},{key:"HTTPUploadThroughPutAsMultiPageTIFF",value:function(e,r,t,n){return this.HTTPUploadThroughPutEx(e,-2,r,2,t,n)}},{key:"HTTPUploadAllThroughPutAsPDF",value:function(e,r,t,n){return this.HTTPUploadThroughPutEx(e,-1,r,4,t,n)}},{key:"HTTPUploadThroughPutAsMultiPagePDF",value:function(e,r,t,n){return this.HTTPUploadThroughPutEx(e,-2,r,4,t,n)}},{key:"GetSelectedImagesSize",value:function(e){var r=this;if(r._resetErr(),!r._isValid())return!1;var t=ii(r);return r._innerFun("GetSelectedImagesSize",kn(e,t.join(",")))}},{key:"SetHTTPHeader",value:function(e,t){var n=this;if(n._resetErr(),!n._isValid())return!1;var i,o,a=e;if(n.__httpHeaderMap||(n.__httpHeaderMap={}),!a||!r.isString(a))return r.isUndefined(a)?r.Errors.HttpHeaderIsUndefined(n):""===a?r.Errors.HttpHeaderIsEmpty(n):null===a?r.Errors.HttpHeaderIsNull(n):r.Errors.HttpHeaderIsInvalid(n),!1;for(i=["if-modified-since","if-none-match","if-range","range","accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"],a=a.toLowerCase(),o=0;o<i.length;o++)if(i[o]==a)return r.Errors.HttpHeaderNotAllowed(n),!1;return r.isUndefined(t)||null===t||""===t?(e in n.__httpHeaderMap&&delete n.__httpHeaderMap[e],!0):(r.isNumber(t)&&(t=""+t),n.__httpHeaderMap[e]=t,!0)}},{key:"ConvertToBlob",value:function(e,t,n,i,o){return r.cancelFrom=q.Other,this._convertToBlobByIndices(e,t,n,i,o)}},{key:"_asyncUploadFilesCmd",value:function(t,n,i,o,a,s,u,c,l,d,f,h){var g=this,p=parseInt(a),m="HTTPUpload",_=t,v=!0,y=[];g.__HTTPPostResponseString="",r.cancelFrom=q.HTTPUpload;var I=function(e,t,i){var o=[];if(r.isArray(n)&&r.each(n,(function(e){var r=g._ImgManager.convertServerIdToClientIndex(e);r>-1&&o.push(r)})),0!=e&&t&&(g._errorCode=e,g._errorString=t),i&&(g.__HTTPPostResponseString=i),g._bServerPercentDone=!0,r.needShowTwiceShowDialog=!1,c&&r.closeProgress(null,m),y.slice(0),y=null,r.isFunction(h))try{h({code:g._errorCode,message:g._errorString,response:i,indices:o})}catch(a){}return!1};r.needShowTwiceShowDialog=!0,c?r.showProgress(g,m,!1):r.hideProgress();var S=n.length,T=0,b=0,E="";return g._bServerPercentDone=!1,g._OnPercentDone([0,-1,e.MSG.Encoding,"http"]),r.each(n,(function(t,a){g._convertToBlobForUpload(p,[t],u,4,(function(t,u,h){if(!t||t.size<=0)return r.Errors.UploadFileCannotEmpty(g),I(g._errorCode,g._errorString);var p=g.__maxUploadImageSize;if(t.size>p&&-1!=p)return r.Errors.UploadExceededMaxSize(g),I(g._errorCode,g._errorString);var C=Jn.cformat(s,a+1);if(b=(T+1)/S*100,E=[T+1,"/",S].join(""),g._OnPercentDone([0,b,E,"http",C]),t.name=C,y.push(t),++T>=S){e.DWT.IfAddMD5InUploadHeader&&u&&""!=u&&(i["dwt-md5"]=u);var w=g._createHttpUploaderConfig(),k=new cR;g.__remoteFilename&&""!=g.__remoteFilename&&(k.remoteFilename=g.__remoteFilename),k.url=_,k.method=m,k.content=y,k.contentType=g._strHttpContentTypeFieldValue,k.headers=i,k.httpFormData=o,k.retry=l,k.bOnlyResponseEmptyIsOK=d,k.blockSize=g._moduleSize,v=aR(w,k,(function(e){g.__HTTPPostResponseString=w.HTTPPostResponse,function(e){if(g._bServerPercentDone=!0,r.needShowTwiceShowDialog=!1,c&&r.closeProgress(null,m),y.slice(0),y=null,r.isFunction(f)){var t=[];r.isArray(n)&&r.each(n,(function(e){var r=g._ImgManager.convertServerIdToClientIndex(e);r>-1&&t.push(r)})),is(f,e,t)}}(e)}),I)}t=null}),I,[t,a])})),v}},{key:"_getVersionInfoAsync",value:function(){return r.product.dwtVersionInfo?r.Promise.resolve(r.product.dwtVersionInfo):this._innerFunV2("VersionInfo")}},{key:"__innerLoadImage",value:function(t,n,i,o,a,s,u){var c=this;if(!r.License.checkProductKey(c,{Core:!0}))return r.isFunction(u)&&u(c._errorCode,c._getErrorString()),!1;if(!r.License.checkPDFProductKeyWhenNeeds(c,i))return r.isFunction(u)&&u(c._errorCode,c._getErrorString()),!1;if(r.isFunction(s)||e.DWT.ConnectWithSocket)return c._bRemoteMode&&c._getIfShowFileDialog()?(r.Errors.RemoteServiceCannotSetShowFileDialog(c),{code:c._errorCode,message:c._getErrorString()}):(c.__innerAcquireOrLoadImageAsync(t,n,o,!0).then(s,u),!0);if(c._bRemoteMode&&c._getIfShowFileDialog())return r.Errors.RemoteServiceCannotSetShowFileDialog(c),{code:c._errorCode,message:c._getErrorString()};var l=c._getCurrentDocumentName();return c.__innerLoadImageFun(t,n,a,l)}},{key:"__innerLoadImageFun",value:function(t,n,i,o){var a,s=this,u=!0;if(a=s._innerFunRaw(t,n,!1,!1,!0),s.__bOpenFileNow=!1,r.isArray(a.result)&&a.result.length>0){var c="",l=[];if(i){var d=a.result[0];r.isObject(d)?(c=d.ids,l=d.metaData):-1!=d||"LoadImage"!=t&&"LoadImageEx"!=t&&"FTPDownloadEx"!=t&&"FTPDownload"!=t&&"LoadImageFromBase64Binary"!=t||(u=!1)}else c=a.result.join(",");if(u)return r.isArray(l)||(l=[]),s._OnBitmapChanged(["c2",c,1,s._ImgManager.getCurrentImageIndex(),s._ImgManager.count(),l],null,o),s._blts&&e.DWT.lcvrf(s),!0}return r.Errors.bImageOnlyError_NotPurelyPDF(s._errorCode)&&r.Errors.LicenseNoPDF(s),!1}},{key:"__innerSaveImage",value:function(t,n,i,o){var a=this;if(a._OnPercentDone([0,-1,e.MSG.Encoding]),a._bRemoteMode||(e.DWT.IfAlwaysFocusOnPopupWindow?a._OnPageFocus(!0):a._OnPageBlur(!0)),!r.isFunction(o))return a._bRemoteMode?a._serviceSyncMethodNotSupport(t):this._innerFun(t,n);if(a._bRemoteMode&&a._getIfShowFileDialog())return r.Errors.RemoteServiceCannotSetShowFileDialog(a),{code:a._errorCode,message:a._getErrorString()};return a.IfShowProgressBar?r.showProgress(a,t,!1):r.hideProgress(),this._innerSend(t,n,!0,(function(){r.closeProgress(null,t),r.isFunction(i)&&i()}),(function(e){return r.isFunction(o)&&o(a._errorCode,a._getErrorString()),r.closeProgress(null,t),e&&r.error(e),!0})),!0}},{key:"__captureImage",value:function(e,r,t,n){var i=this.__GetLoadEventsNum();return this.__LoadImageFromBytesV2(e,r,"",!0,0,0,!0,i,t,n)}},{key:"_getIfShowFileDialog",value:function(){return this._resetErr(),this._isValid()?this._innerFun("IfShowFileDialog"):Be}},{key:"SaveAsBMP",value:function(t,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return!1;if(!(r.License.checkProductKey(a,{Core:!0})||e.navInfoSync.bWin&&r.License.checkProductKey(a,{Webcam:!0},!0)))return r.isFunction(o)&&o(a._errorCode,a._getErrorString()),!1;var s,u=Jn.replaceLocalFilename(t);if(!ni(a,n,o))return!1;if(e.navInfoSync.bAndroid){if(0==a._ImgManager.count())return r.Errors.NoImage(a),r.isFunction(o)&&o(a._errorCode,a._getErrorString()),!1;var c=[];return c.push(n),a._saveImages("SaveAsBMP",u,c,Bn.IT_BMP).then((function(){r.isFunction(i)&&i()}))["catch"]((function(e){r.isFunction(o)&&o(e.code,e.message)})),!0}return-1==(s=a._ImgManager.convertClientIndexToServerId(n))?(r.Errors.IndexOutOfRange(a),r.isFunction(o)&&os(o,a),!1):a.__innerSaveImage("SaveAsBMP",kn(u,s),i,o)}},{key:"SaveAsJPEG",value:function(t,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return!1;if(!(r.License.checkProductKey(a,{Core:!0})||e.navInfoSync.bWin&&r.License.checkProductKey(a,{Webcam:!0},!0)))return r.isFunction(o)&&o(a._errorCode,a._getErrorString()),!1;if(!ni(a,n,o))return!1;var s,u=Jn.replaceLocalFilename(t);if(e.navInfoSync.bAndroid){if(0==a._ImgManager.count())return r.Errors.NoImage(a),r.isFunction(o)&&o(a._errorCode,a._getErrorString()),!1;var c=[];return c.push(n),a._saveImages("SaveAsJPEG",u,c,Bn.IT_JPG).then((function(){r.isFunction(i)&&i()}))["catch"]((function(e){r.isFunction(o)&&o(e.code,e.message)})),!0}return-1==(s=a._ImgManager.convertClientIndexToServerId(n))?(r.Errors.IndexOutOfRange(a),r.isFunction(o)&&os(o,a),!1):a.__innerSaveImage("SaveAsJPEG",kn(u,s),i,o)}},{key:"SaveAsPDF",value:function(t,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return!1;if(!(r.License.checkProductKey(a,{Core:!0})||e.navInfoSync.bWin&&r.License.checkProductKey(a,{Webcam:!0},!0)))return r.isFunction(o)&&o(a._errorCode,a._getErrorString()),!1;if(!ni(a,n,o))return!1;var s,u=Jn.replaceLocalFilename(t);if(e.navInfoSync.bAndroid){if(0==a._ImgManager.count())return r.Errors.NoImage(a),r.isFunction(o)&&o(a._errorCode,a._getErrorString()),!1;var c=[];return c.push(n),a._saveImages("SaveAsPDF",u,c,Bn.IT_PDF).then((function(){r.isFunction(i)&&i()}))["catch"]((function(e){r.isFunction(o)&&o(e.code,e.message)})),!0}return-1==(s=a._ImgManager.convertClientIndexToServerId(n))?(r.Errors.IndexOutOfRange(a),r.isFunction(o)&&os(o,a),!1):a.__innerSaveImage("SaveAsPDF",kn(u,s),i,o)}},{key:"SaveAsPNG",value:function(t,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return!1;if(!(r.License.checkProductKey(a,{Core:!0})||e.navInfoSync.bWin&&r.License.checkProductKey(a,{Webcam:!0},!0)))return r.isFunction(o)&&o(a._errorCode,a._getErrorString()),!1;if(!ni(a,n,o))return!1;var s,u=Jn.replaceLocalFilename(t);if(e.navInfoSync.bAndroid){if(0==a._ImgManager.count())return r.Errors.NoImage(a),r.isFunction(o)&&o(a._errorCode,a._getErrorString()),!1;var c=[];return c.push(n),a._saveImages("SaveAsPNG",u,c,Bn.IT_PNG).then((function(){r.isFunction(i)&&i()}))["catch"]((function(e){r.isFunction(o)&&o(e.code,e.message)})),!0}return-1==(s=a._ImgManager.convertClientIndexToServerId(n))?(r.Errors.IndexOutOfRange(a),r.isFunction(o)&&os(o,a),!1):a.__innerSaveImage("SaveAsPNG",kn(u,s),i,o)}},{key:"SaveAsTIFF",value:function(t,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return!1;if(!(r.License.checkProductKey(a,{Core:!0})||e.navInfoSync.bWin&&r.License.checkProductKey(a,{Webcam:!0},!0)))return r.isFunction(o)&&o(a._errorCode,a._getErrorString()),!1;if(!ni(a,n,o))return!1;var s,u=Jn.replaceLocalFilename(t);if(e.navInfoSync.bAndroid){if(0==a._ImgManager.count())return r.Errors.NoImage(a),r.isFunction(o)&&o(a._errorCode,a._getErrorString()),!1;var c=[];return c.push(n),a._saveImages("SaveAsTIFF",u,c,Bn.IT_TIF).then((function(){r.isFunction(i)&&i()}))["catch"]((function(e){r.isFunction(o)&&o(e.code,e.message)})),!0}return-1==(s=a._ImgManager.convertClientIndexToServerId(n))?(r.Errors.IndexOutOfRange(a),r.isFunction(o)&&os(o,a),!1):a.__innerSaveImage("SaveAsTIFF",kn(u,s),i,o)}},{key:"SaveSelectedImagesAsMultiPagePDF",value:function(t,n,i){var o=this;if(o._resetErr(),!o._isValid())return!1;if(!(r.License.checkProductKey(o,{Core:!0})||e.navInfoSync.bWin&&r.License.checkProductKey(o,{Webcam:!0},!0)))return r.isFunction(i)&&i(o._errorCode,o._getErrorString()),!1;var a=Jn.replaceLocalFilename(t);if(e.navInfoSync.bAndroid){if(0==o._ImgManager.count())return r.Errors.NoImage(o),r.isFunction(i)&&i(o._errorCode,o._getErrorString()),!1;var s=oi(o);return o._saveImages("SaveSelectedImagesAsMultiPagePDF",a,s,Bn.IT_PDF).then((function(){r.isFunction(n)&&n()}))["catch"]((function(e){r.isFunction(i)&&i(e.code,e.message)})),!0}var u=ii(o);return o.__innerSaveImage("SaveSelectedImagesAsMultiPagePDF",kn(a,u.join(",")),n,i)}},{key:"SaveSelectedImagesAsMultiPageTIFF",value:function(t,n,i){var o=this;if(o._resetErr(),!o._isValid())return!1;if(!(r.License.checkProductKey(o,{Core:!0})||e.navInfoSync.bWin&&r.License.checkProductKey(o,{Webcam:!0},!0)))return r.isFunction(i)&&i(o._errorCode,o._getErrorString()),!1;var a=Jn.replaceLocalFilename(t);if(e.navInfoSync.bAndroid){if(0==o._ImgManager.count())return r.Errors.NoImage(o),r.isFunction(i)&&i(o._errorCode,o._getErrorString()),!1;var s=oi(o);return o._saveImages("SaveSelectedImagesAsMultiPageTIFF",a,s,Bn.IT_TIF).then((function(){r.isFunction(n)&&n()}))["catch"]((function(e){r.isFunction(i)&&i(e.code,e.message)})),!0}var u=ii(o);return o.__innerSaveImage("SaveSelectedImagesAsMultiPageTIFF",kn(a,u.join(",")),n,i)}},{key:"SaveAllAsMultiPageTIFF",value:function(t,n,i){var o=this;if(o._resetErr(),!o._isValid())return!1;if(!(r.License.checkProductKey(o,{Core:!0})||e.navInfoSync.bWin&&r.License.checkProductKey(o,{Webcam:!0},!0)))return r.isFunction(i)&&i(o._errorCode,o._getErrorString()),!1;if(!ti(o,i))return!1;var a=[],s=Jn.replaceLocalFilename(t);if(e.navInfoSync.bAndroid){if(0==o._ImgManager.count())return r.Errors.NoImage(o),r.isFunction(i)&&i(o._errorCode,o._getErrorString()),!1;for(var u=[],c=0;c<this._ImgManager.count();c++)u.push(c);return o._saveImages("SaveAllAsMultiPageTIFF",s,u,Bn.IT_TIF).then((function(){r.isFunction(n)&&n()}))["catch"]((function(e){r.isFunction(i)&&i(e.code,e.message)})),!0}return ri(o,a),o.__innerSaveImage("SaveSelectedImagesAsMultiPageTIFF",kn(s,a.join(",")),n,i)}},{key:"SaveAllAsPDF",value:function(t,n,i){var o=this;if(o._resetErr(),!o._isValid())return!1;if(!(r.License.checkProductKey(o,{Core:!0})||e.navInfoSync.bWin&&r.License.checkProductKey(o,{Webcam:!0},!0)))return r.isFunction(i)&&i(o._errorCode,o._getErrorString()),!1;if(!ti(o,i))return!1;var a=[],s=Jn.replaceLocalFilename(t);if(e.navInfoSync.bAndroid){if(0==o._ImgManager.count())return r.Errors.NoImage(o),r.isFunction(i)&&i(o._errorCode,o._getErrorString()),!1;for(var u=[],c=0;c<this._ImgManager.count();c++)u.push(c);return o._saveImages("SaveAllAsPDF",s,u,Bn.IT_PDF).then((function(){r.isFunction(n)&&n()}))["catch"]((function(e){r.isFunction(i)&&i(e.code,e.message)})),!0}return ri(o,a),o.__innerSaveImage("SaveSelectedImagesAsMultiPagePDF",kn(s,a.join(",")),n,i)}},{key:"HTTPUpload",value:function(t,n,i,o,a,s,u){var c=this,l=null!=a?a:"RemoteFile",d=c._GetHttpHeadersAndClear(),f=s,h=u;if(c._resetErr(),!c._isValid())return!1;if(arguments.length<=3)return f=n,h=i,this._innerFormFieldHTTPUpload(t,d,f,h);r.isFunction(arguments[4])&&r.isFunction(arguments[5])&&(l="RemoteFile",f=arguments[4],arguments.length>5&&(h=arguments[5]));var g,p=arguments,m=function(e){r.isFunction(h)&&as(h,c,c.__HTTPPostResponseString,e,p)};if(r.isUndefined(t)||""===t)return r.Errors.ParameterCannotEmpty(c),m&&m(n),!1;if(!r.isString(t))return r.Errors.InvalidUrl(c),m&&m(n),!1;if(!c._checkIndices(n))return m&&m(n),!1;var _=[];if(r.isArray(n)&&r.each(n,(function(e){var r=c._imageBufferWrapper.convertClientIndexToServerId(e);-1!=r&&_.push(r)})),0==_.length)return r.Errors.InvalidIndex(c),m&&m(n),!1;if(r.isUndefined(i))return r.Errors.InvalidImageType(c),m&&m(n),!1;if(i==e.DWT.EnumDWT_ImageType.IT_BMP||i==e.DWT.EnumDWT_ImageType.IT_JPG||i==e.DWT.EnumDWT_ImageType.IT_PNG){if(_.length>1)return r.Errors.UploadIndexMoreThanOne(c),m(n),!1}else if(i!=e.DWT.EnumDWT_ImageType.IT_TIF&&i!=e.DWT.EnumDWT_ImageType.IT_PDF)return r.Errors.InvalidImageType(c),m(n),!1;return r.isUndefined(o)||o!=e.DWT.EnumDWT_UploadDataFormat.Binary&&o!=e.DWT.EnumDWT_UploadDataFormat.Base64?(r.Errors.InvalidDataFormat(c),m(n),!1):(g={method:"HTTPUpload",url:t,serverIds:_,headers:d,formData:EO(c.httpFormFields),enumImageType:i,saveSetup:!1,dataFormat:o,fileName:l,retry:0,bOnlyResponseEmptyIsOK:!0,objUploadFileStatus:!1,asyncSuccessFunc:function(e,t){r.isFunction(f)&&is(f,c.__HTTPPostResponseString,t,p)},asyncFailureFunc:m},this._asyncUploadCmd(g),!0)}},{key:"_innerFormFieldHTTPUpload",value:function(t,n,i,o){var a,s=this,u="HTTPUpload",c=t,l=s.IfShowProgressBar;if(s.__HTTPPostResponseString="",a=function(e,t,n){return 0!=e&&t&&(s._errorCode=e,s._errorString=t),n&&(s.__HTTPPostResponseString=n),r.needShowTwiceShowDialog=!1,r.closeProgress(null,u),r.isFunction(o)&&as(o,s,s.__HTTPPostResponseString),!1},r.isUndefined(c)||""===c)return r.Errors.ParameterCannotEmpty(s),a(s._errorCode,s._getErrorString()),!1;if(!r.isString(c))return r.Errors.InvalidUrl(s),a(s._errorCode,s._getErrorString()),!1;0!=c.indexOf("http://")&&0!=c.indexOf("https://")&&(c=r.detect.ssl?"https://"+c:"http://"+c),s.__HTTPPostResponseString="",r.cancelFrom=q.HTTPUpload,l?r.showProgress(s,u,!1):r.hideProgress(),r.needShowTwiceShowDialog=!0,s._OnPercentDone([0,-1,e.MSG.Uploading,"http"]);var d=s._createHttpUploaderConfig(),f=new cR;return s.__remoteFilename&&""!=s.__remoteFilename&&(f.remoteFilename=s.__remoteFilename),f.url=c,f.method=u,f.content=[],f.headers=n,f.httpFormData=EO(s.httpFormFields),f.blockSize=s._moduleSize,(new uR).httpPostUpload(d,f,(function(e){r.needShowTwiceShowDialog=!1,r.closeProgress(null,u),r.isFunction(i)&&is(i,e,t,[t,i,o])}),a)}},{key:"HTTPUploadThroughPost",value:function(e,t,n,i,o,a,s){var u=this;if(u._resetErr(),!u._isValid())return!1;var c=Jn.getImageType(i),l=arguments,d=!1,f=function(e){return r.isFunction(a)&&as(a,u,u.__HTTPPostResponseString,e,l),!1};return r.isString(i)&&""!=i?(o&&r.isFunction(o)&&(d=function(e,r){return is(o,u.__HTTPPostResponseString,r,l),!0}),!!bO(u,t,c,f)&&dO(u,fO,vO).call(u,e,t,n,i,c,d,f,s)):(r.Errors.UploadFileCannotEmpty(u),f())}},{key:"HTTPUploadThroughPostEx",value:function(e,t,n,i,o,a,s,u){var c=this;if(c._resetErr(),!c._isValid())return!1;var l=arguments,d=!1,f=function(e){return r.isFunction(s)&&as(s,c,c.__HTTPPostResponseString,e,l),!1};return r.isString(i)&&""!=i?(a&&r.isFunction(a)&&(d=function(e,r){return is(a,c.__HTTPPostResponseString,r,l),!0}),!!bO(c,t,o,f)&&dO(c,fO,vO).call(c,e,t,n,i,o,d,f,u)):(r.Errors.UploadFileCannotEmpty(c),f())}},{key:"HTTPUploadAllThroughPostAsMultiPageTIFF",value:function(e,t,n,i,o,a){var s=this;if(s._resetErr(),!s._isValid())return!1;var u=arguments,c=!1,l=function(e){return r.isFunction(o)&&as(o,s,s.__HTTPPostResponseString,e,u),!1};return r.isString(n)&&""!=n?(i&&r.isFunction(i)&&(c=function(e,r){return is(i,s.__HTTPPostResponseString,r,u),!0}),dO(s,fO,vO).call(s,e,-1,t,n,2,c,l,a)):(r.Errors.UploadFileCannotEmpty(s),l())}},{key:"HTTPUploadAllThroughPostAsPDF",value:function(e,t,n,i,o,a){var s=this;if(s._resetErr(),!s._isValid())return!1;var u=arguments,c=!1,l=function(e){return r.isFunction(o)&&as(o,s,s.__HTTPPostResponseString,e,u),!1};return r.isString(n)&&""!=n?(i&&r.isFunction(i)&&(c=function(e,r){return is(i,s.__HTTPPostResponseString,r,u),!0}),dO(s,fO,vO).call(s,e,-1,t,n,4,c,l,a)):(r.Errors.UploadFileCannotEmpty(s),l())}},{key:"HTTPUploadThroughPostAsMultiPagePDF",value:function(e,t,n,i,o,a){var s=this;if(s._resetErr(),!s._isValid())return!1;var u=arguments,c=!1,l=function(e){return r.isFunction(o)&&as(o,s,s.__HTTPPostResponseString,e,u),!1};return r.isString(n)&&""!=n?(i&&r.isFunction(i)&&(c=function(e,r){return is(i,s.__HTTPPostResponseString,r,u),!0}),dO(s,fO,vO).call(s,e,-2,t,n,4,c,l,a)):(r.Errors.UploadFileCannotEmpty(s),l())}},{key:"HTTPUploadThroughPostAsMultiPageTIFF",value:function(e,t,n,i,o,a){var s=this;if(s._resetErr(),!s._isValid())return!1;var u=arguments,c=!1,l=function(e){return r.isFunction(o)&&as(o,s,s.__HTTPPostResponseString,e,u),!1};return r.isString(n)&&""!=n?(i&&r.isFunction(i)&&(c=function(e,r){return is(i,s.__HTTPPostResponseString,r,u),!0}),dO(s,fO,vO).call(s,e,-2,t,n,2,c,l,a)):(r.Errors.UploadFileCannotEmpty(s),l())}},{key:"_innerHTTPDownloadThroughGet",value:function(t,n,i,o,a,s){var u,c=this,l=c._GetHttpHeadersAndClear(),d=c.IfShowProgressBar,f=Jn.combineUrl(c,n,i);if(f===undefined)return r.Errors.ParameterCannotEmpty(c),r.isFunction(s)&&os(s,c),Be;if(!r.License.checkProductKey(c,{Core:!0}))return r.isFunction(s)&&os(s,c),Be;if(!r.License.checkPDFProductKeyWhenNeeds(c,o))return r.isFunction(s)&&os(s,c),Be;r.cancelFrom=q.HTTPDownload;var h=Ve;c._OnPercentDone([0,-1,e.MSG.Downloading,"http"]),r.isFunction(a)||(h=Be);var g=c._getCurrentDocumentName(),p=c._getCurrentDefaultTagName();return r.log("_innerHTTPDownloadThroughGet.currentFileName:"+g+", tag="+p),d&&h?r.showProgress(c,t,!1):h&&r.hideProgress(),u=Jn.loadHttpBlob(c,"get",f,h,(function(n){d&&h&&sR(!1),c._OnPercentDone([0,-1,e.MSG.Loading]);var i=o;i!=e.DWT.EnumDWT_ImageType.IT_BMP&&i!=e.DWT.EnumDWT_ImageType.IT_JPG&&i!=e.DWT.EnumDWT_ImageType.IT_TIF&&i!=e.DWT.EnumDWT_ImageType.IT_PNG&&i!=e.DWT.EnumDWT_ImageType.IT_PDF&&i!=e.DWT.EnumDWT_ImageType.IT_J2K&&(i=-1),n.currentFileName=g,n.currentTagName=p;var u=c.__GetLoadEventsNum();c.__LoadImageFromBytesV1(n,i,"",u,h,(function(){d&&h&&r.closeProgress(null,t),r.isFunction(a)&&a()}),(function(){d&&h&&r.closeProgress(null,t),r.isFunction(s)&&os(s,c)}))}),(function(){d&&h&&r.closeProgress(null,t),r.isFunction(s)&&os(s,c)}),(function(e){var r=0===e.total?100:Math.round(100*e.loaded/e.total);[e.loaded," / ",e.total].join(""),c._OnPercentDone([0,r,"","http"])}),l),u}},{key:"LoadImage",value:function(e,t,n){var i=this;if(i._resetErr(),!i._isValid())return!1;var o,a,s,u=Jn.replaceLocalFilename(e),c=Jn.getImageType(u);return t&&r.isFunction(t)&&(a=function(e){t()}),n&&r.isFunction(n)&&(s=function(){n(i._errorCode,i._getErrorString())}),o=i.__GetLoadEventsNum(),""==u&&(i.__bOpenFileNow=!0),i.__innerLoadImage("LoadImage",kn(u,o,1),c,!0,1,a,s)}},{key:"LoadImageEx",value:function(t,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return!1;var s,u,c,l=Jn.replaceLocalFilename(t),d=n;if(i&&r.isFunction(i)&&(u=function(e){i()}),o&&r.isFunction(o)&&(c=function(){o(a._errorCode,a._getErrorString())}),e.navInfoSync.bAndroid){var f=r.one(".d-loadImage");if(0==f.length){var h=document.createElement("input");h._stwain=a,h.setAttribute("type","file"),h.setAttribute("multiple","multiple"),h.style="position:absolute;top:-2px;left:-2px;width:1px;height:1px;",h.className="d-loadImage",n==e.DWT.EnumDWT_ImageType.IT_BMP?h.setAttribute("accept","image/bmp"):n==e.DWT.EnumDWT_ImageType.IT_JPG?h.setAttribute("accept","image/jpeg"):n==e.DWT.EnumDWT_ImageType.IT_TIF?h.setAttribute("accept","image/tiff"):n==e.DWT.EnumDWT_ImageType.IT_PNG?h.setAttribute("accept","image/png"):n==e.DWT.EnumDWT_ImageType.IT_PDF?h.setAttribute("accept",".pdf"):n==e.DWT.EnumDWT_ImageType.IT_J2K?h.setAttribute("accept",".jp2,.j2k,.j2c"):r.env.bMobile?h.setAttribute("accept","image/jpeg,image/png,image/tiff,image/tif"):h.setAttribute("accept","image/*,.pdf,.jp2,.j2k,.j2c"),h.ondoubleclick=function(){this.files.length>0&&this._stwain.LoadImageFromBinary(this.files,u,c),this.value="",this._stwain=null,h&&h.parentElement.removeChild(h)},h.onchange=function(){this.files.length>0&&this._stwain.LoadImageFromBinary(this.files,u,c),this.value="",this._stwain=null,h&&h.parentElement.removeChild(h)},document.body.appendChild(h),h.click()}else n==e.DWT.EnumDWT_ImageType.IT_BMP?f[0].setAttribute("accept","image/bmp"):n==e.DWT.EnumDWT_ImageType.IT_JPG?f[0].setAttribute("accept","image/jpeg"):n==e.DWT.EnumDWT_ImageType.IT_TIF?f[0].setAttribute("accept","image/tiff"):n==e.DWT.EnumDWT_ImageType.IT_PNG?f[0].setAttribute("accept","image/png"):n==e.DWT.EnumDWT_ImageType.IT_PDF?f[0].setAttribute("accept",".pdf"):n==e.DWT.EnumDWT_ImageType.IT_J2K?f[0].setAttribute("accept",".jp2,.j2k,.j2c"):r.env.bMobile?f[0].setAttribute("accept","image/jpeg,image/png,image/tiff,image/tif"):f[0].setAttribute("accept","image/*,.pdf,.jp2,.j2k,.j2c"),f[0].value="",f[0]._stwain=a,f[0].click();return!0}d==e.DWT.EnumDWT_ImageType.IT_ALL&&(d=-1),s=a.__GetLoadEventsNum(),""==l&&(a.__bOpenFileNow=!0);return a.__innerLoadImage("LoadImageEx",kn(l,d,s,1),d,!0,1,u,c)}},{key:"HTTPDownload",value:function(e,t,n,i){var o=this;if(o._resetErr(),!o._isValid())return r.Promise.reject({code:o._errorCode,message:o._getErrorString()});var a=Jn.getImageType(t);return o._innerHTTPDownloadThroughGet("HTTPDownload",e,t,a,n,i)}},{key:"HTTPDownloadEx",value:function(e,t,n,i,o){var a=this;return a._resetErr(),a._isValid()?a._innerHTTPDownloadThroughGet("HTTPDownloadEx",e,t,n,i,o):r.Promise.reject({code:a._errorCode,message:a._getErrorString()})}},{key:"getFormateDate",value:function(){var e=new Date,r=e.getFullYear(),t=e.getMonth()+1,n=e.getDate(),i=e.getHours(),o=e.getMinutes(),a=e.getSeconds();return t<=9&&(t="0"+t),n<=9&&(n="0"+n),i<=9&&(i="0"+i),o<=9&&(o="0"+o),a<=9&&(a="0"+a),{currentTime_title:r+"-"+t+"-"+n+" "+i+":"+o+":"+a,currentTime_info:t+"/"+n+"/"+r+" "+i+":"+o+":"+a}}},{key:"__shareImagesInner",value:function(e,t,n,i){var o=navigator;o.canShare&&o.canShare({files:e})&&o.share({files:e,title:t,text:this.getFormateDate().currentTime_info}).then((function(){r.isFunction(n)&&n()}))["catch"]((function(e){r.isFunction(i)&&i(e)}))}},{key:"ShareImages",value:(n=ne(de.mark((function a(t,n,i){var o,s,u,c,l,d,f,h,g;return de.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(o=this,!e.navInfoSync.bAndroid){a.next=39;break}if(i!=Bn.IT_ALL&&i!=Bn.IT_MULTIPAGE_PDF&&i!=Bn.IT_MULTIPAGE_TIF){a.next=5;break}throw r.Errors.SaveImagesErrorType(o),{code:o._errorCode,message:o._errorString};case 5:if(s=n.sort((function(e,r){return e-r})),!(s.length>0)){a.next=37;break}if(u="IMAGE File",i==Bn.IT_PDF&&(u="PDF File"),c=iR(t,i),r.isUndefined(c)&&(c=t),i!=Bn.IT_PDF&&i!=Bn.IT_TIF){a.next=15;break}return a.abrupt("return",new r.Promise((function(e,r){o.ConvertToBlob(s,i,(function(t,n,i){var a=[new File([t],c,{type:t.type})];o.__shareImagesInner(a,u,(function(){e()}),(function(e){r({code:0!=e.code?e.code:2201,message:e.message})}))}),(function(){r({code:o._errorCode,message:o._errorString})}))})));case 15:l=[],d=c,a.t0=i,a.next=a.t0===Bn.IT_BMP?20:a.t0===Bn.IT_JPG?22:a.t0===Bn.IT_PNG?24:26;break;case 20:return f=".bmp",a.abrupt("break",27);case 22:return f=".jpg",a.abrupt("break",27);case 24:return f=".png",a.abrupt("break",27);case 26:f=".jpg";case 27:c&&c.lastIndexOf(".")>0&&(d=c.substring(0,c.lastIndexOf(".")),f=c.substring(c.lastIndexOf("."),c.length)),h=de.mark((function p(e){return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new r.Promise((function(r,t){o.ConvertToBlob([s[e]],i,(function(t,n,i){0==e?l.push(new File([t],d+f,{type:t.type})):l.push(new File([t],d+e+f,{type:t.type})),r()}),(function(){t({code:o._errorCode,message:o._errorString})}))}));case 2:case"end":return t.stop()}}),p)})),g=0;case 31:if(!(g<s.length)){a.next=36;break}return a.delegateYield(h(g),"t1",33);case 33:g++,a.next=31;break;case 36:o.__shareImagesInner(l,u);case 37:a.next=41;break;case 39:throw r.Errors.ShareImagesOnlyForAndroid(o),{code:o._errorCode,message:o._errorString};case 41:case"end":return a.stop()}}),a,this)}))),function(e,r,t){return n.apply(this,arguments)})},{key:"Addon",get:function(){return this.__addon}},{key:"LoadDibFromClipboard",value:function(e,t){var n,i,o=this;if(o._resetErr(),!o._isValid())return!1;if(o._bRemoteMode)return r.Errors.RemoteServiceCannotLoadDibFromClipboard(o),{code:o._errorCode,message:o._getErrorString()};e&&r.isFunction(e)&&(n=function(r){e()}),t&&r.isFunction(t)&&(i=function(){t(o._errorCode,o._getErrorString())});var a;return a=o.__GetLoadEventsNum(),o.__innerLoadImage("LoadDibFromClipboard",kn(a,1),-1,!0,1,n,i)}},{key:"__innerGetBarcodeResultAsyncFunction",value:function(r){var t=e.Lib.NewBarcodeResult();return r&&(t._errorCode=r.exception,t._errorString=r.description,t._resultlist=r.result,t._Count=r.result.length),t}},{key:"__innerGetOCRResultAsyncFunction",value:function(r){var t=e.Lib.NewOCRResult(this);return r&&(t._errorCode=r.exception,t._errorString=r.description,t._resultlist=r.result),t}},{key:"__innerFTPDownloadDirectly",value:function(e,t,n,i,o){var a=this;return r.License.checkProductKey(a,{Core:!0})&&r.License.checkPDFProductKeyWhenNeeds(a,n)?(r.cancelFrom=q.FTPDownload,dO(a,pO,SO).call(a,e,t,!0,i,o)):(r.isFunction(o)&&o(a._errorCode,a._errorString),!1)}},{key:"__innerFTPUpload",value:function(e,t,n,i){return r.cancelFrom=q.FTPUpload,dO(this,pO,SO).call(this,e,t,!0,n,i)}},{key:"_GetHttpHeadersAndClear",value:function(){var e=this.__httpHeaderMap;return this.__httpHeaderMap={},e||(e={}),e}},{key:"_asyncUploadCmd",value:function(e){var t=this,n=e.url,i=e.asyncSuccessFunc,a=e.asyncFailureFunc,s=e.method,u=e.serverIds,c=e.headers,l=e.formData,d=e.enumImageType,f=e.dataFormat,h=e.fileName,g=e.saveSetup,p=e.retry,m=e.bOnlyResponseEmptyIsOK,_=e.objUploadFileStatus,v=function(e,n,i){var o=[];if(r.isArray(u)&&r.each(u,(function(e){var r=t._ImgManager.convertServerIdToClientIndex(e);r>-1&&o.push(r)})),0!=e&&n&&(t._errorCode=e,t._errorString=n),i&&(t.__HTTPPostResponseString=i),r.isFunction(a))try{a(o)}catch(s){}return!1};return r.isNumber(p)&&p>0||(p=0),0!=t._errorCode?v(t._errorCode,t._errorString,t.__HTTPPostResponseString):(t.__HTTPPostResponseString="",o._innerHTTPUpload(t,s,n,c,l,u,d,f,h,g,p,m,_,(function(e){if(r.isFunction(i)){var n=[];r.isArray(u)&&r.each(u,(function(e){var r=t._ImgManager.convertServerIdToClientIndex(e);r>-1&&n.push(r)}));try{is(i,e,n)}catch(o){}e=null}return!0}),v))}}],[{key:"_innerHTTPUpload",value:function(t,n,i,o,a,s,u,c,l,d,f,h,g,p,m){var _=parseInt(u),v=parseInt(c),y=l,I=i,S=t._segementUploadThreshold;if(r.isUndefined(u))return r.Errors.InvalidImageType(t),r.isFunction(m)&&m(t._errorCode,t._errorString,""),!1;t._resetErr(),r.cancelFrom=q.HTTPUpload;var T,b=function(e,i,o){return 0!=e&&i&&(t._errorCode=e,t._errorString=i),o&&(t.__HTTPPostResponseString=o),r.needShowTwiceShowDialog=!1,t.IfShowProgressBar&&r.closeProgress(null,n),r.isFunction(m)&&m(t._errorCode,t._errorString,t.__HTTPPostResponseString),!1},E=t._createHttpUploaderConfig();if(E.objUploadStatus=g,y=iR(y,_),r.needShowTwiceShowDialog=!0,t.IfShowProgressBar?(r.showProgress(t,n,!1),r.progressContext&&(r.progressContext._onPercent=function(e){var t=0;if(e){var n,i;n=e.loaded,i=e.total,(t=Math.floor(n/i*100))>100&&(t=100)}r.progressBarOnPercentDone(-1,"Transferring","",t,"")})):r.hideProgress(),v==e.DWT.EnumDWT_UploadDataFormat.Binary){if(g&&g.bCancel)return g.st=2,r.Errors.UserCanceled(t),b(t._errorCode,t._errorString);t._OnPercentDone([0,-1,e.MSG.Encoding,"http"]),t._convertToBlobForUpload(_,s,d,4,(function(i,s,u){if(T=function(e){return r.needShowTwiceShowDialog=!1,t.IfShowProgressBar&&r.closeProgress(null,n),r.isFunction(p)&&is(p,e),!0},g&&g.bCancel)return g.st=2,r.Errors.UserCanceled(t),b(t._errorCode,t._errorString);if(!i||i.size<=0)return r.Errors.UploadFileCannotEmpty(t),b(t._errorCode,t._errorString);var c=t.__maxUploadImageSize;if(i.size>c&&-1!=c)return r.Errors.UploadExceededMaxSize(t),b(t._errorCode,t._errorString);if(0!=t._errorCode)return b(t._errorCode,t._errorString);if(e.DWT.IfAddMD5InUploadHeader&&s&&""!=s&&(o["dwt-md5"]=s),S>0&&i.size>S){t._OnPercentDone([0,-1,e.MSG.Uploading,"http",y]);var l=new uR,d=new cR;return t.__remoteFilename&&""!=t.__remoteFilename&&(d.remoteFilename=t.__remoteFilename),d.url=I,d.method=n,d.content=i,i=null,d.contentType=t._strHttpContentTypeFieldValue,d.headers=o,d.fileName=y,d.httpFormData=a,d.retry=f,d.bOnlyResponseEmptyIsOK=h,d.blockSize=t._moduleSize,l.httpPostUploadFragment(E,d,T,b)}var m=new uR,_=new cR;t.__remoteFilename&&""!=t.__remoteFilename&&(_.remoteFilename=t.__remoteFilename),_.url=I,_.method=n,_.content=i,i=null,_.contentType=t._strHttpContentTypeFieldValue,_.headers=o,_.fileName=y,_.httpFormData=a,_.retry=f,_.bOnlyResponseEmptyIsOK=h,_.blockSize=t._moduleSize,E.objUploadStatus=g,m.httpPostUpload(E,_,T,b)}),b)}else if(v==e.DWT.EnumDWT_UploadDataFormat.Base64){t._convertToBase64ByServerIdsWithUI(n,s,_,d,4,(function(i){var s;if(!i||i.getLength()<=0)return r.Errors.UploadFileCannotEmpty(t),b(t._errorCode,t._errorString);if(T=function(){return r.needShowTwiceShowDialog=!1,t.IfShowProgressBar&&r.closeProgress(null,n),r.isFunction(p)&&is(p,i),!0},S>0&&i.getLength()>S){s=i.getMD5(),e.DWT.IfAddMD5InUploadHeader&&(o["dwt-md5"]=s),t._OnPercentDone([0,-1,e.MSG.Uploading,"http"]);var u=new cR;t.__remoteFilename&&""!=t.__remoteFilename&&(u.remoteFilename=t.__remoteFilename),u.url=I,u.method=n,u.content=i.getData(0,i.getLength()),u.headers=o,u.fileName=y,u.httpFormData=a,u.retry=f,u.bOnlyResponseEmptyIsOK=h,u.blockSize=t._moduleSize,u.offset=0,(new uR).httpPostUploadFragment(E,u,T,b)}else{var c;if(s=i.getMD5(),e.DWT.IfAddMD5InUploadHeader&&(o["dwt-md5"]=s),!(c=i.getData(0,i.getLength()))||""==c)return r.Errors.UploadFileCannotEmpty(t),b(t._errorCode,t._errorString);var l=new cR;t.__remoteFilename&&""!=t.__remoteFilename&&(l.remoteFilename=t.__remoteFilename),l.url=I,l.method=n,l.content=c,l.headers=o,l.fileName=y,l.httpFormData=a,l.retry=f,l.bOnlyResponseEmptyIsOK=h,l.blockSize=t._moduleSize,(new uR).httpPostUpload(E,l,T,b)}}),b)}return!0}}]),o}(nO);function vO(t,n,i,o,a,s,u,c){var l,d,f=this,h="HTTPUploadThroughPostEx",g=f._GetHttpHeadersAndClear(),p=Jn.combineUrl(f,t,i),m=!0,_=!1,v=[],y=function(e){return r.isFunction(u)&&u(e),!1};if(f.__HTTPPostResponseString="",r.isNumber(n)){if(n<-2)return r.Errors.IndexOutOfRange(f),y(n)}else if(!r.isArray(n))return r.Errors.IndexOutOfRange(f),y(n);if(!r.isString(o)||""==o)return r.Errors.UploadFileCannotEmpty(f),y();if(r.isUndefined(a))return r.Errors.InvalidImageType(f),y(n);if(a==e.DWT.EnumDWT_ImageType.IT_BMP||a==e.DWT.EnumDWT_ImageType.IT_JPG||a==e.DWT.EnumDWT_ImageType.IT_PNG||a==e.DWT.EnumDWT_ImageType.IT_J2K){if(-1==n&&f._ImgManager.count()>1||r.isArray(n)&&n.length>1)return r.Errors.UploadIndexMoreThanOne(f),y(n);r.isArray(n)?v.push(n[0]):-1==n?v.push(0):v.push(n)}else{if(a!=e.DWT.EnumDWT_ImageType.IT_TIF&&a!=e.DWT.EnumDWT_ImageType.IT_PDF)return r.Errors.InvalidImageType(f),y(n);if(-1==n){if(0==f._ImgManager.count())return r.Errors.NoImage(f),y();for(d=0;d<f._ImgManager.count();d++)v.push(d)}else if(-2==n)v=f._ImgManager.getSelectedClientIndexArray();else if(r.isArray(n))for(d=0;d<n.length;d++)v.push(n[d]);else v.push(n)}if(r.isFunction(s)||(m=!1),""===t)return r.Errors.HttpServerCannotEmpty(f),y(v);if(r.isUndefined(p)||""===p)return r.Errors.ParameterCannotEmpty(f),y(v);if(!r.isString(p))return r.Errors.InvalidUrl(f),y(v);if(0!=p.indexOf("http://")&&0!=p.indexOf("https://")&&(p=r.detect.ssl?"https://"+p:"http://"+p),!f._checkIndices(v)&&-1!=v)return y(v);var I=[];if(r.isArray(v)&&r.each(v,(function(e){var r=f._ImgManager.convertClientIndexToServerId(e);-1!=r&&I.push(r)})),f._resetErr(),!f._isValid())return!1;if(m)return l={method:"HTTPUploadThroughPostEx",url:p,serverIds:I,headers:g,formData:EO(f.httpFormFields),enumImageType:a,saveSetup:false,fileName:o,retry:0,bOnlyResponseEmptyIsOK:!0,objUploadFileStatus:!1,dataFormat:e.DWT.EnumDWT_UploadDataFormat.Binary,asyncSuccessFunc:s,asyncFailureFunc:y},this._asyncUploadCmd(l),!0;r.cancelFrom=q.HTTPUpload;var S=this.IfShowProgressBar,T=function(e,t,n){return 0!=e&&t&&(f._errorCode=e,f._errorString=t),n&&(f.__HTTPPostResponseString=n),r.needShowTwiceShowDialog=!1,S&&r.closeProgress(null,h),y(v),!1};return r.needShowTwiceShowDialog=!0,S?r.showProgress(f,h,!1):r.hideProgress(),f._OnPercentDone([0,-1,e.MSG.Encoding,"http"]),f._dwtConvertToBlobSync(a,I,false,(function(t,n){if(r.needShowTwiceShowDialog=!1,t){var i=f.__maxUploadImageSize;if(t.size>i&&-1!=i)return r.Errors.UploadExceededMaxSize(f),T(f._errorCode,f._errorString);e.DWT.IfAddMD5InUploadHeader&&n&&""!=n&&(g["dwt-md5"]=n),t instanceof File?t.fileName=o:t.name=o,S&&sR(f.__IfShowCancelDialogWhenImageTransfer);var a=f._createHttpUploaderConfig(),s=new cR;return f.__remoteFilename&&""!=f.__remoteFilename&&(s.remoteFilename=f.__remoteFilename),s.url=p,s.method=h,s.content=t,s.contentType=f._strHttpContentTypeFieldValue,s.headers=g,s.bAsync=m,s.httpFormData=EO(f.httpFormFields),s.blockSize=f._moduleSize,(new uR).httpPostUpload(a,s,(function(e){return S&&r.closeProgress(null,h),_=!0,!0}),T)}var u={};return r.Errors.UploadError(u),T(u._errorCode,u._errorString)}),T),_}function yO(e,t,n,i,o){var a=this;if(t)return a._innerFunRaw("SaveSelectedImagesToBytes",kn(0,0,e,n),t,true,!0,(function(e){if(r.isFunction(i)){var t=new Blob([e],{type:a._strHttpContentTypeFieldValue});i(t),t=null}}),o),!0;var s=a._innerFunRaw("SaveSelectedImagesToBytes",kn(0,0,e,n),t,true,!1);if(0==a._errorCode){var u=i(s);return s=null,u}return s=null,o(),!1}function IO(){return this._resetErr(),!!this._isValid()&&(this._innerSend("SetCancel",null,!0),!0)}function SO(e,t,n,i,o){var a=this;if(!r.isFunction(o))return this._innerFun(e,t);return a.IfShowProgressBar?(r.showProgress(a,e,n),n&&r.progressContext&&r.progressContext.on("cancel",(function(){dO(a,gO,IO).call(a)}))):r.hideProgress(),this._innerSend(e,t,!0,(function(){r.closeProgress(null,e),r.isFunction(i)&&i()}),(function(t){return r.isFunction(o)&&o(a._errorCode,a._getErrorString()),r.closeProgress(null,e),t&&r.error(t),!0})),!0}function TO(t,n,i,o,a){var s,u=this;if(!r.License.checkProductKey(u,{Core:!0}))return r.isFunction(a)&&a(u._errorCode,u._errorString),!1;if(!r.License.checkPDFProductKeyWhenNeeds(u,i))return r.isFunction(a)&&a(u._errorCode,u._errorString),!1;if(r.cancelFrom=q.FTPDownload,r.isFunction(a))return dO(u,pO,SO).call(u,t,n,!0,(function(){var t=u._ImgManager.getCurrentImageIndex();t>=0&&u._innerRefreshUI(t),u._blts&&e.DWT.lcvrf(u),r.isFunction(o)&&o()}),a);var c=u._getCurrentDocumentName();(s=u.__innerLoadImageFun(t,n,0,c))&&u._blts&&e.DWT.lcvrf(u);var l=u._ImgManager.getCurrentImageIndex();return l>=0&&u._innerRefreshUI(l),s}function bO(t,n,i,o){if(0==t._ImgManager.count())return r.Errors.NoImage(t),r.isFunction(o)&&o(n),!1;if(r.isNumber(n)){if(isNaN(n)||n<-2||n>=t._ImgManager.count())return r.Errors.IndexOutOfRange(t),r.isFunction(o)&&o(n),!1}else{if(!r.isArray(n))return r.Errors.IndexOutOfRange(t),r.isFunction(o)&&o(n),!1;var a;for(a=0;a<n.length;a++){var s=n[a];if(isNaN(s)||!r.isNumber(s)||s<0||s>=t._ImgManager.count())return r.Errors.IndicesOutOfRange(t),r.isFunction(o)&&o(n),!1}}if(i==e.DWT.EnumDWT_ImageType.IT_BMP||i==e.DWT.EnumDWT_ImageType.IT_JPG||i==e.DWT.EnumDWT_ImageType.IT_PNG||i==e.DWT.EnumDWT_ImageType.IT_J2K)(-1==n&&t._ImgManager.count()>1||r.isArray(n)&&n.length>1)&&(r.Errors.UploadIndexMoreThanOne(t),r.isFunction(o)&&o(n));else if(i!=e.DWT.EnumDWT_ImageType.IT_TIF&&i!=e.DWT.EnumDWT_ImageType.IT_PDF)return r.Errors.InvalidImageType(t),r.isFunction(o)&&o(n),!1;return!0}function EO(e){var t;return e&&(t=new FormData,r.each(e,(function(e,r){if(e instanceof Blob){var n=e.name;t.append(r,e,n)}else t.append(r,e)}))),t}function CO(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=Te(e);if(r){var i=Te(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return Se(this,t)}}var wO=function(t){Ie(i,t);var n=CO(i);function i(){return X(this,i),n.apply(this,arguments)}return Q(i,[{key:"Viewer",get:function(){return this._viewer}},{key:"BindViewer",value:function(t){var n=this,i=t;return e.DWT.UseDefaultViewer?(r.isString(t)&&(i=r.get(t),r.show(i)),n._config.container!=i&&(n._config.container=i,JR(n)),n._UIView.BindView(t)):(r.Errors.CannotBindViewerWhenNoViewerJS(n),!1)}},{key:"UnbindViewer",value:function(){return this._innerUnbindViewer(!1)}},{key:"AddText",value:function(e,t,n,i,o,a,s,u){var c=this,l=parseInt(e);if(!ai(c,l))return!1;var d=r.RGB2BGR(o),f=r.RGB2BGR(a),h=c._ImgManager.convertClientIndexToServerId(l);return-1==h?(r.Errors.IndexOutOfRange(c),!1):c._innerFun("AddText",kn(h,t,n,i,d,f,s,u))}},{key:"CreateTextFont",value:function(e,r,t,n,i,o,a,s,u,c,l,d,f,h){return this._resetErr(),!!this._isValid()&&this._innerFun("CreateTextFont",kn(e,r,t,n,i,o,a,s,u,c,l,d,f,h))}},{key:"CopyToClipboard",value:function(e){var r=parseInt(e);return!!ai(this,r)&&kO(this,"CopyToClipboard",r,null,null,!1,!1)}},{key:"CopyToClipboardAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return r.Promise.reject({code:t._errorCode,message:t._errorString});var n=parseInt(e);return isNaN(n)?(r.Errors.InvalidIndex(t),r.Promise.reject({code:t._errorCode,message:t._errorString})):n<0||n>=t._ImgManager.count()?(r.Errors.IndexOutOfRange(t),r.Promise.reject({code:t._errorCode,message:t._errorString})):function(e,t,n){var i=e._ImgManager.convertClientIndexToServerId(n);if(-1==i)return r.Errors.IndexOutOfRange(e),r.Promise.reject({code:e._errorCode,message:e._errorString});return e._innerFunV2(t,kn(i))}(t,"CopyToClipboard",n)}},{key:"getView",value:function(){return this._UIView}},{key:"Erase",value:function(e,t,n,i,o,a,s){var u=this;if(r.isFunction(a))return u.EraseAsync(e,t,n,i,o).then(a,(function(e){u._wrappeAsyncFailed(u,e,s)})),!0;var c,l=parseInt(e);if(!ai(u,l,s))return!1;var d=u._ImgManager.convertClientIndexToServerId(l);return-1==d?(r.Errors.IndexOutOfRange(u),r.isFunction(s)&&s(u._errorCode,u._getErrorString()),!1):(u.getView().ClearSelectedAreas(),(c=1==u._innerFun("Erase",kn(d,t,n,i,o)))?r.isFunction(a)&&a():r.isFunction(s)&&s(u._errorCode,u._getErrorString()),c)}},{key:"EraseAsync",value:function(e,t,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return r.Promise.reject({code:a._errorCode,message:a._errorString});var s=parseInt(e);if(isNaN(s))return r.Errors.InvalidIndex(a),r.Promise.reject({code:a._errorCode,message:a._errorString});if(s<0||s>=a._ImgManager.count())return r.Errors.IndexOutOfRange(a),r.Promise.reject({code:a._errorCode,message:a._errorString});var u=a._ImgManager.convertClientIndexToServerId(s);return-1==u?(r.Errors.IndexOutOfRange(a),r.Promise.reject({code:a._errorCode,message:a._errorString})):(a.getView().ClearSelectedAreas(),a._innerFunV2("Erase",kn(u,t,n,i,o),!0).then((function(e){if(1!=e)throw{code:a._errorCode,message:a._errorString}})))}},{key:"GetImageBitDepth",value:function(e){var t=this,n=parseInt(e);if(!ai(t,n))return!1;var i=t._ImgManager.convertClientIndexToServerId(n);return-1==i?(r.Errors.IndexOutOfRange(t),!1):t._innerFun("GetImageBitDepth",kn(i))}},{key:"GetImageWidth",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return!1;var n=parseInt(e);if(isNaN(n))return r.Errors.InvalidIndex(t),-1;if(n<0||n>=t._ImgManager.count())return r.Errors.IndexOutOfRange(t),-1;var i=t._ImgManager.convertClientIndexToServerId(n);return-1==i?(r.Errors.IndexOutOfRange(t),-1):t._innerFun("GetImageWidth",kn(i))}},{key:"GetImageHeight",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return!1;var n=parseInt(e);if(isNaN(n))return r.Errors.InvalidIndex(t),-1;if(n<0||n>=t._ImgManager.count())return r.Errors.IndexOutOfRange(t),-1;var i=t._ImgManager.convertClientIndexToServerId(n);return-1==i?(r.Errors.IndexOutOfRange(t),-1):t._innerFun("GetImageHeight",kn(i))}},{key:"GetImageSize",value:function(e,t,n){var i=this;if(i._resetErr(),!i._isValid())return!1;var o=parseInt(e);if(isNaN(o))return r.Errors.InvalidIndex(i),-1;if(o<0||o>=i._ImgManager.count())return r.Errors.IndexOutOfRange(i),-1;var a=i._ImgManager.convertClientIndexToServerId(o);return-1==a?(r.Errors.IndexOutOfRange(i),-1):i._innerFun("GetImageSize",kn(a,t,n))}},{key:"GetImageSizeWithSpecifiedType",value:function(e,t){var n=this;if(n._resetErr(),!n._isValid())return!1;var i=parseInt(e);if(isNaN(i))return r.Errors.InvalidIndex(n),-1;if(i<0||i>=n._ImgManager.count())return r.Errors.IndexOutOfRange(n),-1;var o=n._ImgManager.convertClientIndexToServerId(i);return-1==o?(r.Errors.IndexOutOfRange(n),-1):n._innerFun("GetImageSizeWithSpecifiedType",kn(o,t))}},{key:"GetImageXResolution",value:function(e){var t=this,n=parseInt(e);if(!ai(t,n))return!1;var i=t._ImgManager.convertClientIndexToServerId(n);return-1==i?(r.Errors.IndexOutOfRange(t),!1):t._innerFun("GetImageXResolution",kn(i))}},{key:"GetImageYResolution",value:function(e){var t=this,n=parseInt(e);if(!ai(t,n))return!1;var i=t._ImgManager.convertClientIndexToServerId(n);return-1==i?(r.Errors.IndexOutOfRange(t),!1):t._innerFun("GetImageYResolution",kn(i))}},{key:"SelectAllImages",value:function(){var e,r=this,t=r._getHowManyImagesInBuffer(),n=[];if(r._resetErr(),!r._isValid())return!1;for(e=0;e<t;e++)n.push(e);return r._ImgManager.setSelectedClientIndexArray(n),n}},{key:"SelectImages",value:function(e){var r=this;return r._resetErr(),!!r._isValid()&&r._ImgManager.setSelectedClientIndexArray(e)}},{key:"GetSkewAngle",value:function(e,t,n){var i,o=this;if(r.isFunction(t))return o.GetSkewAngleAsync(e).then(t,(function(e){o._wrappeAsyncFailed(o,e,n)})),!0;var a=parseInt(e);return!!ai(o,a,n)&&(i=kO(o,"GetSkewAngle",a,t,n,!0,!1),0==o._errorCode?(Jn.refreshImageAfterInvokeFun(o,a),r.isFunction(t)&&t(i),i):(r.isFunction(n)&&n(o._errorCode,o._errorString),0))}},{key:"GetSkewAngleAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return r.Promise.reject({code:t._errorCode,message:t._errorString});var n=parseInt(e);if(isNaN(n))return r.Errors.InvalidIndex(t),r.Promise.reject({code:t._errorCode,message:t._errorString});if(n<0||n>=t._ImgManager.count())return r.Errors.IndexOutOfRange(t),r.Promise.reject({code:t._errorCode,message:t._errorString});var i=t._ImgManager.convertClientIndexToServerId(n);return-1==i?(r.Errors.IndexOutOfRange(t),r.Promise.reject({code:t._errorCode,message:t._errorString})):t._innerFunV2("GetSkewAngle",kn(i),!0).then((function(e){var i=e;return r.isArray(e)&&(i=e.length>0?e[0]:0),Jn.refreshImageAfterInvokeFun(t,n),i}))}},{key:"GetSkewAngleEx",value:function(e,t,n,i,o){var a=this,s=parseInt(e);if(!ai(a,s))return!1;var u=a._ImgManager.convertClientIndexToServerId(s);return-1==u?(r.Errors.IndexOutOfRange(a),!1):a._innerFun("GetSkewAngleEx",kn(u,t,n,i,o))}},{key:"GetSkewAngleFromBinaryAsync",value:function(e,t,n,i){var o=this;if(o._resetErr(),!o._isValid())return r.Promise.reject({code:o._errorCode,message:o._errorString});var a=this._imageBufferWrapper.getMetadataByIndex(e),s={imageId:this._ImgManager.convertClientIndexToServerId(e),bufferLen:t.size,imageType:Bn.IT_BMP,width:a.width,height:a.height,bit:a.bitDepth,xres:a.resolutionX,yres:a.resolutionY},u=r.stringify([r.stringify(s)]);return this._innerSendBlob("GetSkewAngleFromBinary",u,t,!0,!0,n,i)}},{key:"IsBlankImageEx",value:function(e,t,n,i,o,a){var s,u=this;if(!ai(u,s=parseInt(e)))return!1;var c=u._ImgManager.convertClientIndexToServerId(s);return-1==c?(r.Errors.IndexOutOfRange(u),!1):u._innerFun("IsBlankImageEx",kn(c,t,n,i,o,a))}},{key:"MirrorAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return r.Promise.reject({code:t._errorCode,message:t._errorString});var n=parseInt(e);if(isNaN(n))return r.Errors.InvalidIndex(t),r.Promise.reject({code:t._errorCode,message:t._errorString});if(n<0||n>=t._ImgManager.count())return r.Errors.IndexOutOfRange(t),r.Promise.reject({code:t._errorCode,message:t._errorString});var i=t._ImgManager.convertClientIndexToServerId(n);return-1==i?(r.Errors.IndexOutOfRange(t),r.Promise.reject({code:t._errorCode,message:t._errorString})):t._innerFunV2("Mirror",kn(i),!0).then((function(e){if(1!=e)throw{code:t._errorCode,message:t._errorString};Jn.refreshImageAfterInvokeFun(t,n),t.getView().ClearSelectedAreas()}))}},{key:"Mirror",value:function(e,t,n){var i=this;if(r.isFunction(t))return i.MirrorAsync(e).then(t,(function(e){i._wrappeAsyncFailed(i,e,n)})),!0;var o=parseInt(e);return!!ai(i,o,n)&&kO(i,"Mirror",o,t,n,!1,!0)}},{key:"RemoveAllImages",value:function(){return this._removeAllImages("RemoveAllImages")}},{key:"RemoveAllImagesAsync",value:function(){return this._removeAllImagesAsync("RemoveAllImagesAsync",!0)}},{key:"RemoveImageAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return r.Promise.reject({code:t._errorCode,message:t._errorString});var n=parseInt(e);if(isNaN(n))return r.Errors.InvalidIndex(t),r.Promise.reject({code:t._errorCode,message:t._errorString});if(n<0||n>=t._ImgManager.count())return r.Errors.IndexOutOfRange(t),r.Promise.reject({code:t._errorCode,message:t._errorString});var i=t._ImgManager.convertClientIndexToServerId(n);return-1==i?(r.Errors.IndexOutOfRange(t),r.Promise.reject({code:t._errorCode,message:t._errorString})):t._innerFunV2("RemoveImage",kn(i),!0).then((function(e){return!(!e&&-1033!=t._errorCode)&&(t._OnBitmapChanged(["0",""+i,3,t._ImgManager.getCurrentImageIndex(),t._ImgManager.count()]),!0)}))}},{key:"Rotate",value:function(e,r,t,n,i){return this.RotateEx(e,r,t,-1,n,i)}},{key:"_wrappeAsyncFailed",value:function(e,t,n){t&&(e._errorCode=t.code,e._errorString=t.message),r.isFunction(n)&&n(e._errorCode,e._getErrorString())}},{key:"RotateEx",value:function(e,t,n,i,o,a){var s=this;if(r.isFunction(o))return s.RotateExAsync(e,t,n,i).then(o,(function(e){s._wrappeAsyncFailed(s,e,a)})),!0;if(s._resetErr(),!s._isValid())return!1;var u,c=parseInt(e);if(isNaN(c))return r.Errors.InvalidIndex(s),r.isFunction(a)&&a(s._errorCode,s._getErrorString()),!1;if(c<0||c>=s._ImgManager.count())return r.Errors.IndexOutOfRange(s),r.isFunction(a)&&a(s._errorCode,s._getErrorString()),!1;var l=s._ImgManager.convertClientIndexToServerId(c);return-1==l?(r.Errors.IndexOutOfRange(s),r.isFunction(a)&&a(s._errorCode,s._getErrorString()),!1):((u=1==s._innerFun("RotateEx",kn(l,t,n,i)))?(Jn.refreshImageAfterInvokeFun(s,c),s.getView().ClearSelectedAreas(),r.isFunction(o)&&o()):r.isFunction(a)&&a(s._errorCode,s._getErrorString()),u)}},{key:"RotateLeft",value:function(e,r,t){return this.RotateEx(e,-90,!0,-1,r,t)}},{key:"RotateRight",value:function(e,r,t){return this.RotateEx(e,90,!0,-1,r,t)}},{key:"RotateAsync",value:function(e,r,t){return this.RotateExAsync(e,r,t,-1)}},{key:"RotateExAsync",value:function(e,t,n,i){var o=this;if(o._resetErr(),!o._isValid())return r.Promise.reject({code:o._errorCode,message:o._errorString});var a=parseInt(e);if(isNaN(a))return r.Errors.InvalidIndex(o),r.Promise.reject({code:o._errorCode,message:o._errorString});if(a<0||a>=o._ImgManager.count())return r.Errors.IndexOutOfRange(o),r.Promise.reject({code:o._errorCode,message:o._errorString});var s=o._ImgManager.convertClientIndexToServerId(a);return-1==s?(r.Errors.IndexOutOfRange(o),r.Promise.reject({code:o._errorCode,message:o._errorString})):o._innerFunV2("RotateEx",kn(s,t,n,i),!0).then((function(e){if(1!=e&&1!=e)throw{code:o._errorCode,message:o._errorString};Jn.refreshImageAfterInvokeFun(o,a),o.getView().ClearSelectedAreas()}))}},{key:"RotateLeftAsync",value:function(e){return this.RotateExAsync(e,-90,!0,-1)}},{key:"RotateRightAsync",value:function(e){return this.RotateExAsync(e,90,!0,-1)}},{key:"ChangeImageSize",value:function(e,t,n,i,o,a){var s=this;if(r.isFunction(o))return s.ChangeImageSizeAsync(e,t,n,i).then(o,(function(e){s._wrappeAsyncFailed(s,e,a)})),!0;var u,c=parseInt(e),l=1*t,d=1*n;if(!ai(s,c,a))return!1;if(l<=0||d<=0)return r.Errors.InvalidWidthOrHeight(s),r.isFunction(a)&&a(s._errorCode,s._getErrorString()),!1;var f=s._ImgManager.convertClientIndexToServerId(c);return-1==f?(r.Errors.IndexOutOfRange(s),r.isFunction(a)&&a(s._errorCode,s._getErrorString()),!1):((u=1==s._innerFun("ChangeImageSize",kn(f,l,d,i)))?(Jn.refreshImageAfterInvokeFun(s,c),r.isFunction(o)&&o()):r.isFunction(a)&&a(s._errorCode,s._getErrorString()),u)}},{key:"ChangeImageSizeAsync",value:function(e,t,n,i){var o=this,a=parseInt(e),s=1*t,u=1*n;if(o._resetErr(),!o._isValid())return r.Promise.reject({code:o._errorCode,message:o._errorString});if(isNaN(a))return r.Errors.InvalidIndex(o),r.Promise.reject({code:o._errorCode,message:o._errorString});if(a<0||a>=o._ImgManager.count())return r.Errors.IndexOutOfRange(o),r.Promise.reject({code:o._errorCode,message:o._errorString});if(s<=0||u<=0)return r.Errors.InvalidWidthOrHeight(o),r.Promise.reject({code:o._errorCode,message:o._errorString});var c=o._ImgManager.convertClientIndexToServerId(a);return-1==c?(r.Errors.IndexOutOfRange(o),r.Promise.reject({code:o._errorCode,message:o._errorString})):o._innerFunV2("ChangeImageSize",kn(c,s,u,i),!0).then((function(e){if(1!=e)throw{code:o._errorCode,message:o._errorString};Jn.refreshImageAfterInvokeFun(o,a)}))}},{key:"Flip",value:function(e,t,n){var i=this;if(r.isFunction(t))return i.FlipAsync(e).then(t,(function(e){i._wrappeAsyncFailed(i,e,n)})),!0;var o=parseInt(e);return!!ai(i,o,n)&&kO(i,"Flip",o,t,n,!1,!0)}},{key:"FlipAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return r.Promise.reject({code:t._errorCode,message:t._errorString});var n=parseInt(e);if(isNaN(n))return r.Errors.InvalidIndex(t),r.Promise.reject({code:t._errorCode,message:t._errorString});if(n<0||n>=t._ImgManager.count())return r.Errors.IndexOutOfRange(t),r.Promise.reject({code:t._errorCode,message:t._errorString});var i=t._ImgManager.convertClientIndexToServerId(n);return-1==i?(r.Errors.IndexOutOfRange(t),r.Promise.reject({code:t._errorCode,message:t._errorString})):t._innerFunV2("Flip",kn(i),!0).then((function(e){if(1!=e)throw{code:t._errorCode,message:t._errorString};Jn.refreshImageAfterInvokeFun(t,n),t.getView().ClearSelectedAreas()}))}},{key:"Crop",value:function(e,t,n,i,o,a,s){var u=this;if(r.isFunction(a))return u.CropAsync(e,t,n,i,o).then(a,(function(e){u._wrappeAsyncFailed(u,e,s)})),!0;var c,l=parseInt(e);if(!ai(u,l,s))return!1;var d,f,h=u._ImgManager.convertClientIndexToServerId(l);return-1==h?(r.Errors.IndexOutOfRange(u),r.isFunction(s)&&s(u._errorCode,u._getErrorString()),!1):(c=1==u._innerFun("Crop",kn(h,t,n,i,o)),d=u._errorCode,f=u._getErrorString(),u.getView().ClearSelectedAreas(),u._errorCode=d,u._errorString=f,c?(Jn.refreshImageAfterInvokeFun(u,l),r.isFunction(a)&&a()):r.isFunction(s)&&s(d,f),c)}},{key:"CropAsync",value:function(e,t,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return r.Promise.reject({code:a._errorCode,message:a._errorString});var s=parseInt(e);if(isNaN(s))return r.Errors.InvalidIndex(a),r.Promise.reject({code:a._errorCode,message:a._errorString});if(s<0||s>=a._ImgManager.count())return r.Errors.IndexOutOfRange(a),r.Promise.reject({code:a._errorCode,message:a._errorString});var u=a._ImgManager.convertClientIndexToServerId(s);return-1==u?(r.Errors.IndexOutOfRange(a),r.Promise.reject({code:a._errorCode,message:a._errorString})):a._innerFunV2("Crop",kn(u,t,n,i,o),!0).then((function(e){var r,t;if(r=a._errorCode,t=a._getErrorString(),a.getView().ClearSelectedAreas(),a._errorCode=r,a._errorString=t,1!=e)throw{code:a._errorCode,message:a._errorString};return Jn.refreshImageAfterInvokeFun(a,s),!0}))}},{key:"CropToClipboard",value:function(e,t,n,i,o){var a,s=this,u=parseInt(e);if(!ai(s,u))return!1;var c=s._ImgManager.convertClientIndexToServerId(u);return-1==c?(r.Errors.IndexOutOfRange(s),!1):(s.getView().ClearSelectedAreas(),(a=1==s._innerFun("CropToClipboard",kn(c,t,n,i,o)))&&Jn.refreshImageAfterInvokeFun(s,u),a)}},{key:"CutFrameToClipboard",value:function(e,t,n,i,o){var a,s=this,u=parseInt(e);if(!ai(s,u))return!1;var c=s._ImgManager.convertClientIndexToServerId(u);return-1==c?(r.Errors.IndexOutOfRange(s),!1):(s.getView().ClearSelectedAreas(),(a=1==s._innerFun("CutFrameToClipboard",kn(c,t,n,i,o)))&&Jn.refreshImageAfterInvokeFun(s,u),a)}},{key:"CutToClipboard",value:function(e){var t,n=this,i=parseInt(e);if(!ai(n,i))return!1;var o=n._ImgManager.convertClientIndexToServerId(i);return-1==o?(r.Errors.IndexOutOfRange(n),!1):((t=1==n._innerFun("CutToClipboard",kn(o)))&&n._OnBitmapChanged(["0",""+o,3,n._ImgManager.getCurrentImageIndex(),n._ImgManager.count()]),t)}},{key:"CutFrameToClipboardAsync",value:function(e,t,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return r.Promise.reject({code:a._errorCode,message:a._errorString});var s=parseInt(e);if(isNaN(s))return r.Errors.InvalidIndex(a),r.Promise.reject({code:a._errorCode,message:a._errorString});if(s<0||s>=a._ImgManager.count())return r.Errors.IndexOutOfRange(a),r.Promise.reject({code:a._errorCode,message:a._errorString});var u=a._ImgManager.convertClientIndexToServerId(s);return-1==u?(r.Errors.IndexOutOfRange(a),r.Promise.reject({code:a._errorCode,message:a._errorString})):a._innerFunV2("CutFrameToClipboard",kn(u,t,n,i,o)).then((function(e){var r=1==e;if(!r)throw{code:a._errorCode,message:a._errorString};return Jn.refreshImageAfterInvokeFun(a,s),r}))}},{key:"CropToClipboardAsync",value:function(e,t,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return r.Promise.reject({code:a._errorCode,message:a._errorString});var s=parseInt(e);if(isNaN(s))return r.Errors.InvalidIndex(a),r.Promise.reject({code:a._errorCode,message:a._errorString});if(s<0||s>=a._ImgManager.count())return r.Errors.IndexOutOfRange(a),r.Promise.reject({code:a._errorCode,message:a._errorString});var u=a._ImgManager.convertClientIndexToServerId(s);return-1==u?(r.Errors.IndexOutOfRange(a),r.Promise.reject({code:a._errorCode,message:a._errorString})):a._innerFunV2("CropToClipboard",kn(u,t,n,i,o)).then((function(e){var r=1==e;if(!r)throw{code:a._errorCode,message:a._errorString};return Jn.refreshImageAfterInvokeFun(a,s),r}))}},{key:"CutToClipboardAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return r.Promise.reject({code:t._errorCode,message:t._errorString});var n=parseInt(e);if(isNaN(n))return r.Errors.InvalidIndex(t),r.Promise.reject({code:t._errorCode,message:t._errorString});if(n<0||n>=t._ImgManager.count())return r.Errors.IndexOutOfRange(t),r.Promise.reject({code:t._errorCode,message:t._errorString});var i=t._ImgManager.convertClientIndexToServerId(n);return-1==i?(r.Errors.IndexOutOfRange(t),r.Promise.reject({code:t._errorCode,message:t._errorString})):t._innerFunV2("CutToClipboard",kn(i)).then((function(e){var r=1==e;if(!r)throw{code:t._errorCode,message:t._errorString};return t._OnBitmapChanged(["0",""+i,3,t._ImgManager.getCurrentImageIndex(),t._ImgManager.count()]),r}))}},{key:"SetDPI",value:function(e,t,n,i,o,a,s){var u,c=this,l=parseInt(e);if(!ai(c,l,s))return!1;var d=c._ImgManager.convertClientIndexToServerId(l);return-1==d?(r.Errors.IndexOutOfRange(c),r.isFunction(s)&&s(c._errorCode,c._getErrorString()),!1):((u=1==c._innerFun("SetDPI",kn(d,t,n,i,o)))?r.isFunction(a)&&a():r.isFunction(s)&&s(c._errorCode,c._getErrorString()),u)}},{key:"MoveImage",value:function(e,t){var n=this;if(n._resetErr(),!n._isValid())return!1;var i=parseInt(e),o=parseInt(t);return isNaN(i)||isNaN(o)?(r.Errors.InvalidIndex(n),!1):i<0||i>=n._ImgManager.count()||o<0||o>=n._ImgManager.count()?(r.Errors.IndexOutOfRange(n),!1):n._ImgManager.moveImage(i,o)}},{key:"SwitchImage",value:function(e,t){var n=this;if(n._resetErr(),!n._isValid())return!1;var i=parseInt(e),o=parseInt(t);return isNaN(i)||isNaN(o)?(r.Errors.InvalidIndex(n),!1):i<0||i>=n._ImgManager.count()||o<0||o>=n._ImgManager.count()?(r.Errors.IndexOutOfRange(n),!1):n._ImgManager.switchImage(i,o)}},{key:"CloseWorkingProcess",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._innerFun("CloseWorkerProcess")}},{key:"RemoveAllSelectedImages",value:function(){var e=this;if(e._resetErr(),!e._isValid())return!1;var t=!0,n=e._ImgManager.getCurrentImageIndex(),i=e._ImgManager.getSelectedClientIndexArray(),o=[];if(r.isArray(i)&&r.each(i,(function(r){var t=e._ImgManager.convertClientIndexToServerId(r);-1!=t&&o.push(t)})),0==o.length&&n>=0){var a=e._ImgManager.convertClientIndexToServerId(n);o.push(a)}return o.length>0&&(t=e._innerFun("RemoveAllSelectedImages",kn(o.join(",")))),t&&r.each(o,(function(r){e._OnBitmapChanged(["0",""+r,3,e._ImgManager.getCurrentImageIndex(),e._ImgManager.count()])})),t}},{key:"RemoveAllSelectedImagesAsync",value:function(){var e=this;if(e._resetErr(),!e._isValid())return r.Promise.reject({code:e._errorCode,message:e._errorString});var t=e._ImgManager.getCurrentImageIndex(),n=e._ImgManager.getSelectedClientIndexArray(),i=[];if(r.isArray(n)&&r.each(n,(function(r){var t=e._ImgManager.convertClientIndexToServerId(r);-1!=t&&i.push(t)})),0==i.length&&t>=0){var o=e._ImgManager.convertClientIndexToServerId(t);i.push(o)}return i.length>0?e._innerFunV2("RemoveAllSelectedImages",kn(i.join(","),!0)).then((function(t){t&&r.each(i,(function(r){e._OnBitmapChanged(["0",""+r,3,e._ImgManager.getCurrentImageIndex(),e._ImgManager.count()])}))})):r.Promise.resolve()}},{key:"TagImages",value:function(e,t){var n=this;if(n._resetErr(),!n._isValid())return!1;var i=!0,o=n._ImgManager.count();return r.isArray(e)?r.isString(t)&&""!=t?(r.each(e,(function(e){if(isNaN(e)||e<0||e>=o)return r.Errors.IndexOutOfRange(n),i=!1})),i?n._ImgManager.addImageTag(e,t):i):(r.Errors.InvalidTagName(n),!1):(r.Errors.IndicesNotArray(n),!1)}},{key:"ClearImageTags",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&(-1==e||e>=t._getHowManyImagesInBuffer()?(r.Errors.IndexOutOfRange(t),!1):t._ImgManager.removeImageTag(e))}},{key:"SetDefaultTag",value:function(e){var r=this;return r._resetErr(),!!r._isValid()&&r._ImgManager.setDefaultTag(e)}},{key:"FilterImagesByTag",value:function(e,r,t){var n=this;return n._resetErr(),!!n._isValid()&&n._ImgManager.showImagesByFilter(e,r,t)}},{key:"ClearFilter",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._ImgManager.clearFilter()}},{key:"CreateDocument",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&(e&&""!=e?r.isString(e)?t._ImgManager.CreateFile(e):(r.Errors.FileNameNotString(t),!1):(r.isNumber(e)?r.Errors.FileNameNotString(t):r.Errors.FileNameCannotEmpty(t),!1))}},{key:"OpenDocument",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&(e&&""!=e?r.isString(e)?t._ImgManager.OpenFile(e):(r.Errors.FileNameNotString(t),!1):(r.isNumber(e)?r.Errors.FileNameNotString(t):r.Errors.FileNameCannotEmpty(t),!1))}},{key:"RemoveDocument",value:function(e){var r=this;if(r._resetErr(),!r._isValid())return!1;var t=r._ImgManager.GetImageIdsByFileName(e);return t.length>0&&r._innerFun("RemoveAllSelectedImages",kn(t.join(","))),r._ImgManager.RemoveFile(e)}},{key:"RenameDocument",value:function(e,t){var n=this;return n._resetErr(),!!n._isValid()&&(r.isString(e)&&r.isString(t)?e&&""!=e&&t&&""!=t?n._ImgManager.RenameFile(e,t):(r.Errors.FileNameCannotEmpty(n),!1):(r.Errors.FileNameNotString(n),!1))}},{key:"GetDocumentInfoList",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._ImgManager.GetFileInfoList()}},{key:"Invert",value:function(e,t,n){var i=this;if(r.isFunction(t))return i.InvertAsync(e).then(t,(function(e){i._wrappeAsyncFailed(i,e,n)})),!0;var o=parseInt(e);return!!ai(i,o,n)&&kO(i,"Invert",o,t,n,!1,!0)}},{key:"InvertAsync",value:function(e){var t=this,n=parseInt(e);if(t._resetErr(),!t._isValid())return r.Promise.reject({code:t._errorCode,message:t._errorString});if(isNaN(n))return r.Errors.InvalidIndex(t),r.Promise.reject({code:t._errorCode,message:t._errorString});if(n<0||n>=t._ImgManager.count())return r.Errors.IndexOutOfRange(t),r.Promise.reject({code:t._errorCode,message:t._errorString});var i=t._ImgManager.convertClientIndexToServerId(n);return-1==i?(r.Errors.IndexOutOfRange(t),r.Promise.reject({code:t._errorCode,message:t._errorString})):t._innerFunV2("Invert",kn(i),!0).then((function(e){var r=1==e;if(!r)throw{code:t._errorCode,message:t._errorString};return Jn.refreshImageAfterInvokeFun(t,n),r}))}},{key:"RenameTag",value:function(e,t){var n=this;return n._resetErr(),!!n._isValid()&&(r.isUndefined(e)?(r.Errors.ParameterCannotEmpty(n),!1):0==e.length?(r.Errors.OldTagNameRequired(n),!1):r.isUndefined(t)||0==t.length?(r.Errors.NewTagNameRequired(n),!1):n._ImgManager.renameTag(e,t))}},{key:"RemoveTag",value:function(e,t){var n=this;return n._resetErr(),!!n._isValid()&&(r.isUndefined(e)||0==e.length?(r.Errors.ParameterCannotEmpty(n),!1):r.isUndefined(t)||r.isArray(t)?n._ImgManager.removeTag(e,t):(r.Errors.IndicesNotArray(n),!1))}},{key:"GetTagList",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._ImgManager.getTagList()}},{key:"GetTagListByIndex",value:function(e){var r=this;return r._resetErr(),!!r._isValid()&&r._ImgManager.getTagListByIndex(e)}},{key:"GetImageBitDepthAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return r.Promise.reject({code:t._errorCode,message:t._errorString});var n=parseInt(e);if(isNaN(n))return r.Errors.InvalidIndex(t),r.Promise.reject({code:t._errorCode,message:t._errorString});if(n<0||n>=t._ImgManager.count())return r.Errors.IndexOutOfRange(t),r.Promise.reject({code:t._errorCode,message:t._errorString});var i=t._ImgManager.convertClientIndexToServerId(n);return-1==i?(r.Errors.IndexOutOfRange(t),r.Promise.reject({code:t._errorCode,message:t._errorString})):t._innerFunV2("GetImageBitDepth",kn(i))}},{key:"GetImageWidthAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return r.Promise.reject({code:t._errorCode,message:t._errorString});var n=parseInt(e);if(isNaN(n))return r.Errors.InvalidIndex(t),r.Promise.reject({code:t._errorCode,message:t._errorString});if(n<0||n>=t._ImgManager.count())return r.Errors.IndexOutOfRange(t),r.Promise.reject({code:t._errorCode,message:t._errorString});var i=t._ImgManager.convertClientIndexToServerId(n);return-1==i?(r.Errors.IndexOutOfRange(t),r.Promise.reject({code:t._errorCode,message:t._errorString})):t._innerFunV2("GetImageWidth",kn(i))}},{key:"GetImageHeightAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return r.Promise.reject({code:t._errorCode,message:t._errorString});var n=parseInt(e);if(isNaN(n))return r.Errors.InvalidIndex(t),r.Promise.reject({code:t._errorCode,message:t._errorString});if(n<0||n>=t._ImgManager.count())return r.Errors.IndexOutOfRange(t),r.Promise.reject({code:t._errorCode,message:t._errorString});var i=t._ImgManager.convertClientIndexToServerId(n);return-1==i?(r.Errors.IndexOutOfRange(t),r.Promise.reject({code:t._errorCode,message:t._errorString})):t._innerFunV2("GetImageHeight",kn(i))}},{key:"GetImageSizeAsync",value:function(e,t,n){var i=this;if(i._resetErr(),!i._isValid())return r.Promise.reject({code:i._errorCode,message:i._errorString});var o=parseInt(e);if(isNaN(o))return r.Errors.InvalidIndex(i),r.Promise.reject({code:i._errorCode,message:i._errorString});if(o<0||o>=i._ImgManager.count())return r.Errors.IndexOutOfRange(i),r.Promise.reject({code:i._errorCode,message:i._errorString});var a=i._ImgManager.convertClientIndexToServerId(o);return-1==a?(r.Errors.IndexOutOfRange(i),r.Promise.reject({code:i._errorCode,message:i._errorString})):i._innerFunV2("GetImageSize",kn(a,t,n))}},{key:"GetImageSizeWithSpecifiedTypeAsync",value:function(e,t){var n=this;if(n._resetErr(),!n._isValid())return r.Promise.reject({code:n._errorCode,message:n._errorString});var i=parseInt(e);if(isNaN(i))return r.Errors.InvalidIndex(n),r.Promise.reject({code:n._errorCode,message:n._errorString});if(i<0||i>=n._ImgManager.count())return r.Errors.IndexOutOfRange(n),r.Promise.reject({code:n._errorCode,message:n._errorString});var o=n._ImgManager.convertClientIndexToServerId(i);return-1==o?(r.Errors.IndexOutOfRange(n),r.Promise.reject({code:n._errorCode,message:n._errorString})):n._innerFunV2("GetImageSizeWithSpecifiedType",kn(o,t))}},{key:"GetImageXResolutionAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return r.Promise.reject({code:t._errorCode,message:t._errorString});var n=parseInt(e);if(isNaN(n))return r.Errors.InvalidIndex(t),r.Promise.reject({code:t._errorCode,message:t._errorString});if(n<0||n>=t._ImgManager.count())return r.Errors.IndexOutOfRange(t),r.Promise.reject({code:t._errorCode,message:t._errorString});var i=t._ImgManager.convertClientIndexToServerId(n);return-1==i?(r.Errors.IndexOutOfRange(t),r.Promise.reject({code:t._errorCode,message:t._errorString})):t._innerFunV2("GetImageXResolution",kn(i))}},{key:"GetImageYResolutionAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return r.Promise.reject({code:t._errorCode,message:t._errorString});var n=parseInt(e);if(isNaN(n))return r.Errors.InvalidIndex(t),r.Promise.reject({code:t._errorCode,message:t._errorString});if(n<0||n>=t._ImgManager.count())return r.Errors.IndexOutOfRange(t),r.Promise.reject({code:t._errorCode,message:t._errorString});var i=t._ImgManager.convertClientIndexToServerId(n);return-1==i?(r.Errors.IndexOutOfRange(t),r.Promise.reject({code:t._errorCode,message:t._errorString})):t._innerFunV2("GetImageYResolution",kn(i))}},{key:"ChangeBrightnessAsync",value:function(e,t){var n=this,i=parseInt(e);if(!n._isValid())return r.Promise.reject({code:n._errorCode,message:n._errorString});if(t<-1e3||t>1e3)return r.Errors.InvalidValue(n),r.Promise.reject({code:n._errorCode,message:n._errorString});var o=n._ImgManager.convertClientIndexToServerId(i);return-1==o?(r.Errors.IndexOutOfRange(n),r.Promise.reject({code:n._errorCode,message:n._errorString})):n._innerFunV2("ChangeBrightness",kn(o,t))}},{key:"ChangeContrastAsnyc",value:function(e,t){var n=this,i=parseInt(e);if(!n._isValid())return r.Promise.reject({code:n._errorCode,message:n._errorString});if(t<-1e3||t>1e3)return r.Errors.InvalidValue(n),r.Promise.reject({code:n._errorCode,message:n._errorString});var o=n._ImgManager.convertClientIndexToServerId(i);return-1==o?(r.Errors.IndexOutOfRange(n),r.Promise.reject({code:n._errorCode,message:n._errorString})):n._innerFunV2("ChangeContrast",kn(o,t))}},{key:"GetImageAsync",value:function(e,t,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return r.Promise.reject({code:a._errorCode,message:a._errorString});var s=parseInt(e);if(isNaN(s))return r.Errors.InvalidIndex(a),r.Promise.reject({code:a._errorCode,message:a._errorString});if(s<0||s>=a._ImgManager.count())return r.Errors.IndexOutOfRange(a),r.Promise.reject({code:a._errorCode,message:a._errorString});var u,c=a._ImgManager.convertClientIndexToServerId(s);return-1==c?(r.Errors.IndexOutOfRange(a),r.Promise.reject({code:a._errorCode,message:a._errorString})):(r.isNumber(t)?u=kn(c,t):r.isNumber(n)&&r.isNumber(i)?u=kn(c,n,i):r.isNumber(o)&&(u=kn(c,-1,-1,o)),a._sendDataByHttpAsync("GetImageByIndex",u,"blob"))}},{key:"GetImageInfoAsync",value:function(t){var n=this;if(n._resetErr(),!n._isValid())return r.Promise.reject({code:n._errorCode,message:n._errorString});var i=parseInt(t);if(isNaN(i))return r.Errors.InvalidIndex(n),r.Promise.reject({code:n._errorCode,message:n._errorString});if(i<0||i>=n._ImgManager.count())return r.Errors.IndexOutOfRange(n),r.Promise.reject({code:n._errorCode,message:n._errorString});var o=n._ImgManager.convertClientIndexToServerId(i);return-1==o?(r.Errors.IndexOutOfRange(n),r.Promise.reject({code:n._errorCode,message:n._errorString})):n._innerFunV2("GetImageInfo",kn(o)).then((function(r){var t=0,n=0,i=r;if(e.Lib.isArray(r)&&1==r.length&&(i=r[0]),e.Lib.isString(i)){var o=i.split(",");t=parseInt(o[0]),n=parseInt(o[1])}return{width:t,height:n}}))}},{key:"IfShowUI",get:function(){return this._resetErr(),this._isValid()?this._innerFun("IfShowUI"):Be},set:function(e){this._setIfShowUI(e)}},{key:"IfShowFileDialog",get:function(){return this._getIfShowFileDialog()},set:function(e){this._setIfShowFileDialog(e)}},{key:"checkErrorString",value:function(){var r=this._errorCode;if(-2115===r)return!0;if(-2003===r&&!e.DWT.IfHttpPostErrorNoWindow){var t=window.open("","ErrorMessage","height=500,width=750,top=0,left=0,toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no");null==t||t.document.writeln(this.__HTTPPostResponseString)}return 0===r}},{key:"OverlayRectangle",value:function(e,t,n,i,o,a,s){var u,c=this;return c._resetErr(),!!c._isValid()&&(c._isNoViewer()?c._nouiNotSupport("OverlayRectangle"):t>i||n>o||t==i&&n==o?(r.Errors.Overlay_InvalidLeftOrTopOrRightOrBottom(c),!1):(u=r.isNumber(a)?r.getColor(a):a,c._UIView.OverlayRectangle(e,t,n,i,o,u,s)))}},{key:"SetViewMode",value:function(e,t){var n=this;if(n._resetErr(),!n._isValid())return!1;if(n._isNoViewer())return n._nouiNotSupport("SetViewMode");if(r.isString(e)||r.isString(t)||e<-1&&t<-1)return r.Errors.InvalidValue(n),Be;var i=Math.floor(e),o=Math.floor(t);return n._UIView.SetViewMode(i,o),!0}},{key:"ShowImageEditor",value:function(e,r,t,n){var i=this;return i._resetErr(),!!i._isValid()&&(i._isNoViewer()?i._nouiNotSupport("ShowImageEditor"):Vn.isServerInvalid(i)?Be:i._UIView.GetWebViewer().webViewer.imageEditor?i.ShowImageEditorEx(-1,-1,-1,-1,3):e&&r&&t?i.ShowImageEditorEx(-1,-1,r,t,0,!0,e,n):i.ShowImageEditorEx(-1,-1,-1,-1,0,!1))}},{key:"ShowImageEditorEx",value:function(e,r,t,n,i,o,a,s){var u=this;return u._resetErr(),!!u._isValid()&&(u._isNoViewer()?u._nouiNotSupport("ShowImageEditorEx"):u._UIView.ShowImageEditorEx(e,r,t,n,i,o,a,s))}},{key:"SetSelectedImageArea",value:function(e,t,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return!1;if(a._isNoViewer())return a._nouiNotSupport("SetSelectedImageArea");var s=parseInt(e);return isNaN(s)||s<0||s>=a._ImgManager.count()?(r.Errors.IndexOutOfRange(a),!1):!Vn.isServerInvalid(a)&&a._UIView.SetSelectedImageArea(t,n,i,o)}},{key:"first",value:function(){var e=this,r=e._ImgManager.count();return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("first"):(r>0&&(e._UIView.Go(0),GR.__innerRefreshFromUIView(e,e._ImgManager.getCurrentImageIndex())),Ve))}},{key:"previous",value:function(){var e=this,r=e._ImgManager.count();return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("previous"):(r>0&&(e._UIView.__Previous(),GR.__innerRefreshFromUIView(e,e._ImgManager.getCurrentImageIndex())),Ve))}},{key:"next",value:function(){var e=this,r=e._ImgManager.count();return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("next"):(r>0&&(e._UIView.__Next(),GR.__innerRefreshFromUIView(e,e._ImgManager.getCurrentImageIndex())),Ve))}},{key:"last",value:function(){var e=this,r=e._ImgManager.count();return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("last"):(r>0&&(e._UIView.Go(r-1),GR.__innerRefreshFromUIView(e,e._ImgManager.getCurrentImageIndex())),Ve))}},{key:"_isBindViewer",value:function(){return!(!this._viewer||!this._viewer.webViewer)&&this._viewer.webViewer.bindViewUI}},{key:"_isNoViewer",value:function(){return!this._isBindViewer()}},{key:"_innerUnbindViewer",value:function(e){var t=this;t.__funResize&&(r.removeEventListener(window,"resize",t.__funResize),t.__funResize=Be),t._viewer&&(e?t._viewer.webViewer.dispose():t._viewer.unbind()),t._config.container=null}},{key:"_unload_viewer",value:function(){var e=this;e._isBindViewer()&&e._innerUnbindViewer(!0),e._ImgManager&&(e._ImgManager.dispose(),e._ImgManager=null),e._UIView&&(e._UIView.dispose(),e._UIView=null),e._viewer=null}},{key:"_innerRefreshUI",value:function(r,t,n,i,o){var a=this;return 4==o&&a._isBindViewer()&&(0==a._ImgManager.bImageJustChangedInEditor?a._ImgManager.bImageChangedInViewer=!0:(a._ImgManager.bImageJustChangedInEditor=!1,a._ImgManager.bImageChangedInViewer=!1)),n&&a._ImgManager.refresh(r,a._ImgManager.count(),!0,i),e.Lib.isFunction(a.__OnRefreshUI)&&a.__OnRefreshUI(a._ImgManager.getCurrentImageIndex(),a._ImgManager.count()),!0}}],[{key:"ProcessGetBlobByQueue",value:function(){if(i._getblob_queue.length>0&&!i._processing_getblob_queue){i._processing_getblob_queue=!0;var r=i._getblob_queue.shift(),t=r[0],n=r[1],o=r[2];t._convertToBlobForUpload(e.DWT.EnumDWT_ImageType.IT_PNG,[n],!1,4,(function(e,r,n){var a=n[1][0],s={imageId:a,uuid:t._ImgManager.convertServerIdToUUID(a),imageUrl:URL.createObjectURL(e),minImageUrl:URL.createObjectURL(e)};e=null,t._ImgManager.UpdateImage(s,o),i._processing_getblob_queue=!1,setTimeout(i.ProcessGetBlobByQueue,0)}),(function(e){i._processing_getblob_queue=!1,setTimeout(i.ProcessGetBlobByQueue,0)}))}}}]),i}(_O);function kO(e,t,n,i,o,a,s){var u,c=e._ImgManager.convertClientIndexToServerId(n);if(-1==c)return r.Errors.IndexOutOfRange(e),r.isFunction(o)&&o(e._errorCode,e._errorString),!1;if(u=e._innerFun(t,kn(c)),a)return u;var l=1==u;return l?(s&&(Jn.refreshImageAfterInvokeFun(e,n),e.getView().ClearSelectedAreas()),r.isFunction(i)&&i()):r.isFunction(o)&&o(e._errorCode,e._errorString),l}function DO(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=Te(e);if(r){var i=Te(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return Se(this,t)}}_e(wO,"_processing_getblob_queue",!1),_e(wO,"_getblob_queue",[]);var xO=function(t){Ie(i,t);var n=DO(i);function i(){return X(this,i),n.apply(this,arguments)}return Q(i,[{key:"SetCookie",value:function(e){return this._cookie=e,document.cookie=e,Ve}},{key:"LoadImageFromBase64Binary",value:function(t,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return!1;if(!t)return r.Errors.InvalidParameter(a),r.isFunction(o)&&o(a._errorCode,a._getErrorString()),!1;var s,u,c,l,d,f=t,h=Be,g="LoadImageFromBase64Binary",p=n,m=1;if(f instanceof ns&&r.isFunction(f.getLength)&&r.isFunction(f.getData)&&(f=f.getData(0,f.getLength())),r.isString(f))if(-1!=f.indexOf("data:image/bmp"))p=0;else if(-1!=f.indexOf("data:image/jpeg"))p=1;else if(-1!=f.indexOf("data:image/tif"))p=2;else if(-1!=f.indexOf("data:image/png"))p=3;else if(-1!=f.indexOf("data:application/pdf"))p=4;else if(-1!=f.indexOf("data:image/jp2"))p=14;else{var _=f.substr(0,64),v=e.Lib.base64.decode(_,!0);c=v,l=e.DWT.EnumDWT_ImageType,d=c,(c instanceof ArrayBuffer||c instanceof Array)&&(d=new Uint8Array(c.slice(0,12))),p=function(e){return 37==e[0]&&80==e[1]&&68==e[2]&&70==e[3]}(d)?l.IT_PDF:function(e){return 73==e[0]&&73==e[1]&&42==e[2]&&0==e[3]||77==e[0]&&77==e[1]&&0==e[2]&&42==e[3]}(d)?l.IT_TIF:function(e){return 137==e[0]&&80==e[1]&&78==e[2]&&71==e[3]}(d)?l.IT_PNG:function(e){return 255==e[0]&&216==e[1]}(d)?l.IT_JPG:function(e){return 66==e[0]&&77==e[1]}(d)?l.IT_BMP:function(e){return 0==e[0]&&0==e[1]&&0==e[2]&&12==e[3]&&106==e[4]&&80==e[5]&&32==e[6]&&32==e[7]||255==e[0]&&79==e[1]&&255==e[2]&&81==e[3]}(d)?l.IT_J2K:l.IT_PNG}if(p!=e.DWT.EnumDWT_ImageType.IT_BMP&&p!=e.DWT.EnumDWT_ImageType.IT_JPG&&p!=e.DWT.EnumDWT_ImageType.IT_TIF&&p!=e.DWT.EnumDWT_ImageType.IT_PNG&&p!=e.DWT.EnumDWT_ImageType.IT_PDF&&p!=e.DWT.EnumDWT_ImageType.IT_J2K&&(p=-1),!r.License.checkProductKey(a,{Core:!0}))return r.isFunction(o)&&o(a._errorCode,a._getErrorString()),Be;if(!r.License.checkPDFProductKeyWhenNeeds(a,p))return r.isFunction(o)&&o(a._errorCode,a._getErrorString()),Be;var y=a._getCurrentDocumentName();return r.isFunction(i)&&(h=Ve),r.isString(f)&&-1!=f.indexOf("base64,")&&(f=f.substr(f.indexOf("base64,")+7)),u=a.__GetLoadEventsNum(),h?(r.cancelFrom=q.Other,a.IfShowProgressBar?r.showProgress(a,g,a.__IfShowCancelDialogWhenImageTransfer):r.hideProgress(),a.__bLoadingImage=Ve,m=0,s=a._innerSend(g,kn(f,p,u,m),Ve,(function(){if(r.closeProgress(null,g),a.__bLoadingImage=!1,a._isBindViewer()){var t=a._ImgManager.getCurrentImageIndex();t>=0&&a._innerRefreshUI(t)}return a._blts&&e.DWT.lcvrf(a),i&&i(f,n),!0}),(function(){r.closeProgress(null,g),a.__bLoadingImage=!1,r.isFunction(o)&&o(a._errorCode,a._getErrorString(),f,n)}))):(s=a.__innerLoadImageFun(g,kn(f,p,u,m),m,y))&&a._blts&&e.DWT.lcvrf(a),s}},{key:"SaveSelectedImagesToBytes",value:function(e,t){return r.Errors.HTML5NotSupport(this),Be}},{key:"LoadImageFromBytes",value:function(e,t,n){return r.Errors.HTML5NotSupport(this),Be}},{key:"SetImageWidth",value:function(e,t,n,i){var o,a=this;if(a._resetErr(),!a._isValid())return!1;var s=parseInt(e);if(isNaN(s))return r.Errors.InvalidIndex(a),r.isFunction(i)&&i(a._errorCode,a._getErrorString()),!1;if(s<0||s>=a._ImgManager.count())return r.Errors.IndexOutOfRange(a),r.isFunction(i)&&i(a._errorCode,a._getErrorString()),!1;if(r.isUndefined(t))return r.Errors.InvalidParameter(a),r.isFunction(i)&&i(a._errorCode,a._getErrorString()),!1;var u=a._ImgManager.convertClientIndexToServerId(s);return-1==u?(r.Errors.IndexOutOfRange(a),r.isFunction(i)&&i(a._errorCode,a._getErrorString()),!1):((o=1==a._innerFun("SetImageWidth",kn(u,t)))?r.isFunction(n)&&n():r.isFunction(i)&&i(a._errorCode,a._getErrorString()),o)}},{key:"HTTPDownloadStreamThroughPost",value:function(e,t){return r.Errors.HTML5NotSupport(this),Be}},{key:"HTTPUploadStreamThroughPost",value:function(e,t,n,i,o){return r.Errors.HTML5NotSupport(this),Be}},{key:"HTTPUploadThroughPutDirectly",value:function(e,t,n,i,o){return r.Errors.HTML5NotSupport(this),!1}},{key:"SetCustomDSDataEx",value:function(e){return this._resetErr(),!!this._isValid()&&this._innerFun("SetCustomDSDataEx",kn(e))}},{key:"SetCustomDSData",value:function(e){if(this._resetErr(),!this._isValid())return!1;var r=Jn.replaceLocalFilename(e);return this._innerFun("SetCustomDSData",kn(r))}},{key:"GetCustomDSDataEx",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._innerFun("GetCustomDSDataEx")}},{key:"GetCustomDSData",value:function(e){var r=this;if(r._resetErr(),!r._isValid())return!1;var t=Jn.replaceLocalFilename(e);return r._innerFun("GetCustomDSData",kn(t))}},{key:"on",value:function(e,r){return this.registerEvent(e,r)}},{key:"off",value:function(e,r){return this.unregisterEvent(e,r)}},{key:"ConvertToBW",value:function(e,t,n){var i=this;if(i._resetErr(),!i._isValid())return!1;if(!r.License.checkProductKey(i,{Core:!0}))return r.isFunction(n)&&n(i._errorCode,i._getErrorString()),!1;var o=parseInt(e);if(isNaN(o))return r.Errors.InvalidIndex(i),r.isFunction(n)&&n(i._errorCode,i._getErrorString()),!1;if(o<0||o>=i._ImgManager.count())return r.Errors.IndexOutOfRange(i),r.isFunction(n)&&n(i._errorCode,i._getErrorString()),!1;var a=i.ChangeBitDepth(e,1,!0);return a?r.isFunction(t)&&t():r.isFunction(n)&&n(i._errorCode,i._getErrorString()),a}},{key:"LoadImageFromBinary",value:function(e,t,n){var i=this,o="LoadImageFromBinary";r.isFunction(t)&&(i.IfShowProgressBar?r.showProgress(i,o,i.__IfShowCancelDialogWhenImageTransfer):r.hideProgress());return this._innerLoadImageFromBinary(e,0,!0,(function(){r.isFunction(t)&&(i.IfShowProgressBar&&r.closeProgress(null,o),t())}),(function(e,a){r.isFunction(t)&&i.IfShowProgressBar&&r.closeProgress(null,o),r.isFunction(n)&&n(e,a)}))}},{key:"EnableSourceUI",value:function(e,r){var t=this;return t._resetErr(),!!t._isValid()&&(t._innerSend("EnableSourceUI",null,!0,e,r),!0)}},{key:"GetIfShowVideoContainer",value:function(){return this._UIView.GetIfShowVideoContainer()}},{key:"ShowVideoContainer",value:function(e){return this._UIView.ShowVideoContainer(e)}},{key:"UpdateVideoContainer",value:function(e){return this._UIView.UpdateVideoContainer(e)}},{key:"ChangeBitDepth",value:function(e,t,n){var i,o=this;if(o._resetErr(),!o._isValid())return!1;if(i=parseInt(e),isNaN(i))return r.Errors.InvalidIndex(o),!1;if(i<0||i>=o._ImgManager.count())return r.Errors.IndexOutOfRange(o),!1;var a=o._ImgManager.convertClientIndexToServerId(i);return-1==a?(r.Errors.IndexOutOfRange(o),!1):o._innerFun("ChangeBitDepth",kn(a,t,n))}},{key:"ConvertToGrayScale",value:function(e,t,n){var i,o=this;if(o._resetErr(),!o._isValid())return!1;var a=parseInt(e);if(isNaN(a))return r.Errors.InvalidIndex(o),r.isFunction(n)&&n(o._errorCode,o._getErrorString()),!1;if(a<0||a>=o._ImgManager.count())return r.Errors.IndexOutOfRange(o),r.isFunction(n)&&n(o._errorCode,o._getErrorString()),!1;var s=o._ImgManager.convertClientIndexToServerId(a);return-1==s?(r.Errors.IndexOutOfRange(o),r.isFunction(n)&&n(o._errorCode,o._getErrorString()),!1):((i=1==o._innerFun("ConvertToGrayScale",kn(s)))?(Jn.refreshImageAfterInvokeFun(o,a),r.isFunction(t)&&t()):r.isFunction(n)&&n(o._errorCode,o._getErrorString()),i)}},{key:"ClearTiffCustomTag",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&(e._aryTiffTag.splice(0,e._aryTiffTag.length),e._innerFun("ClearTiffCustomTag"))}},{key:"SetTiffCustomTag",value:function(e,t,n){var i=this;if(i._resetErr(),!i._isValid())return!1;if(r.isUndef(e)||r.isUndef(t))return r.Errors.InvalidParameter(i),!1;var o,a=1*e;if(o=r.isString(t)?r.replaceAll(t,'"','\\"'):t,a<=0||a>2147483647)return r.Errors.InvalidTiffTagError(i),!1;var s,u=0,c=!1,l=i._aryTiffTag.length;for(u=0;u<l;u++)(s=i._aryTiffTag[u]).tag==a&&(s.Content=t,s.UseBase64Encoding=n,c=!0);return!c&&l>=32?(r.Errors.TiffTagCountExceedError(i),!1):i._innerFun("SetTiffCustomTag",kn(a,o,n))}},{key:"IsBlankImage",value:function(e){var t,n=this;if(n._resetErr(),!n._isValid())return!1;if(t=parseInt(e),isNaN(t))return r.Errors.InvalidIndex(n),!1;if(t<0||t>=n._ImgManager.count())return r.Errors.IndexOutOfRange(n),!1;var i=n._ImgManager.convertClientIndexToServerId(t);return-1==i?(r.Errors.IndexOutOfRange(n),!1):n._innerFun("IsBlankImage",kn(i,Be))}},{key:"IsBlankImageExpress",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return!1;var n=parseInt(e);if(isNaN(n))return r.Errors.InvalidIndex(t),!1;if(n<0||n>=t._ImgManager.count())return r.Errors.IndexOutOfRange(t),!1;var i=t._ImgManager.convertClientIndexToServerId(n);return-1==i?(r.Errors.IndexOutOfRange(t),!1):t._innerFun("IsBlankImage",kn(i,Ve))}},{key:"SetOpenSourceTimeout",value:function(e){var r=this;return r._resetErr(),!!r._isValid()&&r._innerFun("SetOpenSourceTimeout",kn(e))}},{key:"GetImageURL",value:function(t,n,i,o,a){var s=this;if(s._resetErr(),!s._isValid())return!1;var u,c,l,d=t,f=parseInt(n),h=parseInt(i);if(o?(u="",c="dwt://"):(u=s._httpUrl,c="dwt/"),l=[u,c,r.product.getDWTPrefix(),r.product.getServerVersionInfo(),"/img?id=",s._clientId],r.isUndefined(d)||null===d)return r.Errors.IndexNullOrUndefined(s),"";if(a)l.push("&index=-1&width=-1&height=-1&webcam="),l.push(a);else{if(d=parseInt(d),isNaN(d))return r.Errors.InvalidIndex(s),"";if(d<-1||d>=s._ImgManager.count())return r.Errors.IndexOutOfRange(s),"";var g=s._ImgManager.convertClientIndexToServerId(d);if(-1==g)return"";l.push("&index="),l.push(g),f>0&&h>0?(l.push("&width="),l.push(f),l.push("&height="),l.push(h)):l.push("&width=-1&height=-1"),e.navInfoSync.bMobile&&l.push("&type=1&quality=85")}if(l.push("&t="),l.push((new Date).getTime()),l=l.join(""),e.navInfoSync.bFileSystem&&l.indexOf("dwt://")<0){var p=new Image;p.crossOrigin="anonymous",p.src=l,p=null}return l}},{key:"GetImagePartURL",value:function(e,t,n){var i=this;if(i._resetErr(),!i._isValid())return!1;var o=parseInt(e);return isNaN(o)?(r.Errors.InvalidIndex(i),""):o<0||o>=i._ImgManager.count()?(r.Errors.IndexOutOfRange(i),""):this.GetImageURL(o,t,n,!0)}},{key:"SetLanguage",value:function(e){var r=this;return r._resetErr(),!!r._isValid()&&r._innerFun("SetLanguageForSecurity",kn(e))}},{key:"GetLicenseInfo",value:function(e,t){var n=this;return n.__licenseInfo?r.isFunction(e)&&e(n.__licenseInfo):n._innerFunRaw("GetLicenseInfo",null,Ve,Be,Ve,(function(i){i?i.exception?r.isFunction(t)&&t(i.exception):(rs(n,i),r.isFunction(e)&&e(n.__licenseInfo)):r.isFunction(t)&&t()}),t),Ve}},{key:"SetProductKeyAsync",value:function(e){return this._setProductKeyAsync(e)}},{key:"GetVersionInfoAsync",value:function(){return r.Promise.resolve(r.product.dwtVersionInfo)}},{key:"isUsingActiveX",value:function(){return!1}},{key:"SetLTSLicenseAsync",value:function(e){return this._setLTSLicenseAsync(e)}},{key:"Print",value:function(e){var r=this;if(r._resetErr(),!r._isValid())return!1;if(r._isNoViewer())return r._nouiNotSupport("Print");if(e){return r._innerSend("PrintEx",kn(!0),!0,(function(){}),(function(){})),!0}return r._ImagePrint.Print(),!0}},{key:"PrintEx",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&(r.isArray(e)?t._isNoViewer()?t._nouiNotSupport("Print"):!!t._checkIndices(e)&&(t._ImagePrint.PrintEx(e),!0):(r.Errors.IndicesNotArray(t),!1))}}]),i}(wO),PO=0,FO=1,WO=1,AO=2;function RO(e,t,n,i){var o;n!==PO&&n!==FO?o=n:(o={},n&&(o.set=i==WO?function(n){var i=1*n;return!r.isNumber(i)||isNaN(i)?(r.Errors.InvalidValue(e),Be):(e._resetErr(),!!e._isValid()&&e._innerFun(t,kn(i)))}:i==AO?function(n){return r.isBoolean(n)?(e._resetErr(),!!e._isValid()&&e._innerFun(t,kn(n))):(r.Errors.InvalidValue(e),Be)}:function(n){return r.isString(n)?(e._resetErr(),!!e._isValid()&&e._innerFun(t,kn(n))):(r.Errors.InvalidValue(e),Be)})),o.get||(o.get=function(){return e._resetErr(),!!e._isValid()&&e._innerFun(t)}),t in e||Object.defineProperty(e,t,o)}var OO=e.navInfoSync;r.removeNonPrintableChar;var LO,NO,MO,UO=function(e,t,n){n==AO&&r.each(t,(function(r,t){jR(e,r,{get:function(){return e._resetErr(),e._isValid()?Ve:Be},set:function(r){return e._resetErr(),e._isValid()?Ve:Be}})}))},BO=function(e,t){r.each(t,(function(r,t){RO(e,r,FO,AO)}))},VO=function(e,t){r.each(t,(function(r,t){RO(e,r,FO,WO)}))},GO=function(e,t){r.each(t,(function(r,t){RO(e,r,PO)}))},jO=function(e,t){r.each(t,(function(r,t){RO(e,r,FO)}))};function HO(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=Te(e);if(r){var i=Te(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return Se(this,t)}}r.DynamicLoadAddonFuns=[],r.attachAddon=function(e){var t=!1;return r.each(r.DynamicLoadAddonFuns,(function(n){r.isFunction(n)&&(n(e),t=!0)})),!r.product.bFullEdition&&e.__addon&&delete e.__addon.Camera,t},function(e){e.CAP_NONE=0,e.CAP_XFERCOUNT=1,e.ICAP_COMPRESSION=256,e.ICAP_PIXELTYPE=257,e.ICAP_UNITS=258,e.ICAP_XFERMECH=259,e.CAP_AUTHOR=4096,e.CAP_CAPTION=4097,e.CAP_FEEDERENABLED=4098,e.CAP_FEEDERLOADED=4099,e.CAP_TIMEDATE=4100,e.CAP_SUPPORTEDCAPS=4101,e.CAP_EXTENDEDCAPS=4102,e.CAP_AUTOFEED=4103,e.CAP_CLEARPAGE=4104,e.CAP_FEEDPAGE=4105,e.CAP_REWINDPAGE=4106,e.CAP_INDICATORS=4107,e.CAP_SUPPORTEDCAPSEXT=4108,e.CAP_PAPERDETECTABLE=4109,e.CAP_UICONTROLLABLE=4110,e.CAP_DEVICEONLINE=4111,e.CAP_AUTOSCAN=4112,e.CAP_THUMBNAILSENABLED=4113,e.CAP_DUPLEX=4114,e.CAP_DUPLEXENABLED=4115,e.CAP_ENABLEDSUIONLY=4116,e.CAP_CUSTOMDSDATA=4117,e.CAP_ENDORSER=4118,e.CAP_ALARMS=4120,e.CAP_ALARMVOLUME=4121,e.CAP_AUTOMATICCAPTURE=4122,e.CAP_TIMEBEFOREFIRSTCAPTURE=4123,e.CAP_TIMEBETWEENCAPTURES=4124,e.CAP_CLEARBUFFERS=4125,e.CAP_MAXBATCHBUFFERS=4126,e.CAP_DEVICETIMEDATE=4127,e.CAP_POWERSUPPLY=4128,e.CAP_CAMERAPREVIEWUI=4129,e.CAP_SERIALNUMBER=4132,e.CAP_PRINTER=4134,e.CAP_PRINTERENABLED=4135,e.CAP_PRINTERINDEX=4136,e.CAP_PRINTERMODE=4137,e.CAP_PRINTERSTRING=4138,e.CAP_PRINTERSUFFIX=4139,e.CAP_LANGUAGE=4140,e.CAP_FEEDERALIGNMENT=4141,e.CAP_FEEDERORDER=4142,e.CAP_REACQUIREALLOWED=4144,e.CAP_BATTERYMINUTES=4146,e.CAP_BATTERYPERCENTAGE=4147,e.CAP_CAMERASIDE=4148,e.CAP_SEGMENTED=4149,e.CAP_CAMERAENABLED=4150,e.CAP_CAMERAORDER=4151,e.CAP_MICRENABLED=4152,e.CAP_FEEDERPREP=4153,e.CAP_FEEDERPOCKET=4154,e.CAP_AUTOMATICSENSEMEDIUM=4155,e.CAP_CUSTOMINTERFACEGUID=4156,e.ICAP_AUTOBRIGHT=4352,e.ICAP_BRIGHTNESS=4353,e.ICAP_CONTRAST=4355,e.ICAP_CUSTHALFTONE=4356,e.ICAP_EXPOSURETIME=4357,e.ICAP_FILTER=4358,e.ICAP_FLASHUSED=4359,e.ICAP_GAMMA=4360,e.ICAP_HALFTONES=4361,e.ICAP_HIGHLIGHT=4362,e.ICAP_IMAGEFILEFORMAT=4364,e.ICAP_LAMPSTATE=4365,e.ICAP_LIGHTSOURCE=4366,e.ICAP_ORIENTATION=4368,e.ICAP_PHYSICALWIDTH=4369,e.ICAP_PHYSICALHEIGHT=4370,e.ICAP_SHADOW=4371,e.ICAP_FRAMES=4372,e.ICAP_XNATIVERESOLUTION=4374,e.ICAP_YNATIVERESOLUTION=4375,e.ICAP_XRESOLUTION=4376,e.ICAP_YRESOLUTION=4377,e.ICAP_MAXFRAMES=4378,e.ICAP_TILES=4379,e.ICAP_BITORDER=4380,e.ICAP_CCITTKFACTOR=4381,e.ICAP_LIGHTPATH=4382,e.ICAP_PIXELFLAVOR=4383,e.ICAP_PLANARCHUNKY=4384,e.ICAP_ROTATION=4385,e.ICAP_SUPPORTEDSIZES=4386,e.ICAP_THRESHOLD=4387,e.ICAP_XSCALING=4388,e.ICAP_YSCALING=4389,e.ICAP_BITORDERCODES=4390,e.ICAP_PIXELFLAVORCODES=4391,e.ICAP_JPEGPIXELTYPE=4392,e.ICAP_TIMEFILL=4394,e.ICAP_BITDEPTH=4395,e.ICAP_BITDEPTHREDUCTION=4396,e.ICAP_UNDEFINEDIMAGESIZE=4397,e.ICAP_EXTIMAGEINFO=4399,e.ICAP_MINIMUMHEIGHT=4400,e.ICAP_MINIMUMWIDTH=4401,e.ICAP_AUTODISCARDBLANKPAGES=4404,e.ICAP_FLIPROTATION=4406,e.ICAP_BARCODEDETECTIONENABLED=4407,e.ICAP_SUPPORTEDBARCODETYPES=4408,e.ICAP_BARCODEMAXSEARCHPRIORITIES=4409,e.ICAP_BARCODESEARCHPRIORITIES=4410,e.ICAP_BARCODESEARCHMODE=4411,e.ICAP_BARCODEMAXRETRIES=4412,e.ICAP_BARCODETIMEOUT=4413,e.ICAP_ZOOMFACTOR=4414,e.ICAP_PATCHCODEDETECTIONENABLED=4415,e.ICAP_SUPPORTEDPATCHCODETYPES=4416,e.ICAP_PATCHCODEMAXSEARCHPRIORITIES=4417,e.ICAP_PATCHCODESEARCHPRIORITIES=4418,e.ICAP_PATCHCODESEARCHMODE=4419,e.ICAP_PATCHCODEMAXRETRIES=4420,e.ICAP_PATCHCODETIMEOUT=4421,e.ICAP_FLASHUSED2=4422,e.ICAP_IMAGEFILTER=4423,e.ICAP_NOISEFILTER=4424,e.ICAP_OVERSCAN=4425,e.ICAP_AUTOMATICBORDERDETECTION=4432,e.ICAP_AUTOMATICDESKEW=4433,e.ICAP_AUTOMATICROTATE=4434,e.ICAP_JPEGQUALITY=4435,e.ICAP_FEEDERTYPE=4436,e.ICAP_ICCPROFILE=4437,e.ICAP_AUTOSIZE=4438,e.ICAP_AUTOMATICCROPUSESFRAME=4439,e.ICAP_AUTOMATICLENGTHDETECTION=4440,e.ICAP_AUTOMATICCOLORENABLED=4441,e.ICAP_AUTOMATICCOLORNONCOLORPIXELTYPE=4442,e.ICAP_COLORMANAGEMENTENABLED=4443,e.ICAP_IMAGEMERGE=4444,e.ICAP_IMAGEMERGEHEIGHTTHRESHOLD=4445,e.ICAP_SUPPORTEDEXTIMAGEINFO=4446}(LO||(LO={})),e.DWT.EnumDWT_Cap=LO,function(e){e.TWLG_DAN=0,e.TWLG_DUT=1,e.TWLG_ENG=2,e.TWLG_FCF=3,e.TWLG_FIN=4,e.TWLG_FRN=5,e.TWLG_GER=6,e.TWLG_ICE=7,e.TWLG_ITN=8,e.TWLG_NOR=9,e.TWLG_POR=10,e.TWLG_SPA=11,e.TWLG_SWE=12,e.TWLG_USA=13,e.TWLG_USERLOCALE=-1,e.TWLG_AFRIKAANS=14,e.TWLG_ALBANIA=15,e.TWLG_ARABIC=16,e.TWLG_ARABIC_ALGERIA=17,e.TWLG_ARABIC_BAHRAIN=18,e.TWLG_ARABIC_EGYPT=19,e.TWLG_ARABIC_IRAQ=20,e.TWLG_ARABIC_JORDAN=21,e.TWLG_ARABIC_KUWAIT=22,e.TWLG_ARABIC_LEBANON=23,e.TWLG_ARABIC_LIBYA=24,e.TWLG_ARABIC_MOROCCO=25,e.TWLG_ARABIC_OMAN=26,e.TWLG_ARABIC_QATAR=27,e.TWLG_ARABIC_SAUDIARABIA=28,e.TWLG_ARABIC_SYRIA=29,e.TWLG_ARABIC_TUNISIA=30,e.TWLG_ARABIC_UAE=31,e.TWLG_ARABIC_YEMEN=32,e.TWLG_BASQUE=33,e.TWLG_BYELORUSSIAN=34,e.TWLG_BULGARIAN=35,e.TWLG_CATALAN=36,e.TWLG_CHINESE=37,e.TWLG_CHINESE_HONGKONG=38,e.TWLG_CHINESE_PRC=39,e.TWLG_CHINESE_SINGAPORE=40,e.TWLG_CHINESE_SIMPLIFIED=41,e.TWLG_CHINESE_TAIWAN=42,e.TWLG_CHINESE_TRADITIONAL=43,e.TWLG_CROATIA=44,e.TWLG_CZECH=45,e.TWLG_DANISH=0,e.TWLG_DUTCH=1,e.TWLG_DUTCH_BELGIAN=46,e.TWLG_ENGLISH=2,e.TWLG_ENGLISH_AUSTRALIAN=47,e.TWLG_ENGLISH_CANADIAN=48,e.TWLG_ENGLISH_IRELAND=49,e.TWLG_ENGLISH_NEWZEALAND=50,e.TWLG_ENGLISH_SOUTHAFRICA=51,e.TWLG_ENGLISH_UK=52,e.TWLG_ENGLISH_USA=13,e.TWLG_ESTONIAN=53,e.TWLG_FAEROESE=54,e.TWLG_FARSI=55,e.TWLG_FINNISH=4,e.TWLG_FRENCH=5,e.TWLG_FRENCH_BELGIAN=56,e.TWLG_FRENCH_CANADIAN=3,e.TWLG_FRENCH_LUXEMBOURG=57,e.TWLG_FRENCH_SWISS=58,e.TWLG_GERMAN=6,e.TWLG_GERMAN_AUSTRIAN=59,e.TWLG_GERMAN_LUXEMBOURG=60,e.TWLG_GERMAN_LIECHTENSTEIN=61,e.TWLG_GERMAN_SWISS=62,e.TWLG_GREEK=63,e.TWLG_HEBREW=64,e.TWLG_HUNGARIAN=65,e.TWLG_ICELANDIC=7,e.TWLG_INDONESIAN=66,e.TWLG_ITALIAN=8,e.TWLG_ITALIAN_SWISS=67,e.TWLG_JAPANESE=68,e.TWLG_KOREAN=69,e.TWLG_KOREAN_JOHAB=70,e.TWLG_LATVIAN=71,e.TWLG_LITHUANIAN=72,e.TWLG_NORWEGIAN=9,e.TWLG_NORWEGIAN_BOKMAL=73,e.TWLG_NORWEGIAN_NYNORSK=74,e.TWLG_POLISH=75,e.TWLG_PORTUGUESE=10,e.TWLG_PORTUGUESE_BRAZIL=76,e.TWLG_ROMANIAN=77,e.TWLG_RUSSIAN=78,e.TWLG_SERBIAN_LATIN=79,e.TWLG_SLOVAK=80,e.TWLG_SLOVENIAN=81,e.TWLG_SPANISH=11,e.TWLG_SPANISH_MEXICAN=82,e.TWLG_SPANISH_MODERN=83,e.TWLG_SWEDISH=12,e.TWLG_THAI=84,e.TWLG_TURKISH=85,e.TWLG_UKRANIAN=86,e.TWLG_ASSAMESE=87,e.TWLG_BENGALI=88,e.TWLG_BIHARI=89,e.TWLG_BODO=90,e.TWLG_DOGRI=91,e.TWLG_GUJARATI=92,e.TWLG_HARYANVI=93,e.TWLG_HINDI=94,e.TWLG_KANNADA=95,e.TWLG_KASHMIRI=96,e.TWLG_MALAYALAM=97,e.TWLG_MARATHI=98,e.TWLG_MARWARI=99,e.TWLG_MEGHALAYAN=100,e.TWLG_MIZO=101,e.TWLG_NAGA=102,e.TWLG_ORISSI=103,e.TWLG_PUNJABI=104,e.TWLG_PUSHTU=105,e.TWLG_SERBIAN_CYRILLIC=106,e.TWLG_SIKKIMI=107,e.TWLG_SWEDISH_FINLAND=108,e.TWLG_TAMIL=109,e.TWLG_TELUGU=110,e.TWLG_TRIPURI=111,e.TWLG_URDU=112,e.TWLG_VIETNAMESE=113}(NO||(NO={})),e.DWT.EnumDWT_CapLanguage=NO,function(e){e.TWSS_NONE=0,e.TWSS_A4LETTER=1,e.TWSS_B5LETTER=2,e.TWSS_USLETTER=3,e.TWSS_USLEGAL=4,e.TWSS_A5=5,e.TWSS_B4=6,e.TWSS_B6=7,e.TWSS_USLEDGER=9,e.TWSS_USEXECUTIVE=10,e.TWSS_A3=11,e.TWSS_B3=12,e.TWSS_A6=13,e.TWSS_C4=14,e.TWSS_C5=15,e.TWSS_C6=16,e.TWSS_4A0=17,e.TWSS_2A0=18,e.TWSS_A0=19,e.TWSS_A1=20,e.TWSS_A2=21,e.TWSS_A4=1,e.TWSS_A7=22,e.TWSS_A8=23,e.TWSS_A9=24,e.TWSS_A10=25,e.TWSS_ISOB0=26,e.TWSS_ISOB1=27,e.TWSS_ISOB2=28,e.TWSS_ISOB3=12,e.TWSS_ISOB4=6,e.TWSS_ISOB5=29,e.TWSS_ISOB6=7,e.TWSS_ISOB7=30,e.TWSS_ISOB8=31,e.TWSS_ISOB9=32,e.TWSS_ISOB10=33,e.TWSS_JISB0=34,e.TWSS_JISB1=35,e.TWSS_JISB2=36,e.TWSS_JISB3=37,e.TWSS_JISB4=38,e.TWSS_JISB5=2,e.TWSS_JISB6=39,e.TWSS_JISB7=40,e.TWSS_JISB8=41,e.TWSS_JISB9=42,e.TWSS_JISB10=43,e.TWSS_C0=44,e.TWSS_C1=45,e.TWSS_C2=46,e.TWSS_C3=47,e.TWSS_C7=48,e.TWSS_C8=49,e.TWSS_C9=50,e.TWSS_C10=51,e.TWSS_USSTATEMENT=52,e.TWSS_BUSINESSCARD=53,e.TWSS_MAXSIZE=54}(MO||(MO={})),e.DWT.EnumDWT_CapSupportedSizes=MO;var zO=function(t){Ie(i,t);var n=HO(i);function i(e,r){var t;X(this,i);var o=ve(t=n.call(this,r));return o._stwain=e,o.bImageJustChangedInEditor=!1,o.bImageChangedInViewer=!1,t}return Q(i,[{key:"getUidByIndex",value:function(e){return this._buffer.getUidByIndex(e)}},{key:"dispose",value:function(){return!0}},{key:"unshift",value:function(e,r,t){return 0,this._updateUIAfterAdd(0,r,t)}},{key:"append",value:function(e,r,t){var n,i,o,a,s=this;i=this._buffer.isActiveFile&&t.currentFileName&&t.currentFileName.length>0?s.getCountByDocumentName(t.currentFileName):s.count(),o=s.getCurrentImageIndex();for(var u=i-1;u>=e;u--)a=s.convertClientIndexToServerId(u),s.removeByServerId(a,u);return i<e?(n=i,s._updateUIAfterAdd(n,r,t,!0)):(n=o>=i-1?0:o+1,a=s.convertClientIndexToServerId(n),s.removeByServerId(a,n),n==e-1?s._updateUIAfterAdd(n,r,t,!0):s._updateUIAfterAdd(n,r,t,!1))}},{key:"insertBefore",value:function(e,r,t,n){var i,o=1*e;return(o<0||o>r)&&(o=-1),o>=(i=this.count())&&(o=i),this._updateUIAfterAdd(o,t,n,!1)}},{key:"exists",value:function(e){return!r.isUndefined(this.getImageIdMap(e))}},{key:"insert",value:function(e,r,t,n){var i,o=1*e;return(o<0||o>r)&&(o=-1),o>=(i=this.count())&&(o=i),this._updateUIAfterAdd(o,t,n,!1)}},{key:"moveImage",value:function(e,r,t){return this._buffer.moveImage(e,r)}},{key:"switchImage",value:function(e,r){return this._buffer.switchImage(e,r)}},{key:"refresh",value:function(e,r,t,n){var i,o=this,a=1*e;if(t){var s=o.count();if(a<0||a>s)return!1;i=o.convertClientIndexToServerId(a),o.SetDataImageControl(a,i,n)}return!0}},{key:"setSelectedClientIndexArray",value:function(e){return this._buffer.selectImages(e)}},{key:"getSelectedClientIndexArray",value:function(e){return this._buffer.getSelectedImagesIndices()}},{key:"showImagesByFilter",value:function(e,r,t){return this._buffer.filterImagesByTag(e,r,t)}},{key:"clearFilter",value:function(){return this._buffer.clearFilter()}},{key:"removeImageTag",value:function(e){return this._buffer.removeImageTag(e)}},{key:"addImageTag",value:function(e,r){return this._buffer.tagImages(e,r)}},{key:"getCurrentTag",value:function(){var e;return 0==(e=this._buffer.getCurrentTag())?"":e}},{key:"renameTag",value:function(e,r){return this._buffer.renameTag(e,r)}},{key:"removeTag",value:function(e,r){return this._buffer.removeTag(e,r)}},{key:"getTagList",value:function(){return this._buffer.getTagList()}},{key:"getTagListByIndex",value:function(e){return this._buffer.getTagListByIndex(e)}},{key:"OpenFile",value:function(e){return this._buffer.openDocument(e)}},{key:"CreateFile",value:function(e){return this._buffer.createDocument(e)}},{key:"GetCurrentFileName",value:function(){return this._buffer.getCurrentFileName()}},{key:"RemoveFile",value:function(e){return this._buffer.removeDocument(e)}},{key:"RenameFile",value:function(e,r){return this._buffer.renameDocument(e,r)}},{key:"GetFileInfoList",value:function(){return this._buffer.getDocumentInfoList()}},{key:"GetImageIdsByFileName",value:function(e){var t,n,i=this,o=[];return(t=i.GetFileInfoList())?r.each(t,(function(r){if(e==r.name){if(n={},r.chs)for(var t=0;t<r.chs.length;t++){var a=r.chs[t];a&&(n=i._buffer.getCustomDataByUid(a))&&o.push(n.imageId)}return!1}})):o=[],o}},{key:"insertImage",value:function(e,r,t){this._buffer.insertImage(r,e,t)}},{key:"GetMetaDataByIndex",value:function(e){return this._buffer.getMetadataByUid(this._buffer.getUidByIndex(e))}},{key:"RefreshAllImages",value:function(e,r){for(var t,n,i,o=this,a=0;a<o.count();a++){t=o.convertClientIndexToServerId(a);var s=o.getImageIdMap(t);s&&(n=Rs.getImageUrl(o._baseUrl,t,e,r,Date.now()),s.minImageUrl=n,i=o.GetMetaDataByIndex(a),o._buffer.updateImage(s,i))}}},{key:"UpdateData",value:function(e,r){var t=e,n=this.getImageIdMap(t);return n&&this._buffer.updateImage(n,r),!0}},{key:"UpdateImage",value:function(e,r){return this._buffer.updateImage(e,r),!0}},{key:"SetDataImageControl",value:function(e,r,t){var n,i=this;return-1!=r&&((n=i.getImageIdMap(r))||((n=new Ws).imageId=r,i._imageIdMap[r]=n),null!=n&&(n.bIsDirty=!0),i.__GetImageAndAttach(n,r,!0,!1,!1,e,t),!0)}},{key:"__AttachImages",value:function(){var e,r,t,n=this;r=n.count();for(var i=0;i<r;i++)(e=n.convertClientIndexToServerId(i))>=0&&(t=n.getImageIdMap(e),n.__GetImageAndAttach(t,e,!0,!1,!1,0))}},{key:"AddImage",value:function(e,r,t,n){var i,o=1*e;return-1!=r&&((i=new Ws).bIsDirty=!0,i.imageId=r,this._imageIdMap[r]=i,r>=0&&this.__GetImageAndAttach(i,r,!1,!0,n,o,t),!0)}},{key:"OnGetImageByURL",value:function(e,r,t,n,i,o,a,s){return r.imageUrl&&""!=r.imageUrl?(r.iImageControlWidth=t,r.iImageControlHeight=n,r.bAddImage=i,r.bAppendImage=o,r.index=a,this._attachImagesForControl(r,s),!0):this.OnGetImageFromServer(e,r,t,n,i,o,a,s)}},{key:"OnGetImageFromServer",value:function(t,n,i,o,a,s,u,c){var l,d,f=this,h=f._baseUrl;if(h){if(-1==t)return!1;n.bIsDirty&&(n.ticks=Date.now()),r.isUndefined(i)&&(i=-1),r.isUndefined(o)&&(o=-1),n.iImageControlWidth=i,n.iImageControlHeight=o,n.bAddImage=a,n.bAppendImage=s,n.index=u,e.DWT.ConnectWithSocket&&f._stwain._isBindViewer()?(f._attachImagesForControl(n,c),wO._getblob_queue.push([f._stwain,t,c]),wO.ProcessGetBlobByQueue()):(l=Rs.getImageUrl(h,t,-1,-1,n.ticks),d=Rs.getImageUrl(h,t,i,o,n.ticks),n.imageUrl=l,n.minImageUrl=d,f._attachImagesForControl(n,c))}return!0}},{key:"getBaseUrl",get:function(){return this._baseUrl}},{key:"_attachImagesForControl",value:function(e,r){var t=this;return e.bAddImage?r.currentFileName.length>0?t._buffer.addImage(e,r,r.currentFileName):t._buffer.addImage(e,r):t._buffer.updateImage(e,r),!0}},{key:"_updateUIAfterAdd",value:function(e,r,t,n){return!(r<0)&&this.AddImage(e,r,t,n)}},{key:"__GetImageAndAttach",value:function(e,r,t,n,i,o,a){var s,u,c=this;c._stwain._isBindViewer()?(u=c._stwain.Viewer.height,s=c._stwain.Viewer.width):(s=-1,u=-1);var l=!1;l=!!t||1==e.bIsDirty;var d=c.getImageIdMap(r).uuid;d&&e.iImageControlWidth==s&&e.iImageControlHeight==u&&0==e.bIsDirty||c.__SetArrayControlLoadImage(d,r,e,s,u,c._attachImagesForControl,l,n,i,o,a)}},{key:"__SetArrayControlLoadImage",value:function(e,r,t,n,i,o,a,s,u,c,l){a?this.OnGetImageFromServer(r,t,n,i,s,u,c,l):this.OnGetImageByURL(r,t,n,i,s,u,c,l)}},{key:"GetServerIdList",value:function(){var e,r,t,n=this,i=[];if(e=n._buffer.getDocumentContents(n._buffer.getCurrentDocument()))for(var o=0;o<e.length;o++)(r=e[o])&&(t=n._buffer.getCustomDataByUid(r))&&i.push(t.imageId);return i}}]),i}($A);r.UI.ImageManager=zO;var KO,qO=Q((function HL(e,r,t){X(this,HL),this.Url=e,this.Width=r,this.Height=t})),XO=function(){function t(e){X(this,t),this._stwain=e,this._ImgManager=e._ImgManager}return Q(t,[{key:"Print",value:function(){var e=this;if(e.count()<=0)return!1;var r,t=[];for(r=0;r<e.count();r++)t.push(r);return e.PrintEx(t)}},{key:"PrintCurrentImage",value:function(){var e,t,n,i=this;if(!((e=i._ImgManager.getCurrentImageIndex())<0))return-1==(n=i._ImgManager.convertClientIndexToServerId(e))?(r.Errors.IndexOutOfRange(i),!1):(t=Rs.getImageUrl(i._ImgManager.getBaseUrl,n,-1,-1),i.__PrintInner(t,n,e))}},{key:"PrintEx",value:function(r){var t=this;if(!(t.count()<=0)){var n=[];return e.DWT.ConnectWithSocket?t.__GetPrintUrlforSocket(r,n):t.__GetPrintUrlforHttp(r,n),!0}}},{key:"__PrintInner",value:function(e,t,n){var i=this,o=i._ImgManager.getImageIdMap(t),a=[];if(!o)return!1;var s=o.width;(r.isUndefined(o.width)||o.width<=0)&&(o.width=i.getImageWidthFromServer(n));var u=o.height;(r.isUndefined(o.height)||o.height<=0)&&(o.height=i.getImageHeightFromServer(n));var c=new qO(e,o.width,o.height);return a.push(c),o.width=s,o.height=u,Rs.print(a),!0}},{key:"__GetPrintUrl",value:function(e,r,t){var n,i,o=this,a=0,s=0;return(n=o._ImgManager.getImageIdMap(r))&&(!n.width||n.width<=0?n.width=o.getImageWidthFromServer(t):a=n.width,!n.height||n.height<=0?n.height=o.getImageHeightFromServer(t):s=n.height,i=new qO(e,n.width,n.height),n.width=a,n.height=s),i}},{key:"__GetPrintUrlforHttp",value:function(e,t){var n=this;r.each(e,(function(e){var r=n._ImgManager.convertClientIndexToServerId(e);if(-1!=r){var i=Rs.getImageUrl(n._ImgManager.getBaseUrl,r,-1,-1),o=n.__GetPrintUrl(i,r,e);t.push(o)}})),Rs.print(t)}},{key:"__GetPrintUrlforSocket",value:function(e,t){var n,i=this,o=r.Promise.resolve(0),a=0;return r.each(e,(function(s){o=o.then((function(){var o=i._ImgManager.convertClientIndexToServerId(s);-1!=o&&i._ImgManager.getImageData(s).then((function(u){if(a++,!u){var c={};return r.Errors.InvalidIndex(c),void Le(c._errorString)}n=Dn(u.oriData)?URL.createObjectURL(new Blob([u.oriData])):u.oriData instanceof Blob?URL.createObjectURL(u.oriData):u.oriData;var l=i.__GetPrintUrl(n,o,s);t.push(l),e.length==a&&Rs.print(t)}))}))})),!0}},{key:"__GetPrintUrlforMobileEx",value:function(e,t){var n,i=this,o=r.Promise.resolve(0),a=0;return r.each(e,(function(s){o=o.then((function(){var o=i._ImgManager.convertClientIndexToServerId(s);-1!=o&&i._ImgManager.getImageData(s).then((function(u){if(a++,!u){var c={};return r.Errors.InvalidIndex(c),void Le(c._errorString)}n=Dn(u.oriData)?URL.createObjectURL(new Blob([u.oriData])):u.oriData instanceof Blob?URL.createObjectURL(u.oriData):u.oriData;var l=i.__GetPrintUrl(n,o,s);t.push(l),e.length==a&&Rs.print(t)}))}))})),!0}},{key:"count",value:function(){return this._ImgManager.count()}},{key:"getImageHeightFromServer",value:function(e){var r,t,n,i=this,o=1*e;return r=i.count(),o<0||o>r?0:(n=i._ImgManager.convertClientIndexToServerId(o),(t=i._ImgManager.getImageIdMap(n))&&t.imageHeight?t.imageHeight:i._stwain.GetImageHeight(o))}},{key:"getImageWidthFromServer",value:function(e){var r,t,n,i=this,o=1*e;return r=i.count(),o<0||o>r?0:(n=i._ImgManager.convertClientIndexToServerId(o),(t=i._ImgManager.getImageIdMap(n))&&t.imageWidth?t.imageWidth:i._stwain.GetImageWidth(o))}}]),t}();function JO(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=Te(e);if(r){var i=Te(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return Se(this,t)}}function YO(e,r){!function(e,r){if(r.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,r),r.add(e)}function ZO(e,r,t){if(!r.has(e));return t}!function(e){e.Binary=0,e.Base64=1}(KO||(KO={})),e.DWT.EnumDWT_UploadDataFormat=KO,r.detect.viewerScriptLoaded=Ve;var QO=new WeakSet,$O=new WeakSet,eL=new WeakSet,rL=new WeakSet,tL=new WeakSet,nL=new WeakSet,iL=new WeakSet,oL=function(t){Ie(a,t);var n,i,o=JO(a);function a(t){var n;X(this,a),YO(ve(n=o.call(this,t)),iL),YO(ve(n),nL),YO(ve(n),tL),YO(ve(n),rL),YO(ve(n),eL),YO(ve(n),$O),YO(ve(n),QO),n._ImgManager=new zO(ve(n),n._imageBufferWrapper),n._imageBufferWrapper=n._ImgManager,n._ImagePrint=new XO(ve(n));var i,s,u=t||{};return n._config=u,n._destroying=Be,n._iServiceType=M,n.__addon={},n._bNoMask=u.bNoMask?Ve:Be,n._bNotShowMessage=u.bNotShowMessage?Ve:Be,n._bSelectedSourceByServer=Be,n._bKeepAwake=u.keepAwake,n._bAx=Be,u.container?n._containerElement=u.container:u.containerId&&(n._containerElement=r.get(u.containerId)),n.__IfShowCancelDialogWhenImageTransfer=Ve,n._errorCode=0,n._errorString="",n.__bLoadingImage=Be,n.__bAcquireImageNow=Be,n.__bOpenFileNow=Be,n.__defaultSourceName="",n.__sourceCount=0,n.__serverId="",n._bConnecting=Be,n.__licenseInfo=undefined,n.__strProductName=e.DWT.ProductName,n.__productKey="",n._moduleSize=1048576,n._b64bit=e.dcp.b64bit,n._driverType=F.TWAIN,n.__maxUploadImageSize=-1,n._bServerPercentDone=Ve,n._bSSL=e.navInfoSync.bSSL,n._bRegistedLoad=!1,n._logLevel=0,n._scaleDownThreshold=0,n._pdfWriteSetting={},n.__serverPlatform=I.enumUnknown,n._reconnectTimeSpan=e.Lib.product.LocaleReconnectTimeSpan,n._bRemoteMode||(n.httpFormFields={},n.HTTPPassword=u.HTTPPassword||"",n.HTTPPort=r.detect.ssl?443:80,n.HTTPUserName=u.HTTPUserName||"",n.__HTTPPostResponseString="",n.__remoteFilename="RemoteFile",n.__httpHeaderMap=Be,n._b64bit?n._segementUploadThreshold=4294967296:n._segementUploadThreshold=524288e3,n._aryTiffTag=[],n._tiffCompressionType=e.DWT.EnumDWT_TIFFCompressionType.TIFF_AUTO,n._jpgQuality=80,n._pdfConvertMode=3,n._pdfRealConvertMode=3,n._pdfResolution=200,n._pdfPassword=""),i=ve(n),(s=i)._bRemoteMode||(jR(s,"ProductKey",{get:function(){return e.DWT.ProductKey},set:function(e){return r.isString(e)?(s._resetErr(),!!s._isValid()&&s._setProductKey(e,!1)):(r.Errors.InvalidValue(s),Be)}}),jR(s,"ProductName",{get:function(){return s.__strProductName},set:function(e){return s._resetErr(),r.isString(e)?(s.__strProductName=e,Ve):(r.Errors.InvalidValue(s),Be)}}),jR(s,"VersionInfo",{get:function(){return e.DWT.JSVersion}}),jR(s,"DefaultSourceName",{get:function(){var e=s._getDefaultDevice();return e?e.displayName:""}}),jR(s,"ImageCaptureDriverType",{get:function(){return s._resetErr(),s._isValid()?s._driverType:0},set:function(e){var t=!1,n=!1,i=!1;if(s._bRemoteMode?s.__serverPlatform==I.enumWindow?i=!0:s.__serverPlatform==I.enumLinux?n=!0:s.__serverPlatform==I.enumMac&&(t=!0):(t=OO.bMac,n=OO.bLinux,i=OO.bWin),s._resetErr(),!s._isValid())return!1;if(""!==e){var o=1*e,a=!1;if(o<F.TWAIN||o>F.TWAIN64)return r.Errors.ImageCaptureDriverTypeError(s),Be;if(i){if(o===F.TWAIN_AND_TWAIN64)s._b64bit&&(s._driverType=o);else if(o!=F.TWAIN&&o!=F.TWAIN64)return r.Errors.ImageCaptureDriverTypeError(s),Be;s._b64bit||(o=F.TWAIN),s._driverType=o,a=!0}else if(n)o=F.SANE,s._driverType=o,a=!0;else if(t){if(o===F.TWAIN_AND_ICA);else if(o!=F.ICA&&o!=F.TWAIN&&o!=F.TWAIN64)return r.Errors.ImageCaptureDriverTypeError(s),Be;s._driverType=o,a=!0}return a&&(s._curDevice=null,s.__devices=null),!0}return r.Errors.ImageCaptureDriverTypeError(s),Be}}),jR(s,"HTTPPostResponseString",{get:function(){return s._resetErr(),s._isValid()&&s.__HTTPPostResponseString?s.__HTTPPostResponseString:""}}),jR(s,"IfAppendImage",{get:function(){return s._resetErr(),!!s._isValid()&&s.__IfAppendImage},set:function(e){return s._resetErr(),!!s._isValid()&&(r.isBoolean(e)?s.__IfAppendImage=e:(r.Errors.InvalidValue(s),Be))}}),jR(s,"FTPPort",{get:function(){return s._resetErr(),s._isValid()?s._innerFun("FTPPort"):0},set:function(e){if(s._resetErr(),!s._isValid())return!1;if(""!==e){var r=1*e;return s._innerFun("FTPPort",kn(r))}}}),jR(s,"JPEGQuality",{get:function(){return s._resetErr(),s._isValid()?s._innerFun("JPEGQuality"):0},set:function(e){var r=1*e;return r>=100?r=100:r<0&&(r=0),s._resetErr(),!!s._isValid()&&s._innerFun("JPEGQuality",kn(r))}}),RO(s,"TIFFCompressionType",FO,WO),RO(s,"BufferMemoryLimit",FO,WO),jR(s,"LogLevel",{get:function(){return s._resetErr(),s._isValid()?s._innerFun("LogLevel"):0},set:function(e){if(s._resetErr(),!s._isValid())return!1;var r=1*e;return s._logLevel=r,Cs.logLevel=s._logLevel,s._innerFun("LogLevel",kn(r))}}),jR(s,"HttpContentTypeFieldValue",{get:function(){return s._resetErr(),s._isValid()?s._strHttpContentTypeFieldValue:""},set:function(e){return s._resetErr(),!!s._isValid()&&(s._strHttpContentTypeFieldValue=e,e)}}),jR(s,"BrokerProcessType",{get:function(){return s._resetErr(),s._isValid()?1:0},set:function(e){return s._resetErr(),!!s._isValid()}}),jR(s,"BorderStyle",{get:function(){return s._resetErr(),!!s._isValid()&&0},set:function(e){return s._resetErr(),s._isValid(),!1}}),jR(s,"HttpFieldNameOfUploadedImage",{get:function(){return s._resetErr(),s._isValid()?s.__remoteFilename:""},set:function(e){return s._resetErr(),s._isValid()?s.__remoteFilename=e:""}}),jR(s,"style",{get:function(){return s._isValid()?s.__style:""}}),jR(s,"ScaleDownThreshold",{get:function(){return s._resetErr(),s._isValid()?s._scaleDownThreshold:0},set:function(e){var t=1*e;return!r.isNumber(t)||isNaN(t)?(r.Errors.InvalidValue(self),Be):(s._resetErr(),!!s._isValid()&&(s._scaleDownThreshold=e))}}),jR(s,"CurrentImageIndexInBuffer",{get:function(){return s._isValid()?s._ImgManager.getCurrentImageIndex():0},set:function(e){var r=1*e;return s._resetErr(),!!s._isValid()&&(r>=0&&r<s._ImgManager.count()&&(s._ImgManager.setSelectedClientIndexArray([r]),s._isBindViewer()&&GR.__innerRefreshFromUIView(s,s._ImgManager.getCurrentImageIndex())),!0)}}),jR(s,"SelectedImagesIndices",{get:function(){return s._resetErr(),s._isValid()?s._ImgManager.count()<=0?[]:s._ImgManager.getSelectedClientIndexArray():[]}}),jR(s,"MaxImagesInBuffer",{get:function(){return s._resetErr(),s._isValid()?s.__maxImagesInBuffer:0},set:function(e){var t=1*e;return s._resetErr(),!!s._isValid()&&(t>0&&t<32768?s.__maxImagesInBuffer=t:r.Errors.OutOfRange(s),s.__maxImagesInBuffer)}}),jR(s,"IfSSL",{get:function(){return s._bSSL},set:function(e){return s._bSSL=e,s._innerFun("IfSSL",kn(e)),!0}}),RO(s,"IfAllowLocalCache",FO,AO),jR(s,"UseLocalService",{get:function(){return!0}}),jR(s,"PDFCompressionType",{get:function(){return s._resetErr(),!!s._isValid()&&s._innerFun("PDFCompressionType")},set:function(r){var t=1*r;return t==e.DWT.EnumDWT_PDFCompressionType.PDF_FAX3&&(t=e.DWT.EnumDWT_PDFCompressionType.PDF_FAX4),s._resetErr(),!!s._isValid()&&s._innerFun("PDFCompressionType",kn(t))}}),s._setProductKey=function(t,n,i,o){var a=!0,u=t,c=function(e){e||(s.__licenseInfo=undefined);var t=!0;return o||(t=r.License.checkProductKey(s,{Core:!0})),r.isFunction(i)&&i(),t};if(s._resetErr(),!s._isValid())return!1;if(u=r.isString(u)?r.trim(u):"",e.DWT.ProductKey=u,""==u)a=!1,c();else{e.Lib.License.reparseProductKey();var l=e.DWT.licenseException;if(0!=l.code)return s.__licenseInfo=undefined,s._errorCode=l.code,s._errorString=l.message,r.isFunction(i)&&i(),!1;s._innerFunRaw("ProductKey",kn(u),n,!1,!1,(function(t){var i=!1;i=r.isArray(t)?t[0]:t,r.isArray(t)&&t.length>=3&&"1"===t[1]&&r.isFunction(e.DWT.ShowMessage)&&e.DWT.ShowMessage(t[2],{width:510,height:272,headerStyle:1,seconds:10}),n||(a=i),s.__licenseInfo=undefined,s.GetLicenseInfo((function(){s._setConvertMode(s._pdfConvertMode),c(!0)}),c)}),(function(){n||(a=!1),c()}))}return a},jO(s,["ProxyServer"]),jO(s,["CapValueString","CapDescription","FTPPassword","FTPUserName","Manufacturer","ProductFamily","PDFAuthor","PDFCreationDate","PDFCreator","PDFKeywords","PDFModifiedDate","PDFProducer","PDFSubject","PDFTitle","PDFVersion"]),GO(s,["ImageBitsPerPixel","ImageLength","ImageWidth","ImageXResolution","ImageYResolution"]),GO(s,["BlankImageCurrentStdDev","CapDefaultIndex","CapDefaultValue","DataSourceStatus","Duplex","PendingXfers","ImageLayoutDocumentNumber","ImageLayoutFrameBottom","ImageLayoutFrameLeft","ImageLayoutFrameNumber","ImageLayoutFrameRight","ImageLayoutFrameTop","ImageLayoutPageNumber","ImagePixelType","MagData","MagType","IfFeederLoaded","IfPaperDetectable","IfUIControllable"]),BO(s,["AllowPluginAuthentication","IfModalUI","IfScanInNewThread","_AutoCropMethod"]),BO(s,["IfDisableSourceAfterAcquire","IfDuplexEnabled","IfFeederEnabled","IfPASVMode","IfAutoBright","IfAutoDiscardBlankpages","IfAutoFeed","IfAutomaticBorderDetection","IfAutomaticDeskew","IfAutoScan","IfShowIndicator","IfUseTwainDSM","IfTiffMultiPage"]),VO(s,["MaxInternetTransferThreads"]),VO(s,["BlankImageMaxStdDev","BlankImageThreshold","BitDepth","Brightness","PageSize","PixelType","Resolution","Capability","CapCurrentIndex","CapCurrentValue","CapMaxValue","CapMinValue","CapNumItems","CapStepSize","CapType","CapValue","CapValueType","Contrast","PixelFlavor","TransferMode","Unit","XferCount"]),UO(s,["AsyncMode","EnableInteractiveZoom","IfThrowException","ImageEditorIfEnableEnumerator","ImageEditorIfReadonly","ImageEditorIfModal","ImageEditorWindowTitle","IfShowPrintUI","VScrollBar"],AO),UO(s,["IfOpenImageWithGDIPlus"])),function(e){jR(e,"Width",{get:function(){return e._resetErr(),e._isValid()?e._isNoViewer()?(e._nouiNotSupport("Width"),""):e._UIView.GetWidth():""},set:function(r){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("Width"):e._UIView.SetWidth(r))}}),jR(e,"Height",{get:function(){return e._resetErr(),e._isValid()?e._isNoViewer()?(e._nouiNotSupport("Height"),""):e._UIView.GetHeight():""},set:function(r){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("Height"):e._UIView.SetHeight(r))}}),jR(e,"AllowMultiSelect",{get:function(){return e._resetErr(),e._isValid()?e._isNoViewer()?e._nouiNotSupport("AllowMultiSelect"):e._UIView.GetAllowMultiSelect():""},set:function(r){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("AllowMultiSelect"):void e._UIView.SetAllowMultiSelect(r))}}),jR(e,"BackgroundColor",{get:function(){return e._resetErr(),e._isValid()?e._isNoViewer()?(e._nouiNotSupport("BackgroundColor"),""):e._UIView.GetBackgroundColor():""},set:function(r){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("BackgroundColor"):e._UIView.SetBackgroundColor(r))}}),jR(e,"BackgroundFillColor",{get:function(){if(e._resetErr(),!e._isValid())return"";if(e._isNoViewer())return e._nouiNotSupport("BackgroundFillColor"),"";var t=e._innerFun("BackgroundFillColor");return r.BGR2RGB(t)},set:function(t){if(e._resetErr(),!e._isValid())return!1;if(e._isNoViewer())return e._nouiNotSupport("BackgroundFillColor");var n,i=1*t;return!r.isNumber(i)||isNaN(i)?(r.Errors.InvalidValue(e),Be):(n=r.RGB2BGR(i),e._innerFun("BackgroundFillColor",kn(n)))}}),jR(e,"FitWindowType",{get:function(){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?(e._nouiNotSupport("FitWindowType"),0):e._UIView.GetFitWindowType())},set:function(r){if(e._resetErr(),!e._isValid())return!1;if(e._isNoViewer())return e._nouiNotSupport("FitWindowType");var t=1*r;return e._UIView.SetFitWindowType(t)}}),jR(e,"IfFitWindow",{get:function(){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("IfFitWindow"):e._UIView.GetIfFitWindow())},set:function(r){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("IfFitWindow"):r?e._UIView.SetIfFitWindow(!0):e._UIView.SetIfFitWindow(!1))}}),jR(e,"ImageMargin",{get:function(){return e._resetErr(),e._isValid()?e._isNoViewer()?(e._nouiNotSupport("ImageMargin"),0):e._UIView.GetImageMargin():0},set:function(r){if(e._resetErr(),!e._isValid())return!1;if(e._isNoViewer())return e._nouiNotSupport("ImageMargin");var t=parseInt(r);return!isNaN(t)&&e._UIView.SetImageMargin(t)}}),jR(e,"MouseX",{get:function(){return e._resetErr(),e._isValid()?e._isNoViewer()?(e._nouiNotSupport("MouseX"),0):e.__MouseX:0}}),jR(e,"MouseY",{get:function(){return e._resetErr(),e._isValid()?e._isNoViewer()?(e._nouiNotSupport("MouseY"),0):e.__MouseY:0}}),jR(e,"SelectionImageBorderColor",{get:function(){return e._resetErr(),e._isValid()?e._isNoViewer()?(e._nouiNotSupport("SelectionImageBorderColor"),""):e._UIView.GetSelectionImageBorderColor():""},set:function(r){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("SelectionImageBorderColor"):e._UIView.SetSelectionImageBorderColor(r))}}),jR(e,"Zoom",{get:function(){return e._resetErr(),e._isValid()?e._isNoViewer()?(e._nouiNotSupport("Zoom"),0):e._UIView.GetZoom():0},set:function(r){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("Zoom"):e._UIView.SetZoom(r))}}),jR(e,"MouseShape",{get:function(){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("MouseShape"):e._UIView.GetMouseShape())},set:function(r){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("MouseShape"):e._UIView.SetMouseShape(r))}}),jR(e,"SelectionRectAspectRatio",{get:function(){return e._resetErr(),e._isValid()?e._isNoViewer()?(e._nouiNotSupport("SelectionRectAspectRatio"),0):e._UIView.GetSelectionRectAspectRatio():0},set:function(r){if(e._resetErr(),!e._isValid())return!1;if(e._isNoViewer())return e._nouiNotSupport("SelectionRectAspectRatio");var t=parseFloat(r);return t>=0&&(e._UIView.SetSelectionRectAspectRatio(t),!0)}}),jR(e,"ShowPageNumber",{get:function(){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("ShowPageNumber"):e._UIView.GetShowPageNumber())},set:function(r){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("ShowPageNumber"):e._UIView.SetShowPageNumber(r))}}),jR(e,"IfAutoScroll",{get:function(){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("IfAutoScroll"):e._UIView.GetIfAutoScroll())},set:function(r){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("IfAutoScroll"):e._UIView.SetIfAutoScroll(r))}})}(ve(n)),n._innerInitEvents(u),n}return Q(a,[{key:"GetImageDataAsync",value:function(e){return this._ImgManager.getImageData(e)}},{key:"SetCustomDataAsync",value:function(e,r){return this._ImgManager.setCustomData(e,r)}},{key:"style",get:function(){return this.__style}},{key:"GetSourceNamesAsync",value:(i=ne(de.mark((function s(e){var r;return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((r=this)._resetErr(),r._isValid()){t.next=4;break}throw{code:r._errorCode,message:r._errorString};case 4:return Zn("GetSourceNamesAsync",r),t.prev=5,t.next=8,r._getSourceCountAsync(r._driverType);case 8:t.next=13;break;case 10:throw t.prev=10,t.t0=t["catch"](5),t.t0;case 13:return t.prev=13,Qn("GetSourceNamesAsync"),t.finish(13);case 16:if(!e){t.next=20;break}return t.abrupt("return",ZO(r,QO,aL).call(r));case 20:return t.abrupt("return",ZO(r,$O,sL).call(r));case 21:case"end":return t.stop()}}),s,this,[[5,10,13,16]])}))),function(e){return i.apply(this,arguments)})},{key:"SelectSourceAsync",value:function(e){return this._selectSourceAsync("SelectSourceAsync",e)}},{key:"SelectSourceByIndexAsync",value:function(e){return this._selectSourceByIndexAsync("SelectSourceByIndex",e)}},{key:"OpenSourceAsync",value:function(){return this._openSourceAsync("OpenSourceAsync")}},{key:"CloseSourceAsync",value:function(){return this._closeSourceAsync("CloseSourceAsync")}},{key:"OpenSourceManagerAsync",value:function(){var e=this;return e._resetErr(),e._isValid()?e._innerFunV2("OpenSourceManager"):r.Promise.reject({code:e._errorCode,message:e._errorString})}},{key:"CloseSourceManagerAsync",value:function(){var e=this;return e._resetErr(),e._isValid()?e._innerFunV2("CloseSourceManager"):r.Promise.reject({code:e._errorCode,message:e._errorString})}},{key:"AcquireImage",value:function(e,t,n){var i,o=this,a=null,s=null;return o._resetErr(),!!o._isValid()&&(r.isUndefined(n)&&(r.isFunction(e)&&r.isFunction(t)||r.isFunction(e)&&r.isUndefined(t)||r.isFunction(e)&&null==t||null==e&&r.isFunction(t))?(i={},r.isFunction(e)&&(a=e),r.isFunction(t)&&(s=function(e){e&&e.code&&(o._errorCode=e.code,o._errorString=e.message),t(o._errorCode,o._errorString)})):(i=r.isUndefined(e)||null==e?{}:r.clone(e),r.isFunction(t)&&(a=function(){t(i)}),r.isFunction(n)&&(s=function(e){e&&e.code&&(o._errorCode=e.code,o._errorString=e.message),n(i,o._errorCode,o._errorString)})),a||(a=function(){}),s||(s=function(e){e&&e.code&&(o._errorCode=e.code,o._errorString=e.message)}),o.AcquireImageAsync(i).then(a,s),!Vn.isServerInvalid(o))}},{key:"GetDevicesAsync",value:function(e,r,t){return this._getDevicesAsync("GetDevicesAsync",e,r,t)}},{key:"SelectDeviceAsync",value:function(e,t){var n=this;return n._resetErr(),n._isValid()?this._selectDeviceAsync("SelectDeviceAsync",e,t):r.Promise.reject({code:n._errorCode,message:n._errorString})}},{key:"AcquireImageAsync",value:function(e){return es(Te(a.prototype),"_acquireImage",this).call(this,this._curDevice,e)}},{key:"ImageIDToIndex",value:function(e){return this._imageIDToIndex(e)}},{key:"IndexToImageID",value:function(e){return this._indexToImageID(e)}},{key:"RemoveImage",value:function(e){return this._removeImage("RemoveImage",e)}},{key:"_innerGetSourceNamesSync",value:function(e){var r=this;return r._getSourceCountSync(),e?ZO(r,QO,aL).call(r):ZO(r,$O,sL).call(r)}},{key:"getCapabilities",value:function(e,r){return this._dwtGetCapabilities(e,r)}},{key:"setCapabilities",value:function(e,r,t){return this._dwtSetCapabilities(e,r,t)}},{key:"CancelAllPendingTransfers",value:function(){return this._resetErr(),!!this._isValid()&&this._innerFun("CancelAllPendingTransfers")}},{key:"CloseSource",value:function(){var e=this;if(e._resetErr(),!e._isValid())return!1;var r=e._innerFun("CloseSource");return r&&(e._curDevice=null),r}},{key:"CloseSourceManager",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._innerFun("CloseSourceManager")}},{key:"SelectDevice",value:function(t,n){var i,o=this;if(t&&t.deviceType,o._resetErr(),e.DWT.ConnectWithSocket)return r.Errors.MethodNotWork(o,"SelectDevice"),!1;var a,s=null===(i=this._dmService.attrs)||void 0===i?void 0:i.UUID;if(s)if((null===(a=t.serviceInfo.attrs)||void 0===a?void 0:a.UUID)==s);else{var u,c=(null===(u=t.serviceInfo.attrs)||void 0===u?void 0:u.url)||t.serviceInfo.server;if(!(c&&c.indexOf(s)>-1))return r.Errors.DeviceNotFound(o),!1}var l=!1;try{(l=ZO(this,eL,uL).call(this,t.strDevice,n))&&(this._curDevice=t,this._bSelectedSourceByServer=!1)}catch(d){l=!1,this._errorCode=e.DWT.EnumDWT_Error.CommonError,d&&d.message&&(this._errorString=d.message)}return l}},{key:"DisableSource",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._innerFun("DisableSource")}},{key:"FeedPage",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._innerFun("FeedPage")}},{key:"GetDeviceType",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._innerFun("GetDeviceType")}},{key:"GetSourceNameItems",value:function(e){var r=this;return r._resetErr(),!!r._isValid()&&(r.__sourceCount<0&&(r.__sourceCount=0),e<r.__sourceCount&&e>=0?r._getSourceNameByIndex(e):"")}},{key:"SourceNameItems",value:function(e){var r=this;return r._resetErr(),!!r._isValid()&&r.GetSourceNameItems(e)}},{key:"GetSourceNames",value:function(e){return this._innerGetSourceNamesSync(e)}},{key:"getSourceCount",value:function(e){return this._getSourceCountAsync(e)}},{key:"GetSourceCountAsync",value:function(e){return this._getSourceCountAsync(e)}},{key:"GetSourceType",value:function(e){var t=this,n=parseInt(e);if(t._resetErr(),isNaN(n))return r.Errors.InvalidParameter(t),!1;if(null==t.__devices&&t.GetSourceNames(!1),n>=t.__devices.length||n<0)return r.Errors.IndexOutOfRange(t),!1;var i,o,a,s=t.__devices[n];return i=s.deviceType,o=F.TWAIN,(a=i&Wn)==xn.TWAINSCANNER||a==xn.WIATWAINSCANNER||(a==xn.TWAINX64SCANNER?o=F.TWAIN64:a==xn.ICASCANNER?o=F.ICA:a==xn.SANESCANNER?o=F.SANE:(a&xn.TWAINX64SCANNER)==xn.TWAINX64SCANNER?(a&xn.TWAINSCANNER)!=xn.TWAINSCANNER&&(a&xn.WIATWAINSCANNER)!=xn.WIATWAINSCANNER||(o=F.TWAIN_AND_TWAIN64):(a&xn.ICASCANNER)==xn.ICASCANNER&&((a&xn.TWAINSCANNER)!=xn.TWAINSCANNER&&(a&xn.WIATWAINSCANNER)!=xn.WIATWAINSCANNER||(o=F.TWAIN_AND_ICA))),o}},{key:"OpenSource",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&(e._bRemoteMode?(r.Errors.OpenSourceMustAsyncWhenRemote(e),!1):e._innerFun("OpenSource"))}},{key:"OpenSourceManager",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._innerFun("OpenSourceManager")}},{key:"ResetImageLayout",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._innerFun("ResetImageLayout")}},{key:"RewindPage",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._innerFun("RewindPage")}},{key:"SelectSource",value:function(e,t){var n=this;if(n._resetErr(),!n._isValid())return!1;var i=F.TWAIN;if(r.isUndefined(e)){if(n._bRemoteMode)return r.Errors.SelectSourceMustAsyncWhenRemote(n),!1;if(n._driverType==F.TWAIN_AND_TWAIN64)return r.Errors.SelectSourceMustAsync(n),!1;n._driverType!=F.ICA&&n._driverType!=F.SANE&&n._driverType!=F.TWAIN64||(i=n._driverType);var o=fL.bMac,a=fL.bLinux,s=$n(i,fL.bWin,a,o,fL.bAndroid);return n._bSelectedSourceByServer=!0,n._curDevice=null,n._innerFun("SelectSource",kn(s))}n._driverType!=F.ICA&&n._driverType!=F.SANE&&n._driverType!=F.TWAIN64&&n._driverType!=F.TWAIN_AND_TWAIN64||(i=n._driverType);var u=fL.bMac,c=fL.bLinux,l=$n(i,fL.bWin,c,u,fL.bAndroid);return n.SelectSourceAsync(l).then((function(){r.isFunction(e)&&e()}),(function(){r.isFunction(t)&&t(n._errorCode,n._getErrorString())})),!0}},{key:"GetSourceTypeAsync",value:function(e){var t=this,n=1*e;return t._resetErr(),t._isValid()?r.Promise.resolve(t.GetSourceType(n)):r.Promise.reject({code:t._errorCode,message:t._errorString})}},{key:"SetFileXferInfo",value:function(r,t){var n,i,o=this;return o._resetErr(),!!o._isValid()&&(n=e.navInfoSync.bFileSystem?r.replace(/<%/g,"<%25"):r,i=Jn.replaceLocalFilename(n),o._innerFun("SetFileXferInfo",kn(i,t)))}},{key:"SetImageLayout",value:function(e,r,t,n){var i=this;return i._resetErr(),!!i._isValid()&&i._innerFun("SetImageLayout",kn(e,r,t,n))}},{key:"CapGet",value:function(){return this._resetErr(),!!this._isValid()&&this._innerFun("CapGet")}},{key:"CapGetCurrent",value:function(){return this._resetErr(),!!this._isValid()&&this._innerFun("CapGetCurrent")}},{key:"CapGetDefault",value:function(){return this._resetErr(),!!this._isValid()&&this._innerFun("CapGetDefault")}},{key:"CapGetFrameBottom",value:function(e){return this._resetErr(),!!this._isValid()&&this._innerFun("CapGetFrameBottom",kn(e))}},{key:"CapGetFrameLeft",value:function(e){return this._resetErr(),!!this._isValid()&&this._innerFun("CapGetFrameLeft",kn(e))}},{key:"CapGetFrameRight",value:function(e){return this._resetErr(),!!this._isValid()&&this._innerFun("CapGetFrameRight",kn(e))}},{key:"CapGetFrameTop",value:function(e){return this._resetErr(),!!this._isValid()&&this._innerFun("CapGetFrameTop",kn(e))}},{key:"CapGetHelp",value:function(){return this._resetErr(),!!this._isValid()&&this._innerFun("CapGetHelp")}},{key:"CapGetLabel",value:function(){return this._resetErr(),!!this._isValid()&&this._innerFun("CapGetLabel")}},{key:"CapGetLabels",value:function(){return this._resetErr(),!!this._isValid()&&this._innerFun("CapGetLabels")}},{key:"CapIfSupported",value:function(e){return this._resetErr(),!!this._isValid()&&this._innerFun("CapIfSupported",kn(e))}},{key:"CapReset",value:function(){return this._resetErr(),!!this._isValid()&&this._innerFun("CapReset")}},{key:"CapSet",value:function(){return this._resetErr(),!!this._isValid()&&this._innerFun("CapSet")}},{key:"CapSetFrame",value:function(e,r,t,n,i){return this._resetErr(),!!this._isValid()&&this._innerFun("CapSetFrame",kn(e,r,t,n,i))}},{key:"GetCapItems",value:function(e){return this._resetErr(),!!this._isValid()&&this._innerFun("GetCapItems",kn(e))}},{key:"GetCapItemsString",value:function(e){return this._resetErr(),!!this._isValid()&&this._innerFun("GetCapItemsString",kn(e))}},{key:"SetCapItems",value:function(e,r){return this._resetErr(),!!this._isValid()&&this._innerFun("SetCapItems",kn(e,r))}},{key:"SetCapItemsString",value:function(e,r){return this._resetErr(),!!this._isValid()&&this._innerFun("SetCapItemsString",kn(e,r))}},{key:"GenerateURLForUploadData",value:function(t,n,i,o,a){var s=this,u=[];if(n==e.DWT.EnumDWT_ImageType.IT_BMP||n==e.DWT.EnumDWT_ImageType.IT_JPG||n==e.DWT.EnumDWT_ImageType.IT_PNG){if(!r.isArray(t))return r.Errors.IndicesNotArray(s),r.isFunction(o)&&o(s._errorCode,s._getErrorString(),"",t,n),"";if(t.length>1)return r.Errors.UploadIndexMoreThanOne(s),r.isFunction(o)&&o(s._errorCode,s._getErrorString(),"",t,n),"";if(!s._checkIndices(t))return o(s._errorCode,s._getErrorString(),"",t,n),!1;var c=s._ImgManager.convertClientIndexToServerId(t[0]);-1!=c&&u.push(c)}else{if(n!=e.DWT.EnumDWT_ImageType.IT_TIF&&n!=e.DWT.EnumDWT_ImageType.IT_PDF)return r.isArray(t)?r.Errors.InvalidImageType(s):r.Errors.IndicesNotArray(s),r.isFunction(o)&&o(s._errorCode,s._getErrorString(),s.__HTTPPostResponseString,t,n),"";var l,d;if(r.isArray(t)){if(!s._checkIndices(t))return o(s._errorCode,s._getErrorString(),"",t,n),!1;l=t}else{if(-1!=t)return r.Errors.IndicesNotArray(s),r.isFunction(o)&&o(s._errorCode,s._getErrorString(),s.__HTTPPostResponseString,t,n),"";for(l=[],d=0;d<s._ImgManager.count();d++)l.push(d)}r.each(l,(function(e){var r=s._ImgManager.convertClientIndexToServerId(e);-1!=r&&u.push(r)}))}if(r.isFunction(i)&&r.isFunction(o)){return s._asyncGenerateURLForUploadData(u,n,a,i,(function(e){o(s._errorCode,s._getErrorString(),s.__HTTPPostResponseString,e,n)})),!0}return this._syncGenerateURLForUploadData(u,n,a)}},{key:"_syncGenerateURLForUploadData",value:function(t,n,i){var o,a=this,s=!1,u=e.dcp.managerVersion.join(""),c=i,l=",";r.isString(c)&&""!=c||(c="",l="");var d=["[",'"dcp","dwasm_'+u,'",',n,',"',t.join(","),'"',l,c,"]"].join("");if((o=this._innerFunRaw("GenerateURLForUploadData",d,!1,!1,!0))&&r.isArray(o.result)&&o.result.length>1){var f=o.result[0],h=o.result[1];1==f&&(s=["dcp://dwasm_",u,"/file/",h].join(""))}return r.isArray(t)&&r.each(t,(function(e){a._ImgManager.convertServerIdToClientIndex(e)})),0==s?(r.Errors.GenerateURL_InvalidRetFromServer(a),""):s}},{key:"_asyncGenerateURLForUploadData",value:function(t,n,i,o,a){var s=this,u=n,c=function(){if(r.isFunction(a)){var e=[];r.isArray(t)&&r.each(t,(function(r){var t=s._ImgManager.convertServerIdToClientIndex(r);t>-1&&e.push(t)})),a(e)}return""},l=",";if(u==e.DWT.EnumDWT_ImageType.IT_BMP||u==e.DWT.EnumDWT_ImageType.IT_JPG||u==e.DWT.EnumDWT_ImageType.IT_PNG){if(t.length>1)return r.Errors.UploadIndexMoreThanOne(s),c(),""}else if(u!=e.DWT.EnumDWT_ImageType.IT_TIF&&u!=e.DWT.EnumDWT_ImageType.IT_PDF)return r.Errors.InvalidImageType(s),c(),"";var d=!1,f=e.dcp.managerVersion.join(""),h=i;r.isString(h)&&""!=h||(h="",l="");var g=["[",'"dcp","dwasm_'+f,'",',u,',"',t.join(","),'"',l,h,"]"].join("");return this._innerFunRaw("GenerateURLForUploadData",g,!0,!1,!0,(function(e){if(e&&r.isArray(e.result)&&e.result.length>0)if(1==e.result[0]&&e.result.length>1){var i=e.result[1];d=["dcp://dwasm_",f,"/file/",i].join("")}else e.exception!==undefined&&e.description!==undefined?(s._errorCode=e.exception,s._errorString=e.description):r.Errors.GenerateURL_InvalidRetFromServer(s);else r.Errors.GenerateURL_InvalidRetFromServer(s);if(0==d)return c(),"";if(r.isFunction(o)){var a=[];r.isArray(t)&&r.each(t,(function(e){var r=s._ImgManager.convertServerIdToClientIndex(e);r>-1&&a.push(r)})),o(d,a,n)}return d}),c)}},{key:"SelectSourceByIndex",value:function(e){var t=this,n=parseInt(e);if(t._resetErr(),isNaN(n))return r.Errors.InvalidParameter(t),!1;if(null==t.__devices&&t.GetSourceNames(!1),n>=t.__devices.length||n<0)return r.Errors.IndexOutOfRange(t),!1;var i=t.__devices[n];return t.SelectDevice(i)}},{key:"EnableSource",value:function(e,r,t){var n=this;return n._resetErr(),!!n._isValid()&&n.AcquireImage(e,r,t)}},{key:"SourceCount",get:function(){return this._getSourceCountSync()}},{key:"CurrentSourceName",get:function(){return this._curDevice?this._curDevice.displayName:""}},{key:"checkStartScanParams",value:function(t,n){var i=this;if(!t)return r.Errors.ScanUploader_InvalidScanSetup(i),!1;if(!r.isUndefined(n.transferMode)&&0!=t.transferMode&&1!=t.transferMode&&2!=t.transferMode)return r.Errors.ScanUploader_InvalidTransferMode(i),!1;if(t.transferMode==e.DWT.EnumDWT_TransferMode.TWSX_FILE){if(!t.fileXfer)return r.Errors.ScanUploader_InvalidFileXfer(i),!1;if(!r.isString(t.fileXfer.fileName)||""==t.fileXfer.fileName)return r.Errors.ScanUploader_InvalidFileXferFilename(i),!1;if(!r.isNumber(t.fileXfer.fileFormat)||t.fileXfer.fileFormat<0||t.fileXfer.fileFormat>16)return r.Errors.ScanUploader_InvalidFileXferFileFormat(i),!1}if(n){if(!r.isString(n.type)||""==n.type)return r.Errors.ScanUploader_InvalidHttpType(i),!1;if(!n.httpParams)return r.Errors.ScanUploader_InvalidHttpParams(i),!1;if(t.transferMode!=e.DWT.EnumDWT_TransferMode.TWSX_FILE&&r.isUndefined(n.format))return r.Errors.ScanUploader_InvalidOutputFormat(i),!1;if(!r.isString(n.httpParams.url)||""==n.httpParams.url)return r.Errors.ScanUploader_InvalidHttpUrl(i),!1;if(!r.isString(n.httpParams.fileName)||""==n.httpParams.fileName)return r.Errors.ScanUploader_InvalidHttpFilename(i),!1}return!0}},{key:"startScan",value:function(t){var n=this,i=t;if(n._resetErr(),!n._isValid())return!1;if(1==n._startScanFlag)return r.Errors.StartScanFailed(n),r.Promise.reject({code:n._errorCode,message:n._getErrorString()});n._startScanFlag=!0,r.isObject(i)||(i={});var o,a,s,u=!1,c=!1,l=!0,d=!0,f=!0,h=!1,g=i.onFinally,p=[],m=[],_=0,v=1,y=[],I={type:"http",format:e.DWT.EnumDWT_ImageType.IT_PDF,reTries:3,useUploader:!1,singlePost:!0,showProgressBar:!0,removeAfterOutput:!0,httpParams:{url:"",headers:{},formFields:{},remoteName:"RemoteFile",fileName:""}},S=r.clone(i),T=i;if(s=S.funcScanStatus,delete S.funcScanStatus,r.isFunction(s)?S.bfuncScanStatus=!0:S.bfuncScanStatus=!1,S.outputSetup){var b={pdfSetup:{},tiffSetup:{}};gL(S.outputSetup,I),a=S.outputSetup,delete S.outputSetup,a.pdfSetup&&(a.format!=e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF&&a.format!=e.DWT.EnumDWT_ImageType.IT_PDF||r.mix(b.pdfSetup,a.pdfSetup)),a.tiffSetup&&(a.format!=e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_TIF&&a.format!=e.DWT.EnumDWT_ImageType.IT_TIF||r.mix(b.tiffSetup,a.tiffSetup)),a.format!=e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF&&a.format!=e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_TIF||(a.singlePost=!0),r.isNumber(a.httpParams.threads)&&(v=a.httpParams.threads),u=r.stringify(b),c=n.checkStartScanParams(S,a)}else(a=I).type="",c=n.checkStartScanParams(S,!1);if(!c)return new r.Promise((function(e,r){l&&(r({code:n._errorCode,message:n._getErrorString(),response:""}),l=!1,n._startScanFlag=!1)}));a.funcHttpUploadStatus&&(h=a.funcHttpUploadStatus);var E,C,w,k,D,x=n.__remoteFilename,P=n.MaxUploadImageSize,F=n.IfShowProgressBar,W=n.__OnPostTransferAsync,A=n.__OnPostAllTransfers,R=n.__OnHttpUploadStatus,O=n.__insertingIndex,L=n.__IfAppendImage,N=n.httpFormFields,M=n._tiffCompressionType,U=!1,B=a.showProgressBar;if((E=function(e){var t=!0;r.each(y,(function(e,r){-1==e.st&&(t=!1)})),t?C(e):setTimeout((function(){E(e)}),200)},C=function(r){r.__OnPostTransferAsync=W,r.__OnPostAllTransfers=A,r.__OnHttpUploadStatus=R,r.__remoteFilename=x,r.__maxUploadImageSize=P,r.IfShowProgressBar=F,r.__insertingIndex=O,r.__IfAppendImage=L,r.httpFormFields=N,r._tiffCompressionType=M,e.FileUploader&&(e.FileUploader.nextLoopTime=600),r._startScanFlag=!1},w=function(e,r,t){d?(r(t),E(e)):setTimeout((function(){w(e,r,t)}),200)},k=function(e,r){U=!0,l&&(l=!1,d||n._innerSendCmd("CancelAllPendingTransfers"),w(n,e,r))},D=function(e,t,n,i){if(r.isFunction(h)){var o,a=t,s=0;r.isNumber(i)&&i>0&&(s=i),o={fileName:a,percentage:n,statusCode:s,responseString:e.__HTTPPostResponseString},setTimeout((function(){h(o)}),10)}},n.__HTTPPostResponseString="",n.IfShowProgressBar=B,r.isNumber(S.insertingIndex)&&S.insertingIndex>-1&&(n.__insertingIndex=S.insertingIndex,n.__IfAppendImage=!1),r.isFunction(h)?n.__OnHttpUploadStatus=h:n.__OnHttpUploadStatus=!1,a.useUploader)&&!e.FileUploader)return new r.Promise((function(e,t){r.Errors.Uploader_ModuleError(n);var i={code:n._errorCode,message:n._getErrorString(),response:""};d=!0,k(t,i)}));if(o=a.reTries,a.useUploader){var V=a.httpParams.url;if(!r.startsWith(V,"http://")&&!r.startsWith(V,"https://")){var G=window.location.href,j=G.lastIndexOf("/");G=G.substring(0,j+1),a.httpParams.url=G+V}}else r.each(a.httpParams.headers,(function(e,r){n.SetHTTPHeader(r,e)})),r.each(a.httpParams.formFields,(function(e,r){n.SetHTTPFormField(r,e)}));return""!==a.httpParams.remoteName&&(n.__remoteFilename=a.httpParams.remoteName),new r.Promise((function(r,t){a.useUploader?e.FileUploader.Init(0,(function(e){r({uploadManager:e})}),(function(e,r){n._errorCode=e,n._errorString=r;var i={code:e,message:r,response:n.__HTTPPostResponseString};d=!0,k(t,i)})):r({})})).then((function(t){return new r.Promise((function(i,c){var l=function b(){(S.transferMode==e.DWT.EnumDWT_TransferMode.TWSX_FILE?_==m.length:_==p.length)?(r.closeProgress(null,"Scan Upload"),U=!0,i(T),C(n)):setTimeout(b,100)};s&&r.isFunction(s)&&(n.__OnPreAllTransfersAsync=function(e){s(e)}),n.registerEvent("OnPostTransferAsync",(function(i){var l,g,I,T,b,E,C=a.httpParams.url,w=n._convertGuidToServerId(i.imageId),x=a.singlePost,P=S.transferMode==e.DWT.EnumDWT_TransferMode.TWSX_FILE,F=a.removeAfterOutput,W=0;if(f&&(d=!1,f=!1),P?(W=m.length,m.push(i.path)):(W=p.length,p.push(w)),s&&r.isFunction(s)){var A={event:"postTransfer",bScanCompleted:!1,result:{currentPageNum:W+1}};setTimeout((function(){s(A)}),10)}if(U)return!1;if("http"==a.type)if(g=Jn.cformat(a.httpParams.fileName,W+1),I=Jn.cformat(a.httpParams.remoteName,W+1),x||"http"!=a.type)!x&&a.type;else if(r.isNumber(a.httpParams.maxSizeLimit)&&(n.__maxUploadImageSize=a.httpParams.maxSizeLimit),a.useUploader){B?(e.FileUploader.nextLoopTime=300,r.showProgress(n,"Scan Upload",n.__IfShowCancelDialogWhenImageTransfer)):r.hideProgress(),T=function(e,t){return n.__HTTPPostResponseString=t,D(n,e._fileName,100,200),n._OnPercentDone([0,100,"","http",e._fileName]),B&&r.closeProgress(null,"Scan Upload"),!P&&a.removeAfterOutput?setTimeout((function(){n._ImgManager.convertServerIdToClientIndex(w)>-1?ZO(n,nL,lL).call(n,w,(function(){_++}),(function(){_++})):_++}),100):_++,!0};var R,O=t.uploadManager;if(b=function(){if(B){var e,t=0;for(t=P?m.length:p.length,e=0;e<t;e++)r.closeProgress(null,"Scan Upload")}!P&&a.removeAfterOutput&&setTimeout((function(){n._ImgManager.convertServerIdToClientIndex(w)>-1&&ZO(n,nL,lL).call(n,w)}),100),O.CancelAllUpload();var i={code:n._errorCode,message:n._getErrorString(),response:n.__HTTPPostResponseString};return k(c,i),!1},E=function(e,r,t,i){var o=303;r==hL.TRANS_SERVICE_ERROR_404?o=404:r==hL.TRANS_SERVICE_ERROR_500?o=500:r==hL.TRANS_SERVICE_ERROR_503&&(o=503),n._errorCode=r,n._errorString=t,n.__HTTPPostResponseString=i,D(n,g,100,o),b()},R=function(){n.__HTTPPostResponseString="",D(n,g,100,303),b()},P){var L=O.CreateJob(),N=L.FormField;r.each(a.httpParams.headers,(function(e,r){L.HttpHeader[r]=e})),r.each(a.httpParams.formFields,(function(e,r){N.Add(r,e)})),L.ServerUrl=C,L.bDeleteFile=F,L.reTries=o,r.isNumber(a.httpParams.maxSizeLimit)&&(L.maxSizeLimit=a.httpParams.maxSizeLimit),L._fileName=g,L.SourceValue.Add(i.path,g,I),L.ImageType=S.fileXfer.fileFormat,L.ThreadNum=v,L.OnRunSuccess=T,L.OnRunFailure=E,(B||r.isFunction(h))&&(L.OnUploadTransferPercentage=function(e,t){t>0&&t<=100&&(100==t&&(t=99),B&&n._OnPercentDone([0,t,"","http",e._fileName]),r.isFunction(h)&&D(n,e._fileName,t,0))},r.cancelFrom=q.Scan,B&&(ZO(n,iL,dL).call(n,b),n._OnPercentDone([0,-1,e.MSG.Uploading,"http",g])),D(n,g,0,0)),O.Run(L)}else(l=a.format)==e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF?l=e.DWT.EnumDWT_ImageType.IT_PDF:l==e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_TIF&&(l=e.DWT.EnumDWT_ImageType.IT_TIF),B&&(r.cancelFrom=q.Scan,ZO(n,iL,dL).call(n,b),n._OnPercentDone([0,-1,e.MSG.Encoding,"http",g])),n._asyncGenerateURLForUploadData([w],l,u,(function(t){var i=O.CreateJob(),s=i.FormField;r.each(a.httpParams.headers,(function(e,r){i.HttpHeader[r]=e})),r.each(a.httpParams.formFields,(function(e,r){s.Add(r,e)})),i.ServerUrl=C,i.bDeleteFile=F,i.reTries=o,r.isNumber(a.httpParams.maxSizeLimit)&&(i.maxSizeLimit=a.httpParams.maxSizeLimit),i._fileName=g,i.SourceValue.Add(t,g,I),i.ImageType=l,i.ThreadNum=v,i.OnRunSuccess=T,i.OnRunFailure=E,(B||r.isFunction(h))&&(i.OnUploadTransferPercentage=function(e,t){t>0&&t<=100&&(100==t&&(t=99),B&&n._OnPercentDone([0,t,"","http",e._fileName]),r.isFunction(h)&&D(n,e._fileName,t,0))},B&&n._OnPercentDone([0,-1,e.MSG.Uploading,"http",g]),D(n,g,0,0)),O.Run(i)}),R)}else{var M={id:w,st:-1,bCancel:!1};if(y.push(M),0==W&&(B?r.showProgress(n,"Scan Upload",n.__IfShowCancelDialogWhenImageTransfer):r.hideProgress()),P)T=function(e){return M.st=0,!P&&a.removeAfterOutput?setTimeout((function(){n._ImgManager.convertServerIdToClientIndex(w)>-1?ZO(n,nL,lL).call(n,w,(function(){_++}),(function(){_++})):_++}),100):_++,!0},b=function(){!P&&a.removeAfterOutput&&setTimeout((function(){n._ImgManager.convertServerIdToClientIndex(w)>-1&&ZO(n,nL,lL).call(n,w)}),100);var e={code:n._errorCode,message:n._getErrorString(),response:n.__HTTPPostResponseString};return r.closeProgress(null,"Scan Upload"),2==M.st||(M.st=1,r.each(y,(function(e,r){-1==e.st&&(e.bCancel=!0)})),k(c,e)),!1},n._innerUploadDirectly(C,i.path,g,B,F,o,!1,M,T,b);else{if(T=function(e,r){return M.st=0,!P&&a.removeAfterOutput?setTimeout((function(){n._ImgManager.convertServerIdToClientIndex(w)>-1?ZO(n,nL,lL).call(n,w,(function(){_++}),(function(){_++})):_++}),100):_++,!0},b=function(e){!P&&a.removeAfterOutput&&setTimeout((function(){n._ImgManager.convertServerIdToClientIndex(w)>-1&&ZO(n,nL,lL).call(n,w)}),100);var t={code:n._errorCode,message:n._getErrorString(),response:n.__HTTPPostResponseString};return r.closeProgress(null,"Scan Upload"),2==M.st||(M.st=1,r.each(y,(function(e,r){-1==e.st&&(e.bCancel=!0)})),k(c,t)),!1},l=a.format,r.isUndefined(l)){var V=n._ImgManager.convertServerIdToClientIndex(w);return r.Errors.InvalidImageType(n),b([V]),!1}l==e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF?l=e.DWT.EnumDWT_ImageType.IT_PDF:l==e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_TIF&&(l=e.DWT.EnumDWT_ImageType.IT_TIF);var G={method:"startScan",url:C,serverIds:[w],headers:n._GetHttpHeadersAndClear(),formData:EO(n.httpFormFields),enumImageType:l,saveSetup:u,fileName:g,dataFormat:KO.Binary,retry:o,bOnlyResponseEmptyIsOK:!1,objUploadFileStatus:M,asyncSuccessFunc:T,asyncFailureFunc:b};n._asyncUploadCmd(G)}}})),n.__OnPostAllTransfers=function(){var f,y,I=-1,b=KO.Binary,E=a.httpParams.url,w=a.singlePost,x=S.transferMode==e.DWT.EnumDWT_TransferMode.TWSX_FILE,P=a.removeAfterOutput;s&&r.isFunction(s)&&(I=x?m.length:p.length,y={event:"postTransfer",bScanCompleted:!0,result:{currentPageNum:I}},setTimeout((function(){s(y)}),10));if(0==I)return r.Errors.SourceHasNothingToCapture(n),void setTimeout((function(){d=!0,g&&r.isFunction(g)&&g();var e={code:n._errorCode,message:n._getErrorString(),response:n.__HTTPPostResponseString};k(c,e)}),1e3);if(I>0&&-1029==n._errorCode)n._errorCode=0;else if(0!=n._errorCode){d=!0,g&&r.isFunction(g)&&g();var F={code:n._errorCode,message:n._getErrorString(),response:n.__HTTPPostResponseString};return void k(c,F)}if("http"==a.type){if(w&&"http"==a.type){var W,A,R,O=p;if(r.isNumber(a.httpParams.maxSizeLimit)&&(n.__maxUploadImageSize=a.httpParams.maxSizeLimit),a.useUploader){var L,N=t.uploadManager,M=N.CreateJob(),V=M.FormField;if(B?(e.FileUploader.nextLoopTime=300,r.showProgress(n,"Scan Upload",n.__IfShowCancelDialogWhenImageTransfer)):r.hideProgress(),W=function(e,t){var o=e._fileName;return o||(o=""),n._bServerPercentDone=!0,n.__HTTPPostResponseString=t,D(n,o,100,200),n._OnPercentDone([0,100,"","http"]),B&&r.closeProgress(null,"Scan Upload"),!x&&a.removeAfterOutput?setTimeout((function(){_=0,r.each(O,(function(e){n._ImgManager.convertServerIdToClientIndex(e)>-1?ZO(n,nL,lL).call(n,e,(function(){_++}),(function(){_++})):_++})),setTimeout(l,100)}),100):(U=!0,i(T),C(n)),!0},A=function(){n._OnPercentDone([0,100,"","http"]),B&&r.closeProgress(null,"Scan Upload"),N.CancelAllUpload(),n._bServerPercentDone=!0;var e={code:n._errorCode,message:n._getErrorString(),response:n.__HTTPPostResponseString};return k(c,e),!x&&a.removeAfterOutput&&setTimeout((function(){r.each(O,(function(e){n._ImgManager.convertServerIdToClientIndex(e)>-1&&ZO(n,nL,lL).call(n,e)}))}),100),!1},R=function(e,r,t,i){var o=303;r==hL.TRANS_SERVICE_ERROR_404?o=404:r==hL.TRANS_SERVICE_ERROR_500?o=500:r==hL.TRANS_SERVICE_ERROR_503&&(o=503),n._errorCode=r,n._errorString=t,n.__HTTPPostResponseString=i,D(n,"",100,o),A()},L=function(){n.__HTTPPostResponseString="",D(n,"",100,303),A()},B&&(r.cancelFrom=q.Scan,ZO(n,iL,dL).call(n,A)),x)r.each(a.httpParams.headers,(function(e,r){M.HttpHeader[r]=e})),r.each(a.httpParams.formFields,(function(e,r){V.Add(r,e)})),M.ServerUrl=E,M.bDeleteFile=P,M.reTries=o,r.isNumber(a.httpParams.maxSizeLimit)&&(M.maxSizeLimit=a.httpParams.maxSizeLimit),r.each(m,(function(e,r){var t=Jn.cformat(a.httpParams.fileName,r+1),n=Jn.cformat(a.httpParams.remoteName,r+1);M.SourceValue.Add(e,t,n)})),M.ImageType=S.fileXfer.fileFormat,M.ThreadNum=v,M.OnRunSuccess=W,M.OnRunFailure=R,(B||r.isFunction(h))&&(M.OnUploadTransferPercentage=function(e,t){t>0&&t<=100&&(100==t&&(t=99),B&&n._OnPercentDone([0,t,"","http"]),r.isFunction(h)&&(t>99&&(t=99),D(n,"",t,0)))},B&&n._OnPercentDone([0,-1,e.MSG.Uploading,"http"]),D(n,"",0,0)),N.Run(M);else if((f=a.format)==e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF||f==e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_TIF)f==e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF?f=e.DWT.EnumDWT_ImageType.IT_PDF:f==e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_TIF&&(f=e.DWT.EnumDWT_ImageType.IT_TIF),B&&n._OnPercentDone([0,-1,e.MSG.Encoding,"http"]),n._asyncGenerateURLForUploadData(O,f,u,(function(t){r.each(a.httpParams.headers,(function(e,r){M.HttpHeader[r]=e})),r.each(a.httpParams.formFields,(function(e,r){V.Add(r,e)})),M.ServerUrl=E,M.bDeleteFile=P,M.reTries=o,r.isNumber(a.httpParams.maxSizeLimit)&&(M.maxSizeLimit=a.httpParams.maxSizeLimit);var i=Jn.cformat(a.httpParams.fileName,1),s=Jn.cformat(a.httpParams.remoteName,1);M._fileName=i,M.SourceValue.Add(t,i,s),M.ImageType=f,M.ThreadNum=v,M.OnRunSuccess=W,M.OnRunFailure=R,(B||r.isFunction(h))&&(M.OnUploadTransferPercentage=function(e,t){t>0&&t<=100&&(100==t&&(t=99),B&&n._OnPercentDone([0,t,"","http",i]),r.isFunction(h)&&D(n,i,t,0))},B&&n._OnPercentDone([0,-1,e.MSG.Uploading,"http",i])),N.Run(M)}),L);else{var G=O.length,j=0,H=0,z="";B&&(n._bServerPercentDone=!1,n._OnPercentDone([0,-1,e.MSG.Encoding,"http"])),r.each(O,(function(t,i){var s=Jn.cformat(a.httpParams.fileName,i+1),c=Jn.cformat(a.httpParams.remoteName,i+1);n._asyncGenerateURLForUploadData([t],f,u,(function(t){H=(j+1)/G*100,z=[j+1,"/",G].join(""),n._OnPercentDone([0,H,z,"http"]),M.SourceValue.Add(t,s,c),++j>=G&&(B&&(n._bServerPercentDone=!0),r.each(a.httpParams.headers,(function(e,r){M.HttpHeader[r]=e})),r.each(a.httpParams.formFields,(function(e,r){V.Add(r,e)})),M.ServerUrl=E,M.bDeleteFile=P,M.reTries=o,r.isNumber(a.httpParams.maxSizeLimit)&&(M.maxSizeLimit=a.httpParams.maxSizeLimit),M.ImageType=f,M.ThreadNum=v,M.OnRunSuccess=W,M.OnRunFailure=R,(B||r.isFunction(h))&&(M.OnUploadTransferPercentage=function(e,t){t>0&&t<=100&&(100==t&&(t=99),B&&n._OnPercentDone([0,t,"","http"]),r.isFunction(h)&&(t>99&&(t=99),D(n,"",t,0)))},B&&n._OnPercentDone([0,-1,e.MSG.Uploading,"http"])),N.Run(M))}),L)}))}}else if(x)W=function(e){return n._bServerPercentDone=!0,!x&&a.removeAfterOutput?setTimeout((function(){_=0,r.each(O,(function(e){n._ImgManager.convertServerIdToClientIndex(e)>-1?ZO(n,nL,lL).call(n,e,(function(){_++}),(function(){_++})):_++})),setTimeout(l,100)}),100):(U=!0,i(T),C(n)),!0},A=function(e){n._bServerPercentDone=!0;var t={code:n._errorCode,message:n._getErrorString(),response:n.__HTTPPostResponseString};return k(c,t),!x&&a.removeAfterOutput&&setTimeout((function(){r.each(O,(function(e){n._ImgManager.convertServerIdToClientIndex(e)>-1&&ZO(n,nL,lL).call(n,e)}))}),100),!1},n._innerUploadFilesDirectly(E,m,a.httpParams.fileName,B,P,o,!1,W,A);else{W=function(e,t){return n._bServerPercentDone=!0,!x&&a.removeAfterOutput?setTimeout((function(){_=0,r.each(O,(function(e){n._ImgManager.convertServerIdToClientIndex(e)>-1?ZO(n,nL,lL).call(n,e,(function(){_++}),(function(){_++})):_++})),setTimeout(l,100)}),100):(U=!0,i(T),C(n)),!0},A=function(e){n._bServerPercentDone=!0;var t={code:n._errorCode,message:n._getErrorString(),response:n.__HTTPPostResponseString};return k(c,t),!x&&a.removeAfterOutput&&setTimeout((function(){r.each(O,(function(e){n._ImgManager.convertServerIdToClientIndex(e)>-1&&ZO(n,nL,lL).call(n,e)}))}),100),!1},f=a.format;var K=n._GetHttpHeadersAndClear(),X=EO(n.httpFormFields);if(f==e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF||f==e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_TIF){f==e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF?f=e.DWT.EnumDWT_ImageType.IT_PDF:f==e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_TIF&&(f=e.DWT.EnumDWT_ImageType.IT_TIF);var J=Jn.cformat(a.httpParams.fileName,1);Jn.cformat(a.httpParams.remoteName,1);var Y={method:"startScan",url:E,headers:K,formData:X,serverIds:O,enumImageType:f,saveSetup:u,fileName:J,dataFormat:b,retry:o,bOnlyResponseEmptyIsOK:!1,objUploadFileStatus:!1,asyncSuccessFunc:W,asyncFailureFunc:A};n._asyncUploadCmd(Y)}else O.length>0&&n._asyncUploadFilesCmd(E,O,K,X,f,a.httpParams.fileName,u,B,o,!1,W,A)}}w&&a.type}d=!0,g&&r.isFunction(g)&&g()};var I=function(){"http"!=a.type?(U=!0,i(T),C(n)):a.singlePost||setTimeout(l,100)};ZO(n,tL,cL).call(n,S,I,(function(r){if(-1029==n._errorCode){if(S.transferMode==e.DWT.EnumDWT_TransferMode.TWSX_FILE?m.length>0:p.length>0)return n._errorCode=0,I()}var t={code:n._errorCode,message:n._getErrorString(),response:n.__HTTPPostResponseString};k(c,t)}))}))}))}},{key:"_innerInitEvents",value:function(e){this.__OnWSReconnect=e.onWSReconnect||null,this.__OnWSClose=e.onWSClose||null,this.__OnWSMessage=e.onWSMessage||null,this.__OnWSError=e.onWSError||null,this.__OnPercentDone=e.onPercentDone||"",this.__OnPrintMsg=e.onPrintMsg||"",this.__OnResult=e.onResult||"",this.__OnAfterOperate=e.onAfterOperate||"",this.__OnBeforeOperate=e.onBeforeOperate||"",this.__OnOperateStatus=e.onOperateStatus||"",this.__OnBitmapChanged=e.onBitmapChanged||"",this.__OnGetFilePath=e.onGetFilePath||"",this.__OnPreAllTransfers=e.onPreAllTransfers||"",this.__OnPreTransfer=e.onPreTransfer||"",this.__OnPostLoad=e.onPostLoad||"",this.__OnPostTransfer=e.onPostTransfer||"",this.__OnPostAllTransfers=e.onPostAllTransfers||"",this.__OnSourceUIClose=e.onSourceUIClose||"",this.__OnTransferCancelled=e.onTransferCancelled||"",this.__OnTransferError=e.onTransferError||"",this.__OnInternetTransferPercentage=e.onInternetTransferPercentage||"",this.__OnInternetTransferPercentageEx=e.onInternetTransferPercentageEx||"",this.__OnRemoteScanStatusAsync=e.onRemoteScanStatusAsync||""}}],[{key:"create",value:(n=ne(de.mark((function u(e){var r;return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=new a(e),t.next=3,OR.STwainConnectToServer(r);case 3:return t.abrupt("return",r);case 4:case"end":return t.stop()}}),u)}))),function(e){return n.apply(this,arguments)})}]),a}(xO);function aL(){var e,t,n=[],i=this.__devices.length;for(e=0;e<i;e++){var o=this.__devices[e],a=o.deviceType,s={ProductName:"",DeviceInfo:{},DriverType:"",IsCurrentSource:!1,IsDefaultSource:!1,Manufacturer:"",ProductFamily:"",ProtocolMajor:0,ProtocolMinor:0,SupportedGroups:0,Version:{Country:0,Info:"",Language:0,MajorNum:0,MinorNum:0}},u=void 0,c=r.clone(o.deviceInfo);(t=a)==xn.TWAINSCANNER||t==xn.WIATWAINSCANNER||t==xn.TWAINX64SCANNER?(a==xn.TWAINSCANNER?u="TWAIN":a==xn.WIATWAINSCANNER?u="WIATWAIN":a==xn.TWAINX64SCANNER&&(u="TWAIN64"),s.Manufacturer=c.Manufacturer,s.ProductFamily=c.ProductFamily,s.ProtocolMajor=c.ProtocolMajor,s.ProtocolMinor=c.ProtocolMinor,s.SupportedGroups=c.SupportedGroups,s.Version=c.Version):a==xn.SANESCANNER?(u="SANE",s.DeviceInfo=c):a==xn.ICASCANNER?(u="ICA",s.DeviceInfo=c):a==xn.ESCLSCANNER?(u="eSCL",s.DeviceInfo=c):a==xn.WIFIDIRECTSCANNER?(u="WiFiScanner",s.DeviceInfo=c):a==xn.WIASCANNER&&(u="WIA",s.DeviceInfo=c),s.ProductName=o.displayName,s.DriverType=u,n.push(s)}return n}function sL(){var e,r=[],t=this.__devices.length;for(e=0;e<t;e++){var n=this.__devices[e];r.push(n.displayName)}return r}function uL(e,r){var t=["[",e,",",null!=r?r:ts.SMF_NAME,"]"].join("");return this._innerFun("SelectSourceEx",t)}function cL(e,t,n){var i,o,a=this,s=null,u=null;if(o=r.isUndefined(e)||null==e?{}:e,a._resetErr(),!a._isValid())return!1;if(r.isFunction(t)&&(s=function(){t(o)}),r.isFunction(n)&&(u=function(e,r){n(e,r,o)}),!r.License.checkProductKey(a,{Core:!0}))return r.isFunction(u)&&u(a._errorCode,a._errorString),!1;for(var c=0,l=0;l<ei.length;l++){var d=["__",ei[l]].join("");r.isFunction(a[d])&&(c|=1<<l)}return o.EnableEvents=c,i=["[",r.stringify(o),"]"].join(""),a.__bAcquireImageNow=!0,a.__innerAcquireOrLoadImageAsync("StartScan",i,!1,!0).then(s,u),!0}function lL(e,t,n){var i=this;return i._innerFunRaw("RemoveImage",kn(e),!0,!1,!0,(function(){i._OnBitmapChanged(["0",""+e,3,i._ImgManager.getCurrentImageIndex(),i._ImgManager.count()]),r.isFunction(t)&&t()}),n)}function dL(e){var t=this;t.IfShowCancelDialogWhenImageTransfer?(r.progressContext&&r.progressContext.on("cancel",(function(){r.Errors.UserCanceled(t),e()})),sR(!0)):sR(!1)}var fL=e.navInfoSync,hL={TRANS_SERVICE_ERROR_404:12,TRANS_SERVICE_ERROR_500:13,TRANS_SERVICE_ERROR_503:14},gL=function zL(e,t){if(!r.isUndef(e)&&!r.isUndef(t)&&null!=e&&null!=t){for(var n in t)e.hasOwnProperty(n)?"object"===J(e[n])&&zL(e[n],t[n]):e[n]=t[n];return e}};function pL(e){return mL.apply(this,arguments)}function mL(){return mL=ne(de.mark((function t(n){var i,o,a,s,u,c,l,d,f,h,g;return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=n.id,u=n.host,c=n.port,l=null===(i=n.Container)||void 0===i?void 0:i.id,d=window,!(o=e.DWT.GetWebTwain(s))&&l&&(a=e.DWT.GetWebTwain(l)),!o&&!a){t.next=9;break}throw n.bNoMask||r.closeLoadingMsg(),f={},o?r.Errors.ERR_CreateID_WebTwainIdDuplicated(f):r.Errors.ERR_CreateID_MustNotInContainers(f),{code:f._errorCode,message:f._errorString};case 9:return e.DWT.UseDefaultViewer||(n.container=null),((p=n.container)&&!r.isString(p)?Ve:Be)?n.bNoViewer=!1:n.bNoViewer=!0,t.prev=11,t.next=14,oL.create(n);case 14:h=t.sent,t.next=23;break;case 17:throw t.prev=17,t.t0=t["catch"](11),(g=t.t0&&t.t0.code)==e.DWT.EnumDWT_Error.ResponseDataTypeError||g==e.DWT.EnumDWT_Error.HTSTError||g==e.DWT.EnumDWT_Error.CORSError||(g==e.DWT.EnumDWT_Error.MustUpgrade?Mi(!0,!1):g==e.DWT.EnumDWT_Error.ModuleNotExists&&yR(u,c,h)),h&&h.dispose(),t.t0;case 23:return t.prev=23,d.DCP_DWT_OnClickCloseInstall&&d.DCP_DWT_OnClickCloseInstall(!1,!0),t.finish(23);case 26:return vL(h),t.abrupt("return",h);case 28:case"end":return t.stop()}var p}),t,null,[[11,17,23,26]])}))),mL.apply(this,arguments)}function _L(t,n){var i=e.navInfoSync;if(r.isFunction(e.OnWebTwainNeedUpgradeCallback)){var o,a,s={};if(a=e.dcp.getDSPath(),i.bWin)o=I.enumWindow;else if(e.navInfo.bEmbed||i.bAndroid||i.bChromeOS||i.bHarmonyOS||i.biPhone||i.biPad)i.bAndroid?o=I.enumAndroid:(s.deb=a,o=i.biPhone||i.biPad?I.enumiOS:i.bChromeOS?I.enumChromeOS:i.bHarmonyOS?I.enumHarmonyOS:I.enumEmbed);else if(i.bLinux){var u=e.dcp.getLinuxHTML5DebPath(),c=e.dcp.getLinuxHTML5RpmPath();a=u,s.deb=u,s.rpm=c,o=I.enumLinux}else o=I.enumMac;s["default"]=a;var l=r.one(".dynamsoft-dialog-license");l&&l.getEL()&&(l.getEL().style.display="none"),r.detect.needUpgrade=Ve,e.OnWebTwainNeedUpgradeCallback(r.product.name,s,r.product.bHTML5Edition,o,i.bIE,i.bSafari,r.detect.ssl,r.env.strIEVersion,r.detect.bPromptJSOrServerOutdated,t,n)}}function vL(e){return yL.apply(this,arguments)}function yL(){return yL=ne(de.mark((function t(n){var i,o,a;return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n&&!n._blts){t.next=2;break}return t.abrupt("return");case 2:if(-2207==n.ErrorCode&&(r.detect.bPromptJSOrServerOutdated=Ve,r.isFunction(e.DWT.OnWebTwainNeedUpgradeWebJavascript)&&e.DWT.OnWebTwainNeedUpgradeWebJavascript(n.ErrorString)),!r.product.dwtVersionInfo){t.next=7;break}i=r.product.dwtVersionInfo,t.next=10;break;case 7:return t.next=9,n._getVersionInfoAsync();case 9:i=t.sent;case 10:if(r.detect.bNeedUpgradeEvent||Ea(i)){t.next=19;break}if(r.detect.bNeedUpgradeEvent=Ve,!r.isFunction(e.DWT.OnWebTwainNeedUpgrade)){t.next=15;break}if(!e.DWT.OnWebTwainNeedUpgrade()){t.next=15;break}return t.abrupt("return");case 15:if(!n._bRemoteMode){t.next=18;break}return r.isFunction(e.OnRemoteWebTwainNeedUpgradeCallback)&&(o=n._serverInfo.port,e.OnRemoteWebTwainNeedUpgradeCallback(r.product.name,n._serverInfo.server,o,n._serverInfo.ssl)),t.abrupt("return");case 18:(r.product.bHTML5Edition&&n._isBindViewer()||!r.product.bHTML5Edition)&&((a=n._containerElement)&&(r.one(a).before(r.install._strNonInstallDIV),r.show(r.install._divDWTNonInstallContainerID)),""!=r.install._divDWTemessageContainer&&r.hide(r.install._divDWTemessageContainer),_L());case 19:case"end":return t.stop()}}),t)}))),yL.apply(this,arguments)}function IL(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=Te(e);if(r){var i=Te(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return Se(this,t)}}var SL=function(t){Ie(h,t);var n,i,o,a,s,u,c,l,d,f=IL(h);function h(e){var r;return X(this,h),(r=f.call(this,e))._bServerPercentDone=!0,r}return Q(h,[{key:"getDevices",value:function(e,r,t){return this._getDevices(e,r,t)}},{key:"acquireImage",value:function(e,r){return this._acquireImage(e,r)}},{key:"_acquireImageForSendTo",value:function(e,r,t,n){return es(Te(h.prototype),"_acquireImageForSendTo",this).call(this,e,r,t,n)}},{key:"getCapabilities",value:function(e,r){return this._getCapabilities(e,r)}},{key:"setCapabilities",value:function(e,r,t){return this._setCapabilities(e,r,t)}},{key:"closeSource",value:function(){return this._closeSource()}},{key:"setBufferMemoryLimit",value:(d=ne(de.mark((function g(e){var t,n;return de.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(t=this,r.isNumber(e)&&!isNaN(e)){i.next=4;break}throw r.Errors.InvalidValue(t),{code:t._errorCode,message:t._errorString};case 4:if(t._resetErr(),t._isValid()){i.next=7;break}throw{code:t._errorCode,message:t._errorString};case 7:return i.next=9,t._innerFunV2("BufferMemoryLimit",kn(e));case 9:return n=i.sent,i.abrupt("return",n);case 11:case"end":return i.stop()}}),g,this)}))),function(e){return d.apply(this,arguments)})},{key:"setIfAllowLocalCache",value:(l=ne(de.mark((function p(e){var t,n;return de.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(t=this,r.isBoolean(e)){i.next=4;break}throw r.Errors.InvalidValue(self),{code:t._errorCode,message:t._errorString};case 4:if(t._resetErr(),t._isValid()){i.next=7;break}throw{code:t._errorCode,message:t._errorString};case 7:return i.next=9,t._innerFunV2("IfAllowLocalCache",kn(e));case 9:return n=i.sent,i.abrupt("return",n);case 11:case"end":return i.stop()}}),p,this)}))),function(e){return l.apply(this,arguments)})},{key:"howManyImagesInBuffer",get:function(){return this._imageBufferWrapper.count()}},{key:"currentImageIndexInBuffer",get:function(){return this._imageBufferWrapper.getCurrentImageIndex()},set:function(e){this._imageBufferWrapper.setCurrentImageIndex(e)}},{key:"saveImages",value:(c=ne(de.mark((function m(e,r,t,n){var i;return de.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(i="saveImages",this._checkIndices(r)){o.next=3;break}throw{code:this._errorCode,message:this._getErrorString()};case 3:return this._containerElement=n,o.next=6,this._saveImages(i,e,r,t);case 6:case"end":return o.stop()}}),m,this)}))),function(e,r,t,n){return c.apply(this,arguments)})},{key:"getImages",value:function(e,r,t,n){if(!this._checkIndices(e))throw{code:this._errorCode,message:this._getErrorString()};return this._containerElement=n,this._getImages("getImages",e,r,t)}},{key:"removeImages",value:(u=ne(de.mark((function _(e){var r,t,n,i,o;return de.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(this._checkIndices(e)){a.next=2;break}throw{code:this._errorCode,message:this._getErrorString()};case 2:for(r=e.sort((function(e,r){return r-e})),t=[],n=0;n<r.length;n++)i=r[n],(o=this._imageBufferWrapper.convertClientIndexToServerId(i))>0&&t.push(o);if(0!=t.length){a.next=7;break}return a.abrupt("return");case 7:return a.next=9,this._innerFunV2("RemoveAllImages",kn(t.join(",")));case 9:if(!a.sent&&-1033!=this._errorCode){a.next=16;break}if(this._imageBufferWrapper.removeImages(r)){a.next=14;break}throw this._imageBufferWrapper.getError();case 14:a.next=17;break;case 16:throw{code:this._errorCode,message:this._errorString};case 17:case"end":return a.stop()}}),_,this)}))),function(e){return u.apply(this,arguments)})},{key:"updateImage",value:function(e,r,t){var n=this._imageBufferWrapper.getIndexByUid(e),i=this._imageBufferWrapper.convertClientIndexToServerId(n);return es(Te(h.prototype),"_updateImage",this).call(this,i,r,t)}},{key:"getSkewAngleFromBinaryAsync",value:function(e,t,n,i){var o=this;if(o._resetErr(),!o._isValid())return r.Promise.reject({code:o._errorCode,message:o._errorString});var a=this._imageBufferWrapper.getMetadataByIndex(e),s={imageId:this._imageBufferWrapper.convertClientIndexToServerId(e),bufferLen:t.size,imageType:Bn.IT_BMP,width:a.width,height:a.height,bit:a.bitDepth,xres:a.resolutionX,yres:a.resolutionY},u=r.stringify([r.stringify(s)]);return this._innerSendBlob("GetSkewAngleFromBinary",u,t,!0,!0,n,i)}},{key:"httpUpload",value:(s=ne(de.mark((function v(t,n,i,o,a,s,u){var c,l;return de.wrap((function(d){for(;;)switch(d.prev=d.next){case 0:if((c=this)._resetErr(),c._isValid()){d.next=4;break}throw{code:c._errorCode,message:c._errorString};case 4:if(!r.isUndefined(t)&&""!==t){d.next=9;break}throw r.Errors.ParameterCannotEmpty(c),{code:c._errorCode,message:c._errorString};case 9:if(r.isString(t)){d.next=12;break}throw r.Errors.InvalidUrl(c),{code:c._errorCode,message:c._errorString};case 12:if(c._checkIndices(n)){d.next=14;break}throw{code:c._errorCode,message:c._errorString};case 14:if(l=[],r.isArray(n)&&r.each(n,(function(e){var r=c._imageBufferWrapper.convertClientIndexToServerId(e);-1!=r&&l.push(r)})),0!=l.length){d.next=19;break}throw r.Errors.InvalidIndex(c),{code:c._errorCode,message:c._errorString};case 19:if(!r.isUndefined(i)){d.next=22;break}throw r.Errors.InvalidImageType(c),{code:c._errorCode,message:c._errorString};case 22:if(i!=e.DWT.EnumDWT_ImageType.IT_BMP&&i!=e.DWT.EnumDWT_ImageType.IT_JPG&&i!=e.DWT.EnumDWT_ImageType.IT_PNG){d.next=28;break}if(!(l.length>1)){d.next=26;break}throw r.Errors.UploadIndexMoreThanOne(c),{code:c._errorCode,message:c._errorString};case 26:d.next=33;break;case 28:if(i!=e.DWT.EnumDWT_ImageType.IT_TIF&&i!=e.DWT.EnumDWT_ImageType.IT_PDF){d.next=31;break}d.next=33;break;case 31:throw r.Errors.InvalidImageType(c),{code:c._errorCode,message:c._errorString};case 33:if(!(r.isUndefined(o)||o!=e.DWT.EnumDWT_UploadDataFormat.Binary&&o!=e.DWT.EnumDWT_UploadDataFormat.Base64)){d.next=36;break}throw r.Errors.InvalidDataFormat(c),{code:c._errorCode,message:c._errorString};case 36:return d.next=38,new r.Promise((function(e,n){var d,f,g=parseInt(i),p=parseInt(o);null!=s&&s.formFields&&(d=new FormData,r.each(null==s?void 0:s.formFields,(function(e,t){var n=e.name,i=e.value;r.isString(n)&&(i instanceof Blob?d.append(n,i,e.fileName):d.append(n,i))}))),null!=s&&s.headers&&(f={},r.each(null==s?void 0:s.headers,(function(e,t){r.isString(e.name)&&(f[e.name]=e.value)}))),c._containerElement=u,h._innerHTTPUpload(c,"httpUpload",t,null==s?void 0:s.responseType,f,d,l,g,p,a,void 0,0,!1,void 0,(function(t){if(r.isFunction(e)){var n=[];r.isArray(l)&&r.each(l,(function(e){var r=c._imageBufferWrapper.convertServerIdToClientIndex(e);r>-1&&n.push(r)}));try{is(e,t,n)}catch(i){}}return t=null,!0}),(function(e){if(r.isFunction(n))try{n(e)}catch(t){}return!1}))}));case 38:return d.abrupt("return",d.sent);case 39:case"end":return d.stop()}}),v,this)}))),function(e,r,t,n,i,o,a){return s.apply(this,arguments)})},{key:"getCustomDataByIndex",value:function(e){return this._imageBufferWrapper.getCustomDataByIndex(e)}},{key:"getIndexByUid",value:function(e){return this._imageBufferWrapper.getIndexByUid(e)}},{key:"getProfile",value:function(e){return es(Te(h.prototype),"_getProfile",this).call(this,e)}},{key:"setProfile",value:function(e,r){return es(Te(h.prototype),"_setProfile",this).call(this,e,r)}},{key:"imageIDToIndex",value:function(e){return this._imageIDToIndex(e)}},{key:"indexToImageID",value:function(e){return this._indexToImageID(e)}},{key:"rotate",value:function(e,t,n,i){var o=this;if(o._resetErr(),!o._isValid())return r.Promise.reject({code:o._errorCode,message:o._errorString});var a=parseInt(e);if(isNaN(a))return r.Errors.InvalidIndex(o),r.Promise.reject({code:o._errorCode,message:o._errorString});if(a<0||a>=o.howManyImagesInBuffer)return r.Errors.IndexOutOfRange(o),r.Promise.reject({code:o._errorCode,message:o._errorString});var s=o._imageBufferWrapper.convertClientIndexToServerId(a);return-1==s?(r.Errors.IndexOutOfRange(o),r.Promise.reject({code:o._errorCode,message:o._errorString})):o._innerFunV2("RotateEx",kn(s,t,n,i),!0).then((function(e){}))}},{key:"crop",value:function(e,t){var n=this;if(n._resetErr(),!n._isValid())return r.Promise.reject({code:n._errorCode,message:n._errorString});var i=parseInt(e);if(isNaN(i))return r.Errors.InvalidIndex(n),r.Promise.reject({code:n._errorCode,message:n._errorString});if(i<0||i>=n.howManyImagesInBuffer)return r.Errors.IndexOutOfRange(n),r.Promise.reject({code:n._errorCode,message:n._errorString});var o=n._imageBufferWrapper.convertClientIndexToServerId(i);if(-1==o)return r.Errors.IndexOutOfRange(n),r.Promise.reject({code:n._errorCode,message:n._errorString});var a=t.x,s=t.y,u=t.x+t.width,c=t.y+t.height;return n._innerFunV2("Crop",kn(o,a,s,u,c),!0).then((function(e){}))}},{key:"_createHttpUploaderConfig",value:function(){var e=this,r=new lR;return r.IfShowProgressBar=e.IfShowProgressBar,r.IfShowCancelDialogWhenImageTransfer=e.IfShowCancelDialogWhenImageTransfer,r.MaxUploadImageSize=e.MaxUploadImageSize,r.HTTPRequestswithCredentials=e.HTTPRequestswithCredentials,r.onPercent=function(r){e._OnPercentDone(r)},r.onHttpUploadStatus=function(e){},r}},{key:"_OnReady",value:(a=ne(de.mark((function y(){var t,n,i;return de.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return t=this,r.isLocalIP(t._serverInfo.server)&&(r.LS.item("DWT_port",t._serverInfo.port),r.LS.item("DWT_ssl",t._serverInfo.ssl?"true":"false")),t._bNoMask||Zn("OnReady",t),o.prev=3,o.next=6,es(Te(h.prototype),"_OnReady",this).call(this);case 6:return o.next=8,t._innerActiveUI(t._uuidForActiveUI);case 8:return n=o.sent,o.next=11,t._OnActiveUI(n);case 11:(i=t._id)&&!e.DWT.WebTwainIdMap[i]&&(e.DWT.WebTwainIdMap[i]=t),o.next=20;break;case 15:throw o.prev=15,o.t0=o["catch"](3),o.t0&&(t._errorCode=o.t0.code,t._errorString=o.t0.message),t.dispose(),o.t0;case 20:return o.prev=20,t._bNoMask||Qn("OnReady"),o.finish(20);case 23:case"end":return o.stop()}}),y,this,[[3,15,20,23]])}))),function(){return a.apply(this,arguments)})},{key:"_isBindViewer",value:function(){return this._bBindViewer}},{key:"_isNoViewer",value:function(){return!this._isBindViewer()}},{key:"setViewerInfo",value:function(e){this._bBindViewer=e}}],[{key:"create",value:(o=ne(de.mark((function I(e){var r;return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=new h(e),t.next=3,OR.STwainConnectToServer(r);case 3:return t.abrupt("return",r);case 4:case"end":return t.stop()}}),I)}))),function(e){return o.apply(this,arguments)})},{key:"_getBuffer",value:function(e){return $A._getBuffer(e._imageBufferWrapper)}},{key:"_setError",value:function(e,r,t){e._errorCode=r,e._errorString=t}},{key:"createByServiceInfo",value:(i=ne(de.mark((function S(e,t,n){var i,o,a;return de.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return o={id:r.guid(),dmService:t,bNoViewer:!0,bNoMask:null==t||null===(i=t.attrs)||void 0===i?void 0:i.bNoMask,bNotShowMessage:!0},(a=new h(o))._uuidForActiveUI=e,a._bLicenseErrorDispose=!1,n&&(a._containerElement=n),s.next=7,a._connnect();case 7:return s.next=9,OR.STwainConnectToServer(a);case 9:return s.abrupt("return",a);case 10:case"end":return s.stop()}}),S)}))),function(e,r,t){return i.apply(this,arguments)})},{key:"checkOnlineByServiceInfo",value:(n=ne(de.mark((function T(e){var t,n;return de.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return t={id:r.guid(),dmService:e,bNoViewer:!0,bNoMask:!0,bNotShowMessage:!0},i.prev=1,n=new h(t),i.next=5,n._connnect();case 5:return n.dispose(),i.abrupt("return",!0);case 9:return i.prev=9,i.t0=i["catch"](1),r.warn(i.t0),i.abrupt("return",!1);case 13:case"end":return i.stop()}}),T,null,[[1,9]])}))),function(e){return n.apply(this,arguments)})},{key:"_isReady",value:function(e){return e._bReady}},{key:"_innerHTTPUpload",value:function(t,n,i,o,a,s,u,c,l,d,f,h,g,p,m,_){var v=d,y=i,I=!1;if(r.isUndefined(c))return r.Errors.InvalidImageType(t),r.isFunction(_)&&_({code:t._errorCode,message:t._errorString}),!1;r.cancelFrom=q.HTTPUpload;var S,T=function(e,i,o){return r.needShowTwiceShowDialog=!1,t.IfShowProgressBar&&r.closeProgress(null,n),r.isFunction(_)&&_({code:e,message:i,response:o}),!1},b=t._createHttpUploaderConfig();if(b.objUploadStatus=p,v=iR(v,c),r.needShowTwiceShowDialog=!0,t.IfShowProgressBar?(r.showProgress(t,n,!1),r.progressContext&&(r.progressContext._onPercent=function(e){var t=0;if(e){var n,i;n=e.loaded,i=e.total,(t=Math.floor(n/i*100))>100&&(t=100)}r.progressBarOnPercentDone(-1,"Transferring","",t,"")})):r.hideProgress(),l==e.DWT.EnumDWT_UploadDataFormat.Binary){if(p&&p.bCancel)return p.st=2,r.Errors.UserCanceled(t),T(t._errorCode,t._errorString);b.onPercent([0,-1,e.MSG.Encoding,"http"]),t._convertToBlobForUpload(c,u,f,4,(function(i,u,c){if(S=function(e){return r.needShowTwiceShowDialog=!1,t.IfShowProgressBar&&r.closeProgress(null,n),r.isFunction(m)&&is(m,e),e=null,!0},p&&p.bCancel)return p.st=2,r.Errors.UserCanceled(t),T(t._errorCode,t._errorString);if(!i||i.size<=0)return r.Errors.UploadFileCannotEmpty(t),T(t._errorCode,t._errorString);var l=t.__maxUploadImageSize;if(i.size>l&&-1!=l)return r.Errors.UploadExceededMaxSize(t),T(t._errorCode,t._errorString);if(0!=t._errorCode)return T(t._errorCode,t._errorString);e.DWT.IfAddMD5InUploadHeader&&u&&""!=u&&(a["dwt-md5"]=u);var d=new uR,f=new cR;f.url=y,f.method=n,f.content=i,i=null,f.contentType=t._strHttpContentTypeFieldValue,f.headers=a,f.fileName=v,f.httpFormData=s,f.retry=h,f.bOnlyResponseEmptyIsOK=g,f.responseType=o,b.objUploadStatus=p,I=d.httpPostUpload(b,f,S,T)}),T),I=!0}else if(l==e.DWT.EnumDWT_UploadDataFormat.Base64){t._convertToBase64ByServerIdsWithUI(n,u,c,f,4,(function(i){var u,c;if(!i||i.getLength()<=0)return r.Errors.UploadFileCannotEmpty(t),T(t._errorCode,t._errorString);if(S=function(e){return r.needShowTwiceShowDialog=!1,t.IfShowProgressBar&&r.closeProgress(null,n),r.isFunction(m)&&is(m,e),!0},u=i.getMD5(),e.DWT.IfAddMD5InUploadHeader&&(a["dwt-md5"]=u),!(c=i.getData(0,i.getLength()))||""==c)return r.Errors.UploadFileCannotEmpty(t),T(t._errorCode,t._errorString);var l=new cR;l.url=y,l.method=n,l.content=c,c=null,l.headers=a,l.fileName=v,l.httpFormData=s,l.retry=h,l.bOnlyResponseEmptyIsOK=g,l.responseType=o,(new uR).httpPostUpload(b,l,S,T)}),T)}return I}}]),h}(OR),TL=Rs,bL=function(){function t(n){var i=this;if(X(this,t),this._serverUrl=n,this._defaultDSScanClient=null,this._dsScanClientsMap={},this._serviceInfos=null,this._id=r.guid(),this.onBufferChanged=null,this.onPostTransferAsync=null,this._errorCode=0,this._errorString="",this._bDispose=!1,this._needSetLogLevel=!1,this._logLevel=-1,this._showProgressBar=!0,this._checkServerUrl(),this._id&&!e.DWT.RemoteScanIdMap[this._id]&&(e.DWT.RemoteScanIdMap[this._id]=this),this._uuidForRemoteScanObject="",r.dlgProgress||r.initProgress(null),e.DWT.UseDefaultViewer){var o={viewerEvents:{bufferChanged:function(e,r){i.__bufferChanged(i,e,r)},save:function(e,r,t,n){return i.__save(e,r,t,n)},rotate:function(e,r,t){return i.__rotate(e,r,t)},crop:function(e,r,t,n,o){return i.__crop(e,{x:r,y:t,width:n,height:o})}},viewerError:{setError:function(e,r){i._defaultDSScanClient?SL._setError(i._defaultDSScanClient,e,r):0==e&&""==r||(i._errorCode=e,i._errorString=r)}},imageEditorEvents:{deskew:function(e,r){i.__deskew(i,e,r)},removeImage:function(){i.__remove(i)},removeAllImage:function(){i.__removeAll(i)},close:function(){i.__close(i)}},imageEditorUiConfig:{buttons:{visibility:{scan:!1,load:!1}}}};this._viewer=new e.DWTViewerEx(null,o)}else this._viewer=null}var n,i,o,a,s,u,c,l,d,f,h,g,p,m,_,v,y,I,S,T,b,E;return Q(t,[{key:"Viewer",get:function(){return this._viewer}},{key:"_disposeDSClientByKey",value:function(e){var r=this._dsScanClientsMap[e];r&&(r.isDestroy||r.dispose(),delete this._dsScanClientsMap[e])}},{key:"_checkServerUrl",value:function(){var e=this._serverUrl;if(e&&r.isString(e)&&r.startsWith(location.href,"https://")&&r.startsWith(e,"http://")){var t={};throw r.Errors.HTTPSRequired(t,location.href,e),We(t)}if(!r.isString(e)||""==e){var n={};throw r.Errors.InvalidServerUrl(n),We(n)}}},{key:"getDynamsoftService",value:(E=ne(de.mark((function C(t){var n,i,o,a,s,u,c,l,d,f,h,g,p,m,_,v,y,I,S,T;return de.wrap((function(b){for(;;)switch(b.prev=b.next){case 0:if(!this._bDispose){b.next=4;break}throw n={},r.Errors.RemoteScanObjectDispose(n),We(n);case 4:if(i=this._serverUrl,this._checkServerUrl(),o=new Cs(i,!0),Zn("getDynamsoftService",this.getViewerElement()),b.prev=8,!t&&this._serviceInfos){b.next=68;break}if(a=null,s=this._serviceInfos,this._serviceInfos=[],u="",c="",!r.License.isLTS()){b.next=30;break}return b.next=16,this._setRemoteUuid();case 16:return b.prev=16,b.next=19,wi(e.DWT.EnumInstance.dwt_desktop,"");case 19:(l=b.sent)&&(u=l.ar,c=this._uuidForRemoteScanObject),b.next=28;break;case 23:throw b.prev=23,b.t0=b["catch"](16),UR(d={},b.t0),{code:d._errorCode,message:d._errorString};case 28:b.next=31;break;case 30:u=r.product.refProductKey;case 31:return b.next=33,o.getDynamsoftService(u,c,t);case 33:if(!(a=b.sent)){b.next=68;break}h=[],f=0;case 37:if(!(f<a.length)){b.next=65;break}return m=Un(a[f]),_=null!==(g=null==m||null===(p=m.attrs)||void 0===p?void 0:p.ty)&&void 0!==g?g:"",b.next=42,SL.checkOnlineByServiceInfo(m);case 42:if(!b.sent){b.next=60;break}if(m.attrs=m.attrs||{},m.attrs.bNoMask=!0,m.attrs.bNotShowMessage=!0,!s){b.next=57;break}v=void 0,v=0;case 50:if(!(v<s.length)){b.next=57;break}if(!this.isSameService(m,s[v])){b.next=54;break}return s.splice(v,1),b.abrupt("break",57);case 54:v++,b.next=50;break;case 57:this._serviceInfos.push(m),b.next=61;break;case 60:_+="(x)";case 61:h.push(_);case 62:f++,b.next=37;break;case 65:if(r.log("Find Dynamsoft Services:"),r.log(h.join(", ")),s)for(y=0;y<s.length;y++)(T=null===(I=s[y])||void 0===I||null===(S=I.attrs)||void 0===S?void 0:S.UUID)&&this._disposeDSClientByKey(T);case 68:this._needSetLogLevel&&-1!=this._logLevel&&this.setLogLevel(this._logLevel),b.next=74;break;case 71:throw b.prev=71,b.t1=b["catch"](8),b.t1;case 74:b.prev=74,Qn("getDynamsoftService");try{o._bInited&&o.dispose()}catch(AA){}return b.finish(74);case 78:return b.abrupt("return",this._serviceInfos);case 79:case"end":return b.stop()}}),C,this,[[8,71,74,78],[16,23]])}))),function(e){return E.apply(this,arguments)})},{key:"getDefaultDynamsoftService",value:function(){if(this._bDispose){var e={};throw r.Errors.RemoteScanObjectDispose(e),We(e)}return this._defaultDSScanClient?this._defaultDSScanClient.getServiceInfo():null}},{key:"setDefaultDynamsoftService",value:(b=ne(de.mark((function w(e){var t,n,i,o;return de.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!this._bDispose){a.next=4;break}throw t={},r.Errors.RemoteScanObjectDispose(t),We(t);case 4:if(null!==e){a.next=7;break}return this._defaultDSScanClient=null,a.abrupt("return");case 7:if(e&&e instanceof Mn){a.next=11;break}throw n={},r.Errors.InvalidParameter(n),{code:n._errorCode,message:n._errorString};case 11:return i=this.getViewerElement(),a.next=14,this._createDSClientByServiceInfo(e,!0,i._containerElement);case 14:if(!(o=a.sent)){a.next=18;break}return a.next=18,this._innerSetDefault(o);case 18:case"end":return a.stop()}}),w,this)}))),function(e){return b.apply(this,arguments)})},{key:"_innerSetDefault",value:(T=ne(de.mark((function k(e){var t,n,i,o;return de.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!e){a.next=10;break}if(SL._isReady(e)){a.next=5;break}throw o=null!==(t=null===(n=e.getServiceInfo())||void 0===n||null===(i=n.attrs)||void 0===i?void 0:i.name)&&void 0!==t?t:"",r.Errors.DynamsoftServiceStopped(e,o),{code:e._getErrorCode(),message:e._getErrorString()};case 5:this._defaultDSScanClient=e,this._defaultDSScanClient.IfShowProgressBar=this._showProgressBar,this.Viewer&&this.Viewer.webViewer&&this.Viewer.webViewer.bindViewUI&&this._defaultDSScanClient.setViewerInfo(this.Viewer.webViewer.bindViewUI),this._registEventToDefaultDS(),this._viewer&&this._viewer.webViewer.setBufferService(SL._getBuffer(this._defaultDSScanClient));case 10:case"end":return a.stop()}}),k,this)}))),function(e){return T.apply(this,arguments)})},{key:"__bufferChanged",value:function(e,t,n){var i,o=e,a=[],s=-1,u=[];t.operation&&(t.action=t.operation);for(var c=0;c<o.howManyImagesInBuffer;c++)(i=o._defaultDSScanClient.getCustomDataByIndex(c))&&i.imageId&&a.push(CR(i.imageId));if(t.imageIds=a,t.curIndex>=0&&(i=o._defaultDSScanClient.getCustomDataByIndex(t.curIndex))&&i.imageId&&(s=CR(i.imageId)),t.currentId=s,t.afterStatus.selectedUids)for(var l=0;l<t.afterStatus.selectedUids.length;l++){if(t.afterStatus.selectedUids[l]){var d=o._defaultDSScanClient.getIndexByUid(t.afterStatus.selectedUids[l]);d>=0&&(i=o._defaultDSScanClient.getCustomDataByIndex(d))&&i.imageId&&u.push(CR(i.imageId))}}t.selectedIds=u,r.mix(t,{}),delete t.uids,delete t.currentUid,delete t.selectedUids,delete t.afterStatus,delete t.beforeStatus,delete t.operation,delete t.curIndex,delete t.docUid,o.__fireEvent("onBufferChanged",t)}},{key:"__acquire",value:function(t){var n=t;n._stwain.SelectSource((function(){n._stwain.CloseSource(),n._stwain.OpenSource(),n._stwain.IfShowUI=!0,1==e.DWT.IfConfineMaskWithinTheViewer?(e.DWT.IfConfineMaskWithinTheViewer=!1,n._stwain.AcquireImage({},(function(){e.DWT.IfConfineMaskWithinTheViewer=!0}),(function(){}))):n._stwain.AcquireImage()}),(function(){r.log("User did not select a source")}))}},{key:"__remove",value:(S=ne(de.mark((function D(e){var t,n;return de.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this,!this._defaultDSScanClient){e.next=10;break}if(r.Errors.ClearErrorInfo(this._defaultDSScanClient),!(t.howManyImagesInBuffer<=0||t.currentImageIndexInBuffer<0)){e.next=6;break}return TL.output(t,"No image in Buffer"),e.abrupt("return",!0);case 6:return n=SL._getBuffer(this._defaultDSScanClient),e.next=9,this._defaultDSScanClient.removeImages(n.getSelectedImagesIndices());case 9:return e.abrupt("return",e.sent);case 10:return e.abrupt("return",!1);case 11:case"end":return e.stop()}}),D,this)}))),function(e){return S.apply(this,arguments)})},{key:"__removeAll",value:(I=ne(de.mark((function x(e){return de.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._defaultDSScanClient){e.next=4;break}return r.Errors.ClearErrorInfo(this._defaultDSScanClient),e.next=4,this._defaultDSScanClient._removeAllImagesAsync("removeAllImages",!0);case 4:return e.abrupt("return",!1);case 5:case"end":return e.stop()}}),x,this)}))),function(e){return I.apply(this,arguments)})},{key:"__save",value:(y=ne(de.mark((function P(e,t,n,i){var o,a,s;return de.wrap((function(u){for(;;)switch(u.prev=u.next){case 0:if(a="save",s=(o=this).__getViewerElementForViewer(o,i),Zn(a,s),u.prev=3,r.Errors.ClearErrorInfo(o._defaultDSScanClient),!(o.howManyImagesInBuffer<=0||o.currentImageIndexInBuffer<0)){u.next=8;break}return TL.output(o,"No image in Buffer"),u.abrupt("return");case 8:return u.next=10,o._defaultDSScanClient.updateImage(e,t,n);case 10:return u.sent,u.next=13,o._defaultDSScanClient.__saveToViewerAfterUpdate(e,n);case 13:u.next=17;break;case 15:u.prev=15,u.t0=u["catch"](3);case 17:return u.prev=17,Qn(a),u.finish(17);case 20:case"end":return u.stop()}}),P,this,[[3,15,17,20]])}))),function(e,r,t,n){return y.apply(this,arguments)})},{key:"__getViewerElementForViewer",value:function(e,r){var t,n=e;if(r)if(n._viewer.webViewer.imageEditor){var i=n._viewer.createImageEditor();t="dwt-viewer-imageEditor-fullScreen"==i.inner.containerElement.className?{_containerElement:document.body}:{_containerElement:i.inner.containerElement}}else t=n.getViewerElement();else t=n.getViewerElement();return t}},{key:"__close",value:function(e){var t=e;if(r.isFunction(t.__CloseImageEditorUI))try{t.__CloseImageEditorUI()}catch(n){Le(n)}}},{key:"__deskew",value:function(e,t,n){var i=this,o="deskew";if(r.Errors.ClearErrorInfo(i._defaultDSScanClient),i.howManyImagesInBuffer<=0||i.currentImageIndexInBuffer<0)TL.output(i,"No image in Buffer");else{var a=i.__getViewerElementForViewer(i,!0);Zn(o,a);i._defaultDSScanClient.getSkewAngleFromBinaryAsync(i.currentImageIndexInBuffer,t,(function(e){n(e[0]),Qn(o)}),(function(){Qn(o)}))}}},{key:"__rotate",value:(v=ne(de.mark((function F(e,t,n){var i,o;return de.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return i=this,r.Errors.ClearErrorInfo(i._defaultDSScanClient),a.next=4,this._makeSureDefaultServiceInfo();case 4:if(this._defaultDSScanClient){a.next=6;break}throw r.Errors.DefaultDynamsoftServiceInvalidError();case 6:return a.next=8,this._defaultDSScanClient.rotate(e,t,n,-1);case 8:return o=a.sent,a.abrupt("return",o);case 10:case"end":return a.stop()}}),F,this)}))),function(e,r,t){return v.apply(this,arguments)})},{key:"__crop",value:(_=ne(de.mark((function W(e,t){var n,i;return de.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return n=this,r.Errors.ClearErrorInfo(n._defaultDSScanClient),o.next=4,this._makeSureDefaultServiceInfo();case 4:if(this._defaultDSScanClient){o.next=6;break}throw r.Errors.DefaultDynamsoftServiceInvalidError();case 6:return o.next=8,this._defaultDSScanClient.crop(e,t);case 8:return i=o.sent,o.abrupt("return",i);case 10:case"end":return o.stop()}}),W,this)}))),function(e,r){return _.apply(this,arguments)})},{key:"__fireEvent",value:function(e,t){return!r.isFunction(this[e])||this[e](t)}},{key:"getDevices",value:(m=ne(de.mark((function A(t){var n,i,o,a,s,u,c,l,d,f,h,g,p,m,_,v,y,I,S,T,b,E,C,w,k;return de.wrap((function(D){for(;;)switch(D.prev=D.next){case 0:if(!this._bDispose){D.next=4;break}throw i={},r.Errors.RemoteScanObjectDispose(i),We(i);case 4:if(o=[],a="getDevices",s=this.getViewerElement(),u=!1,l=null==t?void 0:t.serviceInfo,d=null!==(n=null==t?void 0:t.deviceType)&&void 0!==n?n:Fn,Zn(a,s),D.prev=6,h=!1,g=[],this._serviceInfos){D.next=12;break}return D.next=12,this.getDynamsoftService();case 12:if(!l){D.next=25;break}return D.next=15,this._createDSClientByServiceInfo(l,!0);case 15:if(!(m=D.sent)){D.next=21;break}g.push(m),h=!1,D.next=23;break;case 21:throw v=null==l||null===(_=l.attrs)||void 0===_?void 0:_.ty,r.Errors.CreateDynamsoftServiceError(v);case 23:D.next=37;break;case 25:if(!this._serviceInfos){D.next=37;break}p=0;case 27:if(!(p<this._serviceInfos.length)){D.next=36;break}return y=this._serviceInfos[p],D.next=31,this._createDSClientByServiceInfo(y);case 31:(I=D.sent)&&g.push(I);case 33:p++,D.next=27;break;case 36:h=!0;case 37:p=0;case 38:if(!(p<g.length)){D.next=60;break}return S=void 0,D.prev=40,D.next=43,g[p].getDevices(d,null==t?void 0:t.refresh,u);case 43:if(S=D.sent,r.isArray(S)&&S.length>0)for(c=0;c<S.length;c++)o.push(S[c]);D.next=52;break;case 47:if(D.prev=47,D.t0=D["catch"](40),!u){D.next=51;break}throw D.t0;case 51:f=D.t0;case 52:return D.prev=52,T=null,this._defaultDSScanClient&&(T=null===(b=this._defaultDSScanClient.getServiceInfo())||void 0===b||null===(E=b.attrs)||void 0===E?void 0:E.UUID,this._defaultDSScanClient.isDestroy&&(this._disposeDSClientByKey(T),this._defaultDSScanClient=null,T=null)),h&&(w=g[p].getServiceInfo(),(k=null==w||null===(C=w.attrs)||void 0===C?void 0:C.UUID)&&k!=T&&this._disposeDSClientByKey(k)),D.finish(52);case 57:p++,D.next=38;break;case 60:D.next=65;break;case 62:throw D.prev=62,D.t1=D["catch"](6),D.t1;case 65:return D.prev=65,Qn(a),f&&e.DWT.lsetException(f.code,f.message),D.finish(65);case 69:return D.abrupt("return",o);case 70:case"end":return D.stop()}}),A,this,[[6,62,65,69],[40,47,52,57]])}))),function(e){return m.apply(this,arguments)})},{key:"acquireImage",value:(p=ne(de.mark((function R(e,t){var n,i,o,a,s,u,c,l,d,f,h,g,p,m,_,v;return de.wrap((function(y){for(;;)switch(y.prev=y.next){case 0:if(!(n=this)._bDispose){y.next=5;break}throw i={},r.Errors.RemoteScanObjectDispose(i),We(i);case 5:if(e&&e instanceof ss){y.next=9;break}throw o={},r.Errors.InvalidParameter(o),{code:o._errorCode,message:o._errorString};case 9:return s="acquireImage",u=n.getViewerElement(),c=[],Zn(s,u),y.prev=12,r.isUndefined(t)&&(t={}),r.isUndefined(t.IfShowUI)&&(t.IfShowUI=!1),r.isUndefined(t.IfCloseSourceAfterAcquire)&&(t.IfCloseSourceAfterAcquire=!0),l=e.serviceInfo,y.next=19,this._createDSClientByServiceInfo(l,!0);case 19:if(!(a=y.sent)){y.next=46;break}if(n._defaultDSScanClient){y.next=24;break}return y.next=24,n._innerSetDefault(a);case 24:c.push(a),a!=n._defaultDSScanClient&&c.push(n._defaultDSScanClient),d=0;case 27:if(!(d<c.length)){y.next=36;break}if(f=c[d],SL._isReady(f)){y.next=33;break}throw m=null!==(h=null===(g=f.getServiceInfo())||void 0===g||null===(p=g.attrs)||void 0===p?void 0:p.name)&&void 0!==h?h:"",r.Errors.DynamsoftServiceStopped(f,m),{code:f._getErrorCode(),message:f._getErrorString()};case 33:d++,y.next=27;break;case 36:if(n.onPostTransferAsync?a.registerEvent("OnPostTransferAsync",n.onPostTransferAsync):a.unregisterEvent("OnPostTransferAsync"),a!=n._defaultDSScanClient){y.next=42;break}return y.next=40,a.acquireImage(e,t);case 40:y.next=44;break;case 42:return y.next=44,a._acquireImageForSendTo(s,e,t,n._defaultDSScanClient);case 44:y.next=48;break;case 46:throw v=null==l||null===(_=l.attrs)||void 0===_?void 0:_.name,r.Errors.ThrowFailedConnectToRemoteDynamsoftService(v);case 48:y.next=53;break;case 50:throw y.prev=50,y.t0=y["catch"](12),y.t0;case 53:return y.prev=53,a&&a.__closeRemoteScanUI(!0),Qn(s),y.finish(53);case 57:case"end":return y.stop()}}),R,this,[[12,50,53,57]])}))),function(e,r){return p.apply(this,arguments)})},{key:"_waitForDSValid",value:function(t,n){for(var i=0,o=t.length,a=this;i<o;i++)if(!SL._isReady(t[i]))return void setTimeout((function(){a._waitForDSValid(t,n)}),e.Lib.product.RemoteReconnectTimeSpan);r.isFunction(a[n.command])&&a[n.command].apply(a,n.parmas)}},{key:"getCapabilities",value:(g=ne(de.mark((function O(e){var t,n,i,o,a,s,u;return de.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(!this._bDispose){c.next=4;break}throw t={},r.Errors.RemoteScanObjectDispose(t),We(t);case 4:if(e&&e instanceof ss){c.next=8;break}throw n={},r.Errors.InvalidParameter(n),We(n);case 8:return o="getCapabilities",a=[],s=this.getViewerElement(),Zn(o,s),c.prev=10,u=e.serviceInfo,c.next=14,this._createDSClientByServiceInfo(u,!0);case 14:if(i=c.sent,!(i=this._findDSClientByServiceInfo(u))){c.next=20;break}return c.next=19,i.getCapabilities(e);case 19:a=c.sent;case 20:c.next=25;break;case 22:throw c.prev=22,c.t0=c["catch"](10),c.t0;case 25:return c.prev=25,i&&i.__closeRemoteScanUI(!0),Qn(o),c.finish(25);case 29:return c.abrupt("return",a);case 30:case"end":return c.stop()}}),O,this,[[10,22,25,29]])}))),function(e){return g.apply(this,arguments)})},{key:"setCapabilities",value:(h=ne(de.mark((function L(e,t){var n,i,o,a,s,u;return de.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(!this._bDispose){c.next=4;break}throw n={},r.Errors.RemoteScanObjectDispose(n),We(n);case 4:if(e&&e instanceof ss){c.next=8;break}throw i={},r.Errors.InvalidParameter(i),We(i);case 8:return a="setCapabilities",s=this.getViewerElement(),Zn(a,s),c.prev=10,u=e.serviceInfo,c.next=14,this._createDSClientByServiceInfo(u,!0);case 14:if(!(o=c.sent)){c.next=18;break}return c.next=18,o.setCapabilities(e,t);case 18:c.next=23;break;case 20:throw c.prev=20,c.t0=c["catch"](10),c.t0;case 23:return c.prev=23,o&&o.__closeRemoteScanUI(!0),Qn(a),c.finish(23);case 27:case"end":return c.stop()}}),L,this,[[10,20,23,27]])}))),function(e,r){return h.apply(this,arguments)})},{key:"closeSource",value:(f=ne(de.mark((function N(e){var t,n,i,o,a,s;return de.wrap((function(u){for(;;)switch(u.prev=u.next){case 0:if(!this._bDispose){u.next=4;break}throw t={},r.Errors.RemoteScanObjectDispose(t),We(t);case 4:if(e&&e instanceof ss){u.next=8;break}throw n={},r.Errors.InvalidParameter(n),We(n);case 8:return i="closeSource",o=this.getViewerElement(),Zn(i,o),u.prev=10,a=e.serviceInfo,s=this._findDSClientByServiceInfo(a),u.next=15,s.closeSource();case 15:u.next=20;break;case 17:throw u.prev=17,u.t0=u["catch"](10),u.t0;case 20:return u.prev=20,Qn(i),u.finish(20);case 23:case"end":return u.stop()}}),N,this,[[10,17,20,23]])}))),function(e){return f.apply(this,arguments)})},{key:"_putDSClientToMap",value:function(e,r){var t,n=null==e||null===(t=e.attrs)||void 0===t?void 0:t.UUID;n&&(this._dsScanClientsMap[n]=r)}},{key:"_getDSClientFromMap",value:function(e){var r,t=null==e||null===(r=e.attrs)||void 0===r?void 0:r.UUID;return t?this._dsScanClientsMap[t]:null}},{key:"_createDSClientByServiceInfo",value:(d=ne(de.mark((function M(t,n,i){var o,a,s,u;return de.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(this._serviceInfos){c.next=3;break}return c.next=3,this.getDynamsoftService();case 3:if(o=this._findDSClientByServiceInfo(t)){c.next=20;break}return c.next=7,this._setRemoteUuid();case 7:return c.prev=7,c.next=10,SL.createByServiceInfo(this._uuidForRemoteScanObject,t,i);case 10:(o=c.sent)&&this._putDSClientToMap(t,o),c.next=20;break;case 14:if(c.prev=14,c.t0=c["catch"](7),c.t0.code==e.DWT.EnumDWT_Error.MustUpgrade&&(s=null==t||null===(a=t.attrs)||void 0===a?void 0:a.ty)&&(u={},r.Errors.MustUpgradeService(u,s),c.t0.message=u._errorString),!n){c.next=19;break}throw c.t0;case 19:r.warn(c.t0);case 20:return c.abrupt("return",o);case 21:case"end":return c.stop()}}),M,this,[[7,14]])}))),function(e,r,t){return d.apply(this,arguments)})},{key:"_makeSureDefaultServiceInfo",value:(l=ne(de.mark((function U(){var e;return de.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this._serviceInfos){r.next=3;break}return r.next=3,this.getDynamsoftService();case 3:if(!(this._serviceInfos&&this._serviceInfos.length>0)){r.next=8;break}return e=this._serviceInfos[0],r.next=7,this._createDSClientByServiceInfo(e);case 7:return r.abrupt("return",r.sent);case 8:return r.abrupt("return",null);case 9:case"end":return r.stop()}}),U,this)}))),function(){return l.apply(this,arguments)})},{key:"httpUpload",value:(c=ne(de.mark((function B(e,t,n,i,o,a){var s,u,c,l;return de.wrap((function(d){for(;;)switch(d.prev=d.next){case 0:if(!this._bDispose){d.next=4;break}return s={},r.Errors.RemoteScanObjectDispose(s),d.abrupt("return",r.Promise.reject(We(s)));case 4:return c=this.getViewerElement(),l=c._containerElement,d.next=7,this._makeSureDefaultServiceInfo();case 7:if(this._defaultDSScanClient){d.next=9;break}throw r.Errors.DefaultDynamsoftServiceInvalidError();case 9:return d.next=11,this._defaultDSScanClient.httpUpload(e,t,n,i,o,a,l);case 11:return u=d.sent,d.abrupt("return",u);case 13:case"end":return d.stop()}}),B,this)}))),function(e,r,t,n,i,o){return c.apply(this,arguments)})},{key:"removeImages",value:(u=ne(de.mark((function V(e){var t,n,i,o,a;return de.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(!this._bDispose){s.next=4;break}return t={},r.Errors.RemoteScanObjectDispose(t),s.abrupt("return",r.Promise.reject(We(t)));case 4:return n="removeImages",o=this.getViewerElement(),Zn(n,o),s.prev=6,s.next=9,this._makeSureDefaultServiceInfo();case 9:if(this._defaultDSScanClient){s.next=11;break}throw r.Errors.DefaultDynamsoftServiceInvalidError();case 11:if(!this._defaultDSScanClient){s.next=17;break}return s.next=14,this._defaultDSScanClient.removeImages(e);case 14:i=s.sent,s.next=21;break;case 17:if(0!=this.howManyImagesInBuffer){s.next=21;break}if(a={},this._checkIndices(e,a)){s.next=21;break}throw{code:a._errorCode,message:a._errorString};case 21:s.next=26;break;case 23:throw s.prev=23,s.t0=s["catch"](6),s.t0;case 26:return s.prev=26,Qn(n),s.finish(26);case 29:return s.abrupt("return",i);case 30:case"end":return s.stop()}}),V,this,[[6,23,26,29]])}))),function(e){return u.apply(this,arguments)})},{key:"_checkIndices",value:function(t,n){var i,o;if(!r.isArray(t))return r.Errors.IndicesNotArray(n),!1;if(0==t.length)return r.Errors.IndicesCannotEmpty(n),!1;if(e.DWT.ConnectWithSocket)return!0;for(i=this.howManyImagesInBuffer,o=0;o<t.length;o++){var a=t[o];if(r.isUndefined(a)||null===a)return r.Errors.IndexNullOrUndefined(n),!1;if(a=parseInt(a),isNaN(a))return r.Errors.InvalidIndex(n),!1;if(a<0||a>=i)return r.Errors.IndicesOutOfRange(n),!1}return!0}},{key:"saveImages",value:(s=ne(de.mark((function G(e,t,n){var i,o,a,s;return de.wrap((function(u){for(;;)switch(u.prev=u.next){case 0:if(i={},!this._bDispose){u.next=4;break}return r.Errors.RemoteScanObjectDispose(i),u.abrupt("return",r.Promise.reject(We(i)));case 4:if(0!=this.howManyImagesInBuffer){u.next=7;break}return r.Errors.NoImage(i),u.abrupt("return",r.Promise.reject(We(i)));case 7:if(r.isNumber(n)){u.next=10;break}return r.Errors.InvalidParameter(i),u.abrupt("return",r.Promise.reject(We(i)));case 10:if(n!=Bn.IT_BMP&&n!=Bn.IT_JPG&&n!=Bn.IT_PNG){u.next=16;break}if(!(t.length>1)){u.next=14;break}return r.Errors.SaveIndexMoreThanOne(i),u.abrupt("return",r.Promise.reject(We(i)));case 14:u.next=26;break;case 16:if(n!=Bn.IT_TIF&&n!=Bn.IT_PDF){u.next=19;break}u.next=26;break;case 19:if(n!=Bn.IT_ALL&&n!=Bn.IT_MULTIPAGE_PDF&&n!=Bn.IT_MULTIPAGE_TIF){u.next=24;break}return r.Errors.SaveImagesErrorType(i),u.abrupt("return",r.Promise.reject(We(i)));case 24:return r.Errors.InvalidImageType(i),u.abrupt("return",r.Promise.reject(We(i)));case 26:return a=this.getViewerElement(),s=a._containerElement,u.next=29,this._makeSureDefaultServiceInfo();case 29:if(this._defaultDSScanClient){u.next=31;break}throw r.Errors.DefaultDynamsoftServiceInvalidError();case 31:return u.next=33,this._defaultDSScanClient.saveImages(e,t,n,s);case 33:return o=u.sent,u.abrupt("return",o);case 35:case"end":return u.stop()}}),G,this)}))),function(e,r,t){return s.apply(this,arguments)})},{key:"getImages",value:(a=ne(de.mark((function j(e,t,n){var i,o,a,s;return de.wrap((function(u){for(;;)switch(u.prev=u.next){case 0:if(i={},!this._bDispose){u.next=4;break}return r.Errors.RemoteScanObjectDispose(i),u.abrupt("return",r.Promise.reject(We(i)));case 4:if(0!=this.howManyImagesInBuffer){u.next=7;break}return r.Errors.NoImage(i),u.abrupt("return",r.Promise.reject(We(i)));case 7:if(r.isNumber(t)&&r.isNumber(n)){u.next=10;break}return r.Errors.InvalidParameter(i),u.abrupt("return",r.Promise.reject(We(i)));case 10:return a=this.getViewerElement(),s=a._containerElement,u.next=13,this._makeSureDefaultServiceInfo();case 13:if(this._defaultDSScanClient){u.next=15;break}throw r.Errors.DefaultDynamsoftServiceInvalidError();case 15:return u.next=17,this._defaultDSScanClient.getImages(e,t,n,s);case 17:return o=u.sent,u.abrupt("return",o);case 19:case"end":return u.stop()}}),j,this)}))),function(e,r,t){return a.apply(this,arguments)})},{key:"dispose",value:function(){if(this._viewer&&this._viewer.unbind(),this._dsScanClientsMap){var e,r=this._dsScanClientsMap,t=Object.keys(r);for(e=0;e<t.length;e++){var n=t[e];this._disposeDSClientByKey(n)}}return this._dsScanClientsMap=null,this._bDispose=!0,!0}},{key:"setLogLevel",value:function(e){var r,t=this._dsScanClientsMap;if(t){var n=Object.keys(t);for(r=0;r<n.length;r++)t[n[r]]._setLogLevel(e);this._needSetLogLevel=!1,this._logLevel=-1}else this._needSetLogLevel=!0,this._logLevel=e;return!0}},{key:"getProfile",value:(o=ne(de.mark((function H(e){var t,n,i,o;return de.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(t="",e&&e instanceof ss){a.next=5;break}throw n={},r.Errors.InvalidParameter(n),{code:n._errorCode,message:n._errorString};case 5:return a.prev=5,i=e.serviceInfo,a.next=9,this._createDSClientByServiceInfo(i,!0);case 9:if(!(o=a.sent)){a.next=14;break}return a.next=13,o.getProfile(e);case 13:t=a.sent;case 14:a.next=19;break;case 16:throw a.prev=16,a.t0=a["catch"](5),a.t0;case 19:return a.abrupt("return",t);case 20:case"end":return a.stop()}}),H,this,[[5,16]])}))),function(e){return o.apply(this,arguments)})},{key:"setProfile",value:(i=ne(de.mark((function z(e,t){var n,i,o,a;return de.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(n="",e&&e instanceof ss){s.next=5;break}throw i={},r.Errors.InvalidParameter(i),{code:i._errorCode,message:i._errorString};case 5:return s.prev=5,o=e.serviceInfo,s.next=9,this._createDSClientByServiceInfo(o,!0);case 9:if(!(a=s.sent)){s.next=14;break}return s.next=13,a.setProfile(e,t);case 13:n=s.sent;case 14:s.next=19;break;case 16:throw s.prev=16,s.t0=s["catch"](5),s.t0;case 19:return s.abrupt("return",n);case 20:case"end":return s.stop()}}),z,this,[[5,16]])}))),function(e,r){return i.apply(this,arguments)})},{key:"imageIDToIndex",value:function(e){return this._defaultDSScanClient?this._defaultDSScanClient.imageIDToIndex(e):0}},{key:"indexToImageID",value:function(e){return this._defaultDSScanClient?this._defaultDSScanClient.indexToImageID(e):0}},{key:"howManyImagesInBuffer",get:function(){return this._defaultDSScanClient?this._defaultDSScanClient.howManyImagesInBuffer:0}},{key:"currentImageIndexInBuffer",get:function(){return this._defaultDSScanClient?this._defaultDSScanClient.currentImageIndexInBuffer:-1},set:function(e){this._defaultDSScanClient&&(this._defaultDSScanClient.currentImageIndexInBuffer=e)}},{key:"showProgressBar",get:function(){return this._defaultDSScanClient?this._defaultDSScanClient.IfShowProgressBar:this._showProgressBar},set:function(e){this._defaultDSScanClient?(this._showProgressBar=e,this._defaultDSScanClient.IfShowProgressBar=e):this._showProgressBar}},{key:"registerEvent",value:function(e,t){if(this._bDispose){var n={};return r.Errors.RemoteScanObjectDispose(n),r.Promise.reject(We(n))}if(!r.isFunction(t)){var i={};return r.Errors.CallbackNotAFunction(i),r.Promise.reject(We(i))}if("onBufferChanged"==e||"OnBufferChanged"==e)this.onBufferChanged=t;else{if("onPostTransferAsync"!=e&&"OnPostTransferAsync"!=e){var o={};return r.Errors.InvalidEventName(o),r.Promise.reject(We(o))}this.onPostTransferAsync=t}return this._registEventToDefaultDS(),!0}},{key:"unregisterEvent",value:function(e,t){if(this._bDispose){var n={};return r.Errors.RemoteScanObjectDispose(n),r.Promise.reject(We(n))}if("onBufferChanged"==e||"OnBufferChanged"==e){if(this.onBufferChanged=null,this._defaultDSScanClient)return this._defaultDSScanClient.unregisterEvent("OnBufferChanged",t)}else{if("onPostTransferAsync"!=e&&"OnPostTransferAsync"!=e){var i={};return r.Errors.InvalidEventName(i),r.Promise.reject(We(i))}if(this.onPostTransferAsync=null,this._defaultDSScanClient)return this._defaultDSScanClient.unregisterEvent("OnPostTransferAsync",t)}}},{key:"getViewerElement",value:function(){return this.Viewer&&this.Viewer.webViewer&&this.Viewer.webViewer.containerElement?{_containerElement:this.Viewer.webViewer.containerElement}:{_containerElement:document.body}}},{key:"isSameService",value:function(e,r){return!(!e||!r)&&(e.server==r.server&&e.attrs.UUID==r.attrs.UUID&&e.attrs.accessmode==r.attrs.accessmode&&e.attrs.name==r.attrs.name&&e.attrs.os==r.attrs.os&&e.attrs.service_type==r.attrs.service_type&&e.attrs.tags==r.attrs.tags&&e.attrs.ty==r.attrs.ty&&e.attrs.type==r.attrs.type&&e.attrs.txtvers==r.attrs.txtvers)}},{key:"_findDSClientByServiceInfo",value:function(e){var r,t=this._serviceInfos;if(t)for(r=0;r<t.length;r++){var n=t[r];if(this.isSameService(e,n)){var i=this._getDSClientFromMap(n);if(i){var o;if(SL._isReady(i))return i;i.isDestroy||i.dispose();var a=null==n||null===(o=n.attrs)||void 0===o?void 0:o.UUID;a&&delete this._dsScanClientsMap[a]}break}}return null}},{key:"_setRemoteUuid",value:(n=ne(de.mark((function K(){var t;return de.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!r.License.isLTS()){n.next=8;break}if(this._uuidForRemoteScanObject){n.next=6;break}return n.next=4,e.DWT.lgcuid(e.DWT.EnumInstance.dwt_desktop,"");case 4:t=n.sent,this._uuidForRemoteScanObject=t;case 6:n.next=8;break;case 8:case"end":return n.stop()}}),K,this)}))),function(){return n.apply(this,arguments)})},{key:"_registEventToDefaultDS",value:function(){this._defaultDSScanClient&&(this.onBufferChanged&&this._defaultDSScanClient.registerEvent("OnBufferChanged",this.onBufferChanged),this.onPostTransferAsync&&this._defaultDSScanClient.registerEvent("OnPostTransferAsync",this.onPostTransferAsync))}}]),t}(),EL=!1;function CL(e,r){return wL.apply(this,arguments)}function wL(){return wL=ne(de.mark((function t(n,i){var o,a;return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i&&Pi(e.MSG.Init_CheckProductKeyFormat),r.License.isLicenseMixed(null,!0)||r.License.reparseProductKey(i),0==(o=e.DWT.licenseException).code){t.next=6;break}throw n&&Yo(o),{code:o.code,message:o.message};case 6:if(EL){t.next=11;break}if(a=!1,e.navInfoSync.bIE&&(a=e.navInfoSync.strBrowserVersion<=7),a||!r.License.isLTS()){t.next=11;break}return t.abrupt("return",new r.Promise((function(t,n){var i=e.DWT.ResourcesPath,o="";e.navInfoSync.bFileSystem||(o=r.timestamp),r.addScript([i,"/src/dynamsoft.lts.js",o].join(""),!0,!1,(function(){EL=!0,t()}))})));case 11:case"end":return t.stop()}}),t)}))),wL.apply(this,arguments)}var kL=e.navInfoSync;function DL(e,r){return xL.apply(this,arguments)}function xL(){return xL=ne(de.mark((function t(n,i){var o,a,s,u,c,l,d,f,h,g;return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=e.DWT.Containers,a=0;case 2:if(!(a<o.length)){t.next=42;break}if(!(s=r.clone(o[a])).ContainerId){t.next=8;break}if(!e.DWT.ContainerMap[s.ContainerId]){t.next=8;break}return t.abrupt("continue",39);case 8:if(!s.WebTwainId){t.next=12;break}if(!e.DWT.WebTwainIdMap[s.WebTwainId]){t.next=12;break}return t.abrupt("continue",39);case 12:if(s.Host=n,kL.bSSL?s.PortSSL=i:s.Port=i,r.isDOM(s.Container)||s.ContainerId&&(s.Container=r.get(s.ContainerId)),!r.isShadowRoot(s.Container)){t.next=22;break}return l=document.createElement("div"),s.Container.appendChild(l),s.Container=l,d=r.getShadowRoot(l),t.next=22,Ia(d);case 22:return ma(f=Ui(s)),h=void 0,t.prev=25,t.next=28,oL.create(f);case 28:h=t.sent,t.next=35;break;case 31:throw t.prev=31,t.t0=t["catch"](25),h&&h.dispose(),t.t0;case 35:if(0===(c=e.DWT.licenseException).code){t.next=38;break}throw{code:c.code,message:c.message};case 38:u=h;case 39:a++,t.next=2;break;case 42:g=window,u&&(g.DCP_DWT_OnClickCloseInstall&&g.DCP_DWT_OnClickCloseInstall(!1,!0),vL(u),VR(u)),setTimeout((function(){try{r.isFunction(e.DWT.OnWebTwainReady)?e.DWT.OnWebTwainReady():r.isFunction(g.Dynamsoft_OnReady)&&g.Dynamsoft_OnReady()}catch(t){Le(t)}}),100);case 45:case"end":return t.stop()}}),t,null,[[25,31]])}))),xL.apply(this,arguments)}function PL(){return FL.apply(this,arguments)}function FL(){return FL=ne(de.mark((function t(){var n,i,o,a,s,u,c,l;return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.page.bUnload=Be,r.product.bHTML5Edition){t.next=3;break}return t.abrupt("return",e.DWT._innerLoad());case 3:return t.next=5,CL(!0,!0);case 5:if((n=e.DWT.Containers)&&0!==n.length){t.next=10;break}throw i={},r.Errors.ContainersNotSet(i),{code:i._errorCode,message:i._errorString};case 10:if(o=e.DWT.Host,a=e.DWT.Port,a=kL.bSSL?e.DWT.SSLPort:e.DWT.Port,!e.DWT.IfCheckDCP){t.next=25;break}return t.next=16,Na(o,a);case 16:if(!(s=t.sent)){t.next=22;break}o=s.host,a=s.port,t.next=25;break;case 22:throw u={},r.Errors.DynamsoftServiceResponseDataTypeError(u),We(u);case 25:return t.prev=25,t.next=28,Oa(o,a,Be);case 28:c=t.sent,t.next=44;break;case 31:if(t.prev=31,t.t0=t["catch"](25),(l=t.t0.code)!=e.DWT.EnumDWT_Error.ResponseDataTypeError&&l!=e.DWT.EnumDWT_Error.HTSTError&&l!=e.DWT.EnumDWT_Error.CORSError){t.next=37;break}t.next=43;break;case 37:if(l!=e.DWT.EnumDWT_Error.MustUpgrade){t.next=41;break}Mi(!0,!1),t.next=43;break;case 41:return t.next=43,Ga(o,a);case 43:throw t.t0;case 44:if(!c){t.next=48;break}return Pi(e.MSG.Init_CreatingDWTFromContainers),t.next=48,DL(c.host,c.port);case 48:case"end":return t.stop()}}),t,null,[[25,31]])}))),FL.apply(this,arguments)}var WL=e.navInfoSync,AL=window.document;if(r.product.bHTML5Edition){var RL=function(){var t=ne(de.mark((function n(t){var i,o,a,s,u,c,l;return de.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return ta(),n.next=3,CL(!0,!1);case 3:if(e.DWT.UseDefaultViewer||(t.Container=null),!r.isShadowRoot(t.Container)){n.next=11;break}return o=document.createElement("div"),t.Container.appendChild(o),t.Container=o,a=r.getShadowRoot(o),n.next=11,Ia(a);case 11:return i=Ui(t),n.next=14,oa();case 14:return n.next=16,Li();case 16:if(!e.DWT.IfCheckDCP){n.next=28;break}return n.next=19,Na(i.host,i.port);case 19:if(!(s=n.sent)){n.next=25;break}i.host=s.host,i.port=s.port,n.next=28;break;case 25:throw u={},r.Errors.DynamsoftServiceResponseDataTypeError(u),We(u);case 28:return n.prev=28,n.next=31,Oa(i.host,i.port,Be);case 31:n.next=47;break;case 33:if(n.prev=33,n.t0=n["catch"](28),r.log(["check DWT Version failed",n.t0]),(c=n.t0.code)!=e.DWT.EnumDWT_Error.ResponseDataTypeError&&c!=e.DWT.EnumDWT_Error.HTSTError&&c!=e.DWT.EnumDWT_Error.CORSError){n.next=40;break}n.next=46;break;case 40:if(c!=e.DWT.EnumDWT_Error.MustUpgrade){n.next=44;break}Mi(!0,!1),n.next=46;break;case 44:return n.next=46,Ga(i.host,i.port);case 46:throw n.t0;case 47:return Pi(e.MSG.Init_CreatingDWT),n.next=50,pL(i);case 50:return l=n.sent,n.abrupt("return",l);case 52:case"end":return n.stop()}}),n,null,[[28,33]])})));return function(e){return t.apply(this,arguments)}}(),OL=window;OL.addEventListener("beforeunload",(function(){e.Lib.page.bUnload=!0,e.DWT.Unload(),e.Lib.page.OnUnload&&e.Lib.page.OnUnload()})),OL.addEventListener("unload",(function(){e.DWT.Unload()})),e.DWT.Unload=function(){LL(!1,!0);try{r.closeLoadingMsg(),e.DWT.CloseDialog(),r._zdgb_xkz_dhk(),r.closeProgress(null,""),r.hideMask(),function(){for(var e,t,n,i=["dynamsoft.webtwain.install.js","dynamsoft.webtwain.viewer.js","dynamsoft.lts.js","dynamsoft.webtwain.viewer.css","dynamsoft.webtwain.css"],o=document.head.childNodes,a=o.length-1;a>=0;a--)if("LINK"==(t=o[a]).tagName?n=t.href:"SCRIPT"==t.tagName&&(n=t.src),n)for(e=0;e<i.length;e++)n.indexOf(i[e])>=0&&t.remove();r.detect.cssLoaded=!1}()}catch(AA){}e.Lib.product.bDWTLoading=!1},e.DWT.Load=ne(de.mark((function t(){return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r.product.bDWTLoading){t.next=2;break}return t.abrupt("return");case 2:return r.product.bDWTLoading=!0,r.openLoadingMsg(),t.prev=4,t.next=7,fa();case 7:return t.next=9,oa();case 9:return t.next=11,Li();case 11:return t.next=13,LL(!0,!0);case 13:return e.DWT.CloseDialog(),t.next=16,PL();case 16:t.next=30;break;case 18:return t.prev=18,t.t0=t["catch"](4),qo(t.t0.code)||r.detect.bOK||r.asyncQueue.pushToDo(null,e.DWT.Load),Ko(t.t0),t.prev=23,t.next=26,LL();case 26:t.next=30;break;case 28:t.prev=28,t.t1=t["catch"](23);case 30:return t.prev=30,r.product.bDWTLoading=!1,r.closeLoadingMsg(),t.finish(30);case 34:case"end":return t.stop()}}),t,null,[[4,18,30,34],[23,28]])}))),e.DWT.CheckConnectToTheService=function(t,n,i,o){var a=0,s=t,u=n,c=i,l=o;if(r.isFunction(s)&&r.isFunction(u))for(c=s,l=u,s=f(),a=0;a<e.Lib.detect.ports.length;a++)if(e.navInfoSync.bSSL&&e.Lib.detect.ports[a].ssl||!e.navInfoSync.bSSL&&!e.Lib.detect.ports[a].ssl){u=e.Lib.detect.ports[a].port;break}s||(s=f()),Aa(s,u,_t).then((function(e){var t=e.host,n=e.port;e.version,r.isFunction(c)&&c(t,n)}),(function(e){r.isFunction(l)&&l(e)}))},e.DWT.ConnectToTheService=function(){r.asyncQueue.start()},e.DWT.CreateDWTObject=function(t,n,i,o,a,s){var u,c=a,l=s;r.isFunction(n)&&r.isFunction(i)?(c=n,l=i,u={}):u={Host:n,Port:i,PortSSL:o};var d,f=t;if(r.isString(f)&&!(f=r.get(f)))return d={},r.Errors.ERR_CreateID_NotContainer(d),l&&l({code:d._errorCode,message:d._errorString}),Be;if(r.isDOM(f))u.Container=f;else{if(!r.isString(t)){var h=r.Errors.container_id_not_string();return r.isFunction(l)&&l(h),Be}if(!r.get(t)){var g=r.Errors.container_id_not_exist(t);return r.isFunction(l)&&l(g),Be}}return u.WebTwainId=Nn(),e.DWT.CreateDWTObjectEx(u,c,l)},e.DWT.CreateDWTObjectEx=function(t,n,i){var o=arguments;return r.product.loadResourcePath?r.isString(t.WebTwainId)?(r.openLoadingMsg(),RL(t).then((function(e){r.closeLoadingMsg(),VR(e),r.isFunction(n)&&n(e)}),(function(t){if(r.closeLoadingMsg(),!r.detect.bOK){var n=t&&t.code,a=e.DWT.licenseException;(n&&!qo(n)||0==a.code)&&(r.asyncQueue.stop(),r.asyncQueue.pushToDo(null,e.DWT.CreateDWTObjectEx,o))}r.isFunction(i)&&i(t)})),!0):(i&&i(r.Errors.webtwain_id_not_string()),Be):(r.openLoadingMsg(),void fa().then(oa).then((function(){r.closeLoadingMsg(),setTimeout((function(){e.DWT.CreateDWTObjectEx(t,n,i)}),100)}),(function(e){r.closeLoadingMsg(),i(e)})))},e.DWT.CreateRemoteScanObjectAsync=function(){var e=ne(de.mark((function t(e){var n,i;return de.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=null,e){t.next=5;break}throw i={},r.Errors.InvalidParameter(i),{code:i._errorCode,message:i._errorString};case 5:return r.product.bDWTLoading=!0,r.openLoadingMsg(),t.prev=7,t.next=10,oa();case 10:return t.next=12,Li();case 12:return t.next=14,CL(!1,!1);case 14:n=new bL(e),Object.preventExtensions(n);case 16:return t.prev=16,r.product.bDWTLoading=!1,r.closeLoadingMsg(),t.finish(16);case 20:return t.abrupt("return",n);case 21:case"end":return t.stop()}}),t,null,[[7,,16,20]])})));return function(r){return e.apply(this,arguments)}}(),e.DWT.DeleteDWTObject=function(t){var n,i=t;return r.product.bHTML5Edition&&i?!!(n=r.isString(i)?e.DWT.GetWebTwain(i):i)&&(n.dispose(),!0):Be}}function LL(t,n){var i,o,a,s,u;if(t&&Pi(e.MSG.Init_UnLoad),n&&e.DWT.lunload(),r.dlgProgress=!1,r.detect.bOK=!1,r.detect.bFirst=!0,s=e.DWT.WebTwainIdMap)for(u=Object.keys(s),i=0;i<u.length;i++)(a=u[i])&&a in s&&(o=s[a])&&o.dispose();if(s=e.DWT.ContainerMap)for(u=Object.keys(s),i=0;i<u.length;i++)(a=u[i])&&a in s&&(o=s[a])&&o.dispose();if(s=e.DWT.RemoteScanIdMap)for(u=Object.keys(s),i=0;i<u.length;i++)(a=u[i])&&a in s&&(o=s[a])&&o.dispose();for(i=0;i<r.product.unloadQueue.length;i++){var c=r.product.unloadQueue[i];r.isFunction(c)&&c()}return r.product.unloadQueue.splice(0),r.Promise.resolve()}r.domReady(ne(de.mark((function KL(){var t;return de.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=window,WL.bIE&&t.addEventListener&&t.addEventListener("unload",e.DWT.Unload,!1),t&&(r.addEventListener(t,"focus",(function(){var t;(t=e.DWT.WebTwainIdMap)&&r.each(t,(function(e,r){e&&e._OnPageFocus&&e._OnPageFocus()}))})),r.addEventListener(t,"blur",(function(){e.navInfoSync.bWin&&ha()})),r.addEventListener(AL,"visibilitychange",(function(){e.navInfoSync.bWin&&"hidden"==AL.visibilityState&&ha()}))),!1!==e.DWT.AutoLoad&&!r.product.bDWTLoading){n.next=5;break}return n.abrupt("return");case 5:return n.prev=5,n.next=8,fa();case 8:if(!(e.DWT.Containers&&e.DWT.Containers.length>0&&e.DWT.AutoLoad)||r.product.bDWTLoading){n.next=23;break}return r.product.bDWTLoading=!0,r.openLoadingMsg(),n.prev=12,n.next=15,oa();case 15:return n.next=17,Li();case 17:return n.next=19,PL();case 19:return n.prev=19,r.product.bDWTLoading=!1,r.closeLoadingMsg(),n.finish(19);case 23:n.next=37;break;case 25:return n.prev=25,n.t0=n["catch"](5),qo(n.t0.code)||r.detect.bOK||r.asyncQueue.pushToDo(null,e.DWT.Load),Ko(n.t0),n.prev=30,n.next=33,LL();case 33:n.next=37;break;case 35:n.prev=35,n.t1=n["catch"](30);case 37:case"end":return n.stop()}}),KL,null,[[5,25],[12,,19,23],[30,35]])})))),r.timestamp="?t=20230424145534",r.ajax=fr,r.fetch=Ir,e.Ready=function(r){var t=e.Lib;if(!e.navInfo)return t.asyncGetNavInfo().then((function(){try{r(t)}catch(e){throw t.log(e.stack||e,"error"),e}}));try{r(t)}catch(n){throw t.log(n.stack||n,"error"),n}}}();
 
Dynamsoft.DWT.bNpm=true;Dynamsoft.DWT.dbrCanvasMaxWH=4096; 
 
Dynamsoft.aryAddonReadyFun=[];Dynamsoft.AddonReady=function(fn){Dynamsoft.aryAddonReadyFun.push(fn);}; 
Dynamsoft.Lib.mix(Dynamsoft,{license:"",workerPathPdfR:"",workerPathPdfW:"",workerPathImgcore:""}); 
 
/*! 20230310201709
* Dynamsoft JavaScript Library
* Product: Dynamsoft Web Twain
* Web Site: https://www.dynamsoft.com
*
* Copyright 2023, Dynamsoft Corporation
* Author: Dynamsoft Support Team
*
* Module: BarcodeReader
* Version: 18.2
* 
*/
var Dynamsoft=self.Dynamsoft||{};Dynamsoft.DWT=Dynamsoft.DWT||{},Dynamsoft.DBR=Dynamsoft.DBR||{},Dynamsoft.aryAddonReadyFun=Dynamsoft.aryAddonReadyFun||[],Dynamsoft.AddonReady=Dynamsoft.AddonReady||function(e){Dynamsoft.aryAddonReadyFun.push(e)},function(){Dynamsoft.BarcodeReaderAddon=Dynamsoft.BarcodeReaderAddon||{};var n=Dynamsoft.BarcodeReaderAddon;n.Version="9.4.0.1025",n._decoding=!1,n._decodeQueue=[],n._decodeNext=function(){var e,t;0==n._decodeQueue.length?n._decoding=!1:(e=(t=n._decodeQueue[0]).method,t=t.args,n._decodeQueue.splice(0,1),e.apply(null,t))},n._defaultRuntimeSettingsStr="",n._defaultTemplateStr="",n._activeXInstance=!1,n.BarcodeReaderException=function(){var e=arguments[0],t=Dynamsoft.DBR.EnumErrorCode.DBR_UNKNOWN,e="number"==typeof e?(t=e,new Error(arguments[1])):new Error(e);return e.code=t,e},n.RemoveNonPrintableChar=function(e){return Dynamsoft.Lib.isString(e)?e.replace(/[^\x20-\x7E]|(\\")/g,""):e},n.errors={webcamNotInstalled:"The Webcam add-on not installed.",nonServiceNotSupportWebcamDecode:"The BarcodeReader add-on does not support reading barcodes from video streams.",decodeResultEmpty:"decode result is empty.",ServiceEditionNotSupportDbr:"The BarcodeReader add-on does not support your Operating System.",ServiceEditionNotSupportWasmMode:"You cannot call this method on this WebTwain instance."},n._activeXMaxIEVersion=9,n.logLevel=3,Dynamsoft.DBR.EnumAccompanyingTextRecognitionMode={ATRM_GENERAL:1,ATRM_SKIP:0},Dynamsoft.DBR.EnumBarcodeColourMode={BICM_DARK_ON_LIGHT:1,BICM_LIGHT_ON_DARK:2,BICM_DARK_ON_DARK:4,BICM_LIGHT_ON_LIGHT:8,BICM_DARK_LIGHT_MIXED:16,BICM_DARK_ON_LIGHT_DARK_SURROUNDING:32,BICM_SKIP:0},Dynamsoft.DBR.EnumBarcodeComplementMode={BCM_AUTO:1,BCM_GENERAL:2,BCM_SKIP:0},Dynamsoft.DBR.EnumBarcodeFormat={BF_ALL:-32505857,BF_ONED:2047,BF_GS1_DATABAR:260096,BF_CODE_39:1,BF_CODE_128:2,BF_CODE_93:4,BF_CODABAR:8,BF_ITF:16,BF_EAN_13:32,BF_EAN_8:64,BF_UPC_A:128,BF_UPC_E:256,BF_INDUSTRIAL_25:512,BF_CODE_39_EXTENDED:1024,BF_GS1_DATABAR_OMNIDIRECTIONAL:2048,BF_GS1_DATABAR_TRUNCATED:4096,BF_GS1_DATABAR_STACKED:8192,BF_GS1_DATABAR_STACKED_OMNIDIRECTIONAL:16384,BF_GS1_DATABAR_EXPANDED:32768,BF_GS1_DATABAR_EXPANDED_STACKED:65536,BF_GS1_DATABAR_LIMITED:131072,BF_PATCHCODE:262144,BF_PDF417:33554432,BF_QR_CODE:67108864,BF_DATAMATRIX:134217728,BF_AZTEC:268435456,BF_MAXICODE:536870912,BF_MICRO_QR:1073741824,BF_MICRO_PDF417:524288,BF_GS1_COMPOSITE:-2147483648,BF_NULL:0},Dynamsoft.DBR.EnumBarcodeFormat_2={BF2_NULL:0,BF2_POSTALCODE:32505856,BF2_NONSTANDARD_BARCODE:1,BF2_USPSINTELLIGENTMAIL:1048576,BF2_POSTNET:2097152,BF2_PLANET:4194304,BF2_AUSTRALIANPOST:8388608,BF2_RM4SCC:16777216,BF2_DOTCODE:2},Dynamsoft.DBR.EnumBinarizationMode={BM_AUTO:1,BM_LOCAL_BLOCK:2,BM_SKIP:0},Dynamsoft.DBR.EnumClarityCalculationMethod={ECCM_CONTRAST:1},Dynamsoft.DBR.EnumClarityFilterMode={CFM_GENERAL:1},Dynamsoft.DBR.EnumColourClusteringMode={CCM_AUTO:1,CCM_GENERAL_HSV:2,CCM_SKIP:0},Dynamsoft.DBR.EnumColourConversionMode={CICM_GENERAL:1,CICM_SKIP:0},Dynamsoft.DBR.EnumConflictMode={CM_IGNORE:1,CM_OVERWRITE:2},Dynamsoft.DBR.EnumDeformationResistingMode={DRM_AUTO:1,DRM_GENERAL:2,DRM_SKIP:0},Dynamsoft.DBR.EnumDPMCodeReadingMode={DPMCRM_AUTO:1,DPMCRM_GENERAL:2,DPMCRM_SKIP:0},Dynamsoft.DBR.EnumErrorCode={DBR_SYSTEM_EXCEPTION:1,DBR_SUCCESS:0,DBR_UNKNOWN:-1e4,DBR_NO_MEMORY:-10001,DBR_NULL_REFERENCE:-10002,DBR_LICENSE_INVALID:-10003,DBR_LICENSE_EXPIRED:-10004,DBR_FILE_NOT_FOUND:-10005,DBR_FILETYPE_NOT_SUPPORTED:-10006,DBR_BPP_NOT_SUPPORTED:-10007,DBR_INDEX_INVALID:-10008,DBR_BARCODE_FORMAT_INVALID:-10009,DBR_CUSTOM_REGION_INVALID:-10010,DBR_MAX_BARCODE_NUMBER_INVALID:-10011,DBR_IMAGE_READ_FAILED:-10012,DBR_TIFF_READ_FAILED:-10013,DBR_QR_LICENSE_INVALID:-10016,DBR_1D_LICENSE_INVALID:-10017,DBR_DIB_BUFFER_INVALID:-10018,DBR_PDF417_LICENSE_INVALID:-10019,DBR_DATAMATRIX_LICENSE_INVALID:-10020,DBR_PDF_READ_FAILED:-10021,DBR_PDF_DLL_MISSING:-10022,DBR_PAGE_NUMBER_INVALID:-10023,DBR_CUSTOM_SIZE_INVALID:-10024,DBR_CUSTOM_MODULESIZE_INVALID:-10025,DBR_RECOGNITION_TIMEOUT:-10026,DBR_JSON_PARSE_FAILED:-10030,DBR_JSON_TYPE_INVALID:-10031,DBR_JSON_KEY_INVALID:-10032,DBR_JSON_VALUE_INVALID:-10033,DBR_JSON_NAME_KEY_MISSING:-10034,DBR_JSON_NAME_VALUE_DUPLICATED:-10035,DBR_TEMPLATE_NAME_INVALID:-10036,DBR_JSON_NAME_REFERENCE_INVALID:-10037,DBR_PARAMETER_VALUE_INVALID:-10038,DBR_DOMAIN_NOT_MATCHED:-10039,DBR_RESERVEDINFO_NOT_MATCHED:-10040,DBR_AZTEC_LICENSE_INVALID:-10041,DBR_LICENSE_DLL_MISSING:-10042,DBR_LICENSEKEY_NOT_MATCHED:-10043,DBR_REQUESTED_FAILED:-10044,DBR_LICENSE_INIT_FAILED:-10045,DBR_PATCHCODE_LICENSE_INVALID:-10046,DBR_POSTALCODE_LICENSE_INVALID:-10047,DBR_DPM_LICENSE_INVALID:-10048,DBR_FRAME_DECODING_THREAD_EXISTS:-10049,DBR_STOP_DECODING_THREAD_FAILED:-10050,DBR_SET_MODE_ARGUMENT_ERROR:-10051,DBR_LICENSE_CONTENT_INVALID:-10052,DBR_LICENSE_KEY_INVALID:-10053,DBR_LICENSE_DEVICE_RUNS_OUT:-10054,DBR_GET_MODE_ARGUMENT_ERROR:-10055,DBR_IRT_LICENSE_INVALID:-10056,DBR_MAXICODE_LICENSE_INVALID:-10057,DBR_GS1_DATABAR_LICENSE_INVALID:-10058,DBR_GS1_COMPOSITE_LICENSE_INVALID:-10059,DBR_DOTCODE_LICENSE_INVALID:-10061,DMERR_FAILED_TO_REACH_LTS:-20200},Dynamsoft.DBR.EnumGrayscaleTransformationMode={GTM_INVERTED:1,GTM_ORIGINAL:2,GTM_SKIP:0},Dynamsoft.DBR.EnumImagePixelFormat={IPF_Binary:0,IPF_BinaryInverted:1,IPF_GrayScaled:2,IPF_NV21:3,IPF_RGB_565:4,IPF_RGB_555:5,IPF_RGB_888:6,IPF_ARGB_8888:7,IPF_RGB_161616:8,IPF_ARGB_16161616:9,IPF_ABGR_8888:10,IPF_ABGR_16161616:11,IPF_BGR_888:12},Dynamsoft.DBR.EnumImagePreprocessingMode={IPM_AUTO:1,IPM_GENERAL:2,IPM_GRAY_EQUALIZE:4,IPM_GRAY_SMOOTH:8,IPM_SHARPEN_SMOOTH:16,IPM_MORPHOLOGY:32,IPM_SKIP:0},Dynamsoft.DBR.EnumIMResultDataType={IMRDT_IMAGE:1,IMRDT_CONTOUR:2,IMRDT_LINESEGMENT:4,IMRDT_LOCALIZATIONRESULT:8,IMRDT_REGIONOFINTEREST:16,IMRDT_QUADRILATERAL:32},Dynamsoft.DBR.EnumIntermediateResultSavingMode={IRSM_MEMORY:1,IRSM_FILESYSTEM:2,IRSM_BOTH:4},Dynamsoft.DBR.EnumIntermediateResultType={IRT_NO_RESULT:0,IRT_ORIGINAL_IMAGE:1,IRT_COLOUR_CLUSTERED_IMAGE:2,IRT_COLOUR_CONVERTED_GRAYSCALE_IMAGE:4,IRT_TRANSFORMED_GRAYSCALE_IMAGE:8,IRT_PREDETECTED_REGION:16,IRT_PREPROCESSED_IMAGE:32,IRT_BINARIZED_IMAGE:64,IRT_TEXT_ZONE:128,IRT_CONTOUR:256,IRT_LINE_SEGMENT:512,IRT_FORM:1024,IRT_SEGMENTATION_BLOCK:2048,IRT_TYPED_BARCODE_ZONE:4096,IRT_PREDETECTED_QUADRILATERAL:8192},Dynamsoft.DBR.EnumLocalizationMode={LM_SKIP:0,LM_AUTO:1,LM_CONNECTED_BLOCKS:2,LM_LINES:8,LM_STATISTICS:4,LM_SCAN_DIRECTLY:16,LM_STATISTICS_MARKS:32,LM_STATISTICS_POSTAL_CODE:64},Dynamsoft.DBR.EnumPDFReadingMode={PDFRM_RASTER:1,PDFRM_AUTO:2,PDFRM_VECTOR:4},Dynamsoft.DBR.EnumQRCodeErrorCorrectionLevel={QRECL_ERROR_CORRECTION_H:0,QRECL_ERROR_CORRECTION_L:1,QRECL_ERROR_CORRECTION_M:2,QRECL_ERROR_CORRECTION_Q:3},Dynamsoft.DBR.EnumRegionPredetectionMode={RPM_AUTO:1,RPM_GENERAL:2,RPM_GENERAL_RGB_CONTRAST:4,RPM_GENERAL_GRAY_CONTRAST:8,RPM_GENERAL_HSV_CONTRAST:16,RPM_SKIP:0},Dynamsoft.DBR.EnumResultCoordinateType={RCT_PIXEL:1,RCT_PERCENTAGE:2},Dynamsoft.DBR.EnumResultType={RT_STANDARD_TEXT:0,RT_RAW_TEXT:1,RT_CANDIDATE_TEXT:2,RT_PARTIAL_TEXT:3},Dynamsoft.DBR.EnumScaleUpMode={SUM_AUTO:1,SUM_LINEAR_INTERPOLATION:2,SUM_NEAREST_NEIGHBOUR_INTERPOLATION:4,SUM_SKIP:0},Dynamsoft.DBR.EnumTerminatePhase={TP_REGION_PREDETECTED:1,TP_IMAGE_PREPROCESSED:2,TP_IMAGE_BINARIZED:4,TP_BARCODE_LOCALIZED:8,TP_BARCODE_TYPE_DETERMINED:16,TP_BARCODE_RECOGNIZED:32},Dynamsoft.DBR.EnumTextAssistedCorrectionMode={TACM_AUTO:1,TACM_VERIFYING:2,TACM_VERIFYING_PATCHING:4,TACM_SKIP:0},Dynamsoft.DBR.EnumTextFilterMode={TFM_AUTO:1,TFM_GENERAL_CONTOUR:2,TFM_SKIP:0},Dynamsoft.DBR.EnumTextResultOrderMode={TROM_CONFIDENCE:1,TROM_POSITION:2,TROM_FORMAT:4,TROM_SKIP:0},Dynamsoft.DBR.EnumTextureDetectionMode={TDM_AUTO:1,TDM_GENERAL_WIDTH_CONCENTRATION:2,TDM_SKIP:0}}(),Dynamsoft.AddonReady(function(T,e){var t,u=Dynamsoft.BarcodeReaderAddon;function M(e){return e&&e instanceof ArrayBuffer}u.Class=function(){function e(e){this._runtimeSettings=null,this._initSettingsContent=null,this._tplContentArr=[],this._stwain=e}var E;e.prototype._decodeBlob=function(t,e){var n=this;return new T.Promise(function(e){if(!(t instanceof Blob))throw TypeError("'_decodeBlob(blob, templateName)': Type of 'blob' should be 'Blob'.");e()}).then(function(){return n._innerDecode(0,t,e)})},e.prototype._decodeArrayBuffer=function(t,e){var n=this;return new T.Promise(function(e){if(!(t instanceof ArrayBuffer))throw TypeError("'_decodeBlob(arrayBuffer, templateName)': Type of 'arrayBuffer' should be 'ArrayBuffer'.");e()}).then(function(){return n._innerDecode(0,t,e)})},e.prototype._decodeUint8Array=function(t,e){var n=this;return new T.Promise(function(e){if(!(t instanceof Uint8Array||self.Uint8ClampedArray&&t instanceof Uint8ClampedArray))throw TypeError("'_decodeBlob(uint8Array, templateName)': Type of 'uint8Array' should be 'Uint8Array'.");e()}).then(function(){return n._innerDecode(0,t,e)})},e.prototype._decodeImage=function(t,n){var o=this;return new T.Promise(function(e){if(!(t instanceof HTMLImageElement))throw TypeError("'_decodeImage(image, templateName)': Type of 'image' should be 'HTMLImageElement'.");if(t.crossOrigin&&"anonymous"!=t.crossOrigin)throw"cors";n=n||"",e()}).then(function(){return"data:image/"==t.src.substring(0,11)?o._decodeBase64(t.src,n):o._decodeUrl(t.src,n).catch(function(e){return 3<=u.logLevel&&console&&console.warn&&(console.warn("'_decodeImage(image, templateName)': Image src not available. Use '_decodeCanvas' instead."),console.warn(e)),self.HTMLCanvasElement?((e=document.createElement("canvas")).width=t.naturalWidth,e.height=t.naturalHeight,e.getContext("2d").drawImage(t,0,0),o._decodeCanvas(e,n)):T.Promise.reject(Error("'_decodeImage(image, templateName)': Browser not support HTMLCanvasElement."))})})},e.prototype._decodeCanvas=function(n,o){var t=this;return new T.Promise(function(t){if(!(n instanceof HTMLCanvasElement))throw TypeError("'_decodeCanvas(canvas, templateName)': Type of 'canvas' should be 'HTMLCanvasElement'.");if(n.crossOrigin&&"anonymous"!=n.crossOrigin)throw"cors";o=o||"",n.toBlob?n.toBlob(function(e){t(e)}):n.msToBlob?n.msToBlob(function(e){t(e)}):t(n.toDataURL())}).then(function(e){return n.toBlob||n.msToBlob?t._decodeBlob(e,o):t._decodeBase64(e,o)})},e.prototype._decodeVideo=function(d){var s,t=this,c=arguments;return new T.Promise(function(e){if(!(d instanceof HTMLVideoElement))throw TypeError("'_decodeVideo(video [ [, sx, sy, sWidth, sHeight], dWidth, dHeight] [, templateName] )': Type of 'video' should be 'HTMLVideoElement'.");if(d.crossOrigin&&"anonymous"!=d.crossOrigin)throw"cors";c.length<=2?(t=n=0,o=i=d.videoWidth,r=a=d.videoHeight):a=c.length<=4?(t=n=0,o=d.videoWidth,r=d.videoHeight,i=c[1],c[2]):(t=c[1],n=c[2],o=c[3],r=c[4],i=c[5],c[6]),s="string"==typeof c[c.length-1]?c[c.length-1]:"";var t,n,o,r,i,a,_=document.createElement("canvas");_.width=i,_.height=a,_.getContext("2d").drawImage(d,t,n,o,r,0,0,i,a),e(_)}).then(function(e){return t._decodeCanvas(e,s)})},e.prototype._decodeBase64=e.prototype.decodeBase64String=function(t,e){var n=this;return new T.Promise(function(e){if(!("string"==typeof t||"object"==typeof t&&t instanceof String))throw TypeError("'decodeBase64(base64Str, templateName)': Type of 'base64Str' should be 'String'.");"data:image/"==t.substring(0,11)&&(t=t.substring(t.indexOf(",")+1)),e()}).then(function(){return n._innerDecode(1,t,e)})},e.prototype._decodeUrl=function(o,r){var t=this;return o&&o.indexOf&&(0==o.indexOf("dwt://")||0==o.indexOf("dcs://"))?t._decodeDynamsoftServiceInnerUrl(o,r):new T.Promise(function(e,t){var n;if(!("string"==typeof o||"object"==typeof o&&o instanceof String))throw TypeError("'_decodeUrl(url, templateName)': Type of 'url' should be 'String'.");r=r||"",u._activeXInstance?((n=new ActiveXObject("MSXML2.XMLHTTP")).open("GET",o,!0),n.overrideMimeType?n.overrideMimeType("text/plain; charset=x-user-defined"):n.setRequestHeader("Accept-Charset","x-user-defined"),n.onreadystatechange=function(){4==n.readyState&&e(new VBArray(n.responseBody).toArray())},n.send("")):((n=new XMLHttpRequest).open("GET",o,!0),n.responseType="arraybuffer",n.send(),n.onloadend=function(){e(this.response)},n.onerror=function(){t(Error(n.error))})}).then(function(e){return u._activeXInstance?t._activeXDecodeArray(e,r):t._decodeArrayBuffer(e,r)})},e.prototype._decodeDynamsoftServiceInnerUrl=function(t,e){var n=this;return new T.Promise(function(e){if(!("string"==typeof t||"object"==typeof t&&t instanceof String))throw TypeError("'_decodeUrl(url, templateName)': Type of 'innerUrl' should be 'String'.");if(0!=t.indexOf("dwt://")&&0!=t.indexOf("dcs://"))throw TypeError("'_decodeDynamsoftServiceInnerUrl(innerUrl, templateName)': 'innerUrl' should start with 'dwt://' or 'dcs://'.");e()}).then(function(){return n._innerDecode(4e3,t,e)})},e.prototype._activeXDecodeArray=function(n,o){var t=this;return new T.Promise(function(e,t){if(!(n instanceof Array))throw TypeError("'_activeXDecodeArray(array, templateName)': Type of 'array' should be 'Array'.");o=o||"";try{e(Dynamsoft.Lib.btoa(String.fromCharCode.apply(String,n)))}catch(e){t(e)}}).then(function(e){return t._decodeBase64(e,o)})},e.prototype._activeXDecodeHandle=function(e,t){var n=this;return new T.Promise(function(e){t=t||"",e()}).then(function(){return n._innerDecode(4001,e,t)})},e.prototype._decode=e.prototype.decode=function(e,t){return u._activeXInstance?"string"==typeof e||e instanceof String?this._activeXDecodeHandle(e,t):T.Promise.reject(TypeError("'_decode(source, templateName)' in activeX: Type of 'source' should be 'String(partUrl)'.")):self.Blob&&e instanceof Blob?this._decodeBlob(e,t):self.ArrayBuffer&&e instanceof ArrayBuffer?this._decodeArrayBuffer(e,t):self.Uint8Array&&e instanceof Uint8Array||self.Uint8ClampedArray&&e instanceof Uint8ClampedArray?this._decodeUint8Array(e,t):e instanceof Array?this._activeXDecodeArray(e,t):self.HTMLImageElement&&e instanceof HTMLImageElement?this._decodeImage(e,t):self.HTMLCanvasElement&&e instanceof HTMLCanvasElement?this._decodeCanvas(e,t):self.HTMLVideoElement&&e instanceof HTMLVideoElement?this._decodeVideo(e,t):isNaN(e)?"string"==typeof e||e instanceof String?"data:image/"==e.substring(0,11)?this._decodeBase64(e,t):this._decodeUrl(e,t):T.Promise.reject(TypeError("'_decode(source, templateName)' in H5: Type of 'source' should be 'Blob', 'ArrayBuffer', 'Uint8Array', 'HTMLImageElement', 'HTMLCanvasElement', 'HTMLVideoElement', 'String(base64 with image mime)' or 'String(url)'.")):this._activeXDecodeHandle(e,t)},e.prototype._innerServiceCmd=function(r,i){var a=this._stwain;return new T.Promise(function(t,n){var e,o={method:"ReadBarcode",parameter:[Dynamsoft.Lib.product.refProductKey,4002,"",""],updateSettings:r,initSettingsContent:i};u._activeXInstance?t(u._activeXInstance.Process(T.stringify(o),location.protocol+"//"+location.host)):(a._blts?(e="",a&&a._bRemoteMode&&a._dmService&&a._dmService.attrs&&a._dmService.attrs.UUID&&(e=a._dmService.attrs.UUID),Dynamsoft.DWT.lglic(Dynamsoft.DWT.EnumInstance.dwt_desktop,e).then(function(e){return o.parameter.push(e.ar),o.parameter.push(e.cu),o.parameter.push(0),o.parameter.push(""),T.stringify(o)})):T.Promise.resolve(T.stringify(o))).then(function(e){return T.fetch(a._dbrUrlRoot+"ReadBarcode",{mode:"cors",method:"post",body:e,dataType:"arrayBuffer"})}).then(function(e){M(e)?t(String.fromCharCode.apply(null,new Uint8Array(e))):t(e)},function(e){var t="Init template & runtimeSettings failed.";e&&(t=[t," Http info: ",e.errorString," (",e.httpCode,")"].join("")),n(t)})})},e.prototype._innerDecode=function(i,a,_,d){var R=this;return R._runtimeSettings&&0==R._runtimeSettings.expectedBarcodesCount&&(R._runtimeSettings.expectedBarcodesCount=512),new T.Promise(function(s,c){function o(e,t,n){try{var o,r,i,a,_=E&&E(e);for(_&&_.textResults||c(new u.BarcodeReaderException(_.exception,_.description)),T.product.bHTML5Edition&&n&&n.config.data&&(o=T.parse(n.config.data),T.isArray(o.parameter))&&2<o.parameter.length&&4e3==o.parameter[1]&&(4<o.parameter.length&&o.parameter[4]?_.textResults.imageid=o.parameter[4]:0<=(a=(i=o.parameter[2]).indexOf("&index="))&&(_.textResults.imageid=i.substring(a+7,i.indexOf("&t=")))),r=0;r<_.textResults.length;r++){var d=_.textResults[r];d.BarcodeText=d.barcodeText,_.exception!=Dynamsoft.DBR.EnumErrorCode.DBR_SUCCESS&&(d.exception=_.exception)}_.exception!=Dynamsoft.DBR.EnumErrorCode.DBR_SUCCESS&&(_.textResults.exception=_.exception,_.textResults.description=_.description),u._activeXInstance&&_.records&&(Dynamsoft.Lib.each(_.records,function(e,t){Dynamsoft.DWT.lavrf(t,e,Dynamsoft.DWT.EnumInstance.dwt_desktop)}),Dynamsoft.DWT.lavrf_(1,Dynamsoft.DWT.EnumInstance.dwt_desktop)),s(_.textResults)}catch(e){c(e)}}var t,e,n={method:"ReadBarcode",parameter:[Dynamsoft.Lib.product.refProductKey,i,0!=i?a:null,_||""],updateSettings:R._runtimeSettings,conflictMode:1==R.conflictMode?"ignore":"overwrite",initSettingsContent:R._initSettingsContent,tplContent:function(){if(_)for(var e=0;e<R._tplContentArr.length;++e)if(_==R._tplContentArr[e].ImageParameter.Name)return T.stringify(R._tplContentArr[e]);return null}()},r=R._stwain;u._activeXInstance?r._blts?Dynamsoft.DWT.lglic(Dynamsoft.DWT.EnumInstance.dwt_desktop,"").then(function(e){n.parameter.push(e.ar),n.parameter.push(e.cu),n.parameter.push(0),n.parameter.push(""),o(u._activeXInstance.Process(T.stringify(n),location.protocol+"//"+location.host))}):o(u._activeXInstance.Process(T.stringify(n),location.protocol+"//"+location.host)):(t=r._dbrUrlRoot+"ReadBarcode",0==i&&(t+="/LoadZipFromBytes?cmd="+encodeURIComponent(T.stringify(n))),(0==i?T.Promise.resolve(a):r._blts?(e="",r&&r._bRemoteMode&&r._dmService&&r._dmService.attrs&&r._dmService.attrs.UUID&&(e=r._dmService.attrs.UUID),Dynamsoft.DWT.lglic(Dynamsoft.DWT.EnumInstance.dwt_desktop,e).then(function(e){return n.parameter.push(e.ar),n.parameter.push(e.cu),n.parameter.push(0),n.parameter.push([T.product.getDWTPrefix(),T.product.getServerVersionInfo(),"/verify?id=",d,"&t=",T.getRandom()].join("")),T.stringify(n)})):T.Promise.resolve(T.stringify(n))).then(function(e){return T.fetch(t,{mode:"cors",method:"post",body:e,dataType:"arrayBuffer"})}).then(function(e,t,n){M(e)?o(String.fromCharCode.apply(null,new Uint8Array(e)),0,n):o(e,0,n)},function(e){var t="ReadBarcode request fail.";e&&(t=[t," Http info: ",e.errorString," (",e.httpCode,")"].join("")),c(Error(t))}))})},E=u._handleRetJsonString=function(t){var n;if("string"==typeof t||"object"==typeof t&&t instanceof String)try{n=T.parse(t)}catch(e){n=T.parse(u.RemoveNonPrintableChar(t))}else n=t;if(!n)throw u.BarcodeReaderException(Dynamsoft.DBR.EnumErrorCode.DBR_UNKNOWN,u.errors.decodeResultEmpty);if("textResults"in n&&T.isArray(n.textResults)||n.exception==Dynamsoft.DBR.EnumErrorCode.DBR_SUCCESS)return n;throw u.BarcodeReaderException(n.exception,n.description)},e.prototype.getAllParameterTemplateNames=function(){for(var e=[],t=0;t<this._tplContentArr.length;++t)e.push(this._tplContentArr[t].ImageParameter.Name);return e},e.prototype.getRuntimeSettings=function(){return this._runtimeSettings||(this._runtimeSettings=T.parse(u._defaultRuntimeSettingsStr)),T.Promise.resolve(this._runtimeSettings)};return e.prototype.updateRuntimeSettings=function(e){var t,n=this;if("string"==typeof e||"object"==typeof e&&e instanceof String){if("speed"==e||"balance"==e||"coverage"==e||"default"==e)return n.initRuntimeSettingsWithString("speed"==e?'{"ImageParameter":{"AccompanyingTextRecognitionModes":[{"Mode":"ATRM_SKIP"}],"BarcodeColourModes":[{"LightReflection":1,"Mode":"BICM_DARK_ON_LIGHT"}],"BarcodeComplementModes":[{"Mode":"BCM_SKIP"}],"BarcodeFormatIds":["BF_ALL"],"BarcodeFormatIds_2":["BF2_POSTALCODE","BF2_DOTCODE"],"BinarizationModes":[{"BlockSizeX":0,"BlockSizeY":0,"EnableFillBinaryVacancy":1,"ImagePreprocessingModesIndex":-1,"Mode":"BM_LOCAL_BLOCK","ThreshValueCoefficient":10}],"ColourClusteringModes":[{"Mode":"CCM_SKIP"}],"ColourConversionModes":[{"BlueChannelWeight":-1,"GreenChannelWeight":-1,"Mode":"CICM_GENERAL","RedChannelWeight":-1}],"DPMCodeReadingModes":[{"Mode":"DPMCRM_SKIP"}],"DeblurLevel":3,"DeformationResistingModes":[{"Mode":"DRM_SKIP"}],"Description":"","ExpectedBarcodesCount":512,"FormatSpecificationNameArray":null,"GrayscaleTransformationModes":[{"Mode":"GTM_ORIGINAL"}],"ImagePreprocessingModes":[{"Mode":"IPM_GENERAL"}],"IntermediateResultSavingMode":{"Mode":"IRSM_MEMORY"},"IntermediateResultTypes":["IRT_NO_RESULT"],"LocalizationModes":[{"Mode":"LM_CONNECTED_BLOCKS"},{"Mode":"LM_STATISTICS_MARKS"},{"Mode":"LM_STATISTICS_POSTAL_CODE"}],"MaxAlgorithmThreadCount":4,"Name":"bestSpeed","PDFRasterDPI":300,"PDFReadingMode":{"Mode":"PDFRM_AUTO"},"Pages":"","RegionDefinitionNameArray":null,"RegionPredetectionModes":[{"Mode":"RPM_GENERAL"}],"ResultCoordinateType":"RCT_PIXEL","ReturnBarcodeZoneClarity":0,"ScaleDownThreshold":2300,"ScaleUpModes":[{"Mode":"SUM_AUTO"}],"TerminatePhase":"TP_BARCODE_RECOGNIZED","TextAssistedCorrectionMode":{"BottomTextPercentageSize":0,"LeftTextPercentageSize":0,"Mode":"TACM_VERIFYING","RightTextPercentageSize":0,"TopTextPercentageSize":0},"TextFilterModes":[{"Mode":"TFM_SKIP"}],"TextResultOrderModes":[{"Mode":"TROM_CONFIDENCE"},{"Mode":"TROM_POSITION"},{"Mode":"TROM_FORMAT"}],"TextureDetectionModes":[{"Mode":"TDM_GENERAL_WIDTH_CONCENTRATION","Sensitivity":5}],"Timeout":10000},"Version":"3.0"}':"balance"==e?'{"ImageParameter":{"AccompanyingTextRecognitionModes":[{"Mode":"ATRM_SKIP"}],"BarcodeColourModes":[{"LightReflection":1,"Mode":"BICM_DARK_ON_LIGHT"}],"BarcodeComplementModes":[{"Mode":"BCM_SKIP"}],"BarcodeFormatIds":["BF_ALL"],"BarcodeFormatIds_2":["BF2_POSTALCODE","BF2_DOTCODE"],"BinarizationModes":[{"BlockSizeX":0,"BlockSizeY":0,"EnableFillBinaryVacancy":1,"ImagePreprocessingModesIndex":-1,"Mode":"BM_LOCAL_BLOCK","ThreshValueCoefficient":10}],"ColourClusteringModes":[{"Mode":"CCM_SKIP"}],"ColourConversionModes":[{"BlueChannelWeight":-1,"GreenChannelWeight":-1,"Mode":"CICM_GENERAL","RedChannelWeight":-1}],"DPMCodeReadingModes":[{"Mode":"DPMCRM_SKIP"}],"DeblurLevel":5,"DeformationResistingModes":[{"Mode":"DRM_SKIP"}],"Description":"","ExpectedBarcodesCount":512,"FormatSpecificationNameArray":null,"GrayscaleTransformationModes":[{"Mode":"GTM_ORIGINAL"}],"ImagePreprocessingModes":[{"Mode":"IPM_GENERAL"}],"IntermediateResultSavingMode":{"Mode":"IRSM_MEMORY"},"IntermediateResultTypes":["IRT_NO_RESULT"],"LocalizationModes":[{"Mode":"LM_CONNECTED_BLOCKS"},{"Mode":"LM_STATISTICS"},{"Mode":"LM_STATISTICS_MARKS"},{"Mode":"LM_STATISTICS_POSTAL_CODE"}],"MaxAlgorithmThreadCount":4,"Name":"balance","PDFRasterDPI":300,"PDFReadingMode":{"Mode":"PDFRM_AUTO"},"Pages":"","RegionDefinitionNameArray":null,"RegionPredetectionModes":[{"Mode":"RPM_GENERAL"}],"ResultCoordinateType":"RCT_PIXEL","ReturnBarcodeZoneClarity":0,"ScaleDownThreshold":2300,"ScaleUpModes":[{"Mode":"SUM_AUTO"}],"TerminatePhase":"TP_BARCODE_RECOGNIZED","TextAssistedCorrectionMode":{"BottomTextPercentageSize":0,"LeftTextPercentageSize":0,"Mode":"TACM_VERIFYING","RightTextPercentageSize":0,"TopTextPercentageSize":0},"TextFilterModes":[{"MinImageDimension":65536,"Mode":"TFM_GENERAL_CONTOUR","Sensitivity":0}],"TextResultOrderModes":[{"Mode":"TROM_CONFIDENCE"},{"Mode":"TROM_POSITION"},{"Mode":"TROM_FORMAT"}],"TextureDetectionModes":[{"Mode":"TDM_GENERAL_WIDTH_CONCENTRATION","Sensitivity":5}],"Timeout":10000},"Version":"3.0"}':"coverage"==e?'{"ImageParameter":{"AccompanyingTextRecognitionModes":[{"Mode":"ATRM_SKIP"}],"BarcodeColourModes":[{"LightReflection":1,"Mode":"BICM_DARK_ON_LIGHT"}],"BarcodeComplementModes":[{"Mode":"BCM_SKIP"}],"BarcodeFormatIds":["BF_ALL"],"BarcodeFormatIds_2":["BF2_POSTALCODE","BF2_DOTCODE"],"BinarizationModes":[{"BlockSizeX":0,"BlockSizeY":0,"EnableFillBinaryVacancy":1,"ImagePreprocessingModesIndex":-1,"Mode":"BM_LOCAL_BLOCK","ThreshValueCoefficient":10}],"ColourClusteringModes":[{"Mode":"CCM_SKIP"}],"ColourConversionModes":[{"BlueChannelWeight":-1,"GreenChannelWeight":-1,"Mode":"CICM_GENERAL","RedChannelWeight":-1}],"DPMCodeReadingModes":[{"Mode":"DPMCRM_SKIP"}],"DeblurLevel":9,"DeformationResistingModes":[{"Mode":"DRM_SKIP"}],"Description":"","ExpectedBarcodesCount":512,"FormatSpecificationNameArray":null,"GrayscaleTransformationModes":[{"Mode":"GTM_ORIGINAL"},{"Mode":"GTM_INVERTED"}],"ImagePreprocessingModes":[{"Mode":"IPM_GENERAL"}],"IntermediateResultSavingMode":{"Mode":"IRSM_MEMORY"},"IntermediateResultTypes":["IRT_NO_RESULT"],"LocalizationModes":[{"Mode":"LM_CONNECTED_BLOCKS"},{"Mode":"LM_SCAN_DIRECTLY","ScanDirection":0,"ScanStride":0},{"Mode":"LM_STATISTICS"},{"Mode":"LM_LINES"},{"Mode":"LM_STATISTICS_MARKS"},{"Mode":"LM_STATISTICS_POSTAL_CODE"}],"MaxAlgorithmThreadCount":4,"Name":"coverage","PDFRasterDPI":300,"PDFReadingMode":{"Mode":"PDFRM_AUTO"},"Pages":"","RegionDefinitionNameArray":null,"RegionPredetectionModes":[{"Mode":"RPM_GENERAL"}],"ResultCoordinateType":"RCT_PIXEL","ReturnBarcodeZoneClarity":0,"ScaleDownThreshold":214748347,"ScaleUpModes":[{"Mode":"SUM_AUTO"}],"TerminatePhase":"TP_BARCODE_RECOGNIZED","TextAssistedCorrectionMode":{"BottomTextPercentageSize":0,"LeftTextPercentageSize":0,"Mode":"TACM_VERIFYING","RightTextPercentageSize":0,"TopTextPercentageSize":0},"TextFilterModes":[{"MinImageDimension":65536,"Mode":"TFM_GENERAL_CONTOUR","Sensitivity":0}],"TextResultOrderModes":[{"Mode":"TROM_CONFIDENCE"},{"Mode":"TROM_POSITION"},{"Mode":"TROM_FORMAT"}],"TextureDetectionModes":[{"Mode":"TDM_GENERAL_WIDTH_CONCENTRATION","Sensitivity":5}],"Timeout":10000},"Version":"3.0"}':'{"ImageParameter":{"AccompanyingTextRecognitionModes":[{"Mode":"ATRM_SKIP"}],"BarcodeColourModes":[{"LightReflection":1,"Mode":"BICM_DARK_ON_LIGHT"}],"BarcodeComplementModes":[{"Mode":"BCM_SKIP"}],"BarcodeFormatIds":["BF_ALL"],"BarcodeFormatIds_2":null,"BinarizationModes":[{"BlockSizeX":0,"BlockSizeY":0,"EnableFillBinaryVacancy":1,"ImagePreprocessingModesIndex":-1,"Mode":"BM_LOCAL_BLOCK","ThreshValueCoefficient":10}],"ColourClusteringModes":[{"Mode":"CCM_SKIP"}],"ColourConversionModes":[{"BlueChannelWeight":-1,"GreenChannelWeight":-1,"Mode":"CICM_GENERAL","RedChannelWeight":-1}],"DPMCodeReadingModes":[{"Mode":"DPMCRM_SKIP"}],"DeblurLevel":9,"DeformationResistingModes":[{"Mode":"DRM_SKIP"}],"Description":"","ExpectedBarcodesCount":512,"FormatSpecificationNameArray":null,"GrayscaleTransformationModes":[{"Mode":"GTM_ORIGINAL"}],"ImagePreprocessingModes":[{"Mode":"IPM_GENERAL"}],"IntermediateResultSavingMode":{"Mode":"IRSM_MEMORY"},"IntermediateResultTypes":["IRT_NO_RESULT"],"LocalizationModes":[{"Mode":"LM_CONNECTED_BLOCKS"},{"Mode":"LM_SCAN_DIRECTLY","ScanDirection":0,"ScanStride":0},{"Mode":"LM_STATISTICS"},{"Mode":"LM_LINES"}],"MaxAlgorithmThreadCount":4,"Name":"default","PDFRasterDPI":300,"PDFReadingMode":{"Mode":"PDFRM_AUTO"},"Pages":"","RegionDefinitionNameArray":null,"RegionPredetectionModes":[{"Mode":"RPM_GENERAL"}],"ResultCoordinateType":"RCT_PIXEL","ReturnBarcodeZoneClarity":0,"ScaleDownThreshold":2300,"ScaleUpModes":[{"Mode":"SUM_AUTO"}],"TerminatePhase":"TP_BARCODE_RECOGNIZED","TextAssistedCorrectionMode":{"BottomTextPercentageSize":0,"LeftTextPercentageSize":0,"Mode":"TACM_VERIFYING","RightTextPercentageSize":0,"TopTextPercentageSize":0},"TextFilterModes":[{"MinImageDimension":65536,"Mode":"TFM_GENERAL_CONTOUR","Sensitivity":0}],"TextResultOrderModes":[{"Mode":"TROM_CONFIDENCE"},{"Mode":"TROM_POSITION"},{"Mode":"TROM_FORMAT"}],"TextureDetectionModes":[{"Mode":"TDM_GENERAL_WIDTH_CONCENTRATION","Sensitivity":5}],"Timeout":10000},"Version":"3.0"}');t=e}else{if("object"!=typeof e)throw TypeError("'setTemplateSettings(settings)': Type of 'settings' should be 'String' or 'PlainObject'.");t=T.stringify(e)}e=T.parse(t);return n._runtimeSettings=e,n._initSettingsContent=null,n._innerServiceCmd(n._runtimeSettings,null).then(function(e){e=u._handleRetJsonString(e);return n._runtimeSettings=e.settings,n._runtimeSettings||(n._runtimeSettings=T.parse(u._defaultRuntimeSettingsStr)),e.settings})},e.prototype.resetRuntimeSettings=function(){var t=this;return t._runtimeSettings=T.parse(u._defaultRuntimeSettingsStr),t._initSettingsContent=null,t._innerServiceCmd(t._runtimeSettings,null).then(function(e){e=u._handleRetJsonString(e);return t._runtimeSettings=e.settings,t._runtimeSettings||(t._runtimeSettings=T.parse(u._defaultRuntimeSettingsStr)),e.settings})},e.prototype.outputSettingsToString=function(e){if(!e)return u._defaultTemplateStr;for(var t=0;t<this._tplContentArr.length;++t)if(e==this._tplContentArr[t].ImageParameter.Name)return T.stringify(this._tplContentArr[t])},e.prototype.initRuntimeSettingsWithString=function(e){var t=this;if(T.isString(e))return t._runtimeSettings=null,t._initSettingsContent=T.parse(e),t._innerServiceCmd(null,t._initSettingsContent).then(function(e){e=u._handleRetJsonString(e);return t._runtimeSettings=e.settings,t._runtimeSettings||(t._runtimeSettings=T.parse(u._defaultRuntimeSettingsStr)),e.settings});throw TypeError("'initRuntimeSettingsWithString(settings)': Type of 'settings' should be 'String'.")},e}(),u._dbr_ax=!1,u._dbr=!1,u._initH5=function(r,n,o){return new T.Promise(function(e,t){r._bRemoteMode&&r._dmService&&r._dmService.attrs&&r._dmService.attrs.url&&(r._dbrUrlRoot=r._dmService.attrs.url+"dcp/dbr_"+u.Version.replace(/\./g,"")+"/"),r._dbrUrlRoot||(r._dbrUrlRoot=Dynamsoft.DWT.NetManager.getModuleUrl("dcp/dbr_"+u.Version.replace(/\./g,"")+"/"));var n=5,o={method:"POST",url:r._dbrUrlRoot+"VersionInfo?t="+T.getRandom(),data:'{"method":"VersionInfo"}',onSuccess:function(){e()},onError:function(){if(--n<=0)return t("Failed to connect to the Barcode Reader Add-on, the library may be missing in the Dynamsoft Service directory.");setTimeout(function(){T.ajax(o)},300)},dataType:"json",async:!0,timeout:800};T.ajax(o)}).then(function(){return u._dbr=new u.Class(r),u._dbr._innerServiceCmd(null,null)}).then(function(e){try{var t=u._handleRetJsonString(e);u._dbr._runtimeSettings=t.settings,u._defaultRuntimeSettingsStr=T.stringify(t.settings),u._defaultTemplateStr=T.stringify(t.outputSettings),n(u._dbr)}catch(e){o(Error("Init template & runtimeSettings failed: "+e.message)||e)}},function(e){o(e)})},u.dbrInitPromiseFun=function(n){return new T.Promise(function(e,t){u.innerDbrInit(n,e,t)})},u.innerDbrInit=function(e,t,n){var o=!1,r=!1,i=(T.product.bHTML5Edition?o=!0:r=!0,Dynamsoft.BarcodeReaderAddon);if(o){if(i._dbr)return void t(i._dbr)}else if(r&&i._dbr_ax)return void t(i._dbr_ax);if(o&&i._initH5(e,t,n),r){o=Dynamsoft.navInfoSync,r={method:"ReadBarcode",parameter:[Dynamsoft.Lib.product.refProductKey,4002,"",""]};if(!o.bIE)return n(Error("The DBR init error."));try{i._activeXInstance=new ActiveXObject("DBRModule.AtlDBR");var a,_=i._activeXInstance.Process(T.stringify(r),location.protocol+"//"+location.host),d=T.parse(_);return d?"settings"in d?(i._dbr_ax=new i.Class(e),i._dbr_ax._runtimeSettings=d.settings,i._defaultRuntimeSettingsStr=T.stringify(d.settings),"outputSettings"in d&&(i._defaultTemplateStr=T.stringify(d.outputSettings)),void t(i._dbr_ax)):(a=d.description||"The DBR init error.",n(Error(a))):n(Error("The DBR init error."))}catch(e){return n(Error("The DBR .dll is missing or not accessible: "+(e.message||e)))}}},T.DynamicLoadAddonFuns&&T.DynamicLoadAddonFuns.push(function(a){if(t=a._b64bit?"dbrx64_"+Dynamsoft.BarcodeReaderAddon.Version+".dll":"dbr_"+Dynamsoft.BarcodeReaderAddon.Version+".dll",T.product.bHTML5Edition)try{a._innerSend("GetAddOnVersion",T.html5.Funs.makeParams("barcodereader",t),!0,!1,!1).catch(function(){})}catch(e){}function n(e){return!T.License.checkProductKey(e,{Core:!0})||!!(Dynamsoft.navInfoSync.bMac||Dynamsoft.navInfoSync.bLinux||Dynamsoft.Lib.env.bMobile)&&(e._errorCode=Dynamsoft.DBR.EnumErrorCode.DBR_UNKNOWN,e._errorString=u.errors.ServiceEditionNotSupportDbr,!0)}var e={BarcodeReader:{decode:function(t){return n(a)?T.Promise.reject(u.BarcodeReaderException(a._errorCode,a._errorString)):!T.isNumber(t)||t<0||t>=a.HowManyImagesInBuffer?(T.Errors.IndexOutOfRange(a),T.Promise.reject(u.BarcodeReaderException(a._errorCode,a._errorString))):new T.Promise(function(e){u._decoding?u._decodeQueue.push({method:e,args:[t]}):(u._decoding=!0,e(t))}).then(function(e){var i;if(T.product.bHTML5Edition){if(-1==(i=a._ImgManager.convertClientIndexToServerId(e)))throw T.Errors.IndexOutOfRange(a),setTimeout(u._decodeNext,0),u.BarcodeReaderException(a._errorCode,a._errorString)}else i=e;return new T.Promise(function(o,r){u.dbrInitPromiseFun(a).then(function(e){var t;if(!T.product.bHTML5Edition)return t=i,n=a.GetImagePartURL(t,-1,-1),e._innerDecode(4001,n,"").then(function(e){e.imageid=a.IndexToImageID(t),setTimeout(u._decodeNext,0),o(e)},function(e){setTimeout(u._decodeNext,0),r(e)});t=a._ImgManager.convertServerIdToClientIndex(i);var n=a.GetImagePartURL(t,-1,-1);return e._innerDecode(4e3,n,"",a._clientId).then(function(e){e.imageid=a.IndexToImageID(t),setTimeout(u._decodeNext,0),o(e),a._blts&&Dynamsoft.DWT.lcvrf(a)},function(e){setTimeout(u._decodeNext,0),r(e)})},function(e){setTimeout(u._decodeNext,0),r(e)})})})},resetRuntimeSettings:function(){return n(a)?T.Promise.reject(u.BarcodeReaderException(a._errorCode,a._errorString)):u.dbrInitPromiseFun(a).then(function(e){return e.resetRuntimeSettings()})},getRuntimeSettings:function(e){return n(a)?T.Promise.reject(u.BarcodeReaderException(a._errorCode,a._errorString)):!T.isString(e)||"speed"!=e&&"balance"!=e&&"coverage"!=e&&"default"!=e?u.dbrInitPromiseFun(a).then(function(e){return e.getRuntimeSettings()}):this.updateRuntimeSettings(e)},updateRuntimeSettings:function(t){return n(a)?T.Promise.reject(u.BarcodeReaderException(a._errorCode,a._errorString)):u.dbrInitPromiseFun(a).then(function(e){return e.updateRuntimeSettings(t)})},initRuntimeSettingsWithString:function(t){return n(a)?T.Promise.reject(u.BarcodeReaderException(a._errorCode,a._errorString)):u.dbrInitPromiseFun(a).then(function(e){return e.initRuntimeSettingsWithString(t)})}}};T.product.bHTML5Edition?(a.__addon=a.__addon||{},T.mix(a.__addon,e)):(a.Addon=a.Addon||{},T.mix(a.Addon,e))})}); 
/*! 20230424145730
* Dynamsoft JavaScript Library
* Product: Dynamsoft Web Twain
* Web Site: https://www.dynamsoft.com
*
* Copyright 2023, Dynamsoft Corporation
* Author: Dynamsoft Support Team
*
* Module: PDF
* Version: 18.2
* 
*/
var Dynamsoft=self.Dynamsoft||{};Dynamsoft.DWT=Dynamsoft.DWT||{},Dynamsoft.aryAddonReadyFun=Dynamsoft.aryAddonReadyFun||[],Dynamsoft.AddonReady=Dynamsoft.AddonReady||function(n){Dynamsoft.aryAddonReadyFun.push(n)},function(){for(var n=[Dynamsoft.DWT],e=0;e<1;e++){var r=n[e];r.EnumDWT_ConvertMode={CM_RENDERALL:1,CM_IMAGEONLY:2,CM_AUTO:3,CM_RENDERALLWITHANNOTATION:4},r.EnumDWT_PDFCompressionType={PDF_AUTO:0,PDF_FAX3:1,PDF_FAX4:2,PDF_LZW:3,PDF_RLE:4,PDF_JPEG:5,PDF_JP2000:6,PDF_JBIG2:7}}}(),Dynamsoft.AddonReady(function(t,n){var e;t.product.bHTML5Edition&&t.DynamicLoadAddonFuns&&t.DynamicLoadAddonFuns.push(function(a){var n,i=t.html5.Funs;e=a.__serverPlatform==Dynamsoft.DWT.EnumDWT_PlatformType.enumMac?a._b64bit?"libDynamicPdfCorex64_"+Dynamsoft.DWT.PdfVersion+".dylib":"libDynamicPdfCore_"+Dynamsoft.DWT.PdfVersion+".dylib":a.__serverPlatform==Dynamsoft.DWT.EnumDWT_PlatformType.enumLinux||a.__serverPlatform==Dynamsoft.DWT.EnumDWT_PlatformType.enumEmbed||a.__serverPlatform==Dynamsoft.DWT.EnumDWT_PlatformType.enumChromeOS?"libDynamicPdfCore_"+Dynamsoft.DWT.PdfVersion+".so":a._b64bit?"DynamicPdfCorex64_"+Dynamsoft.DWT.PdfVersion+".dll":"DynamicPdfCore_"+Dynamsoft.DWT.PdfVersion+".dll";try{a._innerSend("GetAddOnVersion",i.makeParams("pdf",e),!0,!1,!1).catch(function(){})}catch(n){}n={PDF:{IsModuleInstalled:function(){var n=a;return n._resetErr(),""!=n._innerFun("GetAddOnVersion",i.makeParams("pdf",e))},IsModuleInstalledAsync:function(){var n=a;return n._resetErr(),n._innerFunV2("GetAddOnVersion",i.makeParams("pdf",e)).then(function(n){return""!=n})},ConvertToImage:function(n,e,r,o){var n=i.replaceLocalFilename(n),t="ConvertPDFToImage",s=a;return s._resetErr(),i.showMask(t),s._innerSend(t,i.makeParams(n,e),!0,function(n){return i.hideMask(t),r&&r(),!0},function(n){return i.hideMask(t),o&&o(),!1}),!0},SetPassword:function(n){var e=a;return e._resetErr(),e._innerFun("SetPDFPassword",i.makeParams(n))},SetConvertMode:function(n){return a._setConvertMode(n)},SetConvertModeAsync:function(n){return a._setConvertModeAsync(n)},GetConvertMode:function(){var n=a;return n._resetErr(),n._pdfConvertMode},SetResolution:function(n){return a._resetErr(),a._innerFun("SetPDFResolution",i.makeParams(n))},SetResolutionAsync:function(n){return a._resetErr(),a._innerFunV2("SetPDFResolution",i.makeParams(n))},IsTextBasedPDF:function(n,e,r){var o=a,n=(o._resetErr(),i.replaceLocalFilename(n)),n=a._innerFun("IsTextBasedPDF",i.makeParams(n));return 0==o.ErrorCode?t.isFunction(e)&&e(n):t.isFunction(r)&&r(o.ErrorCode,o.ErrorString),n},Write:{Setup:function(n){var n=(n=n)||{version:15},e=(2<t.stringify(n).length&&(t.isNumber(n.version)?1<=n.version&&n.version<2&&(n.version=parseInt(10*n.version)):n.version=15),t.isNumber(n.compression)&&n.compression==Dynamsoft.DWT.EnumDWT_PDFCompressionType.PDF_FAX3&&(n.compression=Dynamsoft.DWT.EnumDWT_PDFCompressionType.PDF_FAX4),a),n=(e._resetErr(),t.stringify(n)),n=t.replaceAll(n,'"','\\"');return e._innerFun("SetPDFSettings",['["',n,'"]'].join(""))}}}},a.__addon=a.__addon||{},t.mix(a.__addon,n)})}),Dynamsoft.AddonReady(function(a,n){a.product.bActiveXEdition&&a.DynamicLoadAddonFuns&&a.DynamicLoadAddonFuns.push(function(t){var n,s,e;if(!t.getSWebTwain()||!t.getSWebTwain().Addon)return!1;Dynamsoft.navInfoSync.bWin&&(e=!Dynamsoft.navInfo.bOSx64||Dynamsoft.navInfo.bWOW64?"DynamicPdfCore_"+Dynamsoft.DWT.PdfVersion+".dll":"DynamicPdfCorex64_"+Dynamsoft.DWT.PdfVersion+".dll"),s=t.getSWebTwain(),n={PDF:{IsModuleInstalled:function(){var n=s.GetAddOnVersion("pdf",e);return a.setErrorString(t),""!=n},IsModuleInstalledAsync:function(){var n=s.GetAddOnVersion("pdf",e);return a.setErrorString(t),a.Promise.resolve(""!=n)},ConvertToImage:function(n,e,r,o){n=s.ConvertPDFToImage(n,e);return a.wrapperRet(t,n,r,o)},SetPassword:function(n){n=s.SetPDFPassword(n);return a.wrapperRet(t,n)},SetConvertMode:function(n){return t._setConvertMode(n)},SetConvertModeAsync:function(n){return Promise.resolve(t._setConvertMode(n))},GetConvertMode:function(){return t._resetErr(),t._pdfConvertMode},SetResolution:function(n){n=s.SetPDFResolution(n);return a.wrapperRet(t,n)},SetResolutionAsync:function(n){n=s.SetPDFResolution(n);return a.Promise.resolve(a.wrapperRet(t,n))},IsTextBasedPDF:function(n){n=s.IsTextBasedPDF(n);return a.wrapperRet(t,n)}}},t.Addon=t.Addon||{},a.mix(t.Addon,n)})}); 
/*! 20230424145730
* Dynamsoft JavaScript Library
* Product: Dynamsoft Web Twain
* Web Site: https://www.dynamsoft.com
*
* Copyright 2023, Dynamsoft Corporation
* Author: Dynamsoft Support Team
*
* Module: OCR
* Version: 18.2
* 
*/
var Dynamsoft=self.Dynamsoft||{};Dynamsoft.DWT=Dynamsoft.DWT||{},Dynamsoft.aryAddonReadyFun=Dynamsoft.aryAddonReadyFun||[],Dynamsoft.AddonReady=Dynamsoft.AddonReady||function(t){Dynamsoft.aryAddonReadyFun.push(t)},Dynamsoft.DWT.OCRVerInName="10.0.0.0618",function(){for(var t=[Dynamsoft.DWT],e=0;e<1;e++){var n=t[e];n.EnumDWT_OCRLanguage={OCRL_ENG:"eng",OCRL_ARA:"ara",OCRL_CHI_SIM:"chi_sim",OCRL_CHI_TRA:"chi_tra",OCRL_HIN:"hin",OCRL_URD:"urd",OCRL_SPA:"spa",OCRL_FRA:"fra",OCRL_MSA:"msa",OCRL_IND:"ind",OCRL_RUS:"rus",OCRL_BEN:"ben",OCRL_POR:"por",OCRL_PAN:"pan",OCRL_DEU:"deu",OCRL_JPN:"jpn",OCRL_FAS:"fas",OCRL_SWA:"swa",OCRL_JAV:"jav",OCRL_TEL:"tel",OCRL_TUR:"tur",OCRL_KOR:"kor",OCRL_MAR:"mar",OCRL_TAM:"tam",OCRL_VIE:"vie",OCRL_ITA:"ita",OCRL_THA:"tha"},n.EnumDWT_OCRPageSetMode={OCRPSM_OSD_ONLY:0,PSM_AUTO_OSD:1,PSM_AUTO_ONLY:2,PSM_AUTO:3,PSM_SINGLE_COLUMN:4,PSM_SINGLE_BLOCK_VERT_TEXT:5,PSM_SINGLE_BLOCK:6,PSM_SINGLE_LINE:7,PSM_SINGLE_WORD:8,PSM_CIRCLE_WORD:9,PSM_SINGLE_CHAR:10},n.EnumDWT_OCROutputFormat={OCROF_TEXT:0,OCROF_PDFPLAINTEXT:1,OCROF_PDFIMAGEOVERTEXT:2,OCROF_PDFPLAINTEXT_PDFX:3,OCROF_PDFIMAGEOVERTEXT_PDFX:4},n.EnumDWT_OCRDownloadType={OCRDT_Dll:0,OCRDT_LANGUAGE:1}}}(),Dynamsoft.DWT.OCRLanguageData_eng="4113088",Dynamsoft.DWT.OCRLanguageData_ara="1432056",Dynamsoft.DWT.OCRLanguageData_chi_sim="2469156",Dynamsoft.DWT.OCRLanguageData_chi_tra="2366642",Dynamsoft.DWT.OCRLanguageData_hin="1122751",Dynamsoft.DWT.OCRLanguageData_urd="1398718",Dynamsoft.DWT.OCRLanguageData_spa="2294433",Dynamsoft.DWT.OCRLanguageData_fra="1130365",Dynamsoft.DWT.OCRLanguageData_msa="1747801",Dynamsoft.DWT.OCRLanguageData_ind="1122661",Dynamsoft.DWT.OCRLanguageData_rus="3861738",Dynamsoft.DWT.OCRLanguageData_ben="855841",Dynamsoft.DWT.OCRLanguageData_por="1982756",Dynamsoft.DWT.OCRLanguageData_pan="497721",Dynamsoft.DWT.OCRLanguageData_deu="1525436",Dynamsoft.DWT.OCRLanguageData_jpn="2471260",Dynamsoft.DWT.OCRLanguageData_fas="431500",Dynamsoft.DWT.OCRLanguageData_swa="2167651",Dynamsoft.DWT.OCRLanguageData_jav="2982741",Dynamsoft.DWT.OCRLanguageData_tel="2769654",Dynamsoft.DWT.OCRLanguageData_tur="4550554",Dynamsoft.DWT.OCRLanguageData_kor="1677415",Dynamsoft.DWT.OCRLanguageData_mar="2118233",Dynamsoft.DWT.OCRLanguageData_tam="3237963",Dynamsoft.DWT.OCRLanguageData_vie="531275",Dynamsoft.DWT.OCRLanguageData_ita="2701314",Dynamsoft.DWT.OCRLanguageData_tha="1072600",Dynamsoft.DWT.OCRLanguageData={},Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_ENG]=Dynamsoft.DWT.OCRLanguageData_eng,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_ARA]=Dynamsoft.DWT.OCRLanguageData_ara,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_CHI_TRA]=Dynamsoft.DWT.OCRLanguageData_chi_tra,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_CHI_SIM]=Dynamsoft.DWT.OCRLanguageData_chi_sim,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_HIN]=Dynamsoft.DWT.OCRLanguageData_hin,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_URD]=Dynamsoft.DWT.OCRLanguageData_urd,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_SPA]=Dynamsoft.DWT.OCRLanguageData_spa,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_FRA]=Dynamsoft.DWT.OCRLanguageData_fra,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_MSA]=Dynamsoft.DWT.OCRLanguageData_msa,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_IND]=Dynamsoft.DWT.OCRLanguageData_ind,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_RUS]=Dynamsoft.DWT.OCRLanguageData_rus,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_BEN]=Dynamsoft.DWT.OCRLanguageData_ben,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_POR]=Dynamsoft.DWT.OCRLanguageData_por,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_PAN]=Dynamsoft.DWT.OCRLanguageData_pan,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_DEU]=Dynamsoft.DWT.OCRLanguageData_deu,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_JPN]=Dynamsoft.DWT.OCRLanguageData_jpn,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_FAS]=Dynamsoft.DWT.OCRLanguageData_fas,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_SWA]=Dynamsoft.DWT.OCRLanguageData_swa,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_JAV]=Dynamsoft.DWT.OCRLanguageData_jav,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_TEL]=Dynamsoft.DWT.OCRLanguageData_tel,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_TUR]=Dynamsoft.DWT.OCRLanguageData_tur,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_KOR]=Dynamsoft.DWT.OCRLanguageData_kor,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_MAR]=Dynamsoft.DWT.OCRLanguageData_mar,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_TAM]=Dynamsoft.DWT.OCRLanguageData_tam,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_VIE]=Dynamsoft.DWT.OCRLanguageData_vie,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_ITA]=Dynamsoft.DWT.OCRLanguageData_ita,Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_THA]=Dynamsoft.DWT.OCRLanguageData_tha,function(t){function e(){var t=this;t._text="",t._fontName="",t._fontSize="",t._left=0,t._top=0,t._right=0,t._bottom=0}e.prototype.GetText=function(){return this._text},e.prototype.GetFontName=function(){return this._fontName},e.prototype.GetFontSize=function(){return this._fontSize},e.prototype.GetWordRect=function(){var t=this;return t._left+","+t._top+","+t._right+","+t._bottom},t.NewWordBasicResult=function(){return new e}}(Dynamsoft.Lib),function(t){function e(){var t=this;t._count=0,t._left=0,t._top=0,t._right=0,t._bottom=0,t._wordlist=[]}e.prototype.GetWordCount=function(){return this._count},e.prototype.GetLineRect=function(){var t=this;return t._left+","+t._top+","+t._right+","+t._bottom},e.prototype.GetWordContent=function(t){var e=this,n=e._wordlist.length;return e._errorCode<0?"":null==t||n<=t||t<0?(Dynamsoft.Lib.Errors.OCR_InvalidIndex(e,"GetWordContent"),""):((n=Dynamsoft.Lib.NewWordBasicResult())._text=e._wordlist[t].text,n._fontName=e._wordlist[t].fontname,n._fontSize=e._wordlist[t].fontsize,n._left=e._wordlist[t].rect[0],n._top=e._wordlist[t].rect[1],n._right=e._wordlist[t].rect[2],n._bottom=e._wordlist[t].rect[3],n)},t.NewLineBasicResult=function(){return new e}}(Dynamsoft.Lib),function(t){function e(){this._count=0,this._linelist=[]}e.prototype.GetLineCount=function(){return this._count},e.prototype.GetLineContent=function(t){var e=this,n=e._linelist.length;return e._errorCode<0?"":null==t||n<=t||t<0?(Dynamsoft.Lib.Errors.OCR_InvalidIndex(e,"GetLineContent"),""):((n=Dynamsoft.Lib.NewLineBasicResult())._count=e._linelist[t].words.length,n._left=e._linelist[t].rect[0],n._top=e._linelist[t].rect[1],n._right=e._linelist[t].rect[2],n._bottom=e._linelist[t].rect[3],n._wordlist=e._linelist[t].words,n)},t.NewPageBasicResult=function(){return new e}}(Dynamsoft.Lib),function(t){function e(){this._count=0,this._pagelist=[]}e.prototype.GetPageCount=function(){return this._count},e.prototype.GetPageContent=function(t){var e=this,n=e._pagelist.length;return e._errorCode<0?"":null==t||n<=t||t<0?(Dynamsoft.Lib.Errors.OCR_InvalidIndex(e,"GetPageContent"),""):((n=Dynamsoft.Lib.NewPageBasicResult())._count=e._pagelist[t].lines.length,n._linelist=e._pagelist[t].lines,n)},t.NewPageSetBasicResult=function(){return new e}}(Dynamsoft.Lib),function(e){function n(t){var e=this;e._errorCode=0,e._errorString="",e._resultlist=[],e._stwain=t}n.prototype.GetErrorCode=function(){return this._errorCode},n.prototype.GetErrorString=function(){return this._errorString},n.prototype.GetFormat=function(){return this._resultlist[0].format},n.prototype.GetInput=function(){var t=this._resultlist[0].input;if(t){var e=Number(t);if(!isNaN(e))return this._stwain._ImgManager.convertServerIdToClientIndex(e)}return t},n.prototype.GetPageSetCount=function(){return this._resultlist[0].pagesets.length},n.prototype.GetPageSetContent=function(t){var e=this,n=e._resultlist[0].pagesets.length;return e._errorCode<0?"":null==t||n<=t||t<0?(Dynamsoft.Lib.Errors.OCR_InvalidIndex(e,"GetPageSetContent"),""):((n=Dynamsoft.Lib.NewPageSetBasicResult())._count=e._resultlist[0].pagesets[t].pages.length,n._pagelist=e._resultlist[0].pagesets[t].pages,n)},n.prototype.Get=function(){return this._stwain._innerFun("GetOCRRestult")},n.prototype.Save=function(t){t=e.html5.Funs.replaceLocalFilename(t);return this._stwain._innerFun("SaveOCRRestult",e.html5.Funs.makeParams(t))},e.NewOCRBasicResult=function(t){return new n(t)}}(Dynamsoft.Lib),function(e){function t(){var t=this;t.UnicodeFontName="",t.UseDetectedFont=!0,t.MinFontSizeforMoreAccurateResult=0,t.OCRLanguage=Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_ENG,t.PageSetMode=Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_AUTO,t.OutputFormat=Dynamsoft.DWT.EnumDWT_OCROutputFormat.OCROF_PDFIMAGEOVERTEXT}t.prototype.GetUnicodeFontName=function(){return this.UnicodeFontName},t.prototype.SetUnicodeFontName=function(t){return e.isString(t)||(t=""),this.UnicodeFontName=t,!0},t.prototype.GetUseDetectedFont=function(){return!!this.UseDetectedFont},t.prototype.SetUseDetectedFont=function(t){return this.UseDetectedFont=!!t,!0},t.prototype.GetMinFontSizeforMoreAccurateResult=function(){return this.MinFontSizeforMoreAccurateResult},t.prototype.SetMinFontSizeforMoreAccurateResult=function(t){t=+t;return this.MinFontSizeforMoreAccurateResult=t=t<0?0:t,!0},t.prototype.GetOCRLanguage=function(){return this.OCRLanguage},t.prototype.SetOCRLanguage=function(t){return e.isString(t)||(t=""),this.OCRLanguage=t,!0},t.prototype.GetPageSetMode=function(){return this.PageSetMode},t.prototype.SetPageSetMode=function(t){t=+t;return(t<0||t>Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_SINGLE_CHAR)&&(t=Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_AUTO),this.PageSetMode=t,!0},t.prototype.GetOutputFormat=function(){return this.OutputFormat},t.prototype.SetOutputFormat=function(t){t=+t;return(t<0||t>Dynamsoft.DWT.EnumDWT_OCROutputFormat.OCROF_PDFIMAGEOVERTEXT_PDFX)&&(t=Dynamsoft.DWT.EnumDWT_OCROutputFormat.OCROF_PDFIMAGEOVERTEXT),this.OutputFormat=t,!0},e.NewOptions=function(){return new t}}(Dynamsoft.Lib),Dynamsoft.AddonReady(function(C,t){var g;C.product.bHTML5Edition&&C.DynamicLoadAddonFuns&&C.DynamicLoadAddonFuns.push(function(i){var t,O,m,_=C.html5.Funs,R=C.NewOptions();O=i,m=C.html5.Funs,g=C.env.bMac?"DynamicOCR_"+Dynamsoft.DWT.OCRVerInName+".dylib":C.env.bLinux?"DynamicOCR_"+Dynamsoft.DWT.OCRVerInName+".so":Dynamsoft.dcp.b64bit?"DynamicOCRx64_"+Dynamsoft.DWT.OCRVerInName+".dll":"DynamicOCR_"+Dynamsoft.DWT.OCRVerInName+".dll",O._isMobileMode()||O._innerSend("GetAddOnVersion",m.makeParams("ocr",g),!0,!1,!1),O.__innerOCRBasicReadFunction=function(t,e,n,a,o,r,u,D,s,i,_){return C.isFunction(i)?this.__innerOCRBasicAsyncReadFunction(t,e,n,a,o,r,u,D,s,i,_):this.__innerOCRSyncReadFunction(t,s)},O.__innerGetOCRBasicResultAsyncFunction=function(t){var e=Dynamsoft.Lib.NewOCRBasicResult(this);return t&&(e._errorCode=t.exception,e._errorString=t.description,e._resultlist=t.result),e},O.__innerOCRBasicAsyncReadFunction=function(n,a,o,r,u,D,s,i,t,_,R){var g=this;return m.showMask(n),g._innerSend(n,t,!0,function(t){var e;0==t.exception?(C.isFunction(_)&&(-1!=a?(e=g._convertServerIdToGuid(a),1==r?_(e,u,D,s,i,g.__innerGetOCRBasicResultAsyncFunction(t)):_(e,g.__innerGetOCRBasicResultAsyncFunction(t))):""!=o?_(o,g.__innerGetOCRBasicResultAsyncFunction(t)):_(g.__innerGetOCRBasicResultAsyncFunction(t))),C.License.isLTS()&&Dynamsoft.DWT.lcvrf(O)):C.isFunction(R)&&R(t.exception,t.description),m.hideMask(n)},function(t){m.hideMask(n)}),!0},O.__innerOCRSyncReadFunction=function(t,e){t=this._innerFunRaw(t,e,!1,!1),e=C.NewOCRBasicResult();return e._errorCode=this._errorCode,e._errorString=this._errorString,t&&C.isArray(t)&&(e._resultlist=t,e._Count=t.length,C.License.isLTS())&&Dynamsoft.DWT.lcvrf(O),e},O.__IsOCRBasicModuleInstalled=function(){return""!=O._innerFun("GetAddOnVersion",m.makeParams("ocr",g)).split("|")[0]},O.__innerBasicDownload=function(t,n,e,a,o){function r(){return D.IfShowProgressBar&&C.closeProgress(null,"Download"),C.isFunction(a)&&a(),!0}function u(){return D.IfShowProgressBar&&C.closeProgress(null,"Download"),C.isFunction(o)&&o(D.ErrorCode,D.ErrorString),!1}var D=O;C.cancelFrome=2,t=t.toString();if(!C.License.checkProductKey(D,{Core:!0}))return u();if(!C.License.checkProductKey(D,{OCR:!0},!0))return u();n!=Dynamsoft.DWT.EnumDWT_OCRDownloadType.OCRDT_Dll&&D._innerFun("SetOCRLanguage",m.makeParams(e));var s=D._innerFun("GetAddOnVersion",m.makeParams("ocr",g)).split("|");if(n==Dynamsoft.DWT.EnumDWT_OCRDownloadType.OCRDT_Dll){if(""!=s[0])return r(),!0}else{e=Dynamsoft.DWT.OCRLanguageData[e];if(e&&s[1]==e)return r(),!0}if(!t||""==t)return C.Errors.OCR_InvalidRemoteFilename(D),u(),!1;if(m.isServerInvalid(D))return u(),!1;D.IfShowProgressBar&&C.showProgress(D,"Download",!0);var i=!0;n==Dynamsoft.DWT.EnumDWT_OCRDownloadType.OCRDT_Dll?D._OnPercentDone([0,-1,"Downloading OCR Module...","http"]):D._OnPercentDone([0,-1,"Downloading OCR Language Data...","http"]),C.isFunction(a)||(i=!1),m.loadHttpBlob(D,"get",t,i,function(t){D._OnPercentDone([0,-1,"Loading..."]);var e=100;n==Dynamsoft.DWT.EnumDWT_OCRDownloadType.OCRDT_LANGUAGE&&(e=101),D.__LoadImageFromBytes(t,e,"",i,r,u)},function(){D.IfShowProgressBar&&C.closeProgress(null,"Download"),u()},function(t){var e=0===t.total?100:Math.round(100*t.loaded/t.total);[t.loaded," / ",t.total].join("");D._OnPercentDone([0,e,"","http"])})},t={OCR:{SetUnicodeFontName:function(t){var e=i;return e._resetErr(),e._isMobileMode()?e._mobileNotSupport("Addon.OCR.SetUnicodeFontName"):R.SetUnicodeFontName(t)},GetUnicodeFontName:function(){var t=i;return t._resetErr(),t._isMobileMode()?t._mobileNotSupport("Addon.OCR.GetUnicodeFontName"):R.GetUnicodeFontName()},SetIfUseDetectedFont:function(t){var e=i;return e._resetErr(),e._isMobileMode()?e._mobileNotSupport("Addon.OCR.SetIfUseDetectedFont"):R.SetUseDetectedFont(t)},GetIfUseDetectedFont:function(){var t=i;return t._resetErr(),t._isMobileMode()?t._mobileNotSupport("Addon.OCR.GetIfUseDetectedFont"):R.GetUseDetectedFont()},SetMinFontSizeforMoreAccurateResult:function(t){var e=i;return e._resetErr(),e._isMobileMode()?e._mobileNotSupport("Addon.OCR.SetMinFontSizeforMoreAccurateResult"):R.SetMinFontSizeforMoreAccurateResult(t)},GetMinFontSizeforMoreAccurateResult:function(){var t=i;return t._resetErr(),t._isMobileMode()?t._mobileNotSupport("Addon.OCR.GetMinFontSizeforMoreAccurateResult"):R.GetMinFontSizeforMoreAccurateResult()},SetLanguage:function(t){var e=i;return e._resetErr(),e._isMobileMode()?e._mobileNotSupport("Addon.OCR.SetLanguage"):R.SetOCRLanguage(t)},IsModuleInstalled:function(){var t=i;return t._resetErr(),t._isMobileMode()?t._mobileNotSupport("Addon.OCR.IsModuleInstalled"):t.__IsOCRBasicModuleInstalled()},SetPageSetMode:function(t){var e=i;return e._resetErr(),e._isMobileMode()?e._mobileNotSupport("Addon.OCR.SetPageSetMode"):(t=+t)==Dynamsoft.DWT.EnumDWT_OCRPageSetMode.OCRPSM_OSD_ONLY||t==Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_AUTO_OSD||t==Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_AUTO_ONLY||t==Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_AUTO||t==Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_SINGLE_COLUMN||t==Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_SINGLE_BLOCK_VERT_TEXT||t==Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_SINGLE_BLOCK||t==Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_SINGLE_LINE||t==Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_SINGLE_WORD||t==Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_CIRCLE_WORD||t==Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_SINGLE_CHAR?R.SetPageSetMode(t):(Dynamsoft.Lib.Errors.OCR_InvalidPageSetMode(e),!1)},SetOutputFormat:function(t){var e=i;return e._resetErr(),e._isMobileMode()?e._mobileNotSupport("Addon.OCR.SetOutputFormat"):(t=+t)==Dynamsoft.DWT.EnumDWT_OCROutputFormat.OCROF_TEXT||t==Dynamsoft.DWT.EnumDWT_OCROutputFormat.OCROF_PDFPLAINTEXT||t==Dynamsoft.DWT.EnumDWT_OCROutputFormat.OCROF_PDFIMAGEOVERTEXT||t==Dynamsoft.DWT.EnumDWT_OCROutputFormat.OCROF_PDFPLAINTEXT_PDFX||t==Dynamsoft.DWT.EnumDWT_OCROutputFormat.OCROF_PDFIMAGEOVERTEXT_PDFX?R.SetOutputFormat(t):(Dynamsoft.Lib.Errors.OCR_InvalidOutputFormat(e),!1)},Recognize:function(t,e,n){var a=i;return a._resetErr(),a._isMobileMode()?a._mobileNotSupport("Addon.OCR.Recognize"):C.License.checkProductKey(a,{OCR:!0},!0)?(t=a._ImgManager.convertClientIndexToServerId(t),a.__innerOCRBasicReadFunction("OCRRecognize",t,"",0,0,0,0,0,_.makeParams(0,t,"",0,0,0,0,R.GetUnicodeFontName(),R.GetUseDetectedFont(),R.GetMinFontSizeforMoreAccurateResult(),R.GetOCRLanguage(),R.GetPageSetMode(),R.GetOutputFormat(),""),e,n)):(C.isFunction(n)&&n(a._errorCode,a._errorString),!1)},RecognizeRect:function(t,e,n,a,o,r,u){var D,s=i;return s._resetErr(),s._isMobileMode()?s._mobileNotSupport("Addon.OCR.RecognizeRect"):!e&&0!=e||!n&&0!=n||!a&&0!=a||!o&&0!=o?(D=Dynamsoft.Lib.NewOCRBasicResult(s),Dynamsoft.Lib.Errors.OCR_InvalidLeftOrTopOrRightOrBottom(D,"RecognizeRect"),void u(D.GetErrorCode(),D.GetErrorString())):C.License.checkProductKey(s,{OCR:!0},!0)?(D=s._ImgManager.convertClientIndexToServerId(t),s.__innerOCRBasicReadFunction("OCRRecognize",D,"",1,e,n,a,o,_.makeParams(0,D,"",e,n,a,o,R.GetUnicodeFontName(),R.GetUseDetectedFont(),R.GetMinFontSizeforMoreAccurateResult(),R.GetOCRLanguage(),R.GetPageSetMode(),R.GetOutputFormat(),""),r,u)):(C.isFunction(u)&&u(s._errorCode,s._errorString),!1)},RecognizeFile:function(t,e,n){var a=i;return a._resetErr(),a._isMobileMode()?a._mobileNotSupport("Addon.OCR.RecognizeFile"):(t=_.replaceLocalFilename(t),C.License.checkProductKey(a,{OCR:!0},!0)?a.__innerOCRBasicReadFunction("OCRRecognize",-1,t,0,0,0,0,0,_.makeParams(1,-1,t,0,0,0,0,R.GetUnicodeFontName(),R.GetUseDetectedFont(),R.GetMinFontSizeforMoreAccurateResult(),R.GetOCRLanguage(),R.GetPageSetMode(),R.GetOutputFormat(),""),e,n):(C.isFunction(n)&&n(a._errorCode,a._errorString),!1))},RecognizeSelectedImages:function(t,e){var n,a,o,r=i;return r._resetErr(),r._isMobileMode()?r._mobileNotSupport("Addon.OCR.RecognizeSelectedImages"):C.License.checkProductKey(r,{OCR:!0},!0)?(o=[],(n=r)._ImgManager.count()<=0||(a=n._ImgManager.getCurrentImageIndex(),n._ImgManager.convertClientIndexToServerId(a),a=n._ImgManager.getSelectedClientIndexArray(),C.isArray(a)&&C.each(a,function(t){t=n._ImgManager.convertClientIndexToServerId(t);o.push(t)})),a=o,r.__innerOCRBasicReadFunction("OCRRecognize",-1,"",0,0,0,0,0,_.makeParams(2,-1,"",0,0,0,0,R.GetUnicodeFontName(),R.GetUseDetectedFont(),R.GetMinFontSizeforMoreAccurateResult(),R.GetOCRLanguage(),R.GetPageSetMode(),R.GetOutputFormat(),a.join(",")),t,e)):(C.isFunction(e)&&e(r._errorCode,r._errorString),!1)},Download:function(t,e,n){var a=i;return a._resetErr(),a._isMobileMode()?a._mobileNotSupport("Addon.OCR.Download"):a.__innerBasicDownload(t,Dynamsoft.DWT.EnumDWT_OCRDownloadType.OCRDT_Dll,R.GetOCRLanguage(),e,n)},DownloadLangData:function(t,e,n){var a=i;return a._resetErr(),a._isMobileMode()?a._mobileNotSupport("Addon.OCR.DownloadLangData"):a.__innerBasicDownload(t,Dynamsoft.DWT.EnumDWT_OCRDownloadType.OCRDT_LANGUAGE,R.GetOCRLanguage(),e,n)}}},i.__addon=i.__addon||{},C.mix(i.__addon,t)})}); 
/*! 20220215
* Dynamsoft JavaScript Library
* Product: Dynamsoft Web Twain
* Web Site: https://www.dynamsoft.com
*
* Copyright 2022, Dynamsoft Corporation 
* Author: Dynamsoft R&D Department
*
* Version: 17.2.1
* 
* Module: addon/ocrpro
* final js: build\addon\dynamsoft.webtwain.addon.ocrpro.js
*/
;var Dynamsoft=self.Dynamsoft||{};Dynamsoft.DWT=Dynamsoft.DWT||{};Dynamsoft.aryAddonReadyFun=Dynamsoft.aryAddonReadyFun||[];Dynamsoft.AddonReady=Dynamsoft.AddonReady||function(a){Dynamsoft.aryAddonReadyFun.push(a)};Dynamsoft.ProOCRVerInName="1.2.0.0806";(function(b){function a(){var c=this;c._text="";c._left=0;c._top=0;c._right=0;c._bottom=0}a.prototype.GetText=function(){var c=this;return c._text};a.prototype.GetLetterRect=function(){var c=this;return c._left+","+c._top+","+c._right+","+c._bottom};b.NewLetterResult=function(){return new a()}})(Dynamsoft.Lib);(function(b){function a(){var c=this;c._count=0;c._letterlist=[];c._zoneCount=0;c._zoneWords=[]}a.prototype.GetLettersCount=function(){var c=this;return c._count};a.prototype.GetZoneCount=function(){var c=this;return c._zoneCount};a.prototype.GetLetterContent=function(d){var f=this,c=f._count;if(f._errorCode<0){return""}if(d==null||d>=c||d<0){Dynamsoft.Lib.Errors.OCR_InvalidIndex(f,"GetLetterContent");return""}var e=Dynamsoft.Lib.NewLetterResult();e._text=f._letterlist[d].letter;e._left=f._letterlist[d].boundary[0];e._top=f._letterlist[d].boundary[1];e._right=f._letterlist[d].boundary[2];e._bottom=f._letterlist[d].boundary[3];return e};a.prototype.GetZoneContent=function(d){var e=this,c=e._zoneCount;if(e._errorCode<0){return""}if(d==null||d>=c||d<0){Dynamsoft.Lib.Errors.OCR_InvalidIndex(e,"GetZoneContent");return""}return e._zoneWords[d]};b.NewPageResult=function(){return new a()}})(Dynamsoft.Lib);(function(a){function b(){var c=this;c._input=0;c._message="";c._page=-1}b.prototype.GetInput=function(){var c=this;return c._input};b.prototype.GetMessage=function(){var c=this;return c._message};b.prototype.GetPage=function(){var c=this;return c._page};a.NewErrorInfo=function(){return new b()}})(Dynamsoft.Lib);(function(a){function b(c){var d=this;d._errorCode=0;d._errorString="";d._errorlist=[];d._request="";d._ocrTotalCount=0;d._alreadyOCRCount=0;d._resultlist=[];d._resultZoneDetail=[];d._stwain=c}b.prototype.GetErrorCode=function(){var c=this;return c._errorCode};b.prototype.GetErrorString=function(){var c=this;return c._errorString};b.prototype.GetInput=function(){var e=this;if(e._request&&e._request.input){var d=e._request.input;if(d){var c=Number(d);if(!isNaN(c)){return e._stwain._ImgManager.convertServerIdToClientIndex(c)}}return d}else{return""}};b.prototype.GetErrorDetailList=function(){var g=this,c=0;if(g._errorlist){c=g._errorlist.length}var e=[];for(var d=0;d<c;d++){var f=Dynamsoft.Lib.NewErrorInfo();f._input=g._errorlist[d].input;f._message=g._errorlist[d].message;f._page=g._errorlist[d].page;e.push(f)}return e};b.prototype.GetOCRTotalCount=function(){var c=this;if(c._ocrTotalCount){return c._ocrTotalCount}else{return 0}};b.prototype.GetAlreadyOCRCount=function(){var c=this;if(c._alreadyOCRCount){return c._alreadyOCRCount}else{return 0}};b.prototype.GetPageCount=function(){var c=this;if(c._resultlist&&c._resultlist.length){return c._resultlist.length}else{return 0}};b.prototype.GetPageContent=function(d){var f=this,c=0;if(f._resultlist){c=f._resultlist.length}if(d==null||d>=c||d<0){Dynamsoft.Lib.Errors.OCR_InvalidIndex(f,"GetPageContent");return""}var e=Dynamsoft.Lib.NewPageResult();if(f._resultlist){e._count=f._resultlist[d].length;e._letterlist=f._resultlist[d]}else{e._count=0}if(f._resultZoneDetail){e._zoneCount=f._resultZoneDetail[d].length;e._zoneWords=f._resultZoneDetail[d]}else{e._zoneCount=0}return e};b.prototype.Get=function(){var c=this;return c._stwain._innerFun("GetOCRRestult")};b.prototype.Save=function(c){var e=this,d=a.html5.Funs.replaceLocalFilename(c);return e._stwain._innerFun("SaveOCRRestult",a.html5.Funs.makeParams(d))};a.NewOCRProResult=function(c){return new b(c)}})(Dynamsoft.Lib);(function(c){var d=[Dynamsoft.DWT],b=0;for(;b<1;b++){var a=d[b];a.EnumDWT_OCRProRecognitionModule={OCRPM_AUTO:"AUTO",OCRPM_MOSTACCURATE:"MOSTACCURATE",OCRPM_BALANCED:"BALANCED",OCRPM_FASTEST:"FASTEST"};a.EnumDWT_OCRProOutputFormat={OCRPFT_TXTS:"TXTS",OCRPFT_TXTCSV:"TXTCSV",OCRPFT_TXTF:"TXTF",OCRPFT_XML:"XML",OCRPFT_IOTPDF:"IOTPDF",OCRPFT_IOTPDF_MRC:"IOTPDF_MRC"};a.EnumDWT_OCRProPDFVersion={OCRPPDFV_0:"1.0",OCRPPDFV_1:"1.1",OCRPPDFV_2:"1.2",OCRPPDFV_3:"1.3",OCRPPDFV_4:"1.4",OCRPPDFV_5:"1.5",OCRPPDFV_6:"1.6",OCRPPDFV_7:"1.7"};a.EnumDWT_OCRProPDFAVersion={OCRPPDFAV_1A:"pdf/a-1a",OCRPPDFAV_1B:"pdf/a-1b",OCRPPDFAV_2A:"pdf/a-2a",OCRPPDFAV_2B:"pdf/a-2b",OCRPPDFAV_2U:"pdf/a-2u",OCRPPDFAV_3A:"pdf/a-3a",OCRPPDFAV_3B:"pdf/a-3b",OCRPPDFAV_3U:"pdf/a-3u"};a.EnumDWT_OCRProType={OCRDT_File:0,OCRDT_Index:1};a.EnumDWT_OCRFindTextFlags={OCRFT_WHOLEWORD:1,OCRFT_MATCHCASE:2,OCRFT_FUZZYMATCH:4};a.EnumDWT_OCRFindTextAction={OCRFT_HIGHLIGHT:0,OCRFT_STRIKEOUT:1,OCRFT_MARKFORREDACT:2}}})(typeof window!=="undefined"?window:this);(function(a){function b(){var c=this;c.FindText="";c.FindTextFlags=Dynamsoft.DWT.EnumDWT_OCRFindTextFlags.OCRFT_WHOLEWORD;c.FindTextAction=Dynamsoft.DWT.EnumDWT_OCRFindTextAction.OCRFT_MARKFORREDACT}a.NewRedaction=function(){return new b()}})(Dynamsoft.Lib);Dynamsoft.WebTwain={Addon:{OCRPro:{}}};(function(a){function b(){var c=this;c.RecognitionModule="";c.Languages="eng";c.OutputFormat="";c.PDFVersion="";c.PDFAVersion="";c.LicenseChecker="";c.Redaction=Dynamsoft.Lib.NewRedaction()}a.NewSettings=function(){return new b()}})(Dynamsoft.WebTwain.Addon.OCRPro);(function(){function a(f,e,c,b){var d=this;d.left=f;d.top=e;d.right=c;d.bottom=b}Dynamsoft.WebTwain.Addon.OCRPro.NewOCRZone=function(e,d,c,b){return new a(e,d,c,b)}})();Dynamsoft.AddonReady(function(m,h){if(!m.product.bHTML5Edition){return}var n=1000,q=function(){return n++};function o(y){var z=m.html5.Funs;y.__innerGetOCRProResultAsyncFunction=function(B){var A=Dynamsoft.Lib.NewOCRProResult(this);if(B){A._errorCode=B.code;A._errorString=B.message;A._request=B.request;A._errorlist=B.errorList;A._ocrTotalCount=B.ocrTotalCount;A._alreadyOCRCount=B.alreadyOCRCount;A._resultlist=B.resultDetail;A._resultZoneDetail=B.resultZoneDetail}return A};y.__innerIsOCRTrial=function(A,B){var D=this,C=function(){var F=false;if(D.__licenseInfo.Detail){for(var E=0;E<D.__licenseInfo.Detail.length;E++){if(D.__licenseInfo.Detail[E].EnumLicenseType=="10"){if(D.__licenseInfo.Detail[E].Trial=="TRUE"){F=true}}}}return A(F)};if(D.__licenseInfo&&D.__licenseInfo.Detail){return C()}else{return D.GetLicenseInfo(C,B)}};y.__innerOCRReadFunction=function(D,I,E,H,A,B,G,C){var F=this;return F.__innerOCRAsyncReadFunction(D,I,E,H,A,B,G,C)};y.__innerOCRAsyncReadFunction=function(D,K,E,I,A,B,H,C){var G=this;var F=function(L){if(L.code==0){if(m.isFunction(H)){if(K!=-1){if(I==1){H(K,A,G.__innerGetOCRProResultAsyncFunction(L))}else{H(K,G.__innerGetOCRProResultAsyncFunction(L))}}else{if(E!=""){H(E,G.__innerGetOCRProResultAsyncFunction(L))}else{H(G.__innerGetOCRProResultAsyncFunction(L))}}}if(m.License.isLTS()){Dynamsoft.DWT.lcvrf(y)}}else{if(m.isFunction(C)){C(L.code,L.message,G.__innerGetOCRProResultAsyncFunction(L))}}z.hideMask(D)},J=function(L){z.hideMask(D)};z.showMask(D);G._innerSend(D,B,true,F,J);return true};y.__innerGetRequestJson=function(G,I,A,K,B){var F=y,C;var E="[{";E+='"id":"'+y.clientId+'",';E+='"method":"OCRProRecognize",';E+='"dllName":"'+B+'",';E+='"productkey":"'+Dynamsoft.DWT.ProductKey+'",';if(G==Dynamsoft.DWT.EnumDWT_OCRProType.OCRDT_File){E+='"inputType":"file",'}else{E+='"inputType":"index",'}E+='"input":[';for(C=0;C<I.length;C++){if(G==Dynamsoft.DWT.EnumDWT_OCRProType.OCRDT_File){E+='"'+I[C]+'"'}else{E+=I[C]}if(C+1<I.length){E+="|"}}E+="],";E+='"settings":{';E+='"recognitionMethod": "Page"';if(A){if(A.RecognitionModule&&A.RecognitionModule.length>0){E+=',"recognitionModule":"'+A.RecognitionModule+'"'}if(A.Languages&&A.Languages.length>0){E+=',"languages":"'+A.Languages+'"'}if(A.OutputFormat&&A.OutputFormat.length>0){E+=',"outputFormat":"'+A.OutputFormat+'"'}if(A.PDFVersion&&A.PDFVersion.length>0){E+=',"pdfVersion":"'+A.PDFVersion+'"'}if(A.PDFAVersion&&A.PDFAVersion.length>0){E+=',"pdfAVersion":"'+A.PDFAVersion+'"'}if(A.Redaction&&A.Redaction.FindText&&A.Redaction.FindText.length>0){var J=parseInt(A.Redaction.FindTextFlags),H=parseInt(A.Redaction.FindTextAction);if(!isNaN(J)&&!isNaN(H)){E+=',"redaction":{';var D=A.Redaction.FindText;D=D.replace(/\"/g,'\\"');E+='"findText":"'+D+'"';E+=',"findTextFlags":'+J;E+=',"findTextAction":'+H;E+="}"}}}E+="},";E+='"zones":[';for(C=0;C<K.length;C++){E+="["+K[C].left+","+K[C].top+","+K[C].right+","+K[C].bottom+"]";if(C+1<K.length){E+=","}}E+="],";E+='"outputFile":""';E+="}]";return E};y.__LoadImageFromBytesForDownloadInner=function(E,K,O,J,L,B,H,M,D){var I=y;var A,C,G;if(E>=J){A=B*J;G=K.slice(A,L)}else{A=E*B;C=(E+1)*B;G=K.slice(A,C)}var N=function(){if(Dynamsoft.Lib.isFunction(D)){D()}};var F=function(){if(E>=J){if(Dynamsoft.Lib.isFunction(M)){M()}return}E=E+1;I.__LoadImageFromBytesForDownloadInner(E,K,O,J,L,B,H,M,D)};I.__LoadImageFromBytes(G,O,"",H,F,N,A,L)};y.__LoadImageFromBytesForDownload=function(H,B,G,D,C,J){var F=y;var A=2*1000*1000;var I=H.size||H.length;var E=parseInt(I/A);var K=I%A;if(K==0){E=E-1}F.__LoadImageFromBytesForDownloadInner(0,H,B,E,I,A,D,C,J)}}var e=function(B){var C=[],z,y,A;if(B._ImgManager.count()<=0){return C}y=B._ImgManager.getCurrentImageIndex();z=B._ImgManager.convertClientIndexToServerId(y);A=B._ImgManager.getSelectedClientIndexArray();if(m.isArray(A)){m.each(A,function(D){var E=B._ImgManager.convertClientIndexToServerId(D);C.push(E)})}return C},v=function(C,A,z,B){var y=m.NewOCRProResult(C);y._errorCode=A;y._errorString=z;var D=m.NewErrorInfo();D.input=B;D.message=y._errorString;D.page=0;y._errorlist=[D];return y},g=function(A){var B=m.html5.Funs,z,y;if(m.env.bMac){y="DynamicOCRPro_"+Dynamsoft.ProOCRVerInName+".dylib"}else{if(m.env.bLinux){y="DynamicOCRPro_"+Dynamsoft.ProOCRVerInName+".so"}else{if(Dynamsoft.dcp.b64bit){y="DynamicOCRProx64_"+Dynamsoft.ProOCRVerInName+".dll"}else{y="DynamicOCRPro_"+Dynamsoft.ProOCRVerInName+".dll"}}}o(A);z={OCRPro:{Settings:false,Recognize:function(N,K,D){var J=[],H,O,L,I;var G=A;G._resetErr();if(G._isMobileMode()){return G._mobileNotSupport("Addon.OCRPro.Recognize")}H=parseInt(N);if(m.isNaN(H)||!m.isNumber(H)){O=v(A,-2201,"Invalid parameter type.",N);if(m.isFunction(D)){D(O._errorCode,O._errorString,O)}else{m.Errors.WebviewerError(A,O._errorString,O._errorCode)}return false}var F=A._ImgManager.convertClientIndexToServerId(H);if(F==-1){if(m.isFunction(D)){m.Errors.IndexOutOfRange(A);O=v(A,A._errorCode,A._errorString,N);D(O._errorCode,O._errorString,O)}return false}if(!m.License.checkProductKey(A,{OCRPro:true},true)){if(m.isFunction(D)){O=v(A,A._errorCode,A._errorString,N);D(O._errorCode,O._errorString,O)}return false}J.push(F);var M=[],C=this.Settings;var E=A.__innerGetRequestJson(Dynamsoft.DWT.EnumDWT_OCRProType.OCRDT_Index,J,C,M,y);return A.__innerIsOCRTrial(function(P){if(P||m.License.isLTS()){return A.__innerOCRReadFunction("OCRProRecognize",N,"",0,M,E,K,D)}else{return w(C.LicenseChecker,A,"OCRProRecognize",N,"",0,M,E,K,D)}},D)},RecognizeRect:function(X,P,R,G){var N=[],K,M,F,L;var S=A;S._resetErr();if(S._isMobileMode()){return S._mobileNotSupport("Addon.OCRPro.RecognizeRect")}K=parseInt(X);if(m.isNaN(K)||!m.isNumber(K)){M=v(A,-2201,"Invalid parameter type.",X);if(m.isFunction(G)){G(M._errorCode,M._errorString,M)}else{m.Errors.WebviewerError(A,M._errorString,M._errorCode)}return false}var Q=A._ImgManager.convertClientIndexToServerId(K),T=A._ImgManager.GetImageWidth(K),J=A.GetImageHeight(K);if(Q==-1){if(m.isFunction(G)){m.Errors.IndexOutOfRange(A);M=v(A,A._errorCode,A._errorString,X);G(M._errorCode,M._errorString,M)}return false}if(!m.License.checkProductKey(A,{OCRPro:true},true)){if(m.isFunction(G)){M=v(A,A._errorCode,A._errorString,X);G(M._errorCode,M._errorString,M)}return false}if(T>0&&J>0){var V,E,U,W,I,D;for(var O=0;O<P.length;O++){V=P[O];E=V.left;U=V.top;W=V.right;I=V.bottom;if(E<0){E=0}if(U<0){U=0}if(W<0){W=0}if(I<0){I=0}if(E>W){D=E;E=W;W=D}if(U>I){D=U;U=I;I=D}if(W>T){W=T}if(I>J){I=J}V.left=E;V.top=U;V.right=W;V.bottom=I}}N.push(Q);var C=this.Settings;var H=A.__innerGetRequestJson(Dynamsoft.DWT.EnumDWT_OCRProType.OCRDT_Index,N,C,P,y);return A.__innerIsOCRTrial(function(Y){if(Y||m.License.isLTS()){return A.__innerOCRReadFunction("OCRProRecognize",X,"",1,P,H,R,G)}else{return w(C.LicenseChecker,A,"OCRProRecognize",X,"",1,P,H,R,G)}},G)},RecognizeFile:function(D,M,G){var I=A;I._resetErr();if(I._isMobileMode()){return I._mobileNotSupport("Addon.OCRPro.RecognizeFile")}var P,N,K;if(D.length==0){if(m.isFunction(G)){P=Dynamsoft.Lib.NewOCRProResult(A);P._errorCode=-2201;P._errorString="File name cannot be empty.";K=[];N=Dynamsoft.Lib.NewErrorInfo();N.input=D;N.message=P._errorString;N.page=0;K.push(N);P._errorlist=K;G(P._errorCode,P._errorString,P)}return false}if(!m.License.checkProductKey(A,{OCRPro:true},true)){if(m.isFunction(G)){P=Dynamsoft.Lib.NewOCRProResult(A);P._errorCode=A._errorCode;P._errorString=A._errorString;K=[];N=Dynamsoft.Lib.NewErrorInfo();N.input=D;N.message=P._errorString;N.page=0;K.push(N);P._errorlist=K;G(P._errorCode,P._errorString,P)}return false}var J=B.replaceLocalFilename(D);var C=[];if(J.indexOf("|")>0){C=J.split("|")}else{if(J.indexOf(";")>0){C=J.split(";")}else{if(J.indexOf(",")>0){C=J.split(",")}}}var L=[];if(C.length>0){for(var F=0;F<C.length;F++){L.push(C[F])}}else{L.push(J)}var O=[],E=this.Settings;var H=A.__innerGetRequestJson(Dynamsoft.DWT.EnumDWT_OCRProType.OCRDT_File,L,E,O,y);A.__innerIsOCRTrial(function(Q){if(Q||m.License.isLTS()){return A.__innerOCRReadFunction("OCRProRecognize",-1,D,0,O,H,M,G)}else{return w(E.LicenseChecker,A,"OCRProRecognize",-1,D,0,O,H,M,G)}},G)},RecognizeSelectedImages:function(J,D){var G,H,K;var F=A;F._resetErr();if(F._isMobileMode()){return F._mobileNotSupport("Addon.OCRPro.RecognizeSelectedImages")}if(!m.License.checkProductKey(A,{OCRPro:true},true)){if(m.isFunction(D)){var M=Dynamsoft.Lib.NewOCRProResult(A);M._errorCode=A._errorCode;M._errorString=A._errorString;H=[];K=Dynamsoft.Lib.NewErrorInfo();K.input="";K.message=M._errorString;K.page=0;H.push(K);M._errorlist=H;D(M._errorCode,M._errorString,M)}return false}var L=[],C=this.Settings,I=e(A),E=A.__innerGetRequestJson(Dynamsoft.DWT.EnumDWT_OCRProType.OCRDT_Index,I,C,L,y);A.__innerIsOCRTrial(function(N){if(N||m.License.isLTS()){G=A.__innerOCRReadFunction("OCRProRecognize",-1,"",0,L,E,J,D)}else{G=w(C.LicenseChecker,A,"OCRProRecognize",-1,"",0,L,E,J,D)}},D);return G},IsModuleInstalled:function(){var D=A;D._resetErr();if(D._isMobileMode()){return D._mobileNotSupport("Addon.OCRPro.IsModuleInstalled")}var C=D._innerFun("GetAddOnVersion",B.makeParams("proocr",y));return(C!="")},Download:function(G,J,C){var F=A,H;F._resetErr();if(F._isMobileMode()){return F._mobileNotSupport("Addon.OCRPro.Download")}var E=function(){if(m.isFunction(J)){J()}return true},K=function(){if(m.isFunction(C)){C(F.ErrorCode,F.ErrorString)}return false};if(!m.License.checkProductKey(F,{Core:true})){return K()}if(!m.License.checkProductKey(F,{OCRPro:true},true)){return K()}if(this.IsModuleInstalled()){E();return true}if(!G||G==""||!m.isString(G)){m.Errors.OCR_InvalidRemoteFilename(F);K();return false}if(B.isServerInvalid(F)){K();return false}H="get";m.cancelFrome=2;m.showProgress(F,"Download",true);var I=function(L){var M=(L.total===0)?100:Math.round(L.loaded*100/L.total),N=[L.loaded," / ",L.total].join("");F._OnPercentDone([0,M,"","http"])},D=true;F._OnPercentDone([0,-1,"Downloading OCR Resources...","http"]);if(!m.isFunction(J)){D=false}return B.loadHttpBlob(F,H,G,D,function(L){F._OnPercentDone([0,-1,"Loading..."]);var M=102;F.__LoadImageFromBytesForDownload(L,M,"",D,E,K)},function(){m.closeProgress("Download");K()},I)}}};A.__addon=A.__addon||{};m.mix(A.__addon,z)};if(m.DynamicLoadAddonFuns){m.DynamicLoadAddonFuns.push(g)}function p(E,H,z,I,B,G,y,C,F,A){var D=this;D.STWAIN=H;D.AjaxFunctionUrl=E;D.FunctionName=z;D.ImageIndex=I;D.FileNames=B;D.Type=G;D.AryZone=y;D.JsonString=C;D.OnSuccess=F;D.OnFailure=A}Dynamsoft.WebTwain.Addon.OCRPro.NewOCRReadPara=function(D,G,z,H,B,F,y,C,E,A){return new p(D,G,z,H,B,F,y,C,E,A)};function s(C,B){var D="";var E=C.responseText;if(E.length==0){var A=Dynamsoft.WebTwain.Addon.OCRPro.NewOCRError();Dynamsoft.Lib.Errors.OCR_LicenseCheckerError(A,B.AjaxFunctionUrl);E=A.responseText}D=f(E);var z=D.split(";");if(z.length==1){B.OnFailure(-1,E,Dynamsoft.Lib.NewOCRProResult())}else{if(z[0]=="true"){var y=function(G,F,H){if(Dynamsoft.Lib.isUndefined(H)){if(Dynamsoft.Lib.isUndefined(F)){B.OnSuccess(G);x(B.AjaxFunctionUrl,G.GetPageCount())}else{B.OnSuccess(G,F);x(B.AjaxFunctionUrl,F.GetPageCount())}}else{B.OnSuccess(G,F,H);x(B.AjaxFunctionUrl,H.GetPageCount())}};B.STWAIN.__innerOCRReadFunction(B.FunctionName,B.ImageIndex,B.FileNames,B.Type,B.AryZone,B.JsonString,y,B.OnFailure)}else{B.OnFailure(z[1],z[2],Dynamsoft.Lib.NewOCRProResult())}}}function w(G,J,z,K,D,I,y,E,H,A){var B=G;var F="DTW_AjaxMethod=CheckLicense&Productkey="+j(Dynamsoft.DWT.ProductKey);var C=Dynamsoft.WebTwain.Addon.OCRPro.NewOCRReadPara(G,J,z,K,D,I,y,E,H,A);return d(B,F,s,C)}function x(A,B){var z=A;var y="DTW_AjaxMethod=WriteOCRCount&OCRCount="+j(B+"");d(z,y,b,null)}function b(z,y){}function a(){var y=this;y.responseText="";y.errorString=""}Dynamsoft.WebTwain.Addon.OCRPro.NewOCRError=function(){return new a()};Dynamsoft.Lib.mix(Dynamsoft.Lib.Errors,{OCR_LicenseCheckerEmpty:function(z){var A=-2601;var y="LicenseChecker cannot be empty.";z.errorString=y;z.responseText=j("false;"+A+";"+y+";")},OCR_LicenseCheckerNotConnect:function(z){var A=-2602;var y="Cannot connect to the LicenseChecker, please check and make sure it's set correctly.";z.errorString=y;z.responseText=j("false;"+A+";"+y+";")},OCR_AccessDenied:function(z){var A=-2603;var y="Access denied.";z.errorString=y;z.responseText=j("false;"+A+";"+y+";")},OCR_LicenseCheckerError:function(z,B){var A=-2604;var y="Error occured in '"+B+"'.";z.errorString=y;z.responseText=j("false;"+A+";"+y+";")},OCR_HTTPError:function(z,A){var B=-2605;var y="HTTP Error "+A+".";z.errorString=y;z.responseText=j("false;"+B+";"+y+";")},OCR_LicenseCheckerUnauthorized:function(z,B){var A=-2606;var y="You do not have permission to view this directory or page using the credentials you supplied (access denied due to Access Control Lists). Ask the Web server's administrator to give you access to '"+B+"'.";z.errorString=y;z.responseText=j("false;"+A+";"+y+";")},__last:false});function i(){var y=null,A=window;try{y=new A.ActiveXObject("Msxml2.XMLHTTP")}catch(z){try{y=new A.ActiveXObject("Microsoft.XMLHTTP")}catch(z){y=new XMLHttpRequest()}}return y}function d(z,y,D,C){var A=Dynamsoft.WebTwain.Addon.OCRPro.NewOCRError();if(z==""){Dynamsoft.Lib.Errors.OCR_LicenseCheckerEmpty(A);alert(A.errorString);D(A,C);return false}var B=i();B.open("POST",z,true);B.setRequestHeader("Content-Type","application/x-www-form-urlencoded");B.onreadystatechange=function(){if(B.readyState==4){if(B.status==200){if(D!=null&&typeof(D)=="function"){D(B,C)}}else{if(B.status==401){Dynamsoft.Lib.Errors.OCR_LicenseCheckerUnauthorized(A,C.AjaxFunctionUrl);D(A,C);return false}else{if(B.status==404){Dynamsoft.Lib.Errors.OCR_LicenseCheckerNotConnect(A);alert(A.errorString);D(A,C);return false}else{if(B.status==403){Dynamsoft.Lib.Errors.OCR_AccessDenied(A);D(A,C);return false}else{Dynamsoft.Lib.Errors.OCR_HTTPError(A,B.status);D(A,C);return false}}}}}};if(B&&y){B.send(y)}return true}var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var r=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);function k(E){var A,C,y;var D,B,z;y=E.length;C=0;A="";while(C<y){D=E.charCodeAt(C++)&255;if(C==y){A+=c.charAt(D>>2);A+=c.charAt((D&3)<<4);A+="==";break}B=E.charCodeAt(C++);if(C==y){A+=c.charAt(D>>2);A+=c.charAt(((D&3)<<4)|((B&240)>>4));A+=c.charAt((B&15)<<2);A+="=";break}z=E.charCodeAt(C++);A+=c.charAt(D>>2);A+=c.charAt(((D&3)<<4)|((B&240)>>4));A+=c.charAt(((B&15)<<2)|((z&192)>>6));A+=c.charAt(z&63)}return A}function t(F){var E,D,B,z;var C,y,A;y=F.length;C=0;A="";while(C<y){do{E=r[F.charCodeAt(C++)&255]}while(C<y&&E==-1);if(E==-1){break}do{D=r[F.charCodeAt(C++)&255]}while(C<y&&D==-1);if(D==-1){break}A+=String.fromCharCode((E<<2)|((D&48)>>4));do{B=F.charCodeAt(C++)&255;if(B==61){return A}B=r[B]}while(C<y&&B==-1);if(B==-1){break}A+=String.fromCharCode(((D&15)<<4)|((B&60)>>2));do{z=F.charCodeAt(C++)&255;if(z==61){return A}z=r[z]}while(C<y&&z==-1);if(z==-1){break}A+=String.fromCharCode(((B&3)<<6)|z)}return A}function u(B){var z,A,y,C;z="";y=B.length;for(A=0;A<y;A++){C=B.charCodeAt(A);if((C>=1)&&(C<=127)){z+=B.charAt(A)}else{if(C>2047){z+=String.fromCharCode(224|((C>>12)&15));z+=String.fromCharCode(128|((C>>6)&63));z+=String.fromCharCode(128|((C>>0)&63))}else{z+=String.fromCharCode(192|((C>>6)&31));z+=String.fromCharCode(128|((C>>0)&63))}}}return z}function l(D){var z,B,y,E;var C,A;z="";y=D.length;B=0;while(B<y){E=D.charCodeAt(B++);switch(E>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:z+=D.charAt(B-1);break;case 12:case 13:C=D.charCodeAt(B++);z+=String.fromCharCode(((E&31)<<6)|(C&63));break;case 14:C=D.charCodeAt(B++);A=D.charCodeAt(B++);z+=String.fromCharCode(((E&15)<<12)|((C&63)<<6)|((A&63)<<0));break}}return z}function j(y){return k(u(y))}function f(y){return l(t(y))}}); 
/*! 20230424145730
* Dynamsoft JavaScript Library
* Product: Dynamsoft Web Twain
* Web Site: https://www.dynamsoft.com
*
* Copyright 2023, Dynamsoft Corporation
* Author: Dynamsoft Support Team
*
* Module: Webcam
* Version: 18.2
* 
*/
var Dynamsoft=self.Dynamsoft||{};Dynamsoft.DWT=Dynamsoft.DWT||{},Dynamsoft.aryAddonReadyFun=Dynamsoft.aryAddonReadyFun||[],Dynamsoft.AddonReady=Dynamsoft.AddonReady||function(e){Dynamsoft.aryAddonReadyFun.push(e)},Dynamsoft.WebcamVerForActiveX="15.0.0.0625",Dynamsoft.WebcamVerInName="15.0.0.0625",function(){for(var e=[Dynamsoft.DWT],t=0;t<1;t++){var r=e[t];r.EnumDWT_VideoRotateMode={VRM_NONE:0,VRM_90_DEGREES_CLOCKWISE:1,VRM_180_DEGREES_CLOCKWISE:2,VRM_270_DEGREES_CLOCKWISE:3,VRM_FLIP_VERTICAL:4,VRM_FLIP_HORIZONTAL:5},r.EnumDWT_VideoProperty={VP_BRIGHTNESS:0,VP_CONTRAST:1,VP_HUE:2,VP_SATURATION:3,VP_SHARPNESS:4,VP_GAMMA:5,VP_COLORENABLE:6,VP_WHITEBALANCE:7,VP_BACKLIGHTCOMPENSATION:8,VP_GAIN:9},r.EnumDWT_CameraControlProperty={CCP_PAN:0,CCP_TILT:1,CCP_ROLL:2,CCP_ZOOM:3,CCP_EXPOSURE:4,CCP_IRIS:5,CCP_FOCUS:6}}}(),function(){Dynamsoft.Lib.WebcamErrors={InvalidParameter:function(e){e._errorCode=-10001,e._errorString="The parameter is invalid."},VideoNotPlayingWhenCapture:function(e){e._errorCode=-10002,e._errorString="To capture an image, the video must be playing."},VideoNotPlayingWhenGetURL:function(e){e._errorCode=-10003,e._errorString="To get the url for the current frame, the video must be playing."},Success:function(e){e._errorCode=0,e._errorString="Successful."}}}(),function(r){function t(e){var t=this;t._Count=0,t._resultlist=[],t._stwain=e}t.prototype.GetCount=function(){return r.WebcamErrors.Success(this._stwain),this._Count-1},t.prototype.Get=function(e){var t=this;return t._resultlist.length-1<=e||e<0?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(t._stwain,"Get"),""):(r.WebcamErrors.Success(t._stwain),t._resultlist[e])},t.prototype.GetCurrent=function(){var e=this,t=e._resultlist.length;return 0==t?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(e._stwain,"GetCurrent"),""):(r.WebcamErrors.Success(e._stwain),e._resultlist[t-1])},r.NewWebcamValue=function(e){return new t(e)}}(Dynamsoft.Lib),function(t){function r(e){var t=this;t._Count=0,t._resultlist=[],t._stwain=e}r.prototype.GetValue=function(){var e=this;return 0==e._resultlist.length?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(e._stwain,""),""):(t.WebcamErrors.Success(e._stwain),e._resultlist[0].current)},r.prototype.GetIfAuto=function(){var e=this;return 0==e._resultlist.length?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(e._stwain,""),!1):(t.WebcamErrors.Success(e._stwain),"true"==e._resultlist[0].auto)},t.NewWebcamSetting=function(e){return new r(e)}}(Dynamsoft.Lib),function(e){function t(e){var t=this;t._Count=0,t._resultlist=[],t._stwain=e}t.prototype.GetMinValue=function(){var e=this;return 0==e._resultlist.length?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(e._stwain,""),""):e._resultlist[0].min},t.prototype.GetMaxValue=function(){var e=this;return 0==e._resultlist.length?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(e._stwain,""),""):e._resultlist[0].max},t.prototype.GetSteppingDelta=function(){var e=this;return 0==e._resultlist.length?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(e._stwain,""),0):e._resultlist[0].step},t.prototype.GetDefaultValue=function(){var e=this;return 0==e._resultlist.length?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(e._stwain,""),0):e._resultlist[0].defaultValue},t.prototype.GetIfAuto=function(){var e=this;return 0==e._resultlist.length?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(e._stwain,""),!1):"true"==e._resultlist[0].auto},e.NewWebcamMoreSetting=function(e){return new t(e)}}(Dynamsoft.Lib),Dynamsoft.AddonReady(function(n,e){n.DynamicLoadAddonFuns&&n.DynamicLoadAddonFuns.push(function(r){r._innerSetWebcamValue=function(e){var t=n.NewWebcamValue(r);return e&&n.isArray(e)&&(t._resultlist=e,t._Count=e.length),t},r._innerSetWebcamSetting=function(e){var t=n.NewWebcamSetting(r);return e&&n.isArray(e)&&(t._resultlist=e,t._Count=e.length),t},r._innerSetWebcamMoreSetting=function(e){var t=n.NewWebcamMoreSetting(r);return e&&n.isArray(e)&&(t._resultlist=e,t._Count=e.length),t}}),n.Addon_Events.push("OnFrameCaptured"),n.Addon_Events.push("OnCaptureSuccess"),n.Addon_Events.push("OnCaptureError")}),Dynamsoft.AddonReady(function(_,e){_.product.bHTML5Edition&&_.DynamicLoadAddonFuns&&_.DynamicLoadAddonFuns.push(function(m){var e,l=_.html5.Funs,t=_.env.bMac?"DynamicWebcam_"+Dynamsoft.WebcamVerInName+".dylib":_.env.bLinux?"DynamicWebcam_"+Dynamsoft.WebcamVerInName+".so":m._b64bit?"DynamicWebcamx64_"+Dynamsoft.WebcamVerInName+".dll":"DynamicWebcam_"+Dynamsoft.WebcamVerInName+".dll";try{m._innerSend("GetAddOnVersion",l.makeParams("webcam",t),!0,!1,!1)}catch(e){}(e=m)._innerWebcamValueFunction=function(e,t){e=this._innerFunRaw(e,t,!1,!1);return this._innerSetWebcamValue(e)},e._innerWebcamSettingFunction=function(e,t){e=this._innerFunRaw(e,t,!1,!1);return this._innerSetWebcamSetting(e)},e._innerWebcamMoreSettingFunction=function(e,t){e=this._innerFunRaw(e,t,!1,!1);return this._innerSetWebcamMoreSetting(e)},e._OnCaptureSuccess=function(e){Dynamsoft.Lib.isFunction(this.__OnCaptureSuccess)&&this.__OnCaptureSuccess()},e._OnCaptureError=function(e){var t=e[1],e=e[2];Dynamsoft.Lib.isFunction(this.__OnCaptureError)&&this.__OnCaptureError(t,e)},e._OnFrameCaptured=function(e){var t,r=this,n=Dynamsoft.Lib;r.__videoPause||(t=(t=r.__videoQuality)||60,r.__videoDest&&r.__videoDest.UpdateVideoContainer(r.GetImageURL(-1,-1,-1,0,t))),n.isFunction(r.__OnFrameCaptured)&&r.__OnFrameCaptured(e)},e={Webcam:{IsModuleInstalled:function(){var e=m;return e._resetErr(),""!=e._innerFun("GetAddOnVersion",l.makeParams("webcam",t))},Download:function(e,t,r){function n(){return m.IfShowProgressBar&&_.closeProgress(null,"Download"),Dynamsoft.Lib.isFunction(t)&&t(),!0}function i(){return m.IfShowProgressBar&&_.closeProgress(null,"Download"),Dynamsoft.Lib.isFunction(r)&&r(m._errorCode,m._errorString),!1}var o=m;o._resetErr(),Dynamsoft.Lib.cancelFrome=2;if(!_.License.checkProductKey(m,{Webcam:!0},!0))return i();if(this.IsModuleInstalled())return n();if(!e||""==e)return Dynamsoft.Lib.Errors.Webcam_InvalidRemoteFilename(o),i();if(l.isServerInvalid(o))return i(),!1;m.IfShowProgressBar&&_.showProgress(o,"Download",!0);var a=!0;return o._OnPercentDone([0,-1,"Downloading Webcam Module...","http"]),Dynamsoft.Lib.isFunction(t)||(a=!1),l.loadHttpBlob(o,"get",e,a,function(e){o._OnPercentDone([0,-1,"Loading..."]);o.__LoadImageFromBytesV1(e,100,"",0,a,n,i)},function(){i()},function(e){var t=0===e.total?100:Math.round(100*e.loaded/e.total);[e.loaded," / ",e.total].join("");o._OnPercentDone([0,t,"","http"])})},GetSourceList:function(){var e,t=m;return t._resetErr(),_.License.checkProductKey(t,{Webcam:!0},!0)?(e=t._innerFunRaw("GetWebcamSourceList"),0==t.ErrorCode&&e.splice(e.length-1,1),e):[]},SelectSource:function(e){var t=m;return t._resetErr(),!!_.License.checkProductKey(t,{Webcam:!0},!0)&&t._innerFun("SelectWebcam",l.makeParams(e))},CloseSource:function(){var e=m;return e._resetErr(),this._clear(),e._innerFun("StopCapture")},GetFramePartURL:function(){var e=m;return e._resetErr(),this._isPlaying()?e.GetImageURL(-1,-1,-1,!0,e.__videoQuality):(_.WebcamErrors.VideoNotPlayingWhenGetURL(e),"")},GetFrameURL:function(){var e=m;return e._resetErr(),this._isPlaying()?e.GetImageURL(-1,-1,-1,0,e.__videoQuality):(_.WebcamErrors.VideoNotPlayingWhenGetURL(e),"")},PlayVideo:function(e,t,r,n,i){var o=m;o._resetErr();function a(){return c._clear(),Dynamsoft.Lib.isFunction(i)&&i(m._errorCode,m._errorString),!1}var u=Dynamsoft.Lib,s=60,c=this;return Dynamsoft.DWT.UseDefaultViewer?e?_.License.checkProductKey(m,{Webcam:!0},!0)?(o.__videoDest=e,o.__videoDest.ShowVideoContainer(!0),u.isFunction(r)&&(m.__OnFrameCaptured=r),m.__videoPause?(m.__videoPause=!1,_.isFunction(n)&&n()):(m.__videoPause=!1,m.__videoQuality=t?s=(s=+t)<1?60:s:s,m._innerSend("PlayVideo",l.makeParams(!0),!0,n,a)),!0):a():(Dynamsoft.Lib.Errors.ParameterCannotEmpty(m),a()):(u.Errors.CannotDoWhenNoViewerJS(m),!1)},PauseVideo:function(){var e=m;return e._resetErr(),this._isPlaying()&&(e.__videoPause=!0),!0},_clear:function(){var e=m;Dynamsoft.Lib;e.__videoPause=!1,e.__OnFrameCaptured=!1,e.__videoQuality=60,e.__videoDest&&e.__videoDest.ShowVideoContainer(!1),e.__videoDest=!1},_isPlaying:function(){return m.GetIfShowVideoContainer()},StopVideo:function(){var e=m,t=(e._resetErr(),this._clear(),e._innerFun("PlayVideo",l.makeParams(!1,0)));return e._innerFun("StopCapture"),t},CaptureImage:function(e,t){var r,n,i=m;return i._resetErr(),_.License.checkProductKey(i,{Webcam:!0},!0)?(r="CaptureImage",n=function(){l.hideMask(r),_.isFunction(t)&&t(i._errorCode,i._errorString)},l.showMask(r),i.__OnCaptureError=n,i._innerSend(r,l.makeParams(!1),!0,function(){l.hideMask(),0==i.ErrorCode?(l.hideMask(r),_.isFunction(e)&&setTimeout(e,0),_.License.isLTS()&&Dynamsoft.DWT.lcvrf(m)):n(i.ErrorCode,i.ErrorString)},n),!0):(_.isFunction(t)&&t(i._errorCode,i._errorString),!1)},GetMediaType:function(){var e=m;return e._resetErr(),e._innerWebcamValueFunction("GetMediaType")},SetMediaType:function(e){var t=m;return t._resetErr(),_.isString(e)?t._innerFun("SetMediaType",l.makeParams(e)):(_.Errors.InvalidValue(t),!1)},GetResolution:function(){var e=m,e=(e._resetErr(),e._innerWebcamValueFunction("GetResolution"));if(e&&e._resultlist){var t,r,n=e._resultlist,i=[],o=[];for(""==(r=0<n.length?n[n.length-1]:r)&&0<n.length&&(r=n[0]),t=0;t<n.length-1;t++){for(var a,u=(a=n[t]).toLowerCase().split("x"),s=(l=c=s=void 0,{value:a,p1:parseInt(u[0]),p2:parseInt(u[1])}),c=i,l=c.length-1;0<=l&&c[l].p1>=s.p1&&!(c[l].p1==s.p1&&c[l].p2<s.p2);)c[l+1]=c[l],l--;c[l+1]=s}for(t=0;t<i.length;t++)a=i[t].value,o.push(a);r&&o.push(r),e._resultlist=o,o=i=null}return e},SetResolution:function(e){var t=m;return t._resetErr(),_.isNumber(e)||_.isString(e)?t._innerFun("SetResolution",l.makeParams(e)):(_.Errors.InvalidValue(t),!1)},GetFrameRate:function(){var e=m;return e._resetErr(),e._innerWebcamValueFunction("GetFrameRate")},SetFrameRate:function(e){var t=m;return t._resetErr(),_.isNumber(e)?m._innerFun("SetFrameRate",l.makeParams(e)):(_.Errors.InvalidValue(t),!1)},GetVideoPropertySetting:function(e){var t=m;return t._resetErr(),t._innerWebcamSettingFunction("GetWebcamVideoPropertySetting",l.makeParams(e))},GetVideoPropertyMoreSetting:function(e){var t=m;return t._resetErr(),t._innerWebcamMoreSettingFunction("GetWebcamVideoPropertyMoreSetting",l.makeParams(e))},SetVideoPropertySetting:function(e,t,r){var n=m;return n._resetErr(),n._innerFun("SetWebcamVideoPropertySetting",l.makeParams(e,t,r))},SetVideoRotateMode:function(e){var t=m;return t._resetErr(),t._innerFun("SetVideoRotateMode",l.makeParams(e))},GetCameraControlPropertySetting:function(e){var t=m;return t._resetErr(),t._innerWebcamSettingFunction("GetWebcamCameraControlSetting",l.makeParams(e))},GetCameraControlPropertyMoreSetting:function(e){var t=m;return t._resetErr(),t._innerWebcamMoreSettingFunction("GetWebcamCameraControlMoreSetting",l.makeParams(e))},SetCameraControlPropertySetting:function(e,t,r){var n=m;return n._resetErr(),n._innerFun("SetWebcamCameraControlPropertySetting",l.makeParams(e,t,r))}}},m.__addon=m.__addon||{},_.mix(m.__addon,e)})}),Dynamsoft.AddonReady(function(d,e){var r;d.product.bActiveXEdition&&d.DynamicLoadAddonFuns&&d.DynamicLoadAddonFuns.push(function(m){var _,e,t;if(!m.getSWebTwain()||!m.getSWebTwain().Addon)return!1;Dynamsoft.navInfoSync.bWin&&(t=!Dynamsoft.navInfo.bOSx64||Dynamsoft.navInfo.bWOW64,r=t?"DynamicWebcam_"+Dynamsoft.WebcamVerForActiveX+".dll":"DynamicWebcamx64_"+Dynamsoft.WebcamVerForActiveX+".dll"),_=m.getSWebTwain();try{_.GetAddOnVersion("webcam",r)}catch(e){}(t=m)._innerRead=function(e){var t;try{t=Dynamsoft.Lib.parse(e)}catch(e){}return t.result},t._innerWebcamValueFunctionPlugin=function(e){e=this._innerRead(e);return this._innerSetWebcamValue(e)},t._innerWebcamSettingFunctionPlugin=function(e){e=this._innerRead(e);return this._innerSetWebcamSetting(e)},t._innerWebcamMoreSettingFunctionPlugin=function(e){e=this._innerRead(e);return this._innerSetWebcamMoreSetting(e)},e={Webcam:{IsModuleInstalled:function(){var e=_.GetAddOnVersion("webcam",r);return d.setErrorString(m),""!=e},Download:function(e,t,r){function n(){return Dynamsoft.Lib.isFunction(t)&&t(),!0}function i(){return Dynamsoft.Lib.isFunction(r)&&r(m._errorCode,m._errorString),!1}return d.License.checkProductKey(m,{Webcam:!0},!0)?this.IsModuleInstalled()?n():e&&""!=e?(e=_.DownloadAddon(e),d.wrapperRet(m,e,n,i)):(Dynamsoft.Lib.Errors.Webcam_InvalidRemoteFilename(m),i()):i()},GetSourceList:function(){var e,t;return d.License.checkProductKey(m,{Webcam:!0},!0)?(e=_.GetWebcamSourceList(),t=[],d.setErrorString(m),0==m._errorCode&&(t=m._innerRead(e))&&1<t.length&&t.splice(t.length-1,1),t):[]},SelectSource:function(e){return!!d.License.checkProductKey(m,{Webcam:!0},!0)&&(e=_.SelectWebcam(e),d.setErrorString(m),e)},CloseSource:function(){m._playVideoDWT=null;var e=_.StopCapture();return d.setErrorString(m),e},GetFramePartURL:function(){var e;return this._isPlaying()?(e=_.GetDIB(-1),d.setErrorString(m),e):(d.WebcamErrors.VideoNotPlayingWhenGetURL(m),"")},GetFrameURL:function(){return""},PlayVideo:function(e,t,r,n,i){function o(){return m._playVideoDWT=null,Dynamsoft.Lib.isFunction(i)&&i(m.ErrorCode,m.ErrorString),!1}var a;return e&&e.getSWebTwain()?d.License.checkProductKey(m,{Webcam:!0},!0)?(a=e.getSWebTwain().CurrentHWND)?(m._playVideoDWT=e,setTimeout(function(){var e=_.RunWebcamCmd("PlayVideo",a,null,null,r);d.wrapperRet(m,e,n,o)},0),!0):(d.WebcamErrors.InvalidParameter(m),o()):o():(Dynamsoft.Lib.WebcamErrors.InvalidParameter(m),o())},PauseVideo:function(){return!0},StopVideo:function(){m._playVideoDWT=null;var e=_.RunWebcamCmd("StopVideo",0,null,null,null);return d.setErrorString(m),_.StopCapture(),e},CaptureImage:function(e,t){function r(){return Dynamsoft.Lib.isFunction(t)&&t(m.ErrorCode,m.ErrorString),!1}var n;return d.License.checkProductKey(m,{Webcam:!0},!0)?(n=_.RunWebcamCmd("Capture",0,function(){d.isFunction(e)&&setTimeout(e,0),d.License.isLTS()&&Dynamsoft.DWT.lcvrf(m)},r,null),d.setErrorString(m),n):r()},GetMediaType:function(){var e=m._innerWebcamValueFunctionPlugin(_.GetMediaType());return d.setErrorString(m),e},SetMediaType:function(e){return d.isString(e)?(e=_.SetMediaType(e),d.setErrorString(m),e):(d.Errors.InvalidValue(m),!1)},GetResolution:function(){var e=m._innerWebcamValueFunctionPlugin(_.GetResolution());if(d.setErrorString(m),e&&e._resultlist){var t,r,n=e._resultlist,i=[],o=[];for(0<n.length&&(r=n[n.length-1]),t=0;t<n.length-1;t++){for(var a,u=(a=n[t]).toLowerCase().split("x"),s=(l=c=s=void 0,{value:a,p1:parseInt(u[0]),p2:parseInt(u[1])}),c=i,l=c.length-1;0<=l&&c[l].p1>=s.p1&&!(c[l].p1==s.p1&&c[l].p2<s.p2);)c[l+1]=c[l],l--;c[l+1]=s}for(t=0;t<i.length;t++)a=i[t].value,o.push(a);r&&o.push(r),e._resultlist=o,o=i=null}return e},SetResolution:function(e){return d.isNumber(e)||d.isString(e)?(e=_.SetResolution(e),d.setErrorString(m),e):(d.Errors.InvalidValue(m),!1)},GetFrameRate:function(){var e=m._innerWebcamValueFunctionPlugin(_.GetFrameRate());return d.setErrorString(m),e},SetFrameRate:function(e){return d.isNumber(e)?(e=_.SetFrameRate(e),d.setErrorString(m),e):(d.Errors.InvalidValue(m),!1)},GetVideoPropertySetting:function(e){e=_.GetWebcamVideoPropertySetting(e);return d.setErrorString(m),m._innerWebcamSettingFunctionPlugin(e)},GetVideoPropertyMoreSetting:function(e){e=_.GetWebcamVideoPropertyMoreSetting(e);return d.setErrorString(m),m._innerWebcamMoreSettingFunctionPlugin(e)},SetVideoPropertySetting:function(e,t,r){e=_.SetWebcamVideoPropertySetting(e,t,r);return d.setErrorString(m),e},SetVideoRotateMode:function(e){e=_.SetVideoRotateMode(e);return d.setErrorString(m),e},GetCameraControlPropertySetting:function(e){e=_.GetWebcamCameraControlSetting(e);return d.setErrorString(m),m._innerWebcamSettingFunctionPlugin(e)},GetCameraControlPropertyMoreSetting:function(e){e=_.GetWebcamCameraControlMoreSetting(e);return d.setErrorString(m),m._innerWebcamMoreSettingFunctionPlugin(e)},SetCameraControlPropertySetting:function(e,t,r){e=_.SetWebcamCameraControlPropertySetting(e,t,r);return d.setErrorString(m),e},_isPlaying:function(){return!!m._playVideoDWT}}},m.Addon=m.Addon||{},d.mix(m.Addon,e)})}); 
/*! 20230424145730
* Dynamsoft JavaScript Library
* Product: Dynamsoft Web Twain
* Web Site: https://www.dynamsoft.com
*
* Copyright 2023, Dynamsoft Corporation
* Author: Dynamsoft Support Team
*
* Module: Upload
* Version: 18.2
* 
*/
var Dynamsoft=window.Dynamsoft||{};!function(e){e.DWT||(e.DWT={}),e.Lib||(e.Lib={})}(Dynamsoft),Dynamsoft.aryAddonReadyFun=Dynamsoft.aryAddonReadyFun||[],Dynamsoft.AddonReady=Dynamsoft.AddonReady||function(e){Dynamsoft.aryAddonReadyFun.push(e)},Dynamsoft.AddonReady(function(u,e){Dynamsoft.DWT.EnumTransferErrorCode={TRANS_OK:0,TRANS_URL_MALFFORMAT:1,TRANS_FAILED_RESOLVE_PROXY:2,TRANS_FAILED_RESOLVE_HOST:3,TRANS_FAILED_CONNECT:4,TRANS_REMOTE_ACCESS_DENIED:5,TRANS_PARTIAL_FILE:6,TRANS_UPLOAD_FAILED:7,TRANS_READ_FAILED:8,TRANS_OUT_OF_MEMORY:9,TRANS_REMOTE_FULL_DISK:10,TRANS_OPERATION_TIMEOUT:11,TRANS_SERVICE_ERROR_404:12,TRANS_SERVICE_ERROR_500:13,TRANS_SERVICE_ERROR_503:14,TRANS_SERVICE_ERROR:15,TRANS_NOT_SEND:16,TRANS_WAITFOR_SEND:17,TRANS_SENDING:18,TRANS_PAUSE:19,TRANS_FINISHED:20,TRANS_NULL_POINTER:21,TRANS_INVALID_ID:22,TRANS_Failed:23,TRANS_SERVICE_ERROR_MORE_THAN_500:24,TRANS_SERVICE_ERROR_LESS_THAN_200:25,TRANS_SERVICE_ERROR_MORE_THAN_300:26,TRANS_CANNOT_FINDFILE:27,TRANS_ABORT:28,TRANS_NOT_FINISHED:29,TRANS_TASK_PREPARE_INIT:30,TRANS_TASK_INIT:31,TRANS_BEYOND_MAXSIZE:32};var c=Dynamsoft,r=Dynamsoft.dcp,a=[1,7,2,"1026"],f="upload_"+a.join(""),n={Version:"1.0",HttpVersion:"1.1",ServerUrl:"",FileName:"",VERIFYPEER:!1,VERIFYHOST:!1,BlockSize:10240,ThreadNum:1,OnUploadTransferPercentage:function(e,n){},OnRunSuccess:function(e){},OnRunFailure:function(e,n,t){}},p=0,m="",i=function(){p=-1,m="The zip file that contains the upload library (.dll) is invalid."},E=function(){p=-2,m="Upload failed because the url to upload to is invalid."},l=function(e,n,t){p=-3,e?m="Upload cancelled.":(m=n&&""!=n?"Upload failed with error: "+n:"Upload failed.",n&&""!=n&&(m=m+"("+t+")"))},F=function(){p=-4,m="Upload failed because the file to upload has invalid content."},t=function(){p=-5,m="Invalid upload job id."},R=function(){p=-6,m="Cannot create an upload job."},S=function(){p=-7,m="The file name is incorrect in the upload job."},o=function(){p=-8,m="Can not cancel all jobs when at least one job is still being created."},d=function(){p=-9,m="The zip file that contains the upload library (.dll) download failed."},s=function(){p=0,m=""};function T(){}function D(e){this.job=e}function _(e){this.job=e}T.prototype={runWaiting:0,CreateJob:function(){var e={HttpHeader:{},documents:[],formFields:[],bEvent:!1};return u.mix(e,n),e.SourceValue=new D(e),e.FormField=new _(e),e},Run:function(o){var e,r=this,n='""',t=o.ServerUrl,a="";if(!u.isString(t)||""==t)return o.id=-1,E(),!o.bEvent&&u.isFunction(o.OnRunFailure)&&(o.bEvent=!0,o.OnRunFailure(o,p,m),o.bEvent=!1),!1;if(!o.documents||!u.isArray(o.documents)||o.documents.length<=0)return o.id=-1,F(),!o.bEvent&&u.isFunction(o.OnRunFailure)&&(o.bEvent=!0,o.OnRunFailure(o,p,m),o.bEvent=!1),!1;if(!o.ar||!o.cu){Dynamsoft.Lib.License.isLicenseMixed(null,!0)||Dynamsoft.Lib.License.reparseProductKey();var i=Dynamsoft.DWT.licenseException;if(0!=i.code)return o.id=-1,p=i.code,m=i.message,!o.bEvent&&u.isFunction(o.OnRunFailure)&&(o.bEvent=!0,o.OnRunFailure(o,p,m),o.bEvent=!1),!1;if(Dynamsoft.Lib.License.isLTS())return Dynamsoft.DWT.lglic(Dynamsoft.DWT.EnumInstance.dwt_desktop,"").then(function(e){o.ar=e.ar,o.cu=e.cu,r.Run(o)}),!0;u.product.refProductKey&&(n='"'+u.product.refProductKey+'"')}for(o.Url=t,delete o.ServerUrl,e=0;e<o.documents;e++){var l=o.documents[e];if(!u.isString(l.files)||""==l.files)return o.id=-1,S(),!o.bEvent&&u.isFunction(o.OnRunFailure)&&(o.bEvent=!0,o.OnRunFailure(o,p,m),o.bEvent=!1),!1;u.isString(l.remoteName)&&""!=l.remoteName||(l.remoteName="RemoteFile")}var i=o.SourceValue,d=(delete o.SourceValue,o.FormField),s=(delete o.FormField,u.stringify(o)),s=u.replaceAll(s,'"',"'");o.ServerUrl=t,delete o.Url,o.SourceValue=i,o.FormField=d,t=['{"id":"',1,'","method":"RunUploadFile","version":"',f,'","parameter":[',n,',"',s,'"'],o.ar&&o.cu?(a=[',"',o.ar,'","',o.cu,'",0]}'].join(""),delete o.ar,delete o.cu,t.push(a)):t.push("]}"),i=t.join(""),r.runWaiting++;return Dynamsoft.FileUploader._sendCmd("RunUploadFile",i,function(e){var n;r.runWaiting--,e&&((n=e.UploadId)&&0<n?(o.id=n,c.FileUploader.map[o.id]=o,c.FileUploader.ids.push(e.UploadId),o.OnUploadTransferPercentage&&o.OnUploadTransferPercentage(o,0)):(n=e.errorcode,e=e.errorstring,n&&e?(p=n,m=e):R(),!o.bEvent&&u.isFunction(o.OnRunFailure)&&(o.bEvent=!0,o.OnRunFailure(o,p,m),o.bEvent=!1)))},function(e,n,t){r.runWaiting--,c.FileUploader.parseHttpErrors(e,n,t),!o.bEvent&&u.isFunction(o.OnRunFailure)&&(o.bEvent=!0,o.OnRunFailure(o,p,m),o.bEvent=!1)}),!0},Cancel:function(o){var e;return!o.id||o.id<0?(t(),!o.bEvent&&u.isFunction(o.OnRunFailure)&&(o.bEvent=!0,o.OnRunFailure(o,p,m),o.bEvent=!1),!1):(e='{"id":"1","method":"DeleteUploadTask","version":"'+f+'","parameter":["'+o.id+'"]}',Dynamsoft.FileUploader._sendCmd("DeleteUploadTask",e,function(e){c.FileUploader.deleteJobById(o.id)},function(e,n,t){c.FileUploader.parseHttpErrors(e,n,t),!o.bEvent&&u.isFunction(o.OnRunFailure)&&(o.bEvent=!0,o.OnRunFailure(o,p,m),o.bEvent=!1)}),!0)},CancelAllUpload:function(){var t=c.FileUploader.ids,e='{"id":"1","method":"DeleteUploadTask","version":"'+f+'","parameter":["'+t.join(",")+'"]}';return 0<this.runWaiting?(o(),!1):(this.runWaiting<0&&(this.runWaiting=0),t.length<=0||Dynamsoft.FileUploader._sendCmd("DeleteUploadTask",e,function(e){for(var n=0;n<t.length;n++)c.FileUploader.deleteJobById(t[n]);c.FileUploader.ids=[],c.FileUploader.map=[]},function(e,n,t){c.FileUploader.parseHttpErrors(e,n,t)}),!0)},OnUploadTransferPercentage:function(e,n){},OnRunSuccess:function(e){},OnRunFailure:function(e,n,t){}},(c.SourceValue=D).prototype.Add=function(e,n,t){var o=this.job;u.isString(e)&&""!=e?(t=t||"RemoteFile",e=Dynamsoft.Lib.replaceAll(e,"\\\\","\\\\"),o.documents.push({files:[e],fileName:n,remoteName:t})):(S(),!o.bEvent&&u.isFunction(o.OnRunFailure)&&(o.bEvent=!0,o.OnRunFailure(o,p,m),o.bEvent=!1))},c.FormField=_,c.FileUploader={ids:[],map:{},port:18625,protocol:"https://",ip:"127.0.0.1",wsUrl:"",running:!(_.prototype.Add=function(e,n){var t,o,r=n,a=e;if(null==r&&(r=""),!u.isString(a)||""==a||!u.isString(r))return!1;if(r=encodeURI(r),-1<(a=encodeURI(a)).indexOf("'")||-1<r.indexOf("'"))return!1;for(t=0;t<this.job.formFields.length;t++)if((o=this.job.formFields[t]).name==a)return o.value=r,!0;return this.job.formFields.push({name:a,value:r}),!0}),ws:null,nextLoopTime:600,deleteJobById:function(e){var n;if(s(),e){for(n=0;n<c.FileUploader.ids.length;n++)if(e==c.FileUploader.ids[n]){c.FileUploader.ids.splice(n,1);break}var t=c.FileUploader.map[e];for(t.SourceValue.job=null,delete t.SourceValue,t.FormField.job=null,delete t.FormField,delete c.FileUploader.map[e],n=t.documents.length-1;0<=n;n--)t.documents.splice(n,1);for(n=t.formFields.length-1;0<=n;n--)t.formFields.splice(n,1);var o='{"id":"1","method":"DeleteUploadTask","version":"'+f+'","parameter":["'+e+'"]}';Dynamsoft.FileUploader._sendCmd("DeleteUploadTask",o)}},_sendCmdByWS:function(e,n,t){var o=c.FileUploader.ws;return o&&o.readyState!=Dynamsoft.DWT.EnumDWT_WebsocketReadyState.CLOSING&&o.readyState!=Dynamsoft.DWT.EnumDWT_WebsocketReadyState.CLOSED||(o=Dynamsoft.DWT.NetManager.newWebsocket(c.FileUploader.wsUrl),c.FileUploader.ws=o),Dynamsoft.DWT.NetManager.postStringDataByWS(o,e).then(function(e){e=u.parse(e);e&&"result"in e?u.isFunction(n)&&n(e.result):u.isFunction(t)&&t()},t),!0},_sendCmd:function(e,n,t,o){return Dynamsoft.DWT.ConnectWithSocket?_sendCmdByWS(n,t,o):(e=[c.FileUploader.protocol,c.FileUploader.ip,":",c.FileUploader.port,"/dcp/",f,"/",e,"?type=1&dsver=",a.join(""),"&ts=",u.now()].join(""),u.ajax({url:e,method:"post",dataType:"json",processData:!1,data:n,onSuccess:t,onError:o}))},parseHttpErrors:function(e,n,t){var o,e=e&&u.isArray(e)&&2<e.length?(o=e[1],e[2]):(o=n,t);2==e.state&&0==e.status?"abort"===e.statusText?l(!0):E():l(!1,o,e.status)},loadHttpBlob:function(e,n,t,o,r,a,i){e={method:e,url:n,dataType:"blob",async:t,onSuccess:o,onError:function(e,n,t){c.FileUploader.parseHttpErrors(e,n,t),u.isFunction(r)&&r()}};u.isFunction(a)&&(e.beforeSend=function(e){e.addEventListener("progress",function(e){delete e.totalSize,delete e.position,a(e)},!1)}),u.ajax(e)},_OnPercentDone:function(){},Download:function(e,n,t){var o;return u.isString(e)?c.FileUploader.loadHttpBlob("get",e,!!(o=function(){return d(),u.isFunction(t)&&t(p,m),!1}),function(e){r.loadZip(e,100,n,o)},o,!1):(i(),u.isFunction(t)&&t(p,m),!1)},Init:function(e,t,n){s();function o(){var e,n=Dynamsoft.navInfoSync.bSSL?(e="https://",Dynamsoft.dcp.SSLPort):(e="http://",Dynamsoft.dcp.Port);c.FileUploader.port=n,c.FileUploader.protocol=e,c.FileUploader.ip=Dynamsoft.DWT.Host,c.FileUploader.wsUrl=Dynamsoft.DWT.NetManager.getWsUrl(Dynamsoft.DWT.Host,n),c.FileUploader.running=!0,t(new T),setTimeout(c.FileUploader.StatusLoop,500)}Dynamsoft.dcp.detect.bConnected?o():Dynamsoft.DWT.NetManager.checkModuleManager(o,n)},Close:function(){var e;Dynamsoft.DWT.ConnectWithSocket&&(e=Dynamsoft.FileUploader.ws)&&(e.readyState!=Dynamsoft.DWT.EnumDWT_WebsocketReadyState.CLOSED&&e.readyState!=Dynamsoft.DWT.EnumDWT_WebsocketReadyState.CLOSING&&e.close(),Dynamsoft.FileUploader.ws=null),Dynamsoft.FileUploader.running=!1},VersionInfo:function(e,o){s();var n='{"id":"1","method":"VersionInfo","version":"'+f+'","parameter":[]}';return Dynamsoft.FileUploader._sendCmd("VersionInfo",n,e,function(e,n,t){c.FileUploader.parseHttpErrors(e,n,t),u.isFunction(o)&&o(p,m)}),!0},StatusLoop:function(){return s(),c.FileUploader.GetUploadStatus(),c.FileUploader.running&&setTimeout(c.FileUploader.StatusLoop,c.FileUploader.nextLoopTime),!0},GetUploadStatus:function(){var e;return s(),c.FileUploader.ids.length<=0||(e='{"id":"1","method":"GetUploadStatus","version":"'+f+'","parameter":["'+c.FileUploader.ids.join(",")+'"]}',Dynamsoft.FileUploader._sendCmd("GetUploadStatus",e,function(e){if(u.isArray(e))for(var n=0;n<e.length;n++){var t=(l=e[n]).id,o=c.FileUploader.map[t],r=l.percentage,a=l.errorcode,i=l.response,l=l.errorstring;o&&(a==Dynamsoft.DWT.EnumTransferErrorCode.TRANS_FINISHED?(o.OnUploadTransferPercentage(o,100,U(i)),!o.bEvent&&u.isFunction(o.OnRunSuccess)&&(o.bEvent=!0,o.OnRunSuccess(o,U(i)),o.bEvent=!1),c.FileUploader.deleteJobById(t)):a==Dynamsoft.DWT.EnumTransferErrorCode.TRANS_OK||a==Dynamsoft.DWT.EnumTransferErrorCode.TRANS_NOT_SEND||a==Dynamsoft.DWT.EnumTransferErrorCode.TRANS_WAITFOR_SEND||a==Dynamsoft.DWT.EnumTransferErrorCode.TRANS_SENDING||a==Dynamsoft.DWT.EnumTransferErrorCode.TRANS_PAUSE||a==Dynamsoft.DWT.EnumTransferErrorCode.TRANS_TASK_PREPARE_INIT||a==Dynamsoft.DWT.EnumTransferErrorCode.TRANS_TASK_INIT?o.OnUploadTransferPercentage(o,r,U(i)):(!o.bEvent&&u.isFunction(o.OnRunFailure)&&(o.bEvent=!0,o.OnRunFailure(o,a,l,U(i)),o.bEvent=!1),c.FileUploader.deleteJobById(t)))}},function(e,n,t){})),!0}};var y=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);function U(e){for(var n,t,o,r,a=e.length,i=0,l="";i<a;){for(;n=y[255&e.charCodeAt(i++)],i<a&&-1==n;);if(-1==n)break;for(;t=y[255&e.charCodeAt(i++)],i<a&&-1==t;);if(-1==t)break;l+=String.fromCharCode(n<<2|(48&t)>>4);do{if(61==(o=255&e.charCodeAt(i++)))return l}while(o=y[o],i<a&&-1==o);if(-1==o)break;l+=String.fromCharCode((15&t)<<4|(60&o)>>2);do{if(61==(r=255&e.charCodeAt(i++)))return l}while(r=y[r],i<a&&-1==r);if(-1==r)break;l+=String.fromCharCode((3&o)<<6|r)}return l}}); 
/*! 20230315181423333
* Dynamsoft JavaScript Library
* Product: Dynamsoft Web Twain
* Web Site: https://www.dynamsoft.com
*
* Copyright 2023, Dynamsoft Corporation
* Author: Dynamsoft Support Team
* Version: 18.2
*/
//Dynamsoft.On{actionName} It is a callback function called by Web-TWAIN product. The contents of this function are the default templates of the WebTWAIN. Users can modify the fucntions, but be aware that the function name itself cannot be modified
//Dynamsoft._{functionName} It is a private function used by Dynamsoft.On{actionName}. Users can modify and delete according to their needs.
(function () {
  "use strict";
  var screenW = screen.width,
    promptDlgWidth = screenW > 550 ? 550 : (screenW - 10),
    promptDlgWidth2 = screenW > 680 ? 680 : (screenW - 10);


  //----------------------start Install Dialog---------------------------

  //Web TWAIN Service is not detected dialogs
  //Windows
  Dynamsoft.OnWebTwainNotFoundOnWindowsCallback = function (ProductName, InstallerUrl, bHTML5, bIE, bSafari, bSSL, strIEVersion) {
    var _this = Dynamsoft,
      objUrl = {
        'default': InstallerUrl
      };
    _this._show_install_dialog(ProductName, objUrl, bHTML5, Dynamsoft.DWT.EnumDWT_PlatformType.enumWindow, bIE, bSafari, bSSL, strIEVersion, false);
  };

  //Linux
  Dynamsoft.OnWebTwainNotFoundOnLinuxCallback = function (ProductName, strDebUrl, strRpmUrl, bHTML5, bIE, bSafari, bSSL, strIEVersion, iPlatform) {
    var _this = Dynamsoft,
      objUrl = {
        'default': strDebUrl,
        'deb': strDebUrl,
        'rpm': strRpmUrl
      };
    if (!iPlatform) iPlatform = Dynamsoft.DWT.EnumDWT_PlatformType.enumLinux;
    if (iPlatform == Dynamsoft.DWT.EnumDWT_PlatformType.enumAndroid) {
      objUrl.default = "intent://dynamsoft.com/#Intent;scheme=http;package=com.dynamsoft.mobilescan;end";
    }
    _this._show_install_dialog(ProductName, objUrl, bHTML5, iPlatform, bIE, bSafari, bSSL, strIEVersion, false);
  };

  //MacOS
  Dynamsoft.OnWebTwainNotFoundOnMacCallback = function (ProductName, InstallerUrl, bHTML5, bIE, bSafari, bSSL, strIEVersion) {
    var _this = Dynamsoft,
      objUrl = {
        'default': InstallerUrl
      };
    _this._show_install_dialog(ProductName, objUrl, bHTML5, Dynamsoft.DWT.EnumDWT_PlatformType.enumMac, bIE, bSafari, bSSL, strIEVersion, false);
  };

  //Android
  Dynamsoft.OnWebTwainNotFoundOnAndroidCallback = function (ProductName, InstallerUrl, strRpmUrl, bHTML5, bIE, bSafari, bSSL, strIEVersion, iPlatform, bSocketSuccess) {
    var objUrl = {
      'default': 'https://demo.dynamsoft.com/DWT/Resources/dist/DynamsoftServiceSetup.apk'
    }, dt = Math.random();

    objUrl.openService = "intent://dynamsoft.com/#Intent;scheme=http;package=com.dynamsoft.mobilescan;S.timestamp=" + dt + ";end";
    Dynamsoft.DWT.Host = 'local.dynamsoft.com';
    Dynamsoft._show_android_install_dialog(objUrl);
  };

  //Web TWAIN Service is not supported dialogs
  //Mobile Browsers
  Dynamsoft.OnMobileNotSupportCallback = function () {
    var ObjString = [];

    if (Dynamsoft.DWT) {

      ObjString.push('<div class="ds-dwt-ui-dlg-android" style="padding-bottom:30px">');
      ObjString.push('Service Mode does not support your Operating System, please contact the site administrator.');
      ObjString.push('</div>');

      Dynamsoft.DWT.ShowMessage(ObjString.join(''), {
        width: 335,
        headerStyle: 1,
        backgroundStyle: 1
      });
    } else {
      console.log("The Dynamsoft namespace is missing");
    }

  };

  //Error Message - HTTPS is required to allow CORS to function. This error appears when HTTP is detected. (See: https://www.dynamsoft.com/web-twain/docs/faq/http-insecure-websites-in-chromium-browser.html?ver=latest)
  Dynamsoft.OnHTTPCorsError = function (msg) {

    var ObjString = [
      "<div>", msg, "</div>",
      '<div style="margin-top:10px">To fix the issue, please update your website to HTTPS or refer to <br /><a target="_blank" href="https://www.dynamsoft.com/web-twain/docs/faq/http-insecure-websites-in-chromium-browser.html?ver=latest">this article</a> for other workarounds.</div>'
    ].join('');

    Dynamsoft.DWT.ShowMessage(ObjString, {
      width: promptDlgWidth2,
      headerStyle: 2
    });
  };

  Dynamsoft._show_install_dialog = function (ProductName, objInstallerUrl, bHTML5, iPlatform, bIE, bSafari, bSSL, strIEVersion, bNeedUpgrade) {
    var _this = Dynamsoft,
      ObjString, title, browserActionNeeded,
      EnumPlatform = Dynamsoft.DWT.EnumDWT_PlatformType,
      bAndroid = (iPlatform == EnumPlatform.enumAndroid),
      bMobile = bAndroid,
      bUnix = (iPlatform == EnumPlatform.enumLinux || iPlatform == EnumPlatform.enumEmbed ||
        iPlatform == EnumPlatform.enumChromeOS || iPlatform == EnumPlatform.enumHarmonyOS ||
        bAndroid),
      imagesInBase64 = {
        icn_download: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAgCAYAAAAMq2gFAAABOklEQVRIie2WTW6DMBCFH4h1l22VqmqPVUEvEJa9gRt6FDhDpfx0FdJj+Arx3nldhEjEdchgWlaM9CSwMZ/fzMgQvX0TwvA+ePOpIsniRIwZGIl/n/8AGs3RWKB4JA4STjUKBo1EivLtGakEkP7Ru6vbpcpONzFxPFsazQloZyxEmkDepsYk0JIhkZGwzngfWRKvd0u1Pwf93k1NoBjg5uN+pbZuHn0gEFgQ2AVAdgTefQVzU9e2nzaplKbMkEhnK2W9oAOAC9IHIO+Yd5U/rJX2QbocnVSSqARuqse1Ki9BumrUp+U1gXkXRAoyBDIC1jNnCWRPG2Wug2SFrkkUnvHieaPqaxCpo3bL104rLySQviDbpNA0Sgl4W9kXfU9vjWPho+ZaHCHfo6r/kumfYUBEL1/jeJpqFBw/d5aBU2kHOMQAAAAASUVORK5CYII=',
        icn_install: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAaCAYAAACpSkzOAAAA+klEQVRIid2SMWoCQRiFv3GnW7BII6ZPqeAlorewtBELsZdFOz2Q0VYkXQ6QA9iaIqU+mx2Y3QRd12WKffCY4WdmPt5jzPRT5PQOfOSHnky6/rnoqd/cJFt/0FB6I3UkWOVmZbz+GcyjLEjgeSjRzc3KuCMxzIC8fQwsbtTxqJan/jz+r7qZ4LWC2pzbgpkDmclBAG3gO011T0U+g9Mv8PayTY4u0UIQV5jGORYsAcz4oA7wBWR+SUWJAM5Az17E6gFIGUXA2goGJR8wAK1dUuiwVdECnpQZ7cOggiWy5zCcgIkCcbCX2iUKB6pfdfVLFAwUiNS4f6QaXQHE5K75dPBEiQAAAABJRU5ErkJggg==',
        icn_scan: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAADI0lEQVRIibWXTUhUURTHf+/NsxRCp3QGwhKT/MDoAyNo1apmNhYkodGmaFOWmUXQcpgo2gRN5kerllEGLWqjBqZGFH2BlSRJRVqCjpNjYOaUc1q80fnovZmnMx34w+Odc+///u+9595zlbPPBAuWBbiBPcAOoASwR3xB4BPwAngIdOV2en+n6lA5k5zYDjQBJwCHlRECk0Ar4Mvr9AbNglQRMMFBEYZE8IjgSBKXiIJIm6Gg23PQVHHT038U24DrQL1FhamsHThl7/LOxysGYmAT6BCoT/ifDuoFOqbcHlsyYp9ATQZJF1AjcC2OOMZbh9CQacYYnPzu8tQlKrYLNP8/zkU0B1weeyxxk4AzkySqYvjfKXp6opx8IiuAr1jP05S2bQ3sL4a29zA++4/bD6xTBVwCjkwp3eGAo+WQnw1b8w1jHAIuTQRXppTuWgt1JaAA90egc9Q01K0JVGWCdHch1BTr33c/Q89Y0vAqLQxl6ZJWF8He9RAWuPURHo+nbFKqiZC3XEIFOLAB9hTqpDc/wHO/paZ5ahgwQtEqOFIGNtXYD3Boo076R+DGe3jmN441gibCNAmplKXA8QooyAb7CmgZhLlw1G9T4GgZ7HRCKAytg/DO9AI0tGlVYDhxy4cEmgdhOgSVdjizGXI03acpcKxCJ/01D1ffwdvgktNuWBV4ZeQc/QmX30BgDkpz4dxmWL0SGjbB9gKY+QNX3sLQ9LLy/bVyuE+qgQdmc5K/Es5vAWcO/A5Dlgo/QjrpyMySpjfW9qkC3QIBs9FNzsGlARj7qZNOzcHlAfgys+zTzS/QpYq+pC3JgqdCOvnLSbg4AN9m0zpW20oeeUMLNZdPhIlktdSPEFwbhIlZ8xgL8Ivgg+i1GBRoTEOFVTRu7NUrz9gq844IrWmoSYXW0l7v7YXdpUn8bjsNrAVqLO9Pa3Yv0veiJRZ78wK1Au0ZnN52gdryvvjyVjMY3Tz6y6EfvTJ0LlPlBHC6oi86vfGKzdfktgjlIlwQIbCEtQxE2pSbkQIotT1i5ou1hUebi+ijbXXEN0X00dYNdFf2e0OpOvwLFunYK2i9bNwAAAAASUVORK5CYII='
      };

    // npm file mode
    if (bNeedUpgrade)
      title = 'Please update your document scanning service'; //'Please follow the steps below to upgrade your local document scanning service.';
    else
      title = 'Please complete one-time setup';
    ObjString = [
      '<div class="dynamsoft-dwt-dlg-title">',
      title,
      '</div>'
    ];

    if (_this.DWT) {

      var bFirefox = Dynamsoft.navInfoSync.bFirefox;
      if (bUnix || bFirefox) {
        browserActionNeeded = 'RESTART';
      } else {
        browserActionNeeded = 'REFRESH';
      }
      ObjString.push('<div class="dynamsoft-dwt-installdlg-iconholder"> ');

      var left = '125px';
      if (bMobile) {
        left = '60px';
      }
      ObjString.push('<div class="dynamsoft-dwt-installdlg-splitline" style="left: ' + left + '"></div>');

      if (!bMobile) {
        ObjString.push('<div class="dynamsoft-dwt-installdlg-splitline" style="left: 283px"></div>');
      }

      var marginRight = '133px';
      if (bMobile) {
        marginRight = '50px';
      }
      ObjString.push('<img style="margin: 0px ' + marginRight + ' 0px 0px" src=' + imagesInBase64.icn_download + ' alt="download">');
      ObjString.push('<img style="margin: 2px ' + marginRight + ' 2px 0px" src=' + imagesInBase64.icn_install + ' alt="install">');
      ObjString.push('<img src=' + imagesInBase64.icn_scan + ' alt="scan">');
      ObjString.push('<div><span class="dynamsoft-dwt-installdlg-text" style="right: 125px">Download</span>');
      ObjString.push('<span class="dynamsoft-dwt-installdlg-text" style="right: 18px">Install</span>');
      ObjString.push('<span class="dynamsoft-dwt-installdlg-text" style="left: 105px">Scan</span>');
      ObjString.push('</div>');
      ObjString.push('</div>');

      if (bHTML5 && bUnix) {
        ObjString.push('<div style="margin:10px 0 0 60px;">');
        ObjString.push('<div id="dwt-install-url-div">');

        var arm64 = Dynamsoft.navInfo.bArm64,
          mips64 = Dynamsoft.navInfo.bMips64,
          chromeOS = Dynamsoft.navInfoSync.bChromeOS,
          harmonyOS = Dynamsoft.navInfoSync.bHarmonyOS;

        if (arm64 || mips64 || chromeOS || harmonyOS || bAndroid) { } else {
          ObjString.push('<div><input id="dwt-install-url-deb" name="dwt-install-url" type="radio" onclick="Dynamsoft._dwt_change_install_url(\'' + objInstallerUrl.deb + '\')" checked="checked" /><label for="dwt-install-url-deb">64 bit .deb (For Ubuntu/Debian)</label></div>');
          ObjString.push('<div><input id="dwt-install-url-rpm" name="dwt-install-url" type="radio" onclick="Dynamsoft._dwt_change_install_url(\'' + objInstallerUrl.rpm + '\')" /><label for="dwt-install-url-rpm">64 bit .rpm (For Fedora)</label></div>');
        }
        ObjString.push('</div></div>');
      }

      ObjString.push('<div><a id="dwt-btn-install" target="_blank" href="');
      ObjString.push(objInstallerUrl['default']);
      ObjString.push('"');
      if (bHTML5) {
        ObjString.push(' html5="1"');
      } else {
        ObjString.push(' html5="0"');
      }

      ObjString.push(' onclick="Dynamsoft._dcp_dwt_onclickInstallButton()"><div class="dynamsoft-dwt-dlg-button">Download</div></a></div>');
      if (bHTML5) {
        if (bIE) {
          ObjString.push('<div class="dynamsoft-dwt-dlg-tail" style="text-align:left; padding-left: 80px">');
          ObjString.push('If you still see the dialog after installing the Dynamsoft Service, please<br />');
          ObjString.push('1. Add the website to the zone of trusted sites.<br />');
          ObjString.push('IE | Tools | Internet Options | Security | Trusted Sites.<br />');
          ObjString.push('2. Refresh your browser.');
          ObjString.push('</div>');

        } else {

          if (bUnix) {
            ObjString.push('<div class="dynamsoft-dwt-dlg-tail">');
            ObjString.push('<div class="dynamsoft-dwt-dlg-red">After the installation, please <strong>' + browserActionNeeded + '</strong>  your browser.</div>');
            ObjString.push('</div>');
          } else if (bAndroid) {

            ObjString.push('<div class="dynamsoft-dwt-dlg-tail">');
            ObjString.push('<div class="dynamsoft-dwt-dlg">Failed to connect to the service, have you finished the setup?</div>');
            ObjString.push('<div class="dynamsoft-dwt-dlg">Please make sure the setup is done and <a href="#">click here</a> to connect again.</div>');
            ObjString.push('<div class="dynamsoft-dwt-dlg">If the connection continues to fail, please refer to <a href="#">this article</a>.</div>');
            ObjString.push('</div>');

          }

        }

      } else {
        ObjString.push('<div class="dynamsoft-dwt-dlg-tail" style="text-align:left; padding-left: 80px">');
        if (bIE) {
          ObjString.push('After the installation, please<br />');
          ObjString.push('1. Restart the browser<br />');
          ObjString.push('2. Allow "DynamicWebTWAIN" add-on to run by right clicking on the Information Bar in the browser.');
        } else {
          ObjString.push('<div class="dynamsoft-dwt-dlg-red">After installation, please <strong>REFRESH</strong> your browser.</div>');
        }
        ObjString.push('</div>');
      }
      _this.DWT.ShowMessage(ObjString.join(''), {
        width: promptDlgWidth,
        headerStyle: 1
      });
    } else {
      console.log("The Dynamsoft namespace is missing");
    }

    if (Dynamsoft.DWT && Dynamsoft.DWT.OnWebTwainNotFound) {
      Dynamsoft.DWT.OnWebTwainNotFound();
    }
  };

  Dynamsoft._dwt_change_install_url = function (url) {
    var install = document.getElementById('dwt-btn-install');
    if (install)
      install.href = url;
  };

  var reconnectTime = 0;
  Dynamsoft._dcp_dwt_onclickInstallButton = function () {
    var btnInstall = document.getElementById('dwt-btn-install');
    if (btnInstall) {
      setTimeout(function () {
        var install = document.getElementById('dwt-install-url-div');
        if (install)
          install.style.display = 'none';
        var el = document.getElementById('dwt-btn-install');
        if (el && el.getAttribute("html5") == "1") {
          var pel = el.parentNode,
            newDiv = document.createElement('div');
          newDiv.id = 'dwt-btn-install';
          newDiv.style.textAlign = "center";
          newDiv.style.paddingBottom = '15px';
          newDiv.innerHTML = 'Connecting to the service...';
          newDiv.setAttribute("html5", "1");
          pel.removeChild(el);
          pel.appendChild(newDiv);
          reconnectTime = new Date();
          setTimeout(Dynamsoft._dwt_Reconnect, 10);
        } else {
          var pel = el.parentNode;
          pel.removeChild(el);
        }
      }, 10);
    }
    return true;
  };

  Dynamsoft._dwt_Reconnect = function () {
    var _this = Dynamsoft;
    if (((new Date() - reconnectTime) / 1000) > 30) {
      // change prompt
      var el = document.getElementById('dwt-btn-install');
      if (el) {
        el.innerHTML = 'Failed to connect to the service, have you run the setup?<br />If not, please run the setup and <a href="javascript:void(0)" onclick="Dynamsoft._dcp_dwt_onclickInstallButton()">click here to connect again</a>.';
      }
      return;
    }
    if (_this.DWT) {

      var _timeSpan = 500;
      if (navigator.userAgent.indexOf("Safari") > -1) {
        _timeSpan = 2000;
      }

      _this.DWT.CheckConnectToTheService(function () {
        Dynamsoft.DWT.CloseDialog();
        Dynamsoft.DWT.ConnectToTheService();
      }, function () {
        if (Dynamsoft.DWT.NeedCheckWebTwainBySocket()) {
          Dynamsoft.DWT.CheckWebTwainBySocket(function () {
            Dynamsoft.OnHTTPCorsError();
          }, function () {
            setTimeout(Dynamsoft._dwt_Reconnect, _timeSpan);
          }, function () {
            setTimeout(Dynamsoft._dwt_Reconnect, _timeSpan);
          });
          return;
        }
        setTimeout(Dynamsoft._dwt_Reconnect, _timeSpan);
      });
    } else {
      console.log("The Dynamsoft namespace is missing");
    }
  };

  Dynamsoft._show_android_install_dialog = function (objInstallerUrl) {
    var ObjString;

    if (Dynamsoft.DWT.bNpm && Dynamsoft.navInfoSync.bFileSystem) {
      return Dynamsoft._show_online_download_dialog(objInstallerUrl, bHTML5, iPlatform);
    }

    ObjString = [];

    if (Dynamsoft.DWT) {

      ObjString.push('<div class="ds-dwt-ui-dlg-android">');

      ObjString.push('<div>Please download and install the <strong>DYNAMSOFT SERVICE</strong> app via the </div>');

      ObjString.push('<div><a target="_blank" href="');
      ObjString.push(objInstallerUrl['default']);
      ObjString.push('" onclick="Dynamsoft._dwt_ReconnectForAndroid()">direct APK download link</a>.</div>');
      ObjString.push('</div>');

      ObjString.push('<div class="dynamsoft-dwt-dlg-tail" style="text-align:left">');
      ObjString.push('If you have installed it, please click on the button below to initiate the connection.');

      ObjString.push('<a target="_blank" href="');
      ObjString.push(objInstallerUrl.openService);
      ObjString.push('" onclick="Dynamsoft._dwt_ReconnectForAndroid()"><div class="dynamsoft-dwt-dlg-button-android">Open Service</div></a>');

      ObjString.push('</div>');

      ObjString.push('</div>');

      Dynamsoft.DWT.ShowMessage(ObjString.join(''), {
        width: 335,
        headerStyle: 1,
        backgroundStyle: 1
      });
    } else {
      console.log("The Dynamsoft namespace is missing");
    }

    if (Dynamsoft.DWT && Dynamsoft.DWT.OnWebTwainNotFound) {
      Dynamsoft.DWT.OnWebTwainNotFound();
    }
  };

  Dynamsoft._dwt_ReconnectForAndroid = function () {
    Dynamsoft.DWT.CheckConnectToTheService(function (bConnected) {
      if (bConnected) {
        Dynamsoft.DWT.CloseDialog();
        Dynamsoft.DWT.ConnectToTheService();
      } else {
        setTimeout(Dynamsoft._dwt_ReconnectForAndroid, 500);
      }

    }, function () {
      setTimeout(Dynamsoft._dwt_ReconnectForAndroid, 500);
    });
  }

  //Dynamsoft.OnWebTwainNotFoundOnAndroidCallback = Dynamsoft.MobileNotSupportCallback;
  //------------------------end Install Dilaog---------------------------


  //----------------------start Upgrade Dialog---------------------------

  Dynamsoft.OnWebTwainNeedUpgradeCallback = function (ProductName, objInstallerUrl, bHTML5, iPlatform, bIE, bSafari, bSSL, strIEVersion) {
    Dynamsoft._show_install_dialog(ProductName, objInstallerUrl, bHTML5, iPlatform, bIE, bSafari, bSSL, strIEVersion, true, true);
  };

  //----------------------end Upgrade Dialog---------------------------

  //----------------------start DLS License -----------------------
  Dynamsoft.OnLTSLicenseError = function (message, code) {

    var addMessage = '',
      ObjString;

    if (code == -2440 || // NetworkError
      code == -2441 || // Timedout
      code == -2443 || // CorsError
      code == -2446 || // LtsJsLoadError
      message.indexOf('Internet connection') > -1 ||
      message.indexOf('Storage') > -1) {

      var purchaseUrl = 'https://www.dynamsoft.com/customer/license/trialLicense?product=dwt&deploymenttype=js';
      addMessage = '<div>You can register for a free 30-day trial <a href="' + purchaseUrl + '" target="_blank" class="dynamsoft-major-color">here</a>. Make sure to select the product Dynamic Web TWAIN.</div>';
    }

    ObjString = [
      message,
      addMessage
    ];

    Dynamsoft.DWT.ShowMessage(ObjString.join(''), {
      width: promptDlgWidth2,
      headerStyle: 2
    });
  };

  Dynamsoft.OnLTSConnectionWarning = function () {

    var ObjString = [
      'Warning: You are seeing this dialog because Dynamic Web TWAIN has failed to connect to the License Tracking Server. ',
      'A cached authorization is being used, and you can continue to use the software as usual. ',
      'Please get connected to the network as soon as possible. ',
      Dynamsoft.DWT.isPublicLicense() ? '<a class="dynamsoft-major-color" href="https://www.dynamsoft.com/company/contact/">Contact Dynamsoft</a> ' : 'Contact the site administrator ',
      'for more information.'
    ].join('');

    Dynamsoft.DWT.ShowMessage(ObjString, {
      width: promptDlgWidth2,
      caption: 'Warning',
      headerStyle: 2
    });
  };

  Dynamsoft.OnLTSPublicLicenseWarning = function (message) {

    Dynamsoft.DWT.ShowMessage(message, {
      width: promptDlgWidth2,
      caption: 'Warning',
      headerStyle: 2
    });
  };

  //--------------------end DLS License-------------------------------

  //----------------------start Product Key -----------------------
  Dynamsoft.OnLicenseExpiredWarning = function (strExpiredDate, remain, trial) {

    var ObjString, strCaption,
      a_contact_us = '<a target="_blank" href="https://www.dynamsoft.com/company/contact/">contact us</a>',
      a_online_store = '<a target="_blank" href="https://www.dynamsoft.com/store/dynamic-web-twain/#DynamicWebTWAIN">online store</a>',
      a_new_key_href = 'https://www.dynamsoft.com/customer/license/trialLicense?product=dwt&utm_source=in-product',
      a_renew_key_href = 'https://www.dynamsoft.com/customer/order/renewalList';

    if (remain > 5) {

    } else if (trial && remain > 0) { // 1~5

      var strDays;

      if (remain <= 1) {
        strDays = '1 day';
      } else {
        strDays = parseInt(remain) + ' days';
      }

      strCaption = 'Warning';
      ObjString = [
        '<div style="padding:0 0 10px 0">Kindly note your trial key is expiring in ', strDays, '. Two quick steps to extend your trial:</div>',
        '<div style="margin:0 0 0 10px">1. <a target="_blank" href="', a_new_key_href, '">Request a new trial key</a> and follow the instructions to set the new key</div>',
        '<div style="margin:0 0 0 10px">2. Refresh your scan page and try again</div>',
        '<div style="padding:10px 0 0 0">If you run into any issues, please ', a_contact_us, '.</div>',
        '<div style="padding:0">If you are ready to purchase a full license, please go to the ', a_online_store, ' or ', a_contact_us, '.</div>'
      ].join('');

    } else {
      
      if(trial) {
        // Trial remain<=0 Expired
        ObjString = [
          '<div style="padding:0">Sorry. Your product key has expired on ', strExpiredDate, '. You can purchase a full license at the ', a_online_store, '.</div>',
          '<div style="padding:0">Or, you can try requesting a new product key at <a target="_blank" href="', a_new_key_href, '">this page</a>.</div>',
          '<div style="padding:0">If you need any help, please ', a_contact_us, '.</div>'
        ].join('');
      } else {

        ObjString = [
          '<div style="padding:0">You are seeing this message because the license for doc scanning support has expired on ', strExpiredDate, '.</div>',
          '<div style="padding:0"><ul>',
          "<li><strong>If you are the owner of the website</strong>, please <a class='dynamsoft-major-color' href='", a_renew_key_href, "' target='_blank'>renew your license</a> and follow the instructions to set the new key. ",
          'Please ', a_contact_us, ' if you need any help.</li>',
          '<li><strong>If you are an end-user</strong>, please inform the owner or developer of this website.</li>',
          '</ul></div>'
        ].join('');
      }

    }

    if (ObjString) {
      Dynamsoft.DWT.ShowMessage(ObjString, {
        width: promptDlgWidth2,
        caption: strCaption,
        headerStyle: 2
      });
    }
  };

  Dynamsoft.OnLicenseError = Dynamsoft.OnLicenseError || function (message, errorCode) {

    Dynamsoft.DWT.ShowMessage(message, {
      width: promptDlgWidth2,
      headerStyle: 2
    });

  };
  //--------------------end Product Key-------------------------------



  // -- npm start
  Dynamsoft._show_online_download_dialog = function (objInstallerUrl, bHTML5, iPlatform) {
    var ObjString,
      vers = Dynamsoft.DWT.JSVersion.split(','),
      strV = vers[0] + '.' + vers[1],
      page_path = location.pathname,
      online_url, local_file_path, ext;
    page_path = page_path.substring(0, page_path.lastIndexOf('/') + 1);

    if (iPlatform == Dynamsoft.DWT.EnumDWT_PlatformType.enumLinux) {
      if (arm64 || mips64) {
        if (arm64)
          objInstallerUrl['default'] = getDebPath('arm64');
        else if (mips64)
          objInstallerUrl['default'] = getDebPath('mips64el');
      } else {
      }
    }
    ext = objInstallerUrl['default'].substr(objInstallerUrl['default'].length - 3);

    online_url = ['https://www.dynamsoft.com/web-twain/install-dynamsoft-service/?productId=1000001',
      '&downloadLink=https://demo.dynamsoft.com/DWT/Resources/dist/DynamsoftServiceSetup_',
      strV, '.',
      ext].join('');

    local_file_path = Dynamsoft.Lib.Path.normalize([
      page_path,
      objInstallerUrl['default']
    ].join(''));

    if (iPlatform == Dynamsoft.DWT.EnumDWT_PlatformType.enumWindow) {
      if (local_file_path.indexOf('/') == 0) {
        local_file_path = local_file_path.substr(1);
      }
    }

    ObjString = [
      '<div class="dynamsoft-dwt-ltsdlg-body" style="padding:0 20px 20px 20px">',
      '<div>To support document scanning, please complete one-time installation of the DynamsoftServiceSetup.', ext, ' on this machine.</div>',
      '<div>You can download the file via this trust site:</div>',
      '<div><a id="dwt-btn-install" target="_blank" href="',
      online_url,
      '"><div class="dynamsoft-dwt-dlg-button">Open Site</div></a></div>',
      '<div style="word-break: break-word;">Or, go to <br />',
      local_file_path,
      ' if the file exists.</div>',
      '<div>After the installation, please <strong>REFRESH</strong>  your browser.<br /></div>',
      '</div>'
    ];

    Dynamsoft.DWT.ShowMessage(ObjString.join(''), { width: promptDlgWidth, headerStyle: 1, closeButton: false });
  };
  // -- npm end

})(); 
/**
 * Basic Configuration (config.js with differences)
 */
Dynamsoft.DWT.AutoLoad = false;
Dynamsoft.DWT.IfAddMD5InUploadHeader = false;
Dynamsoft.DWT.IfConfineMaskWithinTheViewer = false;
