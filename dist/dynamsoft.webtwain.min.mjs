// @20230105 183608 
/*
* @name: dwt all-in-one package
* @version: 18.1
* @components:
*   + Dynamsoft Dynamic Web TWAIN version: 18.1
*   + Dynamsoft Barcode Reader Addon for DWT version 18.1 (DBR version 9.4)
*   + Dynamsoft PDF Rasterizer Addon for DWT version: 18.1
*   + Dynamsoft OCR Basic Addon for DWT version: 18.1
*   + Dynamsoft OCR Pro Addon for DWT version: 18.1
*   + Dynamsoft Webcam Addon for DWT version: 18.1
*   + Dynamsoft File Uploader version: 18.1
*/

 
/*! 20230105181423 - 20221201
* Dynamsoft JavaScript Library
* Product: Dynamsoft Web Twain
* Web Site: https://www.dynamsoft.com
*
* Copyright 2023, Dynamsoft Corporation
* Author: Dynamsoft Support Team
* Version: 18.1
*/
/// Dynamsoft JavaScript Core, version 6.1.15 20221208163105

var bNode=!!("object"==typeof global&&global.process&&global.process.release&&global.process.release.name&&"undefined"==typeof HTMLCanvasElement),globalThis=bNode?global:self||{},Dynamsoft=globalThis.Dynamsoft||{Lib:{}};!function(o){o.Lib||(o.Lib={}),o.DWT||(o.DWT={});o=o.Lib;o.bNode=bNode,o.noop=function(){},o._defaultAgent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36",o._defaultPlatform="Win64",globalThis&&(globalThis.Dynamsoft=Dynamsoft)}(Dynamsoft);!function(){"use strict";var e=globalThis.Dynamsoft,z=!0;function t(e,t){var i,s,n,o,e=e.toLowerCase(),t=t.toLowerCase(),r=/harmonyos/g.test(e),a=("linux"==t&&0<=e.indexOf("windows nt")&&(t="harmonyos",r=!0),!r&&/cros/.test(e)),d=!r&&/android/g.test(e)||/android/g.test(t),b=/iphone/g.test(e)||/iphone/g.test(t),c=/macintosh/.test(e),l=navigator.maxTouchPoints||0,c=/ipad/g.test(e)||(c||"macintel"==t)&&1<l,l=/ucweb|ucbrowser/g.test(e),f=!l&&/nexus/g.test(e)&&/version\/[\d.]+.*safari\//g.test(e),g=/playbook/g.test(e),x=/hp-tablet/g.test(e),m=/blackberry|bb10/g.test(e),w=/symbian/g.test(e),O=/windows phone/g.test(e),h=/mobile/g.test(e),u=/arm64|aarch64/g.test(e),p=/mips64/g.test(e),v=/huaweibrowser/g.test(e),y=/jsdom/g.test(e),x=g||c||x,h=!x&&!a&&(b||f||m||w||O||d||r||h),S=!h&&!x&&!a,L=S&&/win32|win64|windows/.test(t),U=L&&/win64|x64/.test(e),M=S&&/mac68k|macppc|macintosh|macintel/.test(e),S=S&&/linux/.test(t),t="win64"==t||/wow64|x86_64|win64|x64/.test(e)||u||p,D=/wow64/g.test(e),A=!1,C=/opera|opr/g.test(e),V=/360se/g.test(e),_=/maxthon/g.test(e),j=/tencenttraveler|qqbrowser/g.test(e),F=/the world/g.test(e),N=/metasr/g.test(e),q=/avant/g.test(e),E=/firefox|fxios/g.test(e),J=/gecko/g.test(e),I=!(E||v)&&/edge\/|edga\/|edgios\/|edg\//g.test(e),k=!(m||g||l||C||I||v||y)&&/chrome|crios/g.test(e),P=h||x,T=!1,B="",W=0,G=0,H="";return!L||I||E||k||(s=e.indexOf("msie "),n=e.indexOf("trident"),o=e.indexOf("rv:"),T=-1!=s||-1!=n||-1!=o),!(M||b||c||L||m||g||f)||l||C||I||T||E||(i=e.match(/version\/([\d.]+).*safari\//))&&(m||g||f||(k=!(A=z)),H=i[1]),I?(-1<(s=e.indexOf("edge/"))?s+=5:-1<(s=e.indexOf("edg/"))?s+=4:-1<(s=e.indexOf("edga/"))?s+=5:-1<(s=e.indexOf("edgios/"))&&(s+=7),-1<s&&-1<(i=(H=e.slice(s)).indexOf(" "))&&(H=H.slice(0,i)),P=z):E?(i=e.indexOf("firefox/"),P=z,-1<i?(i=-1<(n=(H=i=-1<(n=(i=e.slice(i+8)).indexOf(" "))?i.slice(0,n):i).indexOf("."))?H.slice(0,n):i)<27&&(P=!1):(b||c)&&-1<(i=e.indexOf("fxios/"))&&(H=i=(i=e.slice(i+6)).slice(0,i.indexOf(" ")))):T?(o=e.indexOf("msie "),m=e.indexOf("trident"),g=e.indexOf("rv:"),-1!=o?B=i=(i=e.slice(o+5)).slice(0,i.indexOf(";")):-1!=g?B=i=(i=(i=e.slice(g+3)).slice(0,i.indexOf(";"))).slice(0,i.indexOf(")")):-1!=m&&(B=i=(i=e.slice(m+7)).slice(0,i.indexOf(";"))),(""===B||10<=parseInt(B))&&(P=z),H=i):A?(i=H.indexOf("."),P=z,-1<i&&(i=H.slice(0,i))<7&&(P=!1)):l?(-1<(i=e.indexOf("ucweb"))?H=e.slice(i+5):-1<(i=e.indexOf("ucbrowser/"))&&-1<(i=(H=e.slice(i+10)).indexOf(" "))&&(H=H.slice(0,i)),P=z):C?(-1<(i=e.indexOf("version/"))?H=e.slice(i+8):-1<(i=e.indexOf("opr/"))&&(H=e.slice(i+4)),P=z):w?(-1<(i=e.indexOf("browserng/"))&&(H=e.slice(i+10)),P=z):O?(-1<(i=e.indexOf("iemobile/"))&&(H=e.slice(i+9)),P=z):k?(-1<(s=e.indexOf("chrome/"))?-1<(i=(H=e.slice(s+7)).indexOf(" "))&&(H=H.slice(0,i)):-1<(s=e.indexOf("crios/"))&&-1<(i=(H=e.slice(s+6)).indexOf(" "))&&(H=H.slice(0,i)),P=z,-1<(i=H.indexOf("."))&&(i=H.slice(0,i))<27&&(P=!1)):v?(-1<(n=e.indexOf("huaweibrowser"))&&-1<(i=(H=e.slice(n+14)).indexOf(" "))&&(H=H.slice(0,i)),P=z):y&&(-1<(o=e.indexOf("jsdom"))&&-1<(i=(H=e.slice(o+6)).indexOf(" "))&&(H=H.slice(0,i)),P=z),(I||T)&&((g=window&&window.document)&&g.documentMode?W=g.documentMode:(W=5,g.compatMode&&"CSS1Compat"==g.compatMode&&(W=7)),T&&(G=parseInt(H))),(M||S)&&(t=!0,M&&(i=e.match(/mac os x (\d+)(_|\.)(\d+)/))&&3<i.length&&(10==i[1]&&i[3]<14||i[1]<10)&&(t=!1)),{bUseUserAgent:!0,bWin:L,bMac:M,bLinux:S,bMobile:h=L||M||S||u||p?h:!0,bPad:x,bChromeOS:a,bHarmonyOS:r,bArm64:u,bMips64:p,bEmbed:u||p,bAndroid:d,biPhone:b,biPad:c,bWin64:U,bWOW64:D,bOSx64:t,bIE:T,bEdge:I,bChrome:k,bFirefox:E,bSafari:A,bOpera:C,bNexus:f,bUC:l,b360SE:V,bMaxthon:_,bTencentTraveler:j,bTheWorld:F,bMetaSr:N,bAvant:q,bHuaWeiBrowser:v,bJSDom:y,bGecko:J,bHTML5Edition:P,strBrowserVersion:H,IEVersion:G,IEMode:W}}function i(){}var s,n,o,r,a=e.Lib,d=navigator;a.bNode?(a.win=global,r=t(a._defaultAgent,a._defaultPlatform),e.navInfo=r):("object"==typeof window?(a.win=window,a.doc=window.document):a.win={},b=!0,o=void 0,"userAgentData"in d&&(n=[],(s=d.userAgentData).platform&&""!=s.platform&&("brands"in s&&Array.isArray(s.brands)&&0<s.brands.length?n=s.brands:"uaList"in s&&Array.isArray(s.uaList)&&0<s.uaList.length&&(n=s.uaList),0<n.length&&(b=!1,o=s.platform.toLowerCase(),r=function(e,t,i){for(var s,n,o,r,a,d=!1,b=!1,c=!1,l=e.mobile,f=!1,g="",x=navigator.maxTouchPoints||0,m=t.length,w=0;w<m;w++){var O=t[w].brand.toLowerCase();if(0<=O.indexOf("chrome")){c=!0,g=t[w].version;break}if(0<=O.indexOf("edge")){d=!0,g=t[w].version;break}if(0<=O.indexOf("opera")){b=!0,g=t[w].version;break}}return c||d||b||(c=!0,g="100"),{bUseUserAgent:!1,bWin:s=/windows/g.test(i),bMac:/mac/g.test(i),bLinux:n=/linux/g.test(i),bAndroid:o=/android/g.test(i),bHarmonyOS:r=/harmony/g.test(i),bChromeOS:/(chromeos|chrome\sos)/g.test(i),bIE:!1,bEdge:d,bUC:!1,bPlaybook:!1,bBlackBerry:!1,bHuaWeiBrowser:!1,bOpera:b,bFirefox:!1,bChrome:c,bJSDom:!1,biPhone:a=/iphone/g.test(i),biPad:f=s||o||n||a?f:/macintel/g.test(i)&&1<x,bPad:o&&!e.mobile,bSafari:!1,bMobile:l=o||r||a||f?!0:l,strBrowserVersion:g,bHTML5Edition:!0,IEVersion:0,IEMode:0}}(s,n,o)))),b&&(r=t(d.userAgent.toLowerCase(),o=d.platform.toLowerCase()),e.navInfo=r)),a.doc||(a.doc={getElementById:i,getElementsByTagName:i,styleSheets:[]});var b=(b=null==(n=null==(s=a.win)?void 0:s.location)?void 0:n.protocol)||"http:";r.protocol=b,r.bSSL="https:"===b,r.bFileSystem="https:"!==b&&"http:"!==b,e.navInfoSync=r}();if(Dynamsoft.navInfoSync.bIE){
/* @preserve
 * The MIT License (MIT)
 * 
 * Copyright (c) 2013-2018 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
/**
 * bluebird build version 3.7.2
 * Features enabled: core, race, call_get, generators, map, nodeify, promisify, props, reduce, settle, some, using, timers, filter, any, each
*/
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.Promise=t()}}(function(){var t,e,n;return function r(t,e,n){function i(s,a){if(!e[s]){if(!t[s]){var c="function"==typeof _dereq_&&_dereq_;if(!a&&c)return c(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=e[s]={exports:{}};t[s][0].call(l.exports,function(e){var n=t[s][1][e];return i(n?n:e)},l,l.exports,r,t,e,n)}return e[s].exports}for(var o="function"==typeof _dereq_&&_dereq_,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(t,e,n){"use strict";e.exports=function(t){function e(t){var e=new n(t),r=e.promise();return e.setHowMany(1),e.setUnwrap(),e.init(),r}var n=t._SomePromiseArray;t.any=function(t){return e(t)},t.prototype.any=function(){return e(this)}}},{}],2:[function(t,e,n){"use strict";function r(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new f(16),this._normalQueue=new f(16),this._haveDrainedQueues=!1;var t=this;this.drainQueues=function(){t._drainQueues()},this._schedule=p}function i(t,e,n){this._lateQueue.push(t,e,n),this._queueTick()}function o(t,e,n){this._normalQueue.push(t,e,n),this._queueTick()}function s(t){this._normalQueue._pushOne(t),this._queueTick()}function a(t){for(;t.length()>0;)c(t)}function c(t){var e=t.shift();if("function"!=typeof e)e._settlePromises();else{var n=t.shift(),r=t.shift();e.call(n,r)}}var u;try{throw new Error}catch(l){u=l}var p=t("./schedule"),f=t("./queue");r.prototype.setScheduler=function(t){var e=this._schedule;return this._schedule=t,this._customScheduler=!0,e},r.prototype.hasCustomScheduler=function(){return this._customScheduler},r.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},r.prototype.fatalError=function(t,e){e?(process.stderr.write("Fatal "+(t instanceof Error?t.stack:t)+"\n"),process.exit(2)):this.throwLater(t)},r.prototype.throwLater=function(t,e){if(1===arguments.length&&(e=t,t=function(){throw e}),"undefined"!=typeof setTimeout)setTimeout(function(){t(e)},0);else try{this._schedule(function(){t(e)})}catch(n){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},r.prototype.invokeLater=i,r.prototype.invoke=o,r.prototype.settlePromises=s,r.prototype._drainQueues=function(){a(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,a(this._lateQueue)},r.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},r.prototype._reset=function(){this._isTickUsed=!1},e.exports=r,e.exports.firstLineError=u},{"./queue":26,"./schedule":29}],3:[function(t,e,n){"use strict";e.exports=function(t,e,n,r){var i=!1,o=function(t,e){this._reject(e)},s=function(t,e){e.promiseRejectionQueued=!0,e.bindingPromise._then(o,o,null,this,t)},a=function(t,e){0===(50397184&this._bitField)&&this._resolveCallback(e.target)},c=function(t,e){e.promiseRejectionQueued||this._reject(t)};t.prototype.bind=function(o){i||(i=!0,t.prototype._propagateFrom=r.propagateFromFunction(),t.prototype._boundValue=r.boundValueFunction());var u=n(o),l=new t(e);l._propagateFrom(this,1);var p=this._target();if(l._setBoundTo(u),u instanceof t){var f={promiseRejectionQueued:!1,promise:l,target:p,bindingPromise:u};p._then(e,s,void 0,l,f),u._then(a,c,void 0,l,f),l._setOnCancel(u)}else l._resolveCallback(p);return l},t.prototype._setBoundTo=function(t){void 0!==t?(this._bitField=2097152|this._bitField,this._boundTo=t):this._bitField=-2097153&this._bitField},t.prototype._isBound=function(){return 2097152===(2097152&this._bitField)},t.bind=function(e,n){return t.resolve(n).bind(e)}}},{}],4:[function(t,e,n){"use strict";function r(){try{Promise===o&&(Promise=i)}catch(t){}return o}var i;"undefined"!=typeof Promise&&(i=Promise);var o=t("./promise")();o.noConflict=r,e.exports=o},{"./promise":22}],5:[function(t,e,n){"use strict";var r=Object.create;if(r){var i=r(null),o=r(null);i[" size"]=o[" size"]=0}e.exports=function(e){function n(t,n){var r;if(null!=t&&(r=t[n]),"function"!=typeof r){var i="Object "+a.classString(t)+" has no method '"+a.toString(n)+"'";throw new e.TypeError(i)}return r}function r(t){var e=this.pop(),r=n(t,e);return r.apply(t,this)}function i(t){return t[this]}function o(t){var e=+this;return 0>e&&(e=Math.max(0,e+t.length)),t[e]}var s,a=t("./util"),c=a.canEvaluate;a.isIdentifier;e.prototype.call=function(t){var e=[].slice.call(arguments,1);return e.push(t),this._then(r,void 0,void 0,e,void 0)},e.prototype.get=function(t){var e,n="number"==typeof t;if(n)e=o;else if(c){var r=s(t);e=null!==r?r:i}else e=i;return this._then(e,void 0,void 0,t,void 0)}}},{"./util":36}],6:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){var o=t("./util"),s=o.tryCatch,a=o.errorObj,c=e._async;e.prototype["break"]=e.prototype.cancel=function(){if(!i.cancellation())return this._warn("cancellation is disabled");for(var t=this,e=t;t._isCancellable();){if(!t._cancelBy(e)){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}var n=t._cancellationParent;if(null==n||!n._isCancellable()){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}t._isFollowing()&&t._followee().cancel(),t._setWillBeCancelled(),e=t,t=n}},e.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},e.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},e.prototype._cancelBy=function(t){return t===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),this._enoughBranchesHaveCancelled()?(this._invokeOnCancel(),!0):!1)},e.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},e.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),c.invoke(this._cancelPromises,this,void 0))},e.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},e.prototype._unsetOnCancel=function(){this._onCancelField=void 0},e.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},e.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},e.prototype._doInvokeOnCancel=function(t,e){if(o.isArray(t))for(var n=0;n<t.length;++n)this._doInvokeOnCancel(t[n],e);else if(void 0!==t)if("function"==typeof t){if(!e){var r=s(t).call(this._boundValue());r===a&&(this._attachExtraTrace(r.e),c.throwLater(r.e))}}else t._resultCancelled(this)},e.prototype._invokeOnCancel=function(){var t=this._onCancel();this._unsetOnCancel(),c.invoke(this._doInvokeOnCancel,this,t)},e.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},e.prototype._resultCancelled=function(){this.cancel()}}},{"./util":36}],7:[function(t,e,n){"use strict";e.exports=function(e){function n(t,n,a){return function(c){var u=a._boundValue();t:for(var l=0;l<t.length;++l){var p=t[l];if(p===Error||null!=p&&p.prototype instanceof Error){if(c instanceof p)return o(n).call(u,c)}else if("function"==typeof p){var f=o(p).call(u,c);if(f===s)return f;if(f)return o(n).call(u,c)}else if(r.isObject(c)){for(var h=i(p),_=0;_<h.length;++_){var d=h[_];if(p[d]!=c[d])continue t}return o(n).call(u,c)}}return e}}var r=t("./util"),i=t("./es5").keys,o=r.tryCatch,s=r.errorObj;return n}},{"./es5":13,"./util":36}],8:[function(t,e,n){"use strict";e.exports=function(t){function e(){this._trace=new e.CapturedTrace(r())}function n(){return i?new e:void 0}function r(){var t=o.length-1;return t>=0?o[t]:void 0}var i=!1,o=[];return t.prototype._promiseCreated=function(){},t.prototype._pushContext=function(){},t.prototype._popContext=function(){return null},t._peekContext=t.prototype._peekContext=function(){},e.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,o.push(this._trace))},e.prototype._popContext=function(){if(void 0!==this._trace){var t=o.pop(),e=t._promiseCreated;return t._promiseCreated=null,e}return null},e.CapturedTrace=null,e.create=n,e.deactivateLongStackTraces=function(){},e.activateLongStackTraces=function(){var n=t.prototype._pushContext,o=t.prototype._popContext,s=t._peekContext,a=t.prototype._peekContext,c=t.prototype._promiseCreated;e.deactivateLongStackTraces=function(){t.prototype._pushContext=n,t.prototype._popContext=o,t._peekContext=s,t.prototype._peekContext=a,t.prototype._promiseCreated=c,i=!1},i=!0,t.prototype._pushContext=e.prototype._pushContext,t.prototype._popContext=e.prototype._popContext,t._peekContext=t.prototype._peekContext=r,t.prototype._promiseCreated=function(){var t=this._peekContext();t&&null==t._promiseCreated&&(t._promiseCreated=this)}},e}},{}],9:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){function o(t,e){return{promise:e}}function s(){return!1}function a(t,e,n){var r=this;try{t(e,n,function(t){if("function"!=typeof t)throw new TypeError("onCancel must be a function, got: "+B.toString(t));r._attachCancellationCallback(t)})}catch(i){return i}}function c(t){if(!this._isCancellable())return this;var e=this._onCancel();void 0!==e?B.isArray(e)?e.push(t):this._setOnCancel([e,t]):this._setOnCancel(t)}function u(){return this._onCancelField}function l(t){this._onCancelField=t}function p(){this._cancellationParent=void 0,this._onCancelField=void 0}function f(t,e){if(0!==(1&e)){this._cancellationParent=t;var n=t._branchesRemainingToCancel;void 0===n&&(n=0),t._branchesRemainingToCancel=n+1}0!==(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)}function h(t,e){0!==(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)}function _(){var t=this._boundTo;return void 0!==t&&t instanceof e?t.isFulfilled()?t.value():void 0:t}function d(){this._trace=new V(this._peekContext())}function v(t,e){if(q(t)){var n=this._trace;if(void 0!==n&&e&&(n=n._parent),void 0!==n)n.attachExtraTrace(t);else if(!t.__stackCleaned__){var r=F(t);B.notEnumerableProp(t,"stack",r.message+"\n"+r.stack.join("\n")),B.notEnumerableProp(t,"__stackCleaned__",!0)}}}function y(){this._trace=void 0}function g(t,e,n,r,i){if(void 0===t&&null!==e&&Z){if(void 0!==i&&i._returnedNonUndefined())return;if(0===(65535&r._bitField))return;n&&(n+=" ");var o="",s="";if(e._trace){for(var a=e._trace.stack.split("\n"),c=k(a),u=c.length-1;u>=0;--u){var l=c[u];if(!Q.test(l)){var p=l.match(G);p&&(o="at "+p[1]+":"+p[2]+":"+p[3]+" ");break}}if(c.length>0)for(var f=c[0],u=0;u<a.length;++u)if(a[u]===f){u>0&&(s="\n"+a[u-1]);break}}var h="a promise was created in a "+n+"handler "+o+"but was not returned from it, see http://goo.gl/rRqMUw"+s;r._warn(h,!0,e)}}function m(t,e){var n=t+" is deprecated and will be removed in a future version.";return e&&(n+=" Use "+e+" instead."),b(n)}function b(t,n,r){if(lt.warnings){var i,o=new U(t);if(n)r._attachExtraTrace(o);else if(lt.longStackTraces&&(i=e._peekContext()))i.attachExtraTrace(o);else{var s=F(o);o.stack=s.message+"\n"+s.stack.join("\n")}ot("warning",o)||x(o,"",!0)}}function w(t,e){for(var n=0;n<e.length-1;++n)e[n].push("From previous event:"),e[n]=e[n].join("\n");return n<e.length&&(e[n]=e[n].join("\n")),t+"\n"+e.join("\n")}function C(t){for(var e=0;e<t.length;++e)(0===t[e].length||e+1<t.length&&t[e][0]===t[e+1][0])&&(t.splice(e,1),e--)}function j(t){for(var e=t[0],n=1;n<t.length;++n){for(var r=t[n],i=e.length-1,o=e[i],s=-1,a=r.length-1;a>=0;--a)if(r[a]===o){s=a;break}for(var a=s;a>=0;--a){var c=r[a];if(e[i]!==c)break;e.pop(),i--}e=r}}function k(t){for(var e=[],n=0;n<t.length;++n){var r=t[n],i="    (No stack trace)"===r||z.test(r),o=i&&at(r);i&&!o&&(W&&" "!==r.charAt(0)&&(r="    "+r),e.push(r))}return e}function E(t){for(var e=t.stack.replace(/\s+$/g,"").split("\n"),n=0;n<e.length;++n){var r=e[n];if("    (No stack trace)"===r||z.test(r))break}return n>0&&"SyntaxError"!=t.name&&(e=e.slice(n)),e}function F(t){var e=t.stack,n=t.toString();return e="string"==typeof e&&e.length>0?E(t):["    (No stack trace)"],{message:n,stack:"SyntaxError"==t.name?e:k(e)}}function x(t,e,n){if("undefined"!=typeof console){var r;if(B.isObject(t)){var i=t.stack;r=e+X(i,t)}else r=e+String(t);"function"==typeof I?I(r,n):("function"==typeof console.log||"object"==typeof console.log)&&console.log(r)}}function T(t,e,n,r){var i=!1;try{"function"==typeof e&&(i=!0,"rejectionHandled"===t?e(r):e(n,r))}catch(o){N.throwLater(o)}"unhandledRejection"===t?ot(t,n,r)||i||x(n,"Unhandled rejection "):ot(t,r)}function P(t){var e;if("function"==typeof t)e="[function "+(t.name||"anonymous")+"]";else{e=t&&"function"==typeof t.toString?t.toString():B.toString(t);var n=/\[object [a-zA-Z0-9$_]+\]/;if(n.test(e))try{var r=JSON.stringify(t);e=r}catch(i){}0===e.length&&(e="(empty array)")}return"(<"+R(e)+">, no stack trace)"}function R(t){var e=41;return t.length<e?t:t.substr(0,e-3)+"..."}function S(){return"function"==typeof ut}function O(t){var e=t.match(ct);return e?{fileName:e[1],line:parseInt(e[2],10)}:void 0}function A(t,e){if(S()){for(var n,r,i=(t.stack||"").split("\n"),o=(e.stack||"").split("\n"),s=-1,a=-1,c=0;c<i.length;++c){var u=O(i[c]);if(u){n=u.fileName,s=u.line;break}}for(var c=0;c<o.length;++c){var u=O(o[c]);if(u){r=u.fileName,a=u.line;break}}0>s||0>a||!n||!r||n!==r||s>=a||(at=function(t){if($.test(t))return!0;var e=O(t);return e&&e.fileName===n&&s<=e.line&&e.line<=a?!0:!1})}}function V(t){this._parent=t,this._promisesCreated=0;var e=this._length=1+(void 0===t?0:t._length);ut(this,V),e>32&&this.uncycle()}var H,D,I,L,N=e._async,U=t("./errors").Warning,B=t("./util"),M=t("./es5"),q=B.canAttachTrace,$=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,Q=/\((?:timers\.js):\d+:\d+\)/,G=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,z=null,X=null,W=!1,K=!(0==B.env("BLUEBIRD_DEBUG")||!B.env("BLUEBIRD_DEBUG")&&"development"!==B.env("NODE_ENV")),J=!(0==B.env("BLUEBIRD_WARNINGS")||!K&&!B.env("BLUEBIRD_WARNINGS")),Y=!(0==B.env("BLUEBIRD_LONG_STACK_TRACES")||!K&&!B.env("BLUEBIRD_LONG_STACK_TRACES")),Z=0!=B.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(J||!!B.env("BLUEBIRD_W_FORGOTTEN_RETURN"));!function(){function t(){for(var t=0;t<r.length;++t)r[t]._notifyUnhandledRejection();n()}function n(){r.length=0}var r=[];L=function(e){r.push(e),setTimeout(t,1)},M.defineProperty(e,"_unhandledRejectionCheck",{value:t}),M.defineProperty(e,"_unhandledRejectionClear",{value:n})}(),e.prototype.suppressUnhandledRejections=function(){var t=this._target();t._bitField=-1048577&t._bitField|524288},e.prototype._ensurePossibleRejectionHandled=function(){0===(524288&this._bitField)&&(this._setRejectionIsUnhandled(),L(this))},e.prototype._notifyUnhandledRejectionIsHandled=function(){T("rejectionHandled",H,void 0,this)},e.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},e.prototype._returnedNonUndefined=function(){return 0!==(268435456&this._bitField)},e.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var t=this._settledValue();this._setUnhandledRejectionIsNotified(),T("unhandledRejection",D,t,this)}},e.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},e.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},e.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},e.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},e.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},e.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},e.prototype._warn=function(t,e,n){return b(t,e,n||this)},e.onPossiblyUnhandledRejection=function(t){var n=e._getContext();D=B.contextBind(n,t)},e.onUnhandledRejectionHandled=function(t){var n=e._getContext();H=B.contextBind(n,t)};var tt=function(){};e.longStackTraces=function(){if(N.haveItemsQueued()&&!lt.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!lt.longStackTraces&&S()){var t=e.prototype._captureStackTrace,r=e.prototype._attachExtraTrace,i=e.prototype._dereferenceTrace;lt.longStackTraces=!0,tt=function(){if(N.haveItemsQueued()&&!lt.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");e.prototype._captureStackTrace=t,e.prototype._attachExtraTrace=r,e.prototype._dereferenceTrace=i,n.deactivateLongStackTraces(),lt.longStackTraces=!1},e.prototype._captureStackTrace=d,e.prototype._attachExtraTrace=v,e.prototype._dereferenceTrace=y,n.activateLongStackTraces()}},e.hasLongStackTraces=function(){return lt.longStackTraces&&S()};var et={unhandledrejection:{before:function(){var t=B.global.onunhandledrejection;return B.global.onunhandledrejection=null,t},after:function(t){B.global.onunhandledrejection=t}},rejectionhandled:{before:function(){var t=B.global.onrejectionhandled;return B.global.onrejectionhandled=null,t},after:function(t){B.global.onrejectionhandled=t}}},nt=function(){var t=function(t,e){if(!t)return!B.global.dispatchEvent(e);var n;try{return n=t.before(),!B.global.dispatchEvent(e)}finally{t.after(n)}};try{if("function"==typeof CustomEvent){var e=new CustomEvent("CustomEvent");return B.global.dispatchEvent(e),function(e,n){e=e.toLowerCase();var r={detail:n,cancelable:!0},i=new CustomEvent(e,r);return M.defineProperty(i,"promise",{value:n.promise}),M.defineProperty(i,"reason",{value:n.reason}),t(et[e],i)}}if("function"==typeof Event){var e=new Event("CustomEvent");return B.global.dispatchEvent(e),function(e,n){e=e.toLowerCase();var r=new Event(e,{cancelable:!0});return r.detail=n,M.defineProperty(r,"promise",{value:n.promise}),M.defineProperty(r,"reason",{value:n.reason}),t(et[e],r)}}var e=document.createEvent("CustomEvent");return e.initCustomEvent("testingtheevent",!1,!0,{}),B.global.dispatchEvent(e),function(e,n){e=e.toLowerCase();var r=document.createEvent("CustomEvent");return r.initCustomEvent(e,!1,!0,n),t(et[e],r)}}catch(n){}return function(){return!1}}(),rt=function(){return B.isNode?function(){return process.emit.apply(process,arguments)}:B.global?function(t){var e="on"+t.toLowerCase(),n=B.global[e];return n?(n.apply(B.global,[].slice.call(arguments,1)),!0):!1}:function(){return!1}}(),it={promiseCreated:o,promiseFulfilled:o,promiseRejected:o,promiseResolved:o,promiseCancelled:o,promiseChained:function(t,e,n){return{promise:e,child:n}},warning:function(t,e){return{warning:e}},unhandledRejection:function(t,e,n){return{reason:e,promise:n}},rejectionHandled:o},ot=function(t){var e=!1;try{e=rt.apply(null,arguments)}catch(n){N.throwLater(n),e=!0}var r=!1;try{r=nt(t,it[t].apply(null,arguments))}catch(n){N.throwLater(n),r=!0}return r||e};e.config=function(t){if(t=Object(t),"longStackTraces"in t&&(t.longStackTraces?e.longStackTraces():!t.longStackTraces&&e.hasLongStackTraces()&&tt()),"warnings"in t){var n=t.warnings;lt.warnings=!!n,Z=lt.warnings,B.isObject(n)&&"wForgottenReturn"in n&&(Z=!!n.wForgottenReturn)}if("cancellation"in t&&t.cancellation&&!lt.cancellation){if(N.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");e.prototype._clearCancellationData=p,e.prototype._propagateFrom=f,e.prototype._onCancel=u,e.prototype._setOnCancel=l,e.prototype._attachCancellationCallback=c,e.prototype._execute=a,st=f,lt.cancellation=!0}if("monitoring"in t&&(t.monitoring&&!lt.monitoring?(lt.monitoring=!0,e.prototype._fireEvent=ot):!t.monitoring&&lt.monitoring&&(lt.monitoring=!1,e.prototype._fireEvent=s)),"asyncHooks"in t&&B.nodeSupportsAsyncResource){var o=lt.asyncHooks,h=!!t.asyncHooks;o!==h&&(lt.asyncHooks=h,h?r():i())}return e},e.prototype._fireEvent=s,e.prototype._execute=function(t,e,n){try{t(e,n)}catch(r){return r}},e.prototype._onCancel=function(){},e.prototype._setOnCancel=function(t){},e.prototype._attachCancellationCallback=function(t){},e.prototype._captureStackTrace=function(){},e.prototype._attachExtraTrace=function(){},e.prototype._dereferenceTrace=function(){},e.prototype._clearCancellationData=function(){},e.prototype._propagateFrom=function(t,e){};var st=h,at=function(){return!1},ct=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;B.inherits(V,Error),n.CapturedTrace=V,V.prototype.uncycle=function(){var t=this._length;if(!(2>t)){for(var e=[],n={},r=0,i=this;void 0!==i;++r)e.push(i),i=i._parent;t=this._length=r;for(var r=t-1;r>=0;--r){var o=e[r].stack;void 0===n[o]&&(n[o]=r)}for(var r=0;t>r;++r){var s=e[r].stack,a=n[s];if(void 0!==a&&a!==r){a>0&&(e[a-1]._parent=void 0,e[a-1]._length=1),e[r]._parent=void 0,e[r]._length=1;var c=r>0?e[r-1]:this;t-1>a?(c._parent=e[a+1],c._parent.uncycle(),c._length=c._parent._length+1):(c._parent=void 0,c._length=1);for(var u=c._length+1,l=r-2;l>=0;--l)e[l]._length=u,u++;return}}}},V.prototype.attachExtraTrace=function(t){if(!t.__stackCleaned__){this.uncycle();for(var e=F(t),n=e.message,r=[e.stack],i=this;void 0!==i;)r.push(k(i.stack.split("\n"))),i=i._parent;j(r),C(r),B.notEnumerableProp(t,"stack",w(n,r)),B.notEnumerableProp(t,"__stackCleaned__",!0)}};var ut=function(){var t=/^\s*at\s*/,e=function(t,e){return"string"==typeof t?t:void 0!==e.name&&void 0!==e.message?e.toString():P(e)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,z=t,X=e;var n=Error.captureStackTrace;return at=function(t){return $.test(t)},function(t,e){Error.stackTraceLimit+=6,n(t,e),Error.stackTraceLimit-=6}}var r=new Error;if("string"==typeof r.stack&&r.stack.split("\n")[0].indexOf("stackDetection@")>=0)return z=/@/,X=e,W=!0,function(t){t.stack=(new Error).stack};var i;try{throw new Error}catch(o){i="stack"in o}return"stack"in r||!i||"number"!=typeof Error.stackTraceLimit?(X=function(t,e){return"string"==typeof t?t:"object"!=typeof e&&"function"!=typeof e||void 0===e.name||void 0===e.message?P(e):e.toString()},null):(z=t,X=e,function(t){Error.stackTraceLimit+=6;try{throw new Error}catch(e){t.stack=e.stack}Error.stackTraceLimit-=6})}([]);"undefined"!=typeof console&&"undefined"!=typeof console.warn&&(I=function(t){console.warn(t)},B.isNode&&process.stderr.isTTY?I=function(t,e){var n=e?"[33m":"[31m";console.warn(n+t+"[0m\n")}:B.isNode||"string"!=typeof(new Error).stack||(I=function(t,e){console.warn("%c"+t,e?"color: darkorange":"color: red")}));var lt={warnings:J,longStackTraces:!1,cancellation:!1,monitoring:!1,asyncHooks:!1};return Y&&e.longStackTraces(),{asyncHooks:function(){return lt.asyncHooks},longStackTraces:function(){return lt.longStackTraces},warnings:function(){return lt.warnings},cancellation:function(){return lt.cancellation},monitoring:function(){return lt.monitoring},propagateFromFunction:function(){return st},boundValueFunction:function(){return _},checkForgottenReturns:g,setBounds:A,warn:b,deprecated:m,CapturedTrace:V,fireDomEvent:nt,fireGlobalEvent:rt}}},{"./errors":12,"./es5":13,"./util":36}],10:[function(t,e,n){"use strict";e.exports=function(t){function e(){return this.value}function n(){throw this.reason}t.prototype["return"]=t.prototype.thenReturn=function(n){return n instanceof t&&n.suppressUnhandledRejections(),this._then(e,void 0,void 0,{value:n},void 0)},t.prototype["throw"]=t.prototype.thenThrow=function(t){return this._then(n,void 0,void 0,{reason:t},void 0)},t.prototype.catchThrow=function(t){if(arguments.length<=1)return this._then(void 0,n,void 0,{reason:t},void 0);var e=arguments[1],r=function(){throw e};return this.caught(t,r)},t.prototype.catchReturn=function(n){if(arguments.length<=1)return n instanceof t&&n.suppressUnhandledRejections(),this._then(void 0,e,void 0,{value:n},void 0);var r=arguments[1];r instanceof t&&r.suppressUnhandledRejections();var i=function(){return r};return this.caught(n,i)}}},{}],11:[function(t,e,n){"use strict";e.exports=function(t,e){function n(){return o(this)}function r(t,n){return i(t,n,e,e)}var i=t.reduce,o=t.all;t.prototype.each=function(t){return i(this,t,e,0)._then(n,void 0,void 0,this,void 0)},t.prototype.mapSeries=function(t){return i(this,t,e,e)},t.each=function(t,r){return i(t,r,e,0)._then(n,void 0,void 0,t,void 0)},t.mapSeries=r}},{}],12:[function(t,e,n){"use strict";function r(t,e){function n(r){return this instanceof n?(p(this,"message","string"==typeof r?r:e),p(this,"name",t),void(Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this))):new n(r)}return l(n,Error),n}function i(t){return this instanceof i?(p(this,"name","OperationalError"),p(this,"message",t),this.cause=t,this.isOperational=!0,void(t instanceof Error?(p(this,"message",t.message),p(this,"stack",t.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor))):new i(t)}var o,s,a=t("./es5"),c=a.freeze,u=t("./util"),l=u.inherits,p=u.notEnumerableProp,f=r("Warning","warning"),h=r("CancellationError","cancellation error"),_=r("TimeoutError","timeout error"),d=r("AggregateError","aggregate error");try{o=TypeError,s=RangeError}catch(v){o=r("TypeError","type error"),s=r("RangeError","range error")}for(var y="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),g=0;g<y.length;++g)"function"==typeof Array.prototype[y[g]]&&(d.prototype[y[g]]=Array.prototype[y[g]]);a.defineProperty(d.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),d.prototype.isOperational=!0;var m=0;d.prototype.toString=function(){var t=Array(4*m+1).join(" "),e="\n"+t+"AggregateError of:\n";m++,t=Array(4*m+1).join(" ");for(var n=0;n<this.length;++n){for(var r=this[n]===this?"[Circular AggregateError]":this[n]+"",i=r.split("\n"),o=0;o<i.length;++o)i[o]=t+i[o];r=i.join("\n"),e+=r+"\n"}return m--,e},l(i,Error);var b=Error.__BluebirdErrorTypes__;b||(b=c({CancellationError:h,TimeoutError:_,OperationalError:i,RejectionError:i,AggregateError:d}),a.defineProperty(Error,"__BluebirdErrorTypes__",{value:b,writable:!1,enumerable:!1,configurable:!1})),e.exports={Error:Error,TypeError:o,RangeError:s,CancellationError:b.CancellationError,OperationalError:b.OperationalError,TimeoutError:b.TimeoutError,AggregateError:b.AggregateError,Warning:f}},{"./es5":13,"./util":36}],13:[function(t,e,n){var r=function(){"use strict";return void 0===this}();if(r)e.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:r,propertyIsWritable:function(t,e){var n=Object.getOwnPropertyDescriptor(t,e);return!(n&&!n.writable&&!n.set)}};else{var i={}.hasOwnProperty,o={}.toString,s={}.constructor.prototype,a=function(t){var e=[];for(var n in t)i.call(t,n)&&e.push(n);return e},c=function(t,e){return{value:t[e]}},u=function(t,e,n){return t[e]=n.value,t},l=function(t){return t},p=function(t){try{return Object(t).constructor.prototype}catch(e){return s}},f=function(t){try{return"[object Array]"===o.call(t)}catch(e){return!1}};e.exports={isArray:f,keys:a,names:a,defineProperty:u,getDescriptor:c,freeze:l,getPrototypeOf:p,isES5:r,propertyIsWritable:function(){return!0}}}},{}],14:[function(t,e,n){"use strict";e.exports=function(t,e){var n=t.map;t.prototype.filter=function(t,r){return n(this,t,r,e)},t.filter=function(t,r,i){return n(t,r,i,e)}}},{}],15:[function(t,e,n){"use strict";e.exports=function(e,n,r){function i(t,e,n){this.promise=t,this.type=e,this.handler=n,this.called=!1,this.cancelPromise=null}function o(t){this.finallyHandler=t}function s(t,e){return null!=t.cancelPromise?(arguments.length>1?t.cancelPromise._reject(e):t.cancelPromise._cancel(),t.cancelPromise=null,!0):!1}function a(){return u.call(this,this.promise._target()._settledValue())}function c(t){return s(this,t)?void 0:(f.e=t,f)}function u(t){var i=this.promise,u=this.handler;if(!this.called){this.called=!0;var l=this.isFinallyHandler()?u.call(i._boundValue()):u.call(i._boundValue(),t);if(l===r)return l;if(void 0!==l){i._setReturnedNonUndefined();var h=n(l,i);if(h instanceof e){if(null!=this.cancelPromise){if(h._isCancelled()){var _=new p("late cancellation observer");return i._attachExtraTrace(_),f.e=_,f}h.isPending()&&h._attachCancellationCallback(new o(this))}return h._then(a,c,void 0,this,void 0)}}}return i.isRejected()?(s(this),f.e=t,f):(s(this),t)}var l=t("./util"),p=e.CancellationError,f=l.errorObj,h=t("./catch_filter")(r);return i.prototype.isFinallyHandler=function(){return 0===this.type},o.prototype._resultCancelled=function(){s(this.finallyHandler)},e.prototype._passThrough=function(t,e,n,r){return"function"!=typeof t?this.then():this._then(n,r,void 0,new i(this,e,t),void 0)},e.prototype.lastly=e.prototype["finally"]=function(t){return this._passThrough(t,0,u,u)},e.prototype.tap=function(t){return this._passThrough(t,1,u)},e.prototype.tapCatch=function(t){var n=arguments.length;if(1===n)return this._passThrough(t,1,void 0,u);var r,i=new Array(n-1),o=0;for(r=0;n-1>r;++r){var s=arguments[r];if(!l.isObject(s))return e.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+l.classString(s)));i[o++]=s}i.length=o;var a=arguments[r];return this._passThrough(h(i,a,this),1,void 0,u)},i}},{"./catch_filter":7,"./util":36}],16:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,s){function a(t,n,r){for(var o=0;o<n.length;++o){r._pushContext();var s=h(n[o])(t);if(r._popContext(),s===f){r._pushContext();var a=e.reject(f.e);return r._popContext(),a}var c=i(s,r);if(c instanceof e)return c}return null}function c(t,n,i,o){if(s.cancellation()){var a=new e(r),c=this._finallyPromise=new e(r);this._promise=a.lastly(function(){return c}),a._captureStackTrace(),a._setOnCancel(this)}else{var u=this._promise=new e(r);u._captureStackTrace()}this._stack=o,this._generatorFunction=t,this._receiver=n,this._generator=void 0,this._yieldHandlers="function"==typeof i?[i].concat(_):_,this._yieldedPromise=null,this._cancellationPhase=!1}var u=t("./errors"),l=u.TypeError,p=t("./util"),f=p.errorObj,h=p.tryCatch,_=[];p.inherits(c,o),c.prototype._isResolved=function(){return null===this._promise},c.prototype._cleanup=function(){this._promise=this._generator=null,s.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},c.prototype._promiseCancelled=function(){if(!this._isResolved()){var t,n="undefined"!=typeof this._generator["return"];if(n)this._promise._pushContext(),t=h(this._generator["return"]).call(this._generator,void 0),this._promise._popContext();else{var r=new e.CancellationError("generator .return() sentinel");e.coroutine.returnSentinel=r,this._promise._attachExtraTrace(r),this._promise._pushContext(),t=h(this._generator["throw"]).call(this._generator,r),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(t)}},c.prototype._promiseFulfilled=function(t){this._yieldedPromise=null,this._promise._pushContext();var e=h(this._generator.next).call(this._generator,t);this._promise._popContext(),this._continue(e)},c.prototype._promiseRejected=function(t){this._yieldedPromise=null,this._promise._attachExtraTrace(t),this._promise._pushContext();var e=h(this._generator["throw"]).call(this._generator,t);this._promise._popContext(),this._continue(e)},c.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof e){var t=this._yieldedPromise;this._yieldedPromise=null,t.cancel()}},c.prototype.promise=function(){return this._promise},c.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},c.prototype._continue=function(t){var n=this._promise;if(t===f)return this._cleanup(),this._cancellationPhase?n.cancel():n._rejectCallback(t.e,!1);var r=t.value;if(t.done===!0)return this._cleanup(),this._cancellationPhase?n.cancel():n._resolveCallback(r);
var o=i(r,this._promise);if(!(o instanceof e)&&(o=a(o,this._yieldHandlers,this._promise),null===o))return void this._promiseRejected(new l("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",String(r))+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")));o=o._target();var s=o._bitField;0===(50397184&s)?(this._yieldedPromise=o,o._proxy(this,null)):0!==(33554432&s)?e._async.invoke(this._promiseFulfilled,this,o._value()):0!==(16777216&s)?e._async.invoke(this._promiseRejected,this,o._reason()):this._promiseCancelled()},e.coroutine=function(t,e){if("function"!=typeof t)throw new l("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var n=Object(e).yieldHandler,r=c,i=(new Error).stack;return function(){var e=t.apply(this,arguments),o=new r(void 0,void 0,n,i),s=o.promise();return o._generator=e,o._promiseFulfilled(void 0),s}},e.coroutine.addYieldHandler=function(t){if("function"!=typeof t)throw new l("expecting a function but got "+p.classString(t));_.push(t)},e.spawn=function(t){if(s.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof t)return n("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var r=new c(t,this),i=r.promise();return r._run(e.spawn),i}}},{"./errors":12,"./util":36}],17:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o){var s=t("./util");s.canEvaluate,s.tryCatch,s.errorObj;e.join=function(){var t,e=arguments.length-1;if(e>0&&"function"==typeof arguments[e]){t=arguments[e];var r}var i=[].slice.call(arguments);t&&i.pop();var r=new n(i).promise();return void 0!==t?r.spread(t):r}}},{"./util":36}],18:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,s){function a(t,n,r,i){this.constructor$(t),this._promise._captureStackTrace();var s=e._getContext();if(this._callback=u.contextBind(s,n),this._preservedValues=i===o?new Array(this.length()):null,this._limit=r,this._inFlight=0,this._queue=[],f.invoke(this._asyncInit,this,void 0),u.isArray(t))for(var a=0;a<t.length;++a){var c=t[a];c instanceof e&&c.suppressUnhandledRejections()}}function c(t,n,i,o){if("function"!=typeof n)return r("expecting a function but got "+u.classString(n));var s=0;if(void 0!==i){if("object"!=typeof i||null===i)return e.reject(new TypeError("options argument must be an object but it is "+u.classString(i)));if("number"!=typeof i.concurrency)return e.reject(new TypeError("'concurrency' must be a number but it is "+u.classString(i.concurrency)));s=i.concurrency}return s="number"==typeof s&&isFinite(s)&&s>=1?s:0,new a(t,n,s,o).promise()}var u=t("./util"),l=u.tryCatch,p=u.errorObj,f=e._async;u.inherits(a,n),a.prototype._asyncInit=function(){this._init$(void 0,-2)},a.prototype._init=function(){},a.prototype._promiseFulfilled=function(t,n){var r=this._values,o=this.length(),a=this._preservedValues,c=this._limit;if(0>n){if(n=-1*n-1,r[n]=t,c>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(c>=1&&this._inFlight>=c)return r[n]=t,this._queue.push(n),!1;null!==a&&(a[n]=t);var u=this._promise,f=this._callback,h=u._boundValue();u._pushContext();var _=l(f).call(h,t,n,o),d=u._popContext();if(s.checkForgottenReturns(_,d,null!==a?"Promise.filter":"Promise.map",u),_===p)return this._reject(_.e),!0;var v=i(_,this._promise);if(v instanceof e){v=v._target();var y=v._bitField;if(0===(50397184&y))return c>=1&&this._inFlight++,r[n]=v,v._proxy(this,-1*(n+1)),!1;if(0===(33554432&y))return 0!==(16777216&y)?(this._reject(v._reason()),!0):(this._cancel(),!0);_=v._value()}r[n]=_}var g=++this._totalResolved;return g>=o?(null!==a?this._filter(r,a):this._resolve(r),!0):!1},a.prototype._drainQueue=function(){for(var t=this._queue,e=this._limit,n=this._values;t.length>0&&this._inFlight<e;){if(this._isResolved())return;var r=t.pop();this._promiseFulfilled(n[r],r)}},a.prototype._filter=function(t,e){for(var n=e.length,r=new Array(n),i=0,o=0;n>o;++o)t[o]&&(r[i++]=e[o]);r.length=i,this._resolve(r)},a.prototype.preservedValues=function(){return this._preservedValues},e.prototype.map=function(t,e){return c(this,t,e,null)},e.map=function(t,e,n,r){return c(t,e,n,r)}}},{"./util":36}],19:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o){var s=t("./util"),a=s.tryCatch;e.method=function(t){if("function"!=typeof t)throw new e.TypeError("expecting a function but got "+s.classString(t));return function(){var r=new e(n);r._captureStackTrace(),r._pushContext();var i=a(t).apply(this,arguments),s=r._popContext();return o.checkForgottenReturns(i,s,"Promise.method",r),r._resolveFromSyncValue(i),r}},e.attempt=e["try"]=function(t){if("function"!=typeof t)return i("expecting a function but got "+s.classString(t));var r=new e(n);r._captureStackTrace(),r._pushContext();var c;if(arguments.length>1){o.deprecated("calling Promise.try with more than 1 argument");var u=arguments[1],l=arguments[2];c=s.isArray(u)?a(t).apply(l,u):a(t).call(l,u)}else c=a(t)();var p=r._popContext();return o.checkForgottenReturns(c,p,"Promise.try",r),r._resolveFromSyncValue(c),r},e.prototype._resolveFromSyncValue=function(t){t===s.errorObj?this._rejectCallback(t.e,!1):this._resolveCallback(t,!0)}}},{"./util":36}],20:[function(t,e,n){"use strict";function r(t){return t instanceof Error&&l.getPrototypeOf(t)===Error.prototype}function i(t){var e;if(r(t)){e=new u(t),e.name=t.name,e.message=t.message,e.stack=t.stack;for(var n=l.keys(t),i=0;i<n.length;++i){var o=n[i];p.test(o)||(e[o]=t[o])}return e}return s.markAsOriginatingFromRejection(t),t}function o(t,e){return function(n,r){if(null!==t){if(n){var o=i(a(n));t._attachExtraTrace(o),t._reject(o)}else if(e){var s=[].slice.call(arguments,1);t._fulfill(s)}else t._fulfill(r);t=null}}}var s=t("./util"),a=s.maybeWrapAsError,c=t("./errors"),u=c.OperationalError,l=t("./es5"),p=/^(?:name|message|stack|cause)$/;e.exports=o},{"./errors":12,"./es5":13,"./util":36}],21:[function(t,e,n){"use strict";e.exports=function(e){function n(t,e){var n=this;if(!o.isArray(t))return r.call(n,t,e);var i=a(e).apply(n._boundValue(),[null].concat(t));i===c&&s.throwLater(i.e)}function r(t,e){var n=this,r=n._boundValue(),i=void 0===t?a(e).call(r,null):a(e).call(r,null,t);i===c&&s.throwLater(i.e)}function i(t,e){var n=this;if(!t){var r=new Error(t+"");r.cause=t,t=r}var i=a(e).call(n._boundValue(),t);i===c&&s.throwLater(i.e)}var o=t("./util"),s=e._async,a=o.tryCatch,c=o.errorObj;e.prototype.asCallback=e.prototype.nodeify=function(t,e){if("function"==typeof t){var o=r;void 0!==e&&Object(e).spread&&(o=n),this._then(o,i,void 0,this,t)}return this}}},{"./util":36}],22:[function(t,e,n){"use strict";e.exports=function(){function n(){}function r(t,e){if(null==t||(t.constructor!==i&&"undefined"!=typeof Promise&&t.constructor!==Promise))throw new E("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof e)throw new E("expecting a function but got "+f.classString(e))}function i(t){t!==x&&r(this,t),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(t),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function o(t){this.promise._resolveCallback(t)}function s(t){this.promise._rejectCallback(t,!1)}function a(t){var e=new i(x);e._fulfillmentHandler0=t,e._rejectionHandler0=t,e._promise0=t,e._receiver0=t}var c=function(){return new E("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},u=function(){return new i.PromiseInspection(this._target())},l=function(t){return i.reject(new E(t))},p={},f=t("./util");f.setReflectHandler(u);var h=function(){var t=process.domain;return void 0===t?null:t},_=function(){return null},d=function(){return{domain:h(),async:null}},v=f.isNode&&f.nodeSupportsAsyncResource?t("async_hooks").AsyncResource:null,y=function(){return{domain:h(),async:new v("Bluebird::Promise")}},g=f.isNode?d:_;f.notEnumerableProp(i,"_getContext",g);var m=function(){g=y,f.notEnumerableProp(i,"_getContext",y)},b=function(){g=d,f.notEnumerableProp(i,"_getContext",d)},w=t("./es5"),C=t("./async"),j=new C;w.defineProperty(i,"_async",{value:j});var k=t("./errors"),E=i.TypeError=k.TypeError;i.RangeError=k.RangeError;var F=i.CancellationError=k.CancellationError;i.TimeoutError=k.TimeoutError,i.OperationalError=k.OperationalError,i.RejectionError=k.OperationalError,i.AggregateError=k.AggregateError;var x=function(){},T={},P={},R=t("./thenables")(i,x),S=t("./promise_array")(i,x,R,l,n),O=t("./context")(i),A=O.create,V=t("./debuggability")(i,O,m,b),H=(V.CapturedTrace,t("./finally")(i,R,P)),D=t("./catch_filter")(P),I=t("./nodeback"),L=f.errorObj,N=f.tryCatch;return i.prototype.toString=function(){return"[object Promise]"},i.prototype.caught=i.prototype["catch"]=function(t){var e=arguments.length;if(e>1){var n,r=new Array(e-1),i=0;for(n=0;e-1>n;++n){var o=arguments[n];if(!f.isObject(o))return l("Catch statement predicate: expecting an object but got "+f.classString(o));r[i++]=o}if(r.length=i,t=arguments[n],"function"!=typeof t)throw new E("The last argument to .catch() must be a function, got "+f.toString(t));return this.then(void 0,D(r,t,this))}return this.then(void 0,t)},i.prototype.reflect=function(){return this._then(u,u,void 0,this,void 0)},i.prototype.then=function(t,e){if(V.warnings()&&arguments.length>0&&"function"!=typeof t&&"function"!=typeof e){var n=".then() only accepts functions but was passed: "+f.classString(t);arguments.length>1&&(n+=", "+f.classString(e)),this._warn(n)}return this._then(t,e,void 0,void 0,void 0)},i.prototype.done=function(t,e){var n=this._then(t,e,void 0,void 0,void 0);n._setIsFinal()},i.prototype.spread=function(t){return"function"!=typeof t?l("expecting a function but got "+f.classString(t)):this.all()._then(t,void 0,void 0,T,void 0)},i.prototype.toJSON=function(){var t={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(t.fulfillmentValue=this.value(),t.isFulfilled=!0):this.isRejected()&&(t.rejectionReason=this.reason(),t.isRejected=!0),t},i.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new S(this).promise()},i.prototype.error=function(t){return this.caught(f.originatesFromRejection,t)},i.getNewLibraryCopy=e.exports,i.is=function(t){return t instanceof i},i.fromNode=i.fromCallback=function(t){var e=new i(x);e._captureStackTrace();var n=arguments.length>1?!!Object(arguments[1]).multiArgs:!1,r=N(t)(I(e,n));return r===L&&e._rejectCallback(r.e,!0),e._isFateSealed()||e._setAsyncGuaranteed(),e},i.all=function(t){return new S(t).promise()},i.cast=function(t){var e=R(t);return e instanceof i||(e=new i(x),e._captureStackTrace(),e._setFulfilled(),e._rejectionHandler0=t),e},i.resolve=i.fulfilled=i.cast,i.reject=i.rejected=function(t){var e=new i(x);return e._captureStackTrace(),e._rejectCallback(t,!0),e},i.setScheduler=function(t){if("function"!=typeof t)throw new E("expecting a function but got "+f.classString(t));return j.setScheduler(t)},i.prototype._then=function(t,e,n,r,o){var s=void 0!==o,a=s?o:new i(x),c=this._target(),u=c._bitField;s||(a._propagateFrom(this,3),a._captureStackTrace(),void 0===r&&0!==(2097152&this._bitField)&&(r=0!==(50397184&u)?this._boundValue():c===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,a));var l=g();if(0!==(50397184&u)){var p,h,_=c._settlePromiseCtx;0!==(33554432&u)?(h=c._rejectionHandler0,p=t):0!==(16777216&u)?(h=c._fulfillmentHandler0,p=e,c._unsetRejectionIsUnhandled()):(_=c._settlePromiseLateCancellationObserver,h=new F("late cancellation observer"),c._attachExtraTrace(h),p=e),j.invoke(_,c,{handler:f.contextBind(l,p),promise:a,receiver:r,value:h})}else c._addCallbacks(t,e,a,r,l);return a},i.prototype._length=function(){return 65535&this._bitField},i.prototype._isFateSealed=function(){return 0!==(117506048&this._bitField)},i.prototype._isFollowing=function(){return 67108864===(67108864&this._bitField)},i.prototype._setLength=function(t){this._bitField=-65536&this._bitField|65535&t},i.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},i.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},i.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},i.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},i.prototype._isFinal=function(){return(4194304&this._bitField)>0},i.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},i.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},i.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},i.prototype._setAsyncGuaranteed=function(){if(!j.hasCustomScheduler()){var t=this._bitField;this._bitField=t|(536870912&t)>>2^134217728}},i.prototype._setNoAsyncGuarantee=function(){this._bitField=-134217729&(536870912|this._bitField)},i.prototype._receiverAt=function(t){var e=0===t?this._receiver0:this[4*t-4+3];return e===p?void 0:void 0===e&&this._isBound()?this._boundValue():e},i.prototype._promiseAt=function(t){return this[4*t-4+2]},i.prototype._fulfillmentHandlerAt=function(t){return this[4*t-4+0]},i.prototype._rejectionHandlerAt=function(t){return this[4*t-4+1]},i.prototype._boundValue=function(){},i.prototype._migrateCallback0=function(t){var e=(t._bitField,t._fulfillmentHandler0),n=t._rejectionHandler0,r=t._promise0,i=t._receiverAt(0);void 0===i&&(i=p),this._addCallbacks(e,n,r,i,null)},i.prototype._migrateCallbackAt=function(t,e){var n=t._fulfillmentHandlerAt(e),r=t._rejectionHandlerAt(e),i=t._promiseAt(e),o=t._receiverAt(e);void 0===o&&(o=p),this._addCallbacks(n,r,i,o,null)},i.prototype._addCallbacks=function(t,e,n,r,i){var o=this._length();if(o>=65531&&(o=0,this._setLength(0)),0===o)this._promise0=n,this._receiver0=r,"function"==typeof t&&(this._fulfillmentHandler0=f.contextBind(i,t)),"function"==typeof e&&(this._rejectionHandler0=f.contextBind(i,e));else{var s=4*o-4;this[s+2]=n,this[s+3]=r,"function"==typeof t&&(this[s+0]=f.contextBind(i,t)),"function"==typeof e&&(this[s+1]=f.contextBind(i,e))}return this._setLength(o+1),o},i.prototype._proxy=function(t,e){this._addCallbacks(void 0,void 0,e,t,null)},i.prototype._resolveCallback=function(t,e){if(0===(117506048&this._bitField)){if(t===this)return this._rejectCallback(c(),!1);var n=R(t,this);if(!(n instanceof i))return this._fulfill(t);e&&this._propagateFrom(n,2);var r=n._target();if(r===this)return void this._reject(c());var o=r._bitField;if(0===(50397184&o)){var s=this._length();s>0&&r._migrateCallback0(this);for(var a=1;s>a;++a)r._migrateCallbackAt(this,a);this._setFollowing(),this._setLength(0),this._setFollowee(n)}else if(0!==(33554432&o))this._fulfill(r._value());else if(0!==(16777216&o))this._reject(r._reason());else{var u=new F("late cancellation observer");r._attachExtraTrace(u),this._reject(u)}}},i.prototype._rejectCallback=function(t,e,n){var r=f.ensureErrorObject(t),i=r===t;if(!i&&!n&&V.warnings()){var o="a promise was rejected with a non-error: "+f.classString(t);this._warn(o,!0)}this._attachExtraTrace(r,e?i:!1),this._reject(t)},i.prototype._resolveFromExecutor=function(t){if(t!==x){var e=this;this._captureStackTrace(),this._pushContext();var n=!0,r=this._execute(t,function(t){e._resolveCallback(t)},function(t){e._rejectCallback(t,n)});n=!1,this._popContext(),void 0!==r&&e._rejectCallback(r,!0)}},i.prototype._settlePromiseFromHandler=function(t,e,n,r){var i=r._bitField;if(0===(65536&i)){r._pushContext();var o;e===T?n&&"number"==typeof n.length?o=N(t).apply(this._boundValue(),n):(o=L,o.e=new E("cannot .spread() a non-array: "+f.classString(n))):o=N(t).call(e,n);var s=r._popContext();i=r._bitField,0===(65536&i)&&(o===P?r._reject(n):o===L?r._rejectCallback(o.e,!1):(V.checkForgottenReturns(o,s,"",r,this),r._resolveCallback(o)))}},i.prototype._target=function(){for(var t=this;t._isFollowing();)t=t._followee();return t},i.prototype._followee=function(){return this._rejectionHandler0},i.prototype._setFollowee=function(t){this._rejectionHandler0=t},i.prototype._settlePromise=function(t,e,r,o){var s=t instanceof i,a=this._bitField,c=0!==(134217728&a);0!==(65536&a)?(s&&t._invokeInternalOnCancel(),r instanceof H&&r.isFinallyHandler()?(r.cancelPromise=t,N(e).call(r,o)===L&&t._reject(L.e)):e===u?t._fulfill(u.call(r)):r instanceof n?r._promiseCancelled(t):s||t instanceof S?t._cancel():r.cancel()):"function"==typeof e?s?(c&&t._setAsyncGuaranteed(),this._settlePromiseFromHandler(e,r,o,t)):e.call(r,o,t):r instanceof n?r._isResolved()||(0!==(33554432&a)?r._promiseFulfilled(o,t):r._promiseRejected(o,t)):s&&(c&&t._setAsyncGuaranteed(),0!==(33554432&a)?t._fulfill(o):t._reject(o))},i.prototype._settlePromiseLateCancellationObserver=function(t){var e=t.handler,n=t.promise,r=t.receiver,o=t.value;"function"==typeof e?n instanceof i?this._settlePromiseFromHandler(e,r,o,n):e.call(r,o,n):n instanceof i&&n._reject(o)},i.prototype._settlePromiseCtx=function(t){this._settlePromise(t.promise,t.handler,t.receiver,t.value)},i.prototype._settlePromise0=function(t,e,n){var r=this._promise0,i=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(r,t,i,e)},i.prototype._clearCallbackDataAtIndex=function(t){var e=4*t-4;this[e+2]=this[e+3]=this[e+0]=this[e+1]=void 0},i.prototype._fulfill=function(t){var e=this._bitField;if(!((117506048&e)>>>16)){if(t===this){var n=c();return this._attachExtraTrace(n),this._reject(n)}this._setFulfilled(),this._rejectionHandler0=t,(65535&e)>0&&(0!==(134217728&e)?this._settlePromises():j.settlePromises(this),this._dereferenceTrace())}},i.prototype._reject=function(t){var e=this._bitField;if(!((117506048&e)>>>16))return this._setRejected(),this._fulfillmentHandler0=t,this._isFinal()?j.fatalError(t,f.isNode):void((65535&e)>0?j.settlePromises(this):this._ensurePossibleRejectionHandled())},i.prototype._fulfillPromises=function(t,e){for(var n=1;t>n;n++){var r=this._fulfillmentHandlerAt(n),i=this._promiseAt(n),o=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(i,r,o,e)}},i.prototype._rejectPromises=function(t,e){for(var n=1;t>n;n++){var r=this._rejectionHandlerAt(n),i=this._promiseAt(n),o=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(i,r,o,e)}},i.prototype._settlePromises=function(){var t=this._bitField,e=65535&t;if(e>0){if(0!==(16842752&t)){var n=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,n,t),this._rejectPromises(e,n)}else{var r=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,r,t),this._fulfillPromises(e,r)}this._setLength(0)}this._clearCancellationData()},i.prototype._settledValue=function(){var t=this._bitField;return 0!==(33554432&t)?this._rejectionHandler0:0!==(16777216&t)?this._fulfillmentHandler0:void 0},"undefined"!=typeof Symbol&&Symbol.toStringTag&&w.defineProperty(i.prototype,Symbol.toStringTag,{get:function(){return"Object"}}),i.defer=i.pending=function(){V.deprecated("Promise.defer","new Promise");var t=new i(x);return{promise:t,resolve:o,reject:s}},f.notEnumerableProp(i,"_makeSelfResolutionError",c),t("./method")(i,x,R,l,V),t("./bind")(i,x,R,V),t("./cancel")(i,S,l,V),t("./direct_resolve")(i),t("./synchronous_inspection")(i),t("./join")(i,S,R,x,j),i.Promise=i,i.version="3.7.2",t("./call_get.js")(i),t("./generators.js")(i,l,x,R,n,V),t("./map.js")(i,S,l,R,x,V),t("./nodeify.js")(i),t("./promisify.js")(i,x),t("./props.js")(i,S,R,l),t("./race.js")(i,x,R,l),t("./reduce.js")(i,S,l,R,x,V),t("./settle.js")(i,S,V),t("./some.js")(i,S,l),t("./timers.js")(i,x,V),t("./using.js")(i,l,R,A,x,V),t("./any.js")(i),t("./each.js")(i,x),t("./filter.js")(i,x),f.toFastProperties(i),f.toFastProperties(i.prototype),a({a:1}),a({b:2}),a({c:3}),a(1),a(function(){}),a(void 0),a(!1),a(new i(x)),V.setBounds(C.firstLineError,f.lastLineError),i}},{"./any.js":1,"./async":2,"./bind":3,"./call_get.js":5,"./cancel":6,"./catch_filter":7,"./context":8,"./debuggability":9,"./direct_resolve":10,"./each.js":11,"./errors":12,"./es5":13,"./filter.js":14,"./finally":15,"./generators.js":16,"./join":17,"./map.js":18,"./method":19,"./nodeback":20,"./nodeify.js":21,"./promise_array":23,"./promisify.js":24,"./props.js":25,"./race.js":27,"./reduce.js":28,"./settle.js":30,"./some.js":31,"./synchronous_inspection":32,"./thenables":33,"./timers.js":34,"./using.js":35,"./util":36,async_hooks:void 0}],23:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o){function s(t){switch(t){case-2:return[];case-3:return{};case-6:return new Map}}function a(t){var r=this._promise=new e(n);t instanceof e&&(r._propagateFrom(t,3),t.suppressUnhandledRejections()),r._setOnCancel(this),this._values=t,this._length=0,this._totalResolved=0,this._init(void 0,-2)}var c=t("./util");c.isArray;return c.inherits(a,o),a.prototype.length=function(){return this._length},a.prototype.promise=function(){return this._promise},a.prototype._init=function u(t,n){var o=r(this._values,this._promise);if(o instanceof e){o=o._target();var a=o._bitField;if(this._values=o,0===(50397184&a))return this._promise._setAsyncGuaranteed(),o._then(u,this._reject,void 0,this,n);if(0===(33554432&a))return 0!==(16777216&a)?this._reject(o._reason()):this._cancel();o=o._value()}if(o=c.asArray(o),null===o){var l=i("expecting an array or an iterable object but got "+c.classString(o)).reason();return void this._promise._rejectCallback(l,!1)}return 0===o.length?void(-5===n?this._resolveEmptyArray():this._resolve(s(n))):void this._iterate(o)},a.prototype._iterate=function(t){var n=this.getActualLength(t.length);this._length=n,this._values=this.shouldCopyValues()?new Array(n):this._values;for(var i=this._promise,o=!1,s=null,a=0;n>a;++a){var c=r(t[a],i);c instanceof e?(c=c._target(),s=c._bitField):s=null,o?null!==s&&c.suppressUnhandledRejections():null!==s?0===(50397184&s)?(c._proxy(this,a),this._values[a]=c):o=0!==(33554432&s)?this._promiseFulfilled(c._value(),a):0!==(16777216&s)?this._promiseRejected(c._reason(),a):this._promiseCancelled(a):o=this._promiseFulfilled(c,a)}o||i._setAsyncGuaranteed()},a.prototype._isResolved=function(){return null===this._values},a.prototype._resolve=function(t){this._values=null,this._promise._fulfill(t)},a.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},a.prototype._reject=function(t){this._values=null,this._promise._rejectCallback(t,!1)},a.prototype._promiseFulfilled=function(t,e){this._values[e]=t;var n=++this._totalResolved;return n>=this._length?(this._resolve(this._values),!0):!1},a.prototype._promiseCancelled=function(){return this._cancel(),!0},a.prototype._promiseRejected=function(t){return this._totalResolved++,this._reject(t),!0},a.prototype._resultCancelled=function(){if(!this._isResolved()){var t=this._values;if(this._cancel(),t instanceof e)t.cancel();else for(var n=0;n<t.length;++n)t[n]instanceof e&&t[n].cancel()}},a.prototype.shouldCopyValues=function(){return!0},a.prototype.getActualLength=function(t){return t},a}},{"./util":36}],24:[function(t,e,n){"use strict";e.exports=function(e,n){function r(t){return!C.test(t)}function i(t){try{return t.__isPromisified__===!0}catch(e){return!1}}function o(t,e,n){var r=h.getDataPropertyOrDefault(t,e+n,b);return r?i(r):!1}function s(t,e,n){for(var r=0;r<t.length;r+=2){var i=t[r];if(n.test(i))for(var o=i.replace(n,""),s=0;s<t.length;s+=2)if(t[s]===o)throw new g("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",e))}}function a(t,e,n,r){for(var a=h.inheritedDataKeys(t),c=[],u=0;u<a.length;++u){var l=a[u],p=t[l],f=r===j?!0:j(l,p,t);"function"!=typeof p||i(p)||o(t,l,e)||!r(l,p,t,f)||c.push(l,p)}return s(c,e,n),c}function c(t,r,i,o,s,a){function c(){var i=r;r===f&&(i=this);var o=new e(n);o._captureStackTrace();var s="string"==typeof l&&this!==u?this[l]:t,c=_(o,a);try{s.apply(i,d(arguments,c))}catch(p){o._rejectCallback(v(p),!0,!0)}return o._isFateSealed()||o._setAsyncGuaranteed(),o}var u=function(){return this}(),l=t;return"string"==typeof l&&(t=o),h.notEnumerableProp(c,"__isPromisified__",!0),c}function u(t,e,n,r,i){for(var o=new RegExp(k(e)+"$"),s=a(t,e,o,n),c=0,u=s.length;u>c;c+=2){var l=s[c],p=s[c+1],_=l+e;if(r===E)t[_]=E(l,f,l,p,e,i);else{var d=r(p,function(){return E(l,f,l,p,e,i)});h.notEnumerableProp(d,"__isPromisified__",!0),t[_]=d}}return h.toFastProperties(t),t}function l(t,e,n){return E(t,e,void 0,t,null,n)}var p,f={},h=t("./util"),_=t("./nodeback"),d=h.withAppended,v=h.maybeWrapAsError,y=h.canEvaluate,g=t("./errors").TypeError,m="Async",b={__isPromisified__:!0},w=["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"],C=new RegExp("^(?:"+w.join("|")+")$"),j=function(t){return h.isIdentifier(t)&&"_"!==t.charAt(0)&&"constructor"!==t},k=function(t){return t.replace(/([$])/,"\\$")},E=y?p:c;e.promisify=function(t,e){if("function"!=typeof t)throw new g("expecting a function but got "+h.classString(t));if(i(t))return t;e=Object(e);var n=void 0===e.context?f:e.context,o=!!e.multiArgs,s=l(t,n,o);return h.copyDescriptors(t,s,r),s},e.promisifyAll=function(t,e){if("function"!=typeof t&&"object"!=typeof t)throw new g("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");e=Object(e);var n=!!e.multiArgs,r=e.suffix;"string"!=typeof r&&(r=m);var i=e.filter;"function"!=typeof i&&(i=j);var o=e.promisifier;if("function"!=typeof o&&(o=E),!h.isIdentifier(r))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var s=h.inheritedDataKeys(t),a=0;a<s.length;++a){var c=t[s[a]];"constructor"!==s[a]&&h.isClass(c)&&(u(c.prototype,r,i,o,n),u(c,r,i,o,n))}return u(t,r,i,o,n)}}},{"./errors":12,"./nodeback":20,"./util":36}],25:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){function o(t){var e,n=!1;if(void 0!==a&&t instanceof a)e=p(t),n=!0;else{var r=l.keys(t),i=r.length;e=new Array(2*i);for(var o=0;i>o;++o){var s=r[o];e[o]=t[s],e[o+i]=s}}this.constructor$(e),this._isMap=n,this._init$(void 0,n?-6:-3)}function s(t){var n,s=r(t);return u(s)?(n=s instanceof e?s._then(e.props,void 0,void 0,void 0,void 0):new o(s).promise(),s instanceof e&&n._propagateFrom(s,2),n):i("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}var a,c=t("./util"),u=c.isObject,l=t("./es5");"function"==typeof Map&&(a=Map);var p=function(){function t(t,r){this[e]=t,this[e+n]=r,e++}var e=0,n=0;return function(r){n=r.size,e=0;var i=new Array(2*r.size);return r.forEach(t,i),i}}(),f=function(t){for(var e=new a,n=t.length/2|0,r=0;n>r;++r){var i=t[n+r],o=t[r];e.set(i,o)}return e};c.inherits(o,n),o.prototype._init=function(){},o.prototype._promiseFulfilled=function(t,e){this._values[e]=t;var n=++this._totalResolved;if(n>=this._length){var r;if(this._isMap)r=f(this._values);else{r={};for(var i=this.length(),o=0,s=this.length();s>o;++o)r[this._values[o+i]]=this._values[o]}return this._resolve(r),!0}return!1},o.prototype.shouldCopyValues=function(){return!1},o.prototype.getActualLength=function(t){return t>>1},e.prototype.props=function(){return s(this)},e.props=function(t){return s(t)}}},{"./es5":13,"./util":36}],26:[function(t,e,n){"use strict";function r(t,e,n,r,i){for(var o=0;i>o;++o)n[o+r]=t[o+e],t[o+e]=void 0}function i(t){this._capacity=t,this._length=0,this._front=0}i.prototype._willBeOverCapacity=function(t){return this._capacity<t},i.prototype._pushOne=function(t){var e=this.length();this._checkCapacity(e+1);var n=this._front+e&this._capacity-1;this[n]=t,this._length=e+1},i.prototype.push=function(t,e,n){var r=this.length()+3;if(this._willBeOverCapacity(r))return this._pushOne(t),this._pushOne(e),void this._pushOne(n);var i=this._front+r-3;this._checkCapacity(r);var o=this._capacity-1;this[i+0&o]=t,this[i+1&o]=e,this[i+2&o]=n,this._length=r},i.prototype.shift=function(){var t=this._front,e=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,e},i.prototype.length=function(){return this._length},i.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<1)},i.prototype._resizeTo=function(t){var e=this._capacity;this._capacity=t;var n=this._front,i=this._length,o=n+i&e-1;r(this,0,this,e,o)},e.exports=i},{}],27:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){function o(t,o){var c=r(t);if(c instanceof e)return a(c);if(t=s.asArray(t),null===t)return i("expecting an array or an iterable object but got "+s.classString(t));var u=new e(n);void 0!==o&&u._propagateFrom(o,3);for(var l=u._fulfill,p=u._reject,f=0,h=t.length;h>f;++f){var _=t[f];(void 0!==_||f in t)&&e.cast(_)._then(l,p,void 0,u,null)}return u}var s=t("./util"),a=function(t){return t.then(function(e){return o(e,t)})};e.race=function(t){return o(t,void 0)},e.prototype.race=function(){return o(this,void 0)}}},{"./util":36}],28:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,s){function a(t,n,r,i){this.constructor$(t);var s=e._getContext();this._fn=f.contextBind(s,n),void 0!==r&&(r=e.resolve(r),r._attachCancellationCallback(this)),this._initialValue=r,this._currentCancellable=null,i===o?this._eachValues=Array(this._length):0===i?this._eachValues=null:this._eachValues=void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function c(t,e){this.isFulfilled()?e._resolve(t):e._reject(t)}function u(t,e,n,i){if("function"!=typeof e)return r("expecting a function but got "+f.classString(e));var o=new a(t,e,n,i);return o.promise()}function l(t){this.accum=t,this.array._gotAccum(t);var n=i(this.value,this.array._promise);return n instanceof e?(this.array._currentCancellable=n,n._then(p,void 0,void 0,this,void 0)):p.call(this,n)}function p(t){var n=this.array,r=n._promise,i=h(n._fn);r._pushContext();var o;o=void 0!==n._eachValues?i.call(r._boundValue(),t,this.index,this.length):i.call(r._boundValue(),this.accum,t,this.index,this.length),o instanceof e&&(n._currentCancellable=o);var a=r._popContext();return s.checkForgottenReturns(o,a,void 0!==n._eachValues?"Promise.each":"Promise.reduce",r),o}var f=t("./util"),h=f.tryCatch;f.inherits(a,n),a.prototype._gotAccum=function(t){void 0!==this._eachValues&&null!==this._eachValues&&t!==o&&this._eachValues.push(t)},a.prototype._eachComplete=function(t){return null!==this._eachValues&&this._eachValues.push(t),this._eachValues},a.prototype._init=function(){},a.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},a.prototype.shouldCopyValues=function(){return!1},a.prototype._resolve=function(t){this._promise._resolveCallback(t),this._values=null},a.prototype._resultCancelled=function(t){return t===this._initialValue?this._cancel():void(this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof e&&this._currentCancellable.cancel(),this._initialValue instanceof e&&this._initialValue.cancel()))},a.prototype._iterate=function(t){this._values=t;var n,r,i=t.length;void 0!==this._initialValue?(n=this._initialValue,r=0):(n=e.resolve(t[0]),r=1),this._currentCancellable=n;for(var o=r;i>o;++o){var s=t[o];s instanceof e&&s.suppressUnhandledRejections()}if(!n.isRejected())for(;i>r;++r){var a={accum:null,value:t[r],index:r,length:i,array:this};n=n._then(l,void 0,void 0,a,void 0),0===(127&r)&&n._setNoAsyncGuarantee()}void 0!==this._eachValues&&(n=n._then(this._eachComplete,void 0,void 0,this,void 0)),n._then(c,c,void 0,n,this)},e.prototype.reduce=function(t,e){return u(this,t,e,null)},e.reduce=function(t,e,n,r){return u(t,e,n,r)}}},{"./util":36}],29:[function(t,e,n){"use strict";var r,i=t("./util"),o=function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")},s=i.getNativePromise();if(i.isNode&&"undefined"==typeof MutationObserver){var a=global.setImmediate,c=process.nextTick;r=i.isRecentNode?function(t){a.call(global,t)}:function(t){c.call(process,t)}}else if("function"==typeof s&&"function"==typeof s.resolve){
var u=s.resolve();r=function(t){u.then(t)}}else r="undefined"!=typeof MutationObserver&&("undefined"==typeof window||!window.navigator||!window.navigator.standalone&&!window.cordova)&&"classList"in document.documentElement?function(){var t=document.createElement("div"),e={attributes:!0},n=!1,r=document.createElement("div"),i=new MutationObserver(function(){t.classList.toggle("foo"),n=!1});i.observe(r,e);var o=function(){n||(n=!0,r.classList.toggle("foo"))};return function(n){var r=new MutationObserver(function(){r.disconnect(),n()});r.observe(t,e),o()}}():"undefined"!=typeof setImmediate?function(t){setImmediate(t)}:"undefined"!=typeof setTimeout?function(t){setTimeout(t,0)}:o;e.exports=r},{"./util":36}],30:[function(t,e,n){"use strict";e.exports=function(e,n,r){function i(t){this.constructor$(t)}var o=e.PromiseInspection,s=t("./util");s.inherits(i,n),i.prototype._promiseResolved=function(t,e){this._values[t]=e;var n=++this._totalResolved;return n>=this._length?(this._resolve(this._values),!0):!1},i.prototype._promiseFulfilled=function(t,e){var n=new o;return n._bitField=33554432,n._settledValueField=t,this._promiseResolved(e,n)},i.prototype._promiseRejected=function(t,e){var n=new o;return n._bitField=16777216,n._settledValueField=t,this._promiseResolved(e,n)},e.settle=function(t){return r.deprecated(".settle()",".reflect()"),new i(t).promise()},e.allSettled=function(t){return new i(t).promise()},e.prototype.settle=function(){return e.settle(this)}}},{"./util":36}],31:[function(t,e,n){"use strict";e.exports=function(e,n,r){function i(t){this.constructor$(t),this._howMany=0,this._unwrap=!1,this._initialized=!1}function o(t,e){if((0|e)!==e||0>e)return r("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var n=new i(t),o=n.promise();return n.setHowMany(e),n.init(),o}var s=t("./util"),a=t("./errors").RangeError,c=t("./errors").AggregateError,u=s.isArray,l={};s.inherits(i,n),i.prototype._init=function(){if(this._initialized){if(0===this._howMany)return void this._resolve([]);this._init$(void 0,-5);var t=u(this._values);!this._isResolved()&&t&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}},i.prototype.init=function(){this._initialized=!0,this._init()},i.prototype.setUnwrap=function(){this._unwrap=!0},i.prototype.howMany=function(){return this._howMany},i.prototype.setHowMany=function(t){this._howMany=t},i.prototype._promiseFulfilled=function(t){return this._addFulfilled(t),this._fulfilled()===this.howMany()?(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0):!1},i.prototype._promiseRejected=function(t){return this._addRejected(t),this._checkOutcome()},i.prototype._promiseCancelled=function(){return this._values instanceof e||null==this._values?this._cancel():(this._addRejected(l),this._checkOutcome())},i.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var t=new c,e=this.length();e<this._values.length;++e)this._values[e]!==l&&t.push(this._values[e]);return t.length>0?this._reject(t):this._cancel(),!0}return!1},i.prototype._fulfilled=function(){return this._totalResolved},i.prototype._rejected=function(){return this._values.length-this.length()},i.prototype._addRejected=function(t){this._values.push(t)},i.prototype._addFulfilled=function(t){this._values[this._totalResolved++]=t},i.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},i.prototype._getRangeError=function(t){var e="Input array must contain at least "+this._howMany+" items but contains only "+t+" items";return new a(e)},i.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},e.some=function(t,e){return o(t,e)},e.prototype.some=function(t){return o(this,t)},e._SomePromiseArray=i}},{"./errors":12,"./util":36}],32:[function(t,e,n){"use strict";e.exports=function(t){function e(t){void 0!==t?(t=t._target(),this._bitField=t._bitField,this._settledValueField=t._isFateSealed()?t._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}e.prototype._settledValue=function(){return this._settledValueField};var n=e.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},r=e.prototype.error=e.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},i=e.prototype.isFulfilled=function(){return 0!==(33554432&this._bitField)},o=e.prototype.isRejected=function(){return 0!==(16777216&this._bitField)},s=e.prototype.isPending=function(){return 0===(50397184&this._bitField)},a=e.prototype.isResolved=function(){return 0!==(50331648&this._bitField)};e.prototype.isCancelled=function(){return 0!==(8454144&this._bitField)},t.prototype.__isCancelled=function(){return 65536===(65536&this._bitField)},t.prototype._isCancelled=function(){return this._target().__isCancelled()},t.prototype.isCancelled=function(){return 0!==(8454144&this._target()._bitField)},t.prototype.isPending=function(){return s.call(this._target())},t.prototype.isRejected=function(){return o.call(this._target())},t.prototype.isFulfilled=function(){return i.call(this._target())},t.prototype.isResolved=function(){return a.call(this._target())},t.prototype.value=function(){return n.call(this._target())},t.prototype.reason=function(){var t=this._target();return t._unsetRejectionIsUnhandled(),r.call(t)},t.prototype._value=function(){return this._settledValue()},t.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},t.PromiseInspection=e}},{}],33:[function(t,e,n){"use strict";e.exports=function(e,n){function r(t,r){if(l(t)){if(t instanceof e)return t;var i=o(t);if(i===u){r&&r._pushContext();var c=e.reject(i.e);return r&&r._popContext(),c}if("function"==typeof i){if(s(t)){var c=new e(n);return t._then(c._fulfill,c._reject,void 0,c,null),c}return a(t,i,r)}}return t}function i(t){return t.then}function o(t){try{return i(t)}catch(e){return u.e=e,u}}function s(t){try{return p.call(t,"_promise0")}catch(e){return!1}}function a(t,r,i){function o(t){a&&(a._resolveCallback(t),a=null)}function s(t){a&&(a._rejectCallback(t,p,!0),a=null)}var a=new e(n),l=a;i&&i._pushContext(),a._captureStackTrace(),i&&i._popContext();var p=!0,f=c.tryCatch(r).call(t,o,s);return p=!1,a&&f===u&&(a._rejectCallback(f.e,!0,!0),a=null),l}var c=t("./util"),u=c.errorObj,l=c.isObject,p={}.hasOwnProperty;return r}},{"./util":36}],34:[function(t,e,n){"use strict";e.exports=function(e,n,r){function i(t){this.handle=t}function o(t){return clearTimeout(this.handle),t}function s(t){throw clearTimeout(this.handle),t}var a=t("./util"),c=e.TimeoutError;i.prototype._resultCancelled=function(){clearTimeout(this.handle)};var u=function(t){return l(+this).thenReturn(t)},l=e.delay=function(t,o){var s,a;return void 0!==o?(s=e.resolve(o)._then(u,null,null,t,void 0),r.cancellation()&&o instanceof e&&s._setOnCancel(o)):(s=new e(n),a=setTimeout(function(){s._fulfill()},+t),r.cancellation()&&s._setOnCancel(new i(a)),s._captureStackTrace()),s._setAsyncGuaranteed(),s};e.prototype.delay=function(t){return l(t,this)};var p=function(t,e,n){var r;r="string"!=typeof e?e instanceof Error?e:new c("operation timed out"):new c(e),a.markAsOriginatingFromRejection(r),t._attachExtraTrace(r),t._reject(r),null!=n&&n.cancel()};e.prototype.timeout=function(t,e){t=+t;var n,a,c=new i(setTimeout(function(){n.isPending()&&p(n,e,a)},t));return r.cancellation()?(a=this.then(),n=a._then(o,s,void 0,c,void 0),n._setOnCancel(c)):n=this._then(o,s,void 0,c,void 0),n}}},{"./util":36}],35:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o,s){function a(t){setTimeout(function(){throw t},0)}function c(t){var e=r(t);return e!==t&&"function"==typeof t._isDisposable&&"function"==typeof t._getDisposer&&t._isDisposable()&&e._setDisposable(t._getDisposer()),e}function u(t,n){function i(){if(s>=u)return l._fulfill();var o=c(t[s++]);if(o instanceof e&&o._isDisposable()){try{o=r(o._getDisposer().tryDispose(n),t.promise)}catch(p){return a(p)}if(o instanceof e)return o._then(i,a,null,null,null)}i()}var s=0,u=t.length,l=new e(o);return i(),l}function l(t,e,n){this._data=t,this._promise=e,this._context=n}function p(t,e,n){this.constructor$(t,e,n)}function f(t){return l.isDisposer(t)?(this.resources[this.index]._setDisposable(t),t.promise()):t}function h(t){this.length=t,this.promise=null,this[t-1]=null}var _=t("./util"),d=t("./errors").TypeError,v=t("./util").inherits,y=_.errorObj,g=_.tryCatch,m={};l.prototype.data=function(){return this._data},l.prototype.promise=function(){return this._promise},l.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():m},l.prototype.tryDispose=function(t){var e=this.resource(),n=this._context;void 0!==n&&n._pushContext();var r=e!==m?this.doDispose(e,t):null;return void 0!==n&&n._popContext(),this._promise._unsetDisposable(),this._data=null,r},l.isDisposer=function(t){return null!=t&&"function"==typeof t.resource&&"function"==typeof t.tryDispose},v(p,l),p.prototype.doDispose=function(t,e){var n=this.data();return n.call(t,t,e)},h.prototype._resultCancelled=function(){for(var t=this.length,n=0;t>n;++n){var r=this[n];r instanceof e&&r.cancel()}},e.using=function(){var t=arguments.length;if(2>t)return n("you must pass at least 2 arguments to Promise.using");var i=arguments[t-1];if("function"!=typeof i)return n("expecting a function but got "+_.classString(i));var o,a=!0;2===t&&Array.isArray(arguments[0])?(o=arguments[0],t=o.length,a=!1):(o=arguments,t--);for(var c=new h(t),p=0;t>p;++p){var d=o[p];if(l.isDisposer(d)){var v=d;d=d.promise(),d._setDisposable(v)}else{var m=r(d);m instanceof e&&(d=m._then(f,null,null,{resources:c,index:p},void 0))}c[p]=d}for(var b=new Array(c.length),p=0;p<b.length;++p)b[p]=e.resolve(c[p]).reflect();var w=e.all(b).then(function(t){for(var e=0;e<t.length;++e){var n=t[e];if(n.isRejected())return y.e=n.error(),y;if(!n.isFulfilled())return void w.cancel();t[e]=n.value()}C._pushContext(),i=g(i);var r=a?i.apply(void 0,t):i(t),o=C._popContext();return s.checkForgottenReturns(r,o,"Promise.using",C),r}),C=w.lastly(function(){var t=new e.PromiseInspection(w);return u(c,t)});return c.promise=C,C._setOnCancel(c),C},e.prototype._setDisposable=function(t){this._bitField=131072|this._bitField,this._disposer=t},e.prototype._isDisposable=function(){return(131072&this._bitField)>0},e.prototype._getDisposer=function(){return this._disposer},e.prototype._unsetDisposable=function(){this._bitField=-131073&this._bitField,this._disposer=void 0},e.prototype.disposer=function(t){if("function"==typeof t)return new p(t,this,i());throw new d}}},{"./errors":12,"./util":36}],36:[function(t,e,n){"use strict";function r(){try{var t=P;return P=null,t.apply(this,arguments)}catch(e){return T.e=e,T}}function i(t){return P=t,r}function o(t){return null==t||t===!0||t===!1||"string"==typeof t||"number"==typeof t}function s(t){return"function"==typeof t||"object"==typeof t&&null!==t}function a(t){return o(t)?new Error(v(t)):t}function c(t,e){var n,r=t.length,i=new Array(r+1);for(n=0;r>n;++n)i[n]=t[n];return i[n]=e,i}function u(t,e,n){if(!F.isES5)return{}.hasOwnProperty.call(t,e)?t[e]:void 0;var r=Object.getOwnPropertyDescriptor(t,e);return null!=r?null==r.get&&null==r.set?r.value:n:void 0}function l(t,e,n){if(o(t))return t;var r={value:n,configurable:!0,enumerable:!1,writable:!0};return F.defineProperty(t,e,r),t}function p(t){throw t}function f(t){try{if("function"==typeof t){var e=F.names(t.prototype),n=F.isES5&&e.length>1,r=e.length>0&&!(1===e.length&&"constructor"===e[0]),i=A.test(t+"")&&F.names(t).length>0;if(n||r||i)return!0}return!1}catch(o){return!1}}function h(t){function e(){}function n(){return typeof r.foo}e.prototype=t;var r=new e;return n(),n(),t}function _(t){return V.test(t)}function d(t,e,n){for(var r=new Array(t),i=0;t>i;++i)r[i]=e+i+n;return r}function v(t){try{return t+""}catch(e){return"[no string representation]"}}function y(t){return t instanceof Error||null!==t&&"object"==typeof t&&"string"==typeof t.message&&"string"==typeof t.name}function g(t){try{l(t,"isOperational",!0)}catch(e){}}function m(t){return null==t?!1:t instanceof Error.__BluebirdErrorTypes__.OperationalError||t.isOperational===!0}function b(t){return y(t)&&F.propertyIsWritable(t,"stack")}function w(t){return{}.toString.call(t)}function C(t,e,n){for(var r=F.names(t),i=0;i<r.length;++i){var o=r[i];if(n(o))try{F.defineProperty(e,o,F.getDescriptor(t,o))}catch(s){}}}function j(t){return N?process.env[t]:void 0}function k(){if("function"==typeof Promise)try{var t=new Promise(function(){});if("[object Promise]"===w(t))return Promise}catch(e){}}function E(t,e){if(null===t||"function"!=typeof e||e===U)return e;null!==t.domain&&(e=t.domain.bind(e));var n=t.async;if(null!==n){var r=e;e=function(){var t=new Array(2).concat([].slice.call(arguments));return t[0]=r,t[1]=this,n.runInAsyncScope.apply(n,t)}}return e}var F=t("./es5"),x="undefined"==typeof navigator,T={e:{}},P,R="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0!==this?this:null,S=function(t,e){function n(){this.constructor=t,this.constructor$=e;for(var n in e.prototype)r.call(e.prototype,n)&&"$"!==n.charAt(n.length-1)&&(this[n+"$"]=e.prototype[n])}var r={}.hasOwnProperty;return n.prototype=e.prototype,t.prototype=new n,t.prototype},O=function(){var t=[Array.prototype,Object.prototype,Function.prototype],e=function(e){for(var n=0;n<t.length;++n)if(t[n]===e)return!0;return!1};if(F.isES5){var n=Object.getOwnPropertyNames;return function(t){for(var r=[],i=Object.create(null);null!=t&&!e(t);){var o;try{o=n(t)}catch(s){return r}for(var a=0;a<o.length;++a){var c=o[a];if(!i[c]){i[c]=!0;var u=Object.getOwnPropertyDescriptor(t,c);null!=u&&null==u.get&&null==u.set&&r.push(c)}}t=F.getPrototypeOf(t)}return r}}var r={}.hasOwnProperty;return function(n){if(e(n))return[];var i=[];t:for(var o in n)if(r.call(n,o))i.push(o);else{for(var s=0;s<t.length;++s)if(r.call(t[s],o))continue t;i.push(o)}return i}}(),A=/this\s*\.\s*\S+\s*=/,V=/^[a-z$_][a-z$_0-9]*$/i,H=function(){return"stack"in new Error?function(t){return b(t)?t:new Error(v(t))}:function(t){if(b(t))return t;try{throw new Error(v(t))}catch(e){return e}}}(),D=function(t){return F.isArray(t)?t:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var I="function"==typeof Array.from?function(t){return Array.from(t)}:function(t){for(var e,n=[],r=t[Symbol.iterator]();!(e=r.next()).done;)n.push(e.value);return n};D=function(t){return F.isArray(t)?t:null!=t&&"function"==typeof t[Symbol.iterator]?I(t):null}}var L="undefined"!=typeof process&&"[object process]"===w(process).toLowerCase(),N="undefined"!=typeof process&&"undefined"!=typeof process.env,U,B={setReflectHandler:function(t){U=t},isClass:f,isIdentifier:_,inheritedDataKeys:O,getDataPropertyOrDefault:u,thrower:p,isArray:F.isArray,asArray:D,notEnumerableProp:l,isPrimitive:o,isObject:s,isError:y,canEvaluate:x,errorObj:T,tryCatch:i,inherits:S,withAppended:c,maybeWrapAsError:a,toFastProperties:h,filledRange:d,toString:v,canAttachTrace:b,ensureErrorObject:H,originatesFromRejection:m,markAsOriginatingFromRejection:g,classString:w,copyDescriptors:C,isNode:L,hasEnvVariables:N,env:j,global:R,getNativePromise:k,contextBind:E};B.isRecentNode=B.isNode&&function(){var t;return process.versions&&process.versions.node?t=process.versions.node.split(".").map(Number):process.version&&(t=process.version.split(".").map(Number)),0===t[0]&&t[1]>10||t[0]>0}(),B.nodeSupportsAsyncResource=B.isNode&&function(){var e=!1;try{var n=t("async_hooks").AsyncResource;e="function"==typeof n.prototype.runInAsyncScope}catch(r){e=!1}return e}(),B.isNode&&B.toFastProperties(process);try{throw new Error}catch(M){B.lastLineError=M}e.exports=B},{"./es5":13,async_hooks:void 0}]},{},[4])(4)}),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise);
}
!function(){"use strict";var e,t=globalThis.Dynamsoft;function n(t){return t===e}function r(t){return t!==e}function i(e){return null===e}var o={"[object Function]":"function","[object String]":"string","[object Object]":"object","[object Boolean]":"boolean","[object Number]":"number","[object Array]":"array"};function s(e){return i(e)||n(e)?String(e):o[{}.toString.call(e)]||"object"}function a(e){return"function"===s(e)}function c(e){return"string"===s(e)}function u(e){return"object"===s(e)}function l(e){return"boolean"===s(e)}function h(e){return"number"===s(e)}function f(e){return Array.isArray?Array.isArray(e):"array"===s(e)}var d=!0,A=!1;function p(e,t,r){if(e){var i=void 0,o=void 0,s=void 0,c=0,u=e.length;if(r=r||null,n(u)||a(e))for(s=Object.keys(e);c<s.length&&(i=s[c],t.call(r,e[i],i,e)!==A);c++);else for(o=e[0];c<u&&t.call(r,o,c,e)!==A;o=e[++c]);}return e}var g={}.hasOwnProperty;function y(e){if(!e||"object"!==s(e)||e.nodeType||e.window==e)return A;var t,r;try{if((r=e.constructor)&&!g(e,"constructor")&&!g(r.prototype,"isPrototypeOf"))return A}catch(i){return A}for(t in e);return n(t)||g(e,t)}var m="object"==typeof HTMLElement;function b(e){return m?e instanceof HTMLElement:e&&"object"==typeof e&&(1===e.nodeType||9===e.nodeType)&&"string"==typeof e.nodeName}function C(e){var t=e;if(b(e))for(;!t&&t!=document.body;)t=t.parentNode;else t=0;return!!t}var v="",w=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,P=String.prototype,I=P.trim;function E(e,t){return 0===e.lastIndexOf(t,0)}function S(e,t){var n=e.length-t.length;return n>=0&&e.indexOf(t,n)===n}function x(e){return null==e?v:I.call(e)}function B(e){if(null==e)return[];if(f(e))return e;var t=typeof e.length,n=typeof e;if("number"!==t||e.alert||"string"===n||"function"===n&&(!("item"in e)||"number"!==t))return[e];for(var r=[],i=0,o=e.length;i<o;i++)r[i]=e[i];return r}function T(e){var t=e?new Date(e):new Date,n="yyyy-MM-dd HH:mm:ss.SSSZ",r={"M+":t.getUTCMonth()+1,"d+":t.getUTCDate(),"H+":t.getUTCHours(),"h+":t.getUTCHours()%12||12,"m+":t.getUTCMinutes(),"s+":t.getUTCSeconds(),"q+":Math.floor((t.getUTCMonth()+3)/3),"S+":t.getUTCMilliseconds()};for(var i in/(y+)/.test(n)&&(n=n.replace(RegExp.$1,(t.getUTCFullYear()+"").substr(4-RegExp.$1.length))),r)new RegExp("("+i+")").test(n)&&(n=n.replace(RegExp.$1,1==RegExp.$1.length?r[i]:("000"+r[i]).substr(("000"+r[i]).length-RegExp.$1.length)));return n}I||(I=P.trim=function(){return this.replace(w,v)});var k,z,L=t.Lib,Q=L.win;function M(e,t,n,r){if(L.debug&&z&&a(z.log)){var i=T((new Date).getTime()),o=B(arguments);z.log(["[",i,"] ",o].join(""))}}function D(e,t,n,r){if((L.debug||L.showConsoleError)&&z&&a(z.error)){var i=T((new Date).getTime()),o=B(arguments);z.error(["[",i,"] ",o].join(""))}}function F(e,t,n,r){if(L.debug&&z&&a(z.warn)){var i=T((new Date).getTime()),o=B(arguments);z.warn(["[",i,"] ",o].join(""))}}function R(e,t,n,r){if(L.debug&&z&&a(z.info)){var i=T((new Date).getTime()),o=B(arguments);z.info(["[",i,"] ",o].join(""))}}function j(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function H(e){if(null==e||"object"!=typeof e)return e;var t,n,r;if(e instanceof Date)return(t=new Date).setTime(e.getTime()),t;if(e instanceof Array){for(t=[],r=e.length,n=0;n<r;n++)t[n]=H(e[n]);return t}if(e instanceof Object){for(n in t={},e)e.hasOwnProperty(n)&&(t[n]=H(e[n]));return t}return 0}Q&&r(Q.console)&&(a((z=Q.console).log)&&a(z.error)?k={log:M,error:D,info:R,warn:F,debug:function(e,t,n,r){if(L.debug&&z&&a(z.debug)){var i=T((new Date).getTime()),o=B(arguments);z.debug(["[",i,"] ",o].join(""))}}}:(z=!1,k=!1)),L.showConsoleError=!1;var N=/[#\/\?@]/g,U=/[#\?]/g,J={scheme:1,userInfo:2,hostname:3,port:4,path:5},K=new RegExp("^(?:([\\w\\d+.-]+):)?(?://(?:([^/?#@]*)@)?([\\w\\d\\-\\u0100-\\uffff.+%]*|\\[[^\\]]+\\])(?::([0-9]+))?)?(.+)?$");function O(e,t){return c(e)&&c(t)?e.toLowerCase()===t.toLowerCase():e===t}function G(e,t){return encodeURI(e).replace(t,(function(e){return"%"+function(e){return 1===e.length?"0"+e:e}(e.charCodeAt(0).toString(16))}))}var Y=function(){function e(t){if(this.scheme="",this.userInfo="",this.hostname="",this.port="",this.path="",t instanceof e)return H(t);e.getComponents(t,this)}return e.prototype.clone=function(){var t=new e,n=this;return p(J,(function(e,r){t[r]=n[r]})),t},e.prototype.getScheme=function(){return this.scheme},e.prototype.setScheme=function(e){return this.scheme=e,this},e.prototype.getHostname=function(){return this.hostname},e.prototype.setHostname=function(e){return this.hostname=e,this},e.prototype.setUserInfo=function(e){return this.userInfo=e,this},e.prototype.getUserInfo=function(){return this.userInfo},e.prototype.setPort=function(e){return this.port=e,this},e.prototype.getPort=function(){return this.port},e.prototype.setPath=function(e){return this.path=e,this},e.prototype.getPath=function(){return this.path},e.prototype.isSameOriginAs=function(e){var t=this;return O(t.hostname,e.hostname)&&O(t.scheme,e.scheme)&&O(t.port,e.port)},e.prototype.toString=function(e){var t,n,r,i,o,s=[],a=this;return(t=a.scheme)&&(s.push(G(t,N)),s.push(":")),(n=a.hostname)&&(s.push("//"),(o=a.userInfo)&&(s.push(G(o,N)),s.push("@")),s.push(encodeURIComponent(n)),(i=a.port)&&(s.push(":"),s.push(i))),(r=a.path)&&(n&&!E(r,"/")&&(r="/"+r),s.push(G(r,U))),s.join("")},e.getComponents=function(e,t){var n=(e=e||v).match(K)||[],r=t||{};return p(J,(function(e,t){r[t]=n[e]})),r},e}(),W=t.Lib,V=t.navInfoSync,q=V.bIE&&parseInt(V.IEVersion)<=9,Z=V.bIE&&parseInt(V.IEVersion)<=10,X=W.win,_=new Y(location.href),$=_&&/^(?:about|app|app\-storage|.+\-extension|file|widget)$/.test(_.getScheme()),ee=!1,te=function(){try{return new X.XMLHttpRequest}catch(e){}},ne=function(){try{var e=A;return p(["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.3.0","Msxml3.XMLHTTP"],(function(t){try{if(!e)return e=new X.ActiveXObject(t),A}catch(n){D("new xhr error: "+n.message)}})),e}catch(t){}},re=!($||!X.XMLHttpRequest)&&"withCredentials"in(te()||[]),ie=X.ActiveXObject?function(e){return q?ne():!$&&te()||ne()}:te,oe=function(e){return ee},se=/^(?:GET|HEAD)$/,ae=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,ce={xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":"*/*"},ue=undefined;Z&&(ue=function(){});var le=function(){function e(){this.url=!1,this.onSuccess=!1,this.onError=!1,this.onComplete=!1,this.method="GET",this.async=!0,this.xhrFields=!1,this.mimeType=!1,this.username=!1,this.password=!1,this.data=!1,this.dataType="text",this.headers=!1,this.contentType="application/x-www-form-urlencoded; charset=UTF-8",this.beforeSend=!1,this.afterSend=!1,this.timeout=0,this.cache=!0,this.crossDomain=!1,this.retry=0}return e.prototype.setRequestHeader=function(e,t){this.headers[e]=t},e.prototype.getAllResponseHeaders=function(){return 2===this.state?this.responseHeadersString:null},e.prototype.getNativeXhr=function(){return this.nativeXhr},e.prototype.getResponseHeader=function(e){var t,n;if(e=e.toLowerCase(),2===this.state){if(!(n=this.responseHeaders))for(n=this.responseHeaders={};t=ae.exec(this.responseHeadersString);)n[t[1].toLowerCase()]=t[2];t=n[e]}return t===undefined?null:t},e.prototype.overrideMimeType=function(e){return this.state||(this.mimeType=e),this},e.prototype.abort=function(e){return e=e||"abort",this.state=3,this.status=0,this.statusText=e,this.nativeXhr&&this.nativeXhr.abort(),this._callback(),this},e.prototype._ioReady=function(e,t){var n=!1,r=this;if(2!==this.state&&3!==this.state){1===this.state&&(this.state=2),this.readyState=4,e>=200&&e<300||304===e?304===e?(t="not modified",n=!0):(t="success",n=!0):e<0&&(e=0);try{e>=200&&this.handleResponseData()}catch(i){D(i,"error"),t=i.message||"parser error"}if((e<200||!n)&&this.retry>0)return this.retry=this.retry-1,void setTimeout((function(){r.sendInternal()}),200);this.status=e,this.statusText=t,this._callback(n)}},e.prototype._callback=function(e){var t=this,n=this.timeoutTimer;n&&(clearTimeout(n),this.timeoutTimer=0),p([e?this.onSuccess:this.onError,this.onComplete],(function(e){a(e)&&e.apply(t.context,[t.responseData,t.statusText,t])})),this.responseData=null},e.prototype.handleResponseData=function(){var e,n=this.dataType,r=this.nativeXhr;if("blob"===n||"arraybuffer"===n)if(q){var i=void 0,o=void 0;if("responseBody"in r)i=r.responseBody,o=X.dsVbsBinGetLength(i),e=new X.VBArray(X.dsVbsBinGetBytes(i,0,o)).toArray();else{var s=void 0;for(e=[],o=(i=r.responseText).length,s=0;s<o;++s)e.push(255&i.charCodeAt(s))}i=null}else e=X.Blob?r.response:"responseBody"in r?r.responseBody:r.responseText;else if("json"==n)e=r.responseType&&"json"==r.responseType.toLowerCase()?r.response:r.responseText?t.Lib.parse(r.responseText):t.Lib.parse(r.response);else if("user-defined"===n)e=r.response!==undefined?r.response:r.responseText;else{this.responseText=e=r.responseText||"";try{var a=r.responseXML;a&&a.documentElement&&(this.responseXML=a)}catch(c){}}this.responseData=e},e.prototype.sendInternal=function(e){var t,n,r,i,o,s,u,l,f,d,A,g=this;if(c(n=(t=this._setup(e)).method)&&(n=n.toUpperCase()),o=t.contentType,r=t.url,i=t.dataType,l=t.mimeType,c(r)&&(this.nativeXhr=s=ie(t.crossDomain),s)){try{if(this.state=1,t.username?s.open(n,r,t.async,t.username,t.password):s.open(n,r,t.async),(t.async||V.bIE)&&i&&"user-defined"!=i&&"responseType"in s)try{s.responseType=i}catch(y){}}catch(m){return void(this.state<2?(D(m,"error"),this._ioReady(-1,"open error: "+(h(m.number)?"("+m.number+")":"")+(m.message||""))):D(m))}"withCredentials"in(u=t.xhrFields||{})&&(re||delete u.withCredentials),p(u,(function(e,t){try{s[t]=e}catch(y){D(y)}})),l&&s.overrideMimeType&&s.overrideMimeType(l),!1===(f=t.headers||{})["X-Requested-With"]&&delete f["X-Requested-With"],"setRequestHeader"in s&&(o&&s.setRequestHeader("Content-Type",t.contentType),s.setRequestHeader("Accept",i&&ce[i]?ce[i]+("*"===i?"":", */*; q=0.01"):ce["*"]),p(f,(function(e,t){s.setRequestHeader(t,e)}))),t.cache||(s.setRequestHeader("If-Modified-Since","0"),s.setRequestHeader("Cache-Control","no-cache")),A=(d=!se.test(t.method))&&t.data||null,d&&q&&(A=t.data),t.async&&t.timeout>0&&(t.timeout<300&&(t.timeout=300),this.timeoutTimer=setTimeout((function(){g.abort("timeout")}),t.timeout));try{if(this.state=1,a(this.beforeSend))if(!1===this.beforeSend(s,g))return void this.abort("cancel");s.send(A),A=null,t.data=null,a(this.afterSend)&&this.afterSend(g)}catch(y){this.state<2?(D(y,"error"),this._ioReady(-1,"send error: "+(y.message||""))):D(y)}t.async&&4!==s.readyState?s.onreadystatechange=function(){g._xhrCallback()}:g._xhrCallback()}},e.prototype._xhrCallback=function(e,t){var n=this.nativeXhr;try{if(4===n.readyState||t)if(oe()||(n.onreadystatechange=ue),t)4!==n.readyState&&n.abort();else{oe()||(this.responseHeadersString=n.getAllResponseHeaders());var r=n.status,i=void 0;try{i=n.statusText}catch(o){D("xhr statusText error: "),D(o),i=""}this._ioReady(r,i)}}catch(o){D(o,"error"),n.onreadystatechange=ue,t||this._ioReady(-1,o.message||"process error")}},e.prototype._setup=function(t){var r,i,o,s,a;if(t){for(i in this.context=t.context,delete t.context,t instanceof e&&(t=t.config),this.config=t,E(s=t.url,"//")&&(t.url=s="http:"+s),(E(s,"http://")||E(s,"https://"))&&(a=new Y(s)),r=t.dataType?t.dataType.toLowerCase():"text",t.dataType=r,t.method?t.method=t.method.toUpperCase():t.method="GET",a&&!("crossDomain"in t)&&(t.crossDomain=!a.isSameOriginAs(_)),o=t.headers)n(o[i])&&delete o[i];j(this,t)}return this.state=1,this},e}();function he(e){if(e&&c(e.url)){var t=new le;return t.sendInternal(e),t}M("the url is error.")}var fe=function(){function e(){}return e.prototype.get=function(e,t,n,r){return he({method:"GET",url:e,onSuccess:t,onError:n,dataType:r})},e.prototype.post=function(e,t,n,r,i){return he({method:"POST",data:t,url:e,onSuccess:n,onError:r,dataType:i})},e.prototype.put=function(e,t,n,r,i){return he({method:"PUT",data:t,url:e,onSuccess:n,onError:r,dataType:i})},e}();function de(e){var n,r;if(!t.Lib.bNode&&!t.navInfoSync.bJSDom){var i=t.Lib.doc;if(i&&c(r=e.body)&&r!=v){(n=i.createElement("script")).charset="utf-8",t.navInfoSync.bIE?n.text=r:n.appendChild(i.createTextNode(r)),e.language?n.language=e.language:n.language="javascript",e.type?n.type=e.type:n.type="text/javascript";var o=i&&i.documentElement,s=i.getElementsByTagName("head")[0]||o;s.insertBefore(n,s.firstChild)}}}function Ae(e){de({body:e})}function pe(e){de({body:e,language:"vbscript",type:"text/vbscript"})}var ge,ye,me,be=t.Lib,Ce=be.win,ve=t.navInfoSync,we=ve.bIE&&parseInt(ve.IEVersion)<=9;(ge=self&&self.fetch?self.fetch:Ce.fetch)?me=function(e,t){var n="text",r=!1;if(t&&(t.dataType&&(n=t.dataType),t.fetchRaw&&(r=!0),t.timeout)){var i=t.timeout;i<300&&(i=300);var o=new AbortController;t.signal=o.signal,setTimeout((function(){o.abort()}),i)}var s=ge(e,t).then((function(e){if(e.ok)return e;throw{httpCode:e.status,errorString:["HTTP process error: ",e.statusText," (",e.status,")."].join("")}}));return r?s:s="blob"==n?s.then((function(e){return e.blob()})):"json"==n?s.then((function(e){return e.json()})):"arraybuffer"==n?s.then((function(e){return e.arrayBuffer()})):s.then((function(e){return e.text()}))}:(we&&pe(["Function dsVbsBinGetAt(strBinary,iOffset)\r\n"," dsVbsBinGetAt=AscB(MidB(strBinary,iOffset+1,1))\r\n","End Function\r\n","Function dsVbsBinGetBytes(strBinary,iOffset,iLength)\r\n"," Dim aBytes()\r\n"," ReDim aBytes(iLength-1)\r\n"," For i=0 To iLength-1\r\n","  aBytes(i)=dsVbsBinGetAt(strBinary,iOffset+i)\r\n"," Next\r\n"," dsVbsBinGetBytes=aBytes\r\n","End Function\r\n","Function dsVbsBinGetLength(strBinary)\r\n"," dsVbsBinGetLength=LenB(strBinary)\r\n","End Function"].join("")),me=function(e,t){return new(be.nativePromise||window.Promise)((function(n,r){var i={url:e,onSuccess:function(e,t,r){n(e)},onError:function(e,t,n){r({httpCode:n.status,errorString:t})},dataType:"text",method:ye,data:ye,headers:ye,contentType:ye,mimeType:ye},o=!1;t&&(t.method&&(i.method=t.method),t.body&&(i.data=t.body),t.headers&&(i.headers||(i.headers={}),p(t.headers,(function(e,t){"content-type"==t.toLowerCase()&&(o=!0),i.headers[t]=e}))),t.dataType&&(i.dataType=t.dataType),t.contentType&&(i.contentType=t.contentType)),o&&(i.contentType=!1),"blob"==i.dataType&&we&&(i.mimeType="text/plain; charset=x-user-defined"),he(i)}))});var Pe=t.Lib,Ie=Pe.bNode,Ee=Pe.Promise||(Ie?global.Promise:window.Promise);function Se(){if(t.navInfo)return Ee.resolve(t.navInfo);var e,n,r=Pe.bNode||t.navInfoSync.bJSDom?undefined:navigator;if(r&&"userAgentData"in r){var i=navigator.userAgentData;if(i.platform&&""!=i.platform){var o=[];if("brands"in i&&Pe.isArray(i.brands)&&i.brands.length>0?o=i.brands:"uaList"in i&&Pe.isArray(i.uaList)&&i.uaList.length>0&&(o=i.uaList),o.length>0)return(n=function(e){var n=t.navInfoSync,r=e.architecture.toLowerCase(),i="64"==e.bitness,o=r.indexOf("arm")>-1,s=r.indexOf("mips")>-1;return{bUseUserAgent:!1,bWin:n.bWin,bMac:n.bMac,bLinux:n.bLinux,bAndroid:n.bAndroid,bMobile:n.bMobile,bPad:n.bPad,bChromeOS:n.bChromeOS,bHarmonyOS:n.bHarmonyOS,bArm64:o,bMips64:s,bEmbed:o||s,bOSx64:i,bIE:!1,bEdge:n.bEdge,bChrome:n.bChrome,bFirefox:n.bFirefox,bSafari:n.bSafari,bOpera:n.bOpera,bGecko:!0,bHuaWeiBrowser:!1,bHTML5Edition:!0,strBrowserVersion:n.strBrowserVersion,IEMode:0}},e?Ee.resolve((function(){return n(e)})):navigator.userAgentData.getHighEntropyValues(["platform","platformVersion","architecture","bitness"]).then(n)).then((function(e){return t.navInfo=e,e}))}}return t.navInfo=t.navInfoSync,Ee.resolve(t.navInfo)}var xe,Be=undefined,Te=function(e){return"function"==typeof e},ke=function(e){return Array.isArray?Array.isArray(e):e instanceof Array},ze=function(e){return!1===e||e===Be||null===e},Le="undefined",Qe=typeof TypeError===Le?Error:TypeError;if(typeof process!==Le&&process.nextTick)xe=process.nextTick;else if(typeof MessageChannel!==Le){var Me=new MessageChannel,De=[];Me.port1.onmessage=function(){De.length&&De.shift()()},xe=function(e){De.push(e),Me.port2.postMessage(0)}}else xe=function(e){setTimeout(e,0)};function Fe(e){xe((function(){throw e}))}function Re(e){return this.then(e,Be)}function je(e){return this.then(Be,e)}function He(e,t){return this.then((function(t){return Te(e)?e.apply(null,ke(t)?t:[t]):Ke.onlyFuncs?t:e}),t||Be)}function Ne(e){function t(){e()}return this.then(t,t),this}function Ue(e){return this.then((function(t){return Te(e)?e.apply(null,ke(t)?t.splice(0,0,undefined)&&t:[undefined,t]):Ke.onlyFuncs?t:e}),(function(t){return e(t)}))}function Je(e){return this.then(Be,e?function(t){throw e(t),t}:Fe)}var Ke=function(){function e(t){this.alwaysAsyncFn=null,this.status=0,this.pendings=[],this.promise={then:function(t,n){var r=new e;return this.pendings.push([function(n){try{ze(t)?r.resolve(n):r.resolve(Te(t)?t(n):e.onlyFuncs?n:t)}catch(i){r.reject(i)}},function(t){if((ze(n)||!Te(n)&&e.onlyFuncs)&&r.reject(t),n)try{r.resolve(Te(n)?n(t):n)}catch(i){r.reject(i)}}]),0!==this.status&&this.alwaysAsyncFn(this.execCallbacks),r.promise},success:Re,error:je,otherwise:je,apply:He,spread:He,ensure:Ne,nodify:Ue,rethrow:Je,isPending:function(){return 0===this.status},getStatus:function(){return this.status}},this.alwaysAsyncFn=(Be!==t?t:e.alwaysAsync)?xe:function(e){e()},this.promise.toSource=this.promise.toString=this.promise.valueOf=function(){return this.value===undefined?this:this.value}}return e.prototype.resolve=function(e){var t,n=!1;function r(e){return function(t){return n?undefined:(n=!0,e(t))}}if(this.status)return this;try{var i=!(!(t=e)||!(typeof t).match(/function|object/))&&e.then;if(Te(i)){if(e===this.promise)throw new Qe("Promise can't resolve itself");return i.call(e,r(this.resolve),r(this.reject)),this}}catch(o){return r(this.reject)(o),this}return this.alwaysAsyncFn((function(){this.value=e,this.status=1,this.execCallbacks()})),this},e.prototype.reject=function(e){return this.status||this.alwaysAsyncFn((function(){try{throw e}catch(t){this.value=t}this.status=-1,this.execCallbacks()})),this},e.prototype.execCallbacks=function(){if(0!==this.status){var e,t=this.pendings,n=0,r=t.length,i=~this.status?0:1;for(this.pendings=[];n<r;n++)(e=t[n][i])&&e(this.value)}},e.deferred=e,e.defer=e,e.nextTick=xe,e.alwaysAsync=!0,e.onlyFuncs=!0,e.resolve=function(t){return new e(!0).resolve(t).promise},e.resolved=e.resolve,e.fulfilled=e.resolve,e.reject=function(t){return new e(!0).reject(t).promise},e.rejected=e.reject,e}();var Oe=t.Lib,Ge=/^(\/?)([\s\S]+\/(?!$)|\/)?((?:\.{1,2}$|[\s\S]+?)?(\.[^.\/]*)?)$/;function Ye(e,t){var n,r=[];for(n=0;n<e.length;n++){var i=e[n];i&&"."!==i&&(".."===i?r.length&&".."!==r[r.length-1]?r.pop():t&&r.push(".."):r.push(i))}return r}function We(e){var t="/"===e.charAt(0),n="/"===e.slice(-1);return(e=Ye(Oe.filter(e.split("/"),(function(e){return!!e})),!t).join("/"))||t||(e="."),e&&n&&(e+="/"),(t?"/":"")+e}var Ve=function(){function e(){}return e.prototype.resolve=function(){var e,t,n="",r=arguments,i=!1;for(e=r.length-1;e>=0&&!i;e--)c(t=r[e])&&t&&(n=t+"/"+n,i="/"===t.charAt(0));return(i?"/":"")+Ye(Oe.filter(n.split("/"),(function(e){return!!e})),!i).join("/")||"."},e.prototype.join=function(){var e=B(arguments);return We(Oe.filter(e,(function(e){return e&&c(e)})).join("/"))},e.prototype.relative=function(e,t){e=We(e),t=We(t);var n,r,i=Oe.filter(e.split("/"),(function(e){return!!e})),o=[],s=Oe.filter(t.split("/"),(function(e){return!!e})),a=Math.min(i.length,s.length);for(n=0;n<a&&i[n]===s[n];n++);for(r=n;n<i.length;)o.push(".."),n++;return(o=o.concat(s.slice(r))).join("/")},e.prototype.basename=function(e,t){var n;return n=(e.match(Ge)||[])[3]||"",t&&n&&n.slice(-1*t.length)===t&&(n=n.slice(0,-1*t.length)),n},e.prototype.dirname=function(e){var t=e.match(Ge)||[],n=t[1]||"",r=t[2]||"";return n||r?(r&&(r=r.substring(0,r.length-1)),n+r):"."},e.prototype.extname=function(e){return(e.match(Ge)||[])[4]||""},e}();function qe(e){return decodeURIComponent(e.replace(/\+/g," "))}function Ze(e){return encodeURIComponent(String(e))}var Xe,_e=t.Lib;function $e(e){var t=typeof e;return null==e||"object"!==t&&"function"!==t}function et(e,t,i,o){t=t||"&",i=i||"=",n(o)&&(o=d);var s=[];return p(e,(function(e,n){var a=Ze(n);$e(e)?(s.push(a),r(e)&&s.push(i,Ze(e+v)),s.push(t)):f(e)&&e.length&&p(e,(function(e){$e(e)&&(s.push(a,o?Ze("[]"):v),r(e)&&s.push(i,Ze(e+v)),s.push(t))}))})),s.pop(),s.join(v)}function tt(e,t,n){if(!c(e)||!(e=x(e)))return{};t=t||"&",n=n||"=";for(var r,i,o,s={},a=qe,u=e.split(t),l=0,h=u.length;l<h;++l){if(-1===(r=_e.indexOf(n,u[l])))i=a(u[l]),o=undefined;else{i=a(u[l].substring(0,r)),o=u[l].substring(r+1);try{o=a(o)}catch(d){D("decodeURIComponent error : "+o),D(d)}S(i,"[]")&&(i=i.substring(0,i.length-2))}i in s?f(s[i])?s[i].push(o):s[i]=[s[i],o]:s[i]=o}return s}function nt(e){e._queryMap||(e._queryMap=tt(e._query))}p({"&amp;":"&","&gt;":">","&lt;":"<","&#x60;":"`","&#x2F;":"/","&quot;":'"',"&#x27;":"'"},(function(e,t){}));var rt,it,ot=function(){function e(e){this._query=e||""}return e.prototype.clone=function(){return new e(this.toString())},e.prototype.reset=function(e){var t=this;return t._query=e||"",t._queryMap=null,t},e.prototype.count=function(){var e=0;return nt(this),p(this._queryMap,(function(t){f(t)?e+=t.length:e++})),e},e.prototype.has=function(e){var t;return nt(this),t=this._queryMap,e?e in t:!function(e){var t;if(e)for(t in e)if(!n(t))return!1;return!0}(t)},e.prototype.get=function(e){var t;return nt(this),t=this._queryMap,e?t[e]:t},e.prototype.keys=function(){return nt(this),Object.keys(this._queryMap)},e.prototype.set=function(t,n){var r,i=this;return nt(i),r=i._queryMap,c(t)?i._queryMap[t]=n:(t instanceof e&&(t=t.get()),p(t,(function(e,t){r[t]=e}))),i},e.prototype.remove=function(e){var t=this;return nt(t),e?delete t._queryMap[e]:t._queryMap={},t},e.prototype.add=function(t,r){var i,o,s=this;return c(t)?(nt(s),o=n(o=(i=s._queryMap)[t])?r:[].concat(o).concat(r),i[t]=o):(t instanceof e&&(t=t.get()),p(t,(function(e,t){s.add(t,e)}))),s},e.prototype.toString=function(e){return nt(this),et(this._queryMap,Xe,Xe,e)},e}(),st=t.Lib,at=/[\-#$\^*()+\[\]{}|\\,.?\s]/g,ct={"&amp;":"&","&gt;":">","&lt;":"<","&#x60;":"`","&#x2F;":"/","&quot;":'"',"&#x27;":"'"},ut={};p(ct,(function(e,t){ut[e]=t}));var lt=function(){function e(e){var t=e.createElement("div"),n=e.createElement("div");n.style&&(this.div=n,this.container=t,this.docElem=e.documentElement,n.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",this.leadingWhitespace=3===n.firstChild.nodeType,this.tbody=!n.getElementsByTagName("tbody").length,this.htmlSerialize=!!n.getElementsByTagName("link").length,n.style.cssText="float:left;opacity:.5",this.opacity="0.5"===n.style.opacity,this.cssFloat=!!n.style.cssFloat,n.style.backgroundClip="content-box",n.cloneNode(!0).style.backgroundClip="",this.clearCloneStyle="content-box"===n.style.backgroundClip,(t=document.createElement("div")).style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",n.innerHTML="",t.appendChild(n),this.boxSizing=""===n.style.boxSizing||""===n.style.MozBoxSizing||""===n.style.WebkitBoxSizing)}return e.prototype.reliableHiddenOffsets=function(){return null==this.pixelPositionVal&&this.computeStyleTests(),this.reliableHiddenOffsetsVal},e.prototype.boxSizingReliable=function(){return null==this.pixelPositionVal&&this.computeStyleTests(),this.boxSizingReliableVal},e.prototype.pixelMarginRight=function(){return null==this.pixelPositionVal&&this.computeStyleTests(),this.pixelMarginRightVal},e.prototype.pixelPosition=function(){return null==this.pixelPositionVal&&this.computeStyleTests(),this.pixelPositionVal},e.prototype.reliableMarginRight=function(){return null==this.pixelPositionVal&&this.computeStyleTests(),this.reliableMarginRightVal},e.prototype.reliableMarginLeft=function(){return null==this.pixelPositionVal&&this.computeStyleTests(),this.reliableMarginLeftVal},e.prototype.computeStyleTests=function(){var e,t,n=this.div;this.docElem&&this.docElem.appendChild(this.container),n.style.cssText="-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",this.pixelPositionVal=this.boxSizingReliableVal=this.reliableMarginLeftVal=!1,this.pixelMarginRightVal=this.reliableMarginRightVal=!0,window.getComputedStyle&&(t=window.getComputedStyle(n),this.pixelPositionVal="1%"!==(t||{}).top,this.reliableMarginLeftVal="2px"===(t||{}).marginLeft,this.boxSizingReliableVal="4px"===(t||{width:"4px"}).width,n.style.marginRight="50%",this.pixelMarginRightVal="4px"===(t||{marginRight:"4px"}).marginRight,(e=n.appendChild(document.createElement("div"))).style.cssText=n.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",e.style.marginRight=e.style.width="0",n.style.width="1px",this.reliableMarginRightVal=!parseFloat((window.getComputedStyle(e)||{}).marginRight),n&&n.removeChild(e)),n.style.display="none",this.reliableHiddenOffsetsVal=0===n.getClientRects().length,this.reliableHiddenOffsetsVal&&(n.style.display="",n.innerHTML="<table><tr><td></td><td>t</td></tr></table>",n.childNodes[0].style.borderCollapse="separate",(e=n.getElementsByTagName("td"))[0].style.cssText="margin:0;border:0;padding:0;display:none",this.reliableHiddenOffsetsVal=0===e[0].offsetHeight,this.reliableHiddenOffsetsVal&&(e[0].style.display="",e[1].style.display="none",this.reliableHiddenOffsetsVal=0===e[0].offsetHeight)),this.docElem&&this.docElem.removeChild(this.container)},e}();function ht(e){return Math.random().toString(16).substring(2,2+e)}var ft=Date.now||function(){return+new Date};function dt(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(t){o(t)}}function a(e){try{c(r["throw"](e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}function At(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),"throw":a(1),"return":a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(a){o=[6,a],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}var pt=!1;"wakeLock"in navigator&&(pt=!0);var gt,yt,mt=null;function bt(){pt&&(null==mt?function(){dt(this,void 0,void 0,(function(){return At(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,navigator.wakeLock.request("screen")];case 1:return mt=e.sent(),[3,3];case 2:return e.sent(),mt=null,[3,3];case 3:return[2]}}))}))}():mt.release().then((function(){mt=null})))}function Ct(){return mt}var vt,wt=20221111,Pt=t.Lib,It=!1;Pt&&Pt.__ver&&Pt.isNumber(Pt.__ver)&&Pt.__ver>=wt&&(It=!0),It||((vt=globalThis)&&!vt.Map&&(vt.Map=function(){this.keys=[],this.data={},this.set=function(e,t){null==this.data[e]&&-1==this.keys.indexOf(e)&&this.keys.push(e),this.data[e]=t},this.get=function(e){return this.data[e]}}),j(t.Lib,{debug:!1,nil:undefined,mix:j,clone:H,keys:Object.keys,now:ft,getRandom:function(){for(var e,t=ft()%1e4,n=[],r=0;r<5;r++)e=Math.floor(10*Math.random()),0!=r||0!=e?n.push(e):r=-1;return t<10?n.push("000"):t<100?n.push("00"):t<1e3&&n.push("0"),n.push(t),n.join("")},guid:function(e){var t=[ht(8),"-",ht(4),"-",ht(4),"-",ht(4),"-",ht(8)];return e&&t.unshift(e),t.join("")},stringify:null===(gt=globalThis.JSON)||void 0===gt?void 0:gt.stringify,parse:null===(yt=globalThis.JSON)||void 0===yt?void 0:yt.parse,__ver:wt}),function(e){var t=e.Lib;t.mix(t,{isDef:r,isUndef:n,isUndefined:n,isNull:i,isNaN:isNaN,isFunction:a,isString:c,isObject:u,isBoolean:l,isNumber:h,isArray:f,type:s,isPlainObject:y,isDOM:b,isDOMInBody:C,each:p})}(t),j(t.Lib,{getFormatedNow:T,getLogger:function(){return k},setLogger:function(e){k=e},log:M,error:D,warn:F,info:R}),function(e){var t=e.Lib,n=Array.prototype;t.mix(t,{filter:function(e,t,r){return n.filter.call(e,t,r||this)},indexOf:function(e,t){return n.indexOf.call(t,e)},uniq:function(e){var t,n,r=[],i=e.length;for(t=0;t<i;t++){for(n=t+1;n<i;n++)e[t]===e[n]&&(n=++t);r.push(e[t])}return r}})}(t),function(e){var t=e.Lib;t.mix(t,{startsWith:E,endsWith:S,replaceAll:function(e,t,n){return e.replace(new RegExp(t,"gi"),n)},upperCaseFirst:function(e){return e.charAt(0).toUpperCase()+e.substr(1)},removeNonPrintableChar:function(e){return t.isString(e)?e.replace(/[^\x20-\x7E]/g,""):e},makeArray:B,trim:x})}(t),function(e){var t=e.Lib;t.extend=function(e,n){var r=function(){e.apply(this,arguments),n&&n.apply(this,arguments)};return t.each(e.prototype,(function(e,t){r.prototype[t]=e})),r.prototype.constructor=r,r}}(t),function(e){var t=e.Lib;function n(e){var n=this,r=n.constructor;for(n.__attrs={},n.__attrVals={},n.userConfig=e;r;)n.addAttrs(r.ATTRS),r=r.superclass?r.superclass.constructor:null;t.mix(n.__attrs,e)}t.mix(n.prototype,{get:function(e){return e in this.__attrs?this.__attrs[e]:""},set:function(e,t){e in this.__attrs&&(this.__attrs[e]=t)},addAttrs:function(e){t.mix(this.__attrs,e)}}),n.extend=function(e){var n,r;return(e=e||{}).constructor&&(n=e.constructor),r=t.extend(this,n),t.mix(r,e),r},t.Attributes=n}(t),j(st,{urlEncode:Ze,urlDecode:qe,fromUnicode:function(e){return e.replace(/\\u([a-f\d]{4})/gi,(function(e,t){return String.fromCharCode(parseInt(t,16))}))},escapeHtml:function(e){return(e+"").replace(function(){if(rt)return rt;var e=v;return p(ct,(function(t){e+=t+"|"})),e=e.slice(0,-1),rt=new RegExp(e,"g")}(),(function(e){return ut[e]}))},escapeRegExp:function(e){return e.replace(at,"\\$&")},unEscapeHtml:function(e){return e.replace(function(){if(it)return it;var e=v;return p(ut,(function(t){e+=t+"|"})),e+="&#(\\d{1,5});",it=new RegExp(e,"g")}(),(function(e,t){return ct[e]||String.fromCharCode(+t)}))},param:et,unparam:tt}),t.Lib.Path=new Ve,t.Lib.uriQuery=ot,t.Lib.Uri=Y,function(e){var t=e.Lib,n=t.win,r=20220622;if(!(t._promise_ver&&t.isNumber(t._promise_ver)&&t._promise_ver>=r)){if(t._promise_ver=r,n&&t.isFunction(n.__zone_symbol__Promise)&&(t.nativePromise=n.__zone_symbol__Promise),self&&self.Promise)return t.Promise=self.Promise,void(t.nativePromise||(t.nativePromise=t.Promise));if(n&&n.Promise)return t.Promise=n.Promise,void(t.nativePromise||(t.nativePromise=t.Promise));t.Promise=Ke,t.nativePromise||(t.nativePromise=t.Promise)}}(t),t.Lib.asyncGetNavInfo=Se,function(e){var t=e.Lib,n=e.navInfoSync,r=!1,i=!1;if(t.bNode||n.bJSDom||n.bEdge&&n.bFileSystem||n.bIE&&n.IEVersion<8);else try{i=window.localStorage,r=!!i}catch(o){i=!1}t.LS={isSupportLS:function(){return r},item:function(e,t,n){var r=null;return this.isSupportLS()?(t?(i.setItem(e,t),r=t):r=i.getItem(e),null===r?n:r):n},removeItem:function(e){return!!this.isSupportLS()&&(i.removeItem(e),!0)}}}(t),function(e){var t=e.Lib,n=t.win,r=t.doc,i=0,o=[],s=/\S/,a=!(!r||!r.addEventListener),c="DOMContentLoaded",u="readystatechange",l="load",h="complete",f=a?function(e,t,n){e.addEventListener(t,n,!1)}:function(e,t,n){e.attachEvent("on"+t,n)},d=a?function(e,t,n){e.removeEventListener(t,n,!1)}:function(e,t,n){e.detachEvent("on"+t,n)};function A(){for(var e=0;e<o.length;e++)try{o[e](t)}catch(n){t.log(n,"error"),setTimeout((function(){throw n}),0)}}function p(){if(!i){if(i=1,t.bNode||e.navInfoSync.bJSDom)return void A();Se().then((function(){r&&d(n,l,p),A()}))}}if(t.mix(t,{isWindow:function(e){return null!=e&&e==e.window},globalEval:function(e){e&&s.test(e)&&(n.execScript?n.execScript(e):function(e){n.eval.call(n,e)}(e))},domReady:function(e){if(i)try{e(t)}catch(n){t.log(n,"error"),setTimeout((function(){throw n}),0)}else o.push(e);return this}}),t.ready=t.domReady,t.bNode||e.navInfoSync.bJSDom)p();else if(function(){if(r&&r.readyState!==h)if(f(n,l,p),a){var e=function(){d(r,c,e),p()};f(r,c,e)}else{var t=function(){r.readyState===h&&(d(r,u,t),p())};f(r,u,t);var i=void 0,o=r&&r.documentElement,s=o&&o.doScroll;try{i=null===n.frameElement}catch(g){i=!1}if(s&&i){var A=function(){try{s("left"),setTimeout(p,30)}catch(e){setTimeout(A,40)}};A()}}else p()}(),e.navInfoSync.bIE)try{r.execCommand("BackgroundImageCache",!1,!0)}catch(g){}}(t),function(e){var t=e.Lib,n="none";t.mix(t,{get:function(e){return t.doc.getElementById(e)},hide:function(e){var r=t.isString(e)?t.get(e):e;r&&(r.length>0&&(r=r[0]),r.style.display=n)},show:function(e){var n=t.isString(e)?t.get(e):e;n&&(n.length>0&&(n=n[0]),n.style.display=v)},toggle:function(e){var r=t.isString(e)?t.get(e):e;r&&(r.length>0&&(r=r[0]),r.style.display===n?r.style.display=v:r.style.display=n)},empty:function(e){if(e)for(;e.firstChild;)e.removeChild(e.firstChild)}})}(t),function(e){var t=e.Lib;t.colorStrToInt=function(e){var t,n,r="0x";if(/^(rgb|RGB)/.test(e)){var i=e.replace(/[^\d,.]/g,"").split(",");for(n=0;n<3;++n)1==(t=Number(i[n]).toString(16)).length&&(t="0"+t),r+=t;4==i.length?(1==(t=Math.round(255*Number(i[n])).toString(16)).length&&(t="0"+t),r+=t):r+="ff"}else if("transparent"==e)r+="00000000";else if(/^#[0-9a-fA-f]{6}$/.test(e))r+=e.replace(/#/,"")+"ff";else if(/^#[0-9a-fA-f]{3}$/.test(e)){for(n=0;n<3;++n)r+=e[n]+e[n];r+="ff"}else r="-1";return Number(r)},t.IntToColorStr=function(t){if(t>4294967295||t<0)return null;var n;if(e.navInfoSync.bHTML5Edition)n="rgba("+Math.floor(t/16777216)+","+Math.floor(t/65536)%256+","+Math.floor(t/256)%256+","+t%256/255+")";else if(t%256==0)n="transparent";else{for(n=Math.floor(t/256).toString(16);6!=n.length;)n="0"+n;n="#"+n}return n}}(t),function(e){var n=t.Lib,r=n.doc,i=r&&r.documentElement,o=r.getElementsByTagName("head")[0]||i,s=r.createElement("script").readyState?function(e,t){var n=e.onreadystatechange;e.onreadystatechange=function(){var r=e.readyState;"loaded"===r||"complete"===r?(e.onreadystatechange=null,n&&n(),t.call(this,!0)):"loading"===r||t.call(this,!1)}}:function(e,t){e.addEventListener("load",t,A),e.addEventListener("error",t,A)};n.scriptOnload=s,n.getScript=function(e,t,r){return n.addScript(e,t,!1,r)},n.addScript=function(e,i,a,c){var u,l,h=c;if(n.isFunction(h)||(h=function(){}),n.bNode||t.navInfoSync.bJSDom)h();else{if(n.isString(e)&&e!=v)return u=r.createElement("script"),l=["",e].join(v),u.src=l,i&&(u.async=!0),u.charset="utf-8",s(u,h),a?o.appendChild(u):o.insertBefore(u,o.firstChild),u;h()}},n.getScripts=function(e,t,r){return n.addScripts(e,t,!1,r)},n.addScripts=function(e,r,i,o){var s=o;if(n.isFunction(s)||(s=function(){}),n.bNode||t.navInfoSync.bJSDom)s("ok");else if(n.isArray(e)){var a=e.length,c=function(e){e?a--:s(),a<=0&&s("ok")};a<=0?s("ok"):n.each(e,(function(e){n.addScript(e,r,i,c)}))}else s()},n.getCss=function(e,t){return n.addCss(e,!1,t)},n.addCss=function(e,i,a){var c,u=a;if(n.isFunction(u)||(u=!1),n.isString(e)&&e!=v){if(!n.bNode&&!t.navInfoSync.bJSDom)return(c=r.createElement("link")).href=e,c.rel="stylesheet",c.async=!0,u&&s(c,u),i?o.appendChild(c):o.insertBefore(c,o.firstChild),c;u&&u()}else u&&u()},n.getAllCss=function(e,t){return n.addAllCss(e,!1,t)},n.addAllCss=function(e,r,i){if(n.bNode||t.navInfoSync.bJSDom)i&&i("ok");else if(n.isArray(e)){var o=e.length,s=function(e){e?o--:i(),o<=0&&i("ok")};n.each(e,(function(e){n.addCss(e,r,s)}))}else i&&i()},n.addJS=Ae,n.addVBS=pe}(),j(t.Lib,{ajax:he,io:new fe,fetch:me}),function(e){var t=e.Lib,n={fire:function(e){var n,r=this;r.exec=r.exec||{},e=e.toLowerCase(),n=Array.prototype.slice.call(arguments,1),t.each(r.exec[e]||[],(function(e){var i=e.f,o=e.c||r;try{i.apply(o,n)}catch(s){t.log(s)}}))},on:function(e,t,n){var r=this;r.exec=r.exec||{},e=e.toLowerCase(),r.exec[e]=r.exec[e]||[],r.exec[e].push({f:t,c:n})},off:function(e,t,n){var r=this.exec;if(r)if(e)if(e=e.toLowerCase(),t)for(var i=r[e]||[],o=i.length-1;o>=0;o--)i[o]===t&&i.splice(o,1);else r[e]=null;else this.exec=null}};t.obj={customEvent:n}}(t),function(e){var t,n=e.Lib;t=function(t){return e.navInfoSync.bGecko&&"mousewheel"===t?"DOMMouseScroll":t},n.mix(n,{addEventListener:function(e,n,r){var i=t(n);e&&e.addEventListener(i,r,!1)},removeEventListener:function(e,n,r){var i=t(n);e&&e.removeEventListener(i,r,!1)},stopPropagation:function(e){var t=e||n.win.event;t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.returnValue=!1,t.cancelBubble=!0},fireEvent:function(e,t){var r=n.win.document.createEvent("HTMLEvents");r.initEvent(e,d,d),t.dispatchEvent&&t.dispatchEvent(r)}})}(t),function(e){var t=e.Lib,n={encodeChars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",decodeChars:[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1]};t.base64={UTF16ToUTF8:function(e){for(var t,n,r=[],i=e.length,o=0;o<i;o++){var s=e.charCodeAt(o);if(s>0&&s<=127)r.push(e.charAt(o));else if(s>=128&&s<=2047)t=192|s>>6&31,n=128|63&s,r.push(String.fromCharCode(t),String.fromCharCode(n));else if(s>=2048&&s<=65535){t=224|s>>12&15,n=128|s>>6&63;var a=128|63&s;r.push(String.fromCharCode(t),String.fromCharCode(n),String.fromCharCode(a))}}return r.join("")},UTF8ToUTF16:function(e){var t,n,r,i,o=[],s=e.length;for(t=0;t<s;t++)0==((n=e.charCodeAt(t))>>7&255)?o.push(e.charAt(t)):6==(n>>5&255)?(i=(31&n)<<6|63&(r=e.charCodeAt(++t)),o.push(String.fromCharCode(i))):14==(n>>4&255)&&(i=(255&(n<<4|(r=e.charCodeAt(++t))>>2&15))<<8|(3&r)<<6|63&e.charCodeAt(++t),o.push(String.fromCharCode(i)));return o.join("")},encode:function(e){for(var t,r,i,o=this.UTF16ToUTF8(e),s=[],a=0,c=o.length;a<c;){if(t=255&o.charCodeAt(a++),a==c){s.push(n.encodeChars.charAt(t>>2)),s.push(n.encodeChars.charAt((3&t)<<4)),s.push("==");break}if(r=o.charCodeAt(a++),a==c){s.push(n.encodeChars.charAt(t>>2)),s.push(n.encodeChars.charAt((3&t)<<4|(240&r)>>4)),s.push(n.encodeChars.charAt((15&r)<<2)),s.push("=");break}i=o.charCodeAt(a++),s.push(n.encodeChars.charAt(t>>2)),s.push(n.encodeChars.charAt((3&t)<<4|(240&r)>>4)),s.push(n.encodeChars.charAt((15&r)<<2|(192&i)>>6)),s.push(n.encodeChars.charAt(63&i))}return s.join("")},encodeArray:function(e){for(var t,r,i,o=[],s=0,a=e.length;s<a;){if(t=255&e[s++],s==a){o.push(n.encodeChars.charAt(t>>2)),o.push(n.encodeChars.charAt((3&t)<<4)),o.push("==");break}if(r=255&e[s++],s==a){o.push(n.encodeChars.charAt(t>>2)),o.push(n.encodeChars.charAt((3&t)<<4|(240&r)>>4)),o.push(n.encodeChars.charAt((15&r)<<2)),o.push("=");break}i=255&e[s++],o.push(n.encodeChars.charAt(t>>2)),o.push(n.encodeChars.charAt((3&t)<<4|(240&r)>>4)),o.push(n.encodeChars.charAt((15&r)<<2|(192&i)>>6)),o.push(n.encodeChars.charAt(63&i))}return o.join("")},decode:function(e,t){for(var r,i,o,s,a=this,c=[],u=0,l=e.length;u<l;){do{r=n.decodeChars[255&e.charCodeAt(u++)]}while(u<l&&-1==r);if(-1==r)break;do{i=n.decodeChars[255&e.charCodeAt(u++)]}while(u<l&&-1==i);if(-1==i)break;t?c.push(r<<2|(48&i)>>4):c.push(String.fromCharCode(r<<2|(48&i)>>4));do{if(61==(o=255&e.charCodeAt(u++)))return t?c:a.UTF8ToUTF16(c.join(""));o=n.decodeChars[o]}while(u<l&&-1==o);if(-1==o)break;t?c.push((15&i)<<4|(60&o)>>2):c.push(String.fromCharCode((15&i)<<4|(60&o)>>2));do{if(61==(s=255&e.charCodeAt(u++)))return t?c:a.UTF8ToUTF16(c.join(""));s=n.decodeChars[s]}while(u<l&&-1==s);if(-1==s)break;t?c.push((3&o)<<6|s):c.push(String.fromCharCode((3&o)<<6|s))}return t?c:a.UTF8ToUTF16(c.join(""))}},t.utf8={fromUTF16:function(e){for(var t,n=[],r=0,i=e.length;r<i;)(t=e.charCodeAt(r))>=1&&t<=127?n.push(e.charAt(r)):t>2047?(n.push(String.fromCharCode(224|t>>12&15)),n.push(String.fromCharCode(128|t>>6&63)),n.push(String.fromCharCode(128|t>>0&63))):(n.push(String.fromCharCode(192|t>>6&31)),n.push(String.fromCharCode(128|t>>0&63))),r++;return n.join("")},toUTF16:function(e){for(var t,n,r,i=[],o=0,s=e.length;o<s;)switch((t=e.charCodeAt(o++))>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:i.push(e.charAt(o-1));break;case 12:case 13:n=e.charCodeAt(o++),i.push(String.fromCharCode((31&t)<<6|63&n));break;case 14:n=e.charCodeAt(o++),r=e.charCodeAt(o++),i.push(String.fromCharCode((15&t)<<12|(63&n)<<6|(63&r)<<0))}return i.join("")}};var r="undefined"!=typeof self?self:global;function i(e){this.message=e}i.prototype=new Error,i.prototype.name="InvalidCharacterError",t.btoa=r.btoa?function(e){return r.btoa(e)}:function(e){var t,r,o=String(e),s=0,a=n.encodeChars,c="";for(s=0,a=n.encodeChars,c="";o.charAt(0|s)||(a="=",s%1);c+=a.charAt(63&t>>8-s%1*8)){if((r=o.charCodeAt(s+=3/4))>255)throw new i("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");t=t<<8|r}return c},t.atob=r.atob?function(e){return r.atob(e)}:function(e){var t,r,o=String(e).replace(/[=]+$/,""),s=0,a=0,c="";if(o.length%4==1)throw new i("'atob' failed: The string to be decoded is not correctly encoded.");for(s=0,a=0,c="";r=o.charAt(a++);~r&&(t=s%4?64*t+r:r,s++%4)?c+=String.fromCharCode(255&t>>(-2*s&6)):0)r=n.encodeChars.indexOf(r);return c}}(t),function(e){var t=e.Lib,n={queue:[],doNextStarted:!1,timer:null,pushToDo:function(e,t,r){n.queue.push({obj:e,method:t,args:r})},doNext:function(){if(n.doNextStarted)if(0!=n.queue.length){var e=n.queue[0],r=e.obj,i=e.method,o=e.args;if(n.queue.splice(0,1),r&&t.isFunction(r[i])){var s=!1;if(o.length>2){var a=o[o.length-2],c=o[o.length-1];t.isFunction(a)&&t.isFunction(c)&&(o[o.length-2]=function(){try{a.apply(r,arguments)}catch(e){}n.timer=setTimeout(n.doNext,0)},o[o.length-1]=function(){try{c.apply(r,arguments)}catch(e){}n.timer=setTimeout(n.doNext,0)},s=!0)}try{r[i].apply(r,o)}catch(u){}s||(n.timer=setTimeout(n.doNext,0))}else if(null===r&&t.isFunction(i)){try{i.apply(null,o)}catch(l){}n.timer=setTimeout(n.doNext,0)}else t.log("not invoke a function: "+i),n.timer=setTimeout(n.doNext,0)}else n.stop();else n.stop()},start:function(){n.doNextStarted||(n.doNextStarted=!0,n.timer=setTimeout(n.doNext,0))},stop:function(){clearTimeout(n.timer),n.timer=null,n.doNextStarted=!1,n.queue=[]}};t.asyncQueue=n}(t),function(e){var t,n=e.Lib,r={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function i(e,t){if(n.isFunction("_".repeat))return e.repeat(t);for(var r=0,i=[];r<t;r++)i.push(e);return i.join("")}function o(e,n){var o,s,a,c,u,l,h,f,d,A=1,p=e.length,g="";for(s=0;s<p;s++)if("string"==typeof e[s])g+=e[s];else if("object"==typeof e[s]){if((c=e[s]).keys)for(o=n[A],a=0;a<c.keys.length;a++){if(o==undefined)throw new Error(t('[sprintf] Cannot access property "%s" of undefined value "%s"',c.keys[a],c.keys[a-1]));o=o[c.keys[a]]}else o=c.param_no?n[c.param_no]:n[A++];if(r.not_type.test(c.type)&&r.not_primitive.test(c.type)&&o instanceof Function&&(o=o()),r.numeric_arg.test(c.type)&&"number"!=typeof o&&isNaN(o))throw new TypeError(t("[sprintf] expecting number but found %T",o));switch(r.number.test(c.type)&&(f=o>=0),c.type){case"b":o=parseInt(o,10).toString(2);break;case"c":o=String.fromCharCode(parseInt(o,10));break;case"d":case"i":o=parseInt(o,10);break;case"j":o=JSON.stringify(o,null,c.width?parseInt(c.width):0);break;case"e":o=c.precision?parseFloat(o).toExponential(c.precision):parseFloat(o).toExponential();break;case"f":o=c.precision?parseFloat(o).toFixed(c.precision):parseFloat(o);break;case"g":o=c.precision?String(Number(o.toPrecision(c.precision))):parseFloat(o);break;case"o":o=(parseInt(o,10)>>>0).toString(8);break;case"s":o=String(o),o=c.precision?o.substring(0,c.precision):o;break;case"t":o=String(!!o),o=c.precision?o.substring(0,c.precision):o;break;case"T":o=Object.prototype.toString.call(o).slice(8,-1).toLowerCase(),o=c.precision?o.substring(0,c.precision):o;break;case"u":o=parseInt(o,10)>>>0;break;case"v":o=o.valueOf(),o=c.precision?o.substring(0,c.precision):o;break;case"x":o=(parseInt(o,10)>>>0).toString(16);break;case"X":o=(parseInt(o,10)>>>0).toString(16).toUpperCase()}r.json.test(c.type)?g+=o:(!r.number.test(c.type)||f&&!c.sign?d="":(d=f?"+":"-",o=o.toString().replace(r.sign,"")),l=c.pad_char?"0"===c.pad_char?"0":c.pad_char.charAt(1):" ",h=c.width-(d+o).length,u=c.width&&h>0?i(l,h):"",g+=c.align?d+o+u:"0"===l?d+u+o:u+d+o)}return g}var s=Object.create?Object.create(null):{};function a(e){if(s[e])return s[e];for(var t,n=e,i=[],o=0;n;){if(null!==(t=r.text.exec(n)))i.push(t[0]);else if(null!==(t=r.modulo.exec(n)))i.push("%");else{if(null===(t=r.placeholder.exec(n)))throw new SyntaxError("[sprintf] unexpected placeholder");if(t[2]){o|=1;var a=[],c=t[2],u=[];if(null===(u=r.key.exec(c)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(a.push(u[1]);""!==(c=c.substring(u[0].length));)if(null!==(u=r.key_access.exec(c)))a.push(u[1]);else{if(null===(u=r.index_access.exec(c)))throw new SyntaxError("[sprintf] failed to parse named argument key");a.push(u[1])}t[2]=a}else o|=2;if(3===o)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");i.push({placeholder:t[0],param_no:t[1],keys:t[2],sign:t[3],pad_char:t[4],align:t[5],width:t[6],precision:t[7],type:t[8]})}n=n.substring(t[0].length)}return s[e]=i,i}t=function(e){return o(a(e),arguments)},n.sprintf=t,n.vsprintf=function(e,n){return t.apply(null,[e].concat(n||[]))}}(t),function(e){var t=e.Lib,n=t.doc;t.Events={registedClass:[],registedObjs:[]};var r=function(e){var n=e||window.event,r=!0;return t.each(t.Events.registedObjs,(function(e){t.each(t.Events.registedClass,(function(t){if(e instanceof t&&e.bFocus&&e.handlerKeyDown&&!(r=e.handlerKeyDown(n)))return!1}))})),r};t.ready((function(){t.addEventListener(n.documentElement,"keydown",r)})),t.mix(t,{getWheelDelta:function(e){var t,n=(e=e||window.event).wheelDelta,r=e.detail;return n&&(t=n/120),r&&(t=-(r%3==0?r/3:r)),t}});var i={LEFT:0,MIDDLE:1,RIGHT:2};t.EnumMouseButton=i,t.detectButton=function(e){var t=e||window.event;return null==t.which?t.button<2?i.LEFT:4==t.button?i.MIDDLE:i.RIGHT:t.which<2?i.LEFT:2==t.which?i.MIDDLE:i.RIGHT}}(t),function(e){e.Lib.switchEvent=function(e){return null==(e=e||window.event).which?e.which=e.button<2?1:4==e.button?2:3:e.which=e.which<2?1:2==e.which?2:3,e}}(t),function(e){var t=e.Lib;t.currentStyle=function(e,n){var r=t.win,i=r.doc;return e.currentStyle?e.currentStyle[n]:r.getComputedStyle?(n.replace(/([A-Z])/g,"-$1"),n.toLowerCase(),i.defaultView.getComputedStyle(e,null)[n]):null}}(t),function(e){var t=Array.prototype,r=e.Lib,i=e.navInfoSync,o=r.isString,s=r.each,a=t.slice,c=" ",u=i.bIE&&i.IEMode<10,l=/[\n\t\r\.]/g,h=function(){function e(t,n,i){this.isNodeList=!0,this.length=0;var o=this;return o instanceof e?t?"string"==typeof t?(r.error("Err 4001."),o):r.isArray(t)||t.isNodeList?(Array.prototype.push.apply(o,B(t)),o):(o[0]=t,o.length=1,o):o:new e(t)}return e.prototype.item=function(t){return r.isNumber(t)?t>=this.length?null:new e(this[t]):new e(t)},e.prototype.slice=function(){return new e(a.apply(this,arguments))},e.prototype.getDOMNodes=function(){return a.call(this)},e.prototype.each=function(t,n){var r=this;return s(r,(function(i,o){return i=new e(i),t.call(n||i,i,o,r)})),r},e.prototype.getEL=function(){return this.length>0?this[0]:void 0},e.prototype.all=function(t){return this.length>0?r.all(t,this):new e},e.prototype.one=function(e){var t=this.all(e);return t.length?t.slice(0,1):t},e}();function f(e){return o(e)&&(e=r.trim(e))&&e.length>=3&&r.startsWith(e,"<")&&r.endsWith(e,">")}function p(e){return(c+e+c).replace(l,c)}function g(e){return e.replace(l,"")}function y(e,t){var n=t;return n&&n.isNodeList&&(n=n.getEL()),o(e)?(f(e)&&r.err("Err 4002."),new h(r.sizzle(e,n))):e.isNodeList?e:new h(e)}r.mix(h.prototype,{before:function(e){var t=this.getEL(),n=[e];t&&(f(e)&&(n=r.parseHTML(e)),s(n,(function(e){t.insertBefore(e,t.childNodes[0])})))},append:function(e){var t=this.getEL(),n=[e];t&&(f(e)&&(n=r.parseHTML(e)),s(n,(function(e){t.appendChild(e)})))},html:function(e){var t,i=this.getEL();if(i){if(n(e))return t=i.innerHTML,document.all?(t=t.replace(/(\s+\w+)\s*=\s*([^<>"\s]+)(?=[^<>]*\/>)/gi,'$1="$2"').replace(/"'([^'"]*)'"/gi,'"$1"')).replace(/<(\/?)(\w+)([^>]*)>/g,(function(e,t,n,r){return t?"</"+n.toLowerCase()+">":("<"+n.toLowerCase()+r+">").replace(/=(("[^"]*?")|('[^']*?')|([\w\-\.]+))([\s>])/g,(function(e,t,n,r,i,o,s,a){return i?'="'+i+'"'+o:e}))})).replace(/<\/?([^>]+)>/g,(function(e){return e})):t;i.innerHTML="",s(r.parseHTML(e),(function(e){i.appendChild(e)}))}},attr:function(e,t){var r=this.getEL();if(r){if(n(t))return"readonly"===e?r.readOnly?"readonly":"":("style"!==e&&u?r=r[e]:(r=r.attributes[e])&&(r=r.value),r);"class"==e?r.className=t:r[e]=t}},style:function(e,t){var n=this.getEL();if(n)return r.style(n,e,t)},css:function(e){s(this,(function(t){s(e,(function(e,n){r.style(t,n,e)}))}))},addClass:function(e){var t=this.getEL();t&&function(e,t){var n,i,o,s,a=e.className,u=t.length;if(a){for(n=p(a),i=a,o=0;o<u;o++)s=g(t[o]),n.indexOf(c+s+c)<0&&(i+=c+s);i=r.trim(i)}else i=t.join(" ");e.className=i}(t,e.split(c))},removeClass:function(e){var t=this.getEL();t&&function(e,t){var n,i,o,s=e.className,a=t.length;if(s&&a){for(n=p(s),i=0;i<a;i++)for(o=c+g(t[i])+c;n.indexOf(o)>=0;)n=n.replace(o,c);e.className=r.trim(n)}}(t,e.split(c))},hasClass:function(e){var t=this.getEL();if(t)return function(e,t){var n,r,i,o=e.className,s=t.length;if(o&&s){for(n=p(o),r=0;r<s;r++)if(i=c+g(t[r])+c,n.indexOf(i)<0)return A;return d}return A}(t,e.split(c))},parent:function(){var e=this.getEL();return e&&(e=e.parentNode),new h(e)},remove:function(){var e=this.getEL();e&&e.parentNode&&e.parentNode.removeChild(e)},offset:function(){var e=this.getEL();return r.DOM.getElDimensions(e,d)}}),r.mix(r,{all:y,one:function(e,t){var n=y(e,t);return n.length?n.slice(0,1):n},isNodeList:function(e){return e instanceof h}}),r.ready((function(){r.all=y}))}(t),function(e){var t=e.Lib,n=t.win,r=isNaN;t.DOM={getOffset:function(e,i,o){var s,a;e=e||n.event;for(var c,u,l=o||e.target,h=0,f=0,d=0,A=0,p=!1,g=t.doc;l&&!r(l.offsetLeft)&&!r(l.offsetTop);)u=l.scrollLeft,c=l.scrollTop,"BODY"===l.tagName?p?(u=0,c=0):(u|=null===(s=g.documentElement)||void 0===s?void 0:s.scrollLeft,c|=null===(a=g.documentElement)||void 0===a?void 0:a.scrollTop):"fixed"===l.style.position&&(p=!0),h+=l.offsetLeft-u,f+=l.offsetTop-c,l=l.offsetParent;return i&&(d=i.Left,A=i.Top),{x:h=e.clientX-h-d,y:f=e.clientY-f-A}},getElDimensions:function(e,t){var n,r;return e?(n=e.style.display,e.style.display="",r=t?{offsetTop:e.offsetTop,offsetLeft:e.offsetLeft,offsetWidth:e.offsetWidth,offsetHeight:e.offsetHeight}:{clientTop:e.clientTop,clientLeft:e.clientLeft,clientWidth:e.clientWidth?e.clientWidth:parseInt(e.style.width)?parseInt(e.style.width):0,clientHeight:e.clientHeight?e.clientHeight:parseInt(e.style.height)?parseInt(e.style.height):0},e.style.display=n,r):{offsetTop:0,offsetLeft:0,offsetWidth:0,offsetHeight:0}}},t.getElDimensions=t.DOM.getElDimensions}(t),function(e){var t,n=e.Lib;n.loaderBarClassName="ds-dwt-loaderBar",n.loaderBarSource="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjAiIHdpZHRoPSIxMDBweCIgaGVpZ2h0PSIxMDBweCIgdmlld0JveD0iMCAwIDEyOCAxMjgiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxnPjxjaXJjbGUgY3g9IjE2IiBjeT0iNjQiIHI9IjE2IiBmaWxsPSIjZmU4ZTE0Ii8+PGNpcmNsZSBjeD0iMTYiIGN5PSI2NCIgcj0iMTQuMzQ0IiBmaWxsPSIjZmU4ZTE0IiB0cmFuc2Zvcm09InJvdGF0ZSg0NSA2NCA2NCkiLz48Y2lyY2xlIGN4PSIxNiIgY3k9IjY0IiByPSIxMi41MzEiIGZpbGw9IiNmZThlMTQiIHRyYW5zZm9ybT0icm90YXRlKDkwIDY0IDY0KSIvPjxjaXJjbGUgY3g9IjE2IiBjeT0iNjQiIHI9IjEwLjc1IiBmaWxsPSIjZmU4ZTE0IiB0cmFuc2Zvcm09InJvdGF0ZSgxMzUgNjQgNjQpIi8+PGNpcmNsZSBjeD0iMTYiIGN5PSI2NCIgcj0iMTAuMDYzIiBmaWxsPSIjZmU4ZTE0IiB0cmFuc2Zvcm09InJvdGF0ZSgxODAgNjQgNjQpIi8+PGNpcmNsZSBjeD0iMTYiIGN5PSI2NCIgcj0iOC4wNjMiIGZpbGw9IiNmZThlMTQiIHRyYW5zZm9ybT0icm90YXRlKDIyNSA2NCA2NCkiLz48Y2lyY2xlIGN4PSIxNiIgY3k9IjY0IiByPSI2LjQzOCIgZmlsbD0iI2ZlOGUxNCIgdHJhbnNmb3JtPSJyb3RhdGUoMjcwIDY0IDY0KSIvPjxjaXJjbGUgY3g9IjE2IiBjeT0iNjQiIHI9IjUuMzc1IiBmaWxsPSIjZmU4ZTE0IiB0cmFuc2Zvcm09InJvdGF0ZSgzMTUgNjQgNjQpIi8+PGFuaW1hdGVUcmFuc2Zvcm0gYXR0cmlidXRlTmFtZT0idHJhbnNmb3JtIiB0eXBlPSJyb3RhdGUiIHZhbHVlcz0iNDUgNjQgNjQ7OTAgNjQgNjQ7MTM1IDY0IDY0OzE4MCA2NCA2NDsyMjUgNjQgNjQ7MjcwIDY0IDY0OzMxNSA2NCA2NDswIDY0IDY0IiBjYWxjTW9kZT0iZGlzY3JldGUiIGR1cj0iNzIwbXMiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIj48L2FuaW1hdGVUcmFuc2Zvcm0+PC9nPjwvc3ZnPg==",n.loaderBarSourceIE="data:image/gif;base64,R0lGODlhZABkAKUAAPyOFPzKjPyuVPzmxPy+dPyeNPzarPz27PzSnPy2ZPymRPzGhPyWJPzu3PzixPzOnPyyZPzChPyiRPzevPz+/PzWrPy6dPyqVPzOlPyyXPzq1PzCfPyiPPzetPz69PzWpPy6bPyqTPyaLPySHPzKlPyuXPzmzPy+fPyePPzatPz29PzSpPy2bPymTPzGjPyWLPzy5P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQJCQAxACwAAAAAZABkAAAG/sCYcEgsGo/IpHLJbDqf0Kh0Sq1ar9hslXI4aEwHFUVLLicpjUBrBACMFKTG2Ewne1Khtl4fSnnqgFYUFSJ7hgAiFXOBjE8mDIeHIyaNlUweGZGRGX+WnkYTL5qHIhOfp0MubKN7Iy6oUhQwDSYmDTBPHiyshyydsEwUJgslCiIFCgkPcpcJvIYJv8BJBy4okW8r0kceIM97LIvTRw0Cq5ojBNtGqt9uC08qGisnBA9g4loHAt8jESpKJhT6VqqJMALn3AiYsE7QAneIFCVRkelbiYZFKDhooanAinxWHFyDKABXEhMJ0VFiAkMBqwITQE6hEAGinhRKBg3UlEim/pENzwQcyAKDn00AJ3wKucMxUogKGIsc2DlqhIMsGjgcBRBC6dI0Cla9IaHBKxEHKTWRyGKCqjsUZpeqOFArTFwiK9JGIsDW7TcOd7FU0HuIL5asWwVELfPo2wOiELYuCHzFQ4FnIzRkoYCBsCYGVz3lZZVuMRQNLiGyGOrpQORRClZuHv2tgAPKWNBA0KvgdhkPJzzrYfDBNB0uKwowYDCCQYETMHA78RDB7x6P42J4MFFhhQPWgA4YKJGWAQgHxrObkdXhhAAOHDK4wKd+GgUKHu5Lr8+/v///AAYo4IAEAgODBhNoYFKBdVCgAQkKMDdCcwq40EB6DDoBAwbW/rUhwgMLZlhFA7vxMkICmolIxQEhCLeHUCpK4YEzNvkiIhomOGACDKYNdhQDFWR4wAMCiMKAAA+AZ8QBFR2VgZIBwsACJHswwEKIRAi0FSKmDEjBLtiEYwQFJGzZBgb7eWICabIN4QEBZiKFISxAsRLBkmBumQCU/pXASwZL0rjlagMaNQqgRbwZpzoDnsDLnRmVaSYJaVoygGeTHKHlVgV5mWcvMjG5JQR8/icllcOBgCURKaDqDgM4MXgAAgJAciQCpbopqDs2ZugBDDnaYhwMF7jYxggwxihFAxm4OAIEKSq77AMdIoJBA9JW4UEDLkQ4IYUWzpmtEgcmuOq4/uimq+66/qHhwAQfVDABGOxGodECFyjnBgMoZBAAM/UuAcMJl6HDAQniZiuMVt9AAHDAQ1AwAcPuCIAtxENo0JRNECTs664QjUApxg7EycHFp/x64XpNbjVCAJVS4cAGJQhggR9kaFCtRecCsqmHk2mxgqtbFdAmIw5Y94EWNcUJAKyWeFDnISF4fIQFTrcRZCUw+BmJCNFagXXWWzdSFE9HUzG1mQwYYIkKYx+iQK5RPGAsKyKEVkkK1r2SRdJOh4ByIx48ZEgJdEfhwcYuJ/UJBSu0UIAIEriQuBQVxFnAALBsR68ZBzBuEwExC0hBBzt31LMRKqRAAAEpAESgYgfU2sSB3kscsOueBXqQnDshxOTECocsXeDpokeCImWv7QFBhlxUEIIIEx7LgAgQoBeF13sgeqMJD7gAAgEurPAwFHYb8hjGT4iqB6nsPyELkSWAWHr8+Oev//789+8/u0EAACH5BAkJADEALAAAAABkAGQAAAb+wJhwSCwaj8ikcslsOp/QqHRKrVqv2Kx2y+0uPY1JJ+XQeLxob2OhYAAAjNaika5fKYPL6M0HjC4DFHaDUSYofYgAKCaEjUweAomJAmeOlkYOe5J9Iw6Xn0MEm4kEoJ8UCqOICoKmUB4aJiYNrU4UHKp9HLWuSwcBAhwoBQolFZVMFC25fC28vUceFQWSIyEOz0gWzG8W0EoeLm6jIilNmdyeUBQNsg3IXhXjqhyMX5G5lK8uF8IKJ3S8HKDGjQU8JA5wjeKgzkmDEprejECBrYsLbm/KJXOgJ9Gfik5g4EtUwJ4WSBjfLDiIpEGENm8YKIgQ0NaKiKRYVtGgEGP+Ahi2NExIkWKChmy+QKgKUROLA4IYBTQddCCEqpJbBhxKKQCoowMXVC3aokFCSgAsDljycELVhalWUKZ0gTQNBQPzEI2IUJdKBZxiB3xSsQHwm65dPFhlNmKDzkEwXIjowwAC3CxPmbXwCspDCgICLrBYoRYNhRRQPba4bImChwMHPPTVYoLFZEQcInD+tjbFAgglSrAgYeIxb0KvYcA4MPu48+fQo0ufTr269evYs1t3DaOBdxiytXOB8VnBixEiJJwwsFt8lQEl8vJhUEKweyoUKvTcxMFA8/tG5HdbLiJU8B+AQzSwXy4csDYdBTBoAMOBF521gHYutcBBCBv+OCgEDANiVEB70lHgQAs4tRBIEvKcBUcF1x1QgiQllHbEAi6+EcF16HjUkBHb5OiNdRiMgkESSgl5HQmjkJAEji7uxaNhfvxYRItnMQCjdQeM1IcANhoBoosjXodHKn2oOBuUKV2YXQMnhCBBCAAxoWBKDYoHoYQHCshNgQciKER+CybCgYGCRuFAfJLQZ2WiIVVAgAQijPCCBARUQCKktnjQ3XfhcSrqqKSWauqpqBbhqSwTppqMCScoUIAIBRTQAgm0uGqEBw5AQCUcAAWaKAUPpLaJAiClSsEKL2AkwaOknmZsLkyl2oCXGFkgrHb5/aoKAx7aQcG2T3gwY47+ALgAigoYXCBHuFIc4G0urDThGmyhTqHCYm+gYJ8WDqD7RgHhHjABBhFYAEIEGEwQ5hMBJFICuUoYIDAAIpi06wolTFtACSsYF80yej1sRQUXZ3wEOyHIhwgDTAXqAZqImFzFBBcTvOsEhW6CwgSBioIbxUnAcLEEB5loFp7JKqHBVhkhelLP3IAgJrbcXGDzEb3uEUIKIktBAQnzbjLCv0NEIPCOnXqQ7xYN0JwSBM+Mia4Im4JCrMtXPfpA2aOM8IBzB5wAeEYrPENBAhcDkADRaHhAAN+IFBCymCQLvNlzKjygwK8jCJACUnderAC8l7CDweecQKBpXWU1zoFdBiWCYUIFKZgQ22xxN346qR6EdbEAKpQqtMCllDrB4dVMYCoF/LoYAuTVpUD5t+acKnmOJ4QtKAwgMD8CC3mPWvj180WwdakeIICi2S0g4P2o7KwgAE6hr5ArKEEAACH5BAkJADAALAAAAABkAGQAhfyOFPzKjPyuVPzmxPyeNPzarPy+dPz27PzSnPymRPy2ZPzGhPyWJPzu3PzixPzOnPyiRPzevPzChPz+/PzWrPyqVPy6dPzOlPyyXPzq1PyiPPzetPzCfPz69PzWpPyqTPy6bPyaLPySHPzKlPyuXPzmzPyePPzatPy+fPz29PzSpPymTPy2bPzGjPyWLPzy5P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAb+QJhwSCwaj8ikcslsOp/QqHRKrVqv2Kx2y+16v+CweAydRCyVjyUyIbujkwYGQK9jGu23Xtkg1f8AJA17hEYdLSKAdSItHYWPMA0Jin8Jg5CEA4mUdCIlmIQRnH8OoGUvJSUHeVAlm5yepkwTLyMaIrgMCQWrT5KjAJaySh0OK5QiGBmsS4evgCIBjsNHZhrAApdNfZyCVRPTYS/HwAAszEq0JM8iguhNcQYrGiwO71oj5XQMEWURIAIqrLk36wSDPyIWhNsy4Zo+ACgIisngEGG/Lg0OPqxwoFCAZ3a8OAA5StieDhY4aViYxdXDYNreTDDACQJLLC806hPQkdD+A5IAQHiZ8OGhCAkSxZFDmOELBaCAQjR91KCCRhEJ2Hw5oKAcI1AHEKBA8QAPmAkZKowSAaInqAlJtcRhobNOiBYvqOkxY0FAghUCUMTUK/NAhgYp4hJezLix48eQI0ueTLmy5cuYM397kaFEhheKNS+Z4ICDAA0mNAjgYE/0lA4oQigSEQLFTdd8BJTLhrvJCxZQF7HI2zvJBA/B/zBQEVov3OYHILwM5jZyBw8QQkDwcLuIg+l0SklOseBVwhRL8oEfMdmB7D8ELiahCd6A5AkXKD1IigI8APuRTfCAfkkF4B97kkXwnl3yIfEdeOJFdoAE5klQ3REHTPJSAhf+PnZddtt1R8QEKtQ1ynLNUQNOir8lB4AIwxW3RAO6YTOYjEd0YMCCf9QmIo5EFCOBABBoAIEAEjjwI5BF0JJKCaAxKeWUVFZp5ZVYPgHOCy8kluURL5yAAgYkCICBAWWN8VwHHcAFSgoPJGDiiyZIEGUXHTSgAgYmMMCABiBEcKceHZSgITAhULBkFAdcIN1sHyi61wmP6sPAA4s68ducPbaQ4hUlVPRQCB58ikQHfujDSKZXZOgfAARESEUHC0yXqKlwGPgqABiwikQJJoAnAHFgvFCpf7HMKgGyJ4hBAacvcVBFA0X5ZwGuTsy0ax0QYAtDCTy+tBIYB8yxLaz+Nzox0qsMZFqMCi20oIKSS7yg1rkhfDLFusj+SIstDOCSiwYjDFoEjecCkC8VA7jwKgESdUCBqIpowB2GqW4bQrrbHDqdAgR18AC0yu1nSErnjjvFASC8ylw1Jb7kQqlGjOAiMBhYcUK45ZjUpAPBTmdCa0RkQMC5DUrRQcsvMXDBPSnQVx9L2u66gq9INHAsMCx0KEQGPOvjwo0NhF0OAxR4S4ShXmFArBEIbIuAESTejBAKXk/RAAhhi0CABOglwcK2LOT4gNmzWZA3FSkUYEECIYjAQAgfJLlkta9WcKoKR59t4Rd5luCAAyWYxcRS/q1g3AAKBFfBCVi7kbFpfyQ0U0ILkIcQAgH0OODlYhxsK20THXAGZeyhbJt0cS9Q/JAGb8sooN2LmCzlC+a+pED0QJaw9SgQTEVlHB8kJ8IKplv5ggS3zKaBnV/CUOgICiRAAAEJKDBCCcj3NsEBDThMA3qBiSAAACH5BAkJAC8ALAAAAABkAGQAhfyOFPzKjPyuVPzmxPyeNPy+dPzarPz27PzSnPymRPy2ZPzGhPyWJPzu3PzOnPyiRPzChPzixPz+/PzWrPyqVPy6dPzOlPyyXPzq1PyiPPzCfPzevPz69PzWpPyqTPy6bPyaLPySHPzKlPyuXPzmzPyePPy+fPzatPz29PzSpPymTPy2bPzGjPyWLPzy5P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAb+wJdwSCwaj8ikcslsOp/QqHRKrVqv2Kx2y+16v+CweEwum4sS1yYg2rgk53gzIgDYQ5SIfI9sJOyAAAkNfIVCEgWBgSZwhnsNKoqAKoSOchh/koIYlnKQmoKVnU4SHByNUoghmoyjTRwRDiwBKSSoUA0PkoOuTC4VBKsAIRkWKFN0gHh6vUouI5ohEAepaiIBbreppdpeHB+gww7dcQ0LCSUFtmERBOEAKtSFB3WADwNgEg7vw5yFKZJWkMPCYQE/ABsMXZAEYuAVDiwOJiwETlEJh1YkpBAGKoSoPScktfpCIsM7AfL4cFgRiMLHLhJEMAAFYgNGMhIiFKgwISX+GBQaOAICkYJDszIHHCQQFmLEBqNHy0g4QGJDhAYHbkbdyrWr169gw4odS7as2bNow3BwgcEF1LRVOJwoQCHBgwQUCpx4C7fJ1BPBopXoqRWuBAwrhEZbgaEw1QEkfH5t4EFxRw8v0TQokAGE5wcFGhR2hKLeQUAjJA9BkcKdJAIpVPfiUMAyvxAF+AopaPvOAt29NoA4zXDiEAkTZr5r0WF0HBQmeh80wZfyacxRG5gkLimDKAknpAcKccK5mQjcoxmXYJD4AvNlEKTXlGLISu4rgFuKOF9RAPsVnfaBfo6I0J8iLBwHAXcQEGgIQAcCUt8h4Z1GHnxkoBfhMMz+CGHdQS5lt92B3hGBXAv8MIchGSgkEqEJkvEWTgi/cSXcgQQYRwRrrikC2zFc0dZfCBUQKMFmnXmWQWgrxnEABfN5IFsRLpAQAQkujPXhQSF44E9fSByW2G2MNSmWBChMUIJtIQyWFZhOyEVXAhngpZeDcCpxAFsuTJnnn4AGKuigUJRyAgsfrLDABG+MUYoLDTTgliMSkGCCcoooEAGQXhyQQgEjJKDCBRA8pVIKI2oCwjQwRTACpoAQ8EFmY3AgAoq3KYBnFBykMFw4GXSIkwOwvhMCdVqcUKwmJdBKUgnpMdAcFgek+s6AZHBgQn8jZHmFBdzVRMYBy3Kp4xT+B0TCHbJiTPCimS+Q0ONp3Y6x4IEe7LrEjdzxIkaA82WgrxIn/Eqcv0uU0kAEKaRw1SlMsHRgCQMn0U56FHjrzAkCCBWCACf4KcS2+FaMhAuZEFeByC808EG5ADAwqxIQ9odtFYhwx0AKGLmggnjwaGxEAxFOAG/LBvOTmp6m8YNSmAvNl8CXVlgANAAgCGuErVffIcJA/BIXgggmKwGdeAwggNGW1zl7NncXCH3FASIkrUwGey1RIXfkJeGCAl2X2EUDJqhQAggElOCBBXIfAVF/LDhIG8x2MHCBs1hMNcAGG5DA6RLf9FekEr2+KkkICYjQeCcoSJzeCiynsYFdBgJkUIIABUzQQNlnCDkfu0yUYoopR4uhT3/jDBqB3fxkTegBUROnAMtwXXxajoQe4sDVISSf/QsQUR5z5N/bd4IKyzKgQt7lE+GpAnXhpUBs7YcJKQYH8F6/IUEAACH5BAkJADAALAAAAABkAGQAhfyOFPzKjPyuVPzmxPy+dPyeNPzarPz27Py2ZPymRPzSnPzGhPyWJPzu3PzixPzOnPyyZPzChPyiRPzevPz+/Py6dPyqVPzOlPyyXPzq1PzCfPyiPPzetPz69Py6bPyqTPzWrPyaLPySHPzKlPyuXPzmzPy+fPyePPzatPz29Py2bPymTPzSpPzGjPyWLPzy5P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAb+QJhwSCwaj8ikcslsOp/QqHRKrVqv2Kx2y+16v+CweEwum5EUynkd7Uwuo0mHTVemTCEAIGRK1f9FFyJ6eiIjUhQdBygBJgQLIA0daoBPFAWEhCeUTm4qDJmFJCAHnJVKBy6hAAwHTwcLeauEDCoNp0yXq5tOLxWDs6EfGbhLI8CFh00HHsHBw6bFRAd4enyuuQHOzirYXB0ZICgN0VEHb3FzTS+y26sMIOVWvgUMLgUt8lBpUC3uzgLUZWmAKRQGb2QObPjn7FaWDghmGdLnxUE7hqFYaMlwMROJF2ZAgMK4SoMWFKpmJSBW5gEykoRUaOEwctVKMw9qwtTjQQv+wWAQEIoRuTPTAi0UTMxiwIJilxIdYYLY0gGCThcBnHbp8KGoHgYgtxx4IGBDAggG6LDwCkCFQKQvSmQoRUdh0RATtErbR5SkiAhv92LpkBOjiApCBWMZqzPY4bCKvxk4sS1EgMSRs1AYKyCECwagQyRoQS6zGAoZULB4AKKEH9OwY8ueTbu27duyOzRAYQJDAgwmxgXGHYVCgxYFQ+ErTbz4BAHuBOS1xM82BQ7JtxWYroTCCwcXTDxw8EJvsRIpGYYo0X0CBmQMMHCH3YHETgzDh6DITqgAB9koNPYPAyggwY4zIUAWGUReITAcBRq4o4F5dWQggVc3FXHACu7+rIBZMRNEpd4ERmSw0DYbsBSZAenB5EJaRZjozgkqKhagVwzAOE0C7iTwIS4heoWXERC6YwKFdGTAY1EZFnFgMAnSB0GD+cGw3ywFFBjbjTDBkwQF7tUU33ymHWAfTCRUKYR3DoygwQjkIVlJCQIiyF4TaciJC5j8BbOdnriBacFLoYhgAZnN4dnAAn0CsBygicKgGwe9/RbcC2pGqummnHbq6aeghlpcnqJa8p0CLWjwwASSkKFbBhmUd8oLCghA6AYBZAApniAgkIAEG6ygwp11NGCVYxY4sOuXDRBA6B6XLUtFA0tWxoG0RVDgQLWzfLTGC2f+E4JDWbxgwT/+BGBrSWEYEZApFC7944IDZrwAHUknDPBQo7OooG4TEzzrTj5YZCCwSgqCQcEDRXnwmhUoHLzKBsSGQUEERXl7RcQYUYyInEllnPAUJUgcSgLkMnFACRMowAIHJfxIBAUjFNXNYiLOAsG7QnTggAonIHOCB3IwEfBOC/DcRAUMiaAREx2MwO8JF7wrI0khaInFT9Hp1UEEJgMAWHcthJ3JzkiBwK8eTSrBsTsi/KdEBueO+A0HXa0iggoD6HVA3v98IDOYOWcyURfe4SHC4gwUwAJdTIDQ4jYvLsFnZSMoTYXPE0xQApJFkjSh5RlU0GcIGCibWQcqwORWEz4HUAFdBhioAMnDkaUQEUkOWpLCCy8coDkgFDBNUgX/mnaMYQGUOgRUGK3n/JqtM+TB8IkesDYhG4wsKpjc2oSo8xSUAMGzIkBQAvabJsIB0CGEcIIKciTf3AHeT69/qUEAACH5BAkJADAALAAAAABkAGQAhfyOFPzKjPyuVPzmxPy+dPzarPyeNPz27PzSnPy2ZPymRPzGhPyWJPzu3PzixPzOnPyyZPzChPzevPyiRPz+/PzWrPy6dPzOlPyyXPzq1PzCfPzetPyiPPz69PzWpPy6bPyqTPyaLPySHPzKlPyuXPzmzPy+fPzatPyePPz29PzSpPy2bPymTPzGjPyWLPzy5P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAb+QJhwSCwaj0gk5dDYPBaRx6ZxoCSv2Kx2yx2mThYDYExGfU6prnrN5r5WIbKcHFq92vg8m1ICzf9kLCVWeoWGRnwTgIsACoOHkIYHAoyMAgeRmXgPlZUPmqBdL3GdiyF3oalXDyKliyKfqrJFFBiujBiEs7MvLLeLLKhYFMS6u2olHL+AHCVXFC8lJw8PFQ4NxsdZJSjLfyjOSC8qGKRjDCAB2Npayd5zzUgZAgyvCifZ7EYvCu9yCsKGUHAgphODB/n0CbTlbwyEbIluicCnEAmnhrCMHFjR6haLBqAodMjQoEPCfea8nTIiod4vEQE6ZDrQwqUBFSeLXPSWkVb+gncfI1Fo0fGcBC0HSLy7ZKSDi3cMHERK4VIOiZwCSyj6pcBBvgYNcUIqwQxkFj5+SolwlJCsvxFY1WRgFhDLm5R/6tQl4vbdhbhdOhSUswIwkQMbLCiDZ+EEpiQvGlYwvIWCh6IAGJjtsiSDhCcLpGSogkXwuxBShUrAwGHChwwKKUR4h2HvoRePKw7AaxBhxVkdZv8SYPu3phckMDMyANv4rgYClP/hcNT5sQYmeJ9b8cj6sQ4lIgwGECKBBNLe2RE7kCHDC5Pp48ufT7++/fv48+vfn17kAfj8aQKNBAGY8IEJI2zwAmUBnlWBAE/J4QIJHsjUYB4paFDVHwz+RJDbhWq88FMpdmxxgAMbOFCcfR0Q5YoILViYBAUFgGBACAYIQNF+DWhnymZHdPBAhGQcJCN+wv2iwRUlaBdCOPh10M0yKBxZRAuMtKBfBj4yEkJzRyi1CAn6ObChK1ElwRAgGJR5ZilpIoHlIlrmx6VKYBrRJCBP6ielN1UmISSRY7jwgJX2aeDNks8UIMCNKAhQAIPO9fhLCEBC5oAEKjbYonSAwIgoiFgckACocohQIqlqZPhmkRp8yCoXFKgA4RwuCCDWrHu8sMEIBByY4IK86uEfgMUmq+yyzDbr7LPQRqveqNIicYAEF0SgwQgnZFotER2sFkJRISiAQBr+qXQQzQMqjEZpJiks8CoAqq6jyQEBTDnGPejq08ECpdR2nAWAMDCCrLtsMO8cdULy6SIM7HjMAWt2shIkBFWiAMKqnNDlHw0XQsEIpUA5y8ioAvLQIR0QUEoF2gS3DAj96tEBwZ2oELOiv4DAMRsdBFBKaruMvMxVkLRUiQErItGBA9kucIEE1B5RwcJ/RBDJARBUMkLVR5RQTkciGICByVc00M+LaBfSQFpziGBB00V04IGPIagA9hCsuFKYJhlAkJIBC9BNBAUeLy2xoCuUokCeW//6gQUPOLB33WtrfDkMDVT8R1fvqtFBCshyccItJ2gBTQvjxv1a6No07ndgFw2MgAEIIJCwQHf3UZB5JwqEnsLP9VGwWCkcwH4hJa6Q+S0Mc5YSsrQZpEyGCJBHS8EHpVigPIgvQICqCBAY3mwDFrzJgAXZP39ABQmQUkcFxH/r3wH4l/78/vz3T0QQACH5BAkJADAALAAAAABkAGQAhfyOFPzKjPyuVPzmxPy+dPzarPyeNPz27PzSnPy2ZPymRPzGhPyWJPzu3PzixPzOnPyyZPzChPzevPz+/PzWrPy6dPyqVPzOlPyyXPzq1PzCfPzetPyiPPz69PzWpPy6bPyqTPyaLPySHPzKlPyuXPzmzPy+fPzatPyePPz29PzSpPy2bPymTPzGjPyWLPzy5P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAb+QJhwSCwaj8ikcslsOp9QZad08lBOpUN0y+1CDyoMx8UQhVAYldbLbnMnDpAIQK/TRSDJxM3vIzsUDHaDdQwUHX6JfRMUIYSPACEUe4qVXSUKkJAKJZaeUB0EmpoEiJ+nShkuo5AMGahsGRQBEREXFGtLCKyaKrBREx0nJCFlcyIMKCslpkgQvJAQv09wAnOaIgQNlEYc0I8c003CBt8CA9xEjt+DBuMlFA8PHg4pihMn5ewsr0Yo7IPCKZlQYgUHYwwMWDiRjg0cfQBZ5BqCAaAdDEoORBD0SESCbW5SWLBYR0NDFSTp+EJyQBQrCw3cFEhJx0AnIhk4AnSFZML+iGusEjR7I4AmABER0nWoQJKAvSMlvEETcYJNiXU0BcTEKfUbpz8RAIKYGEWFzpQoBhRhhJWVpIZDGoAAaMCBlwVAUzLYYATQ2VaHkmRoy4vBSi4mjN6hcGSCBBZ57YhgoUdJicisRIzwklixiAJJwGBAYcwFBxJqmJT4m3lzlwCYAbqQsOQAFQoeTgx4yiQDRGiGvARSzOGmpRdF2RX30uA3SQxkE/mMDWnFUGAJjIp4ADdRAxbfGKhl44A6Lw5bP00owPpR0jYdVqTc3l1Rhwft62SLzqVBcnYirFBfJcIoEBsHI/DWBhzgfSMCBun9MkEDD5BgAAMJWRBBCQP+vpFBJrwECJI4QkzwQgYllJDBiJUcsAAK1DHAgQodkojKBBksIMAYyITAQQIPsGjjkEO8UIIEJ5wgQQkKEunkk1BGKeWUVFZp5ZVYZvlGCjVq6UcHDrTwAQQftODAdV76QRAGIQBlBgYcpplIBwWYZwiacr5xAmGEhFBAlyUaKWSe30HDQoQ9NbAChgysMKiWEwTAzgg1vlDRRS/kCcMBXZ3X5FoqRCYCjXm+YB4hImSaRAedDWICnleWYJFxR4TySCl5ZmBRPz2ZNYhhgEZpKoCqJvECCYOQUGyaKYAIjQL8EWFiBYxW8EKwUU7QwqSATujAtZrG1SArh4brxXr+fA7iJ6zmjjMcYOy228SabZkBQZzytpFCmBWQ2YIEn+br0AHxCmzwwQgnrPDCDDfs8MMQRywxlPhoAAEGBKQ28R8SyCGZASoU7EYHDaQI7pMdqJDuURFEy0cDC4DAAQcCjCDyJxKsTAcDNltygMf6vUrkBHOxYgCifMTXEaVDnnBqHRFUchUkAiw7jQlP06FAJe8SshyJE1xaGLZO+PqITTaGHR7ZTTiwMghIw8IUNAIlcsB/kkVwsyIUZA0AAZasRgjcRB7gXEd2VUKQAMUwEEICLg/UwAgGiqDACI8qEeooIgjtyb5WMPOGA+PWwYID2HawESQiQBC3lRkUTQhgP1+MwGfnr1fJ6iieO0FyBCxgyIEJZ+b6jyYo8LoxDOVxnvjyzPPy/PKCa8IArRsjN0rV0AtxX34McNe9EAd8gJkIH0QesbYw3oFCC2wzjOMDC0TwQAbxj6///vz3v38QACH5BAkJADAALAAAAABkAGQAhfyOFPzKjPyuVPzmxPy+dPyeNPzarPz27Py2ZPymRPzSpPzGhPyWJPzu3PzixPzOnPyyZPzChPyiRPzevPz+/Py6dPyqVPzOlPyyXPzq1PzCfPyiPPzetPz69Py6bPyqTPzWpPyaLPySHPzKlPyuXPzmzPy+fPyePPzatPz29Py2bPymTPzGjPyWLPzy5PzWrP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAb+QJhwSCwaj8ikcslsOp/QqHRKrUI7pcmk1LF6v9ZOxlNgmBmFSqYLbruRjQgDQK/TGZrGe/92YeyAdCIkLnyGYRWBigAVbIePThQXc4uADBcUkJpLDR+Vih96m6NGKJSfdgwopFMUHQcZEw4NBx2ZSx0LqIoLjqxMFA0KAiKpHigut0gHCLuBCAe/TR0vFsWKDBgOSgckzoAk0dJKFAstuxsoykXM33bQTi4vASwKa3wdLNe7IS/rQx0iuKvTawmFEipEFFMoIsEEX14ogDjnbkMJJKYGqsKloMAiBgsKgWmwYiAdBP+EdBoYasmLEJ9EsIDY6sE+dyIyHKEw4ub+JwYjUhJx4REVgwlfOpQ0SccEkg4evnmgSYSCiW8JhEI54NPdCqowXJDoameQyCQulu4ScdFKCaZ1Cpw10kDDKUsmRClxUHTtAy8c4NIpoDOJGBVlzhTwUEJrkZfuFniZIBgA4SYHsmwR5wQFTGcyvWSofGKuoRInvolQ4OXAXZaO2xzwBFovlQ7N4F4YZdOZii8UXrx2xsD2oxS0PxVo60UsUw2x3zhIXamFArBRKPAdKMA4JAoZMAwHcOIF9ikGPu/6wJxVBwUWToQIUWCFBtNggm/YJaDxOCEHDIACCrNEV8VBHpAFQAgRePcfKeAtsMIJBRRwwgcKNGDgg5r+UOBCA7RsyOGIJJZoIoQUiHjiHh5OcMECESwwwgTJrDiKCyYkEMI+IoSQgAn42ejGARf0pUiPF3AmZBsuRAVaBUEuOcUBEJgEj5RhaKBgJSJocJ6JWJiwwgYrmOAAWMGpN1AL/mB5kDeAiNBfSgf8IRgGStpYwn6LWGTEBFuuhdSSDViASndFEFAZHQQsmU+gAIiwwDrUVbYBoQk4s4JtkK6lIikTUGTUNkMsWkeeJaLgziqlmgoAqiSq+g2rQnSKighfjuPAeIGEQKoQfJJGqFqfJGBbIos2KuSjt7KwDqCViTCokA0IcKhxdVaGJ5YDBBvIBgMYkSZc/Xz6y0H+xMQ55xEB2VpWBLmS2IEDJnywwQdmntfOQCrAimUUDSQImgcO/ivFASMYGUiPI/hr8BQuaLBCCKcwEEKZDj9MhYccPMDCAiw8gIy5GkORIsklp6zyyiy37PLLMMcs88wcvvKhC7bQLAV4ERQVQgUToCyFGA3E26EDxNIRggJCR4KCAAVsgEFhHGaQHCAFcPAIBQrcxADV43SgwScCRPlFCgoDgIDRfBxQqSIhTLvHW98WvEkDkL5wCGWBXPZfA7uwZohrgQjA9h4uqBkIA1obUk6cckvTAbKLtHTIASxQUgDTHFIwgeJ1iBDUdwfIckDTQlBwwOkbd7S4CaifW0JlACp4EIB/Oz/9GQMfjJ7yC2+XV4ULE7wAAgpFq7wdICG0pzMuuT1z+MwNZKqIsc83kYEEi0gAdvbLXG2HBRmDL4Q+C7NgPhPOAVL2+kwEzEAxDBAMfzxamH3//vz37///AFxREAAAO2l6MlNnMjJPaEJTY1lvVkpORFI0dmF6ek1tK1ZrditmL1VXWmxseUxSc0NPYk4vVU5kVVRWeThHRmlpUWNqNWQ=",n.createShowMaskContent=function(e){var t,r,i,o="",s="230px",a="240px",c="",u="";return e&&(e.background&&(o=";background:"+e.background),e.width&&(s=e.width),e.height&&(a=e.height),e.imageSource&&(t=e.imageSource)),t||(t=n.loaderBarSource),i=parseInt(s)/2,n.isNumber(i)&&i>0&&(u=";width:"+i+"px"),r=parseInt(a)/2,n.isNumber(r)&&r>0&&(c=";height:"+r+"px"),['<div align="center" ','class="',n.loaderBarClassName,'" ','style="margin:0 auto;max-width:',s,";max-height:",a,";line-height:",a,o,'"><img style="user-select:none',c,u,';max-width:230px;max-height:240px;vertical-align:middle" src="',t,'" draggable="false" /></div>'].join("")};var r,i=n.win,o=n.doc,s=5e5;function a(e,t){for(var n=0;n<e.length;++n)if(e[n]==t)return d;return A}function c(e){var t;return i.getComputedStyle?t=i.getComputedStyle(e):e.currentStyle&&(t=e.currentStyle),t&&"absolute"!=t.position||"auto"!=e.style.top&&""!=e.style.top||"auto"!=e.style.bottom&&""!=e.style.bottom?A:!function(e){for(var t=0;t<o.styleSheets.length;++t){var n=o.styleSheets[t],r=[],i=void 0,s=void 0,c=void 0;try{r=n.cssRules,i=o.querySelectorAll}catch(f){}if(r&&i)for(var u=0;u<r.length;++u){s=r[u],c=A;try{c=i(s.selectorText)}catch(f){}if(c&&a(c,e)){var l=s.style.getPropertyValue("top"),h=s.style.getPropertyValue("bottom");if(l&&"auto"!=l||h&&"auto"!=h)return d}}}return A}(e)}function u(e){var t=o.createEvent("MouseEvents");return null==t||t.initMouseEvent(e.type,e.bubbles,e.cancelable,i,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),t}function l(e){var t;null===(t=o.body)||void 0===t||t.dispatchEvent(u(e))}function h(e,t){if(r){var n=r.style;n.backgroundColor=["rgba(",t,",",t,",",t,",",e,")"].join(""),n.filter=["alpha(opacity=",100*e,")"].join(""),n.opacity=n.MozOpacity=e}}function f(i,a){r===t?function(t,i){if(r=o.createElement("div")){var a=r.style;a.position="fixed",a.display="block",a.left=a.top=a.margin=a.padding=0,h(t,i),a.zIndex=s,a.width=a.height="100%",e.navInfoSync.bIE&&(r.innerHTML='<iframe src="javascript:\'\'" style="background:none;margin:0px auto;border:0;width:100%;height:100%;position:relative;z-index:9999;"></iframe>'),o.createEvent&&n.addEventListener(r,"click",l)}}(i,a):h(i,a),o.body&&!o.body.contains(r)&&o.body.appendChild(r)}var p={pendingDialogStack:[],opacity:.1,grayHex:128,_updateStacking:function(e){var i,a;0!=(i=this.pendingDialogStack).length?(1!=e&&f(p.opacity,p.grayHex),a=s,n.each(i,(function(e){a++,e._dlgInfo.mask&&(e._dlgInfo.mask.style.zIndex=a++),e.style.zIndex=a}))):r!==t&&(n.removeEventListener(r,"click",l),o&&o.body&&o.body.removeChild(r),r=t)},pushDialog:function(e,t){var r,i=this;e.getBoundingClientRect(),i.pendingDialogStack.length>=1e3?n.error("Too many modal dialogs."):((r=o.createElement("div")).className="dynamsoft-backdrop",1==t?(r.style.left=0,r.style.top=0,r.style.position="absolute"):(r.style.left=0,r.style.top=0,r.style.width="100%",r.style.height="100%",r.style.position="fixed"),o.createEvent&&n.addEventListener(r,"click",(function(t){if(e.dispatchEvent){var n=u(t);e.dispatchEvent(n)}})),e.parentNode.insertBefore(r,e.nextSibling),e._dlgInfo.mask=r,i.pendingDialogStack.push(e),i._updateStacking(t))},removeDialog:function(e){var t,r,i=this;-1!=(t=n.isArray(i.pendingDialogStack)?n.indexOf(e,i.pendingDialogStack):-1)&&(i.pendingDialogStack.splice(t,1),(r=e._dlgInfo.mask).parentNode&&r.parentNode.removeChild(r),e._dlgInfo.mask=null,i._updateStacking())}};function g(e,t){var r,s=this,a=!0,u=1==t?"absolute":"fixed",l="50%",h="50%",f="",A="",g=null;if(s._dlgInfo&&s._dlgInfo.styleConfig){var y=s._dlgInfo.styleConfig;n.isString(y.style)?(r=y.style,a=!1):(n.isString(y.position)&&(u=y.position,a=!1),(n.isString(y.left)||n.isNumber(y.left))&&(h=y.left,a=!1),(n.isString(y.top)||n.isNumber(y.top))&&(l=y.top,a=!1),(n.isString(y.width)||n.isNumber(y.width))&&(f=y.width,a=!1),(n.isString(y.height)||n.isNumber(y.height))&&(A=y.height,a=!1),n.isString(y.transform)&&(g=y.transform,a=!1))}if(s.open)n.error("showDialog called on open dialog.");else{if(s.open=d,s.removeAttribute("closed"),s.setAttribute("open","open"),r)s.setAttribute("style",r);else{var m=void 0;a?m=["display:block;position:",u,";left:50%;top:50%;transform:translate(-50%,-50%)"]:(m=["display:block;position:",u,";left:",h,";top:",l,";width:",f,";height:",A],g&&(m.push(";transform:"),m.push(g))),"DIALOG"==s.tagName?m.push(";margin:0;border-radius:6px;box-shadow:2px 2px 0 0 rgba(0,0,0,.05);-webkit-box-sizing:border-box;box-sizing:border-box;"):m.push(";border:0;margin:0;-webkit-box-sizing:border-box;box-sizing:border-box;"),s.setAttribute("style",m.join(""))}c(s)&&function(e){var t,n,r,s;s=((null===(t=o.body)||void 0===t?void 0:t.scrollTop)||(null===(n=o.documentElement)||void 0===n?void 0:n.scrollTop)||0)+((i.innerHeight?i.innerHeight:null===(r=o.documentElement)||void 0===r?void 0:r.clientHeight)-e.offsetHeight)/2,e.style.top=s+"px",e._dlgInfo.isTopOverridden=d}(s),e&&(s._dlgInfo.modal=d,p.pushDialog(s,t))}}function y(e){var t=this;return t.open||n.error("closeDialog called on closed dialog."),t.open=A,t.removeAttribute("open"),t.setAttribute("closed","closed"),t.style.display="none",void 0!==e&&(t.returnValue=e),t._dlgInfo.isTopOverridden&&(t.style.top="auto"),t._dlgInfo.modal&&p.removeDialog(t),t.returnValue}n.dialog={setup:function(e,t){e.show=g.bind(e,A,t),e.showModal=g.bind(e,d,t),e.close=y.bind(e),e._dlgInfo={}}},n.mask={dlgMask:!1,preOnresize:!1,preOnscroll:!1},n.setBackOpacity=function(e){n.isNumber(e.opacity)?p.opacity=e.opacity:p.opacity=.1,n.isNumber(e.grayHex)?p.grayHex=e.grayHex:p.grayHex=128},n.showMask=function(t){var r,i,s,a,c;if(!n.mask.dlgMask&&!n.dlgLoadingShowStatus){var u,l,h,f,d=!1;if(t&&(f={},t.style?f.style=t.style:((n.isString(t.top)||n.isNumber(t.top))&&(f.top=t.top),(n.isString(t.left)||n.isNumber(t.left))&&(f.left=t.left),n.isString(t.position)&&(f.position=t.position)),t.confined&&(d=t.confined),(n.isString(t.width)||n.isNumber(t.width))&&(i=t.width),(n.isString(t.height)||n.isNumber(t.height))&&(s=t.height),n.isString(t.background)&&(a=t.background),n.isString(t.imageSource)&&(c=t.imageSource),n.setBackOpacity(t),d&&t.wrapperEl&&(l=t.wrapperEl,n.isString(l)&&(l=o.getElementById(l)))),!c){var A=void 0;e.DWT&&e.DWT.CustomizableDisplayInfo&&(A=e.DWT.CustomizableDisplayInfo),c=A&&n.isString(A.loaderBarSource)&&""!=A.loaderBarSource?A.loaderBarSource:e.navInfoSync.bIE?n.loaderBarSourceIE:n.loaderBarSource}l&&(h=l.getBoundingClientRect(),l.style.position="relative"),(u=o.createElement("div"))&&(u.className="dynamsoft-dialog-wrap",u.innerHTML=n.createShowMaskContent({width:i,height:s,backgroundColor:a,imageSource:c}),l?(l.appendChild(u),u.style.position="absolute",u.style.top="50%",u.style.left="50%",u.style.transform="translate(-50%, -50%)"):null===(r=o.body)||void 0===r||r.appendChild(u),d&&h&&(window.onresize?n.mask.preOnresize=window.onresize:n.mask.preOnresize=!1,window.onscroll?n.mask.preOnscroll=window.onscroll:n.mask.preOnscroll=!1),n.mask.dlgMask=u,n.dialog.setup(u,d),f&&(u._dlgInfo.styleConfig=f),l&&(u._dlgInfo.wrapperEl=l),u.showModal())}},n.hideMask=function(){var e,t=n.mask.dlgMask;t&&(t.close(),t._dlgInfo&&t._dlgInfo.wrapperEl?(t._dlgInfo.wrapperEl.removeChild(t),t._dlgInfo.wrapperEl=null):null===(e=o.body)||void 0===e||e.removeChild(t),n.mask.dlgMask=!1),n.mask.preOnresize?window.onresize=n.mask.preOnresize:window.onresize=null,n.mask.preOnresize=!1,n.mask.preOnscroll?window.onscroll=n.mask.preOnscroll:window.onscroll=null,n.mask.preOnscroll=!1}}(t),function(e){var t,n,r,i,o=e.Lib,s=window.document,a=[],c=a.push,u=a.slice,l=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,h=function(){n()};try{c.apply(u.call(s.childNodes),s.childNodes)}catch(d){return}function f(e,t,o,a){var u,h,f,d=t&&t.ownerDocument,A=t?t.nodeType:9;if(o=o||[],"string"!=typeof e||!e||1!==A&&9!==A&&11!==A)return o;if(!a&&((t?t.ownerDocument||t:s)!==r&&n(t),t=t||r,11!==A&&(f=l.exec(e))))if(u=f[1]){if(9===A){if(!(h=t.getElementById(u)))return o;if(h.id===u)return o.push(h),o}else if(d&&(h=d.getElementById(u))&&i(t,h)&&h.id===u)return o.push(h),o}else{if(f[2])return c.apply(o,t.getElementsByTagName(e)),o;if((u=f[3])&&t.getElementsByClassName)return c.apply(o,t.getElementsByClassName(u)),o}return o}n=f.setDocument=function(e){var t,n=e?e.ownerDocument||e:s;return n!==r&&9===n.nodeType&&n.documentElement?(s!==(r=n)&&(t=r.defaultView)&&t.top!==t&&(t.addEventListener?t.addEventListener("unload",h,!1):t.attachEvent&&t.attachEvent("onunload",h)),i=function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},r):r},f.contains=function(e,t){return(e.ownerDocument||e)!==r&&n(e),i(e,t)},f.error=function(e){throw new Error("Syntax error: "+e)},t=f.getText=function(e){var n,r="",i=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)r+=t(e)}else if(3===o||4===o)return e.nodeValue}else for(;n=e[i++];)r+=t(n);return r},n(),o.sizzle=f}(t),function(e){var t,n,r=e.Lib,i=r.doc,o=r.each,s=new lt(i),a=s.docElem,c=r.sizzle,u=/^margin/,l=/^(top|right|bottom|left)$/,h=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,f=new RegExp("^("+h+")(?!px)[a-z%]+$","i"),d=new RegExp("^("+h+")(.*)$","i");window.getComputedStyle?(t=function(e){var t,n;return(n=(t=r.isFunction(e.getEL)?e.getEL():e).ownerDocument.defaultView)&&n.opener||(n=window),n.getComputedStyle(t)},n=function(e,n,i){var o,a,l,h,d=e.style;return""!==(h=(i=i||t(e))?i.getPropertyValue(n)||i[n]:undefined)&&h!==undefined||c.contains(e.ownerDocument,e)||(h=r.style(e,n)),i&&!s.pixelMarginRight()&&f.test(h)&&u.test(n)&&(o=d.width,a=d.minWidth,l=d.maxWidth,d.minWidth=d.maxWidth=d.width=h,h=i.width,d.width=o,d.minWidth=a,d.maxWidth=l),h===undefined?h:h+""}):a&&a.currentStyle&&(t=function(e){return e.currentStyle},n=function(e,n,r){var i,o,s,a,c=e.style;return null==(a=(r=r||t(e))?r[n]:undefined)&&c&&c[n]&&(a=c[n]),f.test(a)&&!l.test(n)&&(i=c.left,(s=(o=e.runtimeStyle)&&o.left)&&(o.left=e.currentStyle.left),c.left="fontSize"===n?"1em":a,a=c.pixelLeft+"px",c.left=i,s&&(o.left=s)),a===undefined?a:a+""||"auto"});var A,p=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,g=/<([\w:-]+)/,y=/^\s+/,m=/<|&#?\w+;/,b=/<tbody/i,C=/^-ms-/,v=/-([\da-z])/gi,w=/^(none|table(?!-c[ea]).+)/,P=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,I={position:"absolute",visibility:"hidden",display:"block"},E={letterSpacing:"0",fontWeight:"400"},S=["Top","Right","Bottom","Left"],x={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:s.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},B=["Webkit","O","Moz","ms"],T="abbr|article|aside|audio|bdi|canvas|data|datalist|details|dialog|figcaption|figure|footer|header|hgroup|main|mark|meter|nav|output|picture|progress|section|summary|template|time|video",k=document.createElement("div");if(k.style){A=k.style,s.cssFloat=!!k.style.cssFloat;var z=function(e,t){return t.toUpperCase()},L={type:r.type,cssHooks:{},htmlPrefilter:function(e){return e.replace(p,"<$1></$2>")},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;)e[i++]=t[r++];if(n!=n)for(;t[r]!==undefined;)e[i++]=t[r++];return e.length=i,e},camelCase:function(e){return e.replace(C,"ms-").replace(v,z)},cssProps:{},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0}},Q=["flo","at"].join("");L.cssProps[Q]=s.cssFloat?"cssFloat":"styleFloat",o(["height","width"],(function(e,n){L.cssHooks[e]={get:function(t,n,i){if(n)return w.test(r.css(t,"display"))&&0===t.offsetWidth?function(e,t,n,r){var i,s={};return o(t,(function(n,r){s[r]=e.style[r],e.style[r]=t[r]})),i=n.apply(e,r||[]),o(t,(function(t,n){e.style[n]=s[n]})),i}(t,I,(function(){return R(t,e,i)})):R(t,e,i)},set:function(n,i,o){var a=o&&t(n);return function(e,t,n){var r=d.exec(t);return r?Math.max(0,parseInt(r[1])-(n||0))+(r[2]||"px"):t}(0,i,o?F(n,e,o,s.boxSizing&&"border-box"===r.css(n,"boxSizing",!1,a),a):0)}}})),r.style=function(e,t,n,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,a,c,u=L.camelCase(t),l=e.style;if(t=L.cssProps[u]||(L.cssProps[u]=M(u)||u),c=L.cssHooks[t]||L.cssHooks[u],n===undefined)return c&&"get"in c&&(o=c.get(e,!1,i))!==undefined?o:l[t]+"";"string"==(a=typeof n)&&(o=j(n))&&o[1]&&(n=function(e,t,n,i){var o,s=1,a=20,c=i?function(){return i.cur()}:function(){return r.css(e,t,"")},u=c(),l=n&&n[3]||(L.cssNumber[t]?"":"px"),h=(L.cssNumber[t]||"px"!==l&&+u)&&j(r.css(e,t));if(h&&h[3]!==l){l=l||h[3],n=n||[],h=+u||1;do{h/=s=s||".5",r.style(e,t,h+l)}while(s!==(s=c()/u)&&1!==s&&--a)}return n&&(h=+h||+u||0,o=n[1]?h+(n[1]+1)*n[2]:+n[2],i&&(i.unit=l,i.start=h,i.end=o)),o}(e,t,o),a="number"),null!=n&&n==n&&("number"===a&&(n+=o&&o[3]||(L.cssNumber[u]?"":"px")),s.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),c&&"set"in c&&(n=c.set(e,n,i))===undefined||(l[t]=n))}},r.css=function(e,t,r,i){var o,s,a,c=L.camelCase(t);return t=L.cssProps[c]||(L.cssProps[c]=M(c)||c),(a=L.cssHooks[t]||L.cssHooks[c])&&"get"in a&&(s=a.get(e,!0,r)),s===undefined&&(s=n(e,t,i)),"normal"===s&&t in E&&(s=E[t]),""===r||r?(o=parseFloat(s),!0===r||isFinite(o)?o||0:s):s},r.parseHTML=function(e,t){if(!e||"string"!=typeof e)return[];"boolean"==typeof t&&(t=!1),t=t||document;var n=P.exec(e);return n?[t.createElement(n[1])]:(n=D([e],t),L.merge([],n.childNodes))},r.support=s}function M(e){if(e in A)return e;for(var t=e.charAt(0).toUpperCase()+e.slice(1),n=B.length;n--;)if((e=B[n]+t)in A)return e}function D(e,t){for(var n,i,o,a,u,l,h=e.length,f=function(e){var t=T.split("|"),n=e.createDocumentFragment();if(n.createElement)for(;t.length;)n.createElement(t.pop());return n}(t),d=[],A=0;A<h;A++)if((i=e[A])||0===i)if("object"===r.type(i))L.merge(d,i.nodeType?[i]:i);else if(m.test(i)){if(o=o||f.appendChild(t.createElement("div"))){for(a=(g.exec(i)||["",""])[1].toLowerCase(),l=x[a]||x._default,o.innerHTML=l[1]+L.htmlPrefilter(i)+l[2],n=l[0];n--;)o=o.lastChild;if(!s.leadingWhitespace&&y.test(i)){var p=y.exec(i);p&&p.length>0&&d.push(t.createTextNode(p[0]))}if(!s.tbody&&(n=(i="table"!==a||b.test(i)?"<table>"!==l[1]||b.test(i)?0:o:o.firstChild)&&i.childNodes.length,i))for(;n--;)L.nodeName(u=i.childNodes[n],"tbody")&&!u.childNodes.length&&i.removeChild(u);for(L.merge(d,o.childNodes),o.textContent="";o.firstChild;)o.removeChild(o.firstChild);o=f.lastChild}}else d.push(t.createTextNode(i));for(o&&f&&f.removeChild(o),A=0;i=d[A++];)"SCRIPT"!==i.tagName&&(c.contains(i.ownerDocument,i),f.appendChild(i));return o=null,f}function F(e,t,n,i,o){for(var s=n===(i?"border":"content")?4:"width"===t?1:0,a=0;s<4;s+=2)"margin"===n&&(a+=r.css(e,n+S[s],!0,o)),i?("content"===n&&(a-=r.css(e,"padding"+S[s],!0,o)),"margin"!==n&&(a-=r.css(e,"border"+S[s]+"Width",!0,o))):(a+=r.css(e,"padding"+S[s],!0,o),"padding"!==n&&(a+=r.css(e,"border"+S[s]+"Width",!0,o)));return a}function R(e,i,o){var a=!0,c="width"===i?e.offsetWidth:e.offsetHeight,u=t(e),l=s.boxSizing&&"border-box"===r.css(e,"boxSizing",!1,u);if(c<=0||null==c){if(((c=n(e,i,u))<0||null==c)&&(c=e.style[i]),f.test(c))return c;a=l&&(s.boxSizingReliable()||c===e.style[i]),c=parseFloat(c)||0}return c+F(e,i,o||(l?"border":"content"),a,u)}function j(e){return new RegExp("^(?:([+-])=|)("+h+")([a-z%]*)$","i").exec(e)}}(t),t.Lib.wakeLock={toggle:bt,getWakeLock:Ct})}();
!function(e){"object"==typeof module&&"object"==typeof module.exports&&("function"==typeof Object.create?Object.defineProperty(module.exports,"__esModule",{value:!0}):module.exports.__esModule=!0,module.exports.default=e)}(globalThis.Dynamsoft);
(function(b){if(!b.DWT){b.DWT={}}if(!b.DWT.LTS){b.DWT.LTS={}}if(!b.Lib.UI){b.Lib.UI={}}if(!b.Lib.html5){b.Lib.html5={}}})(Dynamsoft);
(function(e){if(!e.WeakSet){e.WeakSet=b;var c=Date.now()%1E9;function b(a){this.name="__st"+(1E9*Math.random()>>>0)+(c++ +"__");a&&a.forEach&&a.forEach(this.add,this)}var z=b.prototype;z.add=function(a){var d=this.name;a[d]||Object.defineProperty(a,d,{value:!0,writable:!0});return this};z["delete"]=function(a){if(!a[this.name])return!1;a[this.name]=void 0;return!0};z.has=function(a){return!!a[this.name]};}
if(!e.WeakMap){var r=Object.prototype.hasOwnProperty;var n=Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{value:1}).x===1}catch(e){}}();var i=function(e,t,r){if(n){Object.defineProperty(e,t,{configurable:true,writable:true,value:r})}else{e[t]=r}};e.WeakMap=function(){function WeakMap(){if(this===void 0){throw new TypeError("Constructor WeakMap requires 'new'")}i(this,"_id",genId("_WeakMap"));if(arguments.length>0){throw new TypeError("WeakMap iterable is not supported")}}i(WeakMap.prototype,"delete",function(e){checkInstance(this,"delete");if(!isObject(e)){return false}var t=e[this._id];if(t&&t[0]===e){delete e[this._id];return true}return false});i(WeakMap.prototype,"get",function(e){checkInstance(this,"get");if(!isObject(e)){return void 0}var t=e[this._id];if(t&&t[0]===e){return t[1]}return void 0});i(WeakMap.prototype,"has",function(e){checkInstance(this,"has");if(!isObject(e)){return false}var t=e[this._id];if(t&&t[0]===e){return true}return false});i(WeakMap.prototype,"set",function(e,t){checkInstance(this,"set");if(!isObject(e)){throw new TypeError("Invalid value used as weak map key")}var r=e[this._id];if(r&&r[0]===e){r[1]=t;return this}i(e,this._id,[e,t]);return this});function checkInstance(e,t){if(!isObject(e)||!r.call(e,"_id")){throw new TypeError(t+" method called on incompatible receiver "+typeof e)}}function genId(e){return e+"_"+rand()+"."+rand()}function rand(){return Math.random().toString().substring(2)}i(WeakMap,"_polyfill",true);return WeakMap}();function isObject(e){return Object(e)===e}}})(typeof globalThis!=="undefined"?globalThis:typeof self!=="undefined"?self:typeof window!=="undefined"?window:typeof global!=="undefined"?global:this);
!function(){"use strict";var e=globalThis.Dynamsoft,t=e.Lib;function r(e){return Math.floor(e)}var n="18",i="0",o="1025",a="1",s="127.0.0.1",u="".concat(n,",").concat(i,",").concat("0",",").concat(o),c={JSVersion:"".concat(n,",").concat(a,",").concat("0",",").concat("0112"),ServerVersionInfo:u,ServerLinuxVersionInfo:u,ServerMacVersionInfo:u,ActiveXVersion:u,ActiveXPdfVersion:"11.4.1.1025",PdfVersion:"11.4.1.1025",ProductName:"Dynamic Web TWAIN "+[n,a].join("."),Containers:undefined,DynamicContainers:[],ContainerMap:{},Trial:!1,ResourcesPath:"Resources",Debug:!1,IfUpdateService:!1,AutoLoad:!0,ReConnectToService:!0,OnWebTwainReady:!1,OnWebTwainNotFound:!1,OnWebTwainOldPluginNotAllowed:!1,OnWebTwainNeedUpgrade:!1,OnWebTwainNeedUpgradeWebJavascript:!1,OnWebTwainInitMessage:!1,ViewerJSIntegerited:!0,ActiveXInstallWithCAB:!1,IfUseActiveXForIE10Plus:!1,IfInstallDWTModuleWithZIP:!1,IfUseEmbeddedDownloadNoticeForActiveX:!1,IfCheckDCP:!1,IfDisableDefaultSettings:!1,OnWebTwainWillInit:!1,IfAddMD5InUploadHeader:!1,IfAlwaysFocusOnPopupWindow:!0,IfConfineMaskWithinTheViewer:!1,UseDefaultViewer:!0,fetchOptions:{mode:"cors",credentials:"same-origin"},HideTrialMessage:!1,CheckCertExpired:!0,ConnectWithSocket:!1,SSLPort:18623,Port:18622,showLoadingMsgDialog:!0,licenseServer:undefined,sessionPassword:undefined,organizationID:undefined,handshakeCode:undefined,Host:s},l={URL:"",UpdateDaysBeforeExpired:30},d={loaderBarClassName:"ds-dwt-loaderBar",loaderBarBackgroundColor:"",loaderBarSource:e.navInfoSync.bIE?e.Lib.loaderBarSourceIE:e.Lib.loaderBarSource,errorMessages:{ERR_MODULE_NOT_INSTALLED:"Error: The Dynamic Web TWAIN module is not installed.",ERR_BROWSER_NOT_SUPPORT:"Error: This browser is currently not supported.",ERR_CreateID_MustNotInContainers:"Error: Duplicate ContainerId detected for creating Dynamic Web TWAIN objects, please check and modify.",ERR_CreateID_WebTwainIdDuplicated:"Error: Duplicate id detected for creating Dynamic Web TWAIN objects, please check and modify.",ERR_CreateID_NotContainer:"Error: The ID of the DIV for creating the new DWT object is invalid.",ERR_CreateID_WasmEnvNotLoaded:"Error: The wasm env not loaded.",ERR_DWT_NOT_DOWNLOADED:"Error: Failed to download the Dynamic Web TWAIN module.",limitReachedForZoomIn:"Error: You have reached the limit for zooming in",limitReachedForZoomOut:"Error: You have reached the limit for zooming out",insufficientParas:"Error: Not enough parameters.",invalidAngle:"Error: The angle you entered is invalid.",invalidIndex:"Error: The index you entered is invalid.",invalidHeightOrWidth:"Error: The height or width you entered is invalid.",imageNotChanged:"Error: You have not changed the current image."},generalMessages:{checkingDWTVersion:"Checking WebTwain version ...",updatingDService:"Dynamsoft Service is updating ...",downloadingDWTModule:"Downloading the Dynamic Web TWAIN module.",refreshNeeded:"Please REFRESH your browser.",downloadNeeded:"Please download and install the Dynamic Web TWAIN.",DWTmoduleLoaded:"The Dynamic Web TWAIN module is loaded."},customProgressText:{upload:"Uploading...",download:"Downloading...",load:"Loading...",decode:"Processing...",decodeTIFF:"Processing tiff...",decodePDF:"Processing pdf...",encode:"Processing...",encodeTIFF:"Processing tiff...",encodePDF:"Processing pdf...",canvasLoading:"Loading ..."},buttons:{titles:{previous:"Previous Image",next:"Next Image",print:"Print Image",scan:"Scan Documents",load:"Load Local Images",rotateleft:"Rotate Left",rotate:"Rotate",rotateright:"Rotate Right",deskew:"Deskew",crop:"Crop Selected Area",cut:"Cut Selected Area",changeimagesize:"Change Image Size",flip:"Flip Image",mirror:"Mirror Image",zoomin:"Zoom In",originalsize:"Show Original Size",zoomout:"Zoom Out",stretch:"Stretch Mode",fit:"Fit Window",fitw:"Fit Horizontally",fith:"Fit Vertically",hand:"Hand Mode",rectselect:"Select Mode",zoom:"Click to Zoom In",restore:"Restore Original Image",save:"Save Changes",close:"Close the Editor",removeall:"Remove All Images",removeselected:"Remove All Selected Images"},bShowAllButtons:!0,visibility:{scan:!0,load:!0,print:!0,removeall:!0,removeselected:!0,rotateleft:!0,rotate:!0,rotateright:!0,deskew:!0,crop:!0,cut:!0,changeimagesize:!0,flip:!0,mirror:!0,zoomin:!0,originalsize:!0,zoomout:!0,stretch:!0,fit:!0,fitw:!0,fith:!0,hand:!0,rectselect:!0,zoom:!0,restore:!0,save:!0,close:!0}},dialogText:{dlgRotateAnyAngle:["Angle :","Interpolation:","Keep size","  OK  ","Cancel"],dlgChangeImageSize:["New Height :","New Width :","Interpolation method:","  OK  ","Cancel"],saveChangedImage:["You have changed the image. Do you want to keep the change(s)?","  Yes  ","  No  "],selectSource:["Select Source:","Select","Cancel","There is no source available!"]}};function h(){var r=e.DWT.Host;return t.isString(r)&&""!=r||(e.DWT.Host=r=s),r}function g(){return t.detect.ssl?e.dcp.SSLPort:e.dcp.Port}var f={CertificateConfig:{},CustomizableDisplayInfo:{}},m=e.DWT;f.RegisterEvent=function(r,n){return("OnWebTwainReady"===r&&t.isFunction(n)||"OnWebTwainInitMessage"===r&&t.isFunction(n))&&(e.DWT[r]=n),!0},t.mix(f,c),t.mix(f.CertificateConfig,l),t.mix(f.CustomizableDisplayInfo,d),t.mix(f,m),e.DWT=f;var _=e.DWT;_.EnumDWT_PixelType={TWPT_BW:0,TWPT_GRAY:1,TWPT_RGB:2,TWPT_PALLETE:3,TWPT_CMY:4,TWPT_CMYK:5,TWPT_YUV:6,TWPT_YUVK:7,TWPT_CIEXYZ:8,TWPT_LAB:9,TWPT_SRGB:10,TWPT_SCRGB:11,TWPT_INFRARED:16},_.EnumDWT_BorderStyle={TWBS_NONE:0,TWBS_SINGLEFLAT:1,TWBS_SINGLE3D:2},_.EnumDWT_MessageType={TWQC_GET:1,TWQC_SET:2,TWQC_GETDEFAULT:4,TWQC_GETCURRENT:8,TWQC_RESET:16},_.EnumDWT_Cap={CAP_NONE:0,CAP_XFERCOUNT:1,ICAP_COMPRESSION:256,ICAP_PIXELTYPE:257,ICAP_UNITS:258,ICAP_XFERMECH:259,CAP_AUTHOR:4096,CAP_CAPTION:4097,CAP_FEEDERENABLED:4098,CAP_FEEDERLOADED:4099,CAP_TIMEDATE:4100,CAP_SUPPORTEDCAPS:4101,CAP_EXTENDEDCAPS:4102,CAP_AUTOFEED:4103,CAP_CLEARPAGE:4104,CAP_FEEDPAGE:4105,CAP_REWINDPAGE:4106,CAP_INDICATORS:4107,CAP_SUPPORTEDCAPSEXT:4108,CAP_PAPERDETECTABLE:4109,CAP_UICONTROLLABLE:4110,CAP_DEVICEONLINE:4111,CAP_AUTOSCAN:4112,CAP_THUMBNAILSENABLED:4113,CAP_DUPLEX:4114,CAP_DUPLEXENABLED:4115,CAP_ENABLEDSUIONLY:4116,CAP_CUSTOMDSDATA:4117,CAP_ENDORSER:4118,CAP_ALARMS:4120,CAP_ALARMVOLUME:4121,CAP_AUTOMATICCAPTURE:4122,CAP_TIMEBEFOREFIRSTCAPTURE:4123,CAP_TIMEBETWEENCAPTURES:4124,CAP_CLEARBUFFERS:4125,CAP_MAXBATCHBUFFERS:4126,CAP_DEVICETIMEDATE:4127,CAP_POWERSUPPLY:4128,CAP_CAMERAPREVIEWUI:4129,CAP_SERIALNUMBER:4132,CAP_PRINTER:4134,CAP_PRINTERENABLED:4135,CAP_PRINTERINDEX:4136,CAP_PRINTERMODE:4137,CAP_PRINTERSTRING:4138,CAP_PRINTERSUFFIX:4139,CAP_LANGUAGE:4140,CAP_FEEDERALIGNMENT:4141,CAP_FEEDERORDER:4142,CAP_REACQUIREALLOWED:4144,CAP_BATTERYMINUTES:4146,CAP_BATTERYPERCENTAGE:4147,CAP_CAMERASIDE:4148,CAP_SEGMENTED:4149,CAP_CAMERAENABLED:4150,CAP_CAMERAORDER:4151,CAP_MICRENABLED:4152,CAP_FEEDERPREP:4153,CAP_FEEDERPOCKET:4154,CAP_AUTOMATICSENSEMEDIUM:4155,CAP_CUSTOMINTERFACEGUID:4156,ICAP_AUTOBRIGHT:4352,ICAP_BRIGHTNESS:4353,ICAP_CONTRAST:4355,ICAP_CUSTHALFTONE:4356,ICAP_EXPOSURETIME:4357,ICAP_FILTER:4358,ICAP_FLASHUSED:4359,ICAP_GAMMA:4360,ICAP_HALFTONES:4361,ICAP_HIGHLIGHT:4362,ICAP_IMAGEFILEFORMAT:4364,ICAP_LAMPSTATE:4365,ICAP_LIGHTSOURCE:4366,ICAP_ORIENTATION:4368,ICAP_PHYSICALWIDTH:4369,ICAP_PHYSICALHEIGHT:4370,ICAP_SHADOW:4371,ICAP_FRAMES:4372,ICAP_XNATIVERESOLUTION:4374,ICAP_YNATIVERESOLUTION:4375,ICAP_XRESOLUTION:4376,ICAP_YRESOLUTION:4377,ICAP_MAXFRAMES:4378,ICAP_TILES:4379,ICAP_BITORDER:4380,ICAP_CCITTKFACTOR:4381,ICAP_LIGHTPATH:4382,ICAP_PIXELFLAVOR:4383,ICAP_PLANARCHUNKY:4384,ICAP_ROTATION:4385,ICAP_SUPPORTEDSIZES:4386,ICAP_THRESHOLD:4387,ICAP_XSCALING:4388,ICAP_YSCALING:4389,ICAP_BITORDERCODES:4390,ICAP_PIXELFLAVORCODES:4391,ICAP_JPEGPIXELTYPE:4392,ICAP_TIMEFILL:4394,ICAP_BITDEPTH:4395,ICAP_BITDEPTHREDUCTION:4396,ICAP_UNDEFINEDIMAGESIZE:4397,ICAP_EXTIMAGEINFO:4399,ICAP_MINIMUMHEIGHT:4400,ICAP_MINIMUMWIDTH:4401,ICAP_AUTODISCARDBLANKPAGES:4404,ICAP_FLIPROTATION:4406,ICAP_BARCODEDETECTIONENABLED:4407,ICAP_SUPPORTEDBARCODETYPES:4408,ICAP_BARCODEMAXSEARCHPRIORITIES:4409,ICAP_BARCODESEARCHPRIORITIES:4410,ICAP_BARCODESEARCHMODE:4411,ICAP_BARCODEMAXRETRIES:4412,ICAP_BARCODETIMEOUT:4413,ICAP_ZOOMFACTOR:4414,ICAP_PATCHCODEDETECTIONENABLED:4415,ICAP_SUPPORTEDPATCHCODETYPES:4416,ICAP_PATCHCODEMAXSEARCHPRIORITIES:4417,ICAP_PATCHCODESEARCHPRIORITIES:4418,ICAP_PATCHCODESEARCHMODE:4419,ICAP_PATCHCODEMAXRETRIES:4420,ICAP_PATCHCODETIMEOUT:4421,ICAP_FLASHUSED2:4422,ICAP_IMAGEFILTER:4423,ICAP_NOISEFILTER:4424,ICAP_OVERSCAN:4425,ICAP_AUTOMATICBORDERDETECTION:4432,ICAP_AUTOMATICDESKEW:4433,ICAP_AUTOMATICROTATE:4434,ICAP_JPEGQUALITY:4435,ICAP_FEEDERTYPE:4436,ICAP_ICCPROFILE:4437,ICAP_AUTOSIZE:4438,ICAP_AUTOMATICCROPUSESFRAME:4439,ICAP_AUTOMATICLENGTHDETECTION:4440,ICAP_AUTOMATICCOLORENABLED:4441,ICAP_AUTOMATICCOLORNONCOLORPIXELTYPE:4442,ICAP_COLORMANAGEMENTENABLED:4443,ICAP_IMAGEMERGE:4444,ICAP_IMAGEMERGEHEIGHTTHRESHOLD:4445,ICAP_SUPPORTEDEXTIMAGEINFO:4446},_.EnumDWT_CapType={TWON_NONE:0,TWON_ARRAY:3,TWON_ENUMERATION:4,TWON_ONEVALUE:5,TWON_RANGE:6},_.EnumDWT_TransferMode={TWSX_NATIVE:0,TWSX_FILE:1,TWSX_MEMORY:2},_.EnumDWT_FileFormat={TWFF_TIFF:0,TWFF_PICT:1,TWFF_BMP:2,TWFF_XBM:3,TWFF_JFIF:4,TWFF_FPX:5,TWFF_TIFFMULTI:6,TWFF_PNG:7,TWFF_SPIFF:8,TWFF_EXIF:9,TWFF_PDF:10,TWFF_JP2:11,TWFF_JPN:12,TWFF_JPX:13,TWFF_DEJAVU:14,TWFF_PDFA:15,TWFF_PDFA2:16},_.EnumDWT_TIFFCompressionType={TIFF_AUTO:0,TIFF_NONE:1,TIFF_RLE:2,TIFF_FAX3:3,TIFF_T4:3,TIFF_FAX4:4,TIFF_T6:4,TIFF_LZW:5,TIFF_JPEG:7,TIFF_PACKBITS:32773},_.EnumDWT_InterpolationMethod={IM_NEARESTNEIGHBOUR:1,IM_BILINEAR:2,IM_BICUBIC:3,IM_BESTQUALITY:5},_.EnumDWT_ImageType={IT_BMP:0,IT_JPG:1,IT_TIF:2,IT_PNG:3,IT_PDF:4,IT_ALL:5,IT_MULTIPAGE_PDF:7,IT_MULTIPAGE_TIF:8,IT_J2K:14},_.EnumDWT_PDFCompressionType={PDF_AUTO:0,PDF_FAX3:1,PDF_FAX4:2,PDF_LZW:3,PDF_RLE:4,PDF_JPEG:5,PDF_JP2000:6,PDF_JBIG2:7},_.EnumDWT_ShowMode={SW_ACTIVE:0,SW_MAX:1,SW_MIN:2,SW_CLOSE:3,SW_IFLIVE:4},_.EnumDWT_CapValueType={TWTY_INT8:0,TWTY_INT16:1,TWTY_INT32:2,TWTY_UINT8:3,TWTY_UINT16:4,TWTY_int:5,TWTY_BOOL:6,TWTY_FIX32:7,TWTY_FRAME:8,TWTY_STR32:9,TWTY_STR64:10,TWTY_STR128:11,TWTY_STR255:12},_.EnumDWT_UnitType={TWUN_INCHES:0,TWUN_CENTIMETERS:1,TWUN_PICAS:2,TWUN_POINTS:3,TWUN_TWIPS:4,TWUN_PIXELS:5,TWUN_MILLIMETERS:6},_.EnumDWT_DUPLEX={TWDX_NONE:0,TWDX_1PASSDUPLEX:1,TWDX_2PASSDUPLEX:2},_.EnumDWT_CapLanguage={TWLG_DAN:0,TWLG_DUT:1,TWLG_ENG:2,TWLG_FCF:3,TWLG_FIN:4,TWLG_FRN:5,TWLG_GER:6,TWLG_ICE:7,TWLG_ITN:8,TWLG_NOR:9,TWLG_POR:10,TWLG_SPA:11,TWLG_SWE:12,TWLG_USA:13,TWLG_USERLOCALE:-1,TWLG_AFRIKAANS:14,TWLG_ALBANIA:15,TWLG_ARABIC:16,TWLG_ARABIC_ALGERIA:17,TWLG_ARABIC_BAHRAIN:18,TWLG_ARABIC_EGYPT:19,TWLG_ARABIC_IRAQ:20,TWLG_ARABIC_JORDAN:21,TWLG_ARABIC_KUWAIT:22,TWLG_ARABIC_LEBANON:23,TWLG_ARABIC_LIBYA:24,TWLG_ARABIC_MOROCCO:25,TWLG_ARABIC_OMAN:26,TWLG_ARABIC_QATAR:27,TWLG_ARABIC_SAUDIARABIA:28,TWLG_ARABIC_SYRIA:29,TWLG_ARABIC_TUNISIA:30,TWLG_ARABIC_UAE:31,TWLG_ARABIC_YEMEN:32,TWLG_BASQUE:33,TWLG_BYELORUSSIAN:34,TWLG_BULGARIAN:35,TWLG_CATALAN:36,TWLG_CHINESE:37,TWLG_CHINESE_HONGKONG:38,TWLG_CHINESE_PRC:39,TWLG_CHINESE_SINGAPORE:40,TWLG_CHINESE_SIMPLIFIED:41,TWLG_CHINESE_TAIWAN:42,TWLG_CHINESE_TRADITIONAL:43,TWLG_CROATIA:44,TWLG_CZECH:45,TWLG_DANISH:0,TWLG_DUTCH:1,TWLG_DUTCH_BELGIAN:46,TWLG_ENGLISH:2,TWLG_ENGLISH_AUSTRALIAN:47,TWLG_ENGLISH_CANADIAN:48,TWLG_ENGLISH_IRELAND:49,TWLG_ENGLISH_NEWZEALAND:50,TWLG_ENGLISH_SOUTHAFRICA:51,TWLG_ENGLISH_UK:52,TWLG_ENGLISH_USA:13,TWLG_ESTONIAN:53,TWLG_FAEROESE:54,TWLG_FARSI:55,TWLG_FINNISH:4,TWLG_FRENCH:5,TWLG_FRENCH_BELGIAN:56,TWLG_FRENCH_CANADIAN:3,TWLG_FRENCH_LUXEMBOURG:57,TWLG_FRENCH_SWISS:58,TWLG_GERMAN:6,TWLG_GERMAN_AUSTRIAN:59,TWLG_GERMAN_LUXEMBOURG:60,TWLG_GERMAN_LIECHTENSTEIN:61,TWLG_GERMAN_SWISS:62,TWLG_GREEK:63,TWLG_HEBREW:64,TWLG_HUNGARIAN:65,TWLG_ICELANDIC:7,TWLG_INDONESIAN:66,TWLG_ITALIAN:8,TWLG_ITALIAN_SWISS:67,TWLG_JAPANESE:68,TWLG_KOREAN:69,TWLG_KOREAN_JOHAB:70,TWLG_LATVIAN:71,TWLG_LITHUANIAN:72,TWLG_NORWEGIAN:9,TWLG_NORWEGIAN_BOKMAL:73,TWLG_NORWEGIAN_NYNORSK:74,TWLG_POLISH:75,TWLG_PORTUGUESE:10,TWLG_PORTUGUESE_BRAZIL:76,TWLG_ROMANIAN:77,TWLG_RUSSIAN:78,TWLG_SERBIAN_LATIN:79,TWLG_SLOVAK:80,TWLG_SLOVENIAN:81,TWLG_SPANISH:11,TWLG_SPANISH_MEXICAN:82,TWLG_SPANISH_MODERN:83,TWLG_SWEDISH:12,TWLG_THAI:84,TWLG_TURKISH:85,TWLG_UKRANIAN:86,TWLG_ASSAMESE:87,TWLG_BENGALI:88,TWLG_BIHARI:89,TWLG_BODO:90,TWLG_DOGRI:91,TWLG_GUJARATI:92,TWLG_HARYANVI:93,TWLG_HINDI:94,TWLG_KANNADA:95,TWLG_KASHMIRI:96,TWLG_MALAYALAM:97,TWLG_MARATHI:98,TWLG_MARWARI:99,TWLG_MEGHALAYAN:100,TWLG_MIZO:101,TWLG_NAGA:102,TWLG_ORISSI:103,TWLG_PUNJABI:104,TWLG_PUSHTU:105,TWLG_SERBIAN_CYRILLIC:106,TWLG_SIKKIMI:107,TWLG_SWEDISH_FINLAND:108,TWLG_TAMIL:109,TWLG_TELUGU:110,TWLG_TRIPURI:111,TWLG_URDU:112,TWLG_VIETNAMESE:113},_.EnumDWT_CapSupportedSizes={TWSS_NONE:0,TWSS_A4LETTER:1,TWSS_B5LETTER:2,TWSS_USLETTER:3,TWSS_USLEGAL:4,TWSS_A5:5,TWSS_B4:6,TWSS_B6:7,TWSS_USLEDGER:9,TWSS_USEXECUTIVE:10,TWSS_A3:11,TWSS_B3:12,TWSS_A6:13,TWSS_C4:14,TWSS_C5:15,TWSS_C6:16,TWSS_4A0:17,TWSS_2A0:18,TWSS_A0:19,TWSS_A1:20,TWSS_A2:21,TWSS_A4:1,TWSS_A7:22,TWSS_A8:23,TWSS_A9:24,TWSS_A10:25,TWSS_ISOB0:26,TWSS_ISOB1:27,TWSS_ISOB2:28,TWSS_ISOB3:12,TWSS_ISOB4:6,TWSS_ISOB5:29,TWSS_ISOB6:7,TWSS_ISOB7:30,TWSS_ISOB8:31,TWSS_ISOB9:32,TWSS_ISOB10:33,TWSS_JISB0:34,TWSS_JISB1:35,TWSS_JISB2:36,TWSS_JISB3:37,TWSS_JISB4:38,TWSS_JISB5:2,TWSS_JISB6:39,TWSS_JISB7:40,TWSS_JISB8:41,TWSS_JISB9:42,TWSS_JISB10:43,TWSS_C0:44,TWSS_C1:45,TWSS_C2:46,TWSS_C3:47,TWSS_C7:48,TWSS_C8:49,TWSS_C9:50,TWSS_C10:51,TWSS_USSTATEMENT:52,TWSS_BUSINESSCARD:53,TWSS_MAXSIZE:54},_.EnumDWT_CapFeederAlignment={TWFA_NONE:0,TWFA_LEFT:1,TWFA_CENTER:2,TWFA_RIGHT:3},_.EnumDWT_CapFeederOrder={TWFO_FIRSTPAGEFIRST:0,TWFO_LASTPAGEFIRST:1},_.EnumDWT_CapPrinter={TWPR_IMPRINTERTOPBEFORE:0,TWPR_IMPRINTERTOPAFTER:1,TWPR_IMPRINTERBOTTOMBEFORE:2,TWPR_IMPRINTERBOTTOMAFTER:3,TWPR_ENDORSERTOPBEFORE:4,TWPR_ENDORSERTOPAFTER:5,TWPR_ENDORSERBOTTOMBEFORE:6,TWPR_ENDORSERBOTTOMAFTER:7},_.EnumDWT_CapPrinterMode={TWPM_SINGLESTRING:0,TWPM_MULTISTRING:1,TWPM_COMPOUNDSTRING:2},_.EnumDWT_CapBitdepthReduction={TWBR_THRESHOLD:0,TWBR_HALFTONE:1,TWBR_CUSTHALFTONE:2,TWBR_DIFFUSION:3},_.EnumDWT_CapBitOrder={TWBO_LSBFIRST:0,TWBO_MSBFIRST:1},_.EnumDWT_CapFilterType={TWFT_RED:0,TWFT_GREEN:1,TWFT_BLUE:2,TWFT_NONE:3,TWFT_WHITE:4,TWFT_CYAN:5,TWFT_MAGENTA:6,TWFT_YELLOW:7,TWFT_BLACK:8},_.EnumDWT_CapFlash={TWFL_NONE:0,TWFL_OFF:1,TWFL_ON:2,TWFL_AUTO:3,TWFL_REDEYE:4},_.EnumDWT_CapFlipRotation={TWFR_BOOK:0,TWFR_FANFOLD:1},_.EnumDWT_CapImageFilter={TWIF_NONE:0,TWIF_AUTO:1,TWIF_LOWPASS:2,TWIF_BANDPASS:3,TWIF_HIGHPASS:4,TWIF_TEXT:3,TWIF_FINELINE:4},_.EnumDWT_CapLightPath={TWLP_REFLECTIVE:0,TWLP_TRANSMISSIVE:1},_.EnumDWT_CapLightSource={TWLS_RED:0,TWLS_GREEN:1,TWLS_BLUE:2,TWLS_NONE:3,TWLS_WHITE:4,TWLS_UV:5,TWLS_IR:6},_.EnumDWT_MagType={TWMD_MICR:0,TWMD_RAW:1,TWMD_INVALID:2},_.EnumDWT_CapNoiseFilter={TWNF_NONE:0,TWNF_AUTO:1,TWNF_LONEPIXEL:2,TWNF_MAJORITYRULE:3},_.EnumDWT_CapORientation={TWOR_ROT0:0,TWOR_ROT90:1,TWOR_ROT180:2,TWOR_ROT270:3,TWOR_PORTRAIT:0,TWOR_LANDSCAPE:3,TWOR_AUTO:4,TWOR_AUTOTEXT:5,TWOR_AUTOPICTURE:6},_.EnumDWT_CapOverscan={TWOV_NONE:0,TWOV_AUTO:1,TWOV_TOPBOTTOM:2,TWOV_LEFTRIGHT:3,TWOV_ALL:4},_.EnumDWT_CapPixelFlavor={TWPF_CHOCOLATE:0,TWPF_VANILLA:1},_.EnumDWT_CapPlanarChunky={TWPC_CHUNKY:0,TWPC_PLANAR:1},_.EnumDWT_DataSourceStatus={TWDSS_CLOSED:0,TWDSS_OPENED:1,TWDSS_ENABLED:2,TWDSS_ACQUIRING:3};var p=0,v=1,y=2;_.EnumDWT_FitWindowType={enumFitWindow:p,enumFitWindowHeight:v,enumFitWindowWidth:y};var b=-1,I=0,w=1,S=2,T=3,C=4,E=5,M=6,D=7;_.EnumDWT_PlatformType={enumUnknown:b,enumWindow:I,enumMac:w,enumLinux:S,enumEmbed:T,enumChromeOS:C,enumHarmonyOS:E,enumAndroid:M,enumiOS:D},_.EnumDWT_UploadDataFormat={Binary:0,Base64:1};var k=0,x=1,P=2,W=3,L=4,F=5,V=6,N=7,A=8;_.EnumDWT_MouseShape={Default:k,Hand:x,Crosshair:P,Zoom:W,NWResize:L,EResize:F,NResize:V,Resize:N,Move:A},_.EnumDWT_Language={English:0,French:1,Arabic:2,Spanish:3,Portuguese:4,German:5,Italian:6,Russian:7,Chinese:8};var B=1,O=2,R=3,U=4,G=5;_.EnumDWT_InitMsg={Info:B,Error:O,NotInstalledError:R,DownloadError:U,DownloadNotRestartError:G};var j=0,z=3,H=3,X=4,Y=4,J=5;_.EnumDWT_Driver={TWAIN:j,ICA:z,SANE:H,TWAIN_AND_ICA:X,TWAIN_AND_TWAIN64:Y,TWAIN64:J},_.EnumDWT_CompressionType={TWCP_NONE:0,TWCP_PACKBITS:1,TWCP_GROUP31D:2,TWCP_GROUP31DEOL:3,TWCP_GROUP32D:4,TWCP_GROUP4:5,TWCP_JPEG:6,TWCP_LZW:7,TWCP_JBIG:8,TWCP_PNG:9,TWCP_RLE4:10,TWCP_RLE8:11,TWCP_BITFIELDS:12,TWCP_ZIP:13,TWCP_JPEG2000:14};var K=0,Z=1;_.EnumDWT_SelectionMode={Single:K,Multiple:Z},_.EnumDWT_ConfirmExitType={Cancel:0,Exit:1,SaveAndExit:2};var q=0,Q=1,$=2,ee=3;_.EnumDWT_WebsocketReadyState={CONNECTING:q,OPEN:Q,CLOSING:$,CLOSED:ee};var te=16,re=32,ne=64,ie=128,oe=256,ae=512,se=1024,ue=te|re|ne|ie|oe,ce=te|re,le=ae|se;_.EnumDWT_DeviceType={TWAINSCANNER:te,WIATWAINSCANNER:re,TWAINX64SCANNER:ne,ICASCANNER:ie,SANESCANNER:oe,ESCLSCANNER:ae,WIFIDIRECTSCANNER:se};var de=0,he=1,ge=2;_.EnumDWT_ServiceType={Wasm:de,TwainService:he};var fe=1,me=2,_e=4,pe=8,ve=16,ye=32;_.EnumDWT_SourceMatchField={SMF_NAME:fe,SMF_TWAINVERSION:me,SMF_TWAINPROTOCOL:_e,SMF_ICAUUID:pe,SMF_ICAMODULEVERSION:ve,SMF_ICALOCATIONTYPE:ye};var be=0,Ie=2,we=3,Se=4,Te=0,Ce=1,Ee=2;_.EnumDWT_ExtImageInfo={"default":Te,standard:Ce,supported:Ee};var Me=0,De=1,ke=2,xe=3,Pe=4,We=5;function Le(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Fe(e){return Fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fe(e)}function Ve(e){var t=function(e,t){if("object"!==Fe(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(r!==undefined){var n=r.call(e,t||"default");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Fe(t)?t:String(t)}function Ne(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ve(n.key),n)}}function Ae(e,t,r){return t&&Ne(e.prototype,t),r&&Ne(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Be(t){return e.Lib.isString(t)?t:("errorMessage"in t&&(r=t.errorMessage),"message"in t&&(r=t.message),e.Lib.isString(r)||(r="message"in r?r.message:""),"errorCode"in t&&-1==r.indexOf("(")&&(r+="("+t.errorCode+")"),"code"in t&&-1==r.indexOf("(")&&(r+="("+t.code+")"),r);var r}function Oe(e,t,r){e._errorCode=t,e._errorString=r}e.DWT.EnumDWT_Error={UserCancelled:-1032,CommonError:-2201,ModuleNotExists:-2371,FailedToCreateDWTObject:-2607};var Re=function(){function r(){Le(this,r)}return Ae(r,[{key:"OutOfRange",value:function(e){Oe(e,-1010,"Data parameter out of supported range.")}},{key:"InvalidIndex",value:function(e){Oe(e,-1033,"Invalid index.")}},{key:"InvalidValue",value:function(e){Oe(e,-1034,"Invalid value.")}},{key:"NoImage",value:function(e){Oe(e,-1035,"There is no image.")}},{key:"UnrecognizedExt",value:function(e){Oe(e,-1110,"Unrecognized file extension.")}},{key:"LoadTextPDFButSetImageOnly",value:function(e){Oe(e,-1119,"The text-based PDF file was not imported correctly because ConvertMode was set to CM_IMAGEONLY, which means PDF Rasterizer is turned off. Please set ConvertMode to Dynamsoft.DWT.EnumDWT_ConvertMode.CM_AUTO to enable it.")}},{key:"SourceHasNothingToCapture",value:function(e){Oe(e,-1029,"Source has nothing to capture.")}},{key:"bImageOnlyError_NotPurelyPDF",value:function(e){return-1416==e}},{key:"SystemBusy",value:function(e){Oe(e,-2007,"The system is busy, some operations are not completed. Please try later.")}},{key:"MustUpgradeService",value:function(e){Oe(e,-2207,"The Dynamsoft Service installed on your computer is outdated and no longer works with the JavaScript code on the website.")}},{key:"Server_Restarted",value:function(e){Oe(e,-2208,"The connection with the local Dynamsoft Service encountered a problem and has been reset.")}},{key:"HTML5NotSupport",value:function(e){Oe(e,-2209,"The HTML5 edition does not support this method or property.")}},{key:"CannotCallUIMethodWhenNotBindDefaultViewer",value:function(e){Oe(e,-2210,"You cannot call this method on this WebTwain instance because it does not use the default viewer.")}},{key:"HttpServerCannotEmpty",value:function(e){Oe(e,-2300,"Http upload error: the HTTP Server name/ip cannot be empty.")}},{key:"NetworkError",value:function(e){Oe(e,-2301,"Network error.")}},{key:"InvalidResultFormat",value:function(e){Oe(e,-2302,"The result format is invalid.")}},{key:"UploadError",value:function(e,t,r,n){if(t)Oe(e,-2303,"Upload cancelled.");else if(e._errorCode=-2003,n&&n>0||r){var i=["HTTP process error: "];r&&i.push(r),n&&n>0&&i.push(" ("+n+")"),e._errorString=i.join("")+"."}else e._errorString="HTTP process error."}},{key:"HttpDownloadUrlError",value:function(e){Oe(e,-2304,"Http download error: the url is invalid.")}},{key:"HttpDownloadError",value:function(e,t,r,n){if(t)Oe(e,-2305,"User cancelled the operation.");else if(e._errorCode=-2003,n&&n>0||r){var i=["HTTP process error: "];r&&i.push(r),n&&n>0&&i.push(" ("+n+")"),e._errorString=i.join("")+"."}else e._errorString="HTTP process error."}},{key:"UploadFileCannotEmpty",value:function(e){Oe(e,-2306,"Upload Error: the upload file cannot be empty.")}},{key:"InvalidWidthOrHeight",value:function(e){Oe(e,-2307,"The width or height you entered is invalid.")}},{key:"Server_Invalid",value:function(e){0==e._errorCode&&Oe(e,-2308,"The local Dynamsoft Service has been stopped.")}},{key:"InvalidLocalFilename",value:function(e,t){Oe(e,-2309,"The LocalFile is empty in the name "+t+" Function.")}},{key:"BarCode_InvalidIndex",value:function(e,t){Oe(e,-2310,"The index is out of range.")}},{key:"BarCode_InvalidRemoteFilename",value:function(e){Oe(e,-2311,"The RemoteFile field is empty in the Barcode Download Function.")}},{key:"ImageFileLengthCannotZero",value:function(e){Oe(e,-2312,"The file length is empty.")}},{key:"UploadExceededMaxSize",value:function(e){Oe(e,-2313,"The size of the images you are about to upload has exceeded the limit.")}},{key:"ParameterCannotEmpty",value:function(e){Oe(e,-2314,"The parameter cannot be empty.")}},{key:"Webcam_InvalidIndex",value:function(e,t){Oe(e,-2315,"The index is out of range.")}},{key:"Webcam_InvalidRemoteFilename",value:function(e){Oe(e,-2316,"The RemoteFile field is empty in the Webcam Download Function.")}},{key:"Pdf_InvalidRemoteFilename",value:function(e){Oe(e,-2317,"The RemoteFile field is empty in the Pdf Download Function.")}},{key:"InvalidDestination",value:function(e){Oe(e,-2318,"Invalid destination file.")}},{key:"InvalidSourceFile",value:function(e){Oe(e,-2319,"Invalid source file.")}},{key:"InvalidFile",value:function(e){Oe(e,-2320,"Invalid file.")}},{key:"hasLicenseError",value:function(e){return e._errorCode>=-2348&&e._errorCode<=-2325}},{key:"OCR_InvalidIndex",value:function(e,t){Oe(e,-2321,"The index is out of range.")}},{key:"OCR_InvalidLeftOrTopOrRightOrBottom",value:function(e){Oe(e,-2322,"The left or top or right or bottom you entered is invalid.")}},{key:"OCR_InvalidOutputFormat",value:function(e){Oe(e,-2323,"The OCR output format is not supported.")}},{key:"OCR_InvalidPageSetMode",value:function(e){Oe(e,-2324,"The OCR page set mode is not supported.")}},{key:"LicenseEmptyOrInvalid",value:function(t){Oe(t,-2325,e.Lib.License.isLTS()?"The license is invalid.":"The current product key is empty or invalid."),e.Lib.Errors.SetLTSException(t)}},{key:"LicenseExpired",value:function(t,r){t._errorCode=-2326;var n="";if(r&&""!=r&&-1==r.indexOf("on")&&(n=" on "+r),e.Lib.License.isLTS()){var i,o,a,s,u;if(t._isTwainServiceType())if(i=e.DWT.EnumInstance.dwt_desktop,t._bRemoteMode)o=null!==(a=null===(s=t._dmService)||void 0===s||null===(u=s.attrs)||void 0===u?void 0:u.UUID)&&void 0!==a?a:"";else o="";else i=e.DWT.EnumInstance.dwt_browser,o="";t._errorString="The license has expired"+n+".",e.DWT.lcexp(i,o).then((function(){t._errorString=e.DWT.licenseException.message}))}else t._errorString="The current product key has expired"+n+". Please contact the site administrator.",e.Lib.Errors.SetLTSException(t)}},{key:"LicenseNoChrome",value:function(t){Oe(t,-2327,"The current product key does not support Chrome. Please contact the site administrator."),e.Lib.Errors.SetLTSException(t)}},{key:"LicenseNoFirefox",value:function(t){Oe(t,-2328,"The current product key does not support Firefox. Please contact the site administrator."),e.Lib.Errors.SetLTSException(t)}},{key:"LicenseNoIE",value:function(t){Oe(t,-2329,"The current product key does not support IE. Please contact the site administrator."),e.Lib.Errors.SetLTSException(t)}},{key:"LicenseNoEdge",value:function(t){Oe(t,-2330,"The current product key does not support Edge. Please contact the site administrator."),e.Lib.Errors.SetLTSException(t)}},{key:"LicenseNoSafari",value:function(t){Oe(t,-2392,"The current product key does not support Safari. Please contact the site administrator."),e.Lib.Errors.SetLTSException(t)}},{key:"LicenseNoCore",value:function(t,r,i){t._errorCode=-2333,e.Lib.License.isLTS()?t._errorString=r?111==i?"The license for v"+n+" WebAssembly Core Module has expired.":"The license for v"+n+" WebAssembly Core Module is not found.":111==i?"The license for v"+n+" Service Core Module has expired.":"The license for v"+n+" Service Core Module is not found.":t._errorString=r?"The current product key is missing the WebAssembly Core license. Please contact the site administrator.":"The current product key is missing the Service Core license. Please contact the site administrator.",e.Lib.Errors.SetLTSException(t)}},{key:"LicenseNoWebcam",value:function(t){t._errorCode=-2338,e.Lib.License.isLTS()?t._errorString="The license for the module direct show is not found or has expired.":t._errorString="The current product key does not support Webcam. Please contact the site administrator.",e.Lib.Errors.SetLTSException(t)}},{key:"LicenseNoPDF",value:function(t){t._errorCode=-2339,e.Lib.License.isLTS()?t._errorString="The license for the module pdf rasterizer is not found or has expired.":t._errorString="The current product key does not support pdf rasterizer. Please contact the site administrator.",e.Lib.Errors.SetLTSException(t)}},{key:"LicenseNoOCR",value:function(t){t._errorCode=-2340,e.Lib.License.isLTS()?t._errorString="The license for the module ocr is not found or has expired.":t._errorString="The current product key does not support OCR. Please contact the site administrator.",e.Lib.Errors.SetLTSException(t)}},{key:"LicenseNoOCRPro",value:function(t){t._errorCode=-2341,e.Lib.License.isLTS()?t._errorString="The license for the module ocr pro is not found or has expired.":t._errorString="The current product key does not support OCR pro. Please contact the site administrator.",e.Lib.Errors.SetLTSException(t)}},{key:"LicenseBadDomain",value:function(t){Oe(t,-2342,"The domain of your current site does not match the domain bound in the current product key. Please contact the site administrator."),e.Lib.Errors.SetLTSException(t)}},{key:"LicenseNotSupportBorwser",value:function(t){Oe(t,-2343,"The current product key does not support your browser. Please contact the site administrator."),e.Lib.Errors.SetLTSException(t)}},{key:"LicenseNotSupportWindows",value:function(t){Oe(t,-2344,"The current product key does not support Windows OS. Please contact the site administrator."),e.Lib.Errors.SetLTSException(t)}},{key:"LicenseNotSupportMAC",value:function(t){Oe(t,-2345,"The current product key does not support MAC OS. Please contact the site administrator."),e.Lib.Errors.SetLTSException(t)}},{key:"LicenseNotSupportLinux",value:function(t){Oe(t,-2346,"The current product key does not support Linux OS. Please contact the site administrator."),e.Lib.Errors.SetLTSException(t)}},{key:"LicenseNotSupportOS",value:function(t){Oe(t,-2347,"The current product key does not support your OS. Please contact the site administrator."),e.Lib.Errors.SetLTSException(t)}},{key:"LicenseLower",value:function(t){Oe(t,-2348,"The current product key is invalid because it's generated with the licenses of a different major version."),e.Lib.Errors.SetLTSException(t)}},{key:"BarcodeLicenseEmpty",value:function(t){Oe(t,-2349,"The current product key does not include a license for reading barcode. Please contact the site administrator."),e.Lib.Errors.SetLTSException(t)}},{key:"IndicesCannotEmpty",value:function(e){Oe(e,-2350,"The indices cannot be empty.")}},{key:"UploadIndexMoreThanOne",value:function(e){Oe(e,-2351,"You cannot upload more than one image when the format is BMP, JPG or PNG")}},{key:"IndicesOutOfRange",value:function(e){Oe(e,-2352,"The indices are out of range.")}},{key:"HttpHeaderNotAllowed",value:function(e){Oe(e,-2353,"The header name being used is a protected keyword and is not allowed.")}},{key:"HttpHeaderIsEmpty",value:function(e){Oe(e,-2354,"The header name cannot be empty.")}},{key:"HttpHeaderIsNull",value:function(e){Oe(e,-2355,"The header name cannot be null.")}},{key:"HttpHeaderIsUndefined",value:function(e){Oe(e,-2356,"The header name cannot be undefined.")}},{key:"HttpHeaderIsInvalid",value:function(e){Oe(e,-2357,"The header name you entered is invalid.")}},{key:"IndicesNotArray",value:function(e){Oe(e,-2358,"The type of the parameter indices must be an Array.")}},{key:"IndexOutOfRange",value:function(e){Oe(e,-2359,"The index is out of range.")}},{key:"IndexNullOrUndefined",value:function(e){Oe(e,-2360,"The index is null or undefined.")}},{key:"ConvertBase64IndexMoreThanOne",value:function(e){Oe(e,-2361,"You cannot convert more than one image to base64 string when the format is BMP, JPG or PNG.")}},{key:"InvalidImageType",value:function(e){Oe(e,-2362,"The image type is not supported.")}},{key:"InvalidDataFormat",value:function(e){Oe(e,-2363,"The data format is not supported.")}},{key:"InvalidUploadInSegments",value:function(e){Oe(e,-2364,"Please use a Boolean value for the parameter bUploadInSegments.")}},{key:"InvalidUrl",value:function(e){Oe(e,-2365,"The url is invalid.")}},{key:"ConvertBase64Failed",value:function(e){Oe(e,-2366,"Converting images to a base64 string failed.")}},{key:"InvalidSegmentUploadThreshold",value:function(e){Oe(e,-2367,"Invalid value for the parameter segmentUploadThreshold.")}},{key:"InvalidModuleSize",value:function(e){Oe(e,-2368,"Invalid value for the parameter moduleSize.")}},{key:"LicenseNotSupportWasm",value:function(t){Oe(t,-2369,"The current product key is missing the WASM license. Please contact the site administrator."),e.Lib.Errors.SetLTSException(t)}},{key:"LicenseNotSupportPdfRWasm",value:function(t){t._errorCode=-2370,e.Lib.License.isLTS()?t._errorString="The license for the module pdf rasterizer is not found or has expired.":t._errorString="The current product key does not support Pdf Rasterizer Wasm. Please contact the site administrator.",e.Lib.Errors.SetLTSException(t)}},{key:"WebTwainModuleNotExist",value:function(t){Oe(t,e.DWT.EnumDWT_Error.ModuleNotExists,"Dynamic Web TWAIN scanner module is not installed and it is also missing on the server. Please contact the site administrator.")}},{key:"ConvertBinaryIndexMoreThanOne",value:function(e){Oe(e,-2372,"You cannot convert more than one image to binary when the format is BMP, JPG or PNG.")}},{key:"Overlay_InvalidLeftOrTopOrRightOrBottom",value:function(e){Oe(e,-2375,"The left or top or right or bottom you entered is invalid.")}},{key:"GenerateURL_InvalidRetFromServer",value:function(e){Oe(e,-2376,"The generate url failed.")}},{key:"ImageCaptureDriverTypeError",value:function(e){Oe(e,-2377,"Failed to set Image Capture Driver Type.")}},{key:"InvalidTiffTagError",value:function(e){Oe(e,-2378,"Invalid value for the tiff tag code.")}},{key:"OCR_InvalidRemoteFilename",value:function(e){Oe(e,-2379,"The RemoteFile field is empty in the OCR Download Function.")}},{key:"Uploader_ModuleError",value:function(e){Oe(e,-2380,"Please make sure the Uploader Module has been installed.")}},{key:"ScanUploader_InvalidScanSetup",value:function(e){Oe(e,-2381,"scanSetup is invalid.")}},{key:"ScanUploader_InvalidTransferMode",value:function(e){Oe(e,-2382,"Scanner setup error: Invalid Transfer Mode.")}},{key:"ScanUploader_InvalidFileXfer",value:function(e){Oe(e,-2383,"Scanner setup error: fileXfer is invalid.")}},{key:"ScanUploader_InvalidFileXferFilename",value:function(e){Oe(e,-2384,"Scanner setup error: Invalid fileName in fileXfer.")}},{key:"ScanUploader_InvalidFileXferFileFormat",value:function(e){Oe(e,-2385,"Scanner setup error: Invalid fileFormat in fileXfer.")}},{key:"ScanUploader_InvalidHttpParams",value:function(e){Oe(e,-2386,"Output setup error: Invalid httpParams in outputSetup.")}},{key:"ScanUploader_InvalidHttpType",value:function(e){Oe(e,-2387,"Output setup error: Invalid type in outputSetup.")}},{key:"ScanUploader_InvalidHttpUrl",value:function(e){Oe(e,-2388,"Output setup error: Invalid url in outputSetup.httpParams.")}},{key:"ScanUploader_InvalidHttpFilename",value:function(e){Oe(e,-2389,"Output setup error: Invalid fileName in outputSetup.httpParams.")}},{key:"ScanUploader_InvalidOutputFormat",value:function(e){Oe(e,-2390,"Output setup error: Invalid format in outputSetup.")}},{key:"InvalidImageID",value:function(e){Oe(e,-1034,"Invalid image ID.")}},{key:"InvalidEventName",value:function(e){Oe(e,-2391,"Invalid event name.")}},{key:"ConvertBlobIsEmpty",value:function(e){Oe(e,-2393,"Failed to convert the data to blob.")}},{key:"InvalidTagName",value:function(e){Oe(e,-2394,"Invalid tag name.")}},{key:"WebTwainModuleDownloadFailure",value:function(e){Oe(e,-2395,"The module for Dynamic Web TWAIN has failed to download.")}},{key:"LicenseIsFuture",value:function(t,r){Oe(t,-2396,"The current product key is invalid. Please contact the site administrator."),e.Lib.Errors.SetLTSException(t)}},{key:"ServiceNotSupport",value:function(e,t){Oe(e,-2397,t+" doesn't work under current settings.")}},{key:"ScannerNotSupport",value:function(e,t){Oe(e,-2398,t+" is not supported for the current scanner.")}},{key:"MobileNotSupport",value:function(e,t){Oe(e,-2400,t+" doesn't work under current settings.")}},{key:"LoadImageFailed",value:function(e,t){Oe(e,-2401,"Failed to load image: "+Be(t))}},{key:"RotateFailed",value:function(e,t){Oe(e,-2402,"Failed to rotate image: "+Be(t))}},{key:"FlipFailed",value:function(e,t){Oe(e,-2403,"Failed to flip image: "+Be(t))}},{key:"MirrorFailed",value:function(e,t){Oe(e,-2404,"Failed to mirror image: "+Be(t))}},{key:"EraseFailed",value:function(e,t){Oe(e,-2405,"Failed to erase image: "+Be(t))}},{key:"InvertFailed",value:function(e,t){Oe(e,-2406,"Failed to invert image: "+Be(t))}},{key:"SaveImageFailed",value:function(e,t){Oe(e,-2407,"Failed to save image: "+Be(t))}},{key:"ChangeImageSizeFailed",value:function(e,t){Oe(e,-2408,"Failed to change image size: "+Be(t))}},{key:"CropFailed",value:function(e,t){Oe(e,-2409,"Failed to crop image: "+Be(t))}},{key:"SkewAngleFailed",value:function(e,t){Oe(e,-2410,"Failed to skew angle: "+Be(t))}},{key:"ConvertToGrayScaleFailed",value:function(e,t){Oe(e,-2411,"Failed to convert to gray scale: "+Be(t))}},{key:"ConvertToBWScaleFailed",value:function(e,t){Oe(e,-2412,"Failed to convert to black and white scale: "+Be(t))}},{key:"SetDPIFailed",value:function(e,t){Oe(e,-2413,"Failed to set dpi: "+Be(t))}},{key:"SetImageWidthFailed",value:function(e,t){Oe(e,-2414,"Failed to set image width: "+Be(t))}},{key:"GetLicenseInfoFailed",value:function(e,t){Oe(e,-2415,"Failed to get license info: "+Be(t))}},{key:"InvalidParameter",value:function(e){Oe(e,-2416,"Invalid parameter type.")}},{key:"MobileServer_InvalidLeftOrTopOrRightOrBottom",value:function(e){Oe(e,-2417,"The left or top or right or bottom you entered is invalid.")}},{key:"MobileServer_InvalidWidth",value:function(e){Oe(e,-2418,"The width you entered is invalid.")}},{key:"MobileServer_InvalidHeight",value:function(e){Oe(e,-2419,"The height you entered is invalid.")}},{key:"MobileServer_InvalidXResolution",value:function(e){Oe(e,-2420,"The x resolution you entered is invalid.")}},{key:"MobileServer_InvalidYResolution",value:function(e){Oe(e,-2421,"The y resolution you entered is invalid.")}},{key:"MobileServer_InvalidImage",value:function(e){Oe(e,-2422,"The image source is invalid.")}},{key:"MobileServer_InvalidIndex",value:function(e){Oe(e,-2423,"The index is invalid.")}},{key:"GetMD5Failed",value:function(e,t){Oe(e,-2424,"Failed to get MD5: "+Be(t))}},{key:"ConvertFromBase64Failed",value:function(e){Oe(e,-2425,"Converting image from a base64 string failed.")}},{key:"LicenseTrialFullMixed",value:function(e){Oe(e,-2426,"You have used a full license with a trial license which is not permitted. Please check and update Dynamsoft.DWT.ProductKey.")}},{key:"BarcodeReaderError",value:function(e,t){Oe(e,-2427,t)}},{key:"TiffTagCountExceedError",value:function(e){Oe(e,-2428,"Tiff tag count has exceeded the limit.")}},{key:"SelectSourceMustAsync",value:function(e){Oe(e,-2429,"The method SelectSource() must be invoked asynchronously (i.e. with callback functions) when ImageCaptureDriverType is set to TWAIN_AND_ICA or TWAIN_AND_TWAIN64.")}},{key:"HttpLicenseInvalid",value:function(t){Oe(t,-2430,"The current product key is invalid."),e.Lib.Errors.SetLTSException(t)}},{key:"LicenseNotSupportWebcamWasm",value:function(t){t._errorCode=-2431,e.Lib.License.isLTS()?t._errorString="The license for the Camera Addon is not found or has expired.":Oe(t,-2431,"The current product key does not support Camera Addon. Please contact the site administrator."),e.Lib.Errors.SetLTSException(t)}},{key:"InvalidParameterInCallback",value:function(e){Oe(e,-2432,"Invalid parameter.")}},{key:"ActiveXNotSupport",value:function(e){Oe(e,-2433,"The ActiveX edition does not support this method or property.")}},{key:"DetectCallbackErr",value:function(e){e._errorCode=-2434}},{key:"PerspectiveCallback",value:function(e){e._errorCode=-2435}},{key:"HTTPSRequired",value:function(e,t,r){Oe(e,-2436,"Mixed Content: The page at '"+t+"' was loaded over HTTPS, but requested an insecure resource '"+r+"/ddm/18625/ddm/SearchScanner'. This request has been blocked; the content must be served over HTTPS.")}},{key:"webtwain_id_not_string",value:function(){return'Error: The "WebTwainId" is not a string.'}},{key:"container_id_not_string",value:function(){return'Error: The argument you passed to the parameter "conatinerId" is not a string.'}},{key:"container_id_not_exist",value:function(e){return'Error: The element specified by the id "'+e+"\" doesn't exist."}},{key:"StartScanFailed",value:function(e){Oe(e,-2436,"Operation in progress, please try again when the current operation has finished.")}},{key:"ImageEditorOpenCannotPlayVideo",value:function(e){Oe(e,-2437,"The video can not be played while the Image Editor is open.")}},{key:"SelectSourceMustAsyncWhenRemote",value:function(e){Oe(e,-2438,"SelectSource cannot be used synchronously when Object is created by CreateRemoteScanObjectAsync. Please use SelectSourceAsync instead.")}},{key:"CannotBindViewerWhenNoViewerJS",value:function(e){Oe(e,-2439,"You cannot call the method bindViewer() when Dynamsoft.DWT.UseDefaultViewer is set to false.")}},{key:"LTSErrors",value:function(e){Oe(e,-2440,"")}},{key:"LongKeyShortKeyMixed",value:function(e){Oe(e,-2444,"A license can only be specified once and has already been set using the ProductKey API. ")}},{key:"ImageEditorExist",value:function(e){Oe(e,-2500,"An ImageEditor already exists.")}},{key:"ThumbnailViewerExist",value:function(e){Oe(e,-2501,"A ThumbnailViewer already exists.")}},{key:"CustomElementExist",value:function(e){Oe(e,-2502,"A CustomElement already exists.")}},{key:"ImageEditorNotExist",value:function(e){Oe(e,-2503,"This ImageEditor doesn't exist.")}},{key:"ImageEditorDispose",value:function(e){Oe(e,-2504,"The ImageEditor object has been disposed.")}},{key:"ThumbnailViewerNotExist",value:function(e){Oe(e,-2505,"This ThumbnailViewer doesn't exist.")}},{key:"ThumbnailViewerDispose",value:function(e){Oe(e,-2506,"The ThumbnailViewer object has been disposed.")}},{key:"CustomElementNotExist",value:function(e){Oe(e,-2507,"This CustomElement doesn't exist.")}},{key:"CustomElementDispose",value:function(e){Oe(e,-2508,"The CustomElement object has been disposed.")}},{key:"EventNotExist",value:function(e){Oe(e,-2509,"The specified event doesn't exist.")}},{key:"CallbackNotAFunction",value:function(e){Oe(e,-2510,"The callback is not a function.")}},{key:"ElementRequired",value:function(e){Oe(e,-2511,"Parameter 'element' is required.")}},{key:"ElementNotExist",value:function(e){Oe(e,-2512,"Parameter 'element' doesn't exist.")}},{key:"Destroyed",value:function(e){Oe(e,-2513,"The WebTwain instance has been destroyed and can not be used anymore.")}},{key:"InvalidPropertyValue",value:function(e){Oe(e,-2514,"Invalid property value.")}},{key:"HostNotAvailable",value:function(e,t){Oe(e,-2515,"The Dynamsoft Service is not configured correctly on "+t+". Please check.")}},{key:"CameraRequired",value:function(e){Oe(e,-2516,"The camera addon is required.")}},{key:"OldTagNameRequired",value:function(e){Oe(e,-2517,"Old tag name is required.")}},{key:"NewTagNameRequired",value:function(e){Oe(e,-2518,"New tag name is required.")}},{key:"CursorInvalidMode",value:function(e){Oe(e,-2519,"The current mode does not support setting the cursor to zoom-in.")}},{key:"SystemExceptionError",value:function(e,t){Oe(e,-2520,t)}},{key:"ChangeContrastFailed",value:function(e,t){Oe(e,-2521,"Failed to change contrast: "+Be(t))}},{key:"ChangeBrightnessFailed",value:function(e,t){Oe(e,-2522,"Failed to change brightening: "+Be(t))}},{key:"ConvertToGrayScaleFilterCallbackErr",value:function(e,t){Oe(e,-2523,'Failed to apply "gray" filter: '+Be(t))}},{key:"ConvertToBWScaleFilterCallbackErr",value:function(e,t){Oe(e,-2524,'Failed to apply "black and white" filter: '+Be(t))}},{key:"RemoveShadowFilterCallbackErr",value:function(e,t){Oe(e,-2525,'Failed to apply "remove shadow" filter: '+Be(t))}},{key:"EnhanceAndSharpenFilterCallbackErr",value:function(e,t){Oe(e,-2526,'Failed to apply "enhance and sharpen" filter: '+Be(t))}},{key:"BrightenFilterCallbackErr",value:function(e,t){Oe(e,-2527,'Failed to apply "brightening" filter: '+Be(t))}},{key:"SaveTonerCallbackErr",value:function(e,t){Oe(e,-2528,'Failed to apply "save toner" filter: '+Be(t))}},{key:"GetBlurryScoreErr",value:function(e,t){Oe(e,-2529,"Failed to get blurry score: "+Be(t))}},{key:"FileNameCannotEmpty",value:function(e){Oe(e,-2530,"Document name cannot be empty.")}},{key:"FileNameNotString",value:function(e){Oe(e,-2531,"Document name is not a string.")}},{key:"DocumentEditorNotExist",value:function(e){Oe(e,-2532,"This documentEditor doesn't exist.")}},{key:"DocumentEditorDispose",value:function(e){Oe(e,-2533,"The documentEditor object has been disposed.")}},{key:"DocumentEditorExist",value:function(e){Oe(e,-2534,"A documentEditor already exists.")}},{key:"RgbaImageToBlobErr",value:function(e,t){Oe(e,-2535,"Failed to convert image data: "+Be(t))}},{key:"LoadTextPDFButNoPdfrLicenseErr",value:function(e){Oe(e,-2536,"This PDF file is not supported by the Core module. You may need to activate your PDF Rasterizer license to support this PDF file. Please contact support for further information.")}},{key:"WasmNotLoaded",value:function(e){Oe(e,-2537,"The wasm not loaded.")}},{key:"WasmNotLoaded_UseWasmFalse",value:function(e){Oe(e,-2538,"The wasm not loaded when Dynamsoft.DWT.UseCameraAddonWasm is set to false.")}},{key:"LicenseVersionNotCurrent",value:function(t,r){Oe(t,-2539,"The current product key is not for version ".concat(r,". Please contact the site administrator.")),e.Lib.Errors.SetLTSException(t)}},{key:"FileNotExist",value:function(e){Oe(e,-2540,"The document does not exist.")}},{key:"FileExist",value:function(e){Oe(e,-2541,"The document already exists.")}},{key:"LicenseNotSupportMobile",value:function(t){Oe(t,-2542,"The current product key is missing the mobile license. Please contact the site administrator."),e.Lib.Errors.SetLTSException(t)}},{key:"LTSLicenseMixedWithOthers",value:function(e){Oe(e,-2543,'You are using two different generations of Dynamsoft licenses. Please check the "Dynamsoft.DWT.ProductKey" specified in your application.')}},{key:"SelectScannerMustInvokeBeforeOperation",value:function(e){Oe(e,-2544,"The method SelectDeviceAsync() must be invoked before the current operation.")}},{key:"InvalidServerUrl",value:function(e){Oe(e,-2545,"The  proxy server URL is invalid.")}},{key:"FailedParseProductKey",value:function(e){Oe(e,-2546,"The license is invalid.")}},{key:"GetDevicesMustInvokeBeforeAcuireImage",value:function(e){Oe(e,-2547,"The method GetDevicesAsync() must be invoked before the current operation.")}},{key:"WebviewerError",value:function(e,t,r){Oe(e,r||-2600,t)}},{key:"ClearErrorInfo",value:function(e){Oe(e,0,"")}},{key:"SetLTSException",value:function(t){var r=e.DWT.licenseException;r.code=t._errorCode,r.message=t._errorString,r.fromLTS=!1}},{key:"ThrowFailedConnectToRemoteDynamsoftService",value:function(e){var t=e;return t||(t="[]"),{code:-2601,message:"Failed to connect to the Dynamsoft Service on "+t+". Please make sure Dynamsoft Service is running or the certificate is valid."}}},{key:"ThrowInvalidParameterSendTo",value:function(){return{code:-2602,message:'The parameter "SendTo" is invalid.'}}},{key:"ThrowMobileNotSupportOS",value:function(e){return{code:-2603,message:e+" is not supported for your Operating System."}}},{key:"ThrowFailedConnectToProxyServer",value:function(){return{code:-2604,message:"Failed to connect to the Proxy Service. Please make sure the Proxy Service is configured successfully, Dynamsoft Service is running, or the certificate is valid."}}},{key:"ServiceSyncMethodNotSupport",value:function(e,t){Oe(e,-2605,'The synchronized method "'+t+'" is not supported under the current settings.')}},{key:"ServiceAsyncMethodNotSupport",value:function(e,t){Oe(e,-2606,'The asynchronized method "'+t+'" is not supported under the current settings.')}},{key:"ThrowString_FailedToCreateDWTObject",value:function(e){if(e._bRemoteMode){var r,n,i=null===(r=e._dmService)||void 0===r||null===(n=r.attrs)||void 0===n?void 0:n.name;return t.Errors.ThrowFailedConnectToRemoteDynamsoftService(i).message}return"The Dynamsoft Service has been stopped."}},{key:"DeviceNotFound",value:function(e){Oe(e,-2607,"The device selected was not found under the current service object.")}},{key:"RemoteServiceCannotSetShowFileDialog",value:function(e){Oe(e,-2608,"IfShowFileDialog cannot be set to true when Object is created by CreateRemoteScanObjectAsync.")}},{key:"RemoteServiceCannotLoadDibFromClipboard",value:function(e){Oe(e,-2609,"LoadDibFromClipboard is not supported when Object is created by CreateRemoteScanObjectAsync.")}},{key:"OpenSourceMustAsyncWhenRemote",value:function(e){Oe(e,-2610,"OpenSource is not supported when Object is created by CreateRemoteScanObjectAsync. Please use OpenSourceAsync instead.")}},{key:"LicenseNoDbr",value:function(t){Oe(t,-2611,"The license for the Barcode module is invalid."),e.Lib.Errors.SetLTSException(t)}},{key:"ThrowDevicesNotArray",value:function(){return{code:-2612,message:"The devices must be an Array."}}},{key:"DynamsoftServiceStopped",value:function(e){Oe(e,-2613,"The Dynamsoft Service has been stopped.")}},{key:"DynamsoftServiceRestarted",value:function(e){Oe(e,-2614,"The Dynamsoft Service has been restarted.")}},{key:"UserCanceled",value:function(e){Oe(e,-2615,"User cancelled the operation.")}}]),r}();function Ue(e){var t=e.server;return t||(t=h()),e.ssl?["https://",t,":",e.port,"/"].join(""):["http://",t,":",e.port,"/"].join("")}function Ge(e,r,n){var i=e.data;if("object"===Fe(i))return i=null,e=null,void(n&&n());var o=i.replace(/\0/g,"");try{r&&r(o)}catch(a){t.log(i),n&&n()}i=null,e=null}function je(e,r){e&&e.readyState!=$&&e.readyState!=ee?e.readyState==q?(e.onerror=function(r){r&&t.log("websocket error: "+r),e._reject&&(e._reject(),e._reject=null),e.close()},e.onclose=function(t){e.onclose=null,e.onerror=null,e.onmessage=null,e.onopen=null,e._reject=null},e.onopen=function(){e.readyState==Q?(e.onopen=null,e.send(r)):e.readyState==q&&(e.onopen?setTimeout(e.onopen,100):e._reject&&(e._reject(),e._reject=null))}):e.readyState==Q&&(e.onopen=null,e.send(r)):e._reject&&(e._reject(),e._reject=null)}function ze(t,r,n){var i=n;return i||(i=e.navInfoSync.bSSL?"https://":"http://"),[i,t,":",r,"/"].join("")}t.Errors=new Re;var He=function(){function r(){Le(this,r)}return Ae(r,null,[{key:"postStringDataByWS",value:function(e,r){return new t.Promise((function(t,n){e.onmessage=function(r){Ge(r,(function(r){t(r),e.close(),e=null}),(function(){n(),e.close(),e=null}))},e._reject=n,je(e,r)}))}},{key:"postStringDataByWSUrl",value:function(n,i){var o=new t.Promise((function(e,t){var o=r.newWebsocket(n,!1);o.onmessage=function(r){Ge(r,(function(t){e(t),o.close(),o=null}),(function(){t(),o.close(),o=null}))},o._reject=t,je(o,i)}));return e.navInfoSync.bEdge&&o["catch"]((function(){return new t.Promise((function(e,t){var o=r.newWebsocket(n,!0);o.onmessage=function(r){Ge(r,(function(t){e(t),o.close(),o=null}),(function(){t(),o.close(),o=null}))},o._reject=t,je(o,i)}))})),o}},{key:"newWebsocket",value:function(t,r){var n,i=e.dcp.wsProtocol,o=window.MozWebSocket;if(void 0!==o)n=i?new o(t,i):new o(t);else{var a=window.WebSocket;if(r){var s=window,u=parent;try{for(;s!=u&&u.WebSocket;)a=u.WebSocket,s=u.window,u=u.parent}catch(c){a=window.WebSocket}}n=i?new a(t,i):new a(t)}return n}},{key:"getWsUrl",value:function(t,r,n){var i=n;return i===undefined&&(i=e.navInfoSync.bSSL),ze(t,r,i?"wss://":"ws://")}},{key:"getDDMUrl",value:function(e,r,n){var i,o,a="/";return t.startsWith(e,"https://")?i=!0:t.startsWith(e,"http://")?i=!1:e=(i=t.detect.ssl)?"https://"+e:"http://"+e,o=i?"18626/":"18625/",t.endsWith(e,"/")&&(a=""),r?[e,a,"ddm/",o,n].join(""):[e,a,n].join("")}},{key:"getModuleUrl",value:function(t){var r,n=e.dcp;return r=ze(h(),e.navInfoSync.bSSL?n.SSLPort:n.Port),t?r+t:r}}]),r}();e.DWT.NetManager=He;var Xe=Ae((function Uh(e,t,r,n,i){Le(this,Uh),this.server=e,this.port=t,this.ssl=r,this.useWS=n,this.protocol=i}));function Ye(e,t,r){return(t=Ve(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Je(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,i)}function Ke(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){Je(o,n,i,a,s,"next",e)}function s(e){Je(o,n,i,a,s,"throw",e)}a(undefined)}))}}function Ze(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qe(e,t){return qe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},qe(e,t)}function Qe(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qe(e,t)}function $e(e,t){if(t&&("object"===Fe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ze(e)}function et(e){return et=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},et(e)}var tt={exports:{}},rt={exports:{}};!function(e){function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports["default"]=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports["default"]=e.exports}(rt),function(e){var t=rt.exports["default"];function r(){e.exports=r=function(){return n},e.exports.__esModule=!0,e.exports["default"]=e.exports;var n={},i=Object.prototype,o=i.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},u=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function d(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(P){d=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var i=t&&t.prototype instanceof m?t:m,o=Object.create(i.prototype),s=new D(n||[]);return a(o,"_invoke",{value:T(e,r,s)}),o}function g(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(P){return{type:"throw",arg:P}}}n.wrap=h;var f={};function m(){}function _(){}function p(){}var v={};d(v,u,(function(){return this}));var y=Object.getPrototypeOf,b=y&&y(y(k([])));b&&b!==i&&o.call(b,u)&&(v=b);var I=p.prototype=m.prototype=Object.create(v);function w(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,r){function n(i,a,s,u){var c=g(e[i],e,a);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==t(d)&&o.call(d,"__await")?r.resolve(d.__await).then((function(e){n("next",e,s,u)}),(function(e){n("throw",e,s,u)})):r.resolve(d).then((function(e){l.value=e,s(l)}),(function(e){return n("throw",e,s,u)}))}u(c.arg)}var i;a(this,"_invoke",{value:function(e,t){function o(){return new r((function(r,i){n(e,t,r,i)}))}return i=i?i.then(o,o):o()}})}function T(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return x()}for(r.method=i,r.arg=o;;){var a=r.delegate;if(a){var s=C(a,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=g(e,t,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function C(e,t){var r=t.method,n=e.iterator[r];if(undefined===n)return t.delegate=null,"throw"===r&&e.iterator["return"]&&(t.method="return",t.arg=undefined,C(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var i=g(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,f;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=undefined),t.delegate=null,f):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function M(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function k(e){if(e){var t=e[u];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function t(){for(;++r<e.length;)if(o.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=undefined,t.done=!0,t};return n.next=n}}return{next:x}}function x(){return{value:undefined,done:!0}}return _.prototype=p,a(I,"constructor",{value:p,configurable:!0}),a(p,"constructor",{value:_,configurable:!0}),_.displayName=d(p,l,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,d(e,l,"GeneratorFunction")),e.prototype=Object.create(I),e},n.awrap=function(e){return{__await:e}},w(S.prototype),d(S.prototype,c,(function(){return this})),n.AsyncIterator=S,n.async=function(e,t,r,i,o){void 0===o&&(o=Promise);var a=new S(h(e,t,r,i),o);return n.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},w(I),d(I,l,"Generator"),d(I,u,(function(){return this})),d(I,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function i(){for(;r.length;){var e=r.pop();if(e in t)return i.value=e,i.done=!1,i}return i.done=!0,i}},n.values=k,D.prototype={constructor:D,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=undefined,this.done=!1,this.delegate=null,this.method="next",this.arg=undefined,this.tryEntries.forEach(M),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=undefined)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=undefined),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=o.call(i,"catchLoc"),u=o.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),M(r),f}},"catch":function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;M(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:k(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=undefined),f}},n}e.exports=r,e.exports.__esModule=!0,e.exports["default"]=e.exports}(tt);var nt=tt.exports(),it=nt;try{regeneratorRuntime=nt}catch(Rh){"object"==typeof globalThis?globalThis.regeneratorRuntime=nt:Function("r","regeneratorRuntime = r")(nt)}var ot=0,at=-1,st=-4201,ut=-5001,ct=-5002,lt=-5003,dt=-5004,ht="The Web Socket connection failed.",gt="The input is not a JSON object or JSON styled string.",ft="The object has been disposed.",mt="The task is invalid.",_t="The object need to be disposed.",pt=function(){function e(){Le(this,e)}return Ae(e,null,[{key:"message",value:function(e){return this._errorMessage[e]}},{key:"init",value:function(){this._errorMessage[ot]="Successful.",this._errorMessage[st]=ht,this._errorMessage[ut]=gt,this._errorMessage[ct]=ft,this._errorMessage[lt]=mt,this._errorMessage[dt]=_t}}]),e}();Ye(pt,"_errorMessage",Object.create(null)),pt.init();var vt,yt=function(){function e(t,r){Le(this,e),Ye(this,"_code",ot),this.name="DSError",this.message=null!=r?r:"string"==typeof t?t:pt.message(t),this._code="string"==typeof t?at:t}return Ae(e,[{key:"code",get:function(){return this._code}}]),e}();function bt(e){return{code:e._errorCode,message:e._errorString}}!function(e){e[e.NONE=0]="NONE",e[e.TRACE=1]="TRACE",e[e.DEBUG=2]="DEBUG",e[e.INFO=4]="INFO",e[e.WARN=8]="WARN",e[e.ERROR=16]="ERROR"}(vt||(vt={}));var It=t.getLogger(),wt=function(){function e(){Le(this,e)}return Ae(e,null,[{key:"LogLevel",get:function(){return this._logLevel},set:function(e){this._logLevel=e}},{key:"LogFunc",set:function(e){this._logFunc=e}},{key:"all",value:function(e,t){if((this._logLevel&e)==e)if(this._logFunc)this._logFunc(t,e);else switch(e){case vt.DEBUG:It.debug(t);break;case vt.ERROR:It.error(t);break;case vt.INFO:It.info(t);break;case vt.WARN:It.warn(t);break;case vt.TRACE:It.trace(t)}}},{key:"trace",value:function(e){this.all(vt.TRACE,e)}},{key:"debug",value:function(e){this.all(vt.DEBUG,e)}},{key:"info",value:function(e){this.all(vt.INFO,e)}},{key:"warn",value:function(e){this.all(vt.WARN,e)}},{key:"error",value:function(e){this.all(vt.ERROR,e)}}]),e}();Ye(wt,"_logLevel",vt.ERROR),Ye(wt,"_logFunc",undefined);var St=0,Tt=1,Ct=2,Et=3,Mt=4,Dt=5,kt=6,xt=function(){function e(t){Le(this,e),Ye(this,"_serverInfo",undefined),Ye(this,"_disposed",!1),this._serverInfo=t,this._ref=1}var t,r;return Ae(e,[{key:"serverInfo",get:function(){return this._serverInfo}},{key:"requestSync",value:function(e,t){return wt.error("requestSync should be implemented in child class"),undefined}},{key:"request",value:function(){var e=Ke(it.mark((function t(e,r,n,i){return it.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return wt.error("request should be implemented in child class"),e.abrupt("return",Promise.resolve(null));case 2:case"end":return e.stop()}}),t)})));return function(t,r,n,i){return e.apply(this,arguments)}}()},{key:"send",value:(r=Ke(it.mark((function n(e,t,r){return it.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:wt.error("reqsenduestSync should be implemented in child class");case 1:case"end":return e.stop()}}),n)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"testConnection",value:(t=Ke(it.mark((function i(e,t,r,n){return it.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return wt.error("testConnection should be implemented in child class"),e.abrupt("return",Promise.resolve(undefined));case 2:case"end":return e.stop()}}),i)}))),function(e,r,n,i){return t.apply(this,arguments)})},{key:"disposed",get:function(){return this._disposed}},{key:"dispose",value:function(){if(this._ref--,this._ref>0)return!1;this._disposed=!0,this._terminate()}},{key:"_terminate",value:function(){}},{key:"addRef",value:function(){this._ref++}}]),e}();function Pt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(es){return!1}}();return function(){var r,n=et(e);if(t){var i=et(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return $e(this,r)}}function Wt(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function Lt(e,t,r){if(!t.has(e));return r}var Ft=t.getLogger(),Vt=t.fetch,Nt=new WeakSet,At=new WeakSet,Bt=function(e){Qe(o,e);var t,r,n,i=Pt(o);function o(){var e;Le(this,o);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Wt(Ze(e=i.call.apply(i,[this].concat(r))),At),Wt(Ze(e),Nt),e}return Ae(o,[{key:"send",value:(n=Ke(it.mark((function a(e,t,r){return it.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ft.error("HTTP Client send not supported");case 1:case"end":return e.stop()}}),a)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"requestSync",value:function(e,t,r){return undefined}},{key:"request",value:(r=Ke(it.mark((function s(e,t,r,n){return it.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",Lt(this,At,Rt).call(this,e,t,r,undefined,undefined,n));case 1:case"end":return i.stop()}}),s,this)}))),function(e,t,n,i){return r.apply(this,arguments)})},{key:"testConnection",value:(t=Ke(it.mark((function u(e,t,r,n){return it.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",Lt(this,At,Rt).call(this,undefined,undefined,e,t,r,n));case 1:case"end":return i.stop()}}),u,this)}))),function(e,r,n,i){return t.apply(this,arguments)})}]),o}(xt);function Ot(e){var r=this.serverInfo,n="";return n=r.ssl?"https://":"http://",n+=r.server,r.port&&(n+=":",n+=r.port),e&&(t.startsWith(e,"/")||t.endsWith(n,"/")||(n+="/"),t.endsWith(e,"/")?n+=e.slice(0,-1):n+=e),n}function Rt(e,t,r,n,i,o){return Ut.apply(this,arguments)}function Ut(){return(Ut=Ke(it.mark((function e(t,r,n,i,o,a){var s,u,c;return it.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=null!=n?n:{},t&&(s.body=t),s.method||(s.method="POST"),a&&(s.timeout=a),u=Lt(this,Nt,Ot).call(this,r),Ft.debug("HTTP URL: "+u),e.next=9,Vt(u,s,i,o);case 9:return c=e.sent,e.abrupt("return",Promise.resolve(c));case 13:if(e.prev=13,e.t0=e["catch"](0),!(e.t0 instanceof yt)){e.next=19;break}throw e.t0;case 19:throw new yt(e.t0.message);case 20:case"end":return e.stop()}}),e,this,[[0,13]])})))).apply(this,arguments)}function Gt(e){try{return"object"===Fe(e)?e:(e="string"!=typeof e?t.stringify(e):e,t.parse(e))}catch(r){throw r instanceof yt?r:new yt(ut)}}function jt(e){return Math.random().toString(16).substring(2,2+e)}function zt(e){var t=[jt(8),"-",jt(4),"-",jt(4),"-",jt(4),"-",jt(8)];return e&&t.unshift(e),t.join("")}function Ht(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(es){return!1}}();return function(){var r,n=et(e);if(t){var i=et(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return $e(this,r)}}function Xt(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function Yt(e,t,r){if(!t.has(e));return r}var Jt,Kt=t.getLogger(),Zt=new WeakSet,qt=new WeakSet,Qt=new WeakSet,$t=new WeakSet,er=new WeakSet,tr=new WeakSet,rr=new WeakSet,nr=function(e){Qe(s,e);var r,n,i,o,a=Ht(s);function s(e){var t;return Le(this,s),Xt(Ze(t=a.call(this,e)),rr),Xt(Ze(t),tr),Xt(Ze(t),er),Xt(Ze(t),$t),Xt(Ze(t),Qt),Xt(Ze(t),qt),Xt(Ze(t),Zt),Ye(Ze(t),"_defaultRetries",1),Ye(Ze(t),"_ws",Jt),Ye(Ze(t),"_events",{}),Ye(Ze(t),"_bHeartBeatStarted",!1),Ye(Ze(t),"_heartBeatTicks",6e4),t._ws=Jt,t.bUseParentWS=!1,t._tasks=Object.create(null),t}return Ae(s,[{key:"ws",get:function(){return this._ws}},{key:"requestSync",value:function(e,t,r){return Kt.error("WebSocket Client requestSync not supported"),undefined}},{key:"send",value:(o=Ke(it.mark((function u(e,t,r){var n,i,o,a,s;return it.wrap((function(u){for(;;)switch(u.prev=u.next){case 0:if(n=r.client,u.prev=1,(i=r.taskId)!==undefined){u.next=7;break}return u.next=6,t(e,St,n._requestTaskId,r);case 6:i=u.sent;case 7:if(o=n._tasks[i]){u.next=11;break}throw Kt.error("invalid task id: "+i),new yt(lt);case 11:return u.next=13,Yt(n,er,lr).call(n,!1);case 13:return u.next=15,Yt(n,tr,hr).call(n,e,t,r,o);case 15:Kt.debug("begin to send data "+i),n.disposed||n._ws.send(e),e=null,Kt.debug("end to send data "+i),u.next=27;break;case 21:u.prev=21,u.t0=u["catch"](1),Kt.debug("failed to send data."),Kt.error(u.t0),delete n._tasks[i],null===(a=o)||void 0===a||null===(s=a.resolver)||void 0===s||s.reject(u.t0.message);case 27:case"end":return u.stop()}}),u,null,[[1,21]])}))),function(e,t,r){return o.apply(this,arguments)})},{key:"request",value:(i=Ke(it.mark((function c(e,t,r,n){var i,o,a;return it.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return i=this._defaultRetries,o=null!=t?t:Yt(this,$t,ur),a=null!=r?r:{client:this,userData:this},s.abrupt("return",Yt(this,rr,fr).call(this,e,o,a,i,!1,undefined,n));case 2:case"end":return s.stop()}}),c,this)}))),function(e,t,r,n){return i.apply(this,arguments)})},{key:"connected",get:function(){var e;return(null===(e=this._ws)||void 0===e?void 0:e.readyState)==WebSocket.OPEN}},{key:"startHeartBeat",value:function(){var e=this;e._bHeartBeatStarted||(e._bHeartBeatStarted=!0,setTimeout((function(){e._innerSendHeartBeat()}),e._heartBeatTicks))}},{key:"_innerSendHeartBeat",value:(n=Ke(it.mark((function l(){var e,t,r,n,i;return it.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return e=this,t={client:null,userData:null,taskId:"0",eventTaskId:"0",lastEventTaskId:"0"},r=new ArrayBuffer(14),(n=new DataView(r)).setUint8(0,2),n.setUint8(8,2),n.setUint8(12,123),n.setUint8(13,125),i=new Blob([r]),o.prev=9,o.next=12,Yt(e,rr,fr).call(e,i,null,t,0,!0);case 12:o.next=16;break;case 14:o.prev=14,o.t0=o["catch"](9);case 16:e.connected&&setTimeout((function(){e._innerSendHeartBeat()}),e._heartBeatTicks);case 17:case"end":return o.stop()}}),l,this,[[9,14]])}))),function(){return n.apply(this,arguments)})},{key:"testConnection",value:function(e,t,r,n){return Yt(this,er,lr).call(this,!0,null!=t?t:0,r,n)}},{key:"_terminate",value:(r=Ke(it.mark((function d(){var e;return it.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e in Kt.debug("terminate WSClient"),this.fireEvent("disposed"),this._tasks)this._tasks[e]!==undefined&&this._tasks[e].resolver&&this._tasks[e].resolver.reject(new yt(dt));this._lic_callback=Jt,this._blob_callback=Jt,this._ws&&(this._ws.close(),this._ws.onopen=null,this._ws.onerror=null,this._ws.onmessage=null,this._ws.onclose=null),this._ws=Jt,this._tasks=Object.create(null);case 8:case"end":return t.stop()}}),d,this)}))),function(){return r.apply(this,arguments)})},{key:"setRetry",value:function(e){this._defaultRetries=null!=e?e:1}},{key:"addEvent",value:function(e,r,n){var i=this._events[e];i||(this._events[e]={},i=this._events[e]),t.isString(r)&&t.isFunction(n)&&(i[r]=n)}},{key:"removeEvent",value:function(e,r){var n=this._events[e];n&&t.isString(r)&&delete n[r]}},{key:"clearEvent",value:function(e){this._events[e]&&(this._events[e]={})}},{key:"fireEvent",value:function(e){var r,n=this._events[e];if(n){var i=Object.keys(n);for(r=0;r<i.length;r++)t.isFunction(n[i[r]])&&n[i[r]]()}}},{key:"getRequestTaskId",value:function(){return this._requestTaskId?this._requestTaskId:0}}]),s}(xt);function ir(e){var t="";return t=e.ssl?"wss://":"ws://",t+=e.server,e.port&&(t+=":",t+=e.port),t}function or(e,r,n,i){var o=this;return new t.Promise((function(t,a){try{var s,u;if(i&&(u=setTimeout((function(){s.close();var e=new yt("createWebSocket timed out.");Kt.debug(e.message),a(e)}),i)),e.bUseParentWS){var c=window,l=parent,d=c.WebSocket;try{for(;c!=l&&l&&l.WebSocket;)d=l.WebSocket,c=l.window,l=l.parent}catch(h){d=window.WebSocket}s=n?new d(r,n):new d(r)}else s=n?new WebSocket(r,n):new WebSocket(r);s.onopen=function(){u&&clearTimeout(u),e._ws=s,t(s)},s.onerror=function(e){s.close(),u&&clearTimeout(u),o.fireEvent("error"),a(e)},s.onmessage=function(t){Yt(e,Qt,ar).call(e,e,t.data)},s.onclose=function(e){u&&clearTimeout(u),o.fireEvent("close"),a(e)}}catch(g){throw g instanceof yt?g:new yt(g.message)}}))}function ar(e,t){return sr.apply(this,arguments)}function sr(){return(sr=Ke(it.mark((function e(t,r){var n,i,o,a,s,u,c,l,d;return it.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t,e.prev=1,a={client:n,userData:undefined},"object"===Fe(r)&&n._blob_callback&&n._blob_callback(r),n._cbToGetTaskId){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,n._cbToGetTaskId(r,Ct,n._requestTaskId,a);case 8:return s=e.sent,u=!1,e.next=12,n._cbToGetTaskId(s,Et,n._requestTaskId,a);case 12:if(o=e.sent){e.next=21;break}if(!s.Detail||!s.Domain){e.next=17;break}return n._lic_callback&&n._lic_callback(s),e.abrupt("return");case 17:return e.next=19,n._cbToGetTaskId(s,Mt,n._requestTaskId,a);case 19:(o=e.sent)&&(u=!0);case 21:if(i=n._tasks[o]){e.next=31;break}if(!u){e.next=27;break}i={},e.next=29;break;case 27:return""!=o&&Kt.log("invalid task id: "+o),e.abrupt("return");case 29:e.next=33;break;case 31:if(!i.timedout){e.next=33;break}return e.abrupt("return");case 33:return e.next=35,n._cbToGetTaskId(r,Dt,n._requestTaskId,i.ctx);case 35:if((c=e.sent)!==undefined){e.next=40;break}return e.next=39,n._cbToGetTaskId(s,kt,n._requestTaskId,i.ctx);case 39:c=e.sent;case 40:c&&!u&&(i.tmid&&clearTimeout(i.tmid),delete n._tasks[o],i.resolver&&i.resolver.resolve(c)),e.next=49;break;case 43:e.prev=43,e.t0=e["catch"](1),Kt.debug("failed to handle message."),Kt.error(e.t0),delete n._tasks[o],null===(l=i)||void 0===l||null===(d=l.resolver)||void 0===d||d.reject(e.t0.message);case 49:case"end":return e.stop()}}),e,null,[[1,43]])})))).apply(this,arguments)}function ur(e,t,r){return cr.apply(this,arguments)}function cr(){return(cr=Ke(it.mark((function e(t,r,n){var i,o;return it.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=r,e.next=e.t0===St?3:e.t0===Dt?7:9;break;case 3:return(o=Gt(t)).cmdId=null!==(i=o.cmdId)&&void 0!==i?i:zt(),Promise.resolve(["cmdId"]),e.abrupt("break",9);case 7:return Promise.resolve(t),e.abrupt("break",9);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function lr(e,t,r,n){return dr.apply(this,arguments)}function dr(){return(dr=Ke(it.mark((function e(r,n,i,o){var a,s,u,c;return it.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.connected&&!this.disposed){e.next=2;break}return e.abrupt("return");case 2:if(!(u=this)._connectPromise){e.next=7;break}return e.next=6,u._connectPromise;case 6:return e.abrupt("return");case 7:return n=null!==(a=n)&&void 0!==a?a:this._defaultRetries,i=null!==(s=i)&&void 0!==s?s:100,c=Yt(u,Zt,ir).call(u,u.serverInfo),Kt.debug("WebSocket URL: "+c),Kt.debug("try to create websocket "+n+"--"+i),u._connectPromise=new t.Promise((function(e,t){var r=function(r){Yt(u,qt,or).call(u,u,c,u.serverInfo.protocol,o).then((function(t){e(t)}))["catch"]((function(e){Kt.debug("create websocket failed: "+e.message),r<n?a(r):t(e)}))};function a(e,t,n){setTimeout((function(){r(++e)}),i)}r(0)})),e.prev=13,e.next=16,u._connectPromise;case 16:e.next=21;break;case 18:throw e.prev=18,e.t0=e["catch"](13),e.t0;case 21:return e.prev=21,u._connectPromise=null,e.finish(21);case 24:case"end":return e.stop()}}),e,this,[[13,18,21,24]])})))).apply(this,arguments)}function hr(e,t,r,n){return gr.apply(this,arguments)}function gr(){return(gr=Ke(it.mark((function e(t,r,n,i){var o,a,s,u;return it.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this,a=n.eventTaskId,s=n.lastEventTaskId,a!==undefined){e.next=7;break}return e.next=6,r(t,Tt,o._requestTaskId,n);case 6:a=e.sent;case 7:a&&(o._tasks[a]?n&&n.userData&&n.userData.command&&((u=o._tasks[a]).ctx=n,s&&((u=o._tasks[s]).ctx=n)):(u={id:i.id,resolver:null,ctx:n,timedout:!1},o._tasks[a]=u,s&&(o._tasks[s]=u)));case 8:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function fr(e,t,r,n,i,o,a){return mr.apply(this,arguments)}function mr(){return(mr=Ke(it.mark((function e(r,n,i,o,a,s,u){var c,l,d,h;return it.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=this,e.prev=1,i.client=c,e.next=5,Yt(c,er,lr).call(c,a,o,s,u);case 5:if("0"!=(l=i.taskId)){e.next=12;break}return c.disposed||c._ws.send(r),r=null,e.abrupt("return");case 12:if(l!==undefined){e.next=16;break}return e.next=15,n(r,St,null,i);case 15:l=e.sent;case 16:return l===undefined&&Kt.debug("websocket send: task id is invalid."),(d={}).promise=new t.Promise((function(e,t){d.resolve=e,d.reject=t})),h={id:l,resolver:d,ctx:i,timedout:!1},c._tasks[l]=h,c._requestTaskId=l,e.next=24,Yt(c,tr,hr).call(c,r,n,i,h);case 24:return c._cbToGetTaskId=n,u&&(h.tmid=setTimeout((function(){Kt.debug("ws request time out."),h.timedout=!0,h.resolver.reject("request timed out.")}),u)),c.disposed||c._ws.send(r),Kt.debug("end to send task "+l),r=null,e.abrupt("return",d.promise);case 32:if(e.prev=32,e.t0=e["catch"](1),l&&delete c._tasks[l],!(e.t0 instanceof yt)){e.next=39;break}throw e.t0;case 39:throw new yt(e.t0.message);case 40:return e.prev=40,r=null,e.finish(40);case 43:case"end":return e.stop()}}),e,this,[[1,32,40,43]])})))).apply(this,arguments)}function _r(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return pr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pr(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r["return"]||r["return"]()}finally{if(s)throw o}}}}function pr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vr(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function yr(e,t,r){if(!t.has(e));return r}var br=new WeakSet,Ir=new WeakSet,wr=function(){function e(){Le(this,e),vr(this,Ir),vr(this,br),Ye(this,"_maxWebSocketCon",10),Ye(this,"_wsClients",[])}return Ae(e,[{key:"removeTerminatedWSClient",value:function(){this._wsClients=this._wsClients.filter((function(e){return!e.disposed}))}},{key:"getClient",value:function(e){return e.useWS?yr(this,Ir,Tr).call(this,e):new Bt(e)}},{key:"terminate",value:function(){var e=this._wsClients.slice();this._wsClients=[],e.forEach((function(e){e.dispose()}))}}],[{key:"Instance",get:function(){return this._gClientPool||(this._gClientPool=new e),this._gClientPool}}]),e}();function Sr(e){this.removeTerminatedWSClient();var t,r,n,i=_r(this._wsClients);try{for(i.s();!(t=i.n()).done;){var o=t.value;if(r=o.serverInfo,n=e,(null==r?void 0:r.port)==(null==n?void 0:n.port)&&(null==r?void 0:r.protocol)==(null==n?void 0:n.protocol)&&(null==r?void 0:r.server)==(null==n?void 0:n.server)&&(null==r?void 0:r.ssl)==(null==n?void 0:n.ssl)&&(null==r?void 0:r.useWS)==(null==n?void 0:n.useWS)&&!o.disposed)return o.addRef(),o}}catch(a){i.e(a)}finally{i.f()}return null}function Tr(e){var t=yr(this,br,Sr).call(this,e);return t||(this._wsClients.length<this._maxWebSocketCon?((t=new nr(e)).addEvent("disposed","1",(function(){wr.Instance.removeTerminatedWSClient()})),this._wsClients.push(t),t):null)}Ye(wr,"_gClientPool",null);var Cr=function(){function r(){Le(this,r)}return Ae(r,null,[{key:"getHttpClientForDcp",value:function(n,i){var o,a=e.dcp,s=t.detect.ssl;if(i||!e.navInfoSync.bSSL?(o=a.Port,s=!1):(o=a.SSLPort,s=!0),n){var u=new Xe;return t.startsWith(n,"https://")?(u.ssl=!0,u.server=n.substring(8)):t.startsWith(n,"http://")?(u.ssl=!1,u.server=n.substring(7)):(u.ssl=t.detect.ssl,u.server=n),wr.Instance.getClient(u)}return r.getHttpClient(null,o,s)}},{key:"getHttpClient",value:function(e,t,r){var n=r?"https":"http",i=new Xe(e||h(),t,r,!1,n);return wr.Instance.getClient(i)}},{key:"getWsClient",value:function(t,r,n){var i=new Xe(t||h(),r,n,!0,e.dcp.wsProtocol);return wr.Instance.getClient(i)}}]),r}();t.ClientPool=wr;var Er,Mr=3e3,Dr=parseInt(n),kr=parseInt(i),xr=parseInt("0"),Pr=o,Wr=o,Lr=20220801,Fr=function(){if(e.dcp){var r=e.dcp.dcpJSVer;if(t.isNumber(r))return r>=Lr}return!1};if(Fr())Fr=Er,Lr=Er;else{var Vr,Nr=t.win,Ar={dcpStatus:0,dwtPort:0,bConnected:!1,connectedResult:"",IMAXCONNECTCOUNT:5,EnumDCP_DetectStatus:{Init:0,Connected:1,DownloadingZip:2,DownloadedZip:3,DownloadFailed:4,CheckingManagerVer:15,CheckingServiceVer:16,NotInstalled:17,CheckedService:5,VerifyingZip:6,VerifiedZip:7,UpdatingService:8,UpdateSucceed:9,UpdateFailed:10,UpdateSkipped:11}};e.dcp=Vr={SSLPort:18626,Port:18625,bEnhancedMode:!1,dcpJSVer:Lr,oldDWASMVerStr:"dwasm_13000404",oldDWASMVer:[13,0,0,"0404"],wsProtocol:"dwt_command",managerVersion:[Dr,kr,xr,Pr],managerVersionMac:[Dr,kr,xr,Pr],managerVersionLinux:[Dr,kr,xr,Pr],serviceVersion:[1,7,3,Wr],serviceVersionMac:[1,7,3,Wr],serviceVersionLinux:[1,7,3,Wr],detect:Ar,strSID:"",b64bit:!0,getManagerVersion:function(){var t=e.navInfoSync;if(t.bWin);else{if(t.bMac)return Vr.managerVersionMac;if(t.bLinux)return Vr.managerVersionLinux}return Vr.managerVersion},getServiceVersion:function(){var t=e.navInfoSync;if(t.bWin);else{if(t.bMac)return Vr.serviceVersionMac;if(t.bLinux)return Vr.serviceVersionLinux}return Vr.serviceVersion},_checkManagerVersion:function(e,t,r){Ar.dcpStatus=Ar.EnumDCP_DetectStatus.CheckingManagerVer,this._postBase("VersionInfo",!1,e,t,r)},_checkService:function(e,t){Ar.dcpStatus=Ar.EnumDCP_DetectStatus.CheckingServiceVer,this._postBase("DSVersion",!1,Er,e,t)},_checkUpdateFile:function(e,t){this._postBase("CheckUpdateFile",!1,Er,e,t)},_updateService:function(e,t){this._postBase("UpdateService",!1,Er,e,t)},_postBase:function(e,r,n,i,o){var a,s;return a=r?Vr.oldDWASMVerStr:"dwasm2_"+Vr._getModuleVer(),s={id:(new Date).getTime().toString(),method:e,version:a,parameter:[]},t.License.isLongKey(n)&&(s.productKey=n),this._postBaseV2(e,r,s,Mr,i,o),!0},_postBaseV2:function(e,r,n,i,o,a){var s,u,c=t.stringify(n);if(t.isFunction(o)&&t.isFunction(a))if(Vr.detect.bConnected&&"VersionInfo"==e&&""!=Vr.detect.connectedResult)o(Vr.detect.connectedResult);else{s=function(e,t,r){a(e,t,r)},u=function(e,r,n){var i;if(e&&(i=t.parse(e)),i&&"result"in i){if(Vr.detect.bConnected)return;if(Vr.detect.bConnected=!0,Vr.detect.dcpStatus=Vr.detect.EnumDCP_DetectStatus.Connected,o(i.result))return}s(e,r,n)},Vr.detect.bConnected=!1;var l=[r?"dcp/"+Vr.oldDWASMVerStr:Vr._getModuleName_Ver(),"/",e,"?type=1&dsver=",Vr.getServiceVersion().join(""),"&ts=",t.now()].join("");Cr.getHttpClientForDcp().request(c,l,{},i).then(u,s)}},loadZip:function(r,n,i,o){var a=n,s=i;100===a&&(a=0,s=function(e){t.isString(e)&&(e=e.replace('"result" : [ 0,','"result" : [ 100,')),i(e)}),e.DWT.IfUpdateService?[Vr._getModuleName_Ver(),"/LoadZipFromBytes?type=",a,"&dsver=",Vr.getServiceVersion().join(""),"&ts=",t.now()].join(""):["dcp/",Vr.oldDWASMVerStr,"/LoadZipFromBytes?type=0","&dsver=",Vr.getServiceVersion().join(""),"&ts=",t.now()].join(""),Cr.getHttpClientForDcp().request(r,undefined,{},3e4).then(s,o)},_getModuleName_Ver:function(){return Vr.__getModuleName()+Vr._getModuleVer()},__getModuleName:function(){return"dcp/dwasm2_"},_getModuleVer:function(){return Vr.getManagerVersion().join("")},_compareVersion:function(e,r){return!t.isLocalIP(h())||(t.isArray(e)&&4==e.length&&t.isArray(r)&&r.length>=4?e[0]>r[0]||e[0]==r[0]&&e[1]>r[1]||e[0]==r[0]&&e[1]==r[1]&&e[2]>r[2]||e[0]==r[0]&&e[1]==r[1]&&e[2]==r[2]&&parseInt(e[3])>=parseInt(r[3]):!!(t.isArray(e)&&1==e.length&&t.isArray(r)&&r.length>=1)&&parseInt(e[0])>=parseInt(r[0]))},_getDSUpdateZipUrl:function(){var r,n,i=e.navInfoSync,o="";return r="Win",i.bMac?r="Mac":i.bLinux&&(r="Linux"),n=i.bFileSystem?"":"?t="+t.now(),i.bWin&&Vr.b64bit&&(o="_x64"),[e.DWT.ResourcesPath,"/dist/serviceupdate/",r,"DSUpdate_",Vr.getManagerVersion().join("."),o,".zip",n].join("")},getPorts:function(e,r,n){var i="GetPorts",o="dwasm2_"+Vr._getModuleVer(),a={id:t.now(),method:i,version:o,parameter:[e]};this._postBaseV2(i,!1,a,Mr,r,n)},_setDefaultValuesFromServer:function(r){var n="",i=!1,o=!1,a={};if(r.length>4&&(n=t.isString(r[2])?r[2]:"",i=t.isString(r[3])&&"true"===r[3],o=t.isString(r[4])&&"64"===r[4]),r.length>5&&(a=r[5]),Vr.detect.connectedResult=r,Vr.strSID=n,Vr.bEnhancedMode=i,Vr.b64bit=o,Vr.objEnhancedPorts=a,i&&a&&a.dcp){var s=a.dcp;Vr.SSLPort=s.sslPort,Vr.Port=s.Port}if(i&&a&&a.dwt){var u=a.dwt;u?e.navInfoSync.bSSL?Ar.dwtPort=u.sslPort:Ar.dwtPort=u.port:Ar.dwtPort=0}},_checkUpdateZip:function(r,n,i,o,a){var s,u,c,l,d,h,g,f=3;s=function(e,r,n){var i=-1;if(n&&(i=n.status),0==i)return setTimeout((function(){Vr._checkService(h,g)}),5e3),!0;var o=Vr._getDSUpdateZipUrl();return Ar.dcpStatus=Ar.EnumDCP_DetectStatus.DownloadingZip,Vr._sendStatusEvent(),t.fetch(o,{mode:"cors",dataType:"arraybuffer"}).then(l,u),!0},u=function(e){Ar.dcpStatus=Ar.EnumDCP_DetectStatus.DownloadFailed,n&&n();var t="The update package can't be downloaded. The error code is "+e.httpCode+".";return i&&i(!0,t),Vr._sendStatusEvent(!0,t),setTimeout(o,0),!0},c=function(e){if(!(t.isArray(e)&&e.length>1))return!1;if(1==e[1])Ar.dcpStatus=Ar.EnumDCP_DetectStatus.VerifiedZip,Vr._sendStatusEvent(),Ar.dcpStatus=Ar.EnumDCP_DetectStatus.UpdatingService,Vr._sendStatusEvent(),setTimeout((function(){Vr._checkService(h,g)}),5e3);else{var r=0;if("exception"in e&&(r=e.exception),-2373==r)return Vr._funUpdateFailed(n,i,e,200),setTimeout(o,0),!0;setTimeout(s,0)}return!0},l=function(r){e.dcp.loadZip(r,1,(function(e){var r,a;try{t.isString(e)&&"result"in(a=t.parse(e.replace(/\0/g,"")))&&(r=a.result)}catch(s){}t.isArray(r)&&r.length>2&&1==r[2]?setTimeout((function(){Vr._checkService(h,g)}),5e3):(Vr._funUpdateFailed(n,i,e,200),setTimeout(o,0))}),d),r=null},d=function(e,t,r){var a=-1;return r&&(a=r.status),0==a?setTimeout((function(){Vr._checkService(h,g)}),5e3):(Vr._funUpdateFailed(n,i,e,r.status),setTimeout(o,0)),!0},h=function(e){if(!(t.isArray(e)&&e.length>0&&e[0]))return!1;var r=e[0].split(",");return!!Vr._compareVersion(r,Vr.getServiceVersion())&&(Ar.bConnected=!0,n&&n(),Ar.dcpStatus=Ar.EnumDCP_DetectStatus.CheckedService,Vr._sendStatusEvent(!1,e[0]),Ar.dcpStatus=Ar.EnumDCP_DetectStatus.UpdateSucceed,Vr._sendStatusEvent(),setTimeout(o,0),!0)},g=function(e,t){var r=1e3;return f<3&&(r=500),--f<0?(Vr._funShowUpgradeDialogWhenUpdateFailed(n,i),setTimeout(o,0),!0):(setTimeout((function(){Vr._checkService(h,g)}),r),!0)},r&&r(),Ar.dcpStatus=Ar.EnumDCP_DetectStatus.VerifyingZip,Vr._sendStatusEvent(),Vr._checkUpdateFile(c,s)},_getStatusString:function(e,t){var r,n,i="";return e==Ar.EnumDCP_DetectStatus.Init?"Getting manager version":e==Ar.EnumDCP_DetectStatus.Connected?(t&&(i=t),"Getting manager version succeeded and the version is "+i):e==Ar.EnumDCP_DetectStatus.DownloadingZip?"Downloading the update package":e==Ar.EnumDCP_DetectStatus.DownloadedZip?"Update package downloaded":e==Ar.EnumDCP_DetectStatus.DownloadFailed?(n=".",t&&t.length>0?("."==t.slice(t.length-1)&&(n=""),r=" with the error: "+t):r="","Update package failed to download"+r+n):e==Ar.EnumDCP_DetectStatus.CheckingManagerVer?"Getting manager version":e==Ar.EnumDCP_DetectStatus.CheckingServiceVer?"Getting service version":e==Ar.EnumDCP_DetectStatus.NotInstalled?"Dynamsoft Service Not Installed":e==Ar.EnumDCP_DetectStatus.UpdateSkipped?"Update skipped":e==Ar.EnumDCP_DetectStatus.CheckedService?(t&&(i=t),"Getting service version succeeded and the version is "+i):e==Ar.EnumDCP_DetectStatus.VerifyingZip?"Verifying the update package":e==Ar.EnumDCP_DetectStatus.VerifiedZip?"Update package verified":e==Ar.EnumDCP_DetectStatus.UpdatingService?"Updating the service":e==Ar.EnumDCP_DetectStatus.UpdateSucceed?"Update succeeded":e==Ar.EnumDCP_DetectStatus.UpdateFailed?(n=".",t&&t.length>0?("."==t.slice(t.length-1)&&(n=""),r=" with the error: "+t):r="","The update failed"+r+n):""},_sendStatusEvent:function(e,r){var n=!!e;t.isFunction(Nr.OnGetServiceUpdateStatus)&&Nr.OnGetServiceUpdateStatus(n,Ar.dcpStatus,Vr._getStatusString(Ar.dcpStatus,r))},_getErr:function(e){var r,n="";try{t.isString(e)?(r=e.replace(/\0/g,""),r=t.parse(r)):e&&(r=e),"description"in r&&(n=r.description)}catch(i){}return n},_funShowUpgradeDialogWhenUpdateFailed:function(e,t){return Ar.bConnected=!0,Ar.dcpStatus=Ar.EnumDCP_DetectStatus.UpdateFailed,e&&e(),t&&t(),Vr._sendStatusEvent(!0),!0},_funUpdateFailed:function(e,t,r,n){var i,o;return Ar.bConnected=!0,Ar.dcpStatus=Ar.EnumDCP_DetectStatus.UpdateFailed,e&&e(),200==n?(i="The update failed.",o=Vr._getStatusString(Ar.dcpStatus,Vr._getErr(r))):o=i="The update failed. The error code is "+n,t&&t(!0,i),Vr._sendStatusEvent(!0,o),!0},getDSPath:function(t,r){var n=e.DWT.ResourcesPath,i=r;if(e.Lib.isString(n)&&n.length>0?"/"!=n[n.length-1]&&(n+="/"):n="Resources/",!i){var o=e.navInfoSync;i=o.bWin?".msi":o.bMac?".pkg":e.navInfo.bArm64?"-arm64.deb":e.navInfo.bMips64?"-mips64el.deb":e.navInfo.bAndroid?".apk":o.bLinux||o.bChromeOS||o.bHarmonyOS?".deb":".msi"}return[n,"dist/DynamsoftServiceSetup",i].join("")},getLinuxHTML5DebPath:function(){return e.dcp.getDSPath(!1,".deb")},getLinuxHTML5RpmPath:function(){return e.dcp.getDSPath(!1,".rpm")},_checkManagerVersionWS:function(r,n,i){var o=He.getWsUrl(e.DWT.Host,e.navInfoSync.bSSL?Vr.SSLPort:Vr.Port),a={id:(new Date).getTime().toString(),method:"VersionInfo",version:"dwasm2_"+Vr._getModuleVer(),parameter:[]};return t.License.isLongKey(r)&&(a.productKey=r),He.postStringDataByWSUrl(o,t.stringify(a)).then((function(e){var r=t.parse(e);r&&"result"in r?n(r.result):i()}),i),!0},getBinaryFileInfo:function(r,n){var i="GetBinaryFileInfo",o={id:(new Date).getTime().toString(),method:i,version:"dwasm2_"+Vr._getModuleVer(),parameter:[]},a=t.stringify(o),s=function(e,i,o){var a;e&&(a=t.parse(e)),a?r(a):n(e,i,o)};if(e.DWT.ConnectWithSocket&&e.navInfoSync.bHTML5Edition){var u=He.getWsUrl(e.DWT.Host,e.navInfoSync.bSSL?Vr.SSLPort:Vr.Port);return He.postStringDataByWSUrl(u,a).then(s,n),!0}var c=[Vr._getModuleName_Ver(),"/",i,"?type=1&dsver=",Vr.getServiceVersion().join(""),"&ts=",t.now()].join("");Cr.getHttpClientForDcp().request(a,c,{},500).then(s,n)}},Fr=Er,Lr=Er}var Br=function(){function e(){Le(this,e),Ye(this,"_exec",{})}return Ae(e,[{key:"fire",value:function(e,r){var n,i=this;e=e.toLowerCase(),n=Array.prototype.slice.call(arguments,1),t.each(i._exec[e]||[],(function(e){var r=e.f,o=e.c||i;try{r.apply(o,n)}catch(es){t.error(es)}}))}},{key:"on",value:function(e,t,r){e=e.toLowerCase(),this._exec[e]=this._exec[e]||[],this._exec[e].push({f:t,c:r})}},{key:"off",value:function(e,t,r){if(e&&t){e=e.toLowerCase();for(var n=this._exec[e]||[],i=n.length-1;i>=0;i--)n[i]===t&&n.splice(i,1)}else this._exec={}}}]),e}(),Or=!1,Rr=!0;function Ur(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(es){return!1}}();return function(){var r,n=et(e);if(t){var i=et(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return $e(this,r)}}function Gr(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function jr(e,t,r){if(!t.has(e));return r}var zr="[bio]: ",Hr=t.win,Xr=Hr&&Hr.FormData,Yr=new WeakSet,Jr=new WeakSet,Kr=new WeakSet,Zr=new WeakSet,qr=new WeakSet,Qr=new WeakSet,$r=new WeakSet,en=new WeakSet,tn=new WeakSet,rn=new WeakSet,nn=function(e){Qe(n,e);var r=Ur(n);function n(e){var i;return Le(this,n),Gr(Ze(i=r.call(this)),rn),Gr(Ze(i),tn),Gr(Ze(i),en),Gr(Ze(i),$r),Gr(Ze(i),Qr),Gr(Ze(i),qr),Gr(Ze(i),Zr),Gr(Ze(i),Kr),Gr(Ze(i),Jr),Gr(Ze(i),Yr),Ye(Ze(i),"_attrs",{}),t.mix(i._attrs,{action:"",data:{},bChunkedSendData:Rr,blockSize:0,ajaxConfig:{value:{},type:"post",processData:Or,cache:Or,dataType:"text",async:Rr,contentType:Or,retry:0,headers:{"X-Requested-With":Or}},ajax:"",formData:"",CORS:Or,bOnlyEmptyIsOK:Rr}),t.mix(i._attrs,e),jr(Ze(i),Yr,on).call(Ze(i)),i}return Ae(n,[{key:"get",value:function(e){return e in this._attrs?this._attrs[e]:""}},{key:"set",value:function(e,t){e in this._attrs&&(this._attrs[e]=t)}},{key:"uploadToServer",value:function(e){var t=this;return t.get("blockSize")>0&&e&&e.size>0?jr(t,Zr,un).call(t,e):jr(t,Jr,an).call(t,e)}},{key:"uploadFilesToServer",value:function(e){return jr(this,Kr,sn).call(this,e)}},{key:"abort",value:function(){var e=this,r=e.get("ajax");return t.isObject(r)?(r.abort(),e.set("ajax",!1),e):(t.log(zr+"abort(), the value of io invalid!"),e)}},{key:"setRequestHeader",value:function(e,t){var r=this.get("ajaxConfig");return r.headers[e]=t,this.set("ajaxConfig",r),t}}]),n}(Br);function on(){this.get("CORS");var e=this.get("ajaxConfig");return t.mix(e,{xhrFields:{withCredentials:!1}}),e}function an(e){var r=this,n=r.get("ajaxConfig"),i=!0;jr(r,qr,cn).call(r),e&&e.size>0&&(jr(r,Qr,ln).call(r,e),t.isString(e.name)&&""!=e.name?r.name=e.name:r.name=e.fileName),t.mix(n,{data:r.get("formData"),url:r.get("action"),beforeSend:function(e,t,n){e.upload.addEventListener("progress",(function(e){r.fire(nn.event.PROGRESS,{loaded:e.loaded,total:e.total,name:r.name})}),!1)}}),t.mix(n,{method:"POST",onSuccess:function(e){var n="";e&&(e&&t.isArray(e)&&e.length>1?n=e[0]:t.isString(e)&&(n=e)),n=jr(r,rn,fn).call(r,n),r.fire(nn.event.SUCCESS,n)},onError:function(n,o,a){var s,u;i=!1,n&&t.isArray(n)&&n.length>2?(s=n[1],u=n[2]):(s=o,u=a),jr(r,$r,dn).call(r,u,s,e)}});var o=t.ajax(n);return r.set("formData",null),n.async?(r.set("ajax",o),!0):(r.set("ajax",!1),i)}function sn(e){var r=this,n=r.get("ajaxConfig"),i=!0,o=[];jr(r,qr,cn).call(r),t.each(e,(function(e){e&&e.size>0?(jr(r,Qr,ln).call(r,e),t.isString(e.name)&&""!=e.name?o.push(e.name):o.push(e.fileName)):o.push("")})),t.mix(n,{data:r.get("formData"),url:r.get("action"),beforeSend:function(e,t,n){e.upload.addEventListener("progress",(function(e){r.fire(nn.event.PROGRESS,{loaded:e.loaded,total:e.total,name:""})}),!1)}}),t.mix(n,{method:"POST",onSuccess:function(e){var n="";o=[],e&&(e&&t.isArray(e)&&e.length>1?n=e[0]:t.isString(e)&&(n=e)),n=jr(r,rn,fn).call(r,n),r.fire(nn.event.SUCCESS,n)},onError:function(n,a,s){var u,c;i=!1,o=[],n&&t.isArray(n)&&n.length>2?(u=n[1],c=n[2]):(u=a,c=s),jr(r,$r,dn).call(r,c,u,e)}}),r.name="";var a=t.ajax(n);return r.set("formData",null),n.async?(r.set("ajax",a),!0):(r.set("ajax",!1),i)}function un(e){var r=this,n=r.get("ajaxConfig"),i=function(n,i,o){var a,s;n&&t.isArray(n)&&n.length>2?(a=n[1],s=n[2]):(a=i,s=o),jr(r,$r,dn).call(r,s,a,e)};t.mix(n,{url:r.get("action")});var o=e.size,a=0,s=r.get("blockSize")||o,u=e.slice||e.webkitSlice||e.mozSlice;!function c(l){var d=u.call(e,a,a+s,e.type),h=d.size,g=e.name;jr(r,tn,gn).call(r,a,h,o),jr(r,qr,cn).call(r),l&&r.set("data",[]),t.isString(g)&&""!=g||(g=e.fileName),d.name=g,r.name=g,jr(r,Qr,ln).call(r,d),t.mix(n,{data:r.get("formData")}),t.mix(n,{method:"POST",onSuccess:function(e,n,i){var s,u;a=jr(r,en,hn).call(r,i)||a+h,r.fire(nn.event.PROGRESS,{loaded:a,total:o,name:r.name}),a<o?c(!1):(u="",(s=e)&&(s&&t.isArray(s)&&s.length>1?u=s[0]:t.isString(s)&&(u=s)),u=jr(r,rn,fn).call(r,u),r.fire(nn.event.SUCCESS,u))},onError:i}),t.ajax(n),r.set("formData",null)}(!0)}function cn(){var e,r=this,n=r.get("data");if(Xr)if(n instanceof Xr)r.set("formData",n);else{e=new Xr;try{t.each(n,(function(t,r){e.append(r,t)})),r.set("formData",e)}catch(es){t.log(zr+"something error when reset FormData.")}}else t.log(zr+"the browser does not support ajax.")}function ln(e){if(!t.isObject(e))return t.log(zr+"_addFileData(), file parameter invalid!"),!1;var r=this.get("formData"),n=e.name,i=e.remoteFilename;return i||(i="RemoteFile"),r.append(i,e,n),this.set("formData",r),r}function dn(e,t,r){var n=nn.status.ERROR,i={status:n,msg:t,response:!1,name:this.name};e&&(i.httpStatus=e.status,i.response=e.responseText),this.fire(n,i)}function hn(e){var t=e.getResponseHeader("Range"),r=t&&t.split("-"),n=r&&r.length>1&&parseInt(r[1],10);return n&&n+1}function gn(e,t,r){var n="bytes "+e+"-"+(e+t-1)+"/"+r;return this.get("ajaxConfig").headers["Content-Range"]=n,n}function fn(e){var r,n,i,o=!1,a=this.name,s=nn.status.SUCCESS,u=nn.event.ERROR;if(t.log("Response from server: "+e),!this.get("bOnlyEmptyIsOK"))return{status:s,msg:!1,json:!1,response:e,name:a};if(t.isUndefined(e)||""===e)r={status:s,msg:!1,json:!1,response:"",name:a};else if(t.isString(e)){try{for(n=0;n<e.length&&!(n>10);n++){if("{"==(i=e[n])){o=!0;break}if(" "!=i&&"\r"!=i&&"\n"!=i&&"\t"!=i)break}if(o){var c=t.parse(e);r=1==c.status?{status:s,msg:!1,json:c,response:e,name:a}:{status:u,msg:!1,json:c,response:e,name:a}}}catch(es){o=!1,t.log(es)}if(!o){var l=String(e);r=""==(l=l.replace(/( |\t|\r|\n)/g,""))?{status:s,msg:!1,json:!1,response:e,name:a}:{status:u,msg:!1,json:!1,response:e,name:a}}}else r={status:s,msg:!1,json:!1,response:"",name:a};return r}function mn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(es){return!1}}();return function(){var r,n=et(e);if(t){var i=et(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return $e(this,r)}}function _n(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function pn(e,t,r){if(!t.has(e));return r}Ye(nn,"event",{SUCCESS:"success",ERROR:"error",PROGRESS:"progress"}),Ye(nn,"status",{SUCCESS:"success",ERROR:"error"});var vn=new WeakSet,yn=new WeakSet,bn=new WeakSet,In=new WeakSet,wn=function(e){Qe(n,e);var r=mn(n);function n(e){var i;return Le(this,n),_n(Ze(i=r.call(this)),In),_n(Ze(i),bn),_n(Ze(i),yn),_n(Ze(i),vn),i._attrs={action:"",retry:0,timeout:0,CORS:Or,async:Rr,dataType:"text",fileStatus:"",uploadType:Or,data:{},bOnlyEmptyIsOK:Rr},t.mix(i._attrs,e),pn(Ze(i),yn,Tn).call(Ze(i)),i}return Ae(n,[{key:"get",value:function(e){return e in this._attrs?this._attrs[e]:""}},{key:"set",value:function(e,t){e in this._attrs&&(this._attrs[e]=t)}},{key:"upload",value:function(e){var r=this,n=r.get("uploadType");if(e){if(t.isArray(e)){var i=e;return n.uploadFilesToServer(i)}if(t.isObject(e)){var o=e;return o.size?(o.id||(o.id=t.guid("file-")),o.size&&(o.textSize=pn(r,vn,Sn).call(r,o.size))):o.size=0,n.uploadToServer(o)}}return n.uploadToServer(e)}},{key:"abort",value:function(){return this.get("uploadType").abort(),!0}},{key:"setRequestHeader",value:function(e,t){this.get("uploadType").setRequestHeader(e,t)}}]),n}(Br);function Sn(e){var t=-1;do{e/=1024,t++}while(e>99&&t<4);return Math.max(e,.1).toFixed(1)+["KB","MB","GB","TB"][t]}function Tn(){var e=this,t={action:e.get("action"),data:e.get("data"),CORS:e.get("CORS"),bOnlyEmptyIsOK:e.get("bOnlyEmptyIsOK")},r=new nn(t),n=r.get("ajaxConfig");return n&&(n.dataType=e.get("dataType"),n.async=e.get("async"),n.retry=e.get("retry")),r.on(nn.event.SUCCESS,pn(e,In,En),e),r.on(nn.event.ERROR,pn(e,In,En),e),r.on(nn.event.PROGRESS,pn(e,bn,Cn),e),e.set("uploadType",r),r}function Cn(e){this.fire(wn.event.PROGRESS,e)}function En(e){var r=this,n=e.status,i=e.msg,o=r.get("file");t.mix(e,{file:o}),"success"===n?r.fire(wn.event.SUCCESS,e):(!1===i||("abort"===i?t.mix(e,{canceled:!0}):"timeout"===i&&t.mix(e,{timeout:!0})),r.fire(wn.event.ERROR,e))}Ye(wn,"event",{SUCCESS:"success",ERROR:"error",PROGRESS:"progress"}),e.DWT.__innerCheckCertDate=function(r){var n=Date.parse(r+"T00:00:00");""==r||isNaN(n)||e.DWT.CheckCertExpired&&(new Date).getTime()>=n-864e5*e.DWT.CertificateConfig.UpdateDaysBeforeExpired&&(t.isFunction(e.OnCertExpired)&&e.OnCertExpired(r),setTimeout((function(){e.DWT.UpdateCert(e.DWT.CertificateConfig.URL,e.OnUpdateCertSuccess,e.OnUpdateCertFailure)}),5e3))},e.DWT.__innerUpdateCert=function(r,n,i,o){var a=e.dcp,s=[a._getModuleName_Ver(),"/LoadZipFromBytes?type=",2,"&dsver=",a.getServiceVersion().join(""),"&ts=",t.now()].join("");Cr.getHttpClientForDcp(null,n).request(r,s,{},3e4).then(i,(function(){t.isFunction(o)&&o()}))},e.DWT.__innerReboot=function(r,n){var i=[e.dcp._getModuleName_Ver(),"/admin?ts=",t.now()].join(""),o='{"id":"'+(new Date).getTime().toString()+'","method":"Reboot","parameter":[],"version":"dwasm2_'+e.dcp._getModuleVer()+'"}';Cr.getHttpClientForDcp().request(o,i,{},3e4).then(r,n)},e.DWT.UpdateCert=function(r,n,i){t.isString(r)&&""!=r?t.fetch(r,{mode:"cors",dataType:"arraybuffer"}).then((function(r){e.DWT.__innerUpdateCert(r,!1,(function(){e.DWT.CheckCertExpired=!1,t.isFunction(n)&&n()}),(function(){e.navInfoSync.bSSL?e.DWT.__innerUpdateCert(r,!0,n,i):t.isFunction(i)&&i()})),r=null}),i):t.isFunction(i)&&i()};var Mn={Errors:{FilePathSyntaxIncorrect:function(e){e._errorCode=-3123,e._errorString="The filename, directory name, or volume label syntax is incorrect."}},checkFilePath:function(e,r){return t.isString(r)&&0!=r.length?t.startsWith(r,"http://")||t.startsWith(r,"https://")||t.startsWith(r,"ftp://")?(t.File.Errors.FilePathSyntaxIncorrect(e),Or):Rr:(t.Errors.InvalidFile(e),Or)}};Mn.checkFolder=Mn.checkFilePath,t.File=Mn,t.showProgress=function(){},t.closeProgress=function(){},String.prototype.startsWith||(String.prototype.startsWith=function(e){return 0==this.indexOf(e)});var Dn=function(e){var t,r=e,n=r._license||"",i=JSON.parse(JSON.stringify(r._licenseServer)),o=r._sessionPassword,a=0;if(n.startsWith("t")||n.startsWith("f"))a=0;else if(0===n.length||n.startsWith("P")||n.startsWith("L")||n.startsWith("Y")||n.startsWith("A"))a=1;else{a=2;var s=n.indexOf(":");if(-1!=s&&(n=n.substring(s+1)),n.startsWith("DLS2")){var u;try{var c=n.substring(4);c=Dynamsoft.Lib.atob(c),u=JSON.parse(c)}catch(d){throw new Error("Format Error: The license string you specified is invalid, please check to make sure it is correct.")}if("number"==typeof(n=u.handshakeCode?u.handshakeCode:u.organizationID?u.organizationID:"")&&(n=JSON.stringify(n)),0===i.length){var l=[];u.mainServerURL&&(l[0]=u.mainServerURL),u.standbyServerURL&&(l[1]=u.standbyServerURL),i=function(e){if(null==e)e=[];else{e instanceof Array||(e=[e]);for(var t=0;t<e.length;++t){if(document&&document.createElement){var r=document.createElement("a");r.href=e[t],e[t]=r.href}e[t].lastIndexOf("/")!=e[t].length-1&&(e[t]+="/")}}return e}(l)}!o&&u.sessionPassword&&(o=u.sessionPassword),t=u.remark}("200001"===n||n.startsWith("200001-"))&&(i&&i.length||(n="")),n||(a=1)}return 1===a&&(n=""),{lt:a,l:n,ls:i,sp:o,rmk:t}};function kn(){return!!t.wakeLock.getWakeLock()}function xn(e){return Pn.apply(this,arguments)}function Pn(){return(Pn=Ke(it.mark((function e(r){var n;return it.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.wakeLock.getWakeLock(),!r){e.next=7;break}if(null!=n){e.next=5;break}return e.next=5,t.wakeLock.toggle();case 5:e.next=10;break;case 7:if(!n){e.next=10;break}return e.next=10,t.wakeLock.toggle();case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Wn(e){return""==e||!t.isString(e)&&!t.isNumber(e)?Or:Rr}function Ln(e){return e&&!t.isString(e)?Rr:Or}function Fn(e,r,n,i){t.isFunction(e)&&setTimeout((function(){e(r,n,i)}),10)}function Vn(r){if(e.WasmEnv&&!e.WasmEnv.wasmLoad)try{e.WasmEnv.resourceDir=e.DWT.ResourcesPath+"/src/",e.WasmEnv.logLevel=e.DWT.Debug?"logDebug":"",e.WasmEnv.load(r.ar,!0,r.cu),e.WasmEnv.wasmLoad=!0}catch(n){n&&t.error(n.message)}}function Nn(){if(!t.product.bFullEdition&&e.WasmEnv&&!e.WasmEnv.wasmLoad)try{e.WasmEnv.resourceDir=e.DWT.ResourcesPath+"/src/",e.WasmEnv.logLevel=e.DWT.Debug?"logDebug":"",e.WasmEnv.load(t.product.refProductKey),e.WasmEnv.wasmLoad=!0}catch(r){r&&t.error(r.message)}}var An=parseInt(n),Bn=parseInt(i),On=parseInt("0"),Rn="ddm/",Un="ddm_"+[An,Bn,On,o].join("");function Gn(){return Rn+Un}function jn(e){return zn.apply(this,arguments)}function zn(){return(zn=Ke(it.mark((function e(r){var n,i,o;return it.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Mr,n=[Gn(),"/VersionInfo?","ts=",t.now()].join(""),i=['{"id":"',t.guid(),'","method":"VersionInfo"}'].join(""),o=Cr.getHttpClientForDcp(r),e.abrupt("return",o.request(i,n,{dataType:"json"},3e3));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Hn=t.isString,Xn=t.isArray,Yn=t.each;function Jn(e,t){if(Hn(t))e.push('"'),e.push(t),e.push('"');else if(Xn(t)){var r=Rr;e.push("["),Yn(t,(function(t){r?r=Or:e.push(","),Jn(e,t)})),e.push("]")}else t===undefined?e.push('""'):e.push(t)}function Kn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t}function Zn(){for(var e=[],t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(r.length>0)if(1===r.length){var i=r[0];e.push("["),Jn(e,i),e.push("]")}else if(2===r.length){var o=r[0],a=r[1];e.push("["),Jn(e,o),e.push(","),Jn(e,a),e.push("]")}else Jn(e,Array.prototype.slice.call(r));return e.join("")}function qn(t){var r,n=e.DWT.EnumDWT_ImageType,i=t;return(t instanceof ArrayBuffer||t instanceof Array)&&(i=new Uint8Array(t.slice(0,12))),r=function(e){return 37==e[0]&&80==e[1]&&68==e[2]&&70==e[3]}(i)?n.IT_PDF:function(e){return 73==e[0]&&73==e[1]&&42==e[2]&&0==e[3]||77==e[0]&&77==e[1]&&0==e[2]&&42==e[3]}(i)?n.IT_TIF:function(e){return 137==e[0]&&80==e[1]&&78==e[2]&&71==e[3]}(i)?n.IT_PNG:function(e){return 255==e[0]&&216==e[1]}(i)?n.IT_JPG:function(e){return 66==e[0]&&77==e[1]}(i)?n.IT_BMP:function(e){return 0==e[0]&&0==e[1]&&0==e[2]&&12==e[3]&&106==e[4]&&80==e[5]&&32==e[6]&&32==e[7]||255==e[0]&&79==e[1]&&255==e[2]&&81==e[3]}(i)?n.IT_J2K:n.IT_PNG,r}var Qn=Ae((function Gh(){Le(this,Gh)})),$n=Ae((function jh(){Le(this,jh)}));function ei(e){var r=new $n;return r.server=e.server,e.attrs&&(r.attrs=t.clone(e.attrs)),r}var ti={notSupportProperty:function(e){},notSupportMethod:function(e){},cformat:function(e,r){if(t.isString(e)){var n,i,o,a,s,u=e.indexOf("<%");if(-1==u)return e;if(i=e.substring(0,u),!(u+2<(n=e.indexOf(">",i))))return e;o=e.substring(u+1,n),a=e.substring(n+1);try{s=t.sprintf(o,r)}catch(c){s=""}return[i,s,a].join("")}return""},refreshImageAfterInvokeFun:function(e,t,r){return 1==r},loadHttpBlob:function(r,n,i,o,a,s,u,c){var l,d,h=Or;if(d={method:n,dataType:"blob"},c&&(d.headers=c),""!=r.HTTPUserName&&(d.username=r.HTTPUserName,d.password=r.HTTPPassword),o){if((e.Lib.env.bMobile||e.navInfoSync.bChrome||e.navInfoSync.bFirefox)&&"get"==n)return d.fetchRaw=!0,fetch(i,d).then((function(e){var t;if(!e.ok)throw{httpCode:e.status,errorString:e.statusText};var r=e.headers.get("Content-Length"),n=0,i=null==e||null===(t=e.body)||void 0===t?void 0:t.getReader(),o=new ReadableStream({start:function(e){setTimeout((function t(){null==i||i.read().then((function(i){i.done?e.close():(n+=i.value.length,u({loaded:n,total:r}),e.enqueue(i.value),setTimeout(t,0))}))}),0)}}),a=e.headers.get("Content-Type");return a&&""!=a||(a="application/octet-stream"),new Response(o,{headers:{"Content-Type":a}})})).then((function(e){return e.blob()})).then((function(e){a(e),e=null}),(function(e){e&&e.httpCode?t.Errors.HttpDownloadError(r,!1,e.errorString,e.httpCode):t.Errors.HttpDownloadUrlError(r),t.isFunction(s)&&s({code:r._errorCode,message:r._getErrorString()})})),!0;d.onSuccess=a,t.isFunction(u)&&(d.beforeSend=function(t){t.addEventListener("progress",(function(t){!e.navInfoSync.bSafari&&t&&(delete t.totalSize,delete t.position),u(t)}),Or)}),h=Rr}else e.navInfoSync.bIE?(d.dataType="arraybuffer",d.onSuccess=function(e,t,n){var i,o;(i=e||n.responseData)&&(o=new Uint8Array(i)),r._errorCode=0,r._errorString="",a(o),o=null,h=Rr}):(d.dataType="text",d.contentType="text/plain; charset=x-user-defined",d.mimeType="text/plain; charset=x-user-defined",d.onSuccess=function(e,t,n){var i,o,s;o=(i=n.responseText).length,s=new Uint8Array(o);for(var u=0;u<o;u++)s[u]=i.charCodeAt(u);r._errorCode=0,r._errorString="",a(s),s=null,h=Rr}),d.headers?t.mix(d.headers,{"X-Requested-With":Or}):d.headers={"X-Requested-With":Or};if("post"==n){var g,f=r.httpFormFields;if(f)try{g=new FormData,t.each(f,(function(e,t){if(e instanceof Blob){var r=e.name;g.append(t,e,r)}else g.append(t,e)})),t.mix(d,{data:g,processData:Or,contentType:Or})}catch(es){}}l=function(e,n,i){var o,a;if(e&&t.isArray(e)&&e.length>2?(o=e[1],a=e[2]):(o=n,a=i),2==a.state&&0==a.status)if("abort"===a.statusText){t.Errors.HttpDownloadError(r,true)}else t.Errors.HttpDownloadUrlError(r);else t.Errors.HttpDownloadError(r,Or,o,a.status);t.isFunction(s)&&s()},d.url=i,d.async=o,d.onError=l,d.onComplete=function(){t.bio=Or};var m=t.ajax(d);return o&&(t.bio=m),h},combineUrl:function(e,r,n){var i=[],o=r;return o===undefined||n===undefined?undefined:(t.isString(o)||(o=String(r)),0==o.indexOf("http://")?(o=o.replace("http://",""),i.push("http://")):0==o.indexOf("https://")?(o=o.replace("https://",""),i.push("https://")):(0==o.indexOf("//")&&(o=o.replace("//","")),e.IfSSL?i.push("https://"):i.push("http://")),i.push(o),o.indexOf(":")<0&&(""==e.HTTPPort&&(e.HTTPPort=t.detect.ssl?443:80),(!t.detect.ssl&&80!=e.HTTPPort||t.detect.ssl&&443!=e.HTTPPort)&&(i.push(":"),i.push(e.HTTPPort))),0!==n.indexOf("/")&&i.push("/"),i.push(n),i.join(""))},httpPostUpload:function(e,r,n,i,o,a,s,u,c,l,d,h){if(!n||n.size<=0)return t.Errors.UploadFileCannotEmpty(e),t.isFunction(h)&&h(),Or;var g,f,m=e.MaxUploadImageSize,_=n.size,p=n.type;if(_>m&&-1!=m)return t.Errors.UploadExceededMaxSize(e),t.isFunction(h)&&h(),Or;if(""===p||p&&p!=e.HttpContentTypeFieldValue){var v=n.slice||n.webkitSlice||n.mozSlice,y=n.name;t.isString(y)&&""!=y||(y=n.fileName),(g=v.call(n,0,_,e.HttpContentTypeFieldValue)).name=y}else g=n;return n=null,g.remoteFilename=e.__remoteFilename,f=this.httpUploadByBIO(e,r,g,o,i,a,s,u,c,l,d,h),g=null,f},httpPostUploadFiles:function(e,r,n,i,o,a,s,u,c,l,d){var h,g,f=e.MaxUploadImageSize,m=0;if(!n||!t.isArray(n)||n.length<=0)return t.Errors.UploadFileCannotEmpty(e),t.isFunction(d)&&d(),Or;for(h=0;h<n.length;h++){var _=n[h];if(!_||_.size<=0)return t.Errors.UploadFileCannotEmpty(e),t.isFunction(d)&&d(),Or;var p=_.size,v=_.type;if(m+=p,""===v||v&&v!=e.HttpContentTypeFieldValue){var y=_.slice||_.webkitSlice||_.mozSlice,b=_.name,I=y.call(_,0,p,e.HttpContentTypeFieldValue);t.isString(b)&&""!=b||(b=_.fileName),I.name=this.cformat(b,h+1),n[h]=I}n[h].remoteFilename=this.cformat(e.__remoteFilename,h+1),_=null}if(m>f&&-1!=f)return t.Errors.UploadExceededMaxSize(e),t.isFunction(d)&&d(),Or;for(g=this.httpUploadByBIO(e,r,n,o,i,a,s,u,c,!1,l,d),h=0;h<n.length;h++)n[h]=null;return n=null,g},httpPostUploadString:function(e,r,n,i,o,a,s,u,c,l,d){var h,g,f;if(""==n)return t.Errors.UploadFileCannotEmpty(e),t.isFunction(d)&&d(),Or;if(g=e.MaxUploadImageSize,n.length>g&&-1!=g)return t.Errors.UploadExceededMaxSize(e),t.isFunction(d)&&d(),Or;(h=new Blob([n],{type:"text/plain"})).name=i;return f=this.httpUploadByBIO(e,r,h,o,Rr,a,s,u,c,!1,l,d),h=null,f},httpUploadByBIO:function(r,n,i,o,a,s,u,c,l,d,h,g){var f,m,_,p;if(_=r.httpFormFields,p=new FormData,t.each(_,(function(e,t){if(e instanceof Blob){var r=e.name;p.append(t,e,r)}else p.append(t,e)})),t.bio=new t.BIO({action:n,data:p,async:a,retry:c,bOnlyEmptyIsOK:l}),(f=t.bio.get("uploadType"))&&((m=f.get("ajaxConfig"))&&m.headers&&s&&t.mix(m.headers,s),o>=0&&f.set("blockSize",o),r.__withCredentials&&t.mix(m.xhrFields,{withCredentials:!0})),r.__HTTPPostResponseString=Or,t.bio.on(t.BIO.event.SUCCESS,(function(e){if(t.bio=Or,e&&t.isString(e.response)?r.__HTTPPostResponseString=e.response:r.__HTTPPostResponseString="",t.isFunction(r.__OnHttpUploadStatus)){var n;n={fileName:e.name,percentage:100,statusCode:200,responseString:r.__HTTPPostResponseString},r.__OnHttpUploadStatus(n)}t.isFunction(h)&&h(r.__HTTPPostResponseString)})),t.bio.on(t.BIO.event.ERROR,(function(e){var n=e&&e.canceled;e&&e.timeout;var i,o=Or,a=0;(t.bio=Or,e&&t.isString(e.response)?r.__HTTPPostResponseString=e.response:r.__HTTPPostResponseString="",n||(e&&e.msg&&(o=e.msg),e&&e.httpStatus&&(a=e.httpStatus)),t.Errors.UploadError(r,n,o,a),t.isFunction(r.__OnHttpUploadStatus))&&(i={fileName:e.name,percentage:100,statusCode:a,responseString:r.__HTTPPostResponseString},r.__OnHttpUploadStatus(i));t.isFunction(g)&&g(r.__HTTPPostResponseString)})),(u||t.isFunction(r.__OnHttpUploadStatus))&&(t.bio.on(t.BIO.event.PROGRESS,(function(n){!e.navInfoSync.bSafari&&n&&(delete n.totalSize,delete n.position);var i=0===n.total?100:Math.round(100*n.loaded/n.total);if([n.loaded," / ",n.total].join(""),t.isFunction(r.__OnHttpUploadStatus)){var o;i>99&&(i=99),o={fileName:n.name,percentage:i,statusCode:0,responseString:""},r.__OnHttpUploadStatus(o)}u&&r._OnPercentDone([0,i,"","http",n.name])})),u&&r._OnPercentDone([0,-1,e.MSG.Uploading,"http"]),t.isFunction(r.__OnHttpUploadStatus))){var v="";t.isArray(i)&&i.length>0||(i&&i.name&&""!=i.name?v=i.name:i&&i.fileName&&(v=i.fileName)),r.__OnHttpUploadStatus({fileName:v,percentage:0,statusCode:0,responseString:""})}return d&&d.bCancel?(d.st=2,t.isFunction(g)&&g(!1),!1):t.bio.upload(i)},httpPutImage:function(r,n,i,o,a,s,u){var c=Rr,l={method:"PUT",url:n,hasContent:Rr,processData:Or,async:o,data:i,onSuccess:a,onError:function(){c=Or,t.isFunction(s)&&s()},onComplete:function(){t.bio=Or},beforeSend:function(r){t.isFunction(u)&&r.upload.addEventListener("progress",(function(t){!e.navInfoSync.bSafari&&t&&(delete t.totalSize,delete t.position),u(t)}),Or)}};return""!=r.HTTPUserName&&(l.username=r.HTTPUserName,l.password=r.HTTPPassword),o||t.mix(l,{headers:{"X-Requested-With":Or}}),t.bio=t.ajax(l),c},EVENTS:["OnPostAllTransfers","OnPostTransfer","OnPostLoad","OnPreTransfer","OnPreAllTransfers","OnResult","OnTransferCancelled","OnTransferError","OnSourceUIClose","OnGetFilePath","OnPercentDone","OnPostTransferAsync","OnPreAllTransfersAsync","OnRemoteScanStatusAsync","OnConsumed"],SEND_BACK_EVENTS:["OnPreAllTransfers","OnPreTransfer","OnPostTransfer","OnGetFilePath","OnPostLoad"],handleOnBitmapChangedEvent:function(e,r,n){var i="_OnBitmapChanged";return t.isFunction(e[i])&&e[i](r.result,r,n),Or},addImageFileExt:function(t,r){var n,i=t.substring(t.lastIndexOf(".")).toLowerCase();return".bmp"==i||".dib"==i||".jpg"==i||".jpe"==i||".jpeg"==i||".jfif"==i||".tif"==i||".tiff"==i||".png"==i||".pdf"==i?t:(r==e.DWT.EnumDWT_ImageType.IT_BMP?n=[t,".bmp"].join(""):r==e.DWT.EnumDWT_ImageType.IT_JPG?n=[t,".jpg"].join(""):r==e.DWT.EnumDWT_ImageType.IT_PNG?n=[t,".png"].join(""):r==e.DWT.EnumDWT_ImageType.IT_TIF?n=[t,".tif"].join(""):r==e.DWT.EnumDWT_ImageType.IT_PDF?n=[t,".pdf"].join(""):r==e.DWT.EnumDWT_ImageType.IT_J2K&&(n=[t,".jp2"].join("")),n)},GetImageInfo:function(e,r){var n=e._ImgManager.convertClientIndexToServerId(r);return-1==n?(t.Errors.IndexOutOfRange(e),!1):e._innerFun("GetImageInfo",Zn(n))},getBlobTypeByImageType:function(e){var t="application/octet-stream";switch(e){case 0:t="image/bmp";break;case 1:t="image/jpeg";break;case 2:t="image/tiff";break;case 3:t="image/png";break;case 4:t="application/pdf";break;case 14:t="image/jp2"}return t},callbacks:[],pushCallback:function(e,t,r){var n={method:e,callback:t,ticks:r};ti.callbacks.push(n)},refreshUIRef:0,isServerInvalid:function(e){var r=e,n=!1,i=!1;return(e._isTwainServiceType()||e._isWasmWithScan())&&(n=!r._bReady||null===r._wsClient,i=r.__bMustUpgradeService),n?t.Errors.Server_Invalid(r):i?t.Errors.MustUpgradeService(r):r._destroy&&t.Errors.Destroyed(r),n||i||-2208==r._errorCode||r._destroy},replaceLocalFilename:function(t){var r;return t===undefined?"":(r=(t=String(t)).replace(/\\/g,"\\\\"),e.navInfoSync.bFileSystem&&(r=decodeURI(r)),r)},getImageType:function(t){if(t===undefined)return-1;if(t.length<4)return-1;var r=t.lastIndexOf(".");if(-1===r)return-1;var n=t.slice(r).toLowerCase();return".bmp"===n||".dib"===n?e.DWT.EnumDWT_ImageType.IT_BMP:".jpg"===n||".jpe"===n||".jpeg"===n||".jfif"===n?e.DWT.EnumDWT_ImageType.IT_JPG:".tif"===n||".tiff"===n?e.DWT.EnumDWT_ImageType.IT_TIF:".png"===n?e.DWT.EnumDWT_ImageType.IT_PNG:".pdf"===n?e.DWT.EnumDWT_ImageType.IT_PDF:".jp2"===n||".j2k"===n||".j2c"===n?e.DWT.EnumDWT_ImageType.IT_J2K:-1},makeParams:Zn,showMask:ni,hideMask:ii};t.html5.Funs=ti;var ri=0;function ni(e,r,n){if(t.log("showMask:"+e+"--"+ri),0==ri)if(r){t.detect.showMask(r);var i=t.mask.dlgMask;if(i){i.style.zIndex="9990";var o=t.one(".dynamsoft-backdrop",i.parentNode);o&&o.length>0&&(o[0].style.zIndex="9990")}}else t.detect.showMask(n||{});ri++}function ii(e){t.log("hideMask:"+e+"--"+ri),ri>1?ri--:ri<=1&&(t.detect.hideMask(),ri=0)}function oi(e,t,r,n){var i=0;return e==j&&(i=ce),e==J?i=ne:e==z?r?i=oe:n?i=ie:t&&(i=ce):e==Y&&(r?i=ce|oe:n?i=ce|ie:t&&(i=ce|ne)),i}var ai=["OnPreAllTransfers","OnPreTransfer","OnPostTransfer","OnPostTransferAsync"];function si(e,t){for(var r=e._ImgManager.GetAllServerIdList(),n=0;n<r.length;n++)t.push(r[n])}function ui(e,r){return 0!=e._ImgManager.count()||(t.Errors.NoImage(e),t.isFunction(r)&&r(e._errorCode,e._getErrorString()),!1)}function ci(e,r,n){return!!ui(e,n)&&(!(isNaN(r)||!t.isNumber(r)||r<0||r>=e._ImgManager.count())||(t.Errors.IndexOutOfRange(e),t.isFunction(n)&&n(e._errorCode,e._getErrorString()),!1))}function li(e){if(e.ProductName){var r=e.ProductName;e.ProductName=t.base64.decode(r)}if(e.ProductFamily){var n=e.ProductFamily;e.ProductFamily=t.base64.decode(n)}if(e.Manufacturer){var i=e.Manufacturer;e.Manufacturer=t.base64.decode(i)}if(e.Version&&e.Version.Info){var o=e.Version.Info;e.Version.Info=t.base64.decode(o)}}function di(e){var r,n,i,o=[];return e._ImgManager.count()<=0||((n=e._ImgManager.getCurrentImageIndex())>=0&&(r=e._ImgManager.convertClientIndexToServerId(n)),i=e._ImgManager.getSelectedClientIndexArray(),t.isArray(i)&&t.each(i,(function(t){var r=e._ImgManager.convertClientIndexToServerId(t);-1!=r&&o.push(r)})),-1!=r&&0==o.length&&o.push(r)),o}function hi(e,r,n){return e._resetErr(),!!e._isValid()&&(isNaN(r)?(t.Errors.InvalidIndex(e),t.isFunction(n)&&n(e._errorCode,e.ErrorString),Or):r<0||r>=e._ImgManager.count()?(t.Errors.IndexOutOfRange(e),t.isFunction(n)&&n(e._errorCode,e.ErrorString),Or):Rr)}function gi(e){return e==te||e==re||e==ne||e==ie||e==oe}function fi(e){return e==ae||e==se}function mi(e,t){var r,n=e.name,i="",o=e.deviceType;r=o==te?"":o==ne?"Twain64-":o==re?"":o==ie?"ICA-":o==oe?"Sane-":"",t&&t.attrs&&t.attrs.ty&&(i=" on ["+t.attrs.ty+"]"),e.displayName=[r,n,i].join("")}t.removeNonPrintableChar;var _i=1;function pi(){return(++_i).toString()}var vi=function(){function r(t,n){Le(this,r),Ye(this,"m_server",""),Ye(this,"m_iUsingTime",0),Ye(this,"m_countMap",{}),Ye(this,"m_newConsum",!1),Ye(this,"m_mapSavedToDb",!1),this.clearData(),this.m_enumInstance=t,t==e.DWT.EnumInstance.dwt_desktop?(this.m_deploymentType="desktop",this.m_server=n):t!=e.DWT.EnumInstance.dwt_browser&&t!=e.DWT.EnumInstance.dbr||(this.m_deploymentType="browser",this.m_server="")}return Ae(r,[{key:"clearData",value:function(){this.m_iUsingTime=0,this.m_jvUsingTime=t.nil,this.m_countMap={},this.m_newConsum=!1,this.m_mapSavedToDb=!1,this.m_minExpiredTime=t.nil,this.m_maxExpiredTime=t.nil,this.m_cu=t.nil,this.m_ar=t.nil,this.m_ltsInstance=t.nil}},{key:"set_cu",value:function(e){this.m_cu=e}},{key:"get_cu",value:function(){return this.m_cu}},{key:"set_ar",value:function(e){this.m_ar=e}},{key:"get_ar",value:function(){return this.m_ar}},{key:"get_ltsInstance",value:function(e){return this.m_ltsInstance||(this.m_ltsInstance=e(this.m_enumInstance)),this.m_ltsInstance}},{key:"inited_ltsInstance",value:function(){return!!this.m_ltsInstance}},{key:"set_maxExpiredTime",value:function(e){this.m_maxExpiredTime=e}},{key:"get_maxExpiredTime",value:function(){return this.m_maxExpiredTime}},{key:"set_minExpiredTime",value:function(e){this.m_minExpiredTime=e}},{key:"get_minExpiredTime",value:function(){return this.m_minExpiredTime}},{key:"get_deploymentType",value:function(){return this.m_deploymentType}},{key:"get_enumDeploymentType",value:function(){return this.m_enumInstance}}]),r}(),yi=3008;var bi=e.DWT;bi.LTS=bi.LTS||{},bi.licenseException={code:0,message:"",fromLTS:!1},bi.bLTSOnline=!0,bi.axInstance=undefined,bi.lOnUpdateDWObj=[],bi.EnumInstance={dwt_desktop:0,dwt_browser:1,dbr:2};var Ii,wi,Si,Ti,Ci=0,Ei={},Mi=!1,Di=!1,ki={},xi=!1,Pi=!1,Wi=!1;function Li(){var e=t.product.handshakeCode;return t.isString(e)||(e=""),e}function Fi(){var e=t.product.organizationID;return t.isNumber(e)?e=""+e:t.isString(e)||(e=""),e}function Vi(){return t.replaceAll(bi.JSVersion,",",".")}function Ni(e,r){var n=e;return n===t.nil&&(n=t.IsNeedLoadWasm()?bi.EnumInstance.dwt_browser:bi.EnumInstance.dwt_desktop),n==bi.EnumInstance.dwt_browser?(wi||(wi=new vi(n,"")),wi):n==bi.EnumInstance.dbr?(Ti||(Ti=new vi(n,"")),Ti):(Si||(Si=new vi(n,"")),Si)}bi.lupverfy=function(){Ni(bi.EnumInstance.dwt_desktop).get_ltsInstance(ji),Ni(bi.EnumInstance.dwt_browser).get_ltsInstance(ji),Ni(bi.EnumInstance.dbr).get_ltsInstance(ji)},bi.lsmid=function(e,t){Ni(bi.EnumInstance.dwt_desktop).set_cu(e)},bi.lsar=function(e,t){Ni(bi.EnumInstance.dwt_desktop).set_ar(e)},bi.lsmid2b=function(e){Ni(bi.EnumInstance.dwt_browser).set_cu(e)},bi.lgar=function(e,t){Ni(e).get_ar()},bi.laddDWTObj=function(e){var r=!1;t.each(bi.lOnUpdateDWObj,(function(t){if(t==e)return r=!0,!1})),r||bi.lOnUpdateDWObj.push(e)},bi.lremoveDWTObj=function(e){t.each(bi.lOnUpdateDWObj,(function(t,r){if(t==e)return bi.lOnUpdateDWObj.splice(r,1),!1}))},bi.lsendUpdateEvt=function(e,r){var n=[];if(t.each(bi.lOnUpdateDWObj,(function(t){e==bi.EnumInstance.dwt_desktop?(t._bAx||t._isTwainServiceType()||t._isDMServiceType())&&n.push(t):e==bi.EnumInstance.dwt_browser&&(t._bAx||t._isTwainServiceType()||t._isDMServiceType()||n.push(t))})),0==n.length)return t.Promise.resolve();var i,o=n[0];return o._bAx?(t.each(n,(function(t){t.SetLTSInfo(Ni(e).get_ar(),Ni(e).get_cu())})),o.GetLicenseInfo().then((function(n){n&&t.isArray(n.Detail)&&n.Detail.length>0&&bi.lsexp(e,n.Detail[0].ExpireDate,r)}))):(i=o.SetLTSLicenseAsync(Ni(e).get_ar()).then((function(n){n&&t.isArray(n.Detail)&&n.Detail.length>0&&bi.lsexp(e,n.Detail[0].ExpireDate,r)})),t.each(n,(function(t,r){0!=r&&t.SetLTSLicenseAsync(Ni(e).get_ar())})),i)},bi.lgcb=function(){var r=e.navInfoSync,n=[];return r.bChrome?n.push("Chrome"):r.bFirefox?n.push("Firefox"):r.bEdge?n.push("Edge"):r.bIE?n.push("IE"):r.bSafari?n.push("Safari"):r.bOpera?n.push("Opera"):r.b360SE?n.push("360SE"):r.bTencentTraveler?n.push("TencentTraveler"):r.bMaxthon?n.push("Maxthon"):r.bMetaSr?n.push("MetaSr"):r.bTheWorld?n.push("TheWorld"):r.bUC?n.push("UC"):r.bHuaWeiBrowser&&n.push("HuaWeiBrowser"),n.push(r.strBrowserVersion),r.bWin?n.push("Windows"):r.bMac?n.push("Mac"):r.bLinux?n.push("Linux"):r.bAndroid?n.push("Android"):r.bChromeOS?n.push("ChromeOS"):r.bHarmonyOS?n.push("HarmonyOS"):t.env.bMobile?n.push("Mobile OS"):e.navInfo.bEmbed&&n.push("Embed OS"),n.join(" ")};var Ai=-2440,Bi=-2441,Oi=-2443,Ri=-2445,Ui=-2446,Gi=-2447;function ji(r){var n,i,o=t.product.licenseServer;if(o&&o.length>0)for(n=0;n<o.length;n++)i=o[n],t.endsWith(i,"/")||(o[n]=i+"/");var a={dm:location.origin?t.startsWith(location.origin,"http")?location.origin:"https://localhost":t.startsWith(location.href,"http")?location.href:"https://localhost",lf:t.localforage,btoa:t.btoa,atob:t.atob,sutlcb:function(){t.isFunction(bi.lonsend)&&bi.lonsend()},fol:bi.OnFirstOffline,dwt:!0};if(r==bi.EnumInstance.dwt_browser||r==bi.EnumInstance.dbr?a.feab=bi.lfeab_wasm:a.feab=bi.lfeab_ax,!e.navInfoSync.bIE&&t.product.ltsDebug&&(a.debugLog=console.log),e.LTS&&e.LTS._)return e.LTS._.createLtsInstance(a);var s={},u=function(){return t.Promise.reject({code:Ui,message:"The dynamsoft.lts.js load failed."})};return s.i=u,s.s=u,s.caret=u,s}function zi(e,r){var n=null!=r?r:"",i=Ni(e),o=i.get_enumDeploymentType();if(bi.lclex(),i.get_ar()&&i.get_cu())return Promise.resolve({ar:i.get_ar(),cu:i.get_cu()});var a={pd:bi.lgpd(e),v:Vi(),os:bi.lgcb(),fn:bi.DeviceFriendlyName||"",ls:t.product.licenseServer,sp:t.product.sessionPassword,l:t.License.getLTSLicense(),mnet:function(){return i.get_maxExpiredTime()},mxet:function(){return i.get_minExpiredTime()},fol:bi.OnFirstOffline};return a.dt=i.get_deploymentType(),o==bi.EnumInstance.dwt_desktop?a.lsu=i.get_cu():o==bi.EnumInstance.dbr||(a.dwt=!0,""!=i.get_cu()&&(a.lsu=i.get_cu()),a.updateLicense=function(e){i.set_ar(e.ar),i.get_cu()||i.set_cu(e.cu),bi.lsendUpdateEvt(o,n)}),i.get_ltsInstance(ji).i(a).then((function(e){return i.get_ar()||i.set_ar(e.ar),i.get_cu()||i.set_cu(e.cu),e}))}function Hi(){return Ni(bi.EnumInstance.dwt_browser).get_ltsInstance(ji).u()}function Xi(){return Date.now()}function Yi(e){var t=e?new Date(e):new Date,r="yyyy-MM-ddTHH:mm:ss.SSSZ",n={"M+":t.getUTCMonth()+1,"d+":t.getUTCDate(),"H+":t.getUTCHours(),"h+":t.getUTCHours()%12||12,"m+":t.getUTCMinutes(),"s+":t.getUTCSeconds(),"q+":Math.floor((t.getUTCMonth()+3)/3),"S+":t.getUTCMilliseconds()};for(var i in/(y+)/.test(r)&&(r=r.replace(RegExp.$1,(t.getUTCFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+i+")").test(r)&&(r=r.replace(RegExp.$1,1==RegExp.$1.length?n[i]:("000"+n[i]).substr(("000"+n[i]).length-RegExp.$1.length)));return r}function Ji(e,t,r,n){return Ki.apply(this,arguments)}function Ki(){return(Ki=Ke(it.mark((function e(r,n,i,o){var a;return it.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n!=St){e.next=4;break}return e.abrupt("return",o.taskId);case 4:if(n!=Ct){e.next=8;break}return e.abrupt("return",t.parse(r));case 8:if(n!=Et){e.next=13;break}if(!o||!o.client){e.next=11;break}return e.abrupt("return",o.client.getRequestTaskId());case 11:e.next=20;break;case 13:if(n!=Dt){e.next=20;break}if(a=null==o?void 0:o.userData){e.next=17;break}return e.abrupt("return",!1);case 17:return r.indexOf("Version not found")>=0?t.isFunction(a.fFun)&&a.fFun():t.isFunction(a.sFun)&&a.sFun(),e.abrupt("return",!0);case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}bi.lgpd=function(t){return e.navInfoSync.bWin&&t==bi.EnumInstance.dwt_desktop?"dwt|dbr":"dwt"},bi.lglic=zi,bi.lgbuuid=Hi,bi.lshow=function(){return{t:Ii,t2:Ci,m:JSON.stringify(Ei)}},bi.lgct=function(e){switch(e){case 0:return"3011";case 1:return"3012";case 2:return"3014";case 3:return"3013";case 4:return"3015";case 14:return"3016";case 3001:return"3001";case 3002:return"3002";case 3003:return"3003";case 3004:return"3004";case 3005:return"3005";case 3006:return"3006";case 3007:return"3007";case yi:return"3008";case 3009:return"3009";case 5001:return"5001";case 4001:return"4001";case 4002:return"4002";case 4003:return"4003"}return""},bi.lcvrf=function(e){e&&setTimeout((function(){bi.lcvrf_(e)}),1)},bi.lcvrf_=function(r){var n;n=r._bAx?bi.EnumInstance.dwt_desktop:r._isMobileMode()?bi.EnumInstance.dwt_browser:bi.EnumInstance.dwt_desktop;var i,o=bi.DeviceFriendlyName||"",a=bi.lgcb(),s=Ni(n),u={hs:Li(),og:Fi(),cu:s.get_cu(),fn:o,cw:"",os:a,v:Vi(),dt:s.get_deploymentType(),ed:"js"},c=function(t,r){var n,i,o=e.Lib,a=0;if(o.isString(t)&&""!=t&&"{}"!=t&&r&&o.isArray(r)&&!(r.length<1)){if(i=Ni(r[0]),n=o.parse(t),bi.lclex(),0==Ci){var s=Xi(),u="";Ci=s,Ii=Yi(s),Ei={},a=0,o.each(n,(function(e,t){(t<a||0==a)&&(a=t,u=e)})),a>0&&i.get_ltsInstance(ji).s(o.product.licenseServer,u,a,!0).then((function(){}),(function(e){}))}o.each(n,(function(e,t){var r=!1,n=parseInt(t);n>0&&n!=a&&(n+18e4<Xi()&&(r=!0),i.get_ltsInstance(ji).s(o.product.licenseServer,e,t,r).then((function(){}),(function(e){})))}))}};if(u.pd=bi.lgpd(n),i=JSON.stringify(u),!r._bAx){var l="GetBuffer",d=Zn(t.replaceAll(i,'"','\\"')),h={cmd:l,cmdId:pi(),sFun:c,fFun:function(){},params:[n]};return r._innerSendByWS(l,d,h,null,!0)}c(r.GetBuffer(i),[n,""])},bi.lavrf=function(e,t,r,n){var i=1;if(""!=e){t>1&&(i=t);var o=Xi();if(Ci>0&&Ci+18e4<o){Di?(Ei={},bi.lavrf__unload()):bi.lavrf__(!0,r,n);var a=Xi()+1;Ci=a,Ii=Yi(a),Ei={}}Mi=!0,Di=!1,Ei[e]?Ei[e]+=i:Ei[e]=i,0==Ci&&bi.lavrf__(!0,r,n)}},bi.lavrf_=function(e,t,r){if(Mi){var n=1;e&&(n=e),setTimeout((function(){bi.lavrf__(!1,t,r)}),n)}},bi.lavrf__=function(e,r,n){var i,o,a,s=Xi(),u=!1,c=!!e,l=0,d=r;t.isUndefined(d)&&(d=bi.EnumInstance.dwt_browser),a=Ni(d),Mi=!1,0==Ci&&(u=!0,Ci=s,Ii=Yi(s)),i=Ci,o=Ii;var h={};h.ut=o;var g={};if(t.each(Ei,(function(e,t){g[t]=e,e>0&&l++})),h.cts=g,c||i+18e4<s){c=!0;var f=Xi()+1;if(Ci=f,Ii=Yi(f),Ei={},Di=!1,0==l)return}else{if(0==l)return;Di=!0}h.dur=u?1:180;var m,_=bi.DeviceFriendlyName||"",p=bi.lgcb(),v={hs:Li(),og:Fi(),cu:a.get_cu(),fn:_,cw:"",os:p,v:Vi(),dt:a.get_deploymentType(),ed:"js",rcs:[h]};v.product=bi.lgpd(r),m=JSON.stringify(v),t.product.ltsDebug&&Yi(),bi.lclex(),a.get_ltsInstance(ji).s(t.product.licenseServer,m,""+i,c).then((function(){}),(function(e){}))},bi.lavrf__unload=function(){var e,r=Xi(),n=!0,i=!1,o=Ni(bi.EnumInstance.dwt_desktop),a=Ni(bi.EnumInstance.dwt_browser),s=Ni(bi.EnumInstance.dbr);Mi=!1,0==Ci&&(Ci=r,Ii=Yi(r)),e=Ci;var u=Xi()+1;Ci=u,Ii=Yi(u),Ei={},Di=!1,e+=1,bi.lclex(),o.inited_ltsInstance()&&o.get_ltsInstance(ji).s(t.product.licenseServer,i,""+e,n).then((function(){}),(function(e){})),a.inited_ltsInstance()&&a.get_ltsInstance(ji).s(t.product.licenseServer,i,""+e,n).then((function(){}),(function(e){})),s.inited_ltsInstance()&&s.get_ltsInstance(ji).s(t.product.licenseServer,i,""+e,n).then((function(){}),(function(e){}));var c,l=Object.keys(ki);t.each(l,(function(r){(c=ki[r]).inited_ltsInstance()&&c.get_ltsInstance(ji).s(t.product.licenseServer,i,""+e,n).then((function(){}),(function(e){}))}))},bi.lclex=function(){var e=bi.licenseException;e.code=0,e.message="",e.httpResponse="",e.fromLTS=!1},bi.li=function(e,r){var n;if(e.axInstance&&(bi.axInstance=e.axInstance,bi.axInstance))return n=bi.axInstance.GetUUID(),t.product.ltsDebug&&t.log("ActiveX cu: "+n),Ni(e.instanceMode).set_cu(n),n;return Ni(e.instanceMode).get_cu()},bi.lfeab_ax=function(e){return new t.Promise((function(t,r){var n="";if(bi.axInstance)try{n=bi.axInstance.Encrypt(e,0)}catch(i){}t(n)}))},bi.lfeab_wasm=function(r){return new t.Promise((function(t,n){var i=new e.Imagecore;i.getAesResult(r).then((function(e){i.terminate(),t(e)}),(function(e){i.terminate(),n(e)}))}))},bi.lwsproc=function(e,r){try{e=t.parse(e)}catch(n){return void(r.fFun&&r.fFun(n))}"GetBuffer"==e.method?r.sFun&&e.result.length>0?r.sFun(e.result[0],r.params):r.sFun("",r.params):r.sFun&&r.sFun(e)},bi.lsexp=function(e,r,n){var i,o=r;if(3==(i=(o=t.replaceAll(o,"/","-")).split("-")).length){var a=i[0],s=i[1],u=i[2];s.length<2&&(s=(s="00"+s).substr(s.length-2)),u.length<2&&(u=(u="00"+u).substr(u.length-2)),o=[a,s,u].join("-")}var c=[o,"T23:59:59.999Z"].join("");Ni(e).set_minExpiredTime(c),Ni(e).set_maxExpiredTime(c)},bi.lunload=function(){bi.lavrf__unload();var e=Ni(bi.EnumInstance.dwt_desktop),r=Ni(bi.EnumInstance.dwt_browser),n=Ni(bi.EnumInstance.dbr);e.clearData(),r.clearData(),n.clearData();var i=Object.keys(ki);t.each(i,(function(e){ki[e].clearData()})),Ci=0,Ii=t.nil,Ei={},Di=!1,Mi=!1,xi=!1,Pi=!1,Wi=!1,bi.lclex(),bi.bLTSOnline=!0,bi.axInstance=t.nil,bi.lOnUpdateDWObj=[]},bi.lcexp=function(r,n){return Ni(r).get_ltsInstance(ji).caret().then((function(){return!1}),(function(r){var n=bi.licenseException,i="";return r instanceof Error||"message"in r?i=r.message:t.isString(r)&&(i=r),bi.lsetException(Ri,i,!1),Pi||(Pi=!0,t.error(i),e.OnLTSLicenseError&&e.OnLTSLicenseError(t.License.getPublicLicenseContent(n.message))),!0}))},bi.OnLicenseException=function(){var r=bi.licenseException,n=r.message;if(t.isString(n)&&(n.indexOf("Error Code")>-1?n=t.replaceAll(n,"Error Code","error code"):n.indexOf("Error code")>-1&&(n=t.replaceAll(n,"Error code","error code"))),n.indexOf("(https://www.dynamsoft.com/purchase-center/)")>-1&&(n=n.replace("(https://www.dynamsoft.com/purchase-center/)","(https://www.dynamsoft.com/store/dynamic-web-twain/)"),r.message=n),n.indexOf("error code:")>-1){var i=n.substr(0,n.indexOf("message")),o=n.substr(n.indexOf("message"));i.indexOf("{")>-1&&(i=i.substr(i.indexOf("{")+1)),o.indexOf("}")>-1&&(o=o.substr(0,o.indexOf("}"))),i=t.replaceAll(i,"error code:",""),o=t.replaceAll(o,"message: ",""),bi.lsetException(parseInt(i),o,!0),t.error(o),e.OnLTSLicenseError&&e.OnLTSLicenseError(t.License.getPublicLicenseContent(n))}else{if(!r.code){var a=Ai;n.indexOf("timed out")>-1||n.indexOf("timeout")>-1?a=Bi:(n.indexOf("access-control-allow-origin")>-1||n.indexOf("cors")>-1)&&(a=Oi),bi.lsetException(a,n,!0)}if(t.error(r.message),r.code==Ui)return;e.OnLTSLicenseError&&e.OnLTSLicenseError(t.License.getPublicLicenseContent(r.message))}},bi.lol=function(){return bi.bLTSOnline},bi.OnFirstOffline=function(e){bi.bLTSOnline=!1},bi.lpubdlg=function(r,n){if(t.isString(r)&&""!=r){if(r=t.atob(r),console&&console.warn,1==n)return xi||(xi=!0,e.OnLTSPublicLicenseMessage&&e.OnLTSPublicLicenseMessage(t.License.getPublicLicenseContent(r))),!0;2==n&&(xi||(xi=!0))}return!1},bi.lcheckLic=function(r,n,i){var o=!1;if(n){if(t.isArray(n.Detail)&&n.Detail.length>0){var a=n.Detail[0].ExpireDate;return bi.lsexp(r,a,i),bi.lcexp(r,i).then((function(t){var r=!1;t?r=!0:1!=n.Trial&&2!=n.Trial||(r=bi.lpubdlg(n.Message,n.Trial)),r||bi.bLTSOnline||Wi||(Wi=!0,e.OnLTSConnectionWarning&&e.OnLTSConnectionWarning())}))}1!=n.Trial&&2!=n.Trial||(o=bi.lpubdlg(n.Message,n.Trial))}o||bi.bLTSOnline||Wi||(Wi=!0,e.OnLTSConnectionWarning&&e.OnLTSConnectionWarning())},bi.lisValidID=function(r){if(t.isString(r)&&""!=r)return!0;var n,i=bi.licenseException;return bi.lsetException(Gi,"Failed to generate an ID for your device to license it: not enough permission.",!0),t.error(i.message),n=i.message,e.OnLTSUUIDError&&e.OnLTSUUIDError(n),!1},bi.lsetException=function(e,r,n){var i=bi.licenseException;i.code=e,i.message=r,t.isUndefined(n)||(i.fromLTS=n)},e.DWT.NeedCheckWebTwainBySocket=function(){return function(){var t=location.hostname;return"localhost"!=t&&"127.0.0.1"!=t&&0!=t.indexOf("192.168.")&&0!=t.indexOf("172.16.")&&0!=t.indexOf("10.")&&!e.navInfoSync.bSSL}()&&!!((e.navInfoSync.bChrome||e.navInfoSync.bEdge)&&parseInt(e.navInfoSync.strBrowserVersion)>=94)},e.DWT.CheckWebTwainBySocket=function(r,n,i){var o,a,s,u=e.Lib.detect.urls;if(u&&u.length>0){var c=u[0];o=c.host||h(),a=c.port,s=c.ssl}else o=h(),a=(s=e.navInfoSync.bSSL)?e.DWT.SSLPort:e.DWT.Port;var l=t.now(),d=Cr.getWsClient(o,a,s);if(d.connected)return t.isFunction(r)&&r(),void d.dispose();var g,f={id:l,method:"VersionInfo",cmdId:l,version:[e.Lib.product.getDWTPrefix(),e.Lib.product.getServerVersionInfo()].join("")},m=Ji,_={cmdId:l,cmd:null,sFun:r,fFun:n},p=500;e.navInfoSync.bAndroid&&(p=1500),g={client:d,userData:_,taskId:l},d.setRetry(0),d.request(t.stringify(f),m,g,p).then((function(){d.dispose()}),(function(){t.isFunction(i)&&i(),d.dispose()}))},e.DWT.IsLocalServiceConnected=function(){return new t.Promise((function(r,n){var i,o=h();t.each(t.detect.ports,(function(t){e.navInfoSync.bSSL?t.ssl&&(i=t.port):t.ssl||(i=t.port)})),e.DWT.CheckConnectToTheService(o,i,(function(e,t,n){r(!0)}),(function(){n(!1)}))}))};var Zi,qi,Qi=0;function $i(r){return e.WasmEnv?(e.WasmEnv&&(e.WasmEnv.useFastcompEdition=e.Lib.env.isWasmUseFastcomp(),e.DWT.WasmConfig&&(e.DWT.WasmConfig.fetchOptions&&(e.WasmEnv.fetchOptions=e.DWT.WasmConfig.fetchOptions),e.DWT.WasmConfig.maxHeapSize&&(e.WasmEnv.maxHeapSize=e.DWT.WasmConfig.maxHeapSize))),t.detect.wasmScriptLoaded=!0,void r()):Qi>3?(t.detect.wasmScriptLoaded=!0,void r()):(Qi++,void setTimeout((function(){$i(r)}),500))}function eo(r,n){if(function(){try{if("object"===("undefined"==typeof WebAssembly?"undefined":Fe(WebAssembly))&&"function"==typeof WebAssembly.instantiate){var e=new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0]));if(e instanceof WebAssembly.Module)return new WebAssembly.Instance(e)instanceof WebAssembly.Instance}}catch(es){}return!1}())if(t.detect.wasmScriptLoaded)r();else{n&&t.showLoadingMsg(-1,"",e.MSG.Init_DownloadingWasm);var i=function(i){Qi=0,$i(r),n&&t.showLoadingMsg(-1,"",e.MSG.Init_CompilingWasm)};if(e.DWT.bNpm)i();else{var o=[e.DWT.ResourcesPath,"/src/dynamsoft.imageio.js",e.Lib.timestamp].join("");t.addScript(o,!0,!1,i)}}else r()}function to(r,n){if(t.bNode||e.navInfoSync.bJSDom||t.product.bActiveXEdition||!t.product.bFullEdition);else{if(t.IsNeedLoadWasm())return eo(r,!0);if(t.product.bHTML5Edition&&t.product.UseLocalService&&!t.detect.wasmScriptLoaded&&!e.navInfoSync.bFileSystem&&e.DWT.UseCameraAddonWasm)return eo(r,!1)}r()}function ro(){t.detect.scriptLoaded?new t.Promise(to).then(Zi,qi):setTimeout(ro,100)}function no(){return t.detect.scriptLoaded?new t.Promise(to):new t.Promise((function(e,t){Zi=e,qi=t,setTimeout(ro,100)}))}function io(){var t=e.navInfoSync;return t.bAndroid?M:t.bMac?w:t.bChromeOS?C:t.bHarmonyOS?E:e.navInfo.bEmbed?T:t.bLinux?S:t.biPhone||t.biPad?D:I}function oo(r,n,i,o,a){var s,u=t.product,c=e.navInfoSync,l=e.dcp.getDSPath();if(r&&(t.one(r).before(t.install._strNonInstallDIV),(s=t.get(t.install._divDWTNonInstallContainerID))&&(s.style.width=n,s.style.height=i),t.show(t.install._divDWTNonInstallContainerID)),""!=t.install._divDWTemessageContainer&&t.hide(t.install._divDWTemessageContainer),c.bMac)o?t.isFunction(e.OnWebTwainNeedUpgradeCallback)&&e.OnWebTwainNeedUpgradeCallback(u.name,{"default":l},u.bHTML5Edition,w,c.bIE,c.bSafari,t.detect.ssl,t.env.strIEVersion):t.isFunction(e.OnWebTwainNotFoundOnMacCallback)&&e.OnWebTwainNotFoundOnMacCallback(u.name,l,u.bHTML5Edition,c.bIE,c.bSafari,t.detect.ssl,t.env.strIEVersion,a);else if(c.bLinux||e.navInfo.bEmbed||c.bChromeOS||c.bMobile){var d,h,g=io();if(e.navInfo.bEmbed||c.bAndroid||c.bChromeOS||c.bHarmonyOS?d=l:(d=e.dcp.getLinuxHTML5DebPath(),h=e.dcp.getLinuxHTML5RpmPath()),o){if(t.isFunction(e.OnWebTwainNeedUpgradeCallback)){var f={"default":d};c.bLinux&&(f.deb=d,f.rpm=h),e.OnWebTwainNeedUpgradeCallback(u.name,f,u.bHTML5Edition,g,c.bIE,c.bSafari,t.detect.ssl,t.env.strIEVersion)}}else c.bAndroid?t.isFunction(e.OnWebTwainNotFoundOnAndroidCallback)&&e.OnWebTwainNotFoundOnAndroidCallback(u.name,d,h,u.bHTML5Edition,c.bIE,c.bSafari,t.detect.ssl,t.env.strIEVersion,g,a):t.isFunction(e.OnWebTwainNotFoundOnLinuxCallback)&&e.OnWebTwainNotFoundOnLinuxCallback(u.name,d,h,u.bHTML5Edition,c.bIE,c.bSafari,t.detect.ssl,t.env.strIEVersion,g,a)}else if(c.bChrome||c.bSafari||c.bFirefox||c.bOpera||e.DWT.IfUseActiveXForIE10Plus==Or||!e.DWT.ActiveXInstallWithCAB&&c.bIE)if(o){if(t.isFunction(e.OnWebTwainNeedUpgradeCallback)){var m={"default":l};e.OnWebTwainNeedUpgradeCallback(u.name,m,u.bHTML5Edition,I,c.bIE,c.bSafari,t.detect.ssl,t.env.strIEVersion)}}else t.isFunction(e.OnWebTwainNotFoundOnWindowsCallback)&&e.OnWebTwainNotFoundOnWindowsCallback(u.name,l,u.bHTML5Edition,c.bIE,c.bSafari,t.detect.ssl,t.env.strIEVersion,a)}function ao(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function so(e,t,r){if(!t.has(e));return r}var uo=n+".",co=parseInt(n),lo=0,ho=1,go=2,fo=3,mo=4,_o=7,po=8,vo=9,yo=10,bo=50,Io=51,wo=52,So=t.getLogger();function To(e){return t.isString(e)?t.trim(e):e}var Co=new WeakSet,Eo=new WeakSet,Mo=new WeakSet,Do=new WeakSet,ko=new WeakSet,xo=new WeakSet,Po=new WeakSet,Wo=new WeakSet,Lo=new WeakSet,Fo=new WeakSet,Vo=new WeakSet,No=new WeakSet,Ao=new WeakSet,Bo=new WeakSet,Oo=function(){function r(){Le(this,r),ao(this,Bo),ao(this,Ao),ao(this,No),ao(this,Vo),ao(this,Fo),ao(this,Lo),ao(this,Wo),ao(this,Po),ao(this,xo),ao(this,ko),ao(this,Do),ao(this,Mo),ao(this,Eo),ao(this,Co)}return Ae(r,[{key:"isLTS",value:function(){return t.isString(e.Lib.product.handshakeCode)||t.isString(e.Lib.product.organizationID)||e.Lib.product.bPublicLTS||t.isString(e.DWT.ProductKey)&&t.startsWith(e.DWT.ProductKey,"DLS2")}},{key:"isLongKey",value:function(e){if(!(t.isString(e)&&e.length>0))return!1;var r=e.charAt(0);return"f"==r||"t"==r}},{key:"isLicenseMixed",value:function(r,n){var i,o=!1,a=r||e.DWT.ProductKey;(e.DWT.lclex(),n)&&((To(e.DWT.organizationID)||To(e.DWT.handshakeCode))&&a&&(o=!0,i={},t.Errors.LongKeyShortKeyMixed(i)));if(!o&&t.isString(a))if(a=t.trim(a),t.startsWith(a,"f")||t.startsWith(a,"t"));else if(""==a);else if(t.startsWith(a,"DLS2"))try{so(this,Eo,Uo).call(this,a)}catch(u){o=!0,i={},t.Errors.LTSErrors(i),i._errorString=u.message}else{so(this,Co,Ro).call(this,a).LTS||(o=!0,i={},t.Errors.FailedParseProductKey(i))}if(o&&i&&(e.Lib.Errors.SetLTSException(i),So)){var s=e.DWT.licenseException;So.error(s.message)}return o}},{key:"reparseProductKey",value:function(){var r=To(e.DWT.organizationID),n=To(e.DWT.handshakeCode),i=r||n,o=t.product,a=t.trim(e.DWT.ProductKey);if(!i){var s=so(this,Co,Ro).call(this,a);s.LTS&&(n=To(s.handshakeCode),i=(r=To(s.organizationID))||n)}if(i)return this._innerResetLicense(),t.isNumber(a)&&(r=a),o.handshakeCode=n,o.organizationID=r,o.licenseServer=e.DWT.licenseServer,o.sessionPassword=e.DWT.sessionPassword,void(o.bPublicLTS=so(this,Mo,Go).call(this,o.licenseServer,i));var u=!1;if(o.refProductKey!==a&&(this._innerResetLicense(),t.isString(a)&&a.length>0&&(o.refProductKey=a,u=!0)),u){var c=o.refProductKey.charAt(0);if("f"!=c&&"t"!=c){var l,d={_pLoad:{isEmpty:Rr},_license:o.refProductKey,_licenseServer:[]};try{l=Dn(d)}catch(g){t.error(g),l=!1}if(l&&t.isString(l.l)){var h=t.trim(l.l);""==h?o.organizationID=h:-1!=h.indexOf("-")?o.handshakeCode=h:o.organizationID=h,t.isArray(l.ls)&&l.ls.length>0&&(o.licenseServer=l.ls),o.bPublicLTS=so(this,Mo,Go).call(this,o.licenseServer,h),o.sessionPassword=l.sp}else o.bPublicLTS=!1}else o.bPublicLTS=!1}}},{key:"_innerResetLicense",value:function(){var t=e.Lib.product;t.refProductKey="",t.handshakeCode=undefined,t.organizationID=undefined,t.licenseServer=undefined,t.sessionPassword="",t.bPublicLTS=!0}},{key:"checkOSForAllowCore",value:function(e,r,n){if(t.product.bHTML5Edition){if(e)return so(this,Bo,$o).call(this,r);var i=n._bRemoteMode,o=n.__serverPlatform;return this.isOSOK(r,i,o)}return Rr}},{key:"checkLocalPlatformForRemoteService",value:function(r){var n,i,o,a=r.__licenseInfo,s=io(),u=!1;for(n=0;n<a.Detail.length;n++)if(i=a.Detail[n],(o=so(this,No,qo).call(this,i.EnumLicenseType,i.LicenseType)).AndroidW&&!e.navInfoSync.bAndroid&&(i.OS=t.replaceAll(i.OS,"Wasm","AndroidW")),o.Core&&t.isString(i.Version)&&0==i.Version.indexOf(uo)){if(u=so(this,Bo,$o).call(this,i.OS))break;if(u=this.isOSOK(i.OS,true,s))break}return u||(s==I?t.Errors.LicenseNotSupportWindows(r):s==S?t.Errors.LicenseNotSupportLinux(r):s==w?t.Errors.LicenseNotSupportMAC(r):t.Errors.LicenseNotSupportOS(r)),u}},{key:"checkProductKey",value:function(r,n,i,o){var a=e.DWT.licenseException,s=!1,u=Or;return n.Camera?this.checkCameraProductKey(r):(t.isFunction(r._isMobileMode)&&r._isMobileMode()&&(u=Rr),(s=so(this,ko,zo).call(this,r,r.__licenseInfo,u,n,i,o))&&n.Core&&t.isFunction(r._isWasmWithScan)&&r._isWasmWithScan()&&(s=this.checkAndroidServiceCore(r,i,o)),s||(a.code=r._errorCode,a.message=r._getErrorString(),a.fromLTS=!1),s)}},{key:"checkCameraProductKey",value:function(t){var r,n=e.DWT.licenseException,i=t.__calic;return(r=so(this,ko,zo).call(this,t,i,true,{Camera:!0},!0,!1))||(n.code=t._errorCode,n.message=t._getErrorString(),n.fromLTS=!1),r}},{key:"checkAndroidServiceCore",value:function(r,n,i){var o=e.DWT.licenseException,a=!1;return t.isFunction(r._isWasmWithScan)&&r._isWasmWithScan()&&(a=so(this,ko,zo).call(this,r,r.__anlic,!1,{Core:!0},n,i)),a||(o.code=r._errorCode,o.message=r._getErrorString(),o.fromLTS=!1),a}},{key:"showLicenseErrorDialog",value:function(e){var t=e.code;0!=t&&(t==so(this,Po,Xo).call(this)?so(this,Fo,Ko).call(this):so(this,xo,Ho).call(this,e))}},{key:"isBindDomainOK",value:function(e){if(t.isUndefined(e)||null==e||""==e||"*"==e||"*.*"==e)return Rr;var r=location.hostname,n=Or;if(""==r)return Rr;for(var i=r.toLowerCase().split("."),o=i.length,a=e.toLowerCase().split(";"),s=0;s<a.length;s++){var u=a[s];if("*.*"==u){n=Rr;break}var c=u.split("."),l=c.length;if(l>0&&l-1<=o){for(var d=Rr,h=l-1;h>0;h--){if(c[h].indexOf("*")>-1){n=Rr;break}if(h+o-l>=0){if(i[h+o-l]!=c[h]){d=Or;break}}else if("*"!=c[h]){d=Or;break}}if(d&&("*"==c[0]||o>=l&&i[o-l]==c[0])){n=Rr;break}}}return n}},{key:"isExpiredOrFuture",value:function(e,t){if(""==e)return Or;if(!t){var r=e.length;if(r>2&&"/"==e[r-2]&&"0"==e[r-1])return Or}var n=this.parseDateFromString(e),i=(new Date).getTime(),o=i+5184e6;return n.getTime()<i||t&&n.getTime()>o?Rr:Or}},{key:"remainExpireDays",value:function(e){if(""==e)return 65536;var t=this.parseDateFromString(e),r=(new Date).getTime(),n=(t.getTime()-r)/864e5;return t.getTime()<r?0:Math.ceil(n)}},{key:"isOSOK",value:function(t,r,n){var i=!1,o=!1,a=!1,s=!1,u=!1,c=!1,l=!1,d=!1;if(""==t||"0"==t)return Rr;if(r)n==I?a=!0:n==S?o=!0:n==w?i=!0:n==T?u=!0:n==C?c=!0:n==M?l=!0:n==E?d=!0:n==D&&(s=!0);else{var h=e.navInfoSync;i=h.bMac,o=h.bLinux,a=h.bWin,s=h.biPhone||h.biPad,c=h.bChromeOS,u=e.navInfo.bEmbed,l=h.bAndroid,d=h.bHarmonyOS}return(t=t.toLowerCase()).indexOf("windows")>-1&&a||t.indexOf("mac")>-1&&i||t.indexOf("linux")>-1&&(o||c||d)||t.indexOf("android")>-1&&l||t.indexOf("ios")>-1&&s||t.indexOf("embed")>-1&&u?Rr:Or}},{key:"isBrowserOK",value:function(r){if(t.isString(r)){if(""==r||"0"==r)return Rr;var n=(r=r.toLowerCase()).split(";"),i=Or,o=e.navInfoSync;return t.each(n,(function(e){("chrome"==t.trim(e)&&(o.bChrome||o.bSafari||o.bOpera||o.bEdge)||"ie"==t.trim(e)&&o.bIE||"firefox"==t.trim(e)&&o.bFirefox)&&(i=Rr)})),i}return Or}},{key:"parseDateFromString",value:function(e){var t,r=e;return r=r.replace(/-/g,"/"),t=Date.parse(r),isNaN(t)&&(t=0),(t=new Date(t)).setHours(23,59,59,999),t}},{key:"isAllowLicenseType",value:function(e,t){return t.Core?e.Core:t.PDFRasterizer?e.PDFRasterizer:t.Webcam||t.Camera?e.Webcam:t.barcode1D?e.barcode1D:t.QR?e.QR:t.PDF417?e.PDF417:t.DataMatrix?e.DataMatrix:t.OCR?e.OCR:t.OCRPro?e.OCRPro:e.Core}},{key:"setNoAllowedLicenseTypeError",value:function(e,r,n){n.Core?t.Errors.LicenseNoCore(e,r):n.Webcam||n.Camera?r||n.Camera?t.Errors.LicenseNotSupportWebcamWasm(e):t.Errors.LicenseNoWebcam(e):n.PDFRasterizer?r?t.Errors.LicenseNotSupportPdfRWasm(e):t.Errors.LicenseNoPDF(e):n.OCR?t.Errors.LicenseNoOCR(e):n.OCRPro?t.Errors.LicenseNoOCRPro(e):t.Errors.LicenseEmptyOrInvalid(e)}},{key:"getLicenseDateString",value:function(e){var t,r=e.getFullYear();return[(t=e.getMonth()+1)>=10?""+t:"0"+t,"/",e.getDate()>=10?""+e.getDate():"0"+e.getDate(),"/",r].join("")}},{key:"hasPDFRProductKey",value:function(e){return!!this.checkProductKey(e,{PDFRasterizer:!0},!0)||(e._resetErr(),!1)}},{key:"checkPDFProductKeyWhenNeeds",value:function(r,n){if(n==e.DWT.EnumDWT_ImageType.IT_PDF||n==e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF){var i;if(t.product.bHTML5Edition?r.__addon&&r.__addon.PDF&&(i=r.__addon.PDF.GetConvertMode()):r.Addon&&r.Addon.PDF&&(i=r.Addon.PDF.GetConvertMode()),1==i||4==i)return this.checkProductKey(r,{PDFRasterizer:!0},!0)}return Rr}},{key:"getPublicLicenseContent",value:function(e){var r=[],n=e;if(!t.isString(n)){if(t.isUndef(n))return"";n=n instanceof Error||"message"in n?n.message:""+n}var i=n.indexOf("["),o=n.indexOf("]",i),a=n.indexOf("(",o),s=n.indexOf(")",a);if(-1==i||-1==o||-1==a||-1==s)return n;i>0&&r.push(n.substring(0,i));var u=n.substring(i+1,o),c=n.substring(a+1,s);return r.push(['<a href="',c,'" target="_blank" class="dynamsoft-major-color">',u,"</a>"].join("")),r.push(n.substring(s+1)),r.join("")}},{key:"getLTSLicense",value:function(){return e.Lib.product.bPublicLTS?"":e.Lib.product.handshakeCode||e.Lib.product.organizationID}}]),r}();function Ro(e){var t,r,n=e,i=e.indexOf("-"),o=-1!=i;return r={},o&&(n=e.substring(0,i)),(t=Number(n))!=NaN&&String(Number(t))===n&&(o?r.handshakeCode=e:r.organizationID=e,r.LTS=Rr),r}function Uo(e){Dn({_pLoad:{isEmpty:Rr},_license:e,_licenseServer:[]})}function Go(e,r){var n=!0;if(t.isArray(e)&&e.length>0){var i=e[0];t.isString(i)&&""!=i&&-1==i.indexOf("https://mlts.dynamsoft.com")&&(n=!1)}return n&&(!r||"200001"===r||t.startsWith(r,"200001-"))}function jo(e,t,r){return this.checkOSForAllowCore(e,t,r)}function zo(r,o,a,s,u,c){var l,d=c;if(o&&o.LTS){if(!o||!t.isArray(o.Detail)||0==o.Detail.length)return this.isLTS()?t.Errors.LicenseNoCore(r,a):t.Errors.LicenseEmptyOrInvalid(r),so(this,Wo,Yo).call(this,"",!0),Or}else if(!o||!t.isArray(o.Detail)||0==o.Detail.length)return this.isLTS()?t.Errors.LicenseNoCore(r,a):t.Errors.LicenseEmptyOrInvalid(r),so(this,Wo,Yo).call(this,"",!0),Or;var h,g,f,m,_=0,p=0,v=[],y=[],b=Or,I=Or,w=Or,S=Or,T=Or;if(!this.isBindDomainOK(o.Domain))return t.Errors.LicenseBadDomain(r),d&&so(this,xo,Ho).call(this,bt(r)),Or;for(o.Detail.length>0&&(l="FALSE"!=(f=o.Detail[0]).Trial),g=1;g<o.Detail.length;g++)if("FALSE"==(f=o.Detail[g]).Trial&&l||"TRUE"==f.Trial&&!l)return t.Errors.LicenseTrialFullMixed(r),d&&so(this,xo,Ho).call(this,bt(r)),Or;if(s.Core||s.Webcam){var C,E=[],M=!1;for(g=0;g<o.Detail.length;g++)if(f=o.Detail[g],(m=so(this,No,qo).call(this,f.EnumLicenseType,f.LicenseType)).AndroidW&&!e.navInfoSync.bAndroid&&(f.OS=t.replaceAll(f.OS,"Wasm","AndroidW")),s.Core&&m.Core&&this.checkOSForAllowCore(a,f.OS,r)||s.Core&&m.Core&&t.product.bActiveXEdition&&m.ActiveX||s.Webcam&&m.Webcam&&!a){if(o.LTS);else if(m.Webcam);else if(!t.isString(f.Version)||0!=f.Version.indexOf(uo)){E.push(f);continue}if(t.product.bHTML5Edition){if(m.ActiveX&&!m.Html5)continue;y.push(f)}else{if(!m.ActiveX&&m.Html5)continue;y.push(f)}M=!0}if(!M&&E.length>0)return E.splice(0),C=[n,i].join("."),t.Errors.LicenseVersionNotCurrent(r,C),d&&so(this,xo,Ho).call(this,bt(r)),!1;E.splice(0)}else y=o.Detail;for(g=0;g<y.length;g++){var D=Rr;if(f=y[g],(m=so(this,No,qo).call(this,f.EnumLicenseType,f.LicenseType)).AndroidW&&!e.navInfoSync.bAndroid&&(f.OS=t.replaceAll(f.OS,"Wasm","AndroidW")),s.Core&&m.Core||this.isAllowLicenseType(m,s)){h=f.ExpireDate.replace(/-/g,"/");var k="FALSE"!=f.Trial;if(k&&!e.DWT.HideTrialMessage){var x=this.remainExpireDays(h);x<=5&&(t.isFunction(e.OnLicenseExpiredMessage)&&e.OnLicenseExpiredMessage(h,x),e.DWT.HideTrialMessage=!0)}if(this.isExpiredOrFuture(h,k))v.push(h);else if(o.LTS||m.Core&&t.product.bHTML5Edition&&parseInt(f.Version)>=co||m.Core&&t.product.bActiveXEdition||!m.Core){var P=!1;if(m.Core)(this.checkOSForAllowCore(a,f.OS,r)||t.product.bActiveXEdition&&m.ActiveX)&&(P=!0);else{var W=a;s.Camera&&(W=!0),so(this,Do,jo).call(this,W,f.OS,r)&&(P=!0)}P?this.isBrowserOK(f.Browser)||u?(_++,D=Or):I=Rr:s.Core?b=Rr:s.PDFRasterizer?S=Rr:(s.Webcam||s.Camera)&&(T=Rr)}else w=Rr;D&&p++}}if(_>0)return Rr;if(0==p)return this.setNoAllowedLicenseTypeError(r,a,s),d&&so(this,xo,Ho).call(this,bt(r)),Or;if(v.length>0){var L,F=0,V=1e20,N="",A=(new Date).getTime();for(h="",g=0;g<v.length;g++)(L=this.parseDateFromString(v[g])).getTime()<A&&L.getTime()>F?(F=L.getTime(),h=v[g]):L.getTime()>A&&L.getTime()<V&&(V=L.getTime(),N=v[g]);return""!=h?(L=this.parseDateFromString(h),h=this.getLicenseDateString(L),t.Errors.LicenseExpired(r,h),this.isLTS()||so(this,Wo,Yo).call(this,h,l),d=!1):""!=N?(L=this.parseDateFromString(N),N=this.getLicenseDateString(L),t.Errors.LicenseIsFuture(r,N)):(t.Errors.LicenseExpired(r,""),d=!1,so(this,Wo,Yo).call(this)),d&&so(this,xo,Ho).call(this,bt(r)),Or}if(w)return t.Errors.LicenseLower(r),d&&so(this,xo,Ho).call(this,bt(r)),Or;var B=e.navInfoSync;return I?(B.bEdge?t.Errors.LicenseNoEdge(r):B.bChrome?t.Errors.LicenseNoChrome(r):B.bFirefox?t.Errors.LicenseNoFirefox(r):B.bIE?t.Errors.LicenseNoIE(r):B.bSafari?t.Errors.LicenseNoSafari(r):t.Errors.LicenseNotSupportBorwser(r),d&&so(this,xo,Ho).call(this,bt(r)),Or):b?(this.setNoAllowedLicenseTypeError(r,a,{Core:!0}),d&&so(this,xo,Ho).call(this,bt(r)),Or):S?(this.setNoAllowedLicenseTypeError(r,a,{PDFRasterizer:!0}),d&&so(this,xo,Ho).call(this,bt(r)),Or):T?(this.setNoAllowedLicenseTypeError(r,a,{Webcam:!0}),d&&so(this,xo,Ho).call(this,bt(r)),Or):(t.Errors.LicenseEmptyOrInvalid(r),d&&so(this,xo,Ho).call(this,bt(r)),Or)}function Ho(r){var n=0,i=r.message;t.isNumber(r.code)?n=r.code:t.isString(i)&&(n=-1),0!=n&&(So&&So.error(i),t.isFunction(e.OnLicenseError)&&e.OnLicenseError(i,n))}function Xo(){var e={};return t.Errors.FailedParseProductKey(e),(e=bt(e)).code}function Yo(r,n){if(!t.detect.needUpgrade)if(this.isLTS()){var i=e.DWT.licenseException.message;e.OnLTSLicenseError&&e.OnLTSLicenseError(this.getPublicLicenseContent(i))}else so(this,Lo,Jo).call(this,r,n)}function Jo(r,n){var i=[],o="is not valid",a=screen.width,s=a>640?640:a-10;if(r&&""!=r&&(o=-1==r.indexOf("on")?"has expired on "+r:"has expired "+r),i.push('<div style="padding:0 25px 25px 25px;">'),t.env.bMobile?(i.push("The <strong>ProductKey</strong> is not valid."),n&&(i.push(" Please <br /><ul><li>1. <a class='dynamsoft-major-color' href='https://www.dynamsoft.com/customer/license/trialLicense?product=dwt&utm_source=in-product' target='_blank'>Request a trial license</a>.</li>"),i.push("<li>2. <a class='dynamsoft-major-color' href='https://www.dynamsoft.com/web-twain/docs/indepth/development/upgrade.html#update-the-product-key?product=dwt&utm_source=in-product' target='_blank'>Update the ProductKey</a>.</li>"),i.push("</ul>"))):n?(i.push("You are seeing this message because your trial key "),i.push(o),i.push(". Two quick steps to extend your trial: <br /><div><ul>"),i.push("<li style='padding-left:25px'>1.<strong><a class='dynamsoft-major-color' href='https://www.dynamsoft.com/customer/license/trialLicense?product=dwt&utm_source=in-product' target='_blank'>Request a new trial key</a></strong> and follow the instructions to set the new key</li>"),i.push("<li style='padding-left:25px'>2.Refresh your scan page and try again</li>"),i.push("</ul></div>If you run into any issues, please <a class='dynamsoft-major-color' href='https://www.dynamsoft.com/company/contact/' target='_blank'>contact us</a>.")):(i.push("You are seeing this message because the license for doc scanning support "),i.push(o),i.push(".<br /><div><ul>"),i.push("<li><strong>If you are the owner of the website</strong>, please <a class='dynamsoft-major-color' href='https://www.dynamsoft.com/customer/order/renewalList' target='_blank'>renew your license</a> and follow the instructions to set the new key. Please <a class='dynamsoft-major-color' href='https://www.dynamsoft.com/company/contact/' target='_blank'>contact us</a> if you need any help.</li>"),i.push("<li><strong>If you are an end-user</strong>, please inform the owner or developer of this website.</li>"),i.push("</ul></div>")),i.push("</div>"),e.DWT.ShowMessage(i.join(""),{width:s,height:0,headerStyle:1}),t.env.bMobile){var u=t.one(".ds-dwt-ui-dlg-wrap");u&&u.length>0&&(u[0].style.fontSize="1.5em",u[0].style.lineHeight="1.5em")}}function Ko(){so(this,Lo,Jo).call(this,"",!0)}function Zo(e){var r=Or,n=Or,i=Or,o=Or,a=Or,s=Or,u=Or,c=Or,l=Or;return t.isString(e)&&""!=e&&t.each(e.split(";"),(function(e){var t=1*e;t==go||t==fo||t==lo||t==ho?r=Rr:t==mo?n=Rr:t==bo?i=Rr:t==Io?o=Rr:t==wo?a=Rr:t==_o?s=Rr:t==po?u=Rr:t==vo?c=Rr:t==yo&&(l=Rr)})),{Core:r,PDFRasterizer:c,Webcam:u,barcode1D:n,QR:i,PDF417:o,DataMatrix:a,OCR:s,OCRPro:l,AndroidW:Or}}function qo(e,r){var n=so(this,Vo,Zo).call(this,e),i=so(this,Ao,Qo).call(this,r);return t.each(["Core","Html5","ActiveX","PDFRasterizer","Webcam","barcode1D","QR","PDF417","DataMatrix","OCR","OCRPro","AndroidW"],(function(e){n[e]=n[e]||i[e]})),n}function Qo(e){var t=Or,r=Or,n=Or,i=Or,o=Or,a=Or,s=Or,u=Or,c=Or,l=Or,d=Or,h=Or;return e&&""!=e&&("html5;activex;oldie"==(e=e.toLowerCase())?(i=Rr,t=Rr):"html5;activex"==e?(r=Rr,i=Rr,t=Rr):e.indexOf("html5")>-1||"win=(aph) or mac=(ph) or linux(h)"==e?(r=Rr,t=Rr):"1d barcode reader"==e?n=Rr:"2d barcode reader(qrcode)"==e?o=Rr:"2d barcode reader(pdf417)"==e?a=Rr:"2d barcode reader(data matrix)"==e?s=Rr:"ocr"==e?u=Rr:"webcam"==e?c=Rr:"pdf rasterizer"==e?l=Rr:"proocr"==e&&(d=Rr),e.indexOf("androidw")>-1&&(h=Rr,r=Rr)),{Core:t,Html5:r,ActiveX:i,PDFRasterizer:l,Webcam:c,barcode1D:n,QR:o,PDF417:a,DataMatrix:s,OCR:u,OCRPro:d,AndroidW:h}}function $o(e){var t=e.toLowerCase();return t.indexOf("wasm")>-1||t.indexOf("mobile")>-1}function ea(e){return e._isMobileMode()||!e._blts}function ta(e){return ra.apply(this,arguments)}function ra(){return(ra=Ke(it.mark((function r(n){var i,o,a;return it.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n.__calic){r.next=27;break}if(!ea(n)){r.next=5;break}r.next=27;break;case 5:return e.DWT.UseCameraAddonWasm=!0,t.detect.bNeedWasm=!0,r.next=9,no();case 9:if(!t.detect.wasmScriptLoaded){r.next=27;break}return r.next=12,oa(n._bRemoteMode);case 12:return e.DWT.li({instanceMode:e.DWT.EnumInstance.dwt_browser},""),r.next=15,zi(e.DWT.EnumInstance.dwt_browser,"");case 15:return Vn(i=r.sent),o=e.WasmEnv.licMode,r.next=20,e.WasmEnv.getLicenseInfo(i.ar,o,i.cu);case 20:if((a=r.sent)&&!a.message){r.next=25;break}return t.Errors.LicenseEmptyOrInvalid(n),a&&a.message&&(n._errorString=a.message),r.abrupt("return");case 25:n.__calic=a,n.__calic.LTS=!0;case 27:case"end":return r.stop()}}),r)})))).apply(this,arguments)}function na(){return ia.apply(this,arguments)}function ia(){return(ia=Ke(it.mark((function r(){var n,i;return it.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Hi();case 2:if(n=r.sent,!t.isString(n)||""==n){r.next=5;break}return r.abrupt("return",n);case 5:return r.next=7,zi(e.DWT.EnumInstance.dwt_browser,"");case 7:return(i=r.sent)&&i.cu&&Vn(i),r.abrupt("return",i.cu);case 10:case"end":return r.stop()}}),r)})))).apply(this,arguments)}function oa(e){return aa.apply(this,arguments)}function aa(){return(aa=Ke(it.mark((function r(n){var i,o,a,s;return it.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t.License.isLTS()){r.next=2;break}return r.abrupt("return");case 2:if(r.prev=2,i=e.DWT.li({instanceMode:e.DWT.EnumInstance.dwt_desktop},""),!e.navInfoSync.bMobile||e.navInfoSync.bAndroid){r.next=11;break}if(!n){r.next=10;break}return r.next=8,na();case 8:o=r.sent,t.isString(o)&&""!=o&&e.DWT.lsmid(o,"");case 10:return r.abrupt("return");case 11:if(i){r.next=28;break}return r.prev=12,r.next=15,jn();case 15:return a=r.sent,r.next=18,sa(a);case 18:r.next=28;break;case 20:if(r.prev=20,r.t0=r["catch"](12),t.log(r.t0),!n){r.next=28;break}return r.next=26,na();case 26:s=r.sent,t.isString(s)&&""!=s&&e.DWT.lsmid(s,"");case 28:r.next=33;break;case 30:r.prev=30,r.t1=r["catch"](2),t.log(r.t1);case 33:case"end":return r.stop()}}),r,null,[[2,30],[12,20]])})))).apply(this,arguments)}function sa(e){return ua.apply(this,arguments)}function ua(){return(ua=Ke(it.mark((function r(n){var i;return it.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!n){r.next=7;break}if(!(t.isArray(n.result)&&n.result.length>3)){r.next=5;break}i=n.result[3],r.next=7;break;case 5:if(!n.description){r.next=7;break}return r.abrupt("return",{code:n.exception,message:n.description});case 7:t.isString(i)&&""!=i&&(e.DWT.lsmid(i,""),e.DWT.lsmid2b(i));case 8:case"end":return r.stop()}}),r)})))).apply(this,arguments)}function ca(e,t,r,n){return la.apply(this,arguments)}function la(){return(la=Ke(it.mark((function r(n,i,o,a){var s,u,c,l,d;return it.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(ni("getLicenseInfo",n),r.prev=1,!t.License.isLTS()){r.next=19;break}if(u="",c="",""!=o){r.next=9;break}return l=!!a,n&&(l=n._bRemoteMode),r.next=9,oa(l);case 9:return r.next=11,zi(e.DWT.EnumInstance.dwt_desktop,o);case 11:return d=r.sent,c=d.ar,u=d.cu,r.next=16,i.getLicenseInfo(c,u,a);case 16:s=r.sent,r.next=22;break;case 19:return r.next=21,i.getLicenseInfo(e.DWT.ProductKey,"",a);case 21:s=r.sent;case 22:r.next=27;break;case 24:throw r.prev=24,r.t0=r["catch"](1),r.t0;case 27:return r.prev=27,ii("getLicenseInfo"),r.finish(27);case 30:return r.abrupt("return",s);case 31:case"end":return r.stop()}}),r,null,[[1,24,27,30]])})))).apply(this,arguments)}t.License=new Oo,e.DWT.isPublicLicense=function(){return e.Lib.product.bPublicLTS};var da,ha=e.navInfoSync,ga=!0,fa=!1,ma=ha.bHTML5Edition,_a=0,pa=fa;ha.bIE&&(""===(_a=ha.IEVersion)||_a>=10?0==e.DWT.IfUseActiveXForIE10Plus?ma=ga:(ma=fa,pa=ga,ha.bHTML5Edition=ma):(ma=fa,_a>=9&&(pa=ga))),pa||ma||(ma=ga),(da={name:"Dynamic Web TWAIN",bHTML5Edition:ma,bActiveXEdition:pa,_iImageCaptureDriverType:3,_iBrokerProcessType:1,getChromeEditionPath:e.dcp.getDSPath,getPKGPath:function(){return e.DWT.ResourcesPath+"/dist/mac/DynamicWebTWAINMacEdition.pkg"},getMSIPath:function(){return e.DWT.ResourcesPath+"/dist/win/DynamicWebTWAINPlugIn.msi"},getActiveXCABx86Path:function(){return e.DWT.ResourcesPath+"/dist/win/ActiveX/DynamicWebTWAIN.cab"},getActiveXCABx64Path:function(){return e.DWT.ResourcesPath+"/dist/win/ActiveX/DynamicWebTWAINx64.cab"},onlineResources:"https://demo.dynamsoft.com/DWT/Resources/",strMIMEType:"Application/DynamicWebTwain-Plugin",strFullClassID:"E7DA7F8D-27AB-4EE9-8FC0-3FEC9ECFE758",scripts:{},dwtConfigLoaded:!1,dwtConfigLoading:!1,getServerVersionInfo:function(t){var r=e.DWT.ServerVersionInfo;return ha.bWin||(ha.bMac?r=e.DWT.ServerMacVersionInfo:(ha.bLinux||ha.bAndroid||ha.bChromeOS||ha.bHarmonyOS)&&(r=e.DWT.ServerLinuxVersionInfo)),t?r:e.Lib.replaceAll(r,",","")},getDWTPrefix:function(){return!0===e.DWT.CustomMode?"dwtc_":"dwt_"},loadResourcePath:!1,loadingResourcePath:!1,handshakeCode:undefined,organizationID:undefined,licenseServer:undefined,sessionPassword:"",bPublicLTS:!0,refProductKey:undefined,ltsDebug:!1,bDWTLoading:!1,bAndroidConnected:!1,unloadQueue:[],appendBrowserLicenseWhenServiceMode:ta,CustomizableDisplayInfo:d,bFullEdition:!1}).bChromeEdition=da.bHTML5Edition;var va=da,ya=e.navInfoSync,ba=ya.bWin,Ia=ya.bMac,wa=ya.bLinux,Sa=ya.bSafari,Ta=ya.bFirefox,Ca=ya.bChrome,Ea=location.hostname,Ma=location.pathname,Da=0,ka=ya.bMobile,xa=parseFloat(ya.strBrowserVersion);if(ya.bWin||ya.bMac||ya.bLinux||ya.bChromeOS){if(e.navInfo){var Pa=e.navInfo;ka=ka||Pa.bAndroid||Pa.bPad||Pa.biPhone||Pa.biPad}}else ka=!0;""===Ea?ba&&Ma.lastIndexOf("\\")>1?Ma=Ma.substring(1,Ma.lastIndexOf("\\")).replace(/%20/g," "):(Da=1,Ma=Ma.substring(1,Ma.lastIndexOf("/")).replace(/%20/g," ")):(Da=1,Ma=Ma.substring(0,Ma.lastIndexOf("/")));var Wa={bChrome:Ca,bFirefox:Ta,bSafari:Sa,bIE:ya.bIE,bEdge:ya.bEdge,bWin:ba,bMac:Ia,bLinux:wa,iPluginLength:0,bFileSystem:ya.bFileSystem,bMobile:ka,strIEVersion:ya.IEVersion,strChromeVersion:ya.bChrome?xa:"",strFirefoxVersion:ya.bFirefox?xa:"",basePath:Ma,pathType:Da,isDesktopViewer:function(){return e.navInfoSync.bWin||e.navInfoSync.bLinux||e.navInfoSync.bChromeOS||e.navInfoSync.bMac},isPadViewer:function(){return e.navInfoSync.bPad||e.navInfoSync.biPad},isMobileViewer:function(){return e.navInfoSync.bMobile||e.navInfoSync.biPhone||e.navInfoSync.bAndroid||e.navInfoSync.bHarmonyOS},isWasmUseFastcomp:function(){if(e.navInfoSync.bUseUserAgent){var r=parseInt(e.navInfoSync.strBrowserVersion);if(e.navInfoSync.bSafari&&r>=13)return!1;if(e.navInfoSync.bFirefox&&r>=94)return!1;if(e.navInfoSync.bChrome&&r>=94)return!1}else{var n=navigator.userAgentData,i=[],o=0;"brands"in n&&t.isArray(n.brands)&&n.brands.length>0?i=n.brands:"uaList"in n&&t.isArray(n.uaList)&&n.uaList.length>0&&(i=n.uaList);for(o=0;o<i.length;o++){var a=i[o];if(a.brand&&("Chromium"==a.brand||"Google Chrome"==a.brand)&&a.version&&parseInt(a.version,10)>=94)return!1}}return!0}},La={getHex:function(e){var t=Number(e).toString(16).toUpperCase();return 1==t.length&&(t=["0",t].join("")),t},getColor:function(e){var t,r,n;return n=e>>16,r=(65280&e)>>8,t=255&e,["#",La.getHex(n),La.getHex(r),La.getHex(t)].join("")},RGB2BGR:function(e){return(255&e)<<16|65280&e|e>>16}};La.BGR2RGB=La.RGB2BGR;var Fa=document.location.protocol,Va=location.hostname,Na=e.navInfoSync.bSSL;t.env=Wa,t.product=va,t.mix(t,La),t.BIO=wn,e.MSG={Loading:"Processing...",LoadingTiff:"Processing tiff...",LoadingPdf:"Processing pdf...",Encoding:"Processing...",ConvertingToBlob:"Converting to blob...",ConvertingToBase64:"Converting to base64...",SavingPdf:"Saving pdf...",SavingTiff:"Saving tiff...",Downloading:"Downloading...",Uploading:"Uploading...",Wasm_Initializing:"Initializing...",Init_LookingLicense:"Looking for license...",Init_LoadingViewerJs:"Loading the viewer script...",Init_AllJsLoaded:"All scripts loaded.",Init_FireBeforeInitEvt:"OnWebTwainWillInit triggered.",Init_InitActiveX:"Initializing the ActiveX...",Init_InitH5:"Initializing...",Init_InitWasm:"Initializing WebAssembly mode...",Init_DownloadingWasm:"Downloading WebAssembly code...",Init_CompilingWasm:"Compiling WebAssembly code...",Init_InitDynamsoftService:"Initializing the Service mode...",Init_CheckDWT:"Looking for the service module...",Init_CheckDWTVersion:"Checking the service module...",Init_CreatingDWT:"Creating a WebTwain instance...",Init_ConfiguringDWT:"Configuring the WebTwain instance...",Init_SetLicenseForDWT:"Activating the WebTwain instance...",Init_GetLicenseInfoForDWT:"Decoding the license...",Init_CheckingLicense:"Checking the license...",Err_BrowserNotSupportWasm:"It looks like your browser doesn't support the WebAssembly technology which is required to use the library.",Err_ServiceModeNotSupportMobile:"Service Mode does not support your Operating System. Please contact the site administrator.",Err_ServiceEditionNotSupportWasm:"Service Edition does not support Wasm Mode."};var Aa={config:{debug:Or,devMode:Or,bDiscardBlankImage:Or,msg:[],msgPrefix:'<span style="color:#cE5E04"><b>',msgSuffix:"</b></span><br />"},detect:{ssl:Na,dcpStatus:0,dcpCallbackType:0,arySTwains:[],bFirst:Rr,bOK:Or,__dialog:Or,scriptLoaded:Or,wasmScriptLoaded:Or,wasmPdfReaderLoaded:Or,cssLoaded:Or,viewerScriptLoaded:Or,bNoControlEvent:Or,bNeedUpgradeEvent:Or,bPromptJSOrServerOutdated:Or,bNeedWasm:Or,detectType:Na?1:"http:"===Fa||""===Va?0:-1,tryTimes:0,ports:[{port:e.DWT.SSLPort,ssl:Rr},{port:e.DWT.Port,ssl:Or}],cUrlIndex:0,urls:[],onNoControl:Or,needUpgrade:Or,OnDetectNext:Or,OnCreatWS:Or,bMaskShow:Or},page:{bUnload:Or,OnUnload:Or},tmp:{IfAllowLocalCache:Rr,EmptyFunction:function(){}},appendMessage:function(t){"string"==typeof t?Aa.config.msg.push(t):"[object Array]"===Object.prototype.toString.call(t)&&e.Lib.each(t,(function(e){Aa.appendMessage(e)}))},appendRichMessage:function(e){Aa.appendMessage([Aa.config.msgPrefix,e,Aa.config.msgSuffix])},clearMessage:function(){return Aa.config.msg.splice(0),Rr},getRealPath:function(e){return e===undefined?"":1==Aa.env.pathType?Aa.env.basePath+e:Aa.env.basePath+e.replace(new RegExp("/","g"),"\\\\")},isLocalIP:function(e){return e===undefined||e&&("127.0.0.1"===e||"localhost"===e||"local.dynamsoftwebtwain.com"===e||"local.dynamsoft.com"===e)},IsNeedLoadWasm:function(){return!t.product.bActiveXEdition&&(!!t.product.bFullEdition&&(t.detect.bNeedWasm||!1===t.product.UseLocalService||t.product.UseLocalService&&t.env.bMobile||e.DWT.UseBarcodeAddonWasm))},getShadowRoot:function(e){var r=e;if(t.win.ShadowRoot)for(;r;){if(r instanceof t.win.ShadowRoot)return r;r=r.parentNode}return!1},isShadowRoot:function(e){return!!(t.win.ShadowRoot&&e instanceof t.win.ShadowRoot)}};t.mix(t,Aa),t.Addon_Events=[],t.Addon_Sendback_Events=[],t.install={_divDWTNonInstallContainerID:"dwt-NonInstallContainerID",_divDWTemessageContainer:"",_dlgInstall:!1},t.install._strNonInstallDIV=['<div style="text-align:center;" id="',t.install._divDWTNonInstallContainerID,'"></div>'].join("");var Ba=e.DWT;Ba.CloseDialog=function(){var e=t.install._dlgInstall;if(e){var r=t.all(".dynamsoft-dialog-close");t.each(r,(function(e,r){t.removeEventListener(e,"click",Ba.CloseDialog)})),e.open&&e.close(),document.body.removeChild(e),t.install._dlgInstall=!1}},Ba.ShowDialog=function(e,t,r,n,i){if(!1!==r){var o,a={width:e,height:t,position:"absolute"};n?(o=['<div class="dynamsoft-dwt-dialog-body">',r,"</div>"].join(""),a.closeButton=!1):o=['<div class="ds-dwt-ui-showdlg">','<div class="dynamsoft-dwt-dialog-body">','<div class="dynamsoft-dwt-dlg-header">',i?"":'<div class="dynamsoft-dialog-close"></div>',"</div>",r,"</div>","</div>"].join(""),i&&(a.closeButton=!1),Ba.ShowMessage(o,a)}},Ba.ShowMessage=function(r,n){var i,o,a,s,u,c=t.install,l="ds-dwt-ui-dlg",d="ds-dwt-ui-dlg-wrap",h=screen.width,g=!0,f=0,m=!0,_=!0,p=0,v="fixed",y="Error",b=t.product.bActiveXEdition,I=!1,w=null;if(n&&(i=n.width,o=n.height,n.seconds&&(f=n.seconds),n.headerStyle&&(p=n.headerStyle),1==n.backgroundStyle&&(I=!0),!1===n.closeButton&&(m=!1),n.bAutoClose&&(a=n.bAutoClose,m=!0),0==n.bReadyClosed&&(g=!1),n.position&&(v=n.position),n.caption&&(y=n.caption),t.isFunction(n.onClose)&&(w=n.onClose)),i?i>h-10&&(i=h-10):i=h>600?600:h-10,o||(o="100%"),1==p?r=['<div class="dynamsoft-dialog">','<div class="dynamsoft-dwt-dialog-body">','<div class="dynamsoft-dwt-dlg-header">',m?'<div class="dynamsoft-dialog-close"></div>':"","</div>",r,"</div></div>"].join(""):2==p&&(r=['<div class="dynamsoft-dialog">','<div class="dynamsoft-dwt-ltsdlg-header"><span style="color:#FFF;line-height:35px;margin-left:15px">',y,"</span>",m?'<div class="dynamsoft-dialog-close"></div>':"","</div>",'<div class="dynamsoft-dwt-ltsdlg-body" style="padding:25px 50px 20px 50px;">',r,"</div></div>"].join("")),0==t.one("."+l).length){var S=document.createElement("div"),T=document.createElement("div"),C=document.createElement("div");if(S.className=l,T.className=d,T.style.margin="auto",T.style.zIndex="9999",T.style.position="relative",T.style.border="0",a&&((s=document.createElement("div")).className="dynamsoft-dialog-close",T.insertBefore(s,T.firstElementChild),(u=document.createElement("div")).className="dynamsoft-dialog-closeTimer",u.style.width="100%",u.style.height="2px",u.style.marginTop="-2px",u.style.backgroundColor="#fe8e14",T.insertBefore(u,T.firstElementChild)),T.appendChild(C),C.innerHTML=r,S.appendChild(T),document.body.appendChild(S),w){var E=t.one(".dynamsoft-dialog-close",t.one(S));E&&((E=E[0]).onClose=function(){t.removeEventListener(E,"click",E.onClose),E.onClose=null,w()},t.addEventListener(E,"click",E.onClose))}if(I?t.setBackOpacity({opacity:.4,grayHex:0}):t.setBackOpacity({}),c._dlgInstall=S,t.dialog.setup(c._dlgInstall,!1),e.navInfoSync.bIE){var M=document.createElement("iframe");M.frameborder="0",M.marginheight="0",M.marginwidth="0",M.style.border="0",M.style.backgroundColor="transparent",M.style.position="absolute",M.style.left=0,M.style.top=0,M.style.width="100%",M.style.height=document.body.clientHeight+"px",M.style.margin="0 auto",M.style.zIndex="9990",M.src=["javas","cript:",'""'].join("");var D=t.one(".dynamsoft-backdrop");D&&D.length>0&&(D[0].innerHTML="",D[0].appendChild(M))}}else _=!1;var k=t.one("."+d);if(k&&k.getEL()&&(k[0].style.width=i+"px",t.isNumber(o)&&o>0?k[0].style.height=o+"px":k[0].style.height="100%",_||t.each(k[0].childNodes,(function(e){if("DIV"==e.tagName&&"dynamsoft-dialog-close"!=e.className&&"dynamsoft-dialog-closeTimer"!=e.className)return e.innerHTML=r,!1}))),b){var x=t.one(".dynamsoft-dialog");x&&x.getEL()&&(x.getEL().style.border="1px solid #999")}if(c._dlgInstall.open&&c._dlgInstall.close(),c._dlgInstall.showModal({position:v}),c._dlgInstall.bReadyClosed=g,I&&t.setBackOpacity({}),m){var P=t.all(".dynamsoft-dialog-close");t.each(P,(function(e,r){t.addEventListener(e,"click",Ba.CloseDialog)})),P.length>0&&a&&f>0&&setTimeout(t._zdgb_xkz_dhk,100)}},Ba.OnWebTwainPreExecute||(Ba.OnWebTwainPreExecute=function(t,r){e.Lib.detect.OnWebTwainPreExecute(e.DWT.IfConfineMaskWithinTheViewer,t,r)}),Ba.OnWebTwainPostExecute||(Ba.OnWebTwainPostExecute=function(){e.Lib.detect.OnWebTwainPostExecute()}),e.OnWebTwainPreExecuteCallback||(e.OnWebTwainPreExecuteCallback=function(e,r){t.isFunction(Ba.OnWebTwainPreExecute)&&Ba.OnWebTwainPreExecute(e,r)}),e.OnWebTwainPostExecuteCallback||(e.OnWebTwainPostExecuteCallback=function(){t.isFunction(Ba.OnWebTwainPostExecute)&&Ba.OnWebTwainPostExecute()});function Oa(){var r=d,n=e.DWT&&e.DWT.CustomizableDisplayInfo;n&&t.isString(n.loaderBarSource)&&""!=n.loaderBarSource?t.loaderBarSource=n.loaderBarSource:e.navInfoSync.bIE?t.loaderBarSourceIE=r.loaderBarSource:t.loaderBarSource=r.loaderBarSource,n&&t.isString(n.loaderBarClassName)&&""!=n.loaderBarClassName?t.loaderBarClassName=n.loaderBarClassName:t.loaderBarClassName=r.loaderBarClassName,n&&t.isString(n.loaderBarBackgroundColor)?t.loaderBarBackgroundColor=n.loaderBarBackgroundColor:t.loaderBarBackgroundColor=r.loaderBarBackgroundColor}t.win.DCP_DWT_OnClickCloseInstall=function(t,r){var n=e.Lib;r||e.DWT.CloseDialog();var i=n.get(n.install._divDWTNonInstallContainerID);if(i&&i.parentNode&&i.parentNode.removeChild(i),t&&n.isDOM(t)&&n.show(t),t&&n.isString(t))n.show(t);else{var o,a;if(a=e.DWT.Containers)for(o=0;o<a.length;o++)a[o].ContainerId&&n.show(a[o].ContainerId);if(a=e.DWT.DynamicContainers)for(o=0;o<a.length;o++)a[o].ContainerId&&n.show(a[o].ContainerId);a=null}""!=n.install._divDWTemessageContainer&&n.show(n.install._divDWTemessageContainer)},t.detect.showMask=function(r,n){t.detect.bMaskShow=!0,e.DWT.ScanDirectly||t.isFunction(e.OnWebTwainPreExecuteCallback)&&e.OnWebTwainPreExecuteCallback(r,n)},t.detect.OnWebTwainPreExecute=function(r,n,i){var o,a,s=r;if(s&&(n?a=n._containerElement:e.DWT.Containers&&e.DWT.Containers.length>0&&e.DWT.Containers[0].ContainerId&&(a=e.Lib.get(e.DWT.Containers[0].ContainerId)),a)){o=a.getBoundingClientRect();var u=a.firstElementChild;if(u){for(u=u.firstElementChild;u;){if(t.isFunction(u.getBoundingClientRect)){o=u.getBoundingClientRect();break}u=u.nextSibling}a=u}}(o==undefined||e.DWT.Containers&&e.DWT.Containers.length>1||e.DWT.Containers&&1==e.DWT.Containers.length&&(0==o.width||0==o.height))&&(s=!1,a=null);var c=null!=i?i:{};s&&(c={confined:s,wrapperEl:a}),t.showMask(c)},t.detect.hideMask=function(){t.detect.bMaskShow=!1,e.DWT.ScanDirectly||t.isFunction(e.OnWebTwainPostExecuteCallback)&&e.OnWebTwainPostExecuteCallback()},t.detect.OnWebTwainPostExecute=t.hideMask,t.domReady((function(){var e=document.createElement("style"),t=["dialog[open]{display:block}dialog[closed]{display:none}.dynamsoft-backdrop{position:fixed;background:rgba(128,128,128,0.1);top:0;bottom:0;left:0;right:0;z-index:-99999999;}.dynamsoft-dwt-dialogProgress{width:330px;background:#FFF}.dynamsoft-finalMessage{margin:0;color:#3a3a3a;font:20px Arial,sans-serif}.dynamsoft-desc{margin:7px 0;color:#3a3a3a;font:14px Arial,sans-serif}.dynamsoft-status{color:#555;font:14px/22px Arial,sans-serif;margin-bottom:5px}.dynamsoft-progressBar{-webkit-appearance:none;width:280px;margin-bottom:20px;height:14px}.dynamsoft-progressBar,.dynamsoft-progressBar::-webkit-progress-bar{background-color:#e7e7e7;border-radius:7px}.dynamsoft-progressBar::-webkit-progress-value,.dynamsoft-progressBar::-moz-progress-bar{background-color:#50a8e1;border-radius:7px}.dynamsoft-loadingMsg{width:290px;height:290px;margin:auto;color:#CCC;border-width:1px;background:#FFF}.dynamsoft-loadingMsg-msg{margin:0 0 15px 25px;color:#3a3a3a;font:20px Arial,sans-serif}.dynamsoft-loadingMsg-desc{text-align:center;margin:0 0 15px 0;color:#3a3a3a;font:14px Arial,sans-serif}.ds-dwt-loaderBar-noserver-parent{height:100%;}.ds-dwt-loaderBar-noserver{margin: 0 auto;padding-top: 50px;text-align: center;}.ds-dwt-loaderBar-noserver img{height: 100px}"].join("");e.type="text/css";try{e.appendChild(document.createTextNode(t))}catch(r){e.styleSheet.cssText=t}document.body.appendChild(e)})),t._zdgb_xkz_dhk=function(){var r=t.install._dlgInstall;if(r){var n=t.one(".dynamsoft-dialog-closeTimer",r);if(n.getEL()){var i=parseInt(n.getEL().style.width);(i-=1)<=0?e.DWT.CloseDialog():(n.getEL().style.width=i+"%",setTimeout(t._zdgb_xkz_dhk,100))}}},t.ShowLicenseDialog=e.DWT.ShowMessage,t.createLoadingBarContent=function(){},t.openLoadingMsg=function(){t.product.bHTML5Edition&&(Oa(),t.env.bMobile&&ni("openLoadingMsg",null,{width:"280px"}))},t.showLoadingMsg=function(){},t.closeLoadingMsg=function(e){t.product.bHTML5Edition&&t.env.bMobile&&ii("closeLoadingMsg:"+e)};var Ra=!0;function Ua(){if(Ra){var r=e.DWT.CustomizableDisplayInfo,n={};t.mix(n,d),r&&(r.loaderBarClassName&&(n.loaderBarClassName=r.loaderBarClassName),r.loaderBarSource&&(n.loaderBarSource=r.loaderBarSource),r.loaderBarWidth&&(n.loaderBarWidth=r.loaderBarWidth),r.loaderBarHeight&&(n.loaderBarHeight=r.loaderBarHeight),r.errorMessages&&t.mix(n.errorMessages,r.errorMessages),r.generalMessages&&t.mix(n.generalMessages,r.generalMessages),r.customProgressText&&t.mix(n.customProgressText,r.customProgressText),r.buttons&&(r.buttons.titles&&t.mix(n.buttons.titles,r.buttons.titles),r.buttons.bShowAllButtons&&t.mix(n.buttons.bShowAllButtons,r.buttons.bShowAllButtons),r.buttons.visibility&&t.mix(n.buttons.visibility,r.buttons.visibility)),r.dialogText&&t.mix(n.dialogText,r.dialogText)),e.Lib.product.CustomizableDisplayInfo=n,Oa(),Ra=!1}}t._funsAfterConfigLoaded=[],t._safePromptCustomMsg=function(e){t.product.loadResourcePath?(Ua(),e&&e()):e&&t._funsAfterConfigLoaded.push(e)};var Ga=e.navInfoSync,ja=t.win,za=ja.document;function Ha(){var r=l;if(e.DWT.CertificateConfig){var n=e.DWT.CertificateConfig;t.isString(n.URL)||(n.URL=r.URL),(!t.isNumber(n.UpdateDaysBeforeExpired)||n.UpdateDaysBeforeExpired<=0)&&(n.UpdateDaysBeforeExpired=r.UpdateDaysBeforeExpired)}else e.DWT.CertificateConfig=r;t.isString(e.DWT.ProductKey)&&(e.DWT.ProductKey=t.trim(e.DWT.ProductKey)),e.navInfoSync.bAndroid&&"127.0.0.1"==e.DWT.Host&&(e.DWT.Host="local.dynamsoft.com"),t.product.bFullEdition?t.isUndefined(e.DWT.UseLocalService)?t.env.bMobile?t.product.UseLocalService=!1:t.product.UseLocalService=!0:t.env.bMobile&&!e.navInfoSync.bAndroid?t.product.UseLocalService=!1:t.product.UseLocalService=e.DWT.UseLocalService:t.product.UseLocalService=!0,e.navInfo&&(e.navInfoSync.bMac||e.navInfoSync.bWin)&&(e.navInfo.bEmbed=!1,e.navInfo.bArm64=!1,e.navInfo.bMips64=!1)}function Xa(){if(t.detect.cssLoaded)return t.Promise.resolve();var r=e.DWT.ResourcesPath,n="";Ga.bFileSystem||(n=t.timestamp);var i=[[r,"/src/dynamsoft.webtwain.css",n].join("")];return t.product.bHTML5Edition&&e.DWT.UseDefaultViewer&&i.push([r,"/src/dynamsoft.viewer.css",n].join("")),new t.Promise((function(r){e.navInfoSync.bSafari?(t.addAllCss(i,!1,(function(){t.detect.cssLoaded=Rr})),t.detect.cssLoaded=Rr,r()):t.addAllCss(i,!1,(function(){t.detect.cssLoaded=Rr,r()}))}))}function Ya(r){if(Ha(),t.product.loadResourcePath||t.product.loadingResourcePath)return t.product.loadResourcePath?Xa():t.Promise.resolve();t.product.loadingResourcePath=!0,(e.DWT.Port>0||e.DWT.SSLPort>0)&&(t.detect.ports=[{port:e.DWT.Port,ssl:!1},{port:e.DWT.SSLPort,ssl:!0}],t.LS.removeItem("DWT_port"),t.LS.removeItem("DWT_ssl")),Ua(),t._safePromptCustomMsg(),t.each(t._funsAfterConfigLoaded,(function(e){try{t.isFunction(e)&&e()}catch(r){}})),t.showLoadingMsg(-1,"",e.MSG.Init_LookingLicense);var n=t.one(".dynamsoft_waiting").getEL();n&&n.parentNode&&n.parentNode.removeChild(n);var i=e.DWT.ResourcesPath,o="";Ga.bFileSystem||(o=t.timestamp);var a=Rr,s=[];Ga.bSafari&&(a=Or),s.push([i,"/dynamsoft.webtwain.install.js",o].join("")),e.DWT.bNpm&&(s=[]),t.product.bHTML5Edition&&e.DWT.UseDefaultViewer&&s.push([i,"/src/dynamsoft.viewer.js",o].join(""));var u=!1;return e.navInfoSync.bIE&&(u=e.navInfoSync.strBrowserVersion<=7),!u&&t.License.isLTS()&&s.push([i,"/src/dynamsoft.lts.js",o].join("")),s.length>0&&t.showLoadingMsg(-1,"",e.MSG.Init_LoadingViewerJs),Xa().then((function(){return new t.Promise((function(r,n){t.addScripts(s,a,!1,(function(i){if(!i)return t.product.loadingResourcePath=!1,t.getLogger().error("load js failed."),void n();if(t.showLoadingMsg(-1,"",e.MSG.Init_AllJsLoaded),t.detect.scriptLoaded=!0,t.product.bHTML5Edition&&(t.closeAll=t.html5.closeAll),t.product.bFullEdition?t.isUndefined(e.DWT.UseLocalService)?t.env.bMobile?t.product.UseLocalService=!1:t.product.UseLocalService=!0:t.env.bMobile&&!e.navInfoSync.bAndroid?t.product.UseLocalService=!1:t.product.UseLocalService=e.DWT.UseLocalService:t.product.UseLocalService=!0,t.product._srcUseLocalService=t.product.UseLocalService,t.bNode||e.navInfoSync.bJSDom);else if(t.isArray(e.aryAddonReadyFun)){for(var o=0,a=function(){var r=e.aryAddonReadyFun[o];if(t.isFunction(r))try{r(t)}catch(es){t.log(es.stack||es,"error"),setTimeout((function(){throw es}),0)}};o<e.aryAddonReadyFun.length;o++)a();e.aryAddonReadyFun=[]}t.product.loadResourcePath=!0,t.product.loadingResourcePath=!1,e.DWT.OnWebTwainWillInit&&e.DWT.OnWebTwainWillInit(),r()}))}))}))}var Ja=[];function Ka(){var e,t=Ja.length;for(e=0;e<t;e++)Ja[e]();Ja.splice(0)}function Za(){if(e.DWT.Containers||e.DWT.ProductKey){if(t.product.dwtConfigLoaded||t.product.dwtConfigLoading)return;t.product.dwtConfigLoading=!0;var r=Ga.bFileSystem,n=t.env.basePath,i=e.DWT.ResourcesPath,o="";if(t.isArray(e.DWT.Containers)||(e.DWT.Containers=[]),!r){void 0!==i&&""!=i||(i=n),i.length>0&&"/"==i.charAt(i.length-1)&&(i=i.substr(0,i.length-1)),o=t.timestamp,e.DWT.ResourcesPath=i}t.product.bActiveXEdition?t.addScript([i,"/src/dynamsoft.webtwain.activex.js",o].join(""),!0,!1,(function(){t.product.dwtConfigLoaded=!0,t.product.dwtConfigLoading=!1,Ka()})):(t.product.dwtConfigLoaded=!0,t.product.dwtConfigLoading=!1,Ka())}else setTimeout(Za,100)}function qa(){return t.product.dwtConfigLoaded?t.Promise.resolve():new t.Promise((function(e){Ja.push(e),t.domReady((function(){setTimeout(Za,100)}))}))}t.domReady((function(){Ga.bIE&&ja.addEventListener&&ja.addEventListener("unload",e.DWT.Unload,!1),ja&&(t.addEventListener(ja,"focus",(function(){var r=e.DWT.ContainerMap;r&&t.each(r,(function(e,t){e&&e._OnPageFocus&&e._OnPageFocus()}))})),t.addEventListener(ja,"blur",(function(){if(e.navInfoSync.bWin){var r=e.DWT.ContainerMap;r&&t.each(r,(function(e,t){e&&e._OnPageBlur&&e._OnPageBlur()}))}})),t.addEventListener(za,"visibilitychange",(function(){if(e.navInfoSync.bWin&&"hidden"==za.visibilityState){var r=e.DWT.ContainerMap;r&&t.each(r,(function(e,t){e&&e._OnPageBlur&&e._OnPageBlur()}))}}))),qa().then((function(){return e.DWT.Containers&&e.DWT.Containers.length>0&&e.DWT.AutoLoad})).then((function(r){if(r){if(t.product.bDWTLoading)return;return t.product.bDWTLoading=Rr,Ya().then((function(){return t.openLoadingMsg(),no().then(e.DWT._innerLoad).then((function(){t.product.bDWTLoading=!1,t.closeLoadingMsg()}),(function(){t.product.bDWTLoading=!1,t.closeLoadingMsg()}))}))}}),(function(){}))}));function Qa(r){if(t.isUndefined(r))return false;var n,i,o,a=r.toString().toLowerCase(),s=(o=a.toLowerCase().replace(t.product.name.toLowerCase()+" ",""),(o=t.replaceAll(o,"[.]",",")).split(","));n=t.product.bActiveXEdition?e.DWT.ActiveXVersion:t.product.getServerVersionInfo(!0),i=(n=t.replaceAll(String(n),"[.]",",")).split(",");for(var u=s.length>i.length?s.length:i.length,c=0;c<u;c++){if(null==s[c]&&(s[c]=0),null==i[c]&&(i[c]=0),parseInt(s[c])<parseInt(i[c]))return false;if(parseInt(s[c])>parseInt(i[c]))return true}return true}function $a(e,r){var n=e.split(","),i=r.split(",");return n.length>3&&t.trim(n[0])==i[0]&&(t.trim(n[1])>i[1]||t.trim(n[1])==i[1]&&t.trim(n[2])>i[2]||t.trim(n[1])==i[1]&&t.trim(n[2])==i[2]&&parseInt(t.trim(n[3]))>=parseInt(i[3]))}var es={553:function(e){e=function(e){var t,r=Object.prototype,n=r.hasOwnProperty,i=(v="function"==typeof Symbol?Symbol:{}).iterator||"@@iterator",o=v.asyncIterator||"@@asyncIterator",a=v.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(D){s=function(e,t,r){return e[t]=r}}function u(e,r,n,i){var o,a,s,u;r=r&&r.prototype instanceof m?r:m,r=Object.create(r.prototype),i=new C(i||[]);return r._invoke=(o=e,a=n,s=i,u=l,function(e,r){if(u===h)throw new Error("Generator is already running");if(u===g){if("throw"===e)throw r;return M()}for(s.method=e,s.arg=r;;){var n=s.delegate;if(n&&(n=function e(r,n){var i=r.iterator[n.method];if(i===t){if(n.delegate=null,"throw"===n.method){if(r.iterator["return"]&&(n.method="return",n.arg=t,e(r,n),"throw"===n.method))return f;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}return"throw"===(i=c(i,r.iterator,n.arg)).type?(n.method="throw",n.arg=i.arg,n.delegate=null,f):(i=i.arg)?i.done?(n[r.resultName]=i.value,n.next=r.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,f):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,f)}(n,s),n)){if(n===f)continue;return n}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if(u===l)throw u=g,s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);if(u=h,"normal"===(n=c(o,a,s)).type){if(u=s.done?g:d,n.arg!==f)return{value:n.arg,done:s.done}}else"throw"===n.type&&(u=g,s.method="throw",s.arg=n.arg)}}),r}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(D){return{type:"throw",arg:D}}}e.wrap=u;var l="suspendedStart",d="suspendedYield",h="executing",g="completed",f={};function m(){}function _(){}function p(){}var v,y,b=((y=(y=(s(v={},i,(function(){return this})),Object.getPrototypeOf))&&y(y(E([]))))&&y!==r&&n.call(y,i)&&(v=y),p.prototype=m.prototype=Object.create(v));function I(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){var r;this._invoke=function(i,o){function a(){return new t((function(r,a){!function s(r,i,o,a){var u;if("throw"!==(r=c(e[r],e,i)).type)return(i=(u=r.arg).value)&&"object"==typeof i&&n.call(i,"__await")?t.resolve(i.__await).then((function(e){s("next",e,o,a)}),(function(e){s("throw",e,o,a)})):t.resolve(i).then((function(e){u.value=e,o(u)}),(function(e){return s("throw",e,o,a)}));a(r.arg)}(i,o,r,a)}))}return r=r?r.then(a,a):a()}}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function E(e){if(e){var r,o,a=e[i];if(a)return a.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return r=-1,(o=function s(){for(;++r<e.length;)if(n.call(e,r))return s.value=e[r],s.done=!1,s;return s.value=t,s.done=!0,s}).next=o}return{next:M}}function M(){return{value:t,done:!0}}return s(b,"constructor",_.prototype=p),s(p,"constructor",_),_.displayName=s(p,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){return!!(e="function"==typeof e&&e.constructor)&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,s(e,a,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},I(w.prototype),s(w.prototype,o,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var a=new w(u(t,r,n,i),o);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},I(b),s(b,a,"Generator"),s(b,i,(function(){return this})),s(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t,r=[];for(t in e)r.push(t);return r.reverse(),function n(){for(;r.length;){var t=r.pop();if(t in e)return n.value=t,n.done=!1,n}return n.done=!0,n}},e.values=E,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return s.type="throw",s.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var o=this.tryEntries.length-1;0<=o;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}var a=(o=o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc?null:o)?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,f):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),f}},"catch":function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,n,i=this.tryEntries[t];if(i.tryLoc===e)return"throw"===(r=i.completion).type&&(n=r.arg,T(i)),n}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:E(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),f}},e}(e.exports);try{regeneratorRuntime=e}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}},757:function(e,t,r){e.exports=r(553)}},ts={};function rs(e){var t=ts[e];return t!==undefined||(t=ts[e]={exports:{}},es[e](t,t.exports,rs)),t.exports}rs.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return rs.d(t,{a:t}),t},rs.d=function(e,t){for(var r in t)rs.o(t,r)&&!rs.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},rs.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){function e(t,r){return(e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(t,r)}function t(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t,e(t,r)}function r(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)}function n(e){return"[object Object]"===Object.prototype.toString.call(e)}function i(e){return"function"==typeof e}function o(e){return"string"==typeof e}function a(e){return e=String(e),!!/^\d+(px|em)$|^\d+$|^(100|[1-9]?\d(\.\d\d?\d?)?)%$/.test(e)}function s(e){return"number"==typeof e&&!isNaN(e)}function u(e){return"[object Boolean]"===Object.prototype.toString.call(e)}function c(e){var t=document.createElement("span");return t.style.background=e,!!t.style.background}function l(e){var t=document.createElement("span");return t.style.border=e,!(!t.style.border&&""!==e)}function d(){return"ontouchstart"in document.documentElement}function h(e){return e instanceof HTMLElement||"[object ShadowRoot]"===Object.prototype.toString.call(e)}function g(e,t){for(var r in e)t[r]!==undefined&&n(e[r])&&n(t[r])?g(e[r],t[r]):t[r]=e[r]}function f(e,t){for(var r in e){var i=e[r],a=t[r];a===undefined?t[r]=e[r]:o(i)&&n(a)?a.visibility=i:n(i)&&n(a)?f(e[r],t[r]):t[r]=e[r]}}function m(e){var t=Math.random().toString(35).substring(2);return t.length<11&&(t+=Math.random().toString(35).substring(2)),e=Math.max(Math.min(Math.round(e),11),8),t.substring(0,e)}function _(e){var t,i;if(r(e))t=[];else{if(!n(e))return e;t={}}for(i in e){var o=e[i];r(e)||n(e)?t[i]=_(o):t[i]=o}return t}function p(e){var t=window.requestAnimationFrame||window.webkitRequestAnimationFrame,r=!!t;if(r=!(t&&!/requestAnimationFrame\(\)\s*\{\s*\[native code\]\s*\}/i.test(t.toString()))&&r)return t(e);var n={},i=null,o=+new Date;n[1]=e,null===i&&(i=setInterval((function(){var e,t=+new Date,r=n;for(e in n={},r)Object.prototype.hasOwnProperty.call(r,e)&&(r[e](t),o=t);2500<t-o&&(clearInterval(i),i=null)}),1e3/60))}function v(){var e=window;if(e){if(e.devicePixelRatio)return e.devicePixelRatio;if(e.screen.deviceXDPI&&e.screen.logicalXDPI)return e.screen.deviceXDPI/e.screen.logicalXDPI}return 1}function y(e,t,r,n,i){var o=e+r/2,a=t+n/2,s=b(e,t,o,a,i),u=b(e+r,t,o,a,i);r=b(e+r,t+n,o,a,i),e=b(e,t+n,o,a,i),t=[u.x,s.x,e.x,r.x].sort((function(e,t){return e-t})),n=[u.y,s.y,e.y,r.y].sort((function(e,t){return e-t}));return{x:t[0],y:n[0],width:t[3]-t[0],height:n[3]-n[0]}}function b(e,t,r,n,i){return i=i/180*Math.PI,{x:(e-r)*Math.cos(i)-(t-n)*Math.sin(i)+r,y:(e-r)*Math.sin(i)+(t-n)*Math.cos(i)+n}}var I=function(e){window.Dynamsoft&&window.Dynamsoft.Lib.debug&&window.Dynamsoft.Lib.log(e)},w={windowURL:window.URL||window.webkitURL,createURL:function(e){return o(e)?e:w.createURLWithType(e).data},createURLWithType:function(e){if(o(e)||undefined===e)return{type:"string",data:e};if(e instanceof Blob)return{type:"object",data:w.createObjectURL(e)};if(e.imageData&&e.imageData instanceof Blob)return{type:"object",data:w.createObjectURL(e.imageData)};if(e.imageData){var t=Object.prototype.toString.call(e.imageData);if(/\[object \w+Array\]/.test(t))return{type:"object",data:w.createObjectURL(new Blob([e.imageData]))}}else if(t=Object.prototype.toString.call(e),/\[object \w+Array\]/.test(t))return{type:"object",data:w.createObjectURL(new Blob([e]))};return/data:image\/\w+;base64/.test(e)?{type:"string",data:e}:{type:"object",data:e}},createObjectURL:function(e){return e?(e=w.windowURL.createObjectURL(e),I("createObjectURL:"+e),e):""},revokeObjectURL:function(e){I("revokeObjectURL:"+e),o(e)&&0==e.indexOf("blob:http")&&w.windowURL.revokeObjectURL(e)}},S=function(){function e(e){this._evtIds=[],this._oPub=null,this._bDisposePub=!1,e?this._oPub=e:(this._oPub=new T,this._bDisposePub=!0)}var t=e.prototype;return t.getPublishSubscribe=function(){return this._oPub},t._on=function(e,t){t=this._oPub.on(e,t),this.push(e,t)},t._emit=function(e){for(var t,r=arguments.length,n=new Array(1<r?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];null!=(t=this._oPub)&&t.emit.apply(t,[e].concat(n))},t._off=function(e,t){var r;null!=(r=this._oPub)&&r.off(e,t)},t._offById=function(e,t){var r;null!=(r=this._oPub)&&r.offById(e,t)},t.push=function(e,t){this._evtIds.push({name:e,id:t})},t.dispose=function(){if(this._oPub){for(var e=this._evtIds.length,t=0;t<e;t++){var r=this._evtIds[t];this._oPub.offById(r.name,r.id)}this._bDisposePub&&this._oPub&&this._oPub.dispose()}this._oPub=null},e}(),T=function(){function e(){this._events={}}var t=e.prototype;return t.on=function(e,t){this._events[e]||(this._events[e]=[]);var r=m(10);return this._events[e].push({fn:t,evtId:r}),r},t.emit=function(e){var t=this._events[e];if(!t||0===t.length)return!1;for(var r=t.length,n=arguments.length,i=new Array(1<n?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];for(var a,s=0;s<r;s++)null!=(a=t[s])&&(a=a.fn).call.apply(a,[null].concat(i))},t.emitEx=function(e){var t=this._events[e];if(!t||0===t.length)return Promise.resolve(!0);for(var r=t.length,n=Promise.resolve(!0),i=arguments.length,o=new Array(1<i?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];if(1===t.length)return(e=null==(e=t[0])?void 0:(e=e.fn).call.apply(e,[null].concat(o)))instanceof Promise?e:n;for(var s=function(e){var r=null==(e=t[e])?void 0:(e=e.fn).call.apply(e,[null].concat(o));r instanceof Promise&&(n=n.then((function(){return r})))},u=0;u<r;u++)s(u);return n},t.off=function(e,t){var r=this._events[e];if(!r)return!1;if(t)for(var n=r.length-1;0<=n;n--){var i=r[n];i&&i.fn===t&&r.splice(n,1),i=null}else r&&(r.length=0)},t.offById=function(e,t){var r=this._events[e];if(!r)return!1;if(t)for(var n=r.length-1;0<=n;n--){var i=r[n];if(i&&i.evtId===t){r.splice(n,1);break}i=null}else r&&(r.length=0)},t.dispose=function(){for(var e=Object.keys(this._events),t=0,r=e.length;t<r;t++){var n=e[t];(n=this._events[n])&&n.splice(0),n=null}this._events={}},e}();function C(e,t,r,i,o,a,s){try{var u=e[a](s),c=u.value}catch(n){return void r(n)}u.done?t(c):Promise.resolve(c).then(i,o)}function E(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){C(o,n,i,a,s,"next",e)}function s(e){C(o,n,i,a,s,"throw",e)}a(undefined)}))}}var M=rs(757),D=rs.n(M),k=(M="undefined"!=typeof window)&&window,x="prev",P="next",W="mousedown",L="mousemove",F="mouseup",V="pageAreaSelected",N="pageAreaUnselected",A="_canvasVisibilityChanged",B="_updateErrorMessage",O="_updateLogMessage",R="_DirectoryChanged",U="_canvasRightClick",G="_afterRender",j="_currentChanged",z="_updateThbItem",H="_setScrollerSizeUI",X="_changeCanvasCursorUI",Y="_updateForViewer",J="_loadToViewer",K="_openToViewer",Z="_loadPage",q="_removeViewerUid",Q="_changePage",$="_reorderPage",ee="_removePage",te="_editPage",re="_loadToTag",ne="_removePageTag",ie="_addPageTag",oe="_emptyTag",ae="_renameTag",se="_tagChanged",ue="_appendSync",ce="_updateSync",le="_loadToFile",de="_removeFile",he="_renameFile",ge={code:0,message:"ok."},fe={code:80001,message:"The parameter type is wrong."},me={code:80002,message:"The parameter is out of range."},_e={code:80003,message:"The image does not exist."},pe={code:80006,message:"The file does not exist."},ve={code:80009,message:"Tag does not exist."},ye={code:80010,message:"The tag already exists."},be={code:80011,message:"Element does not exist."},Ie={code:80012,message:"Page does not exist."},we={code:80013,message:"The parameter is invalid."},Se={code:80016,message:"The color is invalid."},Te={code:80017,message:"Failed to save image to database."},Ce={code:80018,message:"Failed to remove image from database by uid."},Ee={code:80020,message:"Your browser does not support full screen."},Me={code:80021,message:"The size is invalid."},De={code:80022,message:"The operation mode is error."},ke={code:80023,message:"The border is invalid."},xe={code:80026,message:"The constructor of view ui is required."},Pe={code:80032,message:"The file already exists."},We=function(){function e(){this.matrix=[],this.all=[],this.result=[],this._flipNum=0,this._flipNumX=0,this._flipNumY=0,this._tAngle=0,this._curMode=null}var t=e.prototype;return t.calc3x3Matrix=function(e,t){for(var r=[],n=0;n<3;n++)for(var i=0;i<3;i++){var o=e[3*n+0]*t[i]+e[3*n+1]*t[i+3]+e[3*n+2]*t[i+6];r.push(o)}return r},t.rotateMatrix=function(e,t,r){e=e/180*Math.PI;var n=Math.sin(e);return[e=Math.cos(e),-n,(1-e)*t+r*n,n,e,(1-e)*r-t*n,0,0,1]},t.moveMatrix=function(e,t){return[1,0,e,0,1,t,0,0,1]},t.scaleMatrix=function(e){return[e,0,0,0,e,0,0,0,1]},t.flipMatrix=function(e,t){return[1-2*Math.pow(e,2),-2*e*t,0,-2*e*t,1-2*Math.pow(t,2),0,0,0,1]},t.toCanvasMatrix=function(e){for(var t=[0,3,1,4,2,5],r=0;r<t.length;r++)t[r]=e[t[r]];return t},t.getLatestResult=function(){return 0!==this.result.length?this.result[this.result.length-1].slice():null},t.rotatePoint=function(e,t,r,n,i){return i=i/180*Math.PI,{x:(e-r)*Math.cos(i)-(t-n)*Math.sin(i)+r,y:(e-r)*Math.sin(i)+(t-n)*Math.cos(i)+n}},t.rotateRect=function(e,t,r,n,i){var o=e+r/2,a=t+n/2,s=this.rotatePoint(e,t,o,a,i),u=this.rotatePoint(e+r,t,o,a,i);r=this.rotatePoint(e+r,t+n,o,a,i),e=this.rotatePoint(e,t+n,o,a,i),t=[u.x,s.x,e.x,r.x].sort((function(e,t){return e-t})),n=[u.y,s.y,e.y,r.y].sort((function(e,t){return e-t}));return{x:t[0],y:n[0],width:t[3]-t[0],height:n[3]-n[0]}},t.calcLineEquation=function(e,t){var r=t.y-e.y,n=e.x-t.x,i=(e=t.x*e.y-e.x*t.y,t=r*r+n*n,[]);return i.push((n*n-r*r)/t,-2*r*n/t,-2*r*e/t,-2*r*n/t,(r*r-n*n)/t,-2*n*e/t,0,0,1/t),i},t.setTransform=function(e){var t=this;this.matrix.forEach((function(r){r=t.toCanvasMatrix(r),e.transform.apply(e,r)}))},t.setPointTransform=function(e,t){for(var r=0;r<this.matrix.length;r++){var n=e*(i=this.matrix[r])[0]+t*i[3],i=e*i[1]+t*i[4];e=n,t=i}return{x:e,y:t}},t.crop=function(e,t,r,n){return this._clear(),e={type:"crop",left:e,top:t,width:r,height:n},this.all.push(e),e},t.erase=function(e,t,r,n,i){return this._clear(),e={type:"erase",left:e,top:t,width:r,height:n,color:i},this.all.push(e),e},t.changePageSize=function(e,t){return this._clear(),e={type:"changeSize",width:e,height:t},this.all.push(e),e},t.flip=function(e){this._flipNum+=1;var t=this._tAngle/180*Math.PI,r=Math.cos(t),n=-Math.sin(t),i=-Math.sin(t);t=-Math.cos(t),this._flipNumX%2&&(i=-i,t=-t),this._flipNumY%2&&(r=-r,n=-n),r={x:r,y:n},n={x:i,y:t},i={x:0,y:0},t=null;if(0===e)this._flipNumX+=1,t=this.calcLineEquation(r,i);else{if(1!==e)return;this._flipNumY+=1,t=this.calcLineEquation(n,i)}return r={type:"flip",matrix:t,direction:e},this.all.push(r),this.matrix.push(t),n=(n=this.getLatestResult())?this.calc3x3Matrix(t,n):t,this.result.push(n),r},t.calcFlipMatrix=function(e,t){return[1-2*e*e,-2*e*t,0,-2*e*t,1-2*t*t,0,0,0,1]},t.rotate=function(e,t,r,n){var i=!1,o=(null!==this._curMode&&(i=this._curMode===n||(this._clear(),!1)),this._curMode=n,this._flipNum%2&&(e=-e),this._tAngle+=e,e);r={type:"rotate",matrix:t=this.rotateMatrix(e,t||0,r||0),mode:n,angle:e,calcAngle:o=i?this._tAngle:o};return this.all.push(r),this.matrix.push(t),n=(n=this.getLatestResult())?this.calc3x3Matrix(t,n):t,this.result.push(n),r},t.translate=function(e,t){e=this.moveMatrix(e,t),this.all.push(e),this.matrix.push(e),t=(t=this.getLatestResult())?this.calc3x3Matrix(e,t):e,this.result.push(t)},t.calcTranslateDis=function(e,t){var r=this._tAngle/180*Math.PI,n=e*Math.cos(r),i=(e=-e*Math.sin(r),t*Math.sin(r));t*=Math.cos(r);return this._flipNumX%2&&(i=-i,t=-t),this._flipNumY%2&&(n=-n,e=-e),{x:n+i,y:e+t}},t.reset=function(){this.all=[],this._clear(),this._curMode=null},t.getCurAngle=function(){return this._tAngle},t._clear=function(){this.result=[],this.matrix=[],this._tAngle=0,this._flipNumX=0,this._flipNumY=0,this._flipNum=0},e}(),Le=function(){function e(e,t){this.uid=null,this.minData=null,this.oriData=null,this.customData={},this.tags=[],this.active=!1,this.activeMin=!1,this.minTask=null,this.load=!1,this.show=[],this.overlays=[],this.img=null,this.edt=null,this.vws=[],this.oriType=null,this.minType=null,this.tempWidth=0,this.tempHeight=0,this.uid=e,this.setTempSize(t.width,t.height),this.edt=new We}var t=e.prototype;return t.setTempSize=function(e,t){this.tempWidth=e,this.tempHeight=t},t.addViewer=function(e){-1===this.vws.indexOf(e)&&this.vws.push(e)},t.rmViewer=function(e){-1!==(e=this.vws.indexOf(e))&&this.vws.splice(e,1)},t.setTags=function(e){e.length<1||(this.tags=e.slice())},t.getTags=function(){return this.tags.slice()},e}(),Fe=function(e){function i(t,r,n){var i=e.call(this,r)||this;return i._db=n,i._on(ue,(function(e,t){i.appendSync(e,t)})),i._initEvent(),i}t(i,e);var a=i.prototype;return a.dispose=function(){e.prototype.dispose.call(this),this._db=null},a._initEvent=function(){var e=this;this._on(ce,(function(t,r,n){e.updateSync(t,r,n)})),this._on(ee,(function(t,r){r.forEach((function(t){var r,n=e._db.getMid(t);n&&(o(n.oriData)&&w.revokeObjectURL(n.oriData),o(n.minData)&&w.revokeObjectURL(n.minData),(r=n.img)&&(r.src="",r.onload=null,r.onerror=null,n.img=null)),e._db.removeMid(t),e._db.getDataAsync(t).then((function(e){o(e.oriData)&&w.revokeObjectURL(e.oriData),o(e.minData)&&w.revokeObjectURL(e.minData)}))["catch"]((function(e){})),e._db.removeDataAsync(t),e._db.removeMetadata(t)}))})),this._on(ae,(function(t,r,n){n.forEach((function(n){var i,o=e._db.getMid(n);o&&-1!==(i=o.tags.indexOf(t))&&o.tags.splice(i,1,r),e._db.getDataAsync(n).then((function(i){var o;i.tags&&-1!==(o=i.tags.indexOf(t))&&(i.tags.splice(o,1,r),e._db.updateDataAsync(n,i)["catch"]((function(e){})))}))["catch"]((function(e){}))}))})),this._on(oe,(function(t,r,n){r.forEach((function(r){var n,i=e._db.getMid(r);i&&-1!==(n=i.tags.indexOf(t))&&i.tags.splice(n,1),e._db.getDataAsync(r).then((function(n){var i;n.tags&&-1!==(i=n.tags.indexOf(t))&&(n.tags.splice(i,1),e._db.updateDataAsync(r,n)["catch"]((function(e){})))}))["catch"]((function(e){}))}))})),this._on(ie,(function(t,r,n){var i=e._db.getMid(t);i&&-1===i.tags.indexOf(r)&&i.tags.push(t),e._db.getDataAsync(t).then((function(n){n.tags&&-1===n.tags.indexOf(r)&&(n.tags.push(t),e._db.updateDataAsync(t,n)["catch"]((function(e){})))}))["catch"]((function(e){}))})),this._on(ne,(function(t,r,n){var i,o=e._db.getMid(t);o&&-1!==(i=o.tags.indexOf(r))&&o.tags.splice(i,1),e._db.getDataAsync(t).then((function(n){var i;n.tags&&-1!==(i=n.tags.indexOf(r))&&(n.tags.splice(i,1),e._db.updateDataAsync(t,n)["catch"]((function(e){})))}))["catch"]((function(e){}))}))},a.appendSync=function(e,t){return this._ckStr(e)&&this._ckArray(t)?(e=this._load(e,t),this._ok(),e):[]},a.insertSync=function(e,t,r){return this._ckStr(e)&&this._ckArray(t)?r===undefined?this.appendSync(e,t):(e=this._load(e,t,r),this._ok(),e):(this._thrEr(fe),[])},a.updateSync=function(e,t,r){void 0===r&&(r=!0),this._emit(O,"Invoking DataControl#updateSync.");var n=this._db.getMid(e);if(!n)return!1;this._db.updateMetadata(e,t.metadata),t.customData&&(n.customData=t.customData),t.tags&&n.setTags(t.tags),r&&(w.revokeObjectURL(n.oriData),w.revokeObjectURL(n.minData)),n.minData=null,!n.overlays.length&&t.minData&&o(t.minData)&&(n.minData=t.minData),n.oriData=null,n.img=null,n.active=!1,n.activeMin=!1,n.minTask=null,n.edt.reset(),n.setTempSize(t.metadata.width,t.metadata.height),this._db.updateMid(e,n),t.tags||(t.tags=n.getTags()),t.customData||(t.customData=n.customData),this._db.updateDataAsync(e,t),this._emit(Y,e,t)},a._load=function(e,t,r){for(var n=this,i=[],a=[],s=t.length,u=function(e){var r={uid:m(11),data:t[e]};a.push(r),i.push(r.uid),e=Object.assign({},r.data.metadata),n._db.addMetadata(r.uid,e),n._db.addDataAsync(r.uid,r.data).then((function(e){n._emit("_addDataToDBSuccess",r.uid,e)}))["catch"]((function(e){n._emit("_addDataToDBFailed",r.uid,e)})),e=new Le(r.uid,e);r.data.minData&&o(r.data.minData)&&(e.minData=r.data.minData),e.customData=r.data.customData||{},e.setTags(r.data.tags||[]),n._db.addMid(r.uid,e)},c=0;c<s;c++)u(c);return this._emit(le,e,a,r),a.slice().forEach((function(e){n._emit(re,e)})),i},a._convertData=function(e){return new Promise((function(t,r){var i;n(e)?t(e):((i=new XMLHttpRequest).onload=function(){var e=w.createObjectURL(i.response);t(e)},i.open("GET",e,!0),i.responseType="blob",i.send())}))},a.addData=function(){var e=E(D().mark((function t(e,r){var i=this;return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._ckStr(e)&&n(r)){t.next=3;break}return this._thrEr(fe),t.abrupt("return",this._err(fe.message));case 3:return t.next=5,this._db.addDataAsync(e,r).then((function(e){return i._ok(),e}))["catch"]((function(e){return i._thrEr(Te),i._err(Te.message)}));case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t,this)})));return function(t,r){return e.apply(this,arguments)}}(),a.getData=function(){var e=E(D().mark((function t(e){var r=this;return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._ckStr(e)){t.next=3;break}return this._thrEr(fe),t.abrupt("return",this._err(fe.message));case 3:return t.next=5,this._db.getDataAsync(e).then((function(e){return r._ok(),Promise.resolve(e)}))["catch"]((function(e){return r._thrEr(_e),r._err(_e.message)}));case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t,this)})));return function(t){return e.apply(this,arguments)}}(),a.removeData=function(){var e=E(D().mark((function t(e){var r=this;return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._ckStr(e)){t.next=3;break}return this._thrEr(fe),t.abrupt("return",this._err(fe.message));case 3:return t.next=5,this._db.removeDataAsync(e).then((function(e){return r._ok(),e}))["catch"]((function(e){return r._thrEr(Ce),r._err(Ce.message)}));case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t,this)})));return function(t){return e.apply(this,arguments)}}(),a.updateData=function(){var e=E(D().mark((function t(e,r){var n=this;return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._ckStr(e)){t.next=3;break}return this._thrEr(fe),t.abrupt("return",this._err(fe.message));case 3:return t.next=5,this._db.updateDataAsync(e,r).then((function(e){return n._ok(),e}))["catch"]((function(e){return n._thrEr(_e),n._err(_e.message)}));case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t,this)})));return function(t,r){return e.apply(this,arguments)}}(),a._err=function(e){return Promise.reject(new Error(e))},a._ckArray=function(e){return!!r(e)||(this._thrEr(fe),!1)},a._ckStr=function(e){return!!o(e)||(this._thrEr(fe),!1)},a._thrEr=function(e){this._emit(B,e)},a._ok=function(){this._emit(B,ge)},i}(S);function Ve(){return(Ve=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Ne(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ae(e,t,r){t&&Ne(e.prototype,t),r&&Ne(e,r),Object.defineProperty(e,"prototype",{writable:!1})}function Be(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}M=function(){function e(e){this.cssWidth=0,this.cssHeight=0,this.dpr=1,this.canvas=null,this.ctx=null,this.dpr=e.dpr}var t=e.prototype;return t.bind=function(e){this.canvas=e,this.ctx=e.getContext("2d"),this.ctx.imageSmoothingEnabled=!1},t.unbind=function(){this.canvas=null,this.ctx=null},t.clear=function(e,t,r,n){var i;null!=(i=this.canvas)&&i.clearRect(e,t,r,n)},t.size=function(e,t){this.cssWidth=e,this.cssHeight=t,this.innerWidth=e*this.dpr,this.innerHeight=t*this.dpr},t.dispose=function(){this.unbind()},e}();var Oe=function(e){function r(t){return(t=e.call(this,t)||this).maskColor="rgba(200,200,200,0.5)",t.isMask=!0,t}t(r,e);var n=r.prototype;return n.setMaskColor=function(e){this.maskColor=e},n.getMaskColor=function(){return this.maskColor},r}(M),Re=function(e){function r(t){return e.call(this,t)||this}return t(r,e),r.prototype.setBackGroundColor=function(e){this.canvas.style.background=e},r}(M),Ue=function(){function e(){this.saveColor="#ffffff";var e=v();this.mainCvs=new Re({dpr:e}),this.cropCvs=new Oe({dpr:e})}var t=e.prototype;return t.updateDpr=function(e){this.mainCvs.dpr=e,this.cropCvs.dpr=e},t.bind=function(e){var t,r=e.main;e=e.cropper;r&&null!=(t=this.mainCvs)&&t.bind(r),e&&null!=(r=this.cropCvs)&&r.bind(e)},t.unbind=function(e){"main"===e&&this.mainCvs&&(this.mainCvs.innerWidth=1,this.mainCvs.innerHeight=1,this.mainCvs.unbind()),"cropper"===e&&this.cropCvs&&(this.cropCvs.innerWidth=1,this.cropCvs.innerHeight=1,this.cropCvs.unbind())},t.setCanvasSize=function(e,t){var r;null!=(r=this.mainCvs)&&r.size(e,t),null!=(r=this.cropCvs)&&r.size(e,t)},t.dispose=function(){var e;null!=(e=this.cropCvs)&&e.dispose(),(this.cropCvs=null)!=(e=this.mainCvs)&&e.dispose(),this.mainCvs=null},e}(),Ge=function(e){function r(t,r){return(t=e.call(this,t)||this).wrapper=null,t.isVisible=!1,t.isDragging=!1,t.isStart=!1,t.startX=0,t.startTime=0,t.hideTimer=null,t.width=0,t.triggerDist=10,t.minDistanceThreshold=60,t.minTimeThreshold=300,t.pages=null,t.slideEndCallback=null,t.slidingStateChangedCallback=null,t.stateCb=null,t.touchNum=0,t.curPageUid=null,t.renderPageUid=null,t.loading=!1,t.isNew=!1,t.targetIndexes=[-1,-1,-1],t.allowDrag=!0,t.isDisposed=!1,t._db=r,t.isDisposed=!1,t.pages=[{width:0,height:0,url:"",uid:"",index:-1},{width:0,height:0,url:"",uid:"",index:-1},{width:0,height:0,url:"",uid:"",index:-1}],t._initEvent(),t}t(r,e);var n=r.prototype;return n._initEvent=function(){var t=this;e.prototype._on.call(this,G,(function(e){t.renderPageUid=e})),e.prototype._on.call(this,j,(function(e){e||(t.renderPageUid=null),t.curPageUid=e}))},n.setSlidePages=function(e){if(this.wrapper){for(var t=0;t<3;t++){var r=e[t];if(r.index!==this.targetIndexes[t]||-1<r.index&&""===r.url)return}this.pages=e,this.isNew=!0,this.allowDrag=!1,this.isVisible||this.showPages()}},n.showPages=function(){var e,t=this;this.loading||this.isNew&&(this.loading=!0,this.isNew=!1,e=[],this.pages.forEach((function(r,n){var i=new Promise((function(e,i){var o,a=null==(o=t.wrapper)||null==(o=o.children[n])?void 0:o.children[0],s=r.index;if(a)if(a.style.width=r.width+"px",a.style.height=r.height+"px",a.src!==r.url){if(""===r.url)return a.src=r.url,a.onload=null,a.onerror=null,e(-1);a.onload=function(){a.onload=null,a.onerror=null,e(s)},a.onerror=function(){a.onload=null,a.onerror=null,e(s)},a.src=r.url}else e(s);else i(s)}));e.push(i)})),Promise.all(e).then((function(e){t.allowDrag=!0;for(var r=0;r<e.length;r++)if(e[r]!==t.targetIndexes[r]){t.allowDrag=!1;break}t.loading=!1,t.showPages()}))["catch"]((function(e){})))},n.startHandler=function(e){!this.isDragging&&this.allowDrag&&(clearTimeout(this.hideTimer),this.startTime=e.timeStamp,e.touches?(this.touchNum=e.touches.length,this.startX=e.touches[0].pageX):this.startX=e.pageX,this.isStart=!0)},n.moveHandler=function(e){var t;!this.isStart||2<this.touchNum||(e=(e.touches?e.touches[0]:e).pageX-this.startX,Math.abs(e)>this.triggerDist&&(this.isDragging=!0,null!=(t=this.stateCb)&&t.call(this,!0),this._visible(!0),(t=this.width)<e?e=t:e<-t&&(e=-t)),this._translateX(e))},n.endHandler=function(e){var t,r,n,i,a=this;this.isStart&&(t=!0,(!e||e.touches&&(1<this.touchNum||1!==e.changedTouches.length))&&(t=!1),this.isStart=!1,r=(e=e||{}).pageX-this.startX,e=e.timeStamp-this.startTime,n=this._calcDirection(e,r,t),i=this,(o(n)?this._oPub.emitEx("preSlide",n):Promise.resolve(!0)).then((function(){n&&(a.allowDrag=!1);var e=a._calcSlidingDistance(n);i._transition("transform 0.2s linear"),a._translateX(e),setTimeout((function(){var e;a.wrapper&&(a.isDragging=!1,null!=(e=a.stateCb)&&e.call(a,!1))}),200),n&&setTimeout((function(){var e;a.isDisposed||null!=(e=a.slideEndCallback)&&e.call(a,n)}),205),i._hideSlide()})))},n._calcDirection=function(e,t,r){if(r){r=this.pages;var n,i=this.minDistanceThreshold,o=this.minTimeThreshold,a=this.triggerDist;if(-1!==(null==(n=r[0])?void 0:n.index)&&(i<t||e<o&&a<t))return x;if(-1!==(null==(n=r[2])?void 0:n.index)&&(t<-i||e<o&&t<-a))return P}return null},n._calcSlidingDistance=function(e){return e===x?this.width:e===P?-this.width:0},n._hideSlide=function(){var e=this;this.curPageUid!==this.renderPageUid||this.pages[1].uid!==this.curPageUid||this.isDragging?(clearTimeout(this.hideTimer),this.hideTimer=setTimeout((function(){e.isDisposed||e._hideSlide()}),210)):(this._visible(!1),this.showPages(),this._transition(""),this._translateX(0))},n._translateX=function(e){this.wrapper&&(this.wrapper.style.transform="translateX(".concat(e,"px)"))},n._visible=function(e){this.wrapper&&(this.wrapper.style.visibility=e?"visible":"hidden"),this.isVisible=e},n._transition=function(e){this.wrapper&&(this.wrapper.style.transition=e)},n.bindSlideEndCallback=function(e){this.slideEndCallback=e},n.bind=function(e){this.wrapper=e},n.unbind=function(){this.wrapper=null},n.setSlideSize=function(e){if(!this.wrapper)return!1;e<120&&(this.minDistanceThreshold=e/2),this.width=e,this.wrapper.style.width=3*e+"px",this.wrapper.style.left=-e+"px";for(var t=0;t<3;t++)this.wrapper.children[t].style.width=e+"px"},n.dispose=function(){e.prototype.dispose.call(this),this._hideSlide(),this.unbind(),this.isDisposed=!0},r}(S),je=function(){function e(e,t){this.useWorker=!0,this.workers_archive=[],this.taskUid=null,this.useWorker=e,this.cores=1,this.workerBlobURL=t}var t=e.prototype;return t.resize=function(e,t,r,n,i,o){return this.useWorker?this.resizeWithWorker(e,t,r,n,i,o):this.resizeWithoutWorker(e,n,i,o)},t.resizeWithoutWorker=function(e,t,r,n){for(var i=e.width,o=e.height,a=(t=Math.round(t),o/(r=Math.round(r))),s=e.getContext("2d"),u=[],c=2*Math.ceil(o/this.cores/2),l=[],d=-1,h=0;h<this.cores;h++){var g,f=d+1;o<=f||(d=f+c-1,d=Math.min(d,o-1),c,g=Math.min(c,o-f),u[h]={},u[h].source=s.getImageData(0,f,i,c),u[h].target=!0,u[h].start_y=Math.ceil(f/a),u[h].height=g,f={width_source:i,height_source:u[h].height,width:t,height:Math.ceil(u[h].height/a),core:h,source:u[h].source.data.buffer||u[h].source.data},l[h]=f)}for(var m=l.length,_=[],p=0;p<m;p++){for(var v=(D=l[p]).core,y=D.width_source,b=D.height_source,I=D.width,w=D.height,S=y/I,T=b/w,C=Math.ceil(S/2),E=Math.ceil(T/2),M=new Uint8ClampedArray(D.source),D=(M.length,I*w*4),k=new ArrayBuffer(D),x=new Uint8ClampedArray(k,0,D),P=0;P<w;P++)for(var W=0;W<I;W++){for(var L=4*(W+P*I),F=0,V=0,N=0,A=0,B=0,O=0,R=0,U=P*T,G=Math.floor(W*S),j=Math.ceil((W+1)*S),z=Math.floor(P*T),H=Math.ceil((P+1)*T),X=(j=Math.min(j,y),H=Math.min(H,b),z);X<H;X++)for(var Y=Math.abs(U-X)/E,J=W*S,K=Y*Y,Z=G;Z<j;Z++){var q=Math.abs(J-Z)/C;1<=(q=Math.sqrt(K+q*q))||(R+=(F=2*q*q*q-3*q*q+1)*M[3+(q=4*(Z+X*y))],N+=F,A+=(F=M[3+q]<255?F*M[3+q]/250:F)*M[q],B+=F*M[1+q],O+=F*M[2+q],V+=F)}x[L]=A/V,x[1+L]=B/V,x[2+L]=O/V,x[3+L]=R/N}_.push({core:v,target:x})}for(var Q=0;Q<m;Q++){var $=_[Q],ee=Math.ceil(u[Q].height/a);if(u[Q].target=s.createImageData(t,ee),u[Q].target.data.set)u[Q].target.data.set($.target);else for(var te=u[Q].target.data.length,re=0;re<te;re++)u[Q].target.data[re]=$.target[re]}return Promise.resolve(u)},t.resizeWithWorker=function(e,t,r,n,i,o){for(var a=this,u=Math.floor(t)||1,c=Math.floor(r)||1,l=(n=Math.floor(n)||1,c/(i=Math.floor(i)||1)),d=e.getContext("2d"),h=[],g=2*Math.ceil(c/this.cores/2),f=-1,m=0;m<this.cores;m++){var _,p,v=f+1;c<=v||(f=v+g-1,f=Math.min(f,c-1),g,_=Math.min(g,c-v),h[m]={},h[m].source=d.getImageData(0,v,u,_),h[m].target=!0,p=Math.ceil(v/l),v=Math.min(Math.ceil((v+_)/l)-p,i-p),h[m].startY=p,h[m].height=_,h[m].heightPart=v)}e=d=null;for(var y=[],b=function(e){if(h[e]==undefined)return"continue";var t=new Worker(a.workerBlobURL),i=new Promise((function(e,r){t.onmessage=function(i){t.terminate(),t.onmessage=null,t.onerror=null,t=null,i.data.taskUid!==a.taskUid&&r(!1);var o=i.data.core,u=h[o].heightPart;if(s(u)||(u=1),s(n)||(n=1),h[o].target=document.createElement("canvas").getContext("2d").createImageData(n,u||1),h[o].target.data.set)h[o].target.data.set(i.data.target);else for(var c=h[o].target.data.length,l=0;l<c;l++)h[o].target.data[l]=i.data.target[l];e(o)},t.onerror=function(e){t.terminate(),t.onmessage=null,t.onerror=null,t=null,r(e)}}));y.push(i),i={sourceWidth:u,sourceHeight:h[e].height,width:n,height:h[e].heightPart,core:e,source:h[e].source.data.buffer||h[e].source.data,taskUid:o};try{t.postMessage(i,[i.source])}catch(r){t.postMessage(i)}},I=0;I<this.cores;I++)b(I);return Promise.all(y).then((function(e){return Promise.resolve(h)}))["catch"]((function(e){return Promise.reject(e)}))},e}(),ze=function(e){function r(t,r,n,i,o,a,s,u){var c=e.call(this,n)||this;return c.uid=null,c.cvsOffW=0,c.cvsOffH=0,c.cvsCltW=0,c.cvsCltH=0,c.cvsInnerW=0,c.cvsInnerH=0,c.maxW=0,c.maxH=0,c.virW=0,c.virH=0,c.dpr=1,c.fitType="window",c.keepZoom=!0,c.clickZoom=!1,c.isFreeCrop=!1,c.zoom=1,c.zoomInDelta=1.2,c.zoomOutDelta=1.2,c.zoomDelta=1.2,c.scrL=0,c.scrT=0,c.disMode="single",c.opMode=0,c.curTab=null,c.curPages=[],c.iMargin=10,c.oMargin=10,c.rows=0,c.columns=0,c._mousedown=!1,c._pageX=0,c._pageY=0,c.rotateMode=1,c.saveBg="#ffffff",c.aspectRatio=0,c.keepAspectRatio=!1,c._startDistance=0,c.useWebWorker=!1,c.renderTaskUid=null,c.workerTimer=null,c.useHermite=!0,c.hermite=null,c.workerBlobURL=null,c.scrBarW=0,c.loadingTimer=null,c.allowSlide=!0,c.slide=null,c.isSliding=!1,c.zooming=!0,c.scrollX=!0,c.scrollY=!0,c.animating=!1,c.bouncing=!1,c.paging=!1,c.snapping=!1,c.animationDuration=300,c.locking=!1,c.minZoom=.01,c.maxZoom=8,c.speedDelta=1,c._outerWidth=0,c._outerHeight=0,c._innerWidth=0,c._innerHeight=0,c._outerLeft=0,c._outerTop=0,c._snapWidth=0,c._snapHeight=0,c._pullHeight=0,c._pullActive=!1,c._maxSrL=0,c._maxSrT=0,c._srL=0,c._srT=0,c._zoom=1,c._futureLeft=0,c._futureTop=0,c._futureZoom=0,c._zoomComplete=null,c._isSingleTouch=!0,c._isDecelerating=!1,c._isProcessing=!1,c._isDragging=!1,c._isAnimating=!1,c._interruptedAnimation=!1,c._position=[],c._startTouchLeft=0,c._startTouchTop=0,c._startZoom=1,c._lastTouchLeft=0,c._lastTouchTop=0,c._lastScale=1,c._enableScrollX=!0,c._enableScrollY=!0,c._fps=60,c._running={},c._counter=1,c.cropLineColor="rgba(0,0,0,1)",c.defaultCursor=null,c.isDisposed=!1,c.offScreenCanvas=u,c.offScreenCanvas&&(c.offScreenCanvas.saveColor=c.saveBg),c.uid=i,c.dpr=v(),c._db=r,c.fitType=t.fitType,c.maxZoom=t.maxZoom,c.minZoom=t.minZoom,c.opMode=t.opMode,c.iMargin=t.iMargin,c.scrollX=t.scrollX,c.scrollY=t.scrollY,c.zoomInDelta=t.zoomInDelta,c.zoomOutDelta=t.zoomOutDelta,c.zoomDelta=t.zoomDelta,c.zooming=t.zooming,c.useWebWorker=t.useWebWorker,c.useHermite=o,c.scrBarW=s,c.cvsMng=new Ue,c._initAnimation(),c._initScroller(),c.slide=new Ge(n,r),c.slide.stateCb=function(e){c.isSliding=e},c.useHermite&&(c.workerBlobURL||(c.workerBlobURL=a),c.hermite=new je(c.useWebWorker,c.workerBlobURL)),c}t(r,e);var n=r.prototype;return n.setOffScreenCanvas=function(e){this.offScreenCanvas=e,this.offScreenCanvas.saveColor=this.saveBg},n.updateDpr=function(){var e=v();this.dpr=e,this.cvsMng.updateDpr(e),this.tabItem&&this.tabItem.chs.forEach((function(t){t.cropMng.updateDpr(e)}))},n.setAllowSlide=function(e){this.allowSlide=e},n.setSlidePages=function(e){var t;null!=(t=this.slide)&&t.setSlidePages(e)},n.checkDisplay=function(e,t){return"single"!==t.disMode||!(!(t=t.getCurPage())||e!==t.uid)},n.initGraphic=function(e){var t=e.uid;this.curPages=e.chs,t!==this.curTab&&(this.curTab=t,this.tabItem=e,this.virH=e.virH||0,this.virW=e.virW||0,this.fitType=e.fitType,this.clickZoom=e.clickZoom,this.isFreeCrop=e.isFreeCrop,this.scrL=e.scrL,this.scrT=e.scrT,this.zoom=e.zoom,this.iMargin=e.iMargin,this.oMargin=e.oMargin,this.direction=e.direction,this.disMode=e.disMode,this.opMode=e.opMode)},n.render=function(t){var r,n,i,o,a,s,u,c,l,d,h,g,f=this;!this.tabItem||(r=this.tabItem.getCurPage())&&r.uid===t&&(n=this._db.getMid(t),i=n.img,o=this.cvsMng.mainCvs.ctx,i&&o&&(a=Math.round((r.style.left-this.scrL)*this.dpr),s=Math.round((r.style.top-this.scrT)*this.dpr),u=r.style.width*this.dpr||1,c=r.style.height*this.dpr||1,(l=this.offScreenCanvas).render(d={viewerUid:"",pageUid:t,isMin:!1,img:i,page:r,midData:n}),h=l.mainCanvas,o.clearRect(0,0,this.cvsInnerW,this.cvsInnerH),o.save(),o.imageSmoothingEnabled=!1,o.webkitImageSmoothingEnabled=!1,o.msImageSmoothingEnabled=!1,o.oImageSmoothingEnabled=!1,o.drawImage(h,0,0,l.mainWidth,l.mainHeight,a,s,Math.floor(u),Math.floor(c)),this._handleOverlay((null==n?void 0:n.overlays)||[],r,o),o.restore(),this.workerTimer&&clearTimeout(this.workerTimer),g=m(11),this.renderTaskUid=g,this.hermite&&(this.hermite.taskUid=this.renderTaskUid),this.useHermite&&this.zoom<1&&this.hermite&&(this.workerTimer=setTimeout((function(){var r,n,m,_;f.isDisposed||!f.offScreenCanvas||l.isDisposed||f.hermite.taskUid===g&&i.naturalWidth&&i.naturalHeight&&(l.render(d),n=(r=document.createElement("canvas")).getContext("2d",{willReadFrequently:!0}),m=l.mainWidth,_=l.mainHeight,r.width=m,r.height=_,n.imageSmoothingEnabled=!1,n.drawImage(h,0,0),null!=(n=f.hermite)&&n.resize(r,m,_,u,c,f.renderTaskUid).then((function(r){var n,i=f._db.getMid(t);i&&f.tabItem&&(n=f.tabItem.getCurPage())&&n.uid===t&&(o.save(),o.clearRect(0,0,f.cvsInnerW,f.cvsInnerH),r.forEach((function(e){o.putImageData(e.target,a,e.startY+s)})),f._handleOverlay((null==i?void 0:i.overlays)||[],n,o),o.restore(),e.prototype._emit.call(f,G,t))}))["catch"]((function(r){e.prototype._emit.call(f,G,t)})))}),100)),"single"===this.disMode&&(this.useHermite&&this.zoom<1&&this.hermite||e.prototype._emit.call(this,G,t),e.prototype._emit.call(this,"pageRendered",this.tabItem.cur))))},n._handleOverlay=function(e,t,r){var n,i,o=this;e.length&&(r.save(),r.scale(this.dpr,this.dpr),n=Math.round(t.style.left-this.scrL),i=Math.round(t.style.top-this.scrT),e.forEach((function(e){0<t.style.width-e.width*o.zoom&&0<t.style.height-e.height*o.zoom&&(r.globalAlpha=e.opacity,r.fillStyle=e.color,r.fillRect(n+e.left*o.zoom,i+e.top*o.zoom,Math.min(t.style.width-e.left*o.zoom,e.width*o.zoom),Math.min(t.style.height-e.top*o.zoom,e.height*o.zoom)))})),r.restore())},n.drawSltBox=function(e){var t=this,r=this.cvsMng.cropCvs.ctx;r&&(r.imageSmoothingEnabled=!1,r.clearRect(0,0,this.cvsInnerW,this.cvsInnerH),1===this.opMode&&(r.save(),r.scale(this.dpr,this.dpr),r.lineJoin="round",e.cropMng.cropBoxes.forEach((function(e){for(var n=(m=e.cropBoxStyle).ctrlBorderWidth,i=m.ctrlBackground,o=m.ctrlBorderColor,a=m.ctrlBorderRadius,s=m.ctrlWidth,u=m.ctrlHeight,c=m.borderColor,l=m.borderWidth,d=m.invalidBorderColor,h=m.invalidCtrlBorderColor,g=m.background,f=m.dashLine,m=m.enableConcaveBorderColor,_=e.probePoints.slice(0,8),p=e.midpoints.slice(0,8),v=0;v<4;v++){var y=t.toCanvasCoordinate(_[2*v],_[2*v+1]),b=t.toCanvasCoordinate(p[2*v],p[2*v+1]);_[2*v]=y.x,_[2*v+1]=y.y,p[2*v]=b.x,p[2*v+1]=b.y}r.save();try{r.setLineDash(f)}catch(Q){}r.fillStyle=g,r.lineWidth=l,m&&!e.isConvex?r.strokeStyle=d:r.strokeStyle=c,r.beginPath(),r.moveTo(_[0],_[1]),r.lineTo(_[2],_[3]),r.lineTo(_[4],_[5]),r.lineTo(_[6],_[7]),r.closePath(),r.stroke(),r.restore(),r.lineWidth=n,r.fillStyle=i,m&&!e.isConvex?r.strokeStyle=h:r.strokeStyle=o;for(var I=Math.min(a,s/2),w=Math.min(a,u/2),S=0;S<4;S++)t.drawRoundedRectangle(r,{x:_[2*S],y:_[2*S+1],width:s,height:u,radiusX:I,radiusY:w}),r.stroke(),""!==i&&r.fill(),t.drawRoundedRectangle(r,{x:p[2*S],y:p[2*S+1],width:s,height:u,radiusX:I,radiusY:w}),r.stroke(),""!==i&&r.fill()})),r.restore()))},n.drawRoundedRectangle=function(e,t){var r=t.width,n=t.height,i=t.radiusX,o=t.radiusY,a=t.x,s=[{x:a-r/2+i,y:(t=t.y)-n/2+o,start:Math.PI,end:3*Math.PI/2},{x:a+r/2-i,y:t-n/2+o,start:3*Math.PI/2,end:2*Math.PI},{x:a+r/2-i,y:t+n/2-o,start:0,end:Math.PI/2},{x:a-r/2+i,y:t+n/2-o,start:Math.PI/2,end:Math.PI}];if(e.beginPath(),e.ellipse)for(var u=0;u<4;u++){var c=s[u];e.ellipse(c.x,c.y,i,o,0,c.start,c.end)}else e.rect(a-r/2,t-n/2,r,n);e.closePath()},n.clearCanvas=function(){var e=((e=this.cvsMng.mainCvs.ctx)&&e.clearRect(0,0,this.cvsInnerW,this.cvsInnerH),this.cvsMng.cropCvs.canvas),t=this.cvsMng.cropCvs.ctx;t&&e&&t.clearRect(0,0,e.width,e.height)},n._layoutSingle=function(t,r,n){var i,o,a,s,u,c,l,d,h,g,f,m=t.getCurPage();m&&(h=this._db.getMetadata(m.uid),l=this._db.getMid(m.uid)),m&&h&&l?(l=l.edt.all,i=h.width,o=h.height,a=h.width,s=h.height,c=u=null,l.forEach((function(e){var t,r;"rotate"===e.type?(0===e.mode&&(c=y(0,0,a,s,e.calcAngle)),null!==u&&u!==e.mode&&(a=i,s=o),u=e.mode,c&&(t=(r=c).width,r=r.height,i=t,o=r)):"crop"!==e.type&&"changeSize"!==e.type||(t=e.width,r=e.height,a=i=t,s=o=r)})),null!=m&&m.setNaturalSize(i,o),l=(h=this._calcZoom(t,i||0,o||.1)).zoom,g=h.canvasWidth,f=h.canvasHeight,d=h.virW,h=h.virH,this.setCanvasSize(g,f),m.cropMng.setZoom(l=l||1),this.virW=d,this.virH=h,n||e.prototype._emit.call(this,H,{width:this.virW,height:this.virH,x:this.scrL,y:this.scrT}),g=(this.cvsCltW-d)/2,f=(this.cvsCltH-h)/2,g<0&&(r&&(this._srL=Math.abs(g)),g=0),f<0&&(r&&(this._srT=Math.abs(f)),f=0),m.setBorder(t.pageBorderWidth),m.setSize(d,h),m.setPosition(g,f),t.virW=d,t.virH=h,this._zoomTo(l,!1,r),this.setVirtualSize(d,h),this._zoomTo(l,!1,r),this.zoom!==l&&(this.zoom=l),n||e.prototype._emit.call(this,H,{width:d,height:h,x:this.scrL,y:this.scrT})):e.prototype._emit.call(this,H,{width:1,height:1,x:0,y:0})},n._calcZoom=function(e,t,r){return"window"===e.fitType?this._calFitWindow(t,r):"width"===e.fitType?this._calcFitWidth(t,r):"height"===e.fitType?this._calcFitHeight(t,r):this.keepZoom&&"none"===e.fitType?this._calcKeepZoom(t,r):this._calFitWindow(t,r)},n.calcZoomForSlide=function(e,t){return e=this._calFitWindow(e,t).zoom,Math.min(Math.max(this.minZoom,e),this.maxZoom)},n._calcKeepZoom=function(e,t){var r=this.zoom,n=this.cvsOffW,i=this.cvsOffH;t*=r;return n<(e=e*r)&&(i-=this.scrBarW),i<t&&(n-=this.scrBarW),{zoom:r,canvasWidth:n,canvasHeight:i,virW:e,virH:t}},n._calcFitWidth=function(e,t){var r=1,n=0,i=this.cvsOffW,o=this.cvsOffH;return o<(n=t*(r=e<=this.cvsOffW?1:this.cvsOffW/e))&&(n=t*(r=e<=this.cvsOffW-this.scrBarW?1:(this.cvsOffW-this.scrBarW)/e))>this.cvsOffH&&(i-=this.scrBarW),{zoom:r,canvasWidth:i,canvasHeight:o,virW:e*r,virH:n}},n._calcFitHeight=function(e,t){var r=1,n=0,i=0,o=this.cvsOffW;i=this.cvsOffH;return o<(n=e*(r=t<=this.cvsOffH?1:this.cvsOffH/t))&&(n=e*(r=t<=this.cvsOffH-this.scrBarW?1:(this.cvsOffH-this.scrBarW)/t))>this.cvsOffW&&(i-=this.scrBarW),{zoom:r,canvasWidth:o,canvasHeight:i,virW:n,virH:t*r}},n._calFitWindow=function(e,t){return e<=this.cvsCltW&&t<=this.cvsCltH||e>this.cvsCltW&&t<=this.cvsCltH||!(e<=this.cvsCltW&&t>this.cvsCltH)&&e/this.cvsCltW>=t/this.cvsCltH?this._calcFitWidth(e,t):this._calcFitHeight(e,t)},n._getPage=function(e){for(var t=this.curPages.length,r=0;r<t;r++)if(this.curPages[r].uid===e)return{page:this.curPages[r],index:r}},n.setFitType=function(e){this.fitType=e,this.tabItem&&(this.tabItem.fitType=e)},n._setValidArea=function(){this.setValidArea(this.cvsCltW,this.cvsCltH,this.virW,this.virH)},n._setScrollerPosition=function(){var e=this.cvsMng.mainCvs.canvas;if(e){var t={left:0,top:0,right:0,bottom:0,width:0,height:0};try{t=e.getBoundingClientRect()}catch(a){}this.setPosition(t.left+window.pageXOffset+(null==e?void 0:e.clientLeft)||0,t.top+window.pageYOffset+(null==e?void 0:e.clientTop)||0)}},n.setCanvasOffsetSize=function(e,t){var r=!1;return this.cvsOffW===e&&this.cvsOffH===t&&(r=!0),this.cvsOffW=e,this.cvsOffH=t,this.cvsCltW=e,this.cvsCltH=t,this.cvsInnerW=e*this.dpr,this.cvsInnerH=t*this.dpr,this.cvsMng.setCanvasSize(e,t),null!=(t=this.slide)&&t.setSlideSize(e),this._setScrollerPosition(),r},n.setCanvasSize=function(e,t){this.cvsCltW=e,this.cvsCltH=t,this.cvsInnerW=e*this.dpr,this.cvsInnerH=t*this.dpr,this.cvsMng.setCanvasSize(e,t)},n.setVirtualSize=function(e,t){this.virW=e||0,this.virH=t||0,this._setValidArea()},n.setZoom=function(t){return t=Math.max(Math.min(this.maxZoom,t),this.minZoom),this.zoom=t,this.tabItem&&this.tabItem.total||(this._zoom=t),this.setFitType("none"),e.prototype._emit.call(this,"_onRender"),0===this._maxSrL&&0===this._maxSrT&&e.prototype._emit.call(this,"_getSlidePages"),!0},n.getZoom=function(){return this.zoom},n.zoomTo=function(t,r,n,i){return this.zoom=t,this._zoomTo(t,r,!1,n,i),this.setFitType("none"),e.prototype._emit.call(this,"_onRender"),0===this._maxSrL&&0===this._maxSrT&&e.prototype._emit.call(this,"_getSlidePages"),this._zoom},n.scrollTo=function(t,r,n,i){this._scrollTo(t,r,!1),e.prototype._emit.call(this,"_onRender")},n.zoomIn=function(){var t=this.zoom;return t*=this.zoomInDelta,this._zoomTo(t,!1),this.setFitType("none"),e.prototype._emit.call(this,"_onRender"),0===this._maxSrL&&0===this._maxSrT&&e.prototype._emit.call(this,"_getSlidePages"),t},n.zoomOut=function(){var t=this.zoom;return t/=this.zoomInDelta,this._zoomTo(t,!1),this.setFitType("none"),e.prototype._emit.call(this,"_onRender"),0===this._maxSrL&&0===this._maxSrT&&e.prototype._emit.call(this,"_getSlidePages"),t},n.getMinPageData=function(){var e=document.createElement("canvas"),t=e.getContext("2d"),r=this.offScreenCanvas,n=(e.dvsUid="useToGetMinPageData",r.mainWidth),i=r.mainHeight,o=n/i,a=(o=((800<n||800<i)&&(1<=o?i=(n=800)/o:n=(i=800)*o),e.width=n,e.height=i,n/r.mainWidth),i/r.mainHeight);o=r.mainCanvas.width*o,a=r.mainCanvas.height*a,t.drawImage(r.mainCanvas,0,0,Math.floor(o),Math.floor(a)),r=t.getImageData(0,0,n,i);return e.width=1,e.height=1,t.fillRect(0,0,1,1),e=null,r},n.setSaveBackgroundColor=function(e){this.saveBg=e,this.offScreenCanvas.saveColor=e},n.onCanvasTouchstart=function(t){var r,n,i,o,a,s;t.cancelable&&t.preventDefault(),t.touches[0]&&t.touches[0].target&&t.touches[0].target.tagName.match(/input|textarea|select/i)||"single"===this.disMode&&"single"===this.disMode&&this.tabItem&&0!==this.tabItem.total&&(this._mousedown=!0,t.target.tagName.match(/input|textarea|select/i)||(r=t.touches[0].pageX,n=t.touches[0].pageY,0===this.opMode?(this._pageX=r,this._pageY=n,this.allowSlide&&0===this._maxSrL&&0===this._maxSrT&&!this.slide.isDragging&&null!=(i=this.slide)&&i.startHandler(t),this.isSliding||(1<t.targetTouches.length&&(this._startDistance=this._calDistance(t.targetTouches)),this.startHandler(t.targetTouches,t.timeStamp))):1===this.opMode?this.checkMouseOverPage(t)&&(i=this.tabItem.getCurPage())&&(o=this.getMouseCoordinate(t),o=this.toPageCoordinate(o.x,o.y),!(a=!1)===t.ctrlKey&&(a=!0),s=this.tabItem.cur,null!==i.cropMng.checkSelect(o.x,o.y)||a||0<i.cropMng.cropBoxes.length&&e.prototype._emit.call(this,N,s),i.cropMng.onStartHandler(o.x,o.y,a)):2===this.opMode&&this.checkMouseOverPage(t)&&(this.setFitType("none"),this._setScrollerPosition(),this._zoomTo(this._zoom*this.zoomInDelta,!1,!1,r-this._outerLeft,n-this._outerTop),e.prototype._emit.call(this,"_onRender"))))},n.onCanvasTouchmove=function(t){if("single"===this.disMode&&this.tabItem){var r=this.tabItem.getCurPage();if(r&&this._mousedown){if(0===this.opMode)if(this.allowSlide&&0===this._maxSrT&&0===this._maxSrL&&1===t.targetTouches.length)null!=(r=this.slide)&&r.moveHandler(t);else{if(this.isSliding)return;r=1,1<t.targetTouches.length&&(r=this._calDistance(t.targetTouches)/this._startDistance,this.fitType="none",this.tabItem.fitType="none",t.scale&&(r=t.scale)),this.moveHandler(t.targetTouches,t.timeStamp,r),e.prototype._emit.call(this,"_onRender"),0===this._maxSrL&&0===this._maxSrT&&e.prototype._emit.call(this,"_getSlidePages")}this._mousedown=!0}}},n.onCanvasTouchend=function(e){},n.onDocumentTouchend=function(e){},n.onCanvasMousedown=function(t){var r,n,i,o;"single"===this.disMode&&this.tabItem&&0!==this.tabItem.total&&(this._mousedown=!0,t.cancelable&&t.preventDefault(),t.target.tagName.match(/input|textarea|select/i)||(0===this.opMode?(this._pageX=t.pageX,this._pageY=t.pageY,this.allowSlide&&0===this._maxSrL&&0===this._maxSrT&&!this.slide.isDragging?null!=(r=this.slide)&&r.startHandler(t):this.startHandler([{pageX:t.pageX,pageY:t.pageY}],t.timeStamp)):1===this.opMode?this.checkMouseOverPage(t)&&(r=this.tabItem.getCurPage())&&(n=this.getMouseCoordinate(t),n=this.toPageCoordinate(n.x,n.y),!(i=!1)===t.ctrlKey&&(i=!0),o=this.tabItem.cur,null!==r.cropMng.checkSelect(n.x,n.y)||i||0<r.cropMng.cropBoxes.length&&e.prototype._emit.call(this,N,o),r.cropMng.onStartHandler(n.x,n.y,i)):2===this.opMode&&this.checkMouseOverPage(t)&&(this.setFitType("none"),this._setScrollerPosition(),this._zoomTo(this._zoom*this.zoomInDelta,!1,!1,t.pageX-this._outerLeft,t.pageY-this._outerTop),e.prototype._emit.call(this,"_onRender"),0===this._maxSrL&&0===this._maxSrT&&e.prototype._emit.call(this,"_getSlidePages"))))},n.onCanvasMousemove=function(e){this._mousedown&&(e.cancelable&&e.preventDefault(),"single"===this.disMode&&this.tabItem&&this.tabItem.total)},n.onCanvasMouseup=function(e){},n.onDocumentMousemove=function(t){var r,n,i;"single"===this.disMode&&this.tabItem&&(r=this.tabItem.getCurPage())&&(n=this.getMouseCoordinate(t),n=this.toPageCoordinate(n.x,n.y),this._mousedown?(1===this.opMode?this.checkMouseOverPage(t)!==undefined&&(!(i=!1)===t.ctrlKey&&(i=!0),r.cropMng.setAspectRatio(this.aspectRatio),!0===t.shiftKey?r.cropMng.setKeepAspectRatio(!0):r.cropMng.setKeepAspectRatio(this.keepAspectRatio),r.cropMng.onMoveHandler(n.x,n.y,i),e.prototype._emit.call(this,"_onRenderBoxes")):0!==this.opMode||t.touches||(this.allowSlide&&0===this._maxSrT&&0===this._maxSrL?null!=(i=this.slide)&&i.moveHandler(t):0===this._maxSrL&&0===this._maxSrT||(this.moveHandler([{pageX:t.pageX,pageY:t.pageY}],t.timeStamp),e.prototype._emit.call(this,"_onRender"))),this._mousedown=!0):0<r.cropMng.cropBoxes.length&&(null!==(i=r.cropMng.checkSelectForCursor(n.x,n.y))?(t=null,"move"===i.position?t="move":"nw"!==i.position&&"se"!==i.position&&"ne"!==i.position&&"sw"!==i.position&&"e"!==i.position&&"w"!==i.position&&"n"!==i.position&&"s"!==i.position||(t=i.position+"-resize"),e.prototype._emit.call(this,X,t)):e.prototype._emit.call(this,X,this.defaultCursor)))},n._calDistance=function(e){return Math.sqrt(Math.pow(e[0].pageX-e[1].pageX,2)+Math.pow(e[0].pageY-e[1].pageY,2))},n.onDocumentMouseup=function(t){var r,n;this._mousedown&&(1===this.opMode?this.tabItem&&"single"===this.tabItem.disMode&&(n=this.tabItem.getCurPage())&&(n.cropMng.onEndHandler(),r=this.tabItem.cur,0<(n=n.cropMng.getRectArr()).length&&e.prototype._emit.call(this,V,r,n),e.prototype._emit.call(this,"_onRenderBoxes")):0===this.opMode&&(this.clickZoom&&this._pageX===t.pageX&&this._pageY===t.pageY&&(r=this.getPosition(),this._zoomTo(this.zoom*this.zoomInDelta,!1,!1,t.pageX-r.left,t.pageY-r.top),e.prototype._emit.call(this,"_onRender")),this.allowSlide&&null!=(n=this.slide)&&n.endHandler(t),this.endHandler((null==t?void 0:t.timeStamp)||0)),this._mousedown=!1)},n.onCanvasWheel=function(e){this.isSliding||this._onWheelHandler(e)},n.onCanvasScroll=function(t){t&&t.target&&(this._scrollTo(t.target.scrollLeft,t.target.scrollTop,!1),e.prototype._emit.call(this,"_onRender"),e.prototype._emit.call(this,"_onRenderBoxes"))},n._onWheelHandler=function(t){var r=0,n=t.wheelDelta||-t.deltaY;t.ctrlKey?(t.cancelable&&t.preventDefault(),r=0<n?1.05:.95,this.fitType="none",this.tabItem.fitType="none",this.zoomHandler(n,t.timeStamp,t.pageX,t.pageY),e.prototype._emit.call(this,"_onRender"),e.prototype._emit.call(this,"_onRenderBoxes"),0===this._maxSrL&&0===this._maxSrT&&e.prototype._emit.call(this,"_getSlidePages")):t.shiftKey?0!==this._maxSrL&&(t.cancelable&&t.preventDefault(),r=n<0?30:-30,(0!==this._srL&&r<0||this._srL!==this._maxSrL&&0<r)&&(this._scrollTo(this.scrL+r,this.scrT,!1),e.prototype._emit.call(this,"_onRender"),e.prototype._emit.call(this,"_onRenderBoxes"))):0!==this._maxSrT&&(t.cancelable&&t.preventDefault(),r=n<0?30:-30,(0!==this._srT&&r<0||this._srT!==this._maxSrT&&0<r)&&(this._scrollTo(this.scrL,this.scrT+r,!1),e.prototype._emit.call(this,"_onRender"),e.prototype._emit.call(this,"_onRenderBoxes")))},n.checkMouseOverPage=function(e){if(!this.tabItem)return!1;var t=this.tabItem.getCurPage();if(!t)return!1;e=this.getMouseCoordinate(e);var r=(e=this.toPageCoordinate(e.x,e.y)).x;e=e.y;return 0<=r&&r<=t.naturalWidth&&0<=e&&e<=t.naturalHeight},n.toCanvasCoordinate=function(e,t){var r=this.tabItem.getCurPage();return r.style.left,this.scrL,r.style.width,r.style.top,this.scrT,r.style.height,{x:e=e*this.zoom+r.style.left-this.scrL,y:t=t*this.zoom+r.style.top-this.scrT}},n.toPageCoordinate=function(e,t){var r=this.tabItem.getCurPage();return{x:e=(e-r.style.left+this.scrL)/this.zoom,y:t=(t-r.style.top+this.scrT)/this.zoom}},n.getMouseCoordinate=function(e){var t=this.cvsMng.mainCvs.canvas.getBoundingClientRect(),r=(e.clientX!==undefined?e:e.changedTouches[0]).clientX;e=(e.clientY!==undefined?e:e.changedTouches[0]).clientY;return{x:r-t.left,y:e-t.top}},n._initAnimation=function(){this._time=Date.now||function(){return+new Date},this._fps=60,this._running={},this._counter=1},n._initScroller=function(){this.callback=function(e,t,r){this.scrL=e,this.scrT=t,this.zoom=r,this.tabItem&&(this.tabItem.scrL=e,this.tabItem.scrT=t,this.tabItem.zoom=r)}.bind(this),this._setValidArea(),this._setScrollerPosition()},n.setValidArea=function(e,t,r,n){e===+e&&(this._outerWidth=e),t===+t&&(this._outerHeight=t),r===+r&&(this._innerWidth=r),n===+n&&(this._innerHeight=n),this.calcMaxScrollValue()},n.calcMaxScrollValue=function(e){var t,r,n,i,o,a,s,u,c;e===undefined&&(e=this._zoom),this.tabItem&&((u=this.tabItem.getCurPage())&&(c=this._db.getMetadata(u.uid),t=this._db.getMid(u.uid)),u&&c&&t&&(r=c.width,n=c.height,i=c.width,o=c.height,s=a=null,t.edt.all.forEach((function(e){var t,u;"rotate"===e.type?(0===e.mode&&(s=y(0,0,i,o,e.calcAngle)),null!==a&&a!==e.mode&&(i=r,o=n),a=e.mode,s&&(t=(u=s).width,u=u.height,r=t,n=u)):"crop"!==e.type&&"changeSize"!==e.type||(t=e.width,u=e.height,i=r=t,o=n=u)})),u=r*e,c=n*e,this._maxSrL=Math.round(Math.max(u-this._outerWidth,0)),this._maxSrT=Math.round(Math.max(c-this._outerHeight,0))))},n.setPosition=function(e,t){this._outerLeft=e||0,this._outerTop=t||0},n.getPosition=function(){return{left:this._outerLeft||0,top:this._outerTop||0}},n.setSnapSize=function(e,t){this._snapWidth=e,this._snapHeight=t},n.activatePull=function(e,t,r,n){this._pullHeight=e,this._pullStart=n,this._pullActivate=t,this._pullDeactivate=r},n.emitPull=function(){this.publish(this._srL,-this._pullHeight,this._zoom,!0),this._pullStart&&this._pullStart()},n.endPull=function(){this._pullActive=!1,this._pullDeactivate&&this._pullDeactivate(),this._scrollTo(this._srL,this._srT,!0)},n.getCurScrollValues=function(){return{scrollLeft:this._srL,scrollTop:this._srT,zoom:this._zoom}},n.getMaxScrollValues=function(){return{maxScrollLeft:this._maxSrL,maxScrollTop:this._maxSrT}},n._zoomTo=function(e,t,r,n,i,o){if(void 0===r&&(r=!1),!this.zooming)return!1;if("continuous"===this.disMode)return!1;o&&(this._zoomComplete=o),this._isDecelerating&&(this._stop(this._isDecelerating),this._isDecelerating=!1),n===undefined&&(n=this._outerWidth/2),i===undefined&&(i=this._outerHeight/2);o=this._zoom;return e=Math.max(Math.min(e,this.maxZoom),this.minZoom),"single"===this.disMode?(this.calcMaxScrollValue(e),n=(n+this._srL)*e/o-n,o=(i+this._srT)*e/o-i,n>this._maxSrL?n=this._maxSrL:n<0&&(n=0),o>this._maxSrT?o=this._maxSrT:o<0&&(o=0),(this._innerWidth<this._outerWidth||r)&&(n=this._maxSrL/2),(this._innerHeight<this._outerHeight||r)&&(o=this._maxSrT/2),this.publish(n,o,e,t),!0):void 0},n._zoomBy=function(e,t,r,n,i){return this._zoomTo(this._zoom*e,t,!1,r,n,i)},n._scrollTo=function(e,t,r,n){this._isDecelerating&&(this._stop(this._isDecelerating),this._isDecelerating=!1),n!==undefined&&n!==this._zoom?this.zooming&&(e*=n,t*=n,this.calcMaxScrollValue(n)):n=this._zoom,this.scrollX?this.paging?e=Math.round(e/this._outerWidth)*this._outerWidth:this.snapping&&(e=Math.round(e/this._snapWidth)*this._snapWidth):e=this._srL,this.scrollY?this.paging?t=Math.round(t/this._outerHeight)*this._outerHeight:this.snapping&&(t=Math.round(t/this._snapHeight)*this._snapHeight):t=this._srT,e=Math.max(Math.min(this._maxSrL,e),0),t=Math.max(Math.min(this._maxSrT,t),0),e===this._srL&&t===this._srT&&(r=!1),this._isProcessing||this.publish(e,t,n,r)},n._scrollBy=function(e,t,r){var n=this._isAnimating?this._futureLeft:this._srL,i=this._isAnimating?this._futureTop:this._srT;this._scrollTo(n+(e||0),i+(t||0),r)},n.startHandler=function(e,t){var r;e.length!==undefined&&(t instanceof Date&&(t=t.valueOf()),this._interruptedAnimation=!0,this._isDecelerating&&(this._stop(this._isDecelerating),this._isDecelerating=!1),this._isAnimating&&(this._stop(this._animationId),this._isAnimating=!1),this._isSingleTouch=1===e.length,e=this._isSingleTouch?(r=e[0].pageX,e[0].pageY):(r=Math.abs(e[0].pageX+e[1].pageX)/2,Math.abs(e[0].pageY+e[1].pageY)/2),this._startTouchLeft=r,this._startTouchTop=e,this._startZoom=this._zoom,this._lastTouchLeft=r,this._lastTouchTop=e,this._lastScale=1,this._lastTouchMove=t,this._enableScrollX=!this._isSingleTouch&&this.scrollX,this._enableScrollY=!this._isSingleTouch&&this.scrollY,this._isProcessing=!0,this._isDecComp=!1,this._isDragging=!this._isSingleTouch,this._position=[])},n.moveHandler=function(e,t,r){var n,i,o,a,s,u,c,l,d;e.length!==undefined&&(t instanceof Date&&(t=t.valueOf()),this._isProcessing&&(e=1===e.length?(n=e[0].pageX,e[0].pageY):(n=Math.abs(e[0].pageX+e[1].pageX)/2,Math.abs(e[0].pageY+e[1].pageY)/2),i=this._position,this._isDragging?(d=n-this._lastTouchLeft,o=e-this._lastTouchTop,a=this._srL,s=this._srT,u=this._zoom,r!==undefined&&this.zooming&&(u=(c=u)/this._lastScale*r,c!==(u=Math.max(Math.min(u,this.maxZoom),this.minZoom))&&(this._setScrollerPosition(),a=((l=n-this._outerLeft)+a)*u/c-l,s=((l=e-this._outerTop)+s)*u/c-l,this.calcMaxScrollValue(u))),this._enableScrollX&&((a-=d*this.speedDelta)>this._maxSrL||a<0)&&(this.bouncing?a+=d/2*this.speedDelta:a=Math.max(Math.min(this._maxSrL,a),0)),this._enableScrollY&&((s-=o*this.speedDelta)>this._maxSrT||s<0)&&(this.bouncing?(s+=o/2*this.speedDelta,this._enableScrollX||null==this._pullHeight||(!this._pullActive&&s<=-this._pullHeight?(this._pullActive=!0,this._pullActivate&&this._pullActivate()):this._pullActive&&s>-this._pullHeight&&(this._pullActive=!1,this._pullDeactivate&&this._pullDeactivate()))):s=Math.max(Math.min(this._maxSrT,s),0)),60<i.length&&i.splice(0,30),i.push(a,s,t),this.publish(a,s,u)):(c=this.locking?3:0,l=Math.abs(n-this._startTouchLeft),d=Math.abs(e-this._startTouchTop),this._enableScrollX=this.scrollX&&c<=l,this._enableScrollY=this.scrollY&&c<=d,i.push(this._srL,this._srT,t),this._isDragging=(this._enableScrollX||this._enableScrollY)&&(5<=l||5<=d),this._isDragging&&(this._interruptedAnimation=!1)),this._lastTouchLeft=n,this._lastTouchTop=e,this._lastTouchMove=t,this._lastScale=r))},n.endHandler=function(e){if(e instanceof Date&&(e=e.valueOf()),this._isProcessing){if(this._isProcessing=!1,this._isDragging)if(this._isDragging=!1,this._isSingleTouch&&this.animating&&e-this._lastTouchMove<=100){for(var t,r,n=this._position,i=n.length-1,o=i,a=i;0<a&&n[a]>this._lastTouchMove-100;a-=3)o=a;o!==i?(i=n[i]-n[o],t=this._srL-n[o-2],r=this._srT-n[o-1],this._decVX=t/i*(1e3/60),this._decVY=r/i*(1e3/60),1<Math.abs(this._decVX)||1<Math.abs(this._decVY)?this._startDeceleration(e):this._scrollComp&&this._scrollComp()):this._scrollComp&&this._scrollComp()}else 100<e-this._lastTouchMove&&this._scrollComp&&this._scrollComp();this._isDecelerating||(this._pullActive&&this._pullStart?(this.publish(this._srL,this._srT,this._zoom),this._pullStart()):((this._interruptedAnimation||this._isDragging)&&this._scrollComp&&this._scrollComp(),this._scrollTo(this._srL,this._srT,!0,this._zoom),this._pullActive&&(this._pullActive=!1,this._pullDeactivate&&this._pullDeactivate()))),this._position.length=0}},n.zoomHandler=function(e,t,r,n){return e=0<e?1.05:.95,this._setScrollerPosition(),this._zoomTo(this._zoom*e,!1,!1,r-this._outerLeft,n-this._outerTop)},n.publish=function(e,t,r,n){var i,o,a,s,u,c,l=this;this._isAnimating&&(this._stop(this._isAnimating),this._isAnimating=!1),n&&this.animating?(this._futureLeft=e,this._futureTop=t,this._futureZoom=r,i=this._srL,o=this._srT,a=this._zoom,s=e-i,u=t-o,c=r-a,this._isAnimating=this._start((function(n,d,h){h&&(l._srL=i+s*n,l._srT=o+u*n,l._zoom=a+c*n,l.callback&&l.callback(e,t,r))}),(function(e){return l._isAnimating===e}),(function(e,t,r){t===l._isAnimating&&(l._isAnimating=!1),(l._isDecComp||r)&&l._scrollComp&&l._scrollComp(),l.zooming&&(l.calcMaxScrollValue(),l._zoomComplete&&(l._zoomComplete(),l._zoomComplete=null))}),this.animationDuration,this._isAnimating?this._easeOut:this._easeInOut)):(this._futureLeft=this._srL=e,this._futureTop=this._srT=t,this._futureZoom=this._zoom=r,this.callback&&this.callback(e,t,r),this.zooming&&(this.calcMaxScrollValue(),this._zoomComplete&&(this._zoomComplete(),this._zoomComplete=null)))},n._easeOut=function(e){return Math.pow(e-1,3)+1},n._easeInOut=function(e){return(e/=.5)<1?.5*Math.pow(e,3):.5*(Math.pow(e-2,3)+2)},n._startDeceleration=function(e){var t,r,n,i,o=this,a=(this.paging?(t=Math.max(Math.min(this._srL,this._maxSrL),0),r=Math.max(Math.min(this._srT,this._maxSrT),0),n=this._outerWidth,i=this._outerHeight,this._minDecL=Math.floor(t/n)*n,this._minDecT=Math.floor(r/i)*i,this._maxDecL=Math.ceil(t/n)*n,this._maxDecT=Math.ceil(r/i)*i):(this._minDecL=0,this._minDecT=0,this._maxDecL=this._maxSrL,this._maxDecT=this._maxSrT),function(e,t,r){var n,i,a,s=o._srL+o._decVX,u=o._srT+o._decVY;o.bouncing||(n=Math.max(Math.min(o._maxDecL,s),o._minDecL),i=Math.max(Math.min(o._maxDecT,u),o._minDecT),n!==s&&(s=n,o._decVX=0),i!==u&&(u=i,o._decVY=0)),r?o.publish(s,u,o._zoom):(o._srL=s,o._srT=u),o.paging||(o._decVX*=.95,o._decVY*=.95),o.bouncing&&(i=n=0,r=o.penetrationAcceleration,a=o.penetrationDeceleration,s<o._minDecL?n=o._minDecL-s:s>o._maxDecL&&(n=o._maxDecL-s),u<o._minDecT?i=o._minDecT-u:u>o._maxDecT&&(i=o._maxDecT-u),0!=n&&(n*o._decVX<=0?o._decVX+=n*a:o._decVX=n*r),0!=i&&(i*o._decVY<=0?o._decVY+=i*a:o._decVY=i*r))}),s=this.snapping?4:.001;this._isDecelerating=this._start(a,(function(){return Math.abs(o._decVX)>=s||Math.abs(o._decVY)>=s||!(o._isDecComp=!0)}),(function(e,t,r){o._isDecelerating=!1,o._scrollComp&&o._scrollComp(),o._scrollTo(o._srL,o._srT,o.snapping)}))},n._stop=function(e){var t=null!=this._running[e];return t&&(this._running[e]=null),t},n._isRunning=function(e){return null!=this._running[e]},n._start=function(e,t,r,n,i){var o=this,a=this._time(),s=a,u=0,c=0,l=this._counter++;if(l%16==0){var d,h={};for(d in this._running)h[d]=!0;this._running=h}return this._running[l]=!0,p((function g(d){d=!0!==d;var h=o._time();if(!o._running[l]||t&&!t(l))return o._running[l]=null,void(r&&r(o._fps-c/((h-a)/1e3),l,!1));if(d)for(var f=Math.round((h-s)/(1e3/o._fps))-1,m=0;m<Math.min(f,4);m++)g(!0),c++;n&&1<(u=(h-a)/n)&&(u=1);var _=i?i(u):u;!1!==e(_,h,d)&&1!==u||!d?d&&(s=h,p(g)):(o._running[l]=null,r&&r(o._fps-c/((h-a)/1e3),l,1===u||null==n))})),l},n.dispose=function(){var t;e.prototype.dispose.call(this),(this._db=null)!=(t=this.cvsMng)&&t.dispose(),(this.cvsMng=null)!=(t=this.slide)&&t.dispose(),this.slide=null,this.hermite=null,this.offScreenCanvas=null,this.isDisposed=!0},r}(S),He=function(e){function r(t,r){var n=e.call(this,r)||this;return n.uid=null,n._tbPub=null,n._size=null,n._mouseShape="pointer",n._direction="vertical",n._sequence=-1,n._location="horizontal",n._showThb=!0,n._showPNum=!1,n._showRmBtn=!1,n._fullThb=!1,n._dragging=!0,n._resizing=!0,n._keyboard=!1,n._rows=4,n._columns=1,n._bg="rgba(67,66,70,1)",n._border="1px solid rgba(27,27,29,1)",n._pageBg="rgba(0,0,0,0)",n._pageBorder="1px solid rgba(128,128,128,1)",n._sltPBg="rgba(127,133,251,1)",n._sltPBorder="1px solid rgba(255,0,0,1)",n._hvPBg="rgba(196,250,248,1)",n._hvPBorder="1px solid rgba(255,255,0,1)",n._placeholderBg="rgba(255,192,203,1)",n._pageMargin=10,n._autoChangeIdx=!1,n._checkboxConfig={},n._pageNumberConfig={},n._multiSelectMode=!1,n._optimizeImage=!0,n.uid=m(11),n._tbPub=new S,n.init(t),n._tbPub._on("_changeThumbnailViewProp",(function(e){for(var t in e)n[t]=e[t]})),n}t(r,e);var d=r.prototype;return d.updateUiSetting=function(e){this.init(e=void 0===e?{}:e)},d.init=function(e,t){var r=this;void 0===t&&(t=[]),Object.keys(e).forEach((function(n){var i=r[n];i!==e[n]&&(r[n]=e[n],i===r[n]&&t.push(n))}))},d._err=function(e){this._emit(B,e)},d._ok=function(){this._emit(B,ge)},d.scrollTo=function(e){this.emit("_scrollToUI",e,!1)},d.setViewMode=function(e,t){return s(e)&&s(t)?e<0||t<0?(this._err(me),!1):(this._rows=t,this._columns=e,this.emit("_setViewModeUI",e,t),!0):(this._err(fe),!1)},d.getConfig=function(){return{pubsub:this._tbPub.getPublishSubscribe(),uid:this.uid,size:this.size,mouseShape:this.mouseShape,scrollDirection:this.scrollDirection,sequence:this.sequence,location:this.location,showThumbnail:this.showThumbnail,showPageNumber:this.showPageNumber,showRemoveBtn:this.showRemoveBtn,fullThumbnail:this.fullThumbnail,allowPageDragging:this.allowPageDragging,allowResizing:this.allowResizing,allowKeyboardControl:this.allowKeyboardControl,autoChangeIndex:this.autoChangeIndex,rows:this.rows,columns:this.columns,background:this.background,border:this.border,pageBackground:this.pageBackground,pageBorder:this.pageBorder,selectedPageBackground:this.selectedPageBackground,selectedPageBorder:this.selectedPageBorder,hoverPageBackground:this.hoverPageBackground,hoverPageBorder:this.hoverPageBorder,placeholderBackground:this.placeholderBackground,pageMargin:this.pageMargin,checkbox:this.checkbox,pageNumber:this.pageNumber}},d.on=function(e,t){return o(e)&&i(t)?(this._tbPub._on(e,t),!0):(this._err(fe),!1)},d.emit=function(e){var t;if(!o(e))return this._err(fe),!1;for(var r=arguments.length,n=new Array(1<r?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return(t=this._tbPub)._emit.apply(t,[e].concat(n)),!0},d.off=function(e,t){return o(e)?(this._tbPub._off(e,t),!0):(this._err(fe),!1)},d._notifyUi=function(e){this.emit("_updateThumbnailPropUI",e)},d.dispose=function(){var t;e.prototype.dispose.call(this),null!=(t=this._tbPub)&&t.dispose(),this._tbPub=null},Ae(r,[{key:"optimizeImage",get:function(){return this._optimizeImage},set:function(e){this._optimizeImage=e,this._notifyUi({optimizeImage:e}),this._ok()}},{key:"multiSelectMode",get:function(){return this._multiSelectMode},set:function(e){u(e)?(this._multiSelectMode=e,this._notifyUi({multiSelectMode:e}),this._ok()):this._err(fe)}},{key:"checkbox",get:function(){return this._checkboxConfig},set:function(e){n(e)?(Object.assign(this._checkboxConfig,e),this._notifyUi({checkbox:e}),this._ok()):this._err(fe)}},{key:"pageNumber",get:function(){return this._pageNumberConfig},set:function(e){n(e)?(e.visibility!==undefined&&(this._showPNum="visible"===e.visibility),Object.assign(this._pageNumberConfig,e),this._notifyUi({pageNumber:e}),this._ok()):this._err(fe)}},{key:"size",get:function(){return this._size},set:function(e){a(e)?(this._size=e,this._notifyUi({size:e}),this._ok()):this._err(Me)}},{key:"mouseShape",get:function(){return this._mouseShape},set:function(e){o(e)?(this._mouseShape=e,this._notifyUi({mouseShape:e}),this._ok()):this._err(fe)}},{key:"pubsub",get:function(){return this._tbPub.getPublishSubscribe()}},{key:"scrollDirection",get:function(){return this._direction},set:function(e){o(e)?(this._direction=e,this._notifyUi({scrollDirection:e}),this._ok()):this._err(fe)}},{key:"sequence",get:function(){return this._sequence},set:function(e){s(e)?(this._sequence=e,this._notifyUi({sequence:e}),this._ok()):this._err(fe)}},{key:"location",get:function(){return this._location},set:function(e){o(e)?(this._location=e,this._notifyUi({location:e}),this._ok()):this._err(fe)}},{key:"showThumbnail",get:function(){return this._showThb},set:function(e){u(e)?(this._showThb=e,this._notifyUi({showThumbnail:e}),this._ok()):this._err(fe)}},{key:"showPageNumber",get:function(){return this._showPNum},set:function(e){u(e)?(this._showPNum=e,this._pageNumberConfig||(this._pageNumberConfig={}),this._pageNumberConfig.visibility=e?"visible":"hidden",this._notifyUi({showPageNumber:e}),this._ok()):this._err(fe)}},{key:"showRemoveBtn",get:function(){return this._showRmBtn},set:function(e){u(e)?(this._showRmBtn=e,this._notifyUi({showRemoveBtn:e}),this._ok()):this._err(fe)}},{key:"fullThumbnail",get:function(){return this._fullThb},set:function(e){u(e)?(this._fullThb=e,this._notifyUi({fullThumbnail:e}),this._ok()):this._err(fe)}},{key:"rows",get:function(){return this._rows},set:function(e){s(e)?e<=0?this._err(me):(this._rows=e,this._notifyUi({rows:e}),this._ok()):this._err(fe)}},{key:"columns",get:function(){return this._columns},set:function(e){s(e)?e<=0?this._err(me):(this._columns=e,this._notifyUi({columns:e}),this._ok()):this._err(fe)}},{key:"background",get:function(){return this._bg},set:function(e){c(e)?(this._bg=e,this._notifyUi({background:e}),this._ok()):this._err(Se)}},{key:"border",get:function(){return this._border},set:function(e){l(e)?(this._border=e,this._notifyUi({border:e}),this._ok()):this._err(ke)}},{key:"pageBackground",get:function(){return this._pageBg},set:function(e){c(e)?(this._pageBg=e,this._notifyUi({pageBackground:e}),this._ok()):this._err(Se)}},{key:"pageBorder",get:function(){return this._pageBorder},set:function(e){l(e)?(this._pageBorder=e,this._notifyUi({pageBorder:e}),this._ok()):this._err(ke)}},{key:"selectedPageBackground",get:function(){return this._sltPBg},set:function(e){c(e)?(this._sltPBg=e,this._notifyUi({selectedPageBackground:e}),this._ok()):this._err(Se)}},{key:"selectedPageBorder",get:function(){return this._sltPBorder},set:function(e){l(e)?(this._sltPBorder=e,this._notifyUi({selectedPageBorder:e}),this._ok()):this._err(ke)}},{key:"hoverPageBackground",get:function(){return this._hvPBg},set:function(e){c(e)?(this._hvPBg=e,this._notifyUi({hoverPageBackground:e}),this._ok()):this._err(Se)}},{key:"hoverPageBorder",get:function(){return this._hvPBorder},set:function(e){l(e)?(this._hvPBorder=e,this._notifyUi({hoverPageBorder:e}),this._ok()):this._err(ke)}},{key:"placeholderBackground",get:function(){return this._placeholderBg},set:function(e){c(e)?(this._placeholderBg=e,this._notifyUi({placeholderBackground:e}),this._ok()):this._err(Se)}},{key:"pageMargin",get:function(){return this._pageMargin},set:function(e){a(e)?(this._pageMargin=e,this._notifyUi({pageMargin:e}),this._ok()):this._err(Me)}},{key:"allowPageDragging",get:function(){return this._dragging},set:function(e){u(e)?(this._dragging=e,this._notifyUi({allowPageDragging:e}),this._ok()):this._err(fe)}},{key:"allowResizing",get:function(){return this._resizing},set:function(e){u(e)?(this._resizing=e,this._notifyUi({allowResizing:e}),this._ok()):this._err(fe)}},{key:"allowKeyboardControl",get:function(){return this._keyboard},set:function(e){u(e)?(this._keyboard=e,this._notifyUi({allowKeyboardControl:e}),this._ok()):this._err(fe)}},{key:"autoChangeIndex",get:function(){return this._autoChangeIdx},set:function(e){u(e)?(this._autoChangeIdx=e,this._notifyUi({autoChangeIndex:e}),this._ok()):this._err(fe)}}]),r}(S),Xe=function(){function e(e){var t=this;this.uid=null,this.mode="normal",this.vertexes=[],this.midpoints=[],this.probePoints=[],this.slopeRatio=[],this.isCrop=!1,this.isConvex=!0,this.isPointSelected=!1,this.activeProbePoint=null,this.moveLeft=0,this.moveTop=0,this.isMoveBox=!1,this.width=0,this.height=0,this.type="bottomRight",this.keepAspectRatio=!1,this.aspectRatio=0,this._startX=null,this._startY=null,this._lastX=null,this._lastY=null,this._lastWhr=1,this.zoom=1,this.dpr=1,this.cropBoxStyle={ctrlWidth:8,ctrlHeight:8},this.uid=m(11),Object.keys(e).forEach((function(r){t[r]=e[r]})),this._initBox()}var t=e.prototype;return t.getRect=function(){if("free"===this.mode)return null;var e=(n=this._getMaxPoint()).minX,t=n.maxX,r=n.minY,n=n.maxY;return{x:Math.floor(e),y:Math.floor(r),width:Math.floor(t-e),height:Math.floor(n-r)}},t._initBox=function(){this.midpoints=this._calcMidpoint(this.vertexes),this.probePoints=this.vertexes.slice().concat(this.midpoints.slice()),this.slopeRatio=this._calcSlopeRatio(this.vertexes)},t._getMaxPoint=function(){return{minX:Math.min(this.probePoints[0],this.probePoints[2],this.probePoints[4],this.probePoints[6]),maxX:Math.max(this.probePoints[0],this.probePoints[2],this.probePoints[4],this.probePoints[6]),minY:Math.min(this.probePoints[1],this.probePoints[3],this.probePoints[5],this.probePoints[7]),maxY:Math.max(this.probePoints[1],this.probePoints[3],this.probePoints[5],this.probePoints[7])}},t.checkPointPosition=function(e){var t=(i=this._getMaxPoint()).minX,r=i.maxX,n=i.minY,i=i.maxY,o=this.probePoints[2*e],a=this.probePoints[2*e+1];return e<4?o===r&&a===i?"se":o===r&&a===n?"ne":o===t&&a===n?"nw":o===t&&a===i?"sw":null:o===r?"e":a===i?"s":o===t?"w":a===n?"n":null},t.onStartHandler=function(e,t,r){var n=this.isBoxSelected(e,t);null!==(n=r!==undefined?r:n)&&(this._startX=e,this._startY=t,this._lastX=e,this._lastY=t,-1===n?(this.isPointSelected=!1,this.activeProbePoint=null,"normal"===this.mode&&(this.isMoveBox=!0)):(this.isPointSelected=!0,this.activeProbePoint=n,this.isMoveBox=!1),"free"===this.mode&&3<n&&(this.k1=this.slopeRatio[(1+(r=n-4))%4],this.b1=this.probePoints[(2*r+3)%8]-this.k1*this.probePoints[(2*r+2)%8],this.k2=this.slopeRatio[(3+r)%4],this.b2=this.probePoints[(2*r+1)%8]-this.k2*this.probePoints[(2*r+0)%8]))},t.onMoveHandler=function(e,t,r){if(this.isPointSelected||this.isMoveBox){var n=this.probePoints.slice();if(this.isPointSelected){var i=this.activeProbePoint;r=(r!==undefined&&(i=r),"normal"===this.mode?n=this._movePointNormal(n,i,e,t):(n=this._movePointFree(n,i,e,t),this.slopeRatio=this._calcSlopeRatio(this.probePoints).slice(0,4)),this.probePoints=n.slice(),this._checkRectConvexity(this.probePoints));this.isConvex=!!r}else if(this.isMoveBox){if(i=e-this._lastX,r=t-this._lastY,0==i&&0==r)return;n=this._moveBox(n,i,r),this.probePoints=n.slice()}i=this._calcMidpoint(this.probePoints),this.probePoints=this.probePoints.slice(0,8).concat(i),this.midpoints=i,this._lastX=e,this._lastY=t}},t.onEndHandler=function(){this.isConvex=!0;var e,t=this._startX,r=this._startY,n=(this._startX=0,this._startY=0,this._lastX),i=this._lastY;(this.isPointSelected||this.isMoveBox)&&(this.isPointSelected=!1,this.isMoveBox=!1,this.activeProbePoint=null,e=this._checkRectConvexity(this.probePoints),(t!==n||r!==i)&&e||(this.probePoints=this.vertexes.slice().concat(this.midpoints)),this.vertexes=this.probePoints.slice(0,8),this.midpoints=this._calcMidpoint(this.probePoints),this.probePoints=this.probePoints.slice(0,8).concat(this.midpoints),this.slopeRatio=this._calcSlopeRatio(this.probePoints).slice(0,4))},t._checkEdge=function(e,t){return 0<=e&&e<=this.width&&0<=t&&t<this.height},t._movePointNormal=function(e,t,r,n){r=Math.max(0,Math.min(this.width,r)),n=Math.max(0,Math.min(this.height,n));var i=0,o=0;if(this.keepAspectRatio){var a=(c=this._getMaxPoint()).minX,s=c.maxX,u=c.minY,c=c.maxY,l=this.checkPointPosition(t);a=(0===(s=(s-a)/(c-u))||s===Infinity||s===-Infinity||isNaN(s)?s=this._lastWhr:this._lastWhr=s,o=i=0,"width");if(t<4){if(i=r-e[2*t],o=n-e[2*t+1],0===i||0===o)return e;a="width"}else if(c=t-4,"e"===l?(t=(1+c)%4,a="width"):"s"===l?(t=c,a="height"):"w"===l?(t=c,a="width"):"n"===l&&(t=(1+c)%4,a="height"),i=r-e[2*c],o=n-e[2*c+1],0===i||0===o)return e;"height"===a?(i=o*s,"ne"!==l&&"sw"!==l&&"n"!==l&&"w"!==l||(i=-i)):(o=i/s,"ne"!==l&&"sw"!==l&&"n"!==l&&"w"!==l||(o=-o)),u=e[2*t]+i,c=e[2*t+1]+o,u<0?(i=0-e[2*t],o=0):u>this.width?(i=this.width-e[2*t],o=0):c<0?(o=0-e[2*t+1],i=0):c>this.height&&(o=this.height-e[2*t+1],i=0),e[2*t]+=i,e[2*t+1]+=o,a=(t+1)%4,s=(t+3)%4,t%2?(e[2*a]+=i,e[2*s+1]+=o):(e[2*a+1]+=o,e[2*s]+=i)}else if(t<4){if(i=r-e[2*t],o=n-e[2*t+1],0===i&&0===o)return e;e[2*t]=r,e[2*t+1]=n,l=(t+1)%4,u=(t+3)%4,t%2?(e[2*l]=r,e[2*u+1]=n):(e[2*l+1]=n,e[2*u]=r)}else c=t-4,0===(a=this.slopeRatio[c%4])?(e[(2*c+3)%8]=n,e[(2*c+1)%8]=n):a!==Infinity&&a!==-Infinity||(e[(2*c+2)%8]=r,e[(2*c+0)%8]=r);return e},t._movePointFree=function(e,t,r,n){r=Math.max(0,Math.min(this.width,r)),n=Math.max(0,Math.min(this.height,n));var i=e.slice();if(t<4){var o=r-e[2*t],a=n-e[2*t+1];if(0==o&&0==a)return e;e[2*t]=r,e[2*t+1]=n}else{o=t-4;var s=-(t=n-(a=this.slopeRatio[o%4])*r)/a,u=t,c=e[(2*o+9)%8]-a*e[(2*o+8)%8],l=-c/a,d=this.k1,h=this.b1,g=this.k2,f=this.b2;0===a?(e[(2*o+3)%8]=n,d!==Infinity&&d!==-Infinity&&(e[(2*o+2)%8]=(n-h)/d),e[(2*o+1)%8]=n,g!==Infinity&&g!==-Infinity&&(e[(2*o+0)%8]=(n-f)/g)):a===Infinity||a===-Infinity?(e[(2*o+2)%8]=r,e[(2*o+3)%8]=d*r+h,e[(2*o+0)%8]=r,e[(2*o+1)%8]=g*r+f):(0===d?e[(2*o+2)%8]+=s-l:d===Infinity||d===-Infinity?e[(2*o+3)%8]+=u-c:(e[(2*o+2)%8]=(h-t)/(a-d),e[(2*o+3)%8]=(a*h-d*t)/(a-d)),0===g?e[(2*o+0)%8]+=s-l:g===Infinity||g===-Infinity?e[(2*o+1)%8]+=u-c:(e[(2*o+0)%8]=(f-t)/(a-g),e[(2*o+1)%8]=(a*f-g*t)/(a-g)));for(var m=0;m<4;m++){var _=e[2*m],p=e[2*m+1];if(_<0||_>this.width||p<0||p>this.height)return i}}return e},t._moveBox=function(e,t,r){if("normal"===this.mode){var n=Math.min(e[0],e[2],e[4],e[6]),i=Math.max(e[0],e[2],e[4],e[6]),o=Math.min(e[1],e[3],e[5],e[7]),a=Math.max(e[1],e[3],e[5],e[7]);i+(t=n+t<0?-n:t)>this.width&&(t=this.width-i),a+(r=o+r<0?-o:r)>this.height&&(r=this.height-a);for(var s=0;s<4;s++)e[2*s]+=t,e[2*s+1]+=r}return e},t._isPointOnBox=function(e,t){var r,n,i,o;return"normal"===this.mode&&(r=(o=this._getMaxPoint()).minX,n=o.maxX,i=o.minY,o=o.maxY,r<=e&&e<=n&&i<=t&&t<=o)},t.isBoxSelected=function(e,t){var r=this._isPointOnBox(e,t);return null!==(e=this.isCtrlPointSelected(e,t))?e:r?-1:null},t.isCtrlPointSelected=function(e,t){for(var r=this.cropBoxStyle.ctrlWidth/this.zoom/2,n=this.cropBoxStyle.ctrlHeight/this.zoom/2,i=(s=this._getMaxPoint()).minX,o=s.maxX,a=s.minY,s=s.maxY,u=(r=Math.min(Math.max(r,.1*(o-i)),3*r),n=Math.min(Math.max(n,.1*(s-a)),3*n),0);u<8;u++){var c=this.probePoints[2*u],l=this.probePoints[2*u+1];if(e<=c+r&&c-r<=e&&t<=l+n&&l-n<=t&&0<=e&&e<=this.width&&0<=t&&t<=this.height)return u}return null},t._checkRectConvexity=function(e){var t=(e[6]-e[0])*(e[3]-e[1])-(e[7]-e[1])*(e[2]-e[0]),r=(e[0]-e[2])*(e[5]-e[3])-(e[1]-e[3])*(e[4]-e[2]),n=(e[2]-e[4])*(e[7]-e[5])-(e[3]-e[5])*(e[6]-e[4]),i=(e[4]-e[6])*(e[1]-e[7])-(e[5]-e[7])*(e[0]-e[6]);if(t*r*n*i<0)return!1;var o=e.slice().concat(e.slice(0,2));if(this.slopeRatio.length)for(var a=0;a<2;a++)if(this.slopeRatio[a]!==this.slopeRatio[a+2]&&this._calcIntersection(o.slice(2*a,2*a+2),o.slice(2*a+2,2*a+4),o.slice(2*a+4,2*a+6),o.slice(2*a+6,2*a+8)))return!1;return 0<t*r*n*i},t._calcMidpoint=function(e){for(var t=e.slice(0,8).concat(e[0],e[1]),r=[],n=0;n<4;n++){var i=(t[2*n]+t[2*n+2])/2,o=(t[2*n+1]+t[2*n+3])/2;r.push(i,o)}return r},t._calcSlopeRatio=function(e){for(var t=[],r=null,n=e.slice(0,8).concat(e[0],e[1]),i=0;i<4;i++)r=n[2*i+3]-n[2*i+1]==0&&n[2*i+2]-n[2*i]==0?0:(n[2*i+3]-n[2*i+1])/(n[2*i+2]-n[2*i]),t.push(r);return t},t._calcIntersection=function(e,t,r,n){if(this._isRectCross(e,t,r,n)&&this._isLineSegmentCross(e,t,r,n)){var i=(n[0]-r[0])*(e[1]-t[1])-(t[0]-e[0])*(r[1]-n[1]),o=(e[1]-r[1])*(t[0]-e[0])*(n[0]-r[0])+r[0]*(n[1]-r[1])*(t[0]-e[0])-e[0]*(t[1]-e[1])*(n[0]-r[0]);if(0==i||0===o){var a=this._getLine(e,t),s=this._getLine(r,n),u=a[0],c=a[1],l=s[0],d=s[1];if(c[0]===l[0]&&c[1]===l[1])return c;if(u[0]===d[0]&&u[1]===d[1])return u;if(this._isOnLine(c,s)&&this._isOnLine(l,a))return[l,c];if(this._isOnLine(u,s)&&this._isOnLine(d,a))return[u,d];if(this._isOnLine(u,s)&&this._isOnLine(c,s))return[u,c];if(this._isOnLine(l,s)&&this._isOnLine(d,s))return[l,d]}return a=o/i,i=(e[0]-t[0])*(n[1]-r[1])-(t[1]-e[1])*(r[0]-n[0]),[a,(o=t[1]*(e[0]-t[0])*(n[1]-r[1])+(n[0]-t[0])*(n[1]-r[1])*(e[1]-t[1])-n[1]*(r[0]-n[0])*(t[1]-e[1]))/i]}return!1},t._getLine=function(e,t){return e[0]===t[0]?e[1]<t[1]?[e,t]:[t,e]:e[0]<t[0]?[e,t]:[t,e]},t._isOnLine=function(e,t){return t[0][0]===t[1][0]?e[1]>=t[0][1]&&e[1]<=t[1][1]:e[0]>=t[0][0]&&e[0]<=t[1][0]},t._isRectCross=function(e,t,r,n){var i=Math.min,o=Math.max;return i(e[0],t[0])<=o(r[0],n[0])&&i(r[0],n[0])<=o(e[0],t[0])&&i(e[1],t[1])<=o(r[1],n[1])&&i(r[1],n[1])<=o(e[1],t[1])},t._isLineSegmentCross=function(e,t,r,n){var i=e[0]*(r[1]-t[1])+t[0]*(e[1]-r[1])+r[0]*(t[1]-e[1]),o=e[0]*(n[1]-t[1])+t[0]*(e[1]-n[1])+n[0]*(t[1]-e[1]);return!(0<=(i^o)&&0!==i&&0!==o||0<=((i=r[0]*(e[1]-n[1])+n[0]*(r[1]-e[1])+e[0]*(n[1]-r[1]))^(o=r[0]*(t[1]-n[1])+n[0]*(r[1]-t[1])+t[0]*(n[1]-r[1])))&&0!==i&&0!==o)},e}(),Ye=function(){function e(e,t,r){this._activeBoxId=null,this._startX=null,this._startY=null,this._addNewFlag=null,this._drawingFlag=!1,this.cropBoxes=[],this.width=0,this.height=0,this.zoom=1,this.aspectRatio=0,this.keepAspectRatio=!1,this.mouseDown=!1,this.unselectedCallback=null,this.selectedCallback=null,this.cropBoxStyle={},this.width=e,this.height=t,Object.assign(this.cropBoxStyle,r)}var t=e.prototype;return t.setCropBoxStyle=function(e){Object.assign(this.cropBoxStyle,e),this.cropBoxes.forEach((function(t){Object.assign(t.cropBoxStyle,e)}))},t.updateDpr=function(e){this.cropBoxes.forEach((function(t){t.dpr=e}))},t.setKeepAspectRatio=function(e){this.keepAspectRatio=e,this._drawingFlag||this.cropBoxes.forEach((function(t){t.keepAspectRatio=e}))},t.setAspectRatio=function(e){this.aspectRatio=e},t.setZoom=function(e){this.zoom=e,this.cropBoxes.forEach((function(t){t.zoom=e}))},t.setPageSize=function(e,t){this.width=e,this.height=t},t.getRectArr=function(){var e=[];return this.cropBoxes.forEach((function(t,r){r=Object.assign({index:r},t.getRect()),e.push(r)})),e},t.clear=function(){var e;0<this.cropBoxes.length&&null!=(e=this.unselectedCallback)&&e.call(this),this.cropBoxes=[]},t.addFreeBox=function(e){var t=v();e=new Xe({cropBoxStyle:this.cropBoxStyle,vertexes:e.slice(),width:this.width,height:this.height,mode:"free",dpr:t});return this.cropBoxes.push(e),e},t.addBox=function(e,t){var r=v();e=new Xe({cropBoxStyle:this.cropBoxStyle,vertexes:e.slice(),width:this.width,height:this.height,type:t,mode:"normal",aspectRatio:this.aspectRatio,keepAspectRatio:this.keepAspectRatio,zoom:this.zoom,dpr:r});return this.cropBoxes.push(e),e},t.removeBox=function(e){return e===undefined&&this.clear(),!(e<0||e>=this.cropBoxes.length||(this.cropBoxes.splice(e,1),0))},t.getBoxByUid=function(e){for(var t=this.cropBoxes.length,r=0;r<t;r++)if(this.cropBoxes[r].uid===e)return this.cropBoxes[r];return null},t.onStartHandler=function(e,t,r){this._startX=e,this._startY=t,this.mouseDown=!0;var n=this.checkSelect(e,t);if(null===n)return r||this.clear(),void(this._activeBoxId=null);this._activeBoxId=this.cropBoxes[n].uid,this.getBoxByUid(this._activeBoxId).onStartHandler(e,t)},t.onMoveHandler=function(e,t,r){if(this.mouseDown){var n=null,i=e-this._startX,o=t-this._startY,a=null,s=2/this.zoom,u=(!this._activeBoxId&&e-this._startX<-s&&t-this._startY<-s?(a=0)<this.aspectRatio&&(o=i/this.aspectRatio):!this._activeBoxId&&e-this._startX>s&&t-this._startY<-s?(a=1,0<this.aspectRatio&&(o=-i/this.aspectRatio)):!this._activeBoxId&&e-this._startX>s&&t-this._startY>s?(a=2,0<this.aspectRatio&&(o=i/this.aspectRatio)):!this._activeBoxId&&e-this._startX<-s&&t-this._startY>s&&(a=3,0<this.aspectRatio&&(o=-i/this.aspectRatio)),[e,this._startY+o,this._startX,this._startY+o,this._startX,this._startY,e,this._startY]),c=[this._startX,this._startY,this._startX,this._startY+o,e,this._startY+o,e,this._startY];if(null!==a){for(var l=[],d=0;d<4;d++)a%2?(l.push(c[2*(a+d)%8]),l.push(c[(2*(a+d)+1)%8])):(l.push(u[2*(a+d)%8]),l.push(u[(2*(a+d)+1)%8]));return n=this.addBox(l,["topLeft","topRight","bottomRight","bottomLeft"][a]),0<this.aspectRatio?n.keepAspectRatio=!0:n.keepAspectRatio=!1,this._drawingFlag=!0,this._addNewFlag=this.keepAspectRatio,this._activeBoxId=n.uid,n.onStartHandler(this._startX,this._startY,a),n.onMoveHandler(e,t,a),void(a=null)}(n=this._activeBoxId?this.getBoxByUid(this._activeBoxId):n)&&n.onMoveHandler(e,t)}},t.onEndHandler=function(){var e;this.mouseDown&&(this.mouseDown=!1,this._drawingFlag=!1,this._activeBoxId&&(e=this.getBoxByUid(this._activeBoxId),null!==this._addNewFlag&&(e.keepAspectRatio=this._addNewFlag,this._addNewFlag=null),e.onEndHandler(),0<this.cropBoxes.length&&null!=(e=this.selectedCallback)&&e.call(this,this.getRectArr()),this._activeBoxId=null))},t.checkSelect=function(e,t){var r=this.cropBoxes.length;if(0===r)return null;for(var n=r-1;0<=n;n--)if(null!==this.cropBoxes[n].isBoxSelected(e,t))return n;return null},t.checkSelectForCursor=function(e,t){var r=this.cropBoxes.length;if(0===r)return null;for(var n=r-1;0<=n;n--){var i,o=this.cropBoxes[n],a=o.isBoxSelected(e,t);if(null!==a)return i="move",-1!==a&&(i=o.checkPointPosition(a)),{part:a,type:o.type,position:i}}return null},t.dispose=function(){this.unselectedCallback=null,this.selectedCallback=null},e}(),Je=function(){function e(e,t,r){this._db=null,this.visible=!1,this.children=[],this.redoStack=[],this.undoStack=[],this.matrixStack=[],this.style={left:0,top:0,width:0,height:0,borderColor:"#ffffff",borderType:"solid",borderWidth:0},this.naturalWidth=0,this.naturalHeight=0,this.wrapLeft=0,this.wrapTop=0,this.wrapWidth=0,this.wrapHeight=0,this.rotateAngle=0,this.flipCount=0,this.flipCountX=0,this.flipCountY=0,this.selectionBoxes=[],this.cropMng=null,this.editor2d=null,this._db=t,this.uid=e.uid,this.naturalWidth=e.naturalW,this.naturalHeight=e.naturalH,this.cropMng=new Ye(this.naturalWidth,this.naturalHeight,r),this.editor2d=new We}var t=e.prototype;return t.setBorder=function(e,t,r){this.style.borderWidth=e,t&&(this.style.borderType=t),r&&(this.style.borderColor=r)},t.setSize=function(e,t){this.style.width=e||1,this.style.height=t||1},t.setPosition=function(e,t){this.style.left=e,this.style.top=t},t.clearSelectionBoxes=function(){this.selectionBoxes=[]},t.pushSelectionBox=function(e){this.selectionBoxes.push(e)},t.setNaturalSize=function(e,t){var r=this._db.getMid(this.uid);r&&(r.tempWidth=e,r.tempHeight=t),this.naturalWidth=e,this.naturalHeight=t,this.cropMng.setPageSize(e,t)},t.boxCount=function(){return this.cropMng.cropBoxes.length},e}(),Ke=(k=function(){function e(e){this.uid=e.uid,this.chs=e.chs||[]}var t=e.prototype;return t.append=function(e){return-1===this._idxOf(e)&&(this.chs.push(e),!0)},t.insert=function(e,t){return!(t<0||t>=this.chs.length||(this.chs.splice(t,0,e),0))},t.remove=function(e){return-1!==(e=this._idxOf(e))&&(this.chs.splice(e,1),!0)},t.clear=function(){return this.chs=[],!0},t.move=function(e,t){return e===t||(e=this.chs.splice(e,1)[0],this.chs.splice(t,0,e)),!0},t["switch"]=function(e,t){if(e===t)return!0;var r=this.chs[e];return this.chs[e]=this.chs[t],this.chs[t]=r,!0},t.reorder=function(e){var t=e.length,r=[],n=0;if(this.chs.length!==t||0===t)return!1;for(var i=0;i<t;i++)e[i]===i&&n++;if(n===t)return!0;for(var o=0;o<t;o++)r[o]=this.chs[e[o]];for(var a=0;a<t;a++)this.chs[a]=r[a];return!0},t._idxOf=function(e){for(var t=o(e),r=0,n=this.chs.length;r<n;r++){if(t&&this.chs[r]===e)return r;if(!t&&this.chs[r].uid===e.uid)return r}return-1},e}(),function(e){function r(t){var r=e.call(this,t)||this;return r.cur=-1,r.total=0,r.slt=[],r.chs=[],r.thbs=[],r.scrL=0,r.scrT=0,r.virW=0,r.virH=0,r.iMargin=0,r.oMargin=0,r.zoom=1,r.fitType="window",r.clickZoom=!1,r.isFreeCrop=!1,r.disMode="single",r.opMode=0,r.name=t.name,r.type=t.type,r.chs=t.chs,r.zoom=t.zoom,r.fitType=t.fitType,r.disMode=t.disMode,r.opMode=t.opMode,r}t(r,e);var n=r.prototype;return n.getCurUid=function(){return-1===this.cur?null:this.chs[this.cur].uid},n.getCurPage=function(){return-1===this.cur?null:this.chs[this.cur]},n.idxPage=function(e){return this.chs[e]},n.uidPage=function(e){if(!e)return null;for(var t=0;t<this.total;t++)if(this.chs[t].uid===e)return this.chs[t];return null},n.uid2Idx=function(e){for(var t=0;t<this.total;t++)if(this.chs[t].uid===e)return t;return-1},n.setCur=function(e){return!(e<0||e>=this.total||(this.cur=e,0))},n.append=function(e){return this.chs.push(e),!0},n.remove=function(e){var t=this.chs.length;return 0!==t&&(1===t?this.chs[0].uid===e&&(this.cur=-1,this.total=0,this.slt=[],this.chs=[],!0):-1!==(t=this.uid2Idx(e))&&((t===this.cur&&t===this.total-1||t<this.cur)&&this.cur--,this.chs.splice(t,1),this.chs[this.cur]?this.slt=[this.chs[this.cur].uid]:this.slt=[],this.total--,!0))},n.clear=function(){return this.chs=[],this.slt=[],this.cur=-1,!(this.total=0)},n.getSlt=function(){return this.slt.slice()},n.setSlt=function(e){var t=e.length;return 0===t?(this.slt=e,this.cur=-1,!0):-1!==(t=this.uid2Idx(e[t-1]))&&(this.slt=e,this.cur=t,!0)},n.move=function(t,r){return e.prototype.move.call(this,t,r),this.setSlt([this.chs[r].uid])},n["switch"]=function(t,r){return e.prototype["switch"].call(this,t,r),this.cur===t?this.setSlt([this.chs[r].uid]):this.cur===r&&this.setSlt([this.chs[t].uid]),!0},n.next=function(){return 0===this.total?-1:(1<this.total-this.cur&&this.cur<this.total&&this.cur++,this.slt=[this.chs[this.cur].uid],this.cur)},n.prev=function(){return 0===this.total?-1:(0<this.cur&&this.cur--,this.cur<0?-1:(this.slt=[this.chs[this.cur].uid],this.cur))},n.first=function(){return 0===this.total?-1:(this.cur=0,this.slt=[this.chs[0].uid],0)},n.last=function(){return 0===this.total?-1:(this.cur!==this.total-1&&(this.cur=this.total-1),this.slt=[this.chs[this.cur].uid],this.cur)},n.goto=function(e){return 0===this.total?-1:(e!==this.cur&&(e=e<this.total?0<=e?e:0:this.total-1,this.cur=e),this.slt=[this.chs[this.cur].uid],this.cur)},r}(k)),Ze=function(){function e(e){this.tabs=[],this.mode="single",this.curTab=null,this.dfConfig=null,this._opStack=[],this.tabs=[],this.dfConfig={zoom:1,fitType:"window",disMode:"single",opMode:0}}var t=e.prototype;return t.addTab=function(e){var t=this.checkTab(e.uid),r=null;return-1!==t?r=this.tabs[t]:(t=Object.assign(this.dfConfig,e),r=new Ke(t),"single"===this.mode?this.tabs=[r]:this.tabs.push(r)),r},t.getTab=function(e){return-1===(e=this.checkTab(e))?null:this.tabs[e]},t.checkTab=function(e){for(var t=this.tabs.length,r=0;r<t;r++)if(this.tabs[r].uid===e)return r;return-1},t.getCurTab=function(){return this.getTab(this.curTab)},t.setCurTab=function(e){if(~this.checkTab(e))return this.curTab=e,!0},t._moveToTop=function(e,t){0<=t&&t<e.length&&(t=e.splice(t,1)[0],e.push(t))},t.closeTab=function(e){return-1!==(e=this.checkTab(e))&&(this._opStack.pop(),this.tabs.splice(e,1),0===this.tabs.length?this.curTab=null:this.curTab=this._opStack[this._opStack.length-1],!0)},t.setMode=function(e){return("single"===e||"multiple"===e)&&(this.mode=e,!0)},t.removePage=function(e,t){return-1!=(e=this.checkTab(e))&&this.tabs[e].remove(t)},t.dispose=function(){},e}(),qe=function(e){function i(t,r,n,i,o,a,s,u,c){var l=e.call(this,r)||this;return l.showLatest=!0,l.isMainViewVisible=!0,l.isThumbnailVisible=!0,l.thbViews=[],l.tabMode="single",l.autoOpen=!0,l.keepZoom=!0,l.cors=!0,l.minPicWidth=800,l.minPicHeight=800,l.saveType="image/jpeg",l.saveQuality=1,l.useHermite=!0,l.rows=1,l.columns=1,l.slideTimer=null,l.showTabTimer=null,l.isDisposed=!1,l.cropBoxStyle={borderWidth:1,borderColor:"#000",invalidBorderColor:"#f00",dashLine:[4,2],background:"",ctrlBorderWidth:1,ctrlBorderRadius:0,ctrlBorderColor:"#000",invalidCtrlBorderColor:"#f00",ctrlBackground:"",ctrlWidth:8,ctrlHeight:8,enableConcaveBorderColor:!1},Object.assign(l.cropBoxStyle,t.uiConfig.canvasConfig.cropBoxStyle||{}),l.saveCanvas=c,l.uid=i,l._mPub=new S(n),l._db=s,l._tabMng=new Ze(t),document.documentMode===undefined&&!d()||(l.useHermite=!1),l._gpc=new ze(t,l._db,l._oPub,i,l.useHermite,o,a,u),l._initEvent(),l._gpc.slide.bindSlideEndCallback((function(t){t===x?l.prevPage():t===P&&l.nextPage(),e.prototype._emit.call(Be(l),"slideFinished",t),l.setFitType("window")})),l}t(i,e);var a=i.prototype;return a.setUseHermite=function(e){this.useHermite=e,this._gpc.useHermite=e},a.drawSltBox=function(){var e;"single"===this._gpc.disMode&&(e=this._tabMng.getCurTab())&&(e=e.getCurPage())&&this._gpc.drawSltBox(e)},a.render=function(e,t){e=e||!1,t=t||!1;var r=this._tabMng.getCurTab();return!!r&&(this._gpc._layoutSingle(r,e,t),(e=r.getCurPage())?(this._checkDisplay(r),this._showPage(e.uid,r.uid),this._ok(),!0):(this._gpc.clearCanvas(),this._err(Ie),!1))},a.tabHandler=function(e,t,r){var n,i=this,o=(void 0===t&&(t=null),[]),a=this.getTab(e.uid);if((t=this.getCurTab())&&!a&&"single"===this.tabMode&&r&&this._emitM(q,t.uid,this.uid),!t||!a&&r)n=a=this._tabMng.addTab({uid:e.uid,name:e.name,type:e.type,chs:[]});else{if(!a)return void this._emitM(q,e.uid,this.uid);t.uid!==a.uid&&!r||(n=a)}e.chs.forEach((function(e){a.uidPage(e)||o.push(e)}));var s=o.map((function(e){var t=i._db.getMetadata(e);return new Je({uid:e,naturalW:t.width,naturalH:t.height},i._db,i.cropBoxStyle)})),u=[];return e.chs.forEach((function(e){var t=o.indexOf(e);-1<t?u.push(s[t]):(t=a.uidPage(e))&&u.push(t)})),a.chs=u,a.total=e.chs.length,this.showLatest?(this.clearBox(),t=e.chs.indexOf(o[o.length-1]),(r=a.idxPage(t))&&(a.cur=t,a.setSlt([r.uid]))):0<a.total&&-1===a.cur&&(a.cur=0),n},a.showTab=function(e,t,r){var n=this,i=(void 0===t&&(t="add"),null!==this.showTabTimer&&clearTimeout(this.showTabTimer),e.uid);this._tabMng.setCurTab(i),this._showAllThb(e),(!e.total||e.cur<0)&&this._gpc.clearCanvas(),this._gpc.initGraphic(e),this._gpc._layoutSingle(e,!0),"remove"==t&&!e.total||(this.showTabTimer=setTimeout((function(){n.isDisposed||(n._checkDisplay(e),e.chs.length||n._gpc.offScreenCanvas.reset(),e.chs.forEach((function(e){n._showPage(e.uid,i)})))}),20),this.getSlidePages()),this.__slt([e.cur]),this.__buffer(e,t,"",r),this.__pager()},a.onTabChanged=function(){this._tabMng.curTab,this._tabMng.tabs},a.updateSync=function(e,t,r){var n=this,i=null;if(!(i=t?this.getTab(t):this.getCurTab()))return this._err(_e),!1;for(var o=i.chs,a=new Je({uid:e,naturalW:r.metadata.width||0,naturalH:r.metadata.height||0},this._db,this.cropBoxStyle),s=null,u=0;u<o.length;u++)if(o[u].uid===e){s=o[u],o[u]=a;break}if(this._tabMng.curTab===i.uid){if(i.getCurUid()===e&&this._gpc.offScreenCanvas.reset(),!s)return!1;t=!0,s&&s.naturalHeight===a.naturalHeight&&s.naturalWidth===a.naturalWidth&&(t=!1),this._gpc._layoutSingle(i,t),this._gpc.initGraphic(i),this._checkDisplay(i),o.forEach((function(e){n._showPage(e.uid,i.uid,!0)})),this.getSlidePages(),this.__buffer(i,"modify",e)}},a.setTabMode=function(e){-1!==["single","multiple"].indexOf(e)&&(this.tabMode=e)},a.getSlidePages=function(){var e,t,r,n=this,i=this._tabMng.getCurTab();i&&"continuous"!==i.disMode&&(null!==this.slideTimer&&clearTimeout(this.slideTimer),e=i.cur,i=i.total,t=[],r=[-1,-1,-1],0!==i&&(0<=e-1?(t.push(e-1),r[0]=e-1):r[0]=-1,t.push(e),(r[1]=e)+1<i?(t.push(e+1),r[2]=e+1):r[2]=-1),this._gpc&&this._gpc.slide&&(this._gpc.slide.targetIndexes=r),this.slideTimer=setTimeout((function(){n.isDisposed||t.forEach((function(e){e=n.idxUid(e),n._emitM(Z,e)}))}),200))},a._setSlidePages=function(e){var t,r,n,i=this,o=this.getCurTab();!this.isDisposed&&o&&"single"===o.disMode&&(t=o.cur,r=[-1,-1,-1],0!==(n=o.total)&&(0<=t-1&&(r[0]=t-1),(r[1]=t)+1<n&&(r[2]=t+1)),r.indexOf(e)<0||(n=r.map((function(e){return i._calcSlidePage(e,t,o)})),this._gpc.setSlidePages(n)))},a._calcSlidePage=function(e,t,r){var n={width:0,height:0,index:-1,uid:null,url:""};if(-1===e)return n;var i=this.idxUid(e),o=this._db.getMid(i);r=r.idxPage(e);if(!o||!r)return n;n=r.style.width;var a=r.style.height;return e!==t&&(t=this._gpc.calcZoomForSlide(r.naturalWidth||1,r.naturalHeight||1),n=(r.naturalWidth||0)*t,a=(r.naturalHeight||0)*t),{width:n,height:a,index:e,uid:i,url:o.minData||""}},a._showAllThb=function(t,r){var n=this,i=t.chs||[],o=(r=t.uidPage(r),[]);(i=r?[r]:i).forEach((function(e){var t;!e||(t=n._db.getMid(e.uid))&&(e={uid:e.uid,data:t.minData,tags:t.getTags()},o.push(e))})),e.prototype._emit.call(this,"_thumbnailChangedUI",o)},a.showThbItem=function(t){var r,n,i=this.getCurTab();i&&(r=i.uidPage(t),n=this._db.getMid(t),r&&n&&(r={uid:t,data:n.minData,tags:n.getTags()},e.prototype._emit.call(this,z,r),n=i.uid2Idx(t),this._setSlidePages(n)))},a.needRender=function(e){return!!this._db&&!(!(e=this._db.getMid(e))||e.show.indexOf(this.uid)<0)},a.renderMainPage=function(e){this.needRender(e)&&this._db.getMid(e).img&&this._gpc.render(e)},a._showPage=function(e,t,r){var n,i=this;t===this._tabMng.curTab&&this.needRender(e)&&(n=this._db.getMid(e),!r&&n.img?null!=this&&this._gpc.render(e):!r&&n.active||(n.active=!0,this._db.getDataAsync(e).then((function(t){var o;i.needRender(e)?(t=w.createURLWithType(t.oriData),n.oriData=t.data,n.oriType=t.type,o=new Image,i.cors&&(o.crossOrigin="anonymous"),o.onload=function(){if(o.onload=null,o.onerror=null,i.isDisposed||!i.needRender(e))n.active=!1;else{if(r){if(!i._gpc)return;i._gpc.offScreenCanvas.reset()}n.img=o,i._emitM("dvsRenderMainPage",n.show.slice(),e)}},o.onerror=function(){o.onload=null,o.onerror=null},o.src=n.oriData):n.active=!1}))["catch"]((function(e){n.active=!1}))))},a._checkDisplay=function(e){var t,r=this;"single"===e.disMode&&(t=e.chs,e.getCurPage()&&t.forEach((function(t,n){var i,a,s=r._db.getMid(t.uid);s&&(t=r._gpc.checkDisplay(t.uid,e),a=(i=s.show).indexOf(r.uid),t?a<0&&i.push(r.uid):(-1<a&&i.splice(a,1),0===i.length&&(o(s.oriData)&&""!=s.oriData&&w.revokeObjectURL(s.oriData),s.active=!1,s.load=!1,s.img=null,s.oriData=null)))})))},a.getTabManager=function(){return this._tabMng},a.closeTab=function(t){var r;return!!this._tabMng.closeTab(t)&&(this._tabMng.curTab?this.showTab(this._tabMng.getCurTab(),"add"):(r=new Ke({uid:"",name:"empty",type:"",chs:[]}),this.showTab(r,"remove")),e.prototype._emit.call(this,"_onCloseTab",t),!0)},a.closeCurTab=function(){},a.emptyTab=function(e){},a.getCurrentTabId=function(){return this._tabMng.curTab},a.getTab=function(e){return this._tabMng.getTab(e)},a.getCurTab=function(){return this._tabMng?this._tabMng.getCurTab():null},a.setCurTab=function(e){return!!this._tabMng&&this._tabMng.setCurTab(e)},a.getCurPageUids=function(){var e=this.getCurTab();return e?e.chs.map((function(e){return e.uid})):[]},a.getCurPageCount=function(){var e=this.getCurTab();return e?e.total:0},a.createThumbnailView=function(e){return e=new He(e=void 0===e?{}:e,this._mPub.getPublishSubscribe()),this.thbViews.push(e),e},a.removeThumbnailView=function(e){if(!e)return this.thbViews=[],!0;for(var t=0;t<this.thbViews.length;t++)if(this.thbViews[t].uid===e)return this.thbViews.splice(t,1),!0;return!1},a.getThumbnailViewById=function(e){if(!this._chStr(e))return null;for(var t=0;t<this.thbViews.length;t++)if(this.thbViews[t].uid===e)return this._ok(),this.thbViews[t];return null},a.remove=function(t,n,i){if(void 0===n&&(n=!0),!r(t))return this._err(fe),!1;var o=this._tabMng.tabs,a=(t.forEach((function(e){o.forEach((function(t){t.remove(e)}))})),this.getCurTab());return a?(n&&this._emitM(ee,this.uid,a,t),i&&i!==a.uid||(this.showTab(a,"remove",t),0===a.chs.length&&(this._gpc.slide.targetIndexes=[-1,-1,-1],this._setSlidePages(-1),this._gpc.clearCanvas(),e.prototype._emit.call(this,H,{width:1,height:1,x:1,y:1}))),this._ok(),!0):void 0},a.rmAll=function(e){void 0===e&&(e=!0);var t=[],r=this.getCurTab();return r?(r.chs.forEach((function(e){t.push(e.uid)})),this.remove(t,e,r.uid)):(this._ok(),!0)},a.setBox=function(t,i){var o=this.getCurTab();if(!o)return!1;var a=o.getCurPage();if(a===undefined)return!1;for(var s=null,u=(r(t)?s=t:n(t)&&(s=[t]),i||0<a.boxCount()&&(a.cropMng.clear(),this.drawSltBox(),e.prototype._emit.call(this,N,o.cur)),s.length),c=0;c<u;c++){var l=s[c];if(!this._chBox(l,a.naturalWidth,a.naturalHeight))return!1;a.cropMng.addBox([l.left,l.top,l.left+l.width,l.top,l.left+l.width,l.top+l.height,l.left,l.top+l.height],"bottomRight")}return this.drawSltBox(),0<(t=a.cropMng.getRectArr()).length&&e.prototype._emit.call(this,V,o.cur,t),this._ok(),!0},a._chBox=function(e,t,r){return s(e.left)&&s(e.top)&&s(e.width)&&s(e.height)?!(e.left<0||e.top<0||e.width<0||e.height<0)&&!(e.left>t||e.top>r||e.left+e.width>t||e.top+e.height>r)||(this._err(me),!1):(this._err(we),!1)},a.clearBox=function(t){var r=this.getCurTab();if(!r)return this._err(_e),!1;var n=r.getCurPage();return n?(0<n.boxCount()&&e.prototype._emit.call(this,N,r.cur),n.cropMng.removeBox(t),this.drawSltBox(),this._ok(),!0):(this._err(Ie),!1)},a._clearBox=function(){var t=this.getCurTab();if(!t)return!1;var r=t.getCurPage();return r?(0<r.boxCount()&&e.prototype._emit.call(this,N,t.cur),r.cropMng.removeBox(),e.prototype._emit.call(this,"_clearSltBox",t.cur),!0):(this._err(Ie),!1)},a.setFreeBox=function(t){var r=this.getCurTab();if(!r)return!1;var n=r.getCurPage();return n!==undefined&&(n.cropMng.addFreeBox(t),this.drawSltBox(),0<(t=n.cropMng.getRectArr()).length&&e.prototype._emit.call(this,V,r.cur,t),this._ok(),!0)},a.nextPage=function(t){void 0===t&&(t=!0);var r=this.getCurTab();if(!r)return this._err(_e),-1;var n=r.cur,i=r.slt.length,o=r.next();return-1===o?(this._err(_e),-1):((n!==r.total-1||1<i)&&((i=r.idxPage(n))&&0<i.boxCount()&&(i.cropMng.clear(),this.drawSltBox(),e.prototype._emit.call(this,N,r.cur)),this.__pager(),this.render(!0),this.getSlidePages(),t&&this._emitM(Q,this.uid,P),this.__buffer(r,"shift")),this.__slt(),this._ok(),o)},a.prevPage=function(t){void 0===t&&(t=!0);var r=this.getCurTab();if(!r)return this._err(_e),-1;var n=r.cur,i=r.slt.length,o=r.prev();return-1===o?(this._err(_e),-1):((0!==n||1<i)&&((i=r.idxPage(n))&&0<i.boxCount()&&(i.cropMng.clear(),this.drawSltBox(),e.prototype._emit.call(this,N,r.cur)),this.__pager(),this.render(!0),this.getSlidePages(),t&&this._emitM(Q,this.uid,x),this.__buffer(r,"shift")),this.__slt(),this._ok(),o)},a.firstPage=function(t){void 0===t&&(t=!0);var r=this.getCurTab();if(!r)return this._err(_e),-1;var n=r.cur,i=r.slt.length,o=r.first();return-1===o?(this._err(_e),-1):((0!==n||1<i)&&((i=r.idxPage(n))&&0<i.boxCount()&&(i.cropMng.clear(),this.drawSltBox(),e.prototype._emit.call(this,N,r.cur)),this.__pager(),this.render(!0),this.getSlidePages(),t&&this._emitM(Q,this.uid,"first"),this.__buffer(r,"shift")),this.__slt(),this._ok(),o)},a.lastPage=function(t){void 0===t&&(t=!0);var r=this.getCurTab();if(!r)return this._err(_e),-1;var n=r.cur,i=r.slt.length,o=r.last();return-1===o?(this._err(_e),-1):((n!==r.total-1||1<i)&&((i=r.idxPage(n))&&0<i.boxCount()&&(i.cropMng.clear(),this.drawSltBox(),e.prototype._emit.call(this,N,r.cur)),this.__pager(),this.render(!0),this.getSlidePages(),t&&this._emitM(Q,this.uid,"last"),this.__buffer(r,"shift")),this.__slt(),this._ok(),o)},a.gotoPage=function(t,r){if(void 0===r&&(r=!0),!this._checkIndex(t))return-1;var n=this.getCurTab();if(!n)return this._err(_e),-1;var i=n.cur,o=n.slt.length,a=n.goto(t);return-1===a?(this._err(_e),-1):((i!==t||1<o)&&((o=n.idxPage(i))&&0<o.boxCount()&&(o.cropMng.clear(),this.drawSltBox(),e.prototype._emit.call(this,N,n.cur)),this.render(!0),this.getSlidePages(),r&&this._emitM(Q,this.uid,"goto",t),this.__buffer(n,"shift")),this.__pager(),this.__slt(),this._ok(),a)},a.__slt=function(t){t=t||this.getSltIndexes(),e.prototype._emit.call(this,"_imageSelectedUI",t),e.prototype._emit.call(this,"imageSelected",t)},a.updateSltIndex=function(){this.__slt(),this.__pager(),this.render()},a.__pager=function(){var t=this.getCurTab(),r={cur:-1,total:0};t&&(r={cur:t.cur,total:t.total}),e.prototype._emit.call(this,"_pagerChangedUI",r)},a.changeTag=function(t){e.prototype._emit.call(this,se,t)},a.changeDir=function(t){e.prototype._emit.call(this,se,t)},a.rmPageTag=function(e,t){return!!(t=this._tabMng.getTab(t))&&(t.remove(e),t.uid===this._tabMng.curTab?(this.showTab(t,"remove"),0===t.chs.length&&this._gpc.clearCanvas(),!0):void 0)},a.addPageTag=function(e,t){if(!(t=this._tabMng.getTab(t)))return!1;var r=this._db.getMetadata(e);if(!r)return!1;e=new Je({uid:e,naturalW:r.width,naturalH:r.height},this._db,this.cropBoxStyle),t.append(e),t.total=t.chs.length,this.showLatest&&(t.cur=t.total-1),t.uid===this._tabMng.curTab&&this.showTab(t,"add")},a.emptyTag=function(e){if(!this._tabMng.getTab(e))return!1},a.renameTag=function(e,t,r){if(!(r=this._tabMng.getTab(r)))return!1;r.name=t},a.renameFile=function(e,t,r){if(!(r=this._tabMng.getTab(r)))return!1;r.name=t},a.switchPage=function(e,t,r,n){void 0===r&&(r=!0);var i=null;return(i=n?this.getTab(n):this.getCurTab())?!(!this._checkIndex(e)||!this._checkIndex(t)||(i["switch"](e,t),this._tabMng.curTab===i.uid&&(this._showAllThb(i),this.__slt(),this.__pager(),this.getSlidePages(),this.__buffer(i,"shift")),r&&this._emitM($,this.uid,i,"switch",e,t),this._ok(),0)):(this._err(_e),!1)},a.movePage=function(e,t,r,n){void 0===r&&(r=!0);var i=null;return(i=n?this.getTab(n):this.getCurTab())?!(!this._checkIndex(e)||!this._checkIndex(t)||(i.move(e,t),this._tabMng.curTab===i.uid&&(this._showAllThb(i),this.__slt(),this.__pager(),this.getSlidePages(),this.__buffer(i,"shift")),r&&this._emitM($,this.uid,i,"move",e,t),this._ok(),0)):(this._err(_e),!1)},a.reorderPage=function(t,r,n,i){void 0===n&&(n=!0);var o=null;if(!(o=i?this.getTab(i):this.getCurTab()))return this._err(_e),!1;var a;i=o.getCurPage();o.reorder(t),this._tabMng.curTab===o.uid&&(this._showAllThb(o),this.setSltPages(r,!1),a=o.getCurPage(),i&&a&&i.uid!==a.uid&&0<i.boxCount()&&(i.cropMng.clear(),this.drawSltBox(),e.prototype._emit.call(this,N,o.cur))),n&&this._emitM($,this.uid,o,"reorder",t,r)},a.uidIdx=function(e){var t=this.getCurTab();if(!t)return this._err(_e),null;if(!this._chStr(e))return null;for(var r=t.chs.length,n=0;n<r;n++)if(t.chs[n].uid===e)return this._ok(),n;return this._err(we),null},a.idxUid=function(e){if(!this._checkIndex(e))return null;var t=this.getCurTab();return t?(this._ok(),t.chs[e].uid):(this._err(_e),null)},a.getRealTimeMetadataByIndex=function(e){if(e!==undefined&&!this._checkIndex(e))return null;var t=this.getCurTab();if(!t)return this._err(_e),null;var r=t.getCurPage();return(r=e!==undefined?t.idxPage(e):r)?(e=this._db.getMetadata(r.uid))?(t=this._db.getMid(r.uid),(e=Object.assign({},e)).width=t.tempWidth,e.height=t.tempHeight,this._ok(),e):null:(this._err(_e),null)},a.getMetadata=function(e){return this._checkIndex(e)&&(e=this.idxUid(e))?(this._ok(),(e=this._db.getMetadata(e))?Object.assign({},e):null):null},a.setMetadata=function(e,t){return!!this._checkIndex(e)&&(n(t)?!!(e=this.idxUid(e))&&(this._ok(),this._db.updateMetadata(e,t)):(this._err(fe),!1))},a.getCurIndex=function(){var e=this._tabMng.getCurTab();return e?(this._ok(),e.cur):(this._err(_e),-1)},a.getNextPageIndex=function(){var e=this._tabMng.getCurTab();if(!e)return this._err(_e),-1;if(this._ok(),0===e.total)return-1;var t=e.cur+1;return t>=e.total?-1:t},a.getPrePageIndex=function(){var e=this._tabMng.getCurTab();return e?(this._ok(),0===e.total||(e=e.cur-1)<0?-1:e):(this._err(_e),-1)},a.setCurIndex=function(t,r){if(void 0===r&&(r=!0),!this._checkIndex(t))return!1;var n=this._tabMng.getCurTab();if(!n)return this._err(_e),!1;var i=n.getCurUid(),o=this.idxUid(t);if(o!==i){if((i=n.getCurPage())&&0<i.boxCount()&&(i.cropMng.clear(),this.drawSltBox(),e.prototype._emit.call(this,N,n.cur)),n.setSlt([o]),!n.setCur(t))return!1;this.__pager(),this.render(!0),this.getSlidePages(),r&&this._emitM(Q,this.uid,"cur",t),this.__buffer(n,"shift")}return this.__slt(),this._ok(),!0},a.setSltPages=function(t,n){var i=this;if(void 0===n&&(n=!0),!r(t))return this._err(fe),!1;var o=t.length;0===o&&this._err(we);for(var a=0;a<o;a++){var s=t[a];if(!this._checkIndex(s))return!1}var u=this.getCurTab();if(!u)return this._err(_e),!1;var c=!1,l=u.getCurUid(),d=u.slt.slice(),h=(d.length!==o&&(c=!0),[]),g=(t.forEach((function(e,t){e=i.idxUid(e),h.push(e),d[t]!==e&&(c=!0)})),!1);return l&&l!==h[o-1]&&(c=!0,(l=u.getCurPage())&&0<l.boxCount()&&(l.cropMng.clear(),this.drawSltBox(),e.prototype._emit.call(this,N,u.cur)),g=!0),u.setSlt(h),this.__slt(t),this.__pager(),this.render(g),this.getSlidePages(),n&&this._emitM(Q,this.uid,"slt",t),!c&&d.length===h.length||this.__buffer(u,"shift"),this._ok(),!0},a.getCustomDataByIndex=function(e){return this._checkIndex(e)?(e=this.idxUid(e))?this.getCustomDataByUid(e):(this._err(_e),null):null},a.getCustomDataByUid=function(e){return(e=this._db.getMid(e))?(this._ok(),e.customData):(this._err(_e),null)},a.getSltIndexes=function(){var e=this;if(!(t=this.getCurTab()))return this._err(_e),null;var t=t.getSlt(),r=[];return t.forEach((function(t){t=e.uidIdx(t),r.push(t)})),this._ok(),r},a.selectAll=function(){var e=this.getCurTab();if(!e)return this._err(_e),!1;for(var t=[],r=e.chs.length,n=0;n<r;n++)t.push(n);return this.setSltPages(t)},a.zoomIn=function(){return"single"===this.tabMode&&(this._tabMng.dfConfig.fitType="none"),this._gpc.zoomIn()},a.zoomOut=function(){return"single"===this.tabMode&&(this._tabMng.dfConfig.fitType="none"),this._gpc.zoomOut()},a.zoomTo=function(e,t,r){return!s(e)||t!==undefined&&!s(t)||r!==undefined&&!s(r)?(this._err(fe),-1):("single"===this.tabMode&&(this._tabMng.dfConfig.zoom=e,this._tabMng.dfConfig.fitType="none"),this._ok(),this._gpc.zoomTo(e,!1,t,r))},a.flip=function(e){var t=this.getCurTab();if(!t)return this._err(_e),!1;if(!(t=t.getCurPage()))return this._err(_e),!1;this._clearBox();var r=this._db.getMid(t.uid);return r&&(this._releaseMin(r),e=r.edt.flip(e),this._emitM(te,"flip",{uid:t.uid,flipObj:e,page:t,interlayerData:r})),this.getSlidePages(),!0},a.reset=function(){var e=this,t=this.getCurTab();return t&&t.getCurPage()?(this._clearBox(),t.chs.forEach((function(t){e._resetByPage(t,!0)})),this.getSlidePages(),this._ok(),!0):(this._err(_e),!1)},a._resetByPage=function(e,t){var r,n=this._db.getMid(e.uid);n&&0<n.edt.all.length&&(r=this._db.getMetadata(e.uid),t&&this._releaseMin(n),r&&e.setNaturalSize(r.width,r.height),n.edt.reset(),this._emitM(te,"reset",{uid:e.uid}))},a.resetByIndex=function(e,t){var r=this.getCurTab();r?!s(e)||e<0||e>=r.chs.length?this._err(fe):(e=r.chs[e],this._resetByPage(e,t)):this._err(_e)},a.getRotateAngle=function(e){var t=this.getCurTab();return t?!s(e)||e<0||e>=t.chs.length?(this._err(fe),0):(e=t.chs[e],(t=this._db.getMid(e.uid))?(this._releaseMin(t),t.edt.getCurAngle()):0):(this._err(_e),0)},a.rotate=function(e,t){var n=this,i=this.getCurTab();if(!i)return this._err(_e),!1;if(!s(e))return this._err(fe),!1;if(t!==undefined){if(!s(t)&&!r(t))return this._err(fe),!1;if(r(t))for(var o=t.length,a=0;a<o;a++)if(!this._checkIndex(t[a]))return!1}var u,c,l=[],d=(i.getCurPage(),t===undefined?-1<(c=i.cur)&&(l=[c]):l=s(t)?[t]:t.slice(),this._clearBox(),this._gpc.rotateMode);return l.forEach((function(t){var r;u=i.chs[t],(t=n._db.getMid(u.uid))&&(n._releaseMin(t),r=t.edt.rotate(e,0,0,d),n._emitM(te,"rotate",{uid:u.uid,rotateObj:r,page:u,interlayerData:t}))})),this.getSlidePages(),this._ok(),!0},a.crop=function(e,t,r,n){var i=this.getCurTab();if(!i)return this._err(_e),!1;if(!(i=i.getCurPage()))return this._err(_e),!1;if(!(s(e)&&s(t)&&s(r)&&s(n)))return this._err(fe),!1;var o=i.naturalWidth,a=i.naturalHeight;return e<0||o<e||t<0||a<t||r<0||n<0||o<e+r||a<t+n?(this._err(me),!1):(this._clearBox(),(o=this._db.getMid(i.uid))&&(this._releaseMin(o),a=o.edt.crop(e,t,r,n),this._emitM(te,"crop",{uid:i.uid,cropObj:a,page:i})),this.getSlidePages(),this._ok(),!0)},a.erase=function(e,t,r,n,i){var o=this.getCurTab();if(!o)return this._err(_e),!1;if(!(o=o.getCurPage()))return this._err(_e),!1;if(!(s(e)&&s(t)&&s(r)&&s(n)))return this._err(fe),!1;var a=o.naturalWidth,u=o.naturalHeight;return e<0||a<e||t<0||u<t||r<0||n<0||a<e+r||u<t+n?(this._err(me),!1):(this._clearBox(),(a=this._db.getMid(o.uid))&&(this._releaseMin(a),u=a.edt.erase(e,t,r,n,i),this._emitM(te,"erase",{uid:o.uid,eraseObj:u,page:o})),this.getSlidePages(),this._ok(),!0)},a.overlay=function(e,t,r,n,i,o,a){if(!this._checkIndex(e))return!1;if(!(u=this.getCurTab()))return this._err(_e),!1;if(!(e=u.idxPage(e)))return this._err(_e),!1;if(!(s(t)&&s(r)&&s(n)&&s(i)))return this._err(fe),!1;var u=e.naturalWidth,c=e.naturalHeight;return t<0||u<t||r<0||c<r||n<0||i<0||u<t+n||c<r+i?(this._err(me),!1):((u=this._db.getMid(e.uid)).overlays.push({type:"overlay",left:t,top:r,width:n,height:i,color:o,opacity:a}),u&&(this._releaseMin(u),this._emitM(te,"overlay",{uid:e.uid})),this.getSlidePages(),this._clearBox(),this._ok(),!0)},a.changePageSize=function(e,t){if(e<=0||t<=0)return this._err(we),!1;var r=this.getCurTab();if(!r)return this._err(_e),!1;if(!(r=r.getCurPage()))return this._err(_e),!1;if(!s(e)||!s(t))return this._err(fe),!1;this._clearBox();var n=this._db.getMid(r.uid);return n&&(this._releaseMin(n),e=n.edt.changePageSize(e,t),this._emitM(te,"changePageSize",{uid:r.uid,changeSizeObj:e,page:r})),this.getSlidePages(),this._ok(),!0},a._releaseMin=function(e){o(e.minData)&&""!=e.minData&&w.revokeObjectURL(e.minData),e.minData=null,e.minType=null,e.activeMin=!1},a.setSaveType=function(e){return["image/png","image/jpeg"].indexOf(e)<0?(this._err(we),!1):(this.saveType=e,this._gpc.offScreenCanvas.saveType=e,this._ok(),!0)},a.getSaveType=function(){return this.saveType},a.setSaveQuality=function(e){return e<0||1<e?(this._err(me),!1):(this.saveQuality=e,this._ok(),!0)},a.getSaveQuality=function(){return this.saveQuality},a.setRotateMode=function(e){return s(e)||this._err(fe),-1===[0,1,2].indexOf(e)?(this._err(we),!1):(this._gpc.rotateMode=e,this._ok(),!0)},a.getRotateMode=function(){return this._gpc.rotateMode},a.setSaveBackgroundColor=function(e){return this._ok(),this._gpc.setSaveBackgroundColor(e)},a.getSaveBackgroundColor=function(){return this._gpc.saveBg},a.saveTransformation=function(){var e=this,t=this.getCurTab();if(!t)return Promise.reject(_e);for(var r=t.getCurUid(),n=t.chs,i=[],o=function(t){var o=n[t];(t=e._db.getMid(o.uid))&&0<t.edt.all.length&&(t=new Promise((function(t,n){var i=!0,a=(r===o.uid&&(i=!1),e._db.getMid(o.uid));a.img?e._saveToBlob(o.uid,a.img,o,i).then((function(e){t(e)})):a.oriData?e._getImage(o.uid,a.oriData,o,i).then((function(e){t(e)})):e._db.getDataAsync(o.uid).then((function(r){r=w.createURL(r.oriData),e._getImage(o.uid,r,o,i).then((function(e){t(e)}))}))["catch"]((function(e){}))})),i.push(t))},a=0;a<n.length;a++)o(a);return Promise.all(i)},a.__buffer=function(t,r,n,i){void 0===i&&(i=[]),r={action:r,uids:(null==(r=t.data)||null==(r=r.chs)?void 0:r.slice())||[],currentUid:t.getCurUid(),selectedUids:t.getSlt(),pageUid:n,removedPageUids:i},e.prototype._emit.call(this,j,t.getCurUid()),e.prototype._emit.call(this,"bufferChanged",r)},a._getImage=function(e,t,r,n){var i=this;return new Promise((function(o,a){var s=new Image;i.cors&&(s.crossOrigin="anonymous"),s.src=t,s.onload=function(){s.onload=null,s.onerror=null,i._saveToBlob(e,s,r,n).then((function(e){o(e)})),"object"===t.type&&w.revokeObjectURL(t),s.src=""}}))},a._saveToBlob=function(e,t,r,n){var i=this,o=this._gpc.offScreenCanvas,a=this._db.getMid(e),s=(o.render({viewerUid:"",pageUid:e,isMin:!1,img:t,page:r,midData:a}),this._db.getMetadata(e)),u=a.customData,c=a.tags,l=(r=(s.width=r.naturalWidth,s.height=r.naturalHeight,a.setTempSize(r.naturalWidth,r.naturalHeight),o.mainCanvas),o.mainWidth),d=(o=o.mainHeight,this.saveCanvas);t=d.getContext("2d",{willReadFrequently:!(t=null)});return d.width!==l&&(d.width=l),d.height!==o&&(d.height=o),t.drawImage(r,0,0),new Promise((function(t,r){d.toBlob((function(r){a.edt.reset(),i._emitM(ce,e,{oriData:r,minData:null,metadata:s,customData:u,tags:c},!0),i._db&&i._db.getDataAsync(e).then((function(e){t(r)}))}),i.saveType,i.saveQuality)}))},a.getMinPageData=function(){var e=this.getCurTab();return e&&(e=e.getCurPage())&&this._db.getMid(e.uid)?this._gpc.getMinPageData():(this._err(_e),null)},a.setCropBoxStyle=function(e){Object.assign(this.cropBoxStyle,e),this._tabMng.tabs.forEach((function(t){t.chs.forEach((function(t){t.cropMng.setCropBoxStyle(e)}))})),this.drawSltBox()},a.setKeepZoom=function(e){this._gpc.keepZoom=e},a.getFitType=function(){return this._gpc.fitType},a.setFitType=function(e){if(!this._chStr(e))return!1;if(-1===["window","width","height"].indexOf(e))return this._err(we),!1;this._gpc.fitType=e;var t=this.getCurTab();return t&&(t.fitType=e),"single"===this.tabMode&&(this._tabMng.dfConfig.fitType=e),this.render(!0),this.getSlidePages(),this._ok(),!0},a.setZoom=function(e){"single"===this.tabMode&&(this._tabMng.dfConfig.zoom=e,this._tabMng.dfConfig.fitType="none");var t=this.getCurTab();return t&&(t.zoom=e),this._gpc.setZoom(e)},a.getZoom=function(){return this._gpc.getZoom()},a.setMinZoom=function(e){return this._gpc.minZoom=e,!0},a.getMinZoom=function(){return this._gpc.minZoom},a.setMaxZoom=function(e){return this._gpc.maxZoom=e,!0},a.getMaxZoom=function(){return this._gpc.maxZoom},a.setOperationMode=function(t){var r,n=this.getCurTab();n&&(n.opMode=t,(r=n.getCurPage())&&0<r.boxCount()&&(r.cropMng.clear(),this.drawSltBox(),e.prototype._emit.call(this,N,n.cur))),this._gpc.opMode=t,"single"===this.tabMode&&(this._tabMng.dfConfig.opMode=t)},a.getOperationMode=function(){return this._gpc.opMode},a.setDisplayMode=function(t){var r,n=this.getCurTab();n&&(n.disMode=t,(r=n.getCurPage())&&0<r.boxCount()&&(r.cropMng.clear(),this.drawSltBox(),e.prototype._emit.call(this,N,n.cur))),this._tabMng.dfConfig.disMode=t,this._gpc.disMode=t,this.render(!0),this.getSlidePages()},a.setAspectRatio=function(e){this._gpc.aspectRatio=e;var t=this.getCurTab();t&&t.chs.forEach((function(t){t.cropMng.setAspectRatio(e)}))},a.getAspectRatio=function(){return this._gpc.aspectRatio},a.setKeepAspectRatio=function(e){this._gpc.keepAspectRatio=e;var t=this.getCurTab();t&&t.chs.forEach((function(t){t.cropMng.setKeepAspectRatio(e)}))},a.getKeepAspectRatio=function(){return this._gpc.keepAspectRatio},a.setPageMargin=function(e){return this._gpc.iMargin=e,!0},a.getPageMargin=function(){return this._gpc.iMargin},a.setZoomDelta=function(){},a.getZoomDelta=function(){},a.setAllowSlide=function(e){this._gpc.setAllowSlide(e)},a.getAllowSlide=function(){return this._gpc.allowSlide},a._getOutEvent=function(e){var t=null,r=-1,n=-1,i=-1,o=null==e?void 0:e.clientX,a=null==e?void 0:e.clientY,s=this.getCurTab();return(t=s?s.getCurPage():t)&&(r=this.uidIdx(t.uid)),this._gpc.checkMouseOverPage(e)&&(s=this._gpc.getMouseCoordinate(e),t=this._gpc.toPageCoordinate(s.x,s.y),n=Math.floor(t.x),i=Math.floor(t.y)),{index:r,imageX:n,imageY:i,pageX:o,pageY:a}},a._initEvent=function(){var t=this;e.prototype._on.call(this,ue,(function(e,r){t._emitM(ue,e,r)})),e.prototype._on.call(this,A,this._onSetCanvasVisibility.bind(this)),e.prototype._on.call(this,"_bindSlideComponent",(function(e){var r;null!=(r=t._gpc.slide)&&r.bind(e)})),e.prototype._on.call(this,"_unbindSlideComponent",(function(){var e;null!=(e=t._gpc.slide)&&e.unbind()})),e.prototype._on.call(this,"_bindCanvas",(function(e){t._gpc.cvsMng.bind(e)})),e.prototype._on.call(this,"_unbindCanvas",(function(e){t._gpc.cvsMng.unbind(e)})),e.prototype._on.call(this,"_setCanvasSize",(function(r){var n=r.width,i=r.height;r.isChange,t._gpc.updateDpr(),r=t._gpc.setCanvasOffsetSize(n,i);(n=t.getCurTab())&&0!==n.total||e.prototype._emit.call(t,H,{width:0,height:0,x:0,y:0}),"single"!==t._gpc.disMode||r||(t.render(!1,!1),t.drawSltBox(),t.getSlidePages())})),e.prototype._on.call(this,"_displayedImageChanged",(function(r){r.forEach((function(r){var n=t._db.getMid(r);n&&(n.minData?(n={uid:r,data:n.minData,tags:n.getTags()},e.prototype._emit.call(t,z,n)):t._emitM(Z,r))}))})),e.prototype._on.call(this,"_canvasMousedown",(function(r,n){var i=t.getCurTab();i&&i.getCurPage()&&t._gpc.onCanvasMousedown(r),n=n||t._getOutEvent(r),e.prototype._emit.call(t,W,n,r)})),e.prototype._on.call(this,"_canvasMousemove",(function(r,n){n=n||t._getOutEvent(r),e.prototype._emit.call(t,L,n,r)})),e.prototype._on.call(this,"_canvasMouseup",(function(r,n){n=n||t._getOutEvent(r),e.prototype._emit.call(t,F,n,r)})),e.prototype._on.call(this,"_canvasMouseOver",(function(r,n){n=n||t._getOutEvent(r),e.prototype._emit.call(t,"mouseover",n,r)})),e.prototype._on.call(this,"_canvasMouseOut",(function(r,n){n=n||t._getOutEvent(r),e.prototype._emit.call(t,"mouseout",n,r)})),e.prototype._on.call(this,"_canvasTouchstart",(function(r,n){var i=t.getCurTab();i&&i.getCurPage()&&t._gpc.onCanvasTouchstart(r),n=n||t._getOutEvent(r),e.prototype._emit.call(t,W,n,r)})),e.prototype._on.call(this,"_canvasTouchmove",(function(r,n){var i=t.getCurTab();i&&i.getCurPage()&&t._gpc.onCanvasTouchmove(r),n=n||t._getOutEvent(r),e.prototype._emit.call(t,L,n,r)})),e.prototype._on.call(this,"_canvasTouchend",(function(r,n){n=n||t._getOutEvent(r),e.prototype._emit.call(t,F,n,r)})),e.prototype._on.call(this,"_canvasScroll",(function(e,r){var n=t.getCurTab();n&&n.getCurPage()&&t._gpc.onCanvasScroll(e)})),e.prototype._on.call(this,"_canvasWheel",(function(r,n){var i=t.getCurTab();i&&i.getCurPage()&&(t._gpc.onCanvasWheel(r),e.prototype._emit.call(t,"wheel",r))})),e.prototype._on.call(this,"_canvasClick",(function(r,n){n=n||t._getOutEvent(r),e.prototype._emit.call(t,"click",n,r)})),e.prototype._on.call(this,"_canvasDoubleClick",(function(r,n){n=n||t._getOutEvent(r),e.prototype._emit.call(t,"dblclick",n,r)})),e.prototype._on.call(this,U,(function(r,n){n=n||t._getOutEvent(r),e.prototype._emit.call(t,"rightclick",n,r)})),e.prototype._on.call(this,U,(function(r,n){n=n||t._getOutEvent(r),e.prototype._emit.call(t,"contextmenu",n,r)})),e.prototype._on.call(this,"_canvasKeyDown",(function(r){e.prototype._emit.call(t,"keydown",r)})),e.prototype._on.call(this,"_canvasKeyUp",(function(r){e.prototype._emit.call(t,"keyup",r)})),e.prototype._on.call(this,"_canvasResize",(function(r,n){e.prototype._emit.call(t,"resize",r,n)})),e.prototype._on.call(this,"_canvasDragStart",(function(r,n){n=n||t._getOutEvent(r),e.prototype._emit.call(t,"dragstart",n,r)})),e.prototype._on.call(this,"_canvasDragMove",(function(r,n){n=n||t._getOutEvent(r),e.prototype._emit.call(t,"dragmove",n,r)})),e.prototype._on.call(this,"_canvasDragDone",(function(r){e.prototype._emit.call(t,"dragdone",r)})),e.prototype._on.call(this,"_documentMove",(function(e){var r=t.getCurTab();r&&r.getCurPage()&&t._gpc.onDocumentMousemove(e)})),e.prototype._on.call(this,"_documentUp",(function(e){var r=t.getCurTab();r&&r.getCurPage()&&t._gpc.onDocumentMouseup(e)})),e.prototype._on.call(this,"_SetSelectedIndexes",(function(e){t.setSltPages(e,!1),t._emitM(Q,t.uid,"slt",e)})),e.prototype._on.call(this,"_onReOrderThumbnail",(function(e,r){t.getCurTab()&&t.reorderPage(e,r,!0)})),e.prototype._on.call(this,"_canvasDefaultCursor",(function(e){t._gpc.defaultCursor=e=void 0===e?"default":e})),e.prototype._on.call(this,"_onRender",(function(){t.render()})),e.prototype._on.call(this,"_onRenderBoxes",(function(){t.drawSltBox()})),e.prototype._on.call(this,"_getSlidePages",(function(){t.getSlidePages()}))},a._onSetCanvasVisibility=function(e){},a.setScrBarW=function(e){this._gpc.scrBarW=e},a._onM=function(e,t){this._mPub._on(e,t)},a._emitM=function(e){for(var t,r=arguments.length,n=new Array(1<r?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this._mPub&&(t=this._mPub)._emit.apply(t,[e].concat(n))},a._offM=function(e,t){this._mPub._off(e,t)},a._err=function(e){this._emitM(B,e)},a._ok=function(){this._emitM(B,ge)},a._chStr=function(e){return!!o(e)||(this._err(fe),!1)},a._checkIndex=function(e){return s(e)?!(e<0||e>=this.getCurPageCount())||(this._err(me),!1):(this._err(fe),!1)},a.dispose=function(){var t;this.isDisposed||(e.prototype.dispose.call(this),null!=(t=this._mPub)&&t.dispose(),this._mPub=null,(this._db=null)!=(t=this._tabMng)&&t.dispose(),(this._tabMng=null)!=(t=this._gpc)&&t.dispose(),this._gpc=null,this.saveCanvas=null,this.isDisposed=!0)},i}(S),Qe=function(e){function d(t){var r=t.config,n=t.viewUi,i=t.workerBlobURL,o=t.scrollbarWidth,a=t.groupUid,s=t.defaultConfig,u=t.mPub,c=t.focus,l=t.db,d=t.offScreenCanvas;t=t.saveCanvas,(u=e.call(this,u)||this).ViewUi=null,u.group=null,u._uiConfig={canvasConfig:{}},u._config={},u._dfConfig=null,u._focus={viewerId:undefined,thumbnailId:undefined},u._multiSelectMode=!1,u.workerBlobURL=null,u.uid=m(6),u.postfix="-"+u.uid,u._iPub=new S,u._db=l,u.ViewUi=n,u.group=a,u._dfConfig=s,u._focus=c,u.workerBlobURL=i,u.vm=new qe(r,u._iPub.getPublishSubscribe(),u._oPub,u.uid,i,o,l,d,t),n=u.initConfig(r);return u.bindView(u.container),u._bindEvents(),n.length?(a=n[0],s="Failed to create the viewer because the parameter ".concat(a," is incorrect."),u._e({code:80024,message:s})):u._e(ge),u}t(d,e);var g=d.prototype;return g._bindEvents=function(){var e=this;this.on("_updateFocus",(function(t){var r=t.viewerId;t=t.thumbnailId;e._focus.viewerId=r,e._focus.thumbnailId=t})),this.on("_documentKeyDownUI",(function(t){var r=(n=e._focus).thumbnailId,n=n.viewerId;e.uid===n&&null!=(n=e.ui)&&n.documentKeyDown(t,r)})),this.on("_documentKeyUpUI",(function(t){var r=(n=e._focus).thumbnailId,n=n.viewerId;e.uid===n&&null!=(n=e.ui)&&n.documentKeyUp(t,r)})),this.on("_gotoPage",(function(t){e.gotoPage(t)}))},g.initConfig=function(e){var t,r=[],i=Ve({},e,e.uiConfig.canvasConfig,e.uiConfig);for(t in i)"uiConfig"===t||n(i[t])||this._checkInitProp(i,t)||r.push(t);return this._config=e,this._uiConfig=e.uiConfig,r},g._e=function(t){e.prototype._emit.call(this,B,t)},g._checkInitProp=function(e,t){var r=this[t],n=e[t];return this[t]=e[t],r===n||r!==this[t]},g.closeTab=function(e){if(!o(e))return this._e(fe),!1;this.vm.closeTab(e)},g.closeCurrentTab=function(){return this.vm.closeCurTab()},g.emptyTab=function(e){},g.getCurrentTabId=function(){return this.vm.getCurrentTabId()},g.getTab=function(e){return o(e)?this.vm.getTab(e):(this._e(fe),null)},g.setCurrentTab=function(e){return this.vm.setCurTab(e)},g.getCurrentTab=function(){return this.vm.getCurTab()},g.getCurrentPageUids=function(){return this.vm.getCurPageUids()},g.getCurrentIndex=function(){return this.vm.getCurIndex()},g.getNextPageIndex=function(){return this.vm.getNextPageIndex()},g.getPrePageIndex=function(){return this.vm.getPrePageIndex()},g.setCurrentIndex=function(e){return this.vm.setCurIndex(e)},g.setSelectedIndexes=function(e){return this.vm.setSltPages(e)},g.getSelectedIndexes=function(){return this.vm.getSltIndexes()},g.selectAll=function(){return this.vm.selectAll()},g.removeSync=function(e){if(!r(e=s(e)?[e]:e))return this._e(fe),!1;if(0===e.length)return this._e(we),!1;for(var t=[],n=0;n<e.length;n++){var i=this.getUidByIndex(e[n]);if(!i)return!1;t.push(i)}return this.vm.remove(t)},g.removeAllSync=function(){return this.vm.rmAll()},g.switchPage=function(e,t){return this.vm.switchPage(e,t,!0)},g.movePage=function(e,t){return this.vm.movePage(e,t,!0)},g.getViewerElement=function(){var e;return this._e(ge),(null==(e=this.ui)?void 0:e.getViewerElement())||null},g.bindView=function(e,t,r){var n=this;return void 0===t&&(t={}),void 0===r&&(r=!0),this.ViewUi?e&&h(e=o(e)?document.getElementById(e):e)?(this.unbindView(),r?f(t,this._uiConfig):this._uiConfig=t,this.ui=new this.ViewUi(e,this._uiConfig,this.postfix,this._iPub.getPublishSubscribe(),this._db,this.workerBlobURL),null!=(r=this.ui)&&r.createInnerThumbnail(),null!=(t=this.ui)&&t.setDisplayMode(this.displayMode),null!=(e=this.ui)&&e.setOperationMode(this.operationMode),this.vm.thbViews.forEach((function(e){var t;null!=(t=n.ui)&&t.createThumbnail(e.getConfig())})),(r=this.vm.getCurTab())&&(this.vm._showAllThb(r),this.vm.getSlidePages(),this.vm.updateSltIndex(),this.vm.onTabChanged(),this._e(ge)),!0):(this._e(we),!1):(this._e(xe),!1)},g.unbindView=function(){var e;return null!=(e=this.ui)&&e.unbindView(),this.ui=null,this._e(ge),!0},g.dispose=function(){var t;e.prototype.dispose.call(this),null!=(t=this._iPub)&&t.dispose(),this._iPub=null,this._db=null,this.ViewUi=null,(this.ui=null)!=(t=this.vm)&&t.dispose(),this.vm=null},g.updateUISetting=function(e){var t;return n(e)?(f(e,e=_(this._dfConfig.uiConfig)),(t=null==(t=this.ui)?void 0:t.containerBox)&&this.bindView(t,e,!1),this._e(ge),!0):(this._e(fe),!1)},g.bindContent=function(e){var t;return h(e=o(e)?document.getElementById(e):e)?null!=(t=this.ui)&&t.bindContent(e)?(this._e(ge),!0):(this._e(be),!1):(this._e(we),!1)},g.unbindContent=function(){var e;return null!=(e=this.ui)&&e.unbindContent()?(this._e(ge),!0):(this._e(be),!1)},g.fullScreen=function(){var e;return null!=(e=this.ui)&&e.fullScreen()?(this._e(ge),!0):(this.ui?this._e(Ee):this._e(be),!1)},g.cancelFullScreen=function(){var e;return this._e(ge),null==(e=this.ui)?void 0:e.cancelFullScreen()},g.fullWebPage=function(){var e;return null!=(e=this.ui)&&e.fullPage()?(this._e(ge),!0):(this._e(be),!1)},g.cancelFullWebPage=function(){var e;return null!=(e=this.ui)&&e.cancelFullPage()?(this._e(ge),!0):(this._e(be),!1)},g.setButtonClass=function(e,t){if(!o(e)||!o(t))return this._e(fe),!1;var r=this._uiConfig.buttons[e];return r?(r.setClass=t,null!=(r=this.ui)&&r.setButtonClass(e)?(this._e(ge),!0):(this._e(be),!1)):(this._e(be),!1)},g.setViewMode=function(e,t){return s(e)&&s(t)?0<e&&0<t?(this._uiConfig.canvasConfig.rows=t,this._uiConfig.canvasConfig.columns=e,this.ui?(this._e(ge),this.vm.rows=t,this.vm.columns=e,null==(r=this.ui)?void 0:r.setViewMode(e,t)):(this._e(be),!1)):(this._e(me),!1):(this._e(fe),!1);var r},g.createCustomElement=function(e,t,r){void 0===t&&(t=0),void 0===r&&(r=!1);var n=e;return h(n=o(e)?document.getElementById(e):n)?(this._e(ge),null==(e=this.ui)?void 0:e.createCustomElement(n,t,r)):(this._e(fe),!1)},g.updateVideoContainer=function(e){return this.ui?(o(e)||this._e(fe),this.ui.updateVideoContainer(e),this._e(ge),!0):(this._e(be),!1)},g.setLoadingImage=function(e){var t;this.uiConfig.canvasConfig.loadingImageUrl=e,null!=(t=this.ui)&&t.setLoadingImage(e)},g.nextPage=function(){return this.vm.nextPage()},g.prevPage=function(){return this.vm.prevPage()},g.firstPage=function(){return this.vm.firstPage()},g.lastPage=function(){return this.vm.lastPage()},g.gotoPage=function(e){return this.vm.gotoPage(e)},g.createThumbnailView=function(t){if(void 0===t&&(t={}),e.prototype._emit.call(this,O,"Invoking viewer#createThumbnailView."),!n(t))return this._e(fe),null;var r,i=[],o=this.vm.createThumbnailView(this._uiConfig.thumbnail);return null!=(r=this.ui)&&r.createThumbnail(o.getConfig()),o.init(t,i),i.length?(r="Failed to create the thumbnail viewer because the parameter ".concat(i[0]," is incorrect."),this._e({code:80024,message:r})):this._e(ge),o},g.removeThumbnailView=function(t){e.prototype._emit.call(this,O,"Invoking viewer#removeThumbnailView.");var r=t;return o(t)||(r=t.uid),this.vm.removeThumbnailView(r)?(null!=(t=this.ui)&&t.removeThumbnail(r),this._e(ge),!0):(this._e(we),!1)},g.getThumbnailViewById=function(e){return this.vm.getThumbnailViewById(e)},g.getThumbnailViewsList=function(){return this.vm.thbViews},g.getIndexByUid=function(e){return this.vm.uidIdx(e)},g.getUidByIndex=function(e){return this.vm.idxUid(e)},g.getRealTimeMetadataByIndex=function(e){return this.vm.getRealTimeMetadataByIndex(e)},g.getMetadataByIndex=function(e){return this.vm.getMetadata(e)},g.setMetadataByIndex=function(e,t){return this.vm.setMetadata(e,t)},g.getCustomDataByIndex=function(e){return this.vm.getCustomDataByIndex(e)},g.getCustomDataByUid=function(e){return this.vm.getCustomDataByUid(e)},g.zoomIn=function(){return this.vm.zoomIn()},g.zoomOut=function(){return this.vm.zoomOut()},g.zoomTo=function(e,t,r){return this.vm.zoomTo(e,t,r)},g.reset=function(){return this.vm.reset()},g.resetByIndex=function(e,t){return this.vm.resetByIndex(e,t)},g.mirror=function(){return this.vm.flip(1)},g.flip=function(){return this.vm.flip(0)},g.rotate=function(e,t){return this.vm.rotate(e,t)},g.getRotateAngle=function(e){return this.vm.getRotateAngle(e)},g.crop=function(e,t,r,n){return this.vm.crop(e,t,r,n)},g.erase=function(e,t,r,n,i){return this.vm.erase(e,t,r,n,i)},g.overlayRectangle=function(e,t,r,n,i,o,a){return this.vm.overlay(e,t,r,n,i,o,a)},g.changePageSize=function(e,t){return this.vm.changePageSize(e,t)},g.saveTransformation=function(){return this.vm.saveTransformation()},g.getMinPageData=function(){return"single"===this.displayMode?this.vm.getMinPageData():"continuous"===this.displayMode?null:void 0},g.setFreeSelectedBox=function(e){return this.vm.setFreeBox(e)},g.setSelectedBoxes=function(e,t){if(1!==this.operationMode)return this._e(De),!1;if(e===undefined)return this._e(fe),!1;if(t!==undefined&&!u(t))return this._e(fe),!1;var i=this.getCurrentTab();if(!i)return this._e(_e),!1;if((i=i.getCurPage())===undefined)return this._e(_e),!1;var o=null;if(r(e)){if(0===(o=e).length)return this._e(we),!1}else{if(!n(e))return this._e(fe),!1;o=[e]}for(var a=o.length,c=i.naturalWidth,l=i.naturalHeight,d=0;d<a;d++){var h=o[d];if(!(s(h.left)&&s(h.top)&&s(h.width)&&s(h.height)))return this._e(fe),!1;h.left<0&&(h.left=0),h.top<0&&(h.top=0),h.width<=0&&(h.width=1),h.height<=0&&(h.height=1),h.width+h.left>c&&(h.width=c-h.left),h.height+h.top>l&&(h.height=l-h.top)}return"single"===this.displayMode?this.vm.setBox(e,t):null!=(i=this.ui)&&i.setSelectedBoxes(e,t),this._e(ge),!0},g.clearSelectedBoxes=function(e){var t;return this.vm.clearBox(e),null!=(t=this.ui)&&t.clearSelectedBoxes(e),this._e(ge),!0},g.render=function(){return this.vm.render()},g.on=function(e,t){o(e)&&i(t)?(this._iPub._on(e,t),this._e(ge)):this._e(fe)},g.emit=function(e){var t;if(o(e)){for(var r=arguments.length,n=new Array(1<r?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];(t=this._iPub)._emit.apply(t,[e].concat(n)),this._e(ge)}else this._e(fe)},g.off=function(e,t){!o(e)||t!==undefined&&!i(t)?this._e(fe):(this._iPub._off(e,t),this._e(ge))},g.offById=function(e,t){o(e)&&o(t)?(this._iPub._offById(e,t),this._e(ge)):this._e(fe)},Ae(d,[{key:"zoom",get:function(){return this.vm.getZoom()},set:function(e){s(e)?e<=0?this._e(me):(this.vm.setZoom(e),this._e(ge)):this._e(fe)}},{key:"minZoom",get:function(){return this._config.minZoom},set:function(e){s(e)?e<=0?this._e(me):(this._config.minZoom=e,this.vm.setMinZoom(e),this._e(ge)):this._e(fe)}},{key:"maxZoom",get:function(){return this._config.maxZoom},set:function(e){s(e)?e<=0?this._e(me):(this._config.maxZoom=e,this.vm.setMaxZoom(e),this._e(ge)):this._e(fe)}},{key:"showViewer",get:function(){return this._uiConfig.showViewer},set:function(e){var t;u(e)?(this._uiConfig.showViewer=e,null!=(t=this.ui)&&t.setShowViewer(e),e&&this.render(),this._e(ge)):this._e(fe)}},{key:"showHeader",get:function(){return this._uiConfig.toolbars.header},set:function(e){var t;u(e)?(this._uiConfig.toolbars.header=e,null!=(t=this.ui)&&t.setShowHeader(e),this._e(ge)):this._e(fe)}},{key:"headerColor",get:function(){return this._uiConfig.headerColor},set:function(e){var t;c(e)?(this._uiConfig.headerColor=e,null!=(t=this.ui)&&t.setHeaderColor(e),this._e(ge)):this._e(Se)}},{key:"showTopMenu",get:function(){return this._uiConfig.toolbars.topMenu},set:function(e){var t;u(e)?(this._uiConfig.toolbars.topMenu=e,null!=(t=this.ui)&&t.setShowTopMenu(e),this._e(ge)):this._e(fe)}},{key:"topMenuColor",get:function(){return this._uiConfig.topMenuColor},set:function(e){var t;c(e)?(this._uiConfig.topMenuColor=e,null!=(t=this.ui)&&t.setTopMenuColor(e),this._e(ge)):this._e(Se)}},{key:"topMenuBorder",get:function(){return this._uiConfig.topMenuBorder},set:function(e){var t;l(e)?(this._uiConfig.topMenuBorder=e,null!=(t=this.ui)&&t.setTopMenuBorder(e),this._e(ge)):this._e(ke)}},{key:"showSidebar",get:function(){return this._uiConfig.showSidebar},set:function(e){var t;u(e)?(this._uiConfig.showSidebar=e,null!=(t=this.ui)&&t.setShowSidebar(e),this._e(ge)):this._e(fe)}},{key:"showAside",get:function(){return this._uiConfig.toolbars.asideMenu},set:function(e){var t;u(e)?(this._uiConfig.toolbars.asideMenu=e,null!=(t=this.ui)&&t.setShowAside(e),this._e(ge)):this._e(fe)}},{key:"showMain",get:function(){return this._uiConfig.showMain},set:function(e){var t;u(e)?(this._uiConfig.showMain=e,null!=(t=this.ui)&&t.setShowMain(e),this.emit(A,e),this._e(ge)):this._e(fe)}},{key:"showFooter",get:function(){return this._uiConfig.toolbars.bottomMenu},set:function(e){var t;u(e)?(this._uiConfig.toolbars.bottomMenu=e,null!=(t=this.ui)&&t.setShowFooter(e),this._e(ge)):this._e(fe)}},{key:"showTab",get:function(){return this._uiConfig.showTab},set:function(e){var t;u(e)?(this._uiConfig.showTab=e,null!=(t=this.ui)&&t.setShowTab(e),this._e(ge)):this._e(fe)}},{key:"footerColor",get:function(){return this._uiConfig.footerColor},set:function(e){var t;c(e)?(this._uiConfig.footerColor=e,null!=(t=this.ui)&&t.setFooterColor(e),this._e(ge)):this._e(Se)}},{key:"showVideoContainer",get:function(){return this._uiConfig.showVideoContainer},set:function(e){var t;u(e)||this._e(fe),this._uiConfig.showVideoContainer=e,null!=(t=this.ui)&&t.setShowVideoContainer(e),this._e(ge)}},{key:"fitType",get:function(){return this.vm.getFitType()},set:function(e){this.vm.setFitType(e)&&(this._config.fitType=e)}},{key:"canvasMouseShape",get:function(){return this._uiConfig.canvasConfig.canvasMouseShape},set:function(e){var t;o(e)?(this._uiConfig.canvasConfig.canvasMouseShape=e,null!=(t=this.ui)&&t.setCanvasMouseShape(e),this._e(ge)):this._e(fe)}},{key:"canvasBackground",get:function(){return this._uiConfig.canvasConfig.canvasBackground},set:function(e){var t;c(e)?(this._uiConfig.canvasConfig.canvasBackground=e,null!=(t=this.ui)&&t.setInnerTbProp("canvasBackground",e),this._e(ge)):this._e(Se)}},{key:"cropBoxStyle",get:function(){return this.vm.cropBoxStyle},set:function(e){n(e)?(e.borderColor!==undefined&&(this._uiConfig.canvasConfig.selectedBoxLineColor=e.borderColor),this._uiConfig.canvasConfig.cropBoxStyle||(this._uiConfig.canvasConfig.cropBoxStyle={}),Object.assign(this._uiConfig.canvasConfig.cropBoxStyle,e),this.vm.setCropBoxStyle(this._uiConfig.canvasConfig.cropBoxStyle),null!=(e=this.ui)&&e.setCropBoxStyle(this._uiConfig.canvasConfig.cropBoxStyle),this._e(ge)):this._e(fe)}},{key:"selectedBoxLineColor",get:function(){return this.vm.cropBoxStyle.borderColor},set:function(e){c(e)?(this._uiConfig.canvasConfig.selectedBoxLineColor=e,this._uiConfig.canvasConfig.cropBoxStyle||(this._uiConfig.canvasConfig.cropBoxStyle={}),this._uiConfig.canvasConfig.cropBoxStyle.borderColor=e,this._uiConfig.canvasConfig.cropBoxStyle.ctrlBorderColor=e,this.vm.setCropBoxStyle(this._uiConfig.canvasConfig.cropBoxStyle),null!=(e=this.ui)&&e.setCropBoxStyle(this._uiConfig.canvasConfig.cropBoxStyle),this._e(ge)):this._e(Se)}},{key:"saveBackgroundColor",get:function(){return this.vm.getSaveBackgroundColor()},set:function(e){this.vm.setSaveBackgroundColor(e)}},{key:"saveQuality",get:function(){return this.vm.getSaveQuality()},set:function(e){this.vm.setSaveQuality(e)}},{key:"saveType",get:function(){return this.vm.getSaveType()},set:function(e){this.vm.setSaveType(e)}},{key:"rotateMode",get:function(){return this.vm.getRotateMode()},set:function(e){this.vm.setRotateMode(e)}},{key:"canvasBorder",get:function(){return this._uiConfig.canvasConfig.canvasBorder},set:function(e){var t;l(e)?(this._uiConfig.canvasConfig.canvasBorder=e,null!=(t=this.ui)&&t.setCanvasBorder(e),this._e(ge)):this._e(ke)}},{key:"pageBackground",get:function(){return this._uiConfig.canvasConfig.pageBackground},set:function(e){var t;c(e)?(this._uiConfig.canvasConfig.pageBackground=e,null!=(t=this.ui)&&t.setInnerTbProp("pageBackground",e),this._e(ge)):this._e(Se)}},{key:"pageBorder",get:function(){return this._uiConfig.canvasConfig.pageBorder},set:function(e){var t;l(e)?(this._uiConfig.canvasConfig.pageBorder=e,null!=(t=this.ui)&&t.setInnerTbProp("pageBorder",e),this._e(ge)):this._e(ke)}},{key:"selectedPageBackground",get:function(){return this._uiConfig.canvasConfig.selectedPageBackground},set:function(e){var t;c(e)?(this._uiConfig.canvasConfig.selectedPageBackground=e,null!=(t=this.ui)&&t.setInnerTbProp("selectedPageBackground",e),this._e(ge)):this._e(Se)}},{key:"selectedPageBorder",get:function(){return this._uiConfig.canvasConfig.selectedPageBorder},set:function(e){var t;l(e)?(this._uiConfig.canvasConfig.selectedPageBorder=e,null!=(t=this.ui)&&t.setInnerTbProp("selectedPageBorder",e),this._e(ge)):this._e(ke)}},{key:"hoverPageBorder",get:function(){return this._uiConfig.canvasConfig.hoverPageBorder},set:function(e){var t;l(e)?(this._uiConfig.canvasConfig.hoverPageBorder=e,null!=(t=this.ui)&&t.setInnerTbProp("hoverPageBorder",e),this._e(ge)):this._e(ke)}},{key:"hoverPageBackground",get:function(){return this._uiConfig.canvasConfig.hoverPageBackground},set:function(e){var t;c(e)?(this._uiConfig.canvasConfig.hoverPageBackground=e,null!=(t=this.ui)&&t.setInnerTbProp("hoverPageBackground",e),this._e(ge)):this._e(Se)}},{key:"placeholderBackground",get:function(){return this._uiConfig.canvasConfig.placeholderBackground},set:function(e){var t;c(e)?(this._uiConfig.canvasConfig.placeholderBackground=e,null!=(t=this.ui)&&t.setInnerTbProp("placeholderBackground",e),this._e(ge)):this._e(Se)}},{key:"showPageNumber",get:function(){return this._uiConfig.canvasConfig.showPageNumber},set:function(e){var t;u(e)?(this._uiConfig.canvasConfig.showPageNumber=e,this._uiConfig.canvasConfig.pageNumber||(this._uiConfig.canvasConfig.pageNumber={}),this._uiConfig.canvasConfig.pageNumber.visibility=e?"visible":"hidden",null!=(t=this.ui)&&t.setInnerTbProp("showPageNumber",e),this._e(ge)):this._e(fe)}},{key:"pageNumber",get:function(){var e;return null==(e=this._uiConfig.canvasConfig)?void 0:e.pageNumber},set:function(e){var t;n(e)?(e.visibility!==undefined&&(this._uiConfig.canvasConfig.showPageNumber="visible"===e.visibility),this._uiConfig.canvasConfig.pageNumber||(this._uiConfig.canvasConfig.pageNumber={}),Object.assign(this._uiConfig.canvasConfig.pageNumber,e),null!=(t=this.ui)&&t.setInnerTbProp("pageNumber",e),this._e(ge)):this._e(fe)}},{key:"checkbox",get:function(){return this._uiConfig.canvasConfig.checkbox||{}},set:function(e){var t;n(e)?(this._uiConfig.canvasConfig.checkbox||(this._uiConfig.canvasConfig.checkbox={}),Object.assign(this._uiConfig.canvasConfig.checkbox,e),null!=(t=this.ui)&&t.setInnerTbProp("checkbox",e),this._e(ge)):this._e(fe)}},{key:"multiSelectMode",get:function(){return this._multiSelectMode},set:function(e){var t;u(e)?(this._multiSelectMode=e,null!=(t=this.ui)&&t.setInnerTbProp("multiSelectMode",e),this._e(ge)):this._e(fe)}},{key:"allowPageDragging",get:function(){return this._uiConfig.canvasConfig.allowPageDragging},set:function(e){var t;u(e)?(this._uiConfig.canvasConfig.allowPageDragging=e,null!=(t=this.ui)&&t.setInnerTbProp("allowPageDragging",e),this._e(ge)):this._e(fe)}},{key:"allowKeyboardControl",get:function(){return this._uiConfig.canvasConfig.allowKeyboardControl},set:function(e){var t;u(e)?(this._uiConfig.canvasConfig.allowKeyboardControl=e,null!=(t=this.ui)&&t.setInnerTbProp("allowKeyboardControl",e),this._e(ge)):this._e(fe)}},{key:"pageMargin",get:function(){return this._uiConfig.canvasConfig.pageMargin},set:function(e){var t;a(e)?(this._uiConfig.canvasConfig.pageMargin=e,this.vm.setPageMargin(e),null!=(t=this.ui)&&t.setInnerTbProp("pageMargin",e),this._e(ge)):this._e(Me)}},{key:"scrollDirection",get:function(){return this._uiConfig.canvasConfig.scrollDirection},set:function(e){var t;o(e)?(this._uiConfig.canvasConfig.scrollDirection=e,null!=(t=this.ui)&&t.setInnerTbProp("scrollDirection",e),this._e(ge)):this._e(fe)}},{key:"autoChangeIndex",get:function(){return this._uiConfig.canvasConfig.autoChangeIndex},set:function(e){var t;u(e)?(this.uiConfig.canvasConfig.autoChangeIndex=e,null!=(t=this.ui)&&t.setInnerTbProp("autoChangeIndex",e)):this._e(fe)}},{key:"outerBorder",get:function(){return this._uiConfig.outerBorder},set:function(e){var t;l(e)?(this._uiConfig.outerBorder=e,null!=(t=this.ui)&&t.setOuterBorder(e),this._e(ge)):this._e(ke)}},{key:"sidebarWidth",get:function(){return this._uiConfig.sidebarWidth},set:function(e){var t;a(e)?(this._uiConfig.sidebarWidth=e,null!=(t=this.ui)&&t.setSidebarWidth(e),this._e(ge)):this._e(Me)}},{key:"width",get:function(){var e;return(null==(e=this.ui)?void 0:e.getViewerWidth())||this._uiConfig.width},set:function(e){var t;a(e)?(this._uiConfig.width=e,null!=(t=this.ui)&&t.setViewerWidth(e),this._e(ge)):this._e(Me)}},{key:"height",get:function(){var e;return(null==(e=this.ui)?void 0:e.getViewerHeight())||this._uiConfig.height},set:function(e){var t;a(e)?(this._uiConfig.height=e,null!=(t=this.ui)&&t.setViewerHeight(e),this._e(ge)):this._e(Me)}},{key:"uiConfig",get:function(){return this._uiConfig}},{key:"operationMode",get:function(){return this._config.operationMode},set:function(e){var t;s(e)?-1===[0,1,2].indexOf(e)?this._e(we):(this._config.operationMode=e,this.vm.setOperationMode(e),null!=(t=this.ui)&&t.setOperationMode(e),this._e(ge)):this._e(fe)}},{key:"allowSlide",get:function(){return this.vm.getAllowSlide()},set:function(e){u(e)?(this.vm.setAllowSlide(e),this._e(ge)):this._e(fe)}},{key:"tabMode",get:function(){return this._config.tabMode},set:function(e){"single"===e||"multiple"===e?(this._config.tabMode=e,this.vm.setTabMode(e),this._e(ge)):this._e(we)}},{key:"selectionBoxAspectRatio",get:function(){return this.vm.getAspectRatio()},set:function(e){var t;s(e)?(this.vm.setAspectRatio(e),null!=(t=this.ui)&&t.setAspectRatio(e),this._e(ge)):this._e(fe)}},{key:"keepAspectRatio",get:function(){return this.vm.getKeepAspectRatio()},set:function(e){u(e)?this.vm.setKeepAspectRatio(e):this._e(fe)}},{key:"displayMode",get:function(){return this._config.displayMode},set:function(e){var t;o(e)?-1!==["single","continuous"].indexOf(String(e))?(this._config.displayMode=e,null!=(t=this.ui)&&t.setDisplayMode(e),this.vm.setDisplayMode(e),this._e(ge)):this._e(me):this._e(fe)}},{key:"zooming",get:function(){return this._config.zooming},set:function(e){this._config.zooming=e,this._e(ge)}},{key:"scrollX",get:function(){return this._config.scrollX},set:function(e){this._config.scrollX=e,this._e(ge)}},{key:"scrollY",get:function(){return this._config.scrollY},set:function(e){this._config.scrollY=e,this._e(ge)}},{key:"keepZoom",get:function(){return this._config.keepZoom},set:function(e){u(e)?(this._config.keepZoom=e,this.vm.setKeepZoom(e),this._e(ge)):this._e(fe)}},{key:"ifAllowSlide",get:function(){return this._config.ifAllowSlide},set:function(e){u(e)?(this._config.ifAllowSlide=e,this._e(ge)):this._e(fe)}},{key:"zoomInDelta",get:function(){return this._config.zoomInDelta},set:function(e){s(e)?e<=0?this._e(me):(this._config.zoomInDelta=e,this._e(ge)):this._e(fe)}},{key:"zoomOutDelta",get:function(){return this._config.zoomOutDelta},set:function(e){s(e)?e<=0?this._e(me):(this._config.zoomOutDelta=e,this._e(ge)):this._e(fe)}},{key:"zoomDelta",get:function(){return this._config.zoomDelta},set:function(e){s(e)?e<=0?this._e(me):(this._config.zoomDelta=e,this._e(ge)):this._e(fe)}},{key:"currentPageCount",get:function(){return this.vm.getCurPageCount()}},{key:"showLatestPage",get:function(){return this._config.showLatestPage},set:function(e){u(e)?(this._config.showLatestPage=e,this.vm.showLatest=e,this._e(ge)):this._e(fe)}},{key:"container",get:function(){return this._config.container},set:function(e){""===e||h(e)||h(e)?this._config.container=e:this._e(fe)}},{key:"optimizeImage",get:function(){return this.vm.useHermite},set:function(e){this.vm.setUseHermite(e)}}]),d}(S),$e=function(e){function r(t){var r=e.call(this,t)||this;return r.vws=[],r.name=t.name,r.type=t.type,r.chs=t.chs||[],r}t(r,e);var n=r.prototype;return n.getCounts=function(){return this.chs.length},n.addViewer=function(e){return-1==this.vws.indexOf(e)&&(this.vws.push(e),!0)},n.removeViewer=function(e){return-1!=(e=this.vws.indexOf(e))&&(this.vws.splice(e,1),!0)},r}(k),et=function(){function e(e){this.tabs=[],this.mode="single",this.tabs=[]}var t=e.prototype;return t.addTab=function(e,t){var r=this.checkTab(e.uid),n=null;return-1!==r?n=this.tabs[r]:(n=new $e(e),this.tabs.push(n)),t&&n.addViewer(t),n},t.getTab=function(e){return-1===(e=this.checkTab(e))?null:this.tabs[e]},t.removeTab=function(e){-1<(e=this.checkTab(e))&&this.tabs.splice(e,1)},t.checkTab=function(e){for(var t=this.tabs.length,r=0;r<t;r++)if(this.tabs[r].uid===e)return r;return-1},t.setMode=function(e){return("single"===e||"multiple"===e)&&(this.mode=e,!0)},t.removePage=function(e,t){return-1!=(e=this.checkTab(e))&&this.tabs[e].remove(t)},t.dispose=function(){},e}(),tt=function(){function e(e,t,r){this.baseSize=0,this.mainWidth=0,this.mainHeight=0,this.minorWidth=0,this.minorHeight=0,this._curOpType=null,this.saveColor=null,this.saveType="image/jpg",this.scale=1,this.isKeepCanvasSize=!1,this.isDisposed=!1,this.uid=e,this.baseSize=t=t||3840;e=document.createElement("canvas");var n=document.createElement("canvas");e.id="dvs_used_as_offscreenCanvas_main_".concat(this.uid),n.id="dvs_used_as_offscreenCanvas_minor_".concat(this.uid),this.mainCanvas=e,this.minorCanvas=n,this.mainCtx=e.getContext("2d",{willReadFrequently:!0}),this.minorCtx=n.getContext("2d",{willReadFrequently:!0}),this.mainCtx.imageSmoothingEnabled=!1,this.minorCtx.imageSmoothingEnabled=!1,this._setCanvasSize(t,t),r!==undefined?this.isKeepCanvasSize=r:d()&&(this.isKeepCanvasSize=!0)}var t=e.prototype;return t.dispose=function(){this.isDisposed||(this._setCanvasSize(1,1),this._clearRect(this.mainCtx),this._clearRect(this.minorCtx),this.mainCanvas=null,this.minorCanvas=null,this.mainCtx=null,this.minorCtx=null,this.isDisposed=!0)},t.reset=function(){this.scale=1,this.pageUid=null,this._curOpType=null},t.render=function(e){var t=this,r=e.viewerUid,n=e.pageUid,i=e.isMin,o=e.img,a=e.page,s=e.midData;n!==this.pageUid&&(this.ownerViewer=r,this.isMin=i,this.pageUid=n,e=1,r=o.naturalWidth,i=o.naturalHeight,n=Math.max(r,i),this.isKeepCanvasSize?this.mainCanvas.width<n&&(e=this.baseSize/n,this.scale=e):this.mainCanvas.width===r&&this.mainCanvas.height===i||this._setCanvasSize(r,i),r*=e,i*=e,r=Math.floor(r),i=Math.floor(i),this._setMainSize(r,i),this._setMinorSize(r,i),this._clearRect(this.mainCtx),this._clearRect(this.minorCtx),this.mainCtx.drawImage(o,0,0,r,i),this.minorCtx.drawImage(o,0,0,r,i),n=s.edt.all.slice(),s.edt.reset(),n.forEach((function(e){"rotate"===e.type?(s.edt.rotate(e.angle,0,0,e.mode),t.rotate(e,a,s)):"flip"===e.type?(s.edt.flip(e.direction),t.flip(e,a,s)):"crop"===e.type?(s.edt.crop(e.left,e.top,e.width,e.height),t.crop(e,a)):"erase"===e.type?(s.edt.erase(e.left,e.top,e.width,e.height,e.color),t.erase(e,a)):"changeSize"===e.type&&(s.edt.changePageSize(e.width,e.height),t.changePageSize(e,a))})))},t.rotate=function(e,t,r){var n=this.mainCanvas,i=this.minorCanvas,o=this.mainCtx,a=this.minorCtx,s=null,u=this.mainWidth,c=this.mainHeight,l=1,d=0,h=!1,g=(0===e.mode&&(u=(s=y(0,0,this.minorWidth,this.minorHeight,e.calcAngle)).width,c=s.height,d=Math.pow(Math.pow(u,2)+Math.pow(c,2),.5),h=!this.isKeepCanvasSize&&(this.mainCanvas.width!==u||this.mainCanvas.height!==c),this.isKeepCanvasSize&&(g=Math.max(u,c),this.mainCanvas.width<g&&(l=this.baseSize/g)),u*=l,c*=l),null!==this._curOpType&&this._curOpType!==e.mode&&(s&&h&&this._setMinorCanvasSize(d,d),this._setMinorSize(this.mainWidth,this.mainHeight),this._clearRect(a),a.save(),a.beginPath(),a.rect(0,0,this.minorWidth,this.minorHeight),a.clip(),a.closePath(),a.drawImage(n,0,0),a.restore()),this._curOpType=e.mode,s&&(h&&this._setMainCanvasSize(d,d),this._setMainSize(u,c)),this._clearRect(o),o.save(),o.beginPath(),o.rect(0,0,this.mainWidth,this.mainHeight),o.clip(),o.closePath(),this._fillRect(o,this.mainWidth,this.mainHeight),o.translate(this.mainWidth/2,this.mainHeight/2),r.edt.setTransform(o),this.minorWidth*l/this.minorWidth);n=i.width*g,a=i.height*g;o.drawImage(i,Math.floor(-this.minorWidth*l/2),Math.floor(-this.minorHeight*l/2),Math.floor(n),Math.floor(a)),o.restore()},t.flip=function(e,t,r){var n=this.minorCanvas,i=this.mainCtx;this._clearRect(i),i.save(),i.beginPath(),i.rect(0,0,this.mainWidth,this.mainHeight),i.clip(),i.closePath(),this._fillRect(i,this.mainWidth,this.mainHeight),i.translate(this.mainWidth/2,this.mainHeight/2),r.edt.setTransform(i),i.drawImage(n,Math.floor(-this.minorWidth/2),Math.floor(-this.minorHeight/2)),i.restore()},t.crop=function(e,t){var r=this.mainCanvas,n=this.minorCanvas,i=this.mainCtx,o=this.minorCtx,a=this.scale,s=e.left,u=e.top,c=e.width;e=e.height;s*=a,u*=a,this._setMinorSize(c*=a,e*=a),this._clearRect(o),o.save(),o.beginPath(),o.rect(0,0,c,e),o.clip(),o.closePath(),o.translate(-s,-u),o.drawImage(r,0,0),o.restore(),this._setMainSize(c,e),this._clearRect(i),i.save(),i.beginPath(),i.rect(0,0,this.mainWidth,this.mainHeight),i.clip(),i.closePath(),i.drawImage(n,0,0),i.restore()},t.erase=function(e,t){var r=this.mainCanvas,n=this.mainCtx,i=this.minorCtx,o=this.scale,a=e.left,s=e.top,u=e.width,c=e.height;a*=o,s*=o,u*=o,c*=o,o=e.color||"#ffffff",this._clearRect(i),i.save(),i.beginPath(),i.rect(0,0,this.minorWidth,this.minorHeight),i.clip(),i.closePath(),i.drawImage(r,0,0),i.fillStyle=o,i.fillRect(a,s,u,c),i.restore(),n.save(),n.fillStyle=o,n.fillRect(a,s,u,c),n.restore()},t.changePageSize=function(e,t){var r=this.mainCanvas,n=this.minorCanvas,i=this.mainCtx,o=this.minorCtx,a=e.width,s=(e=e.height,this.scale),u=Math.pow(Math.pow(a,2)+Math.pow(e,2),.5),c=(this.isKeepCanvasSize?(c=Math.max(a,e),this.mainCanvas.width<c&&(s=this.baseSize/c,this.scale=s)):this.mainCanvas.width<u&&this._setMinorCanvasSize(u,u),this._setMinorSize(a*=s,e*=s),this._clearRect(o),o.save(),o.beginPath(),o.rect(0,0,this.minorWidth,this.minorHeight),o.clip(),o.closePath(),a/this.mainWidth);s=e/this.mainHeight,c=r.width*c,s=r.height*s;o.drawImage(r,0,0,Math.floor(c),Math.floor(s)),o.restore(),this.isKeepCanvasSize||this.mainCanvas.width<u&&this._setMainCanvasSize(u,u),this._setMainSize(a,e),this._clearRect(i),i.save(),i.beginPath(),i.rect(0,0,this.mainWidth,this.mainHeight),i.clip(),i.closePath(),i.drawImage(n,0,0),i.restore()},t._clearRect=function(e){e.clearRect(0,0,e.canvas.width,e.canvas.height)},t._fillRect=function(e,t,r){return e.save(),e.fillStyle=this.saveColor,e.fillRect(0,0,t,r),e.restore(),!0},t._setMainSize=function(e,t){this.mainWidth=e,this.mainHeight=t},t._setMinorSize=function(e,t){this.minorWidth=e,this.minorHeight=t},t._setCanvasSize=function(e,t){this.mainCanvas.width=e,this.mainCanvas.height=t,this.minorCanvas.width=e,this.minorCanvas.height=t},t._setMainCanvasSize=function(e,t){this.mainCanvas.width=e,this.mainCanvas.height=t},t._setMinorCanvasSize=function(e,t){this.minorCanvas.width=e,this.minorCanvas.height=t},e}(),rt=function(e){function r(t,r,n,i){return(r=e.call(this,r)||this)._defaultConfig={container:"",ifAllowSlide:!0,useWebWorker:!0,zoomInDelta:1.2,zoomOutDelta:1.2,zoomDelta:.05,fitType:"window",tabMode:"single",displayMode:"single",operationMode:"0",zooming:!0,scrollX:!0,scrollY:!0,minZoom:.01,maxZoom:8,keepZoom:!0,showLatestPage:!0,pageMargin:10,uiConfig:{toolbars:{header:!0,topMenu:!0,asideMenu:!1,bottomMenu:!0},groups:{topMenuRight:{visibility:!0,location:"topMenu",sequence:1}},buttons:{},buttonResize:{ifResize:!1,minSize:24,maxSize:26},tipsConfig:{},thumbnail:{size:180,mouseShape:"pointer",scrollDirection:"vertical",sequence:-1,location:"horizontal",showThumbnail:!0,showPageNumber:!1,showRemoveBtn:!1,fullThumbnail:!1,allowDragDrop:!0,allowResizing:!1,allowKeyboardControl:!1,rows:4,columns:1,background:"rgba(67,66,70,1)",border:"1px solid rgba(27,27,29,1)",pageBackground:"rgba(0,0,0,0)",pageBorder:"1px solid rgba(128,128,128,1)",selectedPageBackground:"rgba(127,133,251,1)",selectedPageBorder:"1px solid rgba(255,0,0,1)",hoverPageBackground:"rgba(196,250,248,1)",hoverPageBorder:"1px solid rgba(255,255,0,1)",placeholderBackground:"rgba(255,192,203,1)",pageMargin:10,checkbox:{visibility:"hidden",width:24,height:24,background:"#fff",borderWidth:2,borderRadius:0,borderColor:"#000",opacity:.5,left:"",top:"",right:"",bottom:"",checkMarkLineWidth:2,checkMarkColor:"#000"},pageNumber:{visibility:"hidden",width:24,height:24,background:"#fff",borderWidth:2,borderRadius:0,borderColor:"#000",opacity:.5,color:"#000",fontSize:12,fontFamily:"sans-serif",left:"",top:"",right:0,bottom:0}},canvasConfig:{canvasMouseShape:"default",canvasBackground:"#434246",canvasBorder:"1px solid #1b1b1d",pageBorder:"1px solid rgba(128,128,128,1)",pageMargin:"10",pageBackground:"rgba(0,0,0,0)",selectedPageBorder:"1px solid rgba(255,0,0,1)",selectedPageBackground:"rgba(127,133,251,1)",hoverPageBorder:"1px solid rgba(255,0,0,1)",hoverPageBackground:"rgb(196,250,248)",placeholderBackground:"pink",allowPageDragging:!0,allowKeyboardControl:!1,showPageNumber:!1,selectedBoxLineColor:"rgba(0,0,0,1)",autoChangeIndex:!1,scrollDirection:"vertical",checkbox:{visibility:"hidden",width:24,height:24,background:"#fff",borderWidth:2,borderRadius:0,borderColor:"#000",opacity:.5,left:0,top:0},pageNumber:{visibility:"hidden",width:24,height:24,background:"#fff",borderWidth:1,borderRadius:0,borderColor:"#000",opacity:.5,color:"#000",fontSize:12,fontFamily:"sans-serif",textAlign:"center",textBaseline:"middle",left:"",top:"",right:0,bottom:0},cropBoxStyle:{borderWidth:1,borderColor:"rgba(0,0,0,1)",invalidBorderColor:"#f00",dashLine:[4,2],background:"",ctrlBorderWidth:1,ctrlBorderRadius:0,ctrlBorderColor:"rgba(0,0,0,1)",invalidCtrlBorderColor:"#f00",ctrlBackground:"",ctrlWidth:8,ctrlHeight:8,enableConcaveBorderColor:!1}},tree:{visibility:!0,iconClass:"ds-dvs-ui-tree",selectedColor:"#0000ff"},tag:{visibility:!0,iconClass:"ds-dvs-ui-tags",selectedColor:"#0000ff",displayMode:""},headerColor:"#2a292b",topMenuColor:"#3a393b",topMenuBorder:"1px solid #1b1b1d",showSidebar:!1,showMain:!0,footerColor:"#434246",showViewer:!0,showVideoContainer:!1,outerBorder:"1px solid #1b1b1d",sidebarWidth:"180",width:"100%",height:"100%"}},r._ViewUi=null,r._scrBarW=0,r._q=[],r.loader=[!1,!1,!1,!1],r._cors=!0,r._outW=4096,r._outH=4096,r._minW=800,r._minH=800,r._group={},r._resizeCb=null,r._focus={viewerId:undefined,thumbnailId:undefined},r.isCanvasInit=!1,r.width=0,r.height=0,r.tempWidth=0,r.tempHeight=0,r.offScreenCanvas=null,r.isDisposed=!1,r.autoCreateOffCanvas=!0,r.vws=[],r._db=n,r._tabMng=new et,r._mPub=new S,r.options=t,r.dvsUid=i,!1===t.autoCreateOffScreenCanvas&&(r.autoCreateOffCanvas=!1),r.autoCreateOffCanvas&&(r.offScreenCanvas=new tt(i,t.baseCanvasSize,t.isKeepCanvasSize)),(n=document.createElement("canvas")).id="dvs_generate_min_cvs_".concat(i),r.canvas=n,(n=document.createElement("canvas")).id="dvs_saveTransformation_cvs_".concat(i),r.saveCanvas=n,r._initTopEvent(),r._initViewerEvent(),g(t,r._defaultConfig),r.initWorkerUlr(),r._getScrBarW(),r.createViewer(),r}t(r,e);var a=r.prototype;return a._initTopEvent=function(){var e=this;this.on(J,(function(t,r,n,i){e._load(t,r,n,i)})),this.on(K,(function(t,r,n){e._open(t,r,n)})),this.on(ae,(function(t,r,n,i){var o=e._tabMng.getTab(i);o&&o.vws.forEach((function(n){(n=e.uidViewer(n))&&n.vm.renameTag(t,r,i)}))})),this.on(oe,(function(t,r,n){var i=e._tabMng.getTab(n);i&&i.vws.forEach((function(t){(t=e.uidViewer(t))&&t.vm.emptyTag(n)}))})),this.on(ie,(function(t,r,n){var i=e._tabMng.getTab(n);i&&i.vws.forEach((function(r){(r=e.uidViewer(r))&&r.vm.addPageTag(t,n)}))})),this.on(ne,(function(t,r,n){var i=e._tabMng.getTab(n);i&&i.vws.forEach((function(r){(r=e.uidViewer(r))&&r.vm.rmPageTag(t,n)}))})),this.on(he,(function(t,r,n,i){var o=e._tabMng.getTab(i);o&&o.vws.forEach((function(n){(n=e.uidViewer(n))&&n.vm.renameFile(t,r,i)}))})),this.on(de,(function(t){e.emit(ee,{},t.chs.slice());var r=e._tabMng.getTab(t.uid);r&&(r.vws.forEach((function(r){(r=e.uidViewer(r))&&r.closeTab(t.uid)})),e._tabMng.removeTab(t.uid))})),this.on(se,(function(t){e.vws.forEach((function(e){e.vm.changeTag(t)}))})),this.on(R,(function(t){e.vws.forEach((function(e){e.vm.changeDir(t)}))})),this.on(Y,(function(t,r){var n=e._db.getMid(t);n&&(t===e.offScreenCanvas.pageUid&&e.offScreenCanvas.reset(),e._tabMng.tabs.forEach((function(n){-1!==n.chs.indexOf(t)&&n.vws.forEach((function(i){(i=e.uidViewer(i))&&(i.vm.updateSync(t,n.uid,r),i.vm.showThbItem(t))}))})),n.minData||e._loadMinPic(t))}))},a._initViewerEvent=function(){var e=this;this.onM("dvsRenderMainPage",(function(t,r){t.forEach((function(t){(t=e.uidViewer(t))&&t.vm.renderMainPage(r)}))})),this.onM(ue,(function(t,r){e.emit(ue,t,r)})),this.onM(ce,(function(t,r,n){e.emit(ce,t,r,n)})),this.onM(B,(function(t){e._err(t)})),this.onM(Z,(function(t){e._loadMinPic(t)})),this.onM(Q,(function(t,r,n){e._getGroup(t).forEach((function(e){if(e.uid!==t)switch(r){case"first":e.vm.firstPage(!1);break;case"last":e.vm.lastPage(!1);break;case"next":e.vm.nextPage(!1);break;case"prev":e.vm.prevPage(!1);break;case"goto":e.vm.gotoPage(n,!1);break;case"cur":e.vm.setCurIndex(n,!1);break;case"slt":e.vm.setSltPages(n,!1)}}))})),this.onM($,(function(t,r,n,i,o){var a,s=e._tabMng.getTab(r.uid);s&&(a=s.uid,s.vws.forEach((function(r){if(t!==r){var s=e.uidViewer(r);if(s)switch(n){case"switch":s.vm.switchPage(i,o,!1,a);break;case"move":s.vm.movePage(i,o,!1,a);break;case"reorder":s.vm.reorderPage(i,o,!1,a)}}})),s[n](i,o),e.emit($,r,n,i,o))})),this.onM(ee,(function(t,r,n){e.emit(ee,r,n),n.forEach((function(t){e._tabMng.tabs.forEach((function(e){e.remove(t)}))})),e.vws.forEach((function(e){e.uid!==t&&e.vm.remove(n,!1,r.uid)}))})),this.onM(te,(function(t,r){var n=r.uid,i=e._db.getMid(n);if(i){if(e._loadMinPic(n),i.vws.length){var o=e.offScreenCanvas;if(o.pageUid===n)switch(t){case"rotate":o.rotate(r.rotateObj,r.page,r.interlayerData);break;case"flip":o.flip(r.flipObj,r.page,r.interlayerData);break;case"crop":o.crop(r.cropObj,r.page);break;case"erase":o.erase(r.eraseObj,r.page);break;case"changePageSize":o.changePageSize(r.changeSizeObj,r.page);break;case"reset":o.reset()}}i.vws.forEach((function(t){(t=e.uidViewer(t))&&t.vm.uidIdx(n)===t.vm.getCurIndex()&&t.vm.render()}))}})),this.onM(q,(function(t,r){(t=e._tabMng.getTab(t))&&t.removeViewer(r)}))},a._getGroup=function(e){var t=this,r=[];return(e=this.uidViewer(e))&&this._group[e.group].forEach((function(e){(e=t.uidViewer(e))&&r.push(e)})),r},a._loadMinPic=function(e){for(var t=this._q,r=-1,n=0;n<this.loader.length;n++)if(!this.loader[n]){r=n;break}-1===r?-1===t.indexOf(e)&&t.push(e):(this.loader[r]=!0,this.runLoader(e,r))},a._convertData=function(e){return new Promise((function(t,r){var i;n(e)?t(e):((i=new XMLHttpRequest).onload=function(){var e=w.createURL(i.response);t(e)},i.open("GET",e,!0),i.responseType="blob",i.send())}))},a.runLoader=function(e,t){var r,n,i,a,s,u=this,c=this._db.getMid(e);c&&c.minData&&c.vws.forEach((function(t){var r=-1;u.vws.some((function(e,n){if(e.uid===t)return r=n,!0})),-1!==r&&u.vws[r].vm.showThbItem(e)})),!c||c.activeMin||c.minData?(r=this._q.shift())?this.runLoader(r,t):this.loader[t]=!1:(n=!1,i=m(11),c.activeMin=!0,c.minTask=i,a=new Promise((function(t,r){c.oriData?(n=!0,t(c.oriData)):u._db.getDataAsync(e).then((function(e){o(e.oriData)&&(n=!0),10===document.documentMode?u._convertData(e.oriData).then((function(e){t(e)})):(e=w.createURL(e.oriData),t(e))}))["catch"]((function(e){r(e)}))})),s=new Promise((function(t,r){a.then((function(n){var o=new Image;u._cors&&(o.crossOrigin="anonymous"),o.src=n,o.onload=function(){var a=u._db.getMid(e);if(!a||a.minTask!==i)return(null==a?void 0:a.oriData)!==n&&w.revokeObjectURL(n),r("task cancel or page does not exist");o.onload=null,o.onerror=null,t(o)},o.onerror=function(e){return o.onload=null,o.onerror=null,r(e)}}))["catch"]((function(e){r(e)}))})),new Promise((function(t,r){s.then((function(o){var a=u._db.getMid(e);if(!a||a.minTask!==i)return(null==a?void 0:a.oriData)!==o.src&&w.revokeObjectURL(o.src),r("task cancel or page does not exist");u.offScreenCanvas||r("OffScreenCanvas is disposed");var s=u.offScreenCanvas;if(s.isDisposed)return r("The offScreenCanvas is disposed.");s.render({viewerUid:"",pageUid:e,isMin:!0,img:o,page:null,midData:a});var c=o.naturalWidth/o.naturalHeight,l=1,d=(c=(1<=c&&s.mainWidth>u._minW?l=u._minW/s.mainWidth:c<1&&s.mainHeight>u._minH&&(l=u._minH/s.mainHeight),s.mainWidth*l),s.mainHeight*l),h=u.canvas,g=h.getContext("2d",{willReadFrequently:!0});h.width!==c&&(h.width=c),h.height!==d&&(h.height=d),d=c/s.mainWidth,c=s.mainCanvas.width*d,d=s.mainCanvas.height*d;g.drawImage(s.mainCanvas,0,0,Math.floor(c),Math.floor(d)),(a.overlays||[]).forEach((function(e){g.save(),g.globalAlpha=e.opacity,g.fillStyle=e.color,g.fillRect(e.left*l,e.top*l,e.width*l,e.height*l),g.restore()})),!n&&o.src&&(w.revokeObjectURL(o.src),o.src=""),h.toBlob((function(n){var o=u._db.getMid(e);o&&o.minTask===i||r("task cancel or page does not exist"),t(n)}),"image/png")}))["catch"]((function(e){r(e)}))})).then((function(r){r=w.createURLWithType(r);var n=u._db.getMid(e);n&&n.minTask===i&&(n.activeMin=!1,o(null==n?void 0:n.minData)&&""!=(null==n?void 0:n.minData)&&w.revokeObjectURL(n.minData),n.minData=r.data,n.vws.forEach((function(t){var r=-1;u.vws.some((function(e,n){if(e.uid===t)return r=n,!0})),-1!==r&&u.vws[r].vm.showThbItem(e)}))),r=u._q.shift();r?u.runLoader(r,t):u.loader[t]=!1}))["catch"]((function(r){var n;(n=((n=u._db.getMid(e))&&n.minTask===i&&(n.activeMin=!1),u._q.shift()))?u.runLoader(n,t):u.loader[t]=!1})))},a._open=function(e,t,r){var n=this,i=e.uid,o=e.chs.slice(),a=this._tabMng.getTab(i);(a=a||this._tabMng.addTab({uid:i,name:e.name,type:t,chs:[]},r)).chs=o,this.vws,i=null;if(r){if(0===(i=this._getGroup(r).map((function(e){return e.uid}))).length)return void this._err(we)}else i=a.vws;i.map((function(e){return n.uidViewer(e)})).forEach((function(e){var t;e&&(a.addViewer(e.uid),a.chs.forEach((function(t){(t=n._db.getMid(t))&&t.addViewer(e.uid)})),(t=null==(t=e.vm)?void 0:t.tabHandler(a,null,!0))&&e.vm.showTab(t,"filter"))}))},a._load=function(e,t,r,n){var i=this,o=e.uid,a=e.chs.slice(),s=(s=this._tabMng.getTab(o))||this._tabMng.addTab({uid:o,name:e.name,type:t,chs:[]});this.vws.forEach((function(e){s.addViewer(e.uid)})),s.chs=a,s.vws.forEach((function(e){var t,n=i.uidViewer(e);n&&(s.chs.forEach((function(e){(e=i._db.getMid(e))&&e.addViewer(n.uid)})),e=null,"all"!==s.type.toLowerCase()&&(e=r),(e=null==(t=n.vm)?void 0:t.tabHandler(s,e,!1))&&n.vm.showTab(e))}))},a.bindViewUi=function(e){var t=this;if(!i(e))return this.emit(B,fe),!1;this.autoCreateOffCanvas||(this.offScreenCanvas=new tt(this.dvsUid,this.options.baseCanvasSize,this.options.isKeepCanvasSize)),this._ViewUi=e,this.vws.forEach((function(r){r.ViewUi=e,t.autoCreateOffCanvas||r.vm._gpc.setOffScreenCanvas(t.offScreenCanvas)}))},a.createViewer=function(e,t){var r=this,n=(void 0===e&&(e={}),null),i=[],o=null;if(t){if(!(o=this.uidViewer(t)))return this._err(we),null;n=o.group,i=this._group[n]}else n=m(11),this._group[n]=i;g(e,t=_(this._defaultConfig)),e={config:t,viewUi:this._ViewUi,workerBlobURL:this._hermiteWorkerUrl,scrollbarWidth:this._scrBarW,groupUid:n,defaultConfig:this._defaultConfig,mPub:this._mPub.getPublishSubscribe(),focus:this._focus,db:this._db,offScreenCanvas:this.offScreenCanvas,saveCanvas:this.saveCanvas};var a=(t=new Qe(e)).uid;return this.vws.push(t),i.push(a),o&&(n=o.vm.getCurTab())&&(n.chs.forEach((function(e){(e=r._db.getMid(e.uid))&&e.addViewer(a)})),(e=this._tabMng.getTab(n.uid)).vws.push(a),(i=t.vm.tabHandler(e,null,!0))&&(i.setCur(n.cur),i.setSlt(n.slt.slice()),t.vm.showTab(i,"filter"))),this.emit(O,"Invoking ViewControl#createViewer."),t},a.removeViewer=function(e){var t=this;if(!e)return!1;var r=e,i=null,o=null;n(e)&&(r=e.uid,i=e);for(var a=0;a<this.vws.length;a++)if(this.vws[a].uid===r){i=this.vws[a],o=a;break}if(null===o)return!1;var s,u;e=this._group[i.group];for(u in e&&(s=e.indexOf(r),e.splice(s,1),0===e.length&&delete this._group[i.group]),null==(s=this._tabMng)||null!=(e=s.tabs)&&e.forEach((function(e){e.removeViewer(i.uid)&&e.chs.forEach((function(e){(e=t._db.getMid(e))&&e.rmViewer(i.uid)}))})),i.unbindView(),i.dispose(),i)i[u]=null,delete i[u];return this.vws.splice(o,1),this.emit(O,"Invoking ViewControl#removeViewer."),!0},a.uidViewer=function(e){if(!e)return this.vws[0]||null;for(var t=0,r=this.vws.length;t<r;t++){var n=this.vws[t];if(n.uid===e)return n}return null},a.idxViewer=function(e){return e>=this.vws.length||e<0?null:this.vws[e]},a.dispose=function(){var t,r=this;this.isDisposed||(e.prototype.dispose.call(this),null!=(t=this.vws)&&t.forEach((function(e){r.removeViewer(e)})),(this.vws=null)!=(t=this.offScreenCanvas)&&t.dispose(),this.offScreenCanvas=null,this.canvas.width=1,this.canvas.height=1,this.canvas.getContext("2d",{willReadFrequently:!0}).clearRect(0,0,1,1),this.canvas=null,this.saveCanvas.width=1,this.saveCanvas.height=1,this.saveCanvas.getContext("2d",{willReadFrequently:!0}).clearRect(0,0,1,1),(this.saveCanvas=null)!=(t=this._mPub)&&t.dispose(),(this._mPub=null)!=(t=this._tabMng)&&t.dispose(),this._tabMng=null,this._hermiteWorkerUrl&&(w.revokeObjectURL(this._hermiteWorkerUrl),this._hermiteWorkerUrl=null),this.isDisposed=!0)},a._getScrBarW=function(){var e=document.createElement("div"),t=document.createElement("div"),r=(e.appendChild(t),e.setAttribute("style","width:180px;height:180px;position:absolute;overflow:auto;"),t.setAttribute("style","width:200px;height:200px;"),document.body.appendChild(e),e.offsetWidth-e.clientWidth);document.body.removeChild(e),this._scrBarW=r,this.vws.forEach((function(e){e.vm.setScrBarW(r)}))},a.initWorkerUlr=function(){this._hermiteWorkerUrl=w.createURL(new Blob(["("+function(){onmessage=function(e){var t=e.data.core,r=e.data.sourceWidth,n=e.data.sourceHeight,i=e.data.width,o=e.data.height,a=null;try{a=new Uint8ClampedArray(e.data.source)}catch(ke){a=new Uint8Array(e.data.source)}var s=i*o*4,u=new ArrayBuffer(s),c=null;try{c=new Uint8ClampedArray(u,0,s)}catch(ke){c=new Uint8Array(u,0,s)}for(var l=0;l<o;l++)for(var d,h=l*n/o,g=1-(h-(d=Math.floor(h))),f=d,m=(l+1)*n/o,_=m-(d=Math.floor(m-1e-5)),p=d,v=l*i*4,y=0;y<i;y++){var b=1-((B=y*r/i)-(A=Math.floor(B))),I=A,w=(A=(y+1)*r/i)-(N=Math.floor(A-1e-5)),S=N,T=0,C=0,E=0,M=0,D=255,k=(f+1)*r*4+4*I,x=void 0,P=void 0;for(x=f+1;x<p;++x)T+=a[k+2]*b*255,C+=a[k+1]*b*255,E+=a[k]*b*255,M+=D*b,k+=4*r;var W=(f+1)*r*4+4*S;for(x=f+1;x<p;++x)T+=a[W+2]*w*255,C+=a[W+1]*w*255,E+=a[W]*w*255,M+=D*w,W+=4*r;var L=f*r*4+4*(I+1);for(P=I+1;P<S;++P)T+=a[L+2]*g*255,C+=a[L+1]*g*255,E+=a[L]*g*255,M+=D*g,L+=4;var F=p*r*4+4*(I+1);for(P=I+1;P<S;++P)T+=a[F+2]*_*255,C+=a[F+1]*_*255,E+=a[F]*_*255,M+=D*_,F+=4;for(x=f+1;x<p;++x){var V=x*r*4+4*(I+1);for(P=I+1;P<S;++P)T+=255*a[V+2],C+=255*a[V+1],E+=255*a[V],M+=255,V+=4}T+=a[2+(N=f*r*4+4*I)]*(g*b)*255,C+=a[1+N]*(g*b)*255,E+=a[N]*(g*b)*255,M+=g*b*D,T+=a[2+(N=f*r*4+4*S)]*(g*w)*255,C+=a[1+N]*(g*w)*255,E+=a[N]*(g*w)*255,M+=g*w*D,T+=a[2+(N=p*r*4+4*I)]*(_*b)*255,C+=a[1+N]*(_*b)*255,E+=a[N]*(_*b)*255,M+=_*b*D,T+=a[2+(N=p*r*4+4*S)]*(_*w)*255,C+=a[1+N]*(_*w)*255,E+=a[N]*(_*w)*255;var N=(M+=_*w*D)/((A-B)*(m-h)),A=0,B=0,O=0;0!=N&&(A=T/M,B=C/M,O=E/M),A+=.5,B+=.5,O+=.5,c[v]=Math.floor(O),c[++v]=Math.floor(B),c[++v]=Math.floor(A),c[++v]=255,v++}u={core:t,target:c,taskUid:e.data.taskUid};try{postMessage(u,[c.buffer])}catch(ke){postMessage(u,null)}}}.toString()+")()"],{type:"application/javascript"}))},a.on=function(t,r){e.prototype._on.call(this,t,r)},a.emit=function(t){for(var r,n=arguments.length,i=new Array(1<n?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];(r=e.prototype._emit).call.apply(r,[this,t].concat(i))},a.onM=function(e,t){this._mPub._on(e,t)},a.emitM=function(e){for(var t,r=arguments.length,n=new Array(1<r?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];(t=this._mPub)._emit.apply(t,[e].concat(n))},a._err=function(e){this.emit(B,e)},a._ok=function(){this.emit(B,ge)},r}(S),nt=function(e){function r(t,r,n,i){var o=e.call(this,r)||this;return o._vwMng=null,o._vwMng=new rt(t,r,n,i),o}t(r,e);var n=r.prototype;return n.createViewer=function(e,t){return this._vwMng.createViewer(e=void 0===e?{}:e,t)},n.getViewerByUid=function(e){return this._vwMng.uidViewer(e)},n.getViewerByIndex=function(e){return this._vwMng.idxViewer(e)},n.removeViewer=function(e){return this._vwMng.removeViewer(e)},n.getViewerList=function(){return this._vwMng.vws.slice()},n.bindViewUiConstructor=function(e){return this._vwMng.bindViewUi(e)},n.dispose=function(){var t;e.prototype.dispose.call(this),null!=(t=this._vwMng)&&t.dispose(),this._vwMng=null},r}(S),it=function(e){function r(t){var r=e.call(this,t)||this;return r.name=t.name,r.type=t.type,r.parent=t.parent||null,r}t(r,e);var n=r.prototype;return n.removeChildren=function(e,t){var r=this.chs.length;if(r){for(var n=0;n<r;n++){var i=this.chs[n];if(i.name===e&&i.type===t)return this.chs.splice(n,1)[0]}return!1}return!1},n.setName=function(e){this.name=e},n.reorder=function(t){return("file"===this.type||"all"===this.type)&&e.prototype.reorder.call(this,t)},r}(k),ot=function(e){function r(t){return(t=e.call(this,t)||this).all=null,t.open=!0,t.dfNode=null,t.root=new it({uid:m(11),name:"root",type:"root",parent:null,chs:[]}),t.dfNode=t.root,t.all=new it({uid:m(11),name:"All",type:"file"}),t.curNode=t.root,t.selectedNodeId=null,t._initEvent(),t}t(r,e);var n=r.prototype;return n.dispose=function(){e.prototype.dispose.call(this)},n._initEvent=function(){var t=this;e.prototype._on.call(this,le,(function(r,n,i){var o=i,a=t.findChild(t.dfNode,r);a||(a=t.createFile(r),e.prototype._emit.call(t,R,t.dfNode)),n.forEach((function(e){i!==undefined?a.insert(e.uid,o++):a.append(e.uid),t.all.append(e.uid)})),e.prototype._emit.call(t,J,a,"file",i,t.open),e.prototype._emit.call(t,J,t.all,"all",i,!1)})),e.prototype._on.call(this,$,(function(e,r,n,i){var o=null;if("file"===e.type){if(!(o=t._find(e.uid,t.root)))return}else{if("all"!==e.type)return;o=t.all}o[{"switch":"switch",move:"move",reorder:"reorder"}[r]](n,i)})),e.prototype._on.call(this,ee,(function(e,r){r.forEach((function(e){t.all.remove(e),t._rmPage(e,t.root)}))}))},n._rmPage=function(e,t){var r=this;if(!(t.chs.length<1))return t.chs[0].uid?void t.chs.forEach((function(t){r._rmPage(e,t)})):t.remove(e)},n.createFile=function(t){var r=(r=this.dfNode)||this.root,n=this.findChild(r,t);return n&&"file"===n.type?e.prototype._emit.call(this,B,Pe):(n=new it({uid:m(11),name:t,type:"file",parent:r,chs:[]}),this.curNode.chs.push(n),e.prototype._emit.call(this,B,ge)),n},n.openAll=function(t){return e.prototype._emit.call(this,K,this.all,"all",t),this.all.chs.slice()},n.openFile=function(t,r){return(t=this.findChild(this.dfNode,t))&&"file"===t.type?(e.prototype._emit.call(this,K,t,"file",r),e.prototype._emit.call(this,B,ge),t.chs.slice()):(e.prototype._emit.call(this,B,pe),!1)},n.removeFile=function(t){for(var r=this.dfNode.chs,n=r.length-1;0<=n;n--)if(r[n].name===t)return e.prototype._emit.call(this,de,r[n]),r.splice(n,1),e.prototype._emit.call(this,B,ge),!0;return e.prototype._emit.call(this,B,pe),!1},n.renameFile=function(t,r){var n=this.findChild(this.dfNode,t),i=this.findChild(this.dfNode,r);return n?i?(this._err(Pe),!1):(n.name=r,i=n.chs.slice(),e.prototype._emit.call(this,he,t,r,i,n.uid),this._ok(),!0):(this._err(pe),!1)},n.getCurrentFileList=function(){return this.dfNode.chs.slice()},n._getSpiltIndex=function(e){for(var t=e.length,r=0;r<t;r++)if("folder"!==e[r].type)return r;return t},n.findChild=function(e,t){return 0<=e.chs.length&&(e=e.chs.filter((function(e){return e.name===t}))).length?e[0]:null},n._find=function(e,t){for(var r=t.chs,n=r.length,i=0;i<n;i++){if(r[i].uid===e)return r[i];if(r[i].children){var o=this._find(e,r[i]);if(o)return o}}},n._err=function(t){e.prototype._emit.call(this,B,t)},n._ok=function(){e.prototype._emit.call(this,B,ge)},r}(S),at=function(){function e(e){this.autoOpen=!0,this._tree=new ot(e.pubsub)}var t=e.prototype;return t.dispose=function(){var e;null!=(e=this._tree)&&e.dispose(),this._tree=null},t.setDefaultFolder=function(e){this._tree.dfNode=e},t.openAll=function(){return this._tree.openAll()},t.getAllContents=function(){return this._tree.all.chs.slice()},t.openFile=function(e,t){return this._tree.openFile(e,t)},t.createFile=function(e){return this._tree.createFile(e)},t.removeFile=function(e){return this._tree.removeFile(e)},t.getCurrentFileList=function(){return this._tree.getCurrentFileList()},t.renameFile=function(e,t){return this._tree.renameFile(e,t)},e}(),st=function(e){function r(t){var r=e.call(this,t)||this;return r.name=t.name,r.chs=t.chs||[],r.uid=t.uid||m(11),r}return t(r,e),r}(k),ut=function(e){function r(t){return(t=e.call(this,t)||this).tags=[],t.dfName=null,t.dfUid=null,t.sltUid=null,t.emptyItem=new st({name:"defaultTag",chs:[]}),t._initEvent(),t}t(r,e);var n=r.prototype;return n.dispose=function(){e.prototype.dispose.call(this),this.tags=[]},n._initEvent=function(){var t=this;e.prototype._on.call(this,re,(function(r){var n=!1,i=r.data;i.tags||(i.tags=[]),t.dfName&&-1===i.tags.indexOf(t.dfName)&&i.tags.push(t.dfName),i.tags.forEach((function(i){t.addTag(i)&&(n=!0),(i=t.getTag(i)).append(r.uid),e.prototype._emit.call(t,J,i,"tag",null,null,!1)})),n&&e.prototype._emit.call(t,se,t.getTagList())})),e.prototype._on.call(this,$,(function(e,r,n,i){"tag"===e.type&&(e=t.uidTag(e.uid))&&e[{"switch":"switch",move:"move",reorder:"reorder"}[r]](n,i)})),e.prototype._on.call(this,ee,(function(e,r){t.getTagList().forEach((function(e){r.forEach((function(t){e.remove(t)}))}))}))},n.openTag=function(t,r){var n=this.getTag(t);return n||(this._err(ve),n=this.emptyItem),this.setDefaultTag(t),this.sltUid=n.uid,e.prototype._emit.call(this,K,n,"tag",r),this._ok(),n.chs.slice()},n.getCurTag=function(){return this.uidTag(this.sltUid)},n.addTag=function(e,t){return-1===this.checkTag(e)&&(e=new st({name:e,chs:t||[]}),this.tags.push(e),!0)},n.removeTag=function(e){var t=this.checkTag(e);return-1!==t&&(e===this.dfName&&(this.dfName=null,this.sltUid=null),this.tags.splice(t,1),!0)},n.emptyTag=function(e){return!!(e=this.getTag(e))&&(e.clear(),!0)},n.clear=function(){return this.tags=[],!0},n.getTagContents=function(e){return(e=this.getTag(e))?e.chs.slice():null},n.getDefaultTag=function(){return this.dfName},n.setDefaultTag=function(e){if(!e)return this.dfName=null,!(this.dfUid=null);var t=this.checkTag(e);return-1!==t&&(t=this.tags[t],this.dfName=e,this.dfUid=t.uid,!0)},n.renameTag=function(t,r){if(!o(t)||!o(r))return this._err(fe),!1;var n=this.getTag(r),i=this.getTag(t);return i?n?(this._err(ye),!1):(i.name=r,n=i.chs.slice(),e.prototype._emit.call(this,ae,t,r,n,i.uid),this._ok(),!0):(this._err(ve),!1)},n.checkTag=function(e){for(var t=this.tags.length,r=0;r<t;r++)if(this.tags[r].name===e)return r;return-1},n.getTagList=function(){return this.tags},n.getTag=function(e){return-1===(e=this.checkTag(e))?null:this.tags[e]},n.uidTag=function(e){for(var t=this.tags.length,r=0;r<t;r++)if(this.tags[r].uid===e)return this.tags[r];return null},n._err=function(t){e.prototype._emit.call(this,B,t)},n._ok=function(){e.prototype._emit.call(this,B,ge)},r}(S),ct=function(){function e(e){this._mng=new ut(e.pubsub)}var t=e.prototype;return t.dispose=function(){var e;null!=(e=this._mng)&&e.dispose(),this._mng=null},t.getTagList=function(){var e=[];return this._mng.tags.forEach((function(t){t={name:t.name,uids:t.chs.slice()},e.push(t)})),e},t.addTag=function(e){return o(e)?!!this._mng.addTag(e)||(this._err(ye),!1):(this._err(fe),!1)},t.removeTag=function(e){var t=this,r=this._mng.getTag(e);return r?(r.chs.slice().forEach((function(r){t.removePageTag(r,e)})),this._ok(),this._mng.removeTag(e)):(this._err(ve),!1)},t.emptyTag=function(e){if(!o(e))return this._err(fe),!1;var t=this._mng.uidTag(e);if(!e)return this._err(ve),!1;var r=t.chs.slice();return this._emit(oe,e,r,t.uid),this._ok(),this._mng.emptyTag(e)},t.openTag=function(e,t){return this._mng.openTag(e,t)},t.getCurrentTag=function(){return this._mng.getCurTag()},t.getTagContents=function(e){return this._mng.getTagContents(e)},t.getDefaultTag=function(){return this._mng.getDefaultTag()},t.setDefaultTag=function(e){return this._mng.setDefaultTag(e)},t.addPageTag=function(e,t){o(e)&&o(t)||this._err(fe);var r=this._mng.getTag(t);return r?r.append(e)?(this._emit(ie,e,t,r.uid),this._emit(se,this._mng.tags),this._ok(),!0):(this._err(ye),!1):(this._err(ve),!1)},t.removePageTag=function(e,t){var r=this;if(o(e)||this._err(fe),t===undefined)this._mng.getTagList().forEach((function(t){t.remove(e),r._emit(ne,e,t.name,t.uid)}));else{o(t)||this._err(fe);var n=this._mng.getTag(t);if(!n)return this._err(ve),!1;if(!n.remove(e))return this._err(Ie),!1;this._emit(ne,e,t,n.uid)}return t=this._mng.getTagList(),this._emit(se,t),!0},t.renameTag=function(e,t){return this._mng.renameTag(e,t)},t._emit=function(e){for(var t,r=arguments.length,n=new Array(1<r?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];(t=this._mng)._emit.apply(t,[e].concat(n))},t._err=function(e){this._emit(B,e)},t._ok=function(){this._emit(B,ge)},e}(),lt=function(){function e(){this._d={}}var t=e.prototype;return t.addDataSync=function(e,t){return!this._check(e)&&(this._d[e]=t,!0)},t.getDataSync=function(e){return this._d[e]},t.removeDataSync=function(e){return!!this._check(e)&&(delete this._d[e],!0)},t.updateDataSync=function(e,t){return!!this._check(e)&&(this._d[e]=t,!0)},t._check=function(e){return this._d[e]!==undefined},e}(),dt=function(){function e(e,t){this._d={},this.createDatabase(e,t)}var t=e.prototype;return t.createDatabase=function(e,t){this._d[e]={},this._d[e][t]={}},t.addDataAsync=function(e,t,r,n){var i=this;return new Promise((function(o,a){return i._checkDB(r)?i._checkTable(r,n)?i._checkId(r,n,e)?a("The ".concat(e," already exists.")):(i._d[r][n][e]=t,void o("Save ".concat(e," to database successful."))):a(i._erMsg(1,n)):a(i._erMsg(0,r))}))},t.getDataAsync=function(e,t,r){var n=this;return new Promise((function(i,o){return n._checkDB(t)?n._checkTable(t,r)?n._checkId(t,r,e)?void i(n._d[t][r][e]):o(n._erMsg(2,e)):o(n._erMsg(1,r)):o(n._erMsg(0,t))}))},t.removeDataAsync=function(e,t,r){var n=this;return new Promise((function(i,o){return n._checkDB(t)?n._checkTable(t,r)?(delete n._d[t][r][e],void i("Remove ".concat(e," successful."))):o(n._erMsg(1,r)):o(n._erMsg(0,t))}))},t.updateDataAsync=function(e,t,r,n){var i=this;return new Promise((function(o,a){return i._checkDB(r)?i._checkTable(r,n)?i._checkId(r,n,e)?(i._d[r][n][e]=t,void o("Update ".concat(e," successful."))):a(i._erMsg(2,e)):a(i._erMsg(1,n)):a(i._erMsg(0,r))}))},t._checkDB=function(e){return this._d[e]!==undefined},t._checkTable=function(e,t){return this._d[e][t]!==undefined},t._checkId=function(e,t,r){return this._d[e][t][r]!==undefined},t._erMsg=function(e,t){return"The ".concat(["database","table","item"][e]," ").concat(t," does not exist.")},e}(),ht=function(){function e(){this.databaseName="dvsDb",this.documentTableName="dvsDoc",this.imageTableName="dvsImage",this.annotationTableName="dvsAnno",this.middle=new lt,this.metadataMng=new lt,this.DBMng=new dt(this.databaseName,this.documentTableName)}var t=e.prototype;return t.addDataAsync=function(e,t,r,n){return this.DBMng.addDataAsync(e,t,r||this.databaseName,n||this.documentTableName)},t.getDataAsync=function(e,t,r){return this.DBMng.getDataAsync(e,t||this.databaseName,r||this.documentTableName)},t.removeDataAsync=function(e,t,r){return this.DBMng.removeDataAsync(e,t||this.databaseName,r||this.documentTableName)},t.updateDataAsync=function(e,t,r,n){return this.DBMng.updateDataAsync(e,t,r||this.databaseName,n||this.documentTableName)},t.addMid=function(e,t){return this.middle.addDataSync(e,t)},t.getMid=function(e){return this.middle.getDataSync(e)},t.removeMid=function(e){return this.middle.removeDataSync(e)},t.updateMid=function(e,t){return this.middle.updateDataSync(e,t)},t.addMetadata=function(e,t){return this.metadataMng.addDataSync(e,t)},t.getMetadata=function(e){return this.metadataMng.getDataSync(e)},t.removeMetadata=function(e){return this.metadataMng.removeDataSync(e)},t.updateMetadata=function(e,t){return this.metadataMng.updateDataSync(e,t)},e}(),gt=function(e){function r(t){return(t=e.call(this,t)||this).errorMessage="ok",t.errorCode=0,t._on(B,t.updateErrorMessage.bind(Be(t))),t}return t(r,e),r.prototype.updateErrorMessage=function(e){80003!==e.code&&(this.errorMessage=e.message,this.errorCode=e.code)},r}(S),ft=function(e){function r(t){return(t=e.call(this,t)||this).logs=[],t.allowLog=!0,t.logs.push(t._formatLog("Initialize DVS object.")),t.logs.push(t._formatLog("Initialize DVS object.")),t._on(O,t.updateLogMessage.bind(Be(t))),t.logs.push(t._formatLog("Complete Log object initialization.")),t}t(r,e);var n=r.prototype;return n.updateLogMessage=function(e){var t;this.allowLog&&null!=this&&null!=(t=this.logs)&&t.push(null==this?void 0:this._formatLog(e))},n._formatLog=function(e){return function(e){var t,r=new Date,n={"M+":r.getMonth()+1,"d+":r.getDate(),"h+":r.getHours(),"m+":r.getMinutes(),"s+":r.getSeconds(),"q+":Math.floor((r.getMonth()+3)/3),S:r.getMilliseconds()};for(t in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(r.getFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+t+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?n[t]:("00"+n[t]).substr((""+n[t]).length)));return e}("yyyy-MM-dd hh:mm:ss")+" DVS: "+e},n.clear=function(){this.logs=[]},n.dispose=function(){e.prototype.dispose.call(this),this.logs=null},r}(S);M=function(e){function r(t){var r,n,i,o,a,s=e.call(this,new T)||this;return s.DataControl=null,s.ViewControl=null,s.File=null,s.Tag=null,s.Annotation=null,s.Error=null,s.Log=null,s.uid=m(11),Array.from||(Array.from=(r=Object.prototype.toString,n=function(e){return"function"==typeof e||"[object Function]"===r.call(e)},i=function(e){return e=Number(e),isNaN(e)?0:0!==e&&isFinite(e)?(0<e?1:-1)*Math.floor(Math.abs(e)):e},o=Math.pow(2,53)-1,a=function(e){return e=i(e),Math.min(Math.max(e,0),o)},function(e){var t=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");var r,i=1<arguments.length?arguments[1]:void undefined;if(void 0!==i){if(!n(i))throw new TypeError("Array.from: when provided, the second argument must be a function");2<arguments.length&&(r=arguments[2])}for(var o,s=a(t.length),u=n(this)?Object(new this(s)):new Array(s),c=0;c<s;)o=t[c],u[c]=i?void 0===r?i(o,c):i.call(r,o,c):o,c+=1;return u.length=s,u})),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(e),n=1;n<arguments.length;n++){var i=arguments[n];if(null!=i)for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])}return r},writable:!0,configurable:!0}),HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(e,t,r){for(var n=atob(this.toDataURL(t,r).split(",")[1]),i=n.length,o=new Uint8Array(i),a=0;a<i;a++)o[a]=n.charCodeAt(a);e(new Blob([o],{type:t||"image/png"}))}}),s.Log=new ft(s._oPub),s._log("DVS"),s._log("db"),s._db=new ht,s._log("db",!1),s._log("Error"),s.Error=new gt(s._oPub),s._log("Error",!1),s._log("Tag"),s.Tag=new ct({pubsub:s._oPub}),s._log("Tag",!1),s._log("File"),s.File=new at({pubsub:s._oPub}),s._log("File",!1),s._log("ViewControl"),s.ViewControl=new nt(t,s._oPub,s._db,s.uid),s._log("ViewControl",!1),s._log("DataControl"),s.DataControl=new Fe(t,s._oPub,s._db),s._log("DataControl",!1),s._log("DVS",!1),s}t(r,e);var n=r.prototype;return n.on=function(t,r){e.prototype._on.call(this,t,r)},n.off=function(t,r){e.prototype._off.call(this,t,r)},n.emit=function(t){for(var r,n=arguments.length,i=new Array(1<n?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];(r=e.prototype._emit).call.apply(r,[this,t].concat(i))},n._log=function(e,t){(t=void 0===t||t)?this._oPub.emit(O,"Initialize ".concat(e," object.")):this._oPub.emit(O,"Complete ".concat(e," object initialization."))},n.dispose=function(){var t;e.prototype.dispose.call(this),null!=(t=this.Tag)&&t.dispose(),null!=(t=this.File)&&t.dispose(),null!=(t=this.ViewControl)&&null!=(t=t.getViewerByIndex(0))&&t.removeAllSync(),null!=(t=this.ViewControl)&&t.dispose(),null!=(t=this.Error)&&t.dispose(),null!=(t=this.Log)&&t.dispose(),this._db=null,this.Log=null,this.Error=null,this.Tag=null,this.File=null,this.DataControl=null},r}(S);window.Dynamsoft=window.Dynamsoft||{},window.Dynamsoft.ViewModel=M}();var ns={changeImageUISize:function(e,r,n){var i,o,a,s,u=r,c=n,l=Or;i=t.one(e._containerElement),t.isString(r)&&r.indexOf("%")>=0?(0==(a=t.css(i,"width"))&&(i[0].style.width="100%"),a=t.css(i,"width")*parseInt(r)/100,l=Rr):u=[(a=parseInt(r))+2,"px"].join(""),t.isString(n)&&n.indexOf("%")>=0?(0==(s=t.css(i,"height"))&&(i[0].style.height="100%"),s=t.css(i,"height")*parseInt(n)/100,l=Rr):c=[(s=parseInt(n))+2,"px"].join(""),i&&(o=t.one(".dynamsoft-dwt-container-box",i))&&o.getEL()&&(o.style("width",u),o.style("height",c)),l?(e.__funResize||(e.__funResize=function(){if(e._ImgManager&&e._containerElement){var t=ns.__innerGetUIViewRealSize(e._containerElement,e._width,e._height);return e._ImgManager.ChangeSize(t.width,t.height)}return Rr}),t.removeEventListener(window,"resize",e.__funResize),t.addEventListener(window,"resize",e.__funResize)):e.__funResize&&(t.removeEventListener(window,"resize",e.__funResize),e.__funResize=Or);var d=ns.__innerGetUIViewRealSize(e._containerElement,a,s);return e._ImgManager?e._ImgManager.ChangeSize(d.width,d.height):Rr},__innerGetUIViewRealSize:function(e,r,n){var i,o=-1,a=-1;return i=t.one(e),t.isString(r)&&r.indexOf("%")>=0&&(o=t.css(i,"width")*parseInt(r)/100),o<0&&r&&(o=parseInt(r)),t.isString(n)&&n.indexOf("%")>=0&&(a=t.css(i,"height")*parseInt(n)/100),a<0&&n&&(a=parseInt(n)),{width:o,height:a}},bindUIViewEvents:function(e,r){var n=e;r.onSelected=function(e){if(!n._isNoViewer()){var r,i=e.length;i>0&&(n._ImgManager.SetSelectedImageCount(i),r=e[i-1],!0,t.isFunction(n.__OnRefreshUI)&&n.__OnRefreshUI(r))}},r.onRefreshUI=function(e){n._isNoViewer()||ns.__innerRefreshFromUIView(n,e)},r.onResetCurrentIndex=function(e){if(!n._isNoViewer()){var r=n._ImgManager.getCurrentImageIndex();e>=0&&e<n._ImgManager.count()&&r!=e&&t.isFunction(n.__OnIndexChangeDuringDragDrop)&&n.__OnIndexChangeDuringDragDrop(r,e)}},r.onMouseMove=function(e){if(!n._isNoViewer()){var r=e.index;if(e){var i=e.x,o=e.y;n.__MouseX=i,n.__MouseY=o}t.isFunction(n.__OnMouseMove)&&n.__OnMouseMove(r)}},r.onMouseClick=function(e){if(!n._isNoViewer()){var r=e.index;if(e){var i=e.x,o=e.y;n.__MouseX=i,n.__MouseY=o}t.isFunction(n.__OnMouseClick)&&n.__OnMouseClick(r)}},r.onMouseDoubleClick=function(e){if(!n._isNoViewer()){var r=e.index;t.isFunction(n.__OnMouseDoubleClick)&&n.__OnMouseDoubleClick(r)}},r.onMouseRightClick=function(e){if(!n._isNoViewer()){var r=e.index;if(e){var i=e.x,o=e.y;n.__MouseX=i,n.__MouseY=o}return t.isFunction(n.__OnMouseRightClick)?n.__OnMouseRightClick(r):Rr}},r.onImageAreaSelected=function(e){n._isNoViewer()||t.isFunction(n.__OnImageAreaSelected)&&n.__OnImageAreaSelected(e.index,e.left,e.top,e.right,e.bottom,e.areaIndex)},r.onImageAreaDeSelected=function(e){n._isNoViewer()||t.isFunction(n.__OnImageAreaDeSelected)&&n.__OnImageAreaDeSelected(e)},r.onBufferChanged=function(e){t.isFunction(n.__OnBufferChanged)&&n.__OnBufferChanged(e)}},__innerRefreshFromUIView:function(e,r){var n=e;t.isFunction(n.__OnRefreshUI)&&n.__OnRefreshUI(r)}},is=e.navInfoSync,os={getImageUrl:function(r,n,i,o,a){var s,u=[r];if(t.isNumber(n)&&n<0)return"";if(n!==undefined&&null!==n&&(u.push("&index="),u.push(n)),u.push("&width="),u.push(i),u.push("&height="),u.push(o),u.push("&ticks="),a?u.push(a):u.push(Date.now()),s=u.join(""),e.navInfoSync.bFileSystem&&s.indexOf("dwt://")<0){var c=new Image;c.crossOrigin="anonymous",c.src=s,c=null}return s},getUrlByAct:function(e,t,r){var n=[e];return t!==undefined&&null!==t&&(n.push("&index="),n.push(t)),r&&(n.push("&act="),n.push(r)),n.push("&ticks="),n.push(Date.now()),n.join("")},output:function(r,n){e.DWT.Debug&&t.log(n)},print:function(e){var r,n=850,i=1120,o=0,a=0,s=0,u="";for(t.product.bHTML5Edition&&(is.bIE&&(i=1160),is.bFirefox&&(i=1150)),o=0;o<e.length;o++){var c=i,l=e[o],d=l.Width,h=l.Height,g=l.Url;d<=0&&(d=n),h<=0&&(h=c);var f=n/d,m=c/h;f<m?c=Math.floor(h*f):f>m&&(n=Math.floor(d*m)),a+=d,s+=h,u=u+'<div style="width:'+n+"px;height:"+c+'px"><img id="D_img'+o+'" src="'+g+'" style="position:relative;left:0px;top:0px;width: '+n+"px;height: "+c+'px" referrerpolicy="strict-origin-when-cross-origin" /></div>'}var _,p=["alwaysRaised=yes,z-look=yes,top=0,left=0,toolbar=no,menubar=no,location=no,status=no,width=",a,",height=",s].join(""),v=window.open("about:blank","_blank",p);r='<html><body id="D_img">'+u+"</body></html>",v&&(v.document.write(r),v.document.close(),v.focus(),(_=v.document.getElementById("D_img"))?_.onload=function(){v&&v.print(),t.log("print image...ok")}:t.log("cannot find image"))}};t.html5.Funs2=os;var as=Ae((function zh(e,t,r){Le(this,zh),this.Url=e,this.Width=t,this.Height=r})),ss=function(){function e(){Le(this,e),Ye(this,"bIsDirty",!1),Ye(this,"imageWidth",0),Ye(this,"imageHeight",0),Ye(this,"iImageControlWidth",0),Ye(this,"iImageControlHeight",0),Ye(this,"imageUrl",""),Ye(this,"minImageUrl",""),Ye(this,"uuid",-1),Ye(this,"serverId",-1),Ye(this,"aryOverlayRectangleData",[]),Ye(this,"ticks",Date.now())}return Ae(e,[{key:"Clear",value:function(){this.imageUrl="",this.minImageUrl="",this.serverId=-1,this.aryOverlayRectangleData=[]}}]),e}(),us=function(){function e(r,n,i,o){Le(this,e);var a=this,s=1;a._webViewer=r,a.myViewer=a._webViewer.myViewer,a.element=n,t.isUndefined(i)||(s="left"==i?-1:1),t.isUndefined(o)&&(o=!1),a.myCustomElemet=a.myViewer.createCustomElement(n,s,o),a.myCustomElemet&&(a.hide(),a.bDispose=!1)}return Ae(e,[{key:"show",value:function(){var e=this;return e.myCustomElemet?(e.myCustomElemet.show(),!0):(e.bDispose?t.Errors.CustomElementDispose(e._webViewer._stwain):t.Errors.CustomElementNotExist(e._webViewer._stwain),!1)}},{key:"hide",value:function(){var e=this;return e.myCustomElemet?(e.myCustomElemet.hide(),!0):(e.bDispose?t.Errors.CustomElementDispose(e._webViewer._stwain):t.Errors.CustomElementNotExist(e._webViewer._stwain),!1)}},{key:"dispose",value:function(){var e=this,t=!1;return!!e.bDispose||(e.myCustomElemet?(t=e.myCustomElemet.dispose())&&(e.bDispose=!0,e._webViewer._customElement=undefined,e.myCustomElemet=undefined,e.myViewer=null,e.element=null):(e.bDispose=!0,t=!0),t)}}]),e}();function cs(e,t,r){t in e||Object.defineProperty(e,t,r)}function ls(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}t.UI.CustomElement=us;var ds=new WeakSet,hs=function(){function r(e,t){Le(this,r),ls(this,ds);var n=this;n._ImgManager=t,n._stwain=t._stwain,n._webViewer=e,n._elements=[],function(e,t,r){if(!t.has(e));return r}(this,ds,gs).call(this)}return Ae(r,[{key:"dispose",value:function(){var e=this;e._stwain=null,e._ImgManager=null,e._webViewer&&(e._webViewer=null),e._elements=[]}},{key:"next",value:function(){return this._webViewer.next()}},{key:"previous",value:function(){return this._webViewer.previous()}},{key:"first",value:function(){return this._webViewer.first()}},{key:"last",value:function(){return this._webViewer.last()}},{key:"gotoPage",value:function(e){return this._webViewer.go(e)}},{key:"render",value:function(){return this._webViewer.render()}},{key:"createDocumentEditor",value:function(e){return this._stwain._isMobileMode()?(ea(this._stwain)||ta(this._stwain)["catch"]((function(){})),this._webViewer.createDocumentEditor(e)):(t.Errors.ServiceNotSupport(this._stwain,"createDocumentEditor"),null)}},{key:"createImageEditor",value:function(e){return this._webViewer.createImageEditor(e)}},{key:"createThumbnailViewer",value:function(e){return this._webViewer.createThumbnailViewer(e)}},{key:"getUISettings",value:function(){return this._webViewer.getUISettings()}},{key:"resetUISettings",value:function(){return this._webViewer.resetUISettings()}},{key:"updateUISettings",value:function(e){return this._webViewer.updateUISettings(e)}},{key:"updateCheckboxStyle",value:function(e){return this._webViewer.UpdateCheckboxStyle(e)}},{key:"updatePageNumberStyle",value:function(e){return this._webViewer.UpdatePageNumberStyle(e)}},{key:"clearSelectedAreas",value:function(){return this._webViewer.clearSelectedAreas()}},{key:"setSelectedAreas",value:function(e){return this._webViewer.setSelectedAreas(e)}},{key:"createCustomElement",value:function(e,t,r){return this._webViewer.createCustomElement(e,t,r)}},{key:"fitWindow",value:function(e){return this._webViewer.SetFitType(e)}},{key:"setButtonClass",value:function(e,t){return this._webViewer.setButtonClass(e,t)}},{key:"setViewMode",value:function(e,t){return this._webViewer.SetViewMode(e,t)}},{key:"bind",value:function(r,n){var i=r;if(t.isShadowRoot(i)){var o=document.createElement("div");i.appendChild(o),this._elements.push(o),i=o}if(t.isDOM(i)){var a=t.getShadowRoot(i);if(a){var s=e.Lib.timestamp,u=document.createElement("style");u.innerHTML=['@import url("',e.DWT.ResourcesPath,"/src/dynamsoft.viewer.css",s,'")'].join(""),a.appendChild(u),this._elements.push(u)}else a=!1;i.id&&""!=i.id||(i.id=["dwt_",t.getRandom()].join(""))}return n?this._webViewer.BindTemplate(i,n):this._webViewer.BindView(i)}},{key:"createTemplate",value:function(e,r){return this._stwain._isMobileMode()?this._webViewer.CreateTemplate(e,r):(t.Errors.ServiceNotSupport(this._stwain,"createTemplate"),null)}},{key:"show",value:function(){return this._webViewer.show()}},{key:"hide",value:function(){return this._webViewer.hide()}},{key:"unbind",value:function(){return this._webViewer._stwain.Template&&this._stwain.Template._documentTemplate.UnbindView(),t.each(this._elements,(function(e){e.parentNode&&e.parentNode.removeChild(e)})),this._webViewer.UnbindView()}},{key:"on",value:function(e,t){this._webViewer.on(e,t)}},{key:"off",value:function(e,t){this._webViewer.off(e,t)}}]),r}();function gs(){var e=this;cs(e,"width",{get:function(){return e._webViewer.GetWidth()},set:function(t){return e._webViewer.SetWidth(t)}}),cs(e,"height",{get:function(){return e._webViewer.GetHeight()},set:function(t){return e._webViewer.SetHeight(t)}}),cs(e,"idPostfix",{get:function(){return e._webViewer.GetIdPostfix()}}),cs(e,"background",{get:function(){return e._webViewer.GetBackground()},set:function(t){return e._webViewer.SetBackground(t)}}),cs(e,"border",{get:function(){return e._webViewer.GetBorder()},set:function(t){return e._webViewer.SetBorder(t)}}),cs(e,"innerBorder",{get:function(){return e._webViewer.GetInnerBorder()},set:function(t){return e._webViewer.SetInnerBorder(t)}}),cs(e,"selectedPageBorder",{get:function(){return e._webViewer.GetSelectedPageBorder()},set:function(t){return e._webViewer.SetSelectedPageBorder(t)}}),cs(e,"selectedPageBackground",{get:function(){return e._webViewer.GetSelectedPageBackground()},set:function(t){return e._webViewer.SetSelectedPageBackground(t)}}),cs(e,"showPageNumber",{get:function(){return e._webViewer.GetShowPageNumber()},set:function(t){return e._webViewer.SetShowPageNumber(t)}}),cs(e,"selectedAreaBorderColor",{get:function(){return e._webViewer.GetSelectedAreaBorderColor()},set:function(t){return e._webViewer.SetSelectedAreaBorderColor(t)}}),cs(e,"selectionRectAspectRatio",{get:function(){return e._webViewer.GetSelectionRectAspectRatio()},set:function(t){return e._webViewer.SetSelectionRectAspectRatio(t)}}),cs(e,"cursor",{get:function(){return e._webViewer.GetCursor()},set:function(t){return e._webViewer.SetCursor(t)}}),cs(e,"ifAutoScroll",{get:function(){return e._webViewer.GetIfAutoScroll()},set:function(t){return e._webViewer.SetIfAutoScroll(t)}}),cs(e,"pageMargin",{get:function(){return e._webViewer.GetPageMargin()},set:function(t){return e._webViewer.SetPageMargin(t)}}),cs(e,"zoom",{get:function(){return e._webViewer.GetZoom()},set:function(t){return e._webViewer.SetZoom(t)}}),cs(e,"singlePageMode",{get:function(){return e._webViewer.GetIfSinglePageMode()},set:function(t){return e._webViewer.SetIfSinglePageMode(t)}}),cs(e,"acceptDrop",{get:function(){return e._webViewer.GetAcceptDrop()},set:function(t){return e._webViewer.SetAcceptDrop(t)}}),cs(e,"allowSlide",{get:function(){return e._webViewer.GetAllowSlide()},set:function(t){return e._webViewer.SetAllowSlide(t)}}),cs(e,"autoChangeIndex",{get:function(){return e._webViewer.GetAutoChangeIndex()},set:function(t){return e._webViewer.SetAutoChangeIndex(t)}}),cs(e,"showCheckbox",{get:function(){return e._webViewer.GetShowCheckbox()},set:function(t){return e._webViewer.SetShowCheckbox(t)}}),cs(e,"selectionMode",{get:function(){return e._webViewer.GetMultiSelectMode()},set:function(t){return e._webViewer.SetMultiSelectMode(t)}}),cs(e,"allowPageDragging",{get:function(){return e._webViewer.GetAllowPageDragging()},set:function(t){return e._webViewer.SetAllowPageDragging(t)}})}t.UI.DWTViewer=hs;var fs="dynamsoft-default-document",ms="rgb(255, 255, 255)",_s="transparent",ps="1px solid rgb(238, 238, 238)",vs="rgb(239, 246, 253)",ys="1px solid rgb(238, 238, 238)",bs="rgb(251, 236, 136)",Is="1px solid rgb(125,162,206)",ws="rgb(199, 222, 252)",Ss={visibility:"hidden",width:"24px",height:"24px",background:"#ffffff",borderWidth:"2px",borderColor:"#000000",checkMarkColor:"#000000",checkMarkLineWidth:"2px",borderRadius:0,opacity:.5,left:0,top:0,right:"",bottom:"",translateX:"",translateY:""},Ts={visibility:"hidden",width:"24px",height:"24px",background:"#ffffff",borderWidth:"1px",borderColor:"#a79898",borderRadius:"50%",opacity:.5,color:"#000000",fontFamily:"sans-serif",fontSize:12,left:"",top:"",right:0,bottom:0,translateX:"",translateY:""},Cs="url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDI1LjQuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHZpZXdCb3g9IjAgMCAzMDAgMzAwIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAzMDAgMzAwOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+CjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+Cgkuc3Qwe2ZpbGw6I0NDQ0NDQzt9Cgkuc3Qxe2ZpbGw6I0YwRUZGNDt9Cjwvc3R5bGU+CjxnIGlkPSJHcm91cF8xMyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTMyOS42NjggLTE3OC41ODkpIj4KCTxnIGlkPSJSZWN0YW5nbGVfMTciPgoJCTxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik01OTgsMzQ3LjloLTQuMnYtMmgyLjJ2LTEuOGgyVjM0Ny45eiBNNTg3LjksMzQ3LjloLTZ2LTJoNlYzNDcuOXogTTU3NS45LDM0Ny45aC02di0yaDZWMzQ3Ljl6IE01NjMuOSwzNDcuOQoJCQloLTZ2LTJoNlYzNDcuOXogTTU1MS45LDM0Ny45aC02di0yaDZWMzQ3Ljl6IE01MzkuOSwzNDcuOWgtNnYtMmg2VjM0Ny45eiBNNTI3LjksMzQ3LjloLTZ2LTJoNlYzNDcuOXogTTUxNS45LDM0Ny45aC02di0yaDYKCQkJVjM0Ny45eiBNNTAzLjksMzQ3LjloLTZ2LTJoNlYzNDcuOXogTTQ5MS45LDM0Ny45aC02di0yaDZWMzQ3Ljl6IE00NzkuOSwzNDcuOWgtNnYtMmg2VjM0Ny45eiBNNDY3LjksMzQ3LjloLTZ2LTJoNlYzNDcuOXoKCQkJIE00NTUuOSwzNDcuOWgtNnYtMmg2VjM0Ny45eiBNNDQzLjksMzQ3LjloLTZ2LTJoNlYzNDcuOXogTTQzMS45LDM0Ny45aC02di0yaDZWMzQ3Ljl6IE00MTkuOSwzNDcuOWgtNnYtMmg2VjM0Ny45eiBNNDA3LjksMzQ3LjkKCQkJaC02di0yaDZWMzQ3Ljl6IE0zOTUuOSwzNDcuOWgtNnYtMmg2VjM0Ny45eiBNMzgzLjksMzQ3LjloLTZ2LTJoNlYzNDcuOXogTTM3OC42LDM0MS4xaC0ydi02aDJWMzQxLjF6IE01OTgsMzM4LjFoLTJ2LTZoMlYzMzguMXoKCQkJIE0zNzguNiwzMjkuMWgtMnYtNmgyVjMyOS4xeiBNNTk4LDMyNi4xaC0ydi02aDJWMzI2LjF6IE0zNzguNiwzMTcuMWgtMnYtNmgyVjMxNy4xeiBNNTk4LDMxNC4xaC0ydi02aDJWMzE0LjF6IE0zNzguNiwzMDUuMWgtMgoJCQl2LTZoMlYzMDUuMXogTTU5OCwzMDIuMWgtMnYtNmgyVjMwMi4xeiBNMzc4LjYsMjkzLjFoLTJ2LTZoMlYyOTMuMXogTTU5OCwyOTAuMWgtMnYtNmgyVjI5MC4xeiBNMzc4LjYsMjgxLjFoLTJ2LTZoMlYyODEuMXoKCQkJIE01OTgsMjc4LjFoLTJ2LTZoMlYyNzguMXogTTM3OC42LDI2OS4xaC0ydi02aDJWMjY5LjF6IE01OTgsMjY2LjFoLTJ2LTZoMlYyNjYuMXogTTM3OC42LDI1Ny4xaC0ydi02aDJWMjU3LjF6IE01OTgsMjU0LjFoLTJ2LTYKCQkJaDJWMjU0LjF6IE0zNzguNiwyNDUuMWgtMnYtNmgyVjI0NS4xeiBNNTk4LDI0Mi4xaC0ydi02aDJWMjQyLjF6IE0zNzguNiwyMzMuMWgtMnYtNmgyVjIzMy4xeiBNNTk4LDIzMC4xaC0ydi02aDJWMjMwLjF6CgkJCSBNMzc4LjYsMjIxLjFoLTJ2LTYuN2g3djJoLTVWMjIxLjF6IE01OTgsMjE4LjFoLTJ2LTEuNmgtMi40di0yaDQuNFYyMTguMXogTTU4Ny42LDIxNi41aC02di0yaDZWMjE2LjV6IE01NzUuNiwyMTYuNWgtNnYtMmg2CgkJCVYyMTYuNXogTTU2My42LDIxNi41aC02di0yaDZWMjE2LjV6IE01NTEuNiwyMTYuNWgtNnYtMmg2VjIxNi41eiBNNTM5LjYsMjE2LjVoLTZ2LTJoNlYyMTYuNXogTTUyNy42LDIxNi41aC02di0yaDZWMjE2LjV6CgkJCSBNNTE1LjYsMjE2LjVoLTZ2LTJoNlYyMTYuNXogTTUwMy42LDIxNi41aC02di0yaDZWMjE2LjV6IE00OTEuNiwyMTYuNWgtNnYtMmg2VjIxNi41eiBNNDc5LjYsMjE2LjVoLTZ2LTJoNlYyMTYuNXogTTQ2Ny42LDIxNi41CgkJCWgtNnYtMmg2VjIxNi41eiBNNDU1LjYsMjE2LjVoLTZ2LTJoNlYyMTYuNXogTTQ0My42LDIxNi41aC02di0yaDZWMjE2LjV6IE00MzEuNiwyMTYuNWgtNnYtMmg2VjIxNi41eiBNNDE5LjYsMjE2LjVoLTZ2LTJoNgoJCQlWMjE2LjV6IE00MDcuNiwyMTYuNWgtNnYtMmg2VjIxNi41eiBNMzk1LjYsMjE2LjVoLTZ2LTJoNlYyMTYuNXoiLz4KCTwvZz4KCTxnIGlkPSJGaWxlcy1Gb2xkZXJzX0NvbW1vbi1GaWxlc19jb21tb24tZmlsZS10ZXh0LWFkZCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMi4zNjIgMi4xMzkpIj4KCQk8ZyBpZD0iR3JvdXBfNDIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDM5Ny44MDYgMjAxLjk1KSI+CgkJCTxnIGlkPSJjb21tb24tZmlsZS10ZXh0LWFkZCI+CgkJCQk8ZyBpZD0iT3ZhbF8xOCI+CgkJCQkJPHBhdGggY2xhc3M9InN0MCIgZD0iTTEwNy4yLDExOC40TDEwNy4yLDExOC40TDEwNy4yLDExOC40Yy0xMi4zLDAtMjIuMy0xMC0yMi4zLTIyLjNjMC0xMi4zLDEwLTIyLjMsMjIuMy0yMi4zYzAsMCwwLDAsMCwwCgkJCQkJCWMxMi4zLDAsMjIuMywxMCwyMi4zLDIyLjNjMCw1LjktMi4zLDExLjUtNi41LDE1LjdDMTE4LjgsMTE2LjEsMTEzLjIsMTE4LjQsMTA3LjIsMTE4LjR6IE0xMDcuMiw3NS45CgkJCQkJCUMxMDcuMiw3NS45LDEwNy4yLDc1LjksMTA3LjIsNzUuOUM5Ni4xLDc1LjksODcsODUsODcsOTYuMmMwLDExLjIsOS4xLDIwLjMsMjAuMywyMC4zbDAsMXYtMWM1LjQsMCwxMC41LTIuMSwxNC4zLTUuOQoJCQkJCQljMy44LTMuOCw1LjktOC45LDUuOS0xNC4zQzEyNy41LDg1LDExOC40LDc1LjksMTA3LjIsNzUuOXoiLz4KCQkJCTwvZz4KCQkJCTxnIGlkPSJTaGFwZV8xMzMiPgoJCQkJCTxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0xMDcuMiwxMDcuOGMtMC42LDAtMS0wLjQtMS0xVjg1LjVjMC0wLjYsMC40LTEsMS0xczEsMC40LDEsMXYyMS4zQzEwOC4yLDEwNy4zLDEwNy44LDEwNy44LDEwNy4yLDEwNy44egoJCQkJCQkiLz4KCQkJCTwvZz4KCQkJCTxnIGlkPSJTaGFwZV8xMzQiPgoJCQkJCTxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0xMTcuOSw5Ny4ySDk2LjZjLTAuNiwwLTEtMC40LTEtMXMwLjQtMSwxLTFoMjEuM2MwLjYsMCwxLDAuNCwxLDFTMTE4LjQsOTcuMiwxMTcuOSw5Ny4yeiIvPgoJCQkJPC9nPgoJCQkJPGcgaWQ9IlNoYXBlXzEzNSI+CgkJCQkJPHBhdGggY2xhc3M9InN0MCIgZD0iTTk0LjgsNjUuM0g2MS4xYy0wLjYsMC0xLTAuNC0xLTFzMC40LTEsMS0xaDMzLjdjMC42LDAsMSwwLjQsMSwxUzk1LjQsNjUuMyw5NC44LDY1LjN6Ii8+CgkJCQk8L2c+CgkJCQk8ZyBpZD0iU2hhcGVfMTM2Ij4KCQkJCQk8cGF0aCBjbGFzcz0ic3QwIiBkPSJNODIuNCw3NS45SDYxLjFjLTAuNiwwLTEtMC40LTEtMXMwLjQtMSwxLTFoMjEuM2MwLjYsMCwxLDAuNCwxLDFTODMsNzUuOSw4Mi40LDc1Ljl6Ii8+CgkJCQk8L2c+CgkJCQk8ZyBpZD0iU2hhcGVfMTM3Ij4KCQkJCQk8cGF0aCBjbGFzcz0ic3QwIiBkPSJNODYsNTQuNkg2MS4xYy0wLjYsMC0xLTAuNC0xLTFzMC40LTEsMS0xSDg2YzAuNiwwLDEsMC40LDEsMVM4Ni41LDU0LjYsODYsNTQuNnoiLz4KCQkJCTwvZz4KCQkJCTxnIGlkPSJTaGFwZV8xMzgiPgoJCQkJCTxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik03NS4zLDg2LjVINjEuMWMtMC42LDAtMS0wLjQtMS0xczAuNC0xLDEtMWgxNC4yYzAuNiwwLDEsMC40LDEsMVM3NS45LDg2LjUsNzUuMyw4Ni41eiIvPgoJCQkJPC9nPgoJCQkJPGcgaWQ9IlNoYXBlXzEzOSI+CgkJCQkJPHBhdGggY2xhc3M9InN0MCIgZD0iTTc1LjMsOTcuMkg2MS4xYy0wLjYsMC0xLTAuNC0xLTFzMC40LTEsMS0xaDE0LjJjMC42LDAsMSwwLjQsMSwxUzc1LjksOTcuMiw3NS4zLDk3LjJ6Ii8+CgkJCQk8L2c+CgkJCQk8ZyBpZD0iU2hhcGVfMTQwIj4KCQkJCQk8cGF0aCBjbGFzcz0ic3QwIiBkPSJNODIuNCwxMTguNEg1MC41Yy0yLjUsMC00LjUtMi00LjUtNC41VjM5LjRjMC0yLjUsMi00LjUsNC41LTQuNWg0Ny4xYzEuMiwwLDIuNCwwLjUsMy4yLDEuM0wxMTQsNDkuNAoJCQkJCQljMC45LDAuOSwxLjMsMiwxLjMsMy4ydjExLjdjMCwwLjYtMC40LDEtMSwxcy0xLTAuNC0xLTFWNTIuNmMwLTAuNy0wLjMtMS4zLTAuNy0xLjhMOTkuNCwzNy42Yy0wLjUtMC41LTEuMS0wLjctMS44LTAuN0g1MC41CgkJCQkJCWMtMS40LDAtMi41LDEuMS0yLjUsMi41djc0LjRjMCwxLjQsMS4xLDIuNSwyLjUsMi41aDMxLjljMC42LDAsMSwwLjQsMSwxUzgzLDExOC40LDgyLjQsMTE4LjR6Ii8+CgkJCQk8L2c+CgkJCTwvZz4KCQk8L2c+Cgk8L2c+Cgk8ZyBpZD0iQXJyb3dzLURpYWdyYW1zX0RpYWdyYW1zX2RpYWdyYW0tZGFzaC1kb3duLWZhc3QiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0yIDQpIj4KCQk8ZyBpZD0iR3JvdXBfMTY1Ij4KCQkJPGcgaWQ9IkxpZ2h0XzE2NSI+CgkJCQk8ZyBpZD0iU2hhcGVfNTM5Ij4KCQkJCQk8cGF0aCBjbGFzcz0ic3QwIiBkPSJNNDg0LjEsNDQzbC00LjItNC4ybDEuNC0xLjRsNC4yLDQuMkw0ODQuMSw0NDN6IE00ODkuNyw0NDIuN2wtMS40LTEuNGw0LjItNC4ybDEuNCwxLjRMNDg5LjcsNDQyLjd6CgkJCQkJCSBNNDc1LjYsNDM0LjVsLTQuMi00LjJsMS40LTEuNGw0LjIsNC4yTDQ3NS42LDQzNC41eiBNNDk4LjIsNDM0LjJsLTEuNC0xLjRsMy45LTMuOWwxLjQsMS40TDQ5OC4yLDQzNC4yeiIvPgoJCQkJPC9nPgoJCQkJPGcgaWQ9IlNoYXBlXzU0MCI+CgkJCQkJPHBhdGggY2xhc3M9InN0MSIgZD0iTTQwMi43LDM0Ny42djQuMiIvPgoJCQkJCTxyZWN0IHg9IjQwMS43IiB5PSIzNDcuNiIgY2xhc3M9InN0MCIgd2lkdGg9IjIiIGhlaWdodD0iNC4yIi8+CgkJCQk8L2c+CgkJCQk8ZyBpZD0iU2hhcGVfNTQxIj4KCQkJCQk8cGF0aCBjbGFzcz0ic3QxIiBkPSJNNDAyLjcsMzYwLjN2OC42Ii8+CgkJCQkJPHJlY3QgeD0iNDAxLjciIHk9IjM2MC4zIiBjbGFzcz0ic3QwIiB3aWR0aD0iMiIgaGVpZ2h0PSI2Ii8+CgkJCQk8L2c+CgkJCQk8ZyBpZD0iU2hhcGVfNTQyIj4KCQkJCQk8cGF0aCBjbGFzcz0ic3QxIiBkPSJNNDAzLjMsMzc3LjRjMC44LDIuOCwyLjIsNS4zLDQuMyw3LjMiLz4KCQkJCQk8cGF0aCBjbGFzcz0ic3QwIiBkPSJNNDA1LjEsMzgzLjNjLTEuMy0xLjctMi4yLTMuNi0yLjgtNS43bDEuOS0wLjVjMC41LDEuOCwxLjMsMy41LDIuNSw1TDQwNS4xLDM4My4zeiIvPgoJCQkJPC9nPgoJCQkJPGcgaWQ9IlNoYXBlXzU0MyI+CgkJCQkJPHBhdGggY2xhc3M9InN0MSIgZD0iTTQxNC44LDM4OWMyLjgsMC42LDUuNywwLjksOC41LDAuNyIvPgoJCQkJCTxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik00MjAuNywzOTAuN2MtMi4xLDAtNC4xLTAuMy02LjItMC43bDAuNC0xLjljMS45LDAuNCwzLjgsMC43LDUuNywwLjdMNDIwLjcsMzkwLjd6Ii8+CgkJCQk8L2c+CgkJCQk8ZyBpZD0iU2hhcGVfNTQ0Ij4KCQkJCQk8cGF0aCBjbGFzcz0ic3QxIiBkPSJNNDMxLjgsMzg5LjZoOC42Ii8+CgkJCQkJPHJlY3QgeD0iNDMxLjgiIHk9IjM4OC42IiBjbGFzcz0ic3QwIiB3aWR0aD0iNiIgaGVpZ2h0PSIyIi8+CgkJCQk8L2c+CgkJCQk8ZyBpZD0iU2hhcGVfNTQ1Ij4KCQkJCQk8cGF0aCBjbGFzcz0ic3QxIiBkPSJNNDQ4LjksMzg5LjZoOC42Ii8+CgkJCQkJPHJlY3QgeD0iNDQ4LjkiIHk9IjM4OC42IiBjbGFzcz0ic3QwIiB3aWR0aD0iNiIgaGVpZ2h0PSIyIi8+CgkJCQk8L2c+CgkJCQk8ZyBpZD0iU2hhcGVfNTQ2Ij4KCQkJCQk8cGF0aCBjbGFzcz0ic3QxIiBkPSJNNDY2LDM4OS42YzIuOS0wLjIsNS43LDAsOC41LDAuNiIvPgoJCQkJCTxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik00NzEuOCwzOTAuOGMtMS45LTAuMy0zLjgtMC4zLTUuOC0wLjJsLTAuMS0yYzIuMS0wLjEsNC4yLTAuMSw2LjIsMC4yTDQ3MS44LDM5MC44eiIvPgoJCQkJPC9nPgoJCQkJPGcgaWQ9IlNoYXBlXzU0NyI+CgkJCQkJPHBhdGggY2xhc3M9InN0MSIgZD0iTTQ4MS43LDM5NC41YzIsMiwzLjUsNC41LDQuMyw3LjMiLz4KCQkJCQk8cGF0aCBjbGFzcz0ic3QwIiBkPSJNNDg0LjIsMzk5LjljLTAuOC0xLjctMS45LTMuMy0zLjItNC42bDEuNC0xLjRjMS41LDEuNSwyLjcsMy4zLDMuNiw1LjJMNDg0LjIsMzk5Ljl6Ii8+CgkJCQk8L2c+CgkJCQk8ZyBpZD0iU2hhcGVfNTQ4Ij4KCQkJCQk8cGF0aCBjbGFzcz0ic3QxIiBkPSJNNDg2LjcsNDEwLjN2OC42Ii8+CgkJCQkJPHJlY3QgeD0iNDg1LjciIHk9IjQxMC4zIiBjbGFzcz0ic3QwIiB3aWR0aD0iMiIgaGVpZ2h0PSI2Ii8+CgkJCQk8L2c+CgkJCQk8ZyBpZD0iU2hhcGVfNTQ5Ij4KCQkJCQk8cGF0aCBjbGFzcz0ic3QxIiBkPSJNNDg2LjcsNDI3LjR2NC4yIi8+CgkJCQkJPHJlY3QgeD0iNDg1LjciIHk9IjQyNy40IiBjbGFzcz0ic3QwIiB3aWR0aD0iMiIgaGVpZ2h0PSI0LjIiLz4KCQkJCTwvZz4KCQkJPC9nPgoJCTwvZz4KCTwvZz4KPC9nPgo8L3N2Zz4K) center /auto no-repeat,#F0EFF4",Es=["click","onExitFunc","onMultiSelectionFunc","onAddDocumentFunc","onMultiSelectionCencelFunc","onAllSelectionFunc","onCancelAllSelectionFunc","onSaveFunc","onUploadFunc","bufferChanged","onRemoveSelectedFunc"],Ms={toolbars:{topMenu:!0,bottomMenu:!0},groups:{viewMenu:!1,global:!1,viewChange:!1,viewerCorner:!1,pager:!1,myMainTopGroup:{visibility:!0,location:"topMenu",sequence:1},myMainBottomGroup:{visibility:!0,location:"bottomMenu",sequence:1},myMultiSelectionTopGroup:{visibility:!0,location:"topMenu",sequence:2},myMultiSelectionBottomGroup:{visibility:!0,location:"bottomMenu",sequence:2},myGroup3:{visibility:!0,location:"header",sequence:1}},cropStyle:{cropMask:!1,cropBar:!1},buttonResize:{ifResize:!0,maxSize:18,minSize:12},buttons:{exit:{visibility:!0,location:"myMainTopGroup",iconClass:"ds-dvs-ui-pagePre ds-dwt-ui-icon-color ds-dwt-ui-icon-left",sequence:1,onButtonClick:"onExitFunc"},fileName:{visibility:!0,location:"myMainTopGroup",iconClass:"ds-dvs-ui-pagePre1 ds-dwt-ui-icon-color",sequence:2,text:""},addDocument:{visibility:!0,location:"myMainBottomGroup",iconClass:"ds-dwt-ui-icon-addImageFromCamera  ds-dwt-ui-icon-color",sequence:1,onButtonClick:"onAddDocumentFunc"},multiSelection:{visibility:!0,location:"myMainTopGroup",iconClass:"ds-dwt-ui-icon-selectAll ds-dwt-ui-icon-color ds-dwt-ui-icon-right",sequence:3,onButtonClick:"onMultiSelectionFunc"},cancel:{visibility:!0,location:"myMultiSelectionTopGroup",iconClass:"ds-dvs-ui-pagePre ds-dwt-ui-icon-color ds-dwt-ui-icon-left",sequence:1,onButtonClick:"onMultiSelectionCencelFunc"},selectCount:{visibility:!0,location:"myMultiSelectionTopGroup",iconClass:"ds-dvs-ui-pagePre2 ds-dwt-ui-icon-color",sequence:2,text:"selected count: "},selectAll:{visibility:!0,location:"myMultiSelectionTopGroup",iconClass:"ds-dwt-ui-mobile-icon-unselected ds-dwt-ui-icon-color dynamsoft-dwt-selectColor ds-dwt-ui-icon-right",sequence:2,onButtonClick:"onAllSelectionFunc"},cancelAllSelect:{visibility:!0,location:"myMultiSelectionTopGroup",iconClass:"ds-dwt-ui-mobile-icon-a-allselected ds-dwt-ui-icon-color dynamsoft-dwt-selectColor ds-dwt-ui-icon-right",sequence:3,onButtonClick:"onCancelAllSelectionFunc"},save:{visibility:!0,location:"myMultiSelectionBottomGroup",iconClass:"ds-dwt-ui-icon-saveImage ds-dwt-ui-icon-color",sequence:2,onButtonClick:"onSaveFunc"},upload:{visibility:!0,location:"myMultiSelectionBottomGroup",iconClass:"ds-dwt-ui-mobile-icon-a-uploadfromserver ds-dwt-ui-icon-color",sequence:2,onButtonClick:"onUploadFunc"},removeSelected:{visibility:!0,location:"myMultiSelectionBottomGroup",iconClass:"ds-dwt-ui-mobile-icon-delete ds-dwt-ui-icon-color",sequence:2,onButtonClick:"onRemoveSelectedFunc"}},content:{besides:{visibility:!1,sequence:4},thumbnail:{backgroundColor:"#fff"}},canvasConfig:{columns:2,rows:2,background:ms,pageBackground:"rgb(255,255,255)",allowPageDragging:!0,checkbox:{visibility:Ss.visibility,width:"30px",height:"30px",background:Ss.background,borderWidth:"3px",borderColor:"#FE8E14",checkMarkColor:"#FE8E14",checkMarkLineWidth:"3px",borderRadius:Ss.borderRadius,opacity:1,left:Ss.left,top:Ss.top,right:Ss.right,bottom:Ss.bottom,translateX:Ss.translateX,translateY:Ss.translateY},pageNumber:{visibility:"visible",width:"36px",height:"36px",background:Ts.background,borderWidth:Ts.borderWidth,borderColor:Ts.borderColor,borderRadius:Ts.borderRadius,opacity:1,color:Ts.color,fontFamily:Ts.fontFamily,fontSize:18,left:Ts.left,top:Ts.top,right:Ts.right,bottom:Ts.bottom,translateX:Ts.translateX,translateY:Ts.translateY}},thumbnail:{showThumbnailControl:!1,selectedBorderColor:"#7DA2CE",selectedBackgroundColor:"rgb(199, 222, 252)",imageBackgroundColor:"transparent",imageBorderColor:"rgb(238, 238, 238)",hoverBackgroundColor:"rgb(239, 246, 253)",hoverBorderColor:"rgb(238, 238, 238)",placeholderBackgroundColor:"rgb(251, 236, 136)"}},Ds=function(){function r(e,t,n,i){Le(this,r);var o=this;o._ImgManager=t,o._stwain=t._stwain,o._webViewer=e,o._template=n,o._documentConfiguration=i}return Ae(r,[{key:"BindView",value:function(e){var r,n=this;r=e&&"DIV"==e.nodeName?e:document.getElementById(e),t.isUndefined(r)||t.isNull(r)?(n.newContainer=document.createElement("div"),document.body.appendChild(n.newContainer),document.body.insertBefore(n.newContainer,document.body.firstElementChild),n.newContainer.style.width="100%",n.newContainer.style.height="100%",n.newContainer.style.position="fixed",n.newContainer.style.left="0px",n.newContainer.style.top="0px",n.bFullScreen=!0):(n.newContainer=r,n.bFullScreen=!1),n._webViewer.BindView(n.newContainer),n._webViewer.updateUISettings(Ms)}},{key:"initView",value:function(){var t=this,r=document.createElement("div");r.id="btnCapture"+t._webViewer.myViewer.postfix,r.className="ds-dwt-ui-icon-addImageFromCamera dynamsoft-dwt-btnCapture",r.onclick=function(){t._webViewer.myViewer.emit("onAddDocumentFunc")},0==t._webViewer.GetHowManyImagesInBuffer()&&t._webViewer.SetBackground(Cs);var n=document.getElementById("WebViewer"+t._webViewer.myViewer.postfix);n&&n.appendChild(r),t.setMultiSelectMode(!1),t.__bindButtonEvents(),t._webViewer.SetCursor("pointer"),t.DWTCustomWrapper=document.createElement("div");var i=e.Lib.env.isMobileViewer(),o=e.Lib.env.isPadViewer();i||o?t.customElement=t._webViewer.createCustomElement(t.DWTCustomWrapper,"right",!0):(t.DWTCustomWrapper.style.height="100%",t.DWTCustomWrapper.style.width="20%",t.customElement=t._webViewer.createCustomElement(t.DWTCustomWrapper,"right",!1));var a=document.getElementById("fileName"+t._webViewer.myViewer.postfix);a&&(a.style.width="80%",a.style.whiteSpace="nowrap");var s=document.getElementById("selectCount"+t._webViewer.myViewer.postfix);s&&(s.style.width="200px",s.style.whiteSpace="nowrap");var u=document.getElementById("bottomMenu"+t._webViewer.myViewer.postfix);u&&(u.style.border="0",u.style.display="none")}},{key:"UnbindView",value:function(){var e=this;e._unbindButtonEvents(),e._documentEditor&&e._documentEditor.dispose();var t=document.getElementById("btnCapture"+e._webViewer.myViewer.postfix);return t&&(t.onclick=function(){}),e.newContainer&&1==e.bFullScreen&&e.newContainer.parentNode&&e.newContainer.childNodes.length>0&&e.newContainer.parentNode.removeChild(e.newContainer),e.newContainer="",e.DWTCustomWrapper="",!0}},{key:"setMultiSelectMode",value:function(e){var t=this,r=document.getElementById("myMainTopGroup"+t._webViewer.GetIdPostfix()),n=document.getElementById("myMainBottomGroup"+t._webViewer.GetIdPostfix()),i=document.getElementById("myMultiSelectionTopGroup"+t._webViewer.GetIdPostfix()),o=document.getElementById("myMultiSelectionBottomGroup"+t._webViewer.GetIdPostfix());e?(r.style.display="none",n.style.display="none",i.style.display="",o.style.display=""):(r.style.display="",n.style.display="",i.style.display="none",o.style.display="none")}},{key:"__bindButtonEvents",value:function(){var t=this;e.Lib.each(Es,(function(e){t._webViewer.on(e,(function(r,n){t[e](r,n)}))}))}},{key:"_unbindButtonEvents",value:function(){var e=this;t.each(Es,(function(t){e._webViewer.off(t)}))}},{key:"bufferChanged",value:function(e){var r=this;if("shift"==e.action||"remove"==e.action||"add"==e.action){var n=document.getElementById("selectCount"+r._webViewer.GetIdPostfix());e.selectedIds&&n&&(n.innerText="selected count: "+e.selectedIds.length),e.selectedIds&&e.selectedIds.length==r._stwain.HowManyImagesInBuffer&&0!=r._stwain.HowManyImagesInBuffer?r.setSelectAllButtonEnable(!1):r.setSelectAllButtonEnable(!0)}e.selectedIds&&0==e.selectedIds.length?(r._webViewer.setButtonClass("save","ds-dwt-ui-icon-color-grey"),r._webViewer.setButtonClass("upload","ds-dwt-ui-icon-color-grey"),r._webViewer.setButtonClass("removeSelected","ds-dwt-ui-icon-color-grey")):(r._webViewer.setButtonClass("save","ds-dwt-ui-icon-color"),r._webViewer.setButtonClass("upload","ds-dwt-ui-icon-color"),r._webViewer.setButtonClass("removeSelected","ds-dwt-ui-icon-color"));var i=document.getElementById("btnCapture"+r._webViewer.myViewer.postfix);i&&""==i.style.display&&(t.isUndefined(e.imageIds)||e.imageIds&&0==e.imageIds.length)?r._webViewer.SetBackground(Cs):r._webViewer.SetBackground(ms)}},{key:"Dynamsoft_DocumentTemplate_OnVideoClosed",value:function(){this._webViewer.OpenFile(this._webViewer.currentFileName)}},{key:"click",value:function(e){var t=this;if(-1!=e.index&&t._webViewer.GetMultiSelectMode()==K&&t._stwain.HowManyImagesInBuffer>0){var r=t._webViewer.createDocumentEditor(t._documentConfiguration);r&&r.show()}}},{key:"onExitFunc",value:function(){this._template.onExitFunc()}},{key:"ifShowDocumentTemplate",value:function(e){var t=this;t.newContainer&&(t.newContainer.style.display=e?"":"none")}},{key:"setTemplateTitle",value:function(t){var r=e.Lib.env.isMobileViewer(),n=document.getElementById("fileName"+this._webViewer.myViewer.postfix);n&&(r&&t.length>26?n.innerText=t.substring(0,10)+"..."+t.substring(t.length-13,t.length):!r&&t.length>100?n.innerText=t.substring(0,80)+"..."+t.substring(t.length-17,t.length):n.innerText=t)}},{key:"onMultiSelectionFunc",value:function(){this._MultiSelectionInner([])}},{key:"_MultiSelectionInner",value:function(t){var r=this,n=document.getElementById("bottomMenu"+r._webViewer.myViewer.postfix);if(n&&(n.style.display=""),r._stwain.SelectImages(t),r.setMultiSelectMode(!0),!r._webViewer.GetShowCheckbox()){document.getElementById("selectCount"+r._webViewer.GetIdPostfix()).innerText="selected count: "+r._stwain.SelectedImagesIndices.length,r._webViewer.SetShowCheckbox(!0),r._stwain.SelectedImagesIndices.length==r._stwain.HowManyImagesInBuffer&&0!=r._stwain.HowManyImagesInBuffer?r.setSelectAllButtonEnable(!1):r.setSelectAllButtonEnable(!0);var i=document.getElementById("btnCapture"+r._webViewer.myViewer.postfix);if(i&&(i.style.display="none",r._webViewer.SetBackground(ms)),r._template&&!e.Lib.isFunction(r._template.onSaveFunc)){var o=document.getElementById("save"+r._webViewer.myViewer.postfix);o&&(o.style.display="none")}if(r._template&&!e.Lib.isFunction(r._template.onUploadFunc)){var a=document.getElementById("upload"+r._webViewer.myViewer.postfix);a&&(a.style.display="none")}}}},{key:"onAddDocumentFunc",value:function(){this._template.onAddDocumentFunc()}},{key:"onMultiSelectionCencelFunc",value:function(){var e=this;e.setMultiSelectMode(!1),e._webViewer.SetShowCheckbox(!1),e._stwain.SelectImages([]);var t=document.getElementById("bottomMenu"+e._webViewer.myViewer.postfix);t&&(t.style.border="0",t.style.display="none");var r=document.getElementById("btnCapture"+e._webViewer.myViewer.postfix);r&&(r.style.display="",0==e._webViewer.GetHowManyImagesInBuffer()?e._webViewer.SetBackground(Cs):e._webViewer.SetBackground(ms)),e._webViewer.SetViewMode(2,2)}},{key:"onAllSelectionFunc",value:function(){this._stwain.SelectAllImages(),this.setSelectAllButtonEnable(!1)}},{key:"onCancelAllSelectionFunc",value:function(){this._stwain.SelectImages([]),this.setSelectAllButtonEnable(!0)}},{key:"setSelectAllButtonEnable",value:function(e){var t=document.getElementById("cancelAllSelect"+this._webViewer.GetIdPostfix()),r=document.getElementById("selectAll"+this._webViewer.GetIdPostfix());r&&t&&(e?(r.style.display="",t.style.display="none"):(r.style.display="none",t.style.display=""))}},{key:"onSaveFunc",value:function(){var t=this;t._stwain.SelectedImagesIndices.length>0&&e.Lib.isFunction(t._template.onSaveFunc)&&t._template.onSaveFunc()}},{key:"onUploadFunc",value:function(){var t=this;t._stwain.SelectedImagesIndices.length>0&&e.Lib.isFunction(t._template.onUploadFunc)&&t._template.onUploadFunc()}},{key:"onRemoveSelectedFunc",value:function(){this._stwain.SelectedImagesIndices.length>0&&this._template.onRemoveSelectedFunc()}},{key:"getCustomElement",value:function(){return this.customElement}}]),r}();t.UI.DocumentTemplate=Ds;var ks=function(){function e(t,r,n){Le(this,e);var i=this;i._webViewer=t,i._ImgManager=r,i._documentTemplate=new Ds(t,r,i,n)}return Ae(e,[{key:"getCustomElement",value:function(){return this._documentTemplate.getCustomElement()}},{key:"onExitFunc",value:function(){this._webViewer.hide()}},{key:"onAddDocumentFunc",value:function(){var e=this;e._documentTemplate._documentConfiguration?e._webViewer.showVideoInner(e._documentTemplate._documentConfiguration):""==e._webViewer._documentScanConfiguration?0==e._documentTemplate.bFullScreen?(e._documentTemplate.newContainer.style.width=e._webViewer.GetWidth()+"px",e._documentTemplate.newContainer.style.height=e._webViewer.GetHeight()+"px",e._webViewer.showVideoInner({element:e._documentTemplate.newContainer})):e._webViewer.showVideoInner():e._webViewer.showVideoInner(e._webViewer._documentScanConfiguration)}},{key:"onRemoveSelectedFunc",value:function(){this._ImgManager._stwain.SelectedImagesIndices.length>0&&this._ImgManager._stwain.RemoveAllSelectedImages()}}]),e}();function xs(e){if(e!=undefined){var r=e;if(t.isString(r)&&(r=r.toLowerCase()),"hidden"===e||!1===e)return!1}return!0}t.UI.Template=ks;var Ps=function(){function e(r,n,i){Le(this,e),Ye(this,"bShowDocumentEdit",!1);var o=this;o._webViewer=r,o._stwain=r._stwain,o._webViewer.mydocEditManager||o._webViewer.createDocumentEditManager(),o._mydocEditManager=r.mydocEditManager,o._webViewer.notBindCameraForDocumentEditManager()&&o._webViewer.bindCameraForDocumentEditManager();var a=o._webViewer.GetCurrentFileName();0==a.length&&(o._webViewer.CreateFile(fs),o._webViewer.OpenFile(fs),a=fs),i.fileName=a,i.viewerUid=o._webViewer.myViewer.uid,o.myDocumentEditor=o._mydocEditManager.createEditPage(n,i),o.bShowDocumentEdit=xs(i.visibility)&&xs(i.documentEditorSettings.visibility),o.myDocumentEditor||t.Errors.WebviewerError(o._webViewer._stwain,o._webViewer.mydocEditManager.Error.errorMessage,o._webViewer.mydocEditManager.Error.errorCode),o.bDispose=!1}return Ae(e,[{key:"dispose",value:function(){var e=this,r=!1;return e.bShowDocumentEdit=!1,e.myDocumentEditor&&e.myDocumentEditor.hide(),e._mydocEditManager?e.myDocumentEditor.isDestroyed?(t.Errors.DocumentEditorDispose(e._webViewer._stwain),e.myDocumentEditor=undefined,e._webViewer._documentEditor=undefined,e._webViewer._documentEditorInner=undefined,e._mydocEditManager=null,e._stwain=null,e.bDispose=!0,!1):((r=e._mydocEditManager.removeEditPage(e.myDocumentEditor))&&(e.myDocumentEditor=undefined,e._webViewer._documentEditor=undefined,e._webViewer._documentEditorInner=undefined,e._mydocEditManager=null,e._stwain=null,e.bDispose=!0),r):(e.bDispose?t.Errors.DocumentEditorDispose(e._webViewer._stwain):t.Errors.DocumentEditorNotExist(e._webViewer._stwain),!1)}},{key:"show",value:function(){var e=this;return e.myDocumentEditor?e.myDocumentEditor.isDestroyed?(t.Errors.DocumentEditorDispose(e._webViewer._stwain),!1):(e.bShowDocumentEdit||e.myDocumentEditor.show(),e.bShowDocumentEdit=!0,!0):(e.bDispose?t.Errors.DocumentEditorDispose(e._webViewer._stwain):t.Errors.DocumentEditorNotExist(e._webViewer._stwain),!1)}},{key:"hide",value:function(){var e=this;return e.bShowDocumentEdit=!1,e.myDocumentEditor?e.myDocumentEditor.isDestroyed?(t.Errors.DocumentEditorDispose(e._webViewer._stwain),!1):(e.myDocumentEditor.hide(),!0):(e.bDispose?t.Errors.DocumentEditorDispose(e._webViewer._stwain):t.Errors.DocumentEditorNotExist(e._webViewer._stwain),!1)}},{key:"syncFile",value:function(e){this._mydocEditManager.syncFile(e)}}]),e}();t.UI.DocumentEditorInner=Ps;var Ws=function(){function e(t,r,n){Le(this,e),this._documentEditorInner=new Ps(t,r,n),this.myDocumentEditor=this._documentEditorInner.myDocumentEditor}return Ae(e,[{key:"show",value:function(){return this._documentEditorInner.show()}},{key:"hide",value:function(){return this._documentEditorInner.hide()}},{key:"dispose",value:function(){return this._documentEditorInner.dispose()}},{key:"syncFile",value:function(e){return this._documentEditorInner.syncFile(e)}}]),e}();t.UI.DocumentEditor=Ws;var Ls=document,Fs=t.win;e.DWT;var Vs,Ns,As=e.Lib.product.CustomizableDisplayInfo.buttons,Bs=e.Lib.product.CustomizableDisplayInfo.dialogText,Os=os,Rs={isFunction:function(e){return e&&"function"==typeof e},addClass:function(e,r){var n=t.one(e);n&&n.length>0&&n.addClass(r)},removeClass:function(e,r){var n=t.one(e);n&&n.length>0&&n.removeClass(r)},output:function(r,n){e.DWT.Debug&&t.log(n)},getTop:function(e){var t=e.offsetTop;return null!=e.offsetParent&&(t+=Rs.getTop(e.offsetParent)),t},getLeft:function(e){var t=e.offsetLeft;return null!=e.offsetParent&&(t+=Rs.getLeft(e.offsetParent)),t}};t._safePromptCustomMsg((function(){As=e.Lib.product.CustomizableDisplayInfo.buttons,Bs=e.Lib.product.CustomizableDisplayInfo.dialogText,Vs={toolbars:{bottomMenu:!1,header:!1,topMenu:!0,asideMenu:!1},groups:{viewMenu:{visibility:!1},myGroup:{visibility:!0,location:"topMenu",sequence:1}},buttonResize:{ifResize:!0,maxSize:22,minSize:16},buttons:{loadImage:{visibility:!1},readDirection:{visibility:!1},panelChange:{visibility:!1},previousImage:{visibility:!0,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-preImage",sequence:1,onButtonClick:"OnPreviousImage"},nextImage:{visibility:!0,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-nextImage",sequence:2,onButtonClick:"OnNextImage"},blank1:{visibility:!0,location:"myGroup",sequence:3},acquire:{visibility:1==As.visibility.scan,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-acquire",sequence:4,onButtonClick:"OnAcquire"},loadImages:{visibility:1==As.visibility.load,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-load",sequence:5,onButtonClick:"OnLoadImage"},print:{visibility:1==As.visibility.print,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-printImage",sequence:6,onButtonClick:"OnPrint"},blank2:{visibility:!!(As.visibility.scan||As.visibility.load||As.visibility.print),location:"myGroup",sequence:7},removeAll:{visibility:1==As.visibility.removeall,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-removeall",sequence:8,onButtonClick:"OnRemoveAll"},remove:{visibility:1==As.visibility.removeselected,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-removeImage",sequence:9,onButtonClick:"OnRemove"},blank3:{visibility:!(!As.visibility.removeall&&!As.visibility.removeselected),location:"myGroup",sequence:10},rotateLeft:{visibility:1==As.visibility.rotateleft,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-rotateLeftImage",sequence:11,onButtonClick:"OnRotateLeft"},rotate:{visibility:1==As.visibility.rotate,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-rotate",sequence:12,onButtonClick:"OnRotate"},rotateRight:{visibility:1==As.visibility.rotateright,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-rotateRightImage",sequence:13,onButtonClick:"OnRotateRight"},deskew:{visibility:1==As.visibility.deskew,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-deskew",sequence:14,onButtonClick:"OnDeskew"},blank4:{visibility:!!(As.visibility.rotateleft||As.visibility.rotate||As.visibility.rotateright||As.visibility.deskew),location:"myGroup",sequence:15},crop:{visibility:1==As.visibility.crop,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-cropImage-grey",sequence:16,onButtonClick:"OnCrop"},cut:{visibility:1==As.visibility.cut,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-erase-grey",sequence:17,onButtonClick:"OnErase"},changeImageSize:{visibility:1==As.visibility.changeimagesize,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-changeImageSize",sequence:18,onButtonClick:"OnChangeImageSize"},flip:{visibility:1==As.visibility.flip,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-flipImage",sequence:19,onButtonClick:"OnFlip"},mirror:{visibility:1==As.visibility.mirror,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-mirrorImage",sequence:20,onButtonClick:"OnMirror"},blank5:{visibility:!!(As.visibility.crop||As.visibility.cut||As.visibility.changeimagesize||As.visibility.flip||As.visibility.mirror),location:"myGroup",sequence:21},zoomin:{visibility:1==As.visibility.zoomin,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-zoomin",sequence:22,onButtonClick:"OnZoomin"},originalsize:{visibility:1==As.visibility.originalsize,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-originalsize",sequence:23,onButtonClick:"OnOriginalsize"},zoomout:{visibility:1==As.visibility.zoomout,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-zoomout",sequence:24,onButtonClick:"OnZoomout"},blank6:{visibility:!!(As.visibility.zoomin||As.visibility.originalsize||As.visibility.zoomout||As.visibility.stretch),location:"myGroup",sequence:26},fitPage:{visibility:1==As.visibility.fit,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-fullWebType",sequence:27,onButtonClick:"OnFitPage"},fitWidth:{visibility:1==As.visibility.fitw,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-fitWidthType",sequence:28,onButtonClick:"OnFitWidth"},fitHeight:{visibility:1==As.visibility.fith,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-fitHeightType",sequence:29,onButtonClick:"OnFitHeight"},blank7:{visibility:!!(As.visibility.fit||As.visibility.fitw||As.visibility.fith),location:"myGroup",sequence:30},hand:{visibility:1==As.visibility.hand,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-hand",sequence:31,onButtonClick:"OnHand"},select:{visibility:1==As.visibility.rectselect,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-select",sequence:32,onButtonClick:"OnSelect"},clicktozoomin:{visibility:1==As.visibility.zoom,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-clicktozoomin",sequence:33,onButtonClick:"OnClicktozoomin"},blank8:{visibility:!!(As.visibility.hand||As.visibility.rectselect||As.visibility.zoom),location:"myGroup",sequence:34},restore:{visibility:1==As.visibility.restore,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-restore",sequence:35,onButtonClick:"OnRestore"},save:{visibility:1==As.visibility.save,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-saveImage",sequence:36,onButtonClick:"OnSave"},close:{visibility:1==As.visibility.close,location:"topMenuRight",iconClass:"d-icon-font ds-dwt-ui-icon-close",sequence:1,onButtonClick:"OnClose"}},thumbnail:{visibility:!1,showThumbnailControl:!1,hoverBackgroundColor:"rgb(239, 246, 253)",hoverBorderColor:"rgb(238, 238, 238)",imageBackgroundColor:"transparent",imageBorderColor:"rgb(238, 238, 238)",placeholderBackgroundColor:"rgb(251, 236, 136)",selectedBorderColor:"rgb(125,162,206)"},tipsConfig:{previousImage:As.titles.previous,nextImage:As.titles.next,acquire:As.titles.scan,loadImages:As.titles.load,print:As.titles.print,removeAll:As.titles.removeall,remove:As.titles.removeselected,rotateLeft:As.titles.rotateleft,rotate:As.titles.rotate,rotateRight:As.titles.rotateright,deskew:As.titles.deskew,crop:As.titles.crop,cut:As.titles.cut,changeImageSize:As.titles.changeimagesize,flip:As.titles.flip,mirror:As.titles.mirror,zoomin:As.titles.zoomin,originalsize:As.titles.originalsize,zoomout:As.titles.zoomout,stretch:As.titles.stretch,fitPage:As.titles.fit,fitWidth:As.titles.fitw,fitHeight:As.titles.fith,hand:As.titles.hand,select:As.titles.rectselect,clicktozoomin:As.titles.zoom,restore:As.titles.restore,save:As.titles.save,close:As.titles.close},canvasConfig:{selectedPageBackground:_s,selectedPageBorder:"",hoverPageBackground:_s,canvasBorder:"",canvasBackground:"#434246"},outerBorder:"",topMenuBorder:""},Ns={toolbars:{header:!0,bottomMenu:!0,topMenu:!0,asideMenu:!1},groups:{viewMenu:{visibility:!1},global:{visibility:!1},viewChange:{visibility:!1},viewerCorner:{visibility:!1},pager:{visibility:!1},myGroup:{visibility:!0,location:"topMenu",sequence:1},myGroup2:{visibility:!0,location:"bottomMenu",sequence:1},myGroup3:{visibility:!0,location:"header",sequence:1},myGroup4:{visibility:!0,location:"bottomMenu",sequence:2}},buttonResize:{ifResize:!0,maxSize:32,minSize:26},buttons:{loadImage:{visibility:!1},readDirection:{visibility:!1},panelChange:{visibility:!1},print:{visibility:!1},loadImages:{visibility:1==As.visibility.load,location:"myGroup3",iconClass:"d-icon-font ds-dwt-ui-icon-load",sequence:1,onButtonClick:"OnLoadImage"},close:{visibility:1==As.visibility.close,location:"myGroup3",iconClass:"d-icon-font ds-dwt-ui-icon-close ds-dwt-ui-icon-close-right",sequence:2,onButtonClick:"OnClose"},rotateLeft:{visibility:1==As.visibility.rotateleft,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-rotateLeftImage",sequence:1,onButtonClick:"OnRotateLeft"},rotateRight:{visibility:1==As.visibility.rotateright,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-rotateRightImage",sequence:2,onButtonClick:"OnRotateRight"},flip:{visibility:1==As.visibility.flip,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-flipImage",sequence:3,onButtonClick:"OnFlip"},mirror:{visibility:1==As.visibility.mirror,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-mirrorImage",sequence:4,onButtonClick:"OnMirror"},crop:{visibility:1==As.visibility.crop,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-cropImage-grey",sequence:5,onButtonClick:"OnCrop"},cut:{visibility:1==As.visibility.cut,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-erase-grey",sequence:6,onButtonClick:"OnErase"},hand:{visibility:1==As.visibility.hand,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-hand",sequence:7,onButtonClick:"OnHand"},select:{visibility:1==As.visibility.rectselect,location:"myGroup",iconClass:"d-icon-font ds-dwt-ui-icon-select",sequence:8,onButtonClick:"OnSelect"},firstPage:{visibility:!0,location:"myGroup2",iconClass:"ds-dvs-ui-pageStart",sequence:1,onButtonClick:"OnFirstImage"},previousPage:{visibility:!0,location:"myGroup2",iconClass:"ds-dvs-ui-pagePre",sequence:2,onButtonClick:"OnPreviousImage"},pagination:{visibility:!0,location:"myGroup2",sequence:3},nextPage:{visibility:!0,location:"myGroup2",iconClass:"ds-dvs-ui-pageNext",sequence:4,onButtonClick:"OnNextImage"},lastPage:{visibility:!0,location:"myGroup2",iconClass:"ds-dvs-ui-pageEnd",sequence:5,onButtonClick:"OnLastImage"},removeAll:{visibility:1==As.visibility.removeall,location:"myGroup4",iconClass:"d-icon-font ds-dwt-ui-icon-removeall",sequence:7,onButtonClick:"OnRemoveAll"},remove:{visibility:1==As.visibility.removeselected,location:"myGroup4",iconClass:"d-icon-font ds-dwt-ui-icon-removeImage",sequence:8,onButtonClick:"OnRemove"},restore:{visibility:1==As.visibility.restore,location:"myGroup4",iconClass:"d-icon-font ds-dwt-ui-icon-restore",sequence:10,onButtonClick:"OnRestore"},save:{visibility:1==As.visibility.save,location:"myGroup4",iconClass:"d-icon-font ds-dwt-ui-icon-saveImage",sequence:11,onButtonClick:"OnSave"}},thumbnail:{visibility:!1,showThumbnailControl:!1,hoverBackgroundColor:"rgb(239, 246, 253)",hoverBorderColor:"rgb(238, 238, 238)",imageBackgroundColor:"transparent",imageBorderColor:"rgb(238, 238, 238)",placeholderBackgroundColor:"rgb(251, 236, 136)",selectedBorderColor:"rgb(125,162,206)",pageBorderColor:"rgb(204, 204, 204)"},tipsConfig:{previousImage:As.titles.previous,nextImage:As.titles.next,acquire:As.titles.scan,loadImages:As.titles.load,print:As.titles.print,removeAll:As.titles.removeall,remove:As.titles.removeselected,rotateLeft:As.titles.rotateleft,rotate:As.titles.rotate,rotateRight:As.titles.rotateright,deskew:As.titles.deskew,crop:As.titles.crop,cut:As.titles.cut,changeImageSize:As.titles.changeimagesize,flip:As.titles.flip,mirror:As.titles.mirror,zoomin:As.titles.zoomin,originalsize:As.titles.originalsize,zoomout:As.titles.zoomout,stretch:As.titles.stretch,fitPage:As.titles.fit,fitWidth:As.titles.fitw,fitHeight:As.titles.fith,hand:As.titles.hand,select:As.titles.rectselect,clicktozoomin:As.titles.zoom,restore:As.titles.restore,save:As.titles.save,close:As.titles.close},canvasConfig:{selectedPageBackground:_s,selectedPageBorder:"",hoverPageBackground:_s,canvasBorder:"",canvasBackground:"#434246"},outerBorder:"",topMenuBorder:""}}));var Us=function(){function n(e,r){Le(this,n);var i=this;i._webViewer=e,i.mydvs=e.mydvs,i._stwain=e._stwain,i.bShowImageEditForFullScreen=!1,i.bCouldBeTimeConsuming=!1,i.bShowImageEdit=!1,i.promptToSaveChange=!0;var o=Vs;i.bMobile=!1;var a=!1;i._stwain._isPC()||(i.bPadViewer||(o=Ns,a=!0),i.bMobile=!0),o=i.updateWebviewerConfig(o,r,a),i.myImageEditor=i.mydvs.ViewControl.createViewer({container:"",displayMode:"single",uiConfig:o,scrollerConfig:{}},i._webViewer.myViewer.uid),i.myImageEditor.maxZoom=50,0!=i._webViewer.mydvs.Error.errorCode&&t.Errors.WebviewerError(i._webViewer._stwain,i._webViewer.mydvs.Error.errorMessage,i._webViewer.mydvs.Error.errorCode),i.bDispose=!1,i._BindImageEditorEvents(),i._bindView(),i._currentIndex=i._webViewer.GetCurrentIndex()}return Ae(n,[{key:"updateWebviewerConfig",value:function(r,n,i){var o=r;return n&&(this.editorSettings=n,t.isUndefined(n.buttons)||(t.isUndefined(n.buttons.titles)||(t.isUndefined(n.buttons.titles.previous)||(o.tipsConfig.previousImage=n.buttons.titles.previous),t.isUndefined(n.buttons.titles.next)||(o.tipsConfig.nextImage=n.buttons.titles.next),t.isUndefined(n.buttons.titles.print)||(o.tipsConfig.print=n.buttons.titles.print),t.isUndefined(n.buttons.titles.scan)||(o.tipsConfig.acquire=n.buttons.titles.scan),t.isUndefined(n.buttons.titles.load)||(o.tipsConfig.loadImages=n.buttons.titles.load),t.isUndefined(n.buttons.titles.rotateleft)||(o.tipsConfig.rotateLeft=n.buttons.titles.rotateleft),t.isUndefined(n.buttons.titles.rotate)||(o.tipsConfig.rotate=n.buttons.titles.rotate),t.isUndefined(n.buttons.titles.rotateright)||(o.tipsConfig.rotateRight=n.buttons.titles.rotateright),t.isUndefined(n.buttons.titles.deskew)||(o.tipsConfig.deskew=n.buttons.titles.deskew),t.isUndefined(n.buttons.titles.crop)||(o.tipsConfig.crop=n.buttons.titles.crop),t.isUndefined(n.buttons.titles.cut)||(o.tipsConfig.cut=n.buttons.titles.cut),t.isUndefined(n.buttons.titles.changeimagesize)||(o.tipsConfig.changeImageSize=n.buttons.titles.changeimagesize),t.isUndefined(n.buttons.titles.flip)||(o.tipsConfig.flip=n.buttons.titles.flip),t.isUndefined(n.buttons.titles.mirror)||(o.tipsConfig.mirror=n.buttons.titles.mirror),t.isUndefined(n.buttons.titles.zoomin)||(o.tipsConfig.zoomin=n.buttons.titles.zoomin),t.isUndefined(n.buttons.titles.originalsize)||(o.tipsConfig.originalsize=n.buttons.titles.originalsize),t.isUndefined(n.buttons.titles.zoomout)||(o.tipsConfig.zoomout=n.buttons.titles.zoomout),t.isUndefined(n.buttons.titles.stretch)||(o.tipsConfig.stretch=n.buttons.titles.stretch),t.isUndefined(n.buttons.titles.fit)||(o.tipsConfig.fitPage=n.buttons.titles.fit),t.isUndefined(n.buttons.titles.fitw)||(o.tipsConfig.fitWidth=n.buttons.titles.fitw),t.isUndefined(n.buttons.titles.fith)||(o.tipsConfig.fitHeight=n.buttons.titles.fith),t.isUndefined(n.buttons.titles.hand)||(o.tipsConfig.hand=n.buttons.titles.hand),t.isUndefined(n.buttons.titles.rectselect)||(o.tipsConfig.select=n.buttons.titles.rectselect),t.isUndefined(n.buttons.titles.zoom)||(o.tipsConfig.clicktozoomin=n.buttons.titles.zoom),t.isUndefined(n.buttons.titles.restore)||(o.tipsConfig.restore=n.buttons.titles.restore),t.isUndefined(n.buttons.titles.save)||(o.tipsConfig.save=n.buttons.titles.save),t.isUndefined(n.buttons.titles.close)||(o.tipsConfig.close=n.buttons.titles.close),t.isUndefined(n.buttons.titles.removeall)||(o.tipsConfig.removeAll=n.buttons.titles.removeall),t.isUndefined(n.buttons.titles.removeselected)||(o.tipsConfig.remove=n.buttons.titles.removeselected)),t.isUndefined(n.buttons.visibility)||(i?(t.isUndefined(n.buttons.visibility.load)?o.buttons.loadImages.visibility=!0:o.buttons.loadImages.visibility=1==n.buttons.visibility.load,t.isUndefined(n.buttons.visibility.close)?o.buttons.close.visibility=!0:o.buttons.close.visibility=1==n.buttons.visibility.close,t.isUndefined(n.buttons.visibility.rotateleft)?o.buttons.rotateLeft.visibility=!0:o.buttons.rotateLeft.visibility=1==n.buttons.visibility.rotateleft,t.isUndefined(n.buttons.visibility.rotateright)?o.buttons.rotateRight.visibility=!0:o.buttons.rotateRight.visibility=1==n.buttons.visibility.rotateright,t.isUndefined(n.buttons.visibility.flip)?o.buttons.flip.visibility=!0:o.buttons.flip.visibility=1==n.buttons.visibility.flip,t.isUndefined(n.buttons.visibility.mirror)?o.buttons.mirror.visibility=!0:o.buttons.mirror.visibility=1==n.buttons.visibility.mirror,t.isUndefined(n.buttons.visibility.crop)?o.buttons.crop.visibility=!0:o.buttons.crop.visibility=1==n.buttons.visibility.crop,t.isUndefined(n.buttons.visibility.cut)?o.buttons.cut.visibility=!0:o.buttons.cut.visibility=1==n.buttons.visibility.cut,t.isUndefined(n.buttons.visibility.hand)?o.buttons.hand.visibility=!0:o.buttons.hand.visibility=1==n.buttons.visibility.hand,t.isUndefined(n.buttons.visibility.rectselect)?o.buttons.select.visibility=!0:o.buttons.select.visibility=1==n.buttons.visibility.rectselect,t.isUndefined(n.buttons.visibility.removeall)?o.buttons.removeAll.visibility=!0:o.buttons.removeAll.visibility=1==n.buttons.visibility.removeall,t.isUndefined(n.buttons.visibility.removeselected)?o.buttons.remove.visibility=!0:o.buttons.remove.visibility=1==n.buttons.visibility.removeselected,t.isUndefined(n.buttons.visibility.restore)?o.buttons.restore.visibility=!0:o.buttons.restore.visibility=1==n.buttons.visibility.restore,t.isUndefined(n.buttons.visibility.save)?o.buttons.save.visibility=!0:o.buttons.save.visibility=1==n.buttons.visibility.save):(t.isUndefined(n.buttons.visibility.scan)?o.buttons.acquire.visibility=!0:o.buttons.acquire.visibility=1==n.buttons.visibility.scan,t.isUndefined(n.buttons.visibility.load)?o.buttons.loadImages.visibility=!0:o.buttons.loadImages.visibility=1==n.buttons.visibility.load,t.isUndefined(n.buttons.visibility.print)?o.buttons.print.visibility=!0:o.buttons.print.visibility=1==n.buttons.visibility.print,o.buttons.blank2.visibility=!!(o.buttons.acquire.visibility||o.buttons.loadImages.visibility||o.buttons.print.visibility),t.isUndefined(n.buttons.visibility.removeall)?o.buttons.removeAll.visibility=!0:o.buttons.removeAll.visibility=1==n.buttons.visibility.removeall,t.isUndefined(n.buttons.visibility.removeselected)?o.buttons.remove.visibility=!0:o.buttons.remove.visibility=1==n.buttons.visibility.removeselected,o.buttons.blank3.visibility=!(!o.buttons.removeAll.visibility&&!o.buttons.remove.visibility),t.isUndefined(n.buttons.visibility.rotateleft)?o.buttons.rotateLeft.visibility=!0:o.buttons.rotateLeft.visibility=1==n.buttons.visibility.rotateleft,t.isUndefined(n.buttons.visibility.rotate)?o.buttons.rotate.visibility=!0:o.buttons.rotate.visibility=1==n.buttons.visibility.rotate,t.isUndefined(n.buttons.visibility.rotateright)?o.buttons.rotateRight.visibility=!0:o.buttons.rotateRight.visibility=1==n.buttons.visibility.rotateright,t.isUndefined(n.buttons.visibility.deskew)?o.buttons.deskew.visibility=!0:o.buttons.deskew.visibility=1==n.buttons.visibility.deskew,o.buttons.blank4.visibility=!!(o.buttons.rotateLeft.visibility||o.buttons.rotate.visibility||o.buttons.rotateRight.visibility||o.buttons.deskew.visibility),t.isUndefined(n.buttons.visibility.crop)?o.buttons.crop.visibility=!0:o.buttons.crop.visibility=1==n.buttons.visibility.crop,t.isUndefined(n.buttons.visibility.cut)?o.buttons.cut.visibility=!0:o.buttons.cut.visibility=1==n.buttons.visibility.cut,t.isUndefined(n.buttons.visibility.changeimagesize)?o.buttons.changeImageSize.visibility=!0:o.buttons.changeImageSize.visibility=1==n.buttons.visibility.changeimagesize,t.isUndefined(n.buttons.visibility.flip)?o.buttons.flip.visibility=!0:o.buttons.flip.visibility=1==n.buttons.visibility.flip,t.isUndefined(n.buttons.visibility.mirror)?o.buttons.mirror.visibility=!0:o.buttons.mirror.visibility=1==n.buttons.visibility.mirror,o.buttons.blank5.visibility=!!(o.buttons.crop.visibility||o.buttons.cut.visibility||o.buttons.changeImageSize.visibility||o.buttons.flip.visibility||o.buttons.mirror.visibility),t.isUndefined(n.buttons.visibility.zoomin)?o.buttons.zoomin.visibility=!0:o.buttons.zoomin.visibility=1==n.buttons.visibility.zoomin,t.isUndefined(n.buttons.visibility.originalsize)?o.buttons.originalsize.visibility=!0:o.buttons.originalsize.visibility=1==n.buttons.visibility.originalsize,t.isUndefined(n.buttons.visibility.zoomout)?o.buttons.zoomout.visibility=!0:o.buttons.zoomout.visibility=1==n.buttons.visibility.zoomout,o.buttons.blank6.visibility=!!(o.buttons.zoomin.visibility||o.buttons.originalsize.visibility||o.buttons.zoomout.visibility),t.isUndefined(n.buttons.visibility.fit)?o.buttons.fitPage.visibility=!0:o.buttons.fitPage.visibility=1==n.buttons.visibility.fit,t.isUndefined(n.buttons.visibility.fitw)?o.buttons.fitWidth.visibility=!0:o.buttons.fitWidth.visibility=1==n.buttons.visibility.fitw,t.isUndefined(n.buttons.visibility.fith)?o.buttons.fitHeight.visibility=!0:o.buttons.fitHeight.visibility=1==n.buttons.visibility.fith,o.buttons.blank7.visibility=!!(o.buttons.fitPage.visibility||o.buttons.fitWidth.visibility||o.buttons.fitHeight.visibility),t.isUndefined(n.buttons.visibility.hand)?o.buttons.hand.visibility=!0:o.buttons.hand.visibility=1==n.buttons.visibility.hand,t.isUndefined(n.buttons.visibility.rectselect)?o.buttons.select.visibility=!0:o.buttons.select.visibility=1==n.buttons.visibility.rectselect,t.isUndefined(n.buttons.visibility.zoom)?o.buttons.clicktozoomin.visibility=!0:o.buttons.clicktozoomin.visibility=1==n.buttons.visibility.zoom,o.buttons.blank7.visibility=!!(o.buttons.hand.visibility||o.buttons.select.visibility||o.buttons.clicktozoomin.visibility),t.isUndefined(n.buttons.visibility.restore)?o.buttons.restore.visibility=!0:o.buttons.restore.visibility=1==n.buttons.visibility.restore,t.isUndefined(n.buttons.visibility.save)?o.buttons.save.visibility=!0:o.buttons.save.visibility=1==n.buttons.visibility.save,t.isUndefined(n.buttons.visibility.close)?o.buttons.close.visibility=!0:o.buttons.close.visibility=1==n.buttons.visibility.close))),t.isUndefined(n.dialogText)||(Bs=n.dialogText,e.Lib.product.CustomizableDisplayInfo.dialogText=Bs),t.isUndefined(n.promptToSaveChange)||(this.promptToSaveChange=n.promptToSaveChange),t.isUndefined(n.border)||(o.outerBorder=n.border),t.isUndefined(n.topMenuBorder)||(o.topMenuBorder=n.topMenuBorder),t.isUndefined(n.innerBorder)||(o.canvasConfig.canvasBorder=n.innerBorder),t.isUndefined(n.background)||(o.canvasConfig.canvasBackground=n.background)),o}},{key:"_bindView",value:function(){var e=this;if(e.bShowImageEdit)return!0;if(!e.myImageEditor)return e.bDispose?t.Errors.ImageEditorDispose(e._stwain):t.Errors.ImageEditorNotExist(e._stwain),!1;var r=t.one(".dynamsoft-cvs-container");if(r&&r.getEL()?(e.cvsContainer=r,e.cvsParentId=r.parent()[0].id,e._stwain&&e._stwain.Addon&&e._stwain.Addon.Camera&&(e.cvsStatus=e._stwain.Addon.Camera.getStatus())):(e.cvsContainer="",e.cvsParentId="",e.cvsStatus=""),e.bShowImageEdit=!0,e.editorSettings&&e.editorSettings.element&&e.editorSettings.width&&e.editorSettings.height){if(e.UIEditor=e.editorSettings.element,e.bFullScreen=!1,e.myImageEditor.width=e.editorSettings.width,e.myImageEditor.height=e.editorSettings.height,e.SetWidthInner(e.editorSettings.width,!0),e.SetHeightInner(e.editorSettings.height,!0),e.myImageEditor.bindView(e.UIEditor),e.hide(),e.cvsParentId){var n=document.getElementById(e.cvsParentId);n&&n.appendChild(e.cvsContainer[0])}}else{var i=Ls.createElement("div");Ls.body.appendChild(i),document.body.insertBefore(i,document.body.firstElementChild),e.UIEditor=i,e.bFullScreen=!0,e.UIEditor.className="D_ImageUIEditor",e.UIEditor.style.width="100%",e.UIEditor.style.height="100%",e.UIEditor.style.position="fixed",e.UIEditor.style.left="0px",e.UIEditor.style.top="0px",e.UIEditor.style.zIndex="9999",e.UIEditor.style.display="none",e.SetWidthInner("100%",!0),e.SetHeightInner("100%",!0),e.myImageEditor.bindView(e.UIEditor),e.hide(),e.bShowImageEditForFullScreen=!0}if(e.updateMode(),e.editorSettings&&e.editorSettings.selectionRectAspectRatio?e.SetSelectionRectAspectRatio(e.editorSettings.selectionRectAspectRatio):e.SetSelectionRectAspectRatio(0),e.HideEditorButtonForPad(),e.actualSelectedCanvasAreas=[{left:0,top:0,right:0,bottom:0}],e._stwain._isMobileMode()){var o,a=t.one(".ds-dwt-ui-icon-acquire");if(a&&a.getEL()&&(a[0].style.display="none"),e.dwtMobileFileId="dwtmobilefile",e.UIEditor&&"DIV"==e.UIEditor.nodeName)o=document.createElement("div"),e.bMobile?o.innerHTML="<input multiple accept='image/jpeg,image/png,image/tiff' id ='"+e.dwtMobileFileId+"' type='file' style='display:none' />":o.innerHTML="<input multiple accept='image/*,.pdf' id ='"+e.dwtMobileFileId+"' type='file' style='display:none' />",e.UIEditor.appendChild(o);else{var s=document.getElementById(e.UIEditor);o=document.createElement("div"),e.bMobile?o.innerHTML="<input id ='"+e.dwtMobileFileId+"' type='file' accept='image/jpeg,image/png,image/tiff' style='display:none' />":o.innerHTML="<input id ='"+e.dwtMobileFileId+"' type='file' accept='image/*,.pdf' style='display:none' />",s.appendChild(o)}t.get(e.dwtMobileFileId).onchange=function(){for(var t=0;t<this.files.length;t++)e._stwain.LoadImageFromBinary(this.files[t]);document.getElementById(e.dwtMobileFileId).value=""}}return e.myImageEditor.off("slideSwitch"),e.myImageEditor.on("slideSwitch",(function(t){"left"==t?e._webViewer.myViewer.previous():"right"==t&&e._webViewer.myViewer.next()})),!0}},{key:"disposeInner",value:function(){var e,t=this;return(e=t.mydvs.ViewControl.removeViewer(t.myImageEditor))&&(t.UIEditor&&t.UIEditor.lastChild&&t.UIEditor.removeChild(t.UIEditor.lastChild),t.myImageEditor=undefined,t._webViewer._imageEditor=undefined,t._webViewer._imageEditorInner=undefined,t.mydvs=null,t._stwain=null,t.bDispose=!0),e}},{key:"dispose",value:function(){var e=this;if(!e.myImageEditor)return e.bDispose?t.Errors.ImageEditorDispose(e._webViewer._stwain):t.Errors.ImageEditorNotExist(e._webViewer._stwain),!1;e.OnCloseInner(!0)}},{key:"show",value:function(){var e=this;return e.myImageEditor?(e.bFullScreen&&(e.UIEditor.style.display="",document.documentElement.scrollLeft=0,document.documentElement.scrollTop=0,document.body.style.overflow="hidden"),e.myImageEditor.showViewer=!0,!0):(e.bDispose?t.Errors.ImageEditorDispose(e._webViewer._stwain):t.Errors.ImageEditorNotExist(e._webViewer._stwain),!1)}},{key:"hide",value:function(){var e=this;return e.myImageEditor?(e.myImageEditor.showViewer=!1,e.bFullScreen&&(e.UIEditor.style.display="none"),!0):(e.bDispose?t.Errors.ImageEditorDispose(e._webViewer._stwain):t.Errors.ImageEditorNotExist(e._webViewer._stwain),!1)}},{key:"_BindImageEditorEvents",value:function(){var e=this;t.each(["OnPreviousImage","OnNextImage","OnAcquire","OnLoadImage","OnPrint","OnRemoveAll","OnRemove","OnRotateLeft","OnRotate","OnRotateRight","OnDeskew","OnCrop","OnErase","OnChangeImageSize","OnFlip","OnMirror","OnZoomin","OnOriginalsize","OnZoomout","OnFitPage","OnFitWidth","OnFitHeight","OnHand","OnSelect","OnClicktozoomin","OnRestore","OnSave","OnClose","click","imageClick","pageAreaSelected","pageAreaUnselected","onDrop","OnFirstImage","OnLastImage","pageChange","bufferChanged","pageRendered","wheel"],(function(t){e.myImageEditor.on(t,(function(r,n){e[t](r,n)}))}))}},{key:"HideEditorButtonForPad",value:function(){var e=this.myImageEditor,t=this.bPadViewer,r=document.getElementById("rotateBtn"+e.postfix);r&&(r.style.display=t?"none":"");var n=document.getElementById("deskewBtn"+e.postfix);n&&(n.style.display=t?"none":"");var i=document.getElementById("changeImageSizeBtn"+e.postfix);i&&(i.style.display=t?"none":"")}},{key:"BackImageData",value:function(){var e=this;if(e._stwain._isMobileMode()&&e.bShowImageEdit){var t=e._webViewer.GetCurrentIndex();t>=0&&e._webViewer.GetImageData(e._webViewer.GetUidByIndex(t)).then((function(r){e.BackImageBuffer=r.oriData;var n=e._webViewer.GetMetaDataByIndex(t);n&&(e.BackModelImageControl={},e.BackModelImageControl.width=n.width,e.BackModelImageControl.height=n.height,e.BackModelImageControl.bitDepth=n.bitDepth,e.BackModelImageControl.resolutionX=n.resolutionX,e.BackModelImageControl.resolutionY=n.resolutionY)}))}}},{key:"CloseShowImageEditor",value:function(){var e=this;if(!e.myImageEditor)return e.bDispose?t.Errors.ImageEditorDispose(e._stwain):t.Errors.ImageEditorNotExist(e._stwain),!1;if(e.cvsContainer&&""!=e.cvsContainer&&e.cvsParentId&&""!=e.cvsParentId){var r=document.getElementById(e.cvsParentId);r&&r.appendChild(e.cvsContainer[0]),"playing"==e.cvsStatus&&e._stwain&&e._stwain.Addon&&e._stwain.Addon.Camera&&e._stwain.Addon.Camera.resume()}return!0}},{key:"UpdateInfo",value:function(){e.Lib.hideMask()}},{key:"clearSelectedAreas",value:function(){var e,r=this;return r._webViewer.GetHowManyImagesInBuffer()<=0||r._webViewer.GetCurrentIndex()<0||((e=r.myImageEditor.clearSelectedBoxes())||t.Errors.WebviewerError(r._stwain,r.mydvs.Error.errorMessage,r.mydvs.Error.errorCode),e)}},{key:"SetSelectionRectAspectRatio",value:function(e){return this.myImageEditor.selectionBoxAspectRatio=e,!0}},{key:"ZoomIn",value:function(){var e,r=this;return(e=r.myImageEditor.zoomIn())||t.Errors.WebviewerError(r._stwain,r.mydvs.Error.errorMessage,r.mydvs.Error.errorCode),e}},{key:"ZoomOut",value:function(){var e,r=this;return(e=r.myImageEditor.zoomOut())||t.Errors.WebviewerError(r._stwain,r.mydvs.Error.errorMessage,r.mydvs.Error.errorCode),e}},{key:"SetZoom",value:function(e,r,n){var i=this,o=!1;return(o=r&n?i.myImageEditor.zoomTo(e,r,n):i.myImageEditor.zoomTo(e))||t.Errors.WebviewerError(i._stwain,i.mydvs.Error.errorMessage,i.mydvs.Error.errorCode),o}},{key:"GetZoom",value:function(){return this.myImageEditor.zoom}},{key:"SetFitType",value:function(e){var r="window";return t.isUndefined(e)||"width"!=e&&"height"!=e||(r=e),this.myImageEditor.fitType=r,!0}},{key:"SetMouseShape",value:function(e){var t;switch(e){case k:t="default";break;case x:t="pointer";break;case P:t="crosshair";break;case W:t="zoom-in";break;default:t="crosshair"}return this.SetCursor(t),!0}},{key:"SetCursor",value:function(e){var t=this;if(!t._webViewer._NouiNotSupport("cursor"))return!1;var r="default";switch(e){case"default":r="default",t.SetOperationMode(1);break;case"pointer":r="pointer",t.SetOperationMode(0);break;case"crosshair":r="crosshair",t.SetOperationMode(1);break;case"zoom-in":r="zoom-in",t.SetOperationMode(2);break;default:r="crosshair"}return t.myImageEditor.canvasMouseShape=r,!0}},{key:"SetSelectionImageBorderColor",value:function(e){return this.myImageEditor.selectedPageBorderColor=e,!0}},{key:"SetBackgroundColor",value:function(e){return this.myImageEditor.imageBackgroundColor=e,!0}},{key:"SetWidth",value:function(e){return this.myImageEditor.width=e,!0}},{key:"SetWidthInner",value:function(e,r){var n=this;if(r)n.myImageEditor.width=e;else if(t.isString(e)&&e.indexOf("%")>=0){var i=n._stwain._containerElement;n.myImageEditor.width=Math.floor(t.css(i,"width")*Math.floor(e)/100)}else n.myImageEditor.width=e;return!0}},{key:"SetHeight",value:function(e){return this.myImageEditor.height=e,!0}},{key:"SetHeightInner",value:function(e,n){var i=this;if(n)i.myImageEditor.height=e;else if(t.isString(e)&&e.indexOf("%")>=0){var o=i._stwain._containerElement;i.myImageEditor.height=r(t.css(o,"height")*r(e)/100)}else i.myImageEditor.height=e;return!0}},{key:"SetIfAutoScroll",value:function(e){return this.myImageEditor.showLatestPage=e,!0}},{key:"ChangeButtonClass",value:function(e,t){var r;return this.myImageEditor&&(r=this.myImageEditor.setButtonClass(e,t)),r}},{key:"SetOperationMode",value:function(e){this.myImageEditor.operationMode=e}},{key:"UnbindContent",value:function(e){this.myImageEditor.unbindContent()}},{key:"SetSelectedPageBackground",value:function(e){this.myImageEditor.selectedPageBackground=e}},{key:"GetRealTimeMetadataByIndex",value:function(e){var r=this;if(!(e<0||e>=r._webViewer.GetHowManyImagesInBuffer()))return r.myImageEditor.getRealTimeMetadataByIndex(e);t.Errors.IndexOutOfRange(r._stwain)}},{key:"DVSRotate",value:function(e){var r,n=this;return n.myImageEditor.rotateMode=0,(r=n.myImageEditor.rotate(e))||t.Errors.WebviewerError(n._stwain,n.mydvs.Error.errorMessage,n.mydvs.Error.errorCode),r}},{key:"DVSFlip",value:function(){var e,r=this;return(e=r.myImageEditor.flip())||t.Errors.WebviewerError(r._stwain,r.mydvs.Error.errorMessage,r.mydvs.Error.errorCode),e}},{key:"DVSMirror",value:function(){var e,r=this;return(e=r.myImageEditor.mirror())||t.Errors.WebviewerError(r._stwain,r.mydvs.Error.errorMessage,r.mydvs.Error.errorCode),e}},{key:"DVSCrop",value:function(e,r,n,i){var o,a=this;return(o=a.myImageEditor.crop(e,r,n-e,i-r))||t.Errors.WebviewerError(a._stwain,a.mydvs.Error.errorMessage,a.mydvs.Error.errorCode),o}},{key:"DVSErase",value:function(e,r,n,i){var o,a=this;return(o=a.myImageEditor.erase(e,r,n-e,i-r,a._webViewer._UIView.BackgroundFillColor))||t.Errors.WebviewerError(a._stwain,a.mydvs.Error.errorMessage,a.mydvs.Error.errorCode),o}},{key:"DVSSaveTransformResult",value:function(e){var r=this;return r.myImageEditor.saveTransformation().then((function(){e(null,-1,null)}),(function(e){t.Errors.WebviewerError(r._stwain,r.mydvs.Error.errorMessage,r.mydvs.Error.errorCode)})),!0}},{key:"DVSRotateEx",value:function(e,r,n){var i,o=this;return o.myImageEditor.rotateMode=r?1:0,(i=o.myImageEditor.rotate(e))||t.Errors.WebviewerError(o._stwain,o.mydvs.Error.errorMessage,o.mydvs.Error.errorCode),i}},{key:"DVSChangeImageSize",value:function(e,n,i){var o,a=this;return(o=a.myImageEditor.changePageSize(r(e),r(n),i))||t.Errors.WebviewerError(a._stwain,a.mydvs.Error.errorMessage,a.mydvs.Error.errorCode),o}},{key:"DVSSkewAngle",value:function(){var e=this;return e._stwain._asyncGetSkewAngleOnly(e._webViewer.GetCurrentIndex(),(function(t){e.DVSRotateEx(t,!0),e.UpdateInfo(),e._IfChangedWithinTheEditor=!0,e.iChangedIndex=e._webViewer.GetCurrentIndex(),e.updateButtons()})),!0}},{key:"updateButtons",value:function(){var e=this;1==e._IfChangedWithinTheEditor?(e.ChangeButtonClass("save","ds-dwt-ui-icon-saveImage"),e.ChangeButtonClass("restore","ds-dwt-ui-icon-restore")):(e.ChangeButtonClass("save","ds-dwt-ui-icon-saveImage-grey"),e.ChangeButtonClass("restore","ds-dwt-ui-icon-restore-grey"))}},{key:"updateMode",value:function(e){var t,r=this;if(r.bShowImageEdit){if((t=r._webViewer.GetHowManyImagesInBuffer())>1?(r._webViewer.GetCurrentIndex()==t-1||r._webViewer.GetHowManyImagesInBuffer()<=1?r.ChangeButtonClass("nextImage","ds-dwt-ui-icon-nextImage-grey"):r.ChangeButtonClass("nextImage","ds-dwt-ui-icon-nextImage"),r._webViewer.GetCurrentIndex()<=0||r._webViewer.GetHowManyImagesInBuffer()<=1?r.ChangeButtonClass("previousImage","ds-dwt-ui-icon-preImage-grey"):r.ChangeButtonClass("previousImage","ds-dwt-ui-icon-preImage")):(r.ChangeButtonClass("nextImage","ds-dwt-ui-icon-nextImage-grey"),r.ChangeButtonClass("previousImage","ds-dwt-ui-icon-preImage-grey")),r.updateButtons(),r.__SetCropButtonGrey(!0),r.__SetEraseButtonGrey(!0),r.bMobile)switch(r.cursorStatus){case"rectselect":r.OnSelect();break;case"zoom":r.OnClicktozoomin();break;default:r.OnHand()}else switch(r.cursorStatus){case"hand":r.OnHand();break;case"zoom":r.OnClicktozoomin();break;default:r.OnSelect()}if(e){var n=r._webViewer.GetCurrentIndex();1==r._IfChangedWithinTheEditor&&n!=r.iChangedIndex&&r.ShowDialogForSaveImage(r._webViewer.GetCurrentIndex(),!1)}}}},{key:"__SaveImageInner",value:function(r,n){var i=this;if(-1==i.iChangedIndex&&0==i._IfSaveChangesOutSideOfTheEditor)return i._IfChangedWithinTheEditor=!1,n&&n(),!1;if(1!=i._IfChangedWithinTheEditor&&0==i._IfSaveChangesOutSideOfTheEditor)return alert(e.Lib.product.CustomizableDisplayInfo.errorMessages.imageNotChanged),i._IfChangedWithinTheEditor=!1,n&&n(),!1;i._IfSaveChangesOutSideOfTheEditor&&(i.iChangedIndex=i._webViewer.GetCurrentIndex());var o=!0;if(1==i._IfChangedWithinTheEditor||1==i._IfSaveChangesOutSideOfTheEditor){var a=i.getImageManager().convertClientIndexToServerId(i.iChangedIndex);if(-1==a)return n&&n(),!1;i.OnGetImageFromServerForEdit(i._webViewer._UIView.mapModelImageControl[a],i.iChangedIndex,2,(function(e,o,a){if(e){if(1==r&&(t.log("__SaveImageInner: "+[e.guid].join(",")),i._webViewer.GetCurrentIndex()==o&&(i._stwain._isMobileMode()?i._webViewer.MobileUpdateImage(e,a):i._webViewer.UpdateImage(e,a))),i._IfChangedWithinTheEditor=!1,i.iChangedIndex=-1,-1==e.serverId)return n&&n(),!1}else i._IfChangedWithinTheEditor=!1,i.iChangedIndex=-1;return i.updateButtons(),n&&n(),!0})),o=!1}return i._IfSaveChangesOutSideOfTheEditor=!1,o&&(i._IfChangedWithinTheEditor=!1,n&&n()),!0}},{key:"ShowDialogForSaveImage",value:function(r,n,i,o){var a=this,s=function(){a.__SaveImageInner(!0,(function(){var e=a._stwain._containerID;Fs.DCP_DWT_OnClickCloseInstall(e),t.bChangeImage=1,-1==r?n&&a.OnClose():a._webViewer.__goInner(r),n&&(document.body.style.overflow=""),Rs.isFunction(i)&&i()}))};if(a.promptToSaveChange){var u=['<div class="dynamsoft-dwt-dlg-tips">',"<div>",Bs.saveChangedImage[0],"</div>",'<div style="width: 200px;white-space:nowrap;margin-left: auto;margin-right: auto;">','<input class="dynamsoft_btnSave" style="width: 100px; height:30px; margin-right: 10px; margin-top: 10px;"  type="button" value="',Bs.saveChangedImage[1],'" /><input class="dynamsoft_btnCancel" style="width: 100px; height:30px; margin-top: 10px;"  type="button" value="',Bs.saveChangedImage[2],'" /></div>',"</div>"];a.bMobile?e.DWT.ShowMessage(u.join(""),{width:300,headerStyle:1}):e.DWT.ShowMessage(u.join(""),{width:420,headerStyle:1});var c=t.one(".dynamsoft_btnSave").getEL();c&&(c.onclick=function(){s()});var l=t.one(".dynamsoft_btnCancel").getEL();l&&(l.onclick=function(){a.__RestoreImageInner(r,(function(){var e=a._stwain._containerElement;Fs.DCP_DWT_OnClickCloseInstall(e),t.bChangeImage=0,-1==r?n&&a.OnClose():a._webViewer.__goInner(r),n&&(document.body.style.overflow=""),Rs.isFunction(o)&&o()}))})}else s()}},{key:"__SetCropButtonGrey",value:function(e){this.ChangeButtonClass("crop","ds-dwt-ui-icon-cropImage-grey"),e&&this.clearSelectedAreas()}},{key:"__SetEraseButtonGrey",value:function(e){this.ChangeButtonClass("cut","ds-dwt-ui-icon-erase-grey"),e&&this.clearSelectedAreas()}},{key:"__SetZoomInButtonEnable",value:function(e){1==e?this.ChangeButtonClass("zoomin","ds-dwt-ui-icon-zoomin"):this.ChangeButtonClass("zoomin","ds-dwt-ui-icon-zoomin-grey")}},{key:"__SetZoomOutButtonEnable",value:function(e){1==e?this.ChangeButtonClass("zoomout","ds-dwt-ui-icon-zoomout"):this.ChangeButtonClass("zoomout","ds-dwt-ui-icon-zoomout-grey")}},{key:"pageChange",value:function(n){var i,o=this,a=o._webViewer.GetHowManyImagesInBuffer();if(t.log("OnPagination"),a<=0)Rs.output(o,"No image in Buffer");else if(1!=a){!/^\d+$/.test(n)||n<=0?alert(e.Lib.product.CustomizableDisplayInfo.errorMessages.invalidIndex):((i=r(n)-1)<0?i=0:i>=a&&(i=a-1),i!=o._webViewer.GetCurrentIndex()&&o.go(i))}}},{key:"bufferChanged",value:function(e){var t=this;if(t._currentIndex!=t._webViewer.GetCurrentIndex())return t._currentIndex=t._webViewer.GetCurrentIndex(),t.updateMode(),"shift"!=e.action||1!=t._IfChangedWithinTheEditor||(t.ShowDialogForSaveImage(t._currentIndex,!1),!1)}},{key:"pageRendered",value:function(e){}},{key:"OnFirstImage",value:function(){t.Errors.ClearErrorInfo(this._stwain),this._webViewer.first()}},{key:"OnLastImage",value:function(){t.Errors.ClearErrorInfo(this._stwain),this._webViewer.last()}},{key:"OnPreviousImage",value:function(){var e=this,r=t.one(".ds-dwt-ui-icon-preImage-grey");t.Errors.ClearErrorInfo(e._stwain),e.hideImgEditorDilag(),r&&r.getEL()||e._webViewer.previous()}},{key:"OnNextImage",value:function(){var e=this,r=t.one(".ds-dwt-ui-icon-nextImage-grey");e.hideImgEditorDilag(),t.Errors.ClearErrorInfo(e._stwain),r&&r.getEL()||e._webViewer.next()}},{key:"go",value:function(e){var t=this;if(t._webViewer.GetHowManyImagesInBuffer()<=0||t._webViewer.GetCurrentIndex()<0)return Rs.output(t,"No image in Buffer"),!1;if(1==t._IfChangedWithinTheEditor)return t.ShowDialogForSaveImage(e,!1),!1;if(t.bShowImageEdit&&void 0!==e){if(-1==e)return!1;t.bCouldBeTimeConsuming=!0,t.myImageEditor.gotoPage(e),t.updateMode()}return!0}},{key:"OnAcquire",value:function(){var r=this,n=function(){r._stwain.SelectSource((function(){r._stwain.CloseSource(),r._stwain.OpenSource(),r._stwain.IfShowUI=!0,1==e.DWT.IfConfineMaskWithinTheViewer?(e.DWT.IfConfineMaskWithinTheViewer=!1,r._stwain.AcquireImage({},(function(){e.DWT.IfConfineMaskWithinTheViewer=!0,null==window.onresize&&(window.onresize=function(){r._stwain.ShowImageEditorEx(-1,-1,-1,-1)})}),(function(){null==window.onresize&&(window.onresize=function(){r._stwain.ShowImageEditorEx(-1,-1,-1,-1)})}))):r._stwain.AcquireImage()}),(function(){t.log("User did not select a source")}))};t.Errors.ClearErrorInfo(r._stwain),r.hideImgEditorDilag(),r._IfChangedWithinTheEditor?r.ShowDialogForSaveImage(r._webViewer.GetCurrentIndex(),!1,n,n):n()}},{key:"OnLoadImage",value:function(){var r=this,n=null,i=function(){if(r._stwain._isMobileMode()){var i=document.getElementById(r.dwtMobileFileId);return i.value="",void i.click()}if(r._stwain.IfShowFileDialog=!0,r._stwain.Addon&&r._stwain.Addon.PDF){var o,a=!1;t.License.checkProductKey(r._stwain,{PDFRasterizer:!0},!0)&&(n=r._stwain.Addon.PDF.GetConvertMode(),o=r._stwain._innerFun("GetAddOnVersion",Zn("pdf")),(t.env.bMac&&o==e.DWT.PdfMacVersion||t.env.bLinux&&o==e.DWT.PdfLinuxVersion||o==e.DWT.PdfVersion)&&(a=!0),a&&r._stwain.Addon.PDF.SetConvertMode(3))}r._stwain.LoadImageEx("",5,(function(){t.log("Loaded an image successfully."),null!=n&&r._stwain.Addon.PDF.SetConvertMode(n)}),(function(e,i){t.log("Loading failed with the error: "+i),null!=n&&r._stwain.Addon.PDF.SetConvertMode(n)}))};t.Errors.ClearErrorInfo(r._stwain),r.hideImgEditorDilag(),r._IfChangedWithinTheEditor?r.ShowDialogForSaveImage(r._webViewer.GetCurrentIndex(),!1,i,i):i()}},{key:"OnPrint",value:function(){var e=this;t.Errors.ClearErrorInfo(e._stwain),e.hideImgEditorDilag(),e._webViewer.GetCurrentIndex()<0?Rs.output(e,"No image in Buffer"):e._webViewer._UIView.Print()}},{key:"OnRemoveAll",value:function(){var e=this;t.Errors.ClearErrorInfo(e._stwain),e.hideImgEditorDilag(),e._webViewer.GetHowManyImagesInBuffer()<=0||e._webViewer.GetCurrentIndex()<0?Rs.output(e,"No image in Buffer"):e._stwain.RemoveAllImages()}},{key:"OnRemove",value:function(){var e=this;t.Errors.ClearErrorInfo(e._stwain),e.hideImgEditorDilag(),e._webViewer.GetHowManyImagesInBuffer()<=0||e._webViewer.GetCurrentIndex()<0?Rs.output(e,"No image in Buffer"):e._stwain.RemoveAllSelectedImages()}},{key:"OnRotateLeft",value:function(){var e=this;t.Errors.ClearErrorInfo(e._stwain),e.hideImgEditorDilag(),e._webViewer.GetHowManyImagesInBuffer()<=0||e._webViewer.GetCurrentIndex()<0?Rs.output(e,"No image in Buffer"):(1==e._webViewer._ImgManager.bImageChangedInViewer?(e._IfSaveChangesOutSideOfTheEditor=!0,e._webViewer._ImgManager.bImageChangedInViewer=!1,e.__SaveImageInner(!1,(function(){e.bCouldBeTimeConsuming=!0,ni("",e._stwain),e._webViewer._ImgManager.bImageJustChangedInEditor=!0,e._stwain._isMobileMode()?(e.DVSRotate(270),e.UpdateInfo()):e._stwain.RotateLeft(e._webViewer.GetCurrentIndex()),e._IfChangedWithinTheEditor=!0,e.iChangedIndex=e._webViewer.GetCurrentIndex(),e.updateButtons()}))):(e.bCouldBeTimeConsuming=!0,ni("",e._stwain),e._IfSaveChangesOutSideOfTheEditor=!1,e._webViewer._ImgManager.bImageJustChangedInEditor=!0,e._IfChangedWithinTheEditor=!0,e.iChangedIndex=e._webViewer.GetCurrentIndex(),e._stwain._isMobileMode()?(e.DVSRotate(270),e.UpdateInfo()):e._stwain.RotateLeft(e._webViewer.GetCurrentIndex())),e.updateMode())}},{key:"RotateEx",value:function(t,r,n){var i=this;i._webViewer.GetHowManyImagesInBuffer()<=0||i._webViewer.GetCurrentIndex()<0?Rs.output(i,"No image in Buffer"):(void 0===t||void 0===r||void 0===n?alert(e.Lib.product.CustomizableDisplayInfo.errorMessages.insufficientParas):1==i._webViewer._ImgManager.bImageChangedInViewer?(i._IfSaveChangesOutSideOfTheEditor=!0,i._webViewer._ImgManager.bImageChangedInViewer=!1,i.__SaveImageInner(!1,(function(){i.bCouldBeTimeConsuming=!0,ni("",i._stwain),i._webViewer._ImgManager.bImageJustChangedInEditor=!0,i._stwain._isMobileMode()?(i.DVSRotateEx(t,r,n),i.UpdateInfo()):i._stwain.RotateEx(i._webViewer.GetCurrentIndex(),t,r,n),i._IfChangedWithinTheEditor=!0,i.iChangedIndex=i._webViewer.GetCurrentIndex(),i.updateButtons()}))):(i.bCouldBeTimeConsuming=!0,ni("",i._stwain),i._IfSaveChangesOutSideOfTheEditor=!1,i._webViewer._ImgManager.bImageJustChangedInEditor=!0,i._IfChangedWithinTheEditor=!0,i.iChangedIndex=i._webViewer.GetCurrentIndex(),i._stwain._isMobileMode()?(i.DVSRotateEx(t,r,n),i.UpdateInfo()):i._stwain.RotateEx(i._webViewer.GetCurrentIndex(),t,r,n)),i.updateMode())}},{key:"OnRotate",value:function(n){var i=this;if(t.Errors.ClearErrorInfo(i._stwain),i._webViewer.GetHowManyImagesInBuffer()<=0||i._webViewer.GetCurrentIndex()<0)Rs.output(i,"No image in Buffer");else{if(t.hide("dynamsoft_ImgSizeEditor"),!t.get("dynamsoft_RotateAnyAngle")){var o=['<div id="dynamsoft_RotateAnyAngle" class="dynamsoft-dwt-imgSizeEditor" style="display:none; z-index: 99999;">',"<ul>",'<li><label for="dynamsoft_Angle"><b>',Bs.dlgRotateAnyAngle[0],'</b><input type="text" id="dynamsoft_Angle" style="width:50%;" size="10"/></label></li>','<li><label for="dynamsoft_Angle_InterpolationMethod"><b>',Bs.dlgRotateAnyAngle[1],'</b>&nbsp;<select size="1" id="dynamsoft_Angle_InterpolationMethod"><option value = ""></option></select></li>','<li><label for="dynamsoft_KeepSize"><b></b>','<input type="checkbox" id="dynamsoft_KeepSize"/>',Bs.dlgRotateAnyAngle[2],"</label></li></ul>","<div>",'<input id="dynamsoft_btnRotateAnyAngleOK" type="button" value="',Bs.dlgRotateAnyAngle[3],'"/><span><input id= "dynamsoft_btnCancelRotateAnyAngle" type="button" value="',Bs.dlgRotateAnyAngle[4],'" /></span></div>',"</div>"];t.one("body").append(o.join(""))}var a=t.get("dynamsoft_Angle_InterpolationMethod");a.options.length=0,a.options.add(new Option("NearestNeighbor","1")),a.options.add(new Option("Bilinear","2")),a.options.add(new Option("Bicubic","3")),a=null,t.get("dynamsoft_btnRotateAnyAngleOK").onclick=function(){var n=t.get("dynamsoft_Angle").value;t.get("dynamsoft_Angle").className="";if(!/^\d+$/.test(n)||n<=0)return t.get("dynamsoft_Angle").className+=" invalid",t.get("dynamsoft_Angle").focus(),void alert(e.Lib.product.CustomizableDisplayInfo.errorMessages.invalidAngle);var o=t.get("dynamsoft_KeepSize").checked;i.bCouldBeTimeConsuming=!0,ni("",i._stwain);var a=r(n);i.RotateEx(a,o,t.get("dynamsoft_Angle_InterpolationMethod").selectedIndex+1),0!=i._stwain._errorCode||t.hide("dynamsoft_RotateAnyAngle")},t.get("dynamsoft_btnCancelRotateAnyAngle").onclick=function(){t.hide("dynamsoft_RotateAnyAngle")};var s=t.get("dynamsoft_RotateAnyAngle");t.toggle("dynamsoft_RotateAnyAngle");var u=n.srcElement||n.target,c=u.y;c||(c=u.offsetTop+1);var l=u.x;if(l||(l=u.offsetLeft+1),i.UIEditor&&"DIV"==i.UIEditor.nodeName)s.style.top=n.clientY+document.documentElement.scrollTop+"px",s.style.left=n.clientX+document.documentElement.scrollLeft+"px";else{var d=Ls.getElementById(i.UIEditor);s.style.top=c+u.offsetHeight+Rs.getTop(d)+"px",s.style.left=l+Rs.getLeft(d)+"px"}t.get("dynamsoft_Angle").value="45"}}},{key:"OnRotateRight",value:function(){var e=this;t.Errors.ClearErrorInfo(e._stwain),e.hideImgEditorDilag(),e._webViewer.GetHowManyImagesInBuffer()<=0||e._webViewer.GetCurrentIndex()<0?Rs.output(e,"No image in Buffer"):(1==e._webViewer._ImgManager.bImageChangedInViewer?(e._IfSaveChangesOutSideOfTheEditor=!0,e._webViewer._ImgManager.bImageChangedInViewer=!1,e.__SaveImageInner(!1,(function(){e.bCouldBeTimeConsuming=!0,ni("",e._stwain),e._stwain._isMobileMode()?(e.DVSRotate(90),e.UpdateInfo()):e._stwain.RotateRight(e._webViewer.GetCurrentIndex()),e._webViewer._ImgManager.bImageJustChangedInEditor=!0,e._IfChangedWithinTheEditor=!0,e.iChangedIndex=e._webViewer.GetCurrentIndex(),e.updateButtons()}))):(e.bCouldBeTimeConsuming=!0,ni("",e._stwain),e._IfSaveChangesOutSideOfTheEditor=!1,e._webViewer._ImgManager.bImageJustChangedInEditor=!0,e._IfChangedWithinTheEditor=!0,e.iChangedIndex=e._webViewer.GetCurrentIndex(),e._stwain._isMobileMode()?(e.DVSRotate(90),e.UpdateInfo()):e._stwain.RotateRight(e._webViewer.GetCurrentIndex())),e.updateMode())}},{key:"OnDeskew",value:function(){var e=this;if(t.Errors.ClearErrorInfo(e._stwain),e.hideImgEditorDilag(),e._webViewer.GetHowManyImagesInBuffer()<=0||e._webViewer.GetCurrentIndex()<0)Rs.output(e,"No image in Buffer");else if(1==e._webViewer._ImgManager.bImageChangedInViewer)e._IfSaveChangesOutSideOfTheEditor=!0,e._webViewer._ImgManager.bImageChangedInViewer=!1,e.__SaveImageInner(!1,(function(){if(e.bCouldBeTimeConsuming=!0,ni("",e._stwain),e._webViewer._ImgManager.bImageJustChangedInEditor=!0,e._stwain._isMobileMode())e.DVSSkewAngle();else{var t=e._webViewer.GetCurrentIndex();t>=0&&e._stwain.GetSkewAngleAsync(t).then((function(t){e.RotateEx(t,!0,1)})),e._IfChangedWithinTheEditor=!0,e.iChangedIndex=e._webViewer.GetCurrentIndex(),e.updateButtons()}}));else if(e.bCouldBeTimeConsuming=!0,ni("",e._stwain),e._IfSaveChangesOutSideOfTheEditor=!1,e._webViewer._ImgManager.bImageJustChangedInEditor=!0,e._IfChangedWithinTheEditor=!0,e.iChangedIndex=e._webViewer.GetCurrentIndex(),e._stwain._isMobileMode())e.DVSSkewAngle();else{var r=e._webViewer.GetCurrentIndex();r>=0&&e._stwain.GetSkewAngleAsync(r).then((function(t){e.RotateEx(t,!0,1)}))}}},{key:"OnCrop",value:function(){var e=this;t.Errors.ClearErrorInfo(e._stwain),e.hideImgEditorDilag();var r=t.one(".ds-dwt-ui-icon-cropImage");r&&r.getEL()&&e.Crop()}},{key:"Crop",value:function(){var e=this;if(e._webViewer.GetHowManyImagesInBuffer()<=0||e._webViewer.GetCurrentIndex()<0)Rs.output(e,"No image in Buffer");else{var t=e.actualSelectedCanvasAreas;if(2==t.length){var n=t[1],i=n.left,o=n.top,a=n.right,s=n.bottom;r(i)-r(a)!=0&&r(o)-r(s)!=0&&(1==e._webViewer._ImgManager.bImageChangedInViewer?(e._IfSaveChangesOutSideOfTheEditor=!0,e._webViewer._ImgManager.bImageChangedInViewer=!1,e.__SaveImageInner(!1,(function(){e.bCouldBeTimeConsuming=!0,ni("",e._stwain),e._stwain._isMobileMode()?(e.DVSCrop(r(i),r(o),r(a),r(s)),e.UpdateInfo()):e._stwain.Crop(e._webViewer.GetCurrentIndex(),r(i),r(o),r(a),r(s)),e._webViewer._ImgManager.bImageJustChangedInEditor=!0,e.__SetCropButtonGrey(!0),e.__SetEraseButtonGrey(!0),e._IfChangedWithinTheEditor=!0,e.iChangedIndex=e._webViewer.GetCurrentIndex(),e.updateButtons()}))):(e.bCouldBeTimeConsuming=!0,ni("",e._stwain),e._IfSaveChangesOutSideOfTheEditor=!1,e._webViewer._ImgManager.bImageJustChangedInEditor=!0,e._IfChangedWithinTheEditor=!0,e.iChangedIndex=e._webViewer.GetCurrentIndex(),e._stwain._isMobileMode()?(e.DVSCrop(r(i),r(o),r(a),r(s)),e.UpdateInfo()):e._stwain.Crop(e._webViewer.GetCurrentIndex(),r(i),r(o),r(a),r(s)),e.__SetCropButtonGrey(!0),e.__SetEraseButtonGrey(!0)),e.updateMode())}else Rs.output(e,"No area selected for cropping")}}},{key:"OnErase",value:function(){var e=this,r=t.one(".ds-dwt-ui-icon-erase");t.Errors.ClearErrorInfo(e._stwain),e.hideImgEditorDilag(),r&&r.getEL()&&e.Erase()}},{key:"Erase",value:function(){var e=this,t=!1;if(e._webViewer.GetHowManyImagesInBuffer()<=0||e._webViewer.GetCurrentIndex()<0)Rs.output(e,"No image in Buffer");else{var n=e.actualSelectedCanvasAreas;if(1!=n.length){if(1==e._webViewer._ImgManager.bImageChangedInViewer)e._IfSaveChangesOutSideOfTheEditor=!0,e._webViewer._ImgManager.bImageChangedInViewer=!1,e.__SaveImageInner(!1,(function(){for(var i=1;i<n.length;i++){var o=n[i],a=o.left,s=o.top,u=o.right,c=o.bottom;r(a)-r(u)!=0&&r(s)-r(c)!=0&&(e.bCouldBeTimeConsuming=!0,ni("",e._stwain),e._stwain._isMobileMode()?(e.DVSErase(r(a),r(s),r(u),r(c)),e.UpdateInfo()):e._stwain.CutFrameToClipboard(e._webViewer.GetCurrentIndex(),r(a),r(s),r(u),r(c)),e._webViewer._ImgManager.bImageJustChangedInEditor=!0,e._IfChangedWithinTheEditor=!0,e.iChangedIndex=e._webViewer.GetCurrentIndex(),e.updateButtons(),t=!0)}e.__SetEraseButtonGrey(t),e.__SetCropButtonGrey(t)}));else{e._IfSaveChangesOutSideOfTheEditor=!1,e._IfChangedWithinTheEditor=!0,e.iChangedIndex=e._webViewer.GetCurrentIndex();for(var i=1;i<n.length;i++){var o=n[i],a=o.left,s=o.top,u=o.right,c=o.bottom;r(a)-r(u)!=0&&r(s)-r(c)!=0&&(e.bCouldBeTimeConsuming=!0,ni("",e._stwain),e._stwain._isMobileMode()?(e.DVSErase(r(a),r(s),r(u),r(c)),e.UpdateInfo()):e._stwain.CutFrameToClipboard(e._webViewer.GetCurrentIndex(),r(a),r(s),r(u),r(c)),e._webViewer._ImgManager.bImageJustChangedInEditor=!0,e._IfChangedWithinTheEditor=!0,e.iChangedIndex=e._webViewer.GetCurrentIndex(),t=!0)}e.__SetEraseButtonGrey(t),e.__SetCropButtonGrey(t)}e.updateMode()}else Rs.output(e,"No area selected for erasing")}}},{key:"ChangeImageSize",value:function(e,t,r){var n=this;n._webViewer.GetHowManyImagesInBuffer()<=0||n._webViewer.GetCurrentIndex()<0?Rs.output(n,"No image in Buffer"):(1==n._webViewer._ImgManager.bImageChangedInViewer?(n._IfSaveChangesOutSideOfTheEditor=!0,n._webViewer._ImgManager.bImageChangedInViewer=!1,n.__SaveImageInner(!1,(function(){n.bCouldBeTimeConsuming=!0,ni("",n._stwain),n._webViewer._ImgManager.bImageJustChangedInEditor=!0,n._stwain._isMobileMode()?(n.DVSChangeImageSize(e,t,r),n.UpdateInfo()):n._stwain.ChangeImageSize(n._webViewer.GetCurrentIndex(),e,t,r),n._IfChangedWithinTheEditor=!0,n.iChangedIndex=n._webViewer.GetCurrentIndex(),n.updateButtons()}))):(n.bCouldBeTimeConsuming=!0,ni("",n._stwain),n._IfSaveChangesOutSideOfTheEditor=!1,n._webViewer._ImgManager.bImageJustChangedInEditor=!0,n._IfChangedWithinTheEditor=!0,n.iChangedIndex=n._webViewer.GetCurrentIndex(),n._stwain._isMobileMode()?(n.DVSChangeImageSize(e,t,r),n.UpdateInfo()):n._stwain.ChangeImageSize(n._webViewer.GetCurrentIndex(),e,t,r)),n.updateMode())}},{key:"OnChangeImageSize",value:function(n){var i=this;if(t.Errors.ClearErrorInfo(i._stwain),i.hideImgEditorDilag(),!(i._webViewer.GetHowManyImagesInBuffer()<=0||i._webViewer.GetCurrentIndex()<0)){if(t.hide("dynamsoft_RotateAnyAngle"),!t.get("dynamsoft_ImgSizeEditor")){var o=['<div id="dynamsoft_ImgSizeEditor" class="dynamsoft-dwt-imgSizeEditor" style="display:none;z-index: 99999;">',"<ul>",'<li><label for="dynamsoft_img_height"><b>',Bs.dlgChangeImageSize[0],'</b><input type="text" id="dynamsoft_img_height" style="width:50%;" size="10"/>pixel</label></li>','<li><label for="dynamsoft_img_width"><b>',Bs.dlgChangeImageSize[1],'</b>&nbsp;<input type="text" id="dynamsoft_img_width" style="width:50%;" size="10"/>pixel</label></li>',"<li>",Bs.dlgChangeImageSize[2],'<select size="1" id="dynamsoft_InterpolationMethod"><option value = ""></option></select></li>',"</ul>","<div>",'<input id="dynamsoft_btnChangeImageSizeOK" type="button" value="',Bs.dlgChangeImageSize[3],'"/><span><input id= "dynamsoft_btnCancelChange" type="button" value="',Bs.dlgChangeImageSize[4],'"/></span></div>',"</div>"];t.one("body").append(o.join(""))}var a=t.get("dynamsoft_InterpolationMethod");a.options.length=0,a.options.add(new Option("NearestNeighbor","1")),a.options.add(new Option("Bilinear","2")),a.options.add(new Option("Bicubic","3")),a=null,t.get("dynamsoft_btnChangeImageSizeOK").onclick=function(){var r=t.get("dynamsoft_img_width").value,n=t.get("dynamsoft_img_height").value;t.get("dynamsoft_img_width").className="",t.get("dynamsoft_img_height").className="";var o=/^\d+$/;return!o.test(n)||n<=0?(t.get("dynamsoft_img_height").className+=" invalid",t.get("dynamsoft_img_height").focus(),void alert(e.Lib.product.CustomizableDisplayInfo.errorMessages.invalidHeightOrWidth)):!o.test(r)||r<=0?(t.get("dynamsoft_img_width").className+=" invalid",t.get("dynamsoft_img_width").focus(),void alert(e.Lib.product.CustomizableDisplayInfo.errorMessages.invalidHeightOrWidth)):(i.ChangeImageSize(r,n,t.get("dynamsoft_InterpolationMethod").selectedIndex+1),void(0!=i._stwain._errorCode||t.hide("dynamsoft_ImgSizeEditor")))},t.get("dynamsoft_btnCancelChange").onclick=function(){t.hide("dynamsoft_ImgSizeEditor")};var s=t.get("dynamsoft_ImgSizeEditor");t.toggle("dynamsoft_ImgSizeEditor");var u=n.srcElement||n.target,c=u.y;c||(c=u.offsetTop+1);var l=u.x;if(l||(l=u.offsetLeft+1),i.UIEditor&&"DIV"==i.UIEditor.nodeName)s.style.top=n.clientY+document.documentElement.scrollTop+"px",s.style.left=n.clientX+document.documentElement.scrollLeft+"px";else{var d=Ls.getElementById(i.UIEditor);s.style.top=c+u.offsetHeight+Rs.getTop(d)+"px",s.style.left=l+Rs.getLeft(d)+"px"}var h=i._webViewer.GetCurrentIndex(),g=i.getImageManager().convertClientIndexToServerId(h);if(-1==g)return!1;if(i._webViewer._UIView.mapModelImageControl[g]){if(i._stwain._isMobileMode()){var f,m=0,_=0;(f=i.GetRealTimeMetadataByIndex())&&f.width&&(m=f.width),f&&f.height&&(_=f.height),t.get("dynamsoft_img_width").value=r(m),t.get("dynamsoft_img_height").value=r(_)}else t.get("dynamsoft_img_width").value=r(i.getImageManager().GetImageWidth(h)),t.get("dynamsoft_img_height").value=r(i.getImageManager().GetImageHeight(h));return!0}return!1}Rs.output(i,"No image in Buffer")}},{key:"OnFlip",value:function(){var e=this;t.Errors.ClearErrorInfo(e._stwain),e.hideImgEditorDilag(),e._webViewer.GetHowManyImagesInBuffer()<=0||e._webViewer.GetCurrentIndex()<0?Rs.output(e,"No image in Buffer"):(1==e._webViewer._ImgManager.bImageChangedInViewer?(e._IfSaveChangesOutSideOfTheEditor=!0,e._webViewer._ImgManager.bImageChangedInViewer=!1,e.__SaveImageInner(!1,(function(){e.bCouldBeTimeConsuming=!0,ni("",e._stwain),e._stwain._isMobileMode()?(e.DVSFlip(),e.UpdateInfo()):e._stwain.Flip(e._webViewer.GetCurrentIndex()),e._webViewer._ImgManager.bImageJustChangedInEditor=!0,e._IfChangedWithinTheEditor=!0,e.iChangedIndex=e._webViewer.GetCurrentIndex(),e.updateButtons()}))):(e.bCouldBeTimeConsuming=!0,ni("",e._stwain),e._IfSaveChangesOutSideOfTheEditor=!1,e._webViewer._ImgManager.bImageJustChangedInEditor=!0,e._IfChangedWithinTheEditor=!0,e.iChangedIndex=e._webViewer.GetCurrentIndex(),e._stwain._isMobileMode()?(e.DVSFlip(),e.UpdateInfo()):e._stwain.Flip(e._webViewer.GetCurrentIndex())),e.updateMode())}},{key:"OnMirror",value:function(){var e=this;t.Errors.ClearErrorInfo(e._stwain),e.hideImgEditorDilag(),e._webViewer.GetHowManyImagesInBuffer()<=0||e._webViewer.GetCurrentIndex()<0?Rs.output(e,"No image in Buffer"):(1==e._webViewer._ImgManager.bImageChangedInViewer?(e._IfSaveChangesOutSideOfTheEditor=!0,e._webViewer._ImgManager.bImageChangedInViewer=!1,e.__SaveImageInner(!1,(function(){e.bCouldBeTimeConsuming=!0,ni("",e._stwain),e._stwain._isMobileMode()?(e.DVSMirror(),e.UpdateInfo()):e._stwain.Mirror(e._webViewer.GetCurrentIndex()),e._webViewer._ImgManager.bImageJustChangedInEditor=!0,e._IfChangedWithinTheEditor=!0,e.iChangedIndex=e._webViewer.GetCurrentIndex(),e.updateButtons()}))):(e.bCouldBeTimeConsuming=!0,ni("",e._stwain),e._IfSaveChangesOutSideOfTheEditor=!1,e._webViewer._ImgManager.bImageJustChangedInEditor=!0,e._IfChangedWithinTheEditor=!0,e.iChangedIndex=e._webViewer.GetCurrentIndex(),e._stwain._isMobileMode()?(e.DVSMirror(),e.UpdateInfo()):e._stwain.Mirror(e._webViewer.GetCurrentIndex())),e.updateMode())}},{key:"wheel",value:function(e){var t=this;this.myImageEditor.zoom,this.myImageEditor.maxZoom,this.myImageEditor.zoom<this.myImageEditor.maxZoom?t.__SetZoomInButtonEnable(!0):t.__SetZoomInButtonEnable(!1),this.myImageEditor.zoom>this.myImageEditor.minZoom?t.__SetZoomOutButtonEnable(!0):t.__SetZoomOutButtonEnable(!1)}},{key:"OnZoomin",value:function(){var e=this;e.hideImgEditorDilag();var r=t.one(".ds-dwt-ui-icon-zoomin-grey");r&&r.getEL()||(t.Errors.ClearErrorInfo(e._stwain),e._webViewer.GetHowManyImagesInBuffer()<=0||e._webViewer.GetCurrentIndex()<0?Rs.output(e,"No image in Buffer"):(this.myImageEditor.zoom<this.myImageEditor.maxZoom?(e.ZoomIn(),e.__SetZoomInButtonEnable(!0)):e.__SetZoomInButtonEnable(!1),e.__SetZoomOutButtonEnable(!0),e.__SetCropButtonGrey(!0),e.__SetEraseButtonGrey(!0)))}},{key:"OnOriginalsize",value:function(){var e=this;t.Errors.ClearErrorInfo(e._stwain),e.hideImgEditorDilag(),e._webViewer.GetHowManyImagesInBuffer()<=0||e._webViewer.GetCurrentIndex()<0?Rs.output(e,"No image in Buffer"):(e.SetZoom(1),e.__SetZoomInButtonEnable(!0),e.__SetZoomOutButtonEnable(!0),e.__SetCropButtonGrey(!0),e.__SetEraseButtonGrey(!0))}},{key:"OnZoomout",value:function(){var e=this;e.hideImgEditorDilag();var r=t.one(".ds-dwt-ui-icon-zoomout-grey");r&&r.getEL()||(t.Errors.ClearErrorInfo(e._stwain),e._webViewer.GetHowManyImagesInBuffer()<=0||e._webViewer.GetCurrentIndex()<0?Rs.output(e,"No image in Buffer"):(this.myImageEditor.zoom>this.myImageEditor.minZoom?(e.ZoomOut(),e.__SetZoomOutButtonEnable(!0)):e.__SetZoomOutButtonEnable(!1),e.__SetZoomInButtonEnable(!0),e.__SetCropButtonGrey(!0),e.__SetEraseButtonGrey(!0)))}},{key:"OnFitPage",value:function(){var e=this;t.Errors.ClearErrorInfo(e._stwain),e.hideImgEditorDilag(),e._webViewer.GetHowManyImagesInBuffer()<=0||e._webViewer.GetCurrentIndex()<0?Rs.output(e,"No image in Buffer"):(e.SetFitType(),e.__SetZoomInButtonEnable(!0),e.__SetZoomOutButtonEnable(!0),e.__SetCropButtonGrey(!0),e.__SetEraseButtonGrey(!0))}},{key:"OnFitWidth",value:function(){var e=this;t.Errors.ClearErrorInfo(e._stwain),e.hideImgEditorDilag(),e._webViewer.GetHowManyImagesInBuffer()<=0||e._webViewer.GetCurrentIndex()<0?Rs.output(e,"No image in Buffer"):(e.SetFitType("width"),e.__SetZoomInButtonEnable(!0),e.__SetZoomOutButtonEnable(!0),e.__SetCropButtonGrey(!0),e.__SetEraseButtonGrey(!0))}},{key:"OnFitHeight",value:function(){var e=this;t.Errors.ClearErrorInfo(e._stwain),e.hideImgEditorDilag(),e._webViewer.GetHowManyImagesInBuffer()<=0||e._webViewer.GetCurrentIndex()<0?Rs.output(e,"No image in Buffer"):(e.SetFitType("height"),e.__SetZoomInButtonEnable(!0),e.__SetZoomOutButtonEnable(!0),e.__SetCropButtonGrey(!0),e.__SetEraseButtonGrey(!0))}},{key:"OnHand",value:function(){var e=this,t=x;e.hideImgEditorDilag(),e.clearSelectedAreas(),e.SetMouseSelectInner(t)}},{key:"OnSelect",value:function(){var e=P;this.hideImgEditorDilag(),this.SetMouseSelectInner(e)}},{key:"OnClicktozoomin",value:function(){var e=this,t=W;e.hideImgEditorDilag(),e.clearSelectedAreas(),e.SetMouseSelectInner(t)}},{key:"SetMouseSelectInner",value:function(e){var r=this;if(t.Errors.ClearErrorInfo(r._stwain),r._webViewer.GetHowManyImagesInBuffer()<=0||r._webViewer.GetCurrentIndex()<0)Rs.output(r,"No image in Buffer");else if(r.SetMouseShape(e),r.__EnableMouseShapButtons(e),r.bMobile)switch(e){case P:r.cursorStatus="rectselect";break;case W:r.cursorStatus="zoom";break;default:r.cursorStatus="hand"}else switch(e){case x:r.cursorStatus="hand";break;case W:r.cursorStatus="zoom";break;default:r.cursorStatus="rectselect"}}},{key:"OnRestore",value:function(){var e=this;e.hideImgEditorDilag();var r=t.one(".ds-dwt-ui-icon-saveImage-grey");r&&r.getEL()||(t.Errors.ClearErrorInfo(e._stwain),e._webViewer.GetHowManyImagesInBuffer()<=0||e._webViewer.GetCurrentIndex()<0?Rs.output(e,"No image in Buffer"):(e.__RestoreImageInner(-1),e.clearSelectedAreas()))}},{key:"__RestoreImageInner",value:function(e,r){var n=this;if(-1==n.iChangedIndex)return n._IfChangedWithinTheEditor=!1,void(r&&r());if(n._stwain._isMobileMode())n.Reset(),n._IfChangedWithinTheEditor=!1,n.iChangedIndex=-1,n.updateButtons(),r&&r();else{var i=!0;if(1==n._IfChangedWithinTheEditor){var o=n.getImageManager().convertClientIndexToServerId(n.iChangedIndex);-1!=o&&n.OnGetImageFromServerForEdit(n._webViewer._UIView.mapModelImageControl[o],n.iChangedIndex,1,(function(i,o,a){i&&(t.log("__RestoreImageInner: "+[i.guid].join(",")),n._stwain._isMobileMode()?n._webViewer.MobileUpdateImage(i,a):n._webViewer.UpdateImage(i,a)),n._IfChangedWithinTheEditor=!1,n.iChangedIndex=-1;var s=i&&i.serverId;return-1==s?(n.updateButtons(),r&&r(),!1):(n.updateButtons(),-1==e&&-1==(s=n.getImageManager().convertClientIndexToServerId(n._webViewer.GetCurrentIndex()))?(t.Errors.IndexOutOfRange(n._stwain),r&&r(),!1):void(r&&r()))})),i=!1}i&&(n._IfChangedWithinTheEditor=!1,r&&r())}}},{key:"OnGetImageFromServerForEdit",value:function(n,i,o,a){var s,u=this;if(a&&u._webViewer._UIView.BaseUrl){var c=u.getImageManager().convertClientIndexToServerId(i);if(-1==c)return!1;if(u._stwain._isMobileMode())if(1==o){var l=u._webViewer.GetMetaDataByIndex(i);l&&(l.width=u.BackModelImageControl.width,l.height=u.BackModelImageControl.height,l.bitDepth=u.BackModelImageControl.bitDepth,l.resolutionX=u.BackModelImageControl.resolutionX,l.resolutionY=u.BackModelImageControl.resolutionY),n.ticks=Date.now(),n.imageUrl=u.BackImageBuffer,a(n,i,{metaData:l})}else u.DVSSaveTransformResult(a);else e.DWT.ConnectWithSocket?a():(s=Os.getUrlByAct(u._webViewer._UIView.BaseUrl,c,o),t.ajax({method:"GET",xhrFields:{withCredentials:!0},url:s,onSuccess:function(e){n.ticks=Date.now(),n.imageUrl=Os.getImageUrl(u._webViewer._UIView.BaseUrl,c,-1,-1,n.ticks),n.minImageUrl=Os.getImageUrl(u._webViewer._UIView.BaseUrl,c,r(n.iImageControlWidth),r(n.iImageControlHeight),n.ticks);var t=u._webViewer.GetMetaDataByIndex(i);if(t){var o=u._webViewer._UIView.GetDataImageControl(c);o&&o.width?t.width=o.width:t.width=u._stwain.GetImageWidth(i),o&&o.height?t.height=o.height:t.height=u._stwain.GetImageHeight(i)}a(n,i,t)},onError:function(){}}))}return!0}},{key:"OnSave",value:function(){var e=this;e.hideImgEditorDilag();var r=t.one(".ds-dwt-ui-icon-saveImage-grey");r&&r.getEL()||(t.Errors.ClearErrorInfo(e._stwain),e._webViewer.GetHowManyImagesInBuffer()<=0||e._webViewer.GetCurrentIndex()<0?Rs.output(e,"No image in Buffer"):e.__SaveImageInner(!0,(function(){if(-1==e.getImageManager().convertClientIndexToServerId(e._webViewer.GetCurrentIndex()))return t.Errors.IndexOutOfRange(e._stwain),!1})))}},{key:"OnClose",value:function(){var e=this;return t.Errors.ClearErrorInfo(e._stwain),1==e._IfChangedWithinTheEditor?(e.ShowDialogForSaveImage(-1,!0),!1):e.OnCloseInner()}},{key:"OnCloseInstall",value:function(){if(0==this._IfChangedWithinTheEditor){var e=this._stwain._containerElement;Fs.DCP_DWT_OnClickCloseInstall(e)}}},{key:"Reset",value:function(e){return this.myImageEditor.reset()}},{key:"OnCloseInner",value:function(r){var n,i=this;if(t.Errors.ClearErrorInfo(i._stwain),1==i._IfChangedWithinTheEditor){if(!r)return i.ShowDialogForSaveImage(-1,!0),!1;var o=i._stwain._containerElement;Fs.DCP_DWT_OnClickCloseInstall(o),t.bChangeImage=0,i.__RestoreImageInner(-1)}return i.UIEditor&&1==i.bFullScreen?i.UIEditor&&i.UIEditor.parentNode&&i.UIEditor.childNodes.length>0&&i.UIEditor.parentNode.removeChild(i.UIEditor):i.myImageEditor&&i.myImageEditor.unbindView(i.UIEditor),i.bShowImageEdit=!1,i._webViewer.bShowImageEdit=!1,i.bShowImageEditForFullScreen=!1,i.CloseShowImageEditor(),i.hideImgEditorDilag(),(n=t.get("dynamsoft_ImgSizeEditor"))&&n.parentNode.removeChild(n),(n=t.get("dynamsoft_RotateAnyAngle"))&&n.parentNode.removeChild(n),e.Lib.dialog.selectsourcedlg&&e.Lib.dialog.selectsourcedlg.close(),window.onresize=null,document.body.style.overflow="",t.isFunction(i._stwain.__CloseImageEditorUI)&&i._stwain.__CloseImageEditorUI(),i.disposeInner()}},{key:"__EnableMouseShapButtons",value:function(e){var t=this;t.ChangeButtonClass("hand","ds-dwt-ui-icon-hand"),t.ChangeButtonClass("select","ds-dwt-ui-icon-select"),t.ChangeButtonClass("clicktozoomin","ds-dwt-ui-icon-clicktozoomin"),e==x?t.ChangeButtonClass("hand","dynamsoft-dwt-EditorButton-selected"):e==P?t.ChangeButtonClass("select","dynamsoft-dwt-EditorButton-selected"):e==W&&t.ChangeButtonClass("clicktozoomin","dynamsoft-dwt-EditorButton-selected")}},{key:"click",value:function(e){var t=this;t.hideImgEditorDilag(),this.myImageEditor.zoom<this.myImageEditor.maxZoom?t.__SetZoomInButtonEnable(!0):t.__SetZoomInButtonEnable(!1),t.__SetZoomOutButtonEnable(!0)}},{key:"hideImgEditorDilag",value:function(){t.hide("dynamsoft_ImgSizeEditor"),t.hide("dynamsoft_RotateAnyAngle")}},{key:"imageClick",value:function(e,t){this.UpdateInfo()}},{key:"pageAreaSelected",value:function(e,t){var n=this,i=1;if(t&&t.length>0){var o=t[t.length-1];o.index&&(i=r(o.index)+1),i>0&&i<n.actualSelectedCanvasAreas.length?n.actualSelectedCanvasAreas[i]={left:o.x,top:o.y,right:o.x+o.width,bottom:o.y+o.height}:i==n.actualSelectedCanvasAreas.length&&n.actualSelectedCanvasAreas.push({left:o.x,top:o.y,right:o.x+o.width,bottom:o.y+o.height}),2==n.actualSelectedCanvasAreas.length&&o.width>0&&o.height>0?(n.ChangeButtonClass("crop","ds-dwt-ui-icon-cropImage"),n.ChangeButtonClass("cut","ds-dwt-ui-icon-erase")):(n.__SetCropButtonGrey(!1),n.__SetEraseButtonGrey(!1))}}},{key:"pageAreaUnselected",value:function(e){var t=this;t.actualSelectedCanvasAreas=[{left:0,top:0,right:0,bottom:0}],t.ChangeButtonClass("crop","ds-dwt-ui-icon-cropImage-grey"),t.ChangeButtonClass("cut","ds-dwt-ui-icon-erase-grey")}},{key:"onDrop",value:function(e){this._webViewer.dropEvent(e)}},{key:"getImageManager",value:function(){return this._webViewer._ImgManager}}]),n}();t.UI.ImageEditorInner=Us;var Gs=function(){function e(t,r){Le(this,e),this._imageEditorInner=new Us(t,r),this.myImageEditor=this._imageEditorInner.myImageEditor}return Ae(e,[{key:"show",value:function(){return this._imageEditorInner.show()}},{key:"hide",value:function(){return this._imageEditorInner.hide()}},{key:"dispose",value:function(){return this._imageEditorInner.dispose()}}]),e}();function js(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}t.UI.ImageEditor=Gs;var zs={showThumbnail:!1,location:"horizontal",sequence:-1,size:"30%",columns:1,rows:3,scrollDirection:"vertical",pageMargin:10,border:"",allowKeyboardControl:!0,allowPageDragging:!0,allowResizing:!1,pageBackground:_s,pageBorder:ps,hoverPageBackground:vs,hoverPageBorder:ys,placeholderBackground:bs,autoChangeIndex:!1},Hs=new WeakSet,Xs=function(){function r(n,i){Le(this,r),js(this,Hs);var o=this;if(o._webViewer=n,i){if(i.location)switch(i.location){case"left":default:i.location="horizontal",i.sequence=-1;break;case"right":i.location="horizontal",i.sequence=1;break;case"top":i.location="vertical",i.sequence=-1;break;case"bottom":i.location="vertical",i.sequence=1}else i.location="horizontal",i.sequence=-1;t.isUndefined(i.size)&&(i.size=zs.size),t.isUndefined(i.columns)&&(i.columns=zs.columns),t.isUndefined(i.rows)&&(i.rows=zs.rows),(t.isUndefined(i.scrollDirection)||"horizontal"!=i.scrollDirection)&&(i.scrollDirection=zs.scrollDirection),t.isUndefined(i.pageMargin)&&(i.pageMargin=zs.pageMargin),t.isUndefined(i.allowKeyboardControl)&&(i.allowKeyboardControl=zs.allowKeyboardControl),t.isUndefined(i.allowPageDragging)&&(i.allowPageDragging=zs.allowPageDragging),t.isUndefined(i.allowResizing)&&(i.allowResizing=zs.allowResizing),t.isUndefined(i.border)&&(i.border=zs.border),t.isUndefined(i.pageBackground)&&(i.pageBackground=zs.pageBackground),t.isUndefined(i.pageBorder)&&(i.pageBorder=zs.pageBorder),t.isUndefined(i.hoverPageBackground)&&(i.hoverPageBackground=zs.hoverPageBackground),t.isUndefined(i.hoverPageBorder)&&(i.hoverPageBorder=zs.hoverPageBorder),t.isUndefined(i.placeholderBackground)&&(i.placeholderBackground=zs.placeholderBackground),t.isUndefined(i.autoChangeIndex)&&(i.autoChangeIndex=zs.autoChangeIndex)}else i=e.Lib.clone(zs);if(t.isUndefined(i.background)&&(i.background=o._webViewer.GetBackground()),t.isUndefined(i.pageNumber)&&(i.pageNumber=o._webViewer.GetPageNumberStyle()),t.isUndefined(i.checkbox)&&(i.checkbox=o._webViewer.GetCheckboxStyle()),t.isUndefined(i.multiSelectMode)&&(i.multiSelectMode=o._webViewer.GetMultiSelectMode()==Z),t.isUndefined(i.selectedPageBorder)){var a=o._webViewer.GetSelectedPageBorder();t.isUndef(a)?i.selectedPageBorder=zs.selectedPageBorder:i.selectedPageBorder=a}if(t.isUndefined(i.selectedPageBackground)){var s=o._webViewer.GetSelectedPageBackground();t.isUndef(s)?i.selectedPageBackground=zs.selectedPageBackground:i.selectedPageBackground=s}i.showThumbnail=!1,o.myThumbnailViewer=o._webViewer.myViewer.createThumbnailView(i),0!=o._webViewer.mydvs.Error.errorCode&&t.Errors.WebviewerError(o._webViewer._stwain,o._webViewer.mydvs.Error.errorMessage,o._webViewer.mydvs.Error.errorCode),function(e,t,r){if(!t.has(e));return r}(this,Hs,Ys).call(this),o.bDispose=!1,o._webViewer.bThumbnailDispose=!1}return Ae(r,[{key:"show",value:function(){var e=this;return!!e._webViewer._NouiNotSupport("show")&&(e.myThumbnailViewer?(e._webViewer.myViewer.setViewMode(1,1),e._webViewer.SetIfSinglePageMode(!0),e.myThumbnailViewer.showThumbnail=!0,!0):(e.bDispose?t.Errors.ThumbnailViewerDispose(e._webViewer._stwain):t.Errors.ThumbnailViewerNotExist(e._webViewer._stwain),!1))}},{key:"hide",value:function(){var e=this;return!!e._webViewer._NouiNotSupport("hide")&&(e.myThumbnailViewer?(e.myThumbnailViewer.showThumbnail=!1,!0):(e.bDispose?t.Errors.ThumbnailViewerDispose(e._webViewer._stwain):t.Errors.ThumbnailViewerNotExist(e._webViewer._stwain),!1))}},{key:"dispose",value:function(){var e,t=this;return!!t.bDispose||((e=t._webViewer.myViewer.removeThumbnailView(t.myThumbnailViewer))&&(t.bDispose=!0,t._webViewer._thumbnailViewer=undefined,t._webViewer.myThumbnailViewer=undefined,t.myThumbnailViewer=undefined,t._webViewer.bThumbnailDispose=!0),e)}},{key:"updateViewMode",value:function(e){var r=this;if(!r.myThumbnailViewer)return r.bDispose?t.Errors.ThumbnailViewerDispose(r._webViewer._stwain):t.Errors.ThumbnailViewerNotExist(r._webViewer._stwain),!1;if(e&&e.columns&&e.rows){if(e.columns<0||e.rows<0)return t.Errors.InvalidPropertyValue(r._webViewer._stwain),!1;r.myThumbnailViewer.showThumbnail=!1,r.myThumbnailViewer.setViewMode(e.columns,e.rows),!e.scrollDirection||"horizontal"!=e.scrollDirection&&"vertical"!=e.scrollDirection||(r.myThumbnailViewer.scrollDirection=e.scrollDirection),r.myThumbnailViewer.showThumbnail=!0}return!0}},{key:"updateCheckboxStyle",value:function(e){var r=this;return r.myThumbnailViewer?(r.myThumbnailViewer.checkbox=e,!0):(r.bDispose?t.Errors.ThumbnailViewerDispose(r._webViewer._stwain):t.Errors.ThumbnailViewerNotExist(r._webViewer._stwain),!1)}},{key:"updatePageNumberStyle",value:function(e){var r=this;return r.myThumbnailViewer?(r.myThumbnailViewer.pageNumber=e,!0):(r.bDispose?t.Errors.ThumbnailViewerDispose(r._webViewer._stwain):t.Errors.ThumbnailViewerNotExist(r._webViewer._stwain),!1)}},{key:"on",value:function(e,r){if(e){if(!t.isFunction(r))return void t.Errors.CallbackNotAFunction(this._webViewer._stwain);this.myThumbnailViewer.on(e,r)}}},{key:"off",value:function(e,r){var n=this;if(e)if(t.isUndefined(r))n.myThumbnailViewer.off(e),"click"==e&&n.myThumbnailViewer.on("click",(function(e,t){n._webViewer.UpdateInfo(!0,!1,!0)}));else{if(!t.isFunction(r))return void t.Errors.CallbackNotAFunction(n._webViewer._stwain);n.myThumbnailViewer.off(e,r)}}}]),r}();function Ys(){var e=this;cs(e,"location",{get:function(){return e._webViewer.GetThumLocation()},set:function(t){return e._webViewer.SetThumLocation(t)}}),cs(e,"size",{get:function(){return e._webViewer.GetThumSize()},set:function(t){return e._webViewer.SetThumSize(t)}}),cs(e,"scrollDirection",{get:function(){return e._webViewer.GetThumScrollDirection()},set:function(t){return e._webViewer.SetThumScrollDirection(t)}}),cs(e,"showPageNumber",{get:function(){return e._webViewer.GetThumShowPageNumber()},set:function(t){return e._webViewer.SetThumShowPageNumber(t)}}),cs(e,"showCheckbox",{get:function(){return e._webViewer.GetThumShowCheckbox()},set:function(t){return e._webViewer.SetThumShowCheckbox(t)}}),cs(e,"pageMargin",{get:function(){return e._webViewer.GetThumMargin()},set:function(t){return e._webViewer.SetThumMargin(t)}}),cs(e,"border",{get:function(){return e._webViewer.GetThumBorder()},set:function(t){return e._webViewer.SetThumBorder(t)}}),cs(e,"background",{get:function(){return e._webViewer.GetThumBackground()},set:function(t){return e._webViewer.SetThumBackground(t)}}),cs(e,"pageBackground",{get:function(){return e._webViewer.GetThumPageBackground()},set:function(t){return e._webViewer.SetThumPageBackground(t)}}),cs(e,"pageBorder",{get:function(){return e._webViewer.GetThumPageBorder()},set:function(t){return e._webViewer.SetThumPageBorder(t)}}),cs(e,"hoverPageBackground",{get:function(){return e._webViewer.GetThumHoverBackground()},set:function(t){return e._webViewer.SetThumHoverBackground(t)}}),cs(e,"hoverPageBorder",{get:function(){return e._webViewer.GetThumHoverBorder()},set:function(t){return e._webViewer.SetThumHoverBorder(t)}}),cs(e,"placeholderBackground",{get:function(){return e._webViewer.GetThumPlaceholderBackground()},set:function(t){return e._webViewer.SetThumPlaceholderBackground(t)}}),cs(e,"selectedPageBorder",{get:function(){return e._webViewer.GetThumSelectedPageBorder()},set:function(t){return e._webViewer.SetThumSelectedPageBorder(t)}}),cs(e,"selectedPageBackground",{get:function(){return e._webViewer.GetThumSelectedPageBackground()},set:function(t){return e._webViewer.SetThumSelectedPageBackground(t)}}),cs(e,"allowKeyboardControl",{get:function(){return e._webViewer.GetThumAllowKeyboardControl()},set:function(t){return e._webViewer.SetThumAllowKeyboardControl(t)}}),cs(e,"allowPageDragging",{get:function(){return e._webViewer.GetThumAllowDrag()},set:function(t){return e._webViewer.SetThumAllowDrag(t)}}),cs(e,"allowResizing",{get:function(){return e._webViewer.GetThumAllowResize()},set:function(t){return e._webViewer.SetThumAllowResize(t)}}),cs(e,"autoChangeIndex",{get:function(){return e._webViewer.GetThumAutoChangeIndex()},set:function(t){return e._webViewer.SetThumAutoChangeIndex(t)}})}t.UI.ThumbnailViewer=Xs;var Js="dvsDb",Ks="dvsDoc",Zs=function(){function e(t,r){if(Le(this,e),this._db=t.DataControl._db,r)this.syncDb={};else{var n=this._db.DBMng._d;n[Js]||(n[Js]={}),n[Js][Ks]||(n[Js][Ks]={}),this.syncDb=n[Js][Ks]}}return Ae(e,[{key:"setCustomDataSync",value:function(e,t){return this.syncDb[e].customData=t,!0}},{key:"getCustomDataSync",value:function(e){return this.syncDb[e]||(this.syncDb[e]={}),this.syncDb[e].customData||(this.syncDb[e].customData={}),this.syncDb[e].customData}},{key:"getOriDataSync",value:function(e){return this.syncDb[e]||(this.syncDb[e]={}),this.syncDb[e].oriData}},{key:"getMetaDataSync",value:function(e){return this._db.getMetadata(e)}},{key:"dispose",value:function(){this._db=null,this.syncDb=null}}]),e}(),qs=function(){function e(t){Le(this,e),this._fileTree=t._tree}return Ae(e,[{key:"createFile",value:function(e){return this._fileTree.createFile(e)}},{key:"openFile",value:function(e){var t=this._fileTree.findChild(this._fileTree.dfNode,e);return t&&"file"===t.type?t.chs.slice():[]}},{key:"findFile",value:function(e){if(this._fileTree.dfNode){var t=this._fileTree.findChild(this._fileTree.dfNode,e);if(t&&"file"===t.type)return t}return null}},{key:"replaceFileContent",value:function(e,t){var r=this.findFile(e);r&&(r.chs.splice(0),r.chs=t)}},{key:"getFileCount",value:function(e){var t=this.findFile(e);return t?t.chs.length:0}},{key:"getIndexByUidInFile",value:function(e,t){var r=this.findFile(e);if(r)for(var n=r.chs.length,i=0;i<n;i++)if(r.chs[i]==t)return i;return-1}},{key:"removeByIndexInFile",value:function(e,t){var r=this.findFile(e);if(r){var n=r.chs.length;if(t>=0&&t<n)return r.chs.splice(t,1),!0}return!1}},{key:"dispose",value:function(){this._fileTree=null}}]),e}(),Qs=function(){return new e.ImageProc},$s=e.navInfoSync.bMac||e.navInfoSync.biPhone||e.navInfoSync.biPad;function eu(e,r,n,i,o){var a;return a=Qs(),t.log("[Wasm]camera callback: area detect"),a.initImage(e.imageData,e.rgba,e.imageWidth,e.imageHeight,e.bgra).then((function(e){return t.log("[Wasm]camera callback: image is ready"),a.src=e.srcBuffer,a.detectDocument(o,r,n,i)})).then((function(e){return t.log("[Wasm]camera callback: area detect successfully"),e.src=a.src,a.terminate(),a.src=null,e}),(function(e){t.closeLoadingMsg(),t.log("[Wasm]camera callback: area detect failed"),a.terminate();var r={};throw e&&e.code&&e.message?(r._errorString=e.message,r._errorCode=e.code):(r._errorString=e,t.Errors.DetectCallbackErr(r)),{code:r._errorCode,message:r._errorString}}))}function tu(r,n){var i=Qs();if(t.log("[Wasm]camera callback: perspective"),!t.isArray(n)||8!=n.length){var o={};return t.Errors.InvalidParameterInCallback(o),t.Promise.reject({code:o._errorCode,message:o._errorString})}return i.initImage(r.imageData,r.rgba,r.imageWidth,r.imageHeight,r.bgra).then((function(e){return t.log("[Wasm]camera callback: image is ready"),i.src=e.srcBuffer,i.perspective(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7])})).then((function(){t.log("[Wasm]camera callback: perspective successfully");var n=undefined,o=r.imageXResolution,a=r.imageYResolution,s=e.Enum_ImageType.IT_JPG;r.imageBitDepth<=8&&(n=r.imageBitDepth,s=e.Enum_ImageType.IT_PNG);var u=$s;return i.getImage(85,!0,!1,n,o,a,!0,s,u)})).then((function(e){t.log("[Wasm]camera callback: filter process successfully");var r=i.src;return i.terminate(),i.src=null,{src:r,result:e}}),(function(e){t.log("[Wasm]camera callback: filter process failed"),t.closeLoadingMsg(),i.terminate();var r={};throw e&&e.code&&e.message?(r._errorString=e.message,r._errorCode=e.code):(r._errorString=e,t.Errors.PerspectiveCallback(r)),{code:r._errorCode,message:r._errorString}}))}function ru(r,n){var i=Qs();return t.log("[Wasm]camera callback: convert to gray scale filter"),i.initImage(r.imageData,r.rgba,r.imageWidth,r.imageHeight,r.bgra).then((function(e){var r;return t.log("[Wasm]camera callback: image is ready"),i.src=e.srcBuffer,n&&(r=n.level),i.toGrayscale(r)})).then((function(){t.log("[Wasm]camera callback: gray scale successfully");var n=undefined,o=r.imageXResolution,a=r.imageYResolution,s=e.Enum_ImageType.IT_JPG;r.imageBitDepth<=8&&(n=r.imageBitDepth,s=e.Enum_ImageType.IT_PNG);var u=$s;return i.getImage(85,!0,!1,n,o,a,!0,s,u)})).then((function(e){t.log("[Wasm]camera callback: filter process successfully");var r=i.src;return i.terminate(),i.src=null,{src:r,result:e}}),(function(e){t.log("[Wasm]camera callback: filter process failed"),t.closeLoadingMsg(),i.terminate();var r={};throw t.Errors.ConvertToGrayScaleFilterCallbackErr(r,e),{code:r._errorCode,message:r._errorString}}))}function nu(e,t){return iu(e,t,!0)}function iu(r,n,i){var o=Qs();return i?t.log("[Wasm]camera callback: save toner filter"):t.log("[Wasm]camera callback: convert to BW scale filter"),o.initImage(r.imageData,r.rgba,r.imageWidth,r.imageHeight,r.bgra).then((function(e){t.log("[Wasm]camera callback: image is ready"),o.src=e.srcBuffer;var r,a=!!i;return n&&(r=n.level),o.toBinary(a,r)})).then((function(){var t=r.imageXResolution,n=r.imageYResolution,i=$s;return o.getImage(85,!0,!1,1,t,n,!0,e.Enum_ImageType.IT_PNG,i)})).then((function(e){t.log("[Wasm]camera callback: filter process successfully");var r=o.src;return o.terminate(),o.src=null,{src:r,result:e}}),(function(e){t.log("[Wasm]camera callback: filter process failed"),t.closeLoadingMsg(),o.terminate();var r={};throw i?t.Errors.SaveTonerCallbackErr(r,e):t.Errors.ConvertToBWScaleFilterCallbackErr(r,e),{code:r._errorCode,message:r._errorString}}))}function ou(r,n){var i=Qs();return t.log("[Wasm]camera callback: remove shadow filter"),i.initImage(r.imageData,r.rgba,r.imageWidth,r.imageHeight,r.bgra).then((function(e){var r,o;return t.log("[Wasm]camera callback: image is ready"),n&&(r=n.level,o=n.alpha),i.src=e.srcBuffer,i.removeShadow(r,o)})).then((function(){var t=undefined,n=r.imageXResolution,o=r.imageYResolution,a=e.Enum_ImageType.IT_JPG;r.imageBitDepth<=8&&(t=r.imageBitDepth,a=e.Enum_ImageType.IT_PNG);var s=$s;return i.getImage(85,!0,!1,t,n,o,!0,a,s)})).then((function(e){t.log("[Wasm]camera callback: remove shadow successfully");var r=i.src;return i.terminate(),i.src=null,{src:r,result:e}}),(function(e){t.log("[Wasm]camera callback: remove shadow failed"),t.closeLoadingMsg(),i.terminate();var r={};throw t.Errors.RemoveShadowFilterCallbackErr(r,e),{code:r._errorCode,message:r._errorString}}))}function au(r,n){var i=Qs();return t.log("[Wasm]camera callback: brighten filter"),i.initImage(r.imageData,r.rgba,r.imageWidth,r.imageHeight,r.bgra).then((function(e){var r;return t.log("[Wasm]camera callback: image is ready"),i.src=e.srcBuffer,n&&(r=n.level),i.brighten(r)})).then((function(){var t=undefined,n=r.imageXResolution,o=r.imageYResolution,a=e.Enum_ImageType.IT_JPG;r.imageBitDepth<=8&&(t=r.imageBitDepth,a=e.Enum_ImageType.IT_PNG);var s=$s;return i.getImage(85,!0,!1,t,n,o,!0,a,s)})).then((function(e){t.log("[Wasm]camera callback: brighten successfully");var r=i.src;return i.terminate(),i.src=null,{src:r,result:e}}),(function(e){t.log("[Wasm]camera callback: brighten failed"),t.closeLoadingMsg(),i.terminate();var r={};throw t.Errors.BrightenFilterCallbackErr(r,e),{code:r._errorCode,message:r._errorString}}))}function su(){}var uu=document;e.DWT;var cu=["topPageChanged","click","rightclick","dblclick","mousemove","pageAreaSelected","pageAreaUnselected","dragdone","onDrop","bufferChanged","pageChange"],lu={toolbars:{header:!1,topMenu:!1,asideMenu:!1,bottomMenu:!1},groups:{},buttons:{},thumbnail:{showThumbnailControl:!1,size:"30%",columns:1,rows:3,scrollDirection:"vertical",pageMargin:10,allowKeyboardControl:!0,allowPageDragging:!0,allowResizing:!1,border:"",background:ms,pageBackground:_s,pageBorder:ps,hoverPageBackground:vs,hoverPageBorder:ys,placeholderBackground:bs,selectedPageBorder:Is,selectedPageBackground:ws,autoChangeIndex:!1,checkbox:Ss,pageNumber:Ts},canvasConfig:{canvasMouseShape:"crosshair",canvasBackground:ms,canvasBorder:"",selectedPageBorder:Is,pageBorder:ps,pageMargin:10,pageBackground:_s,selectedPageBackground:ws,hoverPageBorder:ys,hoverPageBackground:vs,placeholderBackground:bs,autoChangeIndex:!1,allowPageDragging:!0,columns:1,rows:1,scrollDirection:"vertical",checkbox:Ss,pageNumber:Ts},showSidebar:!1,showMain:!0,showViewer:!0,sidebarWidth:"180",outerBorder:"1px solid rgb(204, 204, 204)",topMenuBorder:"",selectedAreaBorderColor:"rgb(42, 29, 43)",selectionRectAspectRatio:0,ifAutoScroll:!0,useOuterDrop:!0,allowSlide:!0},du={background:"#434246",topMenuBorder:"",innerBorder:"",promptToSaveChange:!0,buttons:e.Lib.product.CustomizableDisplayInfo.buttons,dialogText:e.Lib.product.CustomizableDisplayInfo.dialogText};e.Lib.product.CustomizableDisplayInfo.buttons,e.Lib.product.CustomizableDisplayInfo.dialogText;var hu={scannerViewer:{headerStyle:{background:"#000000",color:"#ffffff",selectedColor:"#fe8e14"},bodyStyle:{background:"#ffffff ",loaderBarSource:""},footerStyle:{background:"#000000",color:"#ffffff",selectedColor:"#fe8e14"},fullScreen:!1,enableBorderDetection:!0,polygonStyle:{stroke:"#fe8e14",strokeWidth:"2px",dash:"solid "},scanButtonStyle:{background:"#fe8e14",color:"#ffffff"},resolution:{visibility:"visible",valueList:[{label:"720P",value:{width:1280,height:720}},{label:"1080P",value:{width:1920,height:1080}},{label:"2K",value:{width:2560,height:1440}},{label:"4K",value:{width:3840,height:2160}}],defaultValue:{width:1280,height:720}},autoScan:{visibility:"visible",enableAutoScan:!1},autoDetect:{visibility:"visible",enableAutoDetect:!1,acceptedPolygonConfidence:80,fpsLimit:3,acceptedBlurryScore:0,autoCaptureDelay:1e3},continuousScan:!0,switchCamera:{visibility:"visible"},loadLocalFile:{visibility:"visible"},funcConfirmExit:e.funcConfirmExit},documentEditorSettings:{visibility:"visible",defaultViewerName:"CropViewer",headerStyle:{background:"#000000",color:"#ffffff",selectedColor:"#fe8e14",disabledColor:"#808080"},bodyStyle:{background:"#ffffff ",loaderBarSource:""},footerStyle:{background:"#000000",color:"#ffffff",selectedColor:"#fe8e14"},insert:{visibility:"visible",position:"before"},remove:{visibility:"visible",funcConfirmRemove:e.funcConfirmRemove},rotateLeft:{visibility:"visible"},filter:{visibility:"visible",valueList:[{label:"Original",value:"original",option:{level:1}},{label:"B&W",value:"blackAndWhite",option:{level:1}},{label:"Grayscale",value:"grayscale",option:{level:1}},{label:"Clean",value:"clean",option:{level:1}},{label:"Brightening",value:"brightening",option:{level:1}},{label:"Save Toner",value:"saveToner",option:{level:1}}],defaultValue:"original",applyToAll:{visibility:"visible",enableApplyToAll:!1,label:"Apply to all"}},crop:{visibility:"visible"},cropViewer:{visibility:"visible",polygonStyle:{stroke:"#fe8e14",strokeWidth:"2px",dash:"solid "},rotateLeft:{visibility:"visible"},rotateRight:{visibility:"visible"},autoDetectBorder:{visibility:"visible"},funcConfirmExit:e.funcConfirmCropViewerExit},funcConfirmExit:e.funcConfirmMainViewerExit,funcConfirmExitAfterSave:e.funcConfirmExitAfterSave}},gu={isFunction:function(e){return e&&"function"==typeof e},addClass:function(e,r){var n=t.one(e);n&&n.length>0&&n.addClass(r)},removeClass:function(e,r){var n=t.one(e);n&&n.length>0&&n.removeClass(r)},output:function(r,n){e.DWT.Debug&&t.log(n)},getTop:function(e){var t=e.offsetTop;return null!=e.offsetParent&&(t+=gu.getTop(e.offsetParent)),t},getLeft:function(e){var t=e.offsetLeft;return null!=e.offsetParent&&(t+=gu.getLeft(e.offsetParent)),t}};t._safePromptCustomMsg((function(){du.buttons=e.Lib.product.CustomizableDisplayInfo.buttons,du.dialogText=e.Lib.product.CustomizableDisplayInfo.dialogText}));var fu=function(){function r(t,n,i){Le(this,r),Ye(this,"_bFireSync",!0);var o=this;o._ImgManager=t,o._stwain=t._stwain,o._UIView=i,o._currentTag="",o.bShowImageEdit=!1,o.acceptDrop=!0,o.currentFileName=fs,o._documentScanConfiguration="",o.ifWebviewerInit=!1,o._Init(n),e.funcConfirmExit&&e.Lib.isFunction(e.funcConfirmExit)&&(hu.scannerViewer.funcConfirmExit=e.funcConfirmExit),e.funcConfirmRemove&&e.Lib.isFunction(e.funcConfirmRemove)&&(hu.documentEditorSettings.remove.funcConfirmRemove=e.funcConfirmRemove),e.funcConfirmMainViewerExit&&e.Lib.isFunction(e.funcConfirmMainViewerExit)&&(hu.documentEditorSettings.funcConfirmExit=e.funcConfirmMainViewerExit),e.funcConfirmExitAfterSave&&e.Lib.isFunction(e.funcConfirmExitAfterSave)&&(hu.documentEditorSettings.funcConfirmExitAfterSave=e.funcConfirmExitAfterSave),e.funcConfirmCropViewerExit&&e.Lib.isFunction(e.funcConfirmCropViewerExit)&&(hu.documentEditorSettings.cropViewer.funcConfirmExit=e.funcConfirmCropViewerExit),o._globalScanConfiguration_ScannViewer=e.Lib.clone(hu),o._globalScanConfiguration=e.Lib.clone(hu),o._globalScanConfiguration.documentEditorSettings.defaultViewerName="mainViewer",hs&&e.DWT.UseDefaultViewer&&(o._stwain._viewer=new hs(o,t))}var n;return Ae(r,[{key:"dispose",value:function(){var e=this;e.containerElement=null,e.myViewer&&(e.myViewer.off("bufferChanged"),e.mydvs.ViewControl.removeViewer(e.myViewer),e.myViewer=null),e.mydvs&&(e.mydvs.dispose(),e.mydvs=null),e._dvsWrapper&&(e._dvsWrapper.dispose(),e._dvsWrapper=null),e._fileWrapper&&(e._fileWrapper.dispose(),e._fileWrapper=null),e.myccvs&&(e.myccvs.dispose(),e.myccvs=null),e.mydocEditManager&&(e.mydocEditManager.dispose(),e.mydocEditManager=null),e._UIView=null,e._ImgManager=null,e._stwain._viewer&&(e._stwain._viewer.dispose(),e._stwain._viewer=null),e._stwain=null}},{key:"_Init",value:function(r){var n,i=this;if(r.Container&&(t.isNodeList(r.Container)||t.isArray(r.Container)&&r.Container.length>0)){var o=r.Container[0];o?((n=document.createElement("div")).style.width="100%",n.style.height="100%",o.appendChild(n),i.containerElement=o):i.containerElement=""}else i.containerElement="";if(i.mydvs)""!=i.containerElement&&(i.BindView(i.containerElement),i.show());else{i.initWidth=r.Width,i.initHeight=r.Height;var a=lu;a.width=i.initWidth,a.height=i.initHeight,i._stwain._isPC()||(a.canvasConfig.canvasMouseShape="pointer");var s=!0;i._stwain._bRemoteMode&&(s=!1),i.mydvs=new e.ViewModel({uiConfig:a,displayMode:"continuous",fitType:"window",scrollerConfig:{},autoCreateOffScreenCanvas:s}),i._dvsWrapper=new Zs(i.mydvs),i._fileWrapper=new qs(i.mydvs.File),i._bindViewUi=!1,i.myViewer=i.mydvs.ViewControl.getViewerByUid(),e.DWT.UseDefaultViewer&&i.containerElement&&i.mydvs.ViewControl&&(i.mydvs.ViewControl.bindViewUiConstructor(e.ViewUi),i.myViewer.bindView(n),i._bindViewUi=!0),i.myViewer&&(i._stwain._isPC()?i.SetOperationMode(1):i.SetOperationMode(0)),i.containerElement&&i._InitDVS(),i._bindEvent=!1,i._bindViewUi?(i._BindViewerEvents(),i._bindEvent=!0):i.myViewer.on("bufferChanged",(function(e,t){i.bufferChanged(e,t)})),i._bRegistedLoad=!1}}},{key:"BindView",value:function(r){var n,i,o,a,s=this;return s.OnCloseImageEditor(),a=(i=r&&"DIV"==r.nodeName?r:uu.getElementById(r)).id,t.isString(a)||(i.id=t.getRandom(),a=i.id),t.isUndefined(i)||t.isNull(i)?o=i:((o=document.createElement("div")).style.width="100%",o.style.height="100%",i.appendChild(o)),0==s._bindViewUi&&s.mydvs.ViewControl&&(s.mydvs.ViewControl.bindViewUiConstructor(e.ViewUi),t.html5.ui.initProgress(s._stwain),s._bindViewUi=!0),t.isUndefined(s.myViewer.width)&&(""!=i.style.width?s.initWidth=i.style.width:i.clientWidth>0?s.initWidth=i.clientWidth:i.offsetWidth>0?s.initWidth=i.offsetWidth:i.scrollWidth>0?s.initWidth=i.scrollWidth:s.initWidth=100),t.isUndefined(s.myViewer.height)&&(""!=i.style.height?s.initHeight=i.style.height:i.clientHeight>0?s.initHeight=i.clientHeight:i.offsetHeight>0?s.initHeight=i.offsetHeight:i.scrollHeight>0?s.initHeight=i.scrollHeight:s.initHeight=100),(n=s.myViewer.bindView(o))?(s.myViewer.showViewer=!1,s.containerElement=i,s._stwain._containerElement=i,s._stwain._containerID=a,s._stwain._bBindViewer=!0,s._InitDVS(),s.SetAcceptDrop(!0),s.SetAllowSlide(!0),s.myViewer.off("bufferChanged"),s.resetUISettingsInner(!1,s.GetWidth(),s.GetHeight()),s._bindEvent||s._BindViewerEvents(),s.hide(),n):(t.Errors.WebviewerError(s._stwain,s.mydvs.Error.errorMessage,s.mydvs.Error.errorCode),!1)}},{key:"CreateTemplate",value:function(e,t){var r=this;return r._stwain.Template=new ks(r,r._ImgManager,t),r._stwain.Template}},{key:"BindTemplate",value:function(e,t){var r=!1;return t&&t._documentTemplate&&(r=t._documentTemplate.BindView(e)),r}},{key:"show",value:function(){var e=this;if(!e._NouiNotSupport("show"))return!1;if(e._stwain.Template&&e._stwain.Template._documentTemplate){e._stwain.Template._documentTemplate.ifShowDocumentTemplate(!0);var t=document.getElementById("btnCapture"+e.myViewer.postfix);t&&(t.style.display="")}return e.myViewer.showViewer=!0,!0}},{key:"hide",value:function(){var e=this;if(!e._NouiNotSupport("hide"))return!1;if(e._stwain.Template&&e._stwain.Template._documentTemplate){e._stwain.Template._documentTemplate.ifShowDocumentTemplate(!1);var t=document.getElementById("btnCapture"+e.myViewer.postfix);t&&(t.style.display="none")}return e.myViewer.showViewer=!1,!0}},{key:"UnbindView",value:function(){var e,r=this;if(r._stwain&&r._stwain.Addon&&r._stwain.Addon.Camera&&r._stwain.Addon.Camera._viewer&&""!=r._stwain.Addon.Camera.getStatus()&&r._stwain.Addon.Camera.closeSource(),e=r.myViewer.unbindView()){if(r._bindViewUi=!1,r._UnbindViewerEvents(),r._bindEvent=!1,r._imageEditor&&r._imageEditor.dispose(),r._documentEditor&&r._documentEditor.dispose(),r._thumbnailViewer&&r._thumbnailViewer.dispose(),r._customElement&&r._customElement.dispose(),r.closeVideo(),r.containerElement&&r.containerElement.childNodes&&r.containerElement.childNodes.length>0)if(1==r.containerElement.childNodes.length)r.containerElement&&0==r.containerElement.childNodes[0].childNodes.length&&r.containerElement.removeChild(r.containerElement.childNodes[0]);else for(var n=r.containerElement.childNodes.length-1;n>=0;n--)r.containerElement&&r.containerElement.removeChild(r.containerElement.childNodes[n]);r.containerElement=""}else t.Errors.WebviewerError(r._stwain,r.mydvs.Error.errorMessage,r.mydvs.Error.errorCode);return r._stwain._bBindViewer=!1,e}},{key:"SetUIView",value:function(e){this._UIView=e}},{key:"_BindViewerEvents",value:function(){var e=this;e.myViewer&&(e.myViewer.off("bufferChanged"),t.each(cu,(function(t){e.myViewer.on(t,(function(r,n){e[t](r,n)}))})))}},{key:"_UnbindViewerEvents",value:function(){var e=this;t.each(cu,(function(t){"bufferChanged"!=t&&e.myViewer.off(t)}))}},{key:"_InitDVS",value:function(){var e=this;e.ifWebviewerInit=!0,e.myViewer.showHeader=!1,e.myViewer.showTopMenu=!1,e.myViewer.showFooter=!1,e.myViewer.showMain=!0,e.myViewer.bOnlyShowThumbnailsView=!1,e.myViewer.showThumbnailControl=!1,e.myViewer.showLatestPage=!0,e.myViewer.minZoom=e._UIView.MIN_ZOOM,e.myViewer.maxZoom=e._UIView.MAX_ZOOM}},{key:"ShowImageEditor",value:function(e,t,r,n){var i=this;return e&&r&&n?(du.element=e,du.width=r,du.height=n):(du.element=undefined,du.width=undefined,du.height=undefined),du.border=i.GetBorder(),du.selectionRectAspectRatio=i.GetSelectionRectAspectRatio(),i.createImageEditor(du),0!=i._stwain._errorCode&&(i._imageEditor.dispose(),i.createImageEditor(du)),i._imageEditor.show(),!0}},{key:"OnCloseImageEditor",value:function(){var e=this;return!!e.bShowImageEdit&&(e._imageEditor&&e._imageEditor.dispose(),e.bShowImageEdit=!1,e._imageEditor=undefined,e._imageEditorInner=undefined,!0)}},{key:"GetUidByIndex",value:function(e){var r=this;return e<0||e>=r.GetHowManyImagesInBuffer()?(t.Errors.IndexOutOfRange(r._stwain),-1):r.myViewer.getUidByIndex(e)}},{key:"GetIndexByUid",value:function(e){return e&&""!=e&&-1!=e?this.myViewer.getIndexByUid(e):(t.Errors.IndexOutOfRange(this._stwain),-1)}},{key:"SetMetaDataByIndex",value:function(e,r){var n=this;if(!(e<0||e>=n.GetHowManyImagesInBuffer()))return n.myViewer.setMetadataByIndex(e,r);t.Errors.IndexOutOfRange(n._stwain)}},{key:"GetMetaDataByIndex",value:function(e){var r=this;if(!(e<0||e>=r.GetHowManyImagesInBuffer()))return r.myViewer.getMetadataByIndex(e);t.Errors.IndexOutOfRange(r._stwain)}},{key:"GetCustomDataByIndex",value:function(e){var r,n=this;if(!(e<0||e>=n.GetHowManyImagesInBuffer()))return r=t.isArray(e)?e[0]:e,n.myViewer.getCustomDataByIndex(r);t.Errors.IndexOutOfRange(n._stwain)}},{key:"GetHowManyImagesInBuffer",value:function(){return t.isUndefined(this.myViewer.currentPageCount)?0:this.myViewer.currentPageCount}},{key:"UpdateInfo",value:function(t,r,n){var i=this;r&&e.Lib.hideMask(),t&&i.bShowImageEdit&&i._imageEditorInner&&i._imageEditorInner.updateMode(n)}},{key:"AppendImage",value:function(e,r){var n,i,o=this,a=e.imageUrl,s=e.minImageUrl,u=e.serverId,c=e.bAppendImage,l=e.index,d={},h=o.currentFileName;if(r&&(t.isUndef(r.currentFileName)||(h=r.currentFileName,t.log("metaDataObj.currentFileName:"+r.currentFileName)),t.isUndef(r.width)||(d.width=r.width),t.isUndef(r.height)||(d.height=r.height),t.isUndef(r.bitDepth)||(d.bitDepth=r.bitDepth),t.isUndef(r.resolutionX)||(d.resolutionX=r.resolutionX),t.isUndef(r.resolutionY)||(d.resolutionY=r.resolutionY),t.isUndef(r.oriBlobData)||(i=r.oriBlobData)),0==o.ifFileNameExist(h))return!1;if(t.log("AppendImage_oriData:"+a),c||0==c&&0==o.GetHowManyImagesInBuffer()){if(i){var g,f={imageId:u};for(g in i)i.hasOwnProperty(g)&&(f[g]=i[g]);n=o.mydvs.DataControl.appendSync(h,[{oriData:a,minData:s,metadata:d,customData:f}])}else n=o.mydvs.DataControl.appendSync(h,[{oriData:a,minData:s,metadata:d,customData:{imageId:u}}]);return e.uuid=n[0],o.UpdateInfo(!0),n[0]}return n=o.mydvs.DataControl.insertSync(h,[{oriData:a,minData:s,metadata:d,customData:{imageId:u}}],l),e.uuid=n[0],o.UpdateInfo(!0),n[0]}},{key:"MobileAppendImage",value:function(e,r){var n,i=this,o=e.bAppendImage,a=e.index,s={},u=i.currentFileName;return r.imageId=e.serverId,r&&r.currentFileName&&(u=r.currentFileName),0!=i.ifFileNameExist(u)&&(r&&r.metadata&&(t.isUndef(r.metadata.width)||(s.width=r.metadata.width),t.isUndef(r.metadata.imageWidth)||(s.width=r.metadata.imageWidth),t.isUndef(r.metadata.height)||(s.height=r.metadata.height),t.isUndef(r.metadata.imageHeight)||(s.height=r.metadata.imageHeight),t.isUndef(r.metadata.bitDepth)||(s.bitDepth=r.metadata.bitDepth),t.isUndef(r.metadata.imageBitDepth)||(s.bitDepth=r.metadata.imageBitDepth),t.isUndef(r.metadata.resolutionX)||(s.resolutionX=r.metadata.resolutionX),t.isUndef(r.metadata.imageXResolution)||(s.resolutionX=r.metadata.imageXResolution),t.isUndef(r.metadata.resolutionY)||(s.resolutionY=r.metadata.resolutionY),t.isUndef(r.metadata.imageYResolution)||(s.resolutionY=r.metadata.imageYResolution),t.isUndef(r.metadata.oriBlobData)||(s.oriBlobData=r.metadata.oriBlobData),delete r.metadata),"url"!=r.dataType&&"srcId"in r?0==o&&0==i.GetHowManyImagesInBuffer()?(n=i.mydvs.DataControl.appendSync(u,[{oriData:null,minData:null,metadata:s,customData:r}]),e.uuid=n[0],i.UpdateInfo(!0),n[0]):(n=i.mydvs.DataControl.insertSync(u,[{oriData:null,minData:null,metadata:s,customData:r}],a),e.uuid=n[0],i.UpdateInfo(!0),n[0]):("src"in r&&(e.imageUrl=r.src,delete r.src),"imageUrl"in r&&(e.imageUrl=r.imageUrl,delete r.imageUrl),s.currentFileName=u,i.AppendImage(e,s)))}},{key:"UpdateImage",value:function(e,r){var n=this,i=e.imageUrl,o=e.minImageUrl,a=e.serverId,s=e.uuid,u={};return r&&(t.isUndef(r.width)||(u.width=r.width),t.isUndef(r.height)||(u.height=r.height),t.isUndef(r.bitDepth)||(u.bitDepth=r.bitDepth),t.isUndef(r.resolutionX)||(u.resolutionX=r.resolutionX),t.isUndef(r.resolutionY)||(u.resolutionY=r.resolutionY)),s&&""!=s&&-1!=s?(n._UpdateImageInner(s,{oriData:i,minData:o,customData:{imageId:a},metadata:u}),n.UpdateInfo(!1,!0),s):(t.Errors.IndexOutOfRange(n._stwain),!1)}},{key:"MobileUpdateImage",value:function(e,r){var n=this,i=e.index,o=e.uuid,a={},s={};if(!o||""==o||-1==o)return t.Errors.IndexOutOfRange(n._stwain),!1;if((a=n.GetMetaDataByIndex(i))&&"metadata"in r&&r.metadata&&(t.isUndef(r.metadata.width)||(a.width=r.metadata.width),t.isUndef(r.metadata.imageWidth)||(a.width=r.metadata.imageWidth),t.isUndef(r.metadata.height)||(a.height=r.metadata.height),t.isUndef(r.metadata.imageHeight)||(a.height=r.metadata.imageHeight),t.isUndef(r.metadata.bitDepth)||(a.bitDepth=r.metadata.bitDepth),t.isUndef(r.metadata.imageBitDepth)||(a.bitDepth=r.metadata.imageBitDepth),t.isUndef(r.metadata.resolutionX)||(a.resolutionX=r.metadata.resolutionX),t.isUndef(r.metadata.imageXResolution)||(a.resolutionX=r.metadata.imageXResolution),t.isUndef(r.metadata.resolutionY)||(a.resolutionY=r.metadata.resolutionY),t.isUndef(r.metadata.imageYResolution)||(a.resolutionY=r.metadata.imageYResolution)),"url"==r.dataType||!("srcId"in r))return"src"in r&&(e.imageUrl=r.src),"imageUrl"in r&&(e.imageUrl=r.imageUrl),n.UpdateImage(e,a);if(r&&r.src&&r.srcId){if(s=n.myViewer.getCustomDataByIndex(i)){s.src=r.src,s.srcId=r.srcId,t.isUndef(r.imgType)||(s.imgType=r.imgType);var u={};s&&(u.customData=s,u.metadata=a,n._UpdateImageInner(o,u))}n.UpdateInfo(!1,!0)}return o}},{key:"_UpdateImageInner",value:function(e,t){this.mydvs.DataControl.updateSync(e,t)}},{key:"RemoveByIndex",value:function(e){var r,n=this;if(e<0||e>=n.GetHowManyImagesInBuffer())return t.Errors.IndexOutOfRange(n._stwain),!1;n.bShowImageEdit&&n._imageEditorInner&&1==n._imageEditorInner._IfChangedWithinTheEditor&&(n._imageEditorInner.iChangedIndex!=e?n._imageEditorInner.iChangedIndex>e&&n._imageEditorInner.iChangedIndex--:(n._imageEditorInner._IfChangedWithinTheEditor=!1,n._imageEditorInner.iChangedIndex=-1,n._imageEditorInner.OnCloseInstall())),e==this.GetCurrentIndex()&&n.clearSelectedAreas();var i=[];return i.push(e),(r=n.myViewer.removeSync(i))?n.UpdateInfo(!0):t.Errors.WebviewerError(n._stwain,n.mydvs.Error.errorMessage,n.mydvs.Error.errorCode),r}},{key:"RemoveAllImages",value:function(){var e,r=this;return r.bShowImageEdit&&r._imageEditorInner&&1==r._imageEditorInner._IfChangedWithinTheEditor&&(r._imageEditorInner._IfChangedWithinTheEditor=!1,r._imageEditorInner.iChangedIndex=-1,r._imageEditorInner.OnCloseInstall()),r._bBindViewer&&r.clearSelectedAreas(),(e=r.myViewer.removeAllSync())?(r.UpdateInfo(),r.bShowImageEdit&&r._imageEditorInner&&r._imageEditorInner.updateMode()):t.Errors.WebviewerError(r._stwain,r.mydvs.Error.errorMessage,r.mydvs.Error.errorCode),e}},{key:"SetCurrentIndex",value:function(r){var n,i=this;if(r<0||r>=i.GetHowManyImagesInBuffer())return t.Errors.IndexOutOfRange(i._stwain),e.Lib.hideMask(),!1;return!/^(\d+)$/.test(r)||r<0?(t.Errors.MobileServer_InvalidIndex(i._stwain),e.Lib.hideMask(),!1):((n=i.myViewer.setCurrentIndex(r))||t.Errors.WebviewerError(i._stwain,i.mydvs.Error.errorMessage,i.mydvs.Error.errorCode),i.UpdateInfo(!0,!0),n)}},{key:"OnlySetCurrentIndex",value:function(e){var r,n=this;return e<0||e>=n.GetHowManyImagesInBuffer()?(t.Errors.IndexOutOfRange(n._stwain),!1):((r=n.myViewer.setCurrentIndex(e))||t.Errors.WebviewerError(n._stwain,n.mydvs.Error.errorMessage,n.mydvs.Error.errorCode),r)}},{key:"GetCurrentIndex",value:function(){var e=this,r=-1;return e.GetHowManyImagesInBuffer()>0&&(r=e.myViewer.getCurrentIndex(),(t.isUndef(r)||r<0)&&t.Errors.WebviewerError(e._stwain,e.mydvs.Error.errorMessage,e.mydvs.Error.errorCode)),r}},{key:"SetSelectedindexes",value:function(e){var r,n=this;return(r=n.myViewer.setSelectedIndexes(e))||t.Errors.WebviewerError(n._stwain,n.mydvs.Error.errorMessage,n.mydvs.Error.errorCode),r}},{key:"GetSelectedindexes",value:function(){return this.myViewer.getSelectedIndexes()}},{key:"GoToPage",value:function(r){var n,i=this;if(r<0||r>=i.GetHowManyImagesInBuffer())return t.Errors.IndexOutOfRange(i._stwain),e.Lib.hideMask(),-1;return!/^(\d+)$/.test(r)||r<0?(t.Errors.MobileServer_InvalidIndex(i._stwain),e.Lib.hideMask(),-1):((n=i.myViewer.gotoPage(r))<0&&t.Errors.WebviewerError(i._stwain,i.mydvs.Error.errorMessage,i.mydvs.Error.errorCode),i.UpdateInfo(!0,!0),n)}},{key:"SetSelectedImageArea",value:function(e,r,n,i){var o,a=this,s=[];if(!a._NouiNotSupport("setSelectedAreas"))return!1;var u={};return u.left=e,u.top=r,u.width=n-e,u.height=i-r,s.push(u),(o=a.myViewer.setSelectedBoxes(s,!1))||t.Errors.WebviewerError(a._stwain,a.mydvs.Error.errorMessage,a.mydvs.Error.errorCode),o}},{key:"SetSelectionRectAspectRatio",value:function(e){return!!this._NouiNotSupport("selectionRectAspectRatio")&&(this.myViewer.selectionBoxAspectRatio=e,!0)}},{key:"GetSelectionRectAspectRatio",value:function(){return this._NouiNotSupport("selectionRectAspectRatio")?this.myViewer.selectionBoxAspectRatio:""}},{key:"ZoomIn",value:function(){var e,r=this;return(e=r.myViewer.zoomIn())||t.Errors.WebviewerError(r._stwain,r.mydvs.Error.errorMessage,r.mydvs.Error.errorCode),e}},{key:"ZoomOut",value:function(){var e,r=this;return(e=r.myViewer.zoomOut())||t.Errors.WebviewerError(r._stwain,r.mydvs.Error.errorMessage,r.mydvs.Error.errorCode),e}},{key:"SetZoom",value:function(e,r,n){var i=this,o=!1;return!!i._NouiNotSupport("zoom")&&((o=r&n?i.myViewer.zoomTo(e,r,n):i.myViewer.zoom=e)||t.Errors.WebviewerError(i._stwain,i.mydvs.Error.errorMessage,i.mydvs.Error.errorCode),o)}},{key:"GetZoom",value:function(){return this._NouiNotSupport("zoom")?this.myViewer.zoom:""}},{key:"SetFitType",value:function(e){var r=this,n="window";if(!r._NouiNotSupport("fitType"))return!1;if(!t.isUndefined(e)){if("width"!=e&&"height"!=e&&"window"!=e)return t.Errors.InvalidValue(r._stwain),!1;n=e}return r.myViewer.fitType=n,!0}},{key:"GetMouseShape",value:function(){var e;switch(this.GetCursor()){case"default":e=k;break;case"pointer":e=x;break;case"crosshair":default:e=P;break;case"zoom-in":e=W}return e}},{key:"SetMouseShape",value:function(e){var t;switch(e){case k:t="default";break;case x:t="pointer";break;case P:t="crosshair";break;case W:t="zoom-in";break;default:t="crosshair"}return this.SetCursor(t),!0}},{key:"SetImageMargin",value:function(e){return this.SetPageMargin(e)}},{key:"GetImageMargin",value:function(){return this.GetPageMargin()}},{key:"SetSelectionImageBorderColor",value:function(t){var r=t;return e.Lib.isNumber(r)&&(r=e.Lib.getColor(r)),-1==r.indexOf("1px solid")&&(r="1px solid "+r),this.SetSelectedPageBorder(r)}},{key:"GetSelectedPageBorder",value:function(){return this._NouiNotSupport("selectedPageBorder")?this.myViewer.selectedPageBorder:""}},{key:"SetSelectedPageBorder",value:function(e){var t=this;return!!t._NouiNotSupport("selectedPageBorder")&&(t.myViewer.selectedPageBorder=e,t._thumbnailViewer&&t.SetThumSelectedPageBorder(e),!0)}},{key:"GetSelectedPageBackground",value:function(){return this._NouiNotSupport("selectedPageBackground")?this.myViewer.selectedPageBackground:""}},{key:"SetSelectedPageBackgroundInner",value:function(e){return this.myViewer.selectedPageBackground=e,!0}},{key:"SetSelectedPageBackground",value:function(e){var t=this;return!!t._NouiNotSupport("selectedPageBackground")&&(t.SetSelectedPageBackgroundInner(e),t._thumbnailViewer&&t.SetThumSelectedPageBackground(e),!0)}},{key:"GetShowPageNumber",value:function(){return this._NouiNotSupport("showPageNumber")?"visible"==this.myViewer.pageNumber.visibility:""}},{key:"SetShowPageNumberInner",value:function(e){var t={visibility:"hidden"};return e&&(t.visibility="visible"),this.UpdatePageNumberStyle(t),!0}},{key:"SetShowPageNumber",value:function(e){var r=this;if(!r._NouiNotSupport("showPageNumber"))return!1;if(!t.isBoolean(e))return t.Errors.InvalidValue(r._stwain),!1;var n={visibility:"hidden"};return e&&(n.visibility="visible"),r.UpdatePageNumberStyle(n),r._thumbnailViewer&&r.UpdateThumPageNumberStyle(n),!0}},{key:"UpdatePageNumberStyle",value:function(e){var t=this;return!!t._NouiNotSupport("updatePageNumberStyle")&&(t.myViewer.pageNumber=e,t._thumbnailViewer&&t.UpdateThumPageNumberStyle(e),!0)}},{key:"GetPageNumberStyle",value:function(){return!!this._NouiNotSupport("getPageNumberStyle")&&this.myViewer.pageNumber}},{key:"GetAutoChangeIndex",value:function(){return this._NouiNotSupport("autoChangeIndex")?this.myViewer.autoChangeIndex:""}},{key:"SetAutoChangeIndex",value:function(e){var r=this;return!!r._NouiNotSupport("autoChangeIndex")&&(t.isBoolean(e)?(r.myViewer.autoChangeIndex=e,!0):(t.Errors.InvalidValue(r._stwain),!1))}},{key:"GetShowCheckbox",value:function(){return this._NouiNotSupport("checkbox")?"visible"==this.myViewer.checkbox.visibility:0}},{key:"SetShowCheckbox",value:function(e){var t=this;if(!t._NouiNotSupport("checkbox"))return!1;var r={visibility:"hidden"};return e&&(r.visibility="visible"),t.myViewer.checkbox=r,"visible"==r.visibility?t.SetMultiSelectMode(Z):t.SetMultiSelectMode(K),t._thumbnailViewer&&(t.UpdateThumCheckboxStyle(r),"visible"==r.visibility?t.SetThumMultiSelectMode(Z):t.SetThumMultiSelectMode(K)),!0}},{key:"GetCheckboxStyle",value:function(){return!!this._NouiNotSupport("getCheckboxStyle")&&this.myViewer.checkbox}},{key:"UpdateCheckboxStyle",value:function(e){var t=this;return!!t._NouiNotSupport("updateCheckboxStyle")&&(t.myViewer.checkbox=e,t._thumbnailViewer&&t.UpdateThumCheckboxStyle(e),!0)}},{key:"GetMultiSelectMode",value:function(){return this._NouiNotSupport("multiSelectMode")?this.myViewer.multiSelectMode?Z:K:0}},{key:"SetMultiSelectMode",value:function(e){var r=this;return!!r._NouiNotSupport("multiSelectMode")&&(t.isNumber(e)?(r.myViewer.multiSelectMode=e==Z,r._thumbnailViewer&&r.SetThumMultiSelectMode(e),!0):(t.Errors.InvalidValue(r._stwain),!1))}},{key:"SetHoverPageBackground",value:function(e){return this.myViewer.hoverPageBackground=e,!0}},{key:"SetBackground",value:function(t){var r=this,n=t;return!!r._NouiNotSupport("background")&&(e.Lib.isNumber(n)&&(n=e.Lib.getColor(n)),r.myViewer.canvasBackground=n,r._thumbnailViewer&&r.SetThumBackground(n),!0)}},{key:"GetBackground",value:function(){return this._NouiNotSupport("background")?this.myViewer.canvasBackground:""}},{key:"SetViewerBorder",value:function(e){var t="1px solid"+e;return this.SetBorder(t)}},{key:"SetWidth",value:function(e){var r=this;if(!r._NouiNotSupport("width"))return!1;return!/^((\d+em)|(\d+px)|(\d+%)|(\d+))$/.test(e)||e<=0?(t.Errors.MobileServer_InvalidWidth(r._stwain),!1):(r.myViewer.width=e,!0)}},{key:"GetWidthInner",value:function(){return this.myViewer.width}},{key:"GetWidth",value:function(){return this._NouiNotSupport("width")?this.GetWidthInner():""}},{key:"SetWidthInner",value:function(e,r){var n=this;if(r)n.myViewer.width=e;else if(t.isString(e)&&e.indexOf("%")>=0){var i=n._stwain._containerElement;n.myViewer.width=Math.floor(t.css(i,"width")*parseInt(e)/100)}else n.myViewer.width=e;return!0}},{key:"GetHeightInner",value:function(){return this.myViewer.height}},{key:"GetHeight",value:function(){return this._NouiNotSupport("height")?this.GetHeightInner():""}},{key:"SetHeight",value:function(e){var r=this;if(!r._NouiNotSupport("height"))return!1;return!/^((\d+em)|(\d+px)|(\d+%)|(\d+))$/.test(e)||e<=0?(t.Errors.MobileServer_InvalidHeight(r._stwain),!1):(r.myViewer.height=e,!0)}},{key:"GetIdPostfix",value:function(){return this._NouiNotSupport("idPostfix")?this.myViewer.postfix:""}},{key:"SetHeightInner",value:function(e,r){var n=this;if(r)n.myViewer.height=e;else if(t.isString(e)&&e.indexOf("%")>=0){var i=n._stwain._containerElement;n.myViewer.height=Math.floor(t.css(i,"height")*parseInt(e)/100)}else n.myViewer.height=e;return!0}},{key:"SwitchImage",value:function(e,r){var n,i=this;return e<0||e>=i.GetHowManyImagesInBuffer()||r<0||r>=i.GetHowManyImagesInBuffer()?(t.Errors.IndexOutOfRange(i._stwain),!1):((n=i.myViewer.switchPage(e,r))||t.Errors.WebviewerError(i._stwain,i.mydvs.Error.errorMessage,i.mydvs.Error.errorCode),n)}},{key:"MoveImage",value:function(e,r){var n,i=this;return e<0||e>=i.GetHowManyImagesInBuffer()||r<0||r>=i.GetHowManyImagesInBuffer()?(t.Errors.IndexOutOfRange(i._stwain),!1):((n=i.myViewer.movePage(e,r))||t.Errors.WebviewerError(i._stwain,i.mydvs.Error.errorMessage,i.mydvs.Error.errorCode),n)}},{key:"SetIfSinglePageMode",value:function(e){var t=this;return!!t._NouiNotSupport("singlePageMode")&&(t.myViewer.displayMode=e?"single":"continuous",!0)}},{key:"GetIfSinglePageMode",value:function(){return!!this._NouiNotSupport("singlePageMode")&&"continuous"!=this.myViewer.displayMode}},{key:"SetAcceptDrop",value:function(e){var r=this;return!!r._NouiNotSupport("acceptDrop")&&(t.isBoolean(e)?(r.acceptDrop=e,!0):(t.Errors.InvalidValue(r._stwain),!1))}},{key:"GetAcceptDrop",value:function(){return this._NouiNotSupport("acceptDrop")?this.acceptDrop:""}},{key:"SetAllowSlide",value:function(e){var r=this;return!!r._NouiNotSupport("allowSlide")&&(t.isBoolean(e)?(r.myViewer.allowSlide=e,!0):(t.Errors.InvalidValue(r._stwain),!1))}},{key:"GetAllowSlide",value:function(){return this._NouiNotSupport("allowSlide")?this.myViewer.allowSlide:""}},{key:"SetViewMode",value:function(e,r){var n=this,i=!1,o="vertical";return!!n._NouiNotSupport("setViewMode")&&(t.isNumber(e)&&t.isNumber(r)?(n._thumbnailViewer&&n._thumbnailViewer.hide(),n.clearSelectedAreas(),-1==e&&-1==r?(n.SetIfSinglePageMode(!0),r=0-r,e=0-e,i=!0):(r<0&&(o="horizontal",r=0-r),e<0&&(e=0-e),n.myViewer.scrollDirection=o,(i=n.myViewer.setViewMode(e,r))||t.Errors.WebviewerError(n._stwain,n.mydvs.Error.errorMessage,n.mydvs.Error.errorCode),n.SetIfSinglePageMode(!1),"zoom-in"==n.GetCursor()&&n.SetCursor("crosshair")),i):(t.Errors.InvalidValue(n._stwain),!1))}},{key:"RemoveImageTag",value:function(e){var r,n=this,i=!1;return e<0||e>=n.GetHowManyImagesInBuffer()?(t.Errors.IndexOutOfRange(n._stwain),!1):(r=n.GetUidByIndex(e))&&""!=r&&-1!=r?((i=n.mydvs.Tag.removePageTag(r))||t.Errors.WebviewerError(n._stwain,n.mydvs.Error.errorMessage,n.mydvs.Error.errorCode),i):(t.Errors.WebviewerError(n._stwain,n.mydvs.Error.errorMessage,n.mydvs.Error.errorCode),!1)}},{key:"FilterImagesByTag",value:function(e,r,n){var i=this;if(t.isUndefined(e)||null==e||0==e.length){i._currentTag="";var o=i.GetCurrentFileName();0==o.length&&(o=fs),i.mydvs.File.openFile(o,i.myViewer.uid)?(i.mydvs.Tag.setDefaultTag(""),t.isFunction(r)&&r()):(t.Errors.WebviewerError(i._stwain,i.mydvs.Error.errorMessage,i.mydvs.Error.errorCode),t.isFunction(n)&&n(i.mydvs.Error.errorCode,i.mydvs.Error.errorMessage))}else i._currentTag=e,i.mydvs.Tag.openTag(e,i.myViewer.uid)?t.isFunction(r)&&r():(t.Errors.WebviewerError(i._stwain,i.mydvs.Error.errorMessage,i.mydvs.Error.errorCode),t.isFunction(n)&&n(i.mydvs.Error.errorCode,i.mydvs.Error.errorMessage));return!0}},{key:"ClearFilter",value:function(){var e=this,r=!1;e._currentTag="";var n=e.GetCurrentFileName();return 0==n.length&&(n=fs),(r=e.mydvs.File.openFile(n,e.myViewer.uid))?r=!0:t.Errors.WebviewerError(e._stwain,e.mydvs.Error.errorMessage,e.mydvs.Error.errorCode),r}},{key:"GetServerIdList",value:function(){var e,r,n,i=this,o=[];if(e=i.myViewer.getCurrentPageUids())for(var a=0;a<e.length;a++)(r=e[a])&&(n=i.myViewer.getCustomDataByUid(r))&&o.push(n.imageId);else t.Errors.WebviewerError(i._stwain,i.mydvs.Error.errorMessage,i.mydvs.Error.errorCode);return o}},{key:"GetTagContents",value:function(e){var r=this,n=!1;return(n=e&&e.length>0?r.mydvs.Tag.getTagContents(e):r.myViewer.getCurrentPageUids())||t.Errors.WebviewerError(r._stwain,r.mydvs.Error.errorMessage,r.mydvs.Error.errorCode),n}},{key:"SetDefaultTag",value:function(e){var r,n=this;return n._currentTag=e,n.mydvs.Tag.addTag(e),(r=n.mydvs.Tag.setDefaultTag(e))||t.Errors.WebviewerError(n._stwain,n.mydvs.Error.errorMessage,n.mydvs.Error.errorCode),r}},{key:"AddImageTag",value:function(e,t){var r,n,i=this;i.mydvs.Tag.addTag(t);for(var o=0;o<e.length;o++)(r=e[o])>=0&&(n=i.GetUidByIndex(r))&&""!=n&&-1!=n&&i.mydvs.Tag.addPageTag(n,t);return!0}},{key:"GetCurrentTag",value:function(){return this._currentTag}},{key:"RenameTag",value:function(e,r){var n,i=this;return i._currentTag=r,(n=i.mydvs.Tag.renameTag(e,r))?i.mydvs.Tag.setDefaultTag(r):t.Errors.WebviewerError(i._stwain,i.mydvs.Error.errorMessage,i.mydvs.Error.errorCode),n}},{key:"RemoveTag",value:function(e,r){var n,i=this,o=!1,a=!1;if((n=i.mydvs.Tag.getCurrentTag())&&(a=n.name==e),t.isUndefined(r))o=i.mydvs.Tag.removeTag(e),a&&i.ClearFilter();else{if(!t.isArray(r))return t.Errors.IndicesNotArray(i),!1;if(!i._stwain._checkIndices(r))return!1;var s=[];t.each(r,(function(e){var t=i.GetUidByIndex(e);-1!=t&&s.push(t)})),t.each(s,(function(t){if(!(o=i.mydvs.Tag.removePageTag(t,e)))return!1}))}return o||t.Errors.WebviewerError(i._stwain,i.mydvs.Error.errorMessage,i.mydvs.Error.errorCode),o}},{key:"GetTagList",value:function(){var e,r,n,i=this,o=[];return(e=i.mydvs.Tag.getTagList())?t.each(e,(function(e){if(r=[],n={},e.uids)for(var t=0;t<e.uids.length;t++){var a=e.uids[t];a&&(n=i.myViewer.getCustomDataByUid(a))&&r.push(i._stwain._objImageIndexManager.convertServerIdToGuid(n.imageId))}e.imageIds=r,delete e.uids,o.push(e)})):o=[],o}},{key:"GetTagListByIndex",value:function(e){var r=[],n=[],i=this.GetUidByIndex(e);return i&&((r=this.mydvs.Tag.getTagList())?t.each(r,(function(e){if(e.uids)for(var t=0;t<e.uids.length;t++){var r=e.uids[t];r&&r==i&&n.push(e.name)}})):n=[]),n}},{key:"CreateFile",value:function(e){var r=this,n=!1;return e&&(r.mydvs.File.createFile(e)?80032==r.mydvs.Error.errorCode?t.Errors.FileExist(r._stwain):n=!0:t.Errors.WebviewerError(r._stwain,r.mydvs.Error.errorMessage,r.mydvs.Error.errorCode)),n}},{key:"OpenFile",value:function(e){var r=this,n=!1;return r.mydvs.File.openFile(e,r.myViewer.uid)?(n=!0,r.currentFileName=e,t.log("OpenFile.currentFileName:"+r.currentFileName),r._stwain.Template&&r._stwain.Template._documentTemplate&&r._stwain.Template._documentTemplate.setTemplateTitle(r.currentFileName)):80006==r.mydvs.Error.errorCode?t.Errors.FileNotExist(r._stwain):t.Errors.WebviewerError(r._stwain,r.mydvs.Error.errorMessage,r.mydvs.Error.errorCode),n}},{key:"GetCurrentFileName",value:function(){var e,r=this,n="";return(e=r.mydvs.File.getCurrentFileList())&&t.each(e,(function(e){e.name==r.currentFileName&&(n=r.currentFileName)})),t.log("GetCurrentFileName.currentFileName:"+n),n}},{key:"GetDefaultFileName",value:function(){return fs}},{key:"RemoveFile",value:function(e){var r,n=this;return(r=n.mydvs.File.removeFile(e))?n.currentFileName==e&&(n.currentFileName=fs,n.OpenFile(n.currentFileName)):80006==n.mydvs.Error.errorCode?t.Errors.FileNotExist(n._stwain):t.Errors.WebviewerError(n._stwain,n.mydvs.Error.errorMessage,n.mydvs.Error.errorCode),r}},{key:"RenameFile",value:function(e,r){var n,i=this;return(n=i.mydvs.File.renameFile(e,r))?i.currentFileName==e&&(i.currentFileName=r,t.log("RenameFile.currentFileName:"+i.currentFileName),i._stwain.Template&&i._stwain.Template._documentTemplate&&i._stwain.Template._documentTemplate.setTemplateTitle("")):80006==i.mydvs.Error.errorCode?t.Errors.FileNotExist(i._stwain):80032==i.mydvs.Error.errorCode?t.Errors.FileExist(i._stwain):t.Errors.WebviewerError(i._stwain,i.mydvs.Error.errorMessage,i.mydvs.Error.errorCode),n}},{key:"GetFileInfoList",value:function(){var e,r,n,i,o=this,a=[];return(e=o.mydvs.File.getCurrentFileList())?t.each(e,(function(e){if(!o.IsInternalFile(e.name)){if(r=[],n={},i={},e.chs)for(var t=0;t<e.chs.length;t++){var s=e.chs[t];s&&(n=o.myViewer.getCustomDataByUid(s))&&r.push(o._stwain._objImageIndexManager.convertServerIdToGuid(n.imageId))}i.imageIds=r,i.name=e.name,a.push(i)}})):a=[],a}},{key:"GetImageIdsByFileName",value:function(e){var r,n,i=this,o=[];return(r=i.mydvs.File.getCurrentFileList())?t.each(r,(function(t){if(e==t.name){if(n={},t.chs)for(var r=0;r<t.chs.length;r++){var a=t.chs[r];a&&(n=i.myViewer.getCustomDataByUid(a))&&o.push(n.imageId)}return!1}})):o=[],o}},{key:"ifFileNameExist",value:function(e){var r,n=!1;return(r=this.mydvs.File.getCurrentFileList())&&(0==r.length?e==fs&&(n=!0):(t.each(r,(function(t){if(t.name==e)return n=!0,!0})),0==n&&e==fs&&(n=!0))),n}},{key:"OverlayRectangle",value:function(e,r,n,i,o,a,s){var u,c=this,l=a;return e<0||e>=c.GetHowManyImagesInBuffer()?(t.Errors.IndexOutOfRange(c._stwain),!1):(t.isNumber(l)&&(l=t.getColor(l)),(u=c.myViewer.overlayRectangle(e,r,n,i-r,o-n,l,s))||t.Errors.WebviewerError(c._stwain,c.mydvs.Error.errorMessage,c.mydvs.Error.errorCode),u)}},{key:"SetOperationMode",value:function(e){this.myViewer.operationMode=e}},{key:"GetIfShowVideoContainer",value:function(){return this.myViewer.showVideoContainer}},{key:"ShowVideoContainer",value:function(e){var t=this;return t.myViewer.showVideoContainer==e||(t._thumbnailViewer&&(e?(t.OldShowThumbnail=t.myThumbnailViewer.showThumbnail,t.myThumbnailViewer.showThumbnail=!1):t.myThumbnailViewer.showThumbnail=t.OldShowThumbnail),t.myViewer.showVideoContainer=e),!0}},{key:"UpdateVideoContainer",value:function(e){var r,n=this;return(r=n.myViewer.updateVideoContainer(e))||t.Errors.WebviewerError(n._stwain,n.mydvs.Error.errorMessage,n.mydvs.Error.errorCode),r}},{key:"GetImageData",value:function(e){return this.mydvs.DataControl.getData(e)}},{key:"UpdateImageData",value:function(e,t){return this.mydvs.DataControl.updateData(e,t)}},{key:"GetMinPageData",value:function(e){return this._imageEditorInner?this._imageEditorInner.myImageEditor.getMinPageData():NaN}},{key:"SetLogLevel",value:function(e){this.mydvs.Log.setLogLevel(e)}},{key:"SetLogFunc",value:function(e){this.mydvs.Log.setLogFunc(e)}},{key:"SetThumLocation",value:function(e){var r=this;if(!r._NouiNotSupport("ThumbnailViewer.location"))return!1;if(r.myThumbnailViewer){switch(e){case"left":default:r.myThumbnailViewer.location="horizontal",r.myThumbnailViewer.sequence=-1;break;case"right":r.myThumbnailViewer.location="horizontal",r.myThumbnailViewer.sequence=1;break;case"top":r.myThumbnailViewer.location="vertical",r.myThumbnailViewer.sequence=-1;break;case"bottom":r.myThumbnailViewer.location="vertical",r.myThumbnailViewer.sequence=1}return!0}return r.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(r._stwain):t.Errors.ThumbnailViewerNotExist(r._stwain),!1}},{key:"GetThumLocation",value:function(){var e=this;return!!e._NouiNotSupport("ThumbnailViewer.location")&&(e.myThumbnailViewer?"vertical"==e.myThumbnailViewer.location?e.myThumbnailViewer.sequence>0?"bottom":"top":e.myThumbnailViewer.sequence>0?"right":"left":(e.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(e._stwain):t.Errors.ThumbnailViewerNotExist(e._stwain),""))}},{key:"SetThumSize",value:function(e){var r=this;if(!r._NouiNotSupport("ThumbnailViewer.size"))return!1;return!/^((\d+em)|(\d+px)|(\d+%)|(\d+))$/.test(e)||e<0?(t.Errors.InvalidValue(r._stwain),!1):r.myThumbnailViewer?(r.myThumbnailViewer.size=e,!0):(r.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(r._stwain):t.Errors.ThumbnailViewerNotExist(r._stwain),!1)}},{key:"GetThumSize",value:function(){var e=this;return!!e._NouiNotSupport("ThumbnailViewer.size")&&(e.myThumbnailViewer?e.myThumbnailViewer.size:(e.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(e._stwain):t.Errors.ThumbnailViewerNotExist(e._stwain),0))}},{key:"SetThumScrollDirection",value:function(e){var r=this;return!!r._NouiNotSupport("ThumbnailViewer.scrollDirection")&&("horizontal"!=e&&(e="vertical"),r.myThumbnailViewer?(r.myThumbnailViewer.scrollDirection=e,!0):(r.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(r._stwain):t.Errors.ThumbnailViewerNotExist(r._stwain),!1))}},{key:"GetThumScrollDirection",value:function(){var e=this;return!!e._NouiNotSupport("ThumbnailViewer.scrollDirection")&&(e.myThumbnailViewer?e.myThumbnailViewer.scrollDirection:(e.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(e._stwain):t.Errors.ThumbnailViewerNotExist(e._stwain),""))}},{key:"SetThumShowPageNumber",value:function(e){var r=this;if(!r._NouiNotSupport("ThumbnailViewer.showPageNumber"))return!1;if(!t.isBoolean(e))return t.Errors.InvalidValue(r._stwain),!1;var n={visibility:"hidden"};return e&&(n.visibility="visible"),r.myThumbnailViewer?(r.UpdateThumPageNumberStyle(n),!0):(r.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(r._stwain):t.Errors.ThumbnailViewerNotExist(r._stwain),!1)}},{key:"GetThumShowPageNumber",value:function(){var e=this;return!!e._NouiNotSupport("ThumbnailViewer.showPageNumber")&&(e.myThumbnailViewer?"visible"==e.myThumbnailViewer.pageNumber.visibility:(e.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(e._stwain):t.Errors.ThumbnailViewerNotExist(e._stwain),-1))}},{key:"UpdateThumPageNumberStyle",value:function(e){var r=this;return!!r._NouiNotSupport("ThumbnailViewer.pageNumber")&&(r.myThumbnailViewer?(r.myThumbnailViewer.pageNumber=e,!0):(r.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(r._stwain):t.Errors.ThumbnailViewerNotExist(r._stwain),!1))}},{key:"SetThumShowCheckbox",value:function(e){var r=this;if(!r._NouiNotSupport("ThumbnailViewer.showCheckbox"))return!1;if(!t.isBoolean(e))return t.Errors.InvalidValue(r._stwain),!1;if(r.myThumbnailViewer){var n={visibility:"hidden"};return e&&(n.visibility="visible"),r.UpdateThumCheckboxStyle(n),"visible"==n.visibility?r.SetThumMultiSelectMode(Z):r.SetThumMultiSelectMode(K),!0}return r.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(r._stwain):t.Errors.ThumbnailViewerNotExist(r._stwain),!1}},{key:"UpdateThumCheckboxStyle",value:function(e){var r=this;return!!r._NouiNotSupport("ThumbnailViewer.checkbox")&&(r.myThumbnailViewer?(r.myThumbnailViewer.checkbox=e,!0):(r.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(r._stwain):t.Errors.ThumbnailViewerNotExist(r._stwain),!1))}},{key:"GetThumShowCheckbox",value:function(){var e=this;return!!e._NouiNotSupport("ThumbnailViewer.showCheckbox")&&(e.myThumbnailViewer?"visible"==e.myThumbnailViewer.checkbox.visibility:(e.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(e._stwain):t.Errors.ThumbnailViewerNotExist(e._stwain),-1))}},{key:"GetThumMultiSelectMode",value:function(){var e=this;return!!e._NouiNotSupport("ThumbnailViewer.multiSelectMode")&&(e.myThumbnailViewer?e.myThumbnailViewer.multiSelectMode?Z:K:(e.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(e._stwain):t.Errors.ThumbnailViewerNotExist(e._stwain),-1))}},{key:"SetThumMultiSelectMode",value:function(e){var r=this;return!!r._NouiNotSupport("ThumbnailViewer.multiSelectMode")&&(t.isNumber(e)?r.myThumbnailViewer?(r.myThumbnailViewer.multiSelectMode=e==Z,!0):(r.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(r._stwain):t.Errors.ThumbnailViewerNotExist(r._stwain),!1):(t.Errors.InvalidValue(r._stwain),!1))}},{key:"SetThumMargin",value:function(e){var r=this;if(!r._NouiNotSupport("ThumbnailViewer.margin"))return!1;return!/^((\d+em)|(\d+px)|(\d+%)|(\d+))$/.test(e)||e<0?(t.Errors.InvalidValue(r._stwain),!1):r.myThumbnailViewer?(r.myThumbnailViewer.pageMargin=e,!0):(r.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(r._stwain):t.Errors.ThumbnailViewerNotExist(r._stwain),!1)}},{key:"GetThumMargin",value:function(){var e=this;return!!e._NouiNotSupport("ThumbnailViewer.margin")&&(e.myThumbnailViewer?e.myThumbnailViewer.columns==e.myThumbnailViewer.rows&&1==e.myThumbnailViewer.rows?0:e.myThumbnailViewer.pageMargin:(e.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(e._stwain):t.Errors.ThumbnailViewerNotExist(e._stwain),0))}},{key:"SetThumBorder",value:function(e){var r=this;return!!r._NouiNotSupport("ThumbnailViewer.border")&&(r.myThumbnailViewer?(r.myThumbnailViewer.border=e,!0):(r.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(r._stwain):t.Errors.ThumbnailViewerNotExist(r._stwain),!1))}},{key:"GetThumBorder",value:function(){var e=this;return!!e._NouiNotSupport("ThumbnailViewer.border")&&(e.myThumbnailViewer?e.myThumbnailViewer.border:(e.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(e._stwain):t.Errors.ThumbnailViewerNotExist(e._stwain),""))}},{key:"SetThumBackground",value:function(e){var r=this;return!!r._NouiNotSupport("ThumbnailViewer.background")&&(r.myThumbnailViewer?(r.myThumbnailViewer.background=e,!0):(r.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(r._stwain):t.Errors.ThumbnailViewerNotExist(r._stwain),!1))}},{key:"GetThumBackground",value:function(){var e=this;return!!e._NouiNotSupport("ThumbnailViewer.background")&&(e.myThumbnailViewer?e.myThumbnailViewer.background:(e.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(e._stwain):t.Errors.ThumbnailViewerNotExist(e._stwain),""))}},{key:"SetThumPageBackground",value:function(e){var r=this;return!!r._NouiNotSupport("ThumbnailViewer.pageBackground")&&(r.myThumbnailViewer?(r.myThumbnailViewer.pageBackground=e,!0):(r.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(r._stwain):t.Errors.ThumbnailViewerNotExist(r._stwain),!1))}},{key:"GetThumPageBackground",value:function(){var e=this;return!!e._NouiNotSupport("ThumbnailViewer.pageBackground")&&(e.myThumbnailViewer?e.myThumbnailViewer.pageBackground:(e.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(e._stwain):t.Errors.ThumbnailViewerNotExist(e._stwain),""))}},{key:"SetThumPageBorder",value:function(e){var r=this;return!!r._NouiNotSupport("ThumbnailViewer.pageBorder")&&(r.myThumbnailViewer?(r.myThumbnailViewer.pageBorder=e,!0):(r.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(r._stwain):t.Errors.ThumbnailViewerNotExist(r._stwain),!1))}},{key:"GetThumPageBorder",value:function(){var e=this;return!!e._NouiNotSupport("ThumbnailViewer.pageBorder")&&(e.myThumbnailViewer?e.myThumbnailViewer.pageBorder:(e.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(e._stwain):t.Errors.ThumbnailViewerNotExist(e._stwain),""))}},{key:"SetThumHoverBackground",value:function(e){var r=this;return!!r._NouiNotSupport("ThumbnailViewer.hoverPageBackground")&&(r.myThumbnailViewer?(r.myThumbnailViewer.hoverPageBackground=e,!0):(r.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(r._stwain):t.Errors.ThumbnailViewerNotExist(r._stwain),""))}},{key:"GetThumHoverBackground",value:function(){var e=this;return!!e._NouiNotSupport("ThumbnailViewer.hoverPageBackground")&&(e.myThumbnailViewer?e.myThumbnailViewer.hoverPageBackground:(e.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(e._stwain):t.Errors.ThumbnailViewerNotExist(e._stwain),""))}},{key:"SetThumHoverBorder",value:function(e){var r=this;return!!r._NouiNotSupport("ThumbnailViewer.hoverPageBorder")&&(r.myThumbnailViewer?(r.myThumbnailViewer.hoverPageBorder=e,!0):(r.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(r._stwain):t.Errors.ThumbnailViewerNotExist(r._stwain),!1))}},{key:"GetThumHoverBorder",value:function(){var e=this;return!!e._NouiNotSupport("ThumbnailViewer.hoverPageBorder")&&(e.myThumbnailViewer?e.myThumbnailViewer.hoverPageBorder:(e.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(e._stwain):t.Errors.ThumbnailViewerNotExist(e._stwain),""))}},{key:"SetThumPlaceholderBackground",value:function(e){var r=this;return!!r._NouiNotSupport("ThumbnailViewer.placeholderBackground")&&(r.myThumbnailViewer?(r.myThumbnailViewer.placeholderBackground=e,!0):(r.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(r._stwain):t.Errors.ThumbnailViewerNotExist(r._stwain),!1))}},{key:"GetThumPlaceholderBackground",value:function(){var e=this;return!!e._NouiNotSupport("ThumbnailViewer.placeholderBackground")&&(e.myThumbnailViewer?e.myThumbnailViewer.placeholderBackground:(e.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(e._stwain):t.Errors.ThumbnailViewerNotExist(e._stwain),""))}},{key:"SetThumSelectedPageBorder",value:function(e){var r=this;return!!r._NouiNotSupport("ThumbnailViewer.selectedPageBorder")&&(r.myThumbnailViewer?(r.myThumbnailViewer.selectedPageBorder=e,!0):(r.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(r._stwain):t.Errors.ThumbnailViewerNotExist(r._stwain),!1))}},{key:"GetThumSelectedPageBorder",value:function(){var e=this;return!!e._NouiNotSupport("ThumbnailViewer.selectedPageBorder")&&(e.myThumbnailViewer?e.myThumbnailViewer.selectedPageBorder:(e.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(e._stwain):t.Errors.ThumbnailViewerNotExist(e._stwain),""))}},{key:"SetThumSelectedPageBackground",value:function(e){var r=this;return!!r._NouiNotSupport("ThumbnailViewer.selectedPageBackground")&&(r.myThumbnailViewer?(r.myThumbnailViewer.selectedPageBackground=e,!0):(r.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(r._stwain):t.Errors.ThumbnailViewerNotExist(r._stwain),!1))}},{key:"GetThumSelectedPageBackground",value:function(){var e=this;return!!e._NouiNotSupport("ThumbnailViewer.selectedPageBackground")&&(e.myThumbnailViewer?e.myThumbnailViewer.selectedPageBackground:(e.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(e._stwain):t.Errors.ThumbnailViewerNotExist(e._stwain),""))}},{key:"SetThumAllowKeyboardControl",value:function(e){var r=this;return!!r._NouiNotSupport("ThumbnailViewer.allowKeyboardControl")&&(t.isBoolean(e)?r.myThumbnailViewer?(r.myThumbnailViewer.allowKeyboardControl=e,!0):(r.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(r._stwain):t.Errors.ThumbnailViewerNotExist(r._stwain),!1):(t.Errors.InvalidValue(r._stwain),!1))}},{key:"GetThumAllowKeyboardControl",value:function(){var e=this;return!!e._NouiNotSupport("ThumbnailViewer.allowKeyboardControl")&&(e.myThumbnailViewer?e.myThumbnailViewer.allowKeyboardControl:(e.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(e._stwain):t.Errors.ThumbnailViewerNotExist(e._stwain),!1))}},{key:"SetThumAllowDrag",value:function(e){var r=this;return!!r._NouiNotSupport("ThumbnailViewer.allowDrag")&&(t.isBoolean(e)?r.myThumbnailViewer?(r.myThumbnailViewer.allowPageDragging=e,!0):(r.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(r._stwain):t.Errors.ThumbnailViewerNotExist(r._stwain),!1):(t.Errors.InvalidValue(r._stwain),!1))}},{key:"GetThumAllowDrag",value:function(){var e=this;return!!e._NouiNotSupport("ThumbnailViewer.allowPageDragging")&&(e.myThumbnailViewer?e.myThumbnailViewer.allowPageDragging:(e.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(e._stwain):t.Errors.ThumbnailViewerNotExist(e._stwain),!1))}},{key:"SetThumAllowResize",value:function(e){var r=this;return!!r._NouiNotSupport("ThumbnailViewer.allowResizing")&&(t.isBoolean(e)?r.myThumbnailViewer?(r.myThumbnailViewer.allowResizing=e,!0):(r.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(r._stwain):t.Errors.ThumbnailViewerNotExist(r._stwain),!1):(t.Errors.InvalidValue(r._stwain),!1))}},{key:"GetThumAllowResize",value:function(){var e=this;return!!e._NouiNotSupport("ThumbnailViewer.allowResizing")&&(e.myThumbnailViewer?e.myThumbnailViewer.allowResizing:(e.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(e._stwain):t.Errors.ThumbnailViewerNotExist(e._stwain),!1))}},{key:"SetThumAutoChangeIndex",value:function(e){var r=this;return!!r._NouiNotSupport("ThumbnailViewer.autoChangeIndex")&&(r.myThumbnailViewer?(r.myThumbnailViewer.autoChangeIndex=e,!0):(r.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(r._stwain):t.Errors.ThumbnailViewerNotExist(r._stwain),!1))}},{key:"GetThumAutoChangeIndex",value:function(){var e=this;return!!e._NouiNotSupport("ThumbnailViewer.autoChangeIndex")&&(e.myThumbnailViewer?e.myThumbnailViewer.autoChangeIndex:(e.bThumbnailDispose?t.Errors.ThumbnailViewerDispose(e._stwain):t.Errors.ThumbnailViewerNotExist(e._stwain),""))}},{key:"render",value:function(){return!!this._NouiNotSupport("render")&&this.myViewer.render()}},{key:"getUISettings",value:function(){if(!this._NouiNotSupport("getUISettings"))return!1;var t=e.Lib.clone(this.myViewer.uiConfig);return delete t.tag,delete t.tree,delete t.cropStyle,delete t.thumbnail,t}},{key:"resetUISettings",value:function(){var e={};return this.resetUISettingsInner(!0)&&(e=this.getUISettings()),e}},{key:"resetUISettingsInner",value:function(e,r,n){var i,o=this;if(!o._NouiNotSupport("resetUISetting"))return!1;var a=lu;e?(a.width=o.initWidth,a.height=o.initHeight):(t.isUndefined(r)?a.width=o.initWidth:a.width=r,t.isUndefined(n)?a.height=o.initHeight:a.height=n);var s=o.myViewer.showViewer;return(i=o.myViewer.updateUISetting(a))?(s||o.hide(),o.SetFitType("window"),o.SetIfSinglePageMode(!1),o._stwain._isPC()?o.SetOperationMode(1):o.SetOperationMode(0),o.OnlySetCurrentIndex(o.GetCurrentIndex())):t.Errors.WebviewerError(o._stwain,o.mydvs.Error.errorMessage,o.mydvs.Error.errorCode),i}},{key:"updateUISettings",value:function(e){var r=this,n={};if(!r._NouiNotSupport("updateUISettings"))return!1;var i=r.myViewer.showViewer;return r.myViewer.updateUISetting(e)?(i||r.hide(),"crosshair"==(n=r.getUISettings()).canvasConfig.canvasMouseShape?r.SetOperationMode(1):r.SetOperationMode(0),r._stwain.Template&&r._stwain.Template._documentTemplate&&(r._stwain.Template._documentTemplate.initView(),r.GetFileInfoList().length>0&&r._stwain.Template._documentTemplate.setTemplateTitle(r.currentFileName))):t.Errors.WebviewerError(r._stwain,r.mydvs.Error.errorMessage,r.mydvs.Error.errorCode),n}},{key:"createDocumentCameraManager",value:function(){var r=this;if(!e.CameraModel)return t.Errors.CameraRequired(r._stwain),!1;if(!r.myccvs){r.myccvs=new e.CameraModel;try{r.myccvs&&this.bindCallback(r,r.myccvs)}catch(n){}}}},{key:"createDocumentEditManager",value:function(){var r=this;if(!e.DocumentEditManager)return t.Errors.CameraRequired(r._stwain),!1;if(!r.mydocEditManager){r.mydocEditManager=new e.DocumentEditManager;try{r.mydocEditManager&&this.bindCallback(r,r.mydocEditManager)}catch(n){}}}},{key:"notBindCameraForCameraManager",value:function(){return!this.myccvs||this.myccvs.notBindCamera()}},{key:"bindCameraForCameraManager",value:function(){var r=this,n=!0;return e.CameraModel?(r.myccvs||r.createDocumentCameraManager(),r.myccvs.notBindCamera()&&(n=r.myccvs.bindCamera(e.ViewUi,r.mydvs)),n||void t.Errors.WebviewerError(r._stwain,r.myccvs.Error.errorMessage,r.myccvs.Error.errorCode)):(t.Errors.CameraRequired(r._stwain),!1)}},{key:"notBindCameraForDocumentEditManager",value:function(){return!this.mydocEditManager||this.mydocEditManager.notBindCamera()}},{key:"bindCameraForDocumentEditManager",value:function(){var r=this,n=!0;return e.DocumentEditManager?(r.mydocEditManager||r.createDocumentEditManager(),r.mydocEditManager.notBindCamera()&&(n=r.mydocEditManager.bindCamera(e.ViewUi,r.mydvs)),n||void t.Errors.WebviewerError(r._stwain,r.mydocEditManager.Error.errorMessage,r.mydocEditManager.Error.errorCode)):(t.Errors.CameraRequired(r._stwain),!1)}},{key:"bindCallback",value:function(e,t){t&&(t.bindLicenseCallback&&t.bindLicenseCallback((function(){return e._stwain._checkWebcamWasmLicense()})),t.bindSavePhotoCallback&&t.bindSavePhotoCallback((function(t){return e._stwain._saveImageCallback(t)})),t.bindInsertPhotoCallback&&t.bindInsertPhotoCallback((function(t,r,n){return e._stwain._insertImageCallback(t,r,n)})),t.bindRemovePhotoCallback&&t.bindRemovePhotoCallback((function(t,r){e._stwain._innerRemoveImage(t,r)})),t.bindAreaDetectFunction&&t.bindAreaDetectFunction(eu),t.bindPerspectiveFunction&&t.bindPerspectiveFunction(tu),t.bindFilterHandleList&&t.bindFilterHandleList([{label:"grayscale",handler:ru},{label:"blackAndWhite",handler:iu},{label:"saveToner",handler:nu},{label:"clean",handler:ou},{label:"brightening",handler:au}]),t.bindFreeHandle&&t.bindFreeHandle(su))}},{key:"showVideo",value:function(e,t,r,n){var i=this;if(!i._NouiNotSupport("showVideo"))return!1;var o={scannerViewer:{devicedId:e,fullScreen:n,enableBorderDetection:!0,resolution:{visibility:"hidden"},autoScan:{visibility:"hidden"},autoDetect:{visibility:"visible",enableAutoDetect:!1},continuousScan:!1,switchCamera:{visibility:"hidden"},loadLocalFile:{visibility:"hidden"}},documentEditorSettings:{defaultViewerName:"CropViewer",insert:{visibility:"hidden"},remove:{visibility:"hidden"},rotateLeft:{visibility:"hidden"},filter:{visibility:"hidden",valueList:[]},crop:{visibility:"hidden"},cropViewer:{visibility:"visible",rotateLeft:{visibility:"hidden"},rotateRight:{visibility:"hidden"},autoDetectBorder:{visibility:"hidden"}}}};return t&&(o.scannerViewer.resolution.valueList=[],o.scannerViewer.resolution.valueList.push({label:"resolution",value:t}),o.scannerViewer.resolution.defaultValue=t),r&&"document"==r?o.scannerViewer.enableBorderDetection=!0:(o.scannerViewer.enableBorderDetection=!1,o.scannerViewer.autoDetect.visibility="hidden",o.documentEditorSettings.cropViewer.visibility="hidden"),i.myccvs||i.createDocumentCameraManager(),i.notBindCameraForCameraManager()&&i.bindCameraForCameraManager(),i.showVideoEx(o)}},{key:"setElementForDocumentConfiguration",value:function(t){var r,n,i=this,o=e.Lib.clone(t);if(t&&t.scannerViewer&&t.scannerViewer.element){if(!(r=t.scannerViewer.element&&"DIV"==t.scannerViewer.element.nodeName?t.scannerViewer.element:document.getElementById(t.scannerViewer.element)).childNodes[r.childNodes.length-1]||"DIV"!=r.childNodes[r.childNodes.length-1].nodeName){var a=document.createElement("div");r.appendChild(a)}"DIV"!=(n=r.childNodes[r.childNodes.length-1]).nodeName&&(n=r),n&&r&&""==r.style.width?r.clientWidth>0?n.style.width=r.clientWidth+"px":r.offsetWidth>0?n.style.width=r.offsetWidth+"px":r.scrollWidth>0?n.style.width=r.scrollWidth+"px":n.style.width=i.myViewer.width+"px":n.style.width="100%",n&&r&&""==r.style.height?r.clientHeight>0?n.style.height=r.clientHeight+"px":r.offsetHeight>0?n.style.height=r.offsetHeight+"px":r.scrollHeight>0?n.style.height=r.scrollHeight+"px":n.style.height=i.myViewer.height+"px":n.style.height="100%",o.scannerViewer.element=n}if(t&&t.documentEditorSettings&&t.documentEditorSettings.element){if(!(r=t.documentEditorSettings.element&&"DIV"==t.documentEditorSettings.element.nodeName?t.documentEditorSettings.element:document.getElementById(t.documentEditorSettings.element)).childNodes[r.childNodes.length-1]||"DIV"!=r.childNodes[r.childNodes.length-1].nodeName){var s=document.createElement("div");r.appendChild(s)}"DIV"!=(n=r.childNodes[r.childNodes.length-1]).nodeName&&(n=r),n&&r&&""==r.style.width?r.clientWidth>0?n.style.width=r.clientWidth+"px":r.offsetWidth>0?n.style.width=r.offsetWidth+"px":r.scrollWidth>0?n.style.width=r.scrollWidth+"px":n.style.width=i.myViewer.width+"px":n.style.width="100%",n&&r&&""==r.style.height?r.clientHeight>0?n.style.height=r.clientHeight+"px":r.offsetHeight>0?n.style.height=r.offsetHeight+"px":r.scrollHeight>0?n.style.height=r.scrollHeight+"px":n.style.height=i.myViewer.height+"px":n.style.height="100%",o.documentEditorSettings.element=n}return o}},{key:"showVideoEx",value:function(e){var t=this.setElementForDocumentConfiguration(e);return this.showVideoInner(t)}},{key:"showVideoInner",value:(n=Ke(it.mark((function i(e){var r,n,o;return it.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if((r=this)._NouiNotSupport("scanDocument")){i.next=3;break}return i.abrupt("return",!1);case 3:if(r._stwain._isMobileMode()){i.next=5;break}return i.abrupt("return",r._stwain._serviceNotSupportAsync("scanDocument"));case 5:if(r._stwain.Template&&r._stwain.Template._documentTemplate&&r._stwain.Template._documentTemplate.setTemplateTitle(r.currentFileName),e=r.getDefaultDocumentConfigurationValue(r._globalScanConfiguration_ScannViewer,e,!1),r._globalScanConfiguration_ScannViewer=e,r._documentScanConfiguration=e,r.notBindCameraForCameraManager()&&r.bindCameraForCameraManager(),0==(o=r.GetCurrentFileName()).length&&(r.CreateFile(fs),r.OpenFile(fs),o=fs),ea(r._stwain)){i.next=15;break}return i.next=15,ta(r._stwain);case 15:return i.next=17,r.myccvs.showVideo(e,o);case 17:return(n=i.sent)||t.Errors.WebviewerError(r._stwain,r.myccvs.Error.errorMessage,r.myccvs.Error.errorCode),i.abrupt("return",n);case 20:case"end":return i.stop()}}),i,this)}))),function(e){return n.apply(this,arguments)})},{key:"getDefaultDocumentConfigurationValue",value:function(r,n,i){var o,a=this;if((o=e.Lib.clone(n))&&(o.scannerViewer&&n.scannerViewer&&n.scannerViewer.element&&(o.scannerViewer.element=n.scannerViewer.element),o.documentEditorSettings&&n.documentEditorSettings&&n.documentEditorSettings.element&&(o.documentEditorSettings.element=n.documentEditorSettings.element)),t.isUndefined(o))o=r;else{o.scannerViewer=a.getDefaultScannerViewerValue(o.scannerViewer,true),o.documentEditorSettings=a.getDefaultDocumentEditorValue(o.documentEditorSettings,true,i)}if(t.isFunction(o.documentEditorSettings.funcConfirmExitAfterSave)){var s=o.documentEditorSettings.funcConfirmExitAfterSave;o.documentEditorSettings.funcConfirmExitAfterSave=function(e){var t=a.GetCurrentFileName();0==t.length&&(t=fs),a.OpenFile(t),s(e)}}else o.documentEditorSettings.funcConfirmExitAfterSave=function(e){var t=a.GetCurrentFileName();0==t.length&&(t=fs),a.OpenFile(t)};if(i)if("cropviewer"==o.documentEditorSettings.defaultViewerName.toLowerCase())if(t.isFunction(o.documentEditorSettings.cropViewer.funcConfirmExit)){var u=o.documentEditorSettings.cropViewer.funcConfirmExit;o.documentEditorSettings.cropViewer.funcConfirmExit=function(e,t){var r=a.GetCurrentFileName();return 0==r.length&&(r=fs),a.OpenFile(r),u(e,t)}}else o.documentEditorSettings.cropViewer.funcConfirmExit=function(t,r){var n=a.GetCurrentFileName();return 0==n.length&&(n=fs),a.OpenFile(n),"documentScanPage"==r&&t?Promise.resolve(e.DWT.EnumDWT_ConfirmExitType.SaveAndExit):Promise.resolve(e.DWT.EnumDWT_ConfirmExitType.Exit)};else if(t.isFunction(o.documentEditorSettings.funcConfirmExit)){var c=o.documentEditorSettings.funcConfirmExit;o.documentEditorSettings.funcConfirmExit=function(e,t){var r=a.GetCurrentFileName();return 0==r.length&&(r=fs),a.OpenFile(r),c(e,t)}}else o.documentEditorSettings.funcConfirmExit=function(t,r){var n=a.GetCurrentFileName();return 0==n.length&&(n=fs),a.OpenFile(n),"cropViewer"==r&&t?Promise.resolve(e.DWT.EnumDWT_ConfirmExitType.SaveAndExit):Promise.resolve(e.DWT.EnumDWT_ConfirmExitType.Exit)};return t.isUndefined(o.scannerViewer.maxDocuments)&&(o.scannerViewer.maxDocuments=a._stwain.MaxImagesInBuffer-a.GetHowManyImagesInBuffer()),1==o.scannerViewer.continuousScan?o.scannerViewer.continuousScan={visibility:"hidden",enableContinuousScan:!0}:0==o.scannerViewer.continuousScan?o.scannerViewer.continuousScan={visibility:"hidden",enableContinuousScan:!1}:t.isUndefined(o.scannerViewer.continuousScan)?o.scannerViewer.continuousScan={visibility:"hidden",enableContinuousScan:!0}:(o.scannerViewer.continuousScan.visibility="hidden",t.isUndefined(o.scannerViewer.continuousScan.enableContinuousScan)&&(o.scannerViewer.continuousScan.enableContinuousScan=!0)),o}},{key:"getDefaultScannerViewerValue",value:function(e,r){var n,i;if(i=hu.scannerViewer,t.isUndefined(e))n=i,r&&delete n.funcConfirmExit;else{if(n=e,t.isUndefined(n.headerStyle)?n.headerStyle=i.headerStyle:(t.isUndefined(n.headerStyle.background)&&(n.headerStyle.background=i.headerStyle.background),t.isUndefined(n.headerStyle.color)&&(n.headerStyle.color=i.headerStyle.color),t.isUndefined(n.headerStyle.selectedColor)&&(n.headerStyle.selectedColor=i.headerStyle.selectedColor)),t.isUndefined(n.bodyStyle)?n.bodyStyle=i.bodyStyle:(t.isUndefined(n.bodyStyle.background)&&(n.bodyStyle.background=i.bodyStyle.background),t.isUndefined(n.bodyStyle.loaderBarSource)&&(n.bodyStyle.loaderBarSource=i.bodyStyle.loaderBarSource)),t.isUndefined(n.footerStyle)?n.footerStyle=i.footerStyle:(t.isUndefined(n.footerStyle.background)&&(n.footerStyle.background=i.footerStyle.background),t.isUndefined(n.footerStyle.color)&&(n.footerStyle.color=i.footerStyle.color),t.isUndefined(n.footerStyle.selectedColor)&&(n.footerStyle.selectedColor=i.footerStyle.selectedColor)),t.isUndefined(n.fullScreen)&&(n.fullScreen=i.fullScreen),t.isUndefined(n.enableBorderDetection)&&(n.enableBorderDetection=i.enableBorderDetection),t.isUndefined(n.polygonStyle)?n.polygonStyle=i.polygonStyle:(t.isUndefined(n.polygonStyle.stroke)&&(n.polygonStyle.stroke=i.polygonStyle.stroke),t.isUndefined(n.polygonStyle.strokeWidth)&&(n.polygonStyle.strokeWidth=i.polygonStyle.strokeWidth),t.isUndefined(n.polygonStyle.dash)&&(n.polygonStyle.dash=i.polygonStyle.dash)),n.scanButtonStyle?(t.isUndefined(n.scanButtonStyle.background)&&(n.scanButtonStyle.background=i.scanButtonStyle.background),t.isUndefined(n.scanButtonStyle.color)&&(n.scanButtonStyle.color=i.scanButtonStyle.color)):n.scanButtonStyle=i.scanButtonStyle,t.isUndefined(n.resolution))n.resolution=i.resolution;else{var o=n.resolution;t.isBoolean(o.visibility)&&!o.visibility?o.visibility="hidden":t.isString(o.visibility)||(o.visibility=i.resolution.visibility),t.isUndefined(o.valueList)&&(o.valueList=i.resolution.valueList),t.isUndefined(o.defaultValue)&&o.valueList&&o.valueList.length>0&&(o.defaultValue=o.valueList[0].value)}if(t.isUndefined(n.autoScan))n.autoScan=i.autoScan;else{var a=n.autoScan;t.isBoolean(a.visibility)&&!a.visibility?a.visibility="hidden":t.isString(a.visibility)||(a.visibility=i.autoScan.visibility),t.isUndefined(a.enableAutoScan)&&(a.enableAutoScan=i.autoScan.enableAutoScan)}if(t.isUndefined(n.autoDetect))n.autoDetect=i.autoDetect;else{var s=n.autoDetect;if(t.isBoolean(s.visibility)&&!s.visibility?s.visibility="hidden":t.isString(s.visibility)||(s.visibility=i.autoDetect.visibility),t.isUndefined(s.enableAutoDetect)&&(s.enableAutoDetect=i.autoDetect.enableAutoDetect),t.isUndefined(s.fpsLimit)&&(s.fpsLimit=i.autoDetect.fpsLimit),t.isUndefined(s.acceptedPolygonConfidence))s.acceptedPolygonConfidence=i.autoDetect.acceptedPolygonConfidence;else{var u=parseInt(s.acceptedPolygonConfidence);s.acceptedPolygonConfidence=u>=0?u:i.autoDetect.acceptedPolygonConfidence}if(t.isUndefined(s.acceptedBlurryScore))s.acceptedBlurryScore=i.autoDetect.acceptedBlurryScore;else{var c=parseInt(s.acceptedBlurryScore);s.acceptedBlurryScore=c>=0?c:i.autoDetect.acceptedBlurryScore}if(t.isUndefined(s.autoCaptureDelay))s.autoCaptureDelay=i.autoDetect.autoCaptureDelay;else{var l=parseInt(s.autoCaptureDelay);s.autoCaptureDelay=l>=0?l:i.autoDetect.autoCaptureDelay}}if(t.isUndefined(n.switchCamera))n.switchCamera=i.switchCamera;else{var d=n.switchCamera;t.isBoolean(d.visibility)&&!d.visibility?d.visibility="hidden":t.isString(d.visibility)||(d.visibility=i.switchCamera.visibility)}if(t.isUndefined(n.loadLocalFile))n.loadLocalFile=i.loadLocalFile;else{var h=n.loadLocalFile;t.isBoolean(h.visibility)&&!h.visibility?h.visibility="hidden":t.isString(h.visibility)||(h.visibility=i.loadLocalFile.visibility)}}return n}},{key:"getDefaultDocumentEditorValue",value:function(r,n,i){var o,a;if((a=e.Lib.clone(hu.documentEditorSettings))&&hu.documentEditorSettings&&hu.documentEditorSettings.element&&(a.element=hu.documentEditorSettings.element),i&&(a.defaultViewerName="mainViewer"),t.isUndefined(r))o=a,n&&(delete o.remove.funcConfirmRemove,delete o.funcConfirmExit,delete o.funcConfirmExitAfterSave,delete o.cropViewer.funcConfirmExit);else{if(o=r,t.isBoolean(o.visibility)&&!o.visibility?o.visibility="hidden":t.isString(o.visibility)||(o.visibility=a.visibility),(t.isUndefined(o.defaultViewerName)||""==o.defaultViewerName||"cropviewer"!=o.defaultViewerName.toLowerCase()&&"mainviewer"!=o.defaultViewerName.toLowerCase())&&(o.defaultViewerName=a.defaultViewerName),t.isUndefined(o.headerStyle)?o.headerStyle=a.headerStyle:(t.isUndefined(o.headerStyle.background)&&(o.headerStyle.background=a.headerStyle.background),t.isUndefined(o.headerStyle.color)&&(o.headerStyle.color=a.headerStyle.color),t.isUndefined(o.headerStyle.selectedColor)&&(o.headerStyle.selectedColor=a.headerStyle.selectedColor),t.isUndefined(o.headerStyle.disabledColor)&&(o.headerStyle.disabledColor=a.headerStyle.disabledColor)),t.isUndefined(o.bodyStyle)?o.bodyStyle=a.bodyStyle:(t.isUndefined(o.bodyStyle.background)&&(o.bodyStyle.background=a.bodyStyle.background),t.isUndefined(o.bodyStyle.loaderBarSource)&&(o.bodyStyle.loaderBarSource=a.bodyStyle.loaderBarSource)),t.isUndefined(o.footerStyle)?o.footerStyle=a.footerStyle:(t.isUndefined(o.footerStyle.background)&&(o.footerStyle.background=a.footerStyle.background),t.isUndefined(o.footerStyle.color)&&(o.footerStyle.color=a.footerStyle.color),t.isUndefined(o.footerStyle.selectedColor)&&(o.footerStyle.selectedColor=a.footerStyle.selectedColor)),t.isUndefined(o.insert)?o.insert=a.insert:(t.isBoolean(o.insert.visibility)&&!o.insert.visibility?o.insert.visibility="hidden":t.isString(o.insert.visibility)||(o.insert.visibility=a.insert.visibility),t.isUndefined(o.insert.position)&&(o.insert.position=a.insert.position)),t.isUndefined(o.remove)?(o.remove=a.remove,n&&delete o.remove.funcConfirmRemove):t.isBoolean(o.remove.visibility)&&!o.remove.visibility?o.remove.visibility="hidden":t.isString(o.remove.visibility)||(o.remove.visibility=a.remove.visibility),t.isUndefined(o.rotateLeft)?o.rotateLeft=a.rotateLeft:t.isBoolean(o.rotateLeft.visibility)&&!o.rotateLeft.visibility?o.rotateLeft.visibility="hidden":t.isString(o.rotateLeft.visibility)||(o.rotateLeft.visibility=a.rotateLeft.visibility),t.isUndefined(o.filter))o.filter=a.filter;else{if(t.isBoolean(o.filter.visibility)&&!o.filter.visibility?o.filter.visibility="hidden":t.isString(o.filter.visibility)||(o.filter.visibility=a.filter.visibility),t.isUndefined(o.filter.valueList))o.filter.valueList=a.filter.valueList;else{for(var s=[],u=0;u<o.filter.valueList.length;u++){for(var c=!1,l=o.filter.valueList[u].value,d=0;d<a.filter.valueList.length;d++){if(l==a.filter.valueList[d].value){c=!0;break}}c&&(t.isUndefined(o.filter.valueList[u].option)&&(o.filter.valueList[u].option=a.filter.valueList[0].option),s.push(o.filter.valueList[u]))}o.filter.valueList=s}if(t.isUndefined(o.filter.defaultValue))o.filter.defaultValue=a.filter.defaultValue;else{for(var h=!1,g=o.filter.defaultValue,f=0;f<o.filter.valueList.length;f++)if(g==o.filter.valueList[f].value){h=!0;break}0==h&&(o.filter.defaultValue=a.filter.defaultValue)}if(t.isUndefined(o.filter.applyToAll))o.filter.applyToAll=a.filter.applyToAll;else{var m=o.filter.applyToAll;t.isBoolean(m.visibility)&&!m.visibility?m.visibility="hidden":t.isString(m.visibility)||(m.visibility=a.filter.applyToAll.visibility),t.isUndefined(m.enableApplyToAll)&&(m.enableApplyToAll=a.filter.applyToAll.enableApplyToAll),t.isUndefined(m.label)&&(m.label=a.filter.applyToAll.label)}}if(t.isUndefined(o.crop)?o.crop=a.crop:t.isBoolean(o.crop.visibility)&&!o.crop.visibility?o.crop.visibility="hidden":t.isString(o.crop.visibility)||(o.crop.visibility=a.crop.visibility),t.isUndefined(o.cropViewer))o.cropViewer=a.cropViewer,n&&delete o.cropViewer.funcConfirmExit;else{if(t.isBoolean(o.cropViewer.visibility)&&!o.cropViewer.visibility?o.cropViewer.visibility="hidden":t.isString(o.cropViewer.visibility)||(o.cropViewer.visibility=a.cropViewer.visibility),t.isUndefined(o.cropViewer.polygonStyle)?o.cropViewer.polygonStyle=a.cropViewer.polygonStyle:(t.isUndefined(o.cropViewer.polygonStyle.stroke)&&(o.cropViewer.polygonStyle.stroke=a.cropViewer.polygonStyle.stroke),t.isUndefined(o.cropViewer.polygonStyle.strokeWidth)&&(o.cropViewer.polygonStyle.strokeWidth=a.cropViewer.polygonStyle.strokeWidth),t.isUndefined(o.cropViewer.polygonStyle.dash)&&(o.cropViewer.polygonStyle.dash=a.cropViewer.polygonStyle.dash)),t.isUndefined(o.cropViewer.rotateLeft))o.cropViewer.rotateLeft=a.cropViewer.rotateLeft;else{var _=o.cropViewer.rotateLeft;t.isBoolean(_.visibility)&&!_.visibility?_.visibility="hidden":t.isString(_.visibility)||(_.visibility=a.cropViewer.rotateLeft.visibility)}if(t.isUndefined(o.cropViewer.rotateRight))o.cropViewer.rotateRight=a.cropViewer.rotateRight;else{var p=o.cropViewer.rotateRight;t.isBoolean(p.visibility)&&!p.visibility?p.visibility="hidden":t.isString(p.visibility)||(p.visibility=a.cropViewer.rotateRight.visibility)}if(t.isUndefined(o.cropViewer.autoDetectBorder))o.cropViewer.autoDetectBorder=a.cropViewer.autoDetectBorder;else{var v=o.cropViewer.autoDetectBorder;t.isBoolean(v.visibility)&&!v.visibility?v.visibility="hidden":t.isString(v.visibility)||(v.visibility=a.cropViewer.autoDetectBorder.visibility)}}}return o}},{key:"closeVideo",value:function(){var e,r=this;return!!r._NouiNotSupport("closeVideo")&&(!r.myccvs||((e=r.myccvs.closeVideo())||t.Errors.WebviewerError(r._stwain,r.myccvs.Error.errorMessage,r.myccvs.Error.errorCode),e))}},{key:"camera_on",value:function(e,r){var n=this;if(n.myccvs||n.bindCameraForCameraManager(),n.mydocEditManager||n.bindCameraForDocumentEditManager(),e){if(!t.isFunction(r))return void t.Errors.CallbackNotAFunction(n._stwain);n.myccvs.on(e,r),n.mydocEditManager.on(e,r)}}},{key:"camera_off",value:function(e,r){var n=this;if(n.myccvs&&e)if(t.isUndefined(r))n.myccvs.off(e),cu.indexOf(e)>=0&&n.myccvs.on(e,(function(r,i){t.isFunction(n[e])&&n[e](r,i)}));else{if(!t.isFunction(r))return void t.Errors.CallbackNotAFunction(n._stwain);n.myccvs.off(e,r)}if(n.mydocEditManager&&e)if(t.isUndefined(r))n.mydocEditManager.off(e),cu.indexOf(e)>=0&&n.mydocEditManager.on(e,(function(r,i){t.isFunction(n[e])&&n[e](r,i)}));else{if(!t.isFunction(r))return void t.Errors.CallbackNotAFunction(n._stwain);n.mydocEditManager.off(e,r)}}},{key:"createEditPage",value:function(e,r){var n,i=this,o=r||{};if(!i._NouiNotSupport("createEditPage"))return!1;i.mydocEditManager||i.createDocumentEditManager(),i.notBindCameraForDocumentEditManager()&&i.bindCameraForDocumentEditManager();var a=i.GetCurrentFileName();return 0==a.length&&(i.CreateFile(fs),i.OpenFile(fs),a=fs),o.fileName=a,(n=i.mydocEditManager.createEditPage(e,o))||t.Errors.WebviewerError(i._stwain,i.mydocEditManager.Error.errorMessage,i.mydocEditManager.Error.errorCode),n}},{key:"removeEditPage",value:function(e){var t=!1;return this.mydocEditManager&&(t=this.mydocEditManager.removeEditPage(e)),t}},{key:"GetBorder",value:function(){return this._NouiNotSupport("border")?this.myViewer.outerBorder:""}},{key:"SetBorder",value:function(e){return!!this._NouiNotSupport("border")&&(this.myViewer.outerBorder=e,!0)}},{key:"GetInnerBorder",value:function(){return this._NouiNotSupport("innerBorder")?this.myViewer.canvasBorder:""}},{key:"SetInnerBorder",value:function(e){return!!this._NouiNotSupport("innerBorder")&&(this.myViewer.canvasBorder=e,!0)}},{key:"GetAllowPageDragging",value:function(){return this._NouiNotSupport("allowPageDragging")?this.myViewer.allowPageDragging:""}},{key:"SetAllowPageDragging",value:function(e){return!!this._NouiNotSupport("allowPageDragging")&&(this.myViewer.allowPageDragging=e,!0)}},{key:"GetSelectedAreaBorderColor",value:function(){return this._NouiNotSupport("selectedAreaBorderColor")?this.myViewer.selectedBoxLineColor:""}},{key:"SetSelectedAreaBorderColor",value:function(e){return!!this._NouiNotSupport("selectedAreaBorderColor")&&(this.myViewer.selectedBoxLineColor=e,!0)}},{key:"GetCursor",value:function(){return this._NouiNotSupport("cursor")?this.myViewer.canvasMouseShape:""}},{key:"SetCursor",value:function(e){var r=this;if(!r._NouiNotSupport("cursor"))return!1;if("zoom-in"==e&&!r.GetIfSinglePageMode())return t.Errors.CursorInvalidMode(r._stwain),!1;var n="default";switch(e){case"default":n="default",r.SetOperationMode(0);break;case"pointer":n="pointer",r.SetOperationMode(0);break;case"crosshair":default:n="crosshair",r.SetOperationMode(1);break;case"zoom-in":n="zoom-in",r.SetOperationMode(2)}return r.myViewer.canvasMouseShape=n,!0}},{key:"GetIfAutoScroll",value:function(){return this._NouiNotSupport("ifAutoScroll")?this.myViewer.showLatestPage:""}},{key:"SetIfAutoScroll",value:function(e){var r=this;return!!r._NouiNotSupport("ifAutoScroll")&&(t.isBoolean(e)?(r.myViewer.showLatestPage=e,r._imageEditorInner&&r._imageEditorInner.SetIfAutoScroll(),!0):(t.Errors.InvalidValue(r._stwain),!1))}},{key:"GetPageMargin",value:function(){return this._NouiNotSupport("pageMargin")?this.myViewer.pageMargin:0}},{key:"SetPageMargin",value:function(e){var r=this;if(!r._NouiNotSupport("pageMargin"))return!1;return!/^((\d+em)|(\d+px)|(\d+%)|(\d+))$/.test(e)||e<0?(t.Errors.InvalidValue(r._stwain),!1):(r.myViewer.pageMargin=e,!0)}},{key:"setButtonClass",value:function(e,r){var n,i=this;return!!i._NouiNotSupport("setButtonClass")&&((n=i.myViewer.setButtonClass(e,r))||t.Errors.WebviewerError(i._stwain,i.mydvs.Error.errorMessage,i.mydvs.Error.errorCode),n)}},{key:"clearSelectedAreas",value:function(){var e,r=this;return!!r._NouiNotSupport("clearSelectedAreas")&&(r.GetHowManyImagesInBuffer()<=0||((e=r.myViewer.clearSelectedBoxes())||t.Errors.WebviewerError(r._stwain,r.mydvs.Error.errorMessage,r.mydvs.Error.errorCode),e))}},{key:"setSelectedAreas",value:function(e){var r,n,i=this,o=[];if(i.GetCurrentIndex()<0)return t.Errors.NoImage(i._stwain),!1;if(!i._NouiNotSupport("setSelectedAreas"))return!1;if(t.isUndefined(e)||0==e.length)return t.Errors.MobileServer_InvalidLeftOrTopOrRightOrBottom(i._stwain),!1;if(e.length&&e.length>0){for(var a=0;a<e.length;a++)if(n={},!(t.isUndefined(e[a])||t.isUndefined(e[a].left)||t.isUndefined(e[a].top)||t.isUndefined(e[a].right)||t.isUndefined(e[a].bottom))){if(e[a].left<0||e[a].top<0||e[a].right<0||e[a].bottom<0)continue;if(n.left=e[a].left,n.top=e[a].top,e[a].right-e[a].left<0||e[a].bottom-e[a].top<0)continue;n.width=e[a].right-e[a].left,n.height=e[a].bottom-e[a].top,o.push(n)}}else if(n={},!(t.isUndefined(e)||t.isUndefined(e.left)||t.isUndefined(e.top)||t.isUndefined(e.right)||t.isUndefined(e.bottom))){if(e.left<0||e.top<0||e.right<0||e.bottom<0)return t.Errors.MobileServer_InvalidLeftOrTopOrRightOrBottom(i._stwain),!1;if(n.left=e.left,n.top=e.top,e.right-e.left<0||e.bottom-e.top<0)return t.Errors.MobileServer_InvalidLeftOrTopOrRightOrBottom(i._stwain),!1;n.width=e.right-e.left,n.height=e.bottom-e.top,o.push(n)}return 0==o.length?(t.Errors.MobileServer_InvalidLeftOrTopOrRightOrBottom(i._stwain),!1):((r=i.myViewer.setSelectedBoxes(o,!0))||t.Errors.WebviewerError(i._stwain,i.mydvs.Error.errorMessage,i.mydvs.Error.errorCode),r)}},{key:"_NouiNotSupport",value:function(e){var t=this;return t._stwain._resetErr(),!!t._stwain._isValid()&&(!t._stwain._isNoViewer()||(t._stwain._nouiNotSupport(e),!1))}},{key:"pageChange",value:function(r){var n,i=this,o=i.GetHowManyImagesInBuffer();if(t.log("OnPagination"),o<=0)return t.Errors.NoImage(i._stwain),void gu.output(i,"No image in Buffer");if(1!=o){!/^\d+$/.test(r)||r<=0?alert(e.Lib.product.CustomizableDisplayInfo.errorMessages.invalidIndex):((n=parseInt(r)-1)<0?n=0:n>=o&&(n=o-1),n!=i.GetCurrentIndex()&&i.go(n))}}},{key:"first",value:function(){var e=this,r=e.GetHowManyImagesInBuffer();return e._NouiNotSupport("first")?r<=0?(t.Errors.NoImage(e._stwain),gu.output(e,"No image in Buffer"),-1):(1==r||(0,e.go(0)),0):-1}},{key:"last",value:function(){var e,r=this,n=r.GetHowManyImagesInBuffer();return r._NouiNotSupport("last")?n<=0?(t.Errors.NoImage(r._stwain),gu.output(r,"No image in Buffer"),-1):1==n?0:(e=n-1,r.go(e),e):-1}},{key:"previous",value:function(){var e,r=this,n=r.GetHowManyImagesInBuffer();return r._NouiNotSupport("previous")?n<=0?(t.Errors.NoImage(r._stwain),gu.output(r,"No image in Buffer"),-1):1==n?0:((e=r.GetCurrentIndex()-1)<0&&(e=0),r.go(e),e):-1}},{key:"next",value:function(){var e,r=this,n=r.GetHowManyImagesInBuffer();return r._NouiNotSupport("next")?n<=0?(t.Errors.NoImage(r._stwain),gu.output(r,"No image in Buffer"),-1):1==n?0:((e=r.GetCurrentIndex()+1)>=n&&(e=n-1),r.go(e),e):-1}},{key:"go",value:function(e){var r=this,n=e;return r._NouiNotSupport("go")?r.GetHowManyImagesInBuffer()<=0?(t.Errors.NoImage(r._stwain),gu.output(r,"No image in Buffer"),-1):(r._imageEditorInner?r._imageEditorInner.go(e):n=r.__goInner(e),n):-1}},{key:"__goInner",value:function(e){var r,n=this;if(void 0!==e){if(-1==e)return t.Errors.IndexOutOfRange(n._stwain),-1;ni("",n._stwain),r=n.GoToPage(e)}return r}},{key:"topPageChanged",value:function(e,t){this._UIView.__fireEvent("onTopImageInTheViewChanged",{index:e,bByScrollBar:t})}},{key:"bufferChanged",value:function(e,r){for(var n,i=this,o=[],a=-1,s=[],u=0;u<i.GetHowManyImagesInBuffer();u++)(n=i.GetCustomDataByIndex(u))&&n.imageId&&o.push(i._stwain._objImageIndexManager.convertServerIdToGuid(n.imageId));if(o.length>0&&(e.imageIds=o),e.currentUid){var c=i.GetIndexByUid(e.currentUid);if(c>=0&&(n=i.GetCustomDataByIndex(c))&&n.imageId){a=i._stwain._objImageIndexManager.convertServerIdToGuid(n.imageId);var l=i._stwain._ImgManager._UIView.GetDataImageControl(n.imageId);l&&-1==l.uuid&&(l.uuid=e.currentUid)}}if(e.currentId=a,e.selectedUids)for(var d=0;d<e.selectedUids.length;d++){if(e.selectedUids[d]){var h=i.GetIndexByUid(e.selectedUids[d]);if(h>=0&&(n=i.GetCustomDataByIndex(h))&&n.imageId){s.push(i._stwain._objImageIndexManager.convertServerIdToGuid(n.imageId));var g=i._stwain._ImgManager._UIView.GetDataImageControl(n.imageId);g&&-1==g.uuid&&(g.uuid=e.currentUid)}}}e.selectedIds=s;var f=t.mix(e,{});delete e.uids,delete e.currentUid,delete e.selectedUids,i._UIView.__fireEvent("onBufferChanged",e),i._documentEditor&&i._bFireSync&&(f.file||(f.file=i.GetCurrentFileName()),f.fromViewerBufferChanged===undefined&&(f.fromViewerBufferChanged=!0),i._documentEditor.syncFile(f))}},{key:"click",value:function(e){var t=this;t.UpdateInfo(!0,!1,!0),t._UIView.__fireEvent("onMouseClick",{e:e,x:e.imageX,y:e.imageY,index:t.GetCurrentIndex()})}},{key:"rightclick",value:function(e){this._UIView.__fireEvent("onMouseRightClick",{e:e,x:e.imageX,y:e.imageY,index:this.GetCurrentIndex()})}},{key:"dblclick",value:function(e){this._UIView.__fireEvent("onMouseDoubleClick",{e:e,x:e.imageX,y:e.imageY,index:this.GetCurrentIndex()})}},{key:"mousemove",value:function(e){this._UIView.__fireEvent("onMouseMove",{e:e,x:e.imageX,y:e.imageY,index:this.GetCurrentIndex()})}},{key:"pageAreaSelected",value:function(e,t){var r=1;if(t&&t.length>0){var n=t[t.length-1];n.index&&(r=parseInt(n.index)+1),this._UIView.__fireEvent("onImageAreaSelected",{index:e,left:parseInt(n.x),top:parseInt(n.y),right:parseInt(n.x+n.width),bottom:parseInt(n.y+n.height),areaIndex:r})}}},{key:"pageAreaUnselected",value:function(e){this._UIView.__fireEvent("onImageAreaDeSelected",e)}},{key:"dragdone",value:function(e){t.isFunction(this._stwain.__OnIndexChangeDragDropDone)&&this._stwain.__OnIndexChangeDragDropDone(e)}},{key:"RegistLoadCallback",value:function(e){return this._bRegistedLoad||(this._bRegistedLoad=!0),!0}},{key:"onDrop",value:function(e){this.acceptDrop&&this.dropEvent(e)}},{key:"dropEvent",value:function(r){var n,i,o=this,a=null,s=function(e){e&&os.output(null,e+" was loaded successfully!"),null!=a&&o._stwain.Addon.PDF.SetConvertMode(a)},u=function(e,t,r){r&&os.output(null,r+" failed to load. Error code: "+e+"Error String: "+t),null!=a&&o._stwain.Addon.PDF.SetConvertMode(a)};try{for(var c=r.dataTransfer.files,l=0;l<c.length;l++){if(0==(n=c[l]).type.length){var d=void 0,h=n.name.indexOf(".");switch(h>0&&(d=n.name.substring(h+1)),d){case"bmp":i=e.DWT.EnumDWT_ImageType.IT_BMP;break;case"jpg":case"jpeg":i=e.DWT.EnumDWT_ImageType.IT_JPG;break;case"tif":case"tiff":i=e.DWT.EnumDWT_ImageType.IT_TIF;break;case"png":i=e.DWT.EnumDWT_ImageType.IT_PNG;break;case"pdf":i=e.DWT.EnumDWT_ImageType.IT_PDF;break;case"jp2":case"j2k":case"j2c":i=e.DWT.EnumDWT_ImageType.IT_J2K;break;default:os.output(null,n.name+" failed to load because the file type is not supported!"),i=-1,t.Errors.UnrecognizedExt(o._stwain)}}else switch(n.type){case"image/bmp":i=e.DWT.EnumDWT_ImageType.IT_BMP;break;case"image/jpg":case"image/jpeg":i=e.DWT.EnumDWT_ImageType.IT_JPG;break;case"image/tif":case"image/tiff":i=e.DWT.EnumDWT_ImageType.IT_TIF;break;case"image/png":i=e.DWT.EnumDWT_ImageType.IT_PNG;break;case"application/pdf":i=e.DWT.EnumDWT_ImageType.IT_PDF;break;case"image/jp2":i=e.DWT.EnumDWT_ImageType.IT_J2K;break;default:os.output(null,n.name+" failed to load because the file type is not supported!"),i=-1,t.Errors.UnrecognizedExt(o._stwain)}if(-1!=i){if(t.showProgress(o._stwain,"DropLoading",!0),o._stwain._OnPercentDone([0,-1,e.MSG.Loading]),o._stwain.Addon&&o._stwain.Addon.PDF){var g=!1,f=void 0;t.License.checkProductKey(o._stwain,{PDFRasterizer:!0},!0)&&(o._stwain._isMobileMode()?g=!0:(a=o._stwain.Addon.PDF.GetConvertMode(),f=o._stwain._innerFun("GetAddOnVersion",Zn("pdf")),(t.env.bMac&&f==e.DWT.PdfMacVersion||t.env.bLinux&&f==e.DWT.PdfLinuxVersion||f==e.DWT.PdfVersion)&&(g=!0)),g&&o._stwain.Addon.PDF.SetConvertMode(3))}if(o._stwain._isMobileMode())o._stwain.LoadImageFromBinary(n,(function(){e.Lib.closeProgress(o._stwain)}),(function(){e.Lib.closeProgress(o._stwain)}));else{!function(t){var r=new FileReader;r.readAsDataURL(t),r.onload=function(){var e=o._stwain.__GetLoadEventsNum();o._stwain.__LoadImageFromBytesV2(t,i,"",!0,0,t.size,!1,e,s,u)},r.onerror=function(t){e.Lib.closeProgress(o._stwain),e.Lib.Errors.InvalidFile(o._stwain),o._stwain._errorString=this.error,u(o._stwain._errorCode,o._stwain._getErrorString())}}(c[l])}}}}catch(m){t.error(m.stack||m,"error"),setTimeout((function(){throw m}),0)}}},{key:"getImageManager",value:function(){return this._ImgManager}},{key:"on",value:function(e,r){if(e){if(!t.isFunction(r))return void t.Errors.CallbackNotAFunction(this._stwain);this.myViewer.on(e,r)}}},{key:"off",value:function(e,r){var n=this;if(e)if(t.isUndefined(r))n.myViewer.off(e),cu.indexOf(e)>=0&&n.myViewer.on(e,(function(r,i){t.isFunction(n[e])&&n[e](r,i)}));else{if(!t.isFunction(r))return void t.Errors.CallbackNotAFunction(n._stwain);n.myViewer.off(e,r)}}},{key:"initDialogText",value:function(e,r){var n=e;return t.isUndefined(n)?n=r:(t.isUndefined(n.dlgChangeImageSize)?n.dlgChangeImageSize=r.dlgChangeImageSize:(0==n.dlgChangeImageSize[0].length&&(n.dlgChangeImageSize[0]=r.dlgChangeImageSize[0]),0==n.dlgChangeImageSize[1].length&&(n.dlgChangeImageSize[1]=r.dlgChangeImageSize[1]),0==n.dlgChangeImageSize[2].length&&(n.dlgChangeImageSize[2]=r.dlgChangeImageSize[2]),0==n.dlgChangeImageSize[3].length&&(n.dlgChangeImageSize[3]=r.dlgChangeImageSize[3]),0==n.dlgChangeImageSize[4].length&&(n.dlgChangeImageSize[4]=r.dlgChangeImageSize[4])),t.isUndefined(n.dlgRotateAnyAngle)?n.dlgRotateAnyAngle=r.dlgRotateAnyAngle:(0==n.dlgRotateAnyAngle[0].length&&(n.dlgRotateAnyAngle[0]=r.dlgRotateAnyAngle[0]),0==n.dlgRotateAnyAngle[1].length&&(n.dlgRotateAnyAngle[1]=r.dlgRotateAnyAngle[1]),0==n.dlgRotateAnyAngle[2].length&&(n.dlgRotateAnyAngle[2]=r.dlgRotateAnyAngle[2]),0==n.dlgRotateAnyAngle[3].length&&(n.dlgRotateAnyAngle[3]=r.dlgRotateAnyAngle[3]),0==n.dlgRotateAnyAngle[4].length&&(n.dlgRotateAnyAngle[4]=r.dlgRotateAnyAngle[4])),t.isUndefined(n.saveChangedImage)?n.saveChangedImage=r.saveChangedImage:(0==n.saveChangedImage[0].length&&(n.saveChangedImage[0]=r.saveChangedImage[0]),0==n.saveChangedImage[1].length&&(n.saveChangedImage[1]=r.saveChangedImage[1]),0==n.saveChangedImage[2].length&&(n.saveChangedImage[2]=r.saveChangedImage[2])),t.isUndefined(n.selectSource)?n.selectSource=r.selectSource:(0==n.selectSource[0].length&&(n.selectSource[0]=r.selectSource[0]),0==n.selectSource[1].length&&(n.selectSource[1]=r.selectSource[1]),0==n.selectSource[2].length&&(n.selectSource[2]=r.selectSource[2]),0==n.selectSource[3].length&&(n.selectSource[3]=r.selectSource[3]))),n}},{key:"createDocumentEditor",value:function(e){var r=this;if(!r._NouiNotSupport("createImageEditor"))return NaN;if(!r._documentEditor||r._documentEditor.myDocumentEditor.isDestroyed){var n=r.setElementForDocumentConfiguration(e),i=r.getDefaultDocumentConfigurationValue(r._globalScanConfiguration,n,!0);r._globalScanConfiguration=i,r._documentEditor=new Ws(r,r.GetCurrentIndex(),i)}else t.Errors.DocumentEditorExist(r._stwain);return r._documentEditorInner=r._documentEditor._documentEditorInner,r.bShowDocumentEdit=r._documentEditorInner.bShowDocumentEdit,r._documentEditor}},{key:"createImageEditor",value:function(e){var r=this;return r._NouiNotSupport("createImageEditor")?(r._imageEditor?t.Errors.ImageEditorExist(r._stwain):(e?(t.isUndefined(e.border)&&(e.border=r.GetBorder()),t.isUndefined(e.selectionRectAspectRatio)&&(e.selectionRectAspectRatio=r.GetSelectionRectAspectRatio()),t.isUndefined(e.background)&&(e.background=du.background),t.isUndefined(e.topMenuBorder)&&(e.topMenuBorder=du.topMenuBorder),t.isUndefined(e.innerBorder)&&(e.innerBorder=du.innerBorder),t.isUndefined(e.promptToSaveChange)&&(e.promptToSaveChange=du.promptToSaveChange),t.isUndefined(e.buttons)&&(e.buttons=du.buttons),e.dialogText=r.initDialogText(e.dialogText,du.dialogText)):((e=du).border=r.GetBorder(),e.selectionRectAspectRatio=r.GetSelectionRectAspectRatio()),r._imageEditor=new Gs(r,e)),r._imageEditorInner=r._imageEditor._imageEditorInner,r.bShowImageEdit=r._imageEditorInner.bShowImageEdit,r._imageEditor):NaN}},{key:"createThumbnailViewer",value:function(e){var r=this;return r._NouiNotSupport("createThumbnailViewer")?(e&&!t.isUndefined(e.showCheckbox)&&(t.isUndefined(e.checkbox)&&(e.checkbox={}),e.checkbox.visibility=e.showCheckbox?"visible":"hidden"),r._thumbnailViewer?t.Errors.ThumbnailViewerExist(r._stwain):r._thumbnailViewer=new Xs(r,e),r.myThumbnailViewer=r._thumbnailViewer.myThumbnailViewer,r.myThumbnailViewer.on("click",(function(e,t){r.UpdateInfo(!0,!1,!0)})),r._thumbnailViewer):NaN}},{key:"createCustomElement",value:function(e,r,n){var i=this,o="right",a=!1;return i._NouiNotSupport("createCustomElement")?t.isUndefined(e)?(t.Errors.ElementRequired(i._stwain),NaN):e?(t.isUndefined(r)||(o=r),!t.isUndefined(n)&&t.isBoolean(n)&&(a=n),i._customElement?t.Errors.CustomElementExist(i._stwain):(i._customElement=new us(i,e,o,a),i._customElement.myCustomElemet||(i._customElement=undefined)),i._customElement):(t.Errors.ElementNotExist(i._stwain),NaN):NaN}},{key:"ConvertClientIndexToServerIdInFile",value:function(e,t){var r=this._fileWrapper.openFile(e);if(t>=0&&t<r.length){var n=r[t];if(n)return this._dvsWrapper.getCustomDataSync(n).imageId}return null}},{key:"ConvertServerIdToIndexInFile",value:function(e,t){for(var r,n=-1,i=this._fileWrapper.openFile(e),o=0;o<i.length;o++){var a=i[o];if(a&&(r=this._dvsWrapper.getCustomDataSync(a))&&r.imageId==t){n=o;break}}return n}},{key:"FireBufferChanged",value:function(e,t,r){var n=this,i=n._fileWrapper.openFile(e),o=null;if(n.currentFileName==e){var a=n.GetCurrentIndex(),s=n.myViewer.getCurrentPageUids();s&&a>=0&&a<s.length&&(o=s[a])}var u={action:t,actionData:r,uids:i,currentUid:o,selectedUids:[],fromViewerBufferChanged:!1,file:e};this.IsInternalFile(e)||"add"==t?n._documentEditor&&n._documentEditor.syncFile(u):n.bufferChanged(u)}},{key:"RemoveByServerId",value:function(e,t){var r,n=this,i=n.ConvertServerIdToIndexInFile(e,t);i>=0&&(null===(r=n._fileWrapper)||void 0===r||r.removeByIndexInFile(e,i),n.FireBufferChanged(e,"remove"))}},{key:"IsInternalFile",value:function(e){var t=!1;return 0!=e.indexOf("__dynamsoft_camera_files")&&0!=e.indexOf("__dynamsoft_crop_files")&&0!=e.indexOf("__dynamsoft_edit_files")||(t=!0),t}},{key:"InsertImage",value:function(e,t,r){var n,i,o=this;o._bFireSync=!1,n=r>=0?o.mydvs.DataControl.insertSync(e,[t],r):o.mydvs.DataControl.appendSync(e,[t]),o._bFireSync=!0,n&&n.length>=1&&(i=n[0]),o.FireBufferChanged(e,"add",i)}}]),r}();t.UI.WebViewer=fu;var mu=os;e.DWT;var _u=function(){function n(e,t){Le(this,n);var r=this;r._ImgManager=e,r._stwain=e._stwain,r.zoomInStep=1.2,r.zoomOutStep=.8,r.MIN_ZOOM=.02,r.MAX_ZOOM=65,r.BaseUrl=!1,r.MAX_ROWS=128,r.MAX_COLUMNS=128,r.AllowMultiSelect=!0,r.__MousewheelValue=0,this._Init(t)}return Ae(n,[{key:"_Init",value:function(e){var r=this;r.borderWidth=t.isUndefined(e.borderWidth)?1:e.borderWidth,e.BackgroundColor?r.BackgroundColorByDefault=e.BackgroundColor:r.BackgroundColorByDefault="#FFFFFF",e.BackgroundColor=r.BackgroundColorByDefault,r.BackgroundFillColor=r.BackgroundColorByDefault,r._webViewer?r._webViewer._Init(e):r._webViewer=new fu(r._ImgManager,e,r),r.mapModelImageControl=e.mapModelImageControl,r.__InitEvents(e)}},{key:"dispose",value:function(){var e=this;e._webViewer&&(e._webViewer.dispose(),e._webViewer=null)}},{key:"__InitEvents",value:function(e){var r=this;t.isFunction(e.onTopImageInTheViewChanged)&&(r.onTopImageInTheViewChanged=e.onTopImageInTheViewChanged),t.isFunction(e.onGetImageInfo)&&(r.onGetImageInfo=e.onGetImageInfo),t.isFunction(e.onZoomChanged)&&(r.onZoomChanged=e.onZoomChanged),t.isFunction(e.onMouseMove)&&(r.onMouseMove=e.onMouseMove),t.isFunction(e.onMouseClick)&&(r.onMouseClick=e.onMouseClick),t.isFunction(e.onMouseRightClick)&&(r.onMouseRightClick=e.onMouseRightClick),t.isFunction(e.onMouseDoubleClick)&&(r.onMouseDoubleClick=e.onMouseDoubleClick),t.isFunction(e.onImageAreaDeSelected)&&(r.onImageAreaDeSelected=e.onImageAreaDeSelected),t.isFunction(e.onImageAreaSelected)&&(r.onImageAreaSelected=e.onImageAreaSelected),t.isFunction(e.onBufferChanged)&&(r.onBufferChanged=e.onBufferChanged),t.isFunction(e.onSelected)&&(r.onSelected=e.onSelected),t.isFunction(e.onRefreshUI)&&(r.onRefreshUI=e.onRefreshUI),t.isFunction(e.onResetCurrentIndex)&&(r.onResetCurrentIndex=e.onResetCurrentIndex)}},{key:"SetMetaDataByIndex",value:function(e,t){return this.GetWebViewer().SetMetaDataByIndex(e,t)}},{key:"GetMetaDataByIndex",value:function(e){return this.GetWebViewer().GetMetaDataByIndex(e)}},{key:"GetDataImageControl",value:function(e){return this.mapModelImageControl[e]}},{key:"SetDataImageControl",value:function(e,t,r){var n,i=this;return-1!=t&&((n=i.mapModelImageControl[t])||((n=new ss).serverId=t,i.mapModelImageControl[t]=n),null!=n&&(n.bIsDirty=!0),i.__GetImageAndAttach(n,t,!0,!1,!1,e,r),!0)}},{key:"AttachImagesForControl",value:function(t,r){var n=this.GetWebViewer();return t.bAddImage?n.AppendImage(t,r):n.UpdateImage(t,r),n._ImageEditorInner&&n._ImageEditorInner.bCouldBeTimeConsuming&&(n._ImageEditorInner.bCouldBeTimeConsuming=!1,e.Lib.hideMask()),!0}},{key:"MobileAttachImagesForControl",value:function(t,r){var n=this.GetWebViewer();return t.bAddImage?n.MobileAppendImage(t,r):n.MobileUpdateImage(t,r),n._ImageEditorInner&&n._ImageEditorInner.bCouldBeTimeConsuming&&(n._ImageEditorInner.bCouldBeTimeConsuming=!1,e.Lib.hideMask()),!0}},{key:"GetWebViewer",value:function(){return this._webViewer}},{key:"__GetWebViewerUuid",value:function(e){return this.mapModelImageControl[e].uuid}},{key:"SetSelectedImageArea",value:function(e,t,r,n){var i=this.GetWebViewer();return null!=i&&i.SetSelectedImageArea(e,t,r,n)}},{key:"OverlayRectangle",value:function(e,t,r,n,i,o,a){var s=this.GetWebViewer();return null!=s&&s.OverlayRectangle(e,t,r,n,i,o,a)}},{key:"ChangeImageViewSize",value:function(e,t){var r=this.GetWebViewer();return e>=0&&(r.GetWidth(),r.SetWidth(e)),t>=0&&(r.GetHeight(),this.GetWebViewer().SetHeight(t)),!0}},{key:"GetWidth",value:function(){return this.GetWebViewer().GetWidth()}},{key:"SetWidth",value:function(e){var t=e;return this.GetWebViewer().SetWidth(t),!0}},{key:"GetHeight",value:function(){return this.GetWebViewer().GetHeight()}},{key:"SetHeight",value:function(e){var t=e;return this.GetWebViewer().SetHeight(t),!0}},{key:"RefreshAllImages",value:function(e,t){var r,n,i,o=this,a=o.GetWebViewer();if(!o._stwain._isMobileMode()&&o.mapModelImageControl)for(var s=0;s<a.GetHowManyImagesInBuffer();s++){r=o.getImageManager().convertClientIndexToServerId(s);var u=o.mapModelImageControl[r];u&&(n=mu.getImageUrl(o.BaseUrl,r,e,t,Date.now()),u.minImageUrl=n,i=a.GetMetaDataByIndex(s),a.UpdateImage(u,i))}}},{key:"SetViewMode",value:function(e,t){return this.GetWebViewer().SetViewMode(e,t)}},{key:"RemoveAllImages",value:function(){var e,t,r,n,i=this;for(r=i._ImgManager.count(),n=Object.keys(i.mapModelImageControl).length,e=0;e<r;e++)-1!=(t=i.getImageManager().convertClientIndexToServerId(e))&&i.mapModelImageControl[t]&&(i.mapModelImageControl[t].Clear(),delete i.mapModelImageControl[t]);return r==n&&(i.mapModelImageControl={}),i.GetWebViewer().RemoveAllImages(),!0}},{key:"__GetImageAndAttach",value:function(e,t,r,n,i,o,a){var s=this,u=s.GetWebViewer().GetWidthInner(),c=s.GetWebViewer().GetHeightInner(),l=!1;l=!!r||1==e.bIsDirty;var d=s.__GetWebViewerUuid(t);d&&e.iImageControlWidth==u&&e.iImageControlHeight==c&&0==e.bIsDirty||s.__SetArrayControlLoadImage(d,t,e,u,c,s.AttachImagesForControl,l,n,i,o,a)}},{key:"__SetArrayControlLoadImage",value:function(e,t,r,n,i,o,a,s,u,c,l){var d=this;d._stwain._isMobileMode()?d.OnGetImageFromMobileServer(t,r,n,i,s,u,c,l):a?d.OnGetImageFromServer(t,r,n,i,s,u,c,l):d.OnGetImageByURL(t,r,n,i,s,u,c,l)}},{key:"OnGetImageByURL",value:function(e,t,r,n,i,o,a,s){var u=this;return t.imageUrl&&""!=t.imageUrl?(t.iImageControlWidth=r,t.iImageControlHeight=n,t.bAddImage=i,t.bAppendImage=o,t.index=a,u._stwain._isMobileMode()?u.MobileAttachImagesForControl(t,s):u.AttachImagesForControl(t,s),!0):u.OnGetImageFromServer(e,t,r,n,i,o,a,s)}},{key:"OnGetImageFromMobileServer",value:function(e,t,r,n,i,o,a,s){t.iImageControlWidth=r,t.iImageControlHeight=n,t.bAddImage=i,t.bAppendImage=o,t.index=a,this.MobileAttachImagesForControl(t,s)}},{key:"OnGetImageFromServer",value:function(r,n,i,o,a,s,u,c){var l,d,h=this,g=h.BaseUrl;if(g){if(-1==r)return!1;n.bIsDirty&&(n.ticks=Date.now()),t.isUndefined(i)&&(i=-1),t.isUndefined(o)&&(o=-1),n.iImageControlWidth=i,n.iImageControlHeight=o,n.bAddImage=a,n.bAppendImage=s,n.index=u,e.DWT.ConnectWithSocket&&h._stwain._bBindViewer?h._stwain.__innerConvertToBlob(e.DWT.EnumDWT_ImageType.IT_PNG,[r],!1,!0,4,(function(e){n.imageUrl=URL.createObjectURL(e),n.minImageUrl=URL.createObjectURL(e),h.AttachImagesForControl(n,c)}),(function(e){})):(l=mu.getImageUrl(g,r,-1,-1,n.ticks),d=mu.getImageUrl(g,r,i,o,n.ticks),n.imageUrl=l,n.minImageUrl=d,h.AttachImagesForControl(n,c))}return!0}},{key:"SetIfFitWindowAndType",value:function(e){var t,r=this.GetWebViewer();if(null!=r){switch(e){case 1:t="height";break;case 2:t="width";break;default:t="window"}r.SetFitType(t)}return!0}},{key:"GetAllowMultiSelect",value:function(){return this.AllowMultiSelect}},{key:"SetAllowMultiSelect",value:function(e){return this.AllowMultiSelect=e,!0}},{key:"GetFitWindowType",value:function(){return 0}},{key:"SetSelectionRectAspectRatio",value:function(e){return this.GetWebViewer().SetSelectionRectAspectRatio(e),!0}},{key:"GetSelectionRectAspectRatio",value:function(e){return this.GetWebViewer().GetSelectionRectAspectRatio()}},{key:"SetFitWindowType",value:function(e){return this.SetIfFitWindowAndType(e),!0}},{key:"GetIfFitWindow",value:function(){return!0}},{key:"SetIfFitWindow",value:function(e){return e?this.GetWebViewer().SetFitType():this.GetWebViewer().SetZoom(1),!0}},{key:"GetImageMargin",value:function(){return this.GetWebViewer().GetImageMargin()}},{key:"SetImageMargin",value:function(e){return this.GetWebViewer().SetImageMargin(e),!0}},{key:"GetSelectionImageBorderColor",value:function(){return this.GetWebViewer().GetSelectedPageBorder()}},{key:"SetSelectionImageBorderColor",value:function(e){var t=e;return this.GetWebViewer().SetSelectionImageBorderColor(t),!0}},{key:"GetZoom",value:function(){return this.GetWebViewer().GetZoom()}},{key:"SetZoom",value:function(e,t,r){var n=this;e<n.MIN_ZOOM&&(e=n.MIN_ZOOM),e>n.MAX_ZOOM&&(e=n.MAX_ZOOM);var i=n.GetWebViewer();return null!=i&&i.SetZoom(e),!0}},{key:"ZoomIn",value:function(t,n){var i=this,o=i.mapModelImageControl[i.getImageManager().convertClientIndexToServerId(i._webViewer.GetCurrentIndex())],a=i.GetWebViewer().GetZoom(),s=Math.floor(100*a*i.zoomInStep)+1;return 1<s&&s<2501?r(o.imageWidth*a)>15e3||r(o.imageHeight*a)>15e3?(mu.output(i,e.Lib.product.CustomizableDisplayInfo.errorMessages.limitReachedForZoomIn),alert(e.Lib.product.CustomizableDisplayInfo.errorMessages.limitReachedForZoomIn),!1):(i.SetZoom(s/100,t,n),!0):(mu.output(i,e.Lib.product.CustomizableDisplayInfo.errorMessages.limitReachedForZoomIn),alert(e.Lib.product.CustomizableDisplayInfo.errorMessages.limitReachedForZoomIn),!1)}},{key:"ZoomOut",value:function(){var t=this,r=t.GetWebViewer().GetZoom(),n=Math.floor(100*r*t.zoomOutStep)-1;return 1<n&&n<6501?(t.SetZoom(n/100),!0):(mu.output(t,e.Lib.product.CustomizableDisplayInfo.errorMessages.limitReachedForZoomOut),alert(e.Lib.product.CustomizableDisplayInfo.errorMessages.limitReachedForZoomOut),!1)}},{key:"GetMouseShape",value:function(){return this.GetWebViewer().GetMouseShape()}},{key:"SetMouseShape",value:function(e){return this.GetWebViewer().SetMouseShape(e),!0}},{key:"GetShowPageNumber",value:function(){return this.GetWebViewer().GetShowPageNumber()}},{key:"SetShowPageNumber",value:function(e){return this.GetWebViewer().SetShowPageNumber(e),!0}},{key:"SetBackgroundFillColor",value:function(e){var t=e;return this.BackgroundFillColor=t,!0}},{key:"GetBackgroundColor",value:function(){return this.GetWebViewer().GetBackground()}},{key:"SetBackgroundColor",value:function(e){var t=e;return this.GetWebViewer().SetBackground(t),!0}},{key:"Go",value:function(e){return this.GetWebViewer().go(e)}},{key:"SetSelectedindexes",value:function(e){return this.GetWebViewer().SetSelectedindexes(e)}},{key:"GetSelectedindexes",value:function(e){return this.GetWebViewer().GetSelectedindexes()}},{key:"__Previous",value:function(){return this.Go(this.GetWebViewer().GetCurrentIndex()-1),!0}},{key:"__Next",value:function(){return this.Go(this.GetWebViewer().GetCurrentIndex()+1),!0}},{key:"__fireEvent",value:function(e,r){return!t.isFunction(this[e])||this[e](r)}},{key:"AddImage",value:function(e,t,r,n){var i,o=1*e;return-1!=t&&((i=new ss).bIsDirty=!0,i.serverId=t,this.mapModelImageControl[t]=i,t>=0&&this.__GetImageAndAttach(i,t,!1,!0,n,o,r),!0)}},{key:"RemoveImage",value:function(e,n){var i=this,o=r(e);return isNaN(o)?(t.Errors.InvalidIndex(i),!1):o<0||o>=i._ImgManager.count()?(t.Errors.IndexOutOfRange(i),!1):(i._ImgManager.count(),-1!=n&&i.mapModelImageControl[n]&&(i.mapModelImageControl[n].Clear(),delete i.mapModelImageControl[n]),i.GetWebViewer().RemoveByIndex(o))}},{key:"MoveImage",value:function(e,t,r){return this.GetWebViewer().MoveImage(e,t)}},{key:"SwitchImage",value:function(e,t){return this.GetWebViewer().SwitchImage(e,t)}},{key:"GetIfAutoScroll",value:function(){return this._webViewer.GetIfAutoScroll()}},{key:"SetIfAutoScroll",value:function(e){return this._webViewer.SetIfAutoScroll(e),!0}},{key:"Print",value:function(){var e,r=this;if(!((e=r.GetWebViewer().GetCurrentIndex())<0)){var n,i;if(-1==(i=r.getImageManager().convertClientIndexToServerId(e)))return t.Errors.IndexOutOfRange(r),!1;if(!r._stwain._isMobileMode())return n=mu.getImageUrl(r.BaseUrl,i,-1,-1),r.__PrintInner(n,i,e);var o=r.GetWebViewer().GetUidByIndex(e);return r.GetWebViewer().GetImageData(o).then((function(t){return t.oriData instanceof ArrayBuffer?r.__PrintInner(URL.createObjectURL(new Blob([t.oriData])),i,e):t.oriData instanceof Blob?r.__PrintInner(URL.createObjectURL(t.oriData),i,e):r.__PrintInner(t.oriData,i,e)})),!0}}},{key:"__PrintInner",value:function(e,r,n){var i=this,o=i.mapModelImageControl[r],a=[];if(!o)return!1;var s=o.width;(t.isUndefined(o.width)||o.width<=0)&&(o.width=i.getImageManager().GetImageWidth(n));var u=o.height;(t.isUndefined(o.height)||o.height<=0)&&(o.height=i.getImageManager().GetImageHeight(n));var c=new as(e,o.width,o.height);return a.push(c),o.width=s,o.height=u,mu.print(a),!0}},{key:"GetHowManyImagesInBuffer",value:function(){return this.GetWebViewer().GetHowManyImagesInBuffer()}},{key:"RemoveImageTag",value:function(e){return this.GetWebViewer().RemoveImageTag(e)}},{key:"FilterImagesByTag",value:function(e,t,r){return this.GetWebViewer().FilterImagesByTag(e,t,r)}},{key:"ClearFilter",value:function(){return this.GetWebViewer().ClearFilter()}},{key:"GetServerIdList",value:function(){return this.GetWebViewer().GetServerIdList()}},{key:"GetServerIdListByTag",value:function(e){var t,r,n,i,o=this,a=[];if(e&&0==e.length)for(r=0;r<o.GetHowManyImagesInBuffer();r++)(i=o.GetWebViewer().GetCustomDataByIndex(r))&&a.push(i.imageId);else if(t=o.GetWebViewer().GetTagContents(e))for(r=0;r<t.length;r++)(n=o.GetWebViewer().GetIndexByUid(t[r]))>=0&&(i=o.GetWebViewer().GetCustomDataByIndex(n))&&a.push(i.imageId);return a}},{key:"SetDefaultTag",value:function(e){return this.GetWebViewer().SetDefaultTag(e)}},{key:"AddImageTag",value:function(e,t){return this.GetWebViewer().AddImageTag(e,t)}},{key:"GetCurrentTag",value:function(){var e;return 0==(e=this.GetWebViewer().GetCurrentTag())?"":e}},{key:"RenameTag",value:function(e,t){return this.GetWebViewer().RenameTag(e,t)}},{key:"RemoveTag",value:function(e,t){return this.GetWebViewer().RemoveTag(e,t)}},{key:"GetTagList",value:function(){return this.GetWebViewer().GetTagList()}},{key:"GetTagListByIndex",value:function(e){return this.GetWebViewer().GetTagListByIndex(e)}},{key:"CreateFile",value:function(e){return this.GetWebViewer().CreateFile(e)}},{key:"OpenFile",value:function(e){return this.GetWebViewer().OpenFile(e)}},{key:"GetCurrentFileName",value:function(){return this.GetWebViewer().GetCurrentFileName()}},{key:"RemoveFile",value:function(e){return this.GetWebViewer().RemoveFile(e)}},{key:"RenameFile",value:function(e,t){return this.GetWebViewer().RenameFile(e,t)}},{key:"GetFileInfoList",value:function(){return this.GetWebViewer().GetFileInfoList()}},{key:"GetImageIdsByFileName",value:function(e){return this.GetWebViewer().GetImageIdsByFileName(e)}},{key:"BindView",value:function(e){var t,r=this.GetWebViewer();return(t=r.BindView(e))&&r.show(),t}},{key:"UnbindView",value:function(){return this.GetWebViewer().UnbindView()}},{key:"GetIfShowVideoContainer",value:function(){return this.GetWebViewer().GetIfShowVideoContainer()}},{key:"ShowVideoContainer",value:function(e){return this.GetWebViewer().ShowVideoContainer(e)}},{key:"UpdateVideoContainer",value:function(e){return this.GetWebViewer().UpdateVideoContainer(e)}},{key:"__AttachImages",value:function(){var e,t,r,n=this;t=n.GetWebViewer().GetHowManyImagesInBuffer();for(var i=0;i<t;i++)(e=n._ImgManager.convertClientIndexToServerId(i))>=0&&(r=n.mapModelImageControl[e],n.__GetImageAndAttach(r,e,!0,!1,!1,0))}},{key:"exists",value:function(e){return!t.isUndefined(this.mapModelImageControl[e])}},{key:"getImageManager",value:function(){return this._ImgManager}},{key:"GetImageData",value:function(e){this.GetWebViewer().GetImageData(e)}},{key:"RegistLoadCallback",value:function(e){return this.GetWebViewer().RegistLoadCallback(e)}},{key:"UpdateData",value:function(e,t){var r=this.GetWebViewer(),n=this.GetDataImageControl(e);return n&&r.UpdateImage(n,t),!0}},{key:"RemoveByServerId",value:function(e,t){return this.GetWebViewer().RemoveByServerId(e,t)}},{key:"innerInsertModel",value:function(e,t){var r=new ss;r.serverId=e,r.uuid=t,this.mapModelImageControl[e]=r}}]),n}();t.UI.ImageUIView=_u;var pu=function(e){return[e._httpUrl,"dwt/",t.product.getDWTPrefix(),t.product.getServerVersionInfo(),"/img?id=",e._clientId].join("")},vu=function(r){e.DWT.Debug&&t.log(r)},yu=function(){function r(e,t){Le(this,r);var n=this;n._stwain=e,n.__backgroundFillColor=16777215,n.bImageJustChangedInEditor=!1,n.bImageChangedInViewer=!1,n._Init(e,t)}return Ae(r,[{key:"_Init",value:function(t,r){var n=this;t._ifBindViewer?r.mapModelImageControl=n.getView().mapModelImageControl:r.mapModelImageControl={},r.onTopImageInTheViewChanged=function(r){e.Lib.isFunction(t.__OnTopImageInTheViewChanged)&&t.__OnTopImageInTheViewChanged(r.index,r.bByScrollBar)},r.onGetImageInfo=function(e){return{width:n.GetImageWidth(e),height:-1}},n._UIView?n._UIView._Init(r):n._UIView=new _u(n,r)}},{key:"getUidByIndex",value:function(e){return this.getWebViewer().GetUidByIndex(e)}},{key:"getIndexByUid",value:function(e){return this.getWebViewer().GetIndexByUid(e)}},{key:"getCurrentImageIndex",value:function(){return this.getWebViewer().GetCurrentIndex()}},{key:"convertServerIdToClientIndex",value:function(e){var r,n,i=-1;return(n=this._UIView.GetDataImageControl(e))&&(r=n.uuid),r&&(i=this.getWebViewer().GetIndexByUid(r)),t.isNumber(i)||(i=-1),i}},{key:"convertClientIndexToServerId",value:function(e){var t=this.getWebViewer().GetCustomDataByIndex(e);return t?t.imageId:-1}},{key:"convertClientIndexToServerIdInFile",value:function(e,t){return this.getWebViewer().ConvertClientIndexToServerIdInFile(e,t)}},{key:"getWebViewer",value:function(){return this.getView()._webViewer}},{key:"getTwain",value:function(){return this._stwain}},{key:"getView",value:function(){return this._UIView}},{key:"OnReady",value:function(){return this.getView().BaseUrl=pu(this._stwain),!0}},{key:"count",value:function(){return this.getView().GetWebViewer().GetHowManyImagesInBuffer()}},{key:"clear",value:function(){return this.getView().RemoveAllImages(),!0}},{key:"dispose",value:function(){var e=this;return e._UIView&&(e._UIView.dispose(),e._UIView=null),!0}},{key:"unshift",value:function(e,t,r){return this.getView(),0,this._updateUIAfterAdd(0,t,r)}},{key:"append",value:function(e,t,r){var n,i,o,a,s=this,u=s.getView();i=u.GetWebViewer().GetHowManyImagesInBuffer(),o=u.GetWebViewer().GetCurrentIndex();for(var c=i-1;c>=e;c--)a=s.convertClientIndexToServerId(c),u.RemoveImage(c,a);return i<e?(n=i,s._updateUIAfterAdd(n,t,r,!0)):(n=o>=i-1?0:o+1,a=s.convertClientIndexToServerId(n),u.RemoveImage(n,a),n==e-1?s._updateUIAfterAdd(n,t,r,!0):s._updateUIAfterAdd(n,t,r,!1))}},{key:"exists",value:function(e){return this.getView().exists(e)}},{key:"insertBefore",value:function(e,t,r,n){var i,o=1*e;return(o<0||o>t)&&(o=-1),o>=(i=this.getView().GetWebViewer().GetHowManyImagesInBuffer())&&(o=i),this._updateUIAfterAdd(o,r,n,!1)}},{key:"insert",value:function(e,t,r,n){var i,o=1*e;return(o<0||o>t)&&(o=-1),o>=(i=this.getView().GetWebViewer().GetHowManyImagesInBuffer())&&(o=i),this._updateUIAfterAdd(o,r,n,!1)}},{key:"_updateUIAfterAdd",value:function(e,t,r,n){var i=this.getView();return!(t<0)&&i.AddImage(e,t,r,n)}},{key:"removeByServerId",value:function(e,t){var r=this,n=e,i=r.GetCurrentFileName();if(!n||n==i){var o=r.convertServerIdToClientIndex(t);if(o<0&&(o=r.getWebViewer().ConvertServerIdToIndexInFile(n,t))>=0){var a=r.getUidByIndex(o);r.getView().innerInsertModel(t,a)}if(o>=0)return r.remove(t)}return r.getView().RemoveByServerId(e,t)}},{key:"remove",value:function(e){var t=this.getView(),r=this.convertServerIdToClientIndex(e);return t.RemoveImage(r,e)}},{key:"MoveImage",value:function(e,t){return this.getView().MoveImage(e,t)}},{key:"SwitchImage",value:function(e,t){return this.getView().SwitchImage(e,t)}},{key:"GetImageHeight",value:function(e){var t,r,n,i,o=this,a=1*e;if(r=o.getView(),t=o.count(),a<0||a>t)return 0;if(o._stwain._isMobileMode()){var s=r._webViewer.GetMetaDataByIndex(a);return s&&s.height?s.height:0}return i=o.convertClientIndexToServerId(a),(n=r.GetDataImageControl(i))&&n.imageHeight?n.imageHeight:o._stwain.GetImageHeight(a)}},{key:"GetImageWidth",value:function(e){var t,r,n,i,o=this,a=1*e;if(r=o.getView(),t=o.count(),a<0||a>t)return 0;if(o._stwain._isMobileMode()){var s=r._webViewer.GetMetaDataByIndex(a);return s&&s.width?s.width:0}return i=o.convertClientIndexToServerId(a),(n=r.GetDataImageControl(i))&&n.imageWidth?n.imageWidth:o._stwain.GetImageWidth(a)}},{key:"get",value:function(e){var t,r,n,i=this,o=parseInt(e);return r=i.getView(),t=i.count(),!(o<0||o>t)&&(n=i.convertClientIndexToServerId(o),r.GetDataImageControl(n))}},{key:"refresh",value:function(e,t,r,n){var i,o=this,a=1*e;if(r){var s,u;if(u=o.getView(),s=o.count(),a<0||a>s)return!1;i=o.convertClientIndexToServerId(a),u.SetDataImageControl(a,i,n)}return!0}},{key:"Go",value:function(e){return this.getView().Go(e)}},{key:"__Next",value:function(){return this.getView().__Next()}},{key:"__Previous",value:function(){return this.getView().__Previous()}},{key:"SetSelectedClientIndexArray",value:function(e){return this.getView().SetSelectedindexes(e)}},{key:"getSelectedClientIndexArray",value:function(){return this.getView().GetSelectedindexes()}},{key:"GetZoom",value:function(){return this.getView().GetZoom()}},{key:"SetZoom",value:function(e){return this.getView().SetZoom(e)}},{key:"__GetPrintUrl",value:function(e,t,r){var n,i,o=this,a=0,s=0;return(n=o.getView().GetDataImageControl(t))&&(!n.width||n.width<=0?n.width=o.GetImageWidth(r):a=n.width,!n.height||n.height<=0?n.height=o.GetImageHeight(r):s=n.height,i=new as(e,n.width,n.height),n.width=a,n.height=s),i}},{key:"__GetPrintUrlforHttp",value:function(e,r){var n=this,i=n.getView();t.each(e,(function(e){var t=n.convertClientIndexToServerId(e);if(-1!=t){var o=os.getImageUrl(i.BaseUrl,t,-1,-1),a=n.__GetPrintUrl(o,t,e);r.push(a)}})),os.print(r)}},{key:"__GetPrintUrlforSocket",value:function(e,r){var n,i=this,o=t.Promise.resolve(0),a=0;return t.each(e,(function(t){o=o.then((function(){var o=i.convertClientIndexToServerId(t);if(-1!=o){var s=i.getWebViewer().GetUidByIndex(t);i.getWebViewer().GetImageData(s).then((function(s){a++,n=s.oriData instanceof ArrayBuffer?URL.createObjectURL(new Blob([s.oriData])):s.oriData instanceof Blob?URL.createObjectURL(s.oriData):s.oriData;var u=i.__GetPrintUrl(n,o,t);r.push(u),e.length==a&&os.print(r)}))}}))})),!0}},{key:"__GetPrintUrlforMobileEx",value:function(e,r){var n,i=this,o=t.Promise.resolve(0),a=0;return t.each(e,(function(t){o=o.then((function(){var o=i.convertClientIndexToServerId(t);if(-1!=o){var s=i.getWebViewer().GetUidByIndex(t);i.getWebViewer().GetImageData(s).then((function(s){a++,n=s.oriData instanceof ArrayBuffer?URL.createObjectURL(new Blob([s.oriData])):s.oriData instanceof Blob?URL.createObjectURL(s.oriData):s.oriData;var u=i.__GetPrintUrl(n,o,t);r.push(u),e.length==a&&os.print(r)}))}}))})),!0}},{key:"PrintEx",value:function(t){var r=this;if(!(r.count()<=0)){var n=[];return r._stwain._isMobileMode()?r.__GetPrintUrlforMobileEx(t,n):e.DWT.ConnectWithSocket?r.__GetPrintUrlforSocket(t,n):r.__GetPrintUrlforHttp(t,n),!0}}},{key:"Print",value:function(){var e=this;if(e.count()<=0)return!1;var t,r=[];for(t=0;t<e.count();t++)r.push(t);return e.PrintEx(r)}},{key:"_isNoViewer",value:function(){return!this._stwain._bBindViewer}},{key:"ChangeSize",value:function(e,t){return this.getView().ChangeImageViewSize(e,t)}},{key:"GetWidth",value:function(){return this.getView().GetWidth()}},{key:"SetWidth",value:function(e,t){return!!this._isNoViewer()||this.getView().SetWidth(e)}},{key:"GetHeight",value:function(){return this.getView().GetHeight()}},{key:"SetHeight",value:function(e,t){return!!this._isNoViewer()||this.getView().SetHeight(e)}},{key:"SetViewMode",value:function(e,t){var r=this;return r._isNoViewer()?r._stwain._nouiNotSupport("SetViewMode"):r.getView().SetViewMode(e,t)}},{key:"ShowImageEditorEx",value:function(r,n,i,o,a,s,u,c){var l=this;if(l._isNoViewer())return l._stwain._nouiNotSupport("ShowImageEditorEx");switch(a){case 0:case 1:case 2:break;case 3:if(l.getWebViewer().OnCloseImageEditor())return!0}var d,h,g=document;h=l.getView(),l.getTwain()._containerElement==u&&(s=!1,vu("warning: cannot use the same DIV for the main viewer and the editor viewer."));for(var f=0;f<e.DWT.DynamicContainers.length;f++)if(e.DWT.DynamicContainers[f].ContainerId==u){s=!1,vu("warning: cannot use an DIV which is already consumed by the method CreateDWTObject.");break}if(s&&u&&(t.isDOM(u)?d=u:t.isShadowRoot(u)?(d=document.createElement("div"),u.appendChild(d)):(d=g.getElementById(u))&&"DIV"!=d.nodeName&&(vu("warning: cannot create the editor viewer in a non-DIV element."),s=!1)),s&&u&&t.isDOM(u)){var m=t.getShadowRoot(u);if(m){var _,p,v=e.Lib.timestamp;return(_=g.createElement("link")).href=[e.DWT.ResourcesPath,"/src/dynamsoft.viewer.css",v].join(""),_.rel="stylesheet",_.async=!0,(p=g.createElement("link")).href=[e.DWT.ResourcesPath,"/src/dynamsoft.webtwain.css",v].join(""),p.rel="stylesheet",p.async=!0,t.scriptOnload(_,(function(){t.scriptOnload(p,(function(){return h.GetWebViewer().ShowImageEditor(d,s,i,o)})),m.appendChild(p)})),m.appendChild(_),!0}}return h.GetWebViewer().ShowImageEditor(d,s,i,o)}},{key:"SetSelectionRectAspectRatio",value:function(e){return this.getView().SetSelectionRectAspectRatio(e)}},{key:"GetSelectionRectAspectRatio",value:function(){return this.getView().GetSelectionRectAspectRatio()}},{key:"GetSelectionImageBorderColor",value:function(){return this.getView().GetSelectionImageBorderColor()}},{key:"SetSelectionImageBorderColor",value:function(e){var t=e;return this.getView().SetSelectionImageBorderColor(t)}},{key:"GetBackgroundColor",value:function(){return this.getView().GetBackgroundColor()}},{key:"SetBackgroundColor",value:function(e,t){var r;return!!this._isNoViewer()||(r=this.getView(),t?r.SetBackgroundColor(e,!0):r.SetBackgroundColor(e))}},{key:"GetAllowMultiSelect",value:function(){var e=this.getView();return!this._isNoViewer()&&e.GetAllowMultiSelect()}},{key:"SetAllowMultiSelect",value:function(e){var t=this.getView();return!!this._isNoViewer()||t.SetAllowMultiSelect(e)}},{key:"GetFitWindowType",value:function(){var e=this.getView();return this._isNoViewer()?0:e.GetFitWindowType()}},{key:"SetFitWindowType",value:function(e){var t=this.getView();return!!this._isNoViewer()||t.SetFitWindowType(e)}},{key:"GetIfFitWindow",value:function(){var e=this.getView();return!!this._isNoViewer()||e.GetIfFitWindow()}},{key:"SetIfFitWindow",value:function(e){var t=this.getView();return!!this._isNoViewer()||t.SetIfFitWindow(e)}},{key:"GetImageMargin",value:function(){var e=this.getView();return this._isNoViewer()?0:e.GetImageMargin()}},{key:"SetImageMargin",value:function(e){var t=this.getView();return!!this._isNoViewer()||t.SetImageMargin(e)}},{key:"GetMouseShape",value:function(){var e=this.getView();return this._isNoViewer()?0:e.GetMouseShape()}},{key:"SetMouseShape",value:function(e){var t=this.getView();return!!this._isNoViewer()||t.SetMouseShape(e)}},{key:"GetShowPageNumber",value:function(){var e=this.getView();return!this._isNoViewer()&&e.GetShowPageNumber()}},{key:"SetShowPageNumber",value:function(e){var t=this.getView();return!!this._isNoViewer()||t.SetShowPageNumber(e)}},{key:"GetIfAutoScroll",value:function(){return this.getView().GetIfAutoScroll()}},{key:"SetIfAutoScroll",value:function(e){return this.getView().SetIfAutoScroll(e)}},{key:"OverlayRectangle",value:function(e,t,r,n,i,o,a){return!!this._isNoViewer()||this.getView().OverlayRectangle(e,t,r,n,i,o,a)}},{key:"SetSelectedImageArea",value:function(e,t,r,n,i){var o=this.getView();return e==o.GetWebViewer().GetCurrentIndex()&&(!!this._isNoViewer()||o.SetSelectedImageArea(t,r,n,i))}},{key:"ShowImagesByFilter",value:function(e,t,r){return this.getView().FilterImagesByTag(e,t,r)}},{key:"ClearFilter",value:function(){return this.getView().ClearFilter()}},{key:"GetServerIdListByTag",value:function(e){return this.getView().GetServerIdListByTag(e)}},{key:"GetAllServerIdList",value:function(){return this.getView().GetServerIdList()}},{key:"RemoveImageTag",value:function(e){return this.getView().RemoveImageTag(e)}},{key:"SetDefaultTag",value:function(e){return this.getView().SetDefaultTag(e)}},{key:"AddImageTag",value:function(e,t){return this.getView().AddImageTag(e,t)}},{key:"GetCurrentTag",value:function(){return this.getView().GetCurrentTag()}},{key:"RenameTag",value:function(e,t){return this.getView().RenameTag(e,t)}},{key:"RemoveTag",value:function(e,t){return this.getView().RemoveTag(e,t)}},{key:"GetTagList",value:function(){return this.getView().GetTagList()}},{key:"GetTagListByIndex",value:function(e){return this.getView().GetTagListByIndex(e)}},{key:"OpenFile",value:function(e){return this.getView().OpenFile(e)}},{key:"CreateFile",value:function(e){return this.getView().CreateFile(e)}},{key:"GetCurrentFileName",value:function(){return this.getView().GetCurrentFileName()}},{key:"RemoveFile",value:function(e){return this.getView().RemoveFile(e)}},{key:"RenameFile",value:function(e,t){return this.getView().RenameFile(e,t)}},{key:"GetFileInfoList",value:function(){return this.getView().GetFileInfoList()}},{key:"GetImageIdsByFileName",value:function(e){return this.getView().GetImageIdsByFileName(e)}},{key:"BindView",value:function(e){var r=this.getView(),n=e;return t.isString(e)?n=t.get(e):t.isDOM(n)&&(n.id&&""!=n.id||(n.id=["dwt_",t.getRandom()].join(""))),r.BindView(n)}},{key:"UnbindView",value:function(){return this.getView().UnbindView()}},{key:"GetIfShowVideoContainer",value:function(){return this.getView().GetIfShowVideoContainer()}},{key:"ShowVideoContainer",value:function(e){return this.getView().ShowVideoContainer(e)}},{key:"UpdateVideoContainer",value:function(e){return this.getView().UpdateVideoContainer(e)}},{key:"GetImageData",value:function(e){var t=this,r=t.getView(),n=t.convertServerIdToClientIndex(e);return n>=0?r.GetImageData(t.getUidByIndex(n)):NaN}},{key:"RegistLoadCallback",value:function(e){return this.getView().RegistLoadCallback(e)}},{key:"insertImage",value:function(e,t,r){this.getWebViewer().InsertImage(e,t,r)}}]),r}();t.UI.ImageManager=yu;var bu=function(){function e(t){Le(this,e);var r=this;r._parent=t,cs(r,"width",{get:function(){return this._parent._width},set:function(e){this.SetSize(e,!1)}}),cs(r,"height",{get:function(){return this._parent._height},set:function(e){this.SetSize(!1,e)}})}return Ae(e,[{key:"SetSize",value:function(e,r){var n,i=this._parent,o=!1,a=!1;return!!i._isBindViewer()&&(t.isString(e)&&e.length>0&&"%"===e.charAt(e.length-1)&&(o=e),!o&&e&&(n=parseInt(e))&&(o=n+"px"),t.isString(r)&&r.length>0&&"%"===r.charAt(r.length-1)&&(a=r),!a&&r&&(n=parseInt(r))&&(a=n+"px"),o&&(i._width=o),a&&(i._height=a),ns.changeImageUISize(i,o,a))}}]),e}(),Iu=function(e){t.dlgProgress||t.initProgress();var r=t.one(".dynamsoft-btnCancel");if(r&&r.getEL()){t.addEventListener(r[0],"mousedown",(function(){var r=t.cancelFrom;t.closeProgress(e,0),r==De||r==ke?t.bio&&(t.bio.abort(),t.bio=Or):r==xe||r==Pe?e.SetCancel():r==We&&t.isFunction(e.__OnCancel)&&e.__OnCancel()}))}};t.html5.ui={init:function(e,r){var n,i,o,a;Iu(e),e._isBindViewer()?(r.container?e._containerElement=r.container:r.containerId&&(e._containerElement=t.get(r.containerId)),e._width=r.width,e._height=r.height,n=t.one(e._containerElement)):e._containerElement=null,e._ifBindViewer=r.ifBindViewer,function(e,r){var n={Stwain:e},i=Or;if(e._isBindViewer()){var o,a=e._width,s=e._height;o=t.one(e._containerElement),t.isString(a)&&a.indexOf("%")>=0?(a=t.css(o,"width")*parseInt(a)/100,i=Rr):a=parseInt(a),t.isString(s)&&s.indexOf("%")>=0?(s=t.css(o,"height")*parseInt(s)/100,i=Rr):s=parseInt(s),n={Stwain:e,Container:r,Width:a,Height:s}}ns.bindUIViewEvents(e,n),e._ImgManager?(e._ImgManager&&e._ImgManager._UIView&&e._ImgManager._UIView.BackgroundColor&&(n.BackgroundColor=e._ImgManager._UIView.BackgroundColor),e._ImgManager._Init(e,n)):e._ImgManager=new yu(e,n),i&&ns.changeImageUISize(e,e._width,e._height)}(e,n),e._ifBindViewer||(i=e,o=e._config,a=o||{},i.__OnImageAreaDeSelected=a.onImageAreaDeSelected||"",i.__OnImageAreaSelected=a.onImageAreaSelected||"",i.__OnMouseClick=a.onMouseClick||"",i.__OnMouseDoubleClick=a.onMouseDoubleClick||"",i.__OnMouseMove=a.onMouseMove||"",i.__OnMouseRightClick=a.onMouseRightClick||"",i.__OnTopImageInTheViewChanged=a.onTopImageInTheViewChanged||"",i.__OnBufferChanged=a.onBufferChanged||"",e.__OnMouseClick=r.onMouseClick||"",e.__OnThumbnailMouseClick="",e.__OnKeyDown=r.onKeyDown||"",e.__OnMouseWheel=r.onMouseWheel||"",e.__OnMouseDoubleClick=r.onMouseDoubleClick||"",e.__OnMouseRightClick=r.onMouseRightClick||"",e.__OnMouseMove=r.onMouseMove||"",e.__OnImageAreaSelected=r.onImageAreaSelected||"",e.__OnImageAreaDeSelected=r.onImageAreaDeSelected||"",e.__OnRefreshUI=r.onRefreshUI||"",e.__OnBufferChanged=r.onBufferChanged||"",e.__MouseX=0,e.__MouseY=0,e.__style=new bu(e),e.__fSelectionRectAspectRatio=0)},unLoad:function(e){var t=e._containerElement;t&&(t.innerHTML="")},initProgress:function(e){Iu(e)},addMethods:function(e){e._bRemoteMode||t.mix(e,{OverlayRectangle:function(e,r,n,i,o,a,s){var u,c=this;return c._resetErr(),!!c._isValid()&&(c._isNoViewer()?c._nouiNotSupport("OverlayRectangle"):r>i||n>o||r==i&&n==o?(t.Errors.Overlay_InvalidLeftOrTopOrRightOrBottom(c),!1):(u=t.isNumber(a)?t.getColor(a):a,c._ImgManager.OverlayRectangle(e,r,n,i,o,u,s)))},SetViewMode:function(e,r){var n=this;if(n._resetErr(),!n._isValid())return!1;if(n._isNoViewer())return n._nouiNotSupport("SetViewMode");if(t.isString(e)||t.isString(r)||e<-1&&r<-1)return t.Errors.InvalidValue(n),Or;var i=Math.floor(e),o=Math.floor(r);return n._ImgManager.SetViewMode(i,o),!0},Print:function(e){var t=this;if(t._resetErr(),!t._isValid())return!1;if(t._isNoViewer())return t._nouiNotSupport("Print");if(!t._isMobileMode()&&e){return t._innerSend("PrintEx",Zn(!0),!0,(function(){}),(function(){})),!0}return t._ImgManager.Print(),!0},PrintEx:function(e){var r=this;return r._resetErr(),!!r._isValid()&&(t.isArray(e)?r._isNoViewer()?r._nouiNotSupport("Print"):!!r._checkIndices(e)&&(r._ImgManager.PrintEx(e),!0):(t.Errors.IndicesNotArray(r),!1))},ShowImageEditor:function(e,t,r,n){var i=this;if(i._resetErr(),!i._isValid())return!1;if(i._isNoViewer())return i._nouiNotSupport("ShowImageEditor");if(i._isMobileMode());else if(ti.isServerInvalid(i))return Or;return i._ImgManager.getWebViewer().bShowImageEdit?i.ShowImageEditorEx(-1,-1,-1,-1,3):e&&t&&r?i.ShowImageEditorEx(-1,-1,t,r,0,!0,e,n):i.ShowImageEditorEx(-1,-1,-1,-1,0,!1)},ShowImageEditorEx:function(e,t,r,n,i,o,a,s){var u=this;return u._resetErr(),!!u._isValid()&&(u._isNoViewer()?u._nouiNotSupport("ShowImageEditorEx"):u._ImgManager.ShowImageEditorEx(e,t,r,n,i,o,a,s))},SetSelectedImageArea:function(e,r,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return!1;if(a._isNoViewer())return a._nouiNotSupport("SetSelectedImageArea");var s=parseInt(e);return isNaN(s)||s<0||s>=a._ImgManager.count()?(t.Errors.IndexOutOfRange(a),!1):!(!a._isMobileMode()&&ti.isServerInvalid(a))&&a._ImgManager.SetSelectedImageArea(s,r,n,i,o)},first:function(){var e=this,t=e._ImgManager.count();return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("first"):(t>0&&(e._ImgManager.Go(0),ns.__innerRefreshFromUIView(e,e._ImgManager.getCurrentImageIndex())),Rr))},previous:function(){var e=this,t=e._ImgManager.count();return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("previous"):(t>0&&(e._ImgManager.__Previous(),ns.__innerRefreshFromUIView(e,e._ImgManager.getCurrentImageIndex())),Rr))},next:function(){var e=this,t=e._ImgManager.count();return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("next"):(t>0&&(e._ImgManager.__Next(),ns.__innerRefreshFromUIView(e,e._ImgManager.getCurrentImageIndex())),Rr))},last:function(){var e=this,t=e._ImgManager.count();return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("last"):(t>0&&(e._ImgManager.Go(t-1),ns.__innerRefreshFromUIView(e,e._ImgManager.getCurrentImageIndex())),Rr))}})}},t.attachPropertyUI=function(e){e._bRemoteMode||(cs(e,"Width",{get:function(){return e._resetErr(),e._isValid()?e._isNoViewer()?(e._nouiNotSupport("Width"),""):e._ImgManager.GetWidth():""},set:function(t){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("Width"):e._ImgManager.SetWidth(t))}}),cs(e,"Height",{get:function(){return e._resetErr(),e._isValid()?e._isNoViewer()?(e._nouiNotSupport("Height"),""):e._ImgManager.GetHeight():""},set:function(t){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("Height"):e._ImgManager.SetHeight(t))}}),cs(e,"AllowMultiSelect",{get:function(){return e._resetErr(),e._isValid()?e._isNoViewer()?e._nouiNotSupport("AllowMultiSelect"):e._ImgManager.GetAllowMultiSelect():""},set:function(t){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("AllowMultiSelect"):void e._ImgManager.SetAllowMultiSelect(t))}}),cs(e,"BackgroundColor",{get:function(){return e._resetErr(),e._isValid()?e._isNoViewer()?(e._nouiNotSupport("BackgroundColor"),""):e._ImgManager.GetBackgroundColor():""},set:function(t){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("BackgroundColor"):e._ImgManager.SetBackgroundColor(t))}}),cs(e,"BackgroundFillColor",{get:function(){if(e._resetErr(),!e._isValid())return"";if(e._isNoViewer())return e._nouiNotSupport("BackgroundFillColor"),"";if(e._isMobileMode()){var r=e.__backgroundFillColor;if(t.isUndefined(r)&&(r=e._ImgManager._UIView.BackgroundFillColor),t.isNumber(r))return t.getColor(r);var n=parseInt(r.slice(1),16);return r=n}var i=e._innerFun("BackgroundFillColor");return t.BGR2RGB(i)},set:function(r){if(e._resetErr(),!e._isValid())return!1;if(e._isNoViewer())return e._nouiNotSupport("BackgroundFillColor");var n,i=1*r;return!t.isNumber(i)||isNaN(i)?(t.Errors.InvalidValue(e),Or):e._isMobileMode()?(e._ImgManager._UIView.SetBackgroundFillColor(t.getColor(i)),e.__backgroundFillColor=t.getColor(i),!0):(n=t.RGB2BGR(i),e._innerFun("BackgroundFillColor",Zn(n)))}}),cs(e,"FitWindowType",{get:function(){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?(e._nouiNotSupport("FitWindowType"),0):e._ImgManager.GetFitWindowType())},set:function(t){if(e._resetErr(),!e._isValid())return!1;if(e._isNoViewer())return e._nouiNotSupport("FitWindowType");var r=1*t;return e._ImgManager.SetFitWindowType(r)}}),cs(e,"IfFitWindow",{get:function(){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("IfFitWindow"):e._ImgManager.GetIfFitWindow())},set:function(t){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("IfFitWindow"):t?e._ImgManager.SetIfFitWindow(!0):e._ImgManager.SetIfFitWindow(!1))}}),cs(e,"ImageMargin",{get:function(){return e._resetErr(),e._isValid()?e._isNoViewer()?(e._nouiNotSupport("ImageMargin"),0):e._ImgManager.GetImageMargin():0},set:function(t){if(e._resetErr(),!e._isValid())return!1;if(e._isNoViewer())return e._nouiNotSupport("ImageMargin");var r=parseInt(t);return!isNaN(r)&&e._ImgManager.SetImageMargin(r)}}),cs(e,"MouseX",{get:function(){return e._resetErr(),e._isValid()?e._isNoViewer()?(e._nouiNotSupport("MouseX"),0):e.__MouseX:0}}),cs(e,"MouseY",{get:function(){return e._resetErr(),e._isValid()?e._isNoViewer()?(e._nouiNotSupport("MouseY"),0):e.__MouseY:0}}),cs(e,"SelectionImageBorderColor",{get:function(){return e._resetErr(),e._isValid()?e._isNoViewer()?(e._nouiNotSupport("SelectionImageBorderColor"),""):e._ImgManager.GetSelectionImageBorderColor():""},set:function(t){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("SelectionImageBorderColor"):e._ImgManager.SetSelectionImageBorderColor(t))}}),cs(e,"Zoom",{get:function(){return e._resetErr(),e._isValid()?e._isNoViewer()?(e._nouiNotSupport("Zoom"),0):e._ImgManager.GetZoom():0},set:function(t){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("Zoom"):e._ImgManager.SetZoom(t))}}),cs(e,"MouseShape",{get:function(){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("MouseShape"):e._ImgManager.GetMouseShape()==x)},set:function(t){if(e._resetErr(),!e._isValid())return!1;if(e._isNoViewer())return e._nouiNotSupport("MouseShape");var r=P;return t&&(r=x),e._ImgManager.SetMouseShape(r)}}),cs(e,"SelectionRectAspectRatio",{get:function(){return e._resetErr(),e._isValid()?e._isNoViewer()?(e._nouiNotSupport("SelectionRectAspectRatio"),0):e._ImgManager.GetSelectionRectAspectRatio():0},set:function(t){if(e._resetErr(),!e._isValid())return!1;if(e._isNoViewer())return e._nouiNotSupport("SelectionRectAspectRatio");var r=parseFloat(t);return r>=0&&(e._ImgManager.SetSelectionRectAspectRatio(r),!0)}}),cs(e,"ShowPageNumber",{get:function(){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("ShowPageNumber"):e._ImgManager.GetShowPageNumber())},set:function(t){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("ShowPageNumber"):e._ImgManager.SetShowPageNumber(t))}}),cs(e,"IfAutoScroll",{get:function(){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("IfAutoScroll"):e._ImgManager.GetIfAutoScroll())},set:function(t){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("IfAutoScroll"):e._ImgManager.SetIfAutoScroll(t))}}))},t.detect.viewerScriptLoaded=Rr;function wu(e,r,n){var i={get:function(){return e._mobileNotSupport(r)}};(1===n||t.isUndef(n))&&(i.set=i.get),r in e||Object.defineProperty(e,r,i)}function Su(e,r,n){t.isArray(r)?t.each(r,(function(t){wu(e,t,n)})):wu(e,r,n)}function Tu(e,r,n,i){var o;0!==n&&1!==n?o=n:(o={},n&&(o.set=1==i?function(n){var i=1*n;return!t.isNumber(i)||isNaN(i)?(t.Errors.InvalidValue(e),Or):(e._resetErr(),!!e._isValid()&&e._innerFun(r,Zn(i)))}:2==i?function(n){return t.isBoolean(n)?(e._resetErr(),!!e._isValid()&&e._innerFun(r,Zn(n))):(t.Errors.InvalidValue(e),Or)}:function(n){return t.isString(n)?(e._resetErr(),!!e._isValid()&&e._innerFun(r,Zn(n))):(t.Errors.InvalidValue(e),Or)})),o.get||(o.get=function(){return e._resetErr(),!!e._isValid()&&e._innerFun(r)}),r in e||Object.defineProperty(e,r,o)}function Cu(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Eu(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Eu(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r["return"]||r["return"]()}finally{if(s)throw o}}}}function Eu(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Mu(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(es){return!1}}();return function(){var r,n=et(e);if(t){var i=et(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return $e(this,r)}}function Du(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function ku(e,t,r){if(!t.has(e));return r}function xu(e){var t=be;return e==ae?t=we:e==se?t=Se:gi(e)&&(t=Ie),t}function Pu(e,t){var r=new $n;return r.server=e,r.attrs=t,r}var Wu=new WeakSet,Lu=function(){function r(e,n,i,o){Le(this,r),Du(this,Wu),Ye(this,"serverUrl",undefined),this.serverUrl=e,this.bLocal=t.isLocalIP(e),this.clientId=null!=i?i:t.guid(),this.bGlobal=n,this.serverName=o,this.bLicenseOK=!1}var n,i;return Ae(r,[{key:"checkSource",value:function(e){if(!e)throw{code:-1003,message:"Source Manager unable to find the specified Source"}}},{key:"parseResultDefault",value:function(e){var r;if(t.isObject(e)&&e.exception&&0!=e.exception)throw{code:e.exception,message:null!==(r=e.description)&&void 0!==r?r:"general error"};if(e&&t.isArray(e.result)&&e.result.length>0){var n=e.result[e.result.length-1];try{return JSON.parse(n)}catch(es){return n}}throw e}},{key:"_requestAsync",value:(i=Ke(it.mark((function o(r,n,i){var a,s,u,c,l,d,h,g;return it.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(a=[Gn(),"/",r.method].join(""),!e.DWT.ConnectWithSocket){o.next=9;break}return o.next=4,ku(this,Wu,Fu).call(this);case 4:return c=o.sent,l=0,r&&(l=r.cmdId),d={client:c,userData:{command:r},taskId:l},o.abrupt("return",c.request(t.stringify(r),null,d));case 9:return n&&(s=n),h=(g=this).serverUrl?He.getDDMUrl(g.serverUrl,g.bGlobal,[Rn,r.method].join("")):He.getModuleUrl(a),o.prev=12,o.next=15,e.Lib.fetch(h,{method:"post",dataType:"json",body:e.Lib.stringify(r),fetchRaw:null!=i&&i,timeout:s});case 15:u=o.sent,o.next=21;break;case 18:throw o.prev=18,o.t0=o["catch"](12),o.t0;case 21:return o.abrupt("return",u);case 22:case"end":return o.stop()}}),o,this,[[12,18]])}))),function(e,t,r){return i.apply(this,arguments)})},{key:"_resetLicense",value:(n=Ke(it.mark((function a(e,t,r){return it.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),a)}))),function(e,t,r){return n.apply(this,arguments)})}]),r}();function Fu(){return Vu.apply(this,arguments)}function Vu(){return(Vu=Ke(it.mark((function r(){var n,i,o;return it.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if((n=this)._wsClient){r.next=10;break}return i=new Xe,this.serverUrl?t.startsWith(this.serverUrl,"wss://")?(i.ssl=!0,i.server=this.serverUrl.substring(8)):t.startsWith(this.serverUrl,"ws://")?(i.ssl=!1,i.server=this.serverUrl.substring(7)):(i.ssl=t.detect.ssl,i.server=this.serverUrl):(i.ssl=t.detect.ssl,i.server=h()),i.port=i.ssl?e.dcp.SSLPort:e.dcp.Port,i.useWS=!0,o=wr.Instance.getClient(i),r.next=9,o.testConnection();case 9:n._wsClient=o;case 10:return r.abrupt("return",n._wsClient);case 11:case"end":return r.stop()}}),r,this)})))).apply(this,arguments)}Ye(Lu,"logLevel",-1);var Nu,Au,Bu=0;function Ou(){return Bu=0,t.asyncQueue.pushToDo(null,e.Lib.product._setAndroidConnected),new t.Promise((function(t,r){Nu=t,Au=r,e.Lib.product._doCheckAndroidConnected()}))}e.Lib.product._setAndroidConnected=function(){e.Lib.product.bAndroidConnected=!0},e.Lib.product._doCheckAndroidConnected=function(){if(Bu++,e.DWT.bConnectCanceled&&Au){t.asyncQueue.stop();var r={};return t.Errors.UserCanceled(r),void Au({code:r._errorCode,message:r._errorString})}if(Bu>1e4&&Au){var n={};return t.Errors.DynamsoftServiceStopped(n),void Au({code:n._errorCode,message:n._errorString})}e.Lib.product.bAndroidConnected&&Nu?Nu():setTimeout(e.Lib.product._doCheckAndroidConnected,1e3)};var Ru=new WeakSet,Uu=function(e){Qe(n,e);var r=Mu(n);function n(){var e;Le(this,n);for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];return Du(Ze(e=r.call.apply(r,[this].concat(i))),Ru),e}return Ae(n,[{key:"getLicenseInfoSync",value:function(e,r){Ku();var n=null!=r?r:"",i={id:this.clientId,cmdId:t.guid(),method:"GetLicenseInfo",parameter:[e,Hu.logLevel,n],version:Un},o=ku(this,Ru,Gu).call(this,i,3e3);return this.parseResultDefault(o)}},{key:"getCapabilities",value:function(e){this.checkSource(e),(e.deviceType&ae)==ae||e.deviceType;var r=xu(e.deviceType),n={id:this.clientId,cmdId:t.guid(),method:"SendRequestToScanner",parameter:["getCapabilities",JSON.stringify({UUID:e.serviceInfo.attrs.UUID,service_type:r,ty:e.name})],version:Un},i=ku(this,Ru,Gu).call(this,n,0);return this.parseResultDefault(i)}},{key:"selectSource",value:function(e){var t=this.getCapabilities(e);return!(!t&&""!=t)}},{key:"dispose",value:function(){var e={id:this.clientId,cmdId:t.guid(),method:"dispose",version:Un};ku(this,Ru,Gu).call(this,e,500)}},{key:"disposeAsync",value:function(){var e={id:this.clientId,cmdId:t.guid(),method:"dispose",version:Un};this._requestAsync(e,500)}}]),n}(Lu);function Gu(r,n,i){var o,a,s=[Gn(),"/",r.method].join("");n&&(o=n),a=this.serverUrl?He.getDDMUrl(this.serverUrl,this.bGlobal,[Rn,r.method].join("")):He.getModuleUrl(s);var u="",c={method:"POST",url:a,data:e.Lib.stringify(r),async:!1,timeout:o,headers:{"X-Requested-With":!1},onSuccess:function(e,r,n){try{u=t.isString(e)&&"text/json"===n.getResponseHeader("content-type")?t.parse(e):e}catch(es){}},onError:function(){var e={};if(t.Errors.NetworkError(e),!t.page.bUnload)throw e}};return e.navInfoSync.bFileSystem&&(c.crossDomain=!1),t.ajax(c),u}var ju=new WeakSet,zu=new WeakSet,Hu=function(e){Qe(h,e);var r,n,i,o,a,s,u,c,l,d=Mu(h);function h(){var e;Le(this,h);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Du(Ze(e=d.call.apply(d,[this].concat(r))),zu),Du(Ze(e),ju),Ye(Ze(e),"_bInited",!1),Ye(Ze(e),"_currentDevice",undefined),e}return Ae(h,[{key:"getDynamsoftService",value:(l=Ke(it.mark((function g(e,r){var n,i,o,a,s,u,c,l,d,h,f;return it.wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return e=null!==(n=e)&&void 0!==n&&n,r=null!==(i=r)&&void 0!==i?i:30,o={id:this.clientId,cmdId:t.guid(),method:"SearchScanner",parameter:[1,"_privet._tcp.local.",!1,!0,e,r],version:Un},g.prev=5,g.next=8,this._requestAsync(o,3e4,!1);case 8:a=g.sent,this._bInited=!0,g.next=19;break;case 12:if(g.prev=12,g.t0=g["catch"](5),!this.bLocal){g.next=18;break}throw s={},t.Errors.DynamsoftServiceStopped(s),{code:s._errorCode,message:s._errorString};case 18:throw t.Errors.ThrowFailedConnectToProxyServer();case 19:u=[],c=this.parseResultDefault(a),l=Cu(c),g.prev=22,l.s();case 24:if((d=l.n()).done){g.next=40;break}if(!((h=d.value).service_type&&h.service_type==be||h.type&&"dynamsoft_private_cloud_scan"!=h.type&&"twaindirect"!=h.type)){g.next=30;break}return g.abrupt("continue",38);case 30:if(!h.service_type){g.next=38;break}g.t1=h.service_type,g.next=g.t1===Ie?34:38;break;case 34:return h.bGlobalFind=!0,f=Pu(this.serverUrl,h),u.push(f),g.abrupt("break",38);case 38:g.next=24;break;case 40:g.next=45;break;case 42:g.prev=42,g.t2=g["catch"](22),l.e(g.t2);case 45:return g.prev=45,l.f(),g.finish(45);case 48:return g.abrupt("return",u);case 49:case"end":return g.stop()}}),g,this,[[5,12],[22,42,45,48]])}))),function(e,t){return l.apply(this,arguments)})},{key:"getSources",value:(c=Ke(it.mark((function f(e,r,n){var i,o,a,s,u,c,l,d,h,g,m,_,p,v;return it.wrap((function(f){for(;;)switch(f.prev=f.next){case 0:if(a="",s=!1,u=[],c=!1,((l=null!=e?e:le)&ae)==ae&&(a="_uscan._tcp.local."),(l&se)==se&&(s=!0),0!=a.length||s){f.next=9;break}return f.abrupt("return",[]);case 9:return r=null!==(i=r)&&void 0!==i&&i,n=null!==(o=n)&&void 0!==o?o:30,d={id:this.clientId,cmdId:t.guid(),method:"SearchScanner",parameter:[1,a,s,c,r,n],version:Un},f.next=14,this._requestAsync(d,3e4,!1);case 14:if(h=f.sent,this._bInited=!0,g=this.parseResultDefault(h),t.isArray(g)){f.next=19;break}throw t.Errors.ThrowDevicesNotArray();case 19:m=Cu(g),f.prev=20,m.s();case 22:if((_=m.n()).done){f.next=47;break}if(!((p=_.value).service_type&&p.service_type==be||p.type&&"dynamsoft_private_cloud_scan"!=p.type&&"twaindirect"!=p.type)){f.next=28;break}return f.abrupt("continue",45);case 28:if(!p.service_type){f.next=45;break}f.t0=p.service_type,f.next=f.t0===Ie?32:f.t0===we||f.t0===Se?33:45;break;case 32:return f.abrupt("break",45);case 33:return(v=new Qn).name="",v.displayName="",v.deviceType=0,p.service_type==we?v.deviceType=ae:p.service_type==Se&&(v.deviceType=se),v.name=p.ty,p.hostname&&p.hostname.length>p.ty.length&&(v.name=p.hostname),v.displayName=(p.service_type==we?"eSCL-":"")+v.name,this.bGlobal||(p.url=this.serverUrl,this.serverName&&(v.displayName=v.displayName+" on ["+this.serverName+"]")),v.serviceInfo=Pu(this.serverUrl,p),u.push(v),f.abrupt("break",45);case 45:f.next=22;break;case 47:f.next=52;break;case 49:f.prev=49,f.t1=f["catch"](20),m.e(f.t1);case 52:return f.prev=52,m.f(),f.finish(52);case 55:return f.abrupt("return",u);case 56:case"end":return f.stop()}}),f,this,[[20,49,52,55]])}))),function(e,t,r){return c.apply(this,arguments)})},{key:"getCapabilitiesAsync",value:(u=Ke(it.mark((function m(e){var r,n,i;return it.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return this.checkSource(e),(e.deviceType&ae)!=ae&&(e.deviceType&se)!=se||(this._currentDevice=e),r=xu(e.deviceType),n={id:this.clientId,cmdId:t.guid(),method:"SendRequestToScanner",parameter:["getCapabilities",JSON.stringify({UUID:e.serviceInfo.attrs.UUID,service_type:r,ty:e.name})],version:Un},o.next=6,this._requestAsync(n,0);case 6:return i=o.sent,o.abrupt("return",this.parseResultDefault(i));case 8:case"end":return o.stop()}}),m,this)}))),function(e){return u.apply(this,arguments)})},{key:"selectSourceAsync",value:(s=Ke(it.mark((function _(e){var t;return it.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.getCapabilitiesAsync(e);case 2:if(!(t=r.sent)&&""!=t){r.next=5;break}return r.abrupt("return",!0);case 5:case"end":return r.stop()}}),_,this)}))),function(e){return s.apply(this,arguments)})},{key:"versionInfo",value:(a=Ke(it.mark((function p(){var e,r;return it.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e={id:this.clientId,cmdId:t.guid(),method:"VersionInfo",parameter:[],version:Un},n.next=3,this._requestAsync(e,5e3);case 3:return r=n.sent,this._bInited=!0,n.abrupt("return",r);case 6:case"end":return n.stop()}}),p,this)}))),function(){return a.apply(this,arguments)})},{key:"getLicenseInfo",value:function(e,t,r){return this._resetLicense(e,t,r)}},{key:"getImageAsArrayBuffer",value:(o=Ke(it.mark((function v(e,t){return it.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",ku(this,ju,Xu).call(this,e,t));case 1:case"end":return r.stop()}}),v,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"getImageToDWT",value:(i=Ke(it.mark((function y(e,t,r){return it.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",ku(this,ju,Xu).call(this,e,t,r));case 1:case"end":return n.stop()}}),y,this)}))),function(e,t,r){return i.apply(this,arguments)})},{key:"acquireImage",value:(n=Ke(it.mark((function b(e,r,n){var i,o,a,s,u,c,l,d;return it.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e=null!==(i=e)&&void 0!==i?i:this._currentDevice,this.checkSource(e),this._currentDevice=e,o=xu(e.deviceType),a=["scan",JSON.stringify({UUID:e.serviceInfo.attrs.UUID,service_type:o})],s=ku(this,zu,Ju).call(this,r),a[2]=JSON.stringify(s),u={id:this.clientId,cmdId:t.guid(),method:"SendRequestToScanner",parameter:a,version:Un},c=0;case 10:if(!(c<5)){n.next=33;break}return n.prev=11,n.next=14,this._requestAsync(u,0);case 14:return d=n.sent,l=this.parseResultDefault(d),t.isObject(l)&&(l.device=e,l.scanOptions=s),n.abrupt("break",33);case 20:if(n.prev=20,n.t0=n["catch"](11),-1004!=n.t0.code&&-1001!=n.t0.code){n.next=29;break}if(!(c>=4)){n.next=25;break}throw n.t0;case 25:return n.next=27,new Promise((function(e,t){setTimeout(e,2e3)}));case 27:n.next=30;break;case 29:throw n.t0;case 30:c++,n.next=10;break;case 33:return n.abrupt("return",l);case 34:case"end":return n.stop()}}),b,this,[[11,20]])}))),function(e,t,r){return n.apply(this,arguments)})},{key:"dispose",value:function(){var e={id:this.clientId,cmdId:t.guid(),method:"dispose",version:Un};this._requestAsync(e,500)}},{key:"_resetLicense",value:(r=Ke(it.mark((function I(e,r,n){var i,o,a,s;return it.wrap((function(u){for(;;)switch(u.prev=u.next){case 0:return this.longKeyOrShortkey=e,this.cu=r,Ku(),i=null!=r?r:"",o={id:this.clientId,cmdId:t.guid(),method:"GetLicenseInfo",parameter:[e,h.logLevel,i,n],version:Un},u.prev=5,u.next=8,this._requestAsync(o,1e4);case 8:return a=u.sent,this._bInited=!0,u.abrupt("return",this.parseResultDefault(a));case 13:if(u.prev=13,u.t0=u["catch"](5),!this.bLocal){u.next=19;break}throw s={},t.Errors.DynamsoftServiceStopped(s),{code:s._errorCode,message:s._errorString};case 19:throw t.Errors.ThrowFailedConnectToProxyServer();case 20:case"end":return u.stop()}}),I,this,[[5,13]])}))),function(e,t,n){return r.apply(this,arguments)})}]),h}(Lu);function Xu(e,t,r){return Yu.apply(this,arguments)}function Yu(){return(Yu=Ke(it.mark((function e(r,n,i){var o,a,s,u,c,l;return it.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=r&&r.device){e.next=2;break}throw{code:-1011,message:"Operation out of expected sequence"};case 2:return i=null!==(o=i)&&void 0!==o?o:{ver:"",clientId:""},(a=["getImage",JSON.stringify({UUID:r.device.serviceInfo.attrs.UUID,service_type:n})])[2]=JSON.stringify(r.scanOptions),a[3]=r.scanJobs,a[4]=r.scanId,a[5]=i._clientId,a[6]=i._ver,s={id:this.clientId,cmdId:t.guid(),method:"SendRequestToScanner",parameter:a,version:Un},e.next=12,this._requestAsync(s,0,!0);case 12:if(u=e.sent,!(u.headers.get("content-type").indexOf("image/")>=0)){e.next=20;break}return e.next=17,u.arrayBuffer();case 17:return e.abrupt("return",e.sent);case 20:return e.next=22,u.json();case 22:if(c=e.sent,"boolean"!=typeof(l=this.parseResultDefault(c))){e.next=28;break}return e.abrupt("return",null);case 28:return e.abrupt("return",l);case 29:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function Ju(r){var n=[];if(r){t.isNumber(r.PixelType)&&(n.push({capability:e.DWT.EnumDWT_Cap.ICAP_PIXELTYPE,curValue:r.PixelType}),e.DWT.EnumDWT_PixelType.TWPT_BW==r.PixelType&&(n.push({capability:32771,curValue:"application/octet-stream"}),n.push({capability:32772,curValue:"application/octet-stream"})));var i=r.Resolution;i||(i=300),n.push({capability:e.DWT.EnumDWT_Cap.ICAP_XRESOLUTION,curValue:i}),n.push({capability:e.DWT.EnumDWT_Cap.ICAP_YRESOLUTION,curValue:i}),r.Brightness!==undefined&&n.push({capability:e.DWT.EnumDWT_Cap.ICAP_BRIGHTNESS,curValue:r.Brightness}),r.XferCount!==undefined&&n.push({capability:e.DWT.EnumDWT_Cap.CAP_XFERCOUNT,curValue:r.XferCount}),r.Contrast!==undefined&&n.push({capability:e.DWT.EnumDWT_Cap.ICAP_CONTRAST,curValue:r.Contrast}),r.TransferMode!==undefined&&n.push({capability:e.DWT.EnumDWT_Cap.ICAP_XFERMECH,curValue:r.TransferMode}),r.IfFeederEnabled!==undefined&&n.push({capability:e.DWT.EnumDWT_Cap.CAP_FEEDERENABLED,curValue:r.IfFeederEnabled?1:0}),r.IfDuplexEnabled!==undefined&&n.push({capability:e.DWT.EnumDWT_Cap.CAP_DUPLEXENABLED,curValue:r.IfDuplexEnabled?1:0})}return n}function Ku(){var e=Hu.logLevel;t.isNumber(e)||(Hu.logLevel=-1)}var Zu=e.navInfoSync;t.removeNonPrintableChar;var qu=function(e,r,n){2==n&&t.each(r,(function(t,r){cs(e,t,{get:function(){return e._resetErr(),e._isValid()?Rr:Or},set:function(t){return e._resetErr(),e._isValid()?Rr:Or}})}))},Qu=function(e,r){t.each(r,(function(t,r){Tu(e,t,1,2)}))},$u=function(e,r){t.each(r,(function(t,r){Tu(e,t,1,1)}))},ec=function(e,r){t.each(r,(function(t,r){Tu(e,t,0)}))},tc=function(e,r){t.each(r,(function(t,r){Tu(e,t,1)}))};function rc(e,r){var n,i=this,o=0;n=t.isString(e)?document.getElementById(e):e,i.isLoaded=!1,i.displayType=0,i.progress=0,i.progressPosition=0,i.borderWidth={left:0,right:0,top:0,bottom:0},i.orientation=r.orientation||rc.Orientation.Horizontal,i.direction=r.direction||rc.Direction.LeftToRight,i.creationType=r.creationType||rc.CreationType.Replace,i.value=0,i.initialValue=r.value||0,i.minValue=r.minValue||0,i.maxValue=r.maxValue||100,i.showLabel="undefined"==typeof r.showLabel||r.showLabel,i.labelText=r.labelText||"",i.width=r.width||280,i.height=r.height||20,i.borderRadius=r.borderRadius||10,i.orientation==rc.Orientation.Horizontal&&i.borderRadius>i.height/2&&(i.borderRadius=Math.round(i.height/2)),i.orientation==rc.Orientation.Vertical&&i.borderRadius>i.width/2&&(i.borderRadius=Math.round(i.width/2)),i.backColor=r.backColor||"",i.color=r.color||"#50a8e1",i.animationStyle=0,i.animationInterval=r.animationInterval||100;var a=["parent","background","wrapper","left","middle","right","horizontalText","verticalText","marker"];for(i.extraClassName={},o=0;o<a.length;o++)r.extraClassName?"string"==typeof r.extraClassName?i.extraClassName[a[o]]=r.extraClassName:i.extraClassName[a[o]]=r.extraClassName[a[o]]||"":i.extraClassName[a[o]]="";i.onLoad=r.onLoad||null,i.onValueChanged=r.onValueChanged||null,i.onAnimate=r.onAnimate||null,i.creationType==rc.CreationType.Replace?i.parentElement=n:(i.parentElement=document.createElement("DIV"),n.appendChild(i.parentElement)),i.finishLoading()}t.DynamicLoadAddonFuns=[],t.attachAddon=function(e){t.each(t.DynamicLoadAddonFuns,(function(r){t.isFunction(r)&&r(e)})),!t.product.bFullEdition&&e.__addon&&delete e.__addon.Camera},t.attachProperty=function(r){var n=r;if(!n._bRemoteMode){cs(n,"ProductKey",{get:function(){return e.DWT.ProductKey},set:function(e){return t.isString(e)?(n._resetErr(),!!n._isValid()&&n._setProductKey(e,!1)):(t.Errors.InvalidValue(n),Or)}}),cs(n,"ProductName",{get:function(){return n.__strProductName},set:function(e){return n._resetErr(),t.isString(e)?(n.__strProductName=e,Rr):(t.Errors.InvalidValue(n),Or)}}),cs(n,"VersionInfo",{get:function(){return n.__versionInfo}}),n._isMobileMode()?Su(n,"DefaultSourceName",0):cs(n,"DefaultSourceName",{get:function(){var e=n._getDefaultDevice();return e?e.displayName:""}}),n._isMobileMode()?Su(n,["ImageCaptureDriverType","IfShowCancelDialogWhenImageTransfer"]):(cs(n,"IfShowCancelDialogWhenImageTransfer",{get:function(){return n._resetErr(),!!n._isValid()&&n.__IfShowCancelDialogWhenImageTransfer},set:function(e){return t.isBoolean(e)?(n._resetErr(),!!n._isValid()&&(n.__IfShowCancelDialogWhenImageTransfer=e)):(t.Errors.InvalidValue(n),Or)}}),cs(n,"ImageCaptureDriverType",{get:function(){return n._resetErr(),n._isValid()?n._driverType:0},set:function(e){var r=!1,i=!1,o=!1;if(n._bRemoteMode?n.__serverPlatform==I?o=!0:n.__serverPlatform==S?i=!0:n.__serverPlatform==w&&(r=!0):(r=Zu.bMac,i=Zu.bLinux,o=Zu.bWin),n._resetErr(),!n._isValid())return!1;if(""!==e){var a=1*e,s=!1;if(a<j||a>J)return t.Errors.ImageCaptureDriverTypeError(n),Or;if(o){if(a===Y)n._b64bit&&(n._driverType=a);else if(a!=j&&a!=J)return t.Errors.ImageCaptureDriverTypeError(n),Or;n._b64bit||(a=j),n._driverType=a,s=!0}else if(i)a=H,n._driverType=a,s=!0;else if(r){if(a===X);else if(a!=z&&a!=j&&a!=J)return t.Errors.ImageCaptureDriverTypeError(n),Or;n._driverType=a,s=!0}return s&&(n._curDevice=null,n.__devices=null),!0}return t.Errors.ImageCaptureDriverTypeError(n),Or}})),cs(n,"HTTPPostResponseString",{get:function(){return n._resetErr(),n._isValid()&&n.__HTTPPostResponseString?n.__HTTPPostResponseString:""}}),cs(n,"IfAppendImage",{get:function(){return n._resetErr(),!!n._isValid()&&n.__IfAppendImage},set:function(e){return n._resetErr(),!!n._isValid()&&(t.isBoolean(e)?n.__IfAppendImage=e:(t.Errors.InvalidValue(n),Or))}}),n._isMobileMode()?Su(n,["FTPPort","IfAppendImage"]):cs(n,"FTPPort",{get:function(){return n._resetErr(),n._isValid()?n._innerFun("FTPPort"):0},set:function(e){if(n._resetErr(),!n._isValid())return!1;if(""!==e){var t=1*e;return n._innerFun("FTPPort",Zn(t))}}}),n._isMobileMode()?cs(n,"JPEGQuality",{get:function(){return n._resetErr(),!!n._isValid()&&n._jpgQuality},set:function(e){var t=1*e;return t>=100?t=100:t<0&&(t=0),n._resetErr(),!!n._isValid()&&(n._jpgQuality=t,!0)}}):cs(n,"JPEGQuality",{get:function(){return n._resetErr(),n._isValid()?n._innerFun("JPEGQuality"):0},set:function(e){var t=1*e;return t>=100?t=100:t<0&&(t=0),n._resetErr(),!!n._isValid()&&n._innerFun("JPEGQuality",Zn(t))}}),n._isMobileMode()?cs(n,"TIFFCompressionType",{get:function(){return n._resetErr(),n._isValid()?n._tiffCompressionType:0},set:function(e){return n._resetErr(),!!n._isValid()&&(n._tiffCompressionType=e,!0)}}):Tu(n,"TIFFCompressionType",1,1),n._isMobileMode()?cs(n,"BufferMemoryLimit",{get:function(){return n._resetErr(),n._isValid(),0},set:function(e){return n._resetErr(),n._isValid(),!1}}):Tu(n,"BufferMemoryLimit",1,1),cs(n,"LogLevel",{get:function(){return n._resetErr(),n._isValid()?n._logLevel:0},set:function(t){if(n._resetErr(),!n._isValid())return!1;var r=1*t;return r>=14?r=14:r<0&&(r=0),n._logLevel=r,Hu.logLevel=n._logLevel,n._isMobileMode()?(e.WasmEnv&&e.WasmEnv.setLoglevel(n._logLevel),!0):n._innerFun("LogLevel",Zn(r))}}),cs(n,"HttpContentTypeFieldValue",{get:function(){return n._resetErr(),n._isValid()?n.__strHttpContentTypeFieldValue:""},set:function(e){return n._resetErr(),!!n._isValid()&&(n.__strHttpContentTypeFieldValue=e,e)}}),cs(n,"BrokerProcessType",{get:function(){return n._resetErr(),n._isValid()?1:0},set:function(e){return n._resetErr(),!!n._isValid()}}),cs(n,"BorderStyle",{get:function(){return n._resetErr(),!!n._isValid()&&0},set:function(e){return n._resetErr(),n._isValid(),!1}}),cs(n,"HTTPRequestswithCredentials",{get:function(){return n._resetErr(),!!n._isValid()&&n.__withCredentials},set:function(e){return n._resetErr(),!!n._isValid()&&(n.__withCredentials=e)}}),cs(n,"ScaleDownThreshold",{get:function(){return n._resetErr(),n._isValid()?n._scaleDownThreshold:0},set:function(e){var r=1*e;return!t.isNumber(r)||isNaN(r)?(t.Errors.InvalidValue(self),Or):(n._resetErr(),!!n._isValid()&&(n._scaleDownThreshold=e))}}),cs(n,"CurrentImageIndexInBuffer",{get:function(){return n._isValid()?n._ImgManager.getCurrentImageIndex():0},set:function(e){var t=1*e;return n._resetErr(),!!n._isValid()&&(t>=0&&t<n._ImgManager.count()&&(n._ImgManager.Go(t),n._isBindViewer()&&ns.__innerRefreshFromUIView(n,n._ImgManager.getCurrentImageIndex())),!0)}}),cs(n,"SelectedImagesIndices",{get:function(){return n._resetErr(),n._isValid()?n._ImgManager.count()<=0?[]:n._ImgManager.getSelectedClientIndexArray():[]}}),cs(n,"MaxImagesInBuffer",{get:function(){return n._resetErr(),n._isValid()?n.__maxImagesInBuffer:0},set:function(e){var r=1*e;return n._resetErr(),!!n._isValid()&&(r>0&&r<32768?n.__maxImagesInBuffer=r:t.Errors.OutOfRange(n),n.__maxImagesInBuffer)}}),cs(n,"IfSSL",{get:function(){return n._bSSL},set:function(e){return n._bSSL=e,n._isMobileMode()||n._innerFun("IfSSL",Zn(e)),!0}}),n._isMobileMode()?cs(n,"IfAllowLocalCache",{get:function(){return!1},set:function(e){return!1}}):Tu(n,"IfAllowLocalCache",1,2),cs(n,"UseLocalService",{get:function(){return n._isTwainServiceType()||n._isDMServiceType()}}),cs(n,"PDFCompressionType",{get:function(){return n._resetErr(),!!n._isValid()&&(n._isMobileMode()?n._mobileNotSupport("PDFCompressionType"):n._innerFun("PDFCompressionType"))},set:function(t){var r=1*t;return r==e.DWT.EnumDWT_PDFCompressionType.PDF_FAX3&&(r=e.DWT.EnumDWT_PDFCompressionType.PDF_FAX4),n._resetErr(),!!n._isValid()&&(n._isMobileMode()?n._mobileNotSupport("PDFCompressionType"):n._innerFun("PDFCompressionType",Zn(r)))}}),n._setProductKey=function(r,i,o,a){var s=!0,u=r,c=function(e){e||(n.__licenseInfo=undefined);var r=!0;return a||(r=t.License.checkProductKey(n,{Core:!0})),t.isFunction(o)&&o(),r};if(n._resetErr(),!n._isValid())return!1;if(u=t.isString(u)?t.trim(u):"",e.DWT.ProductKey=u,""==u)s=!1,c();else{e.Lib.License.reparseProductKey();var l=e.DWT.licenseException;if(0!=l.code)return n.__licenseInfo=undefined,n._errorCode=l.code,n._errorString=l.message,t.isFunction(o)&&o(),!1;if(n._isMobileMode())return t.showProgressMsg(-1,"",e.MSG.Init_GetLicenseInfoForDWT),n.__licenseInfo=undefined,n.GetLicenseInfo((function(t){e.WasmEnv&&e.WasmEnv.setLoglevel(n._logLevel),n._setConvertMode(n._pdfConvertMode),n._resetErr(),c(!0)}),c),!0;n._innerFunRaw("ProductKey",Zn(u),i,!1,!1,(function(r){var o=!1;o=t.isArray(r)?r[0]:r,t.isArray(r)&&r.length>=3&&"1"===r[1]&&t.isFunction(e.DWT.ShowMessage)&&e.DWT.ShowMessage(r[2],{width:510,height:272,headerStyle:1,seconds:10}),i||(s=o),t.showProgressMsg(-1,"",e.MSG.Init_GetLicenseInfoForDWT),n.__licenseInfo=undefined,n.GetLicenseInfo((function(){n._setConvertMode(n._pdfConvertMode),c(!0)}),c)}),(function(){i||(s=!1),c()}))}return s},tc(n,["ProxyServer"]);var i=["CapValueString","CapDescription","FTPPassword","FTPUserName","Manufacturer","ProductFamily","PDFAuthor","PDFCreationDate","PDFCreator","PDFKeywords","PDFModifiedDate","PDFProducer","PDFSubject","PDFTitle","PDFVersion"];n._isMobileMode()?Su(n,i):tc(n,i),ec(n,["ImageBitsPerPixel","ImageLength","ImageWidth","ImageXResolution","ImageYResolution"]);var o=["BlankImageCurrentStdDev","CapDefaultIndex","CapDefaultValue","DataSourceStatus","Duplex","PendingXfers","ImageLayoutDocumentNumber","ImageLayoutFrameBottom","ImageLayoutFrameLeft","ImageLayoutFrameNumber","ImageLayoutFrameRight","ImageLayoutFrameTop","ImageLayoutPageNumber","ImagePixelType","MagData","MagType","IfFeederLoaded","IfPaperDetectable","IfUIControllable"];n._isMobileMode()?Su(n,o,0):ec(n,o),Qu(n,["AllowPluginAuthentication","IfModalUI","IfScanInNewThread","_AutoCropMethod"]);var a=["IfDisableSourceAfterAcquire","IfDuplexEnabled","IfFeederEnabled","IfPASVMode","IfAutoBright","IfAutoDiscardBlankpages","IfAutoFeed","IfAutomaticBorderDetection","IfAutomaticDeskew","IfAutoScan","IfShowIndicator","IfUseTwainDSM","IfTiffMultiPage"];n._isMobileMode()?Su(n,a):Qu(n,a),$u(n,["MaxInternetTransferThreads"]);var s=["BlankImageMaxStdDev","BlankImageThreshold","BitDepth","Brightness","PageSize","PixelType","Resolution","Capability","CapCurrentIndex","CapCurrentValue","CapMaxValue","CapMinValue","CapNumItems","CapStepSize","CapType","CapValue","CapValueType","Contrast","PixelFlavor","TransferMode","Unit","XferCount"];n._isMobileMode()?Su(n,s):$u(n,s),qu(n,["AsyncMode","EnableInteractiveZoom","IfThrowException","ImageEditorIfEnableEnumerator","ImageEditorIfReadonly","ImageEditorIfModal","ImageEditorWindowTitle","IfShowPrintUI","VScrollBar"],2);var u=["IfOpenImageWithGDIPlus"];n._isMobileMode()?Su(n,u):qu(n,u)}},t.attachPropertyUI||(t.attachPropertyUI=function(){}),rc.Orientation={Horizontal:0,Vertical:1},rc.Direction={LeftToRight:0,RightToLeft:1,TopToBottom:0,BottomToTop:1},rc.CreationType={Replace:0,AppendChild:1},rc.AnimationStyle={None:0,Static:1,StaticFull:2,Custom:3,CustomFull:4,Flickering1:10,Flickering2:11,Flickering3:12,LeftToRight1:20,LeftToRight2:21,RightToLeft1:22,RightToLeft2:23,TwoWay:24},rc.prototype.finishLoading=function(){var e,t=this;t.wrapperElement=null,t.backgroundElement=null,t.valueElement=null,t.leftElement=null,t.middleElement=null,t.rightElement=null,t.backgroundElement=document.createElement("DIV"),t.backgroundElement.className="progressbar_background"+(t.extraClassName.background?" ":"")+t.extraClassName.background,t.backgroundElement.style.cssText=t.backgroundElement.style.cssText+rc._createBorderRadiusCss(t.borderRadius),t.parentElement.appendChild(t.backgroundElement);var r=["border-radius","border-bottom-right-radius","-moz-border-radius-bottomright","-webkit-border-bottom-right-radius","-khtml-border-radius-bottomright","-khtml-border-bottom-right-radius"],n=0,i="";for(n=0;n<r.length&&(!(i=rc._elementCurrentStyle(t.backgroundElement,r[n]))&&"string"!=typeof i);n++);""!=i&&rc._parseInt(i)!=t.borderRadius&&(t.borderRadius=rc._parseInt(i)),t.orientation==rc.Orientation.Horizontal||t.orientation==rc.Orientation.Vertical?t.displayType=0:t.displayType=1,t.parentElement.className=(""!=t.parentElement.className?" ":"")+"progressbar_parent dynamsoft-progressBar"+(t.extraClassName.parent?" ":"")+t.extraClassName.parent,0==t.displayType?((e=t.wrapperElement=document.createElement("DIV")).style.border="1px solid #A0A0A0",e.style.cssFloat="left",e.style.display="inline-block",e.style.width=t.width+"px",e.style.height=t.height+"px",e.style.left="0px",e.style.top=-t.height+"px",e.style.backgroundColor=t.backColor,e.style.backgroundRepeat="no-repeat",e.style.position="relative",e.style.cssText=e.style.cssText+rc._createBorderRadiusCss(t.borderRadius),t.parentElement.appendChild(e),t.borderWidth={left:rc._parseInt(rc._elementCurrentStyle(e,"border-left-width")),right:rc._parseInt(rc._elementCurrentStyle(e,"border-right-width")),top:rc._parseInt(rc._elementCurrentStyle(e,"border-top-width")),bottom:rc._parseInt(rc._elementCurrentStyle(e,"border-bottom-width"))}):1==t.displayType&&(t.orientation==rc.Orientation.Horizontal?t.borderRadius>t.width/2&&(t.borderRadius=t.width):t.orientation==rc.Orientation.Vertical&&t.borderRadius>t.height/2&&(t.borderRadius=t.height),t.valueElement=document.createElement("DIV"),t.valueElement.className="",t.leftElement=document.createElement("DIV"),t.middleElement=document.createElement("DIV"),t.rightElement=document.createElement("DIV"),t.leftElement.style.border="1px solid #A0A0A0",t.leftElement.style.cssFloat="left",t.leftElement.style.display="inline-block",t.leftElement.style.backgroundColor=t.backColor,t.leftElement.style.backgroundRepeat="no-repeat",t.leftElement.style.position="relative",t.rightElement.style.border="1px solid #A0A0A0",t.rightElement.style.cssFloat="left",t.rightElement.style.display="inline-block",t.rightElement.style.backgroundColor=t.backColor,t.rightElement.style.backgroundRepeat="no-repeat",t.rightElement.style.position="relative",t.middleElement.style.border="1px solid #A0A0A0",t.middleElement.style.cssFloat="left",t.middleElement.style.display="inline-block",t.middleElement.style.overflow="hidden",t.middleElement.style.position="relative",t.valueElement.style.backgroundColor=t.backColor,t.valueElement.style.position="relative",t.orientation==rc.Orientation.Horizontal?(t.leftElement.style.width=t.borderRadius+"px",t.leftElement.style.height=t.height+"px",t.leftElement.style.top=-t.height+"px",t.leftElement.style.left="0px",t.leftElement.style.borderRight="none",t.leftElement.style.cssText=t.leftElement.style.cssText+rc._createBorderRadiusCss(t.borderRadius,0,0,t.borderRadius),t.rightElement.style.width=t.borderRadius+"px",t.rightElement.style.height=t.height+"px",t.rightElement.style.top=-t.height+"px",t.rightElement.style.borderLeft="none",t.rightElement.style.cssText=t.rightElement.style.cssText+rc._createBorderRadiusCss(0,t.borderRadius,t.borderRadius,0),t.middleElement.style.width=t.width-2*t.borderRadius+"px",t.middleElement.style.height=t.height+"px",t.middleElement.style.top=-t.height+"px",t.middleElement.style.borderLeft="none",t.middleElement.style.borderRight="none",t.valueElement.style.width="0px",t.valueElement.style.height=t.height+"px"):t.orientation==rc.Orientation.Vertical&&(t.leftElement.style.width=t.width+"px",t.leftElement.style.height=t.borderRadius+"px",t.leftElement.style.top=-t.height+"px",t.leftElement.style.left="0px",t.leftElement.style.borderBottom="none",t.leftElement.style.cssText=t.leftElement.style.cssText+rc._createBorderRadiusCss(t.borderRadius,t.borderRadius,0,0),t.rightElement.style.width=t.width+"px",t.rightElement.style.height=t.borderRadius+"px",t.rightElement.style.top=-t.height+"px",t.rightElement.style.left="0px",t.rightElement.style.borderTop="none",t.rightElement.style.cssText=t.rightElement.style.cssText+rc._createBorderRadiusCss(0,0,t.borderRadius,t.borderRadius),t.middleElement.style.width=t.width+"px",t.middleElement.style.height=t.height-2*t.borderRadius+"px",t.middleElement.style.top=-t.height+"px",t.middleElement.style.left="0px",t.middleElement.style.borderTop="none",t.middleElement.style.borderBottom="none",t.valueElement.style.width=t.width+"px",t.valueElement.style.height="0px"),t.middleElement.appendChild(t.valueElement),t.parentElement.appendChild(t.leftElement),t.parentElement.appendChild(t.middleElement),t.parentElement.appendChild(t.rightElement),t.orientation==rc.Orientation.Horizontal?t.borderWidth={left:rc._parseInt(rc._elementCurrentStyle(t.leftElement,"border-left-width")),right:rc._parseInt(rc._elementCurrentStyle(t.rightElement,"border-right-width")),top:rc._parseInt(rc._elementCurrentStyle(t.middleElement,"border-top-width")),bottom:rc._parseInt(rc._elementCurrentStyle(t.middleElement,"border-bottom-width"))}:t.orientation==rc.Orientation.Vertical&&(t.borderWidth={left:rc._parseInt(rc._elementCurrentStyle(t.middleElement,"border-left-width")),right:rc._parseInt(rc._elementCurrentStyle(t.middleElement,"border-right-width")),top:rc._parseInt(rc._elementCurrentStyle(t.leftElement,"border-top-width")),bottom:rc._parseInt(rc._elementCurrentStyle(t.rightElement,"border-bottom-width"))})),t.parentElement.style.width=t.width+t.borderWidth.left+t.borderWidth.right+"px",t.parentElement.style.height=t.height+t.borderWidth.top+t.borderWidth.bottom+"px",t.backgroundElement.style.cssFloat="left",t.backgroundElement.style.display="inline-block",t.backgroundElement.style.width=t.width+t.borderWidth.left+t.borderWidth.right+"px",t.backgroundElement.style.height=t.height+"px",t.backgroundElement.style.backgroundColor="#FFFFFF",t.backgroundElement.style.position="relative",0==t.displayType&&(t.backgroundElement.style.width=t.width+t.borderWidth.left+t.borderWidth.right+"px"),t.backgroundElement.style.top=t.borderWidth.top+"px",t.markerElement=document.createElement("DIV"),t.markerElement.style.display="inline-block",t.markerElement.style.zoom="1.0",t.markerElement.style.width=t.width+"px",t.markerElement.style.height=t.height+"px",t.markerElement.style.top=2*-t.height-t.borderWidth.top+"px",t.markerElement.style.left=t.borderWidth.left+"px",t.markerElement.style.backgroundColor=t.color,t.markerElement.style.lineHeight=t.height+"px",t.markerElement.style.position="relative",t.parentElement.appendChild(t.markerElement),t.isLoaded=!0,t.setValue(t.initialValue),null!=t.onLoad&&t.onLoad()},rc.prototype.setValue=function(e){var t=this;if(null!==e&&e<t.minValue&&(e=t.minValue),null!==e&&e>t.maxValue&&(e=t.maxValue),null===e||(t.value=e),t.isLoaded){var r,n=0;if(t.orientation==rc.Orientation.Horizontal){n=t.value/t.maxValue*t.width,t.progressPosition=n,0==t.displayType?(t.direction,rc.Direction.LeftToRight):1==t.displayType&&(t.direction==rc.Direction.LeftToRight?n<=t.borderRadius?t.valueElement.style.width="0px":n>=t.width-t.borderRadius?t.valueElement.style.width=t.middleElement.style.width:t.valueElement.style.width=n-t.borderRadius+"px":n<=t.borderRadius?t.valueElement.style.width="0px":n>=t.width-t.borderRadius?(t.valueElement.style.left="0px",t.valueElement.style.width=t.middleElement.style.width):(t.valueElement.style.left=t.width-n-t.borderRadius+"px",t.valueElement.style.width=n-t.borderRadius+"px")),n>0?(t.animationStyle!=rc.AnimationStyle.StaticFull&&t.animationStyle!=rc.AnimationStyle.CustomFull?t.markerElement.style.width=n+"px":t.markerElement.style.width=t.width+"px",t.markerElement.style.visibility="visible"):(t.markerElement.style.width=t.width+"px",t.animationStyle!=rc.AnimationStyle.StaticFull&&t.animationStyle!=rc.AnimationStyle.CustomFull&&(t.markerElement.style.visibility="hidden")),t.animationStyle!=rc.AnimationStyle.StaticFull&&t.animationStyle!=rc.AnimationStyle.CustomFull?t.direction==rc.Direction.LeftToRight?t.markerElement.style.left=t.borderWidth.left+"px":t.markerElement.style.left=t.width-n+t.borderWidth.left+"px":t.markerElement.style.left=t.borderWidth.left+"px",t.height,t.height,t.borderWidth.top;var i=2*-t.height-t.borderWidth.top;if(0==n||t.width==n)t.markerElement.style.top=i+"px",t.markerElement.style.height=t.height+"px",t.markerElement.style.cssText=t.markerElement.style.cssText+rc._createBorderRadiusCss(t.borderRadius);else if(n<t.borderRadius){var o=t.height-2.25*(t.borderRadius-Math.sqrt(Math.pow(t.borderRadius,2)-Math.pow(t.borderRadius-n,2))),a=i+t.height/2-o/2;t.markerElement.style.top=a+"px",t.markerElement.style.height=o+"px",t.direction==rc.Direction.LeftToRight?t.markerElement.style.cssText=t.markerElement.style.cssText+rc._createBorderRadiusCss(t.borderRadius,0,0,t.borderRadius):t.markerElement.style.cssText=t.markerElement.style.cssText+rc._createBorderRadiusCss(0,t.borderRadius,t.borderRadius,0)}else t.width-n<t.borderRadius?(r=(2*(t.borderRadius-(t.width-n))+(t.borderRadius-Math.sqrt(Math.pow(t.borderRadius,2)-Math.pow(t.borderRadius-(t.width-n),2))))/3,t.direction==rc.Direction.LeftToRight?t.markerElement.style.cssText=t.markerElement.style.cssText+rc._createBorderRadiusCss(t.borderRadius,r,r,t.borderRadius):t.markerElement.style.cssText=t.markerElement.style.cssText+rc._createBorderRadiusCss(r,t.borderRadius,t.borderRadius,r)):(t.markerElement.style.top=i+"px",t.markerElement.style.height=t.height+"px",t.direction==rc.Direction.LeftToRight?t.markerElement.style.cssText=t.markerElement.style.cssText+rc._createBorderRadiusCss(t.borderRadius,0,0,t.borderRadius):t.markerElement.style.cssText=t.markerElement.style.cssText+rc._createBorderRadiusCss(0,t.borderRadius,t.borderRadius,0))}else if(t.orientation==rc.Orientation.Vertical){n=t.value/t.maxValue*t.height,t.progressPosition=n,0==t.displayType?(t.direction,rc.Direction.TopToBottom):1==t.displayType&&(t.direction==rc.Direction.TopToBottom?n<=t.borderRadius?t.valueElement.style.height="0px":n>=t.height-t.borderRadius?t.valueElement.style.height=t.middleElement.style.height:t.valueElement.style.height=n-t.borderRadius+"px":n<=t.borderRadius?t.valueElement.style.height="0px":n>=t.height-t.borderRadius?(t.valueElement.style.top="0px",t.valueElement.style.height=t.middleElement.style.height):(t.valueElement.style.top=t.height-n-t.borderRadius+"px",t.valueElement.style.height=n+2*t.borderRadius+"px")),n>0?(t.animationStyle!=rc.AnimationStyle.StaticFull&&t.animationStyle!=rc.AnimationStyle.CustomFull?t.markerElement.style.height=n+"px":(t.markerElement.style.height=t.height+"px",t.markerElement.style.cssText=t.markerElement.style.cssText+rc._createBorderRadiusCss(t.borderRadius)),t.markerElement.style.visibility="visible"):(t.markerElement.style.height="0px",t.animationStyle!=rc.AnimationStyle.StaticFull&&t.animationStyle!=rc.AnimationStyle.CustomFull&&(t.markerElement.style.visibility="hidden")),t.borderWidth.left;var s=t.borderWidth.left;if(0==n||t.height==n)t.markerElement.style.left=s+"px",t.markerElement.style.width=t.width+"px",t.markerElement.style.cssText=t.markerElement.style.cssText+rc._createBorderRadiusCss(t.borderRadius);else if(n<t.borderRadius){var u=2.5*n;u>t.width&&(u=t.width);var c=s+t.width/2-u/2;t.markerElement.style.left=c+"px",t.markerElement.style.width=u+"px",t.direction==rc.Direction.BottomToTop?t.markerElement.style.cssText=t.markerElement.style.cssText+rc._createBorderRadiusCss(0,0,t.borderRadius,t.borderRadius):t.markerElement.style.cssText=t.markerElement.style.cssText+rc._createBorderRadiusCss(t.borderRadius,t.borderRadius,0,0)}else t.height-n<t.borderRadius?(r=(2*(t.borderRadius-(t.height-n))+(t.borderRadius-Math.sqrt(Math.pow(t.borderRadius,2)-Math.pow(t.borderRadius-(t.height-n),2))))/3,t.direction==rc.Direction.BottomToTop?t.markerElement.style.cssText=t.markerElement.style.cssText+rc._createBorderRadiusCss(r,r,t.borderRadius,t.borderRadius):t.markerElement.style.cssText=t.markerElement.style.cssText+rc._createBorderRadiusCss(t.borderRadius,t.borderRadius,r,r)):(t.markerElement.style.left=s+"px",t.markerElement.style.width=t.width+"px",t.direction==rc.Direction.BottomToTop?t.markerElement.style.cssText=t.markerElement.style.cssText+rc._createBorderRadiusCss(0,0,t.borderRadius,t.borderRadius):t.markerElement.style.cssText=t.markerElement.style.cssText+rc._createBorderRadiusCss(t.borderRadius,t.borderRadius,0,0));t.animationStyle!=rc.AnimationStyle.StaticFull&&t.animationStyle!=rc.AnimationStyle.CustomFull?t.direction==rc.Direction.TopToBottom?t.markerElement.style.top=2*-t.height-t.borderWidth.top+"px":t.markerElement.style.top=-t.height-n-t.borderWidth.top+"px":t.markerElement.style.top=2*-t.height-t.borderWidth.top+"px"}t.progress=t.value/t.maxValue}null!=t.onValueChanged&&t.onValueChanged()},rc._elementCurrentStyle=function(e,t){if(e.currentStyle){var r=0,n="",i=!1;for(r=0;r<t.length;r++)"-"!=t[r].toString()?(n+=i?t[r].toString().toUpperCase():t[r].toString(),i=!1):i=!0;return t=n,e.currentStyle[t]}return getComputedStyle(e,null).getPropertyValue(t)},rc._parseInt=function(e){var t=parseInt(e);return isNaN(t)&&(t=0),t},rc._createBorderRadiusCss=function(e,t,r,n){return null!=e&&null==t&&null==r&&null==n?"; -moz-border-radius: "+e+"px; -ms-border-radius: "+e+"px; -o-border-radius: "+e+"px; -webkit-border-radius: "+e+"px; -khtml-border-radius: "+e+"px; border-radius: "+e+"px;":"; -moz-border-radius: "+(e=e||0)+"px "+(t=t||0)+"px "+(r=r||0)+"px "+(n=n||0)+"px; -ms-border-radius: "+e+"px "+t+"px "+r+"px "+n+"px; -o-border-radius: "+e+"px "+t+"px "+r+"px "+n+"px; -webkit-border-radius: "+e+"px "+t+"px "+r+"px "+n+"px; -khtml-border-radius: "+e+"px "+t+"px "+r+"px "+n+"px; border-radius: "+e+"px "+t+"px "+r+"px "+n+"px;"};var nc=239514e3,ic=function(){function e(){Le(this,e)}return Ae(e,[{key:"convertServerIdToGuid",value:function(e){return 1*e+nc}},{key:"convertGuidToServerId",value:function(e){return 1*e-nc}}]),e}();function oc(e,t){e.__licenseInfo=t,function(e){if(!e.__calic){if(!ea(e))return!1;e.__calic=e.__licenseInfo,e._isMobileMode()&&Nn()}}(e)}var ac=0,sc=1,uc=2,cc=3,lc=4,dc=5;function hc(){return new e.Imagecore}function gc(){return new e.ImageProc}function fc(){return new e.PdfReader}var mc=0;function _c(){return++mc}function pc(r,n){var i,o,a,s,u=n[0],c=n[1],l=!1,d=0,h=!1,g=e.DWT.EnumDWT_ImageType,f=!1,m=!0;if(n.length>3&&(i=n[3]),n.length>4&&(h=n[4]),n.length>5&&(f=n[5]),n.length>6&&(m=n[6]),i||""==(i=r._innerGetCurrentDocumentName())&&r._ImgManager&&(i=r._ImgManager.getWebViewer().GetDefaultFileName()),u instanceof FileList?o=u[0]:u instanceof Blob?o=u:u instanceof ArrayBuffer||u instanceof Uint8Array?(o=new Blob([u]),s=qn(u)):o=u,t.isUndefined(o))return t.Errors.InvalidSourceFile(r),t.Promise.reject({code:r._errorCode,message:r._getErrorString()});if(t.isUndefined(s))if(o.type){if(-1==(s="application/pdf"==o.type?g.IT_PDF:"image/png"==o.type?g.IT_PNG:"image/jpeg"==o.type||"image/jpg"==o.type?g.IT_JPG:"image/bmp"==o.type?g.IT_BMP:"image/tiff"==o.type||"image/tif"==o.type?g.IT_TIF:"image/jp2"==o.type?g.IT_J2K:ti.getImageType(o.name))&&"application/octet-stream"==o.type)return new t.Promise((function(e,t){var r=new FileReader;r.onload=function(t){var r,i=null==t||null===(r=t.target)||void 0===r?void 0:r.result;n[0]=i,e(n)},r.readAsArrayBuffer(o)})).then((function(e){return pc(r,e)}))}else s=ti.getImageType(o.name);if("",a=o.name,s==g.IT_JPG||s==g.IT_PNG||s==g.IT_BMP||s==g.IT_J2K){h||ni("",r);var _=r._jpgQuality;l=hc();var p=e.navInfoSync.bMac||e.navInfoSync.biPhone||e.navInfoSync.biPad;return l.readImage(o,g.IT_JPG,_,!1,p).then((function(t){if(e.navInfoSync.bMobile||e.navInfoSync.bPad){var n=r._jpgQuality,i=3840;if(t&&(t.imageWidth>i||t.imageHeight>i))return e.ImageProcWrapper.resizeImageWithMeta(o,t,5,n,i)}return t})).then((function(u){var d=0;c?(d=c,f&&(u.imageBitDepth=1)):1==u.originalFormat?d=g.IT_BMP:2==u.originalFormat?d=g.IT_JPG:3==u.originalFormat?d=g.IT_PNG:14==u.originalFormat&&(d=g.IT_J2K);var _={src:u.imageData,imgType:u.imageType,verify:d,dataType:"url"};o instanceof File||2==u.originalFormat&&o instanceof Blob&&(_.src=o),mc++;var p=n[2],v={};v.id=mc,v.type=u.imageType,v.width=u.imageWidth,v.height=u.imageHeight,v.bitDepth=u.imageBitDepth,v.resolutionX=u.imageXResolution,v.resolutionY=u.imageYResolution,p&&(v.oriBlobData=p),_.metadata=v;var y=!1,b={ids:mc,metaData:[v]};try{_.imageId=mc,r._OnBitmapChanged(["10",""+mc,1,r._ImgManager.getCurrentImageIndex(),r._ImgManager.count(),_],null,i)}catch(I){y=!0,t.Errors.SystemExceptionError(r,I.message)}if(h||ii(""),!y&&m&&t.isFunction(r.__OnPostLoad))try{r.__OnPostLoad("",a,s)}catch(w){y=!0,t.Errors.SystemExceptionError(r,w.message)}if(l&&l.terminate(),e.DWT.lavrf_(1,e.DWT.EnumInstance.dwt_browser,""),y)throw{code:r._errorCode,message:r._getErrorString()};return b}),(function(e){throw t.Errors.LoadImageFailed(r,e),h||ii(""),l&&l.terminate(),{code:r._errorCode,message:r._getErrorString()}}))}if(s==g.IT_PDF){var v=fc();return v.context={},t.showProgress(r),r._OnPercentDone([0,-1,e.MSG.LoadingPdf,""]),v.open(o,r._pdfPassword).then((function(n){var o,u=n.PdfCount;if(n.isTextBased&&2==r._pdfRealConvertMode)return e.Lib.closeProgress(r),2==r._pdfConvertMode?e.Lib.Errors.LoadTextPDFButSetImageOnly(r):e.Lib.Errors.LoadTextPDFButNoPdfrLicenseErr(r),v.close(),v.terminate(),t.Promise.reject({code:r._errorCode,message:r._getErrorString()});for(r._OnPercentDone([0,0,"0/"+u,""]),o=t.Promise.resolve(0),v.context.cIndex=0,v.context.pdfCount=u,d=0;d<u;d++)o=o.then((function(){var t,n,i,o=v.context.cIndex,a=e.navInfoSync.bMac||e.navInfoSync.biPhone||e.navInfoSync.biPad;return(e.navInfoSync.bMobile||e.navInfoSync.bPad)&&(t=5,n=85,i=3840),v.readPage(o,r._pdfResolution,r._pdfRealConvertMode,e.DWT.EnumDWT_ImageType.IT_JPG,!1,!1,a,t,n,i)})),o=o.then((function(t){var n=v.context.cIndex,o=v.context.pdfCount,a=n+1,s=100*a/(1*o),u={},l=4;if(c?l=c:1==t.realReadMode&&(l=5001),r._OnPercentDone([0,s,a+"/"+o,""]),e.Lib.isArray(t.imageInfos)&&t.imageInfos.length>0){var d=t.imageInfos[0];u.width=d.imageWidth,u.height=d.imageHeight,u.bitDepth=d.imageBitDepth,u.resolutionX=d.imageXResolution,u.resolutionY=d.imageYResolution}mc++;var h={src:t.imageData,dataType:"url",imgType:e.DWT.EnumDWT_ImageType.IT_PDF,verify:l,index:t.pageIndex,metadata:u,imageId:mc};try{r._OnBitmapChanged(["10",""+mc,1,r._ImgManager.getCurrentImageIndex(),r._ImgManager.count(),h],null,i)}catch(g){throw e.Lib.Errors.SystemExceptionError(r,g.message),0}v.context.cIndex=n+1}));return o.then((function(t){return e.Lib.closeProgress(r),v.close(),v.terminate(),e.DWT.lavrf_(1,e.DWT.EnumInstance.dwt_browser,""),m&&e.Lib.isFunction(r.__OnPostLoad)&&r.__OnPostLoad("",a,s),t}),(function(t){throw e.Lib.closeProgress(r),v.close(),v.terminate(),t&&e.Lib.Errors.LoadImageFailed(r,t),{code:r._errorCode,message:r._getErrorString()}}))}),(function(t){throw e.Lib.closeProgress(r),v.close(),v.terminate(),t&&e.Lib.Errors.LoadImageFailed(r,t),{code:r._errorCode,message:r._getErrorString()}}))}return s==g.IT_TIF?(l=hc(),t.showProgress(r),r._OnPercentDone([0,-1,e.MSG.LoadingTiff,""]),l.openTiff(o).then((function(n){var o=n.pageCount,u=n.imageInfos,d=t.Promise.resolve(0);r._OnPercentDone([0,0,"0/"+o,""]);for(var h=0;h<o;h++)d=d.then((function(t){var n,a,s,d=e.navInfoSync.bMac||e.navInfoSync.biPhone||e.navInfoSync.biPad;return(e.navInfoSync.bMobile||e.navInfoSync.bPad)&&(n=5,a=85,s=3840),l.readTiff(t,e.DWT.EnumDWT_ImageType.IT_JPG,!1,d,n,a,s).then((function(n){var a=t+1,s=100*a/(1*o);r._OnPercentDone([0,s,a+"/"+o,""]),mc++;var l=2;c&&(l=c);var d={src:n.imageData,dataType:"url",imgType:e.DWT.EnumDWT_ImageType.IT_TIF,verify:l,index:t,metadata:u[t],imageId:mc};try{r._OnBitmapChanged(["10",""+mc,1,r._ImgManager.getCurrentImageIndex(),r._ImgManager.count(),d],null,i)}catch(h){throw e.Lib.Errors.SystemExceptionError(r,h.message),0}return t+1}))}));return d.then((function(t){return e.Lib.closeProgress(r),l.closeTiff(),l.terminate(),e.DWT.lavrf_(1,e.DWT.EnumInstance.dwt_browser,""),m&&e.Lib.isFunction(r.__OnPostLoad)&&r.__OnPostLoad("",a,s),t}),(function(t){throw e.Lib.closeProgress(r),l.closeTiff(),l.terminate(),t&&e.Lib.Errors.LoadImageFailed(r,t),{code:r._errorCode,message:r._getErrorString()}}))}),(function(t){throw e.Lib.closeProgress(r),l.closeTiff(),l.terminate(),e.Lib.Errors.LoadImageFailed(r,t),{code:r._errorCode,message:r._getErrorString()}}))):(t.Errors.LoadImageFailed(r,"invalid image type."),t.Promise.reject({code:r._errorCode,message:r._getErrorString()}))}function vc(e,r,n){var i=gc(),o=e._ImgManager.convertClientIndexToServerId(r);return i.context={},ni("",e),e._ImgManager.getWebViewer().GetImageData(e._ImgManager.getUidByIndex(r)).then((function(e){return i.context.metadata=e&&e.metadata?e.metadata:{},i.initImage(e.oriData)})).then((function(){return i.flip(n)})).then((function(){return i.getImage()})).then((function(r){var n={src:r.imageData,imgType:t.MobileFuns.convertOutputType(r.imageType),dataType:"url"};try{e._OnBitmapChanged(["10",""+o,4,e._ImgManager.getCurrentImageIndex(),e._ImgManager.count(),n])}catch(i){throw t.Errors.SystemExceptionError(e,i.message),0}})).then((function(){ii(""),i.terminate()}),(function(r){throw ii(""),r&&(-1==n?t.Errors.MirrorFailed(e,r):t.Errors.FlipFailed(e,r)),i.terminate(),{code:e._errorCode,message:e._getErrorString()}}))}function yc(r,n){var i=n[0],o=n[1],a=n[2],s=n[3],u=n[4],c=!1,l=!1,d=e.DWT.EnumDWT_ImageType;if(t.isUndefined(i))return t.Errors.MobileServer_InvalidImage(r),t.Promise.reject({code:r._errorCode,message:r._getErrorString()});if(!t.isArray(o))return t.Errors.MobileServer_InvalidIndex(r),t.Promise.reject({code:r._errorCode,message:r._getErrorString()});if(t.isUndefined(a)&&(a="jpg"),t.isString(i)&&""!=i||(i="img."+a),"png"==a||"jpg"==a||"bmp"==a){var h,g=o[0],f=r._jpgQuality;t.log("[Wasm]Save Image: save "+a),1==s&&ni("",r),h="png"==a?d.IT_PNG:"bmp"==a?d.IT_BMP:d.IT_JPG;var m=r._ImgManager.getWebViewer().GetImageData(r._ImgManager.getUidByIndex(g));return(l=hc()).context={},l.context.bSaveAsBinary=u,(m=r._scaleDownThreshold<=0?m.then((function(r){t.log("[Wasm]Save Image: get original image data successfully.");var n=l.context.bSaveAsBinary?e.Enum_ReturnType.RT_BINARY:e.Enum_ReturnType.RT_BASE64,i=1==r.metadata.bitDepth;return l.saveImage(r.oriData,h,f,n,i)})):(m=m.then((function(n){t.log("[Wasm]Save Image: save to new type successfully.");var i=n&&n.metadata?n.metadata:{},o=1==i.bitDepth;return l.context.bOneBit=o,e.ImageProcWrapper.resize(n.oriData,i.width,i.height,r._scaleDownThreshold,5,l.context.bOneBit)}))).then((function(r){t.log("[Wasm]Save Image: image scale successfully.");var n=l.context.bSaveAsBinary?e.Enum_ReturnType.RT_BINARY:e.Enum_ReturnType.RT_BASE64;return l.saveImage(r.imageData,h,f,n,l.context.bOneBit)}))).then((function(e){return 1==s&&ii(""),l&&l.terminate(),c&&c.terminate(),t.log("[Wasm]Save Image: save image terminate."),{blobData:e.imageData,type:a,MD5:e.MD5}}),(function(e){throw 1==s&&ii(""),t.Errors.SaveImageFailed(r,e),t.log("[Wasm]Save Image: save image failed."),l&&l.terminate(),c&&c.terminate(),{code:r._errorCode,message:r._getErrorString()}}))}if("pdf"==a){var _,p=new e.PdfWriter,v=o.length;p.context={},t.log("[Wasm]Save Image: save pdf"),s&&(t.showProgress(r),2==s?r._OnPercentDone([0,-1,e.MSG.ConvertingToBlob,""]):3==s?r._OnPercentDone([0,-1,e.MSG.ConvertingToBase64,""]):4==s?r._OnPercentDone([0,-1,e.MSG.Encoding,""]):r._OnPercentDone([0,-1,e.MSG.SavingPdf,""]));var y=p.initPdfSetting(r._pdfWriteSetting);for(r._scaleDownThreshold>0&&((c=gc()).context={}),p.context.cIndex=0,p.context.aryIndex=o,p.context.bSaveAsBinary=u,_=0;_<v;_++)y=y.then((function(){var e=p.context.cIndex,n=p.context.aryIndex;return t.log("[Wasm]Save Image: page "+p.context.cIndex+" start process."),r._ImgManager.getWebViewer().GetImageData(r._ImgManager.getUidByIndex(n[e]))})),y=(y=r._scaleDownThreshold<=0?y.then((function(e){t.log("[Wasm]Save Image: page "+p.context.cIndex+" get image data successfully. (no scale)");var r=1==e.metadata.bitDepth;return p.appendPage(e.oriData,r)})):(y=y.then((function(n){t.log("[Wasm]Save Image: page "+p.context.cIndex+" get image data successfully.");var i=n&&n.metadata?n.metadata:{},o=1==i.bitDepth;return p.context.bOneBit=o,e.ImageProcWrapper.resize(n.oriData,i.width,i.height,r._scaleDownThreshold,5,o)}))).then((function(e){return t.log("[Wasm]Save Image: page "+p.context.cIndex+" scale successfully."),p.appendPage(e.imageData,p.context.bOneBit)}))).then((function(){var e=p.context.cIndex,n=p.context.aryIndex.length;if(s){var i=e+1,o=100*i/(1*n);r._OnPercentDone([0,o,i+"/"+n,""])}t.log("[Wasm]Save Image: page "+p.context.cIndex+" processed."),p.context.cIndex=e+1}));return y.then((function(){var t=p.context.bSaveAsBinary?e.Enum_ReturnType.RT_BINARY:e.Enum_ReturnType.RT_AUTO;return p.writePdf(t)})).then((function(e){return t.log("[Wasm]Save Image: save pdf successfully."),s&&t.closeProgress(r),p.terminate(),c&&c.terminate(),{blobData:e.pdfData,type:"pdf",MD5:e.MD5}}),(function(e){throw s&&t.closeProgress(r),t.Errors.SaveImageFailed(r,e),t.log("[Wasm]Save Image: save pdf failed."),p.terminate(),c&&c.terminate(),{code:r._errorCode,message:r._getErrorString()}}))}if("tiff"==a){var b,I=o.length;t.log("[Wasm]Save Image: save tiff"),(l=hc()).context={},l.context.bSaveAsBinary=u,r._scaleDownThreshold>0&&((c=gc()).context={}),s&&(l.context.bShowPercentProgress=!0,t.showProgress(r),2==s?r._OnPercentDone([0,-1,e.MSG.ConvertingToBlob,""]):3==s?r._OnPercentDone([0,-1,e.MSG.ConvertingToBase64,""]):4==s?r._OnPercentDone([0,-1,e.MSG.Encoding,""]):r._OnPercentDone([0,-1,e.MSG.SavingTiff,""]));var w,S=l.createTiff(),T=e.DWT.EnumDWT_TIFFCompressionType;for(l.context.cIndex=0,b=ac,r._tiffCompressionType==T.TIFF_AUTO?b=ac:r._tiffCompressionType==T.TIFF_FAX3||r._tiffCompressionType==T.TIFF_T4?b=sc:r._tiffCompressionType==T.TIFF_FAX4||r._tiffCompressionType==T.TIFF_T6?b=uc:r._tiffCompressionType==T.TIFF_LZW?b=cc:r._tiffCompressionType==T.TIFF_JPEG?b=dc:r._tiffCompressionType==T.TIFF_PACKBITS&&(b=lc),l.context.tiffFormat=b,l.context.aryIndex=o,w=0;w<I;w++)S=t.MobileFuns.appendTiffPage(r,S,l,c);return(S=S.then((function(){t.log("[Wasm]Save Image: generate tiff data.");var r=l.context.bSaveAsBinary?e.Enum_ReturnType.RT_BINARY:e.Enum_ReturnType.RT_AUTO;return l.getTiff(r)}))).then((function(e){return t.log("[Wasm]Save Image: save tiff successfully."),l.context.bShowPercentProgress&&t.closeProgress(r),l.closeTiff(),l.terminate(),c&&c.terminate(),{blobData:e.imageData,type:"tiff",MD5:e.MD5}}),(function(e){throw l.context.bShowPercentProgress&&t.closeProgress(r),t.Errors.SaveImageFailed(r,e),t.log("[Wasm]Save Image: save tiff failed."),l.closeTiff(),l.terminate(),c&&c.terminate(),{code:r._errorCode,message:r._getErrorString()}}))}return t.Errors.InvalidImageType(r),t.Promise.reject({code:r._errorCode,message:r._getErrorString()})}function bc(r,n){var i,o,a,s;return n.length>0?i=n[0]:(s=e.Lib.product.refProductKey,t.License.isLTS()&&e.WasmEnv&&(s=e.WasmEnv.productKey),i=s),e.WasmEnv?r._isMobileMode()?(o=e.WasmEnv.licMode,a=e.WasmEnv.uuid,r.__productKey=i,e.WasmEnv.getLicenseInfo(i,o,a).then((function(e){if(e&&e.Detail)return e;throw t.Errors.LicenseEmptyOrInvalid(r),r.__productKey="",{code:r._errorCode,message:r._getErrorString()}}),(function(e){throw t.Errors.GetLicenseInfoFailed(r,e),r.__productKey="",{code:r._errorCode,message:r._getErrorString()}}))):r._serviceNotSupportAsync("GetLicenseInfo"):(t.Errors.GetLicenseInfoFailed(r,"wasm not load."),t.Promise.reject({code:r._errorCode,message:r._getErrorString()}))}function Ic(e){var t=e.__httpHeaderMap;return e.__httpHeaderMap={},t||(t=e.__httpHeaderMap),t}function wc(e,r){var n,i,o,a,s;return r.length>0&&(n=r[0]),r.length>1&&(i=r[1]),r.length>2&&(o=r[2]),t.isUndefined(n)?(t.Errors.InvalidParameter(e),t.isFunction(o)&&o(e._errorCode,e._getErrorString()),!1):(s=!!t.isFunction(i)&&function(){i(e.__HTTPPostResponseString,n,r)},a={bOnlyUploadForm:Rr,_this:e,url:n,asyncSuccessFunc:s,asyncFailureFunc:function(){t.isFunction(o)&&Ec(o,e,e.__HTTPPostResponseString,n,r)}},t._asyncUploadCmd(a),!0)}function Sc(r,n){var i,o,a,s,u,c,l,d,h;if(n.length>0&&(s=n[0]),n.length>1&&(u=n[1]),n.length>2&&(c=n[2]),n.length>3&&(l=n[3]),t.isUndefined(s))return t.Errors.InvalidParameter(r),t.isFunction(h)&&h(r._errorCode,r._getErrorString()),!1;var g,f=[];if(n.length>4&&(t.isFunction(n[4])?(g="RemoteFile",d=n[4],n.length>5&&(h=n[5])):(n.length>5&&(d=n[5]),n.length>6&&(h=n[6]),g=t.isString(n[4])?n[4]:"RemoteFile")),o=!!t.isFunction(d)&&function(e,t){Tc(d,r.__HTTPPostResponseString,t,n)},a=function(e){t.isFunction(h)&&Ec(h,r,r.__HTTPPostResponseString,e,n)},!r._checkIndices(u))return a(u),!1;if(t.isArray(u)&&t.each(u,(function(e){var t=r._ImgManager.convertClientIndexToServerId(e);-1!=t&&f.push(t)})),0==f.length)return t.Errors.InvalidIndex(r),a(u),!1;if(t.isUndefined(c))return t.Errors.InvalidImageType(r),a(u),!1;if(c==e.DWT.EnumDWT_ImageType.IT_BMP||c==e.DWT.EnumDWT_ImageType.IT_JPG||c==e.DWT.EnumDWT_ImageType.IT_PNG){if(f.length>1)return t.Errors.UploadIndexMoreThanOne(r),a(u),!1}else if(c!=e.DWT.EnumDWT_ImageType.IT_TIF&&c!=e.DWT.EnumDWT_ImageType.IT_PDF)return t.Errors.InvalidImageType(r),a(u),!1;return t.isUndefined(l)||l!=e.DWT.EnumDWT_UploadDataFormat.Binary&&l!=e.DWT.EnumDWT_UploadDataFormat.Base64?(t.Errors.InvalidDataFormat(r),a(u),!1):(i={bOnlyUploadForm:Or,method:"HTTPUpload",_this:r,url:s,serverIds:f,enumImageType:c,saveSetup:!1,dataFormat:l,fileName:g,retry:0,bOnlyEmptyIsOK:!0,objUploadFileStatus:!1,asyncSuccessFunc:o,asyncFailureFunc:a},t._asyncUploadCmd(i),!0)}function Tc(e,t,r,n,i){try{e(t,r,n,i)}catch(o){}t=r=n=i=null}function Cc(e,t,r){try{e(t._errorCode,t._getErrorString(),r)}catch(n){}t=r=null}function Ec(e,t,r,n,i,o){try{e(t._errorCode,t._getErrorString(),r,n,i,o)}catch(a){}t=r=n=i=o=null}function Mc(e,r){(t.cancelFrom==Me&&e.__IfShowProgressBar==Rr||t.cancelFrom!=Me&&e.__IfShowCancelDialogWhenImageTransfer==Rr)&&t.setBtnCancelVisibleForProgress(r)}function Dc(e,r,n,i,o,a,s,u,c,l,d,h,g,f){var m,_,p,v=i.size;return(m=v-s)>0?(m>=u?(m-=u,_=u):(_=m,m=0),(p=0==s&&_==v?i:i.slice(s,s+_))?t.dlgRef>0||0==e.__IfShowCancelDialogWhenImageTransfer?(p.name=o,Mc(e,!0),a["Content-Range"]=["bytes ",s,"-",s+p.size-1,"/",v].join(""),c({total:v,loaded:s}),ti.httpPostUpload(e,r,p,!0,0,a,!1,l,d,h,(function(p){0==m?(t.needShowTwiceShowDialog=!1,c({total:v,loaded:v}),t.isFunction(g)&&Tc(g,p)):(s+=_,setTimeout((function(){t.cancelFrom=De,Dc(e,r,n,i,o,a,s,u,c,l,d,h,g,f)}),100))}),f),!0):(t.Errors.UploadError(e,!0),f()):(t.Errors.UploadFileCannotEmpty(e),f())):(t.needShowTwiceShowDialog=!1,t.closeProgress(e,"HttpUpload"),t.isFunction(g)&&g(""),!0)}function kc(e,r,n,i,o,a,s,u,c,l,d){var h,g,f=i.getLength();if((h=f-s)>0){h>=u?(h-=u,g=u):(g=h,h=0);var m=i.getData(s,u);return m&&""!=m?t.dlgRef>0||0==e.__IfShowCancelDialogWhenImageTransfer?(Mc(e,!0),a["Content-Range"]=["bytes ",s,"-",s+g-1,"/",f].join(""),c({total:f,loaded:s}),ti.httpPostUploadString(e,r,m,o,0,a,!1,0,!0,(function(m){0==h?(t.needShowTwiceShowDialog=!1,c({total:f,loaded:f}),t.isFunction(l)&&Tc(l,m)):(s+=g,setTimeout((function(){t.cancelFrom=De,kc(e,r,n,i,o,a,s,u,c,l,d)}),100))}),d),!0):(t.Errors.UploadError(e,!0),d()):(t.Errors.UploadFileCannotEmpty(e),d())}return t.needShowTwiceShowDialog=!1,t.closeProgress(e,"HttpUpload"),t.isFunction(l)&&l(""),!0}function xc(r,n,i,o,a,s,u,c,l,d,h,g){var f,m=parseInt(o),_=parseInt(a),p=s,v="HTTPUpload",y=n,b=!1,I=r._moduleSize,w=r._segementUploadThreshold;if(r.__HTTPPostResponseString="",t.isUndefined(o))return t.Errors.InvalidImageType(r),t.isFunction(g)&&g(),!1;t.cancelFrom=De;var S,T=function(){return t.needShowTwiceShowDialog=!1,t.closeProgress(r,v),t.isFunction(g)&&g(),!1};if(f=function(e){var t=0===e.total?100:Math.round(100*e.loaded/e.total);[e.loaded," / ",e.total].join(""),r._OnPercentDone([0,t,"","http",p])},p=ti.addImageFileExt(p,m),t.needShowTwiceShowDialog=!0,t.showProgress(r,v,!1),_==e.DWT.EnumDWT_UploadDataFormat.Binary){if(d&&d.bCancel)return d.st=2,T();r._OnPercentDone([0,-1,e.MSG.Encoding,"http"]),b=r.__innerConvertToBlob(m,i,u,!0,4,(function(n,i,o){if(S=function(){return t.needShowTwiceShowDialog=!1,t.closeProgress(r,v),t.isFunction(h)&&Tc(h,n),!0},d&&d.bCancel)return d.st=2,T();if(!n||n.size<=0)return t.Errors.UploadFileCannotEmpty(r),T();var a=r.__maxUploadImageSize;if(n.size>a&&-1!=a)return t.Errors.UploadExceededMaxSize(r),T();if(0!=r._errorCode)return T();if(w>0&&n.size>w){var s=Ic(r);e.DWT.IfAddMD5InUploadHeader&&i&&""!=i&&(s["dwt-md5"]=i),r._OnPercentDone([0,-1,e.MSG.Uploading,"http",p]),b=Dc(r,y,m,n,p,s,0,I,f,c,l,d,S,T)}else b=r.__innnerHTTPUploadBinaryFull(y,i,n,m,p,c,l,d,S,T)}),T)}else if(_==e.DWT.EnumDWT_UploadDataFormat.Base64){var C;b=r._convertToBase64ByServerIds(i,m,u,4,(function(n){if(!n||n.getLength()<=0)return t.Errors.UploadFileCannotEmpty(r),T();if(S=function(){return t.needShowTwiceShowDialog=!1,t.closeProgress(r,v),t.isFunction(h)&&Tc(h,n),!0},w>0&&n.getLength()>w){var i=Ic(r);C=n.getMD5(),e.DWT.IfAddMD5InUploadHeader&&(i["dwt-md5"]=C),r._OnPercentDone([0,-1,e.MSG.Uploading,"http"]),kc(r,y,m,n,p,i,0,I,f,S,T)}else{var o;if(C=n.getMD5(),!(o=n.getData(0,n.getLength()))||""==o)return t.Errors.UploadFileCannotEmpty(r),T();!function(r,n,i,o,a,s,u,c,l,d){var h=Ic(r),g=s,f=n;t.dlgRef>0||0==r.__IfShowCancelDialogWhenImageTransfer?(e.DWT.IfAddMD5InUploadHeader&&h&&i&&""!=i&&(h["dwt-md5"]=i),Mc(r,!0),ti.httpPostUploadString(r,f,o,g,0,h,!0,u,c,(function(e){t.isFunction(l)&&Tc(l,e)}),d)):(t.Errors.UploadError(r,!0),d())}(r,y,C,o,0,p,c,l,S,T)}}),T)}return b}function Pc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(es){return!1}}();return function(){var r,n=et(e);if(t){var i=et(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return $e(this,r)}}t.MobileFuns={makeParams:function(){return arguments},_innerSaveLocal:function(r,n,i){var o=t.win,a=e.navInfoSync,s=o.requestFileSystem||o.webkitRequestFileSystem||o.mozRequestFileSystem;if((a.biPad||a.biPhone)&&!s&&(a.bSafari&&parseFloat(a.strBrowserVersion)<13||!a.bSafari)){var u=o.open(r,"","",!1);return setTimeout((function(){u&&(u.document.title=n)}),100),!0}var c=document.createElementNS("http://www.w3.org/1999/xhtml","a");if(c.href=r,c.download=n,c.target="_blank",document.body.appendChild(c),a.bEdge)c.click();else{var l=document.createEvent("MouseEvents");l.initMouseEvent("click",!0,!1),c.dispatchEvent(l)}return document.body.removeChild(c),!0},saveLocal:function(e,r,n){t.isString(e)&&e.indexOf("blob:http://")>-1?t.MobileFuns._innerSaveLocal(e,r,n):e instanceof Blob?t.MobileFuns._innerSaveLocal(URL.createObjectURL(e),r,n):e instanceof ArrayBuffer?t.MobileFuns._innerSaveLocal(URL.createObjectURL(new Blob([e])),r,n):t.MobileFuns._innerSaveLocal(e,r,n)},dataURLtoBlob:function(e){var t,r,n,i=e.split(","),o=i[0].match(/:(.*?);/)[1];try{t=atob(i[1])}catch(es){return t="",!1}for(r=t.length,n=new Uint8Array(r);r--;)n[r]=t.charCodeAt(r);return new Blob([n],{type:o})},appendTiffPage:function(r,n,i,o){var a=r,s=n,u=i.context.bShowPercentProgress,c=a._aryTiffTag.length;if(c>0){c>32&&(c=32);for(var l=0;l<c;l++)s=(s=s.then((function(e){i.context.tagIndex=0;var r=i.context.tagIndex,n=a._aryTiffTag[r];return t.log("[Wasm]Save Image: page "+i.context.cIndex+" add tiff tag "+n.tag),i.addTag(n.tag,n.content,n.UseBase64Encoding)}))).then((function(){var e=i.context.tagIndex;i.context.tagIndex=e+1}))}return s=s.then((function(){t.log("[Wasm]Save Image: page "+i.context.cIndex+" add tiff tag successfully");var e=i.context.aryIndex,r=i.context.cIndex;return a._ImgManager.getWebViewer().GetImageData(a._ImgManager.getUidByIndex(e[r]))})),a._scaleDownThreshold<=0||(s=(s=s.then((function(r){var n=r&&r.metadata?r.metadata:{};t.log("[Wasm]Save Image: scale"),i.context.metaData=n;var o=1==n.bitDepth;return e.ImageProcWrapper.resize(r.oriData,n.width,n.height,a._scaleDownThreshold,5,o)}))).then((function(e){return t.log("[Wasm]Save Image: scaled"),{oriData:e.imageData,metadata:i.context.metaData}}))),s=s.then((function(r){var n=e.DWT.EnumDWT_ImageType.IT_ALL,o=i.context.tiffFormat;t.log("[Wasm]Save Image: page "+i.context.cIndex+" append to tiff");var s=1==r.metadata.bitDepth;return i.appendImage(r.oriData,n,o,a._jpgQuality,s)})),u&&(s=s.then((function(){var e=i.context.aryIndex.length,t=i.context.cIndex+1,r=100*t/(1*e);a._OnPercentDone([0,r,t+"/"+e,""])}))),s=s.then((function(){var e=i.context.cIndex;return i.context.cIndex=e+1,e+1}))},unloadWasm:function(){return t.detect.wasmScriptLoaded&&e.WasmEnv,t.Promise.resolve()},convertOutputType:function(e){return e},isBlobUrl:function(e){return t.isString(e)&&e.indexOf("blob:http://")>-1},revoke:function(e){return!t.MobileFuns.isBlobUrl(e)||(window.URL||window.webkitURL).revokeObjectURL(e)}},t._asyncUploadCmd=function(e){var r=e._this,n=e.bOnlyUploadForm,i=e.url,o=e.asyncSuccessFunc,a=e.asyncFailureFunc;if(!n){var s=e.serverIds,u=e.enumImageType,c=e.dataFormat,l=e.fileName,d=e.saveSetup,h=e.retry,g=e.bOnlyEmptyIsOK,f=e.objUploadFileStatus,m=function(){if(t.isFunction(a)){var e=[];t.isArray(s)&&t.each(s,(function(t){var n=r._ImgManager.convertServerIdToClientIndex(t);n>-1&&e.push(n)}));try{a(e)}catch(n){}}return!1};return t.isNumber(h)&&h>0||(h=0),0!=r._errorCode?m():xc(r,i,s,u,c,l,d,h,g,f,(function(e){if(t.isFunction(o)){var n=[];t.isArray(s)&&t.each(s,(function(e){var t=r._ImgManager.convertServerIdToClientIndex(e);t>-1&&n.push(t)}));try{Tc(o,e,n)}catch(i){}}return!0}),m)}r._innerFormFieldHTTPUpload(i,(function(){if(t.isFunction(o))try{o()}catch(e){}}),(function(){if(t.isFunction(a))try{a()}catch(e){}}))};var Wc=function(r){Qe(i,r);var n=Pc(i);function i(){return Le(this,i),n.apply(this,arguments)}return Ae(i,[{key:"_getErrorString",value:function(){var e=this;return-2207==e._errorCode&&e.__bMustUpgradeService&&t.Errors.MustUpgradeService(e),0!=e._errorCode?e._errorString:"Successful."}},{key:"_getHowManyImagesInBuffer",value:function(){return this._isValid()?this._ImgManager.count():0}},{key:"_getWebTwainId",value:function(){return this._id}},{key:"_isMobileMode",value:function(){return this._iServiceType==de||this._iServiceType==ge}},{key:"_isWasmWithScan",value:function(){return this._iServiceType==ge}},{key:"_isTwainServiceType",value:function(){return this._iServiceType==he}},{key:"_isDMServiceType",value:function(){var e,t;return this._iServiceType==he&&""!=(null===(e=this._dmService)||void 0===e||null===(t=e.attrs)||void 0===t?void 0:t.UUID)}},{key:"_isPC",value:function(){var t=e.navInfoSync;return t.bWin||t.bMac||t.bLinux}},{key:"_resetErr",value:function(){this._errorCode=0,this._errorString="";var t=e.DWT.licenseException;t.code=0,t.message=""}},{key:"_isValid",value:function(){return!this._destroy||(t.Errors.Destroyed(this),!1)}},{key:"_isBindViewer",value:function(){return this._bBindViewer}},{key:"_isNoViewer",value:function(){return!this._bBindViewer}},{key:"_mobileNotSupport",value:function(e,r){var n=this;return t.Errors.MobileNotSupport(n,e),t.isFunction(r)&&r(n._errorCode,n._getErrorString()),!1}},{key:"_mobileNotSupportAsync",value:function(e){var r=this;return t.Errors.MobileNotSupport(r,e),t.Promise.reject({code:r._errorCode,message:r._getErrorString()})}},{key:"_serviceSyncMethodNotSupport",value:function(e){var r=this;return t.Errors.ServiceSyncMethodNotSupport(r,e),{code:r._errorCode,message:r._getErrorString()}}},{key:"_serviceAsyncMethodNotSupport",value:function(e){var r=this;return t.Errors.ServiceAsyncMethodNotSupport(r,e),{code:r._errorCode,message:r._getErrorString()}}},{key:"_serviceNotSupportAsync",value:function(e){var r=this;return t.Errors.ServiceNotSupport(r,e),t.Promise.reject({code:r._errorCode,message:r._getErrorString()})}},{key:"_nouiNotSupport",value:function(e,r){var n=this;return t.Errors.CannotCallUIMethodWhenNotBindDefaultViewer(n,e),t.isFunction(r)&&r(n._errorCode,n._getErrorString()),!1}}]),i}(Ae((function Hh(){Le(this,Hh)}))),Lc=window.SparkMD5;function Fc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(es){return!1}}();return function(){var r,n=et(e);if(t){var i=et(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return $e(this,r)}}var Vc=e.navInfoSync,Nc=function(r){Qe(i,r);var n=Fc(i);function i(){return Le(this,i),n.apply(this,arguments)}return Ae(i,[{key:"_innerFunRaw",value:function(r,n,i,o,a,s,u){var c,l,d,h,g=this,f="f/",m=!1;if(e.DWT.ConnectWithSocket)return this._innerSend(r,n,!1,s,u),!0;if(g._resetErr(),!g._isValid())return!1;var _=ti.isServerInvalid(g);if(i&&_)return g._waitForConnect().then((function(){return g._innerFunRaw(r,n,i,o,a,s,u)}));if(!i&&_)return t.Errors.ThrowString_FailedToCreateDWTObject(g),!1;if(i&&(m=!0,f="fa/"),d={method:"POST",url:c=[g._httpUrl,f,r].join(""),data:l=Ac(g._clientId,r,n,0),async:m,onSuccess:function(r,n,i){var o=!1;try{o=t.isString(r)&&"text/json"===i.getResponseHeader("content-type")?t.parse(r):r}catch(es){}o?(o.exception!==undefined&&o.description!==undefined?(g._errorCode=o.exception,g._errorString=o.description):g._resetErr(),h=a?o:o.result):(e.Lib.Errors.InvalidResultFormat(g),h=""),t.isFunction(s)&&s(h)},onError:function(){e.Lib.Errors.NetworkError(g),h="",!t.page.bUnload&&t.isFunction(u)&&u()}},!m&&o)Vc.bIE?(d.dataType="arraybuffer",d.onSuccess=function(r,n,i){var o,a,u,c=!1;i.responseHeadersString&&(-1!=i.responseHeadersString.indexOf("text/json")&&(c=!0));if(o=i.responseData,g._resetErr(),h=!1,o&&(a=new Uint8Array(o),c?o=String.fromCharCode.apply(null,a):(h=new Blob([a],{type:g.__strHttpContentTypeFieldValue}),(u=new Lc.ArrayBuffer).append(a),h.md5=u.end())),!o||c){var l,d=!1;if((l=c?o:i.responseText).length>0){if("{"==l.charAt(0))try{d=t.parse(l),c=!0}catch(f){e.Lib.log(l)}c?d.exception!==undefined&&d.description!==undefined?(g._errorCode=d.exception,g._errorString=d.description,h=!1):h=!0:(a=new Uint8Array(l),h=new Blob([a],{type:g.__strHttpContentTypeFieldValue}),(u=new Lc.ArrayBuffer).append(a),h.md5=u.end())}}t.isFunction(s)&&s(h)}):(m||(d.dataType="text",d.contentType="text/plain; charset=x-user-defined",d.mimeType="text/plain; charset=x-user-defined"),d.onSuccess=function(r,n,i){var o,a,u;if(g._resetErr(),(a=(o=i.responseText).length)>0){var c,l=!1;if("{"==o.charAt(0))try{c=t.parse(o),l=!0}catch(m){e.Lib.log(o)}if(l)c.exception!==undefined&&c.description!==undefined?(g._errorCode=c.exception,g._errorString=c.description,h=!1):h=!0;else{u=new Uint8Array(a);for(var d=0;d<a;d++)u[d]=o.charCodeAt(d);h=new Blob([u],{type:g.__strHttpContentTypeFieldValue});var f=new Lc.ArrayBuffer;f.append(u),h.md5=f.end()}}else h="";t.isFunction(s)&&s(h)});else if(m&&o){d={method:"POST",body:l},Vc.bIE?d.dataType="arraybuffer":d.fetchRaw=!0;var p=t.fetch(c,d);return Vc.bIE||(p=p.then((function(e){var t=e.headers.get("content-type");return t.indexOf("image/")>=0||t.indexOf("application/octet-stream")>=0?e.arrayBuffer():e.json()}))),p=p.then((function(r){if(g._resetErr(),r instanceof ArrayBuffer)return t.isFunction(s)&&s(r),void(r=null);if(t.isObject(r)){var n=r;if(n.exception!==undefined&&n.description!==undefined)g._errorCode=n.exception,g._errorString=n.description,t.isFunction(u)&&u();else{var i="";n.result&&(i=n.result),t.isFunction(s)&&s(i)}}else e.Lib.Errors.NetworkError(g),!t.page.bUnload&&t.isFunction(u)&&u()}),(function(r){e.Lib.Errors.NetworkError(g),!t.page.bUnload&&t.isFunction(u)&&u()})),!0}return m||t.mix(d,{headers:{"X-Requested-With":!1}}),Vc.bFileSystem&&(d.crossDomain=!1),t.ajax(d),!!m||h}},{key:"_innerSend",value:function(r,n,i,o,a){var s=this,u=null,c=null,l=!1,d=!0;if(!s._destroy){if("ActiveUI"==r?d=!1:l=ti.isServerInvalid(s),l)return s._waitForConnect().then((function(){s._innerSend(r,n,i,o,a)}))["catch"]((function(e){t.isFunction(a)&&a(e.code,e.message)}));t.isFunction(o)&&(c=o),t.isFunction(a)&&(u=a);var h,g=pi();if(e.DWT.ConnectWithSocket||"SaveSelectedImagesToBytes"!=r&&"ConvertToBlob"!=r){var f=s._innerGetCurrentDocumentName();""==f&&s._ImgManager&&(f=s._ImgManager.getWebViewer().GetDefaultFileName());var m={cmd:r,cmdId:g,sFun:c,fFun:u,currentFileName:f};h=s._innerSendByWS(r,n,m,null,d)}else{var _=Ac(s._clientId,r,n,g);s._innerFunRaw(r,_,!0,!0,!0,c,u),h=t.Promise.resolve(!0)}return h}}},{key:"_innerSendCmd",value:function(e,t){this._innerFunRaw(e,t,!0,!1,!0)}},{key:"_innerFun",value:function(t,r){var n;return n=this._innerFunRaw(t,r,!1,!1,!1),e.Lib.isArray(n)?n[0]:n}},{key:"_innerFunRawV2",value:function(r,n,i,o){var a,s=this;return s._resetErr(),s._isValid()?ti.isServerInvalid(s)?o?t.Promise.reject({code:s._errorCode,message:s._errorString}):s._waitForConnect().then((function(){return s._innerFunRawV2(r,n,i)})):(a={method:"post",body:Ac(s._clientId,r,n,0),dataType:i},e.DWT.ConnectWithSocket?new t.Promise((function(i,o){s._innerSend(r,n,!1,(function(e){var r=!1;try{r=t.isString(e)?t.parse(e):e}catch(es){}if(r){if(r instanceof Blob||r instanceof ArrayBuffer)return void i(r);r.exception!==undefined&&r.description!==undefined&&(s._errorCode=r.exception,s._errorString=r.description)}s._resetErr(),i(r)}),(function(t){if(e.Lib.Errors.NetworkError(s),t){var r=[s._errorString," ",t.errorString];t.httpCode&&(r.push(" ("),r.push(t.httpCode),r.push(")")),s._errorString=r.join("")}o({code:s._errorCode,message:s._errorString})}))})):t.fetch([s._httpUrl,"fa/",r].join(""),a).then((function(r){var n=!1;try{n=t.isString(r)?t.parse(r):r}catch(es){}if(n){if(n instanceof Blob||n instanceof ArrayBuffer)return n;if(n.exception===undefined||n.description===undefined)return s._resetErr(),n;s._errorCode=n.exception,s._errorString=n.description}else e.Lib.Errors.InvalidResultFormat(s);throw{code:s._errorCode,message:s._errorString}}),(function(r){if(e.Lib.Errors.NetworkError(s),r){var n=[s._errorString," ",r.errorString];r.httpCode&&(n.push(" ("),n.push(r.httpCode),n.push(")")),s._errorString=n.join("")}if(!t.page.bUnload)throw{code:s._errorCode,message:s._errorString}}))):t.Promise.reject({code:s._errorCode,message:s._errorString})}},{key:"_innerFunV2",value:function(t,r){return this._innerFunRawV2(t,r,"text").then((function(t){return t&&e.Lib.isArray(t.result)&&t.result.length>0?t.result[0]:t}))}},{key:"_innerSendByWS",value:function(e,r,n,i,o){var a,s,u,c,l=this,d=Oc;n?(a=n.cmdId,u=Bc(l._clientId,a),c=Bc(l._clientId,"")):(a=0,u=0,c=0);var h,g,f,m,_,p,v,y,b,I=Ac(l._clientId,e,r,a),w=l._wsClient;if(s={client:w,userData:{stwain:l,command:n},taskId:a,eventTaskId:u,lastEventTaskId:c},!o){try{w.request(I,d,s)}catch(es){t.log(es)}return Or}for(m=new ArrayBuffer(12),g=i&&i.size?i.size:0,f=(h=(y=new Blob([I])).size)+g,_=new DataView(m),v=0;v<8&&f;v++)_.setUint8(v,f%256),f=Math.floor(f/256);for(v=0;v<4&&h;v++)_.setUint8(8+v,h%256),h=Math.floor(h/256);return p=new Blob([m,y]),b=w.request(p,d,s),"GetLicenseInfo"==e?w._lic_callback=function(e){d(e,kt,"0",s)}:"ConvertToBlob"==e&&(w._blob_callback=function(e){d(e,Dt,"0",s)}),g>0&&(b=w.request(i,d,s)),m=null,y=null,p=null,_=null,i=null,b}},{key:"_innerGetCurrentDocumentName",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&(e._ImgManager?e._ImgManager.GetCurrentFileName():"")}},{key:"_waitForConnect",value:function(){var e=this;return e.__wsRetry=0,this._bReady?t.Promise.resolve():new t.Promise((function(t,r){e._wsCheckResolve=t,e._wsCheckReject=r,Gc(e)}))}}]),i}(Wc);function Ac(e,r,n,i){var o=[];o.push("{"),o.push('"id":"'),o.push(e),o.push('"'),i&&(o.push(',"cmdId":"'),o.push(i),o.push('"')),o.push(',"method":"'),o.push(r),o.push('"'),o.push(',"module":"dwt","version":"');var a=[t.product.getDWTPrefix(),t.product.getServerVersionInfo()].join("");return o.push(a),o.push('"'),n!==undefined&&null!==n&&(o.push(',"parameter":'),o.push(n)),o.push("}"),o.join("")}function Bc(e,t){return["evt",e,t].join("_")}function Oc(e,t,r,n){return Rc.apply(this,arguments)}function Rc(){return(Rc=Ke(it.mark((function r(n,i,o,a){var s,u,c,l,d,h,g,f,m;return it.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i!=St){r.next=4;break}return r.abrupt("return",a.taskId);case 4:if(i!=Tt){r.next=8;break}return r.abrupt("return",a.eventTaskId);case 8:if(i!=Ct){r.next=17;break}if("object"!==Fe(n)){r.next=11;break}return r.abrupt("return",n);case 11:if(!(n.indexOf("Version not found")>=0)){r.next=14;break}return r.abrupt("return",{cmdId:null!=o?o:0});case 14:return r.abrupt("return",t.parse(n));case 17:if(i!=Et){r.next=25;break}if(!n){r.next=22;break}if(!n.event){r.next=21;break}return r.abrupt("return",0);case 21:return r.abrupt("return",n.cmdId);case 22:return r.abrupt("return",n);case 25:if(i!=Mt){r.next=31;break}if(!n||!n.event){r.next=28;break}return r.abrupt("return",Bc(n.id,n.cmdId));case 28:return r.abrupt("return",0);case 31:if(i!=Dt){r.next=59;break}if(s=null==a?void 0:a.userData){r.next=35;break}return r.abrupt("return",!1);case 35:if(u=s.stwain,c=s.command){r.next=39;break}return r.abrupt("return",!1);case 39:if(u&&t.isFunction(u.__OnWSMessage)&&u.__OnWSMessage(n),"object"!==Fe(n)){r.next=44;break}if(!e.DWT.ConnectWithSocket){r.next=44;break}return"ConvertToBlob"!=c.cmd&&"GetImageByIndex"!=c.cmd||c.sFun(n),r.abrupt("return",!0);case 44:if(!((l=n.replace(/\0/g,"")).indexOf('"method" : "Heartbeat"')>=0)){r.next=47;break}return r.abrupt("return",!0);case 47:if(!(l.indexOf('"method" : "EnableBuffer"')>=0||l.indexOf('"method" : "GetBuffer"')>=0)){r.next=50;break}return e.DWT.lwsproc(l,c),r.abrupt("return",!0);case 50:if(!(l.indexOf("Exception:")>=0||0==l.indexOf("Error"))){r.next=57;break}return d=n,h=!1,t.log(d+"@"+c.cmd),c.fFun&&(h=c.fFun(d)),!h&&u&&t.isFunction(u.__OnPrintMsg)&&u.__OnPrintMsg(d),r.abrupt("return",!0);case 57:r.next=70;break;case 59:if(i!=kt){r.next=70;break}if(g=null==a?void 0:a.userData){r.next=63;break}return r.abrupt("return",!1);case 63:if(f=g.stwain){r.next=66;break}return r.abrupt("return",!1);case 66:if(m=g.command){r.next=69;break}return r.abrupt("return",!1);case 69:return r.abrupt("return",Uc(f,n,m));case 70:case"end":return r.stop()}}),r)})))).apply(this,arguments)}function Uc(r,n,i){var o=null==i?void 0:i.cmd;if(!n.event){if(n.exception!==undefined&&n.description!==undefined?(r._errorCode=n.exception,r._errorString=n.description):"StartScan"!=o&&"GetAddOnVersion"!=o&&(r._errorCode=0,r._errorString=""),"ReadBarcode"==o||"OCRRecognize"==o||n.request&&"OCRProRecognize"==n.request.method)return i.sFun&&i.sFun(n),!0;if("ActiveUI"==o||"VersionInfo"==o||"ConvertToBase64"==o||"SaveSelectedImagesToBase64Binary"==o||"ConvertToBlob"==o)return i.sFun&&t.isArray(n.result)&&n.result.length>0?(i.sFun(n.result),!0):(i.fFun(n.result),!0);if("ShowFileDialog"==o||"SplitTiff"==o||"SplitPDF"==o||"EncodeAsBase64"==o||"ProductKey"==o||"GetSourceNames"==o||"GetSkewAngle"==o||"GetImageInfo"==o){if(i.sFun)return i.sFun(n.result),!0}else if("GetLicenseInfo"==o&&t.isArray(n.Detail)){if(i.sFun)return i.sFun(n),!0}else if("SetCapabilities"==o)return"exception"in n&&"0"!=n.exception?(n.result.errorCode&&n.result.errorString?(r._errorCode=n.result.errorCode,r._errorString=n.result.errorString):(r._errorCode=n.exception,r._errorString=n.description),i.fFun&&i.fFun(n.result),n=null,!0):(i.sFun&&i.sFun(n.result),n=null,!0);if(n.result&&n.result.length&&("1"==n.result[0]||1==n.result[0]))i.sFun&&i.sFun();else if(n.exception){var a=!1;i.fFun&&(a=i.fFun(r._errorString)),!a&&n.exception&&n.exception<0&&-2115!=n.exception&&t.isFunction(r.__OnPrintMsg)&&r.__OnPrintMsg(r._errorString)}else{if("LoadImage"==o||"LoadImageEx"==o||"LoadImageFromBytes"==o||"LoadImageFromBase64Binary"==o||"LoadDibFromClipboard"==o||"FTPDownload"==o||"FTPDownloadEx"==o)return i.sFun&&i.sFun(n.result),n=null,!0;if(e.DWT.ConnectWithSocket){var s;if(i.sFun)s=t.isArray(n.result)&&n.result.length>0?n.result[0]:n.result,i.sFun(s);return n=null,!0}i.fFun&&i.fFun(Jn(["result:"],n.result))}return!0}"OnBitmapChanged"==n.event?ti.handleOnBitmapChangedEvent(r,n,i.currentFileName):function(e,r,n){var i=r.result[0],o=Or;t.each(ti.EVENTS,(function(n,i){if(r.event===n){var a=["_",n].join("");return o=Rr,t.isFunction(e[a])&&e[a](r.result,r),Or}})),o?(t.log("handled event:"+r.event),t.each(ti.SEND_BACK_EVENTS,(function(n,o){if(r.event===n)return t.log("sendback event:"+r.event),e._innerSendByWS(r.event,Zn(i),null,null,Rr),Or}))):(t.each(t.Addon_Events,(function(n,i){if(r.event===n){var a=["_",n].join("");return o=Rr,t.isFunction(e[a])&&e[a](r.result),Or}})),o&&(t.log("handled addon event:"+r.event),t.each(t.Addon_Sendback_Events,(function(n,o){if(r.event===n)return t.log("sendback addon event:"+r.event),e._innerSendByWS(r.event,Zn(i),null,null,Rr),Or}))))}(r,n,i.currentFileName)}function Gc(r){if(r._bReady)r._wsCheckResolve();else{if(e.DWT.bConnectCanceled)return t.asyncQueue.stop(),t.Errors.UserCanceled(r),void r._wsCheckReject({code:r._errorCode,message:r._errorString});if(r.__wsRetry>10)return t.Errors.ThrowString_FailedToCreateDWTObject(r),void r._wsCheckReject({code:r._errorCode,message:r._errorString});r.__wsRetry++,setTimeout((function(){Gc(r)}),1100)}}function jc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(es){return!1}}();return function(){var r,n=et(e);if(t){var i=et(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return $e(this,r)}}var zc=e.navInfoSync;t.html5.Funs;var Hc={upload:"Uploading...",download:"Downloading...",load:"Processing...",decode:"Processing...",decodeTIFF:"Processing tiff...",decodePDF:"Processing pdf...",encodeTIFF:"Processing tiff...",encodePDF:"Processing pdf...",encode:"Processing..."},Xc=function(e,r){if(t.config.bDiscardBlankImage){var n=e._ImgManager.getCurrentImageIndex();e.IsBlankImage(n)&&e.RemoveImage(n);var i=["Blank Discard (",r,"): ",e.ErrorString].join("");t.isFunction(e.__OnPrintMsg)&&e.__OnPrintMsg(i)}};var Yc=function(r){Qe(i,r);var n=jc(i);function i(){return Le(this,i),n.apply(this,arguments)}return Ae(i,[{key:"_innerRegisterEvent",value:function(e,r){var n=this;if(n._resetErr(),!n._isValid())return!1;var i=["__",e].join("");if("OnPostTransferAsync"==e){n[i]||(n[i]={});var o=n[i],a=t.guid();return o[a]=r,a}return n[i]=r,!0}},{key:"_unregisterEvent",value:function(e,r){var n=this;if(n._resetErr(),!n._isValid())return!1;var i=["__",e].join("");if("OnPostTransferAsync"==e){var o=n[i];if(t.isObject(o)){if(r){var a;if(t.isString(r))return delete o[r],Rr;if(t.isFunction(r))for(a=0;a<o.length;a++)if(r==o[a])return o.splice(a,1),Rr}n[i]=null}}else n[i]=null;return Rr}},{key:"_OnRemoteScanStatusAsync",value:function(e){var r,n,i,o,a,s,u,c=this;if(e&&e.length>=2){try{var l=new String(e[1]);r=t.parse(l)}catch(h){t.error(h.message),t.log("parse json failed: "+e[1])}r||(r={sequence:0,screen:[]})}if(r&&r.sequence)if(r.sequence>0&&r.screen&&r.screen.length>0){if(n=r.screen,o=r.sequence,s=r.wnds,u=(i=n[0]).img,t.isString(u)&&""!=u&&(a=i.wnd),o&&a){var d=t.one(".ds-img-screen");d&&c._acquireDivEL&&(c._acquireDivEL.evtFun&&(t.removeEventListener(d[0],"mouseup",c._acquireDivEL.evtFun),c._acquireDivEL.evtFun=null),d[0].src=u,c._acquireDivEL.evtFun=function(e){s||(s="0");var r=t.stringify({sequence:o,wnds:s,wnd:a+"",type:2,x:e.offsetX,y:e.offsetY});c._innerSendCmd("SendEventToScannerUI",["[",r,"]"].join(""))},t.addEventListener(d[0],"mouseup",c._acquireDivEL.evtFun))}}else c.__closeRemoteScanUI(!1);return t.isFunction(c.__OnRemoteScanStatusAsync)&&c.__OnRemoteScanStatusAsync(r),!0}},{key:"_OnConsumed",value:function(e){}},{key:"_OnBitmapChanged",value:function(r,n,i){var o=this,a="10"==r[0],s="0"==r[0],u="c2"==r[0],c=s||u||a,l=r[1].split(","),d=r[2],h=r[3],g=o.__maxImagesInBuffer,f=i,m=-1,_=[];if(t.log("_OnBitmapChanged.currentFileName="+f),f||""==(f=o._innerGetCurrentDocumentName())&&o._ImgManager&&(f=o._ImgManager.getWebViewer().GetDefaultFileName()),a){if(r.length>5){var p=r[5];_.push(p),!o._blts||1!=d&&2!=d||e.Lib.isUndef(p.verify)||(m=e.DWT.lgct(p.verify),t.isFunction(o.__OnLtsverify)&&o.__OnLtsverify(m,1,e.DWT.EnumInstance.dwt_browser),e.DWT.lavrf(m,1,e.DWT.EnumInstance.dwt_browser,""))}}else if(u)r.length>5&&(_=r[5]),t.isArray(_)||(_=[]);else{var v={};if(r.length>5&&(v.width=r[5]),r.length>6&&(v.height=r[6]),r.length>7&&(v.bitDepth=r[7]),r.length>8&&(v.resolutionX=r[8]),r.length>9&&(v.resolutionY=r[9]),r.length>10&&(m=r[10]),_.push(v),m>-1&&o._blts&&(1==d||2==d)){var y=e.DWT.lgct(m);t.isFunction(o.__OnLtsverify)&&o.__OnLtsverify(y,1)}}if(t.log("OnBitmapChanged:"+r),2==d||1==d&&!o.__IfAppendImage)t.each(l,(function(e,t){var r,n=parseInt(e),i=o._ImgManager.getCurrentImageIndex();if((r=t<_.length&&_[t]?_[t]:{}).currentFileName=f,isNaN(n)||n<0)return!0;if(c)o._aryBitmapCache.push(n);else for(var a=0;a<o._aryBitmapCache.length;a++)if(o._aryBitmapCache[a]==n)return o._aryBitmapCache.splice(a,1),!0;if(o._ImgManager.exists(n))return!0;o.__insertingIndex>-1&&(i=o.__insertingIndex),-1==i&&(i=0),o._ImgManager.insertBefore(i,g,n,r),o.__insertingIndex>-1&&(o.__insertingIndex=o.__insertingIndex+1)})),t.isFunction(o.__OnRefreshUI)&&o.__OnRefreshUI(o._ImgManager.getCurrentImageIndex(),o._ImgManager.count());else if(1==d&&o.__IfAppendImage)t.each(l,(function(e,r){var n,i=parseInt(e);if(isNaN(i)||i<0)return!0;if((n=r<_.length&&_[r]?_[r]:{}).currentFileName=f,t.log("metaDataObj.currentFileName="+f),c)o._aryBitmapCache.push(i);else for(var a=0;a<o._aryBitmapCache.length;a++)if(o._aryBitmapCache[a]==i)return o._aryBitmapCache.splice(a,1),!0;if(o._ImgManager.exists(i))return!0;o._ImgManager.append(g,i,n)})),t.isFunction(o.__OnRefreshUI)&&o.__OnRefreshUI(o._ImgManager.getCurrentImageIndex(),o._ImgManager.count());else if(3==d&&c){var b=!1;1==l.length&&-1==l[0]&&(b=!0),b?o._ImgManager.clear():t.each(l,(function(e,t){var r=parseInt(e);if(isNaN(r)||r<0)return!0;o._ImgManager.removeByServerId(f,r)})),t.isFunction(o.__OnRefreshUI)&&o.__OnRefreshUI(o._ImgManager.getCurrentImageIndex(),o._ImgManager.count())}else if(4==d)t.each(l,(function(e,t){var r,n=parseInt(e);if(isNaN(n)||n<0)return!0;if((r=t<_.length&&_[t]?_[t]:{}).currentFileName=f,n>=0&&!o.__bLoadingImage){o._isBindViewer()&&(0==o._ImgManager.bImageJustChangedInEditor?o._ImgManager.bImageChangedInViewer=!0:(o._ImgManager.bImageJustChangedInEditor=!1,o._ImgManager.bImageChangedInViewer=!1));var i=o._ImgManager.convertServerIdToClientIndex(n);i>-1&&o.__onRefreshUI(i,o._ImgManager.count(),!0,r)}}));else if(5==d){var I;if(h>=0&&!o.__bLoadingImage)(I=0<_.length&&_[0]?_[0]:{}).currentFileName=f,0==o.__IfAppendImage&&o.__onRefreshUI(h,o._ImgManager.count(),!0,I),o._ImgManager.refresh(h,o._ImgManager.count(),!1,I)}if(t.isFunction(o.__OnBitmapChanged)){if(!a){if(zc.bFirefox&&!c)return!0;if(!zc.bFirefox&&c)return!0}var w=[];t.each(l,(function(e){var t,r=parseInt(e);if(isNaN(r)||r<0)return!0;(t=o._ImgManager.convertServerIdToClientIndex(r))>-1&&w.push(t)}));var S=o._ImgManager.getCurrentImageIndex(),T=d;1==d&&(T=o.__IfAppendImage?1:2),o.__OnBitmapChanged(w,T,S,o._ImgManager.count())}}},{key:"_OnPostLoad",value:function(e,r){var n,i,o,a,s=this;r!==undefined&&r.exception!==undefined&&r.description!==undefined&&(s._errorCode=r.exception,s._errorString=r.description),t.log("OnPostLoad Results:"),i=e[1].split(","),n=t.base64.decode(i[0]),o=t.base64.decode(i[1]),t.log(n),t.log(o),t.log(i[2]),Xc(s,"On PostLoad"),(a=s._ImgManager.getCurrentImageIndex())>=0&&s.__onRefreshUI(a),t.isFunction(s.__OnPostLoad)&&s.__OnPostLoad(n,o,i[2])}},{key:"_OnPostTransfer",value:function(e){var r=this;t.log("On PostTransfer Results:"+e),Xc(r,"On PostTransfer"),t.isFunction(r.__OnPostTransfer)&&r.__OnPostTransfer()}},{key:"_OnPostTransferAsync",value:function(e){var r,n=this;if(t.log("On PostTransfer Async Results:"+e),e&&e.length>=2)try{var i=String(e[1]).replace(/\\/g,"\\\\");(r=t.parse(i)).imageId&&(r.imageId=n._objImageIndexManager.convertServerIdToGuid(r.imageId))}catch(o){t.log(e)}if(r||(r={imageId:-1}),n.__OnPostTransferAsync)return function(e,r){for(var n=0,i=Object.keys(e),o=t.Promise.resolve(),a=function(){var a=e[i[n]];t.isFunction(a)&&(o=o.then((function(){return a(r)})))};n<i.length;n++)a();return o}(n.__OnPostTransferAsync,r)}},{key:"_OnPreAllTransfersAsync",value:function(e){var r=this;if(t.isFunction(r.__OnPreAllTransfersAsync)){var n={event:"beforeAcquire",result:{}};try{t.isArray(e)&&e.length>1&&(n=t.parse(e[1]))}catch(i){}setTimeout((function(){r.__OnPreAllTransfersAsync(n)}),10)}}},{key:"_OnPostAllTransfers",value:function(r){var n=this;r.length>=2&&0==n._errorCode&&(n._errorCode=r[1],n._errorString=r[2]),t.log("On PostAllTransfers Results:"+r),n.__bLoadingImage=!1,n.__bAcquireImageNow=!1,n.__closeRemoteScanUI(!0),t.isFunction(n.__OnPostAllTransfers)&&n.__OnPostAllTransfers(),n._blts&&e.DWT.lcvrf(n)}},{key:"_OnResult",value:function(e){var r=e[1];t.isFunction(this.__OnResult)&&this.__OnResult(r)}},{key:"_OnTransferCancelled",value:function(e){var r=this;r._ImgManager.getCurrentImageIndex(),r._ImgManager.count(),r.__bLoadingImage=!1,r.__bAcquireImageNow=!1,t.isFunction(r.__OnTransferCancelled)&&r.__OnTransferCancelled()}},{key:"_OnTransferError",value:function(e){t.isFunction(this.__OnTransferError)&&this.__OnTransferError()}},{key:"_OnSourceUIClose",value:function(e){var r=this;r.__closeRemoteScanUI(!0),t.isFunction(r.__OnSourceUIClose)&&r.__OnSourceUIClose()}},{key:"_OnPreTransfer",value:function(e){t.isFunction(this.__OnPreTransfer)&&this.__OnPreTransfer()}},{key:"_OnPreAllTransfers",value:function(e){t.isFunction(this.__OnPreAllTransfers)&&this.__OnPreAllTransfers()}},{key:"_OnPercentDone",value:function(t){var r,n,i,o,a,s=this,u=!1,c=e.Lib,l=!1,d=0;if(c.isArray(t)&&t.length>2&&(n=t[0],d=t[1],i=t[2],t.length>3&&(o=t[3]),t.length>4&&(a=t[4]),t.length>5&&t[5],r=d,d<0?r=0:d>100&&(r=100),r=Math.floor(r),c.cancelFrom!=De&&c.cancelFrom!=ke&&c.cancelFrom!=We||(l=a)),s._bServerPercentDone||0==n){if((d>0||0==d)&&(c.cancelFrom!=De&&c.cancelFrom!=ke||"http"==o&&(u=!0),c.cancelFrom!=xe&&c.cancelFrom!=Pe||"ftp"==a&&(u=!0)),c.cancelFrom==Me&&1==s.__IfShowProgressBar||c.cancelFrom!=Me&&1==s.__IfShowCancelDialogWhenImageTransfer){var h,g=c.one(".dynamsoft-progressBar"),f=c.one(".dynamsoft-status"),m=c.one(".dynamsoft-finalMessage"),_=c.one(".dynamsoft-desc");if(c.cancelFrom==xe||c.cancelFrom==Pe){var p=o;0==p?Mc(s,!1):1==p&&Mc(s,!0)}if(d<0?(c.progressMessage=i,h=c.progressMessage):h=""!=i&&"1/1"!=i?c.progressMessage+"("+i+")":c.progressMessage,m&&m.getEL()){var v="",y="";h.indexOf(" ...")&&(h=h.replace(" ...","...")),-1!=h.indexOf("(")?(v=h.substr(0,h.indexOf("(")),y=h.substr(h.indexOf("("))):v=h,c.each(Hc,(function(t,r){-1!=t.indexOf(v)&&(h=e.Lib.product.CustomizableDisplayInfo.customProgressText[r]+y)})),""==h&&(h="&nbsp;"),m.html(h)}if(0!=l?(""==l||c.isUndef(l)?l="&nbsp;":c.isString(l)&&l.length>30&&(l=l.substring(0,30)+"..."),_.html(l)):_.html("&nbsp;"),(r||0===r)&&(f&&f.getEL()&&f.html(r+"%"),g&&g.getEL()&&(zc.bIE?g[0].objProgressBar?g[0].objProgressBar.setValue(r):g[0].value=r:zc.bEdge?(g[0].style.display="",g[0].value=r):g[0].value=r)),r&&(r>=100||c.dlgRef<=0)&&(setTimeout((function(){g&&g.getEL()&&(zc.bIE?g[0].objProgressBar?g[0].objProgressBar.setValue(0):g[0].value=0:zc.bEdge?(g[0].style.display="none",g[0].value=0):g[0].value=0)}),1e3),c.dlgRef<=0)){c.closeProgress(s,"OnPercentDone")}}1==u&&(c.isFunction(s.__OnInternetTransferPercentage)&&s.__OnInternetTransferPercentage(r,!1),c.isFunction(s.__OnInternetTransferPercentageEx)&&s.__OnInternetTransferPercentageEx(r,!1)),c.isFunction(s.__OnPercentDone)&&s.__OnPercentDone()}}},{key:"_OnGetFilePath",value:function(e){var r,n,i,o=this;r=e[1].split(","),t.log("On GetFilePath Results:"+e),n=t.base64.decode(r[3]),i=t.base64.decode(r[4]),"-1032"==r[2]&&(r[2]="-1",n=i=""),t.isFunction(o.__OnGetFilePath)&&o.__OnGetFilePath(1*r[0],1*r[1],1*r[2],n,i),o.__bOpenFileNow=!1}},{key:"__GetLoadEventsNum",value:function(){var e=0;return t.isFunction(this.__OnPostLoad)&&(e|=1),t.isFunction(this.__OnGetFilePath)&&(e|=2),e}},{key:"_OnPageFocus",value:function(r){var n=this;if(n._bPageFocus=!0,(n._isMobileMode()||n._bReady)&&zc.bWin&&!n._isMobileMode()&&e.DWT.IfAlwaysFocusOnPopupWindow){var i=t.stringify({sequence:0,wnds:0,wnd:"0",type:3,x:0,y:0});(n.__bAcquireImageNow||r||n.__bOpenFileNow)&&(n._bServerAlwaysFocusOnPopupWindow=!0,n._innerSendCmd("SendEventToScannerUI",["[",i,"]"].join("")))}}},{key:"_OnPageBlur",value:function(e){var r=this;if(zc.bWin&&!r._isMobileMode()&&r._bReady){var n=t.stringify({sequence:0,wnds:0,wnd:"0",type:4,x:0,y:0});(0!=r._bPageFocus||e)&&(r._bPageFocus=!1,(r.__bAcquireImageNow||e||r.__bOpenFileNow)&&(r._bServerAlwaysFocusOnPopupWindow=!1,r._innerSendCmd("SendEventToScannerUI",["[",n,"]"].join(""))))}}},{key:"__closeRemoteScanUI",value:function(e){var r=this;if(r._acquireDivEL){var n=t.one(".ds-img-screen");r._acquireDivEL.evtFun?(n&&n.length>0&&t.removeEventListener(n[0],"mouseup",r._acquireDivEL.evtFun),r._acquireDivEL.evtFun=null):n&&n.length>0&&t.removeEventListener(n[0],"mouseup"),n&&n.length>0&&(n[0].src=""),e&&(document.body.removeChild(r._acquireDivEL),r._acquireDivEL=null)}}},{key:"__onRefreshUI",value:function(t,r,n,i){var o=this;return n&&o._ImgManager.refresh(t,o._ImgManager.count(),!0,i),e.Lib.isFunction(o.__OnRefreshUI)&&o.__OnRefreshUI(o._ImgManager.getCurrentImageIndex(),o._ImgManager.count()),!0}}]),i}(Nc);function Jc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(es){return!1}}();return function(){var r,n=et(e);if(t){var i=et(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return $e(this,r)}}var Kc=e.navInfoSync,Zc=function(r){Qe(i,r);var n=Jc(i);function i(){return Le(this,i),n.apply(this,arguments)}return Ae(i,[{key:"_getVersionInfoAsync",value:function(){return this._innerFunV2("VersionInfo")}},{key:"__innerLoadImage",value:function(e,r,n,i,o,a,s){var u=this;if(!t.License.checkProductKey(u,{Core:!0}))return t.isFunction(s)&&s(u._errorCode,u._getErrorString()),!1;if(!t.License.checkPDFProductKeyWhenNeeds(u,n))return t.isFunction(s)&&s(u._errorCode,u._getErrorString()),!1;if(t.isFunction(a))return u._bRemoteMode&&u._getIfShowFileDialog()?(t.Errors.RemoteServiceCannotSetShowFileDialog(u),{code:u._errorCode,message:u._getErrorString()}):u.__innerAcquireImage(e,r,i,!0,a,s);if(u._bRemoteMode&&u._getIfShowFileDialog())return t.Errors.RemoteServiceCannotSetShowFileDialog(u),{code:u._errorCode,message:u._getErrorString()};var c=u._innerGetCurrentDocumentName();return""==c&&u._ImgManager&&(c=u._ImgManager.getWebViewer().GetDefaultFileName()),u.__innerLoadImageFun(e,r,o,c)}},{key:"__innerLoadImageFun",value:function(r,n,i,o){var a,s=this,u=!0;if(a=s._innerFunRaw(r,n,!1,!1,!0),s.__bOpenFileNow=!1,t.isArray(a.result)&&a.result.length>0){var c="",l=[];if(i){var d=a.result[0];t.isObject(d)?(c=d.ids,l=d.metaData):-1!=d||"LoadImage"!=r&&"LoadImageEx"!=r&&"FTPDownloadEx"!=r&&"FTPDownload"!=r&&"LoadImageFromBase64Binary"!=r||(u=!1)}else c=a.result.join(",");if(t.isArray(l)||(l=[]),s._OnBitmapChanged(["c2",c,1,s._ImgManager.getCurrentImageIndex(),s._ImgManager.count(),l],null,o),u)return s._blts&&e.DWT.lcvrf(s),!0}return e.Lib.Errors.bImageOnlyError_NotPurelyPDF(s._errorCode)&&e.Lib.Errors.LicenseNoPDF(s),!1}},{key:"_initRemoteDiv",value:function(){if(!this._acquireDivEL){var e=document.createElement("div");e.style.position="absolute",e.style.zIndex="510000",e.style.left="0",e.style.top="0";var t=document.createElement("img");t.className="ds-img-screen",e.appendChild(t),document.body.appendChild(e),this._acquireDivEL=e}}},{key:"__innerAcquireImage",value:function(r,n,i,o,a,s){var u=this,c="LoadImage"==r||"LoadImageEx"==r||"GenerateURLForUploadData"==r,l=c||"LoadDibFromClipboard"==r,d=function(n){u.__bLoadingImage=!1,u.__bAcquireImageNow=!1,u.__bOpenFileNow=!1,u.__closeRemoteScanUI(!0);var i=u._ImgManager.getCurrentImageIndex();return i>=0&&u.__onRefreshUI(i),e.Lib.Errors.bImageOnlyError_NotPurelyPDF(u._errorCode)&&e.Lib.Errors.LicenseNoPDF(u),t.isFunction(s)&&s(u._errorCode,u._getErrorString()),c?e.Lib.closeProgress(u,r):ii(r),n&&e.Lib.error(n),!1};return c?e.Lib.showProgress(u,r,!1):ni(r,u),u._innerSend(r,n,!0,(function(n){if(u.__bLoadingImage=!1,u.__bOpenFileNow=!1,u.__closeRemoteScanUI(!0),c){if(e.Lib.closeProgress(u,r),u._isBindViewer()){var i=u._ImgManager.getCurrentImageIndex();i>=0&&u.__onRefreshUI(i)}}else ii(r);t.isFunction(a)&&a(n),l&&u._blts&&e.DWT.lcvrf(u)}),(function(){c?e.Lib.closeProgress(null,""):ii(r),t.isFunction(d)&&d()})),!0}},{key:"__innerSaveImage",value:function(r,n,i,o){var a=this;if(a._OnPercentDone([0,-1,e.MSG.Encoding]),a._bRemoteMode||(e.DWT.IfAlwaysFocusOnPopupWindow?a._OnPageFocus(!0):a._OnPageBlur(!0)),!t.isFunction(o))return a._bRemoteMode?a._serviceSyncMethodNotSupport(r):this._innerFun(r,n);if(a._bRemoteMode&&a._getIfShowFileDialog())return t.Errors.RemoteServiceCannotSetShowFileDialog(a),{code:a._errorCode,message:a._getErrorString()};return e.Lib.showProgress(a,r,!1),this._innerSend(r,n,!0,(function(){e.Lib.closeProgress(a,r),t.isFunction(i)&&i()}),(function(n){return t.isFunction(o)&&o(a._errorCode,a._getErrorString()),e.Lib.closeProgress(a,r),n&&e.Lib.error(n),!0})),!0}},{key:"__captureImage",value:function(e,t,r,n){var i=this.__GetLoadEventsNum();return this.__LoadImageFromBytesV2(e,t,"",!0,0,0,!0,i,r,n)}},{key:"__LoadImageFromBytes",value:function(e,t,r,n,i,o,a,s){return this.__LoadImageFromBytesV2(e,t,r,n,a,s,!1,0,i,o)}},{key:"__LoadImageFromBytesV1",value:function(e,t,r,n,i,o,a){return this.__LoadImageFromBytesV2(e,t,r,i,0,0,!1,n,o,a)}},{key:"__LoadImageFromBytesV2",value:function(r,n,i,o,a,s,u,c,l,d){var h,g=this,f="LoadImageFromBytes",m=n||3,_=r.size||r.length,p=r.name,v=!0,y=1;!isNaN(a)&&a>=0&&!isNaN(s)&&s>0?y=0:(a=0,s=0),h=["[",_,",",0,",",m,',"',i,'",',a,",",s,",",c,",",y,",",u?"true":"false","]"].join("");var b=function(){if(e.Lib.closeProgress(g,f),g.__bLoadingImage=!1,v){var r=g._ImgManager.getCurrentImageIndex();r>=0&&g.__onRefreshUI(r)}return t.isFunction(d)&&d(g._errorCode,g._getErrorString(),p),!1};return(t.License.checkProductKey(g,{Core:!0})||e.navInfoSync.bWin&&t.License.checkProductKey(g,{Webcam:!0},!0))&&t.License.checkPDFProductKeyWhenNeeds(g,n)?0===_?(e.Lib.Errors.ImageFileLengthCannotZero(g),v=!1,b()):(Mc(g,!1),this._innerSendBlob(f,h,r,o,y,(function(r){if((a+_==s||s<=0||isNaN(s))&&e.Lib.closeProgress(g,f),g.__bLoadingImage=!1,g._isBindViewer()){var n=g._ImgManager.getCurrentImageIndex();o&&n>=0&&g.__onRefreshUI(n)}if(t.isFunction(l)){var i=r;if(t.isArray(i)&&(i=i.length>0?i[0]:{}),o)setTimeout((function(){l(p,i)}),30);else try{l(p,i)}catch(u){e.Lib.error(u.message)}}return g._blts&&e.DWT.lcvrf(g),!0}),b)):(v=!1,b())}},{key:"_innerSendBlob",value:function(r,n,i,o,a,s,u){var c=this,l=!1;if(ti.isServerInvalid(c))return c._waitForConnect().then((function(){c._innerSendBlob(r,n,i,o,a,s,u)}));if(t.isFunction(u)&&(l=u),!o){var d,h,g,f,m=[],_="";return c._resetErr(),c._isValid()?(h=[c._httpUrl,"f/",r].join(""),g=Ac(c._clientId,r,n,0),g+="\r\n\r\n",f={method:"POST",url:h,processData:!1,data:g+=e.Lib.base64.encodeArray(i),async:!1,onSuccess:function(r,n,i){var o=!1,s=!1;try{o=t.isString(r)&&"text/json"===i.getResponseHeader("content-type")?t.parse(r):r}catch(es){}if(o!==undefined&&null!==o&&(o.exception!==undefined&&o.description!==undefined?(c._errorCode=o.exception,c._errorString=o.description):c._resetErr(),(d=o.result)&&t.isArray(d)&&d.length>=1))if(a){var u=d[0];u&&t.isObject(u)&&(_=u.ids,t.isArray(u.metaData)&&(m=u.metaData),s=!0)}else _=d.join(","),m=[],s=!0;s||(e.Lib.Errors.InvalidResultFormat(c),d="",m=[])},onError:function(){e.Lib.Errors.NetworkError(c),d="",m=[]}},t.mix(f,{headers:{"X-Requested-With":!1}}),Kc.bFileSystem&&(f.crossDomain=!1),t.ajax(f),0==c._errorCode?(_.length>0&&c._OnBitmapChanged(["c2",_,1,c._ImgManager.getCurrentImageIndex(),c._ImgManager.count(),m],null,i.currentFileName),t.isFunction(s)&&s()):t.isFunction(l)&&l(),d):!1}var p=pi(),v={cmd:r,cmdId:p,sFun:function(e){t.isFunction(s)&&s(e)},fFun:l,currentFileName:i.currentFileName};c._innerSendByWS(r,n,v,i,!0),i=null}},{key:"_innerActiveUI",value:function(r,n){var i=this,o=t.detect.ssl,a=function(){var r=300,n=e.DWT.RemoteScanConfig;return n&&t.isNumber(n.sessionTimeout)&&n.sessionTimeout>0&&(r=n.sessionTimeout),r}();if(i._bRemoteMode||(a=5),i._blts){var s,u,c,l,d="";if(i._bRemoteMode)d=null!==(u=null===(c=i._dmService)||void 0===c||null===(l=c.attrs)||void 0===l?void 0:l.UUID)&&void 0!==u?u:"";s=e.DWT.li({instanceMode:e.DWT.EnumInstance.dwt_desktop},d),i._innerSend("ActiveUI",Zn(e.Lib.env.WSVersion,e.Lib.env.WSSession,1,s,o,1,a),!1,r,n),i=null}else i._innerSend("ActiveUI",Zn(e.Lib.env.WSVersion,e.Lib.env.WSSession,1,"",o,1,a),!1,r,n);return!0}},{key:"_getIfShowFileDialog",value:function(){return this._resetErr(),this._isValid()?this._isMobileMode()?this._mobileNotSupport("IfShowFileDialog"):this._innerFun("IfShowFileDialog"):Or}},{key:"_innerLoadImageFromBinary",value:function(r,n,i,o,a){var s,u=this,c=n;if(!t.License.checkProductKey(u,{Core:!0}))return t.isFunction(a)&&a(u._errorCode,u._getErrorString()),!1;if(!r||""==r)return t.Errors.ParameterCannotEmpty(u),t.isFunction(a)&&a(u._errorCode,u._getErrorString()),!1;var l=r.currentFileName;if(l||""==(l=u._innerGetCurrentDocumentName())&&u._ImgManager&&(l=u._ImgManager.getWebViewer().GetDefaultFileName()),r instanceof FileList){if(1==r.length)return r[0].currentFileName=l,u._innerLoadImageFromBinary(r[0],c,i,o,a);if(r.length>1){var d;for(t.asyncQueue.stop(),d=0;d<r.length;d++)r[d].currentFileName=l,t.asyncQueue.pushToDo(u,"_innerLoadImageFromBinary",[r[d],c,i,o,a]);return t.asyncQueue.start(),!0}return t.Errors.ParameterCannotEmpty(u),t.isFunction(a)&&a(u._errorCode,u._getErrorString()),!1}if(window.ReadableStream&&r instanceof ReadableStream?s=new Response(r):window.Response&&r instanceof Response&&(s=r),u._isTwainServiceType()||u._isDMServiceType())if(s)s.arrayBuffer().then((function(e){var t=new Blob([e]),r=0;i&&(r=u.__GetLoadEventsNum()),u.__LoadImageFromBytesV1(t,-1,"",r,!0,o,a)}));else{var h=r;(h instanceof ArrayBuffer||h instanceof Uint8Array)&&((h=new Blob([r])).currentFileName=r.currentFileName);var g=-1,f=e.DWT.EnumDWT_ImageType;t.isString(h.type)&&("application/pdf"==h.type?g=f.IT_PDF:"image/png"==h.type?g=f.IT_PNG:"image/jpeg"==h.type||"image/jpg"==h.type?g=f.IT_JPG:"image/bmp"==h.type?g=f.IT_BMP:"image/tiff"==h.type||"image/tif"==h.type?g=f.IT_TIF:"image/jp2"==h.type&&(g=f.IT_J2K));var m=0;i&&(m=u.__GetLoadEventsNum()),u.__LoadImageFromBytesV1(h,g,"",m,!0,o,a)}else s?s.arrayBuffer().then((function(e){u._innerSendToMobile("LoadImageFromBinary",Kn(e,c,null,l,!1,!1,i),0,(function(e){t.isFunction(a)&&o(0,e)}),a)})):u._innerSendToMobile("LoadImageFromBinary",Kn(r,c,null,l,!1,!1,i),0,(function(e){t.isFunction(a)&&o(0,e)}),a);return!0}},{key:"_innerSendToMobile",value:function(e,r,n,i,o){var a=this;return!!a._isMobileMode()||(t.Errors.ServiceNotSupport(a,e),o&&o(a._errorCode,a._getErrorString()),!1)}},{key:"_innerConvertToBase64ByMobile",value:function(e,r,n,i,o,a){var s=this;return!!s._isMobileMode()||(t.Errors.ServiceNotSupport(s,"ConvertToBase64ByMobile"),a&&a(s._errorCode,s._getErrorString()),!1)}},{key:"_innerSendToMobileV2",value:function(e,t){}}]),i}(Yc);function qc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(es){return!1}}();return function(){var r,n=et(e);if(t){var i=et(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return $e(this,r)}}function Qc(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function $c(e,t,r){if(!t.has(e));return r}function el(r,n,i,o){if(0==r._ImgManager.count())return t.Errors.NoImage(r),t.isFunction(o)&&o(n),!1;if(t.isNumber(n)){if(isNaN(n)||n<-2||n>=r._ImgManager.count())return t.Errors.IndexOutOfRange(r),t.isFunction(o)&&o(n),!1}else{if(!t.isArray(n))return t.Errors.IndexOutOfRange(r),t.isFunction(o)&&o(n),!1;var a;for(a=0;a<n.length;a++){var s=n[a];if(isNaN(s)||!t.isNumber(s)||s<0||s>=r._ImgManager.count())return t.Errors.IndicesOutOfRange(r),t.isFunction(o)&&o(n),!1}}if(i==e.DWT.EnumDWT_ImageType.IT_BMP||i==e.DWT.EnumDWT_ImageType.IT_JPG||i==e.DWT.EnumDWT_ImageType.IT_PNG||i==e.DWT.EnumDWT_ImageType.IT_J2K)(-1==n&&r._ImgManager.count()>1||t.isArray(n)&&n.length>1)&&(t.Errors.UploadIndexMoreThanOne(r),t.isFunction(o)&&o(n));else if(i!=e.DWT.EnumDWT_ImageType.IT_TIF&&i!=e.DWT.EnumDWT_ImageType.IT_PDF)return t.Errors.InvalidImageType(r),t.isFunction(o)&&o(n),!1;return!0}function tl(e){if(e._ImgManager.count()<=0)return[];var r=e._ImgManager.getSelectedClientIndexArray();if(t.isArray(r)){if(0==r.length){var n=e._ImgManager.getCurrentImageIndex();n>=0&&r.push(n)}return r}return[]}function rl(e){t.html5.ui.init(e,e._config),t.html5.ui.addMethods(e),e._ImgManager.OnReady(),t.isFunction(e.__OnReady)&&e.__OnReady(e)}var nl=new WeakSet,il=new WeakSet,ol=new WeakSet,al=new WeakSet,sl=new WeakSet,ul=new WeakSet,cl=new WeakSet,ll=new WeakSet,dl=new WeakSet,hl=new WeakSet,gl=function(r){Qe(f,r);var n,i,o,a,s,u,c,l,d,h,g=qc(f);function f(){var e;Le(this,f);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Qc(Ze(e=g.call.apply(g,[this].concat(r))),hl),Qc(Ze(e),dl),Qc(Ze(e),ll),Qc(Ze(e),cl),Qc(Ze(e),ul),Qc(Ze(e),sl),Qc(Ze(e),al),Qc(Ze(e),ol),Qc(Ze(e),il),Qc(Ze(e),nl),e}return Ae(f,[{key:"dispose",value:function(){return this.__unload()}},{key:"_convertToBlobByIndices",value:function(r,n,i,o,a){var s=this;if(s._resetErr(),!s._isValid())return!1;var u=parseInt(n),c=arguments,l=function(e,r){return t.isFunction(i)&&Tc(i,e,r,n,c),e=r=null,!0},d=function(e){return t.isFunction(o)&&Ec(o,s,e,n,c),e=null,!1},h=!1;if(!t.License.checkProductKey(s,{Core:!0}))return t.isFunction(o)&&o(s._errorCode,s._getErrorString()),!1;if(!s._checkIndices(r))return d(r);if(u==e.DWT.EnumDWT_ImageType.IT_BMP||u==e.DWT.EnumDWT_ImageType.IT_JPG||u==e.DWT.EnumDWT_ImageType.IT_PNG||u==e.DWT.EnumDWT_ImageType.IT_J2K){if(r.length>1)return t.Errors.ConvertBinaryIndexMoreThanOne(s),d(r)}else if(u!=e.DWT.EnumDWT_ImageType.IT_TIF&&u!=e.DWT.EnumDWT_ImageType.IT_PDF)return t.Errors.InvalidImageType(s),d(r);var g=[];return t.isArray(r)&&t.each(r,(function(e){var t=s._ImgManager.convertClientIndexToServerId(e);-1!=t&&g.push(t)})),t.isFunction(i)?($c(s,ul,Il).call(s,g,u,h,l,d),!0):$c(s,ul,Il).call(s,g,u,h)}},{key:"_getSourcesAsync",value:(h=Ke(it.mark((function m(e,t,r){var n,i;return it.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return n=this,o.next=3,n._innerFunV2("GetSources",Zn(e,null!=t&&t,null!=r&&r));case 3:return i=o.sent,o.abrupt("return",$c(this,al,yl).call(this,i));case 5:case"end":return o.stop()}}),m,this)}))),function(e,t,r){return h.apply(this,arguments)})},{key:"_checkIndices",value:function(r){var n,i,o=this;if(!t.isArray(r))return t.Errors.IndicesNotArray(o),!1;if(0==r.length)return t.Errors.IndicesCannotEmpty(o),!1;if(e.DWT.ConnectWithSocket)return!0;for(n=o._ImgManager.count(),i=0;i<r.length;i++){var a=r[i];if(t.isUndefined(a)||null===a)return t.Errors.IndexNullOrUndefined(o),!1;if(a=parseInt(a),isNaN(a))return t.Errors.InvalidIndex(o),!1;if(a<0||a>=n)return t.Errors.IndicesOutOfRange(o),!1}return!0}},{key:"_getDefaultDevice",value:function(){var t=this;if(t._resetErr(),!t._isValid())return null;var r="",n=te,i=t._innerFun("GetDefaultSourceName");if(i.length>0)try{var o=JSON.parse(i);n=o.type,r=e.Lib.base64.decode(o.ProductName)}catch(s){r=""}var a=new Qn;return a.name=r,a.deviceType=n,n==ne&&r.length>0?a.displayName="Twain64-"+r:n==ie&&t.__serverPlatform==w&&r.length>0?a.displayName="ICA-"+r:a.displayName=r,a}},{key:"_getDefaultDeviceAsync",value:(d=Ke(it.mark((function _(){var t,r,n,i,o,a;return it.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if((t=this)._resetErr(),t._isValid()){s.next=4;break}return s.abrupt("return",null);case 4:return r="",n=te,s.next=8,t._innerFunRawV2("GetDefaultSourceName");case 8:if((i=s.sent).length>0)try{o=JSON.parse(i),n=o.type,r=e.Lib.base64.decode(o.ProductName)}catch(u){r=""}return(a=new Qn).name=r,a.deviceType=n,n==ne&&r.length>0?a.displayName="Twain64-"+r:n==ie&&t.__serverPlatform==w&&r.length>0?a.displayName="ICA-"+r:a.displayName=r,s.abrupt("return",a);case 15:case"end":return s.stop()}}),_,this)}))),function(){return d.apply(this,arguments)})},{key:"_asyncSaveImage",value:function(r,n,i,o,a){var s=this,u=!0,c=t.isString(i)?i.toLowerCase():"",l=function(e,i,a){var l=r;if(t.isString(l)&&""!=l?(l=t.replaceAll(l,"\\\\","_"),l=t.replaceAll(l,":","_")):l="img"+t.getRandom()+"."+c,!u&&t.isString(e)){var d=["png"==i?"data:image/png;base64,":"jpg"==i?"data:image/jpeg;base64,":"tiff"==i||"tif"==i?"data:image/tif;base64,":"pdf"==i?"data:application/pdf;base64,":"bmp"==i?"data:image/bmp;base64,":"jp2"==i?"data:image/jp2;base64,":"data:application/octet-stream;base64,",e].join("");t.MobileFuns.saveLocal(d,l,c)}else t.MobileFuns.saveLocal(e,l,c);ti.refreshImageAfterInvokeFun(s,n),t.isFunction(o)&&setTimeout(o,30)},d=function(){t.isFunction(a)&&a(s._errorCode,s._getErrorString())},h=window,g=e.navInfoSync,f=h.requestFileSystem||h.webkitRequestFileSystem||h.mozRequestFileSystem;if((g.biPad||g.biPhone)&&!f&&(g.bSafari&&parseFloat(g.strBrowserVersion)<13||!g.bSafari)){u=!1;var m=-1;m="png"==c?e.DWT.EnumDWT_ImageType.IT_PNG:"jpg"==c?e.DWT.EnumDWT_ImageType.IT_JPG:"tiff"==c||"tif"==c?e.DWT.EnumDWT_ImageType.IT_TIF:"pdf"==c?e.DWT.EnumDWT_ImageType.IT_PDF:"bmp"==c?e.DWT.EnumDWT_ImageType.IT_BMP:"jp2"==c?e.DWT.EnumDWT_ImageType.IT_J2K:e.DWT.EnumDWT_ImageType.IT_PNG;var _=[];return t.isArray(n)&&t.each(n,(function(e){var t=s._ImgManager.convertClientIndexToServerId(e);-1!=t&&_.push(t)})),s._innerConvertToBase64ByMobile(r,_,m,1,(function(e){var r=e&&e.result;if(t.isArray(r)&&3==r.length)return l(r[0],r[1],r[2])}),d)}return s._innerSendToMobile("SaveImage",Kn(r,n,c,1,u),0,l,d)}},{key:"_getSources",value:function(e,t,r){var n=this._innerFun("GetSources",Zn(e,null!=t&&t,null!=r&&r));return $c(this,al,yl).call(this,n)}},{key:"_getSourceCountAsync",value:(l=Ke(it.mark((function p(r){var n,i,o,a,s,u;return it.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if((n=this)._resetErr(),n._isValid()){c.next=4;break}return c.abrupt("return",t.Promise.reject({code:n._errorCode,message:n._errorString}));case 4:if(!n._isMobileMode()){c.next=6;break}return c.abrupt("return",t.Promise.resolve(0));case 6:return $c(n,hl,Tl).call(n),ni("GetSourceCountAsync",n),i=[],c.prev=9,r&&(n._driverType=r),o=Or,a=Or,s=Or,n._bRemoteMode?n.__serverPlatform==I?s=!0:n.__serverPlatform==S?a=!0:n.__serverPlatform==w&&(o=!0):(o=e.navInfoSync.bMac,a=e.navInfoSync.bLinux,s=e.navInfoSync.bWin),u=oi(n._driverType,s,a,o),c.next=17,this._getSourcesAsync(u,!0,void 0);case 17:i=c.sent,c.next=23;break;case 20:throw c.prev=20,c.t0=c["catch"](9),c.t0;case 23:return c.prev=23,ii("GetSourceCountAsync"),c.finish(23);case 26:return c.abrupt("return",n._setDevices(i));case 27:case"end":return c.stop()}}),p,this,[[9,20,23,26]])}))),function(e){return l.apply(this,arguments)})},{key:"_setDevices",value:function(e){var t,r=this;return r.__devices=e,t=e.length,r.__sourceCount=t,t<=0?(r.__defaultSourceName="",r.__sourceCount=0,0):t}},{key:"_getSourceNameByIndex",value:function(e){var t=this.__devices.length;return e<0||e>=t?"":this.__devices[e].displayName}},{key:"_selectSourceExAsync",value:(c=Ke(it.mark((function v(e,t){var r,n;return it.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return r=this,n=["[",e,",",null!=t?t:fe,"]"].join(""),i.next=3,r._innerFunV2("SelectSourceEx",n);case 3:return i.abrupt("return",i.sent);case 4:case"end":return i.stop()}}),v,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"__innerConvertToBlob",value:function(r,n,i,o,a,s,u,c){var l=this;if(l._isMobileMode())return $c(l,sl,bl).call(l,r,n,i,a,s,u,c);var d=i,h=",";t.isString(d)&&""!=d||(d="",h="");var g=["[",r,',"',n.join(","),'"',h,d,"]"].join("");if(o)return l._innerFunRaw("ConvertToBlob",g,!0,true,!0,(function(n){var i=ti.getBlobTypeByImageType(r),o=new Blob([n],{type:i});if(e.DWT.IfAddMD5InUploadHeader){var a=new Lc.ArrayBuffer;a.append(n),t.isFunction(s)&&s(o,a.end(),c)}else t.isFunction(s)&&s(o,"",c);o=null}),u);var f=l._innerFunRaw("ConvertToBlob",g,!1,true,!1),m="";return 0==l._errorCode?(f&&"md5"in f&&(m=f.md5),s(f,m,c)):(u(),!1)}},{key:"_acquireImageFromService",value:function(r,n,i){var o,a=this,s="AcquireImage";if(!t.License.checkProductKey(a,{Core:!0}))return t.isFunction(i)&&i(a._errorCode,a._getErrorString()),!1;if(a._isMobileMode())return a._mobileNotSupport(s,i);r.RemoteScan=a._bRemoteMode?1:0,t.isUndefined(r.ShowRemoteScanUI)?r.ShowRemoteScanUI=r.RemoteScan?1:0:r.ShowRemoteScanUI=r.RemoteScan&&r.ShowRemoteScanUI?1:0,a._bRemoteMode&&(t.isFunction(a.__OnRemoteScanStatusAsync)||(a.__OnRemoteScanStatusAsync=function(){}),t.isFunction(a.__OnSourceUIClose)||(a.__OnSourceUIClose=function(){}));for(var u=0,c=0;c<ai.length;c++){var l=["__",ai[c]].join("");t.isFunction(a[l])&&(u|=1<<c)}if(r.EnableEvents=u,a._enableEvents=u,r.RemoteScan&&(a._isBindViewer()||r.ShowRemoteScanUI)&&a._initRemoteDiv(),a._bRemoteMode||(a._bPageFocus&&e.DWT.IfAlwaysFocusOnPopupWindow?a._bServerAlwaysFocusOnPopupWindow||a._OnPageFocus(!0):a._bServerAlwaysFocusOnPopupWindow&&a._OnPageBlur(!0)),"SelectSourceByIndex"in r){var d=r.SelectSourceByIndex;return delete r.SelectSourceByIndex,a._selectSourceByIndexAsync(s,d).then((function(){var e=["[",t.stringify(r),"]"].join("");return a.__innerAcquireImage(s,e,!1,!1,n,i)}),(function(e){i(e.code,e.message)}))}return o=["[",t.stringify(r),"]"].join(""),a.__innerAcquireImage(s,o,!1,!1,n,i)}},{key:"_getSourceCountSync",value:function(){var r=this;if(r._isMobileMode())return r._mobileNotSupport("SourceCount");var n,i=Or,o=Or,a=Or;if(r._bRemoteMode?r.__serverPlatform==I?a=!0:r.__serverPlatform==S?o=!0:r.__serverPlatform==w&&(i=!0):(i=e.navInfoSync.bMac,o=e.navInfoSync.bLinux,a=e.navInfoSync.bWin),n=oi(this._driverType,a,o,i),r._resetErr(),!r._isValid())return 0;if(!t.License.checkProductKey(r,{Core:!0}))return 0;$c(r,hl,Tl).call(r);var s=r._getSources(n,true,undefined);return r._setDevices(s)}},{key:"_OnReady",value:function(){var r,n=this,i=n._getWebTwainId();if(t.detect.starting=!1,n._bRemoteMode||!n._isTwainServiceType()&&!n._isWasmWithScan()||(t.detect.bOK=!0),n._bReady=!0,n._bInited=!0,n.__wsRetry=0,e.DWT.ContainerMap[i]){var o=e.DWT.ContainerMap[i];if(!o._destroy)return void(n!=o&&(t.isFunction(n.__OnReady)&&n.__OnReady(o),n.__unload()));e.DWT.ContainerMap[i]=null}if(n._isTwainServiceType()||n._isDMServiceType()){var a=n._wsClient.ws;if(null===a)return;a.onopen=null,n._wsClient.addEvent("close",n._clientId,(function(e){var r;n._bReady=!1,n.__bAcquireImageNow=!1,n.__wsRetry=0,t.Errors.Server_Invalid(n),t.detect.bOK=!1,n.__closeRemoteScanUI(!0),n._dm&&(n._dm.bLicenseOK=!1),n._dmSync&&(n._dmSync.bLicenseOK=!1),e&&t.log("websocket close: "+e),n.__OnWSClose&&n.__OnWSClose(),n._bNoMask||(r="websocket close",t.log("hideMask:"+r+"--"+ri),t.detect.hideMask(),ri=0),n._heartBeatTimer&&(clearTimeout(n._heartBeatTimer),n._heartBeatTimer=null),Vl(n)})),n._wsClient.addEvent("error",n._clientId,(function(e){e&&t.log("websocket error: "+e),n.__OnWSError&&n.__OnWSError()})),n._wsClient.addEvent("timeout",n._clientId,(function(e){n._bReady=!1,n.__wsRetry=0,t.Errors.Server_Invalid(n),t.detect.bOK=!1,n.__closeRemoteScanUI(!0),e&&t.log("websocket timeout: "+e),n._heartBeatTimer&&(clearTimeout(n._heartBeatTimer),n._heartBeatTimer=null),Vl(n)})),t.isLocalIP(n._serverInfo.server)&&(t.LS.item("DWT_port",n._serverInfo.port),t.LS.item("DWT_ssl",n._serverInfo.ssl?"true":"false"))}(t.attachProperty(n),t.attachPropertyUI(n),n._bNoMask||ni("OnReady",n),n._isTwainServiceType()||n._isDMServiceType())?n._innerActiveUI((function(r){var i,o,a,s=!1;if(r&&r.length>=6){i=r[1],o=r[2],a=r[5];var u=!1,c=!1,l=0;r.length>12?(r[6],n._b64bit="64"==r[7],r[8],u=r[9],c=r[10],l=r[11],r[12]):r.length>8&&(u=r[6],c=r[7],l=r[8]),u?c&&l&&(n._bRemoteMode=!0):n._bRemoteMode=!0,n.__strProductName=o,t.isString(a)&&("win"==a?n.__serverPlatform=I:"linux"==a?n.__serverPlatform=S:"mac"==a?n.__serverPlatform=w:"embed"==a?n.__serverPlatform=T:"chromeos"==a&&(n.__serverPlatform=C))}else r&&r.length>=3?(i=r[1],o=r[2],n.__strProductName=o):r&&r.length>=2?(i=r[1],s=!0):(s=!0,t.log("ActiveUI return parameters error."));if(t.attachAddon(n),o&&(o=o.toLowerCase()),n.__serverId=i,n.__bMustUpgradeService=s,s)rl(n),n._bNoMask||ii("OnReady");else{var d;if(n._blts){var h,g,f,m;if(n._bRemoteMode)h=null!==(g=null===(f=n._dmService)||void 0===f||null===(m=f.attrs)||void 0===m?void 0:m.UUID)&&void 0!==g?g:"";else h="";d=zi(e.DWT.EnumInstance.dwt_desktop,h).then((function(e){return n._setLTSLicenseAsync(e.ar)})).then((function(t){e.DWT.laddDWTObj(n);var r,i,o,a="";n._bRemoteMode&&(a=null!==(r=null===(i=n._dmService)||void 0===i||null===(o=i.attrs)||void 0===o?void 0:o.UUID)&&void 0!==r?r:"");e.DWT.lcheckLic(e.DWT.EnumInstance.dwt_desktop,t,a)}))}else{var _=t.product.refProductKey;d=n._setProductKeyAsync(_)}d=d.then((function(r){n._bNoMask||ii("OnReady");var i=n._blts;if(!(i&&0==e.DWT.licenseException.code||!i&&r))return!i&&n._errorCode<0&&t.License.showLicenseErrorDialog(bt(n)),t.isFunction(n.__OnCreateError)&&n.__OnCreateError(n),void n.__unload();if(!(t.License.checkProductKey(n,{Core:!0})||e.navInfoSync.bWin&&t.License.checkProductKey(n,{Webcam:!0},!0))){var o=!0;return n._bNotShowMessage&&(o=!1),t.License.checkProductKey(n,{Core:!0},!1,o),t.isFunction(n.__OnCreateError)&&n.__OnCreateError(n),void n.__unload()}n._setConvertModeAsync(n._pdfConvertMode)["catch"]((function(){})),e.DWT.lclex(),rl(n)}),(function(e){n._bNoMask||ii("OnReady");var r=!0;n._bNotShowMessage&&(r=!1),Fl(n,n._isMobileMode(),e,r),t.isFunction(n.__OnCreateError)&&n.__OnCreateError(n),n.__unload(),t.detect.arySTwains.splice(0)}))}n._bRemoteMode&&n._wsClient.startHeartBeat()}),(function(){n._bNoMask||ii("OnReady"),t.isFunction(n.__OnCreateError)&&n.__OnCreateError(n),n.__unload()})):(t.attachAddon(n),n.__serverId="1",n.__bMustUpgradeService=!1,n._blts?r=oa(!1).then((function(){return zi(e.DWT.EnumInstance.dwt_browser,"")})).then((function(e){return Vn(e),n._setLTSLicenseAsync(e.ar)})).then((function(t){e.DWT.laddDWTObj(n),e.DWT.lcheckLic(e.DWT.EnumInstance.dwt_browser,t,"")})):(Nn(),r=n._setProductKeyAsync(t.product.refProductKey)),r.then((function(r){n._bNoMask||ii("OnReady");var i=n._blts;return i&&0==e.DWT.licenseException.code||!i&&r?t.License.checkProductKey(n,{Core:!0},!0)||e.navInfoSync.bWin&&t.License.checkProductKey(n,{Webcam:!0},!0)?(e.WasmEnv&&e.WasmEnv.setLoglevel(n._logLevel),n._setConvertMode(n._pdfConvertMode),e.DWT.lclex(),void rl(n)):(t.License.checkProductKey(n,{Core:!0},!0,!0),t.isFunction(n.__OnCreateError)&&n.__OnCreateError(n),void n.__unload()):(t.isFunction(n.__OnCreateError)&&n.__OnCreateError(n),void n.__unload())}),(function(e){var r=!0;n._bNotShowMessage&&(r=!1),Fl(n,n._isMobileMode(),e,r),n._bNoMask||ii("OnReady"),t.isFunction(n.__OnCreateError)&&n.__OnCreateError(n),t.detect.arySTwains.splice(0),n.__unload()})))}},{key:"_setConvertModeAsync",value:function(e){var r=this;if(!r._setConvertModeInner(e))return t.Promise.reject({code:r._errorCode,message:r._errorString});if(!r._isMobileMode()){var n=r._getPdfDllname();return r._innerFunV2("SetPDFConvertMode",Zn(r._pdfRealConvertMode,n)).then((function(){if(2==r._pdfRealConvertMode&&1==r._pdfConvertMode||2==r._pdfRealConvertMode&&4==r._pdfConvertMode)throw t.Errors.LicenseNoPDF(r),{code:r._errorCode,message:r._errorString};return!0}))}return 2==r._pdfRealConvertMode&&1==r._pdfConvertMode||2==r._pdfRealConvertMode&&4==r._pdfConvertMode?(t.Errors.LicenseNoPDF(r),t.Promise.reject({code:r._errorCode,message:r._errorString})):t.Promise.resolve(!0)}},{key:"_setLTSLicenseAsync",value:function(r){var n=this;return n._resetErr(),n._isValid()?t.isString(r)?(n._isMobileMode()?n._innerSendToMobileV2("GetLicenseInfo",Kn(r)):n._setLTSLic(r)).then((function(r){var i=r;if(!i||i.message)throw t.Errors.LicenseEmptyOrInvalid(n),i&&i.message&&(n._errorString=i.message),{code:n._errorCode,message:n._errorString};if(oc(n,i),t.detect.wasmScriptLoaded&&!t.detect.wasmPdfReaderLoaded)try{e.WasmEnv.loadPdfReader(),t.detect.wasmPdfReaderLoaded=!0}catch(o){o&&t.error(o.message)}return n.__licenseInfo&&(n.__licenseInfo.LTS=!0),i})):(t.Errors.LicenseEmptyOrInvalid(n),t.Promise.reject({code:n._errorCode,message:n._errorString})):t.Promise.reject({code:n._errorCode,message:n._errorString})}},{key:"_setLTSLic",value:function(e){var r=this,n=e;return r._resetErr(),!!r._isValid()&&(t.isString(n)?r._innerFunRawV2("LTSLicense",Zn(n)).then((function(e){if(e){if(e.exception!==undefined&&e.description!==undefined)throw r._errorCode=e.exception,r._errorString=e.description,{code:r._errorCode,message:r._errorString};return r._innerFunRawV2("GetLicenseInfo")}throw t.Errors.LicenseEmptyOrInvalid(r),{code:r._errorCode,message:r._errorString}})):(t.Errors.LicenseEmptyOrInvalid(r),t.Promise.reject({code:r._errorCode,message:r._errorString})))}},{key:"_setConvertMode",value:function(e){var r=this;if(!r._setConvertModeInner(e))return!1;if(!r._isMobileMode()){var n=r._getPdfDllname();r._innerFun("SetPDFConvertMode",Zn(r._pdfRealConvertMode,n))}return!(2==r._pdfRealConvertMode&&1==r._pdfConvertMode||2==r._pdfRealConvertMode&&4==r._pdfConvertMode)||(t.Errors.LicenseNoPDF(r),!1)}},{key:"_setConvertModeInner",value:function(e){var r=this;if(!t.License.checkProductKey(r,{Core:!0}))return!1;var n=1*e;return r._resetErr(),!!r._isValid()&&(isNaN(n)?(t.Errors.ParameterCannotEmpty(r),!1):1!=n&&2!=n&&3!=n&&4!=n?(t.Errors.InvalidValue(r),!1):(r._pdfConvertMode=n,2==n||t.License.hasPDFRProductKey(r)?r._pdfRealConvertMode=n:r._pdfRealConvertMode=2,!0))}},{key:"_getPdfDllname",value:function(){var t=this,r=!1,n=!1;return t._bRemoteMode?t.__serverPlatform==I||(t.__serverPlatform==S?n=!0:t.__serverPlatform==w&&(r=!0)):(r=e.navInfoSync.bMac,n=e.navInfoSync.bLinux,e.navInfoSync.bWin),r?t._b64bit?"libDynamicPdfCorex64_"+e.DWT.PdfVersion+".dylib":"libDynamicPdfCore_"+e.DWT.PdfVersion+".dylib":n?"libDynamicPdfCore_"+e.DWT.PdfVersion+".so":t._b64bit?"DynamicPdfCorex64_"+e.DWT.PdfVersion+".dll":"DynamicPdfCore_"+e.DWT.PdfVersion+".dll"}},{key:"_setProductKeyAsync",value:function(r){var n=this,i=r;return n._resetErr(),n._isValid()?t.isString(i)?t.License.isLicenseMixed(i)?t.Promise.reject(e.DWT.licenseException):t.License.isLongKey(i)?(n._isMobileMode()?n._innerSendToMobileV2("GetLicenseInfo",Kn(i)):$c(n,cl,wl).call(n,i)).then((function(r){var i=r;if(!i||i.message)throw t.Errors.LicenseEmptyOrInvalid(n),i&&i.message&&(n._errorString=i.message),{code:n._errorCode,message:n._errorString};if(oc(n,i),t.detect.wasmScriptLoaded&&!t.detect.wasmPdfReaderLoaded)try{e.WasmEnv.loadPdfReader(),t.detect.wasmPdfReaderLoaded=!0}catch(o){o&&t.error(o.message)}return i})):(t.Errors.LicenseEmptyOrInvalid(n),t.Promise.reject({code:n._errorCode,message:n._errorString})):(t.Errors.LicenseEmptyOrInvalid(n),t.Promise.reject({code:n._errorCode,message:n._errorString})):t.Promise.reject({code:n._errorCode,message:n._errorString})}},{key:"_innerBindViewer",value:function(r){var n,i=this,o=r;return e.DWT.UseDefaultViewer?(t.isString(r)&&(o=t.get(r),t.show(o)),i._config.container!=o&&(i._config.container=o,i._config.ifBindViewer=!0,t.html5.ui.init(i,i._config)),n=i._ImgManager.BindView(r),i._bBindViewer=!0,i._config.ifBindViewer=!1,n):(t.Errors.CannotBindViewerWhenNoViewerJS(i),!1)}},{key:"_innerUnbindViewer",value:function(){var e=this;return e.__funResize&&(t.removeEventListener(window,"resize",e.__funResize),e.__funResize=Or),e._bBindViewer=!1,e._config.container=null,e._ImgManager?e._ImgManager.UnbindView():Or}},{key:"_reconnect",value:(u=Ke(it.mark((function y(){var r,n,i,o,a,s,u,c,l,d,h,g;return it.wrap((function(f){for(;;)switch(f.prev=f.next){case 0:if(!(r=this)._destroy){f.next=3;break}return f.abrupt("return");case 3:return f.prev=3,(n=wr.Instance.getClient(r._serverInfo)).setRetry(0),f.next=9,n.testConnection(void 0,0,void 0,3e4);case 9:return r._wsClient=n,r.__wsRetry=0,f.next=13,new t.Promise((function(e,i){r._innerActiveUI((function(i){var o=!1;i&&(i.length>12?(r.__serverId=i[1],o=i[12]):i.length>8?(r.__serverId=i[1],o=i[8]):i.length>=2&&(r.__serverId=i[1])),o&&(t.Errors.DynamsoftServiceRestarted(r),r._removeAllImages("ActiveUI")),r._bRemoteMode&&n.startHeartBeat(),e()}),(function(e){i(e)}))}));case 13:if(r._bReady=!0,r._bRemoteMode||(t.detect.bOK=!0),t.detect.starting=!1,!r._blts){f.next=25;break}return i=r._bRemoteMode&&null!==(o=null===(a=r._dmService)||void 0===a||null===(s=a.attrs)||void 0===s?void 0:s.UUID)&&void 0!==o?o:"",f.next=20,zi(e.DWT.EnumInstance.dwt_desktop,i);case 20:return u=f.sent,f.next=23,r._setLTSLicenseAsync(u.ar);case 23:f.next=28;break;case 25:return c=t.product.refProductKey,f.next=28,r._setProductKeyAsync(c);case 28:f.next=35;break;case 30:throw f.prev=30,f.t0=f["catch"](3),f.t0&&f.t0.message&&t.error(f.t0.message),r._bRemoteMode&&r._isTwainServiceType()&&(h=null===(l=r._dmService)||void 0===l||null===(d=l.attrs)||void 0===d?void 0:d.name,g=t.Errors.ThrowFailedConnectToRemoteDynamsoftService(h),r._errorCode=g.code,r._errorString=g.message),{code:r._errorCode,message:r._errorString};case 35:case"end":return f.stop()}}),y,this,[[3,30]])}))),function(){return u.apply(this,arguments)})},{key:"__unload",value:(s=Ke(it.mark((function b(){var r,n,i;return it.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(r=this,n=t.clone(e.DWT.licenseException),r.__closeRemoteScanUI(!0),!r._destroy&&!r._destroying){o.next=5;break}return o.abrupt("return");case 5:if(r._destroying=!0,delete e.DWT.ContainerMap[r._id],r._ImgManager&&r._ImgManager.clear(),!r._bInited||!r._bReady||t.page.bUnload){o.next=33;break}if(!r._dm){o.next=17;break}return o.prev=10,o.next=13,r._dm.dispose();case 13:o.next=17;break;case 15:o.prev=15,o.t0=o["catch"](10);case 17:if(!r._dmSync){o.next=25;break}return o.prev=18,o.next=21,r._dmSync.disposeAsync();case 21:o.next=25;break;case 23:o.prev=23,o.t1=o["catch"](18);case 25:if(!r._wsClient){o.next=33;break}return o.prev=26,o.next=29,$c(r,ll,Sl).call(r);case 29:o.next=33;break;case 31:o.prev=31,o.t2=o["catch"](26);case 33:r._wsClient&&(r._wsClient.removeEvent("close",r._clientId),r._wsClient.removeEvent("error",r._clientId),r._wsClient.removeEvent("timeout",r._clientId),r._wsClient.dispose(),delete r._wsClient,r._wsClient=null),r._bReady=!1,r.__addon&&r.__addon.Camera&&r.__addon.Camera._viewer&&(""!=r.__addon.Camera.getStatus()&&r.__addon.Camera.closeSource()["catch"]((function(){})),r.__addon.Camera._viewer.dispose(),r.__addon.Camera._viewer=null),r._isBindViewer()&&(r._innerUnbindViewer(),t.html5.ui.unLoad(r)),r._ImgManager&&(r._ImgManager.dispose(),r._ImgManager=null,r._viewer=null),r._objImageIndexManager&&(r._objImageIndexManager=null),r._containerElement=null,e.DWT.lremoveDWTObj(r),r.__bAcquireImageNow=!1,r._destroying=!1,r._destroy=!0,(i=e.DWT.licenseException).code=n.code,i.message=n.message,i.fromLTS=n.fromLTS;case 48:case"end":return o.stop()}}),b,this,[[10,15],[18,23],[26,31]])}))),function(){return s.apply(this,arguments)})},{key:"_setIfShowUI",value:function(e){this._resetErr(),this._isValid()&&(this._isMobileMode()?this._mobileNotSupport("IfShowUI"):t.isBoolean(e)?this._innerFun("IfShowUI",Zn(e)):t.Errors.InvalidValue(self))}},{key:"_setIfShowFileDialog",value:function(e){this._resetErr(),this._isValid()&&(this._isMobileMode()?this._mobileNotSupport("IfShowFileDialog"):t.isBoolean(e)?this._innerFun("IfShowFileDialog",Zn(e)):t.Errors.InvalidValue(self))}},{key:"_getDevicesAsync",value:(a=Ke(it.mark((function E(r,n,i,o){var a,s,u,c,l,d,h,g,f,m;return it.wrap((function(_){for(;;)switch(_.prev=_.next){case 0:if(s=[],u=(a=this)._bRemoteMode?ue:e.navInfoSync.bAndroid?le:ue,c=null!=n?n:u,a._resetErr(),a._isValid()){_.next=5;break}return _.abrupt("return",t.Promise.reject({code:a._errorCode,message:a._errorString}));case 5:if(!a._isWasmWithScan()){_.next=9;break}e.navInfoSync.bAndroid&&!a._bRemoteMode&&(c&=~ue),_.next=11;break;case 9:if(!a._isMobileMode()){_.next=11;break}return _.abrupt("return",a._mobileNotSupportAsync(r));case 11:if(ni(r,a),_.prev=12,a._dm&&(a._dm.bLicenseOK=!1),l=(c&ae)==ae,d=(c&se)==se,!((c&ue)>0)){_.next=20;break}return _.next=18,a._getSourcesAsync(c,i,o);case 18:h=_.sent,t.isArray(h)&&h.length>0&&(s=s.concat(h));case 20:if(!l&&!d){_.next=31;break}if(!e.DWT.ConnectWithSocket){_.next=24;break}_.next=31;break;case 24:return _.next=26,$c(a,ol,pl).call(a,!1);case 26:return g=_.sent,_.next=29,g.getSources(c,i);case 29:f=_.sent,t.isArray(f)&&f.length>0&&(s=s.concat(f));case 31:_.next=36;break;case 33:throw _.prev=33,_.t0=_["catch"](12),_.t0;case 36:return _.prev=36,ii(r),_.finish(36);case 39:if(s.length>0){for(m=0;m<s.length;m++)t.addDeviceAcquireMethod(s[m],!1);this._setDevices(s)}return _.abrupt("return",s);case 41:case"end":return _.stop()}}),E,this,[[12,33,36,39]])}))),function(e,t,r,n){return a.apply(this,arguments)})},{key:"_selectDeviceAsync",value:(o=Ke(it.mark((function M(r,n,i){var o,a,s,u,c,l,d,h,g;return it.wrap((function(f){for(;;)switch(f.prev=f.next){case 0:if(a=this,s=n?n.deviceType:0,a._resetErr(),a._isValid()){f.next=4;break}return f.abrupt("return",t.Promise.reject({code:a._errorCode,message:a._errorString}));case 4:if(n&&n instanceof Qn){f.next=7;break}throw t.Errors.InvalidParameterInCallback(a),{code:a._errorCode,message:a._errorString};case 7:if(!a._isWasmWithScan()){f.next=13;break}return this._curDevice=n,this._bSelectedSourceByServer=!1,f.abrupt("return",!0);case 13:if(!a._isMobileMode()){f.next=15;break}return f.abrupt("return",a._mobileNotSupportAsync(r));case 15:if(!(u=null===(o=this._dmService.attrs)||void 0===o?void 0:o.UUID)){f.next=26;break}if((null===(c=n.serviceInfo.attrs)||void 0===c?void 0:c.UUID)!=u){f.next=20;break}f.next=26;break;case 20:if(!((d=(null===(l=n.serviceInfo.attrs)||void 0===l?void 0:l.url)||n.serviceInfo.server)&&d.indexOf(u)>-1)){f.next=24;break}f.next=26;break;case 24:throw t.Errors.DeviceNotFound(a),{code:a._errorCode,message:a._errorString};case 26:if(h=!1,ni(r,a),f.prev=28,!gi(s)){f.next=33;break}return f.next=32,this._selectSourceExAsync(n.strDevice,i);case 32:h=f.sent;case 33:if(!fi(s)){f.next=46;break}if(a._dm&&(a._dm.bLicenseOK=!1),!e.DWT.ConnectWithSocket){f.next=38;break}f.next=44;break;case 38:return f.next=40,$c(this,ol,pl).call(this,!1);case 40:return g=f.sent,f.next=43,g.selectSourceAsync(n);case 43:h=f.sent;case 44:f.next=46;break;case 46:h&&(this._curDevice=n,this._bSelectedSourceByServer=!1),f.next=52;break;case 49:throw f.prev=49,f.t0=f["catch"](28),f.t0;case 52:return f.prev=52,ii(r),f.finish(52);case 55:return f.abrupt("return",h);case 56:case"end":return f.stop()}}),M,this,[[28,49,52,55]])}))),function(e,t,r){return o.apply(this,arguments)})},{key:"_acquireImageAsync",value:(i=Ke(it.mark((function D(r,n,i){var o,a,s,u,c,l,d,h,g,f,m,_,p,v,y,b,I,w,S,T;return it.wrap((function(C){for(;;)switch(C.prev=C.next){case 0:if(o=this,a=n?t.clone(n):{},u=s=i,o._resetErr(),o._isValid()){C.next=4;break}throw{code:o._errorCode,message:o._errorString};case 4:if(s){C.next=6;break}throw t.Errors.ThrowInvalidParameterSendTo();case 6:if(t.isString(s._id)){C.next=8;break}throw t.Errors.ThrowInvalidParameterSendTo();case 8:if(!o._isWasmWithScan()){C.next=19;break}if(o._curDevice){C.next=14;break}if(o.__devices&&0!=o.__devices.length){C.next=13;break}return C.next=13,o._getDevicesAsync(r,null);case 13:o.__devices&&o.__devices.length>0&&(o._curDevice=o.__devices[0]);case 14:if(o._curDevice){C.next=17;break}throw t.Errors.DeviceNotFound(o),{code:o._errorCode,message:o._getErrorString()};case 17:C.next=21;break;case 19:if(!o._isMobileMode()){C.next=21;break}return C.abrupt("return",o._mobileNotSupportAsync(r));case 21:if(s==o&&(s=null),s||(u=o),!o.__bAcquireImageNow){C.next=26;break}throw t.Errors.SystemBusy(o),{code:o._errorCode,message:o._getErrorString()};case 26:if(o.__bAcquireImageNow=!0,ni(r,u),l=t.cancelFrom,d=o.__IfShowProgressBar,t.cancelFrom=Me,o.__IfShowProgressBar=!1,g=!0,f=t.Promise.resolve(),m=e.DWT.RemoteScanConfig,_=kn(),C.prev=33,Ll(a),m&&xn(m.keepAwake),o._dm&&(o._dm.bLicenseOK=!1),!t.isNumber(a.SelectSourceByIndex)){C.next=44;break}if(null!=o.__devices){C.next=41;break}return C.next=41,o._getDevicesAsync(r,null);case 41:if(!(o.__devices&&o.__devices.length>0)){C.next=44;break}return C.next=44,o._selectSourceByIndexAsync(r,a.SelectSourceByIndex);case 44:if(c=o._curDevice?o._curDevice.deviceType:te,t.License.checkProductKey(o,{Core:!0})&&o._isValid()){C.next=47;break}throw{code:o._errorCode,message:o._errorString};case 47:if(o._isTwainServiceType()&&o._innerSend("Heartbeat"),s&&(s._isTwainServiceType()&&s._innerSend("Heartbeat"),p=function(){var n=Ke(it.mark((function i(n){return it.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:f=f.then((function(){return new t.Promise((function(i,a){o._convertToBlobByIndices([o._imageIDToIndex(n.imageId)],e.DWT.EnumDWT_ImageType.IT_PNG,(function(e,u,c){s&&(s._blts_tmp=s._blts,s._blts=!1,s._innerLoadImageFromBinary(e,0,!1,(function(e,a){t.log("LoadImageFromBinary success"),s._blts=s._blts_tmp;var u=o._imageIDToIndex(n.imageId);n.imageId=parseInt(a.ids),t.isFunction(s._OnPostTransferAsync)&&s._OnPostTransferAsync([!0,t.stringify(n)]),i(),o._removeImage(r,u)}),(function(e,r){t.log(r),s._blts=s._blts_tmp,a({code:e,message:r})})))}),(function(e,r){t.log(r),a({code:e,message:r})}))}))}));case 1:case"end":return i.stop()}}),i)})));return function(e){return n.apply(this,arguments)}}(),h=o._innerRegisterEvent("OnPostTransferAsync",p)),!gi(c)){C.next=54;break}return C.next=52,$c(o,il,_l).call(o,a);case 52:C.next=73;break;case 54:if(!fi(c)){C.next=73;break}if(!e.DWT.ConnectWithSocket){C.next=58;break}C.next=73;break;case 58:return C.next=60,$c(o,ol,pl).call(o,!0);case 60:return v=C.sent,C.next=63,v.acquireImage(o._curDevice,a,o._bRemoteMode);case 63:y=C.sent,t.isFunction(o._OnPreAllTransfers)&&o._OnPreAllTransfers([]),I={_ver:[e.Lib.product.getDWTPrefix(),e.Lib.product.getServerVersionInfo()].join(""),_clientId:o._clientId},s&&(I._clientId=s._clientId),w=0,S=xu(c),T=it.mark((function E(){var r,n;return it.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,v.getImageToDWT(y,S,I);case 3:b=i.sent,i.next=13;break;case 6:if(i.prev=6,i.t0=i["catch"](0),0!=w){i.next=12;break}throw r={},t.Errors.SourceHasNothingToCapture(r),{code:r._errorCode,meesage:r._errorString};case 12:throw i.t0;case 13:b&&("number"==typeof b||(n=o,s&&(n=s),f=f.then((function(){return new t.Promise((function(r,i){var o=yi;e.navInfoSync.bAndroid&&(o=0),n._innerLoadImageFromBinary(b,o,!1,(function(e,i){var o,s;t.log("LoadImageFromBinary success"),o=t.isArray(i.metaData)&&i.metaData.length>0?i.metaData[0]:{id:i.ids},s={imageId:parseInt(o.id)},!1!==a.IfGetImageInfo&&(s.imageInfo={XResolution:o.resolutionX,YResolution:o.resolutionY,ImageWidth:o.width,ImageLength:o.height,BitsPerPixel:o.bitDepth}),t.isFunction(n._OnPostTransferAsync)&&n._OnPostTransferAsync([!0,t.stringify(s)]),r()}),(function(e,r){t.log(r),i({code:e,message:r})}))}))})))),w++;case 15:case"end":return i.stop()}}),E,null,[[0,6]])}));case 70:return C.delegateYield(T(),"t0",71);case 71:if(b){C.next=70;break}case 72:t.isFunction(o._OnPostAllTransfers)&&o._OnPostAllTransfers([]);case 73:C.next=79;break;case 75:throw C.prev=75,C.t1=C["catch"](33),g=!1,C.t1;case 79:return C.prev=79,o.__bAcquireImageNow=!1,C.prev=81,C.next=84,f;case 84:C.next=88;break;case 86:C.prev=86,C.t2=C["catch"](81);case 88:return t.cancelFrom=l,o.__IfShowProgressBar=d,t.isString(h)&&o._unregisterEvent("OnPostTransferAsync",h),ii(r),xn(_),C.finish(79);case 94:return C.abrupt("return",g);case 95:case"end":return C.stop()}}),D,this,[[33,75,79,94],[81,86]])}))),function(e,t,r){return i.apply(this,arguments)})},{key:"_openSourceAsync",value:function(e){var r=this;return r._resetErr(),r._isValid()?r._isMobileMode()?r._mobileNotSupportAsync(e):(r._bRemoteMode&&r._initRemoteDiv(),r._innerFunV2("OpenSource").then((function(e){return r.__closeRemoteScanUI(!0),e}),(function(e){return r.__closeRemoteScanUI(!0),t.Promise.reject(e)}))):t.Promise.reject({code:r._errorCode,message:r._errorString})}},{key:"_closeSourceAsync",value:function(e){var r=this;return r._resetErr(),r._isValid()?r._isWasmWithScan()?t.Promise.resolve(!0):r._isMobileMode()?r._mobileNotSupportAsync(e):r._innerFunV2("CloseSource").then((function(){return r._curDevice=null,!0})):t.Promise.reject({code:r._errorCode,message:r._errorString})}},{key:"_selectSourceAsync",value:function(r,n){var i=this;return i._resetErr(),i._isValid()?i._isMobileMode()&&!i._isWasmWithScan()?i._mobileNotSupportAsync(r):i._getDevicesAsync(r,n).then((function(n){var o,a,s=document,u=n?n.length:0;if(t.dialog.selectsourcedlg)return t.Errors.SystemBusy(i),t.Promise.reject({code:i._errorCode,message:i._errorString});var c,l=-1;for((a=s.createElement("dialog")).className="dynamsoft-dialog-selectsource",e.navInfoSync.bIE&&(a.style.width="300px"),a.setAttribute("closed","closed"),(c=[]).push('<ul id="dynamsoft-dialog-selectsource-sourcelist-ul">'),o=0;o<u;o++){var d="",h=i._getSourceNameByIndex(o);(""==i.__defaultSourceName&&0==o||i.__defaultSourceName==h)&&(d=" dynamsoft-dialog-selectsource-sourcelist-li-selected",l=o),c.push('<li class="dynamsoft-dialog-selectsource-item'+d+'" sourceindex='+o+">"+h+"</li>")}c.push("</ul>"),c=c.join("");var g=["<p>",e.Lib.product.CustomizableDisplayInfo.dialogText.selectSource[0],"</p>",'<div id="dynamsoft-dialog-selectsource-sourcelist">',c,"</div>",'<div><input type="button" value="',e.Lib.product.CustomizableDisplayInfo.dialogText.selectSource[1],'" class="dynamsoft-dialog-selectsource-button-select">','<input type="button" value="',e.Lib.product.CustomizableDisplayInfo.dialogText.selectSource[2],'" class="dynamsoft-dialog-selectsource-button-cancel"></div>'].join("");return a.innerHTML=g,t.dialog.selectsourcedlg=a,s.body.appendChild(t.dialog.selectsourcedlg),t.each(t.all(".dynamsoft-dialog-selectsource-item"),(function(e,r){t.addEventListener(e,"click",(function(e){for(var r=e.target,n=r.attributes.sourceindex.value,i=r.parentElement.children,o=0;o<i.length;o++)i[o].className="dynamsoft-dialog-selectsource-item";r.className="dynamsoft-dialog-selectsource-item dynamsoft-dialog-selectsource-sourcelist-li-selected",t.get("dynamsoft-dialog-selectsource-sourcelist-ul").setAttribute("selectedSourceIndex",n)}))})),t.get("dynamsoft-dialog-selectsource-sourcelist-ul").setAttribute("selectedSourceIndex",l.toString()),t.dialog.setup(t.dialog.selectsourcedlg),t.dialog.selectsourcedlg&&t.dialog.selectsourcedlg.showModal(),"CSS1Compat"==s.compatMode?s.documentElement.scrollTop:s.body.scrollTop,new t.Promise((function(n,o){t.removeEventListener(t.one(".dynamsoft-dialog-selectsource-button-select")[0],"click"),t.removeEventListener(t.one(".dynamsoft-dialog-selectsource-button-cancel")[0],"click"),u>0&&t.addEventListener(t.one(".dynamsoft-dialog-selectsource-button-select")[0],"click",(function(){var o=parseInt(e.Lib.get("dynamsoft-dialog-selectsource-sourcelist-ul").attributes.selectedSourceIndex.value);o<0||i._selectSourceByIndexAsync(r,o).then((function(){t.dialog.selectsourcedlg&&(t.dialog.selectsourcedlg.close(),document.body.removeChild(t.dialog.selectsourcedlg),t.dialog.selectsourcedlg=!1),n(o)}))})),t.addEventListener(t.one(".dynamsoft-dialog-selectsource-button-cancel")[0],"click",(function(){t.dialog.selectsourcedlg&&(t.dialog.selectsourcedlg.close(),document.body.removeChild(t.dialog.selectsourcedlg),t.dialog.selectsourcedlg=!1),o({code:e.DWT.EnumDWT_Error.UserCancelled,message:"User cancelled the operation."})}))}))})):t.Promise.reject({code:i._errorCode,message:i._errorString})}},{key:"_getCapabilities",value:function(e,r){var n=this;if(n._isMobileMode())return n._mobileNotSupport("getCapabilities",r);var i=function(){t.isFunction(r)&&r(n._errorCode,n._errorString)};return!n._curDevice||(n._curDevice.deviceType&ae)!=ae&&(n._curDevice.deviceType&se)!=se?n._innerFunRaw("GetCapabilities",null,!0,!1,!1,(function(r){var o,a;r.length>0&&(a=r[0]);try{t.isString(a)?(a=t.removeNonPrintableChar(a),a=t.replaceAll(a,"\\\\","\\\\"),o=JSON.parse(a)):o={}}catch(s){return n._errorCode=-2302,n._errorString=s,void i()}0==o.errorCode?t.isFunction(e)&&e(o.response):(n._errorCode=o.errorCode,n._errorString=o.errorString,i())}),i):$c(this,nl,fl).call(this,this._curDevice).then(e,i)}},{key:"_setCapabilities",value:function(e,r,n){var i=this;if(i._isMobileMode())return i._mobileNotSupport("setCapabilities",n);if(!t.isObject(e)||t.isArray(e))return t.Errors.InvalidParameter(i),t.isFunction(n)&&n(i._errorCode,i._getErrorString()),!1;if(i._curDevice&&((i._curDevice.deviceType&ae)==ae||(i._curDevice.deviceType&se)==se))return t.Errors.ScannerNotSupport(i,"setCapabilities"),!0;var o=["[",t.stringify(e),"]"].join("");return i._innerSend("SetCapabilities",o,0,(function(e){t.isFunction(r)&&r(e)}),n),!0}},{key:"_selectSourceByIndexAsync",value:(n=Ke(it.mark((function k(e,r){var n,i,o;return it.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(i=1*r,(n=this)._resetErr(),n._isValid()){a.next=4;break}return a.abrupt("return",t.Promise.reject({code:n._errorCode,message:n._errorString}));case 4:if(!n._isMobileMode()||n._isWasmWithScan()){a.next=6;break}return a.abrupt("return",n._mobileNotSupportAsync(e));case 6:if(!t.isNaN(i)){a.next=9;break}return t.Errors.InvalidIndex(n),a.abrupt("return",t.Promise.reject({code:n._errorCode,message:n._errorString}));case 9:if(n.__devices){a.next=12;break}return a.next=12,n._getDevicesAsync(e,null);case 12:if(!(i<0||i>=n.__devices.length)){a.next=15;break}return t.Errors.IndexOutOfRange(n),a.abrupt("return",t.Promise.reject({code:n._errorCode,message:n._errorString}));case 15:return o=n.__devices[i],a.abrupt("return",n._selectDeviceAsync(e,o));case 17:case"end":return a.stop()}}),k,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"_removeAllImages",value:function(e){var t=this,r=!0,n=t._isMobileMode();if(t._resetErr(),!t._isValid())return!1;var i=t._ImgManager.GetCurrentTag();if(""==i||"All"==i)n?t._OnBitmapChanged(["10","-1",3,-1,0]):((r=t._innerFun("RemoveAllImages"))||-1033==t._errorCode)&&t._OnBitmapChanged(["0","-1",3,-1,0]);else{var o,a=function(){},s=function(){},u=[],c="0";for(n&&(c="10"),o=t._getHowManyImagesInBuffer()-1;o>=0;o--){var l=t._ImgManager.convertClientIndexToServerId(o);l>-1&&(n||(r=t._innerFunRaw("RemoveImage",Zn(l),!0,!1,!0,a,s))||-1033==t._errorCode)&&u.push(l)}t._OnBitmapChanged([c,u.join(","),3,t._ImgManager.getCurrentImageIndex(),t._ImgManager.count()])}return r}},{key:"_removeImage",value:function(e,r){var n=this,i=parseInt(r),o=!0;if(!hi(n,i))return!1;var a=n._ImgManager.convertClientIndexToServerId(i);return-1==a?(t.Errors.IndexOutOfRange(n),!1):(n._isMobileMode()?n._OnBitmapChanged(["10",""+a,3,n._ImgManager.getCurrentImageIndex(),n._ImgManager.count()]):((o=n._innerFun("RemoveImage",Zn(a)))||-1033==n._errorCode)&&n._OnBitmapChanged(["0",""+a,3,n._ImgManager.getCurrentImageIndex(),n._ImgManager.count()]),o)}},{key:"_imageIDToIndex",value:function(e){var r,n=this,i=-1;return n._resetErr(),!!n._isValid()&&((r=n._objImageIndexManager.convertGuidToServerId(e))>0&&(i=n._ImgManager.convertServerIdToClientIndex(r)),-1==i&&t.Errors.InvalidImageID(n),i)}}]),f}(Zc);function fl(e){return ml.apply(this,arguments)}function ml(){return(ml=Ke(it.mark((function t(r){var n,i,o,a;return it.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this,"getCapabilities",i=r?r.deviceType:0,n._resetErr(),!n._isMobileMode()){t.next=4;break}return t.abrupt("return",n._mobileNotSupport("getCapabilities"));case 4:if(o="",t.prev=5,i!=ae&&i!=se){t.next=17;break}if(n._dm&&(n._dm.bLicenseOK=!1),!e.DWT.ConnectWithSocket){t.next=11;break}t.next=17;break;case 11:return t.next=13,$c(n,ol,pl).call(n,!0);case 13:return a=t.sent,t.next=16,a.getCapabilitiesAsync(r);case 16:o=t.sent;case 17:t.next=24;break;case 19:throw t.prev=19,t.t0=t["catch"](5),this._errorCode=t.t0.code,this._errorString=t.t0.message,t.t0;case 24:return t.prev=24,t.finish(24);case 26:return t.abrupt("return",o);case 27:case"end":return t.stop()}}),t,this,[[5,19,24,26]])})))).apply(this,arguments)}function _l(e){var r=this;return new Promise((function(n,i){return r._acquireImageFromService(e,(function(){t.log("scan completed"),n(!0)}),(function(e,t){r._errorCode=e,r._errorString=t,i({code:e,message:t})}))}))}function pl(e){return vl.apply(this,arguments)}function vl(){return(vl=Ke(it.mark((function r(n){var i,o,a,s,u,c,l,d,h,g,f;return it.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if((i=this)._dm||(i._bRemoteMode&&(s=null===(u=i._dmService)||void 0===u||null===(c=u.attrs)||void 0===c?void 0:c.url),i._dm=new Hu(s,!1,i._clientId,null===(o=i._dmService)||void 0===o||null===(a=o.attrs)||void 0===a?void 0:a.ty)),i._dm.bLicenseOK){r.next=29;break}return l=i._bRemoteMode&&null!==(d=null===(h=i._dmService)||void 0===h||null===(g=h.attrs)||void 0===g?void 0:g.UUID)&&void 0!==d?d:"",r.prev=4,r.next=7,ca(i,i._dm,l,!1);case 7:i._dm.bLicenseOK=!0,r.next=29;break;case 10:if(r.prev=10,r.t0=r["catch"](4),!e.navInfoSync.bAndroid||i._bRemoteMode){r.next=28;break}return e.DWT.bConnectCanceled=!1,t.product.bAndroidConnected=!1,e.ShowOpenAndroidAppDialog&&e.ShowOpenAndroidAppDialog(),r.next=18,Ou();case 18:if(!e.DWT.bConnectCanceled){r.next=24;break}throw t.asyncQueue.stop(),f={},t.Errors.UserCanceled(f),e.DWT.bConnectCanceled=!1,{code:f._errorCode,message:f._errorString};case 24:return i._dm&&(i._dm.bLicenseOK=!1),r.next=27,$c(i,ol,pl).call(i,!1);case 27:return r.abrupt("return",r.sent);case 28:throw r.t0;case 29:return r.abrupt("return",this._dm);case 30:case"end":return r.stop()}}),r,this,[[4,10]])})))).apply(this,arguments)}function yl(e){return function(e,r){var n,i,o,a=[],s=r;if(t.isString(s)&&(s=t.parse(s)),t.isArray(s))for(n=0;n<s.length;n++){var u=(i=s[n],o=void 0,o=new Qn,i.deviceInfo&&(o.deviceInfo=t.clone(i.deviceInfo)),i.deviceType&&(o.deviceType=t.clone(i.deviceType)),i.displayName&&(o.displayName=t.clone(i.displayName)),i.name&&(o.name=t.clone(i.name)),i.serviceInfo&&(o.serviceInfo=ei(i.serviceInfo)),o);a.push(u)}for(n=0;n<a.length;n++){var c=a[n];c.strDevice=t.stringify(c),c.name&&(c.name=t.base64.decode(c.name)),c.deviceInfo&&li(c.deviceInfo),c.serviceInfo=null==e?void 0:e._dmService,mi(c,null==e?void 0:e._dmService)}return a}(this,e)}function bl(r,n,i,o,a,s,u){var c,l,d=this,h=[];if(r==e.DWT.EnumDWT_ImageType.IT_BMP)return c="bmp",d._mobileNotSupport("Convert to bmp",s);for(c=r==e.DWT.EnumDWT_ImageType.IT_JPG?"jpg":r==e.DWT.EnumDWT_ImageType.IT_PNG?"png":r==e.DWT.EnumDWT_ImageType.IT_TIF?"tiff":r==e.DWT.EnumDWT_ImageType.IT_PDF?"pdf":r==e.DWT.EnumDWT_ImageType.IT_J2K?"jp2":"png",l=0;l<n.length;l++)h.push(d._ImgManager.convertServerIdToClientIndex(n[l]));return d._innerSendToMobile("SaveImage",Kn("",h,c,o,!0),0,(function(e,r,n){t.isFunction(a)&&a(e,u)}),s)}function Il(r,n,i,o,a){var s=this,u="ConvertToBlob",c=!0,l=arguments;t.isFunction(o)||(c=!1),t.cancelFrom=Me,t.showProgress(s,u,!1);var d=function(){if(t.needShowTwiceShowDialog=!1,t.closeProgress(s,u),t.isFunction(a)){var e=[];t.isArray(r)&&t.each(r,(function(t){var r=s._ImgManager.convertServerIdToClientIndex(t);r>-1&&e.push(r)})),Ec(a,s,e,n,l)}return!1},h=2;return s._OnPercentDone([0,-1,e.MSG.Encoding]),s.__innerConvertToBlob(n,r,i,c,h,(function(e,n,i){if(!e||e.size<=0)return t.Errors.ConvertBlobIsEmpty(s),d();var a=s.__maxUploadImageSize;if(e.size>a&&-1!=a)return t.Errors.UploadExceededMaxSize(s),d();if(t.needShowTwiceShowDialog=!1,t.closeProgress(s,u),t.isFunction(o)){var h=[];t.isArray(r)&&t.each(r,(function(e){var t=s._ImgManager.convertServerIdToClientIndex(e);t>-1&&h.push(t)}));try{o(e,h,l)}catch(g){}e=null}return!!c||e}),d)}function wl(r){var n,i=this,o=r;return i._resetErr(),!!i._isValid()&&(o=t.isString(o)?t.trim(o):"",n=i._innerFunRawV2("ProductKey",Zn(o)),i.__productKey=o,n=n.then((function(r){if(r){if(r.exception!==undefined&&r.description!==undefined)throw i._errorCode=r.exception,i._errorString=r.description,i.__productKey="",{code:i._errorCode,message:i._errorString};return e.DWT.ProductKey=i.__productKey,t.License.reparseProductKey(),i._innerFunRawV2("GetLicenseInfo")}throw t.Errors.LicenseEmptyOrInvalid(i),n.context=null,{code:i._errorCode,message:i._errorString}})))}function Sl(){return this._isValid()?this._innerSend("dispose",null,null,(function(){}),(function(){})):t.Promise.reject()}function Tl(){this.__defaultSourceName="",this.__sourceCount=0}var Cl=function(e){Qe(r,e);var t=qc(r);function r(){return Le(this,r),t.apply(this,arguments)}return Ae(r,[{key:"OnRefreshUI",value:function(e,t,r,n){return this.__onRefreshUI(e,t,r,n)}},{key:"GetCurrentDocumentName",value:function(){return this._innerGetCurrentDocumentName()}},{key:"RegisterEvent",value:function(e,t){return!!this._innerRegisterEvent(e,t)}},{key:"UnregisterEvent",value:function(e,t){return this._unregisterEvent(e,t)}},{key:"onEvent",value:function(e,t){this._innerRegisterEvent(e,t)}},{key:"on",value:function(e,t){this._innerRegisterEvent(e,t)}}]),r}(gl),El=new WeakSet,Ml=new WeakSet,Dl=new WeakSet,kl=function(r){Qe(u,r);var n,i,o,a,s=qc(u);function u(){var e;Le(this,u);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Qc(Ze(e=s.call.apply(s,[this].concat(r))),Dl),Qc(Ze(e),Ml),Qc(Ze(e),El),e}return Ae(u,[{key:"LoadImage",value:function(e,r,n){var i=this,o="LoadImage";if(i._resetErr(),!i._isValid())return!1;if(i._isMobileMode())return i._mobileNotSupport(o,n);var a,s,u,c=ti.replaceLocalFilename(e),l=ti.getImageType(c);return r&&t.isFunction(r)&&(s=function(e){r()}),n&&t.isFunction(n)&&(u=function(){n(i._errorCode,i._getErrorString())}),a=i.__GetLoadEventsNum(),""==c&&(i.__bOpenFileNow=!0),i.__innerLoadImage(o,Zn(c,a,1),l,!0,1,s,u)}},{key:"LoadImageEx",value:function(r,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return!1;if(a._isMobileMode()){var s=t.one(".d-loadImage");if(0==s.length){var u=document.createElement("input");u._stwain=a,u.setAttribute("type","file"),u.setAttribute("multiple","multiple"),u.style="position:absolute;top:-2px;left:-2px;width:1px;height:1px;",u.className="d-loadImage",n==e.DWT.EnumDWT_ImageType.IT_BMP?u.setAttribute("accept","image/bmp"):n==e.DWT.EnumDWT_ImageType.IT_JPG?u.setAttribute("accept","image/jpeg"):n==e.DWT.EnumDWT_ImageType.IT_TIF?u.setAttribute("accept","image/tiff"):n==e.DWT.EnumDWT_ImageType.IT_PNG?u.setAttribute("accept","image/png"):n==e.DWT.EnumDWT_ImageType.IT_PDF?u.setAttribute("accept",".pdf"):n==e.DWT.EnumDWT_ImageType.IT_J2K?u.setAttribute("accept",".jp2,.j2k,.j2c"):t.env.bMobile?u.setAttribute("accept","image/jpeg,image/png,image/tiff,image/tif"):u.setAttribute("accept","image/*,.pdf,.jp2,.j2k,.j2c"),u.ondoubleclick=function(){this.files.length>0&&this._stwain.LoadImageFromBinary(this.files,i,o),this.value="",this._stwain=null},u.onchange=function(){this.files.length>0&&this._stwain.LoadImageFromBinary(this.files,i,o),this.value="",this._stwain=null},document.body.appendChild(u),u.click()}else n==e.DWT.EnumDWT_ImageType.IT_BMP?s[0].setAttribute("accept","image/bmp"):n==e.DWT.EnumDWT_ImageType.IT_JPG?s[0].setAttribute("accept","image/jpeg"):n==e.DWT.EnumDWT_ImageType.IT_TIF?s[0].setAttribute("accept","image/tiff"):n==e.DWT.EnumDWT_ImageType.IT_PNG?s[0].setAttribute("accept","image/png"):n==e.DWT.EnumDWT_ImageType.IT_PDF?s[0].setAttribute("accept",".pdf"):n==e.DWT.EnumDWT_ImageType.IT_J2K?s[0].setAttribute("accept",".jp2,.j2k,.j2c"):t.env.bMobile?s[0].setAttribute("accept","image/jpeg,image/png,image/tiff,image/tif"):s[0].setAttribute("accept","image/*,.pdf,.jp2,.j2k,.j2c"),s[0].value="",s[0]._stwain=a,s[0].click();return!0}var c,l,d,h=ti.replaceLocalFilename(r),g=n;i&&t.isFunction(i)&&(l=function(e){i()}),o&&t.isFunction(o)&&(d=function(){o(a._errorCode,a._getErrorString())}),g==e.DWT.EnumDWT_ImageType.IT_ALL&&(g=-1),c=a.__GetLoadEventsNum(),""==h&&(a.__bOpenFileNow=!0);return a.__innerLoadImage("LoadImageEx",Zn(h,g,c,1),g,!0,1,l,d)}},{key:"HTTPDownload",value:function(e,r,n,i){var o=this;if(o._resetErr(),!o._isValid())return t.Promise.reject({code:o._errorCode,message:o._getErrorString()});var a=ti.getImageType(r);return o._innerHTTPDownloadThroughGet(e,r,a,n,i)}},{key:"HTTPDownloadEx",value:function(e,r,n,i,o){var a=this;return a._resetErr(),a._isValid()?a._isMobileMode()?a._mobileNotSupport("HTTPDownloadEx",o):a._innerHTTPDownloadThroughGet(e,r,n,i,o):t.Promise.reject({code:a._errorCode,message:a._getErrorString()})}},{key:"SaveAsBMP",value:function(r,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return!1;if(a._isMobileMode())return a._mobileNotSupport("SaveAsBMP",o);if(!(t.License.checkProductKey(a,{Core:!0})||e.navInfoSync.bWin&&t.License.checkProductKey(a,{Webcam:!0},!0)))return t.isFunction(o)&&o(a._errorCode,a._getErrorString()),!1;var s,u=ti.replaceLocalFilename(r);return!!ci(a,n,o)&&(-1==(s=a._ImgManager.convertClientIndexToServerId(n))?(t.Errors.IndexOutOfRange(a),t.isFunction(o)&&Cc(o,a),!1):a.__innerSaveImage("SaveAsBMP",Zn(u,s),i,o))}},{key:"SaveAsJPEG",value:function(r,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return!1;if(!(t.License.checkProductKey(a,{Core:!0})||e.navInfoSync.bWin&&t.License.checkProductKey(a,{Webcam:!0},!0)))return t.isFunction(o)&&o(a._errorCode,a._getErrorString()),!1;if(!ci(a,n,o))return!1;var s,u=ti.replaceLocalFilename(r);return a._isMobileMode()?u&&""!=u?a._asyncSaveImage(r,[n],"jpg",i,o):(t.Errors.InvalidFile(a),t.isFunction(o)&&Cc(o,a),!1):-1==(s=a._ImgManager.convertClientIndexToServerId(n))?(t.Errors.IndexOutOfRange(a),t.isFunction(o)&&Cc(o,a),!1):a.__innerSaveImage("SaveAsJPEG",Zn(u,s),i,o)}},{key:"SaveAsPDF",value:function(r,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return!1;if(!(t.License.checkProductKey(a,{Core:!0})||e.navInfoSync.bWin&&t.License.checkProductKey(a,{Webcam:!0},!0)))return t.isFunction(o)&&o(a._errorCode,a._getErrorString()),!1;if(!ci(a,n,o))return!1;var s,u=ti.replaceLocalFilename(r);return a._isMobileMode()?u&&""!=u?a._asyncSaveImage(r,[n],"pdf",i,o):(t.Errors.InvalidFile(a),t.isFunction(o)&&Cc(o,a),!1):-1==(s=a._ImgManager.convertClientIndexToServerId(n))?(t.Errors.IndexOutOfRange(a),t.isFunction(o)&&Cc(o,a),!1):a.__innerSaveImage("SaveAsPDF",Zn(u,s),i,o)}},{key:"SaveAsPNG",value:function(r,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return!1;if(!(t.License.checkProductKey(a,{Core:!0})||e.navInfoSync.bWin&&t.License.checkProductKey(a,{Webcam:!0},!0)))return t.isFunction(o)&&o(a._errorCode,a._getErrorString()),!1;if(!ci(a,n,o))return!1;var s,u=ti.replaceLocalFilename(r);return a._isMobileMode()?u&&""!=u?a._asyncSaveImage(r,[n],"png",i,o):(t.Errors.InvalidFile(a),t.isFunction(o)&&Cc(o,a),!1):-1==(s=a._ImgManager.convertClientIndexToServerId(n))?(t.Errors.IndexOutOfRange(a),t.isFunction(o)&&Cc(o,a),!1):a.__innerSaveImage("SaveAsPNG",Zn(u,s),i,o)}},{key:"SaveAsTIFF",value:function(r,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return!1;if(!(t.License.checkProductKey(a,{Core:!0})||e.navInfoSync.bWin&&t.License.checkProductKey(a,{Webcam:!0},!0)))return t.isFunction(o)&&o(a._errorCode,a._getErrorString()),!1;if(!ci(a,n,o))return!1;var s,u=ti.replaceLocalFilename(r);return a._isMobileMode()?u&&""!=u?a._asyncSaveImage(r,[n],"tiff",i,o):(t.Errors.InvalidFile(a),t.isFunction(o)&&Cc(o,a),!1):-1==(s=a._ImgManager.convertClientIndexToServerId(n))?(t.Errors.IndexOutOfRange(a),t.isFunction(o)&&Cc(o,a),!1):a.__innerSaveImage("SaveAsTIFF",Zn(u,s),i,o)}},{key:"SaveSelectedImagesAsMultiPagePDF",value:function(r,n,i){var o=this;if(o._resetErr(),!o._isValid())return!1;if(!(t.License.checkProductKey(o,{Core:!0})||e.navInfoSync.bWin&&t.License.checkProductKey(o,{Webcam:!0},!0)))return t.isFunction(i)&&i(o._errorCode,o._getErrorString()),!1;var a=ti.replaceLocalFilename(r);if(o._isMobileMode()){if(!a||""==a)return t.Errors.InvalidFile(o),t.isFunction(i)&&Cc(i,o),!1;var s=tl(o);return o._asyncSaveImage(r,s,"pdf",n,i)}var u=di(o);return o.__innerSaveImage("SaveSelectedImagesAsMultiPagePDF",Zn(a,u.join(",")),n,i)}},{key:"SaveSelectedImagesAsMultiPageTIFF",value:function(r,n,i){var o=this;if(o._resetErr(),!o._isValid())return!1;if(!(t.License.checkProductKey(o,{Core:!0})||e.navInfoSync.bWin&&t.License.checkProductKey(o,{Webcam:!0},!0)))return t.isFunction(i)&&i(o._errorCode,o._getErrorString()),!1;var a=ti.replaceLocalFilename(r);if(o._isMobileMode()){if(!a||""==a)return t.Errors.InvalidFile(o),t.isFunction(i)&&Cc(i,o),!1;var s=tl(o);return o._asyncSaveImage(r,s,"tiff",n,i)}var u=di(o);return o.__innerSaveImage("SaveSelectedImagesAsMultiPageTIFF",Zn(a,u.join(",")),n,i)}},{key:"SaveAllAsMultiPageTIFF",value:function(r,n,i){var o=this;if(o._resetErr(),!o._isValid())return!1;if(!(t.License.checkProductKey(o,{Core:!0})||e.navInfoSync.bWin&&t.License.checkProductKey(o,{Webcam:!0},!0)))return t.isFunction(i)&&i(o._errorCode,o._getErrorString()),!1;if(!ui(o,i))return!1;var a=[],s=ti.replaceLocalFilename(r);if(o._isMobileMode()){if(!s||""==s)return t.Errors.InvalidFile(o),t.isFunction(i)&&Cc(i,o),!1;for(var u=[],c=0;c<o.HowManyImagesInBuffer;c++)u.push(c);return o._asyncSaveImage(r,u,"tiff",n,i)}return si(o,a),o.__innerSaveImage("SaveSelectedImagesAsMultiPageTIFF",Zn(s,a.join(",")),n,i)}},{key:"SaveAllAsPDF",value:function(r,n,i){var o=this;if(o._resetErr(),!o._isValid())return!1;if(!(t.License.checkProductKey(o,{Core:!0})||e.navInfoSync.bWin&&t.License.checkProductKey(o,{Webcam:!0},!0)))return t.isFunction(i)&&i(o._errorCode,o._getErrorString()),!1;if(!ui(o,i))return!1;var a=[],s=ti.replaceLocalFilename(r);if(o._isMobileMode()){if(!s||""==s)return t.Errors.InvalidFile(o),t.isFunction(i)&&Cc(i,o),!1;for(var u=[],c=0;c<o.HowManyImagesInBuffer;c++)u.push(c);return o._asyncSaveImage(r,u,"pdf",n,i)}return si(o,a),o.__innerSaveImage("SaveSelectedImagesAsMultiPagePDF",Zn(s,a.join(",")),n,i)}},{key:"HTTPUpload",value:function(e,t,r,n,i,o,a){var s=this;return s._resetErr(),!!s._isValid()&&(arguments.length<=3?wc(s,arguments):Sc(s,arguments))}},{key:"HTTPUploadThroughPost",value:function(e,r,n,i,o,a,s){var u=this;if(u._resetErr(),!u._isValid())return!1;if(u._isMobileMode())return u._mobileNotSupport("HTTPUploadThroughPost",a);var c=ti.getImageType(i),l=arguments,d=!1,h=function(e){return t.isFunction(a)&&Ec(a,u,u.__HTTPPostResponseString,e,l),!1};return t.isString(i)&&""!=i?(o&&t.isFunction(o)&&(d=function(e,t){return Tc(o,u.__HTTPPostResponseString,t,l),!0}),!!el(u,r,c,h)&&$c(u,El,xl).call(u,e,r,n,i,c,d,h,s)):(t.Errors.UploadFileCannotEmpty(u),h())}},{key:"HTTPUploadThroughPostEx",value:function(e,r,n,i,o,a,s,u){var c=this;if(c._resetErr(),!c._isValid())return!1;if(c._isMobileMode())return c._mobileNotSupport("HTTPUploadThroughPostEx",s);var l=arguments,d=!1,h=function(e){return t.isFunction(s)&&Ec(s,c,c.__HTTPPostResponseString,e,l),!1};return t.isString(i)&&""!=i?(a&&t.isFunction(a)&&(d=function(e,t){return Tc(a,c.__HTTPPostResponseString,t,l),!0}),!!el(c,r,o,h)&&$c(c,El,xl).call(c,e,r,n,i,o,d,h,u)):(t.Errors.UploadFileCannotEmpty(c),h())}},{key:"HTTPUploadAllThroughPostAsMultiPageTIFF",value:function(e,r,n,i,o,a){var s=this;if(s._resetErr(),!s._isValid())return!1;if(s._isMobileMode())return s._mobileNotSupport("HTTPUploadAllThroughPostAsMultiPageTIFF",o);var u=-1,c=2,l=arguments,d=!1,h=function(e){return t.isFunction(o)&&Ec(o,s,s.__HTTPPostResponseString,e,l),!1};return t.isString(n)&&""!=n?(i&&t.isFunction(i)&&(d=function(e,t){return Tc(i,s.__HTTPPostResponseString,t,l),!0}),$c(s,El,xl).call(s,e,u,r,n,c,d,h,a)):(t.Errors.UploadFileCannotEmpty(s),h())}},{key:"HTTPUploadAllThroughPostAsPDF",value:function(e,r,n,i,o,a){var s=this;if(s._resetErr(),!s._isValid())return!1;if(s._isMobileMode())return s._mobileNotSupport("HTTPUploadAllThroughPostAsPDF",o);var u=-1,c=4,l=arguments,d=!1,h=function(e){return t.isFunction(o)&&Ec(o,s,s.__HTTPPostResponseString,e,l),!1};return t.isString(n)&&""!=n?(i&&t.isFunction(i)&&(d=function(e,t){return Tc(i,s.__HTTPPostResponseString,t,l),!0}),$c(s,El,xl).call(s,e,u,r,n,c,d,h,a)):(t.Errors.UploadFileCannotEmpty(s),h())}},{key:"HTTPUploadThroughPostAsMultiPagePDF",value:function(e,r,n,i,o,a){var s=this;if(s._resetErr(),!s._isValid())return!1;if(s._isMobileMode())return s._mobileNotSupport("HTTPUploadThroughPostAsMultiPagePDF",o);var u=-2,c=4,l=arguments,d=!1,h=function(e){return t.isFunction(o)&&Ec(o,s,s.__HTTPPostResponseString,e,l),!1};return t.isString(n)&&""!=n?(i&&t.isFunction(i)&&(d=function(e,t){return Tc(i,s.__HTTPPostResponseString,t,l),!0}),$c(s,El,xl).call(s,e,u,r,n,c,d,h,a)):(t.Errors.UploadFileCannotEmpty(s),h())}},{key:"HTTPUploadThroughPostAsMultiPageTIFF",value:function(e,r,n,i,o,a){var s=this;if(s._resetErr(),!s._isValid())return!1;if(s._isMobileMode())return s._mobileNotSupport("HTTPUploadThroughPostAsMultiPageTIFF",o);var u=-2,c=2,l=arguments,d=!1,h=function(e){return t.isFunction(o)&&Ec(o,s,s.__HTTPPostResponseString,e,l),!1};return t.isString(n)&&""!=n?(i&&t.isFunction(i)&&(d=function(e,t){return Tc(i,s.__HTTPPostResponseString,t,l),!0}),$c(s,El,xl).call(s,e,u,r,n,c,d,h,a)):(t.Errors.UploadFileCannotEmpty(s),h())}},{key:"GetSourceNamesAsync",value:(a=Ke(it.mark((function c(e){var t;return it.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if((t=this)._resetErr(),t._isValid()){r.next=4;break}throw{code:t._errorCode,message:t._errorString};case 4:if(!t._isMobileMode()){r.next=6;break}return r.abrupt("return",t._mobileNotSupportAsync("GetSourceNamesAsync"));case 6:return ni("GetSourceNamesAsync",t),r.prev=7,r.next=10,t._getSourceCountAsync(t._driverType);case 10:r.next=15;break;case 12:throw r.prev=12,r.t0=r["catch"](7),r.t0;case 15:return r.prev=15,ii("GetSourceNamesAsync"),r.finish(15);case 18:if(!e){r.next=22;break}return r.abrupt("return",$c(t,Ml,Pl).call(t));case 22:return r.abrupt("return",$c(t,Dl,Wl).call(t));case 23:case"end":return r.stop()}}),c,this,[[7,12,15,18]])}))),function(e){return a.apply(this,arguments)})},{key:"SelectSourceAsync",value:function(e){return this._selectSourceAsync("SelectSourceAsync",e)}},{key:"SelectSourceByIndexAsync",value:function(e){return this._selectSourceByIndexAsync("SelectSourceByIndex",e)}},{key:"OpenSourceAsync",value:function(){return this._openSourceAsync("OpenSourceAsync")}},{key:"CloseSourceAsync",value:function(){return this._closeSourceAsync("CloseSourceAsync")}},{key:"OpenSourceManagerAsync",value:function(){var e=this;return e._resetErr(),e._isValid()?e._isMobileMode()?e._mobileNotSupportAsync("OpenSourceManager"):e._innerFunV2("OpenSourceManager"):t.Promise.reject({code:e._errorCode,message:e._errorString})}},{key:"CloseSourceManagerAsync",value:function(){var e=this;return e._resetErr(),e._isValid()?e._isMobileMode()?e._mobileNotSupportAsync("CloseSourceManager"):e._innerFunV2("CloseSourceManager"):t.Promise.reject({code:e._errorCode,message:e._errorString})}},{key:"getCapabilities",value:function(e,t){return this._getCapabilities(e,t)}},{key:"setCapabilities",value:function(e,t,r){return this._setCapabilities(e,t,r)}},{key:"AcquireImage",value:function(e,r,n){var i,o=this,a=null,s=null;if(o._resetErr(),!o._isValid())return!1;if(o._isWasmWithScan());else if(o._isMobileMode())return o._mobileNotSupportAsync("AcquireImage");return t.isUndefined(n)&&(t.isFunction(e)&&t.isFunction(r)||t.isFunction(e)&&t.isUndefined(r)||t.isFunction(e)&&null==r||null==e&&t.isFunction(r))?(i={},t.isFunction(e)&&(a=e),t.isFunction(r)&&(s=function(e){e&&e.code&&(o._errorCode=e.code,o._errorString=e.message),r(o._errorCode,o._errorString)})):(i=t.isUndefined(e)||null==e?{}:t.clone(e),t.isFunction(r)&&(a=function(){r(i)}),t.isFunction(n)&&(s=function(e){e&&e.code&&(o._errorCode=e.code,o._errorString=e.message),n(i,o._errorCode,o._errorString)})),a||(a=function(){}),s||(s=function(e){e&&e.code&&(o._errorCode=e.code,o._errorString=e.message)}),o.AcquireImageAsync(i).then(a,s),!ti.isServerInvalid(o)}},{key:"GetDevicesAsync",value:(o=Ke(it.mark((function l(e,t,r){return it.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this._getDevicesAsync("GetDevicesAsync",e,t,r));case 1:case"end":return n.stop()}}),l,this)}))),function(e,t,r){return o.apply(this,arguments)})},{key:"SelectDeviceAsync",value:(i=Ke(it.mark((function d(e,t){return it.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this._selectDeviceAsync("SelectDeviceAsync",e,t));case 1:case"end":return r.stop()}}),d,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"AcquireImageAsync",value:(n=Ke(it.mark((function h(e){return it.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._acquireImageAsync("AcquireImageAsync",e,this));case 1:case"end":return t.stop()}}),h,this)}))),function(e){return n.apply(this,arguments)})},{key:"ImageIDToIndex",value:function(e){return this._imageIDToIndex(e)}},{key:"IndexToImageID",value:function(e){var r=this;if(r._resetErr(),!r._isValid())return!1;var n=parseInt(e);if(isNaN(n))return t.Errors.InvalidIndex(r),-1;if(n<0||n>=r._ImgManager.count())return t.Errors.IndexOutOfRange(r),-1;var i=r._ImgManager.convertClientIndexToServerId(n);return r._objImageIndexManager.convertServerIdToGuid(i)}},{key:"RemoveImage",value:function(e){return this._removeImage("RemoveImage",e)}},{key:"RemoveAllImages",value:function(){return this._removeAllImages("RemoveAllImages")}},{key:"_innerGetSourceNamesSync",value:function(e){var t=this;return t._isMobileMode()?t._mobileNotSupport("GetSourceNames"):(t._getSourceCountSync(),e?$c(t,Ml,Pl).call(t):$c(t,Dl,Wl).call(t))}},{key:"_innerHTTPDownloadThroughGet",value:function(r,n,i,o,a){var s=this,u=Ic(s),c=ti.combineUrl(s,r,n);if(c===undefined)return t.Errors.ParameterCannotEmpty(s),t.isFunction(a)&&Cc(a,s),Or;if(s._isMobileMode()){if(!t.License.checkProductKey(s,{Core:!0}))return t.isFunction(a)&&Cc(a,s),Or}else{if(!t.License.checkProductKey(s,{Core:!0}))return t.isFunction(a)&&Cc(a,s),Or;if(!t.License.checkPDFProductKeyWhenNeeds(s,i))return t.isFunction(a)&&Cc(a,s),Or}t.cancelFrom=ke,t.showProgress(s,"HTTPDownloadThroughGet",Rr);var l=function(e){var t=0===e.total?100:Math.round(100*e.loaded/e.total);[e.loaded," / ",e.total].join(""),s._OnPercentDone([0,t,"","http"])},d=Rr;s._OnPercentDone([0,-1,e.MSG.Downloading,"http"]),t.isFunction(o)||(d=Or);var h=s._innerGetCurrentDocumentName();return""==h&&s._ImgManager&&(h=s._ImgManager.getWebViewer().GetDefaultFileName()),t.log("_innerHTTPDownloadThroughGet.currentFileName:"+h),s._isMobileMode()?ti.loadHttpBlob(s,"get",c,d,(function(r){s._OnPercentDone([0,-1,e.MSG.Loading]),r.currentFileName=h,t.log("00b.currentFileName:"+h),s._innerLoadImageFromBinary(r,0,!0,(function(){e.Lib.closeProgress(s,""),t.isFunction(o)&&o()}),(function(){t.closeProgress(s,"HTTPDownloadThroughGet"),t.isFunction(a)&&Cc(a,s)}))}),(function(){t.closeProgress(s,"HTTPDownloadThroughGet"),t.isFunction(a)&&Cc(a,s)}),l,u):ti.loadHttpBlob(s,"get",c,d,(function(r){s._OnPercentDone([0,-1,e.MSG.Loading]);var n=i;n!=e.DWT.EnumDWT_ImageType.IT_BMP&&n!=e.DWT.EnumDWT_ImageType.IT_JPG&&n!=e.DWT.EnumDWT_ImageType.IT_TIF&&n!=e.DWT.EnumDWT_ImageType.IT_PNG&&n!=e.DWT.EnumDWT_ImageType.IT_PDF&&n!=e.DWT.EnumDWT_ImageType.IT_J2K&&(n=-1),r.currentFileName=h,t.log("11b.currentFileName:"+h);var u=s.__GetLoadEventsNum();s.__LoadImageFromBytesV1(r,n,"",u,d,(function(){e.Lib.closeProgress(s,""),t.isFunction(o)&&o()}),(function(){t.closeProgress(s,"HTTPDownloadThroughGet"),t.isFunction(a)&&Cc(a,s)}))}),(function(){t.closeProgress(s,"HTTPDownloadThroughGet"),t.isFunction(a)&&Cc(a,s)}),l,u)}},{key:"Viewer",get:function(){return this._viewer}},{key:"ErrorCode",get:function(){return this._errorCode}},{key:"ErrorString",get:function(){return this._getErrorString()}},{key:"HowManyImagesInBuffer",get:function(){return this._getHowManyImagesInBuffer()}},{key:"Addon",get:function(){return this.__addon}},{key:"objImageIndexManager",get:function(){return this._objImageIndexManager}}]),u}(Cl);function xl(r,n,i,o,a,s,u,c){var l,d,h=this,g="HTTPUploadThroughPostEx",f=ti.combineUrl(h,r,i),m=!0,_=!1,p=[],v=function(e){return t.isFunction(u)&&u(e),!1};if(h.__HTTPPostResponseString="",t.isNumber(n)){if(n<-2)return t.Errors.IndexOutOfRange(h),v(n)}else if(!t.isArray(n))return t.Errors.IndexOutOfRange(h),v(n);if(!t.isString(o)||""==o)return t.Errors.UploadFileCannotEmpty(h),v();if(t.isUndefined(a))return t.Errors.InvalidImageType(h),v(n);if(a==e.DWT.EnumDWT_ImageType.IT_BMP||a==e.DWT.EnumDWT_ImageType.IT_JPG||a==e.DWT.EnumDWT_ImageType.IT_PNG||a==e.DWT.EnumDWT_ImageType.IT_J2K){if(-1==n&&h._ImgManager.count()>1||t.isArray(n)&&n.length>1)return t.Errors.UploadIndexMoreThanOne(h),v(n);t.isArray(n)?p.push(n[0]):-1==n?p.push(0):p.push(n)}else{if(a!=e.DWT.EnumDWT_ImageType.IT_TIF&&a!=e.DWT.EnumDWT_ImageType.IT_PDF)return t.Errors.InvalidImageType(h),v(n);if(-1==n){if(0==h._ImgManager.count())return t.Errors.NoImage(h),v();for(d=0;d<h._ImgManager.count();d++)p.push(d)}else if(-2==n)p=h._ImgManager.getSelectedClientIndexArray();else if(t.isArray(n))for(d=0;d<n.length;d++)p.push(n[d]);else p.push(n)}if(h._isMobileMode()?m=!0:t.isFunction(s)||(m=!1),""===r)return t.Errors.HttpServerCannotEmpty(h),v(p);if(t.isUndefined(f)||""===f)return t.Errors.ParameterCannotEmpty(h),v(p);if(!t.isString(f))return t.Errors.InvalidUrl(h),v(p);if(0!=f.indexOf("http://")&&0!=f.indexOf("https://")&&(f=t.detect.ssl?"https://"+f:"http://"+f),!h._checkIndices(p)&&-1!=p)return v(p);var y=[];if(t.isArray(p)&&t.each(p,(function(e){var t=h._ImgManager.convertClientIndexToServerId(e);-1!=t&&y.push(t)})),h._resetErr(),!h._isValid())return!1;if(m)return l={bOnlyUploadForm:Or,method:"HTTPUploadThroughPostEx",_this:h,url:f,serverIds:y,enumImageType:a,saveSetup:false,fileName:o,retry:0,bOnlyEmptyIsOK:!0,objUploadFileStatus:!1,dataFormat:e.DWT.EnumDWT_UploadDataFormat.Binary,asyncSuccessFunc:s,asyncFailureFunc:v},t._asyncUploadCmd(l),!0;t.cancelFrom=De;var b=function(){return t.needShowTwiceShowDialog=!1,t.closeProgress(h,g),v(p),!1};t.needShowTwiceShowDialog=!0,t.showProgress(h,g,!1);var I=Ic(h);return h._OnPercentDone([0,-1,e.MSG.Encoding,"http"]),h.__innerConvertToBlob(a,y,false,m,4,(function(r,n,i){if(t.needShowTwiceShowDialog=!1,r&&(t.dlgRef>0||0==h.__IfShowCancelDialogWhenImageTransfer||0==m)){var a=h.__maxUploadImageSize;if(r.size>a&&-1!=a)return t.Errors.UploadExceededMaxSize(h),b();e.DWT.IfAddMD5InUploadHeader&&n&&""!=n&&(I["dwt-md5"]=n),r instanceof File?r.fileName=o:r.name=o,Mc(h,!0);return ti.httpPostUpload(h,f,r,m,0,I,!0,0,!0,!1,(function(e){return t.closeProgress(h,g),_=!0,!0}),b)}return b()}),b),_}function Pl(){var e,r,n=[],i=this.__devices.length;for(e=0;e<i;e++){var o=this.__devices[e],a=o.deviceType,s={ProductName:"",DeviceInfo:{},DriverType:"",IsCurrentSource:!1,IsDefaultSource:!1,Manufacturer:"",ProductFamily:"",ProtocolMajor:0,ProtocolMinor:0,SupportedGroups:0,Version:{Country:0,Info:"",Language:0,MajorNum:0,MinorNum:0}},u=void 0;if(fi(a))a==ae?u="eSCL":a==se&&(u="WiFiScanner");else{var c=t.clone(o.deviceInfo);(r=a)==te||r==re||r==ne?(a==te?u="TWAIN":a==re?u="WIATWAIN":a==ne&&(u="TWAIN64"),s.Manufacturer=c.Manufacturer,s.ProductFamily=c.ProductFamily,s.ProtocolMajor=c.ProtocolMajor,s.ProtocolMinor=c.ProtocolMinor,s.SupportedGroups=c.SupportedGroups,s.Version=c.Version):a==oe?(u="SANE",s.DeviceInfo=c):a==ie&&(u="ICA",s.DeviceInfo=c)}s.ProductName=o.displayName,s.DriverType=u,n.push(s)}return n}function Wl(){var e,t=[],r=this.__devices.length;for(e=0;e<r;e++){var n=this.__devices[e];t.push(n.displayName)}return t}function Ll(e){e.Resolution!==undefined&&(e.Resolution=parseInt(e.Resolution)),e.PixelType!==undefined&&(e.PixelType=parseInt(e.PixelType)),e.SelectSourceByIndex!==undefined&&(e.SelectSourceByIndex=parseInt(e.SelectSourceByIndex))}function Fl(r,n,i,o){if(r._blts)if(i){var a=i.code||i.ltsErrorCode;111==a&&!e.DWT.isPublicLicense()||106==a||108==a?(t.Errors.LicenseNoCore(r,n,a),i={code:r._errorCode,message:r._errorString}):(r._errorCode=a,r._errorString=i.message),e.DWT.lsetException(a,i.message,!0),o&&e.DWT.OnLicenseException()}else e.navInfoSync.bAndroid?t.License.checkAndroidServiceCore(r):t.License.checkProductKey(r,{Core:!0},!0,o);else r._errorCode=i.code,r._errorString=i.message,o&&e.OnLicenseError(i.message,i.code)}function Vl(e){return Nl.apply(this,arguments)}function Nl(){return(Nl=Ke(it.mark((function e(t){return it.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.__bConnecting=!0,e.prev=1,e.next=4,t._reconnect();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e["catch"](1),t._heartBeatTimer=setTimeout((function(){Vl(t)}),t._heartBeatTicks);case 9:return e.prev=9,t.__bConnecting=!1,e.finish(9);case 12:case"end":return e.stop()}}),e,null,[[1,6,9,12]])})))).apply(this,arguments)}function Al(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(es){return!1}}();return function(){var r,n=et(e);if(t){var i=et(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return $e(this,r)}}var Bl=function(r){Qe(i,r);var n=Al(i);function i(){return Le(this,i),n.apply(this,arguments)}return Ae(i,[{key:"_innerSendToMobile",value:function(e,r,n,i,o){var a=this;return a._isMobileMode()?"GetLicenseInfo"==e||"SetLTSLicense"==e?(ni(e,a),bc(a,r).then((function(r){ii(e),t.isFunction(i)&&i(r)}),(function(r){ii(e),t.Errors.GetLicenseInfoFailed(a,r),o&&o(a._errorCode,a._getErrorString())}))):t.License.checkProductKey(a,{Core:!0},!0)?("SaveImage"==e?yc(a,r).then((function(e){var t=e.blobData;i&&i(t,e.type,e.MD5)}),(function(){t.isFunction(o)&&o(a._errorCode,a._getErrorString())})):a._innerSendToMobileV2(e,r).then(i,(function(){t.isFunction(o)&&o(a._errorCode,a._getErrorString())})),!0):(o&&o(a._errorCode,a._getErrorString()),!1):(t.Errors.ServiceNotSupport(a,e),o&&o(a._errorCode,a._getErrorString()),!1)}},{key:"_innerSendToMobileV2",value:function(r,n){var i=this;return i._isMobileMode()?"GetLicenseInfo"==r||"SetLTSLicense"==r?bc(i,n):t.License.checkProductKey(i,{Core:!0},!0)?"LoadImageFromBinary"==r?pc(i,n):"RotateEx"==r?function(r,n){var i=n[0],o=n[1],a=n[2],s=n[3],u=n[4];t.isUndefined(o)&&(o=0),t.isUndefined(a)&&(a=!0),(t.isUndefined(s)||s<1||s>3)&&(s=3),t.isUndefined(u)&&(u="FFFFFF"),o<0?o=o%360+360:o>=360&&(o%=360),ni("",r);var c=gc(),l=r._ImgManager.convertClientIndexToServerId(i);return c.context={},r._ImgManager.getWebViewer().GetImageData(r._ImgManager.getUidByIndex(i)).then((function(e){return c.context.metadata=e&&e.metadata?e.metadata:{},c.initImage(e.oriData)})).then((function(){if(0!=o)return c.rotate(o,u,a,s)})).then((function(){return c.getImage()})).then((function(t){if(e.navInfoSync.bMobile||e.navInfoSync.bPad){var n=r._jpgQuality,i=3840;if(t&&(t.imageWidth>i||t.imageHeight>i))return e.ImageProcWrapper.resizeImageWithMeta(t.imageData,t,5,n,i)}return t})).then((function(e){"width"in e&&(e.imageWidth=e.imageWidth),"height"in e&&(e.imageHeight=e.imageHeight);var n={src:e.imageData,imgType:t.MobileFuns.convertOutputType(e.imageType),dataType:"url",metadata:{width:e.imageWidth,height:e.imageHeight}},i=!1;try{r._OnBitmapChanged(["10",""+l,4,r._ImgManager.getCurrentImageIndex(),r._ImgManager.count(),n])}catch(o){i=!0,t.Errors.SystemExceptionError(r,o.message)}if(ii(""),c.terminate(),i)throw{code:r._errorCode,message:r._getErrorString()}}),(function(e){throw t.Errors.RotateFailed(r,e),ii(""),c.terminate(),{code:r._errorCode,message:r._getErrorString()}}))}(i,n):"Flip"==r?function(e,t){return vc(e,t[0],1)}(i,n):"Mirror"==r?function(e,t){return vc(e,t[0],-1)}(i,n):"Invert"==r?function(e,r){var n=r[0],i=gc(),o=e._ImgManager.convertClientIndexToServerId(n);return i.context={},ni("",e),e._ImgManager.getWebViewer().GetImageData(e._ImgManager.getUidByIndex(n)).then((function(e){return i.context.metadata=e&&e.metadata?e.metadata:{},i.initImage(e.oriData)})).then((function(){return i.invert()})).then((function(){return i.getImage()})).then((function(r){var n={src:r.imageData,imgType:t.MobileFuns.convertOutputType(r.imageType),dataType:"url"};try{e._OnBitmapChanged(["10",""+o,4,e._ImgManager.getCurrentImageIndex(),e._ImgManager.count(),n])}catch(i){throw t.Errors.SystemExceptionError(e,i.message),0}})).then((function(){ii(""),i.terminate()}),(function(r){throw ii(""),r&&t.Errors.InvertFailed(e,r),i.terminate(),{code:e._errorCode,message:e._getErrorString()}}))}(i,n):"SaveImage"==r?yc(i,n):"Crop"==r?function(e,r){var n=r[0],i=r[1],o=r[2],a=r[3],s=r[4];if(!(t.isNumber(i)&&t.isNumber(o)&&t.isNumber(a)&&t.isNumber(s)))return t.Errors.MobileServer_InvalidLeftOrTopOrRightOrBottom(e),t.Promise.reject({code:e._errorCode,message:e._getErrorString()});var u=gc(),c=e._ImgManager.convertClientIndexToServerId(n);return u.context={},ni("",e),e._ImgManager.getWebViewer().GetImageData(e._ImgManager.getUidByIndex(n)).then((function(e){return u.context.metadata=e&&e.metadata?e.metadata:{},u.initImage(e.oriData)})).then((function(){return u.crop(i,o,a,s)})).then((function(){return u.getImage()})).then((function(r){var n={src:r.imageData,imgType:t.MobileFuns.convertOutputType(r.imageType),dataType:"url",metadata:{imageData:r.imageData,width:r.imageWidth,height:r.imageHeight}};try{e._OnBitmapChanged(["10",""+c,4,e._ImgManager.getCurrentImageIndex(),e._ImgManager.count(),n])}catch(i){throw t.Errors.SystemExceptionError(e,i.message),0}})).then((function(){ii(""),u.terminate()}),(function(r){throw ii(""),r&&t.Errors.CropFailed(e,r),u.terminate(),{code:e._errorCode,message:e._getErrorString()}}))}(i,n):"Erase"==r?function(e,r){var n=r[0],i=r[1],o=r[2],a=r[3],s=r[4],u=r[5];if(!(t.isNumber(i)&&t.isNumber(o)&&t.isNumber(a)&&t.isNumber(s)))return t.Errors.MobileServer_InvalidLeftOrTopOrRightOrBottom(e),t.Promise.reject({code:e._errorCode,message:e._getErrorString()});t.isUndefined(u)&&(u="FFFFFF");var c=gc(),l=e._ImgManager.convertClientIndexToServerId(n);return c.context={},ni("",e),e._ImgManager.getWebViewer().GetImageData(e._ImgManager.getUidByIndex(n)).then((function(e){return c.context.metadata=e&&e.metadata?e.metadata:{},c.initImage(e.oriData)})).then((function(){return c.erase(i,o,a,s,u)})).then((function(){return c.getImage()})).then((function(r){var n={src:r.imageData,imgType:t.MobileFuns.convertOutputType(r.imageType),dataType:"url",metadata:{imageData:r.imageData,width:r.imageWidth,height:r.imageHeight}};try{e._OnBitmapChanged(["10",""+l,4,e._ImgManager.getCurrentImageIndex(),e._ImgManager.count(),n])}catch(i){throw t.Errors.SystemExceptionError(e,i.message),0}})).then((function(){ii(""),c.terminate()}),(function(r){throw ii(""),r&&t.Errors.EraseFailed(e,r),c.terminate(),{code:e._errorCode,message:e._getErrorString()}}))}(i,n):"ChangeImageSize"==r?function(e,r){var n=r[0],i=r[1],o=r[2],a=r[3];if(!t.isNumber(i))return t.Errors.MobileServer_InvalidWidth(e),t.Promise.reject({code:e._errorCode,message:e._getErrorString()});if(!t.isNumber(o))return t.Errors.MobileServer_InvalidHeight(e),t.Promise.reject({code:e._errorCode,message:e._getErrorString()});t.isUndefined(a)&&(a=5);var s=gc(),u=e._ImgManager.convertClientIndexToServerId(n);return s.context={},ni("",e),e._ImgManager.getWebViewer().GetImageData(e._ImgManager.getUidByIndex(n)).then((function(e){return s.context.metadata=e&&e.metadata?e.metadata:{},s.initImage(e.oriData)})).then((function(){var e=1==s.context.metadata.bitDepth;return s.resize(i,o,a,5,e)})).then((function(){return s.getImage()})).then((function(r){var n={src:r.imageData,imgType:t.MobileFuns.convertOutputType(r.imageType),dataType:"url",metadata:{imageData:r.imageData,width:r.imageWidth,height:r.imageHeight}};try{e._OnBitmapChanged(["10",""+u,4,e._ImgManager.getCurrentImageIndex(),e._ImgManager.count(),n])}catch(i){throw t.Errors.SystemExceptionError(e,i.message),0}})).then((function(){ii(""),s.terminate()}),(function(r){throw ii(""),r&&t.Errors.ChangeImageSizeFailed(e,r),s.terminate(),{code:e._errorCode,message:e._getErrorString()}}))}(i,n):"GetSkewAngleOnly"==r?function(e,r){var n=r[0],i=gc();e._ImgManager.convertClientIndexToServerId(n),i.context={},ni("",e);var o=e._ImgManager.getWebViewer().GetMinPageData();if(o)return i.initImage(o.data,!0,o.width,o.height).then((function(){return i.getSkewAngle()})).then((function(e){return ii(""),delete i.context,i.terminate(),e}),(function(r){throw ii(""),t.Errors.SkewAngleFailed(e,r),i.terminate(),{code:e._errorCode,message:e._getErrorString()}}))}(i,n):"GetSkewAngle"==r?function(e,r){var n=r[0],i=gc();return e._ImgManager.convertClientIndexToServerId(n),i.context={},ni("",e),e._ImgManager.getWebViewer().GetImageData(e._ImgManager.getUidByIndex(n)).then((function(e){return i.context.metadata=e&&e.metadata?e.metadata:{},i.initImage(e.oriData)})).then((function(){return i.getSkewAngle()})).then((function(e){return ii(""),delete i.context,i.terminate(),e}),(function(r){throw ii(""),t.Errors.SkewAngleFailed(e,r),i.terminate(),{code:e._errorCode,message:e._getErrorString()}}))}(i,n):"ConvertToGrayScale"==r?function(e,r){var n=r[0],i=gc(),o=e._ImgManager.convertClientIndexToServerId(n);return i.context={},ni("",e),e._ImgManager.getWebViewer().GetImageData(e._ImgManager.getUidByIndex(n)).then((function(e){return i.context.metadata=e&&e.metadata?e.metadata:{},i.initImage(e.oriData)})).then((function(){return i.toGrayscale()})).then((function(){return i.getImage()})).then((function(r){var n={src:r.imageData,imgType:t.MobileFuns.convertOutputType(r.imageType),dataType:"url",metadata:{imageData:r.imageData,width:r.imageWidth,height:r.imageHeight,bitDepth:8}};try{e._OnBitmapChanged(["10",""+o,4,e._ImgManager.getCurrentImageIndex(),e._ImgManager.count(),n])}catch(i){throw t.Errors.SystemExceptionError(e,i.message),0}})).then((function(){ii(""),i.terminate()}),(function(r){throw ii(""),r&&t.Errors.ConvertToGrayScaleFailed(e,r),i.terminate(),{code:e._errorCode,message:e._getErrorString()}}))}(i,n):"ConvertToBWScale"==r?function(e,r){var n=r[0],i=gc(),o=e._ImgManager.convertClientIndexToServerId(n);return i.context={},ni("",e),e._ImgManager.getWebViewer().GetImageData(e._ImgManager.getUidByIndex(n)).then((function(e){return i.context.metadata=e&&e.metadata?e.metadata:{},i.initImage(e.oriData)})).then((function(){return i.toBinary(!1,void 0)})).then((function(){return i.getImage()})).then((function(r){var n={src:r.imageData,imgType:t.MobileFuns.convertOutputType(r.imageType),dataType:"url",metadata:{imageData:r.imageData,width:r.imageWidth,height:r.imageHeight,bitDepth:1}};try{e._OnBitmapChanged(["10",""+o,4,e._ImgManager.getCurrentImageIndex(),e._ImgManager.count(),n])}catch(i){throw t.Errors.SystemExceptionError(e,i.message),0}})).then((function(){ii(""),i.terminate()}),(function(r){throw ii(""),r&&t.Errors.ConvertToBWScaleFailed(e,r),i.terminate(),{code:e._errorCode,message:e._getErrorString()}}))}(i,n):"SetDPI"==r?function(r,n){var i=n[0],o=n[1],a=n[2],s=n[3],u=n[4];if(!t.isNumber(o))return t.Errors.MobileServer_InvalidXResolution(r),t.Promise.reject({code:r._errorCode,message:r._getErrorString()});if(!t.isNumber(a))return t.Errors.MobileServer_InvalidYResolution(r),t.Promise.reject({code:r._errorCode,message:r._getErrorString()});t.isUndefined(u)&&(u=e.DWT.EnumDWT_InterpolationMethod.IM_BICUBIC);var c,l,d,h=gc(),g=r._ImgManager.convertClientIndexToServerId(i);return h.context={},c=r._ImgManager._UIView.GetMetaDataByIndex(i),l=c.resolutionX,d=c.resolutionY,ni("",r),r._ImgManager.getWebViewer().GetImageData(r._ImgManager.getUidByIndex(i)).then((function(e){return h.context.metadata=e&&e.metadata?e.metadata:{},h.initImage(e.oriData)})).then((function(){return h.setDPI(l,d,o,a,s,u)})).then((function(){return h.getImage()})).then((function(e){var n={src:e.imageData,imgType:t.MobileFuns.convertOutputType(e.imageType),dataType:"url",metadata:{imageData:e.imageData,width:e.imageWidth,height:e.imageHeight,resolutionX:o,resolutionY:a}};try{r._OnBitmapChanged(["10",""+g,4,r._ImgManager.getCurrentImageIndex(),r._ImgManager.count(),n])}catch(i){throw t.Errors.SystemExceptionError(r,i.message),0}})).then((function(){ii(""),h.terminate()}),(function(e){throw ii(""),e&&t.Errors.SetDPIFailed(r,e),h.terminate(),{code:r._errorCode,message:r._getErrorString()}}))}(i,n):"SetImageWidth"==r?function(e,r){var n=r[0],i=r[1];if(!t.isNumber(i))return t.Errors.MobileServer_InvalidWidth(e),t.Promise.reject({code:e._errorCode,message:e._getErrorString()});var o=gc(),a=e._ImgManager.convertClientIndexToServerId(n);return o.context={},ni("",e),e._ImgManager.getWebViewer().GetImageData(e._ImgManager.getUidByIndex(n)).then((function(e){return o.context.metadata=e&&e.metadata?e.metadata:{},o.initImage(e.oriData)})).then((function(){return o.setImageWidth(i)})).then((function(){return o.getImage()})).then((function(r){var n={src:r.imageData,imgType:t.MobileFuns.convertOutputType(r.imageType),dataType:"url",metadata:{imageData:r.imageData,width:r.imageWidth,height:r.imageHeight}};try{e._OnBitmapChanged(["10",""+a,4,e._ImgManager.getCurrentImageIndex(),e._ImgManager.count(),n])}catch(i){throw t.Errors.SystemExceptionError(e,i.message),0}})).then((function(){ii(""),o.terminate()}),(function(r){throw ii(""),r&&t.Errors.SetImageWidthFailed(e,r),o.terminate(),{code:e._errorCode,message:e._getErrorString()}}))}(i,n):"IsTextBasedPDF"==r?function(r,n){var i,o,a=n[0],s=e.DWT.EnumDWT_ImageType;if(a instanceof FileList?i=a[0]:a instanceof Blob?i=a:a instanceof ArrayBuffer||a instanceof Uint8Array?(i=new Blob([a]),o=qn(a)):i=a,t.isUndefined(o)&&(i.type?"application/pdf"==i.type&&(o=s.IT_PDF):o=ti.getImageType(i.name)),o==s.IT_PDF){var u=fc();return ni("",r),u.open(i,r._pdfPassword).then((function(e){return ii(""),u.close(),u.terminate(),e.isTextBased}),(function(e){throw ii(""),t.Errors.LoadImageFailed(r,e),u.close(),u.terminate(),{code:r._errorCode,message:r._getErrorString()}}))}return t.Errors.LoadImageFailed(r,"not pdf."),t.Promise.reject({code:r._errorCode,message:r._getErrorString()})}(i,n):"GetMD5"==r?function(e,r){var n=r[0],i=n;n instanceof FileList?i=n[0]:(n instanceof Uint8ClampedArray||n instanceof ArrayBuffer||n instanceof Uint8Array)&&(i=new Blob([n]));var o=hc();return o.getMD5(i).then((function(e){return o.terminate(),e}),(function(r){throw t.Errors.GetMD5Failed(e,r),o.terminate(),{code:e._errorCode,message:e._getErrorString()}}))}(i,n):"ChangeBrightness"==r?function(e,r){var n=r[0],i=r[1],o=gc(),a=e._ImgManager.convertClientIndexToServerId(n);return o.context={},ni("",e),t.log("[Wasm]Change Brightness: value "+i),e._ImgManager.getWebViewer().GetImageData(e._ImgManager.getUidByIndex(n)).then((function(e){return t.log("[Wasm]Change Brightness: get original image data"),o.context.metadata=e&&e.metadata?e.metadata:{},o.initImage(e.oriData)})).then((function(){return t.log("[Wasm]Change Brightness: change brightness"),o.changeBrightness(i)})).then((function(){return o.getImage()})).then((function(r){t.log("[Wasm]Change Brightness: change brightness successfully");var n={src:r.imageData,imgType:t.MobileFuns.convertOutputType(r.imageType),dataType:"url",metadata:{imageData:r.imageData,width:r.imageWidth,height:r.imageHeight,bitDepth:8}};try{e._OnBitmapChanged(["10",""+a,4,e._ImgManager.getCurrentImageIndex(),e._ImgManager.count(),n])}catch(i){throw t.Errors.SystemExceptionError(e,i.message),0}})).then((function(){ii(""),o.terminate()}),(function(r){throw ii(""),r&&t.Errors.ChangeBrightnessFailed(e,r),o.terminate(),{code:e._errorCode,message:e._getErrorString()}}))}(i,n):"ChangeContrast"==r?function(e,r){var n=r[0],i=r[1],o=gc(),a=e._ImgManager.convertClientIndexToServerId(n);return o.context={},ni("",e),e._ImgManager.getWebViewer().GetImageData(e._ImgManager.getUidByIndex(n)).then((function(e){return o.context.metadata=e&&e.metadata?e.metadata:{},o.initImage(e.oriData)})).then((function(){return o.changeContrast(i)})).then((function(){return o.getImage()})).then((function(r){var n={src:r.imageData,imgType:t.MobileFuns.convertOutputType(r.imageType),dataType:"url",metadata:{imageData:r.imageData,width:r.imageWidth,height:r.imageHeight,bitDepth:8}};try{e._OnBitmapChanged(["10",""+a,4,e._ImgManager.getCurrentImageIndex(),e._ImgManager.count(),n])}catch(i){throw t.Errors.SystemExceptionError(e,i.message),0}})).then((function(){ii(""),o.terminate()}),(function(r){throw ii(""),r&&t.Errors.ChangeContrastFailed(e,r),o.terminate(),{code:e._errorCode,message:e._getErrorString()}}))}(i,n):t.Promise.reject({code:-1e3,message:"invalid method: "+r}):t.Promise.reject(e.DWT.licenseException):i._serviceNotSupportAsync(r)}},{key:"_saveImageCallback",value:function(r){var n,i,o,a=this;if(!t.isArray(r))return t.Errors.InvalidSourceFile(a),t.Promise.reject({code:a._errorCode,message:a._getErrorString()});for(t.log("[Wasm]camera callback: save image"),o=r.length,n=t.Promise.resolve({aryData:r,curIndex:0,count:o}),i=0;i<o;i++)n=(n=n.then((function(r){var n,i,o,s,u,c,l;if(n=r.aryData[r.curIndex],r.bOneBit=!1,n){var d=n.iImageData;if(n.file,d instanceof Blob||d instanceof ArrayBuffer)return r.captureBlob=d,r;i=d.imageData,r.bOneBit=1==d.imageBitDepth}return i instanceof Blob||i instanceof ArrayBuffer?r.bOneBit&&(a._isTwainServiceType()||a._isDMServiceType())?(o=i,s=a,u=hc(),c=e.Enum_ReturnType.RT_BINARY,l=e.DWT.EnumDWT_ImageType.IT_PNG,u.saveImage(o,l,85,c,!0).then((function(e){return u&&u.terminate(),{blobData:e.imageData,type:"png",MD5:e.MD5}}),(function(e){throw t.Errors.SaveImageFailed(s,e),u&&u.terminate(),{code:s._errorCode,message:s._getErrorString()}}))).then((function(e){return r.captureBlob=e.blobData,r})):(r.captureBlob=i,r):(e.Lib.Errors.InvalidSourceFile(a),t.log("[Wasm]camera callback: save image error - page "+r.curIndex+" source invalid."),e.Lib.Promise.reject({code:a._errorCode,message:a._errorString}))}))).then((function(n){var i,o;return i=n.aryData[n.curIndex],r&&i&&(o=i.file),t.log("[Wasm]camera callback: save image - page "+n.curIndex+" data ready"),new e.Lib.Promise((function(r,i){var s=n.captureBlob,u=-1,c=e.DWT.EnumDWT_ImageType;if(a._isTwainServiceType()||a._isDMServiceType())e.Lib.isString(s.type)&&("application/pdf"==s.type?u=c.IT_PDF:"image/png"==s.type?u=c.IT_PNG:"image/jpeg"==s.type||"image/jpg"==s.type?u=c.IT_JPG:"image/bmp"==s.type?u=c.IT_BMP:"image/tiff"==s.type||"image/tif"==s.type?u=c.IT_TIF:"image/jp2"==s.type&&(u=c.IT_J2K)),a.__captureImage(s,u,(function(){t.log("[Wasm]camera callback: save image - page "+n.curIndex+" data saved from service"),n.curIndex=n.curIndex+1,n.captureBlob=null,r(n)}),(function(e,t){i({code:e,message:t})}));else{var l=a._innerGetCurrentDocumentName();""==l&&a._ImgManager&&(l=a._ImgManager.getWebViewer().GetDefaultFileName()),a._innerSendToMobile("LoadImageFromBinary",[s,3006,o,l,!0,n.bOneBit],0,(function(){t.log("[Wasm]camera callback: save image - page "+n.curIndex+" data saved"),n.curIndex=n.curIndex+1,n.captureBlob=null,r(n)}),(function(e,t){i({code:e,message:t})}))}}))}));return n}},{key:"_insertImageCallback",value:function(r,n,i){var o,a,s=this,u=n.oriData,c=!0;if(u&&(u instanceof Blob||u instanceof ArrayBuffer||u instanceof Uint8Array)&&(c=!1),!n||c)throw e.Lib.Errors.InvalidSourceFile(s),t.log("[Wasm]camera callback: save image error - source invalid."),{code:s._errorCode,message:s._errorString};(o=n.customData)&&(a=o.oriBlob)&&a.imageBitDepth,t.log("[Wasm]camera callback: save image - data ready");var l=_c();o.imageId=l,s._ImgManager.insertImage(r,n,i);var d=s._ImgManager.getWebViewer().GetUidByIndex(i);s._ImgManager.getView().innerInsertModel(l,d)}},{key:"_checkWebcamWasmLicense",value:function(){return t.License.checkCameraProductKey(this)?{errorCode:0}:e.DWT.licenseException}},{key:"GetRawDataAsync",value:function(e){var r=this;if(r._resetErr(),!r._isMobileMode())return r._serviceNotSupportAsync("GetRawDataAsync");var n,i=parseInt(e);return isNaN(i)?(t.Errors.InvalidIndex(r),t.Promise.reject({code:r._errorCode,message:r._errorString})):i<0||i>=r._ImgManager.count()?(t.Errors.IndexOutOfRange(r),t.Promise.reject({code:r._errorCode,message:r._errorString})):(r._viewer&&r._viewer._webViewer&&(n=r._viewer._webViewer.GetUidByIndex(i)),n?r._viewer._webViewer.GetImageData(n).then((function(e){var r={displayImage:{},documentData:{polygon:[],originImage:{}}};return e.oriData&&(r.displayImage.data=e.oriData),e.metadata&&(e.metadata.bitDepth&&(r.displayImage.bitDepth=e.metadata.bitDepth),e.metadata.height&&(r.displayImage.height=e.metadata.height),e.metadata.width&&(r.displayImage.width=e.metadata.width),e.metadata.resolutionX&&(r.displayImage.resolutionX=e.metadata.resolutionX),e.metadata.resolutionY&&(r.displayImage.resolutionY=e.metadata.resolutionY)),e.customData&&(t.isNumber(e.customData.angle)?r.documentData.angle=e.customData.angle:r.documentData.angle=0,e.customData.detectArea&&(r.documentData.polygon.push({x:e.customData.detectArea[0],y:e.customData.detectArea[1]}),r.documentData.polygon.push({x:e.customData.detectArea[2],y:e.customData.detectArea[3]}),r.documentData.polygon.push({x:e.customData.detectArea[4],y:e.customData.detectArea[5]}),r.documentData.polygon.push({x:e.customData.detectArea[6],y:e.customData.detectArea[7]})),e.customData.filterValue&&(r.documentData.filterValue=e.customData.filterValue),e.customData.oriBlob&&(e.customData.oriBlob.imageBitDepth&&(r.documentData.originImage.bitDepth=e.customData.oriBlob.imageBitDepth),e.customData.oriBlob.imageData&&(r.documentData.originImage.data=e.customData.oriBlob.imageData),e.customData.oriBlob.imageHeight&&(r.documentData.originImage.height=e.customData.oriBlob.imageHeight),e.customData.oriBlob.imageWidth&&(r.documentData.originImage.width=e.customData.oriBlob.imageWidth),e.customData.oriBlob.imageXResolution&&(r.documentData.originImage.resolutionX=e.customData.oriBlob.imageXResolution),e.customData.oriBlob.imageYResolution&&(r.documentData.originImage.resolutionY=e.customData.oriBlob.imageYResolution))),r})):Promise.resolve(null))}},{key:"SetRawDataAsync",value:function(e,r){var n=this;if(n._resetErr(),!n._isMobileMode())return n._serviceNotSupportAsync("GetRawDataAsync");var i,o=parseInt(e);if(isNaN(o))return t.Errors.InvalidIndex(n),t.Promise.reject({code:n._errorCode,message:n._errorString});if(o<0||o>=n._ImgManager.count())return t.Errors.IndexOutOfRange(n),t.Promise.reject({code:n._errorCode,message:n._errorString});if(n._viewer&&n._viewer._webViewer&&(i=n._viewer._webViewer.GetUidByIndex(o))){var a=n._viewer._webViewer.mydvs;if(a){var s=r.displayImage.data;delete r.displayImage.data;var u={oriData:s,metadata:r.displayImage,customData:{}};r.documentData&&(t.isNumber(r.documentData.angle)?u.customData.angle=r.documentData.angle:u.customData.angle=0,r.documentData.polygon&&4==r.documentData.polygon.length&&(u.customData.detectArea=[r.documentData.polygon[0].x,r.documentData.polygon[0].y,r.documentData.polygon[1].x,r.documentData.polygon[1].y,r.documentData.polygon[2].x,r.documentData.polygon[2].y,r.documentData.polygon[3].x,r.documentData.polygon[3].y]),r.documentData.filterValue&&(u.customData.filterValue=r.documentData.filterValue),r.documentData.originImage&&(u.customData.oriBlob={},r.documentData.originImage.bitDepth&&(u.customData.oriBlob.imageBitDepth=r.documentData.originImage.bitDepth),r.documentData.originImage.data&&(u.customData.oriBlob.imageData=r.documentData.originImage.data),r.documentData.originImage.height&&(u.customData.oriBlob.imageHeight=r.documentData.originImage.height),r.documentData.originImage.width&&(u.customData.oriBlob.imageWidth=r.documentData.originImage.width),u.customData.oriBlob.imageXResolution&&(u.customData.oriBlob.imageXResolution=r.documentData.originImage.resolutionX),r.documentData.originImage.resolutionY&&(u.customData.oriBlob.imageYResolution=r.documentData.originImage.resolutionY)));var c=a.DataControl.updateSync(i,u,!0);return Promise.resolve(c)}}return Promise.resolve(null)}},{key:"GetImageDataAsync",value:function(e){var t,r=this;return r._viewer&&r._viewer._webViewer&&(t=r._viewer._webViewer.GetUidByIndex(e)),t?r._viewer._webViewer.GetImageData(t):Promise.resolve(null)}},{key:"SetCustomDataAsync",value:function(e,t){var r,n=this;return n._viewer&&n._viewer._webViewer&&(r=n._viewer._webViewer.GetUidByIndex(e)),r&&t?n._viewer._webViewer.GetImageData(r).then((function(e){return e.customData=t,n._viewer._webViewer.UpdateImageData(r,e)})):Promise.resolve(!1)}},{key:"HttpFieldNameOfUploadedImage",get:function(){return this._resetErr(),!!this._isValid()&&this.__remoteFilename},set:function(e){this._resetErr(),this._isValid()&&(this.__remoteFilename=e)}},{key:"style",get:function(){return this.__style}},{key:"IfShowProgressBar",get:function(){return this._resetErr(),!!this._isValid()&&this.__IfShowProgressBar},set:function(e){this._resetErr(),this._isValid()&&(t.isBoolean(e)?this.__IfShowProgressBar=e:t.Errors.InvalidValue(this))}},{key:"getInstance",value:function(){return this}}]),i}(kl);function Ol(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(es){return!1}}();return function(){var r,n=et(e);if(t){var i=et(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return $e(this,r)}}function Rl(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function Ul(e,t,r){if(!t.has(e));return r}var Gl=new WeakSet,jl=new WeakSet,zl=new WeakSet,Hl=new WeakSet,Xl=new WeakSet,Yl=new WeakSet,Jl=new WeakSet,Kl=new WeakSet,Zl=function(r){Qe(i,r);var n=Ol(i);function i(){var e;Le(this,i);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return Rl(Ze(e=n.call.apply(n,[this].concat(r))),Kl),Rl(Ze(e),Jl),Rl(Ze(e),Yl),Rl(Ze(e),Xl),Rl(Ze(e),Hl),Rl(Ze(e),zl),Rl(Ze(e),jl),Rl(Ze(e),Gl),e}return Ae(i,[{key:"BindViewer",value:function(e){return this._innerBindViewer(e)}},{key:"UnbindViewer",value:function(){return this._innerUnbindViewer()}},{key:"AddText",value:function(e,r,n,i,o,a,s,u){var c=this;if(c._isMobileMode())return c._mobileNotSupport("AddText");var l=parseInt(e);if(!hi(c,l))return!1;var d=t.RGB2BGR(o),h=t.RGB2BGR(a),g=c._ImgManager.convertClientIndexToServerId(l);return-1==g?(t.Errors.IndexOutOfRange(c),!1):c._innerFun("AddText",Zn(g,r,n,i,d,h,s,u))}},{key:"CreateTextFont",value:function(e,t,r,n,i,o,a,s,u,c,l,d,h,g){var f=this;return f._resetErr(),!!f._isValid()&&(f._isMobileMode()?f._mobileNotSupport("CreateTextFont"):this._innerFun("CreateTextFont",Zn(e,t,r,n,i,o,a,s,u,c,l,d,h,g)))}},{key:"CopyToClipboard",value:function(e){var t=this;if(t._isMobileMode())return t._mobileNotSupport("CopyToClipboard");var r=parseInt(e);return!!hi(t,r)&&od(t,"CopyToClipboard",r,null,null,!1,!1)}},{key:"CopyToClipboardAsync",value:function(e){var r=this;if(r._resetErr(),!r._isValid())return t.Promise.reject({code:r._errorCode,message:r._errorString});if(r._isMobileMode())return r._mobileNotSupportAsync("CopyToClipboardAsync");var n=parseInt(e);return isNaN(n)?(t.Errors.InvalidIndex(r),t.Promise.reject({code:r._errorCode,message:r._errorString})):n<0||n>=r._ImgManager.count()?(t.Errors.IndexOutOfRange(r),t.Promise.reject({code:r._errorCode,message:r._errorString})):function(e,r,n){var i=e._ImgManager.convertClientIndexToServerId(n);if(-1==i)return t.Errors.IndexOutOfRange(e),t.Promise.reject({code:e._errorCode,message:e._errorString});return e._innerFunV2(r,Zn(i))}(r,"CopyToClipboard",n)}},{key:"Erase",value:function(e,r,n,i,o,a,s){var u,c=this,l=parseInt(e);if(!hi(c,l,s))return!1;if(c._isMobileMode())return c._ImgManager.getView().GetWebViewer().clearSelectedAreas(),Ul(c,Gl,ql).call(c,l,r,n,i,o,a,s);var d=c._ImgManager.convertClientIndexToServerId(l);return-1==d?(t.Errors.IndexOutOfRange(c),t.isFunction(s)&&s(c._errorCode,c._getErrorString()),!1):(c._ImgManager.getView().GetWebViewer().clearSelectedAreas(),(u=1==c._innerFun("Erase",Zn(d,r,n,i,o)))?t.isFunction(a)&&a():t.isFunction(s)&&s(c._errorCode,c._getErrorString()),u)}},{key:"GetImageBitDepth",value:function(e){var r=this,n=parseInt(e);if(!hi(r,n))return!1;if(r._isMobileMode()){var i=r._ImgManager._UIView.GetMetaDataByIndex(n);return parseInt(i.bitDepth)}var o=r._ImgManager.convertClientIndexToServerId(n);return-1==o?(t.Errors.IndexOutOfRange(r),!1):r._innerFun("GetImageBitDepth",Zn(o))}},{key:"GetImageWidth",value:function(e){var r=this;if(r._resetErr(),!r._isValid())return!1;var n=parseInt(e);if(isNaN(n))return t.Errors.InvalidIndex(r),-1;if(n<0||n>=r._ImgManager.count())return t.Errors.IndexOutOfRange(r),-1;if(r._isMobileMode()){var i=r._ImgManager._UIView.GetMetaDataByIndex(n);return parseInt(i.width)}var o=r._ImgManager.convertClientIndexToServerId(n);return-1==o?(t.Errors.IndexOutOfRange(r),-1):r._innerFun("GetImageWidth",Zn(o))}},{key:"GetImageHeight",value:function(e){var r=this;if(r._resetErr(),!r._isValid())return!1;var n=parseInt(e);if(isNaN(n))return t.Errors.InvalidIndex(r),-1;if(n<0||n>=r._ImgManager.count())return t.Errors.IndexOutOfRange(r),-1;if(r._isMobileMode()){var i=r._ImgManager._UIView.GetMetaDataByIndex(n);return parseInt(i.height)}var o=r._ImgManager.convertClientIndexToServerId(n);return-1==o?(t.Errors.IndexOutOfRange(r),-1):r._innerFun("GetImageHeight",Zn(o))}},{key:"GetImageSize",value:function(e,r,n){var i=this;if(i._resetErr(),!i._isValid())return!1;if(i._isMobileMode())return i._mobileNotSupport("GetImageSize");var o=parseInt(e);if(isNaN(o))return t.Errors.InvalidIndex(i),-1;if(o<0||o>=i._ImgManager.count())return t.Errors.IndexOutOfRange(i),-1;var a=i._ImgManager.convertClientIndexToServerId(o);return-1==a?(t.Errors.IndexOutOfRange(i),-1):i._innerFun("GetImageSize",Zn(a,r,n))}},{key:"GetImageSizeWithSpecifiedType",value:function(e,r){var n=this;if(n._resetErr(),!n._isValid())return!1;if(n._isMobileMode())return n._mobileNotSupport("GetImageSizeWithSpecifiedType");var i=parseInt(e);if(isNaN(i))return t.Errors.InvalidIndex(n),-1;if(i<0||i>=n._ImgManager.count())return t.Errors.IndexOutOfRange(n),-1;var o=n._ImgManager.convertClientIndexToServerId(i);return-1==o?(t.Errors.IndexOutOfRange(n),-1):n._innerFun("GetImageSizeWithSpecifiedType",Zn(o,r))}},{key:"GetImageXResolution",value:function(e){var r=this,n=parseInt(e);if(!hi(r,n))return!1;if(r._isMobileMode()){var i=r._ImgManager._UIView.GetMetaDataByIndex(n);return parseInt(i.resolutionX)}var o=r._ImgManager.convertClientIndexToServerId(n);return-1==o?(t.Errors.IndexOutOfRange(r),!1):r._innerFun("GetImageXResolution",Zn(o))}},{key:"GetImageYResolution",value:function(e){var r=this,n=parseInt(e);if(!hi(r,n))return!1;if(r._isMobileMode()){var i=r._ImgManager._UIView.GetMetaDataByIndex(n);return parseInt(i.resolutionY)}var o=r._ImgManager.convertClientIndexToServerId(n);return-1==o?(t.Errors.IndexOutOfRange(r),!1):r._innerFun("GetImageYResolution",Zn(o))}},{key:"SelectAllImages",value:function(){var e,t=this,r=t.HowManyImagesInBuffer,n=[];if(t._resetErr(),!t._isValid())return!1;for(e=0;e<r;e++)n.push(e);return t._ImgManager.SetSelectedClientIndexArray(n),n}},{key:"SelectImages",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&t._ImgManager.SetSelectedClientIndexArray(e)}},{key:"_asyncGetSkewAngleOnly",value:function(e,r,n){var i=this,o=parseInt(e);return i._innerSendToMobile("GetSkewAngleOnly",Kn(o),0,(function(n){ti.refreshImageAfterInvokeFun(i,e),t.isFunction(r)&&setTimeout((function(){r(n)}),30)}),(function(){t.isFunction(n)&&n(i._errorCode,i._getErrorString())}))}},{key:"GetSkewAngle",value:function(e,r,n){var i,o=this,a=parseInt(e);return!!hi(o,a,n)&&(o._isMobileMode()?Ul(o,jl,Ql).call(o,a,r,n):(i=od(o,"GetSkewAngle",a,r,n,!0,!1),0==o._errorCode?(ti.refreshImageAfterInvokeFun(o,a),t.isFunction(r)&&r(i),i):(t.isFunction(n)&&n(o._errorCode,o._errorString),0)))}},{key:"GetSkewAngleAsync",value:function(e){var r=this;if(r._resetErr(),!r._isValid())return t.Promise.reject({code:r._errorCode,message:r._errorString});var n=parseInt(e);if(isNaN(n))return t.Errors.InvalidIndex(r),t.Promise.reject({code:r._errorCode,message:r._errorString});if(n<0||n>=r._ImgManager.count())return t.Errors.IndexOutOfRange(r),t.Promise.reject({code:r._errorCode,message:r._errorString});if(r._isMobileMode())return r._innerSendToMobileV2("GetSkewAngle",Kn(n)).then((function(e){ti.refreshImageAfterInvokeFun(r,n)}));var i=r._ImgManager.convertClientIndexToServerId(n);return-1==i?(t.Errors.IndexOutOfRange(r),t.Promise.reject({code:r._errorCode,message:r._errorString})):r._innerFunV2("GetSkewAngle",Zn(i)).then((function(e){var i=e;return t.isArray(e)&&(i=e.length>0?e[0]:0),ti.refreshImageAfterInvokeFun(r,n),i}))}},{key:"GetSkewAngleEx",value:function(e,r,n,i,o){var a=this;if(a._isMobileMode())return a._mobileNotSupport("GetSkewAngleEx");var s=parseInt(e);if(!hi(a,s))return!1;var u=a._ImgManager.convertClientIndexToServerId(s);return-1==u?(t.Errors.IndexOutOfRange(a),!1):a._innerFun("GetSkewAngleEx",Zn(u,r,n,i,o))}},{key:"IsBlankImageEx",value:function(e,r,n,i,o,a){var s,u=this;if(u._isMobileMode())return u._mobileNotSupport("IsBlankImageEx");if(!hi(u,s=parseInt(e)))return!1;var c=u._ImgManager.convertClientIndexToServerId(s);return-1==c?(t.Errors.IndexOutOfRange(u),!1):u._innerFun("IsBlankImageEx",Zn(c,r,n,i,o,a))}},{key:"MirrorAsync",value:function(e){var r=this;if(r._resetErr(),!r._isValid())return t.Promise.reject({code:r._errorCode,message:r._errorString});var n=parseInt(e);if(isNaN(n))return t.Errors.InvalidIndex(r),t.Promise.reject({code:r._errorCode,message:r._errorString});if(n<0||n>=r._ImgManager.count())return t.Errors.IndexOutOfRange(r),t.Promise.reject({code:r._errorCode,message:r._errorString});if(r._isMobileMode())return r._innerSendToMobileV2("Mirror",Kn(n)).then((function(){ti.refreshImageAfterInvokeFun(r,n),r._ImgManager._UIView.GetWebViewer().clearSelectedAreas()}));var i=r._ImgManager.convertClientIndexToServerId(n);return-1==i?(t.Errors.IndexOutOfRange(r),t.Promise.reject({code:r._errorCode,message:r._errorString})):r._innerFunV2("Mirror",Zn(i)).then((function(e){if(1!=e)throw{code:r._errorCode,message:r._errorString};ti.refreshImageAfterInvokeFun(r,n),r._ImgManager._UIView.GetWebViewer().clearSelectedAreas()}))}},{key:"Mirror",value:function(e,r,n){var i=this,o=parseInt(e);return!!hi(i,o,n)&&(i._isMobileMode()?(i._innerSendToMobileV2("Mirror",Kn(o)).then((function(){ti.refreshImageAfterInvokeFun(i,o),i._ImgManager._UIView.GetWebViewer().clearSelectedAreas(),r&&r()}),(function(){t.isFunction(n)&&n(i._errorCode,i._getErrorString())})),!0):od(i,"Mirror",o,r,n,!1,!0))}},{key:"_innerRemoveImage",value:function(e,t){var r=this,n=r._ImgManager.convertClientIndexToServerIdInFile(e,t);r._OnBitmapChanged(["10",""+n,3,r._ImgManager.getCurrentImageIndex(),r._ImgManager.count()],null,e)}},{key:"RemoveAllImagesAsync",value:function(){var e=this;if(e._resetErr(),!e._isValid())return t.Promise.reject({code:e._errorCode,message:e._errorString});var r=e._ImgManager.GetCurrentTag();if(""==r||"All"==r)return e._isMobileMode()?(e._OnBitmapChanged(["10","-1",3,-1,0]),t.Promise.resolve(!0)):e._innerFunV2("RemoveAllImages").then((function(t){return!(!t&&-1033!=e._errorCode)&&(e._OnBitmapChanged(["0","-1",3,-1,0]),!0)}));var n,i,o=[],a=e.HowManyImagesInBuffer;for(n=0;n<a;n++){var s=e._ImgManager.convertClientIndexToServerId(n);s>-1&&o.push(s)}if(e._isMobileMode())i=t.Promise.resolve(o.join(","));else{var u=[];for(i=t.Promise.resolve(0),n=0;n<o.length;n++)i=i.then((function(t){return e._innerFunRawV2("RemoveImage",Zn(o[t])).then((function(r){return(r||-1033==e._errorCode)&&u.push(o[t]),t++}))}));i=i.then((function(){return u.join(",")}))}return i.then((function(t){var r="0";e._isMobileMode()&&(r="10"),""!=t&&e._OnBitmapChanged([r,t,3,e._ImgManager.getCurrentImageIndex(),e._ImgManager.count()])}))}},{key:"RemoveImageAsync",value:function(e){var r=this;if(r._resetErr(),!r._isValid())return t.Promise.reject({code:r._errorCode,message:r._errorString});var n=parseInt(e);if(isNaN(n))return t.Errors.InvalidIndex(r),t.Promise.reject({code:r._errorCode,message:r._errorString});if(n<0||n>=r._ImgManager.count())return t.Errors.IndexOutOfRange(r),t.Promise.reject({code:r._errorCode,message:r._errorString});var i=r._ImgManager.convertClientIndexToServerId(n);return-1==i?(t.Errors.IndexOutOfRange(r),t.Promise.reject({code:r._errorCode,message:r._errorString})):r._isMobileMode()?(r._OnBitmapChanged(["10",""+i,3,r._ImgManager.getCurrentImageIndex(),r._ImgManager.count()]),t.Promise.resolve(!0)):r._innerFunV2("RemoveImage",Zn(i)).then((function(e){return!(!e&&-1033!=r._errorCode)&&(r._OnBitmapChanged(["0",""+i,3,r._ImgManager.getCurrentImageIndex(),r._ImgManager.count()]),!0)}))}},{key:"Rotate",value:function(e,t,r,n,i){return this.RotateEx(e,t,r,-1,n,i)}},{key:"RotateEx",value:function(e,r,n,i,o,a){var s=this;if(s._resetErr(),!s._isValid())return!1;var u,c=parseInt(e);if(isNaN(c))return t.Errors.InvalidIndex(s),t.isFunction(a)&&a(s._errorCode,s._getErrorString()),!1;if(c<0||c>=s._ImgManager.count())return t.Errors.IndexOutOfRange(s),t.isFunction(a)&&a(s._errorCode,s._getErrorString()),!1;if(s._isMobileMode())return Ul(s,zl,$l).call(s,c,r,n,i).then(o,(function(){t.isFunction(a)&&a(s._errorCode,s._getErrorString())})),!0;var l=s._ImgManager.convertClientIndexToServerId(c);return-1==l?(t.Errors.IndexOutOfRange(s),t.isFunction(a)&&a(s._errorCode,s._getErrorString()),!1):((u=1==s._innerFun("RotateEx",Zn(l,r,n,i)))?(ti.refreshImageAfterInvokeFun(s,c),s._ImgManager._UIView.GetWebViewer().clearSelectedAreas(),t.isFunction(o)&&o()):t.isFunction(a)&&a(s._errorCode,s._getErrorString()),u)}},{key:"RotateLeft",value:function(e,t,r){return this.RotateEx(e,-90,!0,-1,t,r)}},{key:"RotateRight",value:function(e,t,r){return this.RotateEx(e,90,!0,-1,t,r)}},{key:"RotateAsync",value:function(e,t,r){return this.RotateExAsync(e,t,r,-1)}},{key:"RotateExAsync",value:function(e,r,n,i){var o=this;if(o._resetErr(),!o._isValid())return t.Promise.reject({code:o._errorCode,message:o._errorString});var a=parseInt(e);if(isNaN(a))return t.Errors.InvalidIndex(o),t.Promise.reject({code:o._errorCode,message:o._errorString});if(a<0||a>=o._ImgManager.count())return t.Errors.IndexOutOfRange(o),t.Promise.reject({code:o._errorCode,message:o._errorString});if(o._isMobileMode())return Ul(o,zl,$l).call(o,a,r,n,i);var s=o._ImgManager.convertClientIndexToServerId(a);return-1==s?(t.Errors.IndexOutOfRange(o),t.Promise.reject({code:o._errorCode,message:o._errorString})):o._innerFunV2("RotateEx",Zn(s,r,n,i)).then((function(e){if(1!=e)throw{code:o._errorCode,message:o._errorString};ti.refreshImageAfterInvokeFun(o,a),o._ImgManager._UIView.GetWebViewer().clearSelectedAreas()}))}},{key:"RotateLeftAsync",value:function(e){return this.RotateExAsync(e,-90,!0,-1)}},{key:"RotateRightAsync",value:function(e){return this.RotateExAsync(e,90,!0,-1)}},{key:"ChangeImageSize",value:function(e,r,n,i,o,a){var s,u=this,c=parseInt(e),l=1*r,d=1*n;if(!hi(u,c,a))return!1;if(l<=0||d<=0)return t.Errors.InvalidWidthOrHeight(u),t.isFunction(a)&&a(u._errorCode,u._getErrorString()),!1;if(u._isMobileMode())return Ul(u,Hl,ed).call(u,c,r,n,i).then(o,(function(){t.isFunction(a)&&a(u._errorCode,u._getErrorString())})),!0;var h=u._ImgManager.convertClientIndexToServerId(c);return-1==h?(t.Errors.IndexOutOfRange(u),t.isFunction(a)&&a(u._errorCode,u._getErrorString()),!1):((s=1==u._innerFun("ChangeImageSize",Zn(h,l,d,i)))?(ti.refreshImageAfterInvokeFun(u,c),t.isFunction(o)&&o()):t.isFunction(a)&&a(u._errorCode,u._getErrorString()),s)}},{key:"ChangeImageSizeAsync",value:function(e,r,n,i){var o=this,a=parseInt(e),s=1*r,u=1*n;if(o._resetErr(),!o._isValid())return t.Promise.reject({code:o._errorCode,message:o._errorString});if(isNaN(a))return t.Errors.InvalidIndex(o),t.Promise.reject({code:o._errorCode,message:o._errorString});if(a<0||a>=o._ImgManager.count())return t.Errors.IndexOutOfRange(o),t.Promise.reject({code:o._errorCode,message:o._errorString});if(s<=0||u<=0)return t.Errors.InvalidWidthOrHeight(o),t.Promise.reject({code:o._errorCode,message:o._errorString});if(o._isMobileMode())return Ul(o,Hl,ed).call(o,a,r,n,i);var c=o._ImgManager.convertClientIndexToServerId(a);return-1==c?(t.Errors.IndexOutOfRange(o),t.Promise.reject({code:o._errorCode,message:o._errorString})):o._innerFunV2("ChangeImageSize",Zn(c,s,u,i)).then((function(e){if(1!=e)throw{code:o._errorCode,message:o._errorString};ti.refreshImageAfterInvokeFun(o,a)}))}},{key:"Flip",value:function(e,r,n){var i=this,o=parseInt(e);return!!hi(i,o,n)&&(i._isMobileMode()?(Ul(i,Xl,td).call(i,o).then(r,(function(){t.isFunction(n)&&n(i._errorCode,i._getErrorString())})),!0):od(i,"Flip",o,r,n,!1,!0))}},{key:"FlipAsync",value:function(e){var r=this;if(r._resetErr(),!r._isValid())return t.Promise.reject({code:r._errorCode,message:r._errorString});var n=parseInt(e);if(isNaN(n))return t.Errors.InvalidIndex(r),t.Promise.reject({code:r._errorCode,message:r._errorString});if(n<0||n>=r._ImgManager.count())return t.Errors.IndexOutOfRange(r),t.Promise.reject({code:r._errorCode,message:r._errorString});if(r._isMobileMode())return Ul(r,Xl,td).call(r,n);var i=r._ImgManager.convertClientIndexToServerId(n);return-1==i?(t.Errors.IndexOutOfRange(r),t.Promise.reject({code:r._errorCode,message:r._errorString})):r._innerFunV2("Flip",Zn(i)).then((function(e){if(1!=e)throw{code:r._errorCode,message:r._errorString};ti.refreshImageAfterInvokeFun(r,n),r._ImgManager._UIView.GetWebViewer().clearSelectedAreas()}))}},{key:"Crop",value:function(e,r,n,i,o,a,s){var u,c=this,l=parseInt(e);if(!hi(c,l,s))return!1;if(c._isMobileMode())return Ul(c,Yl,rd).call(c,l,r,n,i,o).then(a,(function(){t.isFunction(s)&&s(c._errorCode,c._getErrorString())})),!0;var d,h,g=c._ImgManager.convertClientIndexToServerId(l);return-1==g?(t.Errors.IndexOutOfRange(c),t.isFunction(s)&&s(c._errorCode,c._getErrorString()),!1):(u=1==c._innerFun("Crop",Zn(g,r,n,i,o)),d=c._errorCode,h=c._getErrorString(),c._ImgManager.getView().GetWebViewer().clearSelectedAreas(),c._errorCode=d,c._errorString=h,u?(ti.refreshImageAfterInvokeFun(c,l),t.isFunction(a)&&a()):t.isFunction(s)&&s(d,h),u)}},{key:"CropAsync",value:function(e,r,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return t.Promise.reject({code:a._errorCode,message:a._errorString});var s=parseInt(e);if(isNaN(s))return t.Errors.InvalidIndex(a),t.Promise.reject({code:a._errorCode,message:a._errorString});if(s<0||s>=a._ImgManager.count())return t.Errors.IndexOutOfRange(a),t.Promise.reject({code:a._errorCode,message:a._errorString});if(a._isMobileMode())return Ul(a,Yl,rd).call(a,s,r,n,i,o);var u=a._ImgManager.convertClientIndexToServerId(s);return-1==u?(t.Errors.IndexOutOfRange(a),t.Promise.reject({code:a._errorCode,message:a._errorString})):a._innerFunV2("Crop",Zn(u,r,n,i,o)).then((function(e){var t,r;if(t=a._errorCode,r=a._getErrorString(),a._ImgManager.getView().GetWebViewer().clearSelectedAreas(),a._errorCode=t,a._errorString=r,1!=e)throw{code:a._errorCode,message:a._errorString};return ti.refreshImageAfterInvokeFun(a,s),!0}))}},{key:"CropToClipboard",value:function(e,r,n,i,o){var a=this;if(a._isMobileMode())return a._mobileNotSupport("CropToClipboard");var s,u=parseInt(e);if(!hi(a,u))return!1;var c=a._ImgManager.convertClientIndexToServerId(u);return-1==c?(t.Errors.IndexOutOfRange(a),!1):(a._ImgManager.getView().GetWebViewer().clearSelectedAreas(),(s=1==a._innerFun("CropToClipboard",Zn(c,r,n,i,o)))&&ti.refreshImageAfterInvokeFun(a,u),s)}},{key:"CutFrameToClipboard",value:function(e,r,n,i,o){var a=this;if(a._isMobileMode())return a._mobileNotSupport("CutFrameToClipboard");var s,u=parseInt(e);if(!hi(a,u))return!1;var c=a._ImgManager.convertClientIndexToServerId(u);return-1==c?(t.Errors.IndexOutOfRange(a),!1):(a._ImgManager.getView().GetWebViewer().clearSelectedAreas(),(s=1==a._innerFun("CutFrameToClipboard",Zn(c,r,n,i,o)))&&ti.refreshImageAfterInvokeFun(a,u),s)}},{key:"CutToClipboard",value:function(e){var r=this;if(r._isMobileMode())return r._mobileNotSupport("CutToClipboard");var n,i=parseInt(e);if(!hi(r,i))return!1;var o=r._ImgManager.convertClientIndexToServerId(i);return-1==o?(t.Errors.IndexOutOfRange(r),!1):((n=1==r._innerFun("CutToClipboard",Zn(o)))&&r._OnBitmapChanged(["0",""+o,3,r._ImgManager.getCurrentImageIndex(),r._ImgManager.count()]),n)}},{key:"CutFrameToClipboardAsync",value:function(e,r,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return t.Promise.reject({code:a._errorCode,message:a._errorString});if(a._isMobileMode())return a._mobileNotSupportAsync("CutFrameToClipboardAsync");var s=parseInt(e);if(isNaN(s))return t.Errors.InvalidIndex(a),t.Promise.reject({code:a._errorCode,message:a._errorString});if(s<0||s>=a._ImgManager.count())return t.Errors.IndexOutOfRange(a),t.Promise.reject({code:a._errorCode,message:a._errorString});var u=a._ImgManager.convertClientIndexToServerId(s);return-1==u?(t.Errors.IndexOutOfRange(a),t.Promise.reject({code:a._errorCode,message:a._errorString})):a._innerFunV2("CutFrameToClipboard",Zn(u,r,n,i,o)).then((function(e){var t=1==e;if(!t)throw{code:a._errorCode,message:a._errorString};return ti.refreshImageAfterInvokeFun(a,s),t}))}},{key:"CropToClipboardAsync",value:function(e,r,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return t.Promise.reject({code:a._errorCode,message:a._errorString});if(a._isMobileMode())return a._mobileNotSupportAsync("CropToClipboardAsync");var s=parseInt(e);if(isNaN(s))return t.Errors.InvalidIndex(a),t.Promise.reject({code:a._errorCode,message:a._errorString});if(s<0||s>=a._ImgManager.count())return t.Errors.IndexOutOfRange(a),t.Promise.reject({code:a._errorCode,message:a._errorString});var u=a._ImgManager.convertClientIndexToServerId(s);return-1==u?(t.Errors.IndexOutOfRange(a),t.Promise.reject({code:a._errorCode,message:a._errorString})):a._innerFunV2("CropToClipboard",Zn(u,r,n,i,o)).then((function(e){var t=1==e;if(!t)throw{code:a._errorCode,message:a._errorString};return ti.refreshImageAfterInvokeFun(a,s),t}))}},{key:"CutToClipboardAsync",value:function(e){var r=this;if(r._resetErr(),!r._isValid())return t.Promise.reject({code:r._errorCode,message:r._errorString});if(r._isMobileMode())return r._mobileNotSupportAsync("CutToClipboardAsync");var n=parseInt(e);if(isNaN(n))return t.Errors.InvalidIndex(r),t.Promise.reject({code:r._errorCode,message:r._errorString});if(n<0||n>=r._ImgManager.count())return t.Errors.IndexOutOfRange(r),t.Promise.reject({code:r._errorCode,message:r._errorString});var i=r._ImgManager.convertClientIndexToServerId(n);return-1==i?(t.Errors.IndexOutOfRange(r),t.Promise.reject({code:r._errorCode,message:r._errorString})):r._innerFunV2("CutToClipboard",Zn(i)).then((function(e){var t=1==e;if(!t)throw{code:r._errorCode,message:r._errorString};return r._OnBitmapChanged(["0",""+i,3,r._ImgManager.getCurrentImageIndex(),r._ImgManager.count()]),t}))}},{key:"SetDPI",value:function(e,r,n,i,o,a,s){var u,c=this,l=parseInt(e);if(!hi(c,l,s))return!1;var d=c._ImgManager.convertClientIndexToServerId(l);return-1==d?(t.Errors.IndexOutOfRange(c),t.isFunction(s)&&s(c._errorCode,c._getErrorString()),!1):c._isMobileMode()?Ul(c,Jl,nd).call(c,l,d,r,n,i,o,a,s):((u=1==c._innerFun("SetDPI",Zn(d,r,n,i,o)))?t.isFunction(a)&&a():t.isFunction(s)&&s(c._errorCode,c._getErrorString()),u)}},{key:"MoveImage",value:function(e,r){var n=this;if(n._resetErr(),!n._isValid())return!1;var i=parseInt(e),o=parseInt(r);return isNaN(i)||isNaN(o)?(t.Errors.InvalidIndex(n),!1):i<0||i>=n._ImgManager.count()||o<0||o>=n._ImgManager.count()?(t.Errors.IndexOutOfRange(n),!1):n._ImgManager.MoveImage(i,o)}},{key:"SwitchImage",value:function(e,r){var n=this;if(n._resetErr(),!n._isValid())return!1;var i=parseInt(e),o=parseInt(r);return isNaN(i)||isNaN(o)?(t.Errors.InvalidIndex(n),!1):i<0||i>=n._ImgManager.count()||o<0||o>=n._ImgManager.count()?(t.Errors.IndexOutOfRange(n),!1):n._ImgManager.SwitchImage(i,o)}},{key:"CloseWorkingProcess",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&(e._isMobileMode()?e._mobileNotSupport("CloseWorkerProcess"):e._innerFun("CloseWorkerProcess"))}},{key:"RemoveAllSelectedImages",value:function(){var e=this,r=e._isMobileMode();if(e._resetErr(),!e._isValid())return!1;var n=!0,i=e._ImgManager.getCurrentImageIndex(),o=e._ImgManager.getSelectedClientIndexArray(),a=[];if(t.isArray(o)&&t.each(o,(function(t){var r=e._ImgManager.convertClientIndexToServerId(t);-1!=r&&a.push(r)})),0==a.length&&i>=0){var s=e._ImgManager.convertClientIndexToServerId(i);a.push(s)}return r||(n=e._innerFun("RemoveAllSelectedImages",Zn(a.join(",")))),n&&(r||(e._HowManyImagesInBuffer=e._innerFun("HowManyImagesInBuffer")),t.each(a,(function(t){var r="0";e._isMobileMode()&&(r="10"),e._OnBitmapChanged([r,""+t,3,e._ImgManager.getCurrentImageIndex(),e._ImgManager.count()])}))),n}},{key:"RemoveAllSelectedImagesAsync",value:function(){var e=this,r=e._isMobileMode();if(e._resetErr(),!e._isValid())return t.Promise.reject({code:e._errorCode,message:e._errorString});var n=e._ImgManager.getCurrentImageIndex(),i=e._ImgManager.getSelectedClientIndexArray(),o=[];if(t.isArray(i)&&t.each(i,(function(t){var r=e._ImgManager.convertClientIndexToServerId(t);-1!=r&&o.push(r)})),0==o.length&&n>=0){var a=e._ImgManager.convertClientIndexToServerId(n);o.push(a)}return(r?t.Promise.resolve(!0):e._innerFunV2("RemoveAllSelectedImages",Zn(o.join(","))).then((function(t){return t&&e._innerFunV2("HowManyImagesInBuffer").then((function(t){return e._HowManyImagesInBuffer=t,!0}))}))).then((function(r){r&&t.each(o,(function(t){var r="0";e._isMobileMode()&&(r="10"),e._OnBitmapChanged([r,""+t,3,e._ImgManager.getCurrentImageIndex(),e._ImgManager.count()])}))}))}},{key:"TagImages",value:function(e,r){var n=this;if(n._resetErr(),!n._isValid())return!1;var i=!0,o=n._ImgManager.getView().GetWebViewer().GetHowManyImagesInBuffer();return t.isArray(e)?t.isString(r)&&""!=r?(t.each(e,(function(e){if(isNaN(e)||e<0||e>=o)return t.Errors.IndexOutOfRange(n),i=!1})),i?n._ImgManager.AddImageTag(e,r):i):(t.Errors.InvalidTagName(n),!1):(t.Errors.IndicesNotArray(n),!1)}},{key:"ClearImageTags",value:function(e){var r=this;return r._resetErr(),!!r._isValid()&&(-1==e||e>=r.HowManyImagesInBuffer?(t.Errors.IndexOutOfRange(r),!1):r._ImgManager.RemoveImageTag(e))}},{key:"SetDefaultTag",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&t._ImgManager.SetDefaultTag(e)}},{key:"FilterImagesByTag",value:function(e,t,r){var n=this;return n._resetErr(),!!n._isValid()&&n._ImgManager.ShowImagesByFilter(e,t,r)}},{key:"ClearFilter",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._ImgManager.ClearFilter()}},{key:"CreateDocument",value:function(e){var r=this;return r._resetErr(),!!r._isValid()&&(e&&""!=e?t.isString(e)?r._ImgManager.CreateFile(e):(t.Errors.FileNameNotString(r),!1):(t.isNumber(e)?t.Errors.FileNameNotString(r):t.Errors.FileNameCannotEmpty(r),!1))}},{key:"OpenDocument",value:function(e){var r=this;return r._resetErr(),!!r._isValid()&&(e&&""!=e?t.isString(e)?r._ImgManager.OpenFile(e):(t.Errors.FileNameNotString(r),!1):(t.isNumber(e)?t.Errors.FileNameNotString(r):t.Errors.FileNameCannotEmpty(r),!1))}},{key:"RemoveDocument",value:function(e){var t=this,r=t._isMobileMode();if(t._resetErr(),!t._isValid())return!1;if(!r){var n=t._ImgManager.GetImageIdsByFileName(e);t._innerFun("RemoveAllSelectedImages",Zn(n.join(",")))}return t._ImgManager.RemoveFile(e)}},{key:"RenameDocument",value:function(e,r){var n=this;return n._resetErr(),!!n._isValid()&&(t.isString(e)&&t.isString(r)?e&&""!=e&&r&&""!=r?n._ImgManager.RenameFile(e,r):(t.Errors.FileNameCannotEmpty(n),!1):(t.Errors.FileNameNotString(n),!1))}},{key:"GetDocumentInfoList",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._ImgManager.GetFileInfoList()}},{key:"Invert",value:function(e,r,n){var i=this,o=parseInt(e);return!!hi(i,o,n)&&(i._isMobileMode()?(Ul(i,Kl,id).call(i,o).then(r,(function(){t.isFunction(n)&&n(i._errorCode,i._getErrorString())})),!0):od(i,"Invert",o,r,n,!1,!0))}},{key:"InvertAsync",value:function(e){var r=this,n=parseInt(e);if(r._resetErr(),!r._isValid())return t.Promise.reject({code:r._errorCode,message:r._errorString});if(isNaN(n))return t.Errors.InvalidIndex(r),t.Promise.reject({code:r._errorCode,message:r._errorString});if(n<0||n>=r._ImgManager.count())return t.Errors.IndexOutOfRange(r),t.Promise.reject({code:r._errorCode,message:r._errorString});if(r._isMobileMode())return Ul(r,Kl,id).call(r,n);var i=r._ImgManager.convertClientIndexToServerId(n);return-1==i?(t.Errors.IndexOutOfRange(r),t.Promise.reject({code:r._errorCode,message:r._errorString})):r._innerFunV2("Invert",Zn(i)).then((function(e){var t=1==e;if(!t)throw{code:r._errorCode,message:r._errorString};return ti.refreshImageAfterInvokeFun(r,n),t}))}},{key:"RenameTag",value:function(e,r){var n=this;return n._resetErr(),!!n._isValid()&&(t.isUndefined(e)?(t.Errors.ParameterCannotEmpty(n),!1):0==e.length?(t.Errors.OldTagNameRequired(n),!1):t.isUndefined(r)||0==r.length?(t.Errors.NewTagNameRequired(n),!1):n._ImgManager.RenameTag(e,r))}},{key:"RemoveTag",value:function(e,r){var n=this;return n._resetErr(),!!n._isValid()&&(t.isUndefined(e)||0==e.length?(t.Errors.ParameterCannotEmpty(n),!1):t.isUndefined(r)||t.isArray(r)?n._ImgManager.RemoveTag(e,r):(t.Errors.IndicesNotArray(n),!1))}},{key:"GetTagList",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._ImgManager.GetTagList()}},{key:"GetTagListByIndex",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&t._ImgManager.GetTagListByIndex(e)}},{key:"_registLoadCallback",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&t._ImgManager.RegistLoadCallback(e)}},{key:"GetImageBitDepthAsync",value:function(e){var r=this;if(r._resetErr(),!r._isValid())return t.Promise.reject({code:r._errorCode,message:r._errorString});var n=parseInt(e);if(isNaN(n))return t.Errors.InvalidIndex(r),t.Promise.reject({code:r._errorCode,message:r._errorString});if(n<0||n>=r._ImgManager.count())return t.Errors.IndexOutOfRange(r),t.Promise.reject({code:r._errorCode,message:r._errorString});if(r._isMobileMode()){var i=r._ImgManager._UIView.GetMetaDataByIndex(n);return t.Promise.resolve(parseInt(i.bitDepth))}var o=r._ImgManager.convertClientIndexToServerId(n);return-1==o?(t.Errors.IndexOutOfRange(r),t.Promise.reject({code:r._errorCode,message:r._errorString})):r._innerFunV2("GetImageBitDepth",Zn(o))}},{key:"GetImageWidthAsync",value:function(e){var r=this;if(r._resetErr(),!r._isValid())return t.Promise.reject({code:r._errorCode,message:r._errorString});var n=parseInt(e);if(isNaN(n))return t.Errors.InvalidIndex(r),t.Promise.reject({code:r._errorCode,message:r._errorString});if(n<0||n>=r._ImgManager.count())return t.Errors.IndexOutOfRange(r),t.Promise.reject({code:r._errorCode,message:r._errorString});if(r._isMobileMode()){var i=r._ImgManager._UIView.GetMetaDataByIndex(n);return t.Promise.resolve(parseInt(i.width))}var o=r._ImgManager.convertClientIndexToServerId(n);return-1==o?(t.Errors.IndexOutOfRange(r),t.Promise.reject({code:r._errorCode,message:r._errorString})):r._innerFunV2("GetImageWidth",Zn(o))}},{key:"GetImageHeightAsync",value:function(e){var r=this;if(r._resetErr(),!r._isValid())return t.Promise.reject({code:r._errorCode,message:r._errorString});var n=parseInt(e);if(isNaN(n))return t.Errors.InvalidIndex(r),t.Promise.reject({code:r._errorCode,message:r._errorString});if(n<0||n>=r._ImgManager.count())return t.Errors.IndexOutOfRange(r),t.Promise.reject({code:r._errorCode,message:r._errorString});if(r._isMobileMode()){var i=r._ImgManager._UIView.GetMetaDataByIndex(n);return t.Promise.resolve(parseInt(i.height))}var o=r._ImgManager.convertClientIndexToServerId(n);return-1==o?(t.Errors.IndexOutOfRange(r),t.Promise.reject({code:r._errorCode,message:r._errorString})):r._innerFunV2("GetImageHeight",Zn(o))}},{key:"GetImageSizeAsync",value:function(e,r,n){var i=this;if(i._resetErr(),!i._isValid())return t.Promise.reject({code:i._errorCode,message:i._errorString});if(i._isMobileMode())return i._mobileNotSupportAsync("GetImageSizeAsync");var o=parseInt(e);if(isNaN(o))return t.Errors.InvalidIndex(i),t.Promise.reject({code:i._errorCode,message:i._errorString});if(o<0||o>=i._ImgManager.count())return t.Errors.IndexOutOfRange(i),t.Promise.reject({code:i._errorCode,message:i._errorString});var a=i._ImgManager.convertClientIndexToServerId(o);return-1==a?(t.Errors.IndexOutOfRange(i),t.Promise.reject({code:i._errorCode,message:i._errorString})):i._innerFunV2("GetImageSize",Zn(a,r,n))}},{key:"GetImageSizeWithSpecifiedTypeAsync",value:function(e,r){var n=this;if(n._resetErr(),!n._isValid())return t.Promise.reject({code:n._errorCode,message:n._errorString});if(n._isMobileMode())return n._mobileNotSupportAsync("GetImageSizeWithSpecifiedTypeAsync");var i=parseInt(e);if(isNaN(i))return t.Errors.InvalidIndex(n),t.Promise.reject({code:n._errorCode,message:n._errorString});if(i<0||i>=n._ImgManager.count())return t.Errors.IndexOutOfRange(n),t.Promise.reject({code:n._errorCode,message:n._errorString});var o=n._ImgManager.convertClientIndexToServerId(i);return-1==o?(t.Errors.IndexOutOfRange(n),t.Promise.reject({code:n._errorCode,message:n._errorString})):n._innerFunV2("GetImageSizeWithSpecifiedType",Zn(o,r))}},{key:"GetImageXResolutionAsync",value:function(e){var r=this;if(r._resetErr(),!r._isValid())return t.Promise.reject({code:r._errorCode,message:r._errorString});var n=parseInt(e);if(isNaN(n))return t.Errors.InvalidIndex(r),t.Promise.reject({code:r._errorCode,message:r._errorString});if(n<0||n>=r._ImgManager.count())return t.Errors.IndexOutOfRange(r),t.Promise.reject({code:r._errorCode,message:r._errorString});if(r._isMobileMode()){var i=r._ImgManager._UIView.GetMetaDataByIndex(n);return t.Promise.resolve(parseInt(i.resolutionX))}var o=r._ImgManager.convertClientIndexToServerId(n);return-1==o?(t.Errors.IndexOutOfRange(r),t.Promise.reject({code:r._errorCode,message:r._errorString})):r._innerFunV2("GetImageXResolution",Zn(o))}},{key:"GetImageYResolutionAsync",value:function(e){var r=this;if(r._resetErr(),!r._isValid())return t.Promise.reject({code:r._errorCode,message:r._errorString});var n=parseInt(e);if(isNaN(n))return t.Errors.InvalidIndex(r),t.Promise.reject({code:r._errorCode,message:r._errorString});if(n<0||n>=r._ImgManager.count())return t.Errors.IndexOutOfRange(r),t.Promise.reject({code:r._errorCode,message:r._errorString});if(r._isMobileMode()){var i=r._ImgManager._UIView.GetMetaDataByIndex(n);return t.Promise.resolve(parseInt(i.resolutionY))}var o=r._ImgManager.convertClientIndexToServerId(n);return-1==o?(t.Errors.IndexOutOfRange(r),t.Promise.reject({code:r._errorCode,message:r._errorString})):r._innerFunV2("GetImageYResolution",Zn(o))}},{key:"ChangeBrightnessAsync",value:function(e,r){var n=this,i=parseInt(e);if(!n._isValid())return t.Promise.reject({code:n._errorCode,message:n._errorString});if(r<-1e3||r>1e3)return t.Errors.InvalidValue(n),t.Promise.reject({code:n._errorCode,message:n._errorString});if(n._isMobileMode())return n._innerSendToMobileV2("ChangeBrightness",Kn(i,r)).then((function(){ti.refreshImageAfterInvokeFun(n,e),n._ImgManager._UIView.GetWebViewer().clearSelectedAreas()}));var o=n._ImgManager.convertClientIndexToServerId(i);return-1==o?(t.Errors.IndexOutOfRange(n),t.Promise.reject({code:n._errorCode,message:n._errorString})):n._innerFunV2("ChangeBrightness",Zn(o,r))}},{key:"ChangeContrastAsnyc",value:function(e,r){var n=this,i=parseInt(e);if(!n._isValid())return t.Promise.reject({code:n._errorCode,message:n._errorString});if(r<-1e3||r>1e3)return t.Errors.InvalidValue(n),t.Promise.reject({code:n._errorCode,message:n._errorString});if(n._isMobileMode())return n._innerSendToMobileV2("ChangeContrast",Kn(i,r)).then((function(){ti.refreshImageAfterInvokeFun(n,e),n._ImgManager._UIView.GetWebViewer().clearSelectedAreas()}));var o=n._ImgManager.convertClientIndexToServerId(i);return-1==o?(t.Errors.IndexOutOfRange(n),t.Promise.reject({code:n._errorCode,message:n._errorString})):n._innerFunV2("ChangeContrast",Zn(o,r))}},{key:"publicGetImageAsync",value:function(e,r,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return t.Promise.reject({code:a._errorCode,message:a._errorString});var s=parseInt(e);if(isNaN(s))return t.Errors.InvalidIndex(a),t.Promise.reject({code:a._errorCode,message:a._errorString});if(s<0||s>=a._ImgManager.count())return t.Errors.IndexOutOfRange(a),t.Promise.reject({code:a._errorCode,message:a._errorString});if(a._isMobileMode())return a._mobileNotSupportAsync("GetImageAsync");var u,c=a._ImgManager.convertClientIndexToServerId(s);return-1==c?(t.Errors.IndexOutOfRange(a),t.Promise.reject({code:a._errorCode,message:a._errorString})):(t.isNumber(r)?u=Zn(c,r):t.isNumber(n)&&t.isNumber(i)?u=Zn(c,n,i):t.isNumber(o)&&(u=Zn(c,-1,-1,o)),a._innerFunRawV2("GetImageByIndex",u,"blob"))}},{key:"GetImageInfoAsync",value:function(r){var n=this;if(n._resetErr(),!n._isValid())return t.Promise.reject({code:n._errorCode,message:n._errorString});var i=parseInt(r);if(isNaN(i))return t.Errors.InvalidIndex(n),t.Promise.reject({code:n._errorCode,message:n._errorString});if(i<0||i>=n._ImgManager.count())return t.Errors.IndexOutOfRange(n),t.Promise.reject({code:n._errorCode,message:n._errorString});if(n._isMobileMode())return n._mobileNotSupportAsync("GetImageAsync");var o=n._ImgManager.convertClientIndexToServerId(i);return-1==o?(t.Errors.IndexOutOfRange(n),t.Promise.reject({code:n._errorCode,message:n._errorString})):n._innerFunV2("GetImageInfo",Zn(o)).then((function(t){var r=0,n=0,i=t;if(e.Lib.isArray(t)&&1==t.length&&(i=t[0]),e.Lib.isString(i)){var o=i.split(",");r=parseInt(o[0]),n=parseInt(o[1])}return{width:r,height:n}}))}},{key:"IfShowUI",get:function(){return this._resetErr(),this._isValid()?this._isMobileMode()?this._mobileNotSupport("IfShowUI"):this._innerFun("IfShowUI"):Or},set:function(e){this._setIfShowUI(e)}},{key:"IfShowFileDialog",get:function(){return this._getIfShowFileDialog()},set:function(e){this._setIfShowFileDialog(e)}},{key:"checkErrorString",value:function(){var t=this._errorCode;if(-2115===t)return!0;if(-2003===t&&!e.DWT.IfHttpPostErrorNoWindow){var r=window.open("","ErrorMessage","height=500,width=750,top=0,left=0,toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no");null==r||r.document.writeln(this.__HTTPPostResponseString)}return 0===t}}]),i}(Bl);function ql(e,r,n,i,o,a,s){var u=this,c=parseInt(e),l=u.__backgroundFillColor;return t.isUndef(l)?l="FFFFFF":t.isNumber(l)?l=l.toString(16):t.isString(l)&&(l=t.replaceAll(l,"#","")),u._innerSendToMobile("Erase",Kn(c,r,n,i,o,l),0,(function(){ti.refreshImageAfterInvokeFun(u,e),t.isFunction(a)&&setTimeout(a,30)}),(function(){t.isFunction(s)&&s(u._errorCode,u._getErrorString())}))}function Ql(e,r,n){var i=this,o=parseInt(e);return i._innerSendToMobile("GetSkewAngle",Kn(o),0,(function(n){ti.refreshImageAfterInvokeFun(i,e),t.isFunction(r)&&setTimeout((function(){r(n)}),30)}),(function(){t.isFunction(n)&&n(i._errorCode,i._getErrorString())}))}function $l(e,r,n,i){var o=this,a=parseInt(e),s=o.__backgroundFillColor;return t.isUndef(s)?s="FFFFFF":t.isNumber(s)?s="0x"+s.toString(16):t.isString(s)&&(s=t.replaceAll(s,"#","")),o._innerSendToMobileV2("RotateEx",Kn(a,r,n,i,s)).then((function(){ti.refreshImageAfterInvokeFun(o,e),o._ImgManager._UIView.GetWebViewer().clearSelectedAreas()}))}function ed(e,t,r,n){var i=this,o=parseInt(e),a=parseInt(t),s=parseInt(r);return i._innerSendToMobileV2("ChangeImageSize",Kn(o,a,s,n)).then((function(){ti.refreshImageAfterInvokeFun(i,e)}))}function td(e){var t=this,r=parseInt(e);return t._innerSendToMobileV2("Flip",Kn(r)).then((function(){ti.refreshImageAfterInvokeFun(t,e),t._ImgManager._UIView.GetWebViewer().clearSelectedAreas()}))}function rd(e,t,r,n,i){var o=this,a=parseInt(e);return o._innerSendToMobileV2("Crop",Kn(a,t,r,n,i)).then((function(){var t,r;ti.refreshImageAfterInvokeFun(o,e),t=o._errorCode,r=o._getErrorString(),o._ImgManager.getView().GetWebViewer().clearSelectedAreas(),o._errorCode=t,o._errorString=r}))}function nd(e,r,n,i,o,a,s,u){var c=this,l=parseInt(e),d=parseInt(n),h=parseInt(i),g=parseInt(a);return isNaN(d)||d<=0||isNaN(h)||h<=0||isNaN(g)||g<0?(t.Errors.InvalidParameter(c),t.isFunction(u)&&u(c._errorCode,c._getErrorString()),!1):c._innerSendToMobile("SetDPI",Kn(l,d,h,o,g),0,(function(){ti.refreshImageAfterInvokeFun(c,e),t.isFunction(s)&&setTimeout(s,30)}),(function(){t.isFunction(u)&&u(c._errorCode,c._getErrorString())}))}function id(e){var t=this,r=parseInt(e);return t._innerSendToMobileV2("Invert",Kn(r)).then((function(){ti.refreshImageAfterInvokeFun(t,e)}))}function od(e,r,n,i,o,a,s){var u,c=e._ImgManager.convertClientIndexToServerId(n);if(-1==c)return t.Errors.IndexOutOfRange(e),t.isFunction(o)&&o(e._errorCode,e._errorString),!1;if(u=e._innerFun(r,Zn(c)),a)return u;var l=1==u;return l?(s&&(ti.refreshImageAfterInvokeFun(e,n),e._ImgManager._UIView.GetWebViewer().clearSelectedAreas()),t.isFunction(i)&&i()):t.isFunction(o)&&o(e._errorCode,e._errorString),l}var ad=function(){function e(t,r,n,i){Le(this,e);var o=this;o._md5=n,o._length=r,o._content=i}return Ae(e,[{key:"getLength",value:function(){return this._length}},{key:"getMD5",value:function(){return this._md5}},{key:"getData",value:function(e,r){var n=this,i=r;return t.isNumber(e)&&t.isNumber(r)?e<0||r<=0?"":0==e&&i==n._length?n._content:(e+i>n._length&&(i=n._length-e),n._content.substr(e,i)):""}}]),e}();function sd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(es){return!1}}();return function(){var r,n=et(e);if(t){var i=et(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return $e(this,r)}}t.html5.Base64Result=ad;var ud=function(r){Qe(i,r);var n=sd(i);function i(){return Le(this,i),n.apply(this,arguments)}return Ae(i,[{key:"SetCookie",value:function(e){return this._cookie=e,document.cookie=e,Rr}},{key:"LoadImageFromBase64Binary",value:function(r,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return!1;if(!r)return t.Errors.InvalidParameter(a),t.isFunction(o)&&o(a._errorCode,a._getErrorString()),!1;var s,u,c=r,l=Or,d="LoadImageFromBase64Binary",h=n,g=1;if(c instanceof ad&&t.isFunction(c.getLength)&&t.isFunction(c.getData)&&(c=c.getData(0,c.getLength())),t.isString(c))if(-1!=c.indexOf("data:image/bmp"))h=0;else if(-1!=c.indexOf("data:image/jpeg"))h=1;else if(-1!=c.indexOf("data:image/tif"))h=2;else if(-1!=c.indexOf("data:image/png"))h=3;else if(-1!=c.indexOf("data:application/pdf"))h=4;else if(-1!=c.indexOf("data:image/jp2"))h=14;else{var f=c.substr(0,64);h=qn(e.Lib.base64.decode(f,!0))}if(h!=e.DWT.EnumDWT_ImageType.IT_BMP&&h!=e.DWT.EnumDWT_ImageType.IT_JPG&&h!=e.DWT.EnumDWT_ImageType.IT_TIF&&h!=e.DWT.EnumDWT_ImageType.IT_PNG&&h!=e.DWT.EnumDWT_ImageType.IT_PDF&&h!=e.DWT.EnumDWT_ImageType.IT_J2K&&(h=-1),!t.License.checkProductKey(a,{Core:!0}))return t.isFunction(o)&&o(a._errorCode,a._getErrorString()),Or;if(!t.License.checkPDFProductKeyWhenNeeds(a,h))return t.isFunction(o)&&o(a._errorCode,a._getErrorString()),Or;var m=a._innerGetCurrentDocumentName();if(""==m&&a._ImgManager&&(m=a._ImgManager.getWebViewer().GetDefaultFileName()),a._isMobileMode()){t.cancelFrom=Me,t.showProgress(a,d,Rr),a.__bLoadingImage=Rr;var _=c;if(t.isString(c)){var p;if(c.indexOf("blob:")>=0||c.indexOf("data:")>=0);else p=h==e.DWT.EnumDWT_ImageType.IT_PNG?"data:image/png;base64,":h==e.DWT.EnumDWT_ImageType.IT_JPG?"data:image/jpeg;base64,":h==e.DWT.EnumDWT_ImageType.IT_TIF?"data:image/tif;base64,":h==e.DWT.EnumDWT_ImageType.IT_PDF?"data:application/pdf;base64,":h==e.DWT.EnumDWT_ImageType.IT_BMP?"data:image/bmp;base64,":h==e.DWT.EnumDWT_ImageType.IT_J2K?"data:image/jp2;base64,":"data:application/octet-stream;base64,",c=[p,c].join("");if(c.indexOf("data:")>=0&&0==(_=t.MobileFuns.dataURLtoBlob(c)))return e.Lib.closeProgress(a,d),a.__bLoadingImage=!1,t.Errors.ConvertFromBase64Failed(a),t.isFunction(o)&&o(a._errorCode,a._getErrorString(),c,n),!1}else if(c instanceof ArrayBuffer){var v="image/png";h==e.DWT.EnumDWT_ImageType.IT_PNG?v="image/png":h==e.DWT.EnumDWT_ImageType.IT_JPG?v="image/jpeg":h==e.DWT.EnumDWT_ImageType.IT_TIF?v="image/tiff":h==e.DWT.EnumDWT_ImageType.IT_PDF?v="application/pdf":h==e.DWT.EnumDWT_ImageType.IT_BMP?v="image/bmp":h==e.DWT.EnumDWT_ImageType.IT_J2K&&(v="image/jp2"),_=new Blob([c],{type:v})}return s=a._innerSendToMobile("LoadImageFromBinary",Kn(_,0,null,m),0,(function(){if(e.Lib.closeProgress(a,d),a.__bLoadingImage=!1,a._isBindViewer()){var t=a._ImgManager.getCurrentImageIndex();t>=0&&a.__onRefreshUI(t)}return i&&i(c,n),!0}),(function(){e.Lib.closeProgress(a,d),a.__bLoadingImage=!1,t.isFunction(o)&&o(a._errorCode,a._getErrorString(),c,n)})),!0}return t.isFunction(i)&&(l=Rr),t.isString(c)&&-1!=c.indexOf("base64,")&&(c=c.substr(c.indexOf("base64,")+7)),u=a.__GetLoadEventsNum(),l?(t.cancelFrom=Me,t.showProgress(a,d,Rr),a.__bLoadingImage=Rr,g=0,s=a._innerSend(d,Zn(c,h,u,g),Rr,(function(){if(e.Lib.closeProgress(a,d),a.__bLoadingImage=!1,a._isBindViewer()){var t=a._ImgManager.getCurrentImageIndex();t>=0&&a.__onRefreshUI(t)}return a._blts&&e.DWT.lcvrf(a),i&&i(c,n),!0}),(function(){e.Lib.closeProgress(a,d),a.__bLoadingImage=!1,t.isFunction(o)&&o(a._errorCode,a._getErrorString(),c,n)}))):(s=a.__innerLoadImageFun(d,Zn(c,h,u,g),g,m))&&a._blts&&e.DWT.lcvrf(a),s}},{key:"SaveSelectedImagesToBytes",value:function(e,r){return t.Errors.HTML5NotSupport(this),Or}},{key:"LoadImageFromBytes",value:function(e,r,n){return t.Errors.HTML5NotSupport(this),Or}},{key:"SetCancel",value:function(e,t){var r=this;return r._resetErr(),!!r._isValid()&&(r._isMobileMode()?r._mobileNotSupport("SetCancel",t):(this._innerSend("SetCancel",null,Rr,e,t),!0))}},{key:"_asyncSetImageWidth",value:function(e,r,n,i){var o=this,a=parseInt(e);return o._innerSendToMobile("SetImageWidth",Kn(a,r),0,(function(){ti.refreshImageAfterInvokeFun(o,e),t.isFunction(n)&&setTimeout(n,30)}),(function(){t.isFunction(i)&&i(o._errorCode,o._getErrorString())}))}},{key:"SetImageWidth",value:function(e,r,n,i){var o,a=this;if(a._resetErr(),!a._isValid())return!1;var s=parseInt(e);if(isNaN(s))return t.Errors.InvalidIndex(a),t.isFunction(i)&&i(a._errorCode,a._getErrorString()),!1;if(s<0||s>=a._ImgManager.count())return t.Errors.IndexOutOfRange(a),t.isFunction(i)&&i(a._errorCode,a._getErrorString()),!1;if(t.isUndefined(r))return t.Errors.InvalidParameter(a),t.isFunction(i)&&i(a._errorCode,a._getErrorString()),!1;if(a._isMobileMode())return a._asyncSetImageWidth(s,r,n,i);var u=a._ImgManager.convertClientIndexToServerId(s);return-1==u?(t.Errors.IndexOutOfRange(a),t.isFunction(i)&&i(a._errorCode,a._getErrorString()),!1):((o=1==a._innerFun("SetImageWidth",Zn(u,r)))?t.isFunction(n)&&n():t.isFunction(i)&&i(a._errorCode,a._getErrorString()),o)}},{key:"HTTPDownloadStreamThroughPost",value:function(e,r){return t.Errors.HTML5NotSupport(this),Or}},{key:"HTTPUploadStreamThroughPost",value:function(e,r,n,i,o){return t.Errors.HTML5NotSupport(this),Or}},{key:"HTTPUploadThroughPutDirectly",value:function(e,r,n,i,o){return t.Errors.HTML5NotSupport(this),!1}},{key:"SetCustomDSDataEx",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&(t._isMobileMode()?t._mobileNotSupport("SetCustomDSDataEx"):this._innerFun("SetCustomDSDataEx",Zn(e)))}},{key:"SetCustomDSData",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return!1;if(t._isMobileMode())return t._mobileNotSupport("SetCustomDSData");var r=ti.replaceLocalFilename(e);return this._innerFun("SetCustomDSData",Zn(r))}},{key:"GetCustomDSDataEx",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&(e._isMobileMode()?e._mobileNotSupport("GetCustomDSDataEx"):e._innerFun("GetCustomDSDataEx"))}},{key:"GetCustomDSData",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return!1;if(t._isMobileMode())return t._mobileNotSupport("GetCustomDSData");var r=ti.replaceLocalFilename(e);return t._innerFun("GetCustomDSData",Zn(r))}},{key:"_asyncConvertToBW",value:function(e,r,n){var i=this,o=parseInt(e);return i._innerSendToMobile("ConvertToBWScale",Kn(o),0,(function(){ti.refreshImageAfterInvokeFun(i,e),t.isFunction(r)&&r()}),(function(){t.isFunction(n)&&n(i._errorCode,i._getErrorString())}))}},{key:"ConvertToBW",value:function(e,r,n){var i=this;if(i._resetErr(),!i._isValid())return!1;if(!t.License.checkProductKey(i,{Core:!0}))return t.isFunction(n)&&n(i._errorCode,i._getErrorString()),!1;var o=parseInt(e);if(isNaN(o))return t.Errors.InvalidIndex(i),t.isFunction(n)&&n(i._errorCode,i._getErrorString()),!1;if(o<0||o>=i._ImgManager.count())return t.Errors.IndexOutOfRange(i),t.isFunction(n)&&n(i._errorCode,i._getErrorString()),!1;if(i._isMobileMode())return i._asyncConvertToBW(o,r,n);var a=i.ChangeBitDepth(e,1,!0);return a?t.isFunction(r)&&r():t.isFunction(n)&&n(i._errorCode,i._getErrorString()),a}},{key:"LoadImageFromBinary",value:function(e,t,r){return this._innerLoadImageFromBinary(e,0,!0,t,r)}},{key:"EnableSourceUI",value:function(e,t){var r=this;return r._resetErr(),!!r._isValid()&&(r._isMobileMode()?r._mobileNotSupport("EnableSourceUI",t):(r._innerSend("EnableSourceUI",null,!0,e,t),!0))}},{key:"GetIfShowVideoContainer",value:function(){return this._ImgManager.GetIfShowVideoContainer()}},{key:"ShowVideoContainer",value:function(e){return this._ImgManager.ShowVideoContainer(e)}},{key:"UpdateVideoContainer",value:function(e){return this._ImgManager.UpdateVideoContainer(e)}},{key:"ChangeBitDepth",value:function(e,r,n){var i,o=this;if(o._resetErr(),!o._isValid())return!1;if(o._isMobileMode())return o._mobileNotSupport("ChangeBitDepth");if(i=parseInt(e),isNaN(i))return t.Errors.InvalidIndex(o),!1;if(i<0||i>=o._ImgManager.count())return t.Errors.IndexOutOfRange(o),!1;var a=o._ImgManager.convertClientIndexToServerId(i);return-1==a?(t.Errors.IndexOutOfRange(o),!1):o._innerFun("ChangeBitDepth",Zn(a,r,n))}},{key:"_asyncConvertToGrayScale",value:function(e,r,n){var i=this,o=function(){t.isFunction(n)&&n(i._errorCode,i._getErrorString())};if(!t.License.checkProductKey(i,{Core:!0}))return o(),!1;var a=parseInt(e);return i._innerSendToMobile("ConvertToGrayScale",Kn(a),0,(function(){ti.refreshImageAfterInvokeFun(i,e),t.isFunction(r)&&setTimeout(r,30)}),o)}},{key:"ConvertToGrayScale",value:function(e,r,n){var i,o=this;if(o._resetErr(),!o._isValid())return!1;var a=parseInt(e);if(isNaN(a))return t.Errors.InvalidIndex(o),t.isFunction(n)&&n(o._errorCode,o._getErrorString()),!1;if(a<0||a>=o._ImgManager.count())return t.Errors.IndexOutOfRange(o),t.isFunction(n)&&n(o._errorCode,o._getErrorString()),!1;if(o._isMobileMode())return o._asyncConvertToGrayScale(a,r,n);var s=o._ImgManager.convertClientIndexToServerId(a);return-1==s?(t.Errors.IndexOutOfRange(o),t.isFunction(n)&&n(o._errorCode,o._getErrorString()),!1):((i=1==o._innerFun("ConvertToGrayScale",Zn(s)))?(ti.refreshImageAfterInvokeFun(o,a),t.isFunction(r)&&r()):t.isFunction(n)&&n(o._errorCode,o._getErrorString()),i)}},{key:"ClearTiffCustomTag",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&(e._aryTiffTag.splice(0,e._aryTiffTag.length),!!e._isMobileMode()||e._innerFun("ClearTiffCustomTag"))}},{key:"SetTiffCustomTag",value:function(e,r,n){var i=this;if(i._resetErr(),!i._isValid())return!1;if(t.isUndef(e)||t.isUndef(r))return t.Errors.InvalidParameter(i),!1;var o,a=1*e;if(o=t.isString(r)?t.replaceAll(r,'"','\\"'):r,a<=0||a>2147483647)return t.Errors.InvalidTiffTagError(i),!1;var s,u=0,c=!1,l=i._aryTiffTag.length;for(u=0;u<l;u++)(s=i._aryTiffTag[u]).tag==a&&(s.Content=r,s.UseBase64Encoding=n,c=!0);return!c&&l>=32?(t.Errors.TiffTagCountExceedError(i),!1):i._isMobileMode()?(c||i._aryTiffTag.push({tag:e,content:r,UseBase64Encoding:n}),!0):i._innerFun("SetTiffCustomTag",Zn(a,o,n))}},{key:"IsBlankImage",value:function(e){var r,n=this;if(n._resetErr(),!n._isValid())return!1;if(n._isMobileMode())return n._mobileNotSupport("IsBlankImage");if(r=parseInt(e),isNaN(r))return t.Errors.InvalidIndex(n),!1;if(r<0||r>=n._ImgManager.count())return t.Errors.IndexOutOfRange(n),!1;var i=n._ImgManager.convertClientIndexToServerId(r);return-1==i?(t.Errors.IndexOutOfRange(n),!1):n._innerFun("IsBlankImage",Zn(i,Or))}},{key:"IsBlankImageExpress",value:function(e){var r=this;if(r._resetErr(),!r._isValid())return!1;if(r._isMobileMode())return r._mobileNotSupport("IsBlankImageExpress");var n=parseInt(e);if(isNaN(n))return t.Errors.InvalidIndex(r),!1;if(n<0||n>=r._ImgManager.count())return t.Errors.IndexOutOfRange(r),!1;var i=r._ImgManager.convertClientIndexToServerId(n);return-1==i?(t.Errors.IndexOutOfRange(r),!1):r._innerFun("IsBlankImage",Zn(i,Rr))}},{key:"SetOpenSourceTimeout",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&(t._isMobileMode()?t._mobileNotSupport("SetOpenSourceTimeout"):t._innerFun("SetOpenSourceTimeout",Zn(e)))}},{key:"GetImageURL",value:function(r,n,i,o,a){var s=this;if(s._resetErr(),!s._isValid())return!1;if(s._isMobileMode()){if(!t.isFunction(n))return s._mobileNotSupport("GetImageURL");s._ImgManager.getWebViewer().GetImageData(s._ImgManager.getWebViewer().GetUidByIndex(r)).then((function(e){n(e.oriData)}),(function(e){i(e.message)}))}var u,c,l,d=r,h=parseInt(n),g=parseInt(i);if(o?(u="",c="dwt://"):(u=s._httpUrl,c="dwt/"),l=[u,c,t.product.getDWTPrefix(),t.product.getServerVersionInfo(),"/img?id=",s._clientId],t.isUndefined(d)||null===d)return t.Errors.IndexNullOrUndefined(s),"";if(a)l.push("&index=-1&width=-1&height=-1&webcam="),l.push(a);else{if(d=parseInt(d),isNaN(d))return t.Errors.InvalidIndex(s),"";if(d<-1||d>=s._ImgManager.count())return t.Errors.IndexOutOfRange(s),"";var f=s._ImgManager.convertClientIndexToServerId(d);if(-1==f)return"";l.push("&index="),l.push(f),h>0&&g>0&&(l.push("&width="),l.push(h),l.push("&height="),l.push(g))}if(l.push("&t="),l.push((new Date).getTime()),l=l.join(""),e.navInfoSync.bFileSystem&&l.indexOf("dwt://")<0){var m=new Image;m.crossOrigin="anonymous",m.src=l,m=null}return l}},{key:"GetImagePartURL",value:function(e,r,n){var i=this;if(i._resetErr(),!i._isValid())return!1;if(i._isMobileMode())return i._mobileNotSupport("GetImagePartURL");var o=parseInt(e);return isNaN(o)?(t.Errors.InvalidIndex(i),""):o<0||o>=i._ImgManager.count()?(t.Errors.IndexOutOfRange(i),""):this.GetImageURL(o,r,n,!0)}},{key:"SetLanguage",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&(t._isMobileMode()?t._mobileNotSupport("SetLanguage"):t._innerFun("SetLanguageForSecurity",Zn(e)))}},{key:"_wasmGetLicenseInfo",value:function(r,n){var i=this;return i._innerSendToMobile("GetLicenseInfo",Kn(),0,(function(o){if(o)if(o.exception)n&&n(o.exception);else{if(oc(i,o),t.detect.wasmScriptLoaded&&!t.detect.wasmPdfReaderLoaded)try{e.WasmEnv.loadPdfReader(),t.detect.wasmPdfReaderLoaded=!0}catch(a){a&&t.error(a.message)}r&&r(i.__licenseInfo)}else n&&n()}),n)}},{key:"GetLicenseInfo",value:function(r,n){var i=this;if(i.__licenseInfo)t.isFunction(r)&&r(i.__licenseInfo);else{if(i._isMobileMode())return i._wasmGetLicenseInfo(r,n);i._innerFunRaw("GetLicenseInfo",null,Rr,Or,Rr,(function(o){if(o)if(o.exception)t.isFunction(n)&&n(o.exception);else{if(oc(i,o),t.detect.wasmScriptLoaded&&!t.detect.wasmPdfReaderLoaded)try{e.WasmEnv.loadPdfReader(),t.detect.wasmPdfReaderLoaded=!0}catch(a){a&&t.error(a.message)}t.isFunction(r)&&r(i.__licenseInfo)}else t.isFunction(n)&&n()}),n)}return Rr}},{key:"SetProductKeyAsync",value:function(e){return this._setProductKeyAsync(e)}},{key:"GetVersionInfoAsync",value:function(){return this._innerFunV2("VersionInfo")}},{key:"isUsingActiveX",value:function(){return!1}},{key:"SetLTSLicenseAsync",value:function(e){return this._setLTSLicenseAsync(e)}}]),i}(Zl);function cd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(es){return!1}}();return function(){var r,n=et(e);if(t){var i=et(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return $e(this,r)}}function ld(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function dd(e,t,r){if(!t.has(e));return r}var hd=new WeakSet,gd=new WeakSet,fd=new WeakSet,md=function(r){Qe(i,r);var n=cd(i);function i(){var e;Le(this,i);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return ld(Ze(e=n.call.apply(n,[this].concat(r))),fd),ld(Ze(e),gd),ld(Ze(e),hd),e}return Ae(i,[{key:"SaveAsGIF",value:function(r,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return!1;if(a._isMobileMode())return t.Errors.HTML5NotSupport(a),t.isFunction(o)&&Cc(o,a),Or;if(!(t.License.checkProductKey(a,{Core:!0})||e.navInfoSync.bWin&&t.License.checkProductKey(a,{Webcam:!0},!0)))return t.isFunction(o)&&o(a._errorCode,a._getErrorString()),!1;var s,u=ti.replaceLocalFilename(r);return!!ci(a,n,o)&&(-1==(s=a._ImgManager.convertClientIndexToServerId(n))?(t.Errors.IndexOutOfRange(a),t.isFunction(o)&&Cc(o,a),!1):a.__innerSaveImage("SaveAsGIF",Zn(u,s),i,o))}},{key:"SaveSelectedImagesToBase64Binary",value:function(r,n){var i=this;if(i._resetErr(),!i._isValid())return!1;if(!(t.License.checkProductKey(i,{Core:!0})||e.navInfoSync.bWin&&t.License.checkProductKey(i,{Webcam:!0},!0)))return t.isFunction(n)&&n(i._errorCode,i._getErrorString()),!1;if(i._isMobileMode())return i._mobileNotSupport("SaveSelectedImagesToBase64Binary",n);var o=di(i);return t.isFunction(r)?(i._innerSend("SaveSelectedImagesToBase64Binary",Zn(o.join(",")),!0,r,n),!0):i._innerFun("SaveSelectedImagesToBase64Binary",Zn(o.join(",")))}},{key:"ShowFileDialog",value:function(e,t,r,n,i,o,a,s){var u=this;if(u._resetErr(),!u._isValid())return!1;if(u._isMobileMode())return u._mobileNotSupport("ShowFileDialog");var c,l=ti.replaceLocalFilename(i);return c=u.__GetLoadEventsNum(),u._innerSend("ShowFileDialog",Zn(e,t,r,n,l,o,a,s,c),!0),!0}},{key:"FTPDownload",value:function(e,r,n,i){var o=this;if(o._resetErr(),!o._isValid())return!1;if(o._isMobileMode())return o._mobileNotSupport("FTPDownload",i);if(!e)return t.Errors.InvalidParameter(o),t.isFunction(i)&&i(o._errorCode,o._getErrorString()),!1;var a=ti.getImageType(r);return dd(o,fd,vd).call(o,"FTPDownload",Zn(e,r),a,n,i)}},{key:"FTPDownloadEx",value:function(e,r,n,i,o){var a=this;return a._resetErr(),!!a._isValid()&&(a._isMobileMode()?a._mobileNotSupport("FTPDownloadEx",o):e?dd(a,fd,vd).call(a,"FTPDownloadEx",Zn(e,r,n),n,i,o):(t.Errors.InvalidParameter(a),t.isFunction(o)&&o(a._errorCode,a._getErrorString()),!1))}},{key:"FTPUpload",value:function(e,r,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return!1;if(a._isMobileMode())return a._mobileNotSupport("FTPUpload",o);var s=a._ImgManager.convertClientIndexToServerId(r);return!!ci(a,r,o)&&(-1==s?(t.Errors.IndexOutOfRange(a),t.isFunction(o)&&Cc(o,a),!1):a.__innerFTPUpload("FTPUpload",Zn(e,s,n),i,o))}},{key:"FTPUploadEx",value:function(e,r,n,i,o,a){var s,u=this;return u._resetErr(),!!u._isValid()&&(u._isMobileMode()?u._mobileNotSupport("FTPUploadEx",a):!!ci(u,r,a)&&(-1==(s=u._ImgManager.convertClientIndexToServerId(r))?(t.Errors.IndexOutOfRange(u),t.isFunction(a)&&Cc(a,u),!1):u.__innerFTPUpload("FTPUploadEx",Zn(e,s,n,i),o,a)))}},{key:"FTPUploadAllAsMultiPageTIFF",value:function(e,t,r,n){var i=this;if(i._resetErr(),!i._isValid())return!1;if(i._isMobileMode())return i._mobileNotSupport("FTPUploadAllAsMultiPageTIFF",n);var o=[];return si(i,o),this.__innerFTPUpload("FTPUploadAsMultiPageTIFF",Zn(e,t,o.join(",")),r,n)}},{key:"FTPUploadAllAsPDF",value:function(e,t,r,n){var i=this;if(i._resetErr(),!i._isValid())return!1;if(i._isMobileMode())return i._mobileNotSupport("FTPUploadAllAsPDF",n);var o=[];return si(i,o),i.__innerFTPUpload("FTPUploadAsMultiPagePDF",Zn(e,t,o.join(",")),r,n)}},{key:"FTPUploadAsMultiPagePDF",value:function(e,t,r,n){var i=this;if(i._resetErr(),!i._isValid())return!1;if(i._isMobileMode())return i._mobileNotSupport("FTPUploadAsMultiPagePDF",n);var o=di(i);return i.__innerFTPUpload("FTPUploadAsMultiPagePDF",Zn(e,t,o.join(",")),r,n)}},{key:"FTPUploadAsMultiPageTIFF",value:function(e,t,r,n){var i=this;if(i._resetErr(),!i._isValid())return!1;if(i._isMobileMode())return i._mobileNotSupport("FTPUploadAsMultiPageTIFF",n);var o=di(i);return this.__innerFTPUpload("FTPUploadAsMultiPageTIFF",Zn(e,t,o.join(",")),r,n)}},{key:"HTTPDownloadDirectly",value:function(r,n,i,o,a){var s=this;if(s._resetErr(),!s._isValid())return!1;if(!t.License.checkProductKey(s,{Core:!0}))return t.isFunction(a)&&a(s._errorCode,s._getErrorString()),!1;if(s._isMobileMode())return s._mobileNotSupport("HTTPDownloadDirectly",a);var u,c,l=Ic(s),d=ti.combineUrl(s,r,n);if(d===undefined)return t.Errors.ParameterCannotEmpty(s),!1;if(!i||""==i)return t.Errors.InvalidLocalFilename(s,"HTTPDownloadDirectly"),t.isFunction(a)&&Cc(a,s),!1;if(u=ti.getImageType(i),!t.License.checkPDFProductKeyWhenNeeds(s,u))return t.isFunction(a)&&a(s._errorCode,s._errorString),!1;t.cancelFrom=ke,c=ti.replaceLocalFilename(i),t.showProgress(s,"HTTPDownloadDirectly",!0);var h=!0;return s._OnPercentDone([0,-1,e.MSG.Downloading,"http"]),t.isFunction(o)||(h=!1),ti.loadHttpBlob(s,"get",d,h,(function(t){s._OnPercentDone([0,-1,e.MSG.Loading]);var r=s.__GetLoadEventsNum();return s.__LoadImageFromBytesV1(t,3,c,r,h,o,a)}),(function(){return t.closeProgress(s,"HTTPDownloadDirectly"),t.isFunction(a)&&Cc(a,s),!1}),(function(e){var t=0===e.total?100:Math.round(100*e.loaded/e.total);[e.loaded," / ",e.total].join(""),s._OnPercentDone([0,t,"","http"])}),l)}},{key:"HTTPUploadThroughPostDirectly",value:function(e,r,n,i,o,a){var s=this;if(s._resetErr(),!s._isValid())return!1;if(s._isMobileMode())return s._mobileNotSupport("HTTPUploadThroughPostDirectly",a);var u=ti.combineUrl(s,e,n),c=function(){t.isFunction(a)&&Cc(a,s,s.__HTTPPostResponseString)};if(s.__HTTPPostResponseString="",""===e)return t.Errors.HttpServerCannotEmpty(s),c(),!1;return s._innerUploadDirectly(u,r,i,!0,!1,0,!0,!1,o,c)}},{key:"_innerUploadDirectly",value:function(e,r,n,i,o,a,s,u,c,l){var d,h=this,g=Ic(h),f="HTTPUploadThroughPostDirectly",m=!0;if(!1===e||""===e)return t.Errors.ParameterCannotEmpty(h),t.isFunction(l)&&l(h._errorCode,h._getErrorString()),!1;if(t.isFunction(c)||(m=!1),!t.License.checkProductKey(h,{Core:!0}))return t.isFunction(l)&&l(h._errorCode,h._getErrorString()),!1;t.cancelFrom=De;var _=function(){return t.needShowTwiceShowDialog=!1,i&&t.closeProgress(h,f),t.isFunction(l)&&l(h._errorCode,h._getErrorString()),!1};return t.needShowTwiceShowDialog=!0,i&&t.showProgress(h,f,!1),(d=ti.replaceLocalFilename(r))&&""!=d?u&&u.bCancel?(u.st=2,_()):dd(h,hd,_d).call(h,d,m,o,(function(r){return t.needShowTwiceShowDialog=!1,u&&u.bCancel?(u.st=2,_()):r&&(t.dlgRef>0||0==h.__IfShowCancelDialogWhenImageTransfer||0==m||!1===i)?(r instanceof File?r.fileName=n:r.name=n,Mc(h,!0),ti.httpPostUpload(h,e,r,m,0,g,!0,a,s,u,(function(e){i&&t.closeProgress(h,f),t.isFunction(c)&&Tc(c,e)}),_)):(_(),!1)}),_):(t.Errors.InvalidFile(h),_(),!1)}},{key:"_innerUploadFilesDirectly",value:function(e,r,n,i,o,a,s,u,c){var l,d=this,h=Ic(d),g="HTTPUploadThroughPostDirectly",f=!0,m=[];if(!1===e||""===e)return t.Errors.ParameterCannotEmpty(d),t.isFunction(c)&&c(d._errorCode,d._getErrorString(),r),!1;if(t.isFunction(u)||(f=!1),!t.License.checkProductKey(d,{Core:!0}))return t.isFunction(c)&&c(d._errorCode,d._getErrorString(),r),!1;t.cancelFrom=De;var _=function(){return t.needShowTwiceShowDialog=!1,i&&t.closeProgress(d,g),t.isFunction(c)&&c(r),!1};t.needShowTwiceShowDialog=!0,i&&t.showProgress(d,g,!1),t.each(r,(function(e){var r=ti.replaceLocalFilename(e);if(!r||""==r)return t.Errors.InvalidFile(d),_(),!1;m.push(r)}));var p=[],v=m.length,y=0;return t.each(m,(function(r,c){l=dd(d,hd,_d).call(d,r,f,o,(function(r){if(t.needShowTwiceShowDialog=!1,!r||!(t.dlgRef>0||0==d.__IfShowCancelDialogWhenImageTransfer||0==f||!1===i))return i&&t.closeProgress(d,g),t.isFunction(_)&&_(),!1;var o=ti.cformat(n,c+1);return r instanceof File?r.fileName=o:r.name=o,p[c]=r,++y==v?(Mc(d,!0),ti.httpPostUploadFiles(d,e,p,f,0,h,i,a,s,(function(e){i&&t.closeProgress(d,g),t.isFunction(u)&&Tc(u,e)}),(function(){i&&t.closeProgress(d,g),t.isFunction(_)&&_()}))):void 0}),(function(){i&&t.closeProgress(d,g),t.isFunction(_)&&_()}))})),l}},{key:"SetUploadSegment",value:function(e,r){var n=this;return n._resetErr(),!!n._isValid()&&(n._isMobileMode()?n._mobileNotSupport("SetUploadSegment"):!t.isNumber(e)||e<0?(t.Errors.InvalidSegmentUploadThreshold(n),!1):!t.isNumber(r)||r<=0?(t.Errors.InvalidModuleSize(n),!1):(n._segementUploadThreshold=1024*e*1024,n._moduleSize=1024*r,!0))}},{key:"_innerFormFieldHTTPUpload",value:function(r,n,i){var o,a=this,s="HTTPUpload",u=r;if(a.__HTTPPostResponseString="",o=function(){return t.needShowTwiceShowDialog=!1,t.closeProgress(a,s),t.isFunction(i)&&Cc(i,a,a.__HTTPPostResponseString),!1},t.isUndefined(u)||""===u)return t.Errors.ParameterCannotEmpty(a),o();if(!t.isString(u))return t.Errors.InvalidUrl(a),o();0!=u.indexOf("http://")&&0!=u.indexOf("https://")&&(u=t.detect.ssl?"https://"+u:"http://"+u),a.__HTTPPostResponseString="",t.cancelFrom=De,t.showProgress(a,s,!1),t.needShowTwiceShowDialog=!0;var c=Ic(a);a._OnPercentDone([0,-1,e.MSG.Uploading,"http"]);return ti.httpUploadByBIO(a,u,Or,0,!0,c,!0,0,!0,!1,(function(e){t.needShowTwiceShowDialog=!1,t.closeProgress(a,s),t.isFunction(n)&&Tc(n,e)}),o)}},{key:"__innnerHTTPUploadBinaryFull",value:function(r,n,i,o,a,s,u,c,l,d){var h=this,g=Ic(h),f=a,m=r;return e.DWT.IfAddMD5InUploadHeader&&n&&""!=n&&(g["dwt-md5"]=n),t.dlgRef>0||0==h.__IfShowCancelDialogWhenImageTransfer?(i instanceof File?i.fileName=f:i.name=f,Mc(h,!0),ti.httpPostUpload(h,m,i,!0,0,g,!0,s,u,c,(function(e){t.isFunction(l)&&Tc(l,e)}),d)):(t.Errors.UploadError(h,!0),d())}},{key:"ConvertToBase64",value:function(r,n,i,o){var a=this;if(a._resetErr(),!a._isValid())return!1;var s=[],u=arguments,c=parseInt(n),l=!1;if(!t.License.checkProductKey(a,{Core:!0}))return t.isFunction(o)&&o(a._errorCode,a._getErrorString()),!1;if(!a._checkIndices(r))return t.isFunction(o)&&Ec(o,a,r,n,u),!1;if(c==e.DWT.EnumDWT_ImageType.IT_BMP||c==e.DWT.EnumDWT_ImageType.IT_JPG||c==e.DWT.EnumDWT_ImageType.IT_PNG){if(r.length>1)return t.Errors.ConvertBase64IndexMoreThanOne(a),t.isFunction(o)&&Ec(o,a,r,n,u),!1}else if(c!=e.DWT.EnumDWT_ImageType.IT_TIF&&c!=e.DWT.EnumDWT_ImageType.IT_PDF)return t.Errors.InvalidImageType(a),t.isFunction(o)&&Ec(o,a,r,n,u),!1;t.isArray(r)&&t.each(r,(function(e){var t=a._ImgManager.convertClientIndexToServerId(e);-1!=t&&s.push(t)}));var d=function(e){var r=[];return t.isArray(s)&&t.each(s,(function(e){var t=a._ImgManager.convertServerIdToClientIndex(e);t>-1&&r.push(t)})),t.isFunction(i)&&Tc(i,e,r,n,u),!1},h=function(){var e=[];return t.isArray(s)&&t.each(s,(function(t){var r=a._ImgManager.convertServerIdToClientIndex(t);r>-1&&e.push(r)})),t.isFunction(o)&&Ec(o,a,e,n,u),!1},g=3;return a._convertToBase64ByServerIds(s,c,l,g,d,h)}},{key:"ClearAllHTTPFormField",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&(e.httpFormFields={},!0)}},{key:"SetHTTPFormField",value:function(e,r,n){var i=this;if(i._resetErr(),!i._isValid())return!1;var o=e;return t.isString(o)||(o=""+o),r instanceof Blob&&(r.name=n),i.httpFormFields[o]=r,!0}},{key:"HTTPDownloadThroughPost",value:function(r,n,i,o,a,s){var u,c=this,l=Ic(c),d=arguments,h=ti.combineUrl(c,r,n);if(h===undefined)return t.Errors.ParameterCannotEmpty(c),Or;if(!t.License.checkProductKey(c,{Core:!0}))return t.isFunction(a)&&Cc(a,c,d),Or;if(!t.License.checkPDFProductKeyWhenNeeds(c,i))return t.isFunction(a)&&Cc(a,c,d),Or;t.cancelFrom=ke,t.showProgress(c,"HttpDownloadThroughPost",Rr),u="post";var g=function(e){var t=0===e.total?100:Math.round(100*e.loaded/e.total);[e.loaded," / ",e.total].join(""),c._OnPercentDone([0,t,"","http"])},f=Rr;return c._OnPercentDone([0,-1,e.MSG.Downloading,"http"]),t.isFunction(o)||(f=Or),ti.loadHttpBlob(c,u,h,f,(function(t){c._OnPercentDone([0,-1,e.MSG.Loading]);var r=i;r!=e.DWT.EnumDWT_ImageType.IT_BMP&&r!=e.DWT.EnumDWT_ImageType.IT_JPG&&r!=e.DWT.EnumDWT_ImageType.IT_TIF&&r!=e.DWT.EnumDWT_ImageType.IT_PNG&&r!=e.DWT.EnumDWT_ImageType.IT_PDF&&r!=e.DWT.EnumDWT_ImageType.IT_J2K&&(r=-1);var n=c.__GetLoadEventsNum();c.__LoadImageFromBytesV1(t,r,"",n,f,o,a)}),(function(){t.closeProgress(c,"HttpDownloadThroughPost"),t.isFunction(a)&&Cc(a,c,d)}),g,l)}},{key:"HTTPDownloadThroughGet",value:function(e,t,r,n,i){return this._innerHTTPDownloadThroughGet(e,t,r,n,i)}},{key:"HTTPUploadThroughPut",value:function(e,t,r,n,i){var o=ti.getImageType(r);return this.HTTPUploadThroughPutEx(e,t,r,o,n,i)}},{key:"HTTPUploadThroughPutEx",value:function(r,n,i,o,a,s){var u=this,c=Ic(u),l="HTTPUploadThroughPutEx",d=ti.combineUrl(u,r,i),h=!0,g=[];if(d===undefined)return t.Errors.ParameterCannotEmpty(u),t.isFunction(s)&&Ec(s,u,"",[n],i,o),!1;t.isFunction(a)||(h=!1),t.cancelFrom=De;var f,m=function(){return t.needShowTwiceShowDialog=!1,t.closeProgress(u,l),t.isFunction(s)&&Ec(s,u,u.__HTTPPostResponseString,g,i,o),!1};switch(t.needShowTwiceShowDialog=!0,t.showProgress(u,l,!1),n){case-1:for(var _=0;_<u._ImgManager.count();_++)g.push(_);break;case-2:g=u._ImgManager.getSelectedClientIndexArray();break;default:if(g.push(n),!(n>=0))return t.Errors.IndexOutOfRange(u),m()}if(""===r)return t.Errors.HttpServerCannotEmpty(u),m();var p=[];t.isArray(g)&&t.each(g,(function(e){var t=u._ImgManager.convertClientIndexToServerId(e);-1!=t&&p.push(t)}));return u._OnPercentDone([0,-1,e.MSG.Encoding,"http"]),u.__innerConvertToBlob(o,p,!1,h,4,(function(r,n,s){if(e.DWT.IfAddMD5InUploadHeader&&n&&""!=n&&(c["dwt-md5"]=n),t.needShowTwiceShowDialog=!1,r&&(t.dlgRef>0||0==u.__IfShowCancelDialogWhenImageTransfer||0==h)){var g=u.__maxUploadImageSize;return r.size>g&&-1!=g?(t.Errors.UploadExceededMaxSize(u),m()):(f=function(e){var t=0===e.total?100:Math.round(100*e.loaded/e.total);[e.loaded," / ",e.total].join(""),u._OnPercentDone([0,t,"","http"])},u._OnPercentDone([0,-1,e.MSG.Uploading,"http"]),Mc(u,!0),ti.httpPutImage(u,d,r,h,(function(e){if(u.__HTTPPostResponseString=e,t.closeProgress(u,l),t.isFunction(a)){var r=[];t.isArray(p)&&t.each(p,(function(e){var t=u._ImgManager.convertServerIdToClientIndex(e);t>-1&&r.push(t)})),Tc(a,u.__HTTPPostResponseString,r,i,o)}return!0}),m,f))}return t.closeProgress(u,l),!1}),m)}},{key:"HTTPUploadAllThroughPutAsMultiPageTIFF",value:function(e,t,r,n){return this.HTTPUploadThroughPutEx(e,-1,t,2,r,n)}},{key:"HTTPUploadThroughPutAsMultiPageTIFF",value:function(e,t,r,n){return this.HTTPUploadThroughPutEx(e,-2,t,2,r,n)}},{key:"HTTPUploadAllThroughPutAsPDF",value:function(e,t,r,n){return this.HTTPUploadThroughPutEx(e,-1,t,4,r,n)}},{key:"HTTPUploadThroughPutAsMultiPagePDF",value:function(e,t,r,n){return this.HTTPUploadThroughPutEx(e,-2,t,4,r,n)}},{key:"GetSelectedImagesSize",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return!1;if(t._isMobileMode())return t._mobileNotSupport("GetSelectedImagesSize");var r=di(t);return t._innerFun("GetSelectedImagesSize",Zn(e,r.join(",")))}},{key:"SetHTTPHeader",value:function(e,r){var n=this;if(n._resetErr(),!n._isValid())return!1;var i,o,a=e;if(n.__httpHeaderMap||(n.__httpHeaderMap={}),!a||!t.isString(a))return t.isUndefined(a)?t.Errors.HttpHeaderIsUndefined(n):""===a?t.Errors.HttpHeaderIsEmpty(n):null===a?t.Errors.HttpHeaderIsNull(n):t.Errors.HttpHeaderIsInvalid(n),!1;for(i=["if-modified-since","if-none-match","if-range","range","accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"],a=a.toLowerCase(),o=0;o<i.length;o++)if(i[o]==a)return t.Errors.HttpHeaderNotAllowed(n),!1;return t.isUndefined(r)||null===r||""===r?(e in n.__httpHeaderMap&&delete n.__httpHeaderMap[e],!0):(t.isNumber(r)&&(r=""+r),n.__httpHeaderMap[e]=r,!0)}},{key:"ConvertToBlob",value:function(e,t,r,n,i){return this._convertToBlobByIndices(e,t,r,n,i)}},{key:"_asyncUploadFilesCmd",value:function(r,n,i,o,a,s,u,c,l,d){var h=this,g=parseInt(i),f="HTTPUpload",m=r,_=!1,p=[];h.__HTTPPostResponseString="",t.cancelFrom=De;var v=function(){if(h._bServerPercentDone=!0,t.needShowTwiceShowDialog=!1,s&&t.closeProgress(h,f),p=null,t.isFunction(d)){var e=[];t.isArray(n)&&t.each(n,(function(t){var r=h._ImgManager.convertServerIdToClientIndex(t);r>-1&&e.push(r)}));try{d(e)}catch(r){}}return!1};t.needShowTwiceShowDialog=!0,s&&t.showProgress(h,f,!1);var y=n.length,b=0,I=0,w="";return h._bServerPercentDone=!1,h._OnPercentDone([0,-1,e.MSG.Encoding,"http"]),t.each(n,(function(r,i){_=h.__innerConvertToBlob(g,[r],a,!0,4,(function(r,a,d){if(!r||r.size<=0)return t.Errors.UploadFileCannotEmpty(h),v();var g=h.__maxUploadImageSize;if(r.size>g&&-1!=g)return t.Errors.UploadExceededMaxSize(h),v();var S=ti.cformat(o,i+1);if(I=(b+1)/y*100,w=[b+1,"/",y].join(""),h._OnPercentDone([0,I,w,"http",S]),d[0],d[1],r.name=S,p.push(r),++b>=y){var T=Ic(h);e.DWT.IfAddMD5InUploadHeader&&a&&""!=a&&(T["dwt-md5"]=a),_=ti.httpPostUploadFiles(h,m,p,!0,0,T,s,u,c,(function(e){!function(e){if(h._bServerPercentDone=!0,t.needShowTwiceShowDialog=!1,s&&t.closeProgress(h,f),p=null,t.isFunction(l)){var r=[];t.isArray(n)&&t.each(n,(function(e){var t=h._ImgManager.convertServerIdToClientIndex(e);t>-1&&r.push(t)})),Tc(l,e,r)}}(e)}),v)}}),v,[r,i])})),_}},{key:"_convertToBase64ByServerIds",value:function(r,n,i,o,a,s){var u=this,c="ConvertToBase64",l=i;t.showProgress(u,c,!1);var d=function(){return t.closeProgress(u,c),t.isFunction(s)&&s(),!1},h=function(e){var n,i=0,o="",s="",l=e&&e.result;t.isArray(r)&&t.each(r,(function(e){u._ImgManager.convertServerIdToClientIndex(e)})),0==u._errorCode?l&&t.isArray(l)&&3==l.length?(s=l[0],i=l[1],o=l[2],n=new ad(null,i,o,s),t.closeProgress(u,c),t.isFunction(a)&&Tc(a,n)):(t.Errors.ConvertBase64Failed(u),d()):d()};if(u._isMobileMode())return n==e.DWT.EnumDWT_ImageType.IT_BMP?(t.closeProgress(u,c),u._mobileNotSupport("Convert to bmp",s)):u._innerConvertToBase64ByMobile("",r,n,o,h,d);t.isString(l)&&""!=l||(l="{}");var g=["[",n,',"',r.join(","),'",',l,",1]"].join("");return u._innerFunRaw(c,g,!0,!1,!0,h,d)}},{key:"_innerConvertToBase64ByMobile",value:function(r,n,i,o,a,s){var u,c,l=this,d=[];if(i==e.DWT.EnumDWT_ImageType.IT_BMP)return u="bmp",l._mobileNotSupport("Convert to bmp",s);if(u=i==e.DWT.EnumDWT_ImageType.IT_JPG?"jpg":i==e.DWT.EnumDWT_ImageType.IT_PNG?"png":i==e.DWT.EnumDWT_ImageType.IT_TIF?"tiff":i==e.DWT.EnumDWT_ImageType.IT_PDF?"pdf":i==e.DWT.EnumDWT_ImageType.IT_J2K?"jp2":"png",t.isArray(n))for(c=0;c<n.length;c++)d.push(l._ImgManager.convertServerIdToClientIndex(n[c]));return l._innerSendToMobile("SaveImage",Kn(r,d,u,o,!1),0,(function(e,r,n){if(e instanceof Uint8ClampedArray||e instanceof ArrayBuffer||e instanceof Uint8Array){var i=new FileReader;i.onload=function(e){var r,n=null==e||null===(r=e.target)||void 0===r?void 0:r.result,o=t.isString(n)?n.split(","):[];o.length>=2&&(n=o[1]),t.isFunction(a)&&a({result:[n,n.length,i.md5]})};var o="image/"+r;return"pdf"==r&&(o="application/pdf"),void l._innerSendToMobile("GetMD5",Kn(e),0,(function(t){i.md5=t,i.readAsDataURL(new Blob([e],{type:o}))}),s)}a({result:[e,e.length,n]})}),s)}},{key:"__innerGetBarcodeResultAsyncFunction",value:function(t){var r=e.Lib.NewBarcodeResult();return t&&(r._errorCode=t.exception,r._errorString=t.description,r._resultlist=t.result,r._Count=t.result.length),r}},{key:"__innerGetOCRResultAsyncFunction",value:function(t){var r=e.Lib.NewOCRResult(this);return t&&(r._errorCode=t.exception,r._errorString=t.description,r._resultlist=t.result),r}},{key:"__innerFTPDownloadDirectly",value:function(e,r,n,i,o){var a=this;return t.License.checkProductKey(a,{Core:!0})&&t.License.checkPDFProductKeyWhenNeeds(a,n)?(t.cancelFrom=Pe,dd(a,gd,pd).call(a,e,r,!0,i,o)):(t.isFunction(o)&&o(a._errorCode,a._errorString),!1)}},{key:"__innerFTPUpload",value:function(t,r,n,i){return e.Lib.cancelFrom=xe,dd(this,gd,pd).call(this,t,r,!0,n,i)}}]),i}(ud);function _d(e,r,n,i,o){var a=this;if(r)return a._innerFunRaw("SaveSelectedImagesToBytes",Zn(0,0,e,n),r,true,!0,(function(e){if(t.isFunction(i)){var r=new Blob([e]);i(r),r=null}}),o),!0;var s=a._innerFunRaw("SaveSelectedImagesToBytes",Zn(0,0,e,n),r,true,!1);return 0==a._errorCode?i(s):(o(),!1)}function pd(r,n,i,o,a){var s=this;if(!t.isFunction(a))return this._innerFun(r,n);return e.Lib.showProgress(s,r,i),this._innerSend(r,n,!0,(function(){e.Lib.closeProgress(s,r),t.isFunction(o)&&o()}),(function(n){return t.isFunction(a)&&a(s._errorCode,s._getErrorString()),e.Lib.closeProgress(s,r),n&&e.Lib.error(n),!0})),!0}function vd(r,n,i,o,a){var s,u=this;if(!t.License.checkProductKey(u,{Core:!0}))return t.isFunction(a)&&a(u._errorCode,u._errorString),!1;if(!t.License.checkPDFProductKeyWhenNeeds(u,i))return t.isFunction(a)&&a(u._errorCode,u._errorString),!1;if(t.cancelFrom=Pe,t.isFunction(a))return dd(u,gd,pd).call(u,r,n,!0,(function(){var r=u._ImgManager.getCurrentImageIndex();r>=0&&u.__onRefreshUI(r),u._blts&&e.DWT.lcvrf(u),t.isFunction(o)&&o()}),a);var c=u._innerGetCurrentDocumentName();""==c&&u._ImgManager&&(c=u._ImgManager.getWebViewer().GetDefaultFileName()),(s=u.__innerLoadImageFun(r,n,1,c))&&u._blts&&e.DWT.lcvrf(u);var l=u._ImgManager.getCurrentImageIndex();return l>=0&&u.__onRefreshUI(l),s}function yd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(es){return!1}}();return function(){var r,n=et(e);if(t){var i=et(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return $e(this,r)}}function bd(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function Id(e,t,r){if(!t.has(e));return r}var wd=e.navInfoSync,Sd=new WeakSet,Td=new WeakSet,Cd=function(r){Qe(i,r);var n=yd(i);function i(){var e;Le(this,i);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return bd(Ze(e=n.call.apply(n,[this].concat(r))),Td),bd(Ze(e),Sd),e}return Ae(i,[{key:"LoadDibFromClipboard",value:function(e,r){var n,i,o=this,a="LoadDibFromClipboard";if(o._resetErr(),!o._isValid())return!1;if(o._isMobileMode())return o._mobileNotSupport(a,r);if(o._bRemoteMode)return t.Errors.RemoteServiceCannotLoadDibFromClipboard(o),{code:o._errorCode,message:o._getErrorString()};e&&t.isFunction(e)&&(n=function(t){e()}),r&&t.isFunction(r)&&(i=function(){r(o._errorCode,o._getErrorString())});var s;return s=o.__GetLoadEventsNum(),o.__innerLoadImage(a,Zn(s,1),-1,!0,1,n,i)}},{key:"CancelAllPendingTransfers",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&(e._isMobileMode()?e._mobileNotSupport("CancelAllPendingTransfers"):this._innerFun("CancelAllPendingTransfers"))}},{key:"CloseSource",value:function(){var e=this;if(e._resetErr(),!e._isValid())return!1;if(e._isMobileMode())return e._mobileNotSupport("CloseSource");if(e._curDevice&&((e._curDevice.deviceType&ae)==ae||(e._curDevice.deviceType&se)==se))return!0;var t=e._innerFun("CloseSource");return t&&(e._curDevice=null),t}},{key:"CloseSourceManager",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&(e._isMobileMode()?e._mobileNotSupport("CloseSourceManager"):e._innerFun("CloseSourceManager"))}},{key:"SelectDevice",value:function(r,n){var i,o=this,a="SelectDevice",s=r?r.deviceType:0;if(o._resetErr(),o._isMobileMode())return o._mobileNotSupport(a);if(e.DWT.ConnectWithSocket)return o._mobileNotSupport(a);var u,c=null===(i=this._dmService.attrs)||void 0===i?void 0:i.UUID;if(c)if((null===(u=r.serviceInfo.attrs)||void 0===u?void 0:u.UUID)==c);else{var l,d=(null===(l=r.serviceInfo.attrs)||void 0===l?void 0:l.url)||r.serviceInfo.server;if(!(d&&d.indexOf(c)>-1))return t.Errors.DeviceNotFound(o),!1}var h=!1;try{if(gi(s))h=Id(this,Sd,Ed).call(this,r.strDevice,n);else if(fi(s)){o._dmSync&&(o._dmSync.bLicenseOK=!1),h=Id(this,Td,Md).call(this,!1).selectSource(r)}h&&(this._curDevice=r,this._bSelectedSourceByServer=!1)}catch(g){h=!1,this._errorCode=e.DWT.EnumDWT_Error.CommonError,g&&g.message&&(this._errorString=g.message)}return h}},{key:"DisableSource",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&(e._isMobileMode()?e._mobileNotSupport("DisableSource"):e._innerFun("DisableSource"))}},{key:"FeedPage",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&(e._isMobileMode()?e._mobileNotSupport("FeedPage"):e._innerFun("FeedPage"))}},{key:"GetDeviceType",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&(e._isMobileMode()?e._mobileNotSupport("GetDeviceType"):e._innerFun("GetDeviceType"))}},{key:"GetSourceNameItems",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&(t._isMobileMode()?t._mobileNotSupport("GetSourceNameItems"):(t.__sourceCount<0&&(t.__sourceCount=0),e<t.__sourceCount&&e>=0?t._getSourceNameByIndex(e):""))}},{key:"SourceNameItems",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&(t._isMobileMode()?t._mobileNotSupport("SourceNameItems"):t.GetSourceNameItems(e))}},{key:"GetSourceNames",value:function(e){return this._innerGetSourceNamesSync(e)}},{key:"getSourceCount",value:function(e){return this._getSourceCountAsync(e)}},{key:"GetSourceCountAsync",value:function(e){return this._getSourceCountAsync(e)}},{key:"GetSourceType",value:function(e){var r=this,n=parseInt(e);if(r._resetErr(),isNaN(n))return t.Errors.InvalidParameter(r),!1;if(null==r.__devices&&r.GetSourceNames(!1),n>=r.__devices.length||n<0)return t.Errors.IndexOutOfRange(r),!1;var i,o,a,s=r.__devices[n];return i=s.deviceType,o=j,(a=i&ue)==te||a==re||(a==ne?o=J:a==ie?o=z:a==oe?o=H:(a&ne)==ne?(a&te)!=te&&(a&re)!=re||(o=Y):(a&ie)==ie&&((a&te)!=te&&(a&re)!=re||(o=X))),o}},{key:"OpenSource",value:function(){var e=this,r="OpenSource";return e._resetErr(),!!e._isValid()&&(e._isMobileMode()?e._mobileNotSupport(r):!(!e._curDevice||(e._curDevice.deviceType&ae)!=ae&&(e._curDevice.deviceType&se)!=se)||(e._bRemoteMode?(t.Errors.OpenSourceMustAsyncWhenRemote(e),{code:e._errorCode,message:e._getErrorString()}):e._innerFun(r)))}},{key:"OpenSourceManager",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&(e._isMobileMode()?e._mobileNotSupport("OpenSourceManager"):e._innerFun("OpenSourceManager"))}},{key:"ResetImageLayout",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&(e._isMobileMode()?e._mobileNotSupport("ResetImageLayout"):e._innerFun("ResetImageLayout"))}},{key:"RewindPage",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&(e._isMobileMode()?e._mobileNotSupport("RewindPage"):e._innerFun("RewindPage"))}},{key:"SelectSource",value:function(e,r){var n=this;if(n._resetErr(),!n._isValid())return!1;if(n._isMobileMode())return n._mobileNotSupport("SelectSource",r);var i=j;if(t.isUndefined(e)){if(n._bRemoteMode)return t.Errors.SelectSourceMustAsyncWhenRemote(n),!1;if(n._driverType==Y)return t.Errors.SelectSourceMustAsync(n),!1;n._driverType!=z&&n._driverType!=H&&n._driverType!=J||(i=n._driverType);var o=wd.bMac,a=wd.bLinux,s=oi(i,wd.bWin,a,o);return n._bSelectedSourceByServer=!0,n._curDevice=null,n._innerFun("SelectSource",Zn(s))}n._driverType!=z&&n._driverType!=H&&n._driverType!=J&&n._driverType!=Y||(i=n._driverType);var u=wd.bMac,c=wd.bLinux,l=oi(i,wd.bWin,c,u);return n.SelectSourceAsync(l).then((function(){t.isFunction(e)&&e()}),(function(){t.isFunction(r)&&r(n._errorCode,n._getErrorString())})),!0}},{key:"GetSourceTypeAsync",value:function(e){var r=this,n=1*e;return r._resetErr(),r._isValid()?r._isMobileMode()?r._mobileNotSupportAsync("GetSourceType"):t.Promise.resolve(r.GetSourceType(n)):t.Promise.reject({code:r._errorCode,message:r._errorString})}},{key:"SetFileXferInfo",value:function(t,r){var n,i,o=this;return o._resetErr(),!!o._isValid()&&(o._isMobileMode()?o._mobileNotSupport("SetFileXferInfo"):(n=e.navInfoSync.bFileSystem?t.replace(/<%/g,"<%25"):t,i=ti.replaceLocalFilename(n),o._innerFun("SetFileXferInfo",Zn(i,r))))}},{key:"SetImageLayout",value:function(e,t,r,n){var i=this;return i._resetErr(),!!i._isValid()&&(i._isMobileMode()?i._mobileNotSupport("SetImageLayout"):i._innerFun("SetImageLayout",Zn(e,t,r,n)))}},{key:"CapGet",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&(e._isMobileMode()?e._mobileNotSupport("CapGet"):this._innerFun("CapGet"))}},{key:"CapGetCurrent",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&(e._isMobileMode()?e._mobileNotSupport("CapGetCurrent"):this._innerFun("CapGetCurrent"))}},{key:"CapGetDefault",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&(e._isMobileMode()?e._mobileNotSupport("CapGetDefault"):this._innerFun("CapGetDefault"))}},{key:"CapGetFrameBottom",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&(t._isMobileMode()?t._mobileNotSupport("CapGetFrameBottom"):this._innerFun("CapGetFrameBottom",Zn(e)))}},{key:"CapGetFrameLeft",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&(t._isMobileMode()?t._mobileNotSupport("CapGetFrameLeft"):this._innerFun("CapGetFrameLeft",Zn(e)))}},{key:"CapGetFrameRight",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&(t._isMobileMode()?t._mobileNotSupport("CapGetFrameRight"):this._innerFun("CapGetFrameRight",Zn(e)))}},{key:"CapGetFrameTop",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&(t._isMobileMode()?t._mobileNotSupport("CapGetFrameTop"):this._innerFun("CapGetFrameTop",Zn(e)))}},{key:"CapGetHelp",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&(e._isMobileMode()?e._mobileNotSupport("CapGetHelp"):this._innerFun("CapGetHelp"))}},{key:"CapGetLabel",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&(e._isMobileMode()?e._mobileNotSupport("CapGetLabel"):this._innerFun("CapGetLabel"))}},{key:"CapGetLabels",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&(e._isMobileMode()?e._mobileNotSupport("CapGetLabels"):this._innerFun("CapGetLabels"))}},{key:"CapIfSupported",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&(t._isMobileMode()?t._mobileNotSupport("CapIfSupported"):this._innerFun("CapIfSupported",Zn(e)))}},{key:"CapReset",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&(e._isMobileMode()?e._mobileNotSupport("CapReset"):this._innerFun("CapReset"))}},{key:"CapSet",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&(e._isMobileMode()?e._mobileNotSupport("CapSet"):this._innerFun("CapSet"))}},{key:"CapSetFrame",value:function(e,t,r,n,i){var o=this;return o._resetErr(),!!o._isValid()&&(o._isMobileMode()?o._mobileNotSupport("CapSetFrame"):this._innerFun("CapSetFrame",Zn(e,t,r,n,i)))}},{key:"GetCapItems",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&(t._isMobileMode()?t._mobileNotSupport("GetCapItems"):this._innerFun("GetCapItems",Zn(e)))}},{key:"GetCapItemsString",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&(t._isMobileMode()?t._mobileNotSupport("GetCapItemsString"):this._innerFun("GetCapItemsString",Zn(e)))}},{key:"SetCapItems",value:function(e,t){var r=this;return r._resetErr(),!!r._isValid()&&(r._isMobileMode()?r._mobileNotSupport("SetCapItems"):this._innerFun("SetCapItems",Zn(e,t)))}},{key:"SetCapItemsString",value:function(e,t){var r=this;return r._resetErr(),!!r._isValid()&&(r._isMobileMode()?r._mobileNotSupport("SetCapItemsString"):this._innerFun("SetCapItemsString",Zn(e,t)))}},{key:"GenerateURLForUploadData",value:function(r,n,i,o,a){var s=this,u=[];if(n==e.DWT.EnumDWT_ImageType.IT_BMP||n==e.DWT.EnumDWT_ImageType.IT_JPG||n==e.DWT.EnumDWT_ImageType.IT_PNG){if(!t.isArray(r))return t.Errors.IndicesNotArray(s),t.isFunction(o)&&o(s._errorCode,s._getErrorString(),"",r,n),"";if(r.length>1)return t.Errors.UploadIndexMoreThanOne(s),t.isFunction(o)&&o(s._errorCode,s._getErrorString(),"",r,n),"";if(!s._checkIndices(r))return o(s._errorCode,s._getErrorString(),"",r,n),!1;var c=s._ImgManager.convertClientIndexToServerId(r[0]);-1!=c&&u.push(c)}else{if(n!=e.DWT.EnumDWT_ImageType.IT_TIF&&n!=e.DWT.EnumDWT_ImageType.IT_PDF)return t.isArray(r)?t.Errors.InvalidImageType(s):t.Errors.IndicesNotArray(s),t.isFunction(o)&&o(s._errorCode,s._getErrorString(),s.__HTTPPostResponseString,r,n),"";var l,d;if(t.isArray(r)){if(!s._checkIndices(r))return o(s._errorCode,s._getErrorString(),"",r,n),!1;l=r}else{if(-1!=r)return t.Errors.IndicesNotArray(s),t.isFunction(o)&&o(s._errorCode,s._getErrorString(),s.__HTTPPostResponseString,r,n),"";for(l=[],d=0;d<s._ImgManager.count();d++)l.push(d)}t.each(l,(function(e){var t=s._ImgManager.convertClientIndexToServerId(e);-1!=t&&u.push(t)}))}if(t.isFunction(i)&&t.isFunction(o)){return s._asyncGenerateURLForUploadData(u,n,a,i,(function(e){o(s._errorCode,s._getErrorString(),s.__HTTPPostResponseString,e,n)})),!0}return this._syncGenerateURLForUploadData(u,n,a)}},{key:"_syncGenerateURLForUploadData",value:function(r,n,i){var o,a=this,s=!1,u=e.dcp.managerVersion.join(""),c=i,l=",";t.isString(c)&&""!=c||(c="",l="");var d=["[",'"dcp","dwasm_'+u,'",',n,',"',r.join(","),'"',l,c,"]"].join("");if((o=this._innerFunRaw("GenerateURLForUploadData",d,!1,!1,!0))&&t.isArray(o.result)&&o.result.length>1){var h=o.result[0],g=o.result[1];1==h&&(s=["dcp://dwasm_",u,"/file/",g].join(""))}return t.isArray(r)&&t.each(r,(function(e){a._ImgManager.convertServerIdToClientIndex(e)})),0==s?(t.Errors.GenerateURL_InvalidRetFromServer(a),""):s}},{key:"_asyncGenerateURLForUploadData",value:function(r,n,i,o,a){var s=this,u=n,c=function(){if(t.isFunction(a)){var e=[];t.isArray(r)&&t.each(r,(function(t){var r=s._ImgManager.convertServerIdToClientIndex(t);r>-1&&e.push(r)})),a(e)}return""},l=",";if(u==e.DWT.EnumDWT_ImageType.IT_BMP||u==e.DWT.EnumDWT_ImageType.IT_JPG||u==e.DWT.EnumDWT_ImageType.IT_PNG){if(r.length>1)return t.Errors.UploadIndexMoreThanOne(s),c(),""}else if(u!=e.DWT.EnumDWT_ImageType.IT_TIF&&u!=e.DWT.EnumDWT_ImageType.IT_PDF)return t.Errors.InvalidImageType(s),c(),"";var d=!1,h=e.dcp.managerVersion.join(""),g=i;t.isString(g)&&""!=g||(g="",l="");var f=["[",'"dcp","dwasm_'+h,'",',u,',"',r.join(","),'"',l,g,"]"].join("");return this._innerFunRaw("GenerateURLForUploadData",f,!0,!1,!0,(function(e){if(e&&t.isArray(e.result)&&e.result.length>0)if(1==e.result[0]&&e.result.length>1){var i=e.result[1];d=["dcp://dwasm_",h,"/file/",i].join("")}else e.exception!==undefined&&e.description!==undefined?(s._errorCode=e.exception,s._errorString=e.description):t.Errors.GenerateURL_InvalidRetFromServer(s);else t.Errors.GenerateURL_InvalidRetFromServer(s);if(0==d)return c(),"";if(t.isFunction(o)){var a=[];t.isArray(r)&&t.each(r,(function(e){var t=s._ImgManager.convertServerIdToClientIndex(e);t>-1&&a.push(t)})),o(d,a,n)}return d}),c)}},{key:"SourceCount",get:function(){return this._getSourceCountSync()}},{key:"MaxUploadImageSize",get:function(){return this._resetErr(),this._isValid()?this.__maxUploadImageSize:Or},set:function(e){var r=this;if(r._resetErr(),this._isValid()){var n=1*e;!t.isNumber(n)||isNaN(n)?t.Errors.InvalidValue(r):(r.__maxUploadImageSize=n,r._isMobileMode()||r._innerFun("MaxUploadImageSize",Zn(n)))}}},{key:"CurrentSourceName",get:function(){var e=this,t="CurrentSourceName";return e._isMobileMode()?(e._mobileNotSupport(t),""):e._curDevice?e._curDevice.name:e._innerFun(t)}}]),i}(md);function Ed(e,t){var r=["[",e,",",null!=t?t:fe,"]"].join("");return this._innerFun("SelectSourceEx",r)}function Md(r){if(!this._dmSync){var n,i,o,a,s,u,c,l;if(this._dmSync=new Uu(null===(n=this._dmService)||void 0===n||null===(i=n.attrs)||void 0===i?void 0:i.url,!1,this._clientId,null===(o=this._dmService)||void 0===o||null===(a=o.attrs)||void 0===a?void 0:a.ty),this._bRemoteMode)s=null!==(u=null===(c=this._dmService)||void 0===c||null===(l=c.attrs)||void 0===l?void 0:l.UUID)&&void 0!==u?u:"";else s="";!function(r,n,i){var o;try{if(t.License.isLTS()){var a="",s="";if(e.navInfoSync.bAndroid){var u=zi(e.DWT.EnumInstance.dwt_browser,"");s=u.ar,a=u.cu}else{""==i&&oa(r._bRemoteMode);var c=zi(e.DWT.EnumInstance.dwt_desktop,i);s=c.ar,a=c.cu}o=n.getLicenseInfoSync(s,a)}else o=n.getLicenseInfoSync(e.DWT.ProductKey)}catch(l){throw l}}(this,this._dmSync,s)}return this._dmSync}function Dd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(es){return!1}}();return function(){var r,n=et(e);if(t){var i=et(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return $e(this,r)}}function kd(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function xd(e,t,r){if(!t.has(e));return r}var Pd=12,Wd=13,Ld=14,Fd=function Xh(e,r){if(!t.isUndef(e)&&!t.isUndef(r)&&null!=e&&null!=r){for(var n in r)e.hasOwnProperty(n)?"object"===Fe(e[n])&&Xh(e[n],r[n]):e[n]=r[n];return e}},Vd=new WeakSet,Nd=new WeakSet,Ad=function(r){Qe(i,r);var n=Dd(i);function i(){var e;Le(this,i);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return kd(Ze(e=n.call.apply(n,[this].concat(r))),Nd),kd(Ze(e),Vd),e}return Ae(i,[{key:"checkStartScanParams",value:function(r,n){var i=this;if(!r)return t.Errors.ScanUploader_InvalidScanSetup(i),!1;if(!t.isUndefined(n.transferMode)&&0!=r.transferMode&&1!=r.transferMode&&2!=r.transferMode)return t.Errors.ScanUploader_InvalidTransferMode(i),!1;if(r.transferMode==e.DWT.EnumDWT_TransferMode.TWSX_FILE){if(!r.fileXfer)return t.Errors.ScanUploader_InvalidFileXfer(i),!1;if(!t.isString(r.fileXfer.fileName)||""==r.fileXfer.fileName)return t.Errors.ScanUploader_InvalidFileXferFilename(i),!1;if(!t.isNumber(r.fileXfer.fileFormat)||r.fileXfer.fileFormat<0||r.fileXfer.fileFormat>16)return t.Errors.ScanUploader_InvalidFileXferFileFormat(i),!1}if(n){if(!t.isString(n.type)||""==n.type)return t.Errors.ScanUploader_InvalidHttpType(i),!1;if(!n.httpParams)return t.Errors.ScanUploader_InvalidHttpParams(i),!1;if(r.transferMode!=e.DWT.EnumDWT_TransferMode.TWSX_FILE&&t.isUndefined(n.format))return t.Errors.ScanUploader_InvalidOutputFormat(i),!1;if(!t.isString(n.httpParams.url)||""==n.httpParams.url)return t.Errors.ScanUploader_InvalidHttpUrl(i),!1;if(!t.isString(n.httpParams.fileName)||""==n.httpParams.fileName)return t.Errors.ScanUploader_InvalidHttpFilename(i),!1}return!0}},{key:"startScan",value:function(r){var n=this,i=r;if(n._resetErr(),!n._isValid())return!1;if(n._isMobileMode())return n._mobileNotSupportAsync("startScan");if(1==n._startScanFlag)return t.Errors.StartScanFailed(n),t.Promise.reject({code:n._errorCode,message:n._getErrorString()});n._startScanFlag=!0,t.isObject(i)||(i={});var o,a,s,u=!1,c=!1,l=!0,d=!0,h=!0,g=!1,f=i.onFinally,m=[],_=[],p=0,v=1,y=[],b={type:"http",format:e.DWT.EnumDWT_ImageType.IT_PDF,reTries:3,useUploader:!1,singlePost:!0,showProgressBar:!0,removeAfterOutput:!0,httpParams:{url:"",headers:{},formFields:{},remoteName:"RemoteFile",fileName:""}},I=t.clone(i),w=i;if(s=I.funcScanStatus,delete I.funcScanStatus,t.isFunction(s)?I.bfuncScanStatus=!0:I.bfuncScanStatus=!1,I.outputSetup){var S={pdfSetup:{},tiffSetup:{}};Fd(I.outputSetup,b),a=I.outputSetup,delete I.outputSetup,a.pdfSetup&&(a.format!=e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF&&a.format!=e.DWT.EnumDWT_ImageType.IT_PDF||t.mix(S.pdfSetup,a.pdfSetup)),a.tiffSetup&&(a.format!=e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_TIF&&a.format!=e.DWT.EnumDWT_ImageType.IT_TIF||t.mix(S.tiffSetup,a.tiffSetup)),a.format!=e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF&&a.format!=e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_TIF||(a.singlePost=!0),t.isNumber(a.httpParams.threads)&&(v=a.httpParams.threads),u=t.stringify(S),c=n.checkStartScanParams(I,a)}else(a=b).type="",c=n.checkStartScanParams(I,!1);if(!c)return new t.Promise((function(e,t){l&&(t({code:n._errorCode,message:n._getErrorString(),response:""}),l=!1,n._startScanFlag=!1)}));a.funcHttpUploadStatus&&(g=a.funcHttpUploadStatus);var T,C,E,M,D,k=n.HttpFieldNameOfUploadedImage,x=n.MaxUploadImageSize,P=n.IfShowProgressBar,W=n.__IfShowCancelDialogWhenImageTransfer,L=n.__OnPostTransferAsync,F=n.__OnPostAllTransfers,V=n.__OnHttpUploadStatus,N=n.__insertingIndex,A=n.__IfAppendImage,B=n.httpFormFields,O=n._tiffCompressionType,R=!1,U=a.showProgressBar;if((T=function(e){var r=!0;t.each(y,(function(e,t){-1==e.st&&(r=!1)})),r?C(e):setTimeout((function(){T(e)}),200)},C=function(t){t.__OnPostTransferAsync=L,t.__OnPostAllTransfers=F,t.__OnHttpUploadStatus=V,t.HttpFieldNameOfUploadedImage=k,t.__maxUploadImageSize=x,t.IfShowProgressBar=P,t.__IfShowCancelDialogWhenImageTransfer=W,t.__insertingIndex=N,t.__IfAppendImage=A,t.httpFormFields=B,t._tiffCompressionType=O,t.__OnCancel=!1,e.FileUploader&&(e.FileUploader.nextLoopTime=600),t._startScanFlag=!1},E=function(e,t,r){d?(t(r),T(e)):setTimeout((function(){E(e,t,r)}),200)},M=function(e,t){R=!0,l&&(l=!1,d||n._innerSendCmd("CancelAllPendingTransfers"),E(n,e,t))},D=function(e,r,n,i){if(t.isFunction(g)){var o,a=r,s=0;t.isNumber(i)&&i>0&&(s=i),o={fileName:a,percentage:n,statusCode:s,responseString:e.__HTTPPostResponseString},setTimeout((function(){g(o)}),10)}},n.__OnCancel=!1,n.__HTTPPostResponseString="",n.IfShowProgressBar=U,n.__IfShowCancelDialogWhenImageTransfer=U,t.isNumber(I.insertingIndex)&&I.insertingIndex>-1&&(n.__insertingIndex=I.insertingIndex,n.__IfAppendImage=!1),t.isFunction(g)?n.__OnHttpUploadStatus=g:n.__OnHttpUploadStatus=!1,a.useUploader)&&!e.FileUploader)return new t.Promise((function(e,r){t.Errors.Uploader_ModuleError(n);var i={code:n._errorCode,message:n._getErrorString(),response:""};d=!0,M(r,i)}));if(o=a.reTries,a.useUploader){var G=a.httpParams.url;if(!t.startsWith(G,"http://")&&!t.startsWith(G,"https://")){var j=window.location.href,z=j.lastIndexOf("/");j=j.substring(0,z+1),a.httpParams.url=j+G}}else t.each(a.httpParams.headers,(function(e,t){n.SetHTTPHeader(t,e)})),t.each(a.httpParams.formFields,(function(e,t){n.SetHTTPFormField(t,e)}));return""!==a.httpParams.remoteName&&(n.HttpFieldNameOfUploadedImage=a.httpParams.remoteName),new t.Promise((function(t,r){a.useUploader?e.FileUploader.Init(0,(function(e){t({uploadManager:e})}),(function(e,t){n._errorCode=e,n._errorString=t;var i={code:e,message:t,response:n.__HTTPPostResponseString};d=!0,M(r,i)})):t({})})).then((function(r){return new t.Promise((function(i,c){var l=function S(){(I.transferMode==e.DWT.EnumDWT_TransferMode.TWSX_FILE?p==_.length:p==m.length)?(t.closeProgress(n,"Scan Upload"),R=!0,i(w),C(n)):setTimeout(S,100)};s&&t.isFunction(s)&&(n.__OnPreAllTransfersAsync=function(e){s(e)}),n._innerRegisterEvent("OnPostTransferAsync",(function(i){var l,f,b,w,S,T=a.httpParams.url,C=n._objImageIndexManager.convertGuidToServerId(i.imageId),E=a.singlePost,k=I.transferMode==e.DWT.EnumDWT_TransferMode.TWSX_FILE,x=a.removeAfterOutput,P=0;if(h&&(d=!1,h=!1),k?(P=_.length,_.push(i.path)):(P=m.length,m.push(C)),s&&t.isFunction(s)){var W={event:"postTransfer",bScanCompleted:!1,result:{currentPageNum:P+1}};setTimeout((function(){s(W)}),10)}if(R)return!1;if("http"==a.type)if(f=ti.cformat(a.httpParams.fileName,P+1),b=ti.cformat(a.httpParams.remoteName,P+1),E||"http"!=a.type)!E&&a.type;else if(t.isNumber(a.httpParams.maxSizeLimit)&&(n.__maxUploadImageSize=a.httpParams.maxSizeLimit),a.useUploader){U&&(e.FileUploader.nextLoopTime=300,t.showProgress(n,"Scan Upload",!0)),w=function(e,r){return n.__HTTPPostResponseString=r,D(n,e._fileName,100,200),n._OnPercentDone([0,100,"","http",e._fileName]),U&&t.closeProgress(n,"Scan Upload"),!k&&a.removeAfterOutput?setTimeout((function(){n._ImgManager.convertServerIdToClientIndex(C)>-1?xd(n,Nd,Od).call(n,C,(function(){p++}),(function(){p++})):p++}),100):p++,!0};var L,F,V=r.uploadManager;if(L=function(){if(U){var e,r=0;for(r=k?_.length:m.length,e=0;e<r;e++)t.closeProgress(n,"Scan Upload")}!k&&a.removeAfterOutput&&setTimeout((function(){n._ImgManager.convertServerIdToClientIndex(C)>-1&&xd(n,Nd,Od).call(n,C)}),100),V.CancelAllUpload();var i={code:n._errorCode,message:n._getErrorString(),response:n.__HTTPPostResponseString};return M(c,i),!1},S=function(e,t,r,i){var o=303;t==Pd?o=404:t==Wd?o=500:t==Ld&&(o=503),n._errorCode=t,n._errorString=r,n.__HTTPPostResponseString=i,D(n,f,100,o),L()},n.__OnCancel=function(){S(null,e.DWT.EnumDWT_Error.UserCancelled,"User cancelled the operation.","")},F=function(){n.__HTTPPostResponseString="",D(n,f,100,303),L()},k){var N=V.CreateJob(),A=N.FormField;t.each(a.httpParams.headers,(function(e,t){N.HttpHeader[t]=e})),t.each(a.httpParams.formFields,(function(e,t){A.Add(t,e)})),N.ServerUrl=T,N.bDeleteFile=x,N.reTries=o,t.isNumber(a.httpParams.maxSizeLimit)&&(N.maxSizeLimit=a.httpParams.maxSizeLimit),N._fileName=f,N.SourceValue.Add(i.path,f,b),N.ImageType=I.fileXfer.fileFormat,N.ThreadNum=v,N.OnRunSuccess=w,N.OnRunFailure=S,(U||t.isFunction(g))&&(N.OnUploadTransferPercentage=function(e,r){r>0&&r<=100&&(100==r&&(r=99),U&&n._OnPercentDone([0,r,"","http",e._fileName]),t.isFunction(g)&&D(n,e._fileName,r,0))},t.cancelFrom=We,U&&n._OnPercentDone([0,-1,e.MSG.Uploading,"http",f]),D(n,f,0,0)),V.Run(N)}else(l=a.format)==e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF?l=e.DWT.EnumDWT_ImageType.IT_PDF:l==e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_TIF&&(l=e.DWT.EnumDWT_ImageType.IT_TIF),U&&(t.cancelFrom=We,n._OnPercentDone([0,-1,e.MSG.Encoding,"http",f])),n._asyncGenerateURLForUploadData([C],l,u,(function(r){var i=V.CreateJob(),s=i.FormField;t.each(a.httpParams.headers,(function(e,t){i.HttpHeader[t]=e})),t.each(a.httpParams.formFields,(function(e,t){s.Add(t,e)})),i.ServerUrl=T,i.bDeleteFile=x,i.reTries=o,t.isNumber(a.httpParams.maxSizeLimit)&&(i.maxSizeLimit=a.httpParams.maxSizeLimit),i._fileName=f,i.SourceValue.Add(r,f,b),i.ImageType=l,i.ThreadNum=v,i.OnRunSuccess=w,i.OnRunFailure=S,(U||t.isFunction(g))&&(i.OnUploadTransferPercentage=function(e,r){r>0&&r<=100&&(100==r&&(r=99),U&&n._OnPercentDone([0,r,"","http",e._fileName]),t.isFunction(g)&&D(n,e._fileName,r,0))},t.cancelFrom=We,U&&n._OnPercentDone([0,-1,e.MSG.Uploading,"http",f]),D(n,f,0,0)),V.Run(i)}),F)}else{var B={id:C,st:-1,bCancel:!1};if(y.push(B),0==P&&t.showProgress(n,"Scan Upload",!0),k)w=function(e){return B.st=0,!k&&a.removeAfterOutput?setTimeout((function(){n._ImgManager.convertServerIdToClientIndex(C)>-1?xd(n,Nd,Od).call(n,C,(function(){p++}),(function(){p++})):p++}),100):p++,!0},S=function(){!k&&a.removeAfterOutput&&setTimeout((function(){n._ImgManager.convertServerIdToClientIndex(C)>-1&&xd(n,Nd,Od).call(n,C)}),100);var e={code:n._errorCode,message:n._getErrorString(),response:n.__HTTPPostResponseString};return t.closeProgress(n,"Scan Upload"),2==B.st||(B.st=1,t.each(y,(function(e,t){-1==e.st&&(e.bCancel=!0)})),M(c,e)),!1},n._innerUploadDirectly(T,i.path,f,U,x,o,!1,B,w,S);else{if(w=function(e,t){return B.st=0,!k&&a.removeAfterOutput?setTimeout((function(){n._ImgManager.convertServerIdToClientIndex(C)>-1?xd(n,Nd,Od).call(n,C,(function(){p++}),(function(){p++})):p++}),100):p++,!0},S=function(e){!k&&a.removeAfterOutput&&setTimeout((function(){n._ImgManager.convertServerIdToClientIndex(C)>-1&&xd(n,Nd,Od).call(n,C)}),100);var r={code:n._errorCode,message:n._getErrorString(),response:n.__HTTPPostResponseString};return t.closeProgress(n,"Scan Upload"),2==B.st||(B.st=1,t.each(y,(function(e,t){-1==e.st&&(e.bCancel=!0)})),M(c,r)),!1},l=a.format,t.isUndefined(l)){var O=n._ImgManager.convertServerIdToClientIndex(C);return t.Errors.InvalidImageType(n),S([O]),!1}l==e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF?l=e.DWT.EnumDWT_ImageType.IT_PDF:l==e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_TIF&&(l=e.DWT.EnumDWT_ImageType.IT_TIF);var G={bOnlyUploadForm:!1,method:"startScan",_this:n,url:T,serverIds:[C],enumImageType:l,saveSetup:u,fileName:f,dataFormat:e.DWT.EnumDWT_UploadDataFormat.Binary,retry:o,bOnlyEmptyIsOK:!1,objUploadFileStatus:B,asyncSuccessFunc:w,asyncFailureFunc:S};t._asyncUploadCmd(G)}}})),n.__OnPostAllTransfers=function(){var h,y,b=-1,S=e.DWT.EnumDWT_UploadDataFormat.Binary,T=a.httpParams.url,E=a.singlePost,k=I.transferMode==e.DWT.EnumDWT_TransferMode.TWSX_FILE,x=a.removeAfterOutput;s&&t.isFunction(s)&&(b=k?_.length:m.length,y={event:"postTransfer",bScanCompleted:!0,result:{currentPageNum:b}},setTimeout((function(){s(y)}),10));if(0==b)return t.Errors.SourceHasNothingToCapture(n),void setTimeout((function(){d=!0,f&&t.isFunction(f)&&f();var e={code:n._errorCode,message:n._getErrorString(),response:n.__HTTPPostResponseString};M(c,e)}),1e3);if(b>0&&-1029==n._errorCode)n._errorCode=0;else if(0!=n._errorCode){d=!0,f&&t.isFunction(f)&&f();var P={code:n._errorCode,message:n._getErrorString(),response:n.__HTTPPostResponseString};return void M(c,P)}if("http"==a.type){if(E&&"http"==a.type){var W,L,F=m;if(t.isNumber(a.httpParams.maxSizeLimit)&&(n.__maxUploadImageSize=a.httpParams.maxSizeLimit),a.useUploader){var V,N,A=r.uploadManager,B=A.CreateJob(),O=B.FormField;if(U&&(e.FileUploader.nextLoopTime=300,t.showProgress(n,"Scan Upload",!0)),W=function(e,r){var o=e._fileName;return o||(o=""),n._bServerPercentDone=!0,n.__HTTPPostResponseString=r,D(n,o,100,200),n._OnPercentDone([0,100,"","http"]),U&&t.closeProgress(n,"Scan Upload"),!k&&a.removeAfterOutput?setTimeout((function(){p=0,t.each(F,(function(e){n._ImgManager.convertServerIdToClientIndex(e)>-1?xd(n,Nd,Od).call(n,e,(function(){p++}),(function(){p++})):p++})),setTimeout(l,100)}),100):(R=!0,i(w),C(n)),!0},V=function(){n._OnPercentDone([0,100,"","http"]),U&&t.closeProgress(n,"Scan Upload"),n._bServerPercentDone=!0;var e={code:n._errorCode,message:n._getErrorString(),response:n.__HTTPPostResponseString};return M(c,e),!k&&a.removeAfterOutput&&setTimeout((function(){t.each(F,(function(e){n._ImgManager.convertServerIdToClientIndex(e)>-1&&xd(n,Nd,Od).call(n,e)}))}),100),!1},L=function(e,t,r,i){var o=303;t==Pd?o=404:t==Wd?o=500:t==Ld&&(o=503),n._errorCode=t,n._errorString=r,n.__HTTPPostResponseString=i,D(n,"",100,o),V()},n.__OnCancel=function(){L(null,e.DWT.EnumDWT_Error.UserCancelled,"User cancelled the operation.","")},N=function(){n.__HTTPPostResponseString="",D(n,"",100,303),V()},k)t.each(a.httpParams.headers,(function(e,t){B.HttpHeader[t]=e})),t.each(a.httpParams.formFields,(function(e,t){O.Add(t,e)})),B.ServerUrl=T,B.bDeleteFile=x,B.reTries=o,t.isNumber(a.httpParams.maxSizeLimit)&&(B.maxSizeLimit=a.httpParams.maxSizeLimit),t.each(_,(function(e,t){var r=ti.cformat(a.httpParams.fileName,t+1),n=ti.cformat(a.httpParams.remoteName,t+1);B.SourceValue.Add(e,r,n)})),B.ImageType=I.fileXfer.fileFormat,B.ThreadNum=v,B.OnRunSuccess=W,B.OnRunFailure=L,(U||t.isFunction(g))&&(B.OnUploadTransferPercentage=function(e,r){r>0&&r<=100&&(100==r&&(r=99),U&&n._OnPercentDone([0,r,"","http"]),t.isFunction(g)&&(r>99&&(r=99),D(n,"",r,0)))},U&&n._OnPercentDone([0,-1,e.MSG.Uploading,"http"]),D(n,"",0,0)),A.Run(B);else if((h=a.format)==e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF||h==e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_TIF)h==e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF?h=e.DWT.EnumDWT_ImageType.IT_PDF:h==e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_TIF&&(h=e.DWT.EnumDWT_ImageType.IT_TIF),U&&n._OnPercentDone([0,-1,e.MSG.Encoding,"http"]),n._asyncGenerateURLForUploadData(F,h,u,(function(r){t.each(a.httpParams.headers,(function(e,t){B.HttpHeader[t]=e})),t.each(a.httpParams.formFields,(function(e,t){O.Add(t,e)})),B.ServerUrl=T,B.bDeleteFile=x,B.reTries=o,t.isNumber(a.httpParams.maxSizeLimit)&&(B.maxSizeLimit=a.httpParams.maxSizeLimit);var i=ti.cformat(a.httpParams.fileName,1),s=ti.cformat(a.httpParams.remoteName,1);B._fileName=i,B.SourceValue.Add(r,i,s),B.ImageType=h,B.ThreadNum=v,B.OnRunSuccess=W,B.OnRunFailure=L,(U||t.isFunction(g))&&(B.OnUploadTransferPercentage=function(e,r){r>0&&r<=100&&(100==r&&(r=99),U&&n._OnPercentDone([0,r,"","http",i]),t.isFunction(g)&&D(n,i,r,0))},t.cancelFrom=We,U&&n._OnPercentDone([0,-1,e.MSG.Uploading,"http",i])),A.Run(B)}),N);else{var G=F.length,j=0,z=0,H="";U&&(n._bServerPercentDone=!1,n._OnPercentDone([0,-1,e.MSG.Encoding,"http"])),t.each(F,(function(r,i){var s=ti.cformat(a.httpParams.fileName,i+1),c=ti.cformat(a.httpParams.remoteName,i+1);n._asyncGenerateURLForUploadData([r],h,u,(function(r){z=(j+1)/G*100,H=[j+1,"/",G].join(""),n._OnPercentDone([0,z,H,"http"]),B.SourceValue.Add(r,s,c),++j>=G&&(U&&(n._bServerPercentDone=!0),t.each(a.httpParams.headers,(function(e,t){B.HttpHeader[t]=e})),t.each(a.httpParams.formFields,(function(e,t){O.Add(t,e)})),B.ServerUrl=T,B.bDeleteFile=x,B.reTries=o,t.isNumber(a.httpParams.maxSizeLimit)&&(B.maxSizeLimit=a.httpParams.maxSizeLimit),B.ImageType=h,B.ThreadNum=v,B.OnRunSuccess=W,B.OnRunFailure=L,(U||t.isFunction(g))&&(B.OnUploadTransferPercentage=function(e,r){r>0&&r<=100&&(100==r&&(r=99),U&&n._OnPercentDone([0,r,"","http"]),t.isFunction(g)&&(r>99&&(r=99),D(n,"",r,0)))},U&&n._OnPercentDone([0,-1,e.MSG.Uploading,"http"])),A.Run(B))}),N)}))}}else if(k)W=function(e){return n._bServerPercentDone=!0,!k&&a.removeAfterOutput?setTimeout((function(){p=0,t.each(F,(function(e){n._ImgManager.convertServerIdToClientIndex(e)>-1?xd(n,Nd,Od).call(n,e,(function(){p++}),(function(){p++})):p++})),setTimeout(l,100)}),100):(R=!0,i(w),C(n)),!0},L=function(e){n._bServerPercentDone=!0;var r={code:n._errorCode,message:n._getErrorString(),response:n.__HTTPPostResponseString};return M(c,r),!k&&a.removeAfterOutput&&setTimeout((function(){t.each(F,(function(e){n._ImgManager.convertServerIdToClientIndex(e)>-1&&xd(n,Nd,Od).call(n,e)}))}),100),!1},n._innerUploadFilesDirectly(T,_,a.httpParams.fileName,U,x,o,!1,W,L);else if(W=function(e,r){return n._bServerPercentDone=!0,!k&&a.removeAfterOutput?setTimeout((function(){p=0,t.each(F,(function(e){n._ImgManager.convertServerIdToClientIndex(e)>-1?xd(n,Nd,Od).call(n,e,(function(){p++}),(function(){p++})):p++})),setTimeout(l,100)}),100):(R=!0,i(w),C(n)),!0},L=function(e){n._bServerPercentDone=!0;var r={code:n._errorCode,message:n._getErrorString(),response:n.__HTTPPostResponseString};return M(c,r),!k&&a.removeAfterOutput&&setTimeout((function(){t.each(F,(function(e){n._ImgManager.convertServerIdToClientIndex(e)>-1&&xd(n,Nd,Od).call(n,e)}))}),100),!1},(h=a.format)==e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF||h==e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_TIF){h==e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF?h=e.DWT.EnumDWT_ImageType.IT_PDF:h==e.DWT.EnumDWT_ImageType.IT_MULTIPAGE_TIF&&(h=e.DWT.EnumDWT_ImageType.IT_TIF);var X=ti.cformat(a.httpParams.fileName,1);ti.cformat(a.httpParams.remoteName,1);var Y={bOnlyUploadForm:!1,method:"startScan",_this:n,url:T,serverIds:F,enumImageType:h,saveSetup:u,fileName:X,dataFormat:S,retry:o,bOnlyEmptyIsOK:!1,objUploadFileStatus:!1,asyncSuccessFunc:W,asyncFailureFunc:L};t._asyncUploadCmd(Y)}else F.length>0&&n._asyncUploadFilesCmd(T,F,h,a.httpParams.fileName,u,U,o,!1,W,L)}E&&a.type}d=!0,f&&t.isFunction(f)&&f()};var b=function(){"http"!=a.type?(R=!0,i(w),C(n)):a.singlePost||setTimeout(l,100)};xd(n,Vd,Bd).call(n,I,b,(function(t){if(-1029==n._errorCode){if(I.transferMode==e.DWT.EnumDWT_TransferMode.TWSX_FILE?_.length>0:m.length>0)return n._errorCode=0,b()}var r={code:n._errorCode,message:n._getErrorString(),response:n.__HTTPPostResponseString};M(c,r)}))}))}))}}]),i}(Cd);function Bd(e,r,n){var i,o,a=this,s=null,u=null;if(o=t.isUndefined(e)||null==e?{}:e,a._resetErr(),!a._isValid())return!1;if(t.isFunction(r)&&(s=function(){r(o)}),t.isFunction(n)&&(u=function(e,t){n(e,t,o)}),!t.License.checkProductKey(a,{Core:!0}))return t.isFunction(u)&&u(a._errorCode,a._errorString),!1;for(var c=0,l=0;l<ai.length;l++){var d=["__",ai[l]].join("");t.isFunction(a[d])&&(c|=1<<l)}return o.EnableEvents=c,i=["[",t.stringify(o),"]"].join(""),a.__bAcquireImageNow=!0,a.__innerAcquireImage("StartScan",i,!1,!0,s,u)}function Od(e,r,n){var i=this;return i._innerFunRaw("RemoveImage",Zn(e),!0,!1,!0,(function(){i._OnBitmapChanged(["0",""+e,3,i._ImgManager.getCurrentImageIndex(),i._ImgManager.count()]),t.isFunction(r)&&r()}),n)}function Rd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(es){return!1}}();return function(){var r,n=et(e);if(t){var i=et(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return $e(this,r)}}var Ud=function(e){Qe(n,e);var r=Rd(n);function n(){return Le(this,n),r.apply(this,arguments)}return Ae(n,[{key:"SelectSourceByIndex",value:function(e){var r=this,n=parseInt(e);if(r._resetErr(),r._isMobileMode())return r._mobileNotSupport("SelectSourceByIndex");if(isNaN(n))return t.Errors.InvalidParameter(r),!1;if(null==r.__devices&&r.GetSourceNames(!1),n>=r.__devices.length||n<0)return t.Errors.IndexOutOfRange(r),!1;var i=r.__devices[n];return r.SelectDevice(i)}},{key:"EnableSource",value:function(e,t,r){var n=this;if(n._resetErr(),!n._isValid())return!1;if(n._isWasmWithScan());else if(n._isMobileMode())return n._mobileNotSupport("EnableSource",r);return n.AcquireImage(e,t,r)}}]),n}(Ad);function Gd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(es){return!1}}();return function(){var r,n=et(e);if(t){var i=et(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return $e(this,r)}}function jd(r,n){var i=n||{};r._config=i,r._clientId=t.getRandom(),function(r,n){var i=n.bNoViewer,o=n.iServiceType;if(r._destroy=Or,r._destroying=Or,r._bInited=Or,r._id=n.id,r._bNoMask=n.bNoMask?Rr:Or,r._bNotShowMessage=n.bNotShowMessage?Rr:Or,r._bSelectedSourceByServer=Or,r._bKeepAwake=n.keepAwake,r._bAx=Or,n.container?r._containerElement=n.container:n.containerId&&(r._containerElement=t.get(n.containerId)),r._bBindViewer=i?Or:Rr,r._iServiceType=o,o==de)r._bRemoteMode=Or;else if(n.dmService){var a,s,u,c,l,d,g=ei(n.dmService),f="/",m="";s=g.server;var _=new t.Uri(n.dmService.server),p=_.scheme;p&&(p=p.toLowerCase()),"https"==p?(a=!0,u=s.substring(8)):"http"==p?(a=!1,u=s.substring(7)):(u=s,s=(a=t.detect.ssl)?"https://"+s:"http://"+s),t.isLocalIP(_.hostname)?r._bRemoteMode=Or:r._bRemoteMode=Rr,t.endsWith(s,"/")&&(f="");var v=g.attrs;if(v){var y,I;c=(null===(y=v)||void 0===y?void 0:y.UUID)||"";var w,S=(null===(I=v.modules)||void 0===I?void 0:I.length)||0;if(""!=c&&S>0)a?S>1&&S>1+(w=v.modules[1])+2&&(l=v.modules[1+w+2]):S>2&&(l=v.modules[2]),t.endsWith(l,"/")&&(f=""),m=[c,"/",l,"/"].join("")}else v={UUID:"",service_type:Ie};d=[s,f,m].join(""),v.url=d,r._serverInfo=new Xe([u,f,m].join(""),null,a,!0,e.dcp.wsProtocol),r._httpUrl=d,r._dmService=g}else{var T,C=n.port,E=t.detect.ssl,M=!1;n.host?(T=n.host,t.isLocalIP(T)||(M=!0)):T=h(),C||(C=E?e.dcp.SSLPort:e.dcp.Port),r._serverInfo=new Xe(T,C,E,!0,e.dcp.wsProtocol),r._httpUrl=Ue(r._serverInfo),r._dmService={server:r._httpUrl,attrs:{url:r._httpUrl,UUID:"",service_type:Ie}},r._bRemoteMode=M}r._bReady=Or,r._wsClient=null,r.__wsRetry=0,r.__IfShowProgressBar=Rr,r.__IfShowCancelDialogWhenImageTransfer=Rr,r._errorCode=0,r._errorString="",r.__bLoadingImage=Or,r.__bAcquireImageNow=Or,r.__bOpenFileNow=Or,r.__addon={},r.__defaultSourceName="",r.__sourceCount=0,r.__serverId="",r.__bConnecting=Or,r.__bTrial=Or,r.__licenseInfo=undefined,r.__strProductName=e.DWT.ProductName,r.__productKey="",r.__versionInfo=e.DWT.JSVersion,r.__bMustUpgradeService=Or,r.__withCredentials=Or,r._moduleSize=1048576,r._b64bit=e.dcp.b64bit,r._driverType=j,r.__IfAppendImage=Rr,r.__maxImagesInBuffer=32767,r.__maxUploadImageSize=-1,r.__insertingIndex=-1,r._objImageIndexManager=new ic,r._bServerPercentDone=Rr,r._aryBitmapCache=[],r._bSSL=e.navInfoSync.bSSL,r._bRegistedLoad=!1,r._logLevel=0,r._scaleDownThreshold=0,r._pdfWriteSetting={},r.__serverPlatform=b,r._bPageFocus=!0,r._bServerAlwaysFocusOnPopupWindow=!0,t.License.isLTS()&&(r._blts=!0),r._heartBeatTicks=1e3}(r,i),r._bRemoteMode||(r.httpFormFields={},r.HTTPPassword=i.HTTPPassword||"",r.HTTPPort=i.HTTPPort||(t.detect.ssl?443:80),r.HTTPUserName=i.HTTPUserName||"",r.__HTTPPostResponseString="",r.__strHttpContentTypeFieldValue="application/octet-stream",r.__remoteFilename="RemoteFile",r.__httpHeaderMap=Or,r._b64bit?r._segementUploadThreshold=4294967296:r._segementUploadThreshold=524288e3,r._aryTiffTag=[],r._tiffCompressionType=e.DWT.EnumDWT_TIFFCompressionType.TIFF_AUTO,r._jpgQuality=80,r._pdfConvertMode=3,r._pdfRealConvertMode=3,r._pdfResolution=200,r._pdfPassword=""),function(e,t){e.__OnReady=t.onReady||null,e.__OnWSReconnect=t.onWSReconnect||null,e.__OnWSClose=t.onWSClose||null,e.__OnWSMessage=t.onWSMessage||null,e.__OnWSError=t.onWSError||null,e.__OnCreateError=t.onCreateError||null,e.__OnPercentDone=t.onPercentDone||"",e.__OnPrintMsg=t.onPrintMsg||"",e.__OnResult=t.onResult||"",e.__OnAfterOperate=t.onAfterOperate||"",e.__OnBeforeOperate=t.onBeforeOperate||"",e.__OnOperateStatus=t.onOperateStatus||"",e.__OnBitmapChanged=t.onBitmapChanged||"",e.__OnGetFilePath=t.onGetFilePath||"",e.__OnPreAllTransfers=t.onPreAllTransfers||"",e.__OnPreTransfer=t.onPreTransfer||"",e.__OnPostLoad=t.onPostLoad||"",e.__OnPostTransfer=t.onPostTransfer||"",e.__OnPostAllTransfers=t.onPostAllTransfers||"",e.__OnSourceUIClose=t.onSourceUIClose||"",e.__OnTransferCancelled=t.onTransferCancelled||"",e.__OnTransferError=t.onTransferError||"",e.__OnInternetTransferPercentage=t.onInternetTransferPercentage||"",e.__OnInternetTransferPercentageEx=t.onInternetTransferPercentageEx||"",e.__OnRemoteScanStatusAsync=t.onRemoteScanStatusAsync||"",e.__OnPostTransferAsync={}}(r,i)}var zd,Hd=function(e){Qe(r,e);var t=Gd(r);function r(e){var n;return Le(this,r),jd(Ze(n=t.call(this)),e),n}return Ae(r)}(Ud),Xd=function(e){Qe(n,e);var r=Gd(n);function n(e){var t;return Le(this,n),jd(Ze(t=r.call(this)),e),t}return Ae(n,[{key:"getDevices",value:function(e,t,r){return this._getDevicesAsync("getDevices",e,t,r)}},{key:"selectDevice",value:function(e,t){return this._selectDeviceAsync("selectDevice",e,t)}},{key:"acquireImage",value:function(e,t){return this._acquireImageAsync("acquireImage",e,t)}},{key:"openSource",value:function(){return this._openSourceAsync("openSource")}},{key:"closeSource",value:function(){return this._closeSourceAsync("closeSource")}},{key:"selectSource",value:function(e){return this._selectSourceAsync("selectSource",e)}},{key:"getCapabilities",value:function(){var e=this;return e._resetErr(),e._isValid()?new t.Promise((function(t,r){return e._getCapabilities((function(e){t(e)}),(function(e,t){r({code:e,message:t})}))})):t.Promise.reject({code:e._errorCode,message:e._errorString})}},{key:"setCapabilities",value:function(e){var r=this;return r._resetErr(),r._isValid()?new t.Promise((function(t,n){return r._setCapabilities(e,(function(){t(!0)}),n)})):t.Promise.reject({code:r._errorCode,message:r._errorString})}}]),n}(gl),Yd=function(){function e(t){Le(this,e),this._stwain=t}return Ae(e,[{key:"getDevices",value:function(e,t,r){return this._stwain.getDevices(e,t,r)}},{key:"selectDevice",value:function(e,t){return this._stwain.selectDevice(e,t)}},{key:"acquireImage",value:function(e,t){return this._stwain.acquireImage(e,t)}},{key:"openSource",value:function(){return this._stwain.openSource()}},{key:"closeSource",value:function(){return this._stwain.closeSource()}},{key:"selectSource",value:function(e){return this._stwain.selectSource(e)}},{key:"getCapabilities",value:function(){return this._stwain.getCapabilities()}},{key:"setCapabilities",value:function(e){return this._stwain.setCapabilities(e)}},{key:"dispose",value:function(){this._stwain.dispose()}}]),e}(),Jd=t.win;function Kd(r,n){var i;if(!t.isObject(r)){var o={};return t.Errors.InvalidParameter(o),t.Promise.reject(bt(o))}if(!(r instanceof $n)){var a={};return t.Errors.InvalidParameter(a),t.Promise.reject(bt(a))}if(!t.product.loadResourcePath)return qa().then(Ya).then((function(){return Kd(r,n)}),(function(e){return t.Promise.reject(e)}));if(!n){t.License.isLicenseMixed(null,!0)||e.Lib.License.reparseProductKey();var s=e.DWT.licenseException;if(0!=s.code)return t.License.showLicenseErrorDialog(s),t.Promise.reject(s)}var u={id:t.guid(),iServiceType:he,dmService:r,bNoViewer:!0,bNoMask:null==r||null===(i=r.attrs)||void 0===i?void 0:i.bNoMask,bNotShowMessage:!0};return new t.Promise((function(t,r){return Zd(u,t,(function(t,n){var i={code:e.DWT.EnumDWT_Error.FailedToCreateDWTObject,message:t};n&&n.__unload(),r(i)}))}))}function Zd(r,n,i){var o=r.id,a=r.containerId;if(r.bNoViewer||t.isString(a)&&""!=a&&(r.container||t.get(a))){if(e.DWT.Containers&&!r.bNoViewer){var s,u=e.DWT.Containers;for(s=0;s<u.length;s++)if(u[s].ContainerId==a)return r.bNoMask||t.closeLoadingMsg(),!r.bNotShowMessage&&t.isFunction(i)&&(r.bNoMask||t.closeLoadingMsg(),t._safePromptCustomMsg((function(){i(e.Lib.product.CustomizableDisplayInfo.errorMessages.ERR_CreateID_MustNotInContainers)}))),Or}r.container||(r.container=t.get(a))}else r.bNoViewer=!0,r.containerId=0;if(e.DWT.ContainerMap[o])return r.bNoMask||t.closeLoadingMsg(),t.isFunction(i)&&i(e.Lib.product.CustomizableDisplayInfo.errorMessages.ERR_CreateID_WebTwainIdDuplicated),Or;var c,l,d,h,g=!1;if(r.iServiceType==de){if(!e.WasmEnv)return r.bNoMask||t.closeLoadingMsg(),t._safePromptCustomMsg((function(){t.isFunction(i)&&i(e.Lib.product.CustomizableDisplayInfo.errorMessages.ERR_CreateID_WasmEnvNotLoaded)})),Or}else r.dmService&&(c=r.dmService.server,l=Or,d=new t.Uri(c),t.isLocalIP(d.hostname||d.scheme)||(l=Rr),g=l);return r.onReady=function(o){if(Jd.DCP_DWT_OnClickCloseInstall(!1,!0),!o)return r.bNoMask||t.closeLoadingMsg(),t.isFunction(i)&&i(e.Lib.product.CustomizableDisplayInfo.errorMessages.ERR_CreateID_NotContainer),!1;if(e.DWT.ContainerMap[o._id])return r.bNoMask||t.closeLoadingMsg(),t.isFunction(i)&&i(e.Lib.product.CustomizableDisplayInfo.errorMessages.ERR_CreateID_WebTwainIdDuplicated,o),!1;var a={};return a.WebTwainId=o._id,o._containerElement&&o._containerElement.id&&(a.ContainerId=o._containerElement.id),e.DWT.DynamicContainers.push(a),e.DWT.ContainerMap[o._id]=o,e.DWT.IfDisableDefaultSettings||!o._isTwainServiceType()&&!o._isDMServiceType()?(r.bNoMask||t.closeLoadingMsg(),t.isFunction(n)&&n(o)):eh(o).then((function(){r.bNoMask||t.closeLoadingMsg(),t.isFunction(n)&&n(o),Qd(o)}),(function(){r.bNoMask||t.closeLoadingMsg(),-2207==o._errorCode&&(t.detect.bPromptJSOrServerOutdated||(t.detect.bPromptJSOrServerOutdated=Rr)),Qd(o)})),!0},r.onCreateError=function(r){if(Jd.DCP_DWT_OnClickCloseInstall(!1,!0),t.isFunction(i)){var n,o=e.DWT.licenseException;0==o?(n=t.Errors.ThrowString_FailedToCreateDWTObject(h),r&&""!=r._errorString&&(n=r._errorString)):n=o.message,i(n,r,!0)}return!1},Ln(r.container)?r.bNoViewer=!1:r.bNoViewer=!0,(h=g?new Xd(r):new Hd(r))._isTwainServiceType()||h._isDMServiceType()?(t.detect.bFirst&&t._init(r),t.detect.bFirst=!1,function(r){var n=r._getWebTwainId();e.DWT.ContainerMap[n]&&r._OnReady();if(r._bReady||r._destroy)return;r.__bConnecting=!0;var i=wr.Instance.getClient(r._serverInfo);return i.setRetry(0),ni("",r),oa(r._bRemoteMode).then((function(){var e,t,r=0,n=1e4;return i.testConnection(e,r,t,n)})).then((function(){r.__bConnecting=!1,r._wsClient=i,r._bReady||(r._bReady=!0,r._OnReady()),ii("")}),(function(e){if(e&&e.message&&t.error(e.message),r._bRemoteMode&&r._isTwainServiceType()){var n,i,o=null===(n=r._dmService)||void 0===n||null===(i=n.attrs)||void 0===i?void 0:i.name,a=t.Errors.ThrowFailedConnectToRemoteDynamsoftService(o);r._errorCode=a.code,r._errorString=a.message}t.isFunction(r.__OnCreateError)&&r.__OnCreateError(r),r._bReady=!1,r.__bConnecting=!1,ii("")}))}(h)):h._isWasmWithScan()?function(e){return rh.apply(this,arguments)}(h):(h._OnReady(),h)}function qd(r,n){var i=e.navInfoSync;if(t.isFunction(e.OnWebTwainNeedUpgradeCallback)){var o,a,s,u,c={};if(i.bWin){if(i.bIE)a=e.dcp.getDSPath();else{var l=t.product;a=l.bHTML5Edition?e.dcp.getDSPath():l.getMSIPath()}o=I}else e.navInfo.bEmbed||i.bAndroid||i.bChromeOS||i.bHarmonyOS||i.biPhone||i.biPad?(a=s=e.dcp.getDSPath(),c.deb=s,o=i.bAndroid?M:i.biPhone||i.biPad?D:i.bChromeOS?C:i.bHarmonyOS?E:T):i.bLinux?(s=e.dcp.getLinuxHTML5DebPath(),u=e.dcp.getLinuxHTML5RpmPath(),a=s,c.deb=s,c.rpm=u,o=S):(a=t.product.bHTML5Edition?e.dcp.getDSPath():t.product.getPKGPath(),o=w);c["default"]=a;var d=t.one(".dynamsoft-dialog-license");d&&d.getEL()&&(d.getEL().style.display="none"),t.detect.needUpgrade=Rr,e.OnWebTwainNeedUpgradeCallback(t.product.name,c,t.product.bHTML5Edition,o,i.bIE,i.bSafari,t.detect.ssl,t.env.strIEVersion,t.detect.bPromptJSOrServerOutdated,r,n)}}function Qd(e){return $d.apply(this,arguments)}function $d(){return($d=Ke(it.mark((function r(n){var i,o,a;return it.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n&&!n._blts){r.next=2;break}return r.abrupt("return");case 2:return r.next=4,n._getVersionInfoAsync();case 4:if(i=r.sent,t.detect.bNeedUpgradeEvent||Qa(i)){r.next=14;break}if(t.detect.bNeedUpgradeEvent=Rr,!t.isFunction(e.DWT.OnWebTwainNeedUpgrade)){r.next=10;break}if(!e.DWT.OnWebTwainNeedUpgrade()){r.next=10;break}return r.abrupt("return");case 10:if(!n._bRemoteMode){r.next=13;break}return t.isFunction(e.OnRemoteWebTwainNeedUpgradeCallback)&&(o=n._serverInfo.port,e.OnRemoteWebTwainNeedUpgradeCallback(t.product.name,n._serverInfo.server,o,n._serverInfo.ssl)),r.abrupt("return");case 13:(t.product.bHTML5Edition&&n._isBindViewer()||!t.product.bHTML5Edition)&&((a=n._containerElement)&&(t.one(a).before(t.install._strNonInstallDIV),t.show(t.install._divDWTNonInstallContainerID)),""!=t.install._divDWTemessageContainer&&t.hide(t.install._divDWTemessageContainer),qd());case 14:case"end":return r.stop()}}),r)})))).apply(this,arguments)}function eh(r){return t.showLoadingMsg(-1,"",e.MSG.Init_ConfiguringDWT),r._innerFunV2("IfDisableSourceAfterAcquire","[1]").then((function(){var t=e.navInfoSync,n=j,i=r,o=!1,a=!1;i._bRemoteMode?i.__serverPlatform==I||(i.__serverPlatform==S?a=!0:i.__serverPlatform==w&&(o=!0)):(o=t.bMac,a=t.bLinux,t.bWin),o?n=X:a&&(n=H),r._driverType=n,r._bRemoteMode&&(r._setIfShowUI(!1),r._setIfShowFileDialog(!1))})).then((function(){r.__licenseInfo&&(t.License.checkProductKey(r,{Core:!0})||e.navInfoSync.bWin&&t.License.checkProductKey(r,{Webcam:!0}))&&(e.DWT.lclex(),t.Errors.ClearErrorInfo(r))}))}function th(e,r){if(t.product.bActiveXEdition){var n={};return t.Errors.ActiveXNotSupport(n),t.Promise.reject({code:n._errorCode,message:n._errorString})}return Kd(e,r)}function rh(){return(rh=Ke(it.mark((function r(n){var i;return it.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=n._getWebTwainId(),e.DWT.ContainerMap[i]&&n._OnReady(),!n._bReady&&!n._destroy){r.next=4;break}return r.abrupt("return");case 4:return n.__bConnecting=!0,r.prev=5,r.next=8,no();case 8:return r.next=10,nh(n);case 10:r.next=17;break;case 12:r.prev=12,r.t0=r["catch"](5),t.error(r.t0),oh(),t.isFunction(n.__OnCreateError)&&n.__OnCreateError(n);case 17:return r.prev=17,r.finish(17);case 19:case"end":return r.stop()}}),r,null,[[5,12,17,19]])})))).apply(this,arguments)}function nh(e){return ih.apply(this,arguments)}function ih(){return(ih=Ke(it.mark((function r(n){var i,o,a,s,u;return it.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,jn();case 3:if(i=r.sent,!t.License.isLTS()){r.next=8;break}if(e.DWT.li({instanceMode:e.DWT.EnumInstance.dwt_desktop},"")){r.next=8;break}return r.abrupt("return",sa(i));case 8:return r.prev=8,o=new Hu("",!1),r.next=12,ca(n,o,"",!1);case 12:if(a=r.sent,t.License.isLTS()&&(a.LTS=!0),n.__anlic=a,n.__bConnecting=!1,!e.navInfoSync.bAndroid){r.next=21;break}if(t.License.checkAndroidServiceCore(n)){r.next=21;break}return e.OnLicenseError(n._errorString,n._errorCode),t.isFunction(n.__OnCreateError)&&n.__OnCreateError(n),r.abrupt("return");case 21:n._bReady||(n._bReady=!0,n._OnReady()),r.next=28;break;case 24:r.prev=24,r.t0=r["catch"](8),Fl(n,!1,r.t0,!0),t.isFunction(n.__OnCreateError)&&n.__OnCreateError(n);case 28:return r.prev=28,o&&o.dispose(),r.finish(28);case 31:r.next=42;break;case 33:throw r.prev=33,r.t1=r["catch"](0),u=-1,n._bReady=!1,n.__bConnecting=!1,t.isString(r.t1)?s=r.t1:r.t1&&(r.t1.code&&(u=r.t1.code),r.t1.message&&(s=r.t1.message)),n._errorCode=u,n._errorString=s,s;case 42:case"end":return r.stop()}}),r,null,[[0,33],[8,24,28,31]])})))).apply(this,arguments)}function oh(){oo(null,0,0,!1,!1)}var ah,sh,uh=e.DWT,ch=e.navInfoSync,lh=t.each;function dh(){var r,n=t.detect,i=5;if(!t.product.bHTML5Edition)return t.appendMessage("This browser is currently not supported. Please try Chrome or Firefox!"),void sh();if(e.navInfoSync.bAndroid&&(i=0),n.tryTimes>i)return t.log("Failed more than 5 times."),void sh();if(n.OnDetectNext&&n.OnDetectNext(),0==n.tryTimes&&n.cUrlIndex>0&&n.arySTwains.length>0){var o=n.arySTwains[0];n.bNoControlEvent||ii(""),hh(o)}if(n.cUrlIndex>=n.urls.length&&(n.cUrlIndex=0,n.tryTimes++),!(n.arySTwains.length>0))return n.bOK=!0,void ah();var a=(r=n.arySTwains[0])._getWebTwainId();if(e.DWT.ContainerMap[a]&&r._OnReady(),r._bReady||r._destroy)return n.arySTwains.splice(0,1),void(n.arySTwains.length<=0?(n.bOK=!0,ah()):setTimeout(dh,100));if(n.bNoControlEvent||ni("",r),!r.__bConnecting){if(r.__bConnecting=!0,r._isTwainServiceType()||r._isDMServiceType()){var s=wr.Instance.getClient(r._serverInfo);return s.testConnection().then((function(){r.__bConnecting=!1,r._wsClient=s,r._bReady||(r._bReady=!0,r._OnReady()),n.arySTwains.splice(0,1),n.arySTwains.length<=0?(ii(""),n.bOK=!0,ah()):setTimeout(dh,100)}),(function(e){var i;e&&e.message&&(i=e.message,t.error(i)),r.__bConnecting=!1,r._bReady?(ii(""),sh(i)):(n.cUrlIndex++,setTimeout(dh,100))}))}return r._isWasmWithScan()?nh(r).then((function(){n.arySTwains.splice(0,1),n.arySTwains.length<=0?(ii(""),n.bOK=!0,ah()):setTimeout(dh,100)}),(function(e){r._bReady?(ii(""),sh(e)):(n.cUrlIndex++,setTimeout(dh,100))})):void 0}sh()}function hh(e){var r=t.detect;if(!r.bNoControlEvent){if(t.isFunction(r.onNoControl)){var n,i=0,o=0;e&&(i=e._width,o=e._height,n=e._containerElement),i<=0&&(i=270),o<=0&&(o=350),r.onNoControl(n,i,o,e)}r.bNoControlEvent=!0}}t.ProgressBar=rc,t.env.WSVersion="12.0.0",t.env.WSSession=(new Date).getTime(),t._init=function(t){var r,n=e.Lib,i=e.dcp,o=n.LS.item("DWT_port"),a=n.LS.item("DWT_ssl");if(i.bEnhancedMode)return!0;n.detect.urls.splice(0),n.detect.cUrlIndex=0,o!==zd&&a!==zd&&(r={port:o,ssl:"true"==a});var s=function(e){return!r||!(!e||e.port==r.port&&e.ssl==r.ssl)};1===n.detect.detectType?(r!==zd&&r.ssl&&n.detect.urls.push(r),lh(n.detect.ports,(function(e){e.ssl&&s(e)&&n.detect.urls.push(e)}))):0===n.detect.detectType?(r===zd||r.ssl||n.detect.urls.push(r),lh(n.detect.ports,(function(e){!1===e.ssl&&s(e)&&n.detect.urls.push(e)}))):(r!==zd&&n.detect.urls.push(r),lh(n.detect.ports,(function(e){s(e)&&n.detect.urls.push(e)})))},t.startCheckWS=function(){return t.detect.tryTimes=0,new t.Promise((function(e,t){ah=e,sh=t,setTimeout(dh,200)}))},t.html5.closeAll=function(){var r,n,i,o,a,s,u,c;for(t.dlgProgress=!1,t.detect.bOK=!1,t.detect.bFirst=!0,r=t.detect.arySTwains.length-1;r>=0;r--)if(i=t.detect.arySTwains[r]){if(s=i._id,i._containerElement&&(a=i._containerElement,o=i._containerElement.id),c=!1,e.DWT.Containers)for(n=0;n<e.DWT.Containers.length;n++)if((u=e.DWT.Containers[n])&&(s==u.WebTwainId||o&&o==u.ContainerId||a==u.Container)){c=!0;break}c&&(i.dispose(),t.detect.arySTwains.splice(r,1)),i._isMobileMode()}},t.bio=!1,t.progressMessage="",t.dialogShowStatus=!1,t.needShowTwiceShowDialog=!1,t.dlgProgress=!1,t.cancelFrom=Me,t.dlgRef=0,t.initProgress=function(e){var r,n;if(!t.dlgProgress){(n=[]).push('<dialog class="dynamsoft-dwt-dialogProgress" closed="closed" style="top:30%"><div class="ds-dwt-progressWrap">'),n.push('<h3 class="dynamsoft-finalMessage"> </h3>'),n.push('<p class="dynamsoft-desc"> </p><p class="dynamsoft-status">0%</p>'),ch.bIE?n.push('<div class="dynamsoft-progressBar" value="" max="100"></div>'):n.push('<progress class="dynamsoft-progressBar" value="" max="100"></progress>'),n.push('<br /><div style="width:100%;text-align:center"><button class="dynamsoft-btnCancel" value="cancel" autofcus>cancel</button></div>'),n.push("</div></dialog>"),(r=t.one(".dynamsoft-dwt-dialogProgress"))&&r.getEL()&&r.remove();var i=t.parseHTML(n.join(""));if(i&&i.length>0&&document.body.appendChild(i[0]),ch.bIE){var o=t.one(".dynamsoft-progressBar"),a=o&&o.getEL();a&&(a.objProgressBar=new rc(a,{width:280,height:20}))}(r=t.one(".dynamsoft-dwt-dialogProgress"))&&r.getEL()&&(t.dlgProgress=r[0],t.dialog.setup(t.dlgProgress)),t.dlgRef=0,t.dialogShowStatus=!1,t.cancelFrom=Me}},t.setBtnCancelVisibleForProgress=function(e){if(!(t.dlgRef<=0||0==t.dialogShowStatus)){var r=t.one(".dynamsoft-btnCancel"),n=r&&r.getEL();n&&(n.style.display=e?"":"none")}},t.showProgressMsg=function(e,r,n){if(!(t.dlgRef<=0||0==t.dialogShowStatus)){var i=t.one(".dynamsoft-progressBar"),o=t.one(".dynamsoft-status"),a=t.one(".dynamsoft-finalMessage"),s=t.one(".dynamsoft-desc"),u=e;if(e<0?u=0:e>100&&(u=100),u=Math.floor(u),a&&a.getEL()&&a.html(r),s&&s.getEL()&&s.html(n),(u||0===u)&&(o&&o.getEL()&&o.html(u+"%"),i&&i.getEL()&&(ch.bIE?i[0].objProgressBar?i[0].objProgressBar.setValue(u):i[0].value=u:ch.bEdge?(i[0].style.display="",i[0].value=u):i[0].value=u)),u&&(u>=100||t.dlgRef<=0)&&(setTimeout((function(){i&&i.getEL()&&(ch.bIE?i[0].objProgressBar?i[0].objProgressBar.setValue(0):i[0].value=0:ch.bEdge?(i[0].style.display="none",i[0].value=0):i[0].value=0)}),300),t.dlgRef<=0)){t.closeProgress(null,"OnPercentDone")}}},t.showProgress=function(r,n,i){var o,a=r;if(e.DWT.IfConfineMaskWithinTheViewer?a._isNoViewer()?o=document.body:a._containerElement?o=a._containerElement:e.DWT.Containers&&e.DWT.Containers.length>0&&e.DWT.Containers[0].ContainerId&&(o=e.Lib.get(e.DWT.Containers[0].ContainerId))||(o=document.body):o=document.body,o&&o!==document.body){var s=o.firstElementChild;s&&s!==t.dlgProgress&&(o=s),""!==o.style.position&&"static"!==o.style.position||(o.style.position="relative",a.progressContainer={el:o})}if(t.dlgProgress&&o.appendChild(t.dlgProgress),t.log("showProgress:"+n+",bCancel:"+i),t.cancelFrom==Me&&1==a.__IfShowProgressBar||t.cancelFrom!=Me&&1==a.__IfShowCancelDialogWhenImageTransfer){var u=t.one(".dynamsoft-btnCancel"),c=u&&u.getEL();if(c&&(c.style.display=0==i?"none":""),0==t.dialogShowStatus){t.dlgProgress&&(t.dialog.setup(t.dlgProgress,!0),t.dlgProgress.showModal()),t.dialogShowStatus=!0;var l=t.one(".dynamsoft-finalMessage"),d=t.one(".dynamsoft-progressBar"),h=d&&d.getEL(),g=t.one(".dynamsoft-status");l&&l.getEL()&&l.html(""),g&&g.getEL()&&g.html("0%"),h&&(ch.bIE&&h.objProgressBar?h.objProgressBar.setValue(0):h.value=0)}t.dlgRef++}},t.closeProgress=function(e,r){var n=e;t.log("closeProgress:"+r);var i=t.one(".dynamsoft-btnCancel");t.dlgRef--,t.dlgRef<=0&&(t.dlgRef=0),1==t.needShowTwiceShowDialog&&t.cancelFrom==De?i&&i.getEL()&&(i[0].innerHTML="Cancel"):(i&&i.getEL()&&(i[0].innerHTML="Cancel"),0==t.dlgRef&&(1==t.dialogShowStatus&&(t.dlgProgress&&(t.dlgProgress.close(),t.dlgProgress&&document.body.appendChild(t.dlgProgress),n&&n.progressContainer&&n.progressContainer.el&&(n.progressContainer.el.style.position="",n.progressContainer=null)),t.dialogShowStatus=!1),t.needShowTwiceShowDialog=!1,t.cancelFrom=Me))},uh.RemoveAllAuthorizations=function(){var e,r=t.LS.item("DWT_port"),n="http://";return"true"==t.LS.item("DWT_ssl")&&(n="https://"),e=[n,h(),":",r,"/dwt/",t.product.getDWTPrefix(),t.product.getServerVersionInfo(),"/RemoveAllAuthorizations?t=",t.now()].join(""),t.ajax({method:"GET",xhrFields:{withCredentials:!0},url:e,async:!0}),!0};var gh={isSupportLS:function(){var t=e.navInfoSync,r=!1;if(t.bEdge&&t.bFileSystem);else try{r=!!window.localStorage}catch(es){}return r},item:function(e,t,r){var n=null;return this.isSupportLS()?(t?(localStorage.setItem(e,t),n=t):n=localStorage.getItem(e),null===n?r:n):r},removeItem:function(e){return!!this.isSupportLS()&&(localStorage.removeItem(e),!0)}},fh=e.navInfoSync,mh=e.dcp,_h=0,ph=2;function vh(e,r){t.isLocalIP(e)&&(t.LS.item("DWT_port",r),t.LS.item("DWT_ssl",fh.bSSL?"true":"false"))}function yh(r,n,i){var o,a,s=function(r){var n,i="",o=r,a="",s=e.navInfoSync;return n=s.bMac?"mac/MacDWT_":s.bLinux?"linux/LinuxDWT_":"win/WinDWT_",s.bFileSystem||(i="?t="+t.getRandom()),o.length>0&&"/"!=o[o.length-1]&&(o+="/"),s.bWin&&mh.b64bit&&(a="_x64"),[o,"dist/",n,t.product.getServerVersionInfo(),a,".zip",i].join("")}(e.DWT.ResourcesPath);if(o=function(r){mh.loadZip(r,0,(function(){if(t.closeLoadingMsg(),t.isFunction(e.OnWebTWAINDllDownloadSuccessful)&&e.OnWebTWAINDllDownloadSuccessful(),e.DWT.OnWebTwainInitMessage){var r;if(fh.bSSL&&fh.bFirefox)return r=e.Lib.product.CustomizableDisplayInfo.generalMessages.refreshNeeded,void e.DWT.OnWebTwainInitMessage(r,G);r=e.Lib.product.CustomizableDisplayInfo.generalMessages.DWTmoduleLoaded,e.DWT.OnWebTwainInitMessage(r,B)}setTimeout(n,3e3)}),a)},a=function(n){if(t.closeLoadingMsg(),e.DWT.OnWebTwainInitMessage){var i=e.Lib.product.CustomizableDisplayInfo.errorMessages.ERR_DWT_NOT_DOWNLOADED;e.DWT.OnWebTwainInitMessage(i,U)}if(t.isFunction(e.OnWebTWAINDllDownloadFailure)){var o={};404==n.httpCode?t.Errors.WebTwainModuleNotExist(o):t.Errors.WebTwainModuleDownloadFailure(o),e.OnWebTWAINDllDownloadFailure(t.product.name,o._errorCode,o._errorString)}t.detect.dcpStatus=3,t.isFunction(r.dwtFailedCallback)&&r.dwtFailedCallback()},e.DWT.OnWebTwainInitMessage){var u=e.Lib.product.CustomizableDisplayInfo.generalMessages.downloadingDWTModule;e.DWT.OnWebTwainInitMessage(u,B)}t.fetch(s,{mode:"cors",dataType:"arraybuffer"}).then(o,a)}function bh(r,n,i,o){var a,s=function(){if(e.DWT.OnWebTwainInitMessage){var t=e.Lib.product.CustomizableDisplayInfo.errorMessages.ERR_MODULE_NOT_INSTALLED;e.DWT.OnWebTwainInitMessage(t,R)}if(o){var r=e.Lib.product.CustomizableDisplayInfo.errorMessages.ERR_MODULE_NOT_INSTALLED;Fn(o,ph,r)}};if(e.DWT.OnWebTwainInitMessage){var u=e.Lib.product.CustomizableDisplayInfo.generalMessages.checkingDWTVersion;e.DWT.OnWebTwainInitMessage(u,B)}a=function(i){var a;i&&(a=t.parse(i)),a&&"result"in a&&(a=a.result,t.isArray(a)&&a.length>0)?setTimeout((function(){!function(r,n,i,o){if(t.isFunction(o)){var a,s=i[0],u=i.length>1?i[1]:"",c=i.length>2?i[2]:0,l=i.length>3?i[3]:"",d=i.length>4?i[4]:"";if(""!==u)e.DWT.OnWebTwainInitMessage&&e.DWT.OnWebTwainInitMessage(u,O),Fn(o,ph,e.Lib.product.CustomizableDisplayInfo.errorMessages.ERR_MODULE_NOT_INSTALLED);else{var h="The WebTwain version is: "+s;e.DWT.OnWebTwainInitMessage&&e.DWT.OnWebTwainInitMessage(h,B),"32"==c&&t.isLocalIP(r)&&(e.dcp.b64bit=!1),""!=l&&(e.DWT.lsmid(l,""),e.DWT.lsmid2b(l)),o(_h,r,n,s)}t.isFunction(e.OnSSLCertInfo)&&(""!=d&&(a=Date.parse(d+"T00:00:00"),a=isNaN(a)?null:new Date(a)),e.OnSSLCertInfo(a))}}(r,n,a,o)}),0):setTimeout(s,1e3)};var c=t.now(),l=['{"id":"',t.guid(),'","method":"VersionInfo","version":"',t.product.getDWTPrefix(),t.product.getServerVersionInfo(),'","parameter":[]}'].join("");if(e.DWT.ConnectWithSocket&&e.navInfoSync.bHTML5Edition)return He.postStringDataByWSUrl(He.getWsUrl(r,n),l).then(a,s);var d="fa/VersionInfo?ts="+c;Cr.getHttpClient(r,n,t.detect.ssl).request(l,d,{},i).then(a,s)}function Ih(r,n,i){var o,a=r.host,s=r.port;return r.iServiceType===de?(t.showLoadingMsg(-1,"",e.MSG.Init_CreatingDWT),t.detect.dcpStatus=2,vh("",0),void oa(!1).then((function(){t.isFunction(r.wasmModeCallback)&&r.wasmModeCallback()}))):r.iServiceType===ge?(t.showLoadingMsg(-1,"",e.MSG.Init_CreatingDWT),t.detect.dcpStatus=2,vh("",0),void oa(!1).then((function(){t.isFunction(r.serviceModeCallback)&&r.serviceModeCallback()}))):(t.showLoadingMsg(-1,"",e.MSG.Init_CheckDWT),o=i>0?i+1:1,s||t.each(t.detect.ports,(function(e){fh.bSSL?e.ssl&&(s=e.port):e.ssl||(s=e.port)})),t.showLoadingMsg(-1,"",e.MSG.Init_CheckDWTVersion),void bh(a,s,Mr,(function(i,a,s,u){if(i===_h&&u&&u.length>0&&$a(u,t.product.getServerVersionInfo(!0)))return t.detect.dcpStatus=2,vh(a,s),t.showLoadingMsg(-1,"",e.MSG.Init_CreatingDWT),void oa(!1).then((function(){t.isFunction(r.serviceModeCallback)&&r.serviceModeCallback(a,s)}));if(n){if(o>3)return t.closeLoadingMsg(),t.detect.dcpStatus=3,void(t.isFunction(r.dwtFailedCallback)&&r.dwtFailedCallback({code:i,message:a}));setTimeout((function(){Ih(r,Rr,o)}),1e3)}else{if(!e.DWT.IfInstallDWTModuleWithZIP)return t.closeLoadingMsg(),t.detect.dcpStatus=3,void(t.isFunction(r.dwtFailedCallback)&&r.dwtFailedCallback({code:i,message:a}));yh(r,(function(){Ih(r,Rr,o)}))}})))}function wh(r){var n=function(n,i){if(e.DWT.OnWebTwainInitMessage){var o=e.Lib.product.CustomizableDisplayInfo.generalMessages.downloadNeeded;e.DWT.OnWebTwainInitMessage(o,B)}if(t.isLocalIP(r.host))!t.detect.bNoControlEvent&&t.isFunction(t.detect.onNoControl)&&(t.detect.bNoControlEvent=Rr,t.detect.onNoControl());else if(t.isFunction(e.OnRemoteWebTwainNotFoundCallback)){var a=fh.bSSL;e.OnRemoteWebTwainNotFoundCallback(t.product.name,r.host,r.port,a,t.env.bMobile)}if(t.isFunction(r.dcpFailedCallback)){var s=i,u=e.DWT.licenseException;t.isString(i)?s=i:n?t.isString(n)?s=n:n.message&&(u.code=n.code,s=n.message):s="",u.code=e.DWT.EnumDWT_Error.FailedToCreateDWTObject,u.message=s,r.dcpFailedCallback(s)}};if(!e.DWT.IfCheckDCP||r.iServiceType===de||r.iServiceType===ge)return r.dwtFailedCallback||(r.dwtFailedCallback=n),void Ih(r,Or,0);var i=function(n){var o=1,a=e.navInfoSync;if(e.navInfoSync.bWin&&(o=n>0?n+1:1)>3)return i=null,t.closeLoadingMsg(),t.detect.dcpStatus=3,void(t.isFunction(r.dwtFailedCallback)&&r.dwtFailedCallback());if(r.dwtFailedCallback||(r.dwtFailedCallback=function(){var r,n,i=e.navInfoSync;(t.closeLoadingMsg(),t.isFunction(e.OnWebTWAINModuleDownloadManually))&&(i.bLinux?(r=S,n={"default":e.dcp.getLinuxHTML5DebPath(),deb:e.dcp.getLinuxHTML5DebPath(),rpm:e.dcp.getLinuxHTML5RpmPath()}):i.bMac?(r=w,n={"default":e.dcp.getDSPath()}):(r=I,n={"default":e.dcp.getDSPath()}),e.OnWebTWAINModuleDownloadManually(n,r,i.bIE,i.bSafari,t.detect.ssl,t.env.strIEVersion))}),mh.bEnhancedMode){var s,u,c=0;return s=function(n){if(t.isArray(n)&&n.length>1){t.closeLoadingMsg();var l,d,h=n[1];if(h&&(mh.currentUserPorts=h,h.dwt))return l=h.dwt.port,d=h.dwt.sslPort,0==l||0==d?e.dcp.bEnhancedMode?(setTimeout((function(){mh.getPorts(mh.strSID,s,u)}),800),!0):++c>5?(i(o),!1):(setTimeout((function(){mh.getPorts(mh.strSID,s,u)}),300),!0):(r.port=a.bSSL?d:l,g=r.port,t.detect.urls.splice(0),t.detect.urls.push({port:g,ssl:fh.bSSL}),t.detect.ports=[{port:g,ssl:fh.bSSL}],t.detect.cUrlIndex=0,fh.bSSL?e.DWT.SSLPort=g:e.DWT.Port=g,Ih(r,Or,0),!0)}var g;return e.DWT.IfInstallDWTModuleWithZIP?(yh(r,(function(){i(o)})),!0):(t.detect.dcpStatus=3,void(t.isFunction(r.dwtFailedCallback)&&r.dwtFailedCallback()))},u=function(){return t.closeLoadingMsg(),e.DWT.IfInstallDWTModuleWithZIP?(yh(r,(function(){i(o)})),!0):(t.detect.dcpStatus=3,void(t.isFunction(r.dwtFailedCallback)&&r.dwtFailedCallback()))},mh.getPorts(mh.strSID,s,u),!0}return i=null,Ih(r,Or,0),!0};Sh(i,n)}function Sh(r,n){t.License.isLicenseMixed(null,!0)||e.Lib.License.reparseProductKey();var i=e.DWT.licenseException;if(0!=i.code)return t.License.showLicenseErrorDialog(i),!!t.isFunction(n)&&n(i.code,i.message);var o=t.product.refProductKey,a=!0,s=0,u=e.dcp,c=u.detect,l=function(e){return!!(t.isArray(e)&&e.length>0&&e[0])&&(u._setDefaultValuesFromServer(e),c.dcpStatus=c.EnumDCP_DetectStatus.UpdateSkipped,u._sendStatusEvent(),setTimeout(r,0),!0)},d=function h(r,i){if(++s>=c.IMAXCONNECTCOUNT?(c.bConnected=!1,c.dcpStatus=c.EnumDCP_DetectStatus.NotInstalled,u._sendStatusEvent()):setTimeout((function(){e.DWT.ConnectWithSocket&&e.navInfoSync.bHTML5Edition?u._checkManagerVersionWS(o,l,h):u._checkManagerVersion(o,l,h)}),1e3),a){if(t.isFunction(n)){var d={};t.Errors.Uploader_ModuleError(d),n(d._errorCode,d._errorString)}return a=!1,!1}return!0};c.bConnected=!1,e.DWT.ConnectWithSocket&&e.navInfoSync.bHTML5Edition?u._checkManagerVersionWS(o,l,d):u._checkManagerVersion(o,l,d)}if(t.LS=gh,e.DWT.NetManager.checkModuleManager=Sh,t.product.bHTML5Edition){var Th,Ch=function(){try{if("object"===("undefined"==typeof WebAssembly?"undefined":Fe(WebAssembly))&&"function"==typeof WebAssembly.instantiate){var e=new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0]));if(e instanceof WebAssembly.Module)return new WebAssembly.Instance(e)instanceof WebAssembly.Instance}}catch(es){}return!1},Eh=function(r,n,i){var o={id:r.WebTwainId,width:r.Width,height:r.Height},a=r.iServiceType;r.Container?(o.container=r.Container,o.containerId=r.Container.id):r.ContainerId&&(o.container=t.get(r.ContainerId),o.containerId=r.ContainerId),Wn(o.id)||(Ln(t.get(o.containerId))?o.id=o.containerId:o.id=o.containerId="dwtcontrolContainer"),function(r){var n=r||{};n.basePath&&(t.env.basePath=n.basePath),n.pathType&&(t.env.pathType=n.pathType),t.isUndefined(n.bDiscardBlankImage)||(t.config.bDiscardBlankImage=n.bDiscardBlankImage),n.msgPrefix&&(t.config.msgPrefix=n.msgPrefix),n.msgSuffix&&(t.config.msgSuffix=n.msgSuffix),n.detectType&&(t.detect.detectType=n.detectType),n.tryTimes&&(t.detect.tryTimes=n.tryTimes),n.onReady&&(e.DWT.OnWebTwainReady=n.onReady);var i=e.DWT.RemoteScanConfig;i||(i={sessionTimeout:300,keepAwake:!0},e.DWT.RemoteScanConfig=i),i.keepAwake===undefined&&(i.keepAwake=!0)}(o);var s,u,c=a==de;for(t.mix(o,c?{iServiceType:a}:{host:r.host,port:r.port,HTTPPort:t.detect.ssl?443:80,iServiceType:a}),o.onReady=function(r){if(!r)return delete e.DWT.ContainerMap[o.id],!1;t.replaceControl(o.id,r),t.isFunction(n)&&n(r)},o.onCreateError=function(r){delete e.DWT.ContainerMap[o.id],t.isFunction(i)&&i(r)},s=0;s<t.detect.arySTwains.length;s++)u=t.detect.arySTwains[s],o.id==u._id&&(o.id=o.id+"_"+t.getRandom()),!u._containerElement||o.container!=u._containerElement&&o.containerId!=u._containerElement.id||(o.containerId="");return function(e){var r,n;for(n=0;n<t.detect.arySTwains.length;n++)if(t.detect.arySTwains[n]._id==e.id)return void(e.bNoMask||t.closeLoadingMsg());return Ln(e.container)?e.bNoViewer=!1:e.bNoViewer=!0,(r=new Hd(e))._isTwainServiceType()||r._isDMServiceType()||r._isWasmWithScan()?(t.detect.arySTwains.push(r),t.detect.bFirst&&t._init(e),t.detect.bFirst=!1):r._OnReady(),r}(o)},Mh=function(){var r,n,i,o,a;if(e.DWT.lunload(),t.closeAll&&t.closeAll(),o=e.DWT.ContainerMap)for(a=Object.keys(o),r=0;r<a.length;r++)(i=a[r])&&i in o&&(n=o[i])&&(n.__unload(),delete o[i]);for(r=0;r<t.product.unloadQueue.length;r++){var s=t.product.unloadQueue[r];t.isFunction(s)&&s()}return t.product.unloadQueue.splice(0),e.DWT.DynamicContainers.splice(0),t.detect.arySTwains.splice(0),e.Lib.detect.bNeedWasm=!1,t.MobileFuns?t.MobileFuns.unloadWasm():t.Promise.resolve()},Dh=function(r){var n=e.DWT.Containers;if(n&&r){var i=n.length;(Vh+=1)>=i&&function(r){var n,i,o,a,s=e.DWT.Containers,u=t.Promise.resolve(0),c=e.DWT.licenseException,l=0!=c.code;if(l){var d=t.getLogger();d&&d.error(c.message)}if(s&&s.length>0){if(l||Lh.DCP_DWT_OnClickCloseInstall(!1,!0),t.isUndefined(r))for(i=0;i<s.length&&!(t.product.bHTML5Edition&&Wn(o=s[i].WebTwainId)&&(a=e.DWT.ContainerMap[o]));i++);else a=r;a&&(t.product.bHTML5Edition?(a._isTwainServiceType()||a._isDMServiceType())&&(u=a._innerFunRawV2("LogLevel").then((function(){Qd(a)}),(function(){-2207==a._errorCode&&(t.isFunction(e.DWT.OnWebTwainNeedUpgradeWebJavascript)?e.DWT.OnWebTwainNeedUpgradeWebJavascript(a.ErrorString):t.detect.bPromptJSOrServerOutdated||(t.detect.bPromptJSOrServerOutdated=Rr)),Qd(a)}))):Qd(a))}var h=[],g=!1;for(t.License.isLTS()&&t.isNumber(c.code)&&0!==c.code&&!0===c.fromLTS&&(g=!0),i=0;i<s.length;i++)t.product.bHTML5Edition&&(o=s[i].WebTwainId),(n=e.DWT.ContainerMap[o])&&(g?t.hide(n._containerElement):t.product.bHTML5Edition&&(n._isBindViewer()&&(n.Width<=0||n.Height<=0)&&(n.Width<=0&&(n.Width=270),n.Height<=0&&(n.Height=350)),n._isTwainServiceType()||n._isDMServiceType()?h.push(eh(n)):l||t.License.checkProductKey(n,{Core:!0}))),n=null;h.length>0&&(u=u.then((function(){return e.Lib.Promise.all(h)}))),s=null,g?(e.DWT.ContainerMap={},t.detect.arySTwains.splice(0)):u=u.then((function(){t.isFunction(e.DWT.OnWebTwainReady)?e.DWT.OnWebTwainReady():t.isFunction(Lh.Dynamsoft_OnReady)&&Lh.Dynamsoft_OnReady()}),(function(e){t.error(e)}))}(r)}else;},kh=function(e){},xh=function(){e.DWT.ShowMessage(e.MSG.Err_BrowserNotSupportWasm,{width:510,headerStyle:2})},Ph=function(r,n,i){if(t.openLoadingMsg(),Ha(),t.product.bFullEdition){if(t.isUndefined(r.UseLocalService))r.UseLocalService=t.product.UseLocalService;else if(r.UseLocalService&&e.navInfoSync.bAndroid);else if(r.UseLocalService&&t.env.bMobile){var o=e.MSG.Err_ServiceModeNotSupportMobile;return i&&i(o),t.closeLoadingMsg(),Or}}else{if(!1===r.UseLocalService){var a=e.MSG.Err_ServiceEditionNotSupportWasm;return i&&i(a),t.closeLoadingMsg(),Or}r.UseLocalService=!0}t.License.isLicenseMixed(null,!0)||e.Lib.License.reparseProductKey();var s=e.DWT.licenseException;if(0!=s.code)return t.License.showLicenseErrorDialog(s),t.closeLoadingMsg(),Or;if(!1===r.UseLocalService&&!Ch())return t.closeLoadingMsg(),xh(),i&&i(e.MSG.Err_BrowserNotSupportWasm),Or;var u,c,l={},d=r.WebTwainId,g=r.Host,f=r.Port,m=r.PortSSL;(!t.product._srcUseLocalService&&r.UseLocalService&&(t.detect.dcpStatus=0,t.product._srcUseLocalService=!0),r.Container)?(u=r.Container,l.container=r.Container,l.bNoViewer=!1,(c=l.container.id)!==Th&&null!==c&&""!==c||(l.container.id=["dwt_",t.getRandom()].join("")),l.containerId=l.container.id,l.id=d===Th||null===d||""===d?l.container.id:d):d===Th||null===d||""===d?(l.id=["dwt_",t.getRandom()].join(""),l.bNoViewer=!0):t.isString(d)&&t.get(d)?(l.id=d,l.containerId=d,u=t.get(d),l.bNoViewer=!1):(l.id=d,l.bNoViewer=!0);return l.bNoViewer?(l.width=0,l.height=0):(t.isUndefined(r.Width)?u&&u.style.width?l.width=u.style.width:l.width=300:l.width=r.Width,t.isUndefined(r.Height)?u&&u.style.height?l.height=u.style.height:l.height=300:l.height=r.Height),r.UseLocalService?(e.navInfoSync.bAndroid?(l.iServiceType=ge,t.detect.bNeedWasm=!0):l.iServiceType=he,l.dmService=r.dmService):(l.iServiceType=de,t.detect.bNeedWasm=!0),l.iServiceType!=he&&l.iServiceType!=ge||(t.isString(g)&&""!=g||(g=h()),l.host=g,Wh.bSSL?(m||(m=e.DWT.SSLPort),l.port=m):(f||(f=e.DWT.Port),l.port=f)),Ya().then(no).then((function(){return new t.Promise((function(t,r){wh({host:l.host,port:l.port,iServiceType:l.iServiceType,serviceModeCallback:function(n,o){Zd(l,t,(function(t,n,o){o&&(n&&n._bReady||0==e.DWT.licenseException&&hh(n));i&&i(t),n&&n.__unload(),r()}))},wasmModeCallback:function(){Zd(l,t,(function(e,t){i&&i(e),t&&t.__unload(),r()}))},dcpFailedCallback:function(e){i&&i(e),r()}})}))})).then((function(e){t.closeLoadingMsg(),t.isFunction(n)&&n(e)}),(function(e){t.closeLoadingMsg()})),Rr},Wh=e.navInfoSync,Lh=t.win,Fh=e.Lib.timestamp;Lh.addEventListener("beforeunload",(function(){e.Lib.page.bUnload=!0,e.DWT.Unload(),e.Lib.page.OnUnload&&e.Lib.page.OnUnload()})),Lh.addEventListener("unload",(function(){e.DWT.Unload()})),t.replaceControl=function(t,r){e.DWT.ContainerMap[t]=r},t.detect.onNoControl=function(r,n,i,o){o&&o._bRemoteMode&&!o._bNotShowMessage?t.isFunction(e.OnRemoteWebTwainNotFoundCallback)&&e.OnRemoteWebTwainNotFoundCallback(t.product.name,o._serverInfo.server,o._serverInfo.port,o._serverInfo.ssl,t.env.bMobile):t.product.bFullEdition||!t.env.bMobile?(0!=e.DWT.licenseException.code||t.detect.bOK||t.asyncQueue.pushToDo(null,e.DWT.Load),t.product.bHTML5Edition?e.DWT.CheckWebTwainBySocket((function(){e.DWT.NeedCheckWebTwainBySocket()?t.isFunction(e.OnHTTPCorsError)&&e.OnHTTPCorsError():oo(r,n,i,!1,!0)}),(function(){oo(r,n,i,!0,!0)}),(function(){oo(r,n,i,!1,!1)})):oo(r,n,i,!1,!0)):t.isFunction(e.MobileNotSupportCallback)&&e.MobileNotSupportCallback()},e.DWT.Unload=function(){Mh();try{t.closeLoadingMsg(),e.DWT.CloseDialog(),t._zdgb_xkz_dhk(),t.closeProgress(null,""),t.hideMask(),function(){for(var e,r,n,i=["dynamsoft.webtwain.install.js","dynamsoft.viewer.js","dynamsoft.imageio.js","dynamsoft.lts.js","dynamsoft.viewer.css","dynamsoft.webtwain.css"],o=document.head.childNodes,a=o.length-1;a>=0;a--)if("LINK"==(r=o[a]).tagName?n=r.href:"SCRIPT"==r.tagName&&(n=r.src),n)for(e=0;e<i.length;e++)n.indexOf(i[e])>=0&&r.remove();t.detect.cssLoaded=!1}()}catch(r){}e.Lib.product.bDWTLoading=!1};var Vh=0,Nh=function(){var r=Ke(it.mark((function n(r,i,o){var a,s,u,c,l;return it.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=e.DWT.Containers,c=!1,o==de&&(c=!0),a&&0!==a.length){n.next=6;break}return t.closeLoadingMsg(),t.log("Dynamsoft.DWT.Containers was not set."),n.abrupt("return");case 6:s=0;case 7:if(!(s<a.length)){n.next=21;break}if(u=t.clone(a[s]),Ln(t.get(u.ContainerId))||(u.bNoViewer=!0),u.iServiceType=o,l=!c,u.bLocalService!==undefined?l=!!u.bLocalService:u.UseLocalService!==undefined&&(l=!!u.UseLocalService),l&&(u.host=r,u.port=i),!e.DWT.ContainerMap[u.WebTwainId]){n.next=17;break}return n.abrupt("continue",18);case 17:Eh(u,Dh,kh);case 18:s++,n.next=7;break;case 21:if(c||!(t.detect.arySTwains.length>0)){n.next=24;break}return n.next=24,t.startCheckWS();case 24:case"end":return n.stop()}}),n)})));return function(e,t,n){return r.apply(this,arguments)}}();e.DWT.Load=function(){return t.product.bDWTLoading?t.Promise.resolve():(t.product.bDWTLoading=Rr,t.openLoadingMsg(),qa().then(Ya).then(no).then(Mh).then((function(){e.DWT.CloseDialog()})).then(e.DWT._innerLoad).then((function(){t.product.bDWTLoading=!1,t.closeLoadingMsg()}),(function(e){return t.product.bDWTLoading=!1,t.closeLoadingMsg(),t.log(e),t.Promise.reject(e)})))},e.DWT.CheckConnectToTheService=function(r,n,i,o){var a=0,s=r,u=n,c=i,l=o;if(t.isFunction(s)&&t.isFunction(u))for(c=s,l=u,s=h(),a=0;a<e.Lib.detect.ports.length;a++)if(e.navInfoSync.bSSL&&e.Lib.detect.ports[a].ssl||!e.navInfoSync.bSSL&&!e.Lib.detect.ports[a].ssl){u=e.Lib.detect.ports[a].port;break}s||(s=h()),e.navInfoSync.bAndroid?jn().then(c,l):bh(s,u,Mr,(function(r,n,i,o){if(r===_h&&o&&o.length>0&&$a(o,t.product.getServerVersionInfo(!0)))return e.DWT.CloseDialog(),void(t.isFunction(c)&&c(n,i));t.isFunction(l)&&l()}))},e.DWT.ConnectToTheService=function(){t.asyncQueue.start()},e.DWT.CreateDWTObject=function(r,n,i,o,a,s){var u,c=a,l=s,d=arguments;if(!t.product.loadResourcePath)return t.openLoadingMsg(),void qa().then(Ya).then((function(){setTimeout((function(){e.DWT.CreateDWTObject(r,n,i,o,a,s)}),100)}),(function(){t.closeLoadingMsg()}));t.isFunction(n)&&t.isFunction(i)&&t.isUndefined(o)&&t.isUndefined(a)&&t.isUndefined(s)?(c=n,l=i,u={WebTwainId:r,Host:e.DWT.Host,Port:e.DWT.Port,PortSSL:e.DWT.SSLPort,UseLocalService:t.product.UseLocalService}):u={WebTwainId:r,Host:n,Port:i,PortSSL:o,UseLocalService:t.product.UseLocalService};var h=r;if(t.isString(h)&&(h=t.get(h)),t.isShadowRoot(h)){var g=document.createElement("div");h.appendChild(g),h=g}if(t.isDOM(h)){var f=t.getShadowRoot(h);if(f){var m=document.createElement("style");m.innerHTML=['@import url("',e.DWT.ResourcesPath,"/src/dynamsoft.viewer.css",Fh,'")'].join(""),f.appendChild(m)}u.Container=h,h.id&&""!=h.id||(h.id=["dwt_",t.getRandom()].join("")),u.WebTwainId=h.id}else{if(!t.isString(r))return t.isFunction(l)&&l(t.Errors.container_id_not_string()),Or;if(!t.get(r))return t.isFunction(l)&&l(t.Errors.container_id_not_exist(r)),Or}return Ph(u,c,(function(r){0!=e.DWT.licenseException.code||t.detect.bOK||(t.asyncQueue.stop(),t.asyncQueue.pushToDo(null,e.DWT.CreateDWTObject,d)),l(r)}))},e.DWT.CreateDWTObjectEx=function(r,n,i){var o=r.Container,a=arguments;if(!t.product.loadResourcePath)return t.openLoadingMsg(),void qa().then(Ya).then((function(){t.closeLoadingMsg(),setTimeout((function(){e.DWT.CreateDWTObjectEx(r,n,i)}),100)}),(function(){t.closeLoadingMsg()}));if(t.isShadowRoot(o)){var s=document.createElement("div");o.appendChild(s),o=s}if(t.isDOM(o)){var u=t.getShadowRoot(o);if(u){var c=document.createElement("style");c.innerHTML=['@import url("',e.DWT.ResourcesPath,"/src/dynamsoft.viewer.css",Fh,'")'].join(""),u.appendChild(c)}u==o&&(o=document.createElement("div"),u.appendChild(o),r.Container=o),o.id&&""!=o.id||(o.id=["dwt_",t.getRandom()].join("")),t.isString(r.WebTwainId)||(r.WebTwainId=o.id)}else if(!t.isString(r.WebTwainId))return i&&i(t.Errors.webtwain_id_not_string()),Or;return Ph(r,n,(function(r){0!=e.DWT.licenseException.code||t.detect.bOK||(t.asyncQueue.stop(),t.asyncQueue.pushToDo(null,e.DWT.CreateDWTObjectEx,a)),t.isFunction(i)&&i(r)}))},e.DWT.CreateRemoteScanObjectAsync=function(e){return ni("CreateRemoteScanObjectAsync",null),Kd(e,!1).then((function(e){if(ii("CreateRemoteScanObjectAsync"),e&&!e._blts&&!t.License.checkLocalPlatformForRemoteService(e)){var r={code:e._errorCode,message:e._getErrorString()};throw e&&e.__unload(),r}var n=new Yd(e);return Object.preventExtensions(n),n}),(function(e){throw ii("CreateRemoteScanObjectAsync"),e}))},e.DWT._innerLoad=Ke(it.mark((function r(){var n,i,o,a,s,u,c,l,d,h,g,f,m,_;return it.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t.page.bUnload=Or,t.product.bHTML5Edition){r.next=3;break}return r.abrupt("return",Or);case 3:if(t.License.isLicenseMixed(null,!0)||e.Lib.License.reparseProductKey(),0==(n=e.DWT.licenseException).code){r.next=8;break}return t.License.showLicenseErrorDialog(n),r.abrupt("return",t.Promise.reject({code:n.code,message:n.message}));case 8:if((!t.product.UseLocalService||t.env.bMobile||e.navInfoSync.bAndroid)&&e.WasmEnv&&!e.WasmEnv.wasmLoad&&(e.Lib.License.isLTS()||Nn()),i=e.DWT.Containers,u=[],!i){r.next=30;break}o=0;case 12:if(!(o<i.length)){r.next=30;break}s=i[o],c=s.Container,t.isShadowRoot(c)&&(l=document.createElement("div"),c.appendChild(l),c=l),t.isDOM(c)&&((d=t.getShadowRoot(c))&&((h=document.createElement("style")).innerHTML=['@import url("',e.DWT.ResourcesPath,"/src/dynamsoft.viewer.css",Fh,'")'].join(""),d.appendChild(h)),c.id&&""!=c.id||(c.id=["dwt_",t.getRandom()].join("")),s.ContainerId=c.id),(t.isString(s.WebTwainId)||t.isNumber(s.WebTwainId))&&""!=s.WebTwainId||(t.isString(s.ContainerId)&&""!=s.ContainerId?s.WebTwainId=s.ContainerId:s.WebTwainId=["dwt_",t.getRandom()].join("")),a=0;case 19:if(!(a<u.length)){r.next=26;break}if(s.WebTwainId!=u[a]){r.next=23;break}return s.WebTwainId=s.WebTwainId+"_"+t.getRandom(),r.abrupt("break",26);case 23:a++,r.next=19;break;case 26:u.push(s.WebTwainId);case 27:o++,r.next=12;break;case 30:if(!t.IsNeedLoadWasm()){r.next=35;break}if(Ch()){r.next=34;break}return xh(),r.abrupt("return",Or);case 34:t.detect.bNeedWasm=!0;case 35:if(g=t.product.UseLocalService?e.navInfoSync.bAndroid?ge:he:de,r.prev=36,g!=he&&g!=ge){r.next=48;break}return f=e.DWT.Host,m=e.DWT.Port,m=Wh.bSSL?e.DWT.SSLPort:e.DWT.Port,r.next=43,new t.Promise((function(e,t){wh({host:f,port:m,iServiceType:g,serviceModeCallback:function(t,r){e({host:t,port:r})},wasmModeCallback:function(){e()},dcpFailedCallback:function(e){t(e)}})}));case 43:return _=r.sent,r.next=46,Nh(_.host,_.port,g);case 46:r.next=50;break;case 48:return r.next=50,Nh(Th,Th,g);case 50:r.next=54;break;case 52:r.prev=52,r.t0=r["catch"](36);case 54:case"end":return r.stop()}}),r,null,[[36,52]])}))),e.DWT.DeleteDWTObject=function(r){var n,i=e.DWT.ContainerMap;if(!t.product.bHTML5Edition)return Or;if(i&&r in i){var o=i[r];o&&(delete i[r],o.__unload())}for(n=0;n<e.DWT.DynamicContainers.length;n++)if(e.DWT.DynamicContainers[n].WebTwainId==r){e.DWT.DynamicContainers.splice(n,1);break}return t.closeLoadingMsg(),Rr},e.DWT.GetWebTwain=function(r){var n,i,o,a,s=r;if(n=e.DWT.Containers,t.isString(s))s=t.get(s);else if(t.isDOM(s));else if(!s&&n&&n.length>0)for(o=0;o<n.length;o++){if(n[o].Container){s=n[o].Container;break}if(n[o].ContainerId&&Ln(t.get(n[o].ContainerId))){s=t.get(n[o].ContainerId);break}}var u=e.DWT.ContainerMap;if(s&&u&&n&&n.length>0)for(o=0;o<n.length;o++)if(a=!1,(i=n[o]).Container){if(i.Container==s&&(a=Wn(i.WebTwainId)?i.WebTwainId:i.Container.id)&&a in u)return u[a]}else if(i.ContainerId&&i.ContainerId==s.id&&(a=Wn(i.WebTwainId)?i.WebTwainId:i.ContainerId)&&a in u)return u[a];return e.DWT.GetWebTwainEx(r)},e.DWT.GetWebTwainEx=function(r){var n,i,o=r;if(n=e.DWT.DynamicContainers,t.isDOM(o))o=o.id;else if(!o&&n&&n.length>0)for(i=0;i<n.length;i++)if(Wn(n[i].WebTwainId)){o=n[i].WebTwainId;break}if(n=null,o){var a=e.DWT.ContainerMap;if(a&&o in a)return a[o]}return null}}if(t.product.bActiveXEdition){var Ah=function(){var r,n,i,o,a;if(e.DWT.lunload(),t.closeAll&&t.closeAll(),o=e.DWT.ContainerMap)for(a=Object.keys(o),r=0;r<a.length;r++)(i=a[r])&&i in o&&(n=o[i])&&(n.__unload(),delete o[i]);for(r=0;r<t.product.unloadQueue.length;r++){var s=t.product.unloadQueue[r];t.isFunction(s)&&s()}return t.product.unloadQueue.splice(0),t.detect.arySTwains.splice(0),t.Promise.resolve()},Bh=!1;e.DWT.Unload=function(){Ah();try{t.closeLoadingMsg(),e.DWT.CloseDialog(),t._zdgb_xkz_dhk(),t.closeProgress(null,""),t.hideMask()}catch(r){}},e.DWT.Load=function(){if(!t.product.bDWTLoading){t.product.bDWTLoading=true,t.License.isLicenseMixed(null,!0)||e.Lib.License.reparseProductKey();var r=e.DWT.licenseException;return 0!=r.code?(t.License.showLicenseErrorDialog(r),t.closeLoadingMsg(),t.Promise.reject({code:r.code,message:r.message})):(t.openLoadingMsg(),e.Lib.detect.bNeedWasm=Bh,t.detect.axAutoLoadDone=!1,qa().then(Ya).then(Ah).then((function(){return e.DWT._innerLoad()})).then((function(){t.product.bDWTLoading=!1,t.detect.axAutoLoadDone=!0,t.closeLoadingMsg()}),(function(e){t.product.bDWTLoading=!1,t.detect.axAutoLoadDone=!1,t.closeLoadingMsg(),t.log(e)})))}},e.DWT.ConnectToTheService=e.DWT.Load,e.DWT.CheckConnectToTheService=function(e,r,n,i){t.product.bActiveXEdition?t.isFunction(i)&&i():t.isFunction(n)&&n()},e.DWT.CreateDWTObject=function(r,n,i,o,a,s){return t._safePromptCustomMsg((function(){s&&s(e.Lib.product.CustomizableDisplayInfo.errorMessages.ERR_BROWSER_NOT_SUPPORT)})),Bh},e.DWT.CreateDWTObjectEx=function(r,n,i){return t._safePromptCustomMsg((function(){i&&i(e.Lib.product.CustomizableDisplayInfo.errorMessages.ERR_BROWSER_NOT_SUPPORT)})),Bh},e.DWT.CreateRemoteScanObjectAsync=function(){var e={};return t.Errors.ActiveXNotSupport(e),t.Promise.reject({code:e._errorCode,message:e._errorString})},e.DWT.DeleteDWTObject=function(e){if(t.product.bActiveXEdition)return Bh}}function Oh(r,n){r.acquireImage=function(){var i=Ke(it.mark((function o(i,a){var s,u,c,l,d,h,g,f,m,_,p,v,y,b,I,w;return it.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(s=this.deviceType,u=this.serviceInfo,c=i?t.clone(i):{},l=!0,a){o.next=3;break}throw t.Errors.ThrowInvalidParameterSendTo();case 3:if(d=e.DWT.RemoteScanConfig,h=kn(),ni("acquireImage",a),o.prev=6,d&&xn(d.keepAwake),(s&ae)!=ae&&(s&se)!=se){o.next=47;break}return f=new Hu((null==u||null===(g=u.attrs)||void 0===g?void 0:g.url)||(null==u?void 0:u.server),n),o.prev=10,o.next=13,ca(null,f,u,n);case 13:return o.sent,o.next=16,f.acquireImage(r,c,!1);case 16:m=o.sent,_=0,v=xu(s);case 19:return o.prev=19,o.next=22,f.getImageToDWT(m,v);case 22:p=o.sent,o.next=32;break;case 25:if(o.prev=25,o.t0=o["catch"](19),0!=_){o.next=31;break}throw y={},t.Errors.SourceHasNothingToCapture(y),{code:y._errorCode,meesage:y._errorString};case 31:throw o.t0;case 32:if(!p){o.next=35;break}return o.next=35,new t.Promise((function(e,r){a._innerLoadImageFromBinary(p,yi,!1,(function(r,n){var i,o;t.log("LoadImageFromBinary success"),i=t.isArray(n.metaData)&&n.metaData.length>0?n.metaData[0]:{id:n.ids},o={imageId:parseInt(i.id)},!1!==c.IfGetImageInfo&&(o.imageInfo={XResolution:i.resolutionX,YResolution:i.resolutionY,ImageWidth:i.width,ImageLength:i.height,BitsPerPixel:i.bitDepth}),t.isFunction(a._OnPostTransferAsync)&&a._OnPostTransferAsync([!0,t.stringify(o)]),e()}),(function(e,n){t.log(n),r({code:e,message:n})}))}));case 35:_++;case 36:if(p){o.next=19;break}case 37:o.next=42;break;case 39:throw o.prev=39,o.t1=o["catch"](10),o.t1;case 42:o.prev=42;try{f._bInited&&f.dispose()}catch(S){}return o.finish(42);case 45:o.next=84;break;case 47:if(null==u||null===(b=u.attrs)||void 0===b||!b.url){o.next=84;break}return(I=ei(u)).attrs=I.attrs||{},I.attrs.bNoMask=!0,I.attrs.bNotShowMessage=!0,o.prev=52,o.next=55,th(I,!0);case 55:if(!(w=o.sent)._bRemoteMode){o.next=61;break}return o.next=59,w.selectDevice(r);case 59:o.next=63;break;case 61:return o.next=63,w.SelectDeviceAsync(r);case 63:return o.next=65,w._acquireImageAsync("acquireImage",c,a);case 65:o.sent,o.next=71;break;case 68:throw o.prev=68,o.t2=o["catch"](52),o.t2;case 71:if(o.prev=71,!w){o.next=81;break}return o.prev=73,o.next=76,w._closeSourceAsync("");case 76:o.next=80;break;case 78:o.prev=78,o.t3=o["catch"](73);case 80:w.dispose();case 81:return o.finish(71);case 82:o.next=84;break;case 84:o.next=90;break;case 86:throw o.prev=86,o.t4=o["catch"](6),l=!1,o.t4;case 90:return o.prev=90,ii("acquireImage"),xn(h),o.finish(90);case 94:return o.abrupt("return",l);case 95:case"end":return o.stop()}}),o,this,[[6,86,90,94],[10,39,42,45],[19,25],[52,68,71,82],[73,78]])})));return function(e,t){return i.apply(this,arguments)}}()}t.addDeviceAcquireMethod=Oh,e.DWT.FindDynamsoftServiceAsync=function(){var e=Ke(it.mark((function r(e,n){var i,o,a,s,u;return it.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!t.product.bActiveXEdition){r.next=4;break}return i={},t.Errors.ActiveXNotSupport(i),r.abrupt("return",t.Promise.reject({code:i._errorCode,message:i._errorString}));case 4:if(!(e&&t.isString(e)&&t.startsWith(location.href,"https://")&&t.startsWith(e,"http://"))){r.next=8;break}return o={},t.Errors.HTTPSRequired(o,location.href,e),r.abrupt("return",t.Promise.reject({code:o._errorCode,message:o._errorString}));case 8:if(t.isString(e)&&""!=e){r.next=12;break}return a={},t.Errors.InvalidServerUrl(a),r.abrupt("return",t.Promise.reject(bt(a)));case 12:return s=[],u=new Hu(e,!0),ni("FindDynamsoftServiceAsync",null),r.prev=14,r.next=17,u.getDynamsoftService(n);case 17:s=r.sent,r.next=23;break;case 20:throw r.prev=20,r.t0=r["catch"](14),r.t0;case 23:r.prev=23,ii("FindDynamsoftServiceAsync");try{u._bInited&&u.dispose()}catch(c){}return r.finish(23);case 27:return r.abrupt("return",s);case 28:case"end":return r.stop()}}),r,null,[[14,20,23,27]])})));return function(t,r){return e.apply(this,arguments)}}(),e.DWT.FindDevicesAsync=function(){var r=Ke(it.mark((function n(r,i,o,a){var s,u,c,l,d,f,m,_,p,v,y,b,I,w,S,T,C,E,M,D,k,x,P,W;return it.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s=[],u="FindDevicesAsync",c=[],m=!1,_=null!=i?i:ue,!t.product.bActiveXEdition){n.next=5;break}return v={},t.Errors.ActiveXNotSupport(v),n.abrupt("return",t.Promise.reject({code:v._errorCode,message:v._errorString}));case 5:if(!(r&&t.isString(r)&&t.startsWith(location.href,"https://")&&t.startsWith(r,"http://"))){n.next=9;break}return y={},t.Errors.HTTPSRequired(y,location.href,r),n.abrupt("return",t.Promise.reject({code:y._errorCode,message:y._errorString}));case 9:if(!(r instanceof $n)){n.next=12;break}n.next=16;break;case 12:if(t.isString(r)&&""!=r){n.next=16;break}return b={},t.Errors.InvalidServerUrl(b),n.abrupt("return",t.Promise.reject(bt(b)));case 16:if(ni(u,null),n.prev=17,!t.isString(r)){n.next=50;break}if(I=r,!(t.startsWith(I,"127.0.0.1")||t.startsWith(I,"http://127.0.0.1")||t.startsWith(I,"https://127.0.0.1"))){n.next=44;break}if(e.navInfoSync.bAndroid||(m=!0),L=void 0,F=void 0,V=void 0,L=h(),F=g(),V=Ue(new Xe(L,F,t.detect.ssl)),w={server:V,attrs:{url:V,UUID:"",service_type:Ie}},!t.env.bMobile){n.next=30;break}if(!e.navInfoSync.bAndroid){n.next=27;break}n.next=28;break;case 27:throw t.Errors.ThrowMobileNotSupportOS(u);case 28:n.next=31;break;case 30:c.push(w);case 31:return n.prev=31,n.next=34,jn();case 34:n.next=41;break;case 36:return n.prev=36,n.t0=n["catch"](31),ii(u),oh(),n.abrupt("return",s);case 41:f=w.server,n.next=48;break;case 44:return f=r,n.next=47,e.DWT.FindDynamsoftServiceAsync(r);case 47:c=n.sent;case 48:n.next=51;break;case 50:r instanceof $n&&(m=!0,T=null==r||null===(S=r.attrs)||void 0===S?void 0:S.service_type,Ie==T&&c.push(r));case 51:l=0;case 52:if(!(l<c.length)){n.next=86;break}return C=ei(c[l]),E=void 0,M=void 0,n.prev=54,C.attrs=C.attrs||{},C.attrs.bNoMask=!0,C.attrs.bNotShowMessage=!0,n.next=60,th(C,!0);case 60:if(!(M=n.sent)._bRemoteMode){n.next=67;break}return n.next=64,M.getDevices(_,o,a);case 64:E=n.sent,n.next=72;break;case 67:return D=e.navInfoSync.bAndroid?le:ue,_=null!=i?i:D,n.next=71,M.GetDevicesAsync(_,o,a);case 71:E=n.sent;case 72:n.next=79;break;case 74:if(n.prev=74,n.t1=n["catch"](54),!a){n.next=78;break}throw n.t1;case 78:p=n.t1;case 79:return n.prev=79,M&&M.dispose(),n.finish(79);case 82:if(t.isArray(E)&&E.length>0)for(d=0;d<E.length;d++)s.push(E[d]);case 83:l++,n.next=52;break;case 86:if(!f||m){n.next=103;break}if(k=(_&se)==se,!((_&ae)==ae)&&!k){n.next=103;break}return x=new Hu(f,!0),n.prev=90,n.next=93,x.getSources(_,o);case 93:if(P=n.sent,t.isArray(P)&&P.length>0)for(d=0;d<P.length;d++)Oh(W=P[d],!0),s.push(W);n.next=100;break;case 97:throw n.prev=97,n.t2=n["catch"](90),n.t2;case 100:n.prev=100;try{x._bInited&&x.dispose()}catch(N){}return n.finish(100);case 103:n.next=108;break;case 105:throw n.prev=105,n.t3=n["catch"](17),n.t3;case 108:return n.prev=108,ii(u),p&&e.DWT.lsetException(p.code,p.message),n.finish(108);case 112:return n.abrupt("return",s);case 113:case"end":return n.stop()}var L,F,V}),n,null,[[17,105,108,112],[31,36],[54,74,79,82],[90,97,100,103]])})));return function(e,t,n,i){return r.apply(this,arguments)}}(),t.timestamp="?t=20230105181423",e.Ready=function(t){var r=e.Lib;if(!e.navInfo)return r.asyncGetNavInfo().then((function(){try{t(r)}catch(es){throw r.log(es.stack||es,"error"),es}}));try{t(r)}catch(es){throw r.log(es.stack||es,"error"),es}}}();
 
Dynamsoft.DWT.bNpm=true;Dynamsoft.DWT.dbrCanvasMaxWH=4096; 
 
Dynamsoft.aryAddonReadyFun=[];Dynamsoft.AddonReady=function(fn){Dynamsoft.aryAddonReadyFun.push(fn);}; 
Dynamsoft.Lib.mix(Dynamsoft,{license:"",workerPathPdfR:"",workerPathPdfW:"",workerPathImgcore:""}); 
 
/*! 20230105181553
* Dynamsoft JavaScript Library
* Product: Dynamsoft Web Twain
* Web Site: https://www.dynamsoft.com
*
* Copyright 2023, Dynamsoft Corporation
* Author: Dynamsoft Support Team
*
* Module: BarcodeReader
* Version: 18.1
* 
*/
var Dynamsoft=self.Dynamsoft||{};Dynamsoft.DWT=Dynamsoft.DWT||{},Dynamsoft.DBR=Dynamsoft.DBR||{},Dynamsoft.aryAddonReadyFun=Dynamsoft.aryAddonReadyFun||[],Dynamsoft.AddonReady=Dynamsoft.AddonReady||function(e){Dynamsoft.aryAddonReadyFun.push(e)},function(){Dynamsoft.BarcodeReaderAddon=Dynamsoft.BarcodeReaderAddon||{};var n=Dynamsoft.BarcodeReaderAddon;n.Version="9.4.0.1025",n._decoding=!1,n._decodeQueue=[],n._decodeNext=function(){var e,t;0==n._decodeQueue.length?n._decoding=!1:(e=(t=n._decodeQueue[0]).method,t=t.args,n._decodeQueue.splice(0,1),e.apply(null,t))},n._defaultRuntimeSettingsStr="",n._defaultTemplateStr="",n._activeXInstance=!1,n.BarcodeReaderException=function(){var e=arguments[0],t=Dynamsoft.DBR.EnumErrorCode.DBR_UNKNOWN,e="number"==typeof e?(t=e,new Error(arguments[1])):new Error(e);return e.code=t,e},n.RemoveNonPrintableChar=function(e){return Dynamsoft.Lib.isString(e)?e.replace(/[^\x20-\x7E]|(\\")/g,""):e},n.errors={webcamNotInstalled:"The Webcam add-on not installed.",nonServiceNotSupportWebcamDecode:"The BarcodeReader add-on does not support reading barcodes from video streams.",decodeResultEmpty:"decode result is empty.",ServiceEditionNotSupportDbr:"The BarcodeReader add-on does not support your Operating System.",ServiceEditionNotSupportWasmMode:"You cannot call this method on this WebTwain instance."},n._activeXMaxIEVersion=9,n.logLevel=3,Dynamsoft.DBR.EnumAccompanyingTextRecognitionMode={ATRM_GENERAL:1,ATRM_SKIP:0},Dynamsoft.DBR.EnumBarcodeColourMode={BICM_DARK_ON_LIGHT:1,BICM_LIGHT_ON_DARK:2,BICM_DARK_ON_DARK:4,BICM_LIGHT_ON_LIGHT:8,BICM_DARK_LIGHT_MIXED:16,BICM_DARK_ON_LIGHT_DARK_SURROUNDING:32,BICM_SKIP:0},Dynamsoft.DBR.EnumBarcodeComplementMode={BCM_AUTO:1,BCM_GENERAL:2,BCM_SKIP:0},Dynamsoft.DBR.EnumBarcodeFormat={BF_ALL:-32505857,BF_ONED:2047,BF_GS1_DATABAR:260096,BF_CODE_39:1,BF_CODE_128:2,BF_CODE_93:4,BF_CODABAR:8,BF_ITF:16,BF_EAN_13:32,BF_EAN_8:64,BF_UPC_A:128,BF_UPC_E:256,BF_INDUSTRIAL_25:512,BF_CODE_39_EXTENDED:1024,BF_GS1_DATABAR_OMNIDIRECTIONAL:2048,BF_GS1_DATABAR_TRUNCATED:4096,BF_GS1_DATABAR_STACKED:8192,BF_GS1_DATABAR_STACKED_OMNIDIRECTIONAL:16384,BF_GS1_DATABAR_EXPANDED:32768,BF_GS1_DATABAR_EXPANDED_STACKED:65536,BF_GS1_DATABAR_LIMITED:131072,BF_PATCHCODE:262144,BF_PDF417:33554432,BF_QR_CODE:67108864,BF_DATAMATRIX:134217728,BF_AZTEC:268435456,BF_MAXICODE:536870912,BF_MICRO_QR:1073741824,BF_MICRO_PDF417:524288,BF_GS1_COMPOSITE:-2147483648,BF_NULL:0},Dynamsoft.DBR.EnumBarcodeFormat_2={BF2_NULL:0,BF2_POSTALCODE:32505856,BF2_NONSTANDARD_BARCODE:1,BF2_USPSINTELLIGENTMAIL:1048576,BF2_POSTNET:2097152,BF2_PLANET:4194304,BF2_AUSTRALIANPOST:8388608,BF2_RM4SCC:16777216,BF2_DOTCODE:2},Dynamsoft.DBR.EnumBinarizationMode={BM_AUTO:1,BM_LOCAL_BLOCK:2,BM_SKIP:0},Dynamsoft.DBR.EnumClarityCalculationMethod={ECCM_CONTRAST:1},Dynamsoft.DBR.EnumClarityFilterMode={CFM_GENERAL:1},Dynamsoft.DBR.EnumColourClusteringMode={CCM_AUTO:1,CCM_GENERAL_HSV:2,CCM_SKIP:0},Dynamsoft.DBR.EnumColourConversionMode={CICM_GENERAL:1,CICM_SKIP:0},Dynamsoft.DBR.EnumConflictMode={CM_IGNORE:1,CM_OVERWRITE:2},Dynamsoft.DBR.EnumDeformationResistingMode={DRM_AUTO:1,DRM_GENERAL:2,DRM_SKIP:0},Dynamsoft.DBR.EnumDPMCodeReadingMode={DPMCRM_AUTO:1,DPMCRM_GENERAL:2,DPMCRM_SKIP:0},Dynamsoft.DBR.EnumErrorCode={DBR_SYSTEM_EXCEPTION:1,DBR_SUCCESS:0,DBR_UNKNOWN:-1e4,DBR_NO_MEMORY:-10001,DBR_NULL_REFERENCE:-10002,DBR_LICENSE_INVALID:-10003,DBR_LICENSE_EXPIRED:-10004,DBR_FILE_NOT_FOUND:-10005,DBR_FILETYPE_NOT_SUPPORTED:-10006,DBR_BPP_NOT_SUPPORTED:-10007,DBR_INDEX_INVALID:-10008,DBR_BARCODE_FORMAT_INVALID:-10009,DBR_CUSTOM_REGION_INVALID:-10010,DBR_MAX_BARCODE_NUMBER_INVALID:-10011,DBR_IMAGE_READ_FAILED:-10012,DBR_TIFF_READ_FAILED:-10013,DBR_QR_LICENSE_INVALID:-10016,DBR_1D_LICENSE_INVALID:-10017,DBR_DIB_BUFFER_INVALID:-10018,DBR_PDF417_LICENSE_INVALID:-10019,DBR_DATAMATRIX_LICENSE_INVALID:-10020,DBR_PDF_READ_FAILED:-10021,DBR_PDF_DLL_MISSING:-10022,DBR_PAGE_NUMBER_INVALID:-10023,DBR_CUSTOM_SIZE_INVALID:-10024,DBR_CUSTOM_MODULESIZE_INVALID:-10025,DBR_RECOGNITION_TIMEOUT:-10026,DBR_JSON_PARSE_FAILED:-10030,DBR_JSON_TYPE_INVALID:-10031,DBR_JSON_KEY_INVALID:-10032,DBR_JSON_VALUE_INVALID:-10033,DBR_JSON_NAME_KEY_MISSING:-10034,DBR_JSON_NAME_VALUE_DUPLICATED:-10035,DBR_TEMPLATE_NAME_INVALID:-10036,DBR_JSON_NAME_REFERENCE_INVALID:-10037,DBR_PARAMETER_VALUE_INVALID:-10038,DBR_DOMAIN_NOT_MATCHED:-10039,DBR_RESERVEDINFO_NOT_MATCHED:-10040,DBR_AZTEC_LICENSE_INVALID:-10041,DBR_LICENSE_DLL_MISSING:-10042,DBR_LICENSEKEY_NOT_MATCHED:-10043,DBR_REQUESTED_FAILED:-10044,DBR_LICENSE_INIT_FAILED:-10045,DBR_PATCHCODE_LICENSE_INVALID:-10046,DBR_POSTALCODE_LICENSE_INVALID:-10047,DBR_DPM_LICENSE_INVALID:-10048,DBR_FRAME_DECODING_THREAD_EXISTS:-10049,DBR_STOP_DECODING_THREAD_FAILED:-10050,DBR_SET_MODE_ARGUMENT_ERROR:-10051,DBR_LICENSE_CONTENT_INVALID:-10052,DBR_LICENSE_KEY_INVALID:-10053,DBR_LICENSE_DEVICE_RUNS_OUT:-10054,DBR_GET_MODE_ARGUMENT_ERROR:-10055,DBR_IRT_LICENSE_INVALID:-10056,DBR_MAXICODE_LICENSE_INVALID:-10057,DBR_GS1_DATABAR_LICENSE_INVALID:-10058,DBR_GS1_COMPOSITE_LICENSE_INVALID:-10059,DBR_DOTCODE_LICENSE_INVALID:-10061,DMERR_FAILED_TO_REACH_LTS:-20200},Dynamsoft.DBR.EnumGrayscaleTransformationMode={GTM_INVERTED:1,GTM_ORIGINAL:2,GTM_SKIP:0},Dynamsoft.DBR.EnumImagePixelFormat={IPF_Binary:0,IPF_BinaryInverted:1,IPF_GrayScaled:2,IPF_NV21:3,IPF_RGB_565:4,IPF_RGB_555:5,IPF_RGB_888:6,IPF_ARGB_8888:7,IPF_RGB_161616:8,IPF_ARGB_16161616:9,IPF_ABGR_8888:10,IPF_ABGR_16161616:11,IPF_BGR_888:12},Dynamsoft.DBR.EnumImagePreprocessingMode={IPM_AUTO:1,IPM_GENERAL:2,IPM_GRAY_EQUALIZE:4,IPM_GRAY_SMOOTH:8,IPM_SHARPEN_SMOOTH:16,IPM_MORPHOLOGY:32,IPM_SKIP:0},Dynamsoft.DBR.EnumIMResultDataType={IMRDT_IMAGE:1,IMRDT_CONTOUR:2,IMRDT_LINESEGMENT:4,IMRDT_LOCALIZATIONRESULT:8,IMRDT_REGIONOFINTEREST:16,IMRDT_QUADRILATERAL:32},Dynamsoft.DBR.EnumIntermediateResultSavingMode={IRSM_MEMORY:1,IRSM_FILESYSTEM:2,IRSM_BOTH:4},Dynamsoft.DBR.EnumIntermediateResultType={IRT_NO_RESULT:0,IRT_ORIGINAL_IMAGE:1,IRT_COLOUR_CLUSTERED_IMAGE:2,IRT_COLOUR_CONVERTED_GRAYSCALE_IMAGE:4,IRT_TRANSFORMED_GRAYSCALE_IMAGE:8,IRT_PREDETECTED_REGION:16,IRT_PREPROCESSED_IMAGE:32,IRT_BINARIZED_IMAGE:64,IRT_TEXT_ZONE:128,IRT_CONTOUR:256,IRT_LINE_SEGMENT:512,IRT_FORM:1024,IRT_SEGMENTATION_BLOCK:2048,IRT_TYPED_BARCODE_ZONE:4096,IRT_PREDETECTED_QUADRILATERAL:8192},Dynamsoft.DBR.EnumLocalizationMode={LM_SKIP:0,LM_AUTO:1,LM_CONNECTED_BLOCKS:2,LM_LINES:8,LM_STATISTICS:4,LM_SCAN_DIRECTLY:16,LM_STATISTICS_MARKS:32,LM_STATISTICS_POSTAL_CODE:64},Dynamsoft.DBR.EnumPDFReadingMode={PDFRM_RASTER:1,PDFRM_AUTO:2,PDFRM_VECTOR:4},Dynamsoft.DBR.EnumQRCodeErrorCorrectionLevel={QRECL_ERROR_CORRECTION_H:0,QRECL_ERROR_CORRECTION_L:1,QRECL_ERROR_CORRECTION_M:2,QRECL_ERROR_CORRECTION_Q:3},Dynamsoft.DBR.EnumRegionPredetectionMode={RPM_AUTO:1,RPM_GENERAL:2,RPM_GENERAL_RGB_CONTRAST:4,RPM_GENERAL_GRAY_CONTRAST:8,RPM_GENERAL_HSV_CONTRAST:16,RPM_SKIP:0},Dynamsoft.DBR.EnumResultCoordinateType={RCT_PIXEL:1,RCT_PERCENTAGE:2},Dynamsoft.DBR.EnumResultType={RT_STANDARD_TEXT:0,RT_RAW_TEXT:1,RT_CANDIDATE_TEXT:2,RT_PARTIAL_TEXT:3},Dynamsoft.DBR.EnumScaleUpMode={SUM_AUTO:1,SUM_LINEAR_INTERPOLATION:2,SUM_NEAREST_NEIGHBOUR_INTERPOLATION:4,SUM_SKIP:0},Dynamsoft.DBR.EnumTerminatePhase={TP_REGION_PREDETECTED:1,TP_IMAGE_PREPROCESSED:2,TP_IMAGE_BINARIZED:4,TP_BARCODE_LOCALIZED:8,TP_BARCODE_TYPE_DETERMINED:16,TP_BARCODE_RECOGNIZED:32},Dynamsoft.DBR.EnumTextAssistedCorrectionMode={TACM_AUTO:1,TACM_VERIFYING:2,TACM_VERIFYING_PATCHING:4,TACM_SKIP:0},Dynamsoft.DBR.EnumTextFilterMode={TFM_AUTO:1,TFM_GENERAL_CONTOUR:2,TFM_SKIP:0},Dynamsoft.DBR.EnumTextResultOrderMode={TROM_CONFIDENCE:1,TROM_POSITION:2,TROM_FORMAT:4,TROM_SKIP:0},Dynamsoft.DBR.EnumTextureDetectionMode={TDM_AUTO:1,TDM_GENERAL_WIDTH_CONCENTRATION:2,TDM_SKIP:0}}(),Dynamsoft.AddonReady(function(u,e){var t,T=Dynamsoft.BarcodeReaderAddon;function M(e){return e&&e instanceof ArrayBuffer}T.Class=function(){function e(e){this._runtimeSettings=null,this._initSettingsContent=null,this._tplContentArr=[],this._stwain=e}var E;e.prototype._decodeBlob=function(t,e){var n=this;return new u.Promise(function(e){if(!(t instanceof Blob))throw TypeError("'_decodeBlob(blob, templateName)': Type of 'blob' should be 'Blob'.");e()}).then(function(){return n._innerDecode(0,t,e)})},e.prototype._decodeArrayBuffer=function(t,e){var n=this;return new u.Promise(function(e){if(!(t instanceof ArrayBuffer))throw TypeError("'_decodeBlob(arrayBuffer, templateName)': Type of 'arrayBuffer' should be 'ArrayBuffer'.");e()}).then(function(){return n._innerDecode(0,t,e)})},e.prototype._decodeUint8Array=function(t,e){var n=this;return new u.Promise(function(e){if(!(t instanceof Uint8Array||self.Uint8ClampedArray&&t instanceof Uint8ClampedArray))throw TypeError("'_decodeBlob(uint8Array, templateName)': Type of 'uint8Array' should be 'Uint8Array'.");e()}).then(function(){return n._innerDecode(0,t,e)})},e.prototype._decodeImage=function(t,n){var o=this;return new u.Promise(function(e){if(!(t instanceof HTMLImageElement))throw TypeError("'_decodeImage(image, templateName)': Type of 'image' should be 'HTMLImageElement'.");if(t.crossOrigin&&"anonymous"!=t.crossOrigin)throw"cors";n=n||"",e()}).then(function(){return"data:image/"==t.src.substring(0,11)?o._decodeBase64(t.src,n):o._decodeUrl(t.src,n).catch(function(e){return 3<=T.logLevel&&console&&console.warn&&(console.warn("'_decodeImage(image, templateName)': Image src not available. Use '_decodeCanvas' instead."),console.warn(e)),self.HTMLCanvasElement?((e=document.createElement("canvas")).width=t.naturalWidth,e.height=t.naturalHeight,e.getContext("2d").drawImage(t,0,0),o._decodeCanvas(e,n)):u.Promise.reject(Error("'_decodeImage(image, templateName)': Browser not support HTMLCanvasElement."))})})},e.prototype._decodeCanvas=function(n,o){var t=this;return new u.Promise(function(t){if(!(n instanceof HTMLCanvasElement))throw TypeError("'_decodeCanvas(canvas, templateName)': Type of 'canvas' should be 'HTMLCanvasElement'.");if(n.crossOrigin&&"anonymous"!=n.crossOrigin)throw"cors";o=o||"",n.toBlob?n.toBlob(function(e){t(e)}):n.msToBlob?n.msToBlob(function(e){t(e)}):t(n.toDataURL())}).then(function(e){return n.toBlob||n.msToBlob?t._decodeBlob(e,o):t._decodeBase64(e,o)})},e.prototype._decodeVideo=function(d){var s,t=this,c=arguments;return new u.Promise(function(e){if(!(d instanceof HTMLVideoElement))throw TypeError("'_decodeVideo(video [ [, sx, sy, sWidth, sHeight], dWidth, dHeight] [, templateName] )': Type of 'video' should be 'HTMLVideoElement'.");if(d.crossOrigin&&"anonymous"!=d.crossOrigin)throw"cors";c.length<=2?(t=n=0,o=i=d.videoWidth,r=a=d.videoHeight):a=c.length<=4?(t=n=0,o=d.videoWidth,r=d.videoHeight,i=c[1],c[2]):(t=c[1],n=c[2],o=c[3],r=c[4],i=c[5],c[6]),s="string"==typeof c[c.length-1]?c[c.length-1]:"";var t,n,o,r,i,a,_=document.createElement("canvas");_.width=i,_.height=a,_.getContext("2d").drawImage(d,t,n,o,r,0,0,i,a),e(_)}).then(function(e){return t._decodeCanvas(e,s)})},e.prototype._decodeBase64=e.prototype.decodeBase64String=function(t,e){var n=this;return new u.Promise(function(e){if(!("string"==typeof t||"object"==typeof t&&t instanceof String))throw TypeError("'decodeBase64(base64Str, templateName)': Type of 'base64Str' should be 'String'.");"data:image/"==t.substring(0,11)&&(t=t.substring(t.indexOf(",")+1)),e()}).then(function(){return n._innerDecode(1,t,e)})},e.prototype._decodeUrl=function(o,r){var t=this;return o&&o.indexOf&&(0==o.indexOf("dwt://")||0==o.indexOf("dcs://"))?t._decodeDynamsoftServiceInnerUrl(o,r):new u.Promise(function(e,t){var n;if(!("string"==typeof o||"object"==typeof o&&o instanceof String))throw TypeError("'_decodeUrl(url, templateName)': Type of 'url' should be 'String'.");r=r||"",T._activeXInstance?((n=new ActiveXObject("MSXML2.XMLHTTP")).open("GET",o,!0),n.overrideMimeType?n.overrideMimeType("text/plain; charset=x-user-defined"):n.setRequestHeader("Accept-Charset","x-user-defined"),n.onreadystatechange=function(){4==n.readyState&&e(new VBArray(n.responseBody).toArray())},n.send("")):((n=new XMLHttpRequest).open("GET",o,!0),n.responseType="arraybuffer",n.send(),n.onloadend=function(){e(this.response)},n.onerror=function(){t(Error(n.error))})}).then(function(e){return T._activeXInstance?t._activeXDecodeArray(e,r):t._decodeArrayBuffer(e,r)})},e.prototype._decodeDynamsoftServiceInnerUrl=function(t,e){var n=this;return new u.Promise(function(e){if(!("string"==typeof t||"object"==typeof t&&t instanceof String))throw TypeError("'_decodeUrl(url, templateName)': Type of 'innerUrl' should be 'String'.");if(0!=t.indexOf("dwt://")&&0!=t.indexOf("dcs://"))throw TypeError("'_decodeDynamsoftServiceInnerUrl(innerUrl, templateName)': 'innerUrl' should start with 'dwt://' or 'dcs://'.");e()}).then(function(){return n._innerDecode(4e3,t,e)})},e.prototype._activeXDecodeArray=function(n,o){var t=this;return new u.Promise(function(e,t){if(!(n instanceof Array))throw TypeError("'_activeXDecodeArray(array, templateName)': Type of 'array' should be 'Array'.");o=o||"";try{e(Dynamsoft.Lib.btoa(String.fromCharCode.apply(String,n)))}catch(e){t(e)}}).then(function(e){return t._decodeBase64(e,o)})},e.prototype._activeXDecodeHandle=function(e,t){var n=this;return new u.Promise(function(e){t=t||"",e()}).then(function(){return n._innerDecode(4001,e,t)})},e.prototype._decode=e.prototype.decode=function(e,t){return T._activeXInstance?"string"==typeof e||e instanceof String?this._activeXDecodeHandle(e,t):u.Promise.reject(TypeError("'_decode(source, templateName)' in activeX: Type of 'source' should be 'String(partUrl)'.")):self.Blob&&e instanceof Blob?this._decodeBlob(e,t):self.ArrayBuffer&&e instanceof ArrayBuffer?this._decodeArrayBuffer(e,t):self.Uint8Array&&e instanceof Uint8Array||self.Uint8ClampedArray&&e instanceof Uint8ClampedArray?this._decodeUint8Array(e,t):e instanceof Array?this._activeXDecodeArray(e,t):self.HTMLImageElement&&e instanceof HTMLImageElement?this._decodeImage(e,t):self.HTMLCanvasElement&&e instanceof HTMLCanvasElement?this._decodeCanvas(e,t):self.HTMLVideoElement&&e instanceof HTMLVideoElement?this._decodeVideo(e,t):isNaN(e)?"string"==typeof e||e instanceof String?"data:image/"==e.substring(0,11)?this._decodeBase64(e,t):this._decodeUrl(e,t):u.Promise.reject(TypeError("'_decode(source, templateName)' in H5: Type of 'source' should be 'Blob', 'ArrayBuffer', 'Uint8Array', 'HTMLImageElement', 'HTMLCanvasElement', 'HTMLVideoElement', 'String(base64 with image mime)' or 'String(url)'.")):this._activeXDecodeHandle(e,t)},e.prototype._innerServiceCmd=function(r,i){var a=this._stwain;return new u.Promise(function(t,n){var e,o={method:"ReadBarcode",parameter:[Dynamsoft.Lib.product.refProductKey,4002,"",""],updateSettings:r,initSettingsContent:i};T._activeXInstance?t(T._activeXInstance.Process(u.stringify(o),location.protocol+"//"+location.host)):(a._blts?(e="",a&&a._bRemoteMode&&a._dmService&&a._dmService.attrs&&a._dmService.attrs.UUID&&(e=a._dmService.attrs.UUID),Dynamsoft.DWT.lglic(Dynamsoft.DWT.EnumInstance.dwt_desktop,e).then(function(e){return o.parameter.push(e.ar),o.parameter.push(e.cu),o.parameter.push(0),o.parameter.push(""),u.stringify(o)})):u.Promise.resolve(u.stringify(o))).then(function(e){return u.fetch(a._dbrUrlRoot+"ReadBarcode",{mode:"cors",method:"post",body:e,dataType:"arrayBuffer"})}).then(function(e){M(e)?t(String.fromCharCode.apply(null,new Uint8Array(e))):t(e)},function(e){var t="Init template & runtimeSettings failed.";e&&(t=[t," Http info: ",e.errorString," (",e.httpCode,")"].join("")),n(t)})})},e.prototype._innerDecode=function(i,a,_,d){var R=this;return R._runtimeSettings&&0==R._runtimeSettings.expectedBarcodesCount&&(R._runtimeSettings.expectedBarcodesCount=512),new u.Promise(function(s,c){function o(e,t,n){try{var o,r,i,a,_=E&&E(e);for(_&&_.textResults||c(new T.BarcodeReaderException(_.exception,_.description)),u.product.bHTML5Edition&&n&&n.config.data&&(o=u.parse(n.config.data),u.isArray(o.parameter))&&2<o.parameter.length&&4e3==o.parameter[1]&&(4<o.parameter.length&&o.parameter[4]?_.textResults.imageid=o.parameter[4]:0<=(a=(i=o.parameter[2]).indexOf("&index="))&&(_.textResults.imageid=i.substring(a+7,i.indexOf("&t=")))),r=0;r<_.textResults.length;r++){var d=_.textResults[r];d.BarcodeText=d.barcodeText,_.exception!=Dynamsoft.DBR.EnumErrorCode.DBR_SUCCESS&&(d.exception=_.exception)}_.exception!=Dynamsoft.DBR.EnumErrorCode.DBR_SUCCESS&&(_.textResults.exception=_.exception,_.textResults.description=_.description),T._activeXInstance&&_.records&&(Dynamsoft.Lib.each(_.records,function(e,t){Dynamsoft.DWT.lavrf(t,e,Dynamsoft.DWT.EnumInstance.dwt_desktop)}),Dynamsoft.DWT.lavrf_(1,Dynamsoft.DWT.EnumInstance.dwt_desktop)),s(_.textResults)}catch(e){c(e)}}var t,e,n={method:"ReadBarcode",parameter:[Dynamsoft.Lib.product.refProductKey,i,0!=i?a:null,_||""],updateSettings:R._runtimeSettings,conflictMode:1==R.conflictMode?"ignore":"overwrite",initSettingsContent:R._initSettingsContent,tplContent:function(){if(_)for(var e=0;e<R._tplContentArr.length;++e)if(_==R._tplContentArr[e].ImageParameter.Name)return u.stringify(R._tplContentArr[e]);return null}()},r=R._stwain;T._activeXInstance?r._blts?Dynamsoft.DWT.lglic(Dynamsoft.DWT.EnumInstance.dwt_desktop,"").then(function(e){n.parameter.push(e.ar),n.parameter.push(e.cu),n.parameter.push(0),n.parameter.push(""),o(T._activeXInstance.Process(u.stringify(n),location.protocol+"//"+location.host))}):o(T._activeXInstance.Process(u.stringify(n),location.protocol+"//"+location.host)):(t=r._dbrUrlRoot+"ReadBarcode",0==i&&(t+="/LoadZipFromBytes?cmd="+encodeURIComponent(u.stringify(n))),(0==i?u.Promise.resolve(a):r._blts?(e="",r&&r._bRemoteMode&&r._dmService&&r._dmService.attrs&&r._dmService.attrs.UUID&&(e=r._dmService.attrs.UUID),Dynamsoft.DWT.lglic(Dynamsoft.DWT.EnumInstance.dwt_desktop,e).then(function(e){return n.parameter.push(e.ar),n.parameter.push(e.cu),n.parameter.push(0),n.parameter.push([u.product.getDWTPrefix(),u.product.getServerVersionInfo(),"/verify?id=",d,"&t=",u.getRandom()].join("")),u.stringify(n)})):u.Promise.resolve(u.stringify(n))).then(function(e){return u.fetch(t,{mode:"cors",method:"post",body:e,dataType:"arrayBuffer"})}).then(function(e,t,n){M(e)?o(String.fromCharCode.apply(null,new Uint8Array(e)),0,n):o(e,0,n)},function(e){var t="ReadBarcode request fail.";e&&(t=[t," Http info: ",e.errorString," (",e.httpCode,")"].join("")),c(Error(t))}))})},E=T._handleRetJsonString=function(t){var n;if("string"==typeof t||"object"==typeof t&&t instanceof String)try{n=u.parse(t)}catch(e){n=u.parse(T.RemoveNonPrintableChar(t))}else n=t;if(!n)throw T.BarcodeReaderException(Dynamsoft.DBR.EnumErrorCode.DBR_UNKNOWN,T.errors.decodeResultEmpty);if("textResults"in n&&u.isArray(n.textResults)||n.exception==Dynamsoft.DBR.EnumErrorCode.DBR_SUCCESS)return n;throw T.BarcodeReaderException(n.exception,n.description)},e.prototype.getAllParameterTemplateNames=function(){for(var e=[],t=0;t<this._tplContentArr.length;++t)e.push(this._tplContentArr[t].ImageParameter.Name);return e},e.prototype.getRuntimeSettings=function(){return this._runtimeSettings||(this._runtimeSettings=u.parse(T._defaultRuntimeSettingsStr)),u.Promise.resolve(this._runtimeSettings)};return e.prototype.updateRuntimeSettings=function(e){var t,n=this;if("string"==typeof e||"object"==typeof e&&e instanceof String){if("speed"==e||"balance"==e||"coverage"==e||"default"==e)return n.initRuntimeSettingsWithString("speed"==e?'{"ImageParameter":{"AccompanyingTextRecognitionModes":[{"Mode":"ATRM_SKIP"}],"BarcodeColourModes":[{"LightReflection":1,"Mode":"BICM_DARK_ON_LIGHT"}],"BarcodeComplementModes":[{"Mode":"BCM_SKIP"}],"BarcodeFormatIds":["BF_ALL"],"BarcodeFormatIds_2":["BF2_POSTALCODE","BF2_DOTCODE"],"BinarizationModes":[{"BlockSizeX":0,"BlockSizeY":0,"EnableFillBinaryVacancy":1,"ImagePreprocessingModesIndex":-1,"Mode":"BM_LOCAL_BLOCK","ThreshValueCoefficient":10}],"ColourClusteringModes":[{"Mode":"CCM_SKIP"}],"ColourConversionModes":[{"BlueChannelWeight":-1,"GreenChannelWeight":-1,"Mode":"CICM_GENERAL","RedChannelWeight":-1}],"DPMCodeReadingModes":[{"Mode":"DPMCRM_SKIP"}],"DeblurLevel":3,"DeformationResistingModes":[{"Mode":"DRM_SKIP"}],"Description":"","ExpectedBarcodesCount":512,"FormatSpecificationNameArray":null,"GrayscaleTransformationModes":[{"Mode":"GTM_ORIGINAL"}],"ImagePreprocessingModes":[{"Mode":"IPM_GENERAL"}],"IntermediateResultSavingMode":{"Mode":"IRSM_MEMORY"},"IntermediateResultTypes":["IRT_NO_RESULT"],"LocalizationModes":[{"Mode":"LM_CONNECTED_BLOCKS"},{"Mode":"LM_STATISTICS_MARKS"},{"Mode":"LM_STATISTICS_POSTAL_CODE"}],"MaxAlgorithmThreadCount":4,"Name":"bestSpeed","PDFRasterDPI":300,"PDFReadingMode":{"Mode":"PDFRM_AUTO"},"Pages":"","RegionDefinitionNameArray":null,"RegionPredetectionModes":[{"Mode":"RPM_GENERAL"}],"ResultCoordinateType":"RCT_PIXEL","ReturnBarcodeZoneClarity":0,"ScaleDownThreshold":2300,"ScaleUpModes":[{"Mode":"SUM_AUTO"}],"TerminatePhase":"TP_BARCODE_RECOGNIZED","TextAssistedCorrectionMode":{"BottomTextPercentageSize":0,"LeftTextPercentageSize":0,"Mode":"TACM_VERIFYING","RightTextPercentageSize":0,"TopTextPercentageSize":0},"TextFilterModes":[{"Mode":"TFM_SKIP"}],"TextResultOrderModes":[{"Mode":"TROM_CONFIDENCE"},{"Mode":"TROM_POSITION"},{"Mode":"TROM_FORMAT"}],"TextureDetectionModes":[{"Mode":"TDM_GENERAL_WIDTH_CONCENTRATION","Sensitivity":5}],"Timeout":10000},"Version":"3.0"}':"balance"==e?'{"ImageParameter":{"AccompanyingTextRecognitionModes":[{"Mode":"ATRM_SKIP"}],"BarcodeColourModes":[{"LightReflection":1,"Mode":"BICM_DARK_ON_LIGHT"}],"BarcodeComplementModes":[{"Mode":"BCM_SKIP"}],"BarcodeFormatIds":["BF_ALL"],"BarcodeFormatIds_2":["BF2_POSTALCODE","BF2_DOTCODE"],"BinarizationModes":[{"BlockSizeX":0,"BlockSizeY":0,"EnableFillBinaryVacancy":1,"ImagePreprocessingModesIndex":-1,"Mode":"BM_LOCAL_BLOCK","ThreshValueCoefficient":10}],"ColourClusteringModes":[{"Mode":"CCM_SKIP"}],"ColourConversionModes":[{"BlueChannelWeight":-1,"GreenChannelWeight":-1,"Mode":"CICM_GENERAL","RedChannelWeight":-1}],"DPMCodeReadingModes":[{"Mode":"DPMCRM_SKIP"}],"DeblurLevel":5,"DeformationResistingModes":[{"Mode":"DRM_SKIP"}],"Description":"","ExpectedBarcodesCount":512,"FormatSpecificationNameArray":null,"GrayscaleTransformationModes":[{"Mode":"GTM_ORIGINAL"}],"ImagePreprocessingModes":[{"Mode":"IPM_GENERAL"}],"IntermediateResultSavingMode":{"Mode":"IRSM_MEMORY"},"IntermediateResultTypes":["IRT_NO_RESULT"],"LocalizationModes":[{"Mode":"LM_CONNECTED_BLOCKS"},{"Mode":"LM_STATISTICS"},{"Mode":"LM_STATISTICS_MARKS"},{"Mode":"LM_STATISTICS_POSTAL_CODE"}],"MaxAlgorithmThreadCount":4,"Name":"balance","PDFRasterDPI":300,"PDFReadingMode":{"Mode":"PDFRM_AUTO"},"Pages":"","RegionDefinitionNameArray":null,"RegionPredetectionModes":[{"Mode":"RPM_GENERAL"}],"ResultCoordinateType":"RCT_PIXEL","ReturnBarcodeZoneClarity":0,"ScaleDownThreshold":2300,"ScaleUpModes":[{"Mode":"SUM_AUTO"}],"TerminatePhase":"TP_BARCODE_RECOGNIZED","TextAssistedCorrectionMode":{"BottomTextPercentageSize":0,"LeftTextPercentageSize":0,"Mode":"TACM_VERIFYING","RightTextPercentageSize":0,"TopTextPercentageSize":0},"TextFilterModes":[{"MinImageDimension":65536,"Mode":"TFM_GENERAL_CONTOUR","Sensitivity":0}],"TextResultOrderModes":[{"Mode":"TROM_CONFIDENCE"},{"Mode":"TROM_POSITION"},{"Mode":"TROM_FORMAT"}],"TextureDetectionModes":[{"Mode":"TDM_GENERAL_WIDTH_CONCENTRATION","Sensitivity":5}],"Timeout":10000},"Version":"3.0"}':"coverage"==e?'{"ImageParameter":{"AccompanyingTextRecognitionModes":[{"Mode":"ATRM_SKIP"}],"BarcodeColourModes":[{"LightReflection":1,"Mode":"BICM_DARK_ON_LIGHT"}],"BarcodeComplementModes":[{"Mode":"BCM_SKIP"}],"BarcodeFormatIds":["BF_ALL"],"BarcodeFormatIds_2":["BF2_POSTALCODE","BF2_DOTCODE"],"BinarizationModes":[{"BlockSizeX":0,"BlockSizeY":0,"EnableFillBinaryVacancy":1,"ImagePreprocessingModesIndex":-1,"Mode":"BM_LOCAL_BLOCK","ThreshValueCoefficient":10}],"ColourClusteringModes":[{"Mode":"CCM_SKIP"}],"ColourConversionModes":[{"BlueChannelWeight":-1,"GreenChannelWeight":-1,"Mode":"CICM_GENERAL","RedChannelWeight":-1}],"DPMCodeReadingModes":[{"Mode":"DPMCRM_SKIP"}],"DeblurLevel":9,"DeformationResistingModes":[{"Mode":"DRM_SKIP"}],"Description":"","ExpectedBarcodesCount":512,"FormatSpecificationNameArray":null,"GrayscaleTransformationModes":[{"Mode":"GTM_ORIGINAL"},{"Mode":"GTM_INVERTED"}],"ImagePreprocessingModes":[{"Mode":"IPM_GENERAL"}],"IntermediateResultSavingMode":{"Mode":"IRSM_MEMORY"},"IntermediateResultTypes":["IRT_NO_RESULT"],"LocalizationModes":[{"Mode":"LM_CONNECTED_BLOCKS"},{"Mode":"LM_SCAN_DIRECTLY","ScanDirection":0,"ScanStride":0},{"Mode":"LM_STATISTICS"},{"Mode":"LM_LINES"},{"Mode":"LM_STATISTICS_MARKS"},{"Mode":"LM_STATISTICS_POSTAL_CODE"}],"MaxAlgorithmThreadCount":4,"Name":"coverage","PDFRasterDPI":300,"PDFReadingMode":{"Mode":"PDFRM_AUTO"},"Pages":"","RegionDefinitionNameArray":null,"RegionPredetectionModes":[{"Mode":"RPM_GENERAL"}],"ResultCoordinateType":"RCT_PIXEL","ReturnBarcodeZoneClarity":0,"ScaleDownThreshold":214748347,"ScaleUpModes":[{"Mode":"SUM_AUTO"}],"TerminatePhase":"TP_BARCODE_RECOGNIZED","TextAssistedCorrectionMode":{"BottomTextPercentageSize":0,"LeftTextPercentageSize":0,"Mode":"TACM_VERIFYING","RightTextPercentageSize":0,"TopTextPercentageSize":0},"TextFilterModes":[{"MinImageDimension":65536,"Mode":"TFM_GENERAL_CONTOUR","Sensitivity":0}],"TextResultOrderModes":[{"Mode":"TROM_CONFIDENCE"},{"Mode":"TROM_POSITION"},{"Mode":"TROM_FORMAT"}],"TextureDetectionModes":[{"Mode":"TDM_GENERAL_WIDTH_CONCENTRATION","Sensitivity":5}],"Timeout":10000},"Version":"3.0"}':'{"ImageParameter":{"AccompanyingTextRecognitionModes":[{"Mode":"ATRM_SKIP"}],"BarcodeColourModes":[{"LightReflection":1,"Mode":"BICM_DARK_ON_LIGHT"}],"BarcodeComplementModes":[{"Mode":"BCM_SKIP"}],"BarcodeFormatIds":["BF_ALL"],"BarcodeFormatIds_2":null,"BinarizationModes":[{"BlockSizeX":0,"BlockSizeY":0,"EnableFillBinaryVacancy":1,"ImagePreprocessingModesIndex":-1,"Mode":"BM_LOCAL_BLOCK","ThreshValueCoefficient":10}],"ColourClusteringModes":[{"Mode":"CCM_SKIP"}],"ColourConversionModes":[{"BlueChannelWeight":-1,"GreenChannelWeight":-1,"Mode":"CICM_GENERAL","RedChannelWeight":-1}],"DPMCodeReadingModes":[{"Mode":"DPMCRM_SKIP"}],"DeblurLevel":9,"DeformationResistingModes":[{"Mode":"DRM_SKIP"}],"Description":"","ExpectedBarcodesCount":512,"FormatSpecificationNameArray":null,"GrayscaleTransformationModes":[{"Mode":"GTM_ORIGINAL"}],"ImagePreprocessingModes":[{"Mode":"IPM_GENERAL"}],"IntermediateResultSavingMode":{"Mode":"IRSM_MEMORY"},"IntermediateResultTypes":["IRT_NO_RESULT"],"LocalizationModes":[{"Mode":"LM_CONNECTED_BLOCKS"},{"Mode":"LM_SCAN_DIRECTLY","ScanDirection":0,"ScanStride":0},{"Mode":"LM_STATISTICS"},{"Mode":"LM_LINES"}],"MaxAlgorithmThreadCount":4,"Name":"default","PDFRasterDPI":300,"PDFReadingMode":{"Mode":"PDFRM_AUTO"},"Pages":"","RegionDefinitionNameArray":null,"RegionPredetectionModes":[{"Mode":"RPM_GENERAL"}],"ResultCoordinateType":"RCT_PIXEL","ReturnBarcodeZoneClarity":0,"ScaleDownThreshold":2300,"ScaleUpModes":[{"Mode":"SUM_AUTO"}],"TerminatePhase":"TP_BARCODE_RECOGNIZED","TextAssistedCorrectionMode":{"BottomTextPercentageSize":0,"LeftTextPercentageSize":0,"Mode":"TACM_VERIFYING","RightTextPercentageSize":0,"TopTextPercentageSize":0},"TextFilterModes":[{"MinImageDimension":65536,"Mode":"TFM_GENERAL_CONTOUR","Sensitivity":0}],"TextResultOrderModes":[{"Mode":"TROM_CONFIDENCE"},{"Mode":"TROM_POSITION"},{"Mode":"TROM_FORMAT"}],"TextureDetectionModes":[{"Mode":"TDM_GENERAL_WIDTH_CONCENTRATION","Sensitivity":5}],"Timeout":10000},"Version":"3.0"}');t=e}else{if("object"!=typeof e)throw TypeError("'setTemplateSettings(settings)': Type of 'settings' should be 'String' or 'PlainObject'.");t=u.stringify(e)}e=u.parse(t);return n._runtimeSettings=e,n._initSettingsContent=null,n._innerServiceCmd(n._runtimeSettings,null).then(function(e){e=T._handleRetJsonString(e);return n._runtimeSettings=e.settings,n._runtimeSettings||(n._runtimeSettings=u.parse(T._defaultRuntimeSettingsStr)),e.settings})},e.prototype.resetRuntimeSettings=function(){var t=this;return t._runtimeSettings=u.parse(T._defaultRuntimeSettingsStr),t._initSettingsContent=null,t._innerServiceCmd(t._runtimeSettings,null).then(function(e){e=T._handleRetJsonString(e);return t._runtimeSettings=e.settings,t._runtimeSettings||(t._runtimeSettings=u.parse(T._defaultRuntimeSettingsStr)),e.settings})},e.prototype.outputSettingsToString=function(e){if(!e)return T._defaultTemplateStr;for(var t=0;t<this._tplContentArr.length;++t)if(e==this._tplContentArr[t].ImageParameter.Name)return u.stringify(this._tplContentArr[t])},e.prototype.initRuntimeSettingsWithString=function(e){var t=this;if(u.isString(e))return t._runtimeSettings=null,t._initSettingsContent=u.parse(e),t._innerServiceCmd(null,t._initSettingsContent).then(function(e){e=T._handleRetJsonString(e);return t._runtimeSettings=e.settings,t._runtimeSettings||(t._runtimeSettings=u.parse(T._defaultRuntimeSettingsStr)),e.settings});throw TypeError("'initRuntimeSettingsWithString(settings)': Type of 'settings' should be 'String'.")},e}(),T._dbr_ax=!1,T._dbr=!1,T._initH5=function(r,n,o){return new u.Promise(function(e,t){r._bRemoteMode&&r._dmService&&r._dmService.attrs&&r._dmService.attrs.url&&(r._dbrUrlRoot=r._dmService.attrs.url+"dcp/dbr_"+T.Version.replace(/\./g,"")+"/"),r._dbrUrlRoot||(r._dbrUrlRoot=Dynamsoft.DWT.NetManager.getModuleUrl("dcp/dbr_"+T.Version.replace(/\./g,"")+"/"));var n=5,o={method:"POST",url:r._dbrUrlRoot+"VersionInfo?t="+u.getRandom(),data:'{"method":"VersionInfo"}',onSuccess:function(){e()},onError:function(){if(--n<=0)return t("Failed to connect to the Barcode Reader Add-on, the library may be missing in the Dynamsoft Service directory.");setTimeout(function(){u.ajax(o)},300)},dataType:"json",async:!0,timeout:800};u.ajax(o)}).then(function(){return T._dbr=new T.Class(r),T._dbr._innerServiceCmd(null,null)}).then(function(e){try{var t=T._handleRetJsonString(e);T._dbr._runtimeSettings=t.settings,T._defaultRuntimeSettingsStr=u.stringify(t.settings),T._defaultTemplateStr=u.stringify(t.outputSettings),n(T._dbr)}catch(e){o(Error("Init template & runtimeSettings failed: "+e.message)||e)}},function(e){o(e)})},T.dbrInitPromiseFun=function(n){return new u.Promise(function(e,t){T.innerDbrInit(n,e,t)})},T.innerDbrInit=function(e,t,n){var o=!1,r=!1,i=(u.product.bHTML5Edition?o=!0:r=!0,Dynamsoft.BarcodeReaderAddon);if(o){if(i._dbr)return void t(i._dbr)}else if(r&&i._dbr_ax)return void t(i._dbr_ax);if(o&&i._initH5(e,t,n),r){o=Dynamsoft.navInfoSync,r={method:"ReadBarcode",parameter:[Dynamsoft.Lib.product.refProductKey,4002,"",""]};if(!o.bIE)return n(Error("The DBR init error."));try{i._activeXInstance=new ActiveXObject("DBRModule.AtlDBR");var a,_=i._activeXInstance.Process(u.stringify(r),location.protocol+"//"+location.host),d=u.parse(_);return d?"settings"in d?(i._dbr_ax=new i.Class(e),i._dbr_ax._runtimeSettings=d.settings,i._defaultRuntimeSettingsStr=u.stringify(d.settings),"outputSettings"in d&&(i._defaultTemplateStr=u.stringify(d.outputSettings)),void t(i._dbr_ax)):(a=d.description||"The DBR init error.",n(Error(a))):n(Error("The DBR init error."))}catch(e){return n(Error("The DBR .dll is missing or not accessible: "+(e.message||e)))}}},u.DynamicLoadAddonFuns&&u.DynamicLoadAddonFuns.push(function(a){if(t=a._b64bit?"dbrx64_"+Dynamsoft.BarcodeReaderAddon.Version+".dll":"dbr_"+Dynamsoft.BarcodeReaderAddon.Version+".dll",u.product.bHTML5Edition&&!a._isMobileMode())try{a._innerSend("GetAddOnVersion",u.html5.Funs.makeParams("barcodereader",t),!0,!1,!1).catch(function(){})}catch(e){}function n(e){return!(u.License.checkProductKey(e,{Core:!0})&&(Dynamsoft.navInfoSync.bMac||Dynamsoft.navInfoSync.bLinux||Dynamsoft.Lib.env.bMobile?(e._errorCode=Dynamsoft.DBR.EnumErrorCode.DBR_UNKNOWN,e._errorString=T.errors.ServiceEditionNotSupportDbr,0):!e._isMobileMode()||(e._errorCode=Dynamsoft.DBR.EnumErrorCode.DBR_UNKNOWN,e._errorString=T.errors.ServiceEditionNotSupportWasmMode,0)))}var e={BarcodeReader:{decode:function(t){return n(a)?u.Promise.reject(T.BarcodeReaderException(a._errorCode,a._errorString)):!u.isNumber(t)||t<0||t>=a.HowManyImagesInBuffer?(u.Errors.IndexOutOfRange(a),u.Promise.reject(T.BarcodeReaderException(a._errorCode,a._errorString))):new u.Promise(function(e){T._decoding?T._decodeQueue.push({method:e,args:[t]}):(T._decoding=!0,e(t))}).then(function(e){var i;if(u.product.bHTML5Edition){if(-1==(i=a._ImgManager.convertClientIndexToServerId(e)))throw u.Errors.IndexOutOfRange(a),setTimeout(T._decodeNext,0),T.BarcodeReaderException(a._errorCode,a._errorString)}else i=e;return new u.Promise(function(o,r){T.dbrInitPromiseFun(a).then(function(e){var t;if(!u.product.bHTML5Edition)return t=i,n=a.GetImagePartURL(t,-1,-1),e._innerDecode(4001,n,"").then(function(e){e.imageid=a.IndexToImageID(t),setTimeout(T._decodeNext,0),o(e)},function(e){setTimeout(T._decodeNext,0),r(e)});t=a._ImgManager.convertServerIdToClientIndex(i);var n=a.GetImagePartURL(t,-1,-1);return e._innerDecode(4e3,n,"",a._clientId).then(function(e){e.imageid=a.IndexToImageID(t),setTimeout(T._decodeNext,0),o(e),a._blts&&Dynamsoft.DWT.lcvrf(a)},function(e){setTimeout(T._decodeNext,0),r(e)})},function(e){setTimeout(T._decodeNext,0),r(e)})})})},resetRuntimeSettings:function(){return n(a)?u.Promise.reject(T.BarcodeReaderException(a._errorCode,a._errorString)):T.dbrInitPromiseFun(a).then(function(e){return e.resetRuntimeSettings()})},getRuntimeSettings:function(e){return n(a)?u.Promise.reject(T.BarcodeReaderException(a._errorCode,a._errorString)):!u.isString(e)||"speed"!=e&&"balance"!=e&&"coverage"!=e&&"default"!=e?T.dbrInitPromiseFun(a).then(function(e){return e.getRuntimeSettings()}):this.updateRuntimeSettings(e)},updateRuntimeSettings:function(t){return n(a)?u.Promise.reject(T.BarcodeReaderException(a._errorCode,a._errorString)):T.dbrInitPromiseFun(a).then(function(e){return e.updateRuntimeSettings(t)})},initRuntimeSettingsWithString:function(t){return n(a)?u.Promise.reject(T.BarcodeReaderException(a._errorCode,a._errorString)):T.dbrInitPromiseFun(a).then(function(e){return e.initRuntimeSettingsWithString(t)})}}};u.product.bHTML5Edition?(a.__addon=a.__addon||{},u.mix(a.__addon,e)):(a.Addon=a.Addon||{},u.mix(a.Addon,e))})}); 
/*! 20230105181553
* Dynamsoft JavaScript Library
* Product: Dynamsoft Web Twain
* Web Site: https://www.dynamsoft.com
*
* Copyright 2023, Dynamsoft Corporation
* Author: Dynamsoft Support Team
*
* Module: PDF
* Version: 18.1
* 
*/
var Dynamsoft=self.Dynamsoft||{};Dynamsoft.DWT=Dynamsoft.DWT||{},Dynamsoft.aryAddonReadyFun=Dynamsoft.aryAddonReadyFun||[],Dynamsoft.AddonReady=Dynamsoft.AddonReady||function(e){Dynamsoft.aryAddonReadyFun.push(e)},function(){for(var e=[Dynamsoft.DWT],n=0;n<1;n++){var o=e[n];o.EnumDWT_ConvertMode={CM_RENDERALL:1,CM_IMAGEONLY:2,CM_AUTO:3,CM_RENDERALLWITHANNOTATION:4},o.EnumDWT_PDFCompressionType={PDF_AUTO:0,PDF_FAX3:1,PDF_FAX4:2,PDF_LZW:3,PDF_RLE:4,PDF_JPEG:5,PDF_JP2000:6,PDF_JBIG2:7}}}(),Dynamsoft.AddonReady(function(t,e){var n;t.product.bHTML5Edition&&t.DynamicLoadAddonFuns&&t.DynamicLoadAddonFuns.push(function(i){var e,a=t.html5.Funs;if(n=i.__serverPlatform==Dynamsoft.DWT.EnumDWT_PlatformType.enumMac?i._b64bit?"libDynamicPdfCorex64_"+Dynamsoft.DWT.PdfVersion+".dylib":"libDynamicPdfCore_"+Dynamsoft.DWT.PdfVersion+".dylib":i.__serverPlatform==Dynamsoft.DWT.EnumDWT_PlatformType.enumLinux||i.__serverPlatform==Dynamsoft.DWT.EnumDWT_PlatformType.enumEmbed||i.__serverPlatform==Dynamsoft.DWT.EnumDWT_PlatformType.enumChromeOS?"libDynamicPdfCore_"+Dynamsoft.DWT.PdfVersion+".so":i._b64bit?"DynamicPdfCorex64_"+Dynamsoft.DWT.PdfVersion+".dll":"DynamicPdfCore_"+Dynamsoft.DWT.PdfVersion+".dll",!i._isMobileMode())try{i._innerSend("GetAddOnVersion",a.makeParams("pdf",n),!0,!1,!1).catch(function(){})}catch(e){}e={PDF:{IsModuleInstalled:function(){var e=i;return e._resetErr(),e._isMobileMode()?!!Dynamsoft.pdf&&Dynamsoft.pdf.IsModuleInstalled():""!=e._innerFun("GetAddOnVersion",a.makeParams("pdf",n))},IsModuleInstalledAsync:function(){var e=i;return e._resetErr(),e._isMobileMode()?Dynamsoft.pdf?t.Promise.resolve(Dynamsoft.pdf.IsModuleInstalled()):t.Promise.resolve(!1):e._innerFunV2("GetAddOnVersion",a.makeParams("pdf",n)).then(function(e){return""!=e})},ConvertToImage:function(e,n,o,r){var e=a.replaceLocalFilename(e),t="ConvertPDFToImage",s=i;return s._resetErr(),s._isMobileMode()||(a.showMask(t),s._innerSend(t,a.makeParams(e,n),!0,function(e){return a.hideMask(t),o&&o(),!0},function(e){return a.hideMask(t),r&&r(),!1})),!0},SetPassword:function(e){var n=i;return n._resetErr(),n._isMobileMode()?(n._pdfPassword=e,!0):n._innerFun("SetPDFPassword",a.makeParams(e))},SetConvertMode:function(e){return i._setConvertMode(e)},SetConvertModeAsync:function(e){return i._setConvertModeAsync(e)},GetConvertMode:function(){var e=i;return e._resetErr(),e._pdfConvertMode},SetResolution:function(e){var n=i;return n._resetErr(),n._isMobileMode()?(n._pdfResolution=+e,!0):i._innerFun("SetPDFResolution",a.makeParams(e))},SetResolutionAsync:function(e){var n=i;return n._resetErr(),n._isMobileMode()?(n._pdfResolution=+e,t.Promise.resolve(!0)):i._innerFunV2("SetPDFResolution",a.makeParams(e))},IsTextBasedPDF:function(e,n,o){var r=i;return r._resetErr(),r._isMobileMode()?r._mobileNotSupport("IsTextBasedPDF",o):(e=a.replaceLocalFilename(e),e=i._innerFun("IsTextBasedPDF",a.makeParams(e)),0==r.ErrorCode?t.isFunction(n)&&n(e):t.isFunction(o)&&o(r.ErrorCode,r.ErrorString),e)},Write:{Setup:function(e){var e=(e=e)||{version:15},n=(2<t.stringify(e).length&&(t.isNumber(e.version)?1<=e.version&&e.version<2&&(e.version=parseInt(10*e.version)):e.version=15),t.isNumber(e.compression)&&e.compression==Dynamsoft.DWT.EnumDWT_PDFCompressionType.PDF_FAX3&&(e.compression=Dynamsoft.DWT.EnumDWT_PDFCompressionType.PDF_FAX4),i);return n._resetErr(),n._isMobileMode()?(n._pdfWriteSetting=e,!0):(e=t.stringify(e),e=t.replaceAll(e,'"','\\"'),n._innerFun("SetPDFSettings",['["',e,'"]'].join("")))}}}},i.__addon=i.__addon||{},t.mix(i.__addon,e)})}),Dynamsoft.AddonReady(function(i,e){i.product.bActiveXEdition&&i.DynamicLoadAddonFuns&&i.DynamicLoadAddonFuns.push(function(t){var e,s,n;if(!t.getSWebTwain()||!t.getSWebTwain().Addon)return!1;Dynamsoft.navInfoSync.bWin&&(n=!Dynamsoft.navInfo.bOSx64||Dynamsoft.navInfo.bWOW64?"DynamicPdfCore_"+Dynamsoft.DWT.PdfVersion+".dll":"DynamicPdfCorex64_"+Dynamsoft.DWT.PdfVersion+".dll"),s=t.getSWebTwain(),e={PDF:{IsModuleInstalled:function(){var e=s.GetAddOnVersion("pdf",n);return i.setErrorString(t),""!=e},IsModuleInstalledAsync:function(){var e=s.GetAddOnVersion("pdf",n);return i.setErrorString(t),i.Promise.resolve(""!=e)},ConvertToImage:function(e,n,o,r){e=s.ConvertPDFToImage(e,n);return i.wrapperRet(t,e,o,r)},SetPassword:function(e){e=s.SetPDFPassword(e);return i.wrapperRet(t,e)},SetConvertMode:function(e){return t._setConvertMode(e)},SetConvertModeAsync:function(e){return Promise.resolve(t._setConvertMode(e))},GetConvertMode:function(){return t._resetErr(),t._pdfConvertMode},SetResolution:function(e){e=s.SetPDFResolution(e);return i.wrapperRet(t,e)},SetResolutionAsync:function(e){e=s.SetPDFResolution(e);return i.Promise.resolve(i.wrapperRet(t,e))},IsTextBasedPDF:function(e){e=s.IsTextBasedPDF(e);return i.wrapperRet(t,e)}}},t.Addon=t.Addon||{},i.mix(t.Addon,e)})}); 
/*! 20220215
* Dynamsoft JavaScript Library
* Product: Dynamsoft Web Twain
* Web Site: https://www.dynamsoft.com
*
* Copyright 2022, Dynamsoft Corporation 
* Author: Dynamsoft R&D Department
*
* Version: 17.2.1
* 
* Module: addon/ocr
* final js: build\addon\dynamsoft.webtwain.addon.OCR.js
*/
;var Dynamsoft=self.Dynamsoft||{};Dynamsoft.DWT=Dynamsoft.DWT||{};Dynamsoft.aryAddonReadyFun=Dynamsoft.aryAddonReadyFun||[];Dynamsoft.AddonReady=Dynamsoft.AddonReady||function(a){Dynamsoft.aryAddonReadyFun.push(a)};Dynamsoft.DWT.OCRVerInName="10.0.0.0618";(function(c){var d=[Dynamsoft.DWT],b=0;for(;b<1;b++){var a=d[b];a.EnumDWT_OCRLanguage={OCRL_ENG:"eng",OCRL_ARA:"ara",OCRL_CHI_SIM:"chi_sim",OCRL_CHI_TRA:"chi_tra",OCRL_HIN:"hin",OCRL_URD:"urd",OCRL_SPA:"spa",OCRL_FRA:"fra",OCRL_MSA:"msa",OCRL_IND:"ind",OCRL_RUS:"rus",OCRL_BEN:"ben",OCRL_POR:"por",OCRL_PAN:"pan",OCRL_DEU:"deu",OCRL_JPN:"jpn",OCRL_FAS:"fas",OCRL_SWA:"swa",OCRL_JAV:"jav",OCRL_TEL:"tel",OCRL_TUR:"tur",OCRL_KOR:"kor",OCRL_MAR:"mar",OCRL_TAM:"tam",OCRL_VIE:"vie",OCRL_ITA:"ita",OCRL_THA:"tha"};a.EnumDWT_OCRPageSetMode={OCRPSM_OSD_ONLY:0,PSM_AUTO_OSD:1,PSM_AUTO_ONLY:2,PSM_AUTO:3,PSM_SINGLE_COLUMN:4,PSM_SINGLE_BLOCK_VERT_TEXT:5,PSM_SINGLE_BLOCK:6,PSM_SINGLE_LINE:7,PSM_SINGLE_WORD:8,PSM_CIRCLE_WORD:9,PSM_SINGLE_CHAR:10};a.EnumDWT_OCROutputFormat={OCROF_TEXT:0,OCROF_PDFPLAINTEXT:1,OCROF_PDFIMAGEOVERTEXT:2,OCROF_PDFPLAINTEXT_PDFX:3,OCROF_PDFIMAGEOVERTEXT_PDFX:4};a.EnumDWT_OCRDownloadType={OCRDT_Dll:0,OCRDT_LANGUAGE:1}}})(typeof window!=="undefined"?window:this);Dynamsoft.DWT.OCRLanguageData_eng="4113088";Dynamsoft.DWT.OCRLanguageData_ara="1432056";Dynamsoft.DWT.OCRLanguageData_chi_sim="2469156";Dynamsoft.DWT.OCRLanguageData_chi_tra="2366642";Dynamsoft.DWT.OCRLanguageData_hin="1122751";Dynamsoft.DWT.OCRLanguageData_urd="1398718";Dynamsoft.DWT.OCRLanguageData_spa="2294433";Dynamsoft.DWT.OCRLanguageData_fra="1130365";Dynamsoft.DWT.OCRLanguageData_msa="1747801";Dynamsoft.DWT.OCRLanguageData_ind="1122661";Dynamsoft.DWT.OCRLanguageData_rus="3861738";Dynamsoft.DWT.OCRLanguageData_ben="855841";Dynamsoft.DWT.OCRLanguageData_por="1982756";Dynamsoft.DWT.OCRLanguageData_pan="497721";Dynamsoft.DWT.OCRLanguageData_deu="1525436";Dynamsoft.DWT.OCRLanguageData_jpn="2471260";Dynamsoft.DWT.OCRLanguageData_fas="431500";Dynamsoft.DWT.OCRLanguageData_swa="2167651";Dynamsoft.DWT.OCRLanguageData_jav="2982741";Dynamsoft.DWT.OCRLanguageData_tel="2769654";Dynamsoft.DWT.OCRLanguageData_tur="4550554";Dynamsoft.DWT.OCRLanguageData_kor="1677415";Dynamsoft.DWT.OCRLanguageData_mar="2118233";Dynamsoft.DWT.OCRLanguageData_tam="3237963";Dynamsoft.DWT.OCRLanguageData_vie="531275";Dynamsoft.DWT.OCRLanguageData_ita="2701314";Dynamsoft.DWT.OCRLanguageData_tha="1072600";Dynamsoft.DWT.OCRLanguageData={};Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_ENG]=Dynamsoft.DWT.OCRLanguageData_eng;Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_ARA]=Dynamsoft.DWT.OCRLanguageData_ara;Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_CHI_TRA]=Dynamsoft.DWT.OCRLanguageData_chi_tra;Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_CHI_SIM]=Dynamsoft.DWT.OCRLanguageData_chi_sim;Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_HIN]=Dynamsoft.DWT.OCRLanguageData_hin;Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_URD]=Dynamsoft.DWT.OCRLanguageData_urd;Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_SPA]=Dynamsoft.DWT.OCRLanguageData_spa;Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_FRA]=Dynamsoft.DWT.OCRLanguageData_fra;Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_MSA]=Dynamsoft.DWT.OCRLanguageData_msa;Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_IND]=Dynamsoft.DWT.OCRLanguageData_ind;Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_RUS]=Dynamsoft.DWT.OCRLanguageData_rus;Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_BEN]=Dynamsoft.DWT.OCRLanguageData_ben;Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_POR]=Dynamsoft.DWT.OCRLanguageData_por;Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_PAN]=Dynamsoft.DWT.OCRLanguageData_pan;Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_DEU]=Dynamsoft.DWT.OCRLanguageData_deu;Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_JPN]=Dynamsoft.DWT.OCRLanguageData_jpn;Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_FAS]=Dynamsoft.DWT.OCRLanguageData_fas;Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_SWA]=Dynamsoft.DWT.OCRLanguageData_swa;Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_JAV]=Dynamsoft.DWT.OCRLanguageData_jav;Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_TEL]=Dynamsoft.DWT.OCRLanguageData_tel;Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_TUR]=Dynamsoft.DWT.OCRLanguageData_tur;Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_KOR]=Dynamsoft.DWT.OCRLanguageData_kor;Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_MAR]=Dynamsoft.DWT.OCRLanguageData_mar;Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_TAM]=Dynamsoft.DWT.OCRLanguageData_tam;Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_VIE]=Dynamsoft.DWT.OCRLanguageData_vie;Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_ITA]=Dynamsoft.DWT.OCRLanguageData_ita;Dynamsoft.DWT.OCRLanguageData[Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_THA]=Dynamsoft.DWT.OCRLanguageData_tha;(function(a){function b(){var c=this;c._text="";c._fontName="";c._fontSize="";c._left=0;c._top=0;c._right=0;c._bottom=0}b.prototype.GetText=function(){var c=this;return c._text};b.prototype.GetFontName=function(){var c=this;return c._fontName};b.prototype.GetFontSize=function(){var c=this;return c._fontSize};b.prototype.GetWordRect=function(){var c=this;return c._left+","+c._top+","+c._right+","+c._bottom};a.NewWordBasicResult=function(){return new b()}})(Dynamsoft.Lib);(function(a){function b(){var c=this;c._count=0;c._left=0;c._top=0;c._right=0;c._bottom=0;c._wordlist=[]}b.prototype.GetWordCount=function(){var c=this;return c._count};b.prototype.GetLineRect=function(){var c=this;return c._left+","+c._top+","+c._right+","+c._bottom};b.prototype.GetWordContent=function(d){var f=this,c=f._wordlist.length;if(f._errorCode<0){return""}if(d==null||d>=c||d<0){Dynamsoft.Lib.Errors.OCR_InvalidIndex(f,"GetWordContent");return""}var e=Dynamsoft.Lib.NewWordBasicResult();e._text=f._wordlist[d].text;e._fontName=f._wordlist[d].fontname;e._fontSize=f._wordlist[d].fontsize;e._left=f._wordlist[d].rect[0];e._top=f._wordlist[d].rect[1];e._right=f._wordlist[d].rect[2];e._bottom=f._wordlist[d].rect[3];return e};a.NewLineBasicResult=function(){return new b()}})(Dynamsoft.Lib);(function(b){function a(){var c=this;c._count=0;c._linelist=[]}a.prototype.GetLineCount=function(){var c=this;return c._count};a.prototype.GetLineContent=function(e){var f=this,d=f._linelist.length;if(f._errorCode<0){return""}if(e==null||e>=d||e<0){Dynamsoft.Lib.Errors.OCR_InvalidIndex(f,"GetLineContent");return""}var c=Dynamsoft.Lib.NewLineBasicResult();c._count=f._linelist[e].words.length;c._left=f._linelist[e].rect[0];c._top=f._linelist[e].rect[1];c._right=f._linelist[e].rect[2];c._bottom=f._linelist[e].rect[3];c._wordlist=f._linelist[e].words;return c};b.NewPageBasicResult=function(){return new a()}})(Dynamsoft.Lib);(function(b){function a(){var c=this;c._count=0;c._pagelist=[]}a.prototype.GetPageCount=function(){var c=this;return c._count};a.prototype.GetPageContent=function(d){var f=this,c=f._pagelist.length;if(f._errorCode<0){return""}if(d==null||d>=c||d<0){Dynamsoft.Lib.Errors.OCR_InvalidIndex(f,"GetPageContent");return""}var e=Dynamsoft.Lib.NewPageBasicResult();e._count=f._pagelist[d].lines.length;e._linelist=f._pagelist[d].lines;return e};b.NewPageSetBasicResult=function(){return new a()}})(Dynamsoft.Lib);(function(b){function a(d){var c=this;c._errorCode=0;c._errorString="";c._resultlist=[];c._stwain=d}a.prototype.GetErrorCode=function(){var c=this;return c._errorCode};a.prototype.GetErrorString=function(){var c=this;return c._errorString};a.prototype.GetFormat=function(){var c=this;return c._resultlist[0].format};a.prototype.GetInput=function(){var e=this,d=e._resultlist[0].input;if(d){var c=Number(d);if(!isNaN(c)){return e._stwain._ImgManager.convertServerIdToClientIndex(c)}}return d};a.prototype.GetPageSetCount=function(){var c=this;return c._resultlist[0].pagesets.length};a.prototype.GetPageSetContent=function(e){var f=this,c=f._resultlist[0].pagesets.length;if(f._errorCode<0){return""}if(e==null||e>=c||e<0){Dynamsoft.Lib.Errors.OCR_InvalidIndex(f,"GetPageSetContent");return""}var d=Dynamsoft.Lib.NewPageSetBasicResult();d._count=f._resultlist[0].pagesets[e].pages.length;d._pagelist=f._resultlist[0].pagesets[e].pages;return d};a.prototype.Get=function(){var c=this;return c._stwain._innerFun("GetOCRRestult")};a.prototype.Save=function(c){var e=this,d=b.html5.Funs.replaceLocalFilename(c);return e._stwain._innerFun("SaveOCRRestult",b.html5.Funs.makeParams(d))};b.NewOCRBasicResult=function(c){return new a(c)}})(Dynamsoft.Lib);(function(b){function a(){var c=this;c.UnicodeFontName="";c.UseDetectedFont=true;c.MinFontSizeforMoreAccurateResult=0;c.OCRLanguage=Dynamsoft.DWT.EnumDWT_OCRLanguage.OCRL_ENG;c.PageSetMode=Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_AUTO;c.OutputFormat=Dynamsoft.DWT.EnumDWT_OCROutputFormat.OCROF_PDFIMAGEOVERTEXT}a.prototype.GetUnicodeFontName=function(){var c=this;return c.UnicodeFontName};a.prototype.SetUnicodeFontName=function(c){var e=this,d=c;if(!b.isString(d)){d=""}e.UnicodeFontName=d;return true};a.prototype.GetUseDetectedFont=function(){var d=this,c=d.UseDetectedFont;return c?true:false};a.prototype.SetUseDetectedFont=function(c){var d=this;d.UseDetectedFont=c?true:false;return true};a.prototype.GetMinFontSizeforMoreAccurateResult=function(){var c=this;return c.MinFontSizeforMoreAccurateResult};a.prototype.SetMinFontSizeforMoreAccurateResult=function(c){var e=this,d=c*1;if(d<0){d=0}e.MinFontSizeforMoreAccurateResult=d;return true};a.prototype.GetOCRLanguage=function(){var c=this;return c.OCRLanguage};a.prototype.SetOCRLanguage=function(c){var e=this,d=c;if(!b.isString(d)){d=""}e.OCRLanguage=d;return true};a.prototype.GetPageSetMode=function(){var c=this;return c.PageSetMode};a.prototype.SetPageSetMode=function(c){var e=this,d=c*1;if(d<0||d>Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_SINGLE_CHAR){d=Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_AUTO}e.PageSetMode=d;return true};a.prototype.GetOutputFormat=function(){var c=this;return c.OutputFormat};a.prototype.SetOutputFormat=function(c){var e=this,d=c*1;if(d<0||d>Dynamsoft.DWT.EnumDWT_OCROutputFormat.OCROF_PDFIMAGEOVERTEXT_PDFX){d=Dynamsoft.DWT.EnumDWT_OCROutputFormat.OCROF_PDFIMAGEOVERTEXT}e.OutputFormat=d;return true};b.NewOptions=function(){return new a()}})(Dynamsoft.Lib);Dynamsoft.AddonReady(function(c,b){if(!c.product.bHTML5Edition){return}var a;function e(g){var h=c.html5.Funs;if(c.env.bMac){a="DynamicOCR_"+Dynamsoft.DWT.OCRVerInName+".dylib"}else{if(c.env.bLinux){a="DynamicOCR_"+Dynamsoft.DWT.OCRVerInName+".so"}else{if(Dynamsoft.dcp.b64bit){a="DynamicOCRx64_"+Dynamsoft.DWT.OCRVerInName+".dll"}else{a="DynamicOCR_"+Dynamsoft.DWT.OCRVerInName+".dll"}}}if(!g._isMobileMode()){g._innerSend("GetAddOnVersion",h.makeParams("ocr",a),true,false,false)}g.__innerOCRBasicReadFunction=function(n,s,o,t,l,u,v,i,j,r,k){var q=this;if(!c.isFunction(r)){return q.__innerOCRSyncReadFunction(n,j)}else{return q.__innerOCRBasicAsyncReadFunction(n,s,o,t,l,u,v,i,j,r,k)}};g.__innerGetOCRBasicResultAsyncFunction=function(j){var i=Dynamsoft.Lib.NewOCRBasicResult(this);if(j){i._errorCode=j.exception;i._errorString=j.description;i._resultlist=j.result}return i};g.__innerOCRBasicAsyncReadFunction=function(n,t,o,u,l,v,x,i,j,s,k){var r=this;var q=function(p){if(p.exception==0){if(c.isFunction(s)){if(t!=-1){var m=r.objImageIndexManager.convertServerIdToGuid(t);if(u==1){s(m,l,v,x,i,r.__innerGetOCRBasicResultAsyncFunction(p))}else{s(m,r.__innerGetOCRBasicResultAsyncFunction(p))}}else{if(o!=""){s(o,r.__innerGetOCRBasicResultAsyncFunction(p))}else{s(r.__innerGetOCRBasicResultAsyncFunction(p))}}}if(c.License.isLTS()){Dynamsoft.DWT.lcvrf(g)}}else{if(c.isFunction(k)){k(p.exception,p.description)}}h.hideMask(n)},w=function(m){h.hideMask(n)};h.showMask(n);r._innerSend(n,j,true,q,w);return true};g.__innerOCRSyncReadFunction=function(j,l){var n=this,k,i;k=n._innerFunRaw(j,l,false,false);i=c.NewOCRBasicResult();i._errorCode=n._errorCode;i._errorString=n._errorString;if(k&&c.isArray(k)){i._resultlist=k;i._Count=k.length;if(c.License.isLTS()){Dynamsoft.DWT.lcvrf(g)}}return i};g.__IsOCRBasicModuleInstalled=function(){var k=g;var i=k._innerFun("GetAddOnVersion",h.makeParams("ocr",a));var j=i.split("|");if(j[0]!=""){return true}else{return false}};g.__innerBasicDownload=function(q,t,k,v,l){var o=g,s;c.cancelFrome=2;q=q.toString();var n=function(){if(c.isFunction(v)){v()}return true},w=function(){if(c.isFunction(l)){l(o.ErrorCode,o.ErrorString)}return false};if(!c.License.checkProductKey(o,{Core:true})){return w()}if(!c.License.checkProductKey(o,{OCR:true},true)){return w()}if(t!=Dynamsoft.DWT.EnumDWT_OCRDownloadType.OCRDT_Dll){o._innerFun("SetOCRLanguage",h.makeParams(k))}var i=o._innerFun("GetAddOnVersion",h.makeParams("ocr",a));var j=i.split("|");if(t==Dynamsoft.DWT.EnumDWT_OCRDownloadType.OCRDT_Dll){if(j[0]!=""){n();return true}}else{var r=Dynamsoft.DWT.OCRLanguageData[k];if(r&&j[1]==r){n();return true}}if(!q||q==""){c.Errors.OCR_InvalidRemoteFilename(o);w();return false}if(h.isServerInvalid(o)){w();return false}s="get";c.showProgress(o,"Download",true);var u=function(x){var y=(x.total===0)?100:Math.round(x.loaded*100/x.total),z=[x.loaded," / ",x.total].join("");o._OnPercentDone([0,y,"","http"])},m=true;if(t==Dynamsoft.DWT.EnumDWT_OCRDownloadType.OCRDT_Dll){o._OnPercentDone([0,-1,"Downloading OCR Module...","http"])}else{o._OnPercentDone([0,-1,"Downloading OCR Language Data...","http"])}if(!c.isFunction(v)){m=false}h.loadHttpBlob(o,s,q,m,function(p){o._OnPercentDone([0,-1,"Loading..."]);var x=100;if(t==Dynamsoft.DWT.EnumDWT_OCRDownloadType.OCRDT_LANGUAGE){x=101}o.__LoadImageFromBytes(p,x,"",m,n,w)},function(){c.closeProgress("Download");w()},u)}}var f=function(j){var k=[],h,g,i;if(j._ImgManager.count()<=0){return k}g=j._ImgManager.getCurrentImageIndex();h=j._ImgManager.convertClientIndexToServerId(g);i=j._ImgManager.getSelectedClientIndexArray();if(c.isArray(i)){c.each(i,function(l){var m=j._ImgManager.convertClientIndexToServerId(l);k.push(m)})}return k},d=function(i){var j=c.html5.Funs,g;var h=c.NewOptions();e(i);g={OCR:{SetUnicodeFontName:function(k){var l=i;l._resetErr();if(l._isMobileMode()){return l._mobileNotSupport("Addon.OCR.SetUnicodeFontName")}return h.SetUnicodeFontName(k)},GetUnicodeFontName:function(){var k=i;k._resetErr();if(k._isMobileMode()){return k._mobileNotSupport("Addon.OCR.GetUnicodeFontName")}return h.GetUnicodeFontName()},SetIfUseDetectedFont:function(k){var l=i;l._resetErr();if(l._isMobileMode()){return l._mobileNotSupport("Addon.OCR.SetIfUseDetectedFont")}return h.SetUseDetectedFont(k)},GetIfUseDetectedFont:function(){var k=i;k._resetErr();if(k._isMobileMode()){return k._mobileNotSupport("Addon.OCR.GetIfUseDetectedFont")}return h.GetUseDetectedFont()},SetMinFontSizeforMoreAccurateResult:function(k){var l=i;l._resetErr();if(l._isMobileMode()){return l._mobileNotSupport("Addon.OCR.SetMinFontSizeforMoreAccurateResult")}return h.SetMinFontSizeforMoreAccurateResult(k)},GetMinFontSizeforMoreAccurateResult:function(){var k=i;k._resetErr();if(k._isMobileMode()){return k._mobileNotSupport("Addon.OCR.GetMinFontSizeforMoreAccurateResult")}return h.GetMinFontSizeforMoreAccurateResult()},SetLanguage:function(k){var l=i;l._resetErr();if(l._isMobileMode()){return l._mobileNotSupport("Addon.OCR.SetLanguage")}return h.SetOCRLanguage(k)},IsModuleInstalled:function(){var k=i;k._resetErr();if(k._isMobileMode()){return k._mobileNotSupport("Addon.OCR.IsModuleInstalled")}return k.__IsOCRBasicModuleInstalled()},SetPageSetMode:function(l){var m=i;m._resetErr();if(m._isMobileMode()){return m._mobileNotSupport("Addon.OCR.SetPageSetMode")}var k=l*1;if(k==Dynamsoft.DWT.EnumDWT_OCRPageSetMode.OCRPSM_OSD_ONLY||k==Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_AUTO_OSD||k==Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_AUTO_ONLY||k==Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_AUTO||k==Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_SINGLE_COLUMN||k==Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_SINGLE_BLOCK_VERT_TEXT||k==Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_SINGLE_BLOCK||k==Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_SINGLE_LINE||k==Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_SINGLE_WORD||k==Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_CIRCLE_WORD||k==Dynamsoft.DWT.EnumDWT_OCRPageSetMode.PSM_SINGLE_CHAR){return h.SetPageSetMode(k)}Dynamsoft.Lib.Errors.OCR_InvalidPageSetMode(m);return false},SetOutputFormat:function(l){var m=i;m._resetErr();if(m._isMobileMode()){return m._mobileNotSupport("Addon.OCR.SetOutputFormat")}var k=l*1;if(k==Dynamsoft.DWT.EnumDWT_OCROutputFormat.OCROF_TEXT||k==Dynamsoft.DWT.EnumDWT_OCROutputFormat.OCROF_PDFPLAINTEXT||k==Dynamsoft.DWT.EnumDWT_OCROutputFormat.OCROF_PDFIMAGEOVERTEXT||k==Dynamsoft.DWT.EnumDWT_OCROutputFormat.OCROF_PDFPLAINTEXT_PDFX||k==Dynamsoft.DWT.EnumDWT_OCROutputFormat.OCROF_PDFIMAGEOVERTEXT_PDFX){return h.SetOutputFormat(k)}Dynamsoft.Lib.Errors.OCR_InvalidOutputFormat(m);return false},Recognize:function(n,k,m){var o=i;o._resetErr();if(o._isMobileMode()){return o._mobileNotSupport("Addon.OCR.Recognize")}if(!c.License.checkProductKey(o,{OCR:true},true)){if(c.isFunction(m)){m(o._errorCode,o._errorString)}return false}var l=o._ImgManager.convertClientIndexToServerId(n);return o.__innerOCRBasicReadFunction("OCRRecognize",l,"",0,0,0,0,0,j.makeParams(0,l,"",0,0,0,0,h.GetUnicodeFontName(),h.GetUseDetectedFont(),h.GetMinFontSizeforMoreAccurateResult(),h.GetOCRLanguage(),h.GetPageSetMode(),h.GetOutputFormat(),""),k,m)},RecognizeRect:function(s,l,p,r,k,q,m){var o=i;o._resetErr();if(o._isMobileMode()){return o._mobileNotSupport("Addon.OCR.RecognizeRect")}if((!l&&l!=0)||(!p&&p!=0)||(!r&&r!=0)||(!k&&k!=0)){var t=Dynamsoft.Lib.NewOCRBasicResult(o);Dynamsoft.Lib.Errors.OCR_InvalidLeftOrTopOrRightOrBottom(t,"RecognizeRect");m(t.GetErrorCode(),t.GetErrorString());return}if(!c.License.checkProductKey(o,{OCR:true},true)){if(c.isFunction(m)){m(o._errorCode,o._errorString)}return false}var n=o._ImgManager.convertClientIndexToServerId(s);return o.__innerOCRBasicReadFunction("OCRRecognize",n,"",1,l,p,r,k,j.makeParams(0,n,"",l,p,r,k,h.GetUnicodeFontName(),h.GetUseDetectedFont(),h.GetMinFontSizeforMoreAccurateResult(),h.GetOCRLanguage(),h.GetPageSetMode(),h.GetOutputFormat(),""),q,m)},RecognizeFile:function(l,k,m){var o=i;o._resetErr();if(o._isMobileMode()){return o._mobileNotSupport("Addon.OCR.RecognizeFile")}var n=j.replaceLocalFilename(l);if(!c.License.checkProductKey(o,{OCR:true},true)){if(c.isFunction(m)){m(o._errorCode,o._errorString)}return false}return o.__innerOCRBasicReadFunction("OCRRecognize",-1,n,0,0,0,0,0,j.makeParams(1,-1,n,0,0,0,0,h.GetUnicodeFontName(),h.GetUseDetectedFont(),h.GetMinFontSizeforMoreAccurateResult(),h.GetOCRLanguage(),h.GetPageSetMode(),h.GetOutputFormat(),""),k,m)},RecognizeSelectedImages:function(k,n){var o=i;o._resetErr();if(o._isMobileMode()){return o._mobileNotSupport("Addon.OCR.RecognizeSelectedImages")}var l;if(!c.License.checkProductKey(o,{OCR:true},true)){if(c.isFunction(n)){n(o._errorCode,o._errorString)}return false}var m=f(o);l=o.__innerOCRBasicReadFunction("OCRRecognize",-1,"",0,0,0,0,0,j.makeParams(2,-1,"",0,0,0,0,h.GetUnicodeFontName(),h.GetUseDetectedFont(),h.GetMinFontSizeforMoreAccurateResult(),h.GetOCRLanguage(),h.GetPageSetMode(),h.GetOutputFormat(),m.join(",")),k,n);return l},Download:function(m,k,l){var n=i;n._resetErr();if(n._isMobileMode()){return n._mobileNotSupport("Addon.OCR.Download")}return n.__innerBasicDownload(m,Dynamsoft.DWT.EnumDWT_OCRDownloadType.OCRDT_Dll,h.GetOCRLanguage(),k,l)},DownloadLangData:function(m,k,l){var n=i;n._resetErr();if(n._isMobileMode()){return n._mobileNotSupport("Addon.OCR.DownloadLangData")}return n.__innerBasicDownload(m,Dynamsoft.DWT.EnumDWT_OCRDownloadType.OCRDT_LANGUAGE,h.GetOCRLanguage(),k,l)}}};i.__addon=i.__addon||{};c.mix(i.__addon,g)};if(c.DynamicLoadAddonFuns){c.DynamicLoadAddonFuns.push(d)}}); 
/*! 20220215
* Dynamsoft JavaScript Library
* Product: Dynamsoft Web Twain
* Web Site: https://www.dynamsoft.com
*
* Copyright 2022, Dynamsoft Corporation 
* Author: Dynamsoft R&D Department
*
* Version: 17.2.1
* 
* Module: addon/ocrpro
* final js: build\addon\dynamsoft.webtwain.addon.ocrpro.js
*/
;var Dynamsoft=self.Dynamsoft||{};Dynamsoft.DWT=Dynamsoft.DWT||{};Dynamsoft.aryAddonReadyFun=Dynamsoft.aryAddonReadyFun||[];Dynamsoft.AddonReady=Dynamsoft.AddonReady||function(a){Dynamsoft.aryAddonReadyFun.push(a)};Dynamsoft.ProOCRVerInName="1.2.0.0806";(function(b){function a(){var c=this;c._text="";c._left=0;c._top=0;c._right=0;c._bottom=0}a.prototype.GetText=function(){var c=this;return c._text};a.prototype.GetLetterRect=function(){var c=this;return c._left+","+c._top+","+c._right+","+c._bottom};b.NewLetterResult=function(){return new a()}})(Dynamsoft.Lib);(function(b){function a(){var c=this;c._count=0;c._letterlist=[];c._zoneCount=0;c._zoneWords=[]}a.prototype.GetLettersCount=function(){var c=this;return c._count};a.prototype.GetZoneCount=function(){var c=this;return c._zoneCount};a.prototype.GetLetterContent=function(d){var f=this,c=f._count;if(f._errorCode<0){return""}if(d==null||d>=c||d<0){Dynamsoft.Lib.Errors.OCR_InvalidIndex(f,"GetLetterContent");return""}var e=Dynamsoft.Lib.NewLetterResult();e._text=f._letterlist[d].letter;e._left=f._letterlist[d].boundary[0];e._top=f._letterlist[d].boundary[1];e._right=f._letterlist[d].boundary[2];e._bottom=f._letterlist[d].boundary[3];return e};a.prototype.GetZoneContent=function(d){var e=this,c=e._zoneCount;if(e._errorCode<0){return""}if(d==null||d>=c||d<0){Dynamsoft.Lib.Errors.OCR_InvalidIndex(e,"GetZoneContent");return""}return e._zoneWords[d]};b.NewPageResult=function(){return new a()}})(Dynamsoft.Lib);(function(a){function b(){var c=this;c._input=0;c._message="";c._page=-1}b.prototype.GetInput=function(){var c=this;return c._input};b.prototype.GetMessage=function(){var c=this;return c._message};b.prototype.GetPage=function(){var c=this;return c._page};a.NewErrorInfo=function(){return new b()}})(Dynamsoft.Lib);(function(a){function b(c){var d=this;d._errorCode=0;d._errorString="";d._errorlist=[];d._request="";d._ocrTotalCount=0;d._alreadyOCRCount=0;d._resultlist=[];d._resultZoneDetail=[];d._stwain=c}b.prototype.GetErrorCode=function(){var c=this;return c._errorCode};b.prototype.GetErrorString=function(){var c=this;return c._errorString};b.prototype.GetInput=function(){var e=this;if(e._request&&e._request.input){var d=e._request.input;if(d){var c=Number(d);if(!isNaN(c)){return e._stwain._ImgManager.convertServerIdToClientIndex(c)}}return d}else{return""}};b.prototype.GetErrorDetailList=function(){var g=this,c=0;if(g._errorlist){c=g._errorlist.length}var e=[];for(var d=0;d<c;d++){var f=Dynamsoft.Lib.NewErrorInfo();f._input=g._errorlist[d].input;f._message=g._errorlist[d].message;f._page=g._errorlist[d].page;e.push(f)}return e};b.prototype.GetOCRTotalCount=function(){var c=this;if(c._ocrTotalCount){return c._ocrTotalCount}else{return 0}};b.prototype.GetAlreadyOCRCount=function(){var c=this;if(c._alreadyOCRCount){return c._alreadyOCRCount}else{return 0}};b.prototype.GetPageCount=function(){var c=this;if(c._resultlist&&c._resultlist.length){return c._resultlist.length}else{return 0}};b.prototype.GetPageContent=function(d){var f=this,c=0;if(f._resultlist){c=f._resultlist.length}if(d==null||d>=c||d<0){Dynamsoft.Lib.Errors.OCR_InvalidIndex(f,"GetPageContent");return""}var e=Dynamsoft.Lib.NewPageResult();if(f._resultlist){e._count=f._resultlist[d].length;e._letterlist=f._resultlist[d]}else{e._count=0}if(f._resultZoneDetail){e._zoneCount=f._resultZoneDetail[d].length;e._zoneWords=f._resultZoneDetail[d]}else{e._zoneCount=0}return e};b.prototype.Get=function(){var c=this;return c._stwain._innerFun("GetOCRRestult")};b.prototype.Save=function(c){var e=this,d=a.html5.Funs.replaceLocalFilename(c);return e._stwain._innerFun("SaveOCRRestult",a.html5.Funs.makeParams(d))};a.NewOCRProResult=function(c){return new b(c)}})(Dynamsoft.Lib);(function(c){var d=[Dynamsoft.DWT],b=0;for(;b<1;b++){var a=d[b];a.EnumDWT_OCRProRecognitionModule={OCRPM_AUTO:"AUTO",OCRPM_MOSTACCURATE:"MOSTACCURATE",OCRPM_BALANCED:"BALANCED",OCRPM_FASTEST:"FASTEST"};a.EnumDWT_OCRProOutputFormat={OCRPFT_TXTS:"TXTS",OCRPFT_TXTCSV:"TXTCSV",OCRPFT_TXTF:"TXTF",OCRPFT_XML:"XML",OCRPFT_IOTPDF:"IOTPDF",OCRPFT_IOTPDF_MRC:"IOTPDF_MRC"};a.EnumDWT_OCRProPDFVersion={OCRPPDFV_0:"1.0",OCRPPDFV_1:"1.1",OCRPPDFV_2:"1.2",OCRPPDFV_3:"1.3",OCRPPDFV_4:"1.4",OCRPPDFV_5:"1.5",OCRPPDFV_6:"1.6",OCRPPDFV_7:"1.7"};a.EnumDWT_OCRProPDFAVersion={OCRPPDFAV_1A:"pdf/a-1a",OCRPPDFAV_1B:"pdf/a-1b",OCRPPDFAV_2A:"pdf/a-2a",OCRPPDFAV_2B:"pdf/a-2b",OCRPPDFAV_2U:"pdf/a-2u",OCRPPDFAV_3A:"pdf/a-3a",OCRPPDFAV_3B:"pdf/a-3b",OCRPPDFAV_3U:"pdf/a-3u"};a.EnumDWT_OCRProType={OCRDT_File:0,OCRDT_Index:1};a.EnumDWT_OCRFindTextFlags={OCRFT_WHOLEWORD:1,OCRFT_MATCHCASE:2,OCRFT_FUZZYMATCH:4};a.EnumDWT_OCRFindTextAction={OCRFT_HIGHLIGHT:0,OCRFT_STRIKEOUT:1,OCRFT_MARKFORREDACT:2}}})(typeof window!=="undefined"?window:this);(function(a){function b(){var c=this;c.FindText="";c.FindTextFlags=Dynamsoft.DWT.EnumDWT_OCRFindTextFlags.OCRFT_WHOLEWORD;c.FindTextAction=Dynamsoft.DWT.EnumDWT_OCRFindTextAction.OCRFT_MARKFORREDACT}a.NewRedaction=function(){return new b()}})(Dynamsoft.Lib);Dynamsoft.WebTwain={Addon:{OCRPro:{}}};(function(a){function b(){var c=this;c.RecognitionModule="";c.Languages="eng";c.OutputFormat="";c.PDFVersion="";c.PDFAVersion="";c.LicenseChecker="";c.Redaction=Dynamsoft.Lib.NewRedaction()}a.NewSettings=function(){return new b()}})(Dynamsoft.WebTwain.Addon.OCRPro);(function(){function a(f,e,c,b){var d=this;d.left=f;d.top=e;d.right=c;d.bottom=b}Dynamsoft.WebTwain.Addon.OCRPro.NewOCRZone=function(e,d,c,b){return new a(e,d,c,b)}})();Dynamsoft.AddonReady(function(m,h){if(!m.product.bHTML5Edition){return}var n=1000,q=function(){return n++};function o(y){var z=m.html5.Funs;y.__innerGetOCRProResultAsyncFunction=function(B){var A=Dynamsoft.Lib.NewOCRProResult(this);if(B){A._errorCode=B.code;A._errorString=B.message;A._request=B.request;A._errorlist=B.errorList;A._ocrTotalCount=B.ocrTotalCount;A._alreadyOCRCount=B.alreadyOCRCount;A._resultlist=B.resultDetail;A._resultZoneDetail=B.resultZoneDetail}return A};y.__innerIsOCRTrial=function(A,B){var D=this,C=function(){var F=false;if(D.__licenseInfo.Detail){for(var E=0;E<D.__licenseInfo.Detail.length;E++){if(D.__licenseInfo.Detail[E].EnumLicenseType=="10"){if(D.__licenseInfo.Detail[E].Trial=="TRUE"){F=true}}}}return A(F)};if(D.__licenseInfo&&D.__licenseInfo.Detail){return C()}else{return D.GetLicenseInfo(C,B)}};y.__innerOCRReadFunction=function(D,I,E,H,A,B,G,C){var F=this;return F.__innerOCRAsyncReadFunction(D,I,E,H,A,B,G,C)};y.__innerOCRAsyncReadFunction=function(D,K,E,I,A,B,H,C){var G=this;var F=function(L){if(L.code==0){if(m.isFunction(H)){if(K!=-1){if(I==1){H(K,A,G.__innerGetOCRProResultAsyncFunction(L))}else{H(K,G.__innerGetOCRProResultAsyncFunction(L))}}else{if(E!=""){H(E,G.__innerGetOCRProResultAsyncFunction(L))}else{H(G.__innerGetOCRProResultAsyncFunction(L))}}}if(m.License.isLTS()){Dynamsoft.DWT.lcvrf(y)}}else{if(m.isFunction(C)){C(L.code,L.message,G.__innerGetOCRProResultAsyncFunction(L))}}z.hideMask(D)},J=function(L){z.hideMask(D)};z.showMask(D);G._innerSend(D,B,true,F,J);return true};y.__innerGetRequestJson=function(G,I,A,K,B){var F=y,C;var E="[{";E+='"id":"'+y.clientId+'",';E+='"method":"OCRProRecognize",';E+='"dllName":"'+B+'",';E+='"productkey":"'+Dynamsoft.DWT.ProductKey+'",';if(G==Dynamsoft.DWT.EnumDWT_OCRProType.OCRDT_File){E+='"inputType":"file",'}else{E+='"inputType":"index",'}E+='"input":[';for(C=0;C<I.length;C++){if(G==Dynamsoft.DWT.EnumDWT_OCRProType.OCRDT_File){E+='"'+I[C]+'"'}else{E+=I[C]}if(C+1<I.length){E+="|"}}E+="],";E+='"settings":{';E+='"recognitionMethod": "Page"';if(A){if(A.RecognitionModule&&A.RecognitionModule.length>0){E+=',"recognitionModule":"'+A.RecognitionModule+'"'}if(A.Languages&&A.Languages.length>0){E+=',"languages":"'+A.Languages+'"'}if(A.OutputFormat&&A.OutputFormat.length>0){E+=',"outputFormat":"'+A.OutputFormat+'"'}if(A.PDFVersion&&A.PDFVersion.length>0){E+=',"pdfVersion":"'+A.PDFVersion+'"'}if(A.PDFAVersion&&A.PDFAVersion.length>0){E+=',"pdfAVersion":"'+A.PDFAVersion+'"'}if(A.Redaction&&A.Redaction.FindText&&A.Redaction.FindText.length>0){var J=parseInt(A.Redaction.FindTextFlags),H=parseInt(A.Redaction.FindTextAction);if(!isNaN(J)&&!isNaN(H)){E+=',"redaction":{';var D=A.Redaction.FindText;D=D.replace(/\"/g,'\\"');E+='"findText":"'+D+'"';E+=',"findTextFlags":'+J;E+=',"findTextAction":'+H;E+="}"}}}E+="},";E+='"zones":[';for(C=0;C<K.length;C++){E+="["+K[C].left+","+K[C].top+","+K[C].right+","+K[C].bottom+"]";if(C+1<K.length){E+=","}}E+="],";E+='"outputFile":""';E+="}]";return E};y.__LoadImageFromBytesForDownloadInner=function(E,K,O,J,L,B,H,M,D){var I=y;var A,C,G;if(E>=J){A=B*J;G=K.slice(A,L)}else{A=E*B;C=(E+1)*B;G=K.slice(A,C)}var N=function(){if(Dynamsoft.Lib.isFunction(D)){D()}};var F=function(){if(E>=J){if(Dynamsoft.Lib.isFunction(M)){M()}return}E=E+1;I.__LoadImageFromBytesForDownloadInner(E,K,O,J,L,B,H,M,D)};I.__LoadImageFromBytes(G,O,"",H,F,N,A,L)};y.__LoadImageFromBytesForDownload=function(H,B,G,D,C,J){var F=y;var A=2*1000*1000;var I=H.size||H.length;var E=parseInt(I/A);var K=I%A;if(K==0){E=E-1}F.__LoadImageFromBytesForDownloadInner(0,H,B,E,I,A,D,C,J)}}var e=function(B){var C=[],z,y,A;if(B._ImgManager.count()<=0){return C}y=B._ImgManager.getCurrentImageIndex();z=B._ImgManager.convertClientIndexToServerId(y);A=B._ImgManager.getSelectedClientIndexArray();if(m.isArray(A)){m.each(A,function(D){var E=B._ImgManager.convertClientIndexToServerId(D);C.push(E)})}return C},v=function(C,A,z,B){var y=m.NewOCRProResult(C);y._errorCode=A;y._errorString=z;var D=m.NewErrorInfo();D.input=B;D.message=y._errorString;D.page=0;y._errorlist=[D];return y},g=function(A){var B=m.html5.Funs,z,y;if(m.env.bMac){y="DynamicOCRPro_"+Dynamsoft.ProOCRVerInName+".dylib"}else{if(m.env.bLinux){y="DynamicOCRPro_"+Dynamsoft.ProOCRVerInName+".so"}else{if(Dynamsoft.dcp.b64bit){y="DynamicOCRProx64_"+Dynamsoft.ProOCRVerInName+".dll"}else{y="DynamicOCRPro_"+Dynamsoft.ProOCRVerInName+".dll"}}}o(A);z={OCRPro:{Settings:false,Recognize:function(N,K,D){var J=[],H,O,L,I;var G=A;G._resetErr();if(G._isMobileMode()){return G._mobileNotSupport("Addon.OCRPro.Recognize")}H=parseInt(N);if(m.isNaN(H)||!m.isNumber(H)){O=v(A,-2201,"Invalid parameter type.",N);if(m.isFunction(D)){D(O._errorCode,O._errorString,O)}else{m.Errors.WebviewerError(A,O._errorString,O._errorCode)}return false}var F=A._ImgManager.convertClientIndexToServerId(H);if(F==-1){if(m.isFunction(D)){m.Errors.IndexOutOfRange(A);O=v(A,A._errorCode,A._errorString,N);D(O._errorCode,O._errorString,O)}return false}if(!m.License.checkProductKey(A,{OCRPro:true},true)){if(m.isFunction(D)){O=v(A,A._errorCode,A._errorString,N);D(O._errorCode,O._errorString,O)}return false}J.push(F);var M=[],C=this.Settings;var E=A.__innerGetRequestJson(Dynamsoft.DWT.EnumDWT_OCRProType.OCRDT_Index,J,C,M,y);return A.__innerIsOCRTrial(function(P){if(P||m.License.isLTS()){return A.__innerOCRReadFunction("OCRProRecognize",N,"",0,M,E,K,D)}else{return w(C.LicenseChecker,A,"OCRProRecognize",N,"",0,M,E,K,D)}},D)},RecognizeRect:function(X,P,R,G){var N=[],K,M,F,L;var S=A;S._resetErr();if(S._isMobileMode()){return S._mobileNotSupport("Addon.OCRPro.RecognizeRect")}K=parseInt(X);if(m.isNaN(K)||!m.isNumber(K)){M=v(A,-2201,"Invalid parameter type.",X);if(m.isFunction(G)){G(M._errorCode,M._errorString,M)}else{m.Errors.WebviewerError(A,M._errorString,M._errorCode)}return false}var Q=A._ImgManager.convertClientIndexToServerId(K),T=A._ImgManager.GetImageWidth(K),J=A.GetImageHeight(K);if(Q==-1){if(m.isFunction(G)){m.Errors.IndexOutOfRange(A);M=v(A,A._errorCode,A._errorString,X);G(M._errorCode,M._errorString,M)}return false}if(!m.License.checkProductKey(A,{OCRPro:true},true)){if(m.isFunction(G)){M=v(A,A._errorCode,A._errorString,X);G(M._errorCode,M._errorString,M)}return false}if(T>0&&J>0){var V,E,U,W,I,D;for(var O=0;O<P.length;O++){V=P[O];E=V.left;U=V.top;W=V.right;I=V.bottom;if(E<0){E=0}if(U<0){U=0}if(W<0){W=0}if(I<0){I=0}if(E>W){D=E;E=W;W=D}if(U>I){D=U;U=I;I=D}if(W>T){W=T}if(I>J){I=J}V.left=E;V.top=U;V.right=W;V.bottom=I}}N.push(Q);var C=this.Settings;var H=A.__innerGetRequestJson(Dynamsoft.DWT.EnumDWT_OCRProType.OCRDT_Index,N,C,P,y);return A.__innerIsOCRTrial(function(Y){if(Y||m.License.isLTS()){return A.__innerOCRReadFunction("OCRProRecognize",X,"",1,P,H,R,G)}else{return w(C.LicenseChecker,A,"OCRProRecognize",X,"",1,P,H,R,G)}},G)},RecognizeFile:function(D,M,G){var I=A;I._resetErr();if(I._isMobileMode()){return I._mobileNotSupport("Addon.OCRPro.RecognizeFile")}var P,N,K;if(D.length==0){if(m.isFunction(G)){P=Dynamsoft.Lib.NewOCRProResult(A);P._errorCode=-2201;P._errorString="File name cannot be empty.";K=[];N=Dynamsoft.Lib.NewErrorInfo();N.input=D;N.message=P._errorString;N.page=0;K.push(N);P._errorlist=K;G(P._errorCode,P._errorString,P)}return false}if(!m.License.checkProductKey(A,{OCRPro:true},true)){if(m.isFunction(G)){P=Dynamsoft.Lib.NewOCRProResult(A);P._errorCode=A._errorCode;P._errorString=A._errorString;K=[];N=Dynamsoft.Lib.NewErrorInfo();N.input=D;N.message=P._errorString;N.page=0;K.push(N);P._errorlist=K;G(P._errorCode,P._errorString,P)}return false}var J=B.replaceLocalFilename(D);var C=[];if(J.indexOf("|")>0){C=J.split("|")}else{if(J.indexOf(";")>0){C=J.split(";")}else{if(J.indexOf(",")>0){C=J.split(",")}}}var L=[];if(C.length>0){for(var F=0;F<C.length;F++){L.push(C[F])}}else{L.push(J)}var O=[],E=this.Settings;var H=A.__innerGetRequestJson(Dynamsoft.DWT.EnumDWT_OCRProType.OCRDT_File,L,E,O,y);A.__innerIsOCRTrial(function(Q){if(Q||m.License.isLTS()){return A.__innerOCRReadFunction("OCRProRecognize",-1,D,0,O,H,M,G)}else{return w(E.LicenseChecker,A,"OCRProRecognize",-1,D,0,O,H,M,G)}},G)},RecognizeSelectedImages:function(J,D){var G,H,K;var F=A;F._resetErr();if(F._isMobileMode()){return F._mobileNotSupport("Addon.OCRPro.RecognizeSelectedImages")}if(!m.License.checkProductKey(A,{OCRPro:true},true)){if(m.isFunction(D)){var M=Dynamsoft.Lib.NewOCRProResult(A);M._errorCode=A._errorCode;M._errorString=A._errorString;H=[];K=Dynamsoft.Lib.NewErrorInfo();K.input="";K.message=M._errorString;K.page=0;H.push(K);M._errorlist=H;D(M._errorCode,M._errorString,M)}return false}var L=[],C=this.Settings,I=e(A),E=A.__innerGetRequestJson(Dynamsoft.DWT.EnumDWT_OCRProType.OCRDT_Index,I,C,L,y);A.__innerIsOCRTrial(function(N){if(N||m.License.isLTS()){G=A.__innerOCRReadFunction("OCRProRecognize",-1,"",0,L,E,J,D)}else{G=w(C.LicenseChecker,A,"OCRProRecognize",-1,"",0,L,E,J,D)}},D);return G},IsModuleInstalled:function(){var D=A;D._resetErr();if(D._isMobileMode()){return D._mobileNotSupport("Addon.OCRPro.IsModuleInstalled")}var C=D._innerFun("GetAddOnVersion",B.makeParams("proocr",y));return(C!="")},Download:function(G,J,C){var F=A,H;F._resetErr();if(F._isMobileMode()){return F._mobileNotSupport("Addon.OCRPro.Download")}var E=function(){if(m.isFunction(J)){J()}return true},K=function(){if(m.isFunction(C)){C(F.ErrorCode,F.ErrorString)}return false};if(!m.License.checkProductKey(F,{Core:true})){return K()}if(!m.License.checkProductKey(F,{OCRPro:true},true)){return K()}if(this.IsModuleInstalled()){E();return true}if(!G||G==""||!m.isString(G)){m.Errors.OCR_InvalidRemoteFilename(F);K();return false}if(B.isServerInvalid(F)){K();return false}H="get";m.cancelFrome=2;m.showProgress(F,"Download",true);var I=function(L){var M=(L.total===0)?100:Math.round(L.loaded*100/L.total),N=[L.loaded," / ",L.total].join("");F._OnPercentDone([0,M,"","http"])},D=true;F._OnPercentDone([0,-1,"Downloading OCR Resources...","http"]);if(!m.isFunction(J)){D=false}return B.loadHttpBlob(F,H,G,D,function(L){F._OnPercentDone([0,-1,"Loading..."]);var M=102;F.__LoadImageFromBytesForDownload(L,M,"",D,E,K)},function(){m.closeProgress("Download");K()},I)}}};A.__addon=A.__addon||{};m.mix(A.__addon,z)};if(m.DynamicLoadAddonFuns){m.DynamicLoadAddonFuns.push(g)}function p(E,H,z,I,B,G,y,C,F,A){var D=this;D.STWAIN=H;D.AjaxFunctionUrl=E;D.FunctionName=z;D.ImageIndex=I;D.FileNames=B;D.Type=G;D.AryZone=y;D.JsonString=C;D.OnSuccess=F;D.OnFailure=A}Dynamsoft.WebTwain.Addon.OCRPro.NewOCRReadPara=function(D,G,z,H,B,F,y,C,E,A){return new p(D,G,z,H,B,F,y,C,E,A)};function s(C,B){var D="";var E=C.responseText;if(E.length==0){var A=Dynamsoft.WebTwain.Addon.OCRPro.NewOCRError();Dynamsoft.Lib.Errors.OCR_LicenseCheckerError(A,B.AjaxFunctionUrl);E=A.responseText}D=f(E);var z=D.split(";");if(z.length==1){B.OnFailure(-1,E,Dynamsoft.Lib.NewOCRProResult())}else{if(z[0]=="true"){var y=function(G,F,H){if(Dynamsoft.Lib.isUndefined(H)){if(Dynamsoft.Lib.isUndefined(F)){B.OnSuccess(G);x(B.AjaxFunctionUrl,G.GetPageCount())}else{B.OnSuccess(G,F);x(B.AjaxFunctionUrl,F.GetPageCount())}}else{B.OnSuccess(G,F,H);x(B.AjaxFunctionUrl,H.GetPageCount())}};B.STWAIN.__innerOCRReadFunction(B.FunctionName,B.ImageIndex,B.FileNames,B.Type,B.AryZone,B.JsonString,y,B.OnFailure)}else{B.OnFailure(z[1],z[2],Dynamsoft.Lib.NewOCRProResult())}}}function w(G,J,z,K,D,I,y,E,H,A){var B=G;var F="DTW_AjaxMethod=CheckLicense&Productkey="+j(Dynamsoft.DWT.ProductKey);var C=Dynamsoft.WebTwain.Addon.OCRPro.NewOCRReadPara(G,J,z,K,D,I,y,E,H,A);return d(B,F,s,C)}function x(A,B){var z=A;var y="DTW_AjaxMethod=WriteOCRCount&OCRCount="+j(B+"");d(z,y,b,null)}function b(z,y){}function a(){var y=this;y.responseText="";y.errorString=""}Dynamsoft.WebTwain.Addon.OCRPro.NewOCRError=function(){return new a()};Dynamsoft.Lib.mix(Dynamsoft.Lib.Errors,{OCR_LicenseCheckerEmpty:function(z){var A=-2601;var y="LicenseChecker cannot be empty.";z.errorString=y;z.responseText=j("false;"+A+";"+y+";")},OCR_LicenseCheckerNotConnect:function(z){var A=-2602;var y="Cannot connect to the LicenseChecker, please check and make sure it's set correctly.";z.errorString=y;z.responseText=j("false;"+A+";"+y+";")},OCR_AccessDenied:function(z){var A=-2603;var y="Access denied.";z.errorString=y;z.responseText=j("false;"+A+";"+y+";")},OCR_LicenseCheckerError:function(z,B){var A=-2604;var y="Error occured in '"+B+"'.";z.errorString=y;z.responseText=j("false;"+A+";"+y+";")},OCR_HTTPError:function(z,A){var B=-2605;var y="HTTP Error "+A+".";z.errorString=y;z.responseText=j("false;"+B+";"+y+";")},OCR_LicenseCheckerUnauthorized:function(z,B){var A=-2606;var y="You do not have permission to view this directory or page using the credentials you supplied (access denied due to Access Control Lists). Ask the Web server's administrator to give you access to '"+B+"'.";z.errorString=y;z.responseText=j("false;"+A+";"+y+";")},__last:false});function i(){var y=null,A=window;try{y=new A.ActiveXObject("Msxml2.XMLHTTP")}catch(z){try{y=new A.ActiveXObject("Microsoft.XMLHTTP")}catch(z){y=new XMLHttpRequest()}}return y}function d(z,y,D,C){var A=Dynamsoft.WebTwain.Addon.OCRPro.NewOCRError();if(z==""){Dynamsoft.Lib.Errors.OCR_LicenseCheckerEmpty(A);alert(A.errorString);D(A,C);return false}var B=i();B.open("POST",z,true);B.setRequestHeader("Content-Type","application/x-www-form-urlencoded");B.onreadystatechange=function(){if(B.readyState==4){if(B.status==200){if(D!=null&&typeof(D)=="function"){D(B,C)}}else{if(B.status==401){Dynamsoft.Lib.Errors.OCR_LicenseCheckerUnauthorized(A,C.AjaxFunctionUrl);D(A,C);return false}else{if(B.status==404){Dynamsoft.Lib.Errors.OCR_LicenseCheckerNotConnect(A);alert(A.errorString);D(A,C);return false}else{if(B.status==403){Dynamsoft.Lib.Errors.OCR_AccessDenied(A);D(A,C);return false}else{Dynamsoft.Lib.Errors.OCR_HTTPError(A,B.status);D(A,C);return false}}}}}};if(B&&y){B.send(y)}return true}var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var r=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);function k(E){var A,C,y;var D,B,z;y=E.length;C=0;A="";while(C<y){D=E.charCodeAt(C++)&255;if(C==y){A+=c.charAt(D>>2);A+=c.charAt((D&3)<<4);A+="==";break}B=E.charCodeAt(C++);if(C==y){A+=c.charAt(D>>2);A+=c.charAt(((D&3)<<4)|((B&240)>>4));A+=c.charAt((B&15)<<2);A+="=";break}z=E.charCodeAt(C++);A+=c.charAt(D>>2);A+=c.charAt(((D&3)<<4)|((B&240)>>4));A+=c.charAt(((B&15)<<2)|((z&192)>>6));A+=c.charAt(z&63)}return A}function t(F){var E,D,B,z;var C,y,A;y=F.length;C=0;A="";while(C<y){do{E=r[F.charCodeAt(C++)&255]}while(C<y&&E==-1);if(E==-1){break}do{D=r[F.charCodeAt(C++)&255]}while(C<y&&D==-1);if(D==-1){break}A+=String.fromCharCode((E<<2)|((D&48)>>4));do{B=F.charCodeAt(C++)&255;if(B==61){return A}B=r[B]}while(C<y&&B==-1);if(B==-1){break}A+=String.fromCharCode(((D&15)<<4)|((B&60)>>2));do{z=F.charCodeAt(C++)&255;if(z==61){return A}z=r[z]}while(C<y&&z==-1);if(z==-1){break}A+=String.fromCharCode(((B&3)<<6)|z)}return A}function u(B){var z,A,y,C;z="";y=B.length;for(A=0;A<y;A++){C=B.charCodeAt(A);if((C>=1)&&(C<=127)){z+=B.charAt(A)}else{if(C>2047){z+=String.fromCharCode(224|((C>>12)&15));z+=String.fromCharCode(128|((C>>6)&63));z+=String.fromCharCode(128|((C>>0)&63))}else{z+=String.fromCharCode(192|((C>>6)&31));z+=String.fromCharCode(128|((C>>0)&63))}}}return z}function l(D){var z,B,y,E;var C,A;z="";y=D.length;B=0;while(B<y){E=D.charCodeAt(B++);switch(E>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:z+=D.charAt(B-1);break;case 12:case 13:C=D.charCodeAt(B++);z+=String.fromCharCode(((E&31)<<6)|(C&63));break;case 14:C=D.charCodeAt(B++);A=D.charCodeAt(B++);z+=String.fromCharCode(((E&15)<<12)|((C&63)<<6)|((A&63)<<0));break}}return z}function j(y){return k(u(y))}function f(y){return l(t(y))}}); 
/*! 20230105181553
* Dynamsoft JavaScript Library
* Product: Dynamsoft Web Twain
* Web Site: https://www.dynamsoft.com
*
* Copyright 2023, Dynamsoft Corporation
* Author: Dynamsoft Support Team
*
* Module: Webcam
* Version: 18.1
* 
*/
var Dynamsoft=self.Dynamsoft||{};Dynamsoft.DWT=Dynamsoft.DWT||{},Dynamsoft.aryAddonReadyFun=Dynamsoft.aryAddonReadyFun||[],Dynamsoft.AddonReady=Dynamsoft.AddonReady||function(e){Dynamsoft.aryAddonReadyFun.push(e)},Dynamsoft.WebcamVerForActiveX="15.0.0.0625",Dynamsoft.WebcamVerInName="15.0.0.0625",function(){for(var e=[Dynamsoft.DWT],t=0;t<1;t++){var r=e[t];r.EnumDWT_VideoRotateMode={VRM_NONE:0,VRM_90_DEGREES_CLOCKWISE:1,VRM_180_DEGREES_CLOCKWISE:2,VRM_270_DEGREES_CLOCKWISE:3,VRM_FLIP_VERTICAL:4,VRM_FLIP_HORIZONTAL:5},r.EnumDWT_VideoProperty={VP_BRIGHTNESS:0,VP_CONTRAST:1,VP_HUE:2,VP_SATURATION:3,VP_SHARPNESS:4,VP_GAMMA:5,VP_COLORENABLE:6,VP_WHITEBALANCE:7,VP_BACKLIGHTCOMPENSATION:8,VP_GAIN:9},r.EnumDWT_CameraControlProperty={CCP_PAN:0,CCP_TILT:1,CCP_ROLL:2,CCP_ZOOM:3,CCP_EXPOSURE:4,CCP_IRIS:5,CCP_FOCUS:6}}}(),function(){Dynamsoft.Lib.WebcamErrors={InvalidParameter:function(e){e._errorCode=-10001,e._errorString="The parameter is invalid."},VideoNotPlayingWhenCapture:function(e){e._errorCode=-10002,e._errorString="To capture an image, the video must be playing."},VideoNotPlayingWhenGetURL:function(e){e._errorCode=-10003,e._errorString="To get the url for the current frame, the video must be playing."},Success:function(e){e._errorCode=0,e._errorString="Successful."}}}(),function(r){function t(e){var t=this;t._Count=0,t._resultlist=[],t._stwain=e}t.prototype.GetCount=function(){return r.WebcamErrors.Success(this._stwain),this._Count-1},t.prototype.Get=function(e){var t=this;return t._resultlist.length-1<=e||e<0?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(t._stwain,"Get"),""):(r.WebcamErrors.Success(t._stwain),t._resultlist[e])},t.prototype.GetCurrent=function(){var e=this,t=e._resultlist.length;return 0==t?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(e._stwain,"GetCurrent"),""):(r.WebcamErrors.Success(e._stwain),e._resultlist[t-1])},r.NewWebcamValue=function(e){return new t(e)}}(Dynamsoft.Lib),function(t){function r(e){var t=this;t._Count=0,t._resultlist=[],t._stwain=e}r.prototype.GetValue=function(){var e=this;return 0==e._resultlist.length?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(e._stwain,""),""):(t.WebcamErrors.Success(e._stwain),e._resultlist[0].current)},r.prototype.GetIfAuto=function(){var e=this;return 0==e._resultlist.length?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(e._stwain,""),!1):(t.WebcamErrors.Success(e._stwain),"true"==e._resultlist[0].auto)},t.NewWebcamSetting=function(e){return new r(e)}}(Dynamsoft.Lib),function(e){function t(e){var t=this;t._Count=0,t._resultlist=[],t._stwain=e}t.prototype.GetMinValue=function(){var e=this;return 0==e._resultlist.length?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(e._stwain,""),""):e._resultlist[0].min},t.prototype.GetMaxValue=function(){var e=this;return 0==e._resultlist.length?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(e._stwain,""),""):e._resultlist[0].max},t.prototype.GetSteppingDelta=function(){var e=this;return 0==e._resultlist.length?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(e._stwain,""),0):e._resultlist[0].step},t.prototype.GetDefaultValue=function(){var e=this;return 0==e._resultlist.length?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(e._stwain,""),0):e._resultlist[0].defaultValue},t.prototype.GetIfAuto=function(){var e=this;return 0==e._resultlist.length?(Dynamsoft.Lib.Errors.Webcam_InvalidIndex(e._stwain,""),!1):"true"==e._resultlist[0].auto},e.NewWebcamMoreSetting=function(e){return new t(e)}}(Dynamsoft.Lib),Dynamsoft.AddonReady(function(n,e){n.DynamicLoadAddonFuns&&n.DynamicLoadAddonFuns.push(function(r){r._innerSetWebcamValue=function(e){var t=n.NewWebcamValue(r);return e&&n.isArray(e)&&(t._resultlist=e,t._Count=e.length),t},r._innerSetWebcamSetting=function(e){var t=n.NewWebcamSetting(r);return e&&n.isArray(e)&&(t._resultlist=e,t._Count=e.length),t},r._innerSetWebcamMoreSetting=function(e){var t=n.NewWebcamMoreSetting(r);return e&&n.isArray(e)&&(t._resultlist=e,t._Count=e.length),t}}),n.Addon_Events.push("OnFrameCaptured"),n.Addon_Events.push("OnCaptureSuccess"),n.Addon_Events.push("OnCaptureError")}),Dynamsoft.AddonReady(function(l,e){l.product.bHTML5Edition&&l.DynamicLoadAddonFuns&&l.DynamicLoadAddonFuns.push(function(m){var e,d=l.html5.Funs,t=l.env.bMac?"DynamicWebcam_"+Dynamsoft.WebcamVerInName+".dylib":l.env.bLinux?"DynamicWebcam_"+Dynamsoft.WebcamVerInName+".so":m._b64bit?"DynamicWebcamx64_"+Dynamsoft.WebcamVerInName+".dll":"DynamicWebcam_"+Dynamsoft.WebcamVerInName+".dll";if(!m._isMobileMode())try{m._innerSend("GetAddOnVersion",d.makeParams("webcam",t),!0,!1,!1).catch(function(){})}catch(e){}(e=m)._innerWebcamValueFunction=function(e,t){e=this._innerFunRaw(e,t,!1,!1);return this._innerSetWebcamValue(e)},e._innerWebcamSettingFunction=function(e,t){e=this._innerFunRaw(e,t,!1,!1);return this._innerSetWebcamSetting(e)},e._innerWebcamMoreSettingFunction=function(e,t){e=this._innerFunRaw(e,t,!1,!1);return this._innerSetWebcamMoreSetting(e)},e._OnCaptureSuccess=function(e){Dynamsoft.Lib.isFunction(this.__OnCaptureSuccess)&&this.__OnCaptureSuccess()},e._OnCaptureError=function(e){var t=e[1],e=e[2];Dynamsoft.Lib.isFunction(this.__OnCaptureError)&&this.__OnCaptureError(t,e)},e._OnFrameCaptured=function(e){var t,r=this,n=Dynamsoft.Lib;r.__videoPause||(t=(t=r.__videoQuality)||60,r.__videoDest&&r.__videoDest.UpdateVideoContainer(r.GetImageURL(-1,-1,-1,0,t))),n.isFunction(r.__OnFrameCaptured)&&r.__OnFrameCaptured(e)},e={Webcam:{IsModuleInstalled:function(){var e=m;return e._resetErr(),e._isMobileMode()?e._mobileNotSupport("Addon.Webcam.IsModuleInstalled"):""!=e._innerFun("GetAddOnVersion",d.makeParams("webcam",t))},Download:function(e,t,r){var n=m;if(n._resetErr(),n._isMobileMode())return n._mobileNotSupport("Addon.Webcam.Download");Dynamsoft.Lib.cancelFrome=2;function o(){return Dynamsoft.Lib.isFunction(t)&&t(),!0}function i(){return Dynamsoft.Lib.isFunction(r)&&r(m._errorCode,m._errorString),!1}if(!l.License.checkProductKey(m,{Webcam:!0},!0))return i();if(this.IsModuleInstalled())return o();if(!e||""==e)return Dynamsoft.Lib.Errors.Webcam_InvalidRemoteFilename(n),i();if(d.isServerInvalid(n))return i(),!1;Dynamsoft.Lib.showProgress(n,"Download",!0);var a=!0;return n._OnPercentDone([0,-1,"Downloading Webcam Module...","http"]),Dynamsoft.Lib.isFunction(t)||(a=!1),d.loadHttpBlob(n,"get",e,a,function(e){n._OnPercentDone([0,-1,"Loading..."]);n.__LoadImageFromBytesV1(e,100,"",0,a,o,i)},function(){Dynamsoft.Lib.closeProgress(n,"Download"),i()},function(e){var t=0===e.total?100:Math.round(100*e.loaded/e.total);[e.loaded," / ",e.total].join("");n._OnPercentDone([0,t,"","http"])})},GetSourceList:function(){var e,t=m;return t._resetErr(),t._isMobileMode()?t._mobileNotSupport("Addon.Webcam.GetSourceList"):l.License.checkProductKey(t,{Webcam:!0},!0)?(e=t._innerFunRaw("GetWebcamSourceList"),0==t.ErrorCode&&e.splice(e.length-1,1),e):[]},SelectSource:function(e){var t=m;return t._resetErr(),t._isMobileMode()?t._mobileNotSupport("Addon.Webcam.SelectSource"):!!l.License.checkProductKey(t,{Webcam:!0},!0)&&t._innerFun("SelectWebcam",d.makeParams(e))},CloseSource:function(){var e=m;return e._resetErr(),e._isMobileMode()?e._mobileNotSupport("Addon.Webcam.CloseSource"):(this._clear(),e._innerFun("StopCapture"))},GetFramePartURL:function(){var e=m;return e._resetErr(),e._isMobileMode()?e._mobileNotSupport("Addon.Webcam.GetFramePartURL"):this._isPlaying()?e.GetImageURL(-1,-1,-1,!0,e.__videoQuality):(l.WebcamErrors.VideoNotPlayingWhenGetURL(e),"")},GetFrameURL:function(){var e=m;return e._resetErr(),e._isMobileMode()?e._mobileNotSupport("Addon.Webcam.GetFrameURL"):this._isPlaying()?e.GetImageURL(-1,-1,-1,0,e.__videoQuality):(l.WebcamErrors.VideoNotPlayingWhenGetURL(e),"")},PlayVideo:function(e,t,r,n,o){var i,a,u,s,c=m;return c._resetErr(),c._isMobileMode()?c._mobileNotSupport("Addon.Webcam.PlayVideo"):(i=Dynamsoft.Lib,a=60,u=this,s=function(){return u._clear(),Dynamsoft.Lib.isFunction(o)&&o(m._errorCode,m._errorString),!1},e?l.License.checkProductKey(m,{Webcam:!0},!0)?(c.__videoDest=e,c.__videoDest.ShowVideoContainer(!0),i.isFunction(r)&&(m.__OnFrameCaptured=r),m.__videoPause?(m.__videoPause=!1,l.isFunction(n)&&n()):(m.__videoPause=!1,m.__videoQuality=t?a=(a=+t)<1?60:a:a,m._innerSend("PlayVideo",d.makeParams(!0),!0,n,s)),!0):s():(Dynamsoft.Lib.Errors.ParameterCannotEmpty(m),s()))},PauseVideo:function(){var e=m;return e._resetErr(),e._isMobileMode()?e._mobileNotSupport("Addon.Webcam.PauseVideo"):(this._isPlaying()&&(e.__videoPause=!0),!0)},_clear:function(){var e=m;Dynamsoft.Lib;e.__videoPause=!1,e.__OnFrameCaptured=!1,e.__videoQuality=60,e.__videoDest&&e.__videoDest.ShowVideoContainer(!1),e.__videoDest=!1},_isPlaying:function(){return m.GetIfShowVideoContainer()},StopVideo:function(){var e=m;if(e._resetErr(),e._isMobileMode())return e._mobileNotSupport("Addon.Webcam.StopVideo");this._clear();var t=e._innerFun("PlayVideo",d.makeParams(!1,0));return e._innerFun("StopCapture"),t},CaptureImage:function(e,t){var r,n,o=m;return o._resetErr(),o._isMobileMode()?(o._mobileNotSupport("Addon.Webcam.CaptureImage"),l.isFunction(t)&&t(o._errorCode,o._errorString),!1):l.License.checkProductKey(o,{Webcam:!0},!0)?(r="CaptureImage",n=function(){d.hideMask(r),l.isFunction(t)&&t(o._errorCode,o._errorString)},d.showMask(r),o.__OnCaptureError=n,o._innerSend(r,d.makeParams(!1),!0,function(){d.hideMask(),0==o.ErrorCode?(d.hideMask(r),l.isFunction(e)&&setTimeout(e,0),l.License.isLTS()&&Dynamsoft.DWT.lcvrf(m)):n(o.ErrorCode,o.ErrorString)},n),!0):(l.isFunction(t)&&t(o._errorCode,o._errorString),!1)},GetMediaType:function(){var e=m;return e._resetErr(),e._isMobileMode()?e._mobileNotSupport("Addon.Webcam.GetMediaType"):e._innerWebcamValueFunction("GetMediaType")},SetMediaType:function(e){var t=m;return t._resetErr(),t._isMobileMode()?t._mobileNotSupport("Addon.Webcam.SetMediaType"):l.isString(e)?t._innerFun("SetMediaType",d.makeParams(e)):(l.Errors.InvalidValue(t),!1)},GetResolution:function(){var e=m;if(e._resetErr(),e._isMobileMode())return e._mobileNotSupport("Addon.Webcam.GetResolution");e=e._innerWebcamValueFunction("GetResolution");if(e&&e._resultlist){var t,r,n=e._resultlist,o=[],i=[];for(""==(r=0<n.length?n[n.length-1]:r)&&0<n.length&&(r=n[0]),t=0;t<n.length-1;t++){for(var a,u=(a=n[t]).toLowerCase().split("x"),s=(d=c=s=void 0,{value:a,p1:parseInt(u[0]),p2:parseInt(u[1])}),c=o,d=c.length-1;0<=d&&c[d].p1>=s.p1&&!(c[d].p1==s.p1&&c[d].p2<s.p2);)c[d+1]=c[d],d--;c[d+1]=s}for(t=0;t<o.length;t++)a=o[t].value,i.push(a);r&&i.push(r),e._resultlist=i,i=o=null}return e},SetResolution:function(e){var t=m;return t._resetErr(),t._isMobileMode()?t._mobileNotSupport("Addon.Webcam.SetResolution"):l.isNumber(e)||l.isString(e)?t._innerFun("SetResolution",d.makeParams(e)):(l.Errors.InvalidValue(t),!1)},GetFrameRate:function(){var e=m;return e._resetErr(),e._isMobileMode()?e._mobileNotSupport("Addon.Webcam.GetFrameRate"):e._innerWebcamValueFunction("GetFrameRate")},SetFrameRate:function(e){var t=m;return t._resetErr(),t._isMobileMode()?t._mobileNotSupport("Addon.Webcam.SetFrameRate"):l.isNumber(e)?m._innerFun("SetFrameRate",d.makeParams(e)):(l.Errors.InvalidValue(t),!1)},GetVideoPropertySetting:function(e){var t=m;return t._resetErr(),t._isMobileMode()?t._mobileNotSupport("Addon.Webcam.GetVideoPropertySetting"):t._innerWebcamSettingFunction("GetWebcamVideoPropertySetting",d.makeParams(e))},GetVideoPropertyMoreSetting:function(e){var t=m;return t._resetErr(),t._isMobileMode()?t._mobileNotSupport("Addon.Webcam.GetVideoPropertyMoreSetting"):t._innerWebcamMoreSettingFunction("GetWebcamVideoPropertyMoreSetting",d.makeParams(e))},SetVideoPropertySetting:function(e,t,r){var n=m;return n._resetErr(),n._isMobileMode()?n._mobileNotSupport("Addon.Webcam.SetVideoPropertySetting"):n._innerFun("SetWebcamVideoPropertySetting",d.makeParams(e,t,r))},SetVideoRotateMode:function(e){var t=m;return t._resetErr(),t._isMobileMode()?t._mobileNotSupport("Addon.Webcam.SetVideoRotateMode"):t._innerFun("SetVideoRotateMode",d.makeParams(e))},GetCameraControlPropertySetting:function(e){var t=m;return t._resetErr(),t._isMobileMode()?t._mobileNotSupport("Addon.Webcam.GetCameraControlPropertySetting"):t._innerWebcamSettingFunction("GetWebcamCameraControlSetting",d.makeParams(e))},GetCameraControlPropertyMoreSetting:function(e){var t=m;return t._resetErr(),t._isMobileMode()?t._mobileNotSupport("Addon.Webcam.GetCameraControlPropertyMoreSetting"):t._innerWebcamMoreSettingFunction("GetWebcamCameraControlMoreSetting",d.makeParams(e))},SetCameraControlPropertySetting:function(e,t,r){var n=m;return n._resetErr(),n._isMobileMode()?n._mobileNotSupport("Addon.Webcam.SetCameraControlPropertySetting"):n._innerFun("SetWebcamCameraControlPropertySetting",d.makeParams(e,t,r))}}},m.__addon=m.__addon||{},l.mix(m.__addon,e)})}),Dynamsoft.AddonReady(function(_,e){var r;_.product.bActiveXEdition&&_.DynamicLoadAddonFuns&&_.DynamicLoadAddonFuns.push(function(m){var l,e,t;if(!m.getSWebTwain()||!m.getSWebTwain().Addon)return!1;Dynamsoft.navInfoSync.bWin&&(t=!Dynamsoft.navInfo.bOSx64||Dynamsoft.navInfo.bWOW64,r=t?"DynamicWebcam_"+Dynamsoft.WebcamVerForActiveX+".dll":"DynamicWebcamx64_"+Dynamsoft.WebcamVerForActiveX+".dll"),l=m.getSWebTwain();try{l.GetAddOnVersion("webcam",r)}catch(e){}(t=m)._innerRead=function(e){var t;try{t=Dynamsoft.Lib.parse(e)}catch(e){}return t.result},t._innerWebcamValueFunctionPlugin=function(e){e=this._innerRead(e);return this._innerSetWebcamValue(e)},t._innerWebcamSettingFunctionPlugin=function(e){e=this._innerRead(e);return this._innerSetWebcamSetting(e)},t._innerWebcamMoreSettingFunctionPlugin=function(e){e=this._innerRead(e);return this._innerSetWebcamMoreSetting(e)},e={Webcam:{IsModuleInstalled:function(){var e=l.GetAddOnVersion("webcam",r);return _.setErrorString(m),""!=e},Download:function(e,t,r){function n(){return Dynamsoft.Lib.isFunction(t)&&t(),!0}function o(){return Dynamsoft.Lib.isFunction(r)&&r(m._errorCode,m._errorString),!1}return _.License.checkProductKey(m,{Webcam:!0},!0)?this.IsModuleInstalled()?n():e&&""!=e?(e=l.DownloadAddon(e),_.wrapperRet(m,e,n,o)):(Dynamsoft.Lib.Errors.Webcam_InvalidRemoteFilename(m),o()):o()},GetSourceList:function(){var e,t;return _.License.checkProductKey(m,{Webcam:!0},!0)?(e=l.GetWebcamSourceList(),t=[],_.setErrorString(m),0==m._errorCode&&(t=m._innerRead(e))&&1<t.length&&t.splice(t.length-1,1),t):[]},SelectSource:function(e){return!!_.License.checkProductKey(m,{Webcam:!0},!0)&&(e=l.SelectWebcam(e),_.setErrorString(m),e)},CloseSource:function(){m._playVideoDWT=null;var e=l.StopCapture();return _.setErrorString(m),e},GetFramePartURL:function(){var e;return this._isPlaying()?(e=l.GetDIB(-1),_.setErrorString(m),e):(_.WebcamErrors.VideoNotPlayingWhenGetURL(m),"")},GetFrameURL:function(){return""},PlayVideo:function(e,t,r,n,o){function i(){return m._playVideoDWT=null,Dynamsoft.Lib.isFunction(o)&&o(m.ErrorCode,m.ErrorString),!1}var a;return e&&e.getSWebTwain()?_.License.checkProductKey(m,{Webcam:!0},!0)?(a=e.getSWebTwain().CurrentHWND)?(m._playVideoDWT=e,setTimeout(function(){var e=l.RunWebcamCmd("PlayVideo",a,null,null,r);_.wrapperRet(m,e,n,i)},0),!0):(_.WebcamErrors.InvalidParameter(m),i()):i():(Dynamsoft.Lib.WebcamErrors.InvalidParameter(m),i())},PauseVideo:function(){return!0},StopVideo:function(){m._playVideoDWT=null;var e=l.RunWebcamCmd("StopVideo",0,null,null,null);return _.setErrorString(m),l.StopCapture(),e},CaptureImage:function(e,t){function r(){return Dynamsoft.Lib.isFunction(t)&&t(m.ErrorCode,m.ErrorString),!1}var n;return _.License.checkProductKey(m,{Webcam:!0},!0)?(n=l.RunWebcamCmd("Capture",0,function(){_.isFunction(e)&&setTimeout(e,0),_.License.isLTS()&&Dynamsoft.DWT.lcvrf(m)},r,null),_.setErrorString(m),n):r()},GetMediaType:function(){var e=m._innerWebcamValueFunctionPlugin(l.GetMediaType());return _.setErrorString(m),e},SetMediaType:function(e){return _.isString(e)?(e=l.SetMediaType(e),_.setErrorString(m),e):(_.Errors.InvalidValue(m),!1)},GetResolution:function(){var e=m._innerWebcamValueFunctionPlugin(l.GetResolution());if(_.setErrorString(m),e&&e._resultlist){var t,r,n=e._resultlist,o=[],i=[];for(0<n.length&&(r=n[n.length-1]),t=0;t<n.length-1;t++){for(var a,u=(a=n[t]).toLowerCase().split("x"),s=(d=c=s=void 0,{value:a,p1:parseInt(u[0]),p2:parseInt(u[1])}),c=o,d=c.length-1;0<=d&&c[d].p1>=s.p1&&!(c[d].p1==s.p1&&c[d].p2<s.p2);)c[d+1]=c[d],d--;c[d+1]=s}for(t=0;t<o.length;t++)a=o[t].value,i.push(a);r&&i.push(r),e._resultlist=i,i=o=null}return e},SetResolution:function(e){return _.isNumber(e)||_.isString(e)?(e=l.SetResolution(e),_.setErrorString(m),e):(_.Errors.InvalidValue(m),!1)},GetFrameRate:function(){var e=m._innerWebcamValueFunctionPlugin(l.GetFrameRate());return _.setErrorString(m),e},SetFrameRate:function(e){return _.isNumber(e)?(e=l.SetFrameRate(e),_.setErrorString(m),e):(_.Errors.InvalidValue(m),!1)},GetVideoPropertySetting:function(e){e=l.GetWebcamVideoPropertySetting(e);return _.setErrorString(m),m._innerWebcamSettingFunctionPlugin(e)},GetVideoPropertyMoreSetting:function(e){e=l.GetWebcamVideoPropertyMoreSetting(e);return _.setErrorString(m),m._innerWebcamMoreSettingFunctionPlugin(e)},SetVideoPropertySetting:function(e,t,r){e=l.SetWebcamVideoPropertySetting(e,t,r);return _.setErrorString(m),e},SetVideoRotateMode:function(e){e=l.SetVideoRotateMode(e);return _.setErrorString(m),e},GetCameraControlPropertySetting:function(e){e=l.GetWebcamCameraControlSetting(e);return _.setErrorString(m),m._innerWebcamSettingFunctionPlugin(e)},GetCameraControlPropertyMoreSetting:function(e){e=l.GetWebcamCameraControlMoreSetting(e);return _.setErrorString(m),m._innerWebcamMoreSettingFunctionPlugin(e)},SetCameraControlPropertySetting:function(e,t,r){e=l.SetWebcamCameraControlPropertySetting(e,t,r);return _.setErrorString(m),e},_isPlaying:function(){return!!m._playVideoDWT}}},m.Addon=m.Addon||{},_.mix(m.Addon,e)})}); 
/*! 20230105181553
* Dynamsoft JavaScript Library
* Product: Dynamsoft Web Twain
* Web Site: https://www.dynamsoft.com
*
* Copyright 2023, Dynamsoft Corporation
* Author: Dynamsoft Support Team
*
* Module: Upload
* Version: 18.1
* 
*/
var Dynamsoft=window.Dynamsoft||{};!function(e){e.DWT||(e.DWT={}),e.Lib||(e.Lib={})}(Dynamsoft),Dynamsoft.aryAddonReadyFun=Dynamsoft.aryAddonReadyFun||[],Dynamsoft.AddonReady=Dynamsoft.AddonReady||function(e){Dynamsoft.aryAddonReadyFun.push(e)},Dynamsoft.AddonReady(function(u,e){Dynamsoft.DWT.EnumTransferErrorCode={TRANS_OK:0,TRANS_URL_MALFFORMAT:1,TRANS_FAILED_RESOLVE_PROXY:2,TRANS_FAILED_RESOLVE_HOST:3,TRANS_FAILED_CONNECT:4,TRANS_REMOTE_ACCESS_DENIED:5,TRANS_PARTIAL_FILE:6,TRANS_UPLOAD_FAILED:7,TRANS_READ_FAILED:8,TRANS_OUT_OF_MEMORY:9,TRANS_REMOTE_FULL_DISK:10,TRANS_OPERATION_TIMEOUT:11,TRANS_SERVICE_ERROR_404:12,TRANS_SERVICE_ERROR_500:13,TRANS_SERVICE_ERROR_503:14,TRANS_SERVICE_ERROR:15,TRANS_NOT_SEND:16,TRANS_WAITFOR_SEND:17,TRANS_SENDING:18,TRANS_PAUSE:19,TRANS_FINISHED:20,TRANS_NULL_POINTER:21,TRANS_INVALID_ID:22,TRANS_Failed:23,TRANS_SERVICE_ERROR_MORE_THAN_500:24,TRANS_SERVICE_ERROR_LESS_THAN_200:25,TRANS_SERVICE_ERROR_MORE_THAN_300:26,TRANS_CANNOT_FINDFILE:27,TRANS_ABORT:28,TRANS_NOT_FINISHED:29,TRANS_TASK_PREPARE_INIT:30,TRANS_TASK_INIT:31,TRANS_BEYOND_MAXSIZE:32};function r(){var e,n=!1,t=Dynamsoft.navInfoSync.bMobile;return Dynamsoft.DWT&&(n=!1===Dynamsoft.Lib.product.UseLocalService),Dynamsoft.navInfo&&(e=Dynamsoft.navInfo,t=t||e.bPad||e.biPhone||e.biPad),n||t}var f=Dynamsoft,a=Dynamsoft.dcp,i=[1,7,2,"1026"],c="upload_"+i.join(""),n={Version:"1.0",HttpVersion:"1.1",ServerUrl:"",FileName:"",VERIFYPEER:!1,VERIFYHOST:!1,BlockSize:10240,ThreadNum:1,OnUploadTransferPercentage:function(e,n){},OnRunSuccess:function(e){},OnRunFailure:function(e,n,t){}},p=0,m="",l=function(){p=-1,m="The zip file that contains the upload library (.dll) is invalid."},F=function(){p=-2,m="Upload failed because the url to upload to is invalid."},d=function(e,n,t){p=-3,e?m="Upload cancelled.":(m=n&&""!=n?"Upload failed with error: "+n:"Upload failed.",n&&""!=n&&(m=m+"("+t+")"))},E=function(){p=-4,m="Upload failed because the file to upload has invalid content."},t=function(){p=-5,m="Invalid upload job id."},R=function(){p=-6,m="Cannot create an upload job."},S=function(){p=-7,m="The file name is incorrect in the upload job."},o=function(){p=-8,m="Can not cancel all jobs when at least one job is still being created."},s=function(){p=-9,m="The zip file that contains the upload library (.dll) download failed."},T=function(){p=-2400,m="File uploader addon doesn't work under current settings."},D=function(){p=0,m=""};function _(){}function y(e){this.job=e}function U(e){this.job=e}_.prototype={runWaiting:0,CreateJob:function(){var e={HttpHeader:{},documents:[],formFields:[],bEvent:!1};return u.mix(e,n),e.SourceValue=new y(e),e.FormField=new U(e),e},Run:function(o){var e,r=this,n='""',t=o.ServerUrl,a="";if(!u.isString(t)||""==t)return o.id=-1,F(),!o.bEvent&&u.isFunction(o.OnRunFailure)&&(o.bEvent=!0,o.OnRunFailure(o,p,m),o.bEvent=!1),!1;if(!o.documents||!u.isArray(o.documents)||o.documents.length<=0)return o.id=-1,E(),!o.bEvent&&u.isFunction(o.OnRunFailure)&&(o.bEvent=!0,o.OnRunFailure(o,p,m),o.bEvent=!1),!1;if(!o.ar||!o.cu){Dynamsoft.Lib.License.isLicenseMixed(null,!0)||Dynamsoft.Lib.License.reparseProductKey();var i=Dynamsoft.DWT.licenseException;if(0!=i.code)return o.id=-1,p=i.code,m=i.message,!o.bEvent&&u.isFunction(o.OnRunFailure)&&(o.bEvent=!0,o.OnRunFailure(o,p,m),o.bEvent=!1),!1;if(Dynamsoft.Lib.License.isLTS())return Dynamsoft.DWT.lglic(Dynamsoft.DWT.EnumInstance.dwt_desktop,"").then(function(e){o.ar=e.ar,o.cu=e.cu,r.Run(o)}),!0;u.product.refProductKey&&(n='"'+u.product.refProductKey+'"')}for(o.Url=t,delete o.ServerUrl,e=0;e<o.documents;e++){var l=o.documents[e];if(!u.isString(l.files)||""==l.files)return o.id=-1,S(),!o.bEvent&&u.isFunction(o.OnRunFailure)&&(o.bEvent=!0,o.OnRunFailure(o,p,m),o.bEvent=!1),!1;u.isString(l.remoteName)&&""!=l.remoteName||(l.remoteName="RemoteFile")}var i=o.SourceValue,d=(delete o.SourceValue,o.FormField),s=(delete o.FormField,u.stringify(o)),s=u.replaceAll(s,'"',"'");o.ServerUrl=t,delete o.Url,o.SourceValue=i,o.FormField=d,t=['{"id":"',1,'","method":"RunUploadFile","version":"',c,'","parameter":[',n,',"',s,'"'],o.ar&&o.cu?(a=[',"',o.ar,'","',o.cu,'",0]}'].join(""),delete o.ar,delete o.cu,t.push(a)):t.push("]}"),i=t.join(""),r.runWaiting++;return Dynamsoft.FileUploader._sendCmd("RunUploadFile",i,function(e){var n;r.runWaiting--,e&&((n=e.UploadId)&&0<n?(o.id=n,f.FileUploader.map[o.id]=o,f.FileUploader.ids.push(e.UploadId),o.OnUploadTransferPercentage&&o.OnUploadTransferPercentage(o,0)):(n=e.errorcode,e=e.errorstring,n&&e?(p=n,m=e):R(),!o.bEvent&&u.isFunction(o.OnRunFailure)&&(o.bEvent=!0,o.OnRunFailure(o,p,m),o.bEvent=!1)))},function(e,n,t){r.runWaiting--,f.FileUploader.parseHttpErrors(e,n,t),!o.bEvent&&u.isFunction(o.OnRunFailure)&&(o.bEvent=!0,o.OnRunFailure(o,p,m),o.bEvent=!1)}),!0},Cancel:function(o){var e;return!o.id||o.id<0?(t(),!o.bEvent&&u.isFunction(o.OnRunFailure)&&(o.bEvent=!0,o.OnRunFailure(o,p,m),o.bEvent=!1),!1):(e='{"id":"1","method":"DeleteUploadTask","version":"'+c+'","parameter":["'+o.id+'"]}',Dynamsoft.FileUploader._sendCmd("DeleteUploadTask",e,function(e){f.FileUploader.deleteJobById(o.id)},function(e,n,t){f.FileUploader.parseHttpErrors(e,n,t),!o.bEvent&&u.isFunction(o.OnRunFailure)&&(o.bEvent=!0,o.OnRunFailure(o,p,m),o.bEvent=!1)}),!0)},CancelAllUpload:function(){var t=f.FileUploader.ids,e='{"id":"1","method":"DeleteUploadTask","version":"'+c+'","parameter":["'+t.join(",")+'"]}';return 0<this.runWaiting?(o(),!1):(this.runWaiting<0&&(this.runWaiting=0),t.length<=0||Dynamsoft.FileUploader._sendCmd("DeleteUploadTask",e,function(e){for(var n=0;n<t.length;n++)f.FileUploader.deleteJobById(t[n]);f.FileUploader.ids=[],f.FileUploader.map=[]},function(e,n,t){f.FileUploader.parseHttpErrors(e,n,t)}),!0)},OnUploadTransferPercentage:function(e,n){},OnRunSuccess:function(e){},OnRunFailure:function(e,n,t){}},(f.SourceValue=y).prototype.Add=function(e,n,t){var o=this.job;u.isString(e)&&""!=e?(t=t||"RemoteFile",e=Dynamsoft.Lib.replaceAll(e,"\\\\","\\\\"),o.documents.push({files:[e],fileName:n,remoteName:t})):(S(),!o.bEvent&&u.isFunction(o.OnRunFailure)&&(o.bEvent=!0,o.OnRunFailure(o,p,m),o.bEvent=!1))},f.FormField=U,f.FileUploader={ids:[],map:{},port:18625,protocol:"https://",ip:"127.0.0.1",wsUrl:"",running:!(U.prototype.Add=function(e,n){var t,o,r=n,a=e;if(null==r&&(r=""),!u.isString(a)||""==a||!u.isString(r))return!1;if(r=encodeURI(r),-1<(a=encodeURI(a)).indexOf("'")||-1<r.indexOf("'"))return!1;for(t=0;t<this.job.formFields.length;t++)if((o=this.job.formFields[t]).name==a)return o.value=r,!0;return this.job.formFields.push({name:a,value:r}),!0}),ws:null,nextLoopTime:600,deleteJobById:function(e){if(D(),r())return T(),!1;var n;if(e){for(n=0;n<f.FileUploader.ids.length;n++)if(e==f.FileUploader.ids[n]){f.FileUploader.ids.splice(n,1);break}var t=f.FileUploader.map[e];for(t.SourceValue.job=null,delete t.SourceValue,t.FormField.job=null,delete t.FormField,delete f.FileUploader.map[e],n=t.documents.length-1;0<=n;n--)t.documents.splice(n,1);for(n=t.formFields.length-1;0<=n;n--)t.formFields.splice(n,1);var o='{"id":"1","method":"DeleteUploadTask","version":"'+c+'","parameter":["'+e+'"]}';Dynamsoft.FileUploader._sendCmd("DeleteUploadTask",o)}},_sendCmdByWS:function(e,n,t){var o=f.FileUploader.ws;return o&&o.readyState!=Dynamsoft.DWT.EnumDWT_WebsocketReadyState.CLOSING&&o.readyState!=Dynamsoft.DWT.EnumDWT_WebsocketReadyState.CLOSED||(o=Dynamsoft.DWT.NetManager.newWebsocket(f.FileUploader.wsUrl),f.FileUploader.ws=o),Dynamsoft.DWT.NetManager.postStringDataByWS(o,e).then(function(e){e=u.parse(e);e&&"result"in e?u.isFunction(n)&&n(e.result):u.isFunction(t)&&t()},t),!0},_sendCmd:function(e,n,t,o){return Dynamsoft.DWT.ConnectWithSocket?_sendCmdByWS(n,t,o):(e=[f.FileUploader.protocol,f.FileUploader.ip,":",f.FileUploader.port,"/dcp/",c,"/",e,"?type=1&dsver=",i.join(""),"&ts=",u.now()].join(""),u.ajax({url:e,method:"post",dataType:"json",processData:!1,data:n,onSuccess:t,onError:o}))},parseHttpErrors:function(e,n,t){var o,e=e&&u.isArray(e)&&2<e.length?(o=e[1],e[2]):(o=n,t);2==e.state&&0==e.status?"abort"===e.statusText?d(!0):F():d(!1,o,e.status)},loadHttpBlob:function(e,n,t,o,r,a,i){e={method:e,url:n,dataType:"blob",async:t,onSuccess:o,onError:function(e,n,t){f.FileUploader.parseHttpErrors(e,n,t),u.isFunction(r)&&r()}};u.isFunction(a)&&(e.beforeSend=function(e){e.addEventListener("progress",function(e){delete e.totalSize,delete e.position,a(e)},!1)}),u.ajax(e)},_OnPercentDone:function(){},Download:function(e,n,t){var o;return u.isString(e)?f.FileUploader.loadHttpBlob("get",e,!!(o=function(){return s(),u.isFunction(t)&&t(p,m),!1}),function(e){a.loadZip(e,100,n,o)},o,!1):(l(),u.isFunction(t)&&t(p,m),!1)},Init:function(e,t,n){if(D(),r())return T(),u.isFunction(n)&&n(p,m),!1;function o(){var e,n=Dynamsoft.navInfoSync.bSSL?(e="https://",Dynamsoft.dcp.SSLPort):(e="http://",Dynamsoft.dcp.Port);f.FileUploader.port=n,f.FileUploader.protocol=e,f.FileUploader.ip=Dynamsoft.DWT.Host,f.FileUploader.wsUrl=Dynamsoft.DWT.NetManager.getWsUrl(Dynamsoft.DWT.Host,n),f.FileUploader.running=!0,t(new _),setTimeout(f.FileUploader.StatusLoop,500)}Dynamsoft.dcp.detect.bConnected?o():Dynamsoft.DWT.NetManager.checkModuleManager(o,n)},Close:function(){var e;Dynamsoft.DWT.ConnectWithSocket&&(e=Dynamsoft.FileUploader.ws)&&(e.readyState!=Dynamsoft.DWT.EnumDWT_WebsocketReadyState.CLOSED&&e.readyState!=Dynamsoft.DWT.EnumDWT_WebsocketReadyState.CLOSING&&e.close(),Dynamsoft.FileUploader.ws=null),Dynamsoft.FileUploader.running=!1},VersionInfo:function(e,o){var n;return D(),r()?(T(),u.isFunction(o)&&o(p,m),!1):(n='{"id":"1","method":"VersionInfo","version":"'+c+'","parameter":[]}',Dynamsoft.FileUploader._sendCmd("VersionInfo",n,e,function(e,n,t){f.FileUploader.parseHttpErrors(e,n,t),u.isFunction(o)&&o(p,m)}),!0)},StatusLoop:function(){return D(),r()?(T(),!1):(f.FileUploader.GetUploadStatus(),f.FileUploader.running&&setTimeout(f.FileUploader.StatusLoop,f.FileUploader.nextLoopTime),!0)},GetUploadStatus:function(){if(D(),!(f.FileUploader.ids.length<=0)){if(r())return T(),!1;var e='{"id":"1","method":"GetUploadStatus","version":"'+c+'","parameter":["'+f.FileUploader.ids.join(",")+'"]}';Dynamsoft.FileUploader._sendCmd("GetUploadStatus",e,function(e){if(u.isArray(e))for(var n=0;n<e.length;n++){var t=(l=e[n]).id,o=f.FileUploader.map[t],r=l.percentage,a=l.errorcode,i=l.response,l=l.errorstring;o&&(a==Dynamsoft.DWT.EnumTransferErrorCode.TRANS_FINISHED?(o.OnUploadTransferPercentage(o,100,b(i)),!o.bEvent&&u.isFunction(o.OnRunSuccess)&&(o.bEvent=!0,o.OnRunSuccess(o,b(i)),o.bEvent=!1),f.FileUploader.deleteJobById(t)):a==Dynamsoft.DWT.EnumTransferErrorCode.TRANS_OK||a==Dynamsoft.DWT.EnumTransferErrorCode.TRANS_NOT_SEND||a==Dynamsoft.DWT.EnumTransferErrorCode.TRANS_WAITFOR_SEND||a==Dynamsoft.DWT.EnumTransferErrorCode.TRANS_SENDING||a==Dynamsoft.DWT.EnumTransferErrorCode.TRANS_PAUSE||a==Dynamsoft.DWT.EnumTransferErrorCode.TRANS_TASK_PREPARE_INIT||a==Dynamsoft.DWT.EnumTransferErrorCode.TRANS_TASK_INIT?o.OnUploadTransferPercentage(o,r,b(i)):(!o.bEvent&&u.isFunction(o.OnRunFailure)&&(o.bEvent=!0,o.OnRunFailure(o,a,l,b(i)),o.bEvent=!1),f.FileUploader.deleteJobById(t)))}},function(e,n,t){})}return!0}};var A=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);function b(e){for(var n,t,o,r,a=e.length,i=0,l="";i<a;){for(;n=A[255&e.charCodeAt(i++)],i<a&&-1==n;);if(-1==n)break;for(;t=A[255&e.charCodeAt(i++)],i<a&&-1==t;);if(-1==t)break;l+=String.fromCharCode(n<<2|(48&t)>>4);do{if(61==(o=255&e.charCodeAt(i++)))return l}while(o=A[o],i<a&&-1==o);if(-1==o)break;l+=String.fromCharCode((15&t)<<4|(60&o)>>2);do{if(61==(r=255&e.charCodeAt(i++)))return l}while(r=A[r],i<a&&-1==r);if(-1==r)break;l+=String.fromCharCode((3&o)<<6|r)}return l}}); 
// @20230103 150102
(function () {
  "use strict";
  var screenW = screen.width,
    promptDlgWidth = screenW > 550 ? 550 : (screenW - 10),
    promptDlgWidth2 = screenW > 680 ? 680 : (screenW - 10),
    reconnectTime = 0,
    imagesInBase64 = {
      icn_download: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAgCAYAAAAMq2gFAAABOklEQVRIie2WTW6DMBCFH4h1l22VqmqPVUEvEJa9gRt6FDhDpfx0FdJj+Arx3nldhEjEdchgWlaM9CSwMZ/fzMgQvX0TwvA+ePOpIsniRIwZGIl/n/8AGs3RWKB4JA4STjUKBo1EivLtGakEkP7Ru6vbpcpONzFxPFsazQloZyxEmkDepsYk0JIhkZGwzngfWRKvd0u1Pwf93k1NoBjg5uN+pbZuHn0gEFgQ2AVAdgTefQVzU9e2nzaplKbMkEhnK2W9oAOAC9IHIO+Yd5U/rJX2QbocnVSSqARuqse1Ki9BumrUp+U1gXkXRAoyBDIC1jNnCWRPG2Wug2SFrkkUnvHieaPqaxCpo3bL104rLySQviDbpNA0Sgl4W9kXfU9vjWPho+ZaHCHfo6r/kumfYUBEL1/jeJpqFBw/d5aBU2kHOMQAAAAASUVORK5CYII=',
      icn_install: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAaCAYAAACpSkzOAAAA+klEQVRIid2SMWoCQRiFv3GnW7BII6ZPqeAlorewtBELsZdFOz2Q0VYkXQ6QA9iaIqU+mx2Y3QRd12WKffCY4WdmPt5jzPRT5PQOfOSHnky6/rnoqd/cJFt/0FB6I3UkWOVmZbz+GcyjLEjgeSjRzc3KuCMxzIC8fQwsbtTxqJan/jz+r7qZ4LWC2pzbgpkDmclBAG3gO011T0U+g9Mv8PayTY4u0UIQV5jGORYsAcz4oA7wBWR+SUWJAM5Az17E6gFIGUXA2goGJR8wAK1dUuiwVdECnpQZ7cOggiWy5zCcgIkCcbCX2iUKB6pfdfVLFAwUiNS4f6QaXQHE5K75dPBEiQAAAABJRU5ErkJggg==',
      icn_scan: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAADI0lEQVRIibWXTUhUURTHf+/NsxRCp3QGwhKT/MDoAyNo1apmNhYkodGmaFOWmUXQcpgo2gRN5kerllEGLWqjBqZGFH2BlSRJRVqCjpNjYOaUc1q80fnovZmnMx34w+Odc+///u+9595zlbPPBAuWBbiBPcAOoASwR3xB4BPwAngIdOV2en+n6lA5k5zYDjQBJwCHlRECk0Ar4Mvr9AbNglQRMMFBEYZE8IjgSBKXiIJIm6Gg23PQVHHT038U24DrQL1FhamsHThl7/LOxysGYmAT6BCoT/ifDuoFOqbcHlsyYp9ATQZJF1AjcC2OOMZbh9CQacYYnPzu8tQlKrYLNP8/zkU0B1weeyxxk4AzkySqYvjfKXp6opx8IiuAr1jP05S2bQ3sL4a29zA++4/bD6xTBVwCjkwp3eGAo+WQnw1b8w1jHAIuTQRXppTuWgt1JaAA90egc9Q01K0JVGWCdHch1BTr33c/Q89Y0vAqLQxl6ZJWF8He9RAWuPURHo+nbFKqiZC3XEIFOLAB9hTqpDc/wHO/paZ5ahgwQtEqOFIGNtXYD3Boo076R+DGe3jmN441gibCNAmplKXA8QooyAb7CmgZhLlw1G9T4GgZ7HRCKAytg/DO9AI0tGlVYDhxy4cEmgdhOgSVdjizGXI03acpcKxCJ/01D1ffwdvgktNuWBV4ZeQc/QmX30BgDkpz4dxmWL0SGjbB9gKY+QNX3sLQ9LLy/bVyuE+qgQdmc5K/Es5vAWcO/A5Dlgo/QjrpyMySpjfW9qkC3QIBs9FNzsGlARj7qZNOzcHlAfgys+zTzS/QpYq+pC3JgqdCOvnLSbg4AN9m0zpW20oeeUMLNZdPhIlktdSPEFwbhIlZ8xgL8Ivgg+i1GBRoTEOFVTRu7NUrz9gq844IrWmoSYXW0l7v7YXdpUn8bjsNrAVqLO9Pa3Yv0veiJRZ78wK1Au0ZnN52gdryvvjyVjMY3Tz6y6EfvTJ0LlPlBHC6oi86vfGKzdfktgjlIlwQIbCEtQxE2pSbkQIotT1i5ou1hUebi+ijbXXEN0X00dYNdFf2e0OpOvwLFunYK2i9bNwAAAAASUVORK5CYII='
    };

  Dynamsoft.OnWebTwainNotFoundOnWindowsCallback = function (ProductName, InstallerUrl, bHTML5, bIE, bSafari, bSSL, strIEVersion, bSocketSuccess) {
    var _this = Dynamsoft,
      objUrl = {
        'default': InstallerUrl
      };
    _this._show_install_dialog(ProductName, objUrl, bHTML5, Dynamsoft.DWT.EnumDWT_PlatformType.enumWindow, bIE, bSafari, bSSL, strIEVersion, false, bSocketSuccess);
  };

  Dynamsoft.OnWebTwainNotFoundOnLinuxCallback = function (ProductName, strDebUrl, strRpmUrl, bHTML5, bIE, bSafari, bSSL, strIEVersion, iPlatform, bSocketSuccess) {
    var _this = Dynamsoft,
      objUrl = {
        'default': strDebUrl,
        'deb': strDebUrl,
        'rpm': strRpmUrl
      };
    if (!iPlatform) iPlatform = Dynamsoft.DWT.EnumDWT_PlatformType.enumLinux;
    if(iPlatform == Dynamsoft.DWT.EnumDWT_PlatformType.enumAndroid) {
      objUrl.default="intent://dynamsoft.com/#Intent;scheme=http;package=com.dynamsoft.mobilescan;end";
    }
    _this._show_install_dialog(ProductName, objUrl, bHTML5, iPlatform, bIE, bSafari, bSSL, strIEVersion, false, bSocketSuccess);
  };

  Dynamsoft.OnWebTwainNotFoundOnMacCallback = function (ProductName, InstallerUrl, bHTML5, bIE, bSafari, bSSL, strIEVersion, bSocketSuccess) {
    var _this = Dynamsoft,
      objUrl = {
        'default': InstallerUrl
      };
    _this._show_install_dialog(ProductName, objUrl, bHTML5, Dynamsoft.DWT.EnumDWT_PlatformType.enumMac, bIE, bSafari, bSSL, strIEVersion, false, bSocketSuccess);
  };
  
  Dynamsoft.DWT_ReconnectForAndroid = function () {
    Dynamsoft.DWT.CheckConnectToTheService(function (bConnected) {
      if(bConnected) {
        Dynamsoft.DWT.CloseDialog();
        Dynamsoft.DWT.ConnectToTheService();
      } else {
        setTimeout(Dynamsoft.DWT_ReconnectForAndroid, 500);
      }

    }, function () {
      setTimeout(Dynamsoft.DWT_ReconnectForAndroid, 500);
    });
  }

  Dynamsoft.dwt_change_install_url = function (url) {
    var install = document.getElementById('dwt-btn-install');
    if (install)
      install.href = url;
  };

  Dynamsoft.DWT_Reconnect = function () {
    var _this = Dynamsoft;
    if (((new Date() - reconnectTime) / 1000) > 30) {
      // change prompt
      var el = document.getElementById('dwt-btn-install');
      if (el) {
        el.innerHTML = 'Failed to connect to the service, have you run the setup?<br />If not, please run the setup and <a href="javascript:void(0)" onclick="Dynamsoft.DCP_DWT_onclickInstallButton()">click here to connect again</a>.';
      }
      return;
    }
    if (_this.DWT) {
      _this.DWT.CheckConnectToTheService(function () {
        Dynamsoft.DWT.ConnectToTheService();
      }, function () {
        if (Dynamsoft.DWT.NeedCheckWebTwainBySocket()) {
          Dynamsoft.DWT.CheckWebTwainBySocket(function () {
            Dynamsoft.OnHTTPCorsError();
          }, function () {
            setTimeout(Dynamsoft.DWT_Reconnect, 500);
          }, function () {
            setTimeout(Dynamsoft.DWT_Reconnect, 500);
          });
          return;
        }
        setTimeout(Dynamsoft.DWT_Reconnect, 500);
      });
    } else {
      console.log("The Dynamsoft namespace is missing");
    }
  };

  Dynamsoft.DCP_DWT_onclickInstallButton = function () {
    var btnInstall = document.getElementById('dwt-btn-install');
    if (btnInstall) {
      setTimeout(function () {
        var install = document.getElementById('dwt-install-url-div');
        if (install)
          install.style.display = 'none';
        var el = document.getElementById('dwt-btn-install');
        if (el && el.getAttribute("html5") == "1") {
          var pel = el.parentNode,
            newDiv = document.createElement('div');
          newDiv.id = 'dwt-btn-install';
          newDiv.style.textAlign = "center";
          newDiv.style.paddingBottom = '15px';
          newDiv.innerHTML = 'Connecting to the service...';
          newDiv.setAttribute("html5", "1");
          pel.removeChild(el);
          pel.appendChild(newDiv);
          reconnectTime = new Date();
          setTimeout(Dynamsoft.DWT_Reconnect, 10);
        } else {
          var pel = el.parentNode;
          pel.removeChild(el);
        }
      }, 10);
    }
    return true;
  };

  Dynamsoft._show_install_dialog = function (ProductName, objInstallerUrl, bHTML5, iPlatform, bIE, bSafari, bSSL, strIEVersion, bNeedUpgrade, bSocketSuccess) {
    return Dynamsoft._show_install_dialog_Detail(ProductName, objInstallerUrl, bHTML5, iPlatform, bIE, bSafari, bSSL, strIEVersion, bNeedUpgrade, bSocketSuccess);
  };

  Dynamsoft._show_install_dialog_Detail = function (ProductName, objInstallerUrl, bHTML5, iPlatform, bIE, bSafari, bSSL, strIEVersion, bNeedUpgrade, bSocketSuccess) {
    var _this = Dynamsoft,
      ObjString, title, browserActionNeeded,
      EnumPlatform = Dynamsoft.DWT.EnumDWT_PlatformType,
      bAndroid = (iPlatform == EnumPlatform.enumAndroid),
      bMobile = bAndroid,
      bUnix = (iPlatform == EnumPlatform.enumLinux || iPlatform == EnumPlatform.enumEmbed ||
        iPlatform == EnumPlatform.enumChromeOS || iPlatform == EnumPlatform.enumHarmonyOS ||
        bAndroid);

    if (Dynamsoft.DWT.bNpm && Dynamsoft.navInfoSync.bFileSystem) {
      return Dynamsoft._show_online_download_dialog(objInstallerUrl, bHTML5, iPlatform);
    }

    if (bNeedUpgrade)
      title = 'Please update your document scanning service'; //'Please follow the steps below to upgrade your local document scanning service.';
    else
      title = 'Please complete one-time setup';
    ObjString = [
      '<div class="dynamsoft-dwt-dlg-title">',
      title,
      '</div>'
    ];

    if (_this.DWT) {

      var bFirefox = Dynamsoft.navInfoSync.bFirefox;
      if (bUnix || bFirefox) {
        browserActionNeeded = 'RESTART';
      } else {
        browserActionNeeded = 'REFRESH';
      }
      ObjString.push('<div class="dynamsoft-dwt-installdlg-iconholder"> ');

      var left = '125px';
      if(bMobile) {
        left = '60px';
      }
      ObjString.push('<div class="dynamsoft-dwt-installdlg-splitline" style="left: '+left+'"></div>');

      if(!bMobile) {
        ObjString.push('<div class="dynamsoft-dwt-installdlg-splitline" style="left: 283px"></div>');
      }

      var marginRight = '133px';
      if(bMobile) {
        marginRight = '50px';
      }
      ObjString.push('<img style="margin: 0px '+marginRight+' 0px 0px" src=' + imagesInBase64.icn_download + ' alt="download">');
      ObjString.push('<img style="margin: 2px '+marginRight+' 2px 0px" src=' + imagesInBase64.icn_install + ' alt="install">');
      ObjString.push('<img src=' + imagesInBase64.icn_scan + ' alt="scan">');
      ObjString.push('<div><span class="dynamsoft-dwt-installdlg-text" style="right: 125px">Download</span>');
      ObjString.push('<span class="dynamsoft-dwt-installdlg-text" style="right: 18px">Install</span>');
      ObjString.push('<span class="dynamsoft-dwt-installdlg-text" style="left: 105px">Scan</span>');
      ObjString.push('</div>');
      ObjString.push('</div>');

      if (bHTML5 && bUnix) {
        ObjString.push('<div style="margin:10px 0 0 60px;">');
        ObjString.push('<div id="dwt-install-url-div">');

        var arm64 = Dynamsoft.navInfo.bArm64,
          mips64 = Dynamsoft.navInfo.bMips64,
          chromeOS = Dynamsoft.navInfoSync.bChromeOS,
          harmonyOS = Dynamsoft.navInfoSync.bHarmonyOS;

        if (arm64 || mips64 || chromeOS || harmonyOS || bAndroid) {} else {
          ObjString.push('<div><input id="dwt-install-url-deb" name="dwt-install-url" type="radio" onclick="Dynamsoft.dwt_change_install_url(\'' + objInstallerUrl.deb + '\')" checked="checked" /><label for="dwt-install-url-deb">64 bit .deb (For Ubuntu/Debian)</label></div>');
          ObjString.push('<div><input id="dwt-install-url-rpm" name="dwt-install-url" type="radio" onclick="Dynamsoft.dwt_change_install_url(\'' + objInstallerUrl.rpm + '\')" /><label for="dwt-install-url-rpm">64 bit .rpm (For Fedora)</label></div>');
        }
        ObjString.push('</div></div>');
      }

      ObjString.push('<div><a id="dwt-btn-install" target="_blank" href="');
      ObjString.push(objInstallerUrl['default']);
      ObjString.push('"');
      if (bHTML5) {
        ObjString.push(' html5="1"');
      } else {
        ObjString.push(' html5="0"');
      }

      ObjString.push(' onclick="Dynamsoft.DCP_DWT_onclickInstallButton()"><div class="dynamsoft-dwt-dlg-button">Download</div></a></div>');
      if (bHTML5) {
        if (bIE) {
          ObjString.push('<div class="dynamsoft-dwt-dlg-tail" style="text-align:left; padding-left: 80px">');
          ObjString.push('If you still see the dialog after installing the Dynamsoft Service, please<br />');
          ObjString.push('1. Add the website to the zone of trusted sites.<br />');
          ObjString.push('IE | Tools | Internet Options | Security | Trusted Sites.<br />');
          ObjString.push('2. Refresh your browser.');
          ObjString.push('</div>');

        } else {

          if (bUnix) {
            ObjString.push('<div class="dynamsoft-dwt-dlg-tail">');
            ObjString.push('<div class="dynamsoft-dwt-dlg-red">After the installation, please <strong>' + browserActionNeeded + '</strong>  your browser.</div>');
            ObjString.push('</div>');
          } else if (bAndroid) {

            ObjString.push('<div class="dynamsoft-dwt-dlg-tail">');
            ObjString.push('<div class="dynamsoft-dwt-dlg">Failed to connect to the service, have you finished the setup?</div>');
            ObjString.push('<div class="dynamsoft-dwt-dlg">Please make sure the setup is done and <a href="#">click here</a> to connect again.</div>');
            ObjString.push('<div class="dynamsoft-dwt-dlg">If the connection continues to fail, please refer to <a href="#">this article</a>.</div>');
            ObjString.push('</div>');

          }

        }

      } else {
        ObjString.push('<div class="dynamsoft-dwt-dlg-tail" style="text-align:left; padding-left: 80px">');
        if (bIE) {
          ObjString.push('After the installation, please<br />');
          ObjString.push('1. Restart the browser<br />');
          ObjString.push('2. Allow "DynamicWebTWAIN" add-on to run by right clicking on the Information Bar in the browser.');
        } else {
          ObjString.push('<div class="dynamsoft-dwt-dlg-red">After installation, please <strong>REFRESH</strong> your browser.</div>');
        }
        ObjString.push('</div>');
      }
      _this.DWT.ShowMessage(ObjString.join(''), {
        width: promptDlgWidth,
        headerStyle: 1
      });
    } else {
      console.log("The Dynamsoft namespace is missing");
    }

    if (Dynamsoft.DWT && Dynamsoft.DWT.OnWebTwainNotFound) {
      Dynamsoft.DWT.OnWebTwainNotFound();
    }
  };

  Dynamsoft._show_android_install_dialog = function (objInstallerUrl) {
    var ObjString;

    if (Dynamsoft.DWT.bNpm && Dynamsoft.navInfoSync.bFileSystem) {
      return Dynamsoft._show_online_download_dialog(objInstallerUrl, bHTML5, iPlatform);
    }

    ObjString = [];

    if (Dynamsoft.DWT) {

      ObjString.push('<div class="ds-dwt-ui-dlg-android">');

      ObjString.push('<div>Please download and install the <strong>DYNAMSOFT SERVICE</strong> app via the </div>');

      ObjString.push('<div><a target="_blank" href="');
      ObjString.push(objInstallerUrl['default']);
      ObjString.push('" onclick="Dynamsoft.DWT_ReconnectForAndroid()">direct APK download link</a>.</div>');
      ObjString.push('</div>');

      ObjString.push('<div class="dynamsoft-dwt-dlg-tail" style="text-align:left">');
      ObjString.push('If you have installed it, please click on the button below to initiate the connection.');
      
      ObjString.push('<a target="_blank" href="');
      ObjString.push(objInstallerUrl.openService);
      ObjString.push('" onclick="Dynamsoft.DWT_ReconnectForAndroid()"><div class="dynamsoft-dwt-dlg-button-android">Open Service</div></a>');
      
      ObjString.push('</div>');

      ObjString.push('</div>');

      Dynamsoft.DWT.ShowMessage(ObjString.join(''), {
        width: 335,
        headerStyle: 1,
        backgroundStyle: 1
      });
    } else {
      console.log("The Dynamsoft namespace is missing");
    }

    if (Dynamsoft.DWT && Dynamsoft.DWT.OnWebTwainNotFound) {
      Dynamsoft.DWT.OnWebTwainNotFound();
    }
  };

  Dynamsoft.OnWebTwainNeedUpgradeCallback = function (ProductName, objInstallerUrl, bHTML5, iPlatform, bIE, bSafari, bSSL, strIEVersion) {
    Dynamsoft._show_install_dialog(ProductName, objInstallerUrl, bHTML5, iPlatform, bIE, bSafari, bSSL, strIEVersion, true, true);
  };

  Dynamsoft.OnRemoteWebTwainNotFoundCallback = function (ProductName, ip, port, bSSL, bMobile) {
    var _this = Dynamsoft;
    var ObjString;

    if (bMobile) {
      ObjString = [
        '<div class="dynamsoft-dwt-dlg-tips" style="text-align:left;font-size:1.4em">',
        'Failed to connect to the Dynamsoft Service, please make sure that the certificate is valid.<br /><br />',
        '</div>'
      ];
    } else {
      ObjString = [
        '<div class="dynamsoft-dwt-dlg-tips" style="text-align:left">',
        'Failed to connect to the Dynamsoft Service.<br />',
        'Please make sure that the certificate is valid OR ',
        'If you change the Dynamsoft.DWT.Host to your own IP/domain, do not forget to update the certificate accordingly.',
        '</div>',
        '<div class="dynamsoft-dwt-dlg-tail">',
        '<div class="dynamsoft-dwt-dlg-red">After installation, please REFRESH your browser.</div></div>'
      ];
    }
    if (_this.DWT) {
      _this.DWT.ShowMessage(ObjString.join(''), {
        width: promptDlgWidth,
        headerStyle: 1
      });
    } else {
      console.log("The Dynamsoft namespace is missing");
    }
  };

  Dynamsoft.OnRemoteWebTwainNeedUpgradeCallback = function (ProductName, ip, port, bSSL) {
    var _this = Dynamsoft;
    var ObjString = [
      '<div class="dynamsoft-dwt-dlg-tips">',
      'Dynamsoft Service is outdated on the PC with IP/domain <br />',
      '"', ip, '".<br />',
      'Please open the page on that PC to download and install it.',
      '</div>',
      '<div class="dynamsoft-dwt-dlg-tail">',
      '<div class="dynamsoft-dwt-dlg-red">After installation, please REFRESH your browser.</div></div>'
    ];
    if (_this.DWT) {
      _this.DWT.ShowMessage(ObjString.join(''), {
        width: promptDlgWidth,
        headerStyle: 1
      });
    } else {
      console.log("The Dynamsoft namespace is missing");
    }
  };

  Dynamsoft.OnWebTWAINDllDownloadSuccessful = function () {
    console.log('The Web TWAIN Module was downloaded successfully!');
  };

  Dynamsoft.OnWebTWAINDllDownloadFailure = function (ProductName, errorCode, errorString) {
    var _this = Dynamsoft;
    if (_this.DWT) {
      if (errorCode == -2371 /* EnumDWT_Error.ModuleNotExists*/ ) {
        var ObjString = [
          '<div class="dynamsoft-dwt-dlg-tips">',
          errorString,
          '</div>',
          '<div class="dynamsoft-dwt-dlg-tail">',
          '<div class="dynamsoft-dwt-dlg-red">You can try <strong>REFRESHING</strong> your browser to try again. <br /> If the issue persists, please contact the website administrator.</div></div>'
        ];

        _this.DWT.ShowMessage(ObjString.join(''), {
          width: promptDlgWidth,
          headerStyle: 1
        });

      }
      return true;
    } else {
      console.log("The Dynamsoft namespace is missing");
    }
  };

  Dynamsoft.OnGetServiceUpdateStatus = function (bError, statusCode, statusString) {
    if (statusString != "Update skipped")
      console.log(statusString);
  };

  Dynamsoft.OnWebTWAINModuleDownloadManually = function (objInstallerUrl, iPlatform, bIE, bSafari, bSSL, strIEVersion) {
    var _this = Dynamsoft;
    return _this._show_install_dialog('', objInstallerUrl, true, iPlatform, bIE, bSafari, bSSL, strIEVersion, false, false);
  };

  Dynamsoft.OnLTSLicenseError = function (message) {

    var addMessage = '',
      ObjString, lexp = Dynamsoft.DWT.licenseException,
      code = 0;
    if (lexp)
      code = lexp.code;

    if (code == -2440 || // NetworkError
      code == -2441 || // Timedout
      code == -2443 || // CorsError
      code == -2446 || // LtsJsLoadError
      message.indexOf('Internet connection') > -1 ||
      message.indexOf('Storage') > -1) {

      var purchaseUrl = 'https://www.dynamsoft.com/customer/license/trialLicense?product=dwt&deploymenttype=js';
      addMessage = '<div>You can register for a free 30-day trial <a href="' + purchaseUrl + '" target="_blank" class="dynamsoft-major-color">here</a>. Make sure to select the product Dynamic Web TWAIN.</div>';
    }

    ObjString = [
      message,
      addMessage
    ];

    Dynamsoft.DWT.ShowMessage(ObjString.join(''), {
      width: promptDlgWidth2,
      headerStyle: 2
    });
  };

  Dynamsoft.OnLTSConnectionFailure = Dynamsoft.OnLTSLicenseError;
  Dynamsoft.OnLTSReturnedAnError = Dynamsoft.OnLTSLicenseError;
  Dynamsoft.OnLTSUUIDError = Dynamsoft.OnLTSLicenseError;

  Dynamsoft.OnLTSConnectionWarning = function () {

    var ObjString = [
      'Warning: You are seeing this dialog because Dynamic Web TWAIN has failed to connect to the License Tracking Server. ',
      'A cached authorization is being used, and you can continue to use the software as usual. ',
      'Please get connected to the network as soon as possible. ',
      Dynamsoft.DWT.isPublicLicense() ? '<a class="dynamsoft-major-color" href="https://www.dynamsoft.com/company/contact/">Contact Dynamsoft</a> ' : 'Contact the site administrator ',
      'for more information.'
    ].join('');

    Dynamsoft.DWT.ShowMessage(ObjString, {
      width: promptDlgWidth2,
      caption: 'Warning',
      headerStyle: 2
    });
  };

  Dynamsoft.OnLTSPublicLicenseMessage = function (message) {

    Dynamsoft.DWT.ShowMessage(message, {
      width: promptDlgWidth2,
      caption: 'Warning',
      headerStyle: 2
    });
  };

  Dynamsoft.OnHTTPCorsError = function () {

    var ObjString = [
      "<div>The Connection from the insecure (HTTP) web page to the local 'Dynamsoft Service' failed!</div>",
      '<div style="margin-top:10px">To fix the issue, please update your website to HTTPS or refer to <br /><a target="_blank" href="https://www.dynamsoft.com/web-twain/docs/faq/http-insecure-websites-in-chromium-browser.html?ver=latest">this article</a> for other workarounds.</div>'
    ].join('');

    Dynamsoft.DWT.ShowMessage(ObjString, {
      width: promptDlgWidth2,
      headerStyle: 2
    });
  };


  Dynamsoft.OnLicenseExpiredMessage = function (strExpiredDate, remain) {

    var ObjString,
      a_contact_us = '<a target="_blank" href="https://www.dynamsoft.com/company/contact/">contact us</a>',
      a_online_store = '<a target="_blank" href="https://www.dynamsoft.com/store/dynamic-web-twain/#DynamicWebTWAIN">online store</a>',
      a_new_key_href = 'https://www.dynamsoft.com/customer/license/trialLicense?product=dwt&utm_source=in-product';

    if (remain > 5) {

    } else if (remain > 0) { // 1~5

      var strDays;

      if (remain <= 1) {
        strDays = '1 day';
      } else {
        strDays = parseInt(remain) + ' days';
      }

      ObjString = [
        '<div style="padding:0 0 10px 0">Kindly note your trial key is expiring in ', strDays, '. Two quick steps to extend your trial:</div>',
        '<div style="margin:0 0 0 10px">1. <a target="_blank" href="', a_new_key_href, '">Request a new trial key</a> and follow the instructions to set the new key</div>',
        '<div style="margin:0 0 0 10px">2. Refresh your scan page and try again</div>',
        '<div style="padding:10px 0 0 0">If you run into any issues, please ', a_contact_us, '.</div>',
        '<div style="padding:0">If you are ready to purchase a full license, please go to the ', a_online_store, ' or ', a_contact_us, '.</div>'
      ].join('');

    } else {
      // remain<=0 Expired
      ObjString = [
        '<div style="padding:0">Sorry. Your trial key has expired on ', strExpiredDate, '. You can purchase a full license at the ', a_online_store, '.</div>',
        '<div style="padding:0">Or, you can try requesting a new trial key at <a target="_blank" href="', a_new_key_href, '">this page</a>.</div>',
        '<div style="padding:0">If you need any help, please ', a_contact_us, '.</div>'
      ].join('');

    }

    if (ObjString) {
      Dynamsoft.DWT.ShowMessage(ObjString, {
        width: promptDlgWidth2,
        caption: 'Warning',
        headerStyle: 2
      });
    }
  };

  Dynamsoft.OnLicenseError = function (message, errorCode) {

    Dynamsoft.DWT.ShowMessage(message, {
      width: promptDlgWidth2,
      headerStyle: 2
    });
    
  };

  Dynamsoft.OnSSLCertInfo = function (sslExpiredDate) {

  };

  Dynamsoft.funcConfirmRemove = function () {
    var msg = "Are you sure you want to delete this image?";
    return initConfirmDialog(msg, true, false);
  };

  Dynamsoft.funcConfirmExit = function (bExistImage) {
    var msg = " Are you sure you want to exit without saving?";
    if (bExistImage) {
      return initConfirmDialog(msg, true, false)
    } else {
      return Promise.resolve(true);
    }
  };

  Dynamsoft.funcConfirmExitAfterSave = function (bFiredByDocumentEdit) {
  };

  Dynamsoft.funcConfirmCropViewerExit = function (bChanged, previousViewerName) {
    if (previousViewerName == "mainViewer" && bChanged) {
      var msg = "Are you sure you want to exit without saving?";
      return initConfirmDialog(msg, Dynamsoft.DWT.EnumDWT_ConfirmExitType.Exit, Dynamsoft.DWT.EnumDWT_ConfirmExitType.Cancel)
    } else if (previousViewerName == "documentScanPage" && bChanged) {
      return Promise.resolve(Dynamsoft.DWT.EnumDWT_ConfirmExitType.SaveAndExit);
    } else
      return Promise.resolve(Dynamsoft.DWT.EnumDWT_ConfirmExitType.Exit);
  };

  Dynamsoft.funcConfirmMainViewerExit = function (bChanged, previousViewerName) {
    if (previousViewerName == "" && bChanged) {
      var msg = "Are you sure you want to exit without saving?";
      return initConfirmDialog(msg, Dynamsoft.DWT.EnumDWT_ConfirmExitType.Exit, Dynamsoft.DWT.EnumDWT_ConfirmExitType.Cancel)
    } else if (previousViewerName == "cropViewer" && bChanged) {
      return Promise.resolve(Dynamsoft.DWT.EnumDWT_ConfirmExitType.SaveAndExit);
    }
    return Promise.resolve(Dynamsoft.DWT.EnumDWT_ConfirmExitType.Exit);
  };

  function initConfirmDialog(title, OK, Cancel) {
    var boxStyle = 'position:fixed;top:50%;left:50%;width:260px;' +
      'transform:translate(-50%,-50%);background:#fff;z-index:999;border-radius: 5px;' +
      'overflow: hidden;';
    var btnStyle = 'flex:1;height:100%;display:flex;align-items:center;justify-content: center;font-size:14px';

    var ObjString = [
      '<div style=' + boxStyle + '>',
      '<div style="padding:20px;font-size: 16px; color:black;height:70%;text-align:center;display:flex;align-items:center">',
      title,
      '</div>',
      '<div style="height:40px;background:#f5f5f5;display:flex;border-top: solid 1px #cdcccc" >',
      '<span id="dynamsoft-confirm-dialog-yes" style="' + btnStyle + ';color:#fe8e14;border-right: solid 1px #cdcccc">OK</span>',
      '<span id="dynamsoft-confirm-dialog-no" style="' + btnStyle + '">Cancel</span></div>',
      '</div>'
    ];

    Dynamsoft.DWT.ShowDialog(500, 0, ObjString.join(''), true, true);

    return new Promise(function (resolve) {
      document.getElementById('dynamsoft-confirm-dialog-yes').addEventListener('click', function () {
        Dynamsoft.DWT.CloseDialog();
        resolve(OK); //Exit
      });
      document.getElementById('dynamsoft-confirm-dialog-no').addEventListener('click', function () {
        Dynamsoft.DWT.CloseDialog();
        resolve(Cancel); //Cancel
      })
    })

  }

  Dynamsoft.MobileNotSupportCallback = function () {
    var ObjString = [];

    if (Dynamsoft.DWT) {

      ObjString.push('<div class="ds-dwt-ui-dlg-android" style="padding-bottom:30px">');
      ObjString.push('Service Mode does not support your Operating System, please contact the site administrator.');
      ObjString.push('</div>');

      Dynamsoft.DWT.ShowMessage(ObjString.join(''), {
        width: 335,
        headerStyle: 1,
        backgroundStyle: 1
      });
    } else {
      console.log("The Dynamsoft namespace is missing");
    }

  };

  Dynamsoft.OnWebTwainNotFoundOnAndroidCallback = Dynamsoft.MobileNotSupportCallback;


  // -- npm start
  Dynamsoft._show_online_download_dialog = function (objInstallerUrl, bHTML5, iPlatform) {
    var ObjString,
      vers = Dynamsoft.DWT.JSVersion.split(','),
      strV = vers[0] + '.' + vers[1],
      page_path = location.pathname,
      online_url, local_file_path, ext;
    page_path = page_path.substring(0, page_path.lastIndexOf('/') + 1);

    if (iPlatform == Dynamsoft.DWT.EnumDWT_PlatformType.enumLinux) {
      if (arm64 || mips64) {
        if (arm64)
          objInstallerUrl['default'] = getDebPath('arm64');
        else if (mips64)
          objInstallerUrl['default'] = getDebPath('mips64el');
      } else {
      }
    }
    ext = objInstallerUrl['default'].substr(objInstallerUrl['default'].length - 3);

    online_url = ['https://www.dynamsoft.com/web-twain/install-dynamsoft-service/?productId=1000001',
      '&downloadLink=https://demo.dynamsoft.com/DWT/Resources/dist/DynamsoftServiceSetup_',
      strV, '.',
      ext].join('');

    local_file_path = Dynamsoft.Lib.Path.normalize([
      page_path,
      objInstallerUrl['default']
    ].join(''));

    if (iPlatform == Dynamsoft.DWT.EnumDWT_PlatformType.enumWindow) {
      if (local_file_path.indexOf('/') == 0) {
        local_file_path = local_file_path.substr(1);
      }
    }

    ObjString = [
      '<div class="dynamsoft-dwt-ltsdlg-body" style="padding:0 20px 20px 20px">',
      '<div>To support document scanning, please complete one-time installation of the DynamsoftServiceSetup.', ext, ' on this machine.</div>',
      '<div>You can download the file via this trust site:</div>',
      '<div><a id="dwt-btn-install" target="_blank" href="',
      online_url,
      '"><div class="dynamsoft-dwt-dlg-button">Open Site</div></a></div>',
      '<div style="word-break: break-word;">Or, go to <br />',
      local_file_path,
      ' if the file exists.</div>',
      '<div>After the installation, please <strong>REFRESH</strong>  your browser.<br /></div>',
      '</div>'
    ];

    Dynamsoft.DWT.ShowMessage(ObjString.join(''), { width: promptDlgWidth, headerStyle: 1, closeButton: false });
  };
  // -- npm end

})(); 
/**
 * Basic Configuration (config.js with differences)
 */
Dynamsoft.DWT.AutoLoad = false;
Dynamsoft.DWT.IfAddMD5InUploadHeader = false;
Dynamsoft.DWT.IfConfineMaskWithinTheViewer = false;

export default Dynamsoft;
