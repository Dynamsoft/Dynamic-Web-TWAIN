/* ! 20260205134629
* Dynamsoft JavaScript Library
* Product: Dynamic Web TWAIN
* Web Site: https://www.dynamsoft.com
*
* Copyright 2026, Dynamsoft Corporation
* Author: Dynamsoft Support Team
* Version: 19.3.1
*/function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o;}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o;},_typeof(o);}!function(){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e;}var i={},r={get exports(){return i;},set exports(e){i=e;}},n=function n(e){return e&&e.Math===Math&&e;},o=n("object"==(typeof globalThis==="undefined"?"undefined":_typeof(globalThis))&&globalThis)||n("object"==(typeof window==="undefined"?"undefined":_typeof(window))&&window)||n("object"==(typeof self==="undefined"?"undefined":_typeof(self))&&self)||n("object"==_typeof(e)&&e)||n("object"==_typeof(e)&&e)||function(){return this;}()||Function("return this")(),a=function a(e){try{return!!e();}catch(e){return!0;}},s=!a(function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype");}),l=s,u=Function.prototype,c=u.apply,h=u.call,d="object"==(typeof Reflect==="undefined"?"undefined":_typeof(Reflect))&&Reflect.apply||(l?h.bind(c):function(){return h.apply(c,arguments);}),f=s,v=Function.prototype,g=v.call,m=f&&v.bind.bind(g,g),y=f?m:function(e){return function(){return g.apply(e,arguments);};},p=y,w=p({}.toString),b=p("".slice),k=function k(e){return b(w(e),8,-1);},S=k,x=y,C=function C(e){if("Function"===S(e))return x(e);},V="object"==(typeof document==="undefined"?"undefined":_typeof(document))&&document.all,T=void 0===V&&void 0!==V?function(e){return"function"==typeof e||e===V;}:function(e){return"function"==typeof e;},I={},E=!a(function(){return 7!==Object.defineProperty({},1,{get:function get(){return 7;}})[1];}),P=s,B=Function.prototype.call,D=P?B.bind(B):function(){return B.apply(B,arguments);},M={},U={}.propertyIsEnumerable,A=Object.getOwnPropertyDescriptor,z=A&&!U.call({1:2},1);M.f=z?function(e){var t=A(this,e);return!!t&&t.enumerable;}:U;var R,N,O=function O(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t};},L=a,W=k,F=Object,H=y("".split),j=L(function(){return!F("z").propertyIsEnumerable(0);})?function(e){return"String"===W(e)?H(e,""):F(e);}:F,X=function X(e){return null==e;},Y=X,q=TypeError,Z=function Z(e){if(Y(e))throw new q("Can't call method on "+e);return e;},_=j,G=Z,K=function K(e){return _(G(e));},$=T,J=function J(e){return"object"==_typeof(e)?null!==e:$(e);},Q={},ee=Q,te=o,ie=T,re=function re(e){return ie(e)?e:void 0;},ne=function ne(e,t){return arguments.length<2?re(ee[e])||re(te[e]):ee[e]&&ee[e][t]||te[e]&&te[e][t];},oe=y({}.isPrototypeOf),ae=o.navigator,se=ae&&ae.userAgent,le=se?String(se):"",ue=o,ce=le,he=ue.process,de=ue.Deno,fe=he&&he.versions||de&&de.version,ve=fe&&fe.v8;ve&&(N=(R=ve.split("."))[0]>0&&R[0]<4?1:+(R[0]+R[1])),!N&&ce&&(!(R=ce.match(/Edge\/(\d+)/))||R[1]>=74)&&(R=ce.match(/Chrome\/(\d+)/))&&(N=+R[1]);var ge=N,me=ge,ye=a,pe=o.String,we=!!Object.getOwnPropertySymbols&&!ye(function(){var e=Symbol("symbol detection");return!pe(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&me&&me<41;}),be=we&&!Symbol.sham&&"symbol"==_typeof(Symbol.iterator),ke=ne,Se=T,xe=oe,Ce=Object,Ve=be?function(e){return"symbol"==_typeof(e);}:function(e){var t=ke("Symbol");return Se(t)&&xe(t.prototype,Ce(e));},Te=String,Ie=function Ie(e){try{return Te(e);}catch(e){return"Object";}},Ee=T,Pe=Ie,Be=TypeError,De=function De(e){if(Ee(e))return e;throw new Be(Pe(e)+" is not a function");},Me=De,Ue=X,Ae=function Ae(e,t){var i=e[t];return Ue(i)?void 0:Me(i);},ze=D,Re=T,Ne=J,Oe=TypeError,Le={},We={get exports(){return Le;},set exports(e){Le=e;}},Fe=!0,He=o,je=Object.defineProperty,Xe=o,Ye=function Ye(e,t){try{je(He,e,{value:t,configurable:!0,writable:!0});}catch(i){He[e]=t;}return t;},qe="__core-js_shared__",Ze=We.exports=Xe[qe]||Ye(qe,{});(Ze.versions||(Ze.versions=[])).push({version:"3.47.0",mode:"pure",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.47.0/LICENSE",source:"https://github.com/zloirock/core-js"});var _e=Le,Ge=function Ge(e,t){return _e[e]||(_e[e]=t||{});},Ke=Z,$e=Object,Je=function Je(e){return $e(Ke(e));},Qe=Je,et=y({}.hasOwnProperty),tt=Object.hasOwn||function(e,t){return et(Qe(e),t);},it=y,rt=0,nt=Math.random(),ot=it(1.1.toString),at=function at(e){return"Symbol("+(void 0===e?"":e)+")_"+ot(++rt+nt,36);},st=Ge,lt=tt,ut=at,ct=we,ht=be,dt=o.Symbol,ft=st("wks"),vt=ht?dt.for||dt:dt&&dt.withoutSetter||ut,gt=function gt(e){return lt(ft,e)||(ft[e]=ct&&lt(dt,e)?dt[e]:vt("Symbol."+e)),ft[e];},mt=D,yt=J,pt=Ve,wt=Ae,bt=function bt(e,t){var i,r;if("string"===t&&Re(i=e.toString)&&!Ne(r=ze(i,e)))return r;if(Re(i=e.valueOf)&&!Ne(r=ze(i,e)))return r;if("string"!==t&&Re(i=e.toString)&&!Ne(r=ze(i,e)))return r;throw new Oe("Can't convert object to primitive value");},kt=TypeError,St=gt("toPrimitive"),xt=function xt(e,t){if(!yt(e)||pt(e))return e;var i,r=wt(e,St);if(r){if(void 0===t&&(t="default"),i=mt(r,e,t),!yt(i)||pt(i))return i;throw new kt("Can't convert object to primitive value");}return void 0===t&&(t="number"),bt(e,t);},Ct=xt,Vt=Ve,Tt=function Tt(e){var t=Ct(e,"string");return Vt(t)?t:t+"";},It=J,Et=o.document,Pt=It(Et)&&It(Et.createElement),Bt=function Bt(e){return Pt?Et.createElement(e):{};},Dt=Bt,Mt=!E&&!a(function(){return 7!==Object.defineProperty(Dt("div"),"a",{get:function get(){return 7;}}).a;}),Ut=E,At=D,zt=M,Rt=O,Nt=K,Ot=Tt,Lt=tt,Wt=Mt,Ft=Object.getOwnPropertyDescriptor;I.f=Ut?Ft:function(e,t){if(e=Nt(e),t=Ot(t),Wt)try{return Ft(e,t);}catch(e){}if(Lt(e,t))return Rt(!At(zt.f,e,t),e[t]);};var Ht=a,jt=T,Xt=/#|\.prototype\./,Yt=function Yt(e,t){var i=Zt[qt(e)];return i===Gt||i!==_t&&(jt(t)?Ht(t):!!t);},qt=Yt.normalize=function(e){return String(e).replace(Xt,".").toLowerCase();},Zt=Yt.data={},_t=Yt.NATIVE="N",Gt=Yt.POLYFILL="P",Kt=Yt,$t=De,Jt=s,Qt=C(C.bind),ei=function ei(e,t){return $t(e),void 0===t?e:Jt?Qt(e,t):function(){return e.apply(t,arguments);};},ti={},ii=E&&a(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype;}),ri=J,ni=String,oi=TypeError,ai=function ai(e){if(ri(e))return e;throw new oi(ni(e)+" is not an object");},si=E,li=Mt,ui=ii,ci=ai,hi=Tt,di=TypeError,fi=Object.defineProperty,vi=Object.getOwnPropertyDescriptor,gi="enumerable",mi="configurable",yi="writable";ti.f=si?ui?function(e,t,i){if(ci(e),t=hi(t),ci(i),"function"==typeof e&&"prototype"===t&&"value"in i&&yi in i&&!i[yi]){var r=vi(e,t);r&&r[yi]&&(e[t]=i.value,i={configurable:mi in i?i[mi]:r[mi],enumerable:gi in i?i[gi]:r[gi],writable:!1});}return fi(e,t,i);}:fi:function(e,t,i){if(ci(e),t=hi(t),ci(i),li)try{return fi(e,t,i);}catch(e){}if("get"in i||"set"in i)throw new di("Accessors not supported");return"value"in i&&(e[t]=i.value),e;};var pi=ti,wi=O,bi=E?function(e,t,i){return pi.f(e,t,wi(1,i));}:function(e,t,i){return e[t]=i,e;},ki=o,Si=d,xi=C,Ci=T,Vi=I.f,Ti=Kt,Ii=Q,Ei=ei,Pi=bi,Bi=tt,Di=function Di(e){var _t2=function t(i,r,n){if(this instanceof _t2){switch(arguments.length){case 0:return new e();case 1:return new e(i);case 2:return new e(i,r);}return new e(i,r,n);}return Si(e,this,arguments);};return _t2.prototype=e.prototype,_t2;},Mi=function Mi(e,t){var i,r,n,o,a,s,l,u,c,h=e.target,d=e.global,f=e.stat,v=e.proto,g=d?ki:f?ki[h]:ki[h]&&ki[h].prototype,m=d?Ii:Ii[h]||Pi(Ii,h,{})[h],y=m.prototype;for(o in t)r=!(i=Ti(d?o:h+(f?".":"#")+o,e.forced))&&g&&Bi(g,o),s=m[o],r&&(l=e.dontCallGetSet?(c=Vi(g,o))&&c.value:g[o]),a=r&&l?l:t[o],(i||v||_typeof(s)!=_typeof(a))&&(u=e.bind&&r?Ei(a,ki):e.wrap&&r?Di(a):v&&Ci(a)?xi(a):a,(e.sham||a&&a.sham||s&&s.sham)&&Pi(u,"sham",!0),Pi(m,o,u),v&&(Bi(Ii,n=h+"Prototype")||Pi(Ii,n,{}),Pi(Ii[n],o,a),e.real&&y&&(i||!y[o])&&Pi(y,o,a)));},Ui=y([].slice),Ai=y,zi=De,Ri=J,Ni=tt,Oi=Ui,Li=s,Wi=Function,Fi=Ai([].concat),Hi=Ai([].join),ji={},Xi=Li?Wi.bind:function(e){var t=zi(this),i=t.prototype,r=Oi(arguments,1),_n2=function n(){var i=Fi(r,Oi(arguments));return this instanceof _n2?function(e,t,i){if(!Ni(ji,t)){for(var r=[],n=0;n<t;n++)r[n]="a["+n+"]";ji[t]=Wi("C,a","return new C("+Hi(r,",")+")");}return ji[t](e,i);}(t,i.length,i):t.apply(e,i);};return Ri(i)&&(_n2.prototype=i),_n2;},Yi={};Yi[gt("toStringTag")]="z";var qi="[object z]"===String(Yi),Zi=qi,_i=T,Gi=k,Ki=gt("toStringTag"),$i=Object,Ji="Arguments"===Gi(function(){return arguments;}()),Qi=Zi?Gi:function(e){var t,i,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(i=function(e,t){try{return e[t];}catch(e){}}(t=$i(e),Ki))?i:Ji?Gi(t):"Object"===(r=Gi(t))&&_i(t.callee)?"Arguments":r;},er=T,tr=Le,ir=y(Function.toString);er(tr.inspectSource)||(tr.inspectSource=function(e){return ir(e);});var rr=tr.inspectSource,nr=y,or=a,ar=T,sr=Qi,lr=rr,ur=function ur(){},cr=ne("Reflect","construct"),hr=/^\s*(?:class|function)\b/,dr=nr(hr.exec),fr=!hr.test(ur),vr=function vr(e){if(!ar(e))return!1;try{return cr(ur,[],e),!0;}catch(e){return!1;}},gr=function gr(e){if(!ar(e))return!1;switch(sr(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1;}try{return fr||!!dr(hr,lr(e));}catch(e){return!0;}};gr.sham=!0;var mr=!cr||or(function(){var e;return vr(vr.call)||!vr(Object)||!vr(function(){e=!0;})||e;})?gr:vr,yr=mr,pr=Ie,wr=TypeError,br=function br(e){if(yr(e))return e;throw new wr(pr(e)+" is not a constructor");},kr={},Sr=Math.ceil,xr=Math.floor,Cr=Math.trunc||function(e){var t=+e;return(t>0?xr:Sr)(t);},Vr=Cr,Tr=function Tr(e){var t=+e;return t!=t||0===t?0:Vr(t);},Ir=Tr,Er=Math.max,Pr=Math.min,Br=function Br(e,t){var i=Ir(e);return i<0?Er(i+t,0):Pr(i,t);},Dr=Tr,Mr=Math.min,Ur=function Ur(e){var t=Dr(e);return t>0?Mr(t,9007199254740991):0;},Ar=Ur,zr=function zr(e){return Ar(e.length);},Rr=K,Nr=Br,Or=zr,Lr=function Lr(e){return function(t,i,r){var n=Rr(t),o=Or(n);if(0===o)return!e&&-1;var a,s=Nr(r,o);if(e&&i!=i){for(;o>s;)if((a=n[s++])!=a)return!0;}else for(;o>s;s++)if((e||s in n)&&n[s]===i)return e||s||0;return!e&&-1;};},Wr={includes:Lr(!0),indexOf:Lr(!1)},Fr={},Hr=tt,jr=K,Xr=Wr.indexOf,Yr=Fr,qr=y([].push),Zr=function Zr(e,t){var i,r=jr(e),n=0,o=[];for(i in r)!Hr(Yr,i)&&Hr(r,i)&&qr(o,i);for(;t.length>n;)Hr(r,i=t[n++])&&(~Xr(o,i)||qr(o,i));return o;},_r=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Gr=Zr,Kr=_r,$r=Object.keys||function(e){return Gr(e,Kr);},Jr=E,Qr=ii,en=ti,tn=ai,rn=K,nn=$r;kr.f=Jr&&!Qr?Object.defineProperties:function(e,t){tn(e);for(var i,r=rn(t),n=nn(t),o=n.length,a=0;o>a;)en.f(e,i=n[a++],r[i]);return e;};var on,an=ne("document","documentElement"),sn=at,ln=Ge("keys"),un=function un(e){return ln[e]||(ln[e]=sn(e));},cn=ai,hn=kr,dn=_r,fn=Fr,vn=an,gn=Bt,mn="prototype",yn="script",pn=un("IE_PROTO"),wn=function wn(){},bn=function bn(e){return"<"+yn+">"+e+"</"+yn+">";},kn=function kn(e){e.write(bn("")),e.close();var t=e.parentWindow.Object;return e=null,t;},_Sn=function Sn(){try{on=new ActiveXObject("htmlfile");}catch(e){}var e,t,i;_Sn="undefined"!=typeof document?document.domain&&on?kn(on):(t=gn("iframe"),i="java"+yn+":",t.style.display="none",vn.appendChild(t),t.src=String(i),(e=t.contentWindow.document).open(),e.write(bn("document.F=Object")),e.close(),e.F):kn(on);for(var r=dn.length;r--;)delete _Sn[mn][dn[r]];return _Sn();};fn[pn]=!0;var xn=Object.create||function(e,t){var i;return null!==e?(wn[mn]=cn(e),i=new wn(),wn[mn]=null,i[pn]=e):i=_Sn(),void 0===t?i:hn.f(i,t);},Cn=Mi,Vn=d,Tn=Xi,In=br,En=ai,Pn=J,Bn=xn,Dn=a,Mn=ne("Reflect","construct"),Un=Object.prototype,An=[].push,zn=Dn(function(){function e(){}return!(Mn(function(){},[],e)instanceof e);}),Rn=!Dn(function(){Mn(function(){});}),Nn=zn||Rn;Cn({target:"Reflect",stat:!0,forced:Nn,sham:Nn},{construct:function construct(e,t){In(e),En(t);var i=arguments.length<3?e:In(arguments[2]);if(Rn&&!zn)return Mn(e,t,i);if(e===i){switch(t.length){case 0:return new e();case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);}var r=[null];return Vn(An,r,t),new(Vn(Tn,e,r))();}var n=i.prototype,o=Bn(Pn(n)?n:Un),a=Vn(e,o,t);return Pn(a)?a:o;}});var On=Q.Reflect.construct;r.exports=On;var Ln=t(i),Wn={},Fn={get exports(){return Wn;},set exports(e){Wn=e;}},Hn=k,jn=Array.isArray||function(e){return"Array"===Hn(e);},Xn=TypeError,Yn=function Yn(e){if(e>9007199254740991)throw Xn("Maximum allowed index exceeded");return e;},qn=E,Zn=ti,_n=O,Gn=function Gn(e,t,i){qn?Zn.f(e,t,_n(0,i)):e[t]=i;},Kn=jn,$n=mr,Jn=J,Qn=gt("species"),eo=Array,to=function to(e){var t;return Kn(e)&&(t=e.constructor,($n(t)&&(t===eo||Kn(t.prototype))||Jn(t)&&null===(t=t[Qn]))&&(t=void 0)),void 0===t?eo:t;},io=function io(e,t){return new(to(e))(0===t?0:t);},ro=a,no=ge,oo=gt("species"),ao=function ao(e){return no>=51||!ro(function(){var t=[];return(t.constructor={})[oo]=function(){return{foo:1};},1!==t[e](Boolean).foo;});},so=Mi,lo=a,uo=jn,co=J,ho=Je,fo=zr,vo=Yn,go=Gn,mo=io,yo=ao,po=ge,wo=gt("isConcatSpreadable"),bo=po>=51||!lo(function(){var e=[];return e[wo]=!1,e.concat()[0]!==e;}),ko=function ko(e){if(!co(e))return!1;var t=e[wo];return void 0!==t?!!t:uo(e);};so({target:"Array",proto:!0,arity:1,forced:!bo||!yo("concat")},{concat:function concat(e){var t,i,r,n,o,a=ho(this),s=mo(a,0),l=0;for(t=-1,r=arguments.length;t<r;t++)if(ko(o=-1===t?a:arguments[t]))for(n=fo(o),vo(l+n),i=0;i<n;i++,l++)i in o&&go(s,l,o[i]);else vo(l+1),go(s,l++,o);return s.length=l,s;}});var So=Qi,xo=String,Co=function Co(e){if("Symbol"===So(e))throw new TypeError("Cannot convert a Symbol value to a string");return xo(e);},Vo={},To=Zr,Io=_r.concat("length","prototype");Vo.f=Object.getOwnPropertyNames||function(e){return To(e,Io);};var Eo={},Po=k,Bo=K,Do=Vo.f,Mo=Ui,Uo="object"==(typeof window==="undefined"?"undefined":_typeof(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];Eo.f=function(e){return Uo&&"Window"===Po(e)?function(e){try{return Do(e);}catch(e){return Mo(Uo);}}(e):Do(Bo(e));};var Ao={};Ao.f=Object.getOwnPropertySymbols;var zo=bi,Ro=function Ro(e,t,i,r){return r&&r.enumerable?e[t]=i:zo(e,t,i),e;},No=ti,Oo=function Oo(e,t,i){return No.f(e,t,i);},Lo={},Wo=gt;Lo.f=Wo;var Fo,Ho,jo,Xo=Q,Yo=tt,qo=Lo,Zo=ti.f,_o=function _o(e){var t=Xo.Symbol||(Xo.Symbol={});Yo(t,e)||Zo(t,e,{value:qo.f(e)});},Go=D,Ko=ne,$o=gt,Jo=Ro,Qo=function Qo(){var e=Ko("Symbol"),t=e&&e.prototype,i=t&&t.valueOf,r=$o("toPrimitive");t&&!t[r]&&Jo(t,r,function(e){return Go(i,this);},{arity:1});},ea=Qi,ta=qi?{}.toString:function(){return"[object "+ea(this)+"]";},ia=qi,ra=ti.f,na=bi,oa=tt,aa=ta,sa=gt("toStringTag"),la=function la(e,t,i,r){var n=i?e:e&&e.prototype;n&&(oa(n,sa)||ra(n,sa,{configurable:!0,value:t}),r&&!ia&&na(n,"toString",aa));},ua=T,ca=o.WeakMap,ha=ua(ca)&&/native code/.test(String(ca)),da=o,fa=J,va=bi,ga=tt,ma=Le,ya=un,pa=Fr,wa="Object already initialized",ba=da.TypeError,ka=da.WeakMap;if(ha||ma.state){var Sa=ma.state||(ma.state=new ka());Sa.get=Sa.get,Sa.has=Sa.has,Sa.set=Sa.set,Fo=function Fo(e,t){if(Sa.has(e))throw new ba(wa);return t.facade=e,Sa.set(e,t),t;},Ho=function Ho(e){return Sa.get(e)||{};},jo=function jo(e){return Sa.has(e);};}else{var xa=ya("state");pa[xa]=!0,Fo=function Fo(e,t){if(ga(e,xa))throw new ba(wa);return t.facade=e,va(e,xa,t),t;},Ho=function Ho(e){return ga(e,xa)?e[xa]:{};},jo=function jo(e){return ga(e,xa);};}var Ca={set:Fo,get:Ho,has:jo,enforce:function enforce(e){return jo(e)?Ho(e):Fo(e,{});},getterFor:function getterFor(e){return function(t){var i;if(!fa(t)||(i=Ho(t)).type!==e)throw new ba("Incompatible receiver, "+e+" required");return i;};}},Va=ei,Ta=j,Ia=Je,Ea=zr,Pa=io,Ba=y([].push),Da=function Da(e){var t=1===e,i=2===e,r=3===e,n=4===e,o=6===e,a=7===e,s=5===e||o;return function(l,u,c,h){for(var d,f,v=Ia(l),g=Ta(v),m=Ea(g),y=Va(u,c),p=0,w=h||Pa,b=t?w(l,m):i||a?w(l,0):void 0;m>p;p++)if((s||p in g)&&(f=y(d=g[p],p,v),e))if(t)b[p]=f;else if(f)switch(e){case 3:return!0;case 5:return d;case 6:return p;case 2:Ba(b,d);}else switch(e){case 4:return!1;case 7:Ba(b,d);}return o?-1:r||n?n:b;};},Ma={forEach:Da(0),map:Da(1),filter:Da(2),some:Da(3),every:Da(4),find:Da(5),findIndex:Da(6),filterReject:Da(7)},Ua=Mi,Aa=o,za=D,Ra=y,Na=E,Oa=we,La=a,Wa=tt,Fa=oe,Ha=ai,ja=K,Xa=Tt,Ya=Co,qa=O,Za=xn,_a=$r,Ga=Vo,Ka=Eo,$a=Ao,Ja=I,Qa=ti,es=kr,ts=M,is=Ro,rs=Oo,ns=Ge,os=Fr,as=at,ss=gt,ls=Lo,us=_o,cs=Qo,hs=la,ds=Ca,fs=Ma.forEach,vs=un("hidden"),gs="Symbol",ms="prototype",ys=ds.set,ps=ds.getterFor(gs),ws=Object[ms],bs=Aa.Symbol,ks=bs&&bs[ms],Ss=Aa.RangeError,xs=Aa.TypeError,Cs=Aa.QObject,Vs=Ja.f,Ts=Qa.f,Is=Ka.f,Es=ts.f,Ps=Ra([].push),Bs=ns("symbols"),Ds=ns("op-symbols"),Ms=ns("wks"),Us=!Cs||!Cs[ms]||!Cs[ms].findChild,As=function As(e,t,i){var r=Vs(ws,t);r&&delete ws[t],Ts(e,t,i),r&&e!==ws&&Ts(ws,t,r);},zs=Na&&La(function(){return 7!==Za(Ts({},"a",{get:function get(){return Ts(this,"a",{value:7}).a;}})).a;})?As:Ts,Rs=function Rs(e,t){var i=Bs[e]=Za(ks);return ys(i,{type:gs,tag:e,description:t}),Na||(i.description=t),i;},_Ns=function Ns(e,t,i){e===ws&&_Ns(Ds,t,i),Ha(e);var r=Xa(t);return Ha(i),Wa(Bs,r)?(i.enumerable?(Wa(e,vs)&&e[vs][r]&&(e[vs][r]=!1),i=Za(i,{enumerable:qa(0,!1)})):(Wa(e,vs)||Ts(e,vs,qa(1,Za(null))),e[vs][r]=!0),zs(e,r,i)):Ts(e,r,i);},Os=function Os(e,t){Ha(e);var i=ja(t),r=_a(i).concat(Hs(i));return fs(r,function(t){Na&&!za(Ls,i,t)||_Ns(e,t,i[t]);}),e;},Ls=function Ls(e){var t=Xa(e),i=za(Es,this,t);return!(this===ws&&Wa(Bs,t)&&!Wa(Ds,t))&&(!(i||!Wa(this,t)||!Wa(Bs,t)||Wa(this,vs)&&this[vs][t])||i);},Ws=function Ws(e,t){var i=ja(e),r=Xa(t);if(i!==ws||!Wa(Bs,r)||Wa(Ds,r)){var n=Vs(i,r);return!n||!Wa(Bs,r)||Wa(i,vs)&&i[vs][r]||(n.enumerable=!0),n;}},Fs=function Fs(e){var t=Is(ja(e)),i=[];return fs(t,function(e){Wa(Bs,e)||Wa(os,e)||Ps(i,e);}),i;},Hs=function Hs(e){var t=e===ws,i=Is(t?Ds:ja(e)),r=[];return fs(i,function(e){!Wa(Bs,e)||t&&!Wa(ws,e)||Ps(r,Bs[e]);}),r;};Oa||(bs=function bs(){if(Fa(ks,this))throw new xs("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?Ya(arguments[0]):void 0,t=as(e),_i2=function i(e){var r=void 0===this?Aa:this;r===ws&&za(_i2,Ds,e),Wa(r,vs)&&Wa(r[vs],t)&&(r[vs][t]=!1);var n=qa(1,e);try{zs(r,t,n);}catch(e){if(!(e instanceof Ss))throw e;As(r,t,n);}};return Na&&Us&&zs(ws,t,{configurable:!0,set:_i2}),Rs(t,e);},is(ks=bs[ms],"toString",function(){return ps(this).tag;}),is(bs,"withoutSetter",function(e){return Rs(as(e),e);}),ts.f=Ls,Qa.f=_Ns,es.f=Os,Ja.f=Ws,Ga.f=Ka.f=Fs,$a.f=Hs,ls.f=function(e){return Rs(ss(e),e);},Na&&rs(ks,"description",{configurable:!0,get:function get(){return ps(this).description;}})),Ua({global:!0,constructor:!0,wrap:!0,forced:!Oa,sham:!Oa},{Symbol:bs}),fs(_a(Ms),function(e){us(e);}),Ua({target:gs,stat:!0,forced:!Oa},{useSetter:function useSetter(){Us=!0;},useSimple:function useSimple(){Us=!1;}}),Ua({target:"Object",stat:!0,forced:!Oa,sham:!Na},{create:function create(e,t){return void 0===t?Za(e):Os(Za(e),t);},defineProperty:_Ns,defineProperties:Os,getOwnPropertyDescriptor:Ws}),Ua({target:"Object",stat:!0,forced:!Oa},{getOwnPropertyNames:Fs}),cs(),hs(bs,gs),os[vs]=!0;var js=we&&!!Symbol.for&&!!Symbol.keyFor,Xs=Mi,Ys=ne,qs=tt,Zs=Co,_s=Ge,Gs=js,Ks=_s("string-to-symbol-registry"),$s=_s("symbol-to-string-registry");Xs({target:"Symbol",stat:!0,forced:!Gs},{for:function _for(e){var t=Zs(e);if(qs(Ks,t))return Ks[t];var i=Ys("Symbol")(t);return Ks[t]=i,$s[i]=t,i;}});var Js=Mi,Qs=tt,el=Ve,tl=Ie,il=js,rl=Ge("symbol-to-string-registry");Js({target:"Symbol",stat:!0,forced:!il},{keyFor:function keyFor(e){if(!el(e))throw new TypeError(tl(e)+" is not a symbol");if(Qs(rl,e))return rl[e];}});var nl=J,ol=Ca.get,al=y,sl=tt,ll=SyntaxError,ul=parseInt,cl=String.fromCharCode,hl=al("".charAt),dl=al("".slice),fl=al(/./.exec),vl={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":"\n","\\r":"\r","\\t":"\t"},gl=/^[\da-f]{4}$/i,ml=/^[\u0000-\u001F]$/,yl=!a(function(){var e="9007199254740993",t=JSON.rawJSON(e);return!JSON.isRawJSON(t)||JSON.stringify(t)!==e;}),pl=Mi,wl=ne,bl=d,kl=D,Sl=y,xl=a,Cl=jn,Vl=T,Tl=function Tl(e){if(!nl(e))return!1;var t=ol(e);return!!t&&"RawJSON"===t.type;},Il=Ve,El=k,Pl=Co,Bl=Ui,Dl=function Dl(e,t){for(var i=!0,r="";t<e.length;){var n=hl(e,t);if("\\"===n){var o=dl(e,t,t+2);if(sl(vl,o))r+=vl[o],t+=2;else{if("\\u"!==o)throw new ll('Unknown escape sequence: "'+o+'"');var a=dl(e,t+=2,t+4);if(!fl(gl,a))throw new ll("Bad Unicode escape at: "+t);r+=cl(ul(a,16)),t+=4;}}else{if('"'===n){i=!1,t++;break;}if(fl(ml,n))throw new ll("Bad control character in string literal at: "+t);r+=n,t++;}}if(i)throw new ll("Unterminated string at: "+t);return{value:r,end:t};},Ml=at,Ul=we,Al=yl,zl=String,Rl=wl("JSON","stringify"),Nl=Sl(/./.exec),Ol=Sl("".charAt),Ll=Sl("".charCodeAt),Wl=Sl("".replace),Fl=Sl("".slice),Hl=Sl([].push),jl=Sl(1.1.toString),Xl=/[\uD800-\uDFFF]/g,Yl=/^[\uD800-\uDBFF]$/,ql=/^[\uDC00-\uDFFF]$/,Zl=Ml(),_l=Zl.length,Gl=!Ul||xl(function(){var e=wl("Symbol")("stringify detection");return"[null]"!==Rl([e])||"{}"!==Rl({a:e})||"{}"!==Rl(Object(e));}),Kl=xl(function(){return"\"\\udf06\\ud834\""!==Rl("\uDF06\uD834")||"\"\\udead\""!==Rl("\uDEAD");}),$l=Gl?function(e,t){var i=Bl(arguments),r=Ql(t);if(Vl(r)||void 0!==e&&!Il(e))return i[1]=function(e,t){if(Vl(r)&&(t=kl(r,this,zl(e),t)),!Il(t))return t;},bl(Rl,null,i);}:Rl,Jl=function Jl(e,t,i){var r=Ol(i,t-1),n=Ol(i,t+1);return Nl(Yl,e)&&!Nl(ql,n)||Nl(ql,e)&&!Nl(Yl,r)?"\\u"+jl(Ll(e,0),16):e;},Ql=function Ql(e){if(Vl(e))return e;if(Cl(e)){for(var t=e.length,i=[],r=0;r<t;r++){var n=e[r];"string"==typeof n?Hl(i,n):"number"!=typeof n&&"Number"!==El(n)&&"String"!==El(n)||Hl(i,Pl(n));}var o=i.length,a=!0;return function(e,t){if(a)return a=!1,t;if(Cl(this))return t;for(var r=0;r<o;r++)if(i[r]===e)return t;};}};Rl&&pl({target:"JSON",stat:!0,arity:3,forced:Gl||Kl||!Al},{stringify:function stringify(e,t,i){var r=Ql(t),n=[],o=$l(e,function(e,t){var i=Vl(r)?kl(r,this,zl(e),t):t;return!Al&&Tl(i)?Zl+(Hl(n,i.rawJSON)-1):i;},i);if("string"!=typeof o)return o;if(Kl&&(o=Wl(o,Xl,Jl)),Al)return o;for(var a="",s=o.length,l=0;l<s;l++){var u=Ol(o,l);if('"'===u){var c=Dl(o,++l).end-1,h=Fl(o,l,c);a+=Fl(h,0,_l)===Zl?n[Fl(h,_l)]:'"'+h+'"',l=c;}else a+=u;}return a;}});var eu=Ao,tu=Je;Mi({target:"Object",stat:!0,forced:!we||a(function(){eu.f(1);})},{getOwnPropertySymbols:function getOwnPropertySymbols(e){var t=eu.f;return t?t(tu(e)):[];}}),_o("asyncDispose"),_o("asyncIterator"),_o("dispose"),_o("hasInstance"),_o("isConcatSpreadable"),_o("iterator"),_o("match"),_o("matchAll"),_o("replace"),_o("search"),_o("species"),_o("split");var iu=Qo;_o("toPrimitive"),iu();var ru=ne,nu=la;_o("toStringTag"),nu(ru("Symbol"),"Symbol"),_o("unscopables"),la(o.JSON,"JSON",!0);var ou,au,su,lu=Q.Symbol,uu={},cu=E,hu=tt,du=Function.prototype,fu=cu&&Object.getOwnPropertyDescriptor,vu=hu(du,"name"),gu={EXISTS:vu,PROPER:vu&&"something"===function(){}.name,CONFIGURABLE:vu&&(!cu||cu&&fu(du,"name").configurable)},mu=!a(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e())!==e.prototype;}),yu=tt,pu=T,wu=Je,bu=mu,ku=un("IE_PROTO"),Su=Object,xu=Su.prototype,Cu=bu?Su.getPrototypeOf:function(e){var t=wu(e);if(yu(t,ku))return t[ku];var i=t.constructor;return pu(i)&&t instanceof i?i.prototype:t instanceof Su?xu:null;},Vu=a,Tu=T,Iu=J,Eu=xn,Pu=Cu,Bu=Ro,Du=gt("iterator"),Mu=!1;[].keys&&("next"in(su=[].keys())?(au=Pu(Pu(su)))!==Object.prototype&&(ou=au):Mu=!0);var Uu=!Iu(ou)||Vu(function(){var e={};return ou[Du].call(e)!==e;});Tu((ou=Uu?{}:Eu(ou))[Du])||Bu(ou,Du,function(){return this;});var Au={IteratorPrototype:ou,BUGGY_SAFARI_ITERATORS:Mu},zu=Au.IteratorPrototype,Ru=xn,Nu=O,Ou=la,Lu=uu,Wu=function Wu(){return this;},Fu=function Fu(e,t,i,r){var n=t+" Iterator";return e.prototype=Ru(zu,{next:Nu(+!r,i)}),Ou(e,n,!1,!0),Lu[n]=Wu,e;},Hu=y,ju=De,Xu=J,Yu=function Yu(e){return Xu(e)||null===e;},qu=String,Zu=TypeError,_u=function _u(e,t,i){try{return Hu(ju(Object.getOwnPropertyDescriptor(e,t)[i]));}catch(e){}},Gu=J,Ku=Z,$u=function $u(e){if(Yu(e))return e;throw new Zu("Can't set "+qu(e)+" as a prototype");},Ju=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,i={};try{(e=_u(Object.prototype,"__proto__","set"))(i,[]),t=i instanceof Array;}catch(e){}return function(i,r){return Ku(i),$u(r),Gu(i)?(t?e(i,r):i.__proto__=r,i):i;};}():void 0),Qu=Mi,ec=D,tc=gu,ic=Fu,rc=Cu,nc=la,oc=Ro,ac=uu,sc=Au,lc=tc.PROPER,uc=sc.BUGGY_SAFARI_ITERATORS,cc=gt("iterator"),hc="keys",dc="values",fc="entries",vc=function vc(){return this;},gc=function gc(e,t,i,r,n,o,a){ic(i,t,r);var s,l,u,c=function c(e){if(e===n&&g)return g;if(!uc&&e&&e in f)return f[e];switch(e){case hc:case dc:case fc:return function(){return new i(this,e);};}return function(){return new i(this);};},h=t+" Iterator",d=!1,f=e.prototype,v=f[cc]||f["@@iterator"]||n&&f[n],g=!uc&&v||c(n),m="Array"===t&&f.entries||v;if(m&&(s=rc(m.call(new e())))!==Object.prototype&&s.next&&(nc(s,h,!0,!0),ac[h]=vc),lc&&n===dc&&v&&v.name!==dc&&(d=!0,g=function g(){return ec(v,this);}),n)if(l={values:c(dc),keys:o?g:c(hc),entries:c(fc)},a)for(u in l)(uc||d||!(u in f))&&oc(f,u,l[u]);else Qu({target:t,proto:!0,forced:uc||d},l);return a&&f[cc]!==g&&oc(f,cc,g,{name:n}),ac[t]=g,l;},mc=function mc(e,t){return{value:e,done:t};},yc=K,pc=function pc(){},wc=uu,bc=Ca,kc=(ti.f,gc),Sc=mc,xc="Array Iterator",Cc=bc.set,Vc=bc.getterFor(xc);kc(Array,"Array",function(e,t){Cc(this,{type:xc,target:yc(e),index:0,kind:t});},function(){var e=Vc(this),t=e.target,i=e.index++;if(!t||i>=t.length)return e.target=null,Sc(void 0,!0);switch(e.kind){case"keys":return Sc(i,!1);case"values":return Sc(t[i],!1);}return Sc([i,t[i]],!1);},"values");wc.Arguments=wc.Array;pc(),pc(),pc();var Tc={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Ic=o,Ec=la,Pc=uu;for(var Bc in Tc)Ec(Ic[Bc],Bc),Pc[Bc]=Pc.Array;var Dc=lu;!function(e){e.exports=Dc;}(Fn);var Mc=t(Wn),Uc={},Ac={get exports(){return Uc;},set exports(e){Uc=e;}};Mi({target:"Object",stat:!0,sham:!E},{create:xn});var zc=Q.Object,Rc=function Rc(e,t){return zc.create(e,t);},Nc=Rc;!function(e){e.exports=Nc;}(Ac);var Oc=t(Uc),Lc={},Wc={get exports(){return Lc;},set exports(e){Lc=e;}},Fc=Je,Hc=Cu,jc=mu;Mi({target:"Object",stat:!0,forced:a(function(){Hc(1);}),sham:!jc},{getPrototypeOf:function getPrototypeOf(e){return Hc(Fc(e));}});var Xc=Q.Object.getPrototypeOf;!function(e){e.exports=Xc;}(Wc);var Yc=t(Lc),qc={},Zc={get exports(){return qc;},set exports(e){qc=e;}};Mi({target:"Object",stat:!0},{setPrototypeOf:Ju});var _c=Q.Object.setPrototypeOf;!function(e){e.exports=_c;}(Zc);var Gc=t(qc),Kc={},$c={get exports(){return Kc;},set exports(e){Kc=e;}},Jc={},Qc={get exports(){return Jc;},set exports(e){Jc=e;}},eh=gt,th=ti.f,ih=eh("metadata"),rh=Function.prototype;void 0===rh[ih]&&th(rh,ih,{value:null}),_o("metadata");var nh=Dc,oh=y,ah=ne("Symbol"),sh=ah.keyFor,lh=oh(ah.prototype.valueOf),uh=ah.isRegisteredSymbol||function(e){try{return void 0!==sh(lh(e));}catch(e){return!1;}};Mi({target:"Symbol",stat:!0},{isRegisteredSymbol:uh});for(var ch=Ge,hh=ne,dh=y,fh=Ve,vh=gt,gh=hh("Symbol"),mh=gh.isWellKnownSymbol,yh=hh("Object","getOwnPropertyNames"),ph=dh(gh.prototype.valueOf),wh=ch("wks"),bh=0,kh=yh(gh),Sh=kh.length;bh<Sh;bh++)try{var xh=kh[bh];fh(gh[xh])&&vh(xh);}catch(e){}var Ch=function Ch(e){if(mh&&mh(e))return!0;try{for(var t=ph(e),i=0,r=yh(wh),n=r.length;i<n;i++)if(wh[r[i]]==t)return!0;}catch(e){}return!1;};Mi({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:Ch}),_o("customMatcher"),_o("observable"),Mi({target:"Symbol",stat:!0,name:"isRegisteredSymbol"},{isRegistered:uh}),Mi({target:"Symbol",stat:!0,name:"isWellKnownSymbol",forced:!0},{isWellKnown:Ch}),_o("matcher"),_o("metadataKey"),_o("patternMatch"),_o("replaceAll");var Vh=nh;!function(e){e.exports=Vh;}(Qc),function(e){e.exports=Jc;}($c);var Th=t(Kc),Ih={},Eh={get exports(){return Ih;},set exports(e){Ih=e;}},Ph={},Bh={get exports(){return Ph;},set exports(e){Ph=e;}},Dh=y,Mh=Tr,Uh=Co,Ah=Z,zh=Dh("".charAt),Rh=Dh("".charCodeAt),Nh=Dh("".slice),Oh=function Oh(e){return function(t,i){var r,n,o=Uh(Ah(t)),a=Mh(i),s=o.length;return a<0||a>=s?e?"":void 0:(r=Rh(o,a))<55296||r>56319||a+1===s||(n=Rh(o,a+1))<56320||n>57343?e?zh(o,a):r:e?Nh(o,a,a+2):n-56320+(r-55296<<10)+65536;};},Lh={codeAt:Oh(!1),charAt:Oh(!0)},Wh=Lh.charAt,Fh=Co,Hh=Ca,jh=gc,Xh=mc,Yh="String Iterator",qh=Hh.set,Zh=Hh.getterFor(Yh);jh(String,"String",function(e){qh(this,{type:Yh,string:Fh(e),index:0});},function(){var e,t=Zh(this),i=t.string,r=t.index;return r>=i.length?Xh(void 0,!0):(e=Wh(i,r),t.index+=e.length,Xh(e,!1));});var _h=Lo.f("iterator");!function(e){e.exports=_h;}(Bh),function(e){e.exports=Ph;}(Eh);var Gh=t(Ih);function Kh(e){return Kh="function"==typeof Th&&"symbol"==_typeof(Gh)?function(e){return _typeof(e);}:function(e){return e&&"function"==typeof Th&&e.constructor===Th&&e!==Th.prototype?"symbol":_typeof(e);},Kh(e);}function $h(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r;}var Jh={},Qh={get exports(){return Jh;},set exports(e){Jh=e;}},ed={},td={get exports(){return ed;},set exports(e){ed=e;}};Mi({target:"Array",stat:!0},{isArray:jn});var id=Q.Array.isArray,rd=id;!function(e){e.exports=rd;}(td),function(e){e.exports=ed;}(Qh);var nd=t(Jh);function od(e){if(nd(e))return e;}var ad={},sd={get exports(){return ad;},set exports(e){ad=e;}},ld={},ud={get exports(){return ld;},set exports(e){ld=e;}},cd=Qi,hd=Ae,dd=X,fd=uu,vd=gt("iterator"),gd=function gd(e){if(!dd(e))return hd(e,vd)||hd(e,"@@iterator")||fd[cd(e)];},md=gd;!function(e){e.exports=md;}(ud),function(e){e.exports=ld;}(sd);var yd=t(ad),pd={},wd={get exports(){return pd;},set exports(e){pd=e;}},bd={},kd={get exports(){return bd;},set exports(e){bd=e;}},Sd=D,xd=ai,Cd=Ae,Vd=function Vd(e,t,i){var r,n;xd(e);try{if(!(r=Cd(e,"return"))){if("throw"===t)throw i;return i;}r=Sd(r,e);}catch(e){n=!0,r=e;}if("throw"===t)throw i;if(n)throw r;return xd(r),i;},Td=ai,Id=Vd,Ed=uu,Pd=gt("iterator"),Bd=Array.prototype,Dd=function Dd(e){return void 0!==e&&(Ed.Array===e||Bd[Pd]===e);},Md=D,Ud=De,Ad=ai,zd=Ie,Rd=gd,Nd=TypeError,Od=function Od(e,t){var i=arguments.length<2?Rd(e):t;if(Ud(i))return Ad(Md(i,e));throw new Nd(zd(e)+" is not iterable");},Ld=ei,Wd=D,Fd=Je,Hd=function Hd(e,t,i,r){try{return r?t(Td(i)[0],i[1]):t(i);}catch(t){Id(e,"throw",t);}},jd=Dd,Xd=mr,Yd=zr,qd=Gn,Zd=Od,_d=gd,Gd=Array,Kd=function Kd(e){var t=Fd(e),i=Xd(this),r=arguments.length,n=r>1?arguments[1]:void 0,o=void 0!==n;o&&(n=Ld(n,r>2?arguments[2]:void 0));var a,s,l,u,c,h,d=_d(t),f=0;if(!d||this===Gd&&jd(d))for(a=Yd(t),s=i?new this(a):Gd(a);a>f;f++)h=o?n(t[f],f):t[f],qd(s,f,h);else for(s=i?new this():[],c=(u=Zd(t,d)).next;!(l=Wd(c,u)).done;f++)h=o?Hd(u,n,[l.value,f],!0):l.value,qd(s,f,h);return s.length=f,s;},$d=gt("iterator"),Jd=!1;try{var Qd=0,ef={next:function next(){return{done:!!Qd++};},return:function _return(){Jd=!0;}};ef[$d]=function(){return this;},Array.from(ef,function(){throw 2;});}catch(e){}var tf=function tf(e,t){try{if(!t&&!Jd)return!1;}catch(e){return!1;}var i=!1;try{var r={};r[$d]=function(){return{next:function next(){return{done:i=!0};}};},e(r);}catch(e){}return i;},rf=Kd;Mi({target:"Array",stat:!0,forced:!tf(function(e){Array.from(e);})},{from:rf});var nf=Q.Array.from,of=nf;!function(e){e.exports=of;}(kd),function(e){e.exports=bd;}(wd);var af=t(pd);function sf(e){if(void 0!==Th&&null!=yd(e)||null!=e["@@iterator"])return af(e);}var lf={},uf={get exports(){return lf;},set exports(e){lf=e;}},cf={},hf={get exports(){return cf;},set exports(e){cf=e;}},df=Mi,ff=jn,vf=mr,gf=J,mf=Br,yf=zr,pf=K,wf=Gn,bf=gt,kf=Ui,Sf=ao("slice"),xf=bf("species"),Cf=Array,Vf=Math.max;df({target:"Array",proto:!0,forced:!Sf},{slice:function slice(e,t){var i,r,n,o=pf(this),a=yf(o),s=mf(e,a),l=mf(void 0===t?a:t,a);if(ff(o)&&(i=o.constructor,(vf(i)&&(i===Cf||ff(i.prototype))||gf(i)&&null===(i=i[xf]))&&(i=void 0),i===Cf||void 0===i))return kf(o,s,l);for(r=new(void 0===i?Cf:i)(Vf(l-s,0)),n=0;s<l;s++,n++)s in o&&wf(r,n,o[s]);return r.length=n,r;}});var Tf=o,If=Q,Ef=function Ef(e,t){var i=If[e+"Prototype"],r=i&&i[t];if(r)return r;var n=Tf[e],o=n&&n.prototype;return o&&o[t];},Pf=Ef("Array","slice"),Bf=oe,Df=Pf,Mf=Array.prototype,Uf=function Uf(e){var t=e.slice;return e===Mf||Bf(Mf,e)&&t===Mf.slice?Df:t;},Af=Uf,zf=Af;!function(e){e.exports=zf;}(hf),function(e){e.exports=cf;}(uf);var Rf=t(lf);function Nf(e,t){var i;if(e){if("string"==typeof e)return $h(e,t);var r=Rf(i=Object.prototype.toString.call(e)).call(i,8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?af(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?$h(e,t):void 0;}}function Of(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function Lf(e,t){var i=void 0!==Th&&yd(e)||e["@@iterator"];if(!i){if(nd(e)||(i=Nf(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var r=0,n=function n(){};return{s:n,n:function n(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]};},e:function e(_e2){throw _e2;},f:n};}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var o,a=!0,s=!1;return{s:function s(){i=i.call(e);},n:function n(){var e=i.next();return a=e.done,e;},e:function e(_e3){s=!0,o=_e3;},f:function f(){try{a||null==i.return||i.return();}finally{if(s)throw o;}}};}var Wf={},Ff={get exports(){return Wf;},set exports(e){Wf=e;}},Hf={},jf={get exports(){return Hf;},set exports(e){Hf=e;}},Xf=Q.Object.getOwnPropertySymbols;!function(e){e.exports=Xf;}(jf),function(e){e.exports=Hf;}(Ff);var Yf=t(Wf),qf={},Zf={get exports(){return qf;},set exports(e){qf=e;}},_f={},Gf={get exports(){return _f;},set exports(e){_f=e;}},Kf=a,$f=function $f(e,t){var i=[][e];return!!i&&Kf(function(){i.call(null,t||function(){return 1;},1);});},Jf=Mi,Qf=Wr.indexOf,ev=$f,tv=C([].indexOf),iv=!!tv&&1/tv([1],1,-0)<0;Jf({target:"Array",proto:!0,forced:iv||!ev("indexOf")},{indexOf:function indexOf(e){var t=arguments.length>1?arguments[1]:void 0;return iv?tv(this,e,t)||0:Qf(this,e,t);}});var rv=Ef("Array","indexOf"),nv=oe,ov=rv,av=Array.prototype,sv=function sv(e){var t=e.indexOf;return e===av||nv(av,e)&&t===av.indexOf?ov:t;},lv=sv,uv=lv;!function(e){e.exports=uv;}(Gf),function(e){e.exports=_f;}(Zf);var cv=t(qf),hv={},dv={get exports(){return hv;},set exports(e){hv=e;}},fv={},vv={get exports(){return fv;},set exports(e){fv=e;}},gv=Je,mv=$r;Mi({target:"Object",stat:!0,forced:a(function(){mv(1);})},{keys:function keys(e){return mv(gv(e));}});var yv=Q.Object.keys,pv=yv;!function(e){e.exports=pv;}(vv),function(e){e.exports=fv;}(dv);var wv=t(hv);function bv(e,t){if(null==e)return{};var i,r,n=function(e,t){if(null==e)return{};var i,r,n={},o=wv(e);for(r=0;r<o.length;r++)i=o[r],cv(t).call(t,i)>=0||(n[i]=e[i]);return n;}(e,t);if(Yf){var o=Yf(e);for(r=0;r<o.length;r++)i=o[r],cv(t).call(t,i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i]);}return n;}var kv={},Sv={get exports(){return kv;},set exports(e){kv=e;}},xv={},Cv={get exports(){return xv;},set exports(e){xv=e;}},Vv=Xi;Mi({target:"Function",proto:!0,forced:Function.bind!==Vv},{bind:Vv});var Tv=Ef("Function","bind"),Iv=oe,Ev=Tv,Pv=Function.prototype,Bv=function Bv(e){var t=e.bind;return e===Pv||Iv(Pv,e)&&t===Pv.bind?Ev:t;},Dv=Bv,Mv=Dv;!function(e){e.exports=Mv;}(Cv),function(e){e.exports=xv;}(Sv);var Uv=t(kv),Av={},zv={get exports(){return Av;},set exports(e){Av=e;}},Rv={},Nv={get exports(){return Rv;},set exports(e){Rv=e;}},Ov=On;!function(e){e.exports=Ov;}(Nv),function(e){e.exports=Rv;}(zv);var Lv=t(Av),Wv={},Fv={get exports(){return Wv;},set exports(e){Wv=e;}},Hv={},jv={get exports(){return Hv;},set exports(e){Hv=e;}},Xv=_c;!function(e){e.exports=Xv;}(jv),function(e){e.exports=Hv;}(Fv);var Yv=t(Wv);function qv(e,t){var i;return qv=Yv?Uv(i=Yv).call(i):function(e,t){return e.__proto__=t,e;},qv(e,t);}function Zv(){if("undefined"==typeof Reflect||!Lv)return!1;if(Lv.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Lv(Boolean,[],function(){})),!0;}catch(e){return!1;}}function _v(e,t,i){var r;Zv()?_v=Uv(r=Lv).call(r):_v=function _v(e,t,i){var r=[null];r.push.apply(r,t);var n=new(Uv(Function).apply(e,r))();return i&&qv(n,i.prototype),n;};return _v.apply(null,arguments);}var Gv={},Kv={get exports(){return Gv;},set exports(e){Gv=e;}},$v={},Jv={get exports(){return $v;},set exports(e){$v=e;}},Qv=ne,eg=Vo,tg=Ao,ig=ai,rg=y([].concat),ng=Qv("Reflect","ownKeys")||function(e){var t=eg.f(ig(e)),i=tg.f;return i?rg(t,i(e)):t;},og=tt,ag=ng,sg=I,lg=ti,ug=J,cg=bi,hg=Error,dg=y("".replace),fg=String(new hg("zxcasd").stack),vg=/\n\s*at [^:]*:[^\n]*/,gg=vg.test(fg),mg=O,yg=!a(function(){var e=new Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",mg(1,7)),7!==e.stack);}),pg=bi,wg=function wg(e,t){if(gg&&"string"==typeof e&&!hg.prepareStackTrace)for(;t--;)e=dg(e,vg,"");return e;},bg=yg,kg=Error.captureStackTrace,Sg=ei,xg=D,Cg=ai,Vg=Ie,Tg=Dd,Ig=zr,Eg=oe,Pg=Od,Bg=gd,Dg=Vd,Mg=TypeError,Ug=function Ug(e,t){this.stopped=e,this.result=t;},Ag=Ug.prototype,zg=function zg(e,t,i){var r,n,o,a,s,l,u,c=i&&i.that,h=!(!i||!i.AS_ENTRIES),d=!(!i||!i.IS_RECORD),f=!(!i||!i.IS_ITERATOR),v=!(!i||!i.INTERRUPTED),g=Sg(t,c),m=function m(e){return r&&Dg(r,"normal"),new Ug(!0,e);},y=function y(e){return h?(Cg(e),v?g(e[0],e[1],m):g(e[0],e[1])):v?g(e,m):g(e);};if(d)r=e.iterator;else if(f)r=e;else{if(!(n=Bg(e)))throw new Mg(Vg(e)+" is not iterable");if(Tg(n)){for(o=0,a=Ig(e);a>o;o++)if((s=y(e[o]))&&Eg(Ag,s))return s;return new Ug(!1);}r=Pg(e,n);}for(l=d?e.next:r.next;!(u=xg(l,r)).done;){try{s=y(u.value);}catch(e){Dg(r,"throw",e);}if("object"==_typeof(s)&&s&&Eg(Ag,s))return s;}return new Ug(!1);},Rg=Co,Ng=Mi,Og=oe,Lg=Cu,Wg=Ju,Fg=function Fg(e,t,i){for(var r=ag(t),n=lg.f,o=sg.f,a=0;a<r.length;a++){var s=r[a];og(e,s)||i&&og(i,s)||n(e,s,o(t,s));}},Hg=xn,jg=bi,Xg=O,Yg=function Yg(e,t){ug(t)&&"cause"in t&&cg(e,"cause",t.cause);},qg=function qg(e,t,i,r){bg&&(kg?kg(e,t):pg(e,"stack",wg(i,r)));},Zg=zg,_g=function _g(e,t){return void 0===e?arguments.length<2?"":t:Rg(e);},Gg=gt("toStringTag"),Kg=Error,$g=[].push,_Jg=function Jg(e,t){var i,r=Og(Qg,this);Wg?i=Wg(new Kg(),r?Lg(this):Qg):(i=r?this:Hg(Qg),jg(i,Gg,"Error")),void 0!==t&&jg(i,"message",_g(t)),qg(i,_Jg,i.stack,1),arguments.length>2&&Yg(i,arguments[2]);var n=[];return Zg(e,$g,{that:n}),jg(i,"errors",n),i;};Wg?Wg(_Jg,Kg):Fg(_Jg,Kg,{name:!0});var Qg=_Jg.prototype=Hg(Kg.prototype,{constructor:Xg(1,_Jg),message:Xg(1,""),name:Xg(1,"AggregateError")});Ng({global:!0,constructor:!0,arity:2},{AggregateError:_Jg});var em,tm,im,rm,nm=o,om=le,am=k,sm=function sm(e){return om.slice(0,e.length)===e;},lm=sm("Bun/")?"BUN":sm("Cloudflare-Workers")?"CLOUDFLARE":sm("Deno/")?"DENO":sm("Node.js/")?"NODE":nm.Bun&&"string"==typeof Bun.version?"BUN":nm.Deno&&"object"==_typeof(Deno.version)?"DENO":"process"===am(nm.process)?"NODE":nm.window&&nm.document?"BROWSER":"REST",um="NODE"===lm,cm=ne,hm=Oo,dm=E,fm=gt("species"),vm=function vm(e){var t=cm(e);dm&&t&&!t[fm]&&hm(t,fm,{configurable:!0,get:function get(){return this;}});},gm=oe,mm=TypeError,ym=function ym(e,t){if(gm(t,e))return e;throw new mm("Incorrect invocation");},pm=ai,wm=br,bm=X,km=gt("species"),Sm=function Sm(e,t){var i,r=pm(e).constructor;return void 0===r||bm(i=pm(r)[km])?t:wm(i);},xm=TypeError,Cm=function Cm(e,t){if(e<t)throw new xm("Not enough arguments");return e;},Vm=/(?:ipad|iphone|ipod).*applewebkit/i.test(le),Tm=o,Im=d,Em=ei,Pm=T,Bm=tt,Dm=a,Mm=an,Um=Ui,Am=Bt,zm=Cm,Rm=Vm,Nm=um,Om=Tm.setImmediate,Lm=Tm.clearImmediate,Wm=Tm.process,Fm=Tm.Dispatch,Hm=Tm.Function,jm=Tm.MessageChannel,Xm=Tm.String,Ym=0,qm={},Zm="onreadystatechange";Dm(function(){em=Tm.location;});var _m=function _m(e){if(Bm(qm,e)){var t=qm[e];delete qm[e],t();}},Gm=function Gm(e){return function(){_m(e);};},Km=function Km(e){_m(e.data);},$m=function $m(e){Tm.postMessage(Xm(e),em.protocol+"//"+em.host);};Om&&Lm||(Om=function Om(e){zm(arguments.length,1);var t=Pm(e)?e:Hm(e),i=Um(arguments,1);return qm[++Ym]=function(){Im(t,void 0,i);},tm(Ym),Ym;},Lm=function Lm(e){delete qm[e];},Nm?tm=function tm(e){Wm.nextTick(Gm(e));}:Fm&&Fm.now?tm=function tm(e){Fm.now(Gm(e));}:jm&&!Rm?(rm=(im=new jm()).port2,im.port1.onmessage=Km,tm=Em(rm.postMessage,rm)):Tm.addEventListener&&Pm(Tm.postMessage)&&!Tm.importScripts&&em&&"file:"!==em.protocol&&!Dm($m)?(tm=$m,Tm.addEventListener("message",Km,!1)):tm=Zm in Am("script")?function(e){Mm.appendChild(Am("script"))[Zm]=function(){Mm.removeChild(this),_m(e);};}:function(e){setTimeout(Gm(e),0);});var Jm={set:Om,clear:Lm},Qm=o,ey=E,ty=Object.getOwnPropertyDescriptor,iy=function iy(e){if(!ey)return Qm[e];var t=ty(Qm,e);return t&&t.value;},ry=function ry(){this.head=null,this.tail=null;};ry.prototype={add:function add(e){var t={item:e,next:null},i=this.tail;i?i.next=t:this.head=t,this.tail=t;},get:function get(){var e=this.head;if(e)return null===(this.head=e.next)&&(this.tail=null),e.item;}};var ny,oy,ay,sy,ly,uy=ry,cy=/ipad|iphone|ipod/i.test(le)&&"undefined"!=typeof Pebble,hy=/web0s(?!.*chrome)/i.test(le),dy=o,fy=iy,vy=ei,gy=Jm.set,my=uy,yy=Vm,py=cy,wy=hy,by=um,ky=dy.MutationObserver||dy.WebKitMutationObserver,Sy=dy.document,xy=dy.process,Cy=dy.Promise,Vy=fy("queueMicrotask");if(!Vy){var Ty=new my(),Iy=function Iy(){var e,t;for(by&&(e=xy.domain)&&e.exit();t=Ty.get();)try{t();}catch(e){throw Ty.head&&ny(),e;}e&&e.enter();};yy||by||wy||!ky||!Sy?!py&&Cy&&Cy.resolve?((sy=Cy.resolve(void 0)).constructor=Cy,ly=vy(sy.then,sy),ny=function ny(){ly(Iy);}):by?ny=function ny(){xy.nextTick(Iy);}:(gy=vy(gy,dy),ny=function ny(){gy(Iy);}):(oy=!0,ay=Sy.createTextNode(""),new ky(Iy).observe(ay,{characterData:!0}),ny=function ny(){ay.data=oy=!oy;}),Vy=function Vy(e){Ty.head||ny(),Ty.add(e);};}var Ey=Vy,Py=function Py(e){try{return{error:!1,value:e()};}catch(e){return{error:!0,value:e};}},By=o.Promise,Dy=o,My=By,Uy=T,Ay=Kt,zy=rr,Ry=gt,Ny=lm,Oy=ge,Ly=My&&My.prototype,Wy=Ry("species"),Fy=!1,Hy=Uy(Dy.PromiseRejectionEvent),jy=Ay("Promise",function(){var e=zy(My),t=e!==String(My);if(!t&&66===Oy)return!0;if(!Ly.catch||!Ly.finally)return!0;if(!Oy||Oy<51||!/native code/.test(e)){var i=new My(function(e){e(1);}),r=function r(e){e(function(){},function(){});};if((i.constructor={})[Wy]=r,!(Fy=i.then(function(){})instanceof r))return!0;}return!(t||"BROWSER"!==Ny&&"DENO"!==Ny||Hy);}),Xy={CONSTRUCTOR:jy,REJECTION_EVENT:Hy,SUBCLASSING:Fy},Yy={},qy=De,Zy=TypeError,_y=function _y(e){var t,i;this.promise=new e(function(e,r){if(void 0!==t||void 0!==i)throw new Zy("Bad Promise constructor");t=e,i=r;}),this.resolve=qy(t),this.reject=qy(i);};Yy.f=function(e){return new _y(e);};var Gy,Ky,$y,Jy=Mi,Qy=um,ep=o,tp=Q,ip=D,rp=Ro,np=la,op=vm,ap=De,sp=T,lp=J,up=ym,cp=Sm,hp=Jm.set,dp=Ey,fp=function fp(e,t){try{1===arguments.length?console.error(e):console.error(e,t);}catch(e){}},vp=Py,gp=uy,mp=Ca,yp=By,pp=Xy,wp=Yy,bp="Promise",kp=pp.CONSTRUCTOR,Sp=pp.REJECTION_EVENT,xp=mp.getterFor(bp),Cp=mp.set,Vp=yp&&yp.prototype,Tp=yp,Ip=Vp,Ep=ep.TypeError,Pp=ep.document,Bp=ep.process,Dp=wp.f,Mp=Dp,Up=!!(Pp&&Pp.createEvent&&ep.dispatchEvent),Ap="unhandledrejection",zp=function zp(e){var t;return!(!lp(e)||!sp(t=e.then))&&t;},Rp=function Rp(e,t){var i,r,n,o=t.value,a=1===t.state,s=a?e.ok:e.fail,l=e.resolve,u=e.reject,c=e.domain;try{s?(a||(2===t.rejection&&Fp(t),t.rejection=1),!0===s?i=o:(c&&c.enter(),i=s(o),c&&(c.exit(),n=!0)),i===e.promise?u(new Ep("Promise-chain cycle")):(r=zp(i))?ip(r,i,l,u):l(i)):u(o);}catch(e){c&&!n&&c.exit(),u(e);}},Np=function Np(e,t){e.notified||(e.notified=!0,dp(function(){for(var i,r=e.reactions;i=r.get();)Rp(i,e);e.notified=!1,t&&!e.rejection&&Lp(e);}));},Op=function Op(e,t,i){var r,n;Up?((r=Pp.createEvent("Event")).promise=t,r.reason=i,r.initEvent(e,!1,!0),ep.dispatchEvent(r)):r={promise:t,reason:i},!Sp&&(n=ep["on"+e])?n(r):e===Ap&&fp("Unhandled promise rejection",i);},Lp=function Lp(e){ip(hp,ep,function(){var t,i=e.facade,r=e.value;if(Wp(e)&&(t=vp(function(){Qy?Bp.emit("unhandledRejection",r,i):Op(Ap,i,r);}),e.rejection=Qy||Wp(e)?2:1,t.error))throw t.value;});},Wp=function Wp(e){return 1!==e.rejection&&!e.parent;},Fp=function Fp(e){ip(hp,ep,function(){var t=e.facade;Qy?Bp.emit("rejectionHandled",t):Op("rejectionhandled",t,e.value);});},Hp=function Hp(e,t,i){return function(r){e(t,r,i);};},jp=function jp(e,t,i){e.done||(e.done=!0,i&&(e=i),e.value=t,e.state=2,Np(e,!0));},_Xp=function Xp(e,t,i){if(!e.done){e.done=!0,i&&(e=i);try{if(e.facade===t)throw new Ep("Promise can't be resolved itself");var r=zp(t);r?dp(function(){var i={done:!1};try{ip(r,t,Hp(_Xp,i,e),Hp(jp,i,e));}catch(t){jp(i,t,e);}}):(e.value=t,e.state=1,Np(e,!1));}catch(t){jp({done:!1},t,e);}}};kp&&(Ip=(Tp=function Tp(e){up(this,Ip),ap(e),ip(Gy,this);var t=xp(this);try{e(Hp(_Xp,t),Hp(jp,t));}catch(e){jp(t,e);}}).prototype,(Gy=function Gy(e){Cp(this,{type:bp,done:!1,notified:!1,parent:!1,reactions:new gp(),rejection:!1,state:0,value:null});}).prototype=rp(Ip,"then",function(e,t){var i=xp(this),r=Dp(cp(this,Tp));return i.parent=!0,r.ok=!sp(e)||e,r.fail=sp(t)&&t,r.domain=Qy?Bp.domain:void 0,0===i.state?i.reactions.add(r):dp(function(){Rp(r,i);}),r.promise;}),Ky=function Ky(){var e=new Gy(),t=xp(e);this.promise=e,this.resolve=Hp(_Xp,t),this.reject=Hp(jp,t);},wp.f=Dp=function Dp(e){return e===Tp||e===$y?new Ky(e):Mp(e);}),Jy({global:!0,constructor:!0,wrap:!0,forced:kp},{Promise:Tp}),$y=tp.Promise,np(Tp,bp,!1,!0),op(bp);var Yp=By,qp=Xy.CONSTRUCTOR||!tf(function(e){Yp.all(e).then(void 0,function(){});}),Zp=D,_p=De,Gp=Yy,Kp=Py,$p=zg;Mi({target:"Promise",stat:!0,forced:qp},{all:function all(e){var t=this,i=Gp.f(t),r=i.resolve,n=i.reject,o=Kp(function(){var i=_p(t.resolve),o=[],a=0,s=1;$p(e,function(e){var l=a++,u=!1;s++,Zp(i,t,e).then(function(e){u||(u=!0,o[l]=e,--s||r(o));},n);}),--s||r(o);});return o.error&&n(o.value),i.promise;}});var Jp=Mi,Qp=Xy.CONSTRUCTOR;By&&By.prototype,Jp({target:"Promise",proto:!0,forced:Qp,real:!0},{catch:function _catch(e){return this.then(void 0,e);}});var ew=D,tw=De,iw=Yy,rw=Py,nw=zg;Mi({target:"Promise",stat:!0,forced:qp},{race:function race(e){var t=this,i=iw.f(t),r=i.reject,n=rw(function(){var n=tw(t.resolve);nw(e,function(e){ew(n,t,e).then(i.resolve,r);});});return n.error&&r(n.value),i.promise;}});var ow=Yy;Mi({target:"Promise",stat:!0,forced:Xy.CONSTRUCTOR},{reject:function reject(e){var t=ow.f(this);return(0,t.reject)(e),t.promise;}});var aw=ai,sw=J,lw=Yy,uw=function uw(e,t){if(aw(e),sw(t)&&t.constructor===e)return t;var i=lw.f(e);return(0,i.resolve)(t),i.promise;},cw=Mi,hw=By,dw=Xy.CONSTRUCTOR,fw=uw,vw=ne("Promise"),gw=!dw;cw({target:"Promise",stat:!0,forced:true},{resolve:function resolve(e){return fw(gw&&this===vw?hw:this,e);}});var mw=D,yw=De,pw=Yy,ww=Py,bw=zg;Mi({target:"Promise",stat:!0,forced:qp},{allSettled:function allSettled(e){var t=this,i=pw.f(t),r=i.resolve,n=i.reject,o=ww(function(){var i=yw(t.resolve),n=[],o=0,a=1;bw(e,function(e){var s=o++,l=!1;a++,mw(i,t,e).then(function(e){l||(l=!0,n[s]={status:"fulfilled",value:e},--a||r(n));},function(e){l||(l=!0,n[s]={status:"rejected",reason:e},--a||r(n));});}),--a||r(n);});return o.error&&n(o.value),i.promise;}});var kw=D,Sw=De,xw=ne,Cw=Yy,Vw=Py,Tw=zg,Iw="No one promise resolved";Mi({target:"Promise",stat:!0,forced:qp},{any:function any(e){var t=this,i=xw("AggregateError"),r=Cw.f(t),n=r.resolve,o=r.reject,a=Vw(function(){var r=Sw(t.resolve),a=[],s=0,l=1,u=!1;Tw(e,function(e){var c=s++,h=!1;l++,kw(r,t,e).then(function(e){h||u||(u=!0,n(e));},function(e){h||u||(h=!0,a[c]=e,--l||o(new i(a,Iw)));});}),--l||o(new i(a,Iw));});return a.error&&o(a.value),r.promise;}});var Ew=Mi,Pw=d,Bw=Ui,Dw=Yy,Mw=De,Uw=Py,Aw=o.Promise,zw=!1;Ew({target:"Promise",stat:!0,forced:!Aw||!Aw.try||Uw(function(){Aw.try(function(e){zw=8===e;},8);}).error||!zw},{try:function _try(e){var t=arguments.length>1?Bw(arguments,1):[],i=Dw.f(this),r=Uw(function(){return Pw(Mw(e),void 0,t);});return(r.error?i.reject:i.resolve)(r.value),i.promise;}});var Rw=Yy;Mi({target:"Promise",stat:!0},{withResolvers:function withResolvers(){var e=Rw.f(this);return{promise:e.promise,resolve:e.resolve,reject:e.reject};}});var Nw=Mi,Ow=By,Lw=a,Ww=ne,Fw=T,Hw=Sm,jw=uw,Xw=Ow&&Ow.prototype;Nw({target:"Promise",proto:!0,real:!0,forced:!!Ow&&Lw(function(){Xw.finally.call({then:function then(){}},function(){});})},{finally:function _finally(e){var t=Hw(this,Ww("Promise")),i=Fw(e);return this.then(i?function(i){return jw(t,e()).then(function(){return i;});}:e,i?function(i){return jw(t,e()).then(function(){throw i;});}:e);}});var Yw=Q.Promise,qw=Yw;!function(e){e.exports=qw;}(Jv),function(e){e.exports=$v;}(Kv);var Zw=t(Gv);function _w(e,t,i,r,n,o,a){try{var s=e[o](a),l=s.value;}catch(e){return void i(e);}s.done?t(l):Zw.resolve(l).then(r,n);}function Gw(e){return function(){var t=this,i=arguments;return new Zw(function(r,n){var o=e.apply(t,i);function a(e){_w(o,r,n,a,s,"next",e);}function s(e){_w(o,r,n,a,s,"throw",e);}a(void 0);});};}function Kw(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}var $w={},Jw={get exports(){return $w;},set exports(e){$w=e;}},Qw={},eb={get exports(){return Qw;},set exports(e){Qw=e;}},tb=Xc;!function(e){e.exports=tb;}(eb),function(e){e.exports=Qw;}(Jw);var ib=t($w);function rb(e){var t;return rb=Yv?Uv(t=ib).call(t):function(e){return e.__proto__||ib(e);},rb(e);}var nb={},ob={get exports(){return nb;},set exports(e){nb=e;}},ab={},sb={get exports(){return ab;},set exports(e){ab=e;}},lb=tt,ub=D,cb=J,hb=ai,db=function db(e){return void 0!==e&&(lb(e,"value")||lb(e,"writable"));},fb=I,vb=Cu;Mi({target:"Reflect",stat:!0},{get:function e(t,i){var r,n,o=arguments.length<3?t:arguments[2];return hb(t)===o?t[i]:(r=fb.f(t,i))?db(r)?r.value:void 0===r.get?void 0:ub(r.get,o):cb(n=vb(t))?e(n,i,o):void 0;}});var gb=Q.Reflect.get;!function(e){e.exports=gb;}(sb),function(e){e.exports=ab;}(ob);var mb=t(nb),yb={},pb={get exports(){return yb;},set exports(e){yb=e;}},wb={},bb={get exports(){return wb;},set exports(e){wb=e;}},kb={},Sb={get exports(){return kb;},set exports(e){kb=e;}},xb=Mi,Cb=a,Vb=K,Tb=I.f,Ib=E;xb({target:"Object",stat:!0,forced:!Ib||Cb(function(){Tb(1);}),sham:!Ib},{getOwnPropertyDescriptor:function getOwnPropertyDescriptor(e,t){return Tb(Vb(e),t);}});var Eb=Q.Object,Pb=Sb.exports=function(e,t){return Eb.getOwnPropertyDescriptor(e,t);};Eb.getOwnPropertyDescriptor.sham&&(Pb.sham=!0);var Bb=kb;!function(e){e.exports=Bb;}(bb),function(e){e.exports=wb;}(pb);var Db=t(yb);function Mb(){var e;"undefined"!=typeof Reflect&&mb?Mb=Uv(e=mb).call(e):Mb=function Mb(e,t,i){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=rb(e)););return e;}(e,t);if(r){var n=Db(r,t);return n.get?n.get.call(arguments.length<3?e:i):n.value;}};return Mb.apply(this,arguments);}var Ub={},Ab={get exports(){return Ub;},set exports(e){Ub=e;}},zb={},Rb={get exports(){return zb;},set exports(e){zb=e;}},Nb=Nc;!function(e){e.exports=Nb;}(Rb),function(e){e.exports=zb;}(Ab);var Ob=t(Ub),Lb={},Wb={get exports(){return Lb;},set exports(e){Lb=e;}},Fb={},Hb={get exports(){return Fb;},set exports(e){Fb=e;}},jb={},Xb={get exports(){return jb;},set exports(e){jb=e;}},Yb=Mi,qb=E,Zb=ti.f;Yb({target:"Object",stat:!0,forced:Object.defineProperty!==Zb,sham:!qb},{defineProperty:Zb});var _b=Q.Object,Gb=Xb.exports=function(e,t,i){return _b.defineProperty(e,t,i);};_b.defineProperty.sham&&(Gb.sham=!0);var Kb=jb,$b=Kb;!function(e){e.exports=$b;}(Hb),function(e){e.exports=Fb;}(Wb);var Jb=t(Lb);function Qb(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Ob(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Jb(e,"prototype",{writable:!1}),t&&qv(e,t);}function ek(e,t){return od(e)||function(e,t){var i=null==e?null:void 0!==Th&&yd(e)||e["@@iterator"];if(null!=i){var r,n,o,a,s=[],l=!0,u=!1;try{if(o=(i=i.call(e)).next,0===t){if(Object(i)!==i)return;l=!1;}else for(;!(l=(r=o.call(i)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){u=!0,n=e;}finally{try{if(!l&&null!=i.return&&(a=i.return(),Object(a)!==a))return;}finally{if(u)throw n;}}return s;}}(e,t)||Nf(e,t)||Of();}function tk(e){return function(e){if(nd(e))return $h(e);}(e)||sf(e)||Nf(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}();}var ik={},rk={get exports(){return ik;},set exports(e){ik=e;}},nk={},ok={get exports(){return nk;},set exports(e){nk=e;}},ak=Ma.filter;Mi({target:"Array",proto:!0,forced:!ao("filter")},{filter:function filter(e){return ak(this,e,arguments.length>1?arguments[1]:void 0);}});var sk=Ef("Array","filter"),lk=oe,uk=sk,ck=Array.prototype,hk=function hk(e){var t=e.filter;return e===ck||lk(ck,e)&&t===ck.filter?uk:t;},dk=hk,fk=dk;!function(e){e.exports=fk;}(ok),function(e){e.exports=nk;}(rk);var vk=t(ik),gk={},mk={get exports(){return gk;},set exports(e){gk=e;}},yk={},pk={get exports(){return yk;},set exports(e){yk=e;}},wk=Ma.forEach,bk=$f("forEach")?[].forEach:function(e){return wk(this,e,arguments.length>1?arguments[1]:void 0);};Mi({target:"Array",proto:!0,forced:[].forEach!==bk},{forEach:bk});var kk=Ef("Array","forEach"),Sk=Qi,xk=tt,Ck=oe,Vk=kk,Tk=Array.prototype,Ik={DOMTokenList:!0,NodeList:!0},Ek=function Ek(e){var t=e.forEach;return e===Tk||Ck(Tk,e)&&t===Tk.forEach||xk(Ik,Sk(e))?Vk:t;},Pk=Ek;!function(e){e.exports=Pk;}(pk),function(e){e.exports=yk;}(mk);var Bk=t(gk),Dk={},Mk={get exports(){return Dk;},set exports(e){Dk=e;}},Uk={},Ak={get exports(){return Uk;},set exports(e){Uk=e;}},zk=ng,Rk=K,Nk=I,Ok=Gn;Mi({target:"Object",stat:!0,sham:!E},{getOwnPropertyDescriptors:function getOwnPropertyDescriptors(e){for(var t,i,r=Rk(e),n=Nk.f,o=zk(r),a={},s=0;o.length>s;)void 0!==(i=n(r,t=o[s++]))&&Ok(a,t,i);return a;}});var Lk=Q.Object.getOwnPropertyDescriptors;!function(e){e.exports=Lk;}(Ak),function(e){e.exports=Uk;}(Mk);var Wk=t(Dk),Fk={},Hk={get exports(){return Fk;},set exports(e){Fk=e;}},jk={},Xk={get exports(){return jk;},set exports(e){jk=e;}},Yk={},qk={get exports(){return Yk;},set exports(e){Yk=e;}},Zk=Mi,_k=E,Gk=kr.f;Zk({target:"Object",stat:!0,forced:Object.defineProperties!==Gk,sham:!_k},{defineProperties:Gk});var Kk=Q.Object,$k=qk.exports=function(e,t){return Kk.defineProperties(e,t);};Kk.defineProperties.sham&&($k.sham=!0);var Jk=Yk;!function(e){e.exports=Jk;}(Xk),function(e){e.exports=jk;}(Hk);var Qk=t(Fk),eS={},tS={get exports(){return eS;},set exports(e){eS=e;}},iS={},rS={get exports(){return iS;},set exports(e){iS=e;}},nS=Lo.f("toPrimitive");!function(e){e.exports=nS;}(rS),function(e){e.exports=iS;}(tS);var oS=t(eS);function aS(e){var t=function(e,t){if("object"!==Kh(e)||null===e)return e;var i=e[oS];if(void 0!==i){var r=i.call(e,t||"default");if("object"!==Kh(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===t?String:Number)(e);}(e,"string");return"symbol"===Kh(t)?t:String(t);}function sS(e,t,i){return(t=aS(t))in e?Jb(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e;}function lS(e,t){var i=wv(e);if(Yf){var r=Yf(e);t&&(r=vk(r).call(r,function(t){return Db(e,t).enumerable;})),i.push.apply(i,r);}return i;}function uS(e){for(var t=1;t<arguments.length;t++){var i,r,n=null!=arguments[t]?arguments[t]:{};t%2?Bk(i=lS(Object(n),!0)).call(i,function(t){sS(e,t,n[t]);}):Wk?Qk(e,Wk(n)):Bk(r=lS(Object(n))).call(r,function(t){Jb(e,t,Db(n,t));});}return e;}function cS(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Jb(e,aS(r.key),r);}}function hS(e,t,i){return t&&cS(e.prototype,t),i&&cS(e,i),Jb(e,"prototype",{writable:!1}),e;}function dS(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");}var fS={},vS={get exports(){return fS;},set exports(e){fS=e;}};!function(e){e.exports=id;}(vS);var gS=t(fS),mS={},yS={get exports(){return mS;},set exports(e){mS=e;}};!function(e){e.exports=Ek;}(yS);var pS=t(mS),wS={},bS={get exports(){return wS;},set exports(e){wS=e;}};!function(e){e.exports=yv;}(bS);var kS=t(wS),SS={},xS={get exports(){return SS;},set exports(e){SS=e;}},CS=Ef("Array","concat"),VS=oe,TS=CS,IS=Array.prototype,ES=function ES(e){var t=e.concat;return e===IS||VS(IS,e)&&t===IS.concat?TS:t;},PS=ES;!function(e){e.exports=PS;}(xS);var BS=t(SS),DS={},MS={get exports(){return DS;},set exports(e){DS=e;}};Mi({target:"Number",stat:!0},{isNaN:function isNaN(e){return e!=e;}});var US=Q.Number.isNaN;!function(e){e.exports=US;}(MS);var AS=t(DS),zS={},RS={get exports(){return zS;},set exports(e){zS=e;}},NS="\t\n\x0B\f\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF",OS=Z,LS=Co,WS=NS,FS=y("".replace),HS=RegExp("^["+WS+"]+"),jS=RegExp("(^|[^"+WS+"])["+WS+"]+$"),XS=function XS(e){return function(t){var i=LS(OS(t));return 1&e&&(i=FS(i,HS,"")),2&e&&(i=FS(i,jS,"$1")),i;};},YS={start:XS(1),end:XS(2),trim:XS(3)},qS=gu.PROPER,ZS=a,_S=NS,GS=YS.trim;Mi({target:"String",proto:!0,forced:function(e){return ZS(function(){return!!_S[e]()||"​᠎"!=="​᠎"[e]()||qS&&_S[e].name!==e;});}("trim")},{trim:function trim(){return GS(this);}});var KS=Ef("String","trim"),$S=oe,JS=KS,QS=String.prototype,ex=function ex(e){var t=e.trim;return"string"==typeof e||e===QS||$S(QS,e)&&t===QS.trim?JS:t;},tx=ex;!function(e){e.exports=tx;}(RS);var ix=t(zS),rx={},nx={get exports(){return rx;},set exports(e){rx=e;}},ox=o,ax=a,sx=y,lx=Co,ux=YS.trim,cx=NS,hx=ox.parseInt,dx=ox.Symbol,fx=dx&&dx.iterator,vx=/^[+-]?0x/i,gx=sx(vx.exec),mx=8!==hx(cx+"08")||22!==hx(cx+"0x16")||fx&&!ax(function(){hx(Object(fx));})?function(e,t){var i=ux(lx(e));return hx(i,t>>>0||(gx(vx,i)?16:10));}:hx;Mi({global:!0,forced:parseInt!==mx},{parseInt:mx});var yx=Q.parseInt;!function(e){e.exports=yx;}(nx);var px=t(rx),wx={},bx={get exports(){return wx;},set exports(e){wx=e;}},kx=De,Sx=Je,xx=j,Cx=zr,Vx=TypeError,Tx="Reduce of empty array with no initial value",Ix=function Ix(e){return function(t,i,r,n){var o=Sx(t),a=xx(o),s=Cx(o);if(kx(i),0===s&&r<2)throw new Vx(Tx);var l=e?s-1:0,u=e?-1:1;if(r<2)for(;;){if(l in a){n=a[l],l+=u;break;}if(l+=u,e?l<0:s<=l)throw new Vx(Tx);}for(;e?l>=0:s>l;l+=u)l in a&&(n=i(n,a[l],l,o));return n;};},Ex={left:Ix(!1),right:Ix(!0)}.left;Mi({target:"Array",proto:!0,forced:!um&&ge>79&&ge<83||!$f("reduce")},{reduce:function reduce(e){var t=arguments.length;return Ex(this,e,t,t>1?arguments[1]:void 0);}});var Px=Ef("Array","reduce"),Bx=oe,Dx=Px,Mx=Array.prototype,Ux=function Ux(e){var t=e.reduce;return e===Mx||Bx(Mx,e)&&t===Mx.reduce?Dx:t;},Ax=Ux;!function(e){e.exports=Ax;}(bx);var zx=t(wx),Rx={},Nx={get exports(){return Rx;},set exports(e){Rx=e;}};!function(e){e.exports=dk;}(Nx);var Ox=t(Rx),Lx={},Wx={get exports(){return Lx;},set exports(e){Lx=e;}},Fx=Mi,Hx=y,jx=Br,Xx=RangeError,Yx=String.fromCharCode,qx=String.fromCodePoint,Zx=Hx([].join);Fx({target:"String",stat:!0,arity:1,forced:!!qx&&1!==qx.length},{fromCodePoint:function fromCodePoint(e){for(var t,i=[],r=arguments.length,n=0;r>n;){if(t=+arguments[n++],jx(t,1114111)!==t)throw new Xx(t+" is not a valid code point");i[n]=t<65536?Yx(t):Yx(55296+((t-=65536)>>10),t%1024+56320);}return Zx(i,"");}});var _x=a,Gx=Fe,Kx=gt("iterator"),$x=!_x(function(){var e=new URL("b?a=1&b=2&c=3","https://a"),t=e.searchParams,i=new URLSearchParams("a=1&a=2&b=3"),r="";return e.pathname="c%20d",t.forEach(function(e,i){t.delete("b"),r+=i+e;}),i.delete("a",2),i.delete("b",void 0),!e.toJSON||!i.has("a",1)||i.has("a",2)||!i.has("a",void 0)||i.has("b")||!t.size&&Gx||!t.sort||"https://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[Kx]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("https://тест").host||"#%D0%B1"!==new URL("https://a#б").hash||"a1c3"!==r||"x"!==new URL("https://x",void 0).host;}),Jx=Ro,Qx=function Qx(e,t,i){for(var r in t)i&&i.unsafe&&e[r]?e[r]=t[r]:Jx(e,r,t[r],i);return e;},eC=Ui,tC=Math.floor,_iC=function iC(e,t){var i=e.length;if(i<8)for(var r,n,o=1;o<i;){for(n=o,r=e[o];n&&t(e[n-1],r)>0;)e[n]=e[--n];n!==o++&&(e[n]=r);}else for(var a=tC(i/2),s=_iC(eC(e,0,a),t),l=_iC(eC(e,a),t),u=s.length,c=l.length,h=0,d=0;h<u||d<c;)e[h+d]=h<u&&d<c?t(s[h],l[d])<=0?s[h++]:l[d++]:h<u?s[h++]:l[d++];return e;},rC=_iC,nC=Mi,oC=o,aC=iy,sC=ne,lC=D,uC=y,cC=E,hC=$x,dC=Ro,fC=Oo,vC=Qx,gC=la,mC=Fu,yC=Ca,pC=ym,wC=T,bC=tt,kC=ei,SC=Qi,xC=ai,CC=J,VC=Co,TC=xn,IC=O,EC=Od,PC=gd,BC=mc,DC=Cm,MC=rC,UC=gt("iterator"),AC="URLSearchParams",zC=AC+"Iterator",RC=yC.set,NC=yC.getterFor(AC),OC=yC.getterFor(zC),LC=aC("fetch"),WC=aC("Request"),FC=aC("Headers"),HC=WC&&WC.prototype,jC=FC&&FC.prototype,XC=oC.TypeError,YC=oC.encodeURIComponent,qC=String.fromCharCode,ZC=sC("String","fromCodePoint"),_C=parseInt,GC=uC("".charAt),KC=uC([].join),$C=uC([].push),JC=uC("".replace),QC=uC([].shift),eV=uC([].splice),tV=uC("".split),iV=uC("".slice),rV=uC(/./.exec),nV=/\+/g,oV=/^[0-9a-f]+$/i,aV=function aV(e,t){var i=iV(e,t,t+2);return rV(oV,i)?_C(i,16):NaN;},sV=function sV(e){for(var t=0,i=128;i>0&&0!==(e&i);i>>=1)t++;return t;},lV=function lV(e){var t=null;switch(e.length){case 1:t=e[0];break;case 2:t=(31&e[0])<<6|63&e[1];break;case 3:t=(15&e[0])<<12|(63&e[1])<<6|63&e[2];break;case 4:t=(7&e[0])<<18|(63&e[1])<<12|(63&e[2])<<6|63&e[3];}return t>1114111?null:t;},uV=function uV(e){for(var t=(e=JC(e,nV," ")).length,i="",r=0;r<t;){var n=GC(e,r);if("%"===n){if("%"===GC(e,r+1)||r+3>t){i+="%",r++;continue;}var o=aV(e,r+1);if(o!=o){i+=n,r++;continue;}r+=2;var a=sV(o);if(0===a)n=qC(o);else{if(1===a||a>4){i+="�",r++;continue;}for(var s=[o],l=1;l<a&&!(++r+3>t||"%"!==GC(e,r));){var u=aV(e,r+1);if(u!=u){r+=3;break;}if(u>191||u<128)break;$C(s,u),r+=2,l++;}if(s.length!==a){i+="�";continue;}var c=lV(s);null===c?i+="�":n=ZC(c);}}i+=n,r++;}return i;},cV=/[!'()~]|%20/g,hV={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},dV=function dV(e){return hV[e];},fV=function fV(e){return JC(YC(e),cV,dV);},vV=mC(function(e,t){RC(this,{type:zC,target:NC(e).entries,index:0,kind:t});},AC,function(){var e=OC(this),t=e.target,i=e.index++;if(!t||i>=t.length)return e.target=null,BC(void 0,!0);var r=t[i];switch(e.kind){case"keys":return BC(r.key,!1);case"values":return BC(r.value,!1);}return BC([r.key,r.value],!1);},!0),gV=function gV(e){this.entries=[],this.url=null,void 0!==e&&(CC(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===GC(e,0)?iV(e,1):e:VC(e)));};gV.prototype={type:AC,bindURL:function bindURL(e){this.url=e,this.update();},parseObject:function parseObject(e){var t,i,r,n,o,a,s,l=this.entries,u=PC(e);if(u)for(i=(t=EC(e,u)).next;!(r=lC(i,t)).done;){if(o=(n=EC(xC(r.value))).next,(a=lC(o,n)).done||(s=lC(o,n)).done||!lC(o,n).done)throw new XC("Expected sequence with length 2");$C(l,{key:VC(a.value),value:VC(s.value)});}else for(var c in e)bC(e,c)&&$C(l,{key:c,value:VC(e[c])});},parseQuery:function parseQuery(e){if(e)for(var t,i,r=this.entries,n=tV(e,"&"),o=0;o<n.length;)(t=n[o++]).length&&(i=tV(t,"="),$C(r,{key:uV(QC(i)),value:uV(KC(i,"="))}));},serialize:function serialize(){for(var e,t=this.entries,i=[],r=0;r<t.length;)e=t[r++],$C(i,fV(e.key)+"="+fV(e.value));return KC(i,"&");},update:function update(){this.entries.length=0,this.parseQuery(this.url.query);},updateURL:function updateURL(){this.url&&this.url.update();}};var mV=function mV(){pC(this,yV);var e=RC(this,new gV(arguments.length>0?arguments[0]:void 0));cC||(this.size=e.entries.length);},yV=mV.prototype;if(vC(yV,{append:function append(e,t){var i=NC(this);DC(arguments.length,2),$C(i.entries,{key:VC(e),value:VC(t)}),cC||this.size++,i.updateURL();},delete:function _delete(e){for(var t=NC(this),i=DC(arguments.length,1),r=t.entries,n=VC(e),o=i<2?void 0:arguments[1],a=void 0===o?o:VC(o),s=0;s<r.length;){var l=r[s];if(l.key!==n||void 0!==a&&l.value!==a)s++;else if(eV(r,s,1),void 0!==a)break;}cC||(this.size=r.length),t.updateURL();},get:function get(e){var t=NC(this).entries;DC(arguments.length,1);for(var i=VC(e),r=0;r<t.length;r++)if(t[r].key===i)return t[r].value;return null;},getAll:function getAll(e){var t=NC(this).entries;DC(arguments.length,1);for(var i=VC(e),r=[],n=0;n<t.length;n++)t[n].key===i&&$C(r,t[n].value);return r;},has:function has(e){for(var t=NC(this).entries,i=DC(arguments.length,1),r=VC(e),n=i<2?void 0:arguments[1],o=void 0===n?n:VC(n),a=0;a<t.length;){var s=t[a++];if(s.key===r&&(void 0===o||s.value===o))return!0;}return!1;},set:function set(e,t){var i=NC(this);DC(arguments.length,1);for(var r,n=i.entries,o=!1,a=VC(e),s=VC(t),l=0;l<n.length;l++)(r=n[l]).key===a&&(o?eV(n,l--,1):(o=!0,r.value=s));o||$C(n,{key:a,value:s}),cC||(this.size=n.length),i.updateURL();},sort:function sort(){var e=NC(this);MC(e.entries,function(e,t){return e.key>t.key?1:-1;}),e.updateURL();},forEach:function forEach(e){for(var t,i=NC(this).entries,r=kC(e,arguments.length>1?arguments[1]:void 0),n=0;n<i.length;)r((t=i[n++]).value,t.key,this);},keys:function keys(){return new vV(this,"keys");},values:function values(){return new vV(this,"values");},entries:function entries(){return new vV(this,"entries");}},{enumerable:!0}),dC(yV,UC,yV.entries,{name:"entries"}),dC(yV,"toString",function(){return NC(this).serialize();},{enumerable:!0}),cC&&fC(yV,"size",{get:function get(){return NC(this).entries.length;},configurable:!0,enumerable:!0}),gC(mV,AC),nC({global:!0,constructor:!0,forced:!hC},{URLSearchParams:mV}),!hC&&wC(FC)){var pV=uC(jC.has),wV=uC(jC.set),bV=function bV(e){if(CC(e)){var t,i=e.body;if(SC(i)===AC)return t=e.headers?new FC(e.headers):new FC(),pV(t,"content-type")||wV(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),TC(e,{body:IC(0,VC(i)),headers:IC(0,t)});}return e;};if(wC(LC)&&nC({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function fetch(e){return LC(e,arguments.length>1?bV(arguments[1]):{});}}),wC(WC)){var kV=function kV(e){return pC(this,HC),new WC(e,arguments.length>1?bV(arguments[1]):{});};HC.constructor=kV,kV.prototype=HC,nC({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:kV});}}var SV,xV={URLSearchParams:mV,getState:NC},CV=E,VV=y,TV=D,IV=a,EV=$r,PV=Ao,BV=M,DV=Je,MV=j,UV=Object.assign,AV=Object.defineProperty,zV=VV([].concat),RV=!UV||IV(function(){if(CV&&1!==UV({b:1},UV(AV({},"a",{enumerable:!0,get:function get(){AV(this,"b",{value:3,enumerable:!1});}}),{b:2})).b)return!0;var e={},t={},i=Symbol("assign detection"),r="abcdefghijklmnopqrst";return e[i]=7,r.split("").forEach(function(e){t[e]=e;}),7!==UV({},e)[i]||EV(UV({},t)).join("")!==r;})?function(e,t){for(var i=DV(e),r=arguments.length,n=1,o=PV.f,a=BV.f;r>n;)for(var s,l=MV(arguments[n++]),u=o?zV(EV(l),o(l)):EV(l),c=u.length,h=0;c>h;)s=u[h++],CV&&!TV(a,l,s)||(i[s]=l[s]);return i;}:UV,NV=y,OV=2147483647,LV=/[^\0-\u007E]/,WV=/[.\u3002\uFF0E\uFF61]/g,FV="Overflow: input needs wider integers to process",HV=RangeError,jV=NV(WV.exec),XV=Math.floor,YV=String.fromCharCode,qV=NV("".charCodeAt),ZV=NV([].join),_V=NV([].push),GV=NV("".replace),KV=NV("".split),$V=NV("".toLowerCase),JV=function JV(e){return e+22+75*(e<26);},QV=function QV(e,t,i){var r=0;for(e=i?XV(e/700):e>>1,e+=XV(e/t);e>455;)e=XV(e/35),r+=36;return XV(r+36*e/(e+38));},eT=function eT(e){var t=[];e=function(e){for(var t=[],i=0,r=e.length;i<r;){var n=qV(e,i++);if(n>=55296&&n<=56319&&i<r){var o=qV(e,i++);56320==(64512&o)?_V(t,((1023&n)<<10)+(1023&o)+65536):(_V(t,n),i--);}else _V(t,n);}return t;}(e);var i,r,n=e.length,o=128,a=0,s=72;for(i=0;i<e.length;i++)(r=e[i])<128&&_V(t,YV(r));var l=t.length,u=l;for(l&&_V(t,"-");u<n;){var c=OV;for(i=0;i<e.length;i++)(r=e[i])>=o&&r<c&&(c=r);var h=u+1;if(c-o>XV((OV-a)/h))throw new HV(FV);for(a+=(c-o)*h,o=c,i=0;i<e.length;i++){if((r=e[i])<o&&++a>OV)throw new HV(FV);if(r===o){for(var d=a,f=36;;){var v=f<=s?1:f>=s+26?26:f-s;if(d<v)break;var g=d-v,m=36-v;_V(t,YV(JV(v+g%m))),d=XV(g/m),f+=36;}_V(t,YV(JV(d))),s=QV(a,h,u===l),a=0,u++;}}a++,o++;}return ZV(t,"");},tT=Mi,iT=E,rT=$x,nT=o,oT=ei,aT=y,sT=Ro,lT=Oo,uT=ym,cT=tt,hT=RV,dT=Kd,fT=Ui,vT=Lh.codeAt,gT=function gT(e){var t,i,r=[],n=KV(GV($V(e),WV,"."),".");for(t=0;t<n.length;t++)i=n[t],_V(r,jV(LV,i)?"xn--"+eT(i):i);return ZV(r,".");},mT=Co,yT=la,pT=Cm,wT=xV,bT=Ca,kT=bT.set,ST=bT.getterFor("URL"),xT=wT.URLSearchParams,CT=wT.getState,VT=nT.URL,TT=nT.TypeError,IT=nT.parseInt,ET=Math.floor,PT=Math.pow,BT=aT("".charAt),DT=aT(/./.exec),MT=aT([].join),UT=aT(1.1.toString),AT=aT([].pop),zT=aT([].push),RT=aT("".replace),NT=aT([].shift),OT=aT("".split),LT=aT("".slice),WT=aT("".toLowerCase),FT=aT([].unshift),HT="Invalid scheme",jT="Invalid host",XT="Invalid port",YT=/[a-z]/i,qT=/[\d+-.a-z]/i,ZT=/\d/,_T=/^0x/i,GT=/^[0-7]+$/,KT=/^\d+$/,$T=/^[\da-f]+$/i,JT=/[\0\t\n\r #%/:<>?@[\\\]^|]/,QT=/[\0\t\n\r #/:<>?@[\\\]^|]/,eI=/^[\u0000-\u0020]+/,tI=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,iI=/[\t\n\r]/g,rI=function rI(e){var t,i,r,n;if("number"==typeof e){for(t=[],i=0;i<4;i++)FT(t,e%256),e=ET(e/256);return MT(t,".");}if("object"==_typeof(e)){for(t="",r=function(e){for(var t=null,i=1,r=null,n=0,o=0;o<8;o++)0!==e[o]?(n>i&&(t=r,i=n),r=null,n=0):(null===r&&(r=o),++n);return n>i?r:t;}(e),i=0;i<8;i++)n&&0===e[i]||(n&&(n=!1),r===i?(t+=i?":":"::",n=!0):(t+=UT(e[i],16),i<7&&(t+=":")));return"["+t+"]";}return e;},nI={},oI=hT({},nI,{" ":1,'"':1,"<":1,">":1,"`":1}),aI=hT({},oI,{"#":1,"?":1,"{":1,"}":1}),sI=hT({},aI,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),lI=function lI(e,t){var i=vT(e,0);return i>32&&i<127&&!cT(t,e)?e:encodeURIComponent(e);},uI={ftp:21,file:null,http:80,https:443,ws:80,wss:443},cI=function cI(e,t){var i;return 2===e.length&&DT(YT,BT(e,0))&&(":"===(i=BT(e,1))||!t&&"|"===i);},hI=function hI(e){var t;return e.length>1&&cI(LT(e,0,2))&&(2===e.length||"/"===(t=BT(e,2))||"\\"===t||"?"===t||"#"===t);},dI=function dI(e){return"."===e||"%2e"===WT(e);},fI=function fI(e){return".."===(e=WT(e))||"%2e."===e||".%2e"===e||"%2e%2e"===e;},vI={},gI={},mI={},yI={},pI={},wI={},bI={},kI={},SI={},xI={},CI={},VI={},TI={},II={},EI={},PI={},BI={},DI={},MI={},UI={},AI={},_zI=function zI(e,t,i){var r,n,o,a=mT(e);if(t){if(n=this.parse(a))throw new TT(n);this.searchParams=null;}else{if(void 0!==i&&(r=new _zI(i,!0)),n=this.parse(a,null,r))throw new TT(n);(o=CT(new xT())).bindURL(this),this.searchParams=o;}};_zI.prototype={type:"URL",parse:function parse(e,t,i){var r,n,o,a,s=this,l=t||vI,u=0,c="",h=!1,d=!1,f=!1;for(e=mT(e),t||(s.scheme="",s.username="",s.password="",s.host=null,s.port=null,s.path=[],s.query=null,s.fragment=null,s.cannotBeABaseURL=!1,e=RT(e,eI,""),e=RT(e,tI,"$1")),e=RT(e,iI,""),r=dT(e);u<=r.length;){switch(n=r[u],l){case vI:if(!n||!DT(YT,n)){if(t)return HT;l=mI;continue;}c+=WT(n),l=gI;break;case gI:if(n&&(DT(qT,n)||"+"===n||"-"===n||"."===n))c+=WT(n);else{if(":"!==n){if(t)return HT;c="",l=mI,u=0;continue;}if(t&&(s.isSpecial()!==cT(uI,c)||"file"===c&&(s.includesCredentials()||null!==s.port)||"file"===s.scheme&&!s.host))return;if(s.scheme=c,t)return void(s.isSpecial()&&uI[s.scheme]===s.port&&(s.port=null));c="","file"===s.scheme?l=II:s.isSpecial()&&i&&i.scheme===s.scheme?l=yI:s.isSpecial()?l=kI:"/"===r[u+1]?(l=pI,u++):(s.cannotBeABaseURL=!0,zT(s.path,""),l=MI);}break;case mI:if(!i||i.cannotBeABaseURL&&"#"!==n)return HT;if(i.cannotBeABaseURL&&"#"===n){s.scheme=i.scheme,s.path=fT(i.path),s.query=i.query,s.fragment="",s.cannotBeABaseURL=!0,l=AI;break;}l="file"===i.scheme?II:wI;continue;case yI:if("/"!==n||"/"!==r[u+1]){l=wI;continue;}l=SI,u++;break;case pI:if("/"===n){l=xI;break;}l=DI;continue;case wI:if(s.scheme=i.scheme,n===SV)s.username=i.username,s.password=i.password,s.host=i.host,s.port=i.port,s.path=fT(i.path),s.query=i.query;else if("/"===n||"\\"===n&&s.isSpecial())l=bI;else if("?"===n)s.username=i.username,s.password=i.password,s.host=i.host,s.port=i.port,s.path=fT(i.path),s.query="",l=UI;else{if("#"!==n){s.username=i.username,s.password=i.password,s.host=i.host,s.port=i.port,s.path=fT(i.path),s.path.length--,l=DI;continue;}s.username=i.username,s.password=i.password,s.host=i.host,s.port=i.port,s.path=fT(i.path),s.query=i.query,s.fragment="",l=AI;}break;case bI:if(!s.isSpecial()||"/"!==n&&"\\"!==n){if("/"!==n){s.username=i.username,s.password=i.password,s.host=i.host,s.port=i.port,l=DI;continue;}l=xI;}else l=SI;break;case kI:if(l=SI,"/"!==n||"/"!==BT(c,u+1))continue;u++;break;case SI:if("/"!==n&&"\\"!==n){l=xI;continue;}break;case xI:if("@"===n){h&&(c="%40"+c),h=!0,o=dT(c);for(var v=0;v<o.length;v++){var g=o[v];if(":"!==g||f){var m=lI(g,sI);f?s.password+=m:s.username+=m;}else f=!0;}c="";}else if(n===SV||"/"===n||"?"===n||"#"===n||"\\"===n&&s.isSpecial()){if(h&&""===c)return"Invalid authority";u-=dT(c).length+1,c="",l=CI;}else c+=n;break;case CI:case VI:if(t&&"file"===s.scheme){l=PI;continue;}if(":"!==n||d){if(n===SV||"/"===n||"?"===n||"#"===n||"\\"===n&&s.isSpecial()){if(s.isSpecial()&&""===c)return jT;if(t&&""===c&&(s.includesCredentials()||null!==s.port))return;if(a=s.parseHost(c))return a;if(c="",l=BI,t)return;continue;}"["===n?d=!0:"]"===n&&(d=!1),c+=n;}else{if(""===c)return jT;if(a=s.parseHost(c))return a;if(c="",l=TI,t===VI)return;}break;case TI:if(!DT(ZT,n)){if(n===SV||"/"===n||"?"===n||"#"===n||"\\"===n&&s.isSpecial()||t){if(""!==c){var y=IT(c,10);if(y>65535)return XT;s.port=s.isSpecial()&&y===uI[s.scheme]?null:y,c="";}if(t)return;l=BI;continue;}return XT;}c+=n;break;case II:if(s.scheme="file","/"===n||"\\"===n)l=EI;else{if(!i||"file"!==i.scheme){l=DI;continue;}switch(n){case SV:s.host=i.host,s.path=fT(i.path),s.query=i.query;break;case"?":s.host=i.host,s.path=fT(i.path),s.query="",l=UI;break;case"#":s.host=i.host,s.path=fT(i.path),s.query=i.query,s.fragment="",l=AI;break;default:hI(MT(fT(r,u),""))||(s.host=i.host,s.path=fT(i.path),s.shortenPath()),l=DI;continue;}}break;case EI:if("/"===n||"\\"===n){l=PI;break;}i&&"file"===i.scheme&&!hI(MT(fT(r,u),""))&&(cI(i.path[0],!0)?zT(s.path,i.path[0]):s.host=i.host),l=DI;continue;case PI:if(n===SV||"/"===n||"\\"===n||"?"===n||"#"===n){if(!t&&cI(c))l=DI;else if(""===c){if(s.host="",t)return;l=BI;}else{if(a=s.parseHost(c))return a;if("localhost"===s.host&&(s.host=""),t)return;c="",l=BI;}continue;}c+=n;break;case BI:if(s.isSpecial()){if(l=DI,"/"!==n&&"\\"!==n)continue;}else if(t||"?"!==n){if(t||"#"!==n){if(n!==SV&&(l=DI,"/"!==n))continue;}else s.fragment="",l=AI;}else s.query="",l=UI;break;case DI:if(n===SV||"/"===n||"\\"===n&&s.isSpecial()||!t&&("?"===n||"#"===n)){if(fI(c)?(s.shortenPath(),"/"===n||"\\"===n&&s.isSpecial()||zT(s.path,"")):dI(c)?"/"===n||"\\"===n&&s.isSpecial()||zT(s.path,""):("file"===s.scheme&&!s.path.length&&cI(c)&&(s.host&&(s.host=""),c=BT(c,0)+":"),zT(s.path,c)),c="","file"===s.scheme&&(n===SV||"?"===n||"#"===n))for(;s.path.length>1&&""===s.path[0];)NT(s.path);"?"===n?(s.query="",l=UI):"#"===n&&(s.fragment="",l=AI);}else c+=lI(n,aI);break;case MI:"?"===n?(s.query="",l=UI):"#"===n?(s.fragment="",l=AI):n!==SV&&(s.path[0]+=lI(n,nI));break;case UI:t||"#"!==n?n!==SV&&("'"===n&&s.isSpecial()?s.query+="%27":s.query+="#"===n?"%23":lI(n,nI)):(s.fragment="",l=AI);break;case AI:n!==SV&&(s.fragment+=lI(n,oI));}u++;}},parseHost:function parseHost(e){var t,i,r;if("["===BT(e,0)){if("]"!==BT(e,e.length-1))return jT;if(t=function(e){var t,i,r,n,o,a,s,l=[0,0,0,0,0,0,0,0],u=0,c=null,h=0,d=function d(){return BT(e,h);};if(":"===d()){if(":"!==BT(e,1))return;h+=2,c=++u;}for(;d();){if(8===u)return;if(":"!==d()){for(t=i=0;i<4&&DT($T,d());)t=16*t+IT(d(),16),h++,i++;if("."===d()){if(0===i)return;if(h-=i,u>6)return;for(r=0;d();){if(n=null,r>0){if(!("."===d()&&r<4))return;h++;}if(!DT(ZT,d()))return;for(;DT(ZT,d());){if(o=IT(d(),10),null===n)n=o;else{if(0===n)return;n=10*n+o;}if(n>255)return;h++;}l[u]=256*l[u]+n,2!==++r&&4!==r||u++;}if(4!==r)return;break;}if(":"===d()){if(h++,!d())return;}else if(d())return;l[u++]=t;}else{if(null!==c)return;h++,c=++u;}}if(null!==c)for(a=u-c,u=7;0!==u&&a>0;)s=l[u],l[u--]=l[c+a-1],l[c+--a]=s;else if(8!==u)return;return l;}(LT(e,1,-1)),!t)return jT;this.host=t;}else if(this.isSpecial()){if(e=gT(e),DT(JT,e))return jT;if(t=function(e){var t,i,r,n,o,a,s,l=OT(e,".");if(l.length&&""===l[l.length-1]&&l.length--,(t=l.length)>4)return e;for(i=[],r=0;r<t;r++){if(""===(n=l[r]))return e;if(o=10,n.length>1&&"0"===BT(n,0)&&(o=DT(_T,n)?16:8,n=LT(n,8===o?1:2)),""===n)a=0;else{if(!DT(10===o?KT:8===o?GT:$T,n))return e;a=IT(n,o);}zT(i,a);}for(r=0;r<t;r++)if(a=i[r],r===t-1){if(a>=PT(256,5-t))return null;}else if(a>255)return null;for(s=AT(i),r=0;r<i.length;r++)s+=i[r]*PT(256,3-r);return s;}(e),null===t)return jT;this.host=t;}else{if(DT(QT,e))return jT;for(t="",i=dT(e),r=0;r<i.length;r++)t+=lI(i[r],nI);this.host=t;}},cannotHaveUsernamePasswordPort:function cannotHaveUsernamePasswordPort(){return!this.host||this.cannotBeABaseURL||"file"===this.scheme;},includesCredentials:function includesCredentials(){return""!==this.username||""!==this.password;},isSpecial:function isSpecial(){return cT(uI,this.scheme);},shortenPath:function shortenPath(){var e=this.path,t=e.length;!t||"file"===this.scheme&&1===t&&cI(e[0],!0)||e.length--;},serialize:function serialize(){var e=this,t=e.scheme,i=e.username,r=e.password,n=e.host,o=e.port,a=e.path,s=e.query,l=e.fragment,u=t+":";return null!==n?(u+="//",e.includesCredentials()&&(u+=i+(r?":"+r:"")+"@"),u+=rI(n),null!==o&&(u+=":"+o)):"file"===t&&(u+="//"),u+=e.cannotBeABaseURL?a[0]:a.length?"/"+MT(a,"/"):"",null!==s&&(u+="?"+s),null!==l&&(u+="#"+l),u;},setHref:function setHref(e){var t=this.parse(e);if(t)throw new TT(t);this.searchParams.update();},getOrigin:function getOrigin(){var e=this.scheme,t=this.port;if("blob"===e)try{return new RI(e.path[0]).origin;}catch(e){return"null";}return"file"!==e&&this.isSpecial()?e+"://"+rI(this.host)+(null!==t?":"+t:""):"null";},getProtocol:function getProtocol(){return this.scheme+":";},setProtocol:function setProtocol(e){this.parse(mT(e)+":",vI);},getUsername:function getUsername(){return this.username;},setUsername:function setUsername(e){var t=dT(mT(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var i=0;i<t.length;i++)this.username+=lI(t[i],sI);}},getPassword:function getPassword(){return this.password;},setPassword:function setPassword(e){var t=dT(mT(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var i=0;i<t.length;i++)this.password+=lI(t[i],sI);}},getHost:function getHost(){var e=this.host,t=this.port;return null===e?"":null===t?rI(e):rI(e)+":"+t;},setHost:function setHost(e){this.cannotBeABaseURL||this.parse(e,CI);},getHostname:function getHostname(){var e=this.host;return null===e?"":rI(e);},setHostname:function setHostname(e){this.cannotBeABaseURL||this.parse(e,VI);},getPort:function getPort(){var e=this.port;return null===e?"":mT(e);},setPort:function setPort(e){this.cannotHaveUsernamePasswordPort()||(""===(e=mT(e))?this.port=null:this.parse(e,TI));},getPathname:function getPathname(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+MT(e,"/"):"";},setPathname:function setPathname(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,BI));},getSearch:function getSearch(){var e=this.query;return e?"?"+e:"";},setSearch:function setSearch(e){""===(e=mT(e))?this.query=null:("?"===BT(e,0)&&(e=LT(e,1)),this.query="",this.parse(e,UI)),this.searchParams.update();},getSearchParams:function getSearchParams(){return this.searchParams.facade;},getHash:function getHash(){var e=this.fragment;return e?"#"+e:"";},setHash:function setHash(e){""!==(e=mT(e))?("#"===BT(e,0)&&(e=LT(e,1)),this.fragment="",this.parse(e,AI)):this.fragment=null;},update:function update(){this.query=this.searchParams.serialize()||null;}};var RI=function RI(e){var t=uT(this,NI),i=pT(arguments.length,1)>1?arguments[1]:void 0,r=kT(t,new _zI(e,!1,i));iT||(t.href=r.serialize(),t.origin=r.getOrigin(),t.protocol=r.getProtocol(),t.username=r.getUsername(),t.password=r.getPassword(),t.host=r.getHost(),t.hostname=r.getHostname(),t.port=r.getPort(),t.pathname=r.getPathname(),t.search=r.getSearch(),t.searchParams=r.getSearchParams(),t.hash=r.getHash());},NI=RI.prototype,OI=function OI(e,t){return{get:function get(){return ST(this)[e]();},set:t&&function(e){return ST(this)[t](e);},configurable:!0,enumerable:!0};};if(iT&&(lT(NI,"href",OI("serialize","setHref")),lT(NI,"origin",OI("getOrigin")),lT(NI,"protocol",OI("getProtocol","setProtocol")),lT(NI,"username",OI("getUsername","setUsername")),lT(NI,"password",OI("getPassword","setPassword")),lT(NI,"host",OI("getHost","setHost")),lT(NI,"hostname",OI("getHostname","setHostname")),lT(NI,"port",OI("getPort","setPort")),lT(NI,"pathname",OI("getPathname","setPathname")),lT(NI,"search",OI("getSearch","setSearch")),lT(NI,"searchParams",OI("getSearchParams")),lT(NI,"hash",OI("getHash","setHash"))),sT(NI,"toJSON",function(){return ST(this).serialize();},{enumerable:!0}),sT(NI,"toString",function(){return ST(this).serialize();},{enumerable:!0}),VT){var LI=VT.createObjectURL,WI=VT.revokeObjectURL;LI&&sT(RI,"createObjectURL",oT(LI,VT)),WI&&sT(RI,"revokeObjectURL",oT(WI,VT));}yT(RI,"URL"),tT({global:!0,constructor:!0,forced:!rT,sham:!iT},{URL:RI});var FI=Mi,HI=a,jI=Cm,XI=Co,YI=$x,qI=ne("URL"),ZI=YI&&HI(function(){qI.canParse();}),_I=HI(function(){return 1!==qI.canParse.length;});FI({target:"URL",stat:!0,forced:!ZI||_I},{canParse:function canParse(e){var t=jI(arguments.length,1),i=XI(e),r=t<2||void 0===arguments[1]?void 0:XI(arguments[1]);try{return!!new qI(i,r);}catch(e){return!1;}}});var GI=Mi,KI=Cm,$I=Co,JI=$x,QI=ne("URL");GI({target:"URL",stat:!0,forced:!JI},{parse:function parse(e){var t=KI(arguments.length,1),i=$I(e),r=t<2||void 0===arguments[1]?void 0:$I(arguments[1]);try{return new QI(i,r);}catch(e){return null;}}});var eE=Q.URL;!function(e){e.exports=eE;}(Wx);var tE=t(Lx),iE={},rE={get exports(){return iE;},set exports(e){iE=e;}};!function(e){e.exports=Af;}(rE);var nE=t(iE),oE={},aE={get exports(){return oE;},set exports(e){oE=e;}};!function(e){e.exports=lv;}(aE);var sE=t(oE),lE={},uE={get exports(){return lE;},set exports(e){lE=e;}},cE=E,hE=jn,dE=TypeError,fE=Object.getOwnPropertyDescriptor,vE=cE&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1;}catch(e){return e instanceof TypeError;}}()?function(e,t){if(hE(e)&&!fE(e,"length").writable)throw new dE("Cannot set read only .length");return e.length=t;}:function(e,t){return e.length=t;},gE=Ie,mE=TypeError,yE=function yE(e,t){if(!delete e[t])throw new mE("Cannot delete property "+gE(t)+" of "+gE(e));},pE=Mi,wE=Je,bE=Br,kE=Tr,SE=zr,xE=vE,CE=Yn,VE=io,TE=Gn,IE=yE,EE=ao("splice"),PE=Math.max,BE=Math.min;pE({target:"Array",proto:!0,forced:!EE},{splice:function splice(e,t){var i,r,n,o,a,s,l=wE(this),u=SE(l),c=bE(e,u),h=arguments.length;for(0===h?i=r=0:1===h?(i=0,r=u-c):(i=h-2,r=BE(PE(kE(t),0),u-c)),CE(u+i-r),n=VE(l,r),o=0;o<r;o++)(a=c+o)in l&&TE(n,o,l[a]);if(n.length=r,i<r){for(o=c;o<u-r;o++)s=o+i,(a=o+r)in l?l[s]=l[a]:IE(l,s);for(o=u;o>u-r+i;o--)IE(l,o-1);}else if(i>r)for(o=u-r;o>c;o--)s=o+i-1,(a=o+r-1)in l?l[s]=l[a]:IE(l,s);for(o=0;o<i;o++)l[o+c]=arguments[o+2];return xE(l,u-r+i),n;}});var DE=Ef("Array","splice"),ME=oe,UE=DE,AE=Array.prototype,zE=function zE(e){var t=e.splice;return e===AE||ME(AE,e)&&t===AE.splice?UE:t;},RE=zE;!function(e){e.exports=RE;}(uE);var NE=t(lE),OE={},LE={get exports(){return OE;},set exports(e){OE=e;}},WE=Mi,FE=Ma.findIndex,HE="findIndex",jE=!0;HE in[]&&Array(1)[HE](function(){jE=!1;}),WE({target:"Array",proto:!0,forced:jE},{findIndex:function findIndex(e){return FE(this,e,arguments.length>1?arguments[1]:void 0);}});var XE=Ef("Array","findIndex"),YE=oe,qE=XE,ZE=Array.prototype,_E=function _E(e){var t=e.findIndex;return e===ZE||YE(ZE,e)&&t===ZE.findIndex?qE:t;},GE=_E;!function(e){e.exports=GE;}(LE);var KE=t(OE),$E={},JE={get exports(){return $E;},set exports(e){$E=e;}},QE=Mi,eP=Math.hypot,tP=Math.abs,iP=Math.sqrt;QE({target:"Math",stat:!0,arity:2,forced:!!eP&&eP(1/0,NaN)!==1/0},{hypot:function hypot(e,t){for(var i,r,n=0,o=0,a=arguments.length,s=0;o<a;)s<(i=tP(arguments[o++]))?(n=n*(r=s/i)*r+1,s=i):n+=i>0?(r=i/s)*r:i;return s===1/0?1/0:s*iP(n);}});var rP=Q.Math.hypot;!function(e){e.exports=rP;}(JE);var nP=t($E),oP={},aP={get exports(){return oP;},set exports(e){oP=e;}},sP=Math.sign||function(e){var t=+e;return 0===t||t!=t?t:t<0?-1:1;};Mi({target:"Math",stat:!0},{sign:sP});var lP=Q.Math.sign;!function(e){e.exports=lP;}(aP);var uP=t(oP),cP={},hP={get exports(){return cP;},set exports(e){cP=e;}},dP=Ma.map;Mi({target:"Array",proto:!0,forced:!ao("map")},{map:function map(e){return dP(this,e,arguments.length>1?arguments[1]:void 0);}});var fP=Ef("Array","map"),vP=oe,gP=fP,mP=Array.prototype,yP=function yP(e){var t=e.map;return e===mP||vP(mP,e)&&t===mP.map?gP:t;},pP=yP;!function(e){e.exports=pP;}(hP);var wP=t(cP),bP={},kP={get exports(){return bP;},set exports(e){bP=e;}},SP=Je,xP=Br,CP=zr,VP=function VP(e){for(var t=SP(this),i=CP(t),r=arguments.length,n=xP(r>1?arguments[1]:void 0,i),o=r>2?arguments[2]:void 0,a=void 0===o?i:xP(o,i);a>n;)t[n++]=e;return t;};Mi({target:"Array",proto:!0},{fill:VP});var TP=Ef("Array","fill"),IP=oe,EP=TP,PP=Array.prototype,BP=function BP(e){var t=e.fill;return e===PP||IP(PP,e)&&t===PP.fill?EP:t;},DP=BP;!function(e){e.exports=DP;}(kP);var MP=t(bP),UP={},AP={get exports(){return UP;},set exports(e){UP=e;}},zP=Mi,RP=Ma.find,NP="find",OP=!0;NP in[]&&Array(1)[NP](function(){OP=!1;}),zP({target:"Array",proto:!0,forced:OP},{find:function find(e){return RP(this,e,arguments.length>1?arguments[1]:void 0);}});var LP=Ef("Array","find"),WP=oe,FP=LP,HP=Array.prototype,jP=function jP(e){var t=e.find;return e===HP||WP(HP,e)&&t===HP.find?FP:t;},XP=jP;!function(e){e.exports=XP;}(AP);var YP=t(UP),qP={},ZP={get exports(){return qP;},set exports(e){qP=e;}},_P=o,GP=d,KP=T,$P=lm,JP=le,QP=Ui,eB=Cm,tB=_P.Function,iB=/MSIE .\./.test(JP)||"BUN"===$P&&function(){var e=_P.Bun.version.split(".");return e.length<3||"0"===e[0]&&(e[1]<3||"3"===e[1]&&"0"===e[2]);}(),rB=function rB(e,t){var i=t?2:1;return iB?function(r,n){var o=eB(arguments.length,1)>i,a=KP(r)?r:tB(r),s=o?QP(arguments,i):[],l=o?function(){GP(a,this,s);}:a;return t?e(l,n):e(l);}:e;},nB=Mi,oB=o,aB=rB(oB.setInterval,!0);nB({global:!0,bind:!0,forced:oB.setInterval!==aB},{setInterval:aB});var sB=Mi,lB=o,uB=rB(lB.setTimeout,!0);sB({global:!0,bind:!0,forced:lB.setTimeout!==uB},{setTimeout:uB});var cB=Q.setTimeout;!function(e){e.exports=cB;}(ZP);var hB=t(qP),dB={},fB={get exports(){return dB;},set exports(e){dB=e;}},vB=E,gB=a,mB=y,yB=Cu,pB=$r,wB=K,bB=mB(M.f),kB=mB([].push),SB=vB&&gB(function(){var e=Object.create(null);return e[2]=2,!bB(e,2);}),xB=function xB(e){return function(t){for(var i,r=wB(t),n=pB(r),o=SB&&null===yB(r),a=n.length,s=0,l=[];a>s;)i=n[s++],vB&&!(o?i in r:bB(r,i))||kB(l,e?[i,r[i]]:r[i]);return l;};},CB={entries:xB(!0),values:xB(!1)},VB=CB.entries;Mi({target:"Object",stat:!0},{entries:function entries(e){return VB(e);}});var TB=Q.Object.entries;!function(e){e.exports=TB;}(fB);var IB=t(dB),EB={},PB={get exports(){return EB;},set exports(e){EB=e;}};!function(e){e.exports=Yw;}(PB);var BB=t(EB),DB={},MB={get exports(){return DB;},set exports(e){DB=e;}},UB=Wr.includes;Mi({target:"Array",proto:!0,forced:a(function(){return!Array(1).includes();})},{includes:function includes(e){return UB(this,e,arguments.length>1?arguments[1]:void 0);}});var AB=Ef("Array","includes"),zB=J,RB=k,NB=gt("match"),OB=function OB(e){var t;return zB(e)&&(void 0!==(t=e[NB])?!!t:"RegExp"===RB(e));},LB=TypeError,WB=function WB(e){if(OB(e))throw new LB("The method doesn't accept regular expressions");return e;},FB=gt("match"),HB=function HB(e){var t=/./;try{"/./"[e](t);}catch(i){try{return t[FB]=!1,"/./"[e](t);}catch(e){}}return!1;},jB=Mi,XB=WB,YB=Z,qB=Co,ZB=HB,_B=y("".indexOf);jB({target:"String",proto:!0,forced:!ZB("includes")},{includes:function includes(e){return!!~_B(qB(YB(this)),qB(XB(e)),arguments.length>1?arguments[1]:void 0);}});var GB=Ef("String","includes"),KB=oe,$B=AB,JB=GB,QB=Array.prototype,eD=String.prototype,tD=function tD(e){var t=e.includes;return e===QB||KB(QB,e)&&t===QB.includes?$B:"string"==typeof e||e===eD||KB(eD,e)&&t===eD.includes?JB:t;},iD=tD;!function(e){e.exports=iD;}(MB);var rD=t(DB),nD={},oD={get exports(){return nD;},set exports(e){nD=e;}};!function(e){e.exports=nf;}(oD);var aD=t(nD),sD={},lD={get exports(){return sD;},set exports(e){sD=e;}},uD=Ef("Array","keys"),cD=Qi,hD=tt,dD=oe,fD=uD,vD=Array.prototype,gD={DOMTokenList:!0,NodeList:!0},mD=function mD(e){var t=e.keys;return e===vD||dD(vD,e)&&t===vD.keys||hD(gD,cD(e))?fD:t;};!function(e){e.exports=mD;}(lD);var yD=t(sD),pD={},wD={get exports(){return pD;},set exports(e){pD=e;}},bD={},kD={get exports(){return bD;},set exports(e){bD=e;}},SD=a(function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8});}}),xD=a,CD=J,VD=k,TD=SD,ID=Object.isExtensible,ED=xD(function(){ID(1);})||TD?function(e){return!!CD(e)&&(!TD||"ArrayBuffer"!==VD(e))&&(!ID||ID(e));}:ID,PD=!a(function(){return Object.isExtensible(Object.preventExtensions({}));}),BD=Mi,DD=y,MD=Fr,UD=J,AD=tt,zD=ti.f,RD=Vo,ND=Eo,OD=ED,LD=PD,WD=!1,FD=at("meta"),HD=0,jD=function jD(e){zD(e,FD,{value:{objectID:"O"+HD++,weakData:{}}});},XD=kD.exports={enable:function enable(){XD.enable=function(){},WD=!0;var e=RD.f,t=DD([].splice),i={};i[FD]=1,e(i).length&&(RD.f=function(i){for(var r=e(i),n=0,o=r.length;n<o;n++)if(r[n]===FD){t(r,n,1);break;}return r;},BD({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:ND.f}));},fastKey:function fastKey(e,t){if(!UD(e))return"symbol"==_typeof(e)?e:("string"==typeof e?"S":"P")+e;if(!AD(e,FD)){if(!OD(e))return"F";if(!t)return"E";jD(e);}return e[FD].objectID;},getWeakData:function getWeakData(e,t){if(!AD(e,FD)){if(!OD(e))return!0;if(!t)return!1;jD(e);}return e[FD].weakData;},onFreeze:function onFreeze(e){return LD&&WD&&OD(e)&&!AD(e,FD)&&jD(e),e;}};MD[FD]=!0;var YD=Mi,qD=o,ZD=bD,_D=a,GD=bi,KD=zg,$D=ym,JD=T,QD=J,eM=X,tM=la,iM=ti.f,rM=Ma.forEach,nM=E,oM=Ca.set,aM=Ca.getterFor,sM=function sM(e,t,i){var r,n=-1!==e.indexOf("Map"),o=-1!==e.indexOf("Weak"),a=n?"set":"add",s=qD[e],l=s&&s.prototype,u={};if(nM&&JD(s)&&(o||l.forEach&&!_D(function(){new s().entries().next();}))){var c=(r=t(function(t,i){oM($D(t,c),{type:e,collection:new s()}),eM(i)||KD(i,t[a],{that:t,AS_ENTRIES:n});})).prototype,h=aM(e);rM(["add","clear","delete","forEach","get","has","set","keys","values","entries"],function(e){var t="add"===e||"set"===e;!(e in l)||o&&"clear"===e||GD(c,e,function(i,r){var n=h(this).collection;if(!t&&o&&!QD(i))return"get"===e&&void 0;var a=n[e](0===i?0:i,r);return t?this:a;});}),o||iM(c,"size",{configurable:!0,get:function get(){return h(this).collection.size;}});}else r=i.getConstructor(t,e,n,a),ZD.enable();return tM(r,e,!1,!0),u[e]=r,YD({global:!0,forced:!0},u),o||i.setStrong(r,e,n),r;},lM=xn,uM=Oo,cM=Qx,hM=ei,dM=ym,fM=X,vM=zg,gM=gc,mM=mc,yM=vm,pM=E,wM=bD.fastKey,bM=Ca.set,kM=Ca.getterFor,SM={getConstructor:function getConstructor(e,t,i,r){var n=e(function(e,n){dM(e,o),bM(e,{type:t,index:lM(null),first:null,last:null,size:0}),pM||(e.size=0),fM(n)||vM(n,e[r],{that:e,AS_ENTRIES:i});}),o=n.prototype,a=kM(t),s=function s(e,t,i){var r,n,o=a(e),s=l(e,t);return s?s.value=i:(o.last=s={index:n=wM(t,!0),key:t,value:i,previous:r=o.last,next:null,removed:!1},o.first||(o.first=s),r&&(r.next=s),pM?o.size++:e.size++,"F"!==n&&(o.index[n]=s)),e;},l=function l(e,t){var i,r=a(e),n=wM(t);if("F"!==n)return r.index[n];for(i=r.first;i;i=i.next)if(i.key===t)return i;};return cM(o,{clear:function clear(){for(var e=a(this),t=e.first;t;)t.removed=!0,t.previous&&(t.previous=t.previous.next=null),t=t.next;e.first=e.last=null,e.index=lM(null),pM?e.size=0:this.size=0;},delete:function _delete(e){var t=this,i=a(t),r=l(t,e);if(r){var n=r.next,o=r.previous;delete i.index[r.index],r.removed=!0,o&&(o.next=n),n&&(n.previous=o),i.first===r&&(i.first=n),i.last===r&&(i.last=o),pM?i.size--:t.size--;}return!!r;},forEach:function forEach(e){for(var t,i=a(this),r=hM(e,arguments.length>1?arguments[1]:void 0);t=t?t.next:i.first;)for(r(t.value,t.key,this);t&&t.removed;)t=t.previous;},has:function has(e){return!!l(this,e);}}),cM(o,i?{get:function get(e){var t=l(this,e);return t&&t.value;},set:function set(e,t){return s(this,0===e?0:e,t);}}:{add:function add(e){return s(this,e=0===e?0:e,e);}}),pM&&uM(o,"size",{configurable:!0,get:function get(){return a(this).size;}}),n;},setStrong:function setStrong(e,t,i){var r=t+" Iterator",n=kM(t),o=kM(r);gM(e,t,function(e,t){bM(this,{type:r,target:e,state:n(e),kind:t,last:null});},function(){for(var e=o(this),t=e.kind,i=e.last;i&&i.removed;)i=i.previous;return e.target&&(e.last=i=i?i.next:e.state.first)?mM("keys"===t?i.key:"values"===t?i.value:[i.key,i.value],!1):(e.target=null,mM(void 0,!0));},i?"entries":"values",!i,!0),yM(t);}};sM("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0);};},SM);var xM=Ie,CM=TypeError,VM=function VM(e){if("object"==_typeof(e)&&"size"in e&&"has"in e&&"add"in e&&"delete"in e&&"keys"in e)return e;throw new CM(xM(e)+" is not a set");},TM=function TM(e,t){return 1===t?function(t,i){return t[e](i);}:function(t,i,r){return t[e](i,r);};},IM=TM,EM=ne("Set"),PM=EM.prototype,BM={Set:EM,add:IM("add",1),has:IM("has",1),remove:IM("delete",1),proto:PM},DM=D,MM=function MM(e,t,i){for(var r,n,o=i?e:e.iterator,a=e.next;!(r=DM(a,o)).done;)if(void 0!==(n=t(r.value)))return n;},UM=MM,AM=function AM(e,t,i){return i?UM(e.keys(),t,!0):e.forEach(t);},zM=AM,RM=BM.Set,NM=BM.add,OM=function OM(e){var t=new RM();return zM(e,function(e){NM(t,e);}),t;},LM=function LM(e){return e.size;},WM=De,FM=ai,HM=D,jM=Tr,XM=function XM(e){return{iterator:e,next:e.next,done:!1};},YM="Invalid size",qM=RangeError,ZM=TypeError,_M=Math.max,GM=function GM(e,t){this.set=e,this.size=_M(t,0),this.has=WM(e.has),this.keys=WM(e.keys);};GM.prototype={getIterator:function getIterator(){return XM(FM(HM(this.keys,this.set)));},includes:function includes(e){return HM(this.has,this.set,e);}};var KM=function KM(e){FM(e);var t=+e.size;if(t!=t)throw new ZM(YM);var i=jM(t);if(i<0)throw new qM(YM);return new GM(e,i);},$M=VM,JM=OM,QM=LM,eU=KM,tU=AM,iU=MM,rU=BM.has,nU=BM.remove,oU=function oU(){return!1;},aU=function aU(e){var t=$M(this),i=eU(e),r=JM(t);return QM(t)<=i.size?tU(t,function(e){i.includes(e)&&nU(r,e);}):iU(i.getIterator(),function(e){rU(r,e)&&nU(r,e);}),r;},sU=a;Mi({target:"Set",proto:!0,real:!0,forced:!oU()||sU(function(){var e={size:1,has:function has(){return!0;},keys:function keys(){var e=0;return{next:function next(){var i=e++>1;return t.has(1)&&t.clear(),{done:i,value:2};}};}},t=new Set([1,2,3,4]);return 3!==t.difference(e).size;})},{difference:aU});var lU=VM,uU=LM,cU=KM,hU=AM,dU=MM,fU=BM.Set,vU=BM.add,gU=BM.has,mU=a,yU=function yU(e){var t=lU(this),i=cU(e),r=new fU();return uU(t)>i.size?dU(i.getIterator(),function(e){gU(t,e)&&vU(r,e);}):hU(t,function(e){i.includes(e)&&vU(r,e);}),r;};Mi({target:"Set",proto:!0,real:!0,forced:!oU()||mU(function(){return"3,2"!==String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))));})},{intersection:yU});var pU=VM,wU=BM.has,bU=LM,kU=KM,SU=AM,xU=MM,CU=Vd,VU=function VU(e){var t=pU(this),i=kU(e);if(bU(t)<=i.size)return!1!==SU(t,function(e){if(i.includes(e))return!1;},!0);var r=i.getIterator();return!1!==xU(r,function(e){if(wU(t,e))return CU(r,"normal",!1);});};Mi({target:"Set",proto:!0,real:!0,forced:!oU()},{isDisjointFrom:VU});var TU=VM,IU=LM,EU=AM,PU=KM,BU=function BU(e){var t=TU(this),i=PU(e);return!(IU(t)>i.size)&&!1!==EU(t,function(e){if(!i.includes(e))return!1;},!0);};Mi({target:"Set",proto:!0,real:!0,forced:!oU()},{isSubsetOf:BU});var DU=VM,MU=BM.has,UU=LM,AU=KM,zU=MM,RU=Vd,NU=function NU(e){var t=DU(this),i=AU(e);if(UU(t)<i.size)return!1;var r=i.getIterator();return!1!==zU(r,function(e){if(!MU(t,e))return RU(r,"normal",!1);});};Mi({target:"Set",proto:!0,real:!0,forced:!oU()},{isSupersetOf:NU});var OU=VM,LU=OM,WU=KM,FU=MM,HU=BM.add,jU=BM.has,XU=BM.remove,YU=function YU(e){try{var t=new Set(),i={size:0,has:function has(){return!0;},keys:function keys(){return Object.defineProperty({},"next",{get:function get(){return t.clear(),t.add(4),function(){return{done:!0};};}});}},r=t[e](i);return 1===r.size&&4===r.values().next().value;}catch(e){return!1;}},qU=function qU(e){var t=OU(this),i=WU(e).getIterator(),r=LU(t);return FU(i,function(e){jU(t,e)?XU(r,e):HU(r,e);}),r;},ZU=YU;Mi({target:"Set",proto:!0,real:!0,forced:!oU()||!ZU("symmetricDifference")},{symmetricDifference:qU});var _U=VM,GU=BM.add,KU=OM,$U=KM,JU=MM,QU=function QU(e){var t=_U(this),i=$U(e).getIterator(),r=KU(t);return JU(i,function(e){GU(r,e);}),r;},eA=YU;Mi({target:"Set",proto:!0,real:!0,forced:!oU()||!eA("union")},{union:QU});var tA=Q.Set;!function(e){e.exports=tA;}(wD);var iA=t(pD),rA={},nA={get exports(){return rA;},set exports(e){rA=e;}},oA=jn,aA=zr,sA=Yn,lA=ei,_uA=function uA(e,t,i,r,n,o,a,s){for(var l,u,c=n,h=0,d=!!a&&lA(a,s);h<r;)h in i&&(l=d?d(i[h],h,t):i[h],o>0&&oA(l)?(u=aA(l),c=_uA(e,t,l,u,c,o-1)-1):(sA(c+1),e[c]=l),c++),h++;return c;},cA=_uA,hA=Je,dA=zr,fA=Tr,vA=io;Mi({target:"Array",proto:!0},{flat:function flat(){var e=arguments.length?arguments[0]:void 0,t=hA(this),i=dA(t),r=vA(t,0);return r.length=cA(r,t,t,i,0,void 0===e?1:fA(e)),r;}});var gA=Ef("Array","flat"),mA=oe,yA=gA,pA=Array.prototype,wA=function wA(e){var t=e.flat;return e===pA||mA(pA,e)&&t===pA.flat?yA:t;},bA=wA;!function(e){e.exports=bA;}(nA);var kA=t(rA),SA={},xA={get exports(){return SA;},set exports(e){SA=e;}},CA=o.isFinite,VA=Number.isFinite||function(e){return"number"==typeof e&&CA(e);};Mi({target:"Number",stat:!0},{isFinite:VA});var TA=Q.Number.isFinite;!function(e){e.exports=TA;}(xA);var IA=t(SA),EA={},PA={get exports(){return EA;},set exports(e){EA=e;}},BA=o,DA=a,MA=Co,UA=YS.trim,AA=NS,zA=y("".charAt),RA=BA.parseFloat,NA=BA.Symbol,OA=NA&&NA.iterator,LA=1/RA(AA+"-0")!=-1/0||OA&&!DA(function(){RA(Object(OA));})?function(e){var t=UA(MA(e)),i=RA(t);return 0===i&&"-"===zA(t,0)?-0:i;}:RA;Mi({global:!0,forced:parseFloat!==LA},{parseFloat:LA});var WA=Q.parseFloat;!function(e){e.exports=WA;}(PA);var FA=t(EA),HA={},jA={get exports(){return HA;},set exports(e){HA=e;}},XA=Mi,YA=C;I.f;var qA=Ur,ZA=Co,_A=WB,GA=Z,KA=HB,$A=YA("".slice),JA=Math.min;XA({target:"String",proto:!0,forced:!KA("startsWith")},{startsWith:function startsWith(e){var t=ZA(GA(this));_A(e);var i=qA(JA(arguments.length>1?arguments[1]:void 0,t.length)),r=ZA(e);return $A(t,i,i+r.length)===r;}});var QA=Ef("String","startsWith"),ez=oe,tz=QA,iz=String.prototype,rz=function rz(e){var t=e.startsWith;return"string"==typeof e||e===iz||ez(iz,e)&&t===iz.startsWith?tz:t;},nz=rz;!function(e){e.exports=nz;}(jA);var oz=t(HA),az={},sz={get exports(){return az;},set exports(e){az=e;}},lz=RV;Mi({target:"Object",stat:!0,arity:2,forced:Object.assign!==lz},{assign:lz});var uz=Q.Object.assign;!function(e){e.exports=uz;}(sz);var cz=t(az),hz={},dz={get exports(){return hz;},set exports(e){hz=e;}},fz=le.match(/firefox\/(\d+)/i),vz=!!fz&&+fz[1],gz=/MSIE|Trident/.test(le),mz=le.match(/AppleWebKit\/(\d+)\./),yz=!!mz&&+mz[1],pz=Mi,wz=y,bz=De,kz=Je,Sz=zr,xz=yE,Cz=Co,Vz=a,Tz=rC,Iz=$f,Ez=vz,Pz=gz,Bz=ge,Dz=yz,Mz=[],Uz=wz(Mz.sort),Az=wz(Mz.push),zz=Vz(function(){Mz.sort(void 0);}),Rz=Vz(function(){Mz.sort(null);}),Nz=Iz("sort"),Oz=!Vz(function(){if(Bz)return Bz<70;if(!(Ez&&Ez>3)){if(Pz)return!0;if(Dz)return Dz<603;var e,t,i,r,n="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:i=3;break;case 68:case 71:i=4;break;default:i=2;}for(r=0;r<47;r++)Mz.push({k:t+r,v:i});}for(Mz.sort(function(e,t){return t.v-e.v;}),r=0;r<Mz.length;r++)t=Mz[r].k.charAt(0),n.charAt(n.length-1)!==t&&(n+=t);return"DGBEFHACIJK"!==n;}});pz({target:"Array",proto:!0,forced:zz||!Rz||!Nz||!Oz},{sort:function sort(e){void 0!==e&&bz(e);var t=kz(this);if(Oz)return void 0===e?Uz(t):Uz(t,e);var i,r,n=[],o=Sz(t);for(r=0;r<o;r++)r in t&&Az(n,t[r]);for(Tz(n,function(e){return function(t,i){return void 0===i?-1:void 0===t?1:void 0!==e?+e(t,i)||0:Cz(t)>Cz(i)?1:-1;};}(e)),i=Sz(n),r=0;r<i;)t[r]=n[r++];for(;r<o;)xz(t,r++);return t;}});var Lz=Ef("Array","sort"),Wz=oe,Fz=Lz,Hz=Array.prototype,jz=function jz(e){var t=e.sort;return e===Hz||Wz(Hz,e)&&t===Hz.sort?Fz:t;},Xz=jz;!function(e){e.exports=Xz;}(dz);var Yz=t(hz),qz={},Zz={get exports(){return qz;},set exports(e){qz=e;}},_z={},Gz={get exports(){return _z;},set exports(e){_z=e;}},Kz=o;Mi({global:!0,forced:Kz.globalThis!==Kz},{globalThis:Kz});var $z={},Jz={get exports(){return $z;},set exports(e){$z=e;}};!function(e){e.exports=o;}(Jz);var Qz=$z;!function(e){e.exports=Qz;}(Gz),function(e){e.exports=_z;}(Zz);var eR=t(qz),tR={},iR={get exports(){return tR;},set exports(e){tR=e;}},rR=Mi,nR=jn,oR=y([].reverse),aR=[1,2];rR({target:"Array",proto:!0,forced:String(aR)===String(aR.reverse())},{reverse:function reverse(){return nR(this)&&(this.length=this.length),oR(this);}});var sR=Ef("Array","reverse"),lR=oe,uR=sR,cR=Array.prototype,hR=function hR(e){var t=e.reverse;return e===cR||lR(cR,e)&&t===cR.reverse?uR:t;},dR=hR;!function(e){e.exports=dR;}(iR);var fR=t(tR),vR={},gR={get exports(){return vR;},set exports(e){vR=e;}};sM("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0);};},SM);var mR=TM,yR=ne("Map"),pR={Map:yR,set:mR("set",2),get:mR("get",1),has:mR("has",1),remove:mR("delete",1),proto:yR.prototype},wR=Mi,bR=De,kR=Z,SR=zg,xR=pR.Map,CR=pR.has,VR=pR.get,TR=pR.set,IR=y([].push);wR({target:"Map",stat:!0,forced:true},{groupBy:function groupBy(e,t){kR(e),bR(t);var i=new xR(),r=0;return SR(e,function(e){var n=t(e,r++);CR(i,n)?IR(VR(i,n),e):TR(i,n,[e]);}),i;}});var ER=Q.Map;!function(e){e.exports=ER;}(gR);var PR=t(vR),BR={},DR={get exports(){return BR;},set exports(e){BR=e;}},MR=Tr,UR=Co,AR=Z,zR=RangeError,RR=y,NR=Ur,OR=Co,LR=function LR(e){var t=UR(AR(this)),i="",r=MR(e);if(r<0||r===1/0)throw new zR("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(i+=t);return i;},WR=Z,FR=RR(LR),HR=RR("".slice),jR=Math.ceil,XR=function XR(e){return function(t,i,r){var n,o,a=OR(WR(t)),s=NR(i),l=a.length,u=void 0===r?" ":OR(r);return s<=l||""===u?a:((o=FR(u,jR((n=s-l)/u.length))).length>n&&(o=HR(o,0,n)),e?a+o:o+a);};},YR=y,qR=a,ZR={start:XR(!1),end:XR(!0)}.start,_R=RangeError,GR=isFinite,KR=Math.abs,$R=Date.prototype,JR=$R.toISOString,QR=YR($R.getTime),eN=YR($R.getUTCDate),tN=YR($R.getUTCFullYear),iN=YR($R.getUTCHours),rN=YR($R.getUTCMilliseconds),nN=YR($R.getUTCMinutes),oN=YR($R.getUTCMonth),aN=YR($R.getUTCSeconds),sN=qR(function(){return"0385-07-25T07:06:39.999Z"!==JR.call(new Date(-50000000000001));})||!qR(function(){JR.call(new Date(NaN));})?function(){if(!GR(QR(this)))throw new _R("Invalid time value");var e=this,t=tN(e),i=rN(e),r=t<0?"-":t>9999?"+":"";return r+ZR(KR(t),r?6:4,0)+"-"+ZR(oN(e)+1,2,0)+"-"+ZR(eN(e),2,0)+"T"+ZR(iN(e),2,0)+":"+ZR(nN(e),2,0)+":"+ZR(aN(e),2,0)+"."+ZR(i,3,0)+"Z";}:JR,lN=D,uN=Je,cN=xt,hN=sN,dN=k;Mi({target:"Date",proto:!0,forced:a(function(){return null!==new Date(NaN).toJSON()||1!==lN(Date.prototype.toJSON,{toISOString:function toISOString(){return 1;}});})},{toJSON:function toJSON(e){var t=uN(this),i=cN(t,"number");return"number"!=typeof i||isFinite(i)?"toISOString"in t||"Date"!==dN(t)?t.toISOString():lN(hN,t):null;}});var fN=Q,vN=d;fN.JSON||(fN.JSON={stringify:JSON.stringify});var gN=function gN(e,t,i){return vN(fN.JSON.stringify,null,arguments);},mN=gN;!function(e){e.exports=mN;}(DR);var yN=t(BR),pN={},wN={get exports(){return pN;},set exports(e){pN=e;}},bN=CB.values;Mi({target:"Object",stat:!0},{values:function values(e){return bN(e);}});var kN=Q.Object.values;!function(e){e.exports=kN;}(wN);var SN=t(pN),xN={},CN={get exports(){return xN;},set exports(e){xN=e;}};!function(e){e.exports=Dv;}(CN);var VN=t(xN),TN={},IN={get exports(){return TN;},set exports(e){TN=e;}},EN=Ma.some;Mi({target:"Array",proto:!0,forced:!$f("some")},{some:function some(e){return EN(this,e,arguments.length>1?arguments[1]:void 0);}});var PN=Ef("Array","some"),BN=oe,DN=PN,MN=Array.prototype,UN=function UN(e){var t=e.some;return e===MN||BN(MN,e)&&t===MN.some?DN:t;},AN=UN;!function(e){e.exports=AN;}(IN);var zN=t(TN),RN={},NN={get exports(){return RN;},set exports(e){RN=e;}};!function(e){e.exports=Kb;}(NN);var ON,LN,WN,FN,HN,jN,XN,YN,qN,ZN=t(RN),_N=["style"],GN=["style"],KN=["style"],$N=["style"],JN=["style"],QN=["style"],eO=["style"],tO=["style"];function iO(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,i="function"==typeof Mc?Mc:{},r=i.iterator||"@@iterator",n=i.toStringTag||"@@toStringTag";function o(i,r,n,o){var l=r&&r.prototype instanceof s?r:s,u=Oc(l.prototype);return _rO(u,"_invoke",function(i,r,n){var o,s,l,u=0,c=n||[],h=!1,_d2={p:0,n:0,v:e,a:f,f:VN(f).call(f,e,4),d:function d(t,i){return o=t,s=0,l=e,_d2.n=i,a;}};function f(i,r){for(s=i,l=r,t=0;!h&&u&&!n&&t<c.length;t++){var n,o=c[t],f=_d2.p,v=o[2];i>3?(n=v===r)&&(l=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=f&&((n=i<2&&f<o[1])?(s=0,_d2.v=r,_d2.n=o[1]):f<v&&(n=i<3||o[0]>r||r>v)&&(o[4]=i,o[5]=r,_d2.n=v,s=0));}if(n||i>1)return a;throw h=!0,r;}return function(n,c,v){if(u>1)throw TypeError("Generator is already running");for(h&&1===c&&f(c,v),s=c,l=v;(t=s<2?e:l)||!h;){o||(s?s<3?(s>1&&(_d2.n=-1),f(s,l)):_d2.n=l:_d2.v=l);try{if(u=2,o){if(s||(n="next"),t=o[n]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,s<2&&(s=0);}else 1===s&&(t=o.return)&&t.call(o),s<2&&(l=TypeError("The iterator does not provide a '"+n+"' method"),s=1);o=e;}else if((t=(h=_d2.n<0)?l:i.call(r,_d2))!==a)break;}catch(t){o=e,s=1,l=t;}finally{u=1;}}return{value:t,done:h};};}(i,n,o),!0),u;}var a={};function s(){}function l(){}function u(){}t=Yc;var c=[][r]?t(t([][r]())):(_rO(t={},r,function(){return this;}),t),h=u.prototype=s.prototype=Oc(c);function d(e){return Gc?Gc(e,u):(e.__proto__=u,_rO(e,n,"GeneratorFunction")),e.prototype=Oc(h),e;}return l.prototype=u,_rO(h,"constructor",u),_rO(u,"constructor",l),l.displayName="GeneratorFunction",_rO(u,n,"GeneratorFunction"),_rO(h),_rO(h,n,"Generator"),_rO(h,r,function(){return this;}),_rO(h,"toString",function(){return"[object Generator]";}),(iO=function iO(){return{w:o,m:d};})();}function _rO(e,t,i,r){var n=ZN;try{n({},"",{});}catch(e){n=0;}_rO=function rO(e,t,i,r){function o(t,i){_rO(e,t,function(e){return this._invoke(t,i,e);});}t?n?n(e,t,{value:i,enumerable:!r,configurable:!r,writable:!r}):e[t]=i:(o("next",0),o("throw",1),o("return",2));},_rO(e,t,i,r);}function nO(e,t,i){return t=rb(t),function(e,t){if(t&&("object"===Kh(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Kw(e);}(e,Zv()?Ln(t,i||[],rb(e).constructor):t.apply(e,i));}function oO(e,t,i,r){var n=Mb(rb(1&r?e.prototype:e),t,i);return 2&r&&"function"==typeof n?function(e){return n.apply(i,e);}:n;}var aO={code:0,message:"ok."},sO={code:8e4,message:"The parameter type is wrong."},lO={code:80002,message:"The parameter is out of range."},uO={code:80003,message:"The image does not exist."},cO={code:80013,message:"The parameter is invalid."},hO={code:80021,message:"The size is invalid."},dO=function dO(e){return e.replace(/[A-Z]/g,function(e){return"-".concat(e.toLowerCase());});},fO=function fO(e){return Object.prototype.toString.call(e);},vO=function vO(e){return gS?gS(e):"[object Array]"===fO(e);},gO=function gO(e){return null!==e&&"[object Object]"===fO(e);},_mO=function mO(e){var t,i=null;return vO(e)&&(i||(i=[]),pS(e).call(e,function(e){i.push(_mO(e));})),gO(e)&&(i||(i={}),pS(t=kS(e)).call(t,function(t){i[t]=_mO(e[t]);})),i||e;};function yO(e,t){for(var i in t)e[i]=e[i]&&"[object Object]"===e[i].toString()?yO(e[i],t[i]):e[i]=t[i];return e;}var pO=function pO(e){return void 0===e;},wO=function wO(e,t){var i,r;e=null!==(i=e)&&void 0!==i?i:"yyyy-MM-dd hh:mm:ss";var n=pO(t)?new Date():new Date(t),o={"M+":(n.getMonth()+1).toString(),"d+":n.getDate().toString(),"h+":n.getHours().toString(),"m+":n.getMinutes().toString(),"s+":n.getSeconds().toString(),"q+":Math.floor((n.getMonth()+3)/3).toString(),S:n.getMilliseconds().toString()};return /(y+)/.test(e)&&(e=e.replace(RegExp.$1,"".concat(n.getFullYear()).substring(4-RegExp.$1.length))),pS(r=kS(o)).call(r,function(t){new RegExp("(".concat(t,")")).test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?o[t]:"00".concat(o[t]).substring("".concat(o[t]).length)));}),e;},bO=function bO(e){return"string"==typeof e;};function kO(e,t){return Math.pow(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2),.5);}function SO(e){var t=e.type,i=e.value;return"hex"===t?"#".concat(i):"literal"===t?i:"rgb"===t?"rgb(".concat(i.join(","),")"):"rgba(".concat(i.join(","),")");}var xO=function(){var e=/^(linear\-gradient)/i,t=/^(repeating\-linear\-gradient)/i,i=/^(radial\-gradient)/i,r=/^(repeating\-radial\-gradient)/i,n=/^(conic\-gradient)/i,o=/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,a=/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,s=/^(left|center|right|top|bottom)/i,l=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,u=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,c=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,h=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,d=/^\(/,f=/^\)/,v=/^,/,g=/^\#([0-9a-fA-F]+)/,m=/^([a-zA-Z]+)/,y=/^rgb/i,p=/^rgba/i,w=/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/,b="";function k(e){var t;throw new Error(BS(t="".concat(b,": ")).call(t,e));}function S(){return x("linear-gradient",e,V)||x("repeating-linear-gradient",t,V)||x("radial-gradient",i,T)||x("repeating-radial-gradient",r,T)||x("conic-gradient",n,T);}function x(e,t,i){return C(t,function(t){var r=i();return r&&(N(v)||k("Missing comma before color stops")),{type:e,orientation:r,colorStops:D(M)};});}function C(e,t){var i=N(e);if(i){N(d)||k("Missing (");var r=t(i);return N(f)||k("Missing )"),r;}}function V(){return R("directional",o,1)||R("angular",h,1);}function T(){var e,t,i=I();return i&&((e=[]).push(i),t=b,N(v)&&((i=I())?e.push(i):b=t)),e;}function I(){var e=function(){var e=R("shape",/^(circle)/i,0);return e&&(e.style=z()||E()),e;}()||function(){var e=R("shape",/^(ellipse)/i,0);return e&&(e.style=A()||E()),e;}();if(e)e.at=P();else{var t=E();if(t){e=t;var i=P();i&&(e.at=i);}else{var r=B();r&&(e={type:"default-radial",at:r});}}return e;}function E(){return R("extent-keyword",a,1);}function P(){if(R("position",/^at/,0)){var e=B();return e||k("Missing positioning value"),e;}}function B(){var e={x:A(),y:A()};if(e.x||e.y)return{type:"position",value:e};}function D(e){var t=e(),i=[];if(t)for(i.push(t);N(v);)(t=e())?i.push(t):k("One extra comma");return i;}function M(){var e=R("hex",g,1)||C(p,function(){return{type:"rgba",value:D(U)};})||C(y,function(){return{type:"rgb",value:D(U)};})||R("literal",m,0);return e||k("Expected color definition"),e.length=A(),e;}function U(){return N(w)[1];}function A(){return R("%",u,1)||R("position-keyword",s,1)||z();}function z(){return R("px",l,1)||R("em",c,1);}function R(e,t,i){var r=N(t);if(r)return{type:e,value:r[i]};}function N(e){var t=/^[\n\r\t\s]+/.exec(b);t&&O(t[0].length);var i=e.exec(b);return i&&O(i[0].length),i;}function O(e){b=b.substring(e);}return function(e){return b=e,function(){var e=D(S);return b.length>0&&k("Invalid input not EOF"),e;}();};}(),CO=function CO(e){return"number"==typeof e&&!AS(e);},VO=function VO(e){return"[object Boolean]"===fO(e);},TO=function TO(e){return"function"==typeof e;},IO=function IO(){return void 0!==document.documentMode;},EO=function EO(){return"ontouchstart"in document.documentElement;};function PO(e){return null==e;}var BO=function BO(e,t){return e in t;},DO=function DO(e,t){for(var i=[];e;){var r=e.match(t);if(!r)break;i.push(r),e=e.substring(r.index+r[0].length);}return i;};function MO(e,t){var i;return pS(i=kS(e)).call(i,function(i){pO(t[i])?t[i]=e[i]:gO(e[i])?MO(e[i],t[i]):t[i]=e[i];}),t;}var UO=0,AO=function AO(){var e;return UO+=1,BS(e="".concat(new Date().getTime().toString(36))).call(e,UO.toString(36));},zO=function zO(e,t,i){return Math.min(Math.max(e,t),i);},RO="\\s*([+-]?\\d+)\\s*",NO="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",OO="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",LO=/^#([0-9a-f]{3,8})$/,WO=new RegExp(BS(ON="^rgb\\(".concat(RO,",").concat(RO,",")).call(ON,RO,"\\)$")),FO=new RegExp(BS(LN="^rgb\\(".concat(OO,",").concat(OO,",")).call(LN,OO,"\\)$")),HO=new RegExp(BS(WN=BS(FN="^rgba\\(".concat(RO,",").concat(RO,",")).call(FN,RO,",")).call(WN,NO,"\\)$")),jO=new RegExp(BS(HN=BS(jN="^rgba\\(".concat(OO,",").concat(OO,",")).call(jN,OO,",")).call(HN,NO,"\\)$")),XO=new RegExp(BS(XN="^hsl\\(".concat(NO,",").concat(OO,",")).call(XN,OO,"\\)$")),YO=new RegExp(BS(YN=BS(qN="^hsla\\(".concat(NO,",").concat(OO,",")).call(qN,OO,",")).call(YN,NO,"\\)$")),qO={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ZO=hS(function e(t,i,r,n){dS(this,e),sS(this,"r",void 0),sS(this,"g",void 0),sS(this,"b",void 0),sS(this,"opacity",void 0),this.r=t,this.g=i,this.b=r,this.opacity=n;});function _O(e){return new ZO(e>>16&255,e>>8&255,255&e,1);}function GO(e,t,i,r){return r<=0&&(e=NaN,t=NaN,i=NaN),new ZO(e,t,i,r);}function KO(e,t,i,r){return r<=0?(e=NaN,t=NaN,i=NaN):i<=0||i>=1?(e=NaN,t=NaN):t<=0&&(e=NaN),{h:e,s:t,l:i,opacity:r};}function $O(e,t,i){return e<60?(t+(i-t)*e)/60*255:e<180?255*i:e<240?(t+(i-t)*(240-e))/60*255:255*t;}function JO(e){var t=e.h<0?e.h%360+360:e.h%360,i=AS(t)||AS(e.s)?0:e.s,r=e.l,n=r+(r<.5?r:1-r)*i,o=2*r-n;return new ZO($O(t>=240?t-240:t+120,o,n),$O(t,o,n),$O(t<120?t+240:t-120,o,n),e.opacity);}var QO;function eL(e){var t,i;return e?zx(t=Ox(i=kS(e)).call(i,function(t){return null!==e[t]&&void 0!==e[t];})).call(t,function(t,i){return uS(uS({},t),{},sS({},i,e[i]));},{}):{};}function tL(){return void 0===QO&&(QO=/Mac OS/.test(navigator.userAgent)),QO;}var iL,rL={"&amp;":"&","&gt;":">","&lt;":"<","&nbsp;":" ","&quot;":'"',"&#x27;":"'"},nL={};function oL(e,t){for(var i=kS(e),r=0;r<i.length;r++){var n=i[r];if(!1===t.call(null,e[n],n,e))break;}}function aL(e){return 0===e.length?"":e.replace(function(){if(iL)return iL;var e="";return oL(nL,function(t){e+="".concat(t,"|");}),e+="&#(\\d{1,5});",iL=new RegExp(e,"g");}(),function(e,t){return rL[e]||String.fromCharCode(+t);});}oL(rL,function(e,t){nL[e]=t;}),function(e,t){for(var i=kS(e),r=0;r<i.length;r++){var n=i[r];if(!1===t.call(null,e[n],n,e))break;}}({"&amp;":"&","&gt;":">","&lt;":"<","&nbsp;":" ","&quot;":'"',"&#x27;":"'"},function(e,t){});var sL=function sL(e,t,i){void 0===t?i.appendChild(e):i.insertBefore(e,t);},lL=function lL(e,t){var i=t.parentNode;i.lastChild===t?i.appendChild(e):sL(e,t.nextSibling,i);},uL=function uL(e){e&&(e.stopPropagation?e.stopPropagation():e.cancelBubble=!0);},cL=function cL(e){var t=tE||window.webkitURL,i="string";return bO(e)?i="string":"[object Blob]"===fO(e)?(i="blob",e=t.createObjectURL(e)):("[object ArrayBuffer]"===fO(e)||vO(e))&&(i="blob",e=t.createObjectURL(new Blob([e]))),{type:i,data:e};},hL=function hL(){var e=window;if(e){if(e.devicePixelRatio)return e.devicePixelRatio;if(e.screen.deviceXDPI&&e.screen.logicalXDPI)return e.screen.deviceXDPI/e.screen.logicalXDPI;}return 1;},dL=function dL(e){var t=tE||window.webkitURL;/^blob:/.test(e)&&t.revokeObjectURL(e);},fL=function fL(){return{scrollX:void 0===window.scrollX?window.pageXOffset:window.scrollX,scrollY:void 0===window.scrollY?window.pageYOffset:window.scrollY};},vL=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";dS(this,e),sS(this,"prefix",void 0),sS(this,"postfix",void 0),sS(this,"isDestroyed",!1),sS(this,"uid",AO()),sS(this,"cacheEvents",void 0),sS(this,"events",void 0),sS(this,"isCached",void 0),this.cacheEvents=[],this.events={},this.isCached=!1,this.prefix=t,this.postfix=i;}return hS(e,[{key:"save",value:function value(){this.isCached=!0;}},{key:"restore",value:function value(){var e,t=this;this.isCached=!1,pS(e=this.cacheEvents).call(e,function(e){var i,r=e.eventName,n=e.param;t.emit.apply(t,BS(i=[r]).call(i,tk(n)));}),this.cacheEvents.length=0;}},{key:"destroy",value:function value(){var e=this;if(!this.isDestroyed){for(var t in this.events)if(Object.prototype.hasOwnProperty.call(this.events,t)){var i,r=this.events[t];r&&pS(i=nE(r).call(r)).call(i,function(t){var i=t.name,r=t.fn,n=t.context,o=t.once;e.off(i,r,n,o);});}this.events={},this.isDestroyed=!0;}}},{key:"on",value:function value(e,t,i){var r,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.events,a={name:e=this.format(e),uid:AO(),context:i,once:n,fn:t};return o[e]||(o[e]=[]),sE(r=o[e]).call(r,a)<0&&o[e].push(a),a;}},{key:"once",value:function value(e,t,i){return this.on(e,t,i,!0);}},{key:"emit",value:function value(e){for(var t,i,r=this,n=arguments.length,o=new Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];if(this.isCached)return this.cacheEvents.push({eventName:e,param:o}),!0;var s=this.events[e=this.format(e)];return!(!s||!s.length||(pS(t=nE(s).call(s)).call(t,function(e){var t,i=e.fn,r=e.context;i.call.apply(i,BS(t=[r||null]).call(t,o));}),pS(i=nE(s).call(s)).call(i,function(t){var i=t.fn,n=t.context,o=t.once;o&&r.off(e,i,n,o);}),0));}},{key:"off",value:function value(e,t,i,r){var n=this.events[e=this.format(e)];if(!n)return!1;if(!arguments.length)return n.length=0,!0;for(var o=n.length-1;o>=0;o--){var a=n[o];t&&a.fn!==t||i&&a.context!==i||r&&a.once!==r||NE(n).call(n,o,1);}return!0;}},{key:"removeAllEventListeners",value:function value(e){if(e){var t,i;e=this.format(e);var r=KE(t=this.cacheEvents).call(t,function(t){return t.eventName===e;});r>-1&&NE(i=this.cacheEvents).call(i,r,1),this.events[e]&&delete this.events[e];}else this.cacheEvents=[],this.events={};}},{key:"getAllEvents",value:function value(){return this.events;}},{key:"format",value:function value(e){var t,i;return BS(t=BS(i="".concat(this.prefix||"")).call(i,e)).call(t,this.postfix||"");}}],[{key:"create",value:function value(t,i){return new e(t,i);}}]);}(),gL="default",mL=function(){function e(){dS(this,e),sS(this,"emitter",new vL());}return hS(e,[{key:"on",value:function value(e){this.emitter.on(gL,e);}},{key:"emit",value:function value(){for(var e,t,i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];(e=this.emitter).emit.apply(e,BS(t=[gL]).call(t,r));}},{key:"off",value:function value(e){this.emitter.off(gL,e);}}],[{key:"create",value:function value(){return new e();}}]);}(),yL=function yL(e){return e/180*Math.PI;},pL=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;dS(this,e),sS(this,"x",void 0),sS(this,"y",void 0),sS(this,"z",void 0),this.x=t,this.y=i,this.z=r;}return hS(e,[{key:"setFromVector",value:function value(e){var t;this.x=e.x,this.y=e.y,this.z=null!==(t=e.z)&&void 0!==t?t:0;}},{key:"clone",value:function value(){return new e(this.x,this.y,this.z);}},{key:"norm",value:function value(){return nP(this.x,this.y,this.z);}},{key:"dot",value:function value(e){var t;return this.x*e.x+this.y*e.y+this.z*(null!==(t=e.z)&&void 0!==t?t:0);}},{key:"projectionTo",value:function value(e){var t=nP(e.x,e.y,e.z);return this.dot(e)/t;}},{key:"angle",value:function value(e){var t=this.norm()*nP(e.x,e.y,e.z),i=t&&this.dot(e)/t;return Math.acos(zO(i,-1,1));}},{key:"equals",value:function value(e){var t;return this.x===e.x&&this.y===e.y&&this.z===(null!==(t=e.z)&&void 0!==t?t:0);}},{key:"distance",value:function value(e){var t;return nP(this.x-e.x,this.y-e.y,this.z-(null!==(t=e.z)&&void 0!==t?t:0));}},{key:"lerp",value:function value(t){var i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,n=this.x,o=this.y,a=this.z;return new e(n+r*(t.x-n),o+r*(t.y-o),a+r*((null!==(i=t.z)&&void 0!==i?i:0)-a));}},{key:"normalize",value:function value(){var e=this,t=e.norm();return e.x/=t,e.y/=t,e.z/=t,this;}},{key:"negate",value:function value(){return this.x*=-1,this.y*=-1,this.z*=-1,this;}},{key:"cross",value:function value(e){var t=this;return{x:t.y*e.z-t.z*e.y,y:t.z*e.x-t.x*e.z,z:t.x*e.y-t.y*e.x};}},{key:"add",value:function value(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this;}},{key:"multiply",value:function value(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this;}}],[{key:"fromPoint",value:function value(t){return new e(t.x,t.y,t.z);}},{key:"fromTwoPoint",value:function value(t,i){var r,n,o,a,s,l;return new e((null!==(r=i.x)&&void 0!==r?r:0)-(null!==(n=t.x)&&void 0!==n?n:0),(null!==(o=i.y)&&void 0!==o?o:0)-(null!==(a=t.y)&&void 0!==a?a:0),(null!==(s=i.z)&&void 0!==s?s:0)-(null!==(l=t.z)&&void 0!==l?l:0));}},{key:"fromValue",value:function value(t,i,r){return new e(t,i,r);}}]);}();function wL(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return CO(e)?pL.fromValue(e,t,i):pL.fromPoint(e);}function bL(e,t){return pL.fromTwoPoint(e,t);}var kL=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;dS(this,e),sS(this,"x",void 0),sS(this,"y",void 0),sS(this,"z",void 0),this.x=t,this.y=i,this.z=r;}return hS(e,[{key:"matrixTransform",value:function value(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.x,i=this.y,r=this.z,n=e.m11,o=e.m21,a=e.m31,s=e.m41,l=e.m12,u=e.m22,c=e.m32,h=e.m42,d=e.m13,f=e.m23,v=e.m33,g=e.m43,m=e.m14*t+e.m24*i+e.m34*r+e.m44;return SL({x:(n*t+o*i+a*r+s)/m,y:(l*t+u*i+c*r+h)/m,z:(d*t+f*i+v*r+g)/m});}},{key:"setFromPoint",value:function value(e){return this.x=e.x||0,this.y=e.y||0,this.z=e.z||0,this;}},{key:"clone",value:function value(){return SL(this);}},{key:"equals",value:function value(e){var t=e.x,i=void 0===t?0:t,r=e.y,n=void 0===r?0:r,o=e.z,a=void 0===o?0:o,s=this;return s.x===i&&s.y===n&&s.z===a;}},{key:"distanceTo",value:function value(e){var t=e.x,i=void 0===t?0:t,r=e.y,n=void 0===r?0:r,o=e.z,a=void 0===o?0:o,s=this;return nP(s.x-i,s.y-n,s.z-a);}},{key:"lerpTo",value:function value(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,i=e.x,r=void 0===i?0:i,n=e.y,o=void 0===n?0:n,a=e.z,s=void 0===a?0:a,l=this;return SL({x:l.x+t*(r-l.x),y:l.y+t*(o-l.y),z:l.z+t*(s-l.z)});}},{key:"footPointInSegment",value:function value(e,t){var i=bL(e,this),r=bL(e,t),n=r.norm(),o=SL(e);if(0===n)return o;var a=i.projectionTo(r)/n;return o.lerpTo(t,a);}},{key:"perpendicularToSegment",value:function value(e,t){var i=this.footPointInSegment(e,t);return this.distanceTo(i);}}],[{key:"fromPoint",value:function value(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new e(t.x,t.y,t.z);}}]);}();function SL(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return CO(e)?new kL(e,t,i):new kL(e.x,e.y,e.z);}var xL=function xL(e){return e/Math.PI*180;},CL=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;dS(this,e),sS(this,"x",void 0),sS(this,"y",void 0),sS(this,"z",void 0),sS(this,"w",void 0),this.x=t,this.y=i,this.z=r,this.w=n;}return hS(e,[{key:"clone",value:function value(){var t=new e();return t.setFromQuat(this),t;}},{key:"setFromQuat",value:function value(e){var t,i,r,n,o=this;return o.x=null!==(t=e.x)&&void 0!==t?t:0,o.y=null!==(i=e.y)&&void 0!==i?i:0,o.z=null!==(r=e.z)&&void 0!==r?r:0,o.w=null!==(n=e.w)&&void 0!==n?n:1,this;}},{key:"toEuler",value:function value(){var e=this.x,t=this.y,i=this.z,r=this.w,n=.4990234375,o=this.w*this.y-this.x*this.z;if(o<-n||o>n){var a=uP(o);return{z:-2*a*Math.atan2(this.x,this.w),y:a*(Math.PI/2),x:0};}return{x:xL(Math.atan2(2*(t*i+r*e),r*r-e*e-t*t+i*i)),y:xL(Math.asin(-2*(e*i-r*t))),z:xL(Math.atan2(2*(e*t+r*i),r*r+e*e-t*t-i*i))};}},{key:"invert",value:function value(){var e=this.x,t=this.y,i=this.z,r=this.w,n=e*e+t*t+i*i+r*r,o=n?1/n:0;return this.x=-e*o,this.y=-t*o,this.z=-i*o,this.w=r*o,this;}},{key:"multiply",value:function value(e){var t=this.x,i=this.y,r=this.z,n=this.w,o=e.x,a=e.y,s=e.z,l=e.w;return this.x=t*l+n*o+i*s-r*a,this.y=i*l+n*a+r*o-t*s,this.z=r*l+n*s+t*a-i*o,this.w=n*l-t*o-i*a-r*s,this;}},{key:"normalize",value:function value(){var e=this.x,t=this.y,i=this.z,r=this.w,n=e*e+t*t+i*i+r*r;return this.x/=n,this.y/=n,this.z/=n,this.w/=n,this;}}],[{key:"fromQuat",value:function value(t){return new e().setFromQuat(t);}},{key:"fromEuler",value:function value(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;t=yL(t)/2,i=yL(i)/2,r=yL(r)/2;var n=Math.sin(t),o=Math.cos(t),a=Math.sin(i),s=Math.cos(i),l=Math.sin(r),u=Math.cos(r),c=new e();return c.setFromQuat({x:n*s*u-o*a*l,y:o*a*u+n*s*l,z:o*s*l-n*a*u,w:o*s*u+n*a*l}),c;}}]);}();function VL(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return CO(e)?new CL(e,t,i,r):CL.fromQuat(e);}function TL(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return CL.fromEuler(e,t,i);}var IL=function(){return hS(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;dS(this,e),sS(this,"x",void 0),sS(this,"y",void 0),sS(this,"z",void 0),sS(this,"w",void 0),this.x=t,this.y=i,this.z=r,this.w=n;},[{key:"negate",value:function value(){this.x*=-1,this.y*=-1,this.z*=-1,this.w*=-1;}},{key:"normalize",value:function value(){var e=this.norm();this.x/=e,this.y/=e,this.z/=e,this.w/=e;}},{key:"norm",value:function value(){return nP(this.x,this.y,this.z,this.w);}}]);}();function EL(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return CO(e)?new IL(e,t,i,r):new IL(e.x,e.y,e.z,e.w);}var PL=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],BL=function(){function e(t){if(dS(this,e),sS(this,"a",1),sS(this,"b",0),sS(this,"c",0),sS(this,"d",1),sS(this,"e",0),sS(this,"f",0),sS(this,"m11",1),sS(this,"m12",0),sS(this,"m13",0),sS(this,"m14",0),sS(this,"m21",0),sS(this,"m22",1),sS(this,"m23",0),sS(this,"m24",0),sS(this,"m31",0),sS(this,"m32",0),sS(this,"m33",1),sS(this,"m34",0),sS(this,"m41",0),sS(this,"m42",0),sS(this,"m43",0),sS(this,"m44",1),sS(this,"is2D",void 0),t||(t=PL),bO(t));else{if(!vO(t))throw new Error("DefaultMatrix error.");AL(t,this);}}return hS(e,[{key:"isIdentity",get:function get(){for(var e=this.toArray(),t=0;t<16;t++)if(e[t]!==PL[t])return!1;return!0;}},{key:"translate",value:function value(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.clone().translateSelf(e,t,i);}},{key:"scale",value:function value(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return pO(t)&&(t=e),this.clone().scaleSelf(e,t,i,r,n,o);}},{key:"scale3d",value:function value(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this.clone().scale3dSelf(e,t,i,r);}},{key:"rotate",value:function value(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;return this.clone().rotateSelf(e,t,i);}},{key:"rotateFromVector",value:function value(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.clone().rotateFromVectorSelf(e,t);}},{key:"rotateAxisAngle",value:function value(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this.clone().rotateAxisAngleSelf(e,t,i,r);}},{key:"skewX",value:function value(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.clone().skewXSelf(e);}},{key:"skewY",value:function value(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.clone().skewYSelf(e);}},{key:"multiply",value:function value(e){return this.clone().multiplySelf(e);}},{key:"flipX",value:function value(){return this.clone().multiplySelf(new e([-1,0,0,1,0,0]));}},{key:"flipY",value:function value(){return this.clone().multiplySelf(new e([1,0,0,-1,0,0]));}},{key:"inverse",value:function value(){return this.clone().invertSelf();}},{key:"transformPoint",value:function value(){return SL(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).matrixTransform(this);}},{key:"toFloat32Array",value:function value(){var e=this.toArray();return new Float32Array(e);}},{key:"toFloat64Array",value:function value(){var e=this.toArray();return new Float64Array(e);}},{key:"toJSON",value:function value(){}},{key:"multiplySelf",value:function value(){var e=zL(this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return this.setFromMatrix(e),this;}},{key:"preMultiplySelf",value:function value(){var e=zL(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},this);return this.setFromMatrix(e),this;}},{key:"translateSelf",value:function value(){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,t=function(){return{m11:1,m21:0,m31:0,m41:arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,m12:0,m22:1,m32:0,m42:arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,m13:0,m23:0,m33:1,m43:arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,m14:0,m24:0,m34:0,m44:1};}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e);return this.multiplySelf(t),e&&(this.is2D=!1),this;}},{key:"scaleSelf",value:function value(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;this.translateSelf(r,n,o),pO(t)&&(t=e);var a=function(){return{m11:arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,m21:0,m31:0,m41:0,m12:0,m22:arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,m32:0,m42:0,m13:0,m23:0,m33:arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,m43:0,m14:0,m24:0,m34:0,m44:1};}(e,t,i);return this.multiplySelf(a),this.translateSelf(-r,-n,-o),1!==i&&(this.is2D=!1),this;}},{key:"scale3dSelf",value:function value(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this.scaleSelf(e,e,e,t,i,r);}},{key:"rotateSelf",value:function value(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;pO(t)&&pO(i)&&(i=e,e=0,t=0),pO(t)&&(t=0),pO(i)&&(i=0),0===e&&0===t||(this.is2D=!1);var r=RL(i,[0,0,1]),n=RL(t,[0,1,0]),o=RL(e,[1,0,0]);return this.multiplySelf(r),this.multiplySelf(n),this.multiplySelf(o),this;}},{key:"rotateFromVectorSelf",value:function value(){var e=wL(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0),t=wL(1,0),i=RL(e.angle(t),[0,0,1]);return this.multiplySelf(i),this;}},{key:"rotateAxisAngleSelf",value:function value(){var e=RL(arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,[arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0]);return this.multiplySelf(e),this;}},{key:"skewXSelf",value:function value(){var e=NL(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,0);return this.multiplySelf(e),this;}},{key:"skewYSelf",value:function value(){var e=NL(0,arguments.length>0&&void 0!==arguments[0]?arguments[0]:0);return this.multiplySelf(e),this;}},{key:"invertSelf",value:function value(){var e=function(e){if(e[0].length!==e.length)throw new Error();for(var t=ML(e),i=function(e,t,i){if(e[0].length!==e.length)throw new Error("Not square matrix.");for(var r=e.length,n=wP(t=MP(i=new Array(r)).call(i,0)).call(t,function(e){var t;return MP(t=new Array(r)).call(t,0);}),o=0;o<r;o++)for(var a=0;a<r;a++)n[o][a]=UL(e,o,a);return function(e,t,i){for(var r=wP(t=MP(i=new Array(e.length)).call(i,0)).call(t,function(t){var i;return MP(i=new Array(e[0].length)).call(i,0);}),n=0;n<r.length;n++)for(var o=0;o<r[0].length;o++)r[n][o]=e[o][n];return r;}(n);}(e),r=0;r<i.length;r++)for(var n=0;n<i.length;n++)i[r][n]/=t;return i;}(this.toTwoDimensionalArray());return this.setFromTwoDimensionalArray(e),this;}},{key:"setMatrixValue",value:function value(e){}},{key:"setFromMatrix",value:function value(e){var t=this;t.m11=e.m11,t.m12=e.m12,t.m13=e.m13,t.m14=e.m14,t.m21=e.m21,t.m22=e.m22,t.m23=e.m23,t.m24=e.m24,t.m31=e.m31,t.m32=e.m32,t.m33=e.m33,t.m34=e.m34,t.m41=e.m41,t.m42=e.m42,t.m43=e.m43,t.m44=e.m44,t.a=e.m11,t.b=e.m12,t.c=e.m21,t.d=e.m22,t.e=e.m41,t.f=e.m42,!1===e.is2D&&(t.is2D=!1);}},{key:"setFromTwoDimensionalArray",value:function value(e){var t=ek(e,4),i=ek(t[0],4),r=i[0],n=i[1],o=i[2],a=i[3],s=ek(t[1],4),l=s[0],u=s[1],c=s[2],h=s[3],d=ek(t[2],4),f=d[0],v=d[1],g=d[2],m=d[3],y=ek(t[3],4),p=y[0],w=y[1],b=y[2],k=y[3];this.setFromMatrix({m11:r,m21:n,m31:o,m41:a,m12:l,m22:u,m32:c,m42:h,m13:f,m23:v,m33:g,m43:m,m14:p,m24:w,m34:b,m44:k});}},{key:"clone",value:function value(){return e.fromMatrix(this);}},{key:"determinant",value:function value(){return ML(this.toTwoDimensionalArray());}},{key:"toTwoDimensionalArray",value:function value(){var e=this;return[[e.m11,e.m21,e.m31,e.m41],[e.m12,e.m22,e.m32,e.m42],[e.m13,e.m23,e.m33,e.m43],[e.m14,e.m24,e.m34,e.m44]];}},{key:"toArray",value:function value(){var e=this;return[e.m11,e.m12,e.m13,e.m14,e.m21,e.m22,e.m23,e.m24,e.m31,e.m32,e.m33,e.m34,e.m41,e.m42,e.m43,e.m44];}},{key:"decompose",value:function value(){if(0===this.m44)return{};var e=EL(0,0,0,1),t=VL(0,0,0,1),i=wL(0,0,0),r=wL(0,0,0),n=wL(0,0,0),o=this;o.normalize();var a=o.clone();if(a.m14=0,a.m24=0,a.m34=0,a.m44=1,0===a.determinant())return!1;if(0!==o.m14||0!==o.m24||0!==o.m34){var s={x:o.m14,y:o.m24,z:o.m34,w:o.m44};e=a.invertSelf().transposeSelf().multiplyVector(s);}else e.x=0,e.y=0,e.z=0,e.w=1;n.x=o.m41,n.y=o.m42,n.z=o.m43;var l=[wL(o.m11,o.m12,o.m13),wL(o.m21,o.m22,o.m23),wL(o.m31,o.m32,o.m33)];i.x=l[0].norm(),l[0].normalize(),r.x=l[0].dot(l[1]),l[1]=wL(DL(l[1],l[0],1,-r.x)),i.y=l[1].norm(),l[1].normalize(),r.x/=i.y,r.y=l[0].dot(l[2]),l[2]=wL(DL(l[2],l[0],1,-r.y)),r.z=l[1].dot(l[2]),l[2]=wL(DL(l[2],l[1],1,-r.z)),i.z=l[2].norm(),l[2].normalize(),r.y/=i.z,r.z/=i.z;var u,c=l[1].cross(l[2]);if(l[0].dot(c)<0&&(i.negate(),l[0].negate(),l[1].negate(),l[2].negate()),t.x=.5*Math.pow(Math.max(1+l[0].x-l[1].y-l[2].z,0),.5),t.y=.5*Math.pow(Math.max(1-l[0].x+l[1].y-l[2].z,0),.5),t.z=.5*Math.pow(Math.max(1-l[0].x-l[1].y+l[2].z,0),.5),t.w=.5*Math.pow(Math.max(1+l[0].x+l[1].y+l[2].z,0),.5),l[2].y>l[1].z&&(t.x*=-1),l[0].z>l[2].x&&(t.y*=-1),l[1].x>l[0].y&&(t.z*=-1),t.x<.001&&t.x>=0&&t.y<.001&&t.y>=0){var h=Math.atan2(l[0].y,l[0].x);u={x:0,y:0,z:Number(xL(h).toFixed(3))};}else u=t.toEuler();return{rotation:u,scale:i,translation:n,skew:r,quaternion:t,perspective:e};}},{key:"multiplyVector",value:function value(e){var t=this,i=e.x,r=e.y,n=e.z,o=e.w;return{x:t.m11*i+t.m21*r+t.m31*n+t.m41*o,y:t.m12*i+t.m22*r+t.m32*n+t.m42*o,z:t.m13*i+t.m23*r+t.m33*n+t.m43*o,w:t.m14*i+t.m24*r+t.m34*n+t.m44*o};}},{key:"transpose",value:function value(){var e=this.clone();return e.transposeSelf(),e;}},{key:"transposeSelf",value:function value(){var e=this.m11,t=this.m21,i=this.m31,r=this.m41,n=this.m12,o=this.m22,a=this.m32,s=this.m42,l=this.m13,u=this.m23,c=this.m33,h=this.m43,d=this.m14,f=this.m24,v=this.m34,g=this.m44;return this.setFromMatrix({m11:e,m21:n,m31:l,m41:d,m12:t,m22:o,m32:u,m42:f,m13:i,m23:a,m33:c,m43:v,m14:r,m24:s,m34:h,m44:g}),this;}},{key:"normalize",value:function value(){var e=this,t=e.m44;e.m11/=t,e.m12/=t,e.m13/=t,e.m14/=t,e.m21/=t,e.m22/=t,e.m23/=t,e.m24/=t,e.m31/=t,e.m32/=t,e.m33/=t,e.m34/=t,e.m41/=t,e.m42/=t,e.m43/=t,e.m44/=t;}},{key:"getTranslation",value:function value(){return wL(this.m41,this.m42,this.m43);}},{key:"getRotation",value:function value(){var e=this,t=.5*Math.pow(e.m11+e.m22+e.m33+1,.5);return VL(.25*(e.m23-e.m32)/t,.25*(e.m31-e.m13)/t,.25*(e.m12-e.m21)/t,t);}},{key:"getScaling",value:function value(){var e=this;return wL(nP(e.m11,e.m12,e.m13),nP(e.m21,e.m22,e.m23),nP(e.m31,e.m32,e.m33));}},{key:"toEuler",value:function value(){var e=this.getRotation().toEuler();return wL(e.x,e.y,e.z);}}],[{key:"fromQuat",value:function value(t){var i=t.x,r=t.y,n=t.z,o=t.w,a=new e();return a.m11=1-2*(r*r+n*n),a.m12=2*(i*r+n*o),a.m13=2*(i*n-r*o),a.m21=2*(i*r-n*o),a.m22=1-2*(i*i+n*n),a.m23=2*(r*n+i*o),a.m31=2*(i*n+r*o),a.m32=2*(r*n-i*o),a.m33=1-2*(i*i+r*r),a.setFromMatrix(a),a;}},{key:"fromMatrix",value:function value(t){var i=new e();return i.setFromMatrix(t),i.is2D=!!t.is2D,i;}},{key:"fromFloat32Array",value:function value(t){var i=new e();return AL(t,i),i;}},{key:"fromFloat64Array",value:function value(t){var i=new e();return AL(t,i),i;}}]);}();function DL(e,t,i,r){return{x:i*e.x+r*t.x,y:i*e.y+r*t.y,z:i*e.z+r*t.z};}function ML(e){var t;if(e.length!==e[0].length)throw new Error();var i=e.length,r=0;if(i>3)for(var n=0;n<i;n++)r+=e[0][n]*UL(e,0,n);else 3===i?r=e[0][0]*e[1][1]*e[2][2]+e[0][1]*e[1][2]*e[2][0]+e[0][2]*e[1][0]*e[2][1]-e[0][2]*e[1][1]*e[2][0]-e[0][1]*e[1][0]*e[2][2]-e[0][0]*e[1][2]*e[2][1]:2===i?r=e[0][0]*e[1][1]-e[0][1]*e[1][0]:1===i&&(t=ek(e,1),r=ek(t[0],1)[0]);return r;}function UL(e){for(var t,i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=e.length,a=wP(t=MP(i=new Array(o-1)).call(i,0)).call(t,function(e){var t;return MP(t=new Array(o-1)).call(t,0);}),s=0;s<o-1;s++)for(var l=0;l<o-1;l++){var u=s<r?s:s+1,c=l<n?l:l+1;a[s][l]=e[u][c];}return Math.pow(-1,r+n)*ML(a);}function AL(e,t){var i=ek(e,16),r=i[0],n=i[1],o=i[2],a=i[3],s=i[4],l=i[5],u=i[6],c=i[7],h=i[8],d=i[9],f=i[10],v=i[11],g=i[12],m=i[13],y=i[14],p=i[15];if(6===e.length)t.m11=r,t.m12=n,t.m21=o,t.m22=a,t.m41=s,t.m42=l,t.m13=0,t.m14=0,t.m23=0,t.m24=0,t.m31=0,t.m32=0,t.m34=0,t.m33=1,t.m44=1,t.is2D=!0;else{if(16!==e.length)throw new Error();t.m11=r,t.m12=n,t.m13=o,t.m14=a,t.m21=s,t.m22=l,t.m23=u,t.m24=c,t.m31=h,t.m32=d,t.m33=f,t.m34=v,t.m41=g,t.m42=m,t.m43=y,t.m44=p,t.is2D=!1;}}function zL(e,t){var i={},r=e.m11,n=e.m21,o=e.m31,a=e.m41,s=e.m12,l=e.m22,u=e.m32,c=e.m42,h=e.m13,d=e.m23,f=e.m33,v=e.m43,g=e.m14,m=e.m24,y=e.m34,p=e.m44,w=t.m11,b=t.m21,k=t.m31,S=t.m41,x=t.m12,C=t.m22,V=t.m32,T=t.m42,I=t.m13,E=t.m23,P=t.m33,B=t.m43,D=t.m14,M=t.m24,U=t.m34,A=t.m44;return i.m11=r*w+n*x+o*I+a*D,i.m21=r*b+n*C+o*E+a*M,i.m31=r*k+n*V+o*P+a*U,i.m41=r*S+n*T+o*B+a*A,i.m12=s*w+l*x+u*I+c*D,i.m22=s*b+l*C+u*E+c*M,i.m32=s*k+l*V+u*P+c*U,i.m42=s*S+l*T+u*B+c*A,i.m13=h*w+d*x+f*I+v*D,i.m23=h*b+d*C+f*E+v*M,i.m33=h*k+d*V+f*P+v*U,i.m43=h*S+d*T+f*B+v*A,i.m14=g*w+m*x+y*I+p*D,i.m24=g*b+m*C+y*E+p*M,i.m34=g*k+m*V+y*P+p*U,i.m44=g*S+m*T+y*B+p*A,i;}function RL(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,1];e=yL(e);var i=Math.sin(e/2)*Math.cos(e/2),r=Math.pow(Math.sin(e/2),2),n=ek(t,3),o=n[0],a=n[1],s=n[2];return{m11:1-2*(Math.pow(a,2)+Math.pow(s,2))*r,m21:2*(o*a*r-s*i),m31:2*(o*s*r+a*i),m41:0,m12:2*(o*a*r+s*i),m22:1-2*(Math.pow(o,2)+Math.pow(a,2))*r,m32:2*(a*s*r-o*i),m42:0,m13:2*(o*s*r-a*i),m23:2*(a*s*r+o*i),m33:1-2*(Math.pow(o,2)+Math.pow(a,2))*r,m43:0,m14:0,m24:0,m34:0,m44:1};}function NL(e,t){var i=new BL();return e&&(i.m21=Math.tan(yL(e))),t&&(i.m12=Math.tan(yL(t))),i;}function OL(e,t,i){var r=e.x-t.x,n=e.y-t.y,o=(i.x-e.x)*r+(i.y-e.y)*n;return o/=r*r+n*n,new kL(e.x+o*r,e.y+o*n);}function LL(e,t){return Math.pow(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2),.5);}function WL(e,t,i){return(i.x-e.x)*(t.y-e.y)===(t.x-e.x)*(i.y-e.y)&&Math.min(e.x,t.x)<=i.x&&i.x<=Math.max(e.x,t.x)&&Math.min(e.y,t.y)<=i.y&&i.y<=Math.max(e.y,t.y);}var FL=function(){return hS(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;dS(this,e),sS(this,"x",0),sS(this,"y",0),sS(this,"left",0),sS(this,"top",0),sS(this,"right",0),sS(this,"bottom",0),sS(this,"width",0),sS(this,"height",0),this.update(t,i,r,n);},[{key:"update",value:function value(e,t,i,r){this.x=e,this.y=t,this.left=e,this.top=t,this.right=e+i,this.bottom=t+r,this.width=i,this.height=r;}},{key:"toJSON",value:function value(){}}]);}();function HL(e,t,i,r,n){var o=Math.cos,a=Math.sin;return{x:(e-i)*o(n)-(t-r)*a(n)+i,y:(e-i)*a(n)+(t-r)*o(n)+r};}var jL=function(){return hS(function e(t){dS(this,e),sS(this,"uid",void 0),sS(this,"children",void 0),this.uid=t.uid,this.children=t.children||[];},[{key:"append",value:function value(e){var t=this.children;return sE(t).call(t,e)<0&&(t.push(e),!0);}},{key:"insert",value:function value(e,t){var i=this.children;return!(t<0||(t>i.length&&(t=i.length),NE(i).call(i,t,0,e),0));}},{key:"remove",value:function value(e){var t=this.children,i=sE(t).call(t,e);return!(i<0||(NE(t).call(t,i,1),0));}},{key:"clear",value:function value(){return this.children=[],!0;}},{key:"move",value:function value(e,t){if(e===t)return!0;var i=this.children,r=ek(NE(i).call(i,e,1),1)[0];return NE(i).call(i,t,0,r),!0;}},{key:"switch",value:function value(e,t){if(e===t)return!0;var i=this.children,r=i[e];return i[e]=i[t],i[t]=r,!0;}},{key:"reorder",value:function value(e){var t=this.children,i=e.length,r=[],n=0;if(t.length!==i||0===i)return!1;for(var o=0;o<i;o++)e[o]===o&&(n+=1);if(n===i)return!0;for(var a=0;a<i;a++)r[a]=t[e[a]];for(var s=0;s<i;s++)t[s]=r[s];return!0;}}]);}(),XL=new(function(){return hS(function e(){dS(this,e),sS(this,"tasks",[]);},[{key:"createTimer",value:function value(e,t){var i=AO();return this.tasks.push({uid:i,callback:e,time:t}),this.executeTimer(i),i;}},{key:"executeTimer",value:function value(e){var t,i=YP(t=this.tasks).call(t,function(t){return t.uid===e;});if(i){var _r2=function r(){i.callback(),null!==i.timer&&(i.timer=hB(_r2,i.time));};i.timer=hB(_r2,i.time);}}},{key:"clearTimer",value:function value(e){var t,i,r=KE(t=this.tasks).call(t,function(t){return t.uid===e;});r>-1&&(clearTimeout(this.tasks[r].timer),this.tasks[r].timer=null,NE(i=this.tasks).call(i,r,1));}}]);}())(),YL=function(){return hS(function e(t,i){dS(this,e),sS(this,"isDestroyed",!1),sS(this,"data",void 0),sS(this,"table",["database","table","item"]),sS(this,"dbName",void 0),sS(this,"tableName",void 0),this.data={},this.dbName=t,this.tableName=i,this.createDatabase(t,i);},[{key:"destroy",value:function value(){if(!this.isDestroyed){for(var e=0,t=IB(this.data);e<t.length;e++){var i=ek(t[e],2),r=i[0];i[1],this.data[r]=null;}this.data=null,this.isDestroyed=!0;}}},{key:"createDatabase",value:function value(e,t){this.data[e]={},this.data[e][t]={};}},{key:"set",value:function value(e,t){var i=this,r=this.dbName,n=this.tableName;return new BB(function(o,a){i.checkId(e)?a(new Error("The ".concat(e," already exists."))):(i.data[r][n][e]=t,o("Save ".concat(e," to database successful.")));});}},{key:"get",value:function value(e){var t=this,i=this.dbName,r=this.tableName;return new BB(function(n,o){t.checkId(e)?n(t.data[i][r][e]):o(t.erMsg(2,e));});}},{key:"remove",value:function value(e){var t=this,i=this.dbName,r=this.tableName;return new BB(function(n,o){delete t.data[i][r][e],n("Remove ".concat(e," successful."));});}},{key:"update",value:function value(e,t){var i=this,r=this.dbName,n=this.tableName;return new BB(function(o,a){i.checkId(e)?(i.data[r][n][e]=t,o("Update ".concat(e," successful."))):a(i.erMsg(2,e));});}},{key:"checkId",value:function value(e){var t=this.dbName,i=this.tableName;return void 0!==this.data[t][i][e];}},{key:"erMsg",value:function value(e,t){var i;return BS(i="The ".concat(this.table[e]," ")).call(i,t," does not exist.");}}]);}(),qL=function(){return hS(function e(){dS(this,e),sS(this,"isDestroyed",!1),sS(this,"data",void 0),this.data={};},[{key:"destroy",value:function value(){if(!this.isDestroyed){for(var e=0,t=IB(this.data);e<t.length;e++){var i,r=ek(t[e],2),n=r[0];r[1],null!==(i=this.data[n])&&void 0!==i&&i.destroy(),this.data[n]=null;}this.data=null,this.isDestroyed=!0;}}},{key:"set",value:function value(e,t){return!this.check(e)&&(this.data[e]=t,!0);}},{key:"get",value:function value(e){return this.data[e];}},{key:"remove",value:function value(e){return!!this.check(e)&&(delete this.data[e],!0);}},{key:"update",value:function value(e,t){return!!this.check(e)&&(this.data[e]=t,!0);}},{key:"check",value:function value(e){return void 0!==this.data[e];}}]);}(),ZL=function(e){function t(e){var i;return dS(this,t),sS(Kw(i=nO(this,t,[e])),"name",void 0),sS(Kw(i),"type",void 0),sS(Kw(i),"fileType",void 0),sS(Kw(i),"createdDate",void 0),sS(Kw(i),"modifiedDate",void 0),sS(Kw(i),"parent",void 0),sS(Kw(i),"isRoot",!1),i.name=e.name,i.type=e.type,i.fileType=e.fileType,i.parent=e.parent||null,i.isRoot=e.isRoot||!1,i.createdDate=wO(),i.modifiedDate=i.createdDate,i;}return Qb(t,e),hS(t,[{key:"updateDate",value:function value(){this.modifiedDate=wO();}},{key:"setName",value:function value(e){this.name=e;}},{key:"reorder",value:function value(e){var i=this.type;return("file"===i||"default"===i)&&oO(t,"reorder",this,3)([e]);}}]);}(jL),_L=function(){return hS(function e(){dS(this,e),sS(this,"root",void 0),sS(this,"currentNode",void 0),sS(this,"selectedUid",void 0),sS(this,"defaultNode",void 0),sS(this,"hooks",{fileChanged:mL.create(),beforeRemoveFile:mL.create(),removeFile:mL.create(),afterRemoveFile:mL.create(),afterRenameFile:mL.create(),destroy:mL.create()}),this.root=new ZL({uid:AO(),children:[],name:"root",type:"file",fileType:"folder",parent:void 0,isRoot:!0}),this.defaultNode=this.root,this.currentNode=this.root;},[{key:"appendChildrenToFile",value:function value(e,t,i){var r=i,n=GL(this.defaultNode,e);return n||(n=this.createFile(e),this.hooks.fileChanged.emit(this.defaultNode)),pS(t).call(t,function(e){pO(r)?n.append(e):(n.insert(e,r),r+=1);}),n;}},{key:"removeChildFromFile",value:function value(e,t){bO(t)&&(t=[t]);var i=this.getFileByUid(e);i&&pS(t).call(t,function(e){i.remove(e);});}},{key:"findChild",value:function value(e,t){var i;return YP(i=e.children).call(i,function(e){return e.name===t;});}},{key:"createFile",value:function value(e){var t=this.defaultNode;t||(t=this.root);var i=GL(t,e);return i&&"file"===i.type||(i=new ZL({uid:AO(),children:[],name:e,type:"file",fileType:"file",parent:t,isRoot:!1}),this.currentNode.append(i),this.hooks.fileChanged.emit(this.currentNode.children)),i;}},{key:"removeFile",value:function value(e){for(var t=this.defaultNode.children,i=0;i<t.length;i++){var r=t[i];if(r.name===e)return this.hooks.beforeRemoveFile.emit(r),NE(t).call(t,i,1),this.hooks.afterRemoveFile.emit(r),this.hooks.fileChanged.emit(r),!0;}return!1;}},{key:"renameFile",value:function value(e,t){var i=this.findChild(this.defaultNode,e),r=this.findChild(this.defaultNode,t);return!!i&&!r&&(i.name=t,this.hooks.afterRenameFile.emit(i),this.hooks.fileChanged.emit(this.currentNode.children),!0);}},{key:"getFile",value:function value(e){return this.findChild(this.defaultNode,e);}},{key:"getFileByUid",value:function value(e){return YP(this).call(this,e,this.root);}},{key:"getCurrentFileList",value:function value(){return this.currentNode.children;}},{key:"isFileExist",value:function value(e){return!!this.findChild(this.defaultNode,e);}},{key:"createFolder",value:function value(){}},{key:"find",value:function value(e,t){for(var i=t.children,r=i.length,n=0;n<r;n++){if(i[n].uid===e)return i[n];if(i[n].children){var o=YP(this).call(this,e,i[n]);if(o)return o;}}return null;}}]);}();function GL(e,t){var i,r=Ox(i=e.children).call(i,function(e){return e.name===t;});return 0===r.length?null:r[0];}var KL,$L=function(e){function t(e){var i;return dS(this,t),sS(Kw(i=nO(this,t,[e])),"name",void 0),sS(Kw(i),"type","tag"),i.name=e.name,i.uid=e.uid||AO(),i.type="tag",i;}return Qb(t,e),hS(t);}(jL),JL=function(){return hS(function e(){dS(this,e),sS(this,"tags",void 0),sS(this,"defaultName",void 0),sS(this,"defaultUid",void 0),sS(this,"selectedUid",void 0),sS(this,"emptyItem",void 0),sS(this,"hooks",{beforeRemoveTag:mL.create(),afterRenameTag:mL.create(),destroy:mL.create(),load:mL.create()}),this.tags=[],this.defaultName=null,this.defaultUid=null,this.selectedUid=null,this.emptyItem=new $L({name:"defaultTag",children:[]});},[{key:"appendChildToTag",value:function value(e,t){var i=this.createTag(e);bO(t)&&(t=[t]);var r=!1;return pS(t).call(t,function(e){i.append(e)&&(r=!0);}),r;}},{key:"removeChildFromTag",value:function value(e,t){var i=this.getTag(e);return!!i&&(bO(t)&&(t=[t]),pS(t).call(t,function(e){i.remove(e);}),!0);}},{key:"createTag",value:function value(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=this.getTag(e);return i||(i=new $L({name:e,children:t}),this.tags.push(i)),i;}},{key:"removeTag",value:function value(e){var t,i,r=this.getTag(e);if(!r)return!1;this.hooks.beforeRemoveTag.emit(r);var n=KE(t=this.tags).call(t,function(t){return t.name===e;});return e===this.defaultName&&(this.defaultName=null,this.selectedUid=null),NE(i=this.tags).call(i,n,1),!0;}},{key:"renameTag",value:function value(e,t){if(!bO(e)||!bO(t))return!1;var i=this.isTagExisted(t),r=this.getTag(e);return!(!r||i||(r.name=t,this.hooks.afterRenameTag.emit(r),0));}},{key:"getTag",value:function value(e){var t;return YP(t=this.tags).call(t,function(t){return t.name===e;});}},{key:"getTagByUid",value:function value(e){var t;return YP(t=this.tags).call(t,function(t){return t.uid===e;});}},{key:"getTagList",value:function value(){var e;return nE(e=this.tags).call(e);}},{key:"setDefaultTag",value:function value(e){if(!e)return this.defaultName=null,this.defaultUid=null,!0;var t=this.getTag(e);return!!t&&(this.defaultName=e,this.defaultUid=t.uid,!0);}},{key:"getDefaultTag",value:function value(){return this.defaultName;}},{key:"isTagExisted",value:function value(e){return!!this.getTag(e);}}]);}(),QL=function(){return hS(function e(){dS(this,e);},[{key:"apply",value:function value(e){var t=e.hooks,i={beforeStatus:null,afterStatus:null,operation:null,docUid:null},r=function r(e){i.beforeStatus={uids:e.uids,selectedUids:[],currentUid:"",modifiedUid:e.modifiedUid,removedUids:e.removedUids};},n=function n(t){i.afterStatus={uids:t.uids,selectedUids:[],currentUid:"",modifiedUid:t.modifiedUid,removedUids:t.removedUids},i.docUid=t.docUid,i.operation=t.operation,i.docType=t.docType,i.docName=t.docName,e.emit("bufferChanged",uS({},i)),i={beforeStatus:null,afterStatus:null,operation:null,docUid:null};};t.beforeBufferChanged.on(r),t.afterBufferChanged.on(n),t.destroy.on(function(){t.beforeBufferChanged.off(r),t.afterBufferChanged.off(n);});}}]);}(),eW=function(){return hS(function e(){dS(this,e);},[{key:"apply",value:function value(e){var t=e.hooks;e.customStore=new qL();var i=function i(t){var i=t.data;pS(i).call(i,function(t){var i=t.customData;i||(i={}),e.customStore.set(t.uid,i);});},r=function r(t){var i=t.removedUids;pS(i).call(i,function(t){e.customStore.remove(t);});},n=function n(t){var i=t.data.customData;i&&e.customStore.update(t.modifiedUid,i);};t.loadSource.on(i),t.removeSource.on(r),t.updateSource.on(n),t.destroy.on(function(){t.loadSource.off(i),t.removeSource.off(r),t.updateSource.off(n);});}}]);}(),tW=function(e){function t(){var e;return dS(this,t),sS(e=nO(this,t,[{uid:AO(),children:[]}]),"name","dvs-default"),sS(e,"isDestroyed",!1),sS(e,"type",void 0),e;}return Qb(t,e),hS(t,[{key:"destroy",value:function value(){this.isDestroyed||(this.isDestroyed=!0);}}]);}(jL),iW=function(){return hS(function e(){dS(this,e);},[{key:"apply",value:function value(e){e.defaultFile=new tW();var t=e.hooks,i=function i(t){var i,r,n,o=t.filename,a=t.index,s=t.data;if(pO(o)){var l=wP(s).call(s,function(e){return e.uid;});void 0===a?(i=e.defaultFile.children).push.apply(i,tk(l)):NE(r=e.defaultFile.children).apply(r,BS(n=[a,0]).call(n,tk(l)));var u={docUid:e.defaultFile.uid,sourceUids:l,type:"default",index:a};e.hooks.loadToDoc.emit(u);}},r=function r(t){var i=t.removedUids,r=[];pS(i).call(i,function(t){var i=e.statusStore.get(t);i&&i.ownerDefaultFile&&(e.defaultFile.remove(t),r.push(t));}),r.length&&e.hooks.removeFromDoc.emit({docUid:e.defaultFile.uid,sourceUids:i,type:"default"});};t.loadSource.on(i),t.removeSource.on(r),t.destroy.on(function(){t.loadSource.off(i),t.removeSource.off(r);});}}]);}(),rW=function(){return hS(function e(){dS(this,e);},[{key:"apply",value:function value(e){e.dir=new _L(),this.listenDirectoryHooks(e),this.listenSpaceHooks(e);}},{key:"listenDirectoryHooks",value:function value(e){var t=e.dir.hooks,i=function i(t){var i;pS(i=t.children).call(i,function(i){var r=e.statusStore.get(i);r&&r.ownerFiles.remove(t.uid);}),e.hooks.removeDoc.emit(t);},r=function r(t){e.hooks.renameDoc.emit(t);};t.beforeRemoveFile.on(i),t.afterRenameFile.on(r),t.destroy.on(function(){t.beforeRemoveFile.off(i),t.afterRenameFile.off(r);});}},{key:"listenSpaceHooks",value:function value(e){var t=e.hooks,i=function i(t){var i=t.data,r=t.filename,n=t.index;if(!pO(r)){var o=e.dir.getFile(r);e.hooks.beforeBufferChanged.emit({docType:"file",docUid:null==o?void 0:o.uid,uids:tk((null==o?void 0:o.children)||[]),operation:"add"});var a=wP(i).call(i,function(e){return e.uid;}),s=e.dir.appendChildrenToFile(r,a,n),l={docUid:s.uid,sourceUids:a,type:"file",index:n};e.hooks.loadToDoc.emit(l),e.hooks.afterBufferChanged.emit({docType:"file",docName:r,docUid:null==s?void 0:s.uid,uids:tk((null==s?void 0:s.children)||[]),operation:"add"});}},r=function r(t){var i=t.removedUids,r={};pS(i).call(i,function(t){var i,n,o=e.statusStore.get(t);o&&pS(i=nE(n=o.ownerFiles.children).call(n)).call(i,function(e){r[e]||(r[e]=[]),r[e].push(t);});});for(var n=0,o=IB(r);n<o.length;n++){var a=ek(o[n],2),s=a[0],l=a[1],u=e.dir.getFileByUid(s);u&&(e.hooks.beforeBufferChanged.emit({docUid:s,uids:tk(u.children),removedUids:tk(l),operation:"remove"}),e.dir.removeChildFromFile(s,l),e.hooks.afterBufferChanged.emit({docType:"file",docName:u.name,docUid:s,uids:tk(u.children),removedUids:tk(l),operation:"remove"})),e.hooks.removeFromDoc.emit({docUid:s,sourceUids:l});}},n=function n(t){var i,r,n=e.statusStore.get(t.modifiedUid);n&&pS(i=nE(r=n.ownerFiles.children).call(r)).call(i,function(i){var r=e.dir.getFileByUid(i);r&&(e.hooks.beforeBufferChanged.emit({uids:tk(r.children),modifiedUid:t.modifiedUid,operation:"modify"}),e.hooks.afterBufferChanged.emit({docType:"file",docName:r.name,docUid:i,uids:tk(r.children),modifiedUid:t.modifiedUid,operation:"modify"}));});};t.loadSource.on(i),t.removeSource.on(r),t.updateSource.on(n),t.destroy.on(function(){t.loadSource.off(i),t.removeSource.off(r),t.updateSource.off(n);});}}]);}(),nW=function(){return hS(function e(){dS(this,e);},[{key:"apply",value:function value(e){var t=e.hooks;e.metadataStore=new qL();var i=function i(t){var i=t.data;pS(i).call(i,function(t){var i=t.metadata;i||(i={width:void 0,height:void 0}),e.metadataStore.set(t.uid,i);});},r=function r(t){var i=t.removedUids;pS(i).call(i,function(t){e.metadataStore.remove(t);});},n=function n(t){var i=t.data.metadata;i&&e.metadataStore.update(t.modifiedUid,i);};t.loadSource.on(i),t.removeSource.on(r),t.updateSource.on(n),t.destroy.on(function(){t.loadSource.off(i),t.removeSource.off(r),t.updateSource.off(n);});}}]);}(),oW=function(){return hS(function e(t){dS(this,e),sS(this,"uid",null),sS(this,"minData",null),sS(this,"oriData",null),sS(this,"customData",{}),sS(this,"activeOri",!1),sS(this,"activeMin",!1),sS(this,"minTask",null),sS(this,"oriTask",null),sS(this,"load",!1),sS(this,"preload",[]),sS(this,"visible",[]),sS(this,"overlays",[]),sS(this,"img",null),sS(this,"minImg",null),sS(this,"imageScale",1),sS(this,"owners",[]),sS(this,"oriType",null),sS(this,"minType",null),sS(this,"metadata",null),sS(this,"realTimeWidth",0),sS(this,"realTimeHeight",0),sS(this,"isFromFile",!1),sS(this,"isCached",!1),sS(this,"isDestroyed",!1),sS(this,"isLoading",!1),sS(this,"isMinLoading",!1),sS(this,"isSaving",!1),sS(this,"annotations",void 0),sS(this,"ownerFiles",new jL({children:[]})),sS(this,"ownerTags",new jL({children:[]})),sS(this,"ownerDefaultFile",void 0),sS(this,"operations",[]),sS(this,"useFillColor",!1),this.uid=t.uid,this.metadata=uS({},t.metadata),this.setRealTimeSize(this.metadata.width,this.metadata.height);},[{key:"setRealTimeSize",value:function value(e,t){this.realTimeWidth=e,this.realTimeHeight=t;}},{key:"destroy",value:function value(){this.isDestroyed||(this.customData=null,this.img=null,this.owners=null,this.metadata=null,this.isDestroyed=!0);}},{key:"addOwner",value:function value(e){var t=this.owners;sE(t).call(t,e)<0&&t.push(e);}},{key:"removeOwner",value:function value(e){var t=this.owners,i=sE(t).call(t,e);i>-1&&NE(t).call(t,i,1);}},{key:"removeViewer",value:function value(e){var t=this.owners,i=sE(t).call(t,e);i>-1&&NE(t).call(t,i,1);}},{key:"setVisible",value:function value(e){var t;sE(t=this.visible).call(t,e)<0&&this.visible.push(e);}},{key:"cancelVisible",value:function value(e){var t,i,r=sE(t=this.visible).call(t,e);r>-1&&NE(i=this.visible).call(i,r,1);}},{key:"setPreload",value:function value(e){var t;sE(t=this.preload).call(t,e)<0&&this.preload.push(e);}},{key:"cancelPreload",value:function value(e){var t,i,r=sE(t=this.preload).call(t,e);r>-1&&NE(i=this.preload).call(i,r,1);}},{key:"reset",value:function value(){this.minData=null,this.oriData=null,this.img=null,this.activeOri=!1,this.activeMin=!1,this.minTask=null,this.oriTask=null,this.operations=[];}}]);}(),aW=function(){return hS(function e(){dS(this,e);},[{key:"apply",value:function value(e){var t=e.hooks;e.statusStore=new qL();var i=function i(t){var i=t.data;t.filename,t.index,pS(i).call(i,function(t){var i=new oW(t);e.statusStore.set(t.uid,i);});},r=function r(t){var i=t.removedUids;pS(i).call(i,function(t){var i,r,n=e.statusStore.get(t);n&&(dL(n.minData),dL(n.oriData),n.ownerFiles.clear(),n.ownerTags.clear(),n.ownerDefaultFile=!1,null!==(i=n.img)&&void 0!==i&&i.src&&(n.img.src=""),null!==(r=n.minImg)&&void 0!==r&&r.src&&(n.minImg.src=""),n.img=null,n.minImg=null),e.statusStore.remove(t);});},n=function n(t){var i=t.modifiedUid,r=t.data,n=t.revoke,o=e.statusStore.get(i);if(o){o.img=null,o.minImg=null;var a=r.metadata;a&&(o.metadata=uS({},a),o.setRealTimeSize(a.width,a.height)),n&&(dL(o.oriData),dL(o.minData)),o.reset(),e.statusStore.update(i,o);}},o=function o(t){var i;pS(i=t.children).call(i,function(i){var r=e.statusStore.get(i);r&&("file"===t.type?r.ownerFiles.remove(t.uid):"tag"===t.type&&r.ownerTags.remove(t.uid));});},a=function a(t){var i=t.docUid,r=t.sourceUids,n=t.type;pS(r).call(r,function(t){var r=e.statusStore.get(t);r&&("file"===n?r.ownerFiles.append(i):"tag"===n?r.ownerTags.append(i):"default"===n&&(r.ownerDefaultFile=!0));});},s=function s(t){var i=t.docUid,r=t.sourceUids,n=t.type;pS(r).call(r,function(t){var r=e.statusStore.get(t);r&&("file"===n?r.ownerFiles.remove(i):"tag"===n?r.ownerTags.remove(i):"default"===n&&(r.ownerDefaultFile=!0));});};t.loadSource.on(i),t.afterRemoveSource.on(r),t.updateSource.on(n),t.removeDoc.on(o),t.loadToDoc.on(a),t.removeFromDoc.on(s),t.destroy.on(function(){t.loadSource.off(i),t.afterRemoveSource.off(r),t.updateSource.off(n),t.removeDoc.off(o),t.loadToDoc.off(a),t.removeFromDoc.off(s);});}}]);}(),sW=function(){return hS(function e(){dS(this,e);},[{key:"apply",value:function value(e){var t=e.hooks;e.store=new YL("space_db","space_doc");var i=function i(t){var i=t.data;i&&pS(i).call(i,function(t){e.store.set(t.uid,t);});},r=function r(t){var i;pS(i=t.removedUids).call(i,function(t){e.store.remove(t);});},n=function n(t){e.store.update(t.modifiedUid,t.data);};t.loadSource.on(i),t.removeSource.on(r),t.updateSource.on(n),t.destroy.on(function(){t.loadSource.off(i),t.removeSource.off(r),t.updateSource.off(n);});}}]);}(),lW=function(){return hS(function e(){dS(this,e);},[{key:"apply",value:function value(e){e.tag=new JL(),this.listenSpaceHooks(e),this.listenTagHooks(e);}},{key:"listenTagHooks",value:function value(e){var t=e.tag.hooks,i=function i(t){var i;pS(i=t.children).call(i,function(i){var r=e.statusStore.get(i);r&&r.ownerFiles.remove(t.uid);}),e.hooks.removeDoc.emit(t);},r=function r(t){e.hooks.renameDoc.emit(t);};t.beforeRemoveTag.on(i),t.afterRenameTag.on(r),t.destroy.on(function(){t.beforeRemoveTag.off(i),t.afterRenameTag.off(r);});}},{key:"listenSpaceHooks",value:function value(e){var t=e.hooks,i=function i(t){var i=t.data,r=e.tag.defaultName;pS(i).call(i,function(e){var t;(e.tags||(e.tags=[]),r)&&sE(t=e.tags).call(t,r)<0&&e.tags.push(r);});},r=function r(t){var i=t.data;pS(i).call(i,function(t){var i;null!==(i=t.tags)&&void 0!==i&&pS(i).call(i,function(i){var r=e.tag.getTag(i);e.hooks.beforeBufferChanged.emit({uids:tk((null==r?void 0:r.children)||[]),operation:"add"}),e.tag.appendChildToTag(i,t.uid);var n=e.tag.getTag(i),o={docUid:n.uid,sourceUids:[t.uid],type:"tag"};e.hooks.loadToDoc.emit(o),e.hooks.afterBufferChanged.emit({docType:"tag",docName:i,docUid:null==n?void 0:n.uid,uids:tk((null==n?void 0:n.children)||[]),operation:"add"});}),t.tags.length=0;});},n=function n(t){var i=t.removedUids,r={};pS(i).call(i,function(t){var i,n,o=e.statusStore.get(t);o&&pS(i=nE(n=o.ownerTags.children).call(n)).call(i,function(e){r[e]||(r[e]=[]),r[e].push(t);});});for(var n=0,o=IB(r);n<o.length;n++){var a=ek(o[n],2),s=a[0],l=a[1],u=e.tag.getTagByUid(s);u&&(e.hooks.beforeBufferChanged.emit({uids:tk(u.children),removedUids:tk(l),operation:"remove"}),e.tag.removeChildFromTag(u.name,l),e.hooks.afterBufferChanged.emit({docType:"tag",docName:u.name,docUid:s,uids:tk(u.children),removedUids:tk(l),operation:"remove"})),e.hooks.removeFromDoc.emit({docUid:s,sourceUids:l,type:"tag"});}},o=function o(e){"tag"!==e.type&&n({removedUids:e.children});},a=function a(t){var i=t.docUid,r=t.sourceUids;if("tag"===t.type){var n=e.tag.getTagByUid(i);n&&pS(r).call(r,function(){var t=Gw(iO().m(function t(i){var r,o;return iO().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,e.store.get(i);case 1:if(o=t.v,!(o&&sE(r=o.tags).call(r,n.name)<0)){t.n=2;break;}return o.tags.push(n.name),t.n=2,e.store.update(i,o);case 2:t.n=4;break;case 3:t.p=3,t.v,console.log();case 4:return t.a(2);}},t,null,[[0,3]]);}));return function(e){return t.apply(this,arguments);};}());}},s=function s(t){var i=t.docUid,r=t.sourceUids;if("tag"===t.type){var n=e.tag.getTagByUid(i);n&&pS(r).call(r,function(){var t=Gw(iO().m(function t(i){var r,o,a,s;return iO().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,e.store.get(i);case 1:if(!(r=t.v)){t.n=2;break;}return(s=sE(o=r.tags).call(o,n.name))>-1&&NE(a=r.tags).call(a,s,1),t.n=2,e.store.update(i,r);case 2:t.n=4;break;case 3:t.p=3,t.v,console.log();case 4:return t.a(2);}},t,null,[[0,3]]);}));return function(e){return t.apply(this,arguments);};}());}},l=function l(t){var i,r,n=e.statusStore.get(t.modifiedUid);n&&pS(i=nE(r=n.ownerTags.children).call(r)).call(i,function(i){var r=e.tag.getTagByUid(i);r&&(e.hooks.beforeBufferChanged.emit({uids:tk(r.children),modifiedUid:t.modifiedUid,operation:"modify"}),e.hooks.afterBufferChanged.emit({docType:"tag",docName:r.name,docUid:i,uids:tk(r.children),modifiedUid:t.modifiedUid,operation:"modify"}));});};t.beforeLoadSource.on(i),t.loadSource.on(r),t.removeSource.on(n),t.removeDoc.on(o),t.loadToDoc.on(a),t.removeFromDoc.on(s),t.updateSource.on(l),t.destroy.on(function(){t.beforeLoadSource.off(i),t.loadSource.off(r),t.removeSource.off(n),t.removeDoc.off(o),t.loadToDoc.off(a),t.removeFromDoc.off(s),t.updateSource.off(l);});}}]);}(),uW=function(e){function t(){var e;return dS(this,t),sS(Kw(e=nO(this,t)),"uid",AO()),sS(Kw(e),"hooks",{init:mL.create(),destroy:mL.create(),beforeLoadSource:mL.create(),loadSource:mL.create(),afterLoadSource:mL.create(),beforeRemoveSource:mL.create(),removeSource:mL.create(),afterRemoveSource:mL.create(),beforeUpdateSource:mL.create(),updateSource:mL.create(),afterUpdateSource:mL.create(),beforeBufferChanged:mL.create(),afterBufferChanged:mL.create(),directoryChanged:mL.create(),tagChanged:mL.create(),openDoc:mL.create(),loadToDoc:mL.create(),removeFromDoc:mL.create(),removeDoc:mL.create(),renameDoc:mL.create(),move:mL.create(),afterMove:mL.create(),switch:mL.create(),afterSwitch:mL.create(),reorder:mL.create(),afterReorder:mL.create()}),sS(Kw(e),"dir",void 0),sS(Kw(e),"tag",void 0),sS(Kw(e),"store",void 0),sS(Kw(e),"customStore",void 0),sS(Kw(e),"metadataStore",void 0),sS(Kw(e),"statusStore",void 0),sS(Kw(e),"defaultFile",void 0),sS(Kw(e),"plugins",[]),sS(Kw(e),"imageLoader",void 0),e.initPlugins(),e.hooks.init.emit(),e;}return Qb(t,e),hS(t,[{key:"destroy",value:function value(){this.hooks.destroy.emit();}},{key:"initPlugins",value:function value(){new sW().apply(this),new aW().apply(this),new eW().apply(this),new nW().apply(this),new QL().apply(this),new iW().apply(this),new rW().apply(this),new lW().apply(this);}},{key:"setImageLoader",value:function value(e){this.imageLoader=e;}},{key:"getCustomData",value:function value(e){return this.customStore.get(e);}},{key:"setCustomData",value:function value(e,t){return this.customStore.set(e,t);}},{key:"getMetadata",value:function value(e){return this.metadataStore.get(e);}},{key:"setMetadata",value:function value(e,t){return this.metadataStore.set(e,t);}},{key:"createStore",value:function value(e){var t=e.type,i=void 0===t?"sync":t,r=e.tableName,n=e.dbName;return"sync"===i?new qL():n&&r?new YL(n,r):null;}},{key:"loadSource",value:function value(e,t){if(pO(e))return[];var i=e.data;if(!vO(i))return[];var r=[];return pS(i).call(i,function(e){e.uid=AO(),r.push(e.uid);}),TO(t)&&t(r),this.hooks.beforeLoadSource.emit(e),this.hooks.loadSource.emit(e),this.hooks.afterLoadSource.emit(e),r;}},{key:"removeSource",value:function value(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];bO(e)&&(e=[e]);var i={removedUids:e,docUid:"",trigger:this.uid,operation:"remove"};return this.hooks.beforeRemoveSource.emit(i),this.hooks.removeSource.emit(i),t&&this.hooks.afterRemoveSource.emit(i),!0;}},{key:"updateSource",value:function value(e,t){var i={modifiedUid:e,data:t,revoke:!(arguments.length>2&&void 0!==arguments[2])||arguments[2],operation:"modify"};return this.hooks.beforeUpdateSource.emit(i),this.hooks.updateSource.emit(i),this.hooks.afterUpdateSource.emit(i),!0;}},{key:"getSource",value:function value(e){return this.store.get(e);}},{key:"openDefault",value:function value(e){var t={node:this.defaultFile,type:"default",config:e};this.hooks.openDoc.emit(t);}},{key:"createFile",value:function value(e){return this.dir.createFile(e);}},{key:"removeFile",value:function value(e){return this.dir.removeFile(e);}},{key:"renameFile",value:function value(e,t){return this.dir.renameFile(e,t);}},{key:"openFile",value:function value(e,t){var i=this.getFile(e);if(!i)return!1;var r={node:i,type:"file",config:t};return this.hooks.openDoc.emit(r),!0;}},{key:"movePagesToFile",value:function value(e,t,i,r){var n=this,o=this.getFile(e),a=this.getFile(i);if(!o||!a)return!1;for(var s=0;s<t.length;s++)if(t[s]<0||t[s]>=o.children.length)return!1;if(r<0)return!1;var l=wP(t).call(t,function(e){return o.children[e];});pS(l).call(l,function(e){var t=n.statusStore.get(e);t&&t.ownerFiles.remove(o.uid);}),this.dir.removeChildFromFile(o.uid,l),this.hooks.removeFromDoc.emit({docUid:o.uid,sourceUids:l}),r>a.children.length&&(r=a.children.length);var u=this.dir.appendChildrenToFile(i,l,r),c={docUid:u.uid,sourceUids:l,type:"file",index:r,isSameDoc:e===i};return pS(l).call(l,function(e){var t=n.statusStore.get(e);t&&t.ownerFiles.append(u.uid);}),this.hooks.loadToDoc.emit(c),!0;}},{key:"getFile",value:function value(e){return this.dir.getFile(e);}},{key:"getFileList",value:function value(){return this.dir.getCurrentFileList();}},{key:"isFileExisted",value:function value(e){return this.dir.isFileExist(e);}},{key:"createTag",value:function value(e){return this.tag.createTag(e);}},{key:"removeTag",value:function value(e){for(var t=this.getTag(e).children||[],i=0;i<t.length;i++)this.store.get(t[i]).then(function(t){var i,r,n=sE(i=(null==t?void 0:t.tags)||[]).call(i,e);-1!==n&&NE(r=t.tags).call(r,n,1);});return this.tag.removeTag(e);}},{key:"renameTag",value:function value(e,t){var i=this.getTag(e).children||[],r=this.tag.renameTag(e,t);if(r)for(var n=0;n<i.length;n++)this.store.get(i[n]).then(function(i){var r,n,o=sE(r=(null==i?void 0:i.tags)||[]).call(r,e);-1!==o&&NE(n=i.tags).call(n,o,1,t);});return r;}},{key:"openTag",value:function value(e,t){var i=this.getTag(e);if(!i)return!1;var r={node:i,type:"tag",config:t};return this.hooks.openDoc.emit(r),!0;}},{key:"getTag",value:function value(e){return this.tag.getTag(e);}},{key:"getTagList",value:function value(){return this.tag.getTagList();}},{key:"setDefaultTag",value:function value(e){return this.tag.setDefaultTag(e);}},{key:"getDefaultTag",value:function value(){return this.tag.getDefaultTag();}},{key:"isTagExisted",value:function value(e){return this.tag.isTagExisted(e);}},{key:"addTagToSource",value:function value(e,t){if(this.statusStore.get(e)){bO(t)&&(t=[t]);for(var i=0;i<t.length;i++)if(!this.addSourceToTag(t[i],e))return!1;return!0;}return!1;}},{key:"removeTagFromSource",value:function value(e,t){if(this.statusStore.get(e)){var i;pO(t)?t=wP(i=this.tag.tags).call(i,function(e){return e.name;}):bO(t)&&(t=[t]);for(var r=0;r<t.length;r++)if(!this.removeSourceFromTag(t[r],e))return!1;return!0;}return!1;}},{key:"addSourceToTag",value:function value(e,t){var i=this.tag.getTag(e);if(i&&this.tag.appendChildToTag(e,t)){bO(t)&&(t=[t]);for(var r=0;r<t.length;r++)this.store.get(t[r]).then(function(t){var i;t&&(vO(t.tags)||(t.tags=[]),rD(i=t.tags).call(i,e)||t.tags.push(e));});var n={sourceUids:t,docUid:i.uid,type:"tag"};return this.hooks.loadToDoc.emit(n),!0;}return!1;}},{key:"removeSourceFromTag",value:function value(e,t){var i=this.tag.getTag(e);if(i){this.tag.removeChildFromTag(e,t),bO(t)&&(t=[t]);for(var r=0;r<t.length;r++)this.store.get(t[r]).then(function(t){var i,r,n=sE(i=(null==t?void 0:t.tags)||[]).call(i,e);-1!==n&&NE(r=t.tags).call(r,n,1);});var n={docUid:i.uid,sourceUids:t,type:"tag"};return this.hooks.removeFromDoc.emit(n),!0;}return!1;}},{key:"getSourceTags",value:function value(e){var t,i=this,r=this.statusStore.get(e);return r?wP(t=r.ownerTags.children).call(t,function(e){return i.tag.getTagByUid(e).name;}):[];}},{key:"switch",value:function value(e){var t=e.one,i=e.other,r=e.type,n=e.docUid,o=e.emit,a=this.getDocNode(n,r);if(a){if(a.switch(t,i),o||pO(o)){var s={one:t,other:i,docUid:n,type:a.type,trigger:this.uid,operation:"shift"};this.hooks.switch.emit(s);}return!0;}return!1;}},{key:"move",value:function value(e){var t=e.from,i=e.to,r=e.type,n=e.docUid,o=e.emit,a=this.getDocNode(n,r);if(a){if(a.move(t,i),o||pO(o)){var s={from:t,to:i,docUid:n,type:a.type,trigger:this.uid,operation:"shift"};this.hooks.move.emit(s);}return!0;}return!1;}},{key:"reorder",value:function value(e){var t=e.indexes,i=e.type,r=e.docUid,n=e.emit,o=this.getDocNode(r,i);if(o&&(o.reorder(t),n||pO(n))){var a={indexes:t,docUid:r,type:o.type,trigger:this.uid,operation:"shift"};this.hooks.move.emit(a);}}},{key:"getDocNode",value:function value(e,t){switch(t){case"default":return this.defaultFile;case"file":return this.dir.getFileByUid(e);case"tag":return this.tag.getTagByUid(e);default:return e===this.defaultFile.uid?this.defaultFile:this.tag.getTagByUid(e)||this.dir.getFileByUid(e)||null;}}}]);}(vL),cW={Successful:{errorCode:0,errorString:"Successful."},InvalidIndex:{errorCode:-1033,errorString:"Invalid index."},InvalidValue:{errorCode:-1034,errorString:"Invalid value."},NoImage:{errorCode:-1035,errorString:"There is no image."},UnBindViewer:{errorCode:-2210,errorString:"You cannot call this method on this WebTwain instance because it does not use the default viewer."},AlReadyBindViewer:{errorCode:-2211,errorString:"The element is already bound to the viewer."},ParameterCannotEmpty:{errorCode:-2314,errorString:"The parameter cannot be empty."},IndicesNotArray:{errorCode:-2358,errorString:"The type of the parameter indices must be an Array."},IndexOutOfRange:{errorCode:-2359,errorString:"The index is out of range."},InvalidTagName:{errorCode:-2394,errorString:"Invalid tag name."},InvalidLeftOrTopOrRightOrBottom:{errorCode:-2417,errorString:"The left or top or right or bottom you entered is invalid."},InvalidWidth:{errorCode:-2418,errorString:"The width you entered is invalid."},InvalidHeight:{errorCode:-2419,errorString:"The height you entered is invalid."},WidthOrHeightOutOfImageSize:{errorCode:-2420,errorString:"The width or height is out of image size."},MobileServer_InvalidIndex:{errorCode:-2423,errorString:"The index is invalid."},ImageEditorExist:{errorCode:-2500,errorString:"An ImageEditor already exists."},ThumbnailViewerExist:{errorCode:-2501,errorString:"A ThumbnailViewer already exists."},CustomElementExist:{errorCode:-2502,errorString:"A CustomElement already exists."},ImageEditorDispose:{errorCode:-2504,errorString:"The ImageEditor object has been disposed."},ThumbnailViewerNotExist:{errorCode:-2505,errorString:"This ThumbnailViewer doesn't exist."},ThumbnailViewerDispose:{errorCode:-2506,errorString:"The ThumbnailViewer object has been disposed."},CallbackNotAFunction:{errorCode:-2510,errorString:"The callback is not a function."},ElementRequired:{errorCode:-2511,errorString:"Parameter 'element' is required."},ElementNotExist:{errorCode:-2512,errorString:"Parameter 'element' doesn't instanceof HTMLDivElement."},InvalidPropertyValue:{errorCode:-2514,errorString:"Invalid property value."},CursorInvalidMode:{errorCode:-2519,errorString:"The current mode does not support setting the cursor to zoom."},OldTagNameRequired:{errorCode:-2517,errorString:"Old tag name is required."},NewTagNameRequired:{errorCode:-2518,errorString:"New tag name is required."},FileNameCannotEmpty:{errorCode:-2530,errorString:"Document name cannot be empty."},FileNameNotString:{errorCode:-2531,errorString:"Document name is not a string."},FileNotExist:{errorCode:-2540,errorString:"The document does not exist."},FileExist:{errorCode:-2541,errorString:"The document already exists."},CustomElementDispose:{errorCode:-2508,errorString:"The CustomElement object has been disposed."},CustomElementNotExist:{errorCode:-2507,errorString:"This CustomElement doesn't exist."},ParameterOutRange:{errorCode:80002,errorString:"The parameter is out of range."},TagNotExist:{errorCode:80009,errorString:"Tag does not exist."},TagExist:{errorCode:80010,errorString:"The tag already exists."},OperationError:{errorCode:80022,errorString:"The operation mode is wrong."}},hW={visibility:"hidden",width:"24px",height:"24px",background:"#ffffff",borderWidth:"1px",borderColor:"#a79898",borderRadius:"50%",opacity:1,color:"#000000",fontFamily:"sans-serif",fontSize:12,left:"",top:"",right:1,bottom:1,translateX:"",translateY:""},dW={visibility:"hidden",width:"24px",height:"24px",borderWidth:"1px",borderColor:"#000000",checkMarkColor:"#000000",checkMarkLineWidth:"2px",right:1,top:1},fW={visibility:"hidden",width:"24px",height:"24px",background:"#ffffff",borderWidth:"2px",borderColor:"#000000",checkMarkColor:"#000000",checkMarkLineWidth:"2px",borderRadius:0,opacity:1,left:1,top:1,right:"",bottom:"",translateX:"",translateY:""},vW=["topPageChanged","click","rightclick","dblclick","mousemove","pageAreaSelected","pageAreaUnselected","dragdone","onDrop","bufferChanged","removeBtnClick"];!function(e){e[e.Normal=0]="Normal",e[e.Balance=1]="Balance";}(KL||(KL={}));var gW={rows:1,columns:1,show:!1,enableDragPage:!1,enableSlide:!0,enableZoomWithCtrl:!0,enableSelectWithCtrl:!0,enableSelectWithShift:!0,scrollDirection:"vertical",displayMode:"multiple",fitType:"window",tabMode:"single",autoSelectTopPage:!1,autoScroll:!0,autoSelectLatest:!0,margin:0,gap:10,enableOptimizeImage:!0,enableDWT1x1:!0,viewerStyle:{background:"rgb(255, 255, 255)",border:""},canvasStyle:{background:"rgb(255, 255, 255)",border:"",cursor:"crosshair"},pageStyle:{border:"1px solid rgb(204, 204, 204)",background:"rgba(0,0,0,0)"},selectedPageStyle:{border:"1px solid rgb(125, 162, 206)",background:"rgb(199, 222, 252)"},hoveredPageStyle:{border:"1px solid rgb(204, 204, 204)",background:"rgb(239, 246, 253)"},placeholderStyle:{background:"rgb(251, 236, 136)"},checkboxStyle:uS({},fW),pageNumberStyle:uS({},hW),removeBtnStyle:uS({},dW)},mW={size:"30%",columns:1,rows:3,show:!1,scrollDirection:"vertical",gap:10,margin:10,autoChangeIndex:!1,autoSelectTopPage:!1,autoSelectLatest:!0,autoScroll:!0,enableKeyboardControl:!0,enableDragPage:!0,enableResizing:!1,enableDWT1x1:!0,enableOptimizeImage:!0,canvasStyle:{border:"",background:""},thumbnailStyle:{border:"",background:"rgb(255, 255, 255)"},pageStyle:{border:"1px solid rgb(238, 238, 238)",background:"transparent"},selectedPageStyle:{border:"1px solid rgb(125, 162, 206)",background:"rgb(199, 222, 252)"},hoveredPageStyle:{border:"1px solid rgb(238, 238, 238)",background:"rgb(239, 246, 253)"},pageNumberStyle:uS({},hW),checkboxStyle:uS({},fW),removeBtnStyle:uS({},dW),placeholderStyle:{background:"rgb(251, 236, 136)"}},yW={dlgRotateAnyAngle:["Angle :","Interpolation:","Keep size","  OK  ","Cancel"],dlgChangeImageSize:["New Height :","New Width :","Interpolation:","  OK  ","Cancel"],saveChangedImage:["You have changed the image, do you want to keep the change(s)?","  Yes  ","  No  "],selectSource:["Select Source:","Select","Cancel","There is no source available!"]},pW={background:"#434246",innerBorder:"",topMenuBorder:"",border:"1px solid rgb(204, 204, 204)",width:"100%",height:"100%",zoomOrigin:{x:"center",y:"center"},promptToSaveChange:!0,workMode:KL.Normal,selectionRectAspectRatio:1,buttons:{titles:{previous:"Previous Image",next:"Next Image",print:"Print Image",scan:"Acquire new Image(s)",load:"Load local Image(s)",rotateleft:"Rotate Left",rotate:"Rotate",rotateright:"Rotate Right",deskew:"Deskew",crop:"Crop Selected Area",cut:"Cut Selected Area",changeimagesize:"Change Image Size",flip:"Flip Image",mirror:"Mirror Image",zoomin:"Zoom In",originalsize:"Show Original Size",zoomout:"Zoom Out",stretch:"Stretch Mode",fit:"Fit Window",fitw:"Fit Horizontally",fith:"Fit Vertically",hand:"Hand Mode",rectselect:"Select Mode",zoom:"Click to Zoom In",restore:"Restore Original Image",save:"Save Changes",close:"Close the Editor",removeall:"Remove All Images",removeselected:"Remove All Selected Images"},visibility:{scan:!0,load:!0,print:!0,removeall:!0,removeselected:!0,rotateleft:!0,rotate:!0,rotateright:!0,deskew:!0,crop:!0,cut:!0,changeimagesize:!0,flip:!0,mirror:!0,zoomin:!0,originalsize:!0,zoomout:!0,stretch:!0,fit:!0,fitw:!0,fith:!0,hand:!0,rectselect:!0,zoom:!0,restore:!0,save:!0,close:!0}},dialogText:yW},wW={borderColor:"rgba(0,0,0,1)",borderWidth:1,ctrlBorderColor:"rgba(0,0,0,1)",ctrlBorderRadius:1,ctrlBorderWidth:1,ctrlWidth:9,ctrlHeight:9,ctrlSize:9,keepAspectRatio:!1,aspectRatio:1},bW=function(){return hS(function e(){dS(this,e),sS(this,"errCode",void 0),sS(this,"errorString",void 0);},[{key:"setError",value:function value(e,t){this.errCode=e,this.errorString=t;}},{key:"getError",value:function value(){return{errCode:this.errCode,errorString:this.errorString};}}]);}(),kW=function(){return hS(function e(t){var i=this;dS(this,e),sS(this,"space",void 0),sS(this,"webViewer",void 0),sS(this,"isActiveFile",!1),sS(this,"isActiveTag",!1),sS(this,"currentFileName",""),sS(this,"currentTagName",""),sS(this,"bufferConfig",null),sS(this,"currentSelected",[]),sS(this,"lastCurrentSelected",[]),this.space=new uW(),t&&(this.bufferConfig=t),this.space.on("bufferChanged",function(e,t){var r;if(!i.webViewer&&TO(null===(r=i.bufferConfig)||void 0===r?void 0:r.bufferChanged)){var n,o,a,s,l,u,c,h=[],d=[],f=i.getCurrentDataSet().children;pS(n=i.currentSelected).call(n,function(e){f&&f[e]&&h.push(f[e]);}),pS(o=i.lastCurrentSelected).call(o,function(e){f&&f[e]&&d.push(f[e]);});var v={afterStatus:{uids:e.afterStatus.uids,selectedUids:h,modifiedUid:(null==e||null===(a=e.afterStatus)||void 0===a?void 0:a.modifiedUid)||"",removedUids:(null==e||null===(s=e.afterStatus)||void 0===s?void 0:s.removedUids)||[],currentUid:e.afterStatus.uids[e.afterStatus.uids.length-1]||""},beforeStatus:{uids:e.beforeStatus.uids,selectedUids:d,removedUids:(null==e||null===(l=e.beforeStatus)||void 0===l?void 0:l.removedUids)||[],modifiedUid:(null==e||null===(u=e.beforeStatus)||void 0===u?void 0:u.modifiedUid)||"",currentUid:e.beforeStatus.uids[e.beforeStatus.uids.length-1]||""},operation:e.operation,docUid:e.docUid,docName:(null===(c=i.space.dir.getFileByUid(e.docUid))||void 0===c?void 0:c.name)||"",total:e.afterStatus.uids.length,curIndex:e.afterStatus.uids.length-1};i.lastCurrentSelected=tk(i.currentSelected),i.bufferConfig.bufferChanged(v,t);}});},[{key:"e",value:function value(){this.setError("Successful");}},{key:"IsFileNameExist",value:function value(e){var t=this.space.getFileList();if("dynamsoft-default-document"===e)return!0;if(t)for(var i=0;i<t.length;i++)if(t[i].name===e)return!0;return!1;}},{key:"getCurrentDataSet",value:function value(){if(this.webViewer){var e=this.webViewer.myViewer.getCurrentTab();if(void 0===e)return!1;var t=e.type;this.isActiveFile="file"===t,this.isActiveTag="tag"===t;}if(this.isActiveFile){var i=this.getCurrentFileName(),r=this.space.getFile(i);if(r)return r;}if(this.isActiveTag){var n=this.space.getTag(this.currentTagName);if(n)return n;}return!1;}},{key:"setError",value:function value(e){var t;if("Default"!==e){if(this.webViewer)this.webViewer.setError(e);else if(this.bufferConfig&&this.bufferConfig.viewerError){var i=cW[e],r=i.errorCode,n=i.errorString;this.bufferConfig.viewerError.setError(r,n);}}else null==this||null===(t=this.webViewer)||void 0===t||t.setDefaultError();}},{key:"emitViewerEvent",value:function value(){var e,t;this.webViewer&&0===this.getHowManyImagesInBuffer()&&(null===(e=this.webViewer)||void 0===e||null===(t=e.myViewer)||void 0===t||t.emit("pageRendered",-1));}},{key:"bindViewer",value:function value(e){this.webViewer=e;}},{key:"getCurrentTag",value:function value(){return this.currentTagName;}},{key:"getCurrentDocument",value:function value(){return this.currentFileName;}},{key:"getCurrentFileName",value:function value(){var e=this,t=this.space.getFileList(),i="";return t&&pS(t).call(t,function(t){t.name===e.currentFileName&&(i=e.currentFileName);}),i;}},{key:"getCurrentIndex",value:function value(){if(this.webViewer)return this.webViewer.getCurrentIndex();var e=this.getSelectedImagesIndices().length;if(e<=0){var t=this.getCurrentDataSet();return!!t&&t.children.length-1;}return this.getSelectedImagesIndices()[e-1];}},{key:"getHowManyImagesInBuffer",value:function value(){if(this.webViewer)return this.webViewer.getHowManyImagesInBuffer();var e=this.getCurrentDataSet();return e?e.children.length:0;}},{key:"getSelectedImagesIndices",value:function value(){return this.webViewer?this.webViewer.getSelectedImagesIndices():this.currentSelected;}},{key:"getIndexByUid",value:function value(e){if(!bO(e)||!e)return this.setError("InvalidValue"),!1;if(this.webViewer)return this.webViewer.myViewer.getIndexByUid(e);var t=this.getCurrentDataSet(),i=t.children;return!!(t&&i&&vO(i))&&sE(i).call(i,e);}},{key:"getUidByIndex",value:function value(e){if(e<0||e>=this.getHowManyImagesInBuffer())return this.setError("IndexOutOfRange"),!1;if(this.webViewer)return this.webViewer.myViewer.getUidByIndex(e);var t=this.getCurrentDataSet().children;return!(t&&t.length<e)&&t[e];}},{key:"getDataByUid",value:function value(e){return this.space.getSource(e);}},{key:"updateDataByUid",value:function value(e,t){return this.space.store.set(e,t);}},{key:"setCustomDataByUid",value:function value(e,t){return bO(e)&&""!==e?this.space.setCustomData(e,t):(this.setError("InvalidValue"),!1);}},{key:"getCustomDataByUid",value:function value(e){return this.space.getCustomData(e);}},{key:"setMetadataByUid",value:function value(e,t){return bO(e)&&""!==e?this.space.setMetadata(e,t):(this.setError("InvalidValue"),!1);}},{key:"getMetadataByUid",value:function value(e){return this.space.getMetadata(e);}},{key:"addImage",value:function value(e,t,i){var r,n,o={},a=this.currentFileName,s="";!pO(i)&&bO(i)?(this.IsFileNameExist(i)||this.createDocument(i),s=i):pO(a)||""===a?(this.space.isFileExisted("dynamsoft-default-document")||this.createDocument("dynamsoft-default-document"),this.webViewer&&(this.webViewer.bEmitBufferChanged=!1),this.openDocument("dynamsoft-default-document"),this.webViewer&&(this.webViewer.bEmitBufferChanged=!0),s="dynamsoft-default-document"):s=a,t&&(delete(n=uS({},t)).oriBlobData,t.oriBlobData&&(r=t.oriBlobData));var l=e.imageUrl,u=e.minImageUrl,c=e.imageId,h=e.serverId,d=e.uidFromServer,f=e.index;r&&(o=uS({},r)),c&&(o.imageId=c),h&&(o.serverId=h),d&&(o.uidFromServer=d);var v=this.getDocumentContents(s).length;!pO(f)&&CO(f)?f>=v&&(f=v):f=v,this.isActiveFile&&(this.currentSelected=[f]);var g=this.space.loadSource({data:[{oriData:l,minData:u,metadata:n,customData:o}],filename:s,index:f},function(t){var i=ek(t,1)[0];e.uuid=i;}),m=this.getHowManyImagesInBuffer();return this.isActiveTag&&(this.currentSelected=m>0?[m-1]:[]),g;}},{key:"insertImage",value:function value(e,t,i){var r;if(i&&i>=0)this.currentSelected=[i],r=this.space.loadSource({data:[e],filename:t,index:i});else{r=this.space.loadSource({data:[e],filename:t});var n=this.getHowManyImagesInBuffer();this.currentSelected=n>0?[n-1]:[];}return r[0];}},{key:"updateImage",value:function value(e,t){var i=e.imageUrl,r=e.minImageUrl,n=e.imageId,o=e.serverId,a=e.uidFromServer,s=e.uuid,l=uS({},t);return s&&""!==s&&-1!==s?(this.space.updateSource(s,{oriData:i,minData:r,metadata:l,customData:{imageId:n,serverId:o,uidFromServer:a}}),s):(this.setError("IndexOutOfRange"),!1);}},{key:"removeImageByUid",value:function value(e){if(this.e(),this.webViewer){var t=this.webViewer.removePageByUid(e);return this.webViewer.resized(),this.emitViewerEvent(),t;}return this.space.removeSource(e);}},{key:"removeImageByIndex",value:function value(e){if(this.e(),e<0||e>=this.getHowManyImagesInBuffer())return this.setError("IndexOutOfRange"),!1;var t=this.getCurrentIndex(),i=!1;if(this.currentSelected=e===t&&0===e?this.getHowManyImagesInBuffer()>0?[0]:[]:e<=t?[t-1]:[t],this.webViewer)i=this.webViewer.removePageByIndexes(e),this.webViewer.resized(),this.emitViewerEvent();else{var r=this.getCurrentDataSet();if(!r)return!1;i=this.space.removeSource(r.children[e]);}return i||this.setError("Default"),i;}},{key:"removeSelectedImages",value:function value(e){this.e();var t=this.getSelectedImagesIndices();vO(e)&&e.length>0&&(t=e);var i=!1;if(this.webViewer)i=this.webViewer.removePageByIndexes(t),this.webViewer.resized(),this.emitViewerEvent();else{var r=[],n=this.getCurrentDataSet();if(!n)return!1;pS(t).call(t,function(e){n.children[e]&&n.children[e]&&r.push(n.children[e]);}),i=this.space.removeSource(r);}i||this.setError("Default");var o=this.getHowManyImagesInBuffer();return this.currentSelected=o>0?[o-1]:[],i;}},{key:"removeImageByIndexArr",value:function value(e){if(this.e(),!vO(e))return!1;var t=this.getCurrentDataSet();if(!t)return!1;var i,r=[];pS(e).call(e,function(e){var i=t.children[e];i&&r.push(i);}),(i=this.space.removeSource(r))||this.setError("Default"),this.webViewer&&(this.webViewer.resized(),this.emitViewerEvent());var n=this.getHowManyImagesInBuffer();return this.currentSelected=n>0?[n-1]:[],i;}},{key:"removeAllImages",value:function value(){this.e();var e=!1;if(this.currentSelected=[],this.webViewer)e=this.webViewer.removeAllPages(),this.webViewer.resized(),this.emitViewerEvent();else{var t=this.getCurrentDataSet();t&&(e=this.space.removeSource(tk(t.children)));}return e||this.setError("Default"),e;}},{key:"tagImages",value:function value(e,t){this.e();var i=this.getHowManyImagesInBuffer();if(!vO(e))return this.setError("IndicesNotArray"),!1;if(!bO(t)||""===t)return this.setError("InvalidTagName"),!1;for(var r=0;r<i;r++){var n=e[r];if(AS(n)||n<0||n>=i)return this.setError("IndexOutOfRange"),!1;}this.space.createTag(t);for(var o=0;o<e.length;o++){var a=e[o];if(a>=0){var s=this.getUidByIndex(a);s&&""!==s&&-1!==px(s,10)&&this.space.addTagToSource(s,t);}}return!0;}},{key:"removeImageTag",value:function value(e,t){if(this.e(),!CO(e))return this.setError("InvalidValue"),!1;if(e<0||e>this.getHowManyImagesInBuffer())return this.setError("IndexOutOfRange"),!1;var i=this.getUidByIndex(e),r=!1;return i&&""!==i&&-1!==i&&(r=this.space.removeTagFromSource(i,t)),r||this.setError("Default"),r;}},{key:"getDefaultTag",value:function value(){return this.space.getDefaultTag();}},{key:"setDefaultTag",value:function value(e){if(this.e(),!bO(e))return this.setError("InvalidValue"),!1;if(""===e)return this.space.setDefaultTag(null),!0;var t;return this.space.createTag(e),(t=this.space.setDefaultTag(e))||this.setError("Default"),t;}},{key:"removeTag",value:function value(e,t){var i=this;if(this.e(),!bO(e))return this.setError("InvalidValue"),!1;if(!pO(t)&&!vO(t))return this.setError("IndicesNotArray"),!1;if(!this.space.isTagExisted(e))return this.setError("TagNotExist"),!1;var r=this.currentTagName,n=!1,o=!1;if(r&&(n=r===e),pO(t))o=this.space.removeTag(e),n&&this.clearFilter();else{var a=[];pS(t).call(t,function(e){var t=i.getUidByIndex(e);-1!==t&&a.push(t);});for(var s=0;s<(null==a?void 0:a.length);s++)if(!(o=this.space.removeTagFromSource(a[s],e)))return!1;}return o||this.webViewer.setDefaultError(),o;}},{key:"renameTag",value:function value(e,t){if(this.e(),pO(e)||""===e)return this.setError("OldTagNameRequired"),!1;if(pO(t)||""===t)return this.setError("NewTagNameRequired"),!1;if(!this.space.isTagExisted(e))return this.setError("TagNotExist"),!1;if(this.space.isTagExisted(t))return this.setError("TagExist"),!1;var i;return e===this.currentTagName&&(this.currentTagName=t),(i=this.space.renameTag(e,t))?this.space.setDefaultTag(t):this.setError("Default"),i;}},{key:"getTagContents",value:function value(e){return this.e(),e&&bO(e)&&""!==e?this.space.getTag(e).children:[];}},{key:"getTagList",value:function value(){var e=this;this.e();var t=this.space.getTagList(),i=[];return t?pS(t).call(t,function(t){var r,n=[];pS(r=t.children).call(r,function(t){var i=e.getCustomDataByUid(t);if(i){var r=i.uidFromServer;n.push(r);}}),i.push({name:t.name,imageIds:n});}):i=[],i;}},{key:"getTagListByIndex",value:function value(e){if(!CO(e))return!1;var t=this.getUidByIndex(e);return this.space.getSourceTags(t);}},{key:"clearFilter",value:function value(){this.e(),this.currentTagName="",this.space.setDefaultTag(null);var e,t=this.getCurrentFileName();return""===t&&(t="dynamsoft-default-document"),(e=this.openDocument(t))||this.setError("Default"),e;}},{key:"filterImagesByTag",value:function value(e,t,i){this.e();var r=!1;if(pO(e)||null===e||""===e){this.currentTagName="";var n=this.getCurrentFileName();""===n&&(n="dynamsoft-default-document"),(r=this.openDocument(n))?TO(t)&&t():(this.setError("Default"),TO(i)&&i());}else{var o,a;if(!this.space.isTagExisted(e))return this.setError("TagNotExist"),TO(i)&&i(),!1;if(this.isActiveTag=!0,this.isActiveFile=!1,this.currentTagName=e,this.setDefaultTag(e),r=this.space.openTag(e,null==this||null===(o=this.webViewer)||void 0===o||null===(a=o.myViewer)||void 0===a?void 0:a.uid)){var s=this.space.getTag(e);if(s){var l,u=(null==s||null===(l=s.children)||void 0===l?void 0:l.length)||0;this.currentSelected=u>0?[u-1]:[];}TO(t)&&t();}else this.setError("Default"),TO(i)&&i();}return this.webViewer&&this.webViewer.render(),r;}},{key:"createDocument",value:function value(e){if(this.e(),!e||""===e){var t=CO(e)?"FileNameNotString":"FileNameCannotEmpty";return this.setError(t),!1;}return bO(e)?this.space.isFileExisted(e)?(this.setError("FileExist"),!1):!!this.space.createFile(e)||(this.setError("Default"),!1):(this.setError("FileNameNotString"),!1);}},{key:"openDocument",value:function value(e,t){var i,r;if(this.e(),!e||""===e){var n=CO(e)?"FileNameNotString":"FileNameCannotEmpty";return this.setError(n),!1;}if(!bO(e))return this.setError("FileNameNotString"),!1;if(!this.space.isFileExisted(e))return this.setError("FileNotExist"),!1;var o=t&&""!==t?t:null==this||null===(i=this.webViewer)||void 0===i||null===(r=i.myViewer)||void 0===r?void 0:r.uid,a=this.space.getFile(e);if(a){var s,l=null==a||null===(s=a.children)||void 0===s?void 0:s.length;this.currentSelected=l>0?[l-1]:[];}return this.space.openFile(e,{viewerUid:o})?(this.currentFileName=e,this.isActiveFile=!0,this.isActiveTag=!1,!0):(this.setError("Default"),!1);}},{key:"getDocumentContents",value:function value(e){return this.e(),e&&bO(e)&&""!==e?this.space.isFileExisted(e)?this.space.getFile(e).children:(this.setError("FileNotExist"),[]):[];}},{key:"renameDocument",value:function value(e,t){return this.e(),bO(e)&&bO(t)?(e&&""!==e&&t&&""!==t||this.setError("FileNameCannotEmpty"),this.space.isFileExisted(e)?this.space.isFileExisted(t)?(this.setError("FileExist"),!1):this.space.renameFile(e,t)?(this.currentFileName===e&&(this.currentFileName=t),!0):(this.setError("Default"),!1):(this.setError("FileNotExist"),!1)):(this.setError("FileNameNotString"),!1);}},{key:"removeDocument",value:function value(e){if(this.e(),!e||!bO(e))return this.setError("FileNameNotString"),!1;if(!this.space.isFileExisted(e))return this.setError("FileNotExist"),!1;var t=this.space.removeFile(e);return t?(t&&this.webViewer&&this.webViewer.resized(),this.currentFileName===e&&(this.currentFileName=""),!0):(this.setError("Default"),!1);}},{key:"getDocumentInfoList",value:function value(){var e=this;this.e();var t=this.space.getFileList(),i=[];return t?(pS(t).call(t,function(t){if(t.children){for(var r=[],n=0;n<t.children.length;n++){var o=t.children[n],a=e.getCustomDataByUid(o);if(a){var s=a.uidFromServer;r.push(s);}}i.push({imageIds:r,name:t.name});}}),i):[];}},{key:"getDocumentInfo",value:function value(e){this.e();var t=this.space.getFile(e);if(!t)return this.setError("FileNotExist"),{imageIds:[],length:0};for(var i=[],r=0;r<t.children.length;r++){var n=t.children[r],o=this.getCustomDataByUid(n);if(o){var a=o.uidFromServer;i.push(a);}}return{imageIds:i,length:i.length};}},{key:"selectImages",value:function value(e){this.e();var t=!0;if(!e||!vO(e))return!1;if(this.webViewer){var i=this.webViewer.getIfAutoScroll();!1===i&&this.webViewer.setIfAutoScroll(!0),t=this.webViewer.selectPages(e),!1===i&&this.webViewer.setIfAutoScroll(!1);}else{for(var r=this.getHowManyImagesInBuffer(),n=0;n<e.length;n++)if(!CO(e[n])||e[n]<0||e[n]>=r)return this.setError("ParameterOutRange"),!1;t=!0;}return t?this.currentSelected=e:this.setError("Default"),t;}},{key:"selectAllImages",value:function value(){this.e();var e=!0;if(this.webViewer)e=this.webViewer.myViewer.selectAll(),this.currentSelected=this.webViewer.getSelectedImagesIndices();else{var t,i=this.getCurrentDataSet();this.currentSelected=aD(yD(t=new Array(i.children.length)).call(t));}return e||this.setError("Default"),e;}},{key:"moveImage",value:function value(e,t){this.e();var i=px(e,10),r=px(t,10);if(AS(e)||AS(t))return this.setError("InvalidIndex"),!1;var n=this.getHowManyImagesInBuffer();if(i<0||i>=n||r<0||r>n)return this.setError("IndexOutOfRange"),!1;var o=!1;if(this.webViewer)o=this.webViewer.myViewer.movePage(e,t);else{var a=this.getCurrentDataSet();if(!a)return!1;a.children.length>t&&(this.currentSelected=[t]),o=this.space.move({docUid:a.uid,type:a.type,from:e,to:t});}return o||this.setError("Default"),o;}},{key:"switchImage",value:function value(e,t){this.e();var i=px(e,10),r=px(t,10);if(AS(e)||AS(t))return this.setError("InvalidIndex"),!1;var n=this.getHowManyImagesInBuffer(),o=this.getCurrentIndex();if(i<0||i>=n||r<0||r>n)return this.setError("IndexOutOfRange"),!1;var a=!1;if(this.webViewer)a=this.webViewer.myViewer.switchPage(e,t);else{var s=this.getCurrentDataSet();if(!s)return!1;a=this.space.switch({docUid:s.uid,type:s.type,one:e,other:t});}a||this.setError("Default");var l=o;return i===o?l=r:r===o&&(l=i),this.currentSelected=[l],a;}},{key:"moveImageToFile",value:function value(e,t,i,r){if(!this.space.isFileExisted(e)||!this.space.isFileExisted(i))return this.setError("FileNotExist"),!1;t=tk(new iA(t));var n=this.getDocumentInfo(e).length;if(!vO(t)||t.length>n)return this.setError("ParameterOutRange"),!1;var o=this.getDocumentInfo(i).length,a=this.space.movePagesToFile(e,t,i,r);if(!this.webViewer&&this.isActiveFile){var s=this.getHowManyImagesInBuffer();e===this.currentFileName&&(this.currentSelected=s>0?[s-1]:[]),i===this.currentFileName&&(CO(r)&&r<o&&r>=0?this.currentSelected=[r+t.length-1]:this.currentSelected=s>0?[s-1]:[]);}return a;}}]);}(),SW=function(){return hS(function e(t){var i,r,n,o,a=this;dS(this,e),sS(this,"uid",null),sS(this,"mode","default"),sS(this,"vertexes",[]),sS(this,"midpoints",[]),sS(this,"probePoints",[]),sS(this,"slopeRatio",[]),sS(this,"sensorRadius",4),sS(this,"isPointSelected",!1),sS(this,"activeProbePoint",null),sS(this,"isConvex",!0),sS(this,"isMoveBox",!1),sS(this,"width",0),sS(this,"height",0),sS(this,"zoom",1),sS(this,"keepAspectRatio",!1),sS(this,"aspectRatio",0),sS(this,"startX",null),sS(this,"startY",null),sS(this,"lastX",null),sS(this,"lastY",null),sS(this,"lastWhr",1),sS(this,"b1",void 0),sS(this,"b2",void 0),sS(this,"k1",void 0),sS(this,"k2",void 0),this.uid=AO(),pS(i=kS(t)).call(i,function(e){a[e]=t[e];}),this.midpoints=xW(this.vertexes),this.probePoints=BS(r=nE(n=this.vertexes).call(n)).call(r,nE(o=this.midpoints).call(o)),this.slopeRatio=CW(this.vertexes);},[{key:"getRect",value:function value(){if("free"===this.mode)return null;var e=this.getBounds(),t=e.minX,i=e.maxX,r=e.minY;return{x:t,y:r,width:i-t||1,height:e.maxY-r||1};}},{key:"isBoxSelected",value:function value(e,t){var i=this.isPointOnBox(e,t),r=this.isCtrlPointSelected(e,t);return null!==r?r:i?8:-1;}},{key:"isCtrlPointSelected",value:function value(e,t){for(var i=hL(),r=this.sensorRadius,n=this.zoom,o=this.probePoints,a=this.width,s=this.height,l=r/n,u=zO(l,0,3*l)*i,c=zO(l,0,3*l)*i,h=0;h<8;h++){var d=o[2*h],f=o[2*h+1];if(e<=d+u&&e>=d-u&&t<=f+c&&t>=f-c&&e>=0-u&&e<=a+u&&t>=0-c&&t<=s+c)return h;}return null;}},{key:"checkOrientation",value:function value(e){if(e<0||e>7)return null;var t=this.getBounds(),i=t.minX,r=t.maxX,n=t.minY,o=t.maxY,a=this.probePoints,s=a[2*e],l=a[2*e+1],u=null,c=null;return s===r?u="e":s===i&&(u="w"),l===o?c="s":l===n&&(c="n"),e<4?c+u:c||u;}},{key:"onStartHandler",value:function value(e,t,i){if(void 0===i&&(i=this.isBoxSelected(e,t)),!(i<0)){this.startX=e,this.startY=t,this.lastX=e,this.lastY=t,8===i?(this.isPointSelected=!1,this.activeProbePoint=null,this.isMoveBox=!0):(this.isPointSelected=!0,this.activeProbePoint=i,this.isMoveBox=!1);var r=this.mode,n=this.probePoints,o=this.slopeRatio;if("free"===r&&i>3&&i<8){var a=i-4;this.k1=o[(a+1)%4],this.b1=n[(2*a+3)%8]-this.k1*n[(2*a+2)%8],this.k2=o[(a+3)%4],this.b2=n[(2*a+1)%8]-this.k2*n[(2*a+0)%8];}}}},{key:"onMoveHandler",value:function value(e,t,i){var r,n,o=this.isPointSelected,a=this.isMoveBox,s=this.probePoints,l=this.activeProbePoint,u=this.lastX,c=this.lastY,h=this.mode;if(o||a){var d=e-u,f=t-c;if(0!==d||0!==f){var v=nE(s).call(s);o?(void 0===i&&(i=l),"default"===h?v=this.movePointNormal(v,i,e,t):(v=this.movePointFree(v,i,e,t),this.slopeRatio=nE(r=CW(s)).call(r,0,4),this.isConvex=this.checkConvexity(v))):a&&(v=this.moveBox(v,d,f));var g=xW(v);this.probePoints=BS(n=nE(v).call(v,0,8)).call(n,g),this.midpoints=g,this.lastX=e,this.lastY=t;}}}},{key:"onEndHandler",value:function value(){var e,t,i,r,n=this.isPointSelected,o=this.isMoveBox,a=this.startX,s=this.startY,l=this.vertexes,u=this.midpoints,c=this.lastX,h=this.lastY;if(this.startX=0,this.startY=0,n||o){this.isPointSelected=!1,this.isMoveBox=!1,this.activeProbePoint=null;var d=nE(e=this.probePoints).call(e),f=this.checkConvexity(d);(a===c&&s===h||!f)&&(d=BS(t=nE(l).call(l)).call(t,u)),this.isConvex=!0,this.vertexes=nE(d).call(d,0,8),this.midpoints=xW(d),this.probePoints=BS(i=nE(d).call(d,0,8)).call(i,this.midpoints),this.slopeRatio=nE(r=CW(d)).call(r,0,4);}}},{key:"getBounds",value:function value(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.probePoints;return{minX:Math.min(e[0],e[2],e[4],e[6]),maxX:Math.max(e[0],e[2],e[4],e[6]),minY:Math.min(e[1],e[3],e[5],e[7]),maxY:Math.max(e[1],e[3],e[5],e[7])};}},{key:"movePointNormal",value:function value(e,t,i,r){i=Math.max(0,Math.min(this.width,i)),r=Math.max(0,Math.min(this.height,r));var n=0,o=0;if(this.keepAspectRatio){var a=this.getBounds(),s=a.minX,l=a.maxX,u=a.minY,c=a.maxY,h=this.checkOrientation(t),d=(l-s)/(c-u);0===d||d===1/0||d===-1/0||AS(d)?d=this.lastWhr:this.lastWhr=d,n=0,o=0;var f="w";if(t<4){if(n=i-e[2*t],o=r-e[2*t+1],0===n||0===o)return e;f="w";}else{var v=t-4;if("e"===h?(t=(v+1)%4,f="w"):"s"===h?(t=v,f="h"):"w"===h?(t=v,f="w"):"n"===h&&(t=(v+1)%4,f="h"),n=i-e[2*v],o=r-e[2*v+1],0===n||0===o)return e;}"h"===f?(n=o*d,"ne"!==h&&"sw"!==h&&"n"!==h&&"w"!==h||(n=-n)):(o=n/d,"ne"!==h&&"sw"!==h&&"n"!==h&&"w"!==h||(o=-o));var g=e[2*t]+n,m=e[2*t+1]+o,y=this.width,p=this.height;g<0?(n=0-e[2*t],o=0):g>y?(n=y-e[2*t],o=0):m<0?(o=0-e[2*t+1],n=0):m>p&&(o=p-e[2*t+1],n=0),e[2*t]+=n,e[2*t+1]+=o;var w=(t+1)%4,b=(t+3)%4;t%2?(e[2*w]+=n,e[2*b+1]+=o):(e[2*w+1]+=o,e[2*b]+=n);}else if(t<4){if(n=i-e[2*t],o=r-e[2*t+1],0===n&&0===o)return e;e[2*t]=i,e[2*t+1]=r;var k=(t+1)%4,S=(t+3)%4;t%2?(e[2*k]=i,e[2*S+1]=r):(e[2*k+1]=r,e[2*S]=i);}else{var x=t-4,C=this.slopeRatio[x%4];0===C?(e[(2*x+3)%8]=r,e[(2*x+1)%8]=r):C!==1/0&&C!==-1/0||(e[(2*x+2)%8]=i,e[(2*x+0)%8]=i);}return e;}},{key:"movePointFree",value:function value(e,t,i,r){i=Math.max(0,Math.min(this.width,i)),r=Math.max(0,Math.min(this.height,r));var n=nE(e).call(e);if(t<4){var o=i-e[2*t],a=r-e[2*t+1];if(0===o&&0===a)return e;e[2*t]=i,e[2*t+1]=r;}else{var s=t-4,l=this.slopeRatio[s%4],u=r-l*i,c=-u/l,h=u,d=e[(2*s+9)%8]-l*e[(2*s+8)%8],f=-d/l,v=this.k1,g=this.b1,m=this.k2,y=this.b2;0===l?(e[(2*s+3)%8]=r,v!==1/0&&v!==-1/0&&(e[(2*s+2)%8]=(r-g)/v),e[(2*s+1)%8]=r,m!==1/0&&m!==-1/0&&(e[(2*s+0)%8]=(r-y)/m)):l===1/0||l===-1/0?(e[(2*s+2)%8]=i,e[(2*s+3)%8]=v*i+g,e[(2*s+0)%8]=i,e[(2*s+1)%8]=m*i+y):(0===v?e[(2*s+2)%8]+=c-f:v===1/0||v===-1/0?e[(2*s+3)%8]+=h-d:(e[(2*s+2)%8]=(g-u)/(l-v),e[(2*s+3)%8]=(l*g-v*u)/(l-v)),0===m?e[(2*s+0)%8]+=c-f:m===1/0||m===-1/0?e[(2*s+1)%8]+=h-d:(e[(2*s+0)%8]=(y-u)/(l-m),e[(2*s+1)%8]=(l*y-m*u)/(l-m)));for(var p=0;p<4;p++){var w=e[2*p],b=e[2*p+1];if(w<0||w>this.width||b<0||b>this.height)return n;}}return e;}},{key:"moveBox",value:function value(e,t,i){var r=this.getBounds(e),n=r.minX,o=r.maxX,a=r.minY,s=r.maxY,l=this.width,u=this.height;n+t<0&&(t=0-n),o+t>l&&(t=l-o),a+i<0&&(i=0-a),s+i>u&&(i=u-s);for(var c=0;c<4;c++)e[2*c]+=t,e[2*c+1]+=i;return e;}},{key:"isPointOnBox",value:function value(e,t){var i=this.getBounds(),r=i.minX,n=i.maxX,o=i.minY,a=i.maxY;if(e<r||e>n||t<o||t>a)return!1;if("free"===this.mode){for(var s=tk(this.vertexes),l=tk(this.midpoints),u=[],c=0;c<4;c++)u.push(NE(s).call(s,0,2)),u.push(NE(l).call(l,0,2));var h=function(e,t){var i,r,n,o,a=0,s=t.length;for(n=ek(t,1)[0],i=1;i<=s;i++){o=t[i%s],e[0]>Math.min(n[0],o[0])&&e[0]<=Math.max(n[0],o[0])&&e[1]<=Math.max(n[1],o[1])&&n[0]!==o[0]&&(r=(e[0]-n[0])*(o[1]-n[1])/(o[0]-n[0])+n[1],(n[1]===o[1]||e[1]<=r)&&(a+=1)),n=o;}return a%2!=0;}([e,t],u);return h;}return!0;}},{key:"checkConvexity",value:function value(e){var t,i=ek(e,8),r=i[0],n=i[1],o=i[2],a=i[3],s=i[4],l=i[5],u=i[6],c=i[7],h=(u-r)*(a-n)-(c-n)*(o-r),d=(r-o)*(l-a)-(n-a)*(s-o),f=(o-s)*(c-l)-(a-l)*(u-s),v=(s-u)*(n-c)-(l-c)*(r-u);if(h*d*f*v<0)return!1;var g=BS(t=nE(e).call(e)).call(t,nE(e).call(e,0,2)),m=this.slopeRatio;if(m.length)for(var y=0;y<2;y++)if(m[y]!==m[y+2]&&VW(nE(g).call(g,2*y,2*y+2),nE(g).call(g,2*y+2,2*y+4),nE(g).call(g,2*y+4,2*y+6),nE(g).call(g,2*y+6,2*y+8)))return!1;return h*d*f*v>0;}}]);}();function xW(e){for(var t,i=BS(t=nE(e).call(e,0,8)).call(t,e[0],e[1]),r=[],n=0;n<4;n++){var o=(i[2*n]+i[2*n+2])/2,a=(i[2*n+1]+i[2*n+3])/2;r.push(o,a);}return r;}function CW(e){for(var t,i=[],r=null,n=BS(t=nE(e).call(e,0,8)).call(t,e[0],e[1]),o=0;o<4;o++)r=n[2*o+3]-n[2*o+1]===0&&n[2*o+2]-n[2*o]===0?0:(n[2*o+3]-n[2*o+1])/(n[2*o+2]-n[2*o]),i.push(r);return i;}function VW(e,t,i,r){if(function(e,t,i,r){var n=Math.min,o=Math.max;return n(e[0],t[0])<=o(i[0],r[0])&&n(i[0],r[0])<=o(e[0],t[0])&&n(e[1],t[1])<=o(i[1],r[1])&&n(i[1],r[1])<=o(e[1],t[1]);}(e,t,i,r)&&function(e,t,i,r){var n=e[0]*(i[1]-t[1])+t[0]*(e[1]-i[1])+i[0]*(t[1]-e[1]),o=e[0]*(r[1]-t[1])+t[0]*(e[1]-r[1])+r[0]*(t[1]-e[1]);return!((n^o)>=0&&0!==n&&0!==o||(n=i[0]*(e[1]-r[1])+r[0]*(i[1]-e[1])+e[0]*(r[1]-i[1]),o=i[0]*(t[1]-r[1])+r[0]*(i[1]-t[1])+t[0]*(r[1]-i[1]),(n^o)>=0&&0!==n&&0!==o));}(e,t,i,r)){var n=(r[0]-i[0])*(e[1]-t[1])-(t[0]-e[0])*(i[1]-r[1]),o=(e[1]-i[1])*(t[0]-e[0])*(r[0]-i[0])+i[0]*(r[1]-i[1])*(t[0]-e[0])-e[0]*(t[1]-e[1])*(r[0]-i[0]);if(0===n||0===o){var a=TW(e,t),s=TW(i,r),l=a[0],u=a[1],c=s[0],h=s[1];if(u[0]===c[0]&&u[1]===c[1])return u;if(l[0]===h[0]&&l[1]===h[1])return l;if(IW(u,s)&&IW(c,a))return[c,u];if(IW(l,s)&&IW(h,a))return[l,h];if(IW(l,s)&&IW(u,s))return[l,u];if(IW(c,s)&&IW(h,s))return[c,h];}var d=o/n;return n=(e[0]-t[0])*(r[1]-i[1])-(t[1]-e[1])*(i[0]-r[0]),[d,(o=t[1]*(e[0]-t[0])*(r[1]-i[1])+(r[0]-t[0])*(r[1]-i[1])*(e[1]-t[1])-r[1]*(i[0]-r[0])*(t[1]-e[1]))/n];}return!1;}function TW(e,t){return e[0]===t[0]?e[1]<t[1]?[e,t]:[t,e]:e[0]<t[0]?[e,t]:[t,e];}function IW(e,t){return t[0][0]===t[1][0]?e[1]>=t[0][1]&&e[1]<=t[1][1]:e[0]>=t[0][0]&&e[0]<=t[1][0];}var EW={aspectRatio:1,keepAspectRatio:!1,keepAspectRatioEdit:!1,keepAspectRatioWithShift:!0,multipleCropping:!0,enableCreateBoxByPointer:!0,enableCursor:!0,enableMagnifier:!0,borderColor:"orange",borderWidth:2,background:"rgba(255,255,255,0)",dashLine:[5,2],ctrlSize:16,ctrlBorderWidth:2,ctrlBorderRadius:4,ctrlBorderColor:"orange",ctrlBackground:"rgba(255,0,0,0)",invalidCtrlBorderColor:"red",invalidBorderColor:"red",magnifier:{fixed:!1,fixedTop:0,fixedLeft:0,size:50,magnification:2}},PW=function(){return hS(function e(t,i){dS(this,e),sS(this,"activeBoxId",null),sS(this,"startX",null),sS(this,"startY",null),sS(this,"addNewFlag",null),sS(this,"drawingFlag",!1),sS(this,"lastKeepAspectRatio",!1),sS(this,"area",null),sS(this,"canvasItem",null),sS(this,"cropBoxes",[]),sS(this,"width",0),sS(this,"height",0),sS(this,"scrollTop",0),sS(this,"scrollLeft",0),sS(this,"zoom",1),sS(this,"aspectRatio",0),sS(this,"keepAspectRatio",!1),sS(this,"keepAspectRatioEdit",!1),sS(this,"mouseDown",!1),sS(this,"cropSetting",{}),sS(this,"currentBoxId",void 0),sS(this,"unselectedCallback",null),sS(this,"selectedCallback",null),this.width=t,this.height=i,this.cropSetting=_mO(EW);},[{key:"count",value:function value(){return this.cropBoxes.length;}},{key:"setCanvas",value:function value(e){this.canvasItem=e;}},{key:"setCanvasSize",value:function value(e,t){this.width=e,this.height=t,this.area||this.setArea(0,0,e,t);}},{key:"setKeepAspectRatio",value:function value(e){var t;this.keepAspectRatio=e,this.drawingFlag||pS(t=this.cropBoxes).call(t,function(t){t.keepAspectRatio=e;});}},{key:"setAspectRatio",value:function value(e){this.aspectRatio=e;}},{key:"setZoom",value:function value(e){var t;this.zoom=e,pS(t=this.cropBoxes).call(t,function(t){t.zoom=e;});}},{key:"setScrollTop",value:function value(e){this.scrollTop=e;}},{key:"setScrollLeft",value:function value(e){this.scrollLeft=e;}},{key:"setCropSetting",value:function value(){var e=MO(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},_mO(this.cropSetting));this.cropSetting=e;var t=this.cropSetting,i=t.keepAspectRatioEdit,r=t.keepAspectRatio;return this.keepAspectRatioEdit=i,r?(this.setKeepAspectRatio(!0),this.setAspectRatio(this.cropSetting.aspectRatio)):this.setKeepAspectRatio(!1),!0;}},{key:"getCropBoxes",value:function value(){var e,t=[];return pS(e=this.cropBoxes).call(e,function(e,i){var r=e.getRect();null!==r&&t.push({index:i,left:r.x,top:r.y,width:r.width,height:r.height});}),t;}},{key:"getRectArr",value:function value(){var e;return wP(e=this.cropBoxes).call(e,function(e,t){return uS({index:t},e.getRect());});}},{key:"clear",value:function value(){var e;this.cropBoxes.length>0&&null!==(e=this.unselectedCallback)&&void 0!==e&&e.call(this),this.cropBoxes=[];}},{key:"addFreeBox",value:function value(e){var t=this.cropSetting,i=t.ctrlSize,r=t.ctrlHeight,n=t.ctrlWidth,o=i;(n||r)&&(o=Math.max(n,r));var a=new SW({vertexes:nE(e).call(e),width:this.area.width,height:this.area.height,sensorRadius:o/2,mode:"free"});return this.cropBoxes.push(a),a;}},{key:"addBox",value:function value(e){var t=this.cropSetting,i=t.ctrlSize,r=t.ctrlHeight,n=t.ctrlWidth,o=i;(n||r)&&(o=Math.max(n,r));var a=new SW({vertexes:nE(e).call(e),width:this.area.width,height:this.area.height,mode:"default",aspectRatio:this.aspectRatio,keepAspectRatio:this.keepAspectRatio,sensorRadius:o/2,zoom:this.zoom});return a.isScaled=!1,this.cropBoxes.push(a),a;}},{key:"removeBox",value:function value(e){var t=this.cropBoxes;return pO(e)?(this.clear(),!0):!(e<0||e>=t.length||(NE(t).call(t,e,1),0));}},{key:"getBoxByUid",value:function value(e){var t;return YP(t=this.cropBoxes).call(t,function(t){return t.uid===e;});}},{key:"setArea",value:function value(e,t,i,r){var n;this.area={left:e,top:t,width:i,height:r},pS(n=this.cropBoxes).call(n,function(e){e.width=i,e.height=r;});}},{key:"isInArea",value:function value(e,t){var i=this.area,r=i.width,n=i.height;return!(e<0||e>r||t<0||t>n);}},{key:"checkSelect",value:function value(e,t){var i;return KE(i=this.cropBoxes).call(i,function(i){return i.isBoxSelected(e,t)>-1;});}},{key:"checkSelectForCursor",value:function value(e,t){for(var i=this.cropBoxes.length-1;i>=0;i--){var r=this.cropBoxes[i],n=r.isBoxSelected(e,t);if(n>-1){var o="move";return n<8&&(o=r.checkOrientation(n)),{part:n,position:o,mode:r.mode};}}return null;}},{key:"checkSelectVertex",value:function value(e,t){for(var i=this.cropBoxes.length-1;i>=0;i--){var r=this.cropBoxes[i].isBoxSelected(e,t);if(r>-1&&r<4)return!0;}return!1;}},{key:"onStartHandler",value:function value(e,t,i){var r=this.area,n=r.width,o=r.height,a=this.checkSelect(e,t);if(e=zO(e,0,n),t=zO(t,0,o),this.startX=e,this.startY=t,this.mouseDown=!0,a<0)return i||this.clear(),this.activeBoxId=null,void(this.lastKeepAspectRatio&&!this.keepAspectRatio&&this.setKeepAspectRatio(!0));var s=this.cropBoxes[a].uid;this.currentBoxId=s,this.activeBoxId=s,this.getBoxByUid(s).onStartHandler(e,t),!this.keepAspectRatioEdit&&this.keepAspectRatio&&(this.lastKeepAspectRatio=this.keepAspectRatio,this.setKeepAspectRatio(!1));}},{key:"onMoveHandler",value:function value(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.mouseDown){var r=null,n=this.activeBoxId,o=this.startX,a=this.startY,s=this.aspectRatio,l=this.area,u=l.width,c=l.height;e=zO(e,0,u);var h=(t=zO(t,0,c))-a,d=e-o,f=2/this.zoom,v=null;if(n||(d<-f&&h<-f?v=0:d>f&&h<-f?v=1:d>f&&h>f?v=2:d<-f&&h>f&&(v=3),null!==v&&s>0&&(h=d/s,v%2&&(h=-d/s))),null!==v&&i){for(var g=[],m=v%2?[o,a,o,a+h,e,a+h,e,a]:[e,a+h,o,a+h,o,a,e,a],y=0;y<4;y++)g.push(m[2*(v+y)%8]),g.push(m[(2*(v+y)+1)%8]);return(r=this.addBox(g)).keepAspectRatio=this.keepAspectRatio&&s>0,this.drawingFlag=!0,this.addNewFlag=this.keepAspectRatio,this.currentBoxId=r.uid,this.activeBoxId=r.uid,r.onStartHandler(this.startX,this.startY,v),r.onMoveHandler(e,t,v),void(v=null);}this.activeBoxId&&(r=this.getBoxByUid(this.activeBoxId)),r&&r.onMoveHandler(e,t);}}},{key:"onEndHandler",value:function value(){var e;if(this.mouseDown&&this.activeBoxId){this.mouseDown=!1,this.drawingFlag=!1;var t=this.getBoxByUid(this.activeBoxId);t&&(null!==this.addNewFlag&&(t.keepAspectRatio=this.addNewFlag,this.addNewFlag=null),t.onEndHandler(),this.cropBoxes.length>0&&null!==(e=this.selectedCallback)&&void 0!==e&&e.call(this,this.getRectArr()),this.activeBoxId=null);}}}]);}(),BW=function(){return hS(function e(){dS(this,e),sS(this,"cropMng",void 0),sS(this,"originalBoxes",[]),sS(this,"mouseDown",!1),sS(this,"imgData",null),this.cropMng=new PW(0,0);},[{key:"getBoxesData",value:function value(e,t){for(var i=e.length,r=[],n=[],o=0;o<i;o++){var a=e[o];if(CO(a.left)&&CO(a.top)&&CO(a.width)&&CO(a.height)){var s=a.left,l=a.top,u=a.width,c=a.height;r.push(uS({},a)),t.width>0&&t.height>0&&(s=s<0||s>t.width?0:s,l=l<0||l>t.height?0:l,c=c<=0?1:c,(u=u<=0?1:u)+s>t.width&&(u=t.width-s),c+l>t.height&&(c=t.height-l));var h={left:s,top:l,width:u,height:c};n.push(h);}}return{oriBoxes:r,newBoxes:n};}},{key:"resetBoxes",value:function value(){if(this.originalBoxes.length<1)return!1;var e=this.cropMng;e.removeBox();for(var t=this.getBoxesData(this.originalBoxes,e.area).newBoxes,i=t.length,r=0;r<i;r++){var n=t[r],o=n.left,a=n.top,s=n.width,l=n.height;this.cropMng.addBox([o,a,o+s,a,o+s,a+l,o,a+l]);}return!0;}},{key:"initCrop",value:function value(e,t,i,r){this.cropMng.setCanvas(i),this.cropMng.setCanvasSize(e,t),this.cropMng.setCropSetting(r);}},{key:"setCropArea",value:function value(e,t,i,r){this.cropMng.setArea(e,t,i,r);}},{key:"setCropConfig",value:function value(e){var t=e.zoom,i=e.scrollTop,r=e.scrollLeft;t&&this.cropMng.setZoom(t),pO(i)||this.cropMng.setScrollTop(i),pO(r)||this.cropMng.setScrollLeft(r);}},{key:"updateCropSetting",value:function value(e){return this.cropMng.setCropSetting(e),!0;}},{key:"setFreeBox",value:function value(e){var t,i;if(!this.cropMng.canvasItem)return!1;if(!e){var r=this.cropMng.area,n=r.width,o=r.height;e=[0,0,n,0,n,o,0,o];}return this.cropMng.addFreeBox(e),null!==(t=(i=this.cropMng).selectedCallback)&&void 0!==t&&t.call(i,this.cropMng.getRectArr()),!0;}},{key:"setNormalBoxes",value:function value(e){var t,i,r,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=this.cropMng,s=a.canvasItem,l=a.area;if(!s)return!1;var u=null;if(vO(e)){if(0===(u=e).length)return!1;}else{if(!gO(e))return!1;u=[e];}var c=this.getBoxesData(u,l),h=c.oriBoxes,d=c.newBoxes,f=d.length;n||this.cropMng.count()>0&&this.clearBox();for(var v=0;v<f;v++){var g=d[v],m=g.left,y=g.top,p=g.width,w=g.height;this.cropMng.addBox([m,y,m+p,y,m+p,y+w,m,y+w],o);}return(t=this.originalBoxes).push.apply(t,tk(h)),null!==(i=(r=this.cropMng).selectedCallback)&&void 0!==i&&i.call(r,this.cropMng.getRectArr()),!0;}},{key:"clearSelectedBoxes",value:function value(e){var t,i=this.cropMng;return!!i.canvasItem&&(NE(t=this.originalBoxes).call(t,e,1),i.removeBox(e),this.render(),!0);}},{key:"clearBox",value:function value(){var e=this.cropMng;return!(!e.canvasItem||e.cropBoxes.length&&0!==e.cropBoxes.length&&(this.originalBoxes=[],e.canvasItem.style.cursor="crosshair",e.removeBox(),this.render(),0));}},{key:"getCropBoxes",value:function value(){return this.cropMng.getCropBoxes();}},{key:"getBoxCount",value:function value(){var e=this.cropMng;return e.cropBoxes.length?e.cropBoxes.length:0;}},{key:"getCropCoordinate",value:function value(e){var t=this.cropMng;return!(!t.canvasItem||0===t.cropBoxes.length)&&(void 0!==e?!!(CO(e)&&e<t.cropBoxes.length)&&t.cropBoxes[e].probePoints:t.getBoxByUid(t.currentBoxId).probePoints);}},{key:"setMagnifier",value:function value(e){this.imgData=e;}},{key:"render",value:function value(){var e,t=this,i=this.cropMng,r=i.canvasItem,n=i.zoom,o=i.area,a=i.scrollTop,s=i.scrollLeft,l=i.cropSetting;if(r&&i.cropBoxes.length){var u=r.getContext("2d"),c=l.dashLine,h=l.borderColor,d=l.borderWidth,f=l.ctrlBorderColor,v=l.ctrlBackground,g=l.ctrlBorderWidth,m=l.ctrlBorderRadius,y=l.background,p=l.invalidBorderColor,w=l.invalidCtrlBorderColor,b=l.ctrlSize,k=l.ctrlWidth,S=l.ctrlHeight;u.setTransform(1,0,0,1,0,0),pS(e=i.cropBoxes).call(e,function(e){for(var i,r,l=nE(i=e.probePoints).call(i,0,8),x=nE(r=e.midpoints).call(r,0,8),C=0;C<4;C++)l[2*C]=l[2*C]*n+o.left-s,l[2*C+1]=l[2*C+1]*n+o.top-a,x[2*C]=x[2*C]*n+o.left-s,x[2*C+1]=x[2*C+1]*n+o.top-a;u.save();var V=hL();try{u.setLineDash([c[0]*V,c[1]*V]);}catch(e){console.error("your browser does not support setLineDash().");}u.strokeStyle=e.isConvex?h:p,u.fillStyle=y,u.lineWidth=d*V,u.beginPath(),u.moveTo(l[0]*V,l[1]*V);for(var T=1;T<4;T++)u.lineTo(l[2*T]*V,l[2*T+1]*V);u.closePath(),MP(u).call(u),u.stroke(),u.strokeStyle=e.isConvex?f:w,u.fillStyle=v,u.lineWidth=g*V;var I=b,E=b;I=CO(k)?k*V:CO(S)?S*V:b*V,CO(S)?E=S*V:I=CO(k)?k*V:b*V;for(var P=0;P<4;P++){u.setLineDash([0,0]),u.beginPath();for(var B=l[2*P],D=l[2*P+1],M=0;M<4;M++)t.drawRoundedRectangle(u,{x:B*V,y:D*V,width:I,height:E,radius:Math.min(m*V,b*V/2)});u.closePath(),MP(u).call(u),u.stroke();}for(var U=0;U<4;U++){u.beginPath();for(var A=x[2*U],z=x[2*U+1],R=0;R<4;R++)t.drawRoundedRectangle(u,{x:A*V,y:z*V,width:I,height:E,radius:Math.min(m*V,b*V/2)});u.closePath(),MP(u).call(u),u.stroke();}u.restore();});}}},{key:"drawRoundedRectangle",value:function value(e,t){var i=t.width,r=t.height,n=t.radius,o=t.x,a=t.y,s=[{x:o-i/2+n,y:a-r/2+n,start:Math.PI,end:3*Math.PI/2},{x:o+i/2-n,y:a-r/2+n,start:3*Math.PI/2,end:2*Math.PI},{x:o+i/2-n,y:a+r/2-n,start:0,end:Math.PI/2},{x:o-i/2+n,y:a+r/2-n,start:Math.PI/2,end:Math.PI}];if(e.beginPath(),e.arc)for(var l=0;l<4;l++){var u=s[l];e.arc(u.x,u.y,n,u.start,u.end);}else e.rect(o-i/2,a-r/2,i,r);e.closePath();}},{key:"toCanvas",value:function value(e){var t=window.TouchEvent&&e instanceof window.TouchEvent?e.targetTouches[0]:e,i=this.cropMng.canvasItem.getBoundingClientRect(),r=fL(),n=r.scrollX,o=r.scrollY;return{offsetX:t.pageX-n-i.left,offsetY:t.pageY-o-i.top};}},{key:"onStartHandler",value:function value(e){var t=this.cropMng.cropSetting.multipleCropping,i=this.toCanvas(e),r=this.toAreaCoordinate(i.offsetX,i.offsetY);this.mouseDown=!0,this.cropMng.onStartHandler(r.x,r.y,e.ctrlKey&&t);}},{key:"onMoveHandler",value:function value(e){var t=this.cropMng,i=t.canvasItem,r=t.cropSetting,n=t.cropBoxes;if(this.mouseDown||0!==n.length){var o=r.enableCreateBoxByPointer,a=r.keepAspectRatioWithShift,s=r.keepAspectRatio,l=r.enableCursor,u=r.enableMagnifier,c=this.toCanvas(e),h=this.toAreaCoordinate(c.offsetX,c.offsetY);if(!this.mouseDown&&l){var d=this.cropMng.checkSelectForCursor(h.x,h.y);if(null===d)return void(i.style.cursor="crosshair");"default"===d.mode?i.style.cursor="move"===d.position?"move":"".concat(d.position,"-resize"):i.style.cursor=["move","nw-resize","ne-resize","se-resize","sw-resize","sw-resize","n-resize","e-resize","s-resize","w-resize"][d.part+1];}if(this.mouseDown){this.cropMng.onMoveHandler(h.x,h.y,o),e.shiftKey&&a?this.cropMng.setKeepAspectRatio(!0):s||this.cropMng.setKeepAspectRatio(!1);var f=this.cropMng.isInArea(h.x,h.y),v=this.cropMng.checkSelectVertex(h.x,h.y);this.mouseDown&&u&&f&&v&&this.renderMagnifier(e,h.x,h.y);}}else"crosshair"!==i.style.cursor&&(i.style.cursor="crosshair");}},{key:"onEndHandler",value:function value(e){this.mouseDown=!1,this.cropMng.onEndHandler();}},{key:"renderMagnifier",value:function value(e,t,i){var r=this.cropMng;if(this.imgData&&r.canvasItem){var n=r.cropSetting,o=n.dashLine,a=n.borderColor,s=n.borderWidth,l=n.magnifier,u=l.fixed,c=l.fixedLeft,h=l.fixedTop,d=l.size,f=l.magnification,v=this.cropMng.canvasItem.getContext("2d"),g=this.toCanvas(e),m=2*d*f,y=g.offsetX,p=g.offsetY,w=f*d,b=g.offsetX-w,k=g.offsetY-w;u&&(y=h+d,p=c+d,b=h-(w=(f-1)*d),k=c-w),v.save(),v.beginPath(),v.arc(y,p,d,0,2*Math.PI),v.closePath(),v.clip(),v.drawImage(this.imgData,t-d,i-d,2*d,2*d,b,k,m,m),v.lineWidth=s,v.strokeStyle=a,v.setLineDash([o[0],o[1]]);var S=u?h+d:g.offsetX,x=u?c+d:g.offsetY;v.beginPath(),v.moveTo(S,x-d),v.lineTo(S,x+d),v.moveTo(S-d,x),v.lineTo(S+d,x),v.stroke(),v.restore();}}},{key:"toAreaCoordinate",value:function value(e,t){var i=this.cropMng,r=i.area,n=i.scrollLeft,o=i.scrollTop,a=i.zoom;return{x:e=(e-r.left+n)/a,y:t=(t-r.top+o)/a};}}]);}(),DW=function(){return hS(function e(){dS(this,e);},[{key:"init",value:function value(e){var t=e.rendererService.canvasDom,i=new BW();e.boxRenderer=i,i.cropMng.selectedCallback=function(){var t=e.getCurrentTab(),r=i.cropMng.getRectArr(),n=e.getStatus(t.currentPage.uid).imageScale;"single"===e.config.displayMode&&(n=1);var o=[];pS(r).call(r,function(e,t){var i={areaIndex:t,x:Math.floor(e.x*n),y:Math.floor(e.y*n),width:Math.floor(e.width*n),height:Math.floor(e.height*n)};o.push(i);}),e.emit("pageAreaSelected",t.current,o);},i.cropMng.unselectedCallback=function(){var t=e.getCurrentTab();e.emit("pageAreaUnselected",t.current);},i.initCrop(t.width,t.height,t,{}),this.listenNativeEvents(e),this.listenViewerHooks(e);}},{key:"listenNativeEvents",value:function value(e){var t=e.rendererService.canvasDom,i=!1,r=function r(t){var r=ek(e.formatTouches(t),1)[0];if("crop"===e.config.toolType){e.getPointerOverPageInfo(r.pageX,r.pageY).pageInfo.obj;var n=e.getCurrentTab();n&&n.currentPage&&(i=!0,e.boxRenderer.onStartHandler(t));}},n=function n(t){if("crop"===e.config.toolType&&(e.boxRenderer.onMoveHandler(t),i)){var r=e.getCurrentTab();e.rendererService.render(r);}},o=function o(t){if("crop"===e.config.toolType&&(e.boxRenderer.onEndHandler(t),i)){i=!1;var r=e.getCurrentTab();e.rendererService.render(r);}},a=function a(e){e.cancelable&&e.preventDefault();};t.addEventListener("touchmove",a,{passive:!1}),window.PointerEvent?(t.addEventListener("pointerdown",r),document.addEventListener("pointermove",n),document.addEventListener("pointerup",o)):window.MSPointerEvent&&(t.addEventListener("MSPointerDown",r),document.addEventListener("MSPointerMove",n),document.addEventListener("MSPointerUp",o)),e.hooksService.hooks.destroy.on(function(){t.removeEventListener("touchmove",a),window.PointerEvent?(t.removeEventListener("pointerdown",r),document.removeEventListener("pointermove",n),document.removeEventListener("pointerup",o)):window.MSPointerEvent&&(t.removeEventListener("MSPointerDown",r),document.removeEventListener("MSPointerMove",n),document.removeEventListener("MSPointerUp",o));});}},{key:"listenViewerHooks",value:function value(e){var t=function t(_t3,i){if("min"===i&&"multiple"===e.config.displayMode){var r=e.getCurrentTab();if(r){var n=r.currentPage;if(n&&n.uid===_t3){var o=e.getStatus(n.uid).imageScale,a=e.boxRenderer.cropMng.cropBoxes;e.boxRenderer.clearBox(),pS(a).call(a,function(t){var i=t.getRect();if(!t.isScaled){var r=i.x,n=i.y,a=i.width,s=i.height,l=r/o,u=n/o;a/=o,s/=o,e.boxRenderer.cropMng.addBox([l,u,l+a,u,l+a,u+s,l,u+s]).isScaled=!0;}}),e.renderOnly();}}}},i=e.hooksService.hooks,r=function r(){if("crop"===e.config.toolType){var t=e.getCurrentTab();t&&t.isTopPageChanged&&!t.isLoadPage&&e.config.autoSelectTopPage&&e.boxRenderer.clearBox();}},n=function n(){if("crop"===e.config.toolType){var t=e.getCurrentTab();if(t){var i=t.currentPage;if(i&&i.isVisible){var r,n,o,a=i.imageContainer.getPosition(),s=i.imageContainer.parsedStyle,l=s.width,u=s.height;null!==(r=e.boxRenderer)&&void 0!==r&&r.setCropArea(a.x,a.y,l.value,u.value),null!==(n=e.boxRenderer)&&void 0!==n&&n.setCropConfig({zoom:(null==i?void 0:i.zoom)||1}),null===(o=e.boxRenderer)||void 0===o||o.render();}}}},o=function o(){e.viewer.clearCropBox();};e.rendererService.hooks.beforeRender.on(r),e.rendererService.hooks.afterRender.on(n),i.afterBufferChanged.on(o),e.dvsContext.hooksService.hooks.afterLoadImage.on(t),e.hooksService.hooks.destroy.on(function(){e.rendererService.hooks.beforeRender.off(r),e.rendererService.hooks.afterRender.off(n),i.afterBufferChanged.off(o),e.dvsContext.hooksService.hooks.afterLoadImage.off(t);});}}]);}(),MW={name:"dvsBoxRenderer",install:function install(e){var t=e.getClassStore(),i=t.Viewer;if(i){var r=function(e,t){return t=function(e){function t(e){var i;return dS(this,t),sS(Kw(i=nO(this,t,[e])),"boxRenderer",void 0),i.context.config.pure||new DW().init(i.context),i.context.configService.registerHandler("cropBoxConfig",function(e,t){gO(t)&&(i.context.boxRenderer.updateCropSetting(t),i.context.renderOnly());}),i.context.config.cropBoxConfig||(i.context.config.cropBoxConfig=i.cropBoxConfig),i;}return Qb(t,e),hS(t,[{key:"cropBoxConfig",get:function get(){return this.context.boxRenderer.cropMng.cropSetting;},set:function set(e){gO(e)&&(this.context.boxRenderer.updateCropSetting(e),this.context.renderOnly());}},{key:"setFreeCropBox",value:function value(e){var t=this.getCurrentTab();if(t){var i=t.currentPage;if(i){var r=this.context.getStatus(i.uid);r&&this.context.boxRenderer.setCropArea(0,0,r.realTimeWidth||0,r.realTimeHeight||0);}}var n=this.context.boxRenderer.setFreeBox(kA(e).call(e));return n&&this.context.renderOnly(),n;}},{key:"setCropBox",value:function value(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.getCurrentTab(),r=!1;if(i){var n=i.currentPage;if(n){var o=this.context.getStatus(n.uid);if(o&&(this.context.boxRenderer.setCropArea(0,0,n.realTimeWidth||0,n.realTimeHeight||0),"multiple"===this.context.config.displayMode&&this.context.config.useMinImage)){var a=o.imageScale;vO(e)||(e=[e]);var s=[];pS(e).call(e,function(e){var t={left:e.left/a,top:e.top/a,width:e.width/a,height:e.height/a};s.push(t);}),e=s,r=!0;}}}var l=this.context.boxRenderer.setNormalBoxes(e,t,r);return l&&this.context.renderOnly(),l;}},{key:"clearCropBox",value:function value(){var e=this.context.boxRenderer.clearBox();return e&&this.context.boxRenderer.getBoxCount()>0&&this.context.renderOnly(),e;}},{key:"getCropBoxes",value:function value(){var e=this.context.boxRenderer.getCropBoxes(),t=this.getCurrentTab();if(t){var i=t.currentPage;if(i){var r=this.context.getStatus(i.uid);if(r&&"multiple"===this.context.config.displayMode&&this.context.config.useMinImage){var n=r.imageScale;e=wP(e).call(e,function(e){return{left:e.left*n,top:e.top*n,width:e.width*n,height:e.height*n};});}}}return e;}}]);}(e),sS(t,"use",e.use),t;}(i);t.Viewer=r;}}};function UW(e,t){if(AS(t))return{unit:"px",value:0};if(PO(t))return{unit:"px",value:0};if(CO(t))return{unit:"px",value:t};if(t=ix(t).call(t).toLowerCase(),IA(Number(t))&&"px".search(e)>=0)return{unit:"px",value:Number(t)};var i=[];t=t.replace(e,function(e){return i.push(e),"U".concat(e);});var r="U(".concat(e.source,")");return wP(i).call(i,function(e){return{unit:e,value:Number(t.replace(new RegExp("U".concat(e),"g"),"").replace(new RegExp(r,"g"),"*0"))};})[0];}var AW=function AW(e){return UW(/px/g,e);},zW=function zW(e){return UW(/px|%|em/g,e);},RW=function RW(e){return UW(/deg|rad|grad|turn/g,e);},NW=function(){function e(t,i,r){var n,o,a,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,l=arguments.length>4&&void 0!==arguments[4]&&arguments[4];dS(this,e),sS(this,"r",void 0),sS(this,"g",void 0),sS(this,"b",void 0),sS(this,"alpha",void 0),sS(this,"isNone",void 0),sS(this,"formatted",""),this.r=t,this.g=i,this.b=r,this.alpha=s,this.isNone=l,this.formatted=BS(n=BS(o=BS(a="rgba(".concat(t,", ")).call(a,i,", ")).call(o,r,", ")).call(n,s,")");}return hS(e,[{key:"clone",value:function value(){return new e(this.r,this.g,this.b,this.alpha);}}]);}(),OW=function(){function e(t,i){dS(this,e),sS(this,"type",void 0),sS(this,"value",void 0),this.type=t,this.value=i;}return hS(e,[{key:"clone",value:function value(){return new e(this.type,this.value);}}]);}(),LW={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},WW=function WW(e){return{value:"angular"===e.type?Number(e.value):LW[e.value]||0,unit:"deg"};};function FW(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(PO(e))return null;if("currentColor"===e&&(e="black"),"transparent"===e)return new NW(0,0,0,0);var t=function(e){var t;if(sE(e).call(e,"linear")>-1||sE(e).call(e,"radial")>-1)return wP(t=xO(e)).call(t,function(e){var t=e.type,i=e.orientation,r=e.colorStops;!function(e,t,i){var r=e.length;e[r-1].length=null!==(t=e[r-1].length)&&void 0!==t?t:{type:"%",value:"100"},r>1&&(e[0].length=null!==(i=e[0].length)&&void 0!==i?i:{type:"%",value:"0"});for(var n=0,o=Number(e[0].length.value),a=1;a<r;a++){var s,l=null===(s=e[a].length)||void 0===s?void 0:s.value;if(!PO(l)&&!PO(o)){for(var u=1;u<a-n;u++)e[n+u].length={type:"%",value:"".concat(o+(Number(l)-o)*u/(a-n))};n=a,o=Number(l);}}}(r);var n=wP(r).call(r,function(e){return{offset:{value:e.length.value,unit:"%"},color:SO(e)};});if("linear-gradient"===t)return new OW(1,{angle:i?WW(i):{value:0,unit:"deg"},steps:n});if("radial-gradient"===t&&(i||(i=[{type:"shape",value:"circle"}]),"shape"===i[0].type&&"circle"===i[0].value)){var o,a=function(e){var t=50,i=50,r="%",n="%";if("position"===(null==e?void 0:e.type)){var o=e.value,a=o.x,s=o.y;"position-keyword"===(null==a?void 0:a.type)&&("left"===a.value?t=0:"center"===a.value?t=50:"right"===a.value?t=100:"top"===a.value?i=0:"bottom"===a.value&&(i=100)),"position-keyword"===(null==s?void 0:s.type)&&("left"===s.value?t=0:"center"===s.value?i=50:"right"===s.value?t=100:"top"===s.value?i=0:"bottom"===s.value&&(i=100)),"px"!==(null==a?void 0:a.type)&&"%"!==(null==a?void 0:a.type)&&"em"!==(null==a?void 0:a.type)||(r=null==a?void 0:a.type,t=Number(a.value)),"px"!==(null==s?void 0:s.type)&&"%"!==(null==s?void 0:s.type)&&"em"!==(null==s?void 0:s.type)||(n=null==s?void 0:s.type,i=Number(s.value));}return{cx:{value:t,unit:r},cy:{value:i,unit:n}};}(i[0].at),s=a.cx,l=a.cy;if(i[0].style){var u=i[0].style,c=u.type,h=u.value;o="extent-keyword"===c?h:{value:h,unit:c};}return new OW(2,{cx:s,cy:l,size:o,steps:n});}});}(e);if(t)return t;var i=function(e){var t,i,r;if(e=ix(t="".concat(e)).call(t).toLowerCase(),LO.exec(e))switch(i=LO.exec(e),r=i[1].length,i=px(i[1],16),r){case 6:return _O(i);case 3:return new ZO(i>>8&15|i>>4&240,i>>4&15|240&i,(15&i)<<4|15&i,1);case 8:return GO(i>>24&255,i>>16&255,i>>8&255,(255&i)/255);case 4:return GO(i>>12&15|i>>8&240,i>>8&15|i>>4&240,i>>4&15|240&i,((15&i)<<4|15&i)/255);default:return null;}return WO.exec(e)?(i=WO.exec(e),new ZO(i[1],i[2],i[3],1)):FO.exec(e)?(i=FO.exec(e),new ZO(255*i[1]/100,255*i[2]/100,255*i[3]/100,1)):HO.exec(e)?GO((i=HO.exec(e))[1],i[2],i[3],i[4]):jO.exec(e)?GO(255*(i=jO.exec(e))[1]/100,255*i[2]/100,255*i[3]/100,i[4]):XO.exec(e)?JO(KO((i=XO.exec(e))[1],i[2]/100,i[3]/100,1)):YO.exec(e)?JO(KO((i=YO.exec(e))[1],i[2]/100,i[3]/100,i[4])):qO.hasOwnProperty(e)?_O(qO[e]):"transparent"===e?new ZO(NaN,NaN,NaN,0):null;}(e),r=[0,0,0,0];return null!==i&&(r[0]=px(i.r,10)||0,r[1]=px(i.g,10)||0,r[2]=px(i.b,10)||0,r[3]=FA(i.opacity)),_v(NW,r);}function HW(e){var t=null;vO(e)&&(t=e),bO(e)&&(t=e.split(" "));for(var i=0;i<3;i++)t[i]?t[i]=AW(t[i]).value:t[i]=0;var r=FW(t[3]);return t[3]=r?r.formatted:"black",nE(t).call(t,0,4);}function jW(e){var t,i=[];return bO(e)?pS(t=e.split(" ")).call(t,function(e){var t=AW(e);t&&i.push(t.value);}):i.push.apply(i,tk(e)),1===i.length?[i[0],i[0]]:i;}var XW=function XW(e){var t=e;if(bO(e)){var i=zW(e);"%"===i.unit&&(t=i.value/100),"px"===i.unit&&(t=i.value);}return t>1&&(t=1),t;};function YW(e,t,i){var r=i.parsedStyle,n=r.x,o=void 0===n?0:n,a=r.y,s=void 0===a?0:a;r.z,e!==t&&i.setLocalPosition(o,s);}var qW=function(){return hS(function e(t){dS(this,e),sS(this,"bubbles",!0),sS(this,"cancelBubble",!0),sS(this,"cancelable",!1),sS(this,"composed",!1),sS(this,"currentTarget",void 0),sS(this,"defaultPrevented",!1),sS(this,"eventPhase",e.prototype.NONE),sS(this,"isTrusted",void 0),sS(this,"returnValue",void 0),sS(this,"srcElement",void 0),sS(this,"target",void 0),sS(this,"timeStamp",void 0),sS(this,"type",void 0),sS(this,"detail",void 0),sS(this,"view",void 0),sS(this,"which",void 0),sS(this,"path",void 0),sS(this,"immediatePropagationStopped",!1),sS(this,"propagationStopped",!1),sS(this,"nativeEvent",void 0),sS(this,"originalEvent",void 0),sS(this,"eventService",void 0),sS(this,"AT_TARGET",1),sS(this,"BUBBLING_PHASE",2),sS(this,"CAPTURING_PHASE",3),sS(this,"NONE",0),this.eventService=t;},[{key:"initUIEvent",value:function value(e,t,i,r,n){}},{key:"composedPath",value:function value(){var e=this.path,t=this.eventService,i=this.target;return!t||e&&e[this.path.length-1]===i||(this.path=i?t.getPropagationPath(i):[]),this.path;}},{key:"initEvent",value:function value(e,t,i){}},{key:"preventDefault",value:function value(){var e=this.nativeEvent;e instanceof Event&&e.cancelable&&e.preventDefault(),this.defaultPrevented=!0;}},{key:"stopImmediatePropagation",value:function value(){this.immediatePropagationStopped=!0;}},{key:"stopPropagation",value:function value(){this.propagationStopped=!0;}}]);}(),ZW=function(e){function t(e,i){var r;return dS(this,t),(r=nO(this,t,[null])).type=e,r.detail=i,r;}return Qb(t,e),hS(t);}(qW),_W=function(){return hS(function e(){dS(this,e),sS(this,"pubsub",vL.create());},[{key:"addEventListener",value:function value(e,t,i){var r,n=VO(i)&&i;gO(i)&&(n=i.capture,r=i.once),e=n?"".concat(e,":capture"):e,t=TO(t)?t:t.handleEvent,this.pubsub.on(e,t,this,r);}},{key:"dispatchEvent",value:function value(e){var t,i=this.ownerDocument||this.document;return i&&(e.eventService=(null===(t=i.defaultView)||void 0===t?void 0:t.eventService)||null,e.defaultPrevented=!1,e.path=[],e.target=this,function(e,t,i){if(t=null!==(i=t)&&void 0!==i?i:e.type,e.propagationStopped=!1,e.immediatePropagationStopped=!1,e.target){var r=e.composedPath(),n=r.length;e.eventPhase=e.CAPTURING_PHASE;for(var o=0;o<n-1;o++)if(e.currentTarget=r[o],GW(e,"".concat(t,":capture")),KW(e))return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,GW(e,t),!KW(e)){e.eventPhase=e.BUBBLING_PHASE;for(var a=n-2;a>=0;a--)if(e.currentTarget=r[a],GW(e,t),KW(e))return;}}}(e)),!e.defaultPrevented;}},{key:"removeEventListener",value:function value(e,t,i){var r=VO(i)&&i;gO(i)&&(r=i.capture),e=r?"".concat(e,":capture"):e,t=TO(t)?t:t.handleEvent,this.pubsub.off(e,t,context);}},{key:"removeAllEventListeners",value:function value(){this.pubsub.removeAllEventListeners();}},{key:"getAllEvents",value:function value(){return this.pubsub.getAllEvents();}}]);}();function GW(e,t){for(var i=e.currentTarget.getAllEvents()[t]||[],r=0,n=i.length;r<n;r++){if(e.immediatePropagationStopped)return;var o=i[r],a=o.context;o.fn.call(a,e);}}function KW(e){return e.propagationStopped||e.immediatePropagationStopped;}var $W=function(e){function t(e,i,r,n,o,a,s,l){var u;return dS(this,t),sS(Kw(u=nO(this,t,[null])),"relatedNode",void 0),sS(Kw(u),"prevValue",void 0),sS(Kw(u),"newValue",void 0),sS(Kw(u),"attrName",void 0),sS(Kw(u),"attrChange",void 0),sS(Kw(u),"prevParsedValue",void 0),sS(Kw(u),"newParsedValue",void 0),u.type=e,u.relatedNode=i,u.prevValue=r,u.newValue=n,u.attrName=o,u.attrChange=a,u.prevParsedValue=s,u.newParsedValue=l,u;}return Qb(t,e),hS(t);}(qW);sS($W,"ADDITION",2),sS($W,"MODIFICATION",1),sS($W,"REMOVAL",3);var JW=new(function(){return hS(function e(){dS(this,e);},[{key:"querySelector",value:function value(e,t){return oz(e).call(e,"#")?YP(t).call(t,function(t){return t.id===e.substring(1);}):null;}},{key:"querySelectorAll",value:function value(e,t){return[];}}]);}())(),QW=new(function(){return hS(function e(t){dS(this,e),sS(this,"selector",void 0),this.selector=t;},[{key:"recursiveUpdateHierarchy",value:function value(e){var t=this,i=e.transform,r=e.childNodes;i.frozen||(i.frozen=!0,(i.localDirty||i.worldDirty)&&this.updateHierarchy(e),pS(r).call(r,function(e){t.recursiveUpdateHierarchy(e);}));}},{key:"querySelector",value:function value(e,t){return this.selector.querySelector(e,t);}},{key:"querySelectorAll",value:function value(e,t){return this.selector.querySelectorAll(e,t);}},{key:"append",value:function value(e,t,i){e.parentNode&&this.remove(e),e.parentNode=t;var r=t.childNodes,n=t.sortable;void 0!==i?NE(r).call(r,i,0,e):r.push(e),n&&(n.dirty=!0);var o=e.transform;o&&this.dirtyWorld(e,o),o.frozen&&this.unfreezeParentToRoot(e);}},{key:"remove",value:function value(e){var t=e.parentNode,i=!0;if(!t)return i=!1;var r=t.sortable;r&&(r.dirty=!0);var n=t.childNodes,o=sE(n).call(n,e);o>-1?(i=!0,NE(n).call(n,o,1)):i=!1;var a=e.transform;return a&&this.dirtyWorld(e,a),e.parentNode=null,i;}},{key:"isChildExist",value:function value(e){var t=e.parentNode;if(!t)return!1;var i=t.childNodes;return!(sE(i).call(i,e)<0);}},{key:"setOrigin",value:function value(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;CO(t)&&(t=pL.fromValue(t,i));var r=e.transform;r.origin.equals(t)||(r.origin.setFromVector(t),this.dirtyLocal(e,r));}},{key:"getOrigin",value:function value(e){return e.transform.origin;}},{key:"setPosition",value:function value(e,t){var i=e.transform;t=pL.fromValue(t.x,t.y,t.z||0);var r=this.getPosition(e);if(!t.equals(r)){var n=this.getWorldTransform(e),o=this.getPosition(e),a=t.x-o.x,s=t.y-o.y,l=t.z-o.z;if(i.position=t,e.hasParentTransform()){n=new BL().translateSelf(a,s,l).multiply(n);var u=e.parentNode.transform.worldTransform,c=this.getWorldTransform(e);c.m41=t.x,c.m42=t.y,c.m43=t.z;var h=u.inverse().multiply(n),d=this.getOrigin(e),f=h.getScaling(),v=this.createScaleMatrix(f.x,f.y,f.z),g=BL.fromMatrix(v).inverse(),m=h.translate(d.x,d.y,d.z).multiply(g),y=m.getRotation(),p=BL.fromQuat(y).inverse(),w=m.multiply(p).getTranslation();w.x-=d.x,w.y-=d.y,w.z-=d.z,i.localPosition.setFromVector(w);}else i.localPosition=t;this.dirtyLocal(e,i);}}},{key:"setLocalPosition",value:function value(e,t){var i=e.transform;(t=pL.fromValue(t.x,t.y,t.z||0)).equals(i.localPosition)||(i.localPosition=t,this.dirtyLocal(e,i));}},{key:"getPosition",value:function value(e){var t=this.getWorldTransform(e),i=e.transform,r=t.getTranslation();return i.position.setFromVector(r),e.transform.position;}},{key:"getLocalPosition",value:function value(e){return e.transform.localPosition;}},{key:"translate",value:function value(e,t){if(!t.equals(new pL())){var i=this.getPosition(e),r=this.getWorldTransform(e),n=r.getScaling(),o=this.createScaleMatrix(n.x,n.y,n.z),a=r.multiply(BL.fromMatrix(o).inverse()).getRotation(),s=BL.fromQuat(a).transformPoint(t);i.add(s),this.setPosition(e,i);}}},{key:"translateLocal",value:function value(e,t){var i=e.transform;if(!t.equals(new pL())){t.multiply(i.localScale);var r=BL.fromQuat(i.localRotation).transformPoint(t);i.localPosition.add(r),this.dirtyLocal(e,i);}}},{key:"scaleLocal",value:function value(e,t){var i=e.transform;i.localScale.multiply(t),this.dirtyLocal(e,i);}},{key:"setLocalScale",value:function value(e,t){var i=e.transform,r=pL.fromValue(t.x,t.y,t.z||i.localScale.z);r.equals(i.localScale)||(i.localScale=r,this.dirtyLocal(e,i));}},{key:"getScale",value:function value(e){var t=e.transform,i=this.getWorldTransform(e).getScaling();return t.scale.setFromVector(i),t.scale;}},{key:"getLocalScale",value:function value(e){return e.transform.localScale;}},{key:"getRotation",value:function value(e){var t=e.transform,i=this.getWorldTransform(e),r=i.getScaling(),n=this.createScaleMatrix(r.x,r.y,r.z),o=i.multiply(BL.fromMatrix(n).inverse()).getRotation();return t.rotation.setFromQuat(o),t.rotation;}},{key:"getLocalRotation",value:function value(e){return e.transform.localRotation;}},{key:"rotate",value:function value(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=e.transform;if(CO(t)&&(t=wL(t,i,r)),e.hasParentTransform()){var o=TL(t.x,t.y,t.z),a=this.getRotation(e),s=this.getRotation(e.parentNode).clone().invert().multiply(o).multiply(a).normalize();n.localRotation.setFromQuat(s),this.dirtyLocal(e,n);}else this.rotateLocal(e,t);}},{key:"rotateLocal",value:function value(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;CO(t)&&(t=wL(t,i,r));var n=e.transform,o=TL(t.x,t.y,t.z);n.localRotation.multiply(o),this.dirtyLocal(e,n);}},{key:"setAngle",value:function value(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;CO(t)&&(t=wL(t,i,r));var n=e.transform;if(e.hasParentTransform()){var o=TL(t.x,t.y,t.z);n.localRotation.setFromQuat(o);var a=this.getRotation(e.parentNode);a.invert(),n.localRotation.setFromQuat(a.multiply(n.localRotation)),this.dirtyLocal(e,n);}else this.setLocalAngle(e,t);}},{key:"setLocalAngle",value:function value(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;CO(t)&&(t=wL(t,i,r));var n=e.transform,o=TL(t.x,t.y,t.z);n.localRotation.setFromQuat(o),this.dirtyLocal(e,n);}},{key:"setRotation",value:function value(e,t){var i=e.transform;if(e.hasParentTransform()){var r=this.getRotation(e.parentNode);r=r.clone().invert().multiply(t).normalize(),i.localRotation.setFromQuat(r),this.dirtyLocal(e,i);}else this.setLocalRotation(e,t);}},{key:"setLocalRotation",value:function value(e,t){var i=e.transform;i.localRotation.setFromQuat(t),this.dirtyLocal(e,i);}},{key:"getAngle",value:function value(e){var t=this.getWorldTransform(e);return CL.fromQuat(t.decompose().quaternion).toEuler();}},{key:"getLocalAngle",value:function value(e){return this.getLocalTransform(e),this.getLocalRotation(e).toEuler();}},{key:"setLocalTransform",value:function value(e,t){var i=this.getOrigin(e),r=t.decompose();r.quaternion;var n=r.rotation,o=r.scale,a=this.createScaleMatrix(o.x,o.y,o.z),s=BL.fromMatrix(a).inverse(),l=t.translate(i.x,i.y,i.z).multiply(s).getTranslation();l.x-=i.x,l.y-=i.y,l.z-=i.z,this.setLocalPosition(e,l),this.setLocalAngle(e,n.x,n.y,n.z),this.setLocalScale(e,o);}},{key:"createScaleMatrix",value:function value(){return{m11:arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,m21:0,m31:0,m41:0,m12:0,m22:arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,m32:0,m42:0,m13:0,m23:0,m33:arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,m43:0,m14:0,m24:0,m34:0,m44:1};}},{key:"resetLocalTransform",value:function value(e){this.setLocalScale(e,new pL(1,1,1)),this.setLocalPosition(e,new pL(0,0,0)),this.setLocalAngle(e,0);}},{key:"getWorldTransform",value:function value(e){var t=e.transform;if(!t.worldDirty&&!t.localDirty)return t.worldTransform;var i=e.parentNode;return i&&i.transform&&this.getWorldTransform(i),this.updateHierarchy(e),t.worldTransform;}},{key:"getLocalTransform",value:function value(e){var t=e.transform;return t.localDirty&&t.updateLocalTransform(),t.localTransform;}},{key:"getBounds",value:function value(e,t){var i=this,r=e.renderable,n=e.childNodes;if(t&&!r.renderBoundsDirty&&r)return r.renderBounds;if(!t&&!r.boundsDirty&&r.bounds)return r.bounds;var o=this.getTransformedGeometryBounds(e,t);pS(n).call(n,function(e){var r=i.getBounds(e,t);r&&(o?o.addBounds(r):o=LF.fromBounds(r));});var a=e.style.clipPath;if(a){var s=this.getTransformedGeometryBounds(a,!0),l=null;s&&(l=LF.create()).setFromTransformedBounds(this.getWorldTransform(e),s),o?l&&(o=l.intersection(o)):o=l;}return t?(r.renderBoundsDirty=!1,o&&(r.renderBounds=o)):(r.boundsDirty=!1,o&&(r.bounds=o)),o||LF.create();}},{key:"getLocalBounds",value:function value(e){var t=e.parentNode;if(t){var i=new BL();t.transform&&(i=this.getWorldTransform(t).inverse());var r=this.getBounds(e);if(!LF.isEmpty(r)){var n=LF.create();return n.setFromTransformedBounds(i,r),n;}}return this.getBounds(e);}},{key:"getGeometryBounds",value:function value(e,t){var i=e.geometry;return(t?i.renderBounds:i.contentBounds)||LF.create();}},{key:"getBoundingClientRect",value:function value(e){var t,i,r=this.getGeometryBounds(e);LF.isEmpty(r)||(i=LF.create()).setFromTransformedBounds(this.getWorldTransform(e),r);var n=null===(t=e.ownerDocument)||void 0===t?void 0:t.defaultView.getContextService().getBoundingClientRect();return i?{x:i.minX+((null==n?void 0:n.left)||0),y:i.minY+((null==n?void 0:n.top)||0),width:i.maxX-i.minX,height:i.maxY-i.minY}:{x:(null==n?void 0:n.left)||0,y:(null==n?void 0:n.top)||0,width:0,height:0};}},{key:"updateHierarchy",value:function value(e){var t=e.transform;if(t.localDirty&&t.updateLocalTransform(),t.worldDirty){var i,r=null==e||null===(i=e.parentNode)||void 0===i?void 0:i.transform;e.parentNode&&r||(r=new nF()),t.updateWorldTransform(r);}}},{key:"getTransformedGeometryBounds",value:function value(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.getGeometryBounds(e,t);if(!LF.isEmpty(i)){var r=LF.create();return this.getWorldTransform(e),r.setFromTransformedBounds(this.getWorldTransform(e),i),r;}return null;}},{key:"dirtyLocal",value:function value(e,t){t.localDirty||(t.localDirty=!0,t.worldDirty||this.dirtyWorld(e,t));}},{key:"dirtyWorld",value:function value(e,t){t.worldDirty||this.unfreezeParentToRoot(e),this.recursiveDirtyWorld(e,t),function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=e;i;){var r=i.renderable;r&&(r.boundsDirty=!0,r.renderBoundsDirty=!0),i=i.parentNode;}e.dispatchEvent(new ZW("bounds-changed",{affectChildren:t}));}(e,!0);}},{key:"recursiveDirtyWorld",value:function value(e,t){var i,r=this;if(!t.worldDirty){t.worldDirty=!0,t.frozen=!1,pS(i=e.childNodes).call(i,function(e){var t=e.transform;t.worldDirty||r.recursiveDirtyWorld(e,t);});var n=e.renderable;n&&(n.boundsDirty=!0,n.renderBoundsDirty=!0);var o=new $W("DOMAttrModified",e,null,null,"modelMatrix",$W.MODIFICATION,null,null);e.dispatchEvent(o);}}},{key:"unfreezeParentToRoot",value:function value(e){for(var t=e;t;){var i=t.transform;i&&(i.frozen=!1),t=t.parentNode;}}}]);}())(JW),eF=function(e){function t(){var e,i;dS(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return sS(i=nO(this,t,BS(e=[]).call(e,n)),"baseURI",""),sS(i,"childNodes",[]),sS(i,"nodeName",""),sS(i,"nodeType",0),sS(i,"nodeValue",null),sS(i,"ownerDocument",null),sS(i,"parentNode",null),sS(i,"isConnected",!1),sS(i,"textContent",void 0),i;}return Qb(t,e),hS(t,[{key:"firstChild",get:function get(){return this.childNodes.length>0?this.childNodes[0]:null;}},{key:"lastChild",get:function get(){var e=this.childNodes;return e.length>0?e[e.length-1]:null;}},{key:"nextSibling",get:function get(){var e=this.parentNode;if(e){var t,i=sE(t=e.childNodes).call(t,this);return e.childNodes[i+1];}return null;}},{key:"parentElement",get:function get(){return this.parentNode;}},{key:"previousSibling",get:function get(){var e=this.parentNode;if(e){var t,i=sE(t=e.childNodes).call(t,this);return e.childNodes[i-1];}return null;}},{key:"contains",value:function value(e){for(var t=e;t&&this!==t;)t=t.parentNode;return!!t;}},{key:"getRootNode",value:function value(e){return this.parentNode?this.parentNode.getRootNode(e):this;}},{key:"hasChildNodes",value:function value(){return this.childNodes.length>0;}},{key:"isEqualNode",value:function value(e){return this===e;}},{key:"isSameNode",value:function value(e){return this.isEqualNode(e);}},{key:"compareDocumentPosition",value:function value(e){throw new Error("Method to be implemented");}},{key:"isDefaultNamespace",value:function value(e){throw new Error("Method to be implemented");}},{key:"lookupNamespaceURI",value:function value(e){throw new Error("Method to be implemented");}},{key:"lookupPrefix",value:function value(e){throw new Error("Method to be implemented");}},{key:"normalize",value:function value(){throw new Error("Method to be implemented");}},{key:"recursiveCall",value:function value(e){var t;e(this)||pS(t=this.childNodes).call(t,function(t){t.recursiveCall(e);});}},{key:"hasParentTransform",value:function value(){return!(!this.parentNode||!this.parentNode.transform);}}],[{key:"isNode",value:function value(e){return!!e.childNodes;}}]);}(_W);sS(eF,"ELEMENT_NODE",1),sS(eF,"ATTRIBUTE_NODE",2),sS(eF,"TEXT_NODE",3),sS(eF,"CDATA_SECTION_NODE",4),sS(eF,"ENTITY_REFERENCE_NODE",5),sS(eF,"ENTITY_NODE",6),sS(eF,"PROCESSING_INSTRUCTION_NODE",7),sS(eF,"COMMENT_NODE",8),sS(eF,"DOCUMENT_NODE",9),sS(eF,"DOCUMENT_TYPE_NODE",10),sS(eF,"DOCUMENT_FRAGMENT_NODE",11),sS(eF,"NOTATION_NODE",12),sS(eF,"DOCUMENT_POSITION_DISCONNECTED",1),sS(eF,"DOCUMENT_POSITION_PRECEDING",2),sS(eF,"DOCUMENT_POSITION_FOLLOWING",4),sS(eF,"DOCUMENT_POSITION_CONTAINS",8),sS(eF,"DOCUMENT_POSITION_CONTAINED_BY",16),sS(eF,"DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC",32);var tF=hS(function e(){dS(this,e),sS(this,"contentBounds",void 0),sS(this,"renderBounds",void 0);}),iF=function(){return hS(function e(){dS(this,e),sS(this,"boundsDirty",!0),sS(this,"bounds",void 0),sS(this,"renderBoundsDirty",!0),sS(this,"renderBounds",void 0);},[{key:"isRenderable",value:function value(){return this.boundsDirty||this.renderBoundsDirty;}},{key:"toRenderable",value:function value(){this.boundsDirty=!0,this.renderBoundsDirty=!0;}}]);}(),rF=hS(function e(){dS(this,e),sS(this,"renderOrder",0),sS(this,"lastSortedIndex",void 0),sS(this,"sorted",void 0),sS(this,"dirty",!1);}),nF=function(){return hS(function e(){dS(this,e),sS(this,"frozen",!0),sS(this,"worldDirty",!1),sS(this,"localDirty",!1),sS(this,"localRotation",VL(0,0,0,1)),sS(this,"rotation",VL(0,0,0,1)),sS(this,"localScale",wL(1,1,1)),sS(this,"scale",wL(1,1,1)),sS(this,"localPosition",wL(0,0,0)),sS(this,"position",wL(0,0,0)),sS(this,"localSkew",wL(0,0,0)),sS(this,"skew",wL(0,0,0)),sS(this,"origin",wL(0,0,0)),sS(this,"worldTransform",new BL()),sS(this,"localTransform",new BL());},[{key:"updateLocalTransform",value:function value(){var e=this.origin,t=this.localScale,i=this.localPosition,r=this.localRotation,n=this.localSkew,o=new BL();o.translateSelf(e.x,e.y,e.z);var a=EL(0,0,0,1),s=this.compose(a,i,r,n,t);o.multiplySelf(s),o.translateSelf(-e.x,-e.y,-e.z),this.localTransform.setFromMatrix(o),this.localDirty=!1;}},{key:"updateWorldTransform",value:function value(e){var t=e.worldTransform.clone();t.multiplySelf(this.localTransform),this.worldTransform.setFromMatrix(t),this.worldDirty=!1;}},{key:"compose",value:function value(e,t,i,r,n){var o=new BL();o.m14=e.x,o.m24=e.y,o.m34=e.z,o.m44=e.w,o.translateSelf(t.x,t.y,t.z);var a=BL.fromQuat(i);o.multiplySelf(a);var s=new BL();return r.z&&(s.m32=r.z,o.multiplySelf(s)),r.y&&(s.m32=0,s.m31=r.y,o.multiplySelf(s)),r.x&&(s.m31=0,s.m21=r.x,o.multiplySelf(s)),o.scaleSelf(n.x,n.y,n.z),o;}}]);}(),oF=function(e){function t(){var e,i;dS(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return sS(i=nO(this,t,BS(e=[]).call(e,n)),"attributes",{}),sS(i,"id",void 0),sS(i,"pageUid",void 0),sS(i,"index",void 0),sS(i,"name",void 0),sS(i,"scrollLeft",void 0),sS(i,"scrollTop",void 0),sS(i,"scrollWidth",void 0),sS(i,"scrollHeight",void 0),sS(i,"renderable",new iF()),sS(i,"sortable",new rF()),sS(i,"geometry",new tF()),sS(i,"transform",new nF()),sS(i,"parsedStyle",{}),sS(i,"style",void 0),sS(i,"isDestroyed",!1),i;}return Qb(t,e),hS(t,[{key:"className",get:function get(){return this.getAttribute("class")||"";},set:function set(e){this.setAttribute("class",e);}},{key:"classList",get:function get(){var e;return Ox(e=this.className.split(" ")).call(e,function(e){return""!==e;});}},{key:"tagName",get:function get(){return this.nodeName;}},{key:"children",get:function get(){return this.childNodes;}},{key:"childElementCount",get:function get(){return this.childNodes.length;}},{key:"firstElementChild",get:function get(){return this.firstChild;}},{key:"lastElementChild",get:function get(){return this.lastChild;}},{key:"getAttribute",value:function value(e){var t=this.attributes[e];return null==t?null:t;}},{key:"getElementsByName",value:function value(e){return QW.querySelectorAll('[name="'.concat(e,'"]'),this);}},{key:"getElementsByClassName",value:function value(e){return QW.querySelectorAll(".".concat(e),this);}},{key:"getElementsByTagName",value:function value(e){return QW.querySelectorAll(e,this);}},{key:"hasAttribute",value:function value(e){var t;return sE(t=kS(this.attributes)).call(t,e)>-1;}},{key:"removeAttribute",value:function value(e){this.setAttribute(e,null),delete this.attributes[e];}},{key:"setAttribute",value:function value(e,t){this.attributes[e]=t;}},{key:"appendChild",value:function value(e,t){QW.append(e,this,t);var i=new ZW("child-inserted",{child:e});this.dispatchEvent(i);var r=new $W("DOMNodeInserted",this,"","","",0,"","");return e.dispatchEvent(r),e;}},{key:"cloneNode",value:function value(e){return null;}},{key:"insertBefore",value:function value(e,t){if(t){var i,r=sE(i=this.childNodes).call(i,t);this.appendChild(e,r-1);}else this.appendChild(e);return e;}},{key:"removeChild",value:function value(e){var t=new $W("removed",this,"","","",0,"","");e.dispatchEvent(t);var i=new ZW("child-removed",{child:e});return this.dispatchEvent(i),QW.remove(e),e;}},{key:"isChildExist",value:function value(e){return QW.isChildExist(e);}},{key:"replaceChild",value:function value(e,t){var i,r=sE(i=this.childNodes).call(i,t);return this.removeChild(t),this.appendChild(e,r),t;}},{key:"destroy",value:function value(){var e=new ZW("destroy",{});this.dispatchEvent(e),this.remove(),this.removeAllEventListeners(),this.isDestroyed=!0;}},{key:"after",value:function value(){var e=this.parentNode;if(e){for(var t,i=sE(t=e.childNodes).call(t,this),r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];pS(n).call(n,function(t,r){null==e||e.appendChild(t,i+r+1);});}}},{key:"before",value:function value(){var e=this.parentNode;if(e){for(var t,i=sE(t=e.childNodes).call(t,this),r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];pS(n).call(n,function(t,r){null==e||e.appendChild(t,i+r);});}}},{key:"remove",value:function value(){this.parentNode&&this.parentNode.removeChild(this);}},{key:"replaceWith",value:function value(){this.after.apply(this,arguments),this.remove();}},{key:"append",value:function value(){for(var e=this,t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];pS(i).call(i,function(t){e.appendChild(t);});}},{key:"prepend",value:function value(){for(var e=this,t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];pS(i).call(i,function(t,i){e.appendChild(t,i);});}},{key:"querySelector",value:function value(e){return QW.querySelector(e,this);}},{key:"querySelectorAll",value:function value(e){return QW.querySelectorAll(e,this);}},{key:"find",value:function value(e){var t=this,i=null;return this.recursiveCall(function(r){return!(r!==t||!e(r)||(i=r,0));}),i;}},{key:"findAll",value:function value(e){var t=this,i=[];return this.recursiveCall(function(r){r===t&&e(r)&&i.push(r);}),i;}},{key:"getGeometryBounds",value:function value(){return QW.getGeometryBounds(this);}},{key:"getRenderBounds",value:function value(){return QW.getBounds(this,!0);}},{key:"getBounds",value:function value(){return QW.getBounds(this);}},{key:"getLocalBounds",value:function value(){return QW.getLocalBounds(this);}},{key:"getBoundingClientRect",value:function value(){return QW.getBoundingClientRect(this);}}]);}(eF),aF=function(){return hS(function e(t){dS(this,e),sS(this,"lineAlign",void 0),sS(this,"owner",void 0),this.owner=t,this.reset();},[{key:"reset",value:function value(){this.lineAlign=.5;}},{key:"x",get:function get(){return this.owner.getAttribute("x");},set:function set(e){this.owner.setAttribute("x",e);}},{key:"y",get:function get(){return this.owner.getAttribute("y");},set:function set(e){this.owner.setAttribute("y",e);}},{key:"r",get:function get(){return this.owner.getAttribute("r");},set:function set(e){this.owner.setAttribute("r",e);}},{key:"width",get:function get(){return this.owner.getAttribute("width");},set:function set(e){this.owner.setAttribute("width",e);}},{key:"height",get:function get(){return this.owner.getAttribute("height");},set:function set(e){this.owner.setAttribute("height",e);}},{key:"points",get:function get(){return this.owner.getAttribute("points");},set:function set(e){this.owner.setAttribute("points",e);}},{key:"selectable",get:function get(){return this.owner.getAttribute("selectable");},set:function set(e){this.owner.setAttribute("selectable",e);}},{key:"origin",get:function get(){return this.owner.getAttribute("origin");},set:function set(e){this.owner.setAttribute("origin",e);}},{key:"anchor",get:function get(){return this.owner.getAttribute("anchor");},set:function set(e){this.owner.setAttribute("anchor",e);}},{key:"visibility",get:function get(){return this.owner.getAttribute("visibility");},set:function set(e){this.owner.setAttribute("visibility",e);}},{key:"zIndex",get:function get(){return this.owner.getAttribute("zIndex");},set:function set(e){this.owner.setAttribute("zIndex",e);}},{key:"transformOrigin",get:function get(){return this.owner.getAttribute("transformOrigin");},set:function set(e){this.owner.setAttribute("transformOrigin",e);}},{key:"borderWidth",get:function get(){return this.owner.getAttribute("borderWidth");},set:function set(e){this.owner.setAttribute("borderWidth",e);}},{key:"borderColor",get:function get(){return this.owner.getAttribute("borderColor");},set:function set(e){this.owner.setAttribute("borderColor",e);}},{key:"opacity",get:function get(){return this.owner.getAttribute("opacity");},set:function set(e){this.owner.setAttribute("opacity",e);}},{key:"fillOpacity",get:function get(){return this.owner.getAttribute("fillOpacity");},set:function set(e){this.owner.setAttribute("fillOpacity",e);}},{key:"borderOpacity",get:function get(){return this.owner.getAttribute("borderOpacity");},set:function set(e){this.owner.setAttribute("borderOpacity",e);}},{key:"background",get:function get(){return this.owner.getAttribute("background");},set:function set(e){this.owner.setAttribute("background",e);}},{key:"clipPath",get:function get(){return this.owner.getAttribute("clipPath");},set:function set(e){this.owner.setAttribute("clipPath",e);}},{key:"cursor",get:function get(){return this.owner.getAttribute("cursor");},set:function set(e){this.owner.setAttribute("cursor",e);}},{key:"hitArea",get:function get(){return this.owner.getAttribute("hitArea");},set:function set(e){this.owner.setAttribute("hitArea",e);}},{key:"pointerEvents",get:function get(){return this.owner.getAttribute("pointerEvents");},set:function set(e){this.owner.setAttribute("pointerEvents",e);}},{key:"miterLimit",get:function get(){return this.owner.getAttribute("miterLimit");},set:function set(e){this.owner.setAttribute("miterLimit",e);}},{key:"lineCap",get:function get(){return this.owner.getAttribute("lineCap");},set:function set(e){this.owner.setAttribute("lineCap",e);}},{key:"lineJoin",get:function get(){return this.owner.getAttribute("lineJoin");},set:function set(e){this.owner.setAttribute("lineJoin",e);}},{key:"lineDash",get:function get(){return this.owner.getAttribute("lineDash");},set:function set(e){this.owner.setAttribute("lineDash",e);}},{key:"lineDashOffset",get:function get(){return this.owner.getAttribute("lineDashOffset");},set:function set(e){this.owner.setAttribute("lineDashOffset",e);}},{key:"shadow",get:function get(){return this.owner.getAttribute("shadow");},set:function set(e){this.owner.setAttribute("shadow",e);}},{key:"shadowOffsetX",get:function get(){return this.owner.getAttribute("shadowOffsetX");},set:function set(e){this.owner.setAttribute("shadowOffsetX",e);}},{key:"shadowOffsetY",get:function get(){return this.owner.getAttribute("shadowOffsetY");},set:function set(e){this.owner.setAttribute("shadowOffsetY",e);}},{key:"shadowBlur",get:function get(){return this.owner.getAttribute("shadowBlur");},set:function set(e){this.owner.setAttribute("shadowBlur",e);}},{key:"shadowColor",get:function get(){return this.owner.getAttribute("shadowColor");},set:function set(e){this.owner.setAttribute("shadowColor",e);}},{key:"startAngle",get:function get(){return this.owner.getAttribute("startAngle");},set:function set(e){this.owner.setAttribute("startAngle",e);}},{key:"endAngle",get:function get(){return this.owner.getAttribute("endAngle");},set:function set(e){this.owner.setAttribute("endAngle",e);}},{key:"rx",get:function get(){return this.owner.getAttribute("rx");},set:function set(e){this.owner.setAttribute("rx",e);}},{key:"ry",get:function get(){return this.owner.getAttribute("ry");},set:function set(e){this.owner.setAttribute("ry",e);}},{key:"img",get:function get(){return this.owner.getAttribute("img");},set:function set(e){this.owner.setAttribute("img",e);}},{key:"src",get:function get(){return this.owner.getAttribute("src");},set:function set(e){this.owner.setAttribute("src",e);}},{key:"x1",get:function get(){return this.owner.getAttribute("x1");},set:function set(e){this.owner.setAttribute("x1",e);}},{key:"y1",get:function get(){return this.owner.getAttribute("y1");},set:function set(e){this.owner.setAttribute("y1",e);}},{key:"x2",get:function get(){return this.owner.getAttribute("x2");},set:function set(e){this.owner.setAttribute("x2",e);}},{key:"y2",get:function get(){return this.owner.getAttribute("y2");},set:function set(e){this.owner.setAttribute("y2",e);}},{key:"text",get:function get(){return this.owner.getAttribute("text");},set:function set(e){this.owner.setAttribute("text",e);}},{key:"wordWarp",get:function get(){return this.owner.getAttribute("wordWarp");},set:function set(e){this.owner.setAttribute("wordWarp",e);}},{key:"wordBreak",get:function get(){return this.owner.getAttribute("wordBreak");},set:function set(e){this.owner.setAttribute("wordBreak",e);}},{key:"underline",get:function get(){return this.owner.getAttribute("underline");},set:function set(e){this.owner.setAttribute("underline",e);}},{key:"strikeout",get:function get(){return this.owner.getAttribute("strikeout");},set:function set(e){this.owner.setAttribute("strikeout",e);}},{key:"textMaxWidth",get:function get(){return this.owner.getAttribute("textMaxWidth");},set:function set(e){this.owner.setAttribute("textMaxWidth",e);}},{key:"letterSpacing",get:function get(){return this.owner.getAttribute("letterSpacing");},set:function set(e){this.owner.setAttribute("letterSpacing",e);}},{key:"textAlign",get:function get(){return this.owner.getAttribute("textAlign");},set:function set(e){this.owner.setAttribute("textAlign",e);}},{key:"textBaseLine",get:function get(){return this.owner.getAttribute("textBaseLine");},set:function set(e){this.owner.setAttribute("textBaseLine",e);}},{key:"textTransform",get:function get(){return this.owner.getAttribute("textTransform");},set:function set(e){this.owner.setAttribute("textTransform",e);}},{key:"color",get:function get(){return this.owner.getAttribute("color");},set:function set(e){this.owner.setAttribute("color",e);}},{key:"fontStyle",get:function get(){return this.owner.getAttribute("fontStyle");},set:function set(e){this.owner.setAttribute("fontStyle",e);}},{key:"fontVariant",get:function get(){return this.owner.getAttribute("fontVariant");},set:function set(e){this.owner.setAttribute("fontVariant",e);}},{key:"fontWeight",get:function get(){return this.owner.getAttribute("fontWeight");},set:function set(e){this.owner.setAttribute("fontWeight",e);}},{key:"fontSize",get:function get(){return this.owner.getAttribute("fontSize");},set:function set(e){this.owner.setAttribute("fontSize",e);}},{key:"lineHeight",get:function get(){return this.owner.getAttribute("lineHeight");},set:function set(e){this.owner.setAttribute("lineHeight",e);}},{key:"fontFamily",get:function get(){return this.owner.getAttribute("fontFamily");},set:function set(e){this.owner.setAttribute("fontFamily",e);}},{key:"startPoint",get:function get(){return this.owner.getAttribute("startPoint");},set:function set(e){this.owner.setAttribute("startPoint",e);}},{key:"endPoint",get:function get(){return this.owner.getAttribute("endPoint");},set:function set(e){this.owner.setAttribute("endPoint",e);}},{key:"lineEnding",get:function get(){return this.owner.getAttribute("lineEnding");},set:function set(e){this.owner.setAttribute("lineEnding",e);}},{key:"stampPoints",get:function get(){return this.owner.getAttribute("stampPoints");},set:function set(e){this.owner.setAttribute("stampPoints",e);}}]);}(),sF={},lF={},uF=function(e){function t(e){var i;return dS(this,t),sS(Kw(i=nO(this,t)),"shapeType",void 0),sS(Kw(i),"config",void 0),sS(Kw(i),"path",void 0),sS(Kw(i),"steps",void 0),sS(Kw(i),"externalMatrixes",[]),sS(Kw(i),"clippable",!1),sS(Kw(i),"imageData",null),i.config=e,i.id=e.id||e.uid||"",i.name=e.name||"",i.index=e.index,i.nodeName=e.type||"container",i.pageUid=e.pageUid||"",(e.className||e.class)&&(i.className=e.className||e.class),i.style=new aF(Kw(i)),i.initAttributes(e),i;}return Qb(t,e),hS(t,[{key:"isVisible",get:function get(){return"visible"===this.parsedStyle.visibility;}},{key:"isInteractive",get:function get(){return"none"!==this.parsedStyle.pointerEvents;}},{key:"width",get:function get(){return this.parsedStyle.width.value*Math.abs(this.getScale().x);}},{key:"height",get:function get(){return this.parsedStyle.height.value*Math.abs(this.getScale().y);}},{key:"initAttributes",value:function value(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(var t in e)if(BO(t,e)){if("style"===t)continue;this.attributes[t]=e[t];}for(var i in e.style)BO(i,e.style)&&(this.parseStyleProperty(i,e.style[i]),this.attributes[i]=e.style[i]);this.renderable.toRenderable();}},{key:"setAttribute",value:function value(e,i){if(!pO(i)&&i!==this.attributes[e]){var r=this.attributes[e];oO(t,"setAttribute",this,3)([e,i]),this.config.hasOwnProperty(e)||(this.parseStyleProperty(e,i),this.updateStyleProperty(e,r,i));}}},{key:"parseStyleProperty",value:function value(e,t){var i=sF[e];this.parsedStyle[e]=i?i(t,this,e):t;}},{key:"updateStyleProperty",value:function value(e,t,i){var r=this,n=lF[e];n&&pS(n).call(n,function(n){n(t,i,r,e);});}},{key:"toFront",value:function value(){var e=this.parentNode;if(e){var t,i=Math.max.apply(Math,tk(wP(t=e.children).call(t,function(e){return e.style.zIndex;})));this.style.zIndex=i+1;}return this;}},{key:"toBack",value:function value(){var e=this.parentNode;if(e){var t,i=Math.min.apply(Math,tk(wP(t=e.children).call(t,function(e){return e.style.zIndex;})));this.style.zIndex=i-1;}return this;}},{key:"setOrigin",value:function value(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return QW.setOrigin(this,e,t),this;}},{key:"getOrigin",value:function value(){return QW.getOrigin(this);}},{key:"setPosition",value:function value(e){return QW.setPosition(this,e),this;}},{key:"setLocalPosition",value:function value(e){var t=wL(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0);return QW.setLocalPosition(this,t),this;}},{key:"getPosition",value:function value(){return QW.getPosition(this);}},{key:"getLocalPosition",value:function value(){return QW.getLocalPosition(this);}},{key:"translate",value:function value(e){var t=wL(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0);return QW.translate(this,t),this;}},{key:"translateLocal",value:function value(e){var t=wL(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0);return QW.translateLocal(this,t),this;}},{key:"scale",value:function value(e,t,i){return this.scaleLocal(e,t,i);}},{key:"scaleLocal",value:function value(e,t,i){return CO(e)&&(e=wL(e,t=t||e,i=i||e)),QW.scaleLocal(this,e),this;}},{key:"setLocalScale",value:function value(e,t,i){return CO(e)&&(e=wL(e,t=t||e,i=i||e)),QW.setLocalScale(this,e),this;}},{key:"getScale",value:function value(){return QW.getScale(this);}},{key:"getLocalScale",value:function value(){return QW.getLocalScale(this);}},{key:"rotate",value:function value(e,t,i){return pO(t)&&pO(i)?QW.rotate(this,0,0,e):QW.rotate(this,e,t,i),this;}},{key:"rotateLocal",value:function value(e,t,i){return pO(t)&&pO(i)?QW.rotateLocal(this,0,0,e):QW.rotateLocal(this,e,t,i),this;}},{key:"setAngle",value:function value(e){return QW.setAngle(this,0,0,e),this;}},{key:"setLocalAngle",value:function value(e){return QW.setLocalAngle(this,0,0,e),this;}},{key:"getAngle",value:function value(){return QW.getAngle(this).z;}},{key:"getLocalAngle",value:function value(){return QW.getLocalAngle(this).z;}},{key:"getLocalTransform",value:function value(){return QW.getLocalTransform(this);}},{key:"getWorldTransform",value:function value(){return QW.getWorldTransform(this);}},{key:"setLocalTransform",value:function value(e){return QW.setLocalTransform(this,e),this;}},{key:"resetLocalTransform",value:function value(){QW.resetLocalTransform(this);}},{key:"getPath",value:function value(){}},{key:"getConfig",value:function value(){}},{key:"getBoundingRect",value:function value(){}},{key:"getBoundingRectObject",value:function value(){}},{key:"updateStyle",value:function value(e){}},{key:"isPointInPath",value:function value(e){}}]);}(oF);function cF(e,t){return{type:e,data:t};}function hF(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=[],r=ek(e,1)[0];i.push(cF("moveTo",[r]));for(var n=1;n<e.length;n++)r=e[n],i.push(cF("lineTo",[r]));return t&&e.length>2&&(r=ek(e,1)[0],i.push(cF("lineTo",[r]))),i;}function dF(e,t){var i=t.data,r=t.type,n=ek(i,3),o=n[0],a=n[1],s=n[2];switch(r){case"moveTo":e.moveTo(o.x,o.y);break;case"lineTo":e.lineTo(o.x,o.y);break;case"bezierCurveTo":e.bezierCurveTo(o.x,o.y,a.x,a.y,s.x,s.y);break;case"quadraticCurveTo":e.quadraticCurveTo(o.x,o.y,a.x,a.y);}}function fF(e){for(var t=Math.min,i=Math.max,r=e[0],n=r.x,o=r.y,a=n,s=o,l=n,u=o,c=1;c<e.length;c++){var h=e[c];a=t(a,h.x),l=i(l,h.x),s=t(s,h.y),u=i(u,h.y);}return{left:a,top:s,right:l,bottom:u,width:l-a,height:u-s};}var vF={opacity:1,fillOpacity:1,borderOpacity:1,lineJoin:"miter",lineCap:"butt",zIndex:0,visibility:"visible",anchor:[0,0],borderColor:"black",miterLimit:10,lineDash:[0,0],lineDashOffset:0};function gF(e){if(e.length<1)return[];for(var t=[],i=[],r=0;r<e.length;r++){var n=e[r];if(0===n.step)r>0&&t.push({step:i,close:e[r-1].close}),(i=[]).push(cF("moveTo",[{x:n.x,y:n.y}]));else if(1===n.step)i.push(cF("lineTo",[{x:n.x,y:n.y}]));else if(2===n.step&&r+2<e.length&&2===e[r+1].step&&2===e[r+2].step){var o=e[r+1],a=e[r+2];i.push(cF("bezierCurveTo",[n,o,a])),r+=2;}}return t.push({step:i,close:e[e.length-1].close}),t;}function mF(e,t,i,r){var n=0,o=0,a=0,s=0,l=[e,t],u=fF(l),c=function(e,t,i,r){var n=r/2,o=r/2,a=t.y-e.y,s=t.x-e.x;if(0===a||0===s)return[s,a];var l=-1/((t.y-e.y)/(t.x-e.x)),u=Math.atan(l);return"square"===i?(n=Math.sqrt(2)*r/2,o=Math.sqrt(2)*r/2):"round"===i?(n=r/2,o=r/2):(n=Math.abs(Math.cos(u)*r)/2,o=Math.abs(Math.sin(u)*r)/2),[n,o];}(l[0],l[1],r,i||0);return 0===c[1]?(n=u.left,o=u.top-i/2,a=u.width,s=u.height+i,"square"!==r&&"round"!==r||(n-=i/2,a+=i)):0===c[0]?(n=u.left-i/2,o=u.top,a=u.width+i,s=u.height,"square"!==r&&"round"!==r||(o-=i/2,s+=i)):(n=u.left-c[0],o=u.top-c[1],a=u.width+2*c[0],s=u.height+2*c[1]),{x:n,y:o,width:a,height:s};}function yF(e){return Math.abs(e)<1e-6?0:e<0?-1:1;}function pF(e,t,i,r){var n=e.x,o=e.y,a=t.x,s=t.y,l=r.x,u=r.y,c=Math.min(n,a),h=Math.max(n,a),d=Math.min(o,s),f=Math.max(o,s),v=i/2;return l>=c-v&&l<=h+v&&u>=d-v&&u<=f+v&&function(e,t,i,r,n,o){var a=[i-e,r-t];if(new pL(a[0],a[1]).equals({x:0,y:0}))return Math.sqrt((n-e)*(n-e)+(o-t)*(o-t));var s=[-a[1],a[0]],l=new pL(s[0],s[1]);l.normalize();var u=[n-e,o-t],c=new pL(u[0],u[1]);return Math.abs(c.dot(l));}(n,o,a,s,l,u)<=i/2;}function wF(e,t,i,r,n){var o=e.length;if(o<2)return!1;for(var a=0;a<o-1;a++)if(pF(e[a],e[a+1],t,{x:i,y:r}))return!0;return!(!n||!pF(e[0],e[o-1],t,{x:i,y:r}));}function bF(e,t,i,r,n,o){return n>=e&&n<=e+i&&o>=t&&o<=t+r;}function kF(e,t,i,r,n,o){var a=o,s=r.x,l=r.y,u=n.x,c=n.y;0===t&&(s=n.x,l=n.y,u=r.x,c=r.y);var h=Math.PI/2,d=u-s>=0?1:-1,f=c-l>=0?1:-1;s!==u&&(h=Math.atan(Math.abs(c-l)/Math.abs(u-s)));var v=Math.cos(h),g=Math.sin(h),m=i?1:-1,y={x:u+9*m*a*v*d-4.5*a*g*d,y:c+9*m*a*g*f+4.5*a*v*f,step:0,close:!1},p={x:u+m*a*v*d,y:c+m*a*g*f,step:1,close:!1},w={x:u+9*m*a*v*d+4.5*a*g*d,y:c+9*m*a*g*f-4.5*a*v*f,step:1,close:!1};e.push(y,p,w);}function SF(e,t,i,r,n,o){var a=o,s=r.x,l=r.y,u=n.x,c=n.y;0===t&&(s=n.x,l=n.y,u=r.x,c=r.y);var h=Math.PI/2,d=u-s>=0?1:-1,f=c-l>=0?1:-1;s!==u&&(h=Math.atan(Math.abs(c-l)/Math.abs(u-s)));var v=Math.cos(h),g=Math.sin(h),m=i?1:-1,y={x:u+9*m*a*v*d-4.5*a*g*d,y:c+9*m*a*g*f+4.5*a*v*f,step:0,close:!1},p={x:u+m*a*v*d,y:c+m*a*g*f,step:1,close:!1},w={x:u+9*m*a*v*d+4.5*a*g*d,y:c+9*m*a*g*f-4.5*a*v*f,step:1,close:!0};e.push(y,p,w);}function xF(e,t,i,r,n){var o=n,a=i.x,s=i.y,l=r.x,u=r.y;0===t&&(a=r.x,s=r.y,l=i.x,u=i.y);var c=Math.PI/2,h=l-a>=0?1:-1,d=u-s>=0?1:-1;a!==l&&(c=Math.atan(Math.abs(u-s)/Math.abs(l-a)));var f=Math.cos(c),v=Math.sin(c),g={x:l-3*o*v*h,y:u+3*o*f*d,step:0,close:!1},m={x:l+3*o*v*h,y:u-3*o*f*d,step:1,close:!1};e.push(g,m);}function CF(e,t,i,r,n){var o=n,a=i.x,s=i.y,l=r.x,u=r.y;0===t&&(a=r.x,s=r.y,l=i.x,u=i.y);var c=Math.PI/2,h=l-a>=0?1:-1,d=u-s>=0?1:-1,f=u>=s&&l>=a||u<=s&&l<=a?-1:1;a!==l&&(c=Math.atan(Math.abs(u-s)/Math.abs(l-a)));var v=Math.cos(c),g=Math.sin(c),m=4.5*Math.sqrt(3)*o,y={x:l+4.5*o*v*h-m*g*h*f,y:u+4.5*o*g*d+m*v*d*f,step:0,close:!1},p={x:l-4.5*o*v*h+m*g*h*f,y:u-4.5*o*g*d-m*v*d*f,step:1,close:!1};e.push(y,p);}function VF(e,t,i,r,n){var o=n,a=r.x,s=r.y;0===t&&(a=i.x,s=i.y);var l={x:a-3*o,y:s,step:0,close:!1},u={x:a,y:s-3*o,step:1,close:!1},c={x:a+3*o,y:s,step:1,close:!1},h={x:a,y:s+3*o,step:1,close:!0};e.push(l,u,c,h);}function TF(e,t,i,r,n){var o=n,a=r.x,s=r.y;0===t&&(a=i.x,s=i.y);var l=3*o-0*o,u=function(e,t,i,r){var n=e-i,o=e+i,a=t-r,s=t+r,l=.551915024494,u=l*i,c=l*r,h=[];return h.push({x:o,y:t}),h.push({x:o,y:t+c},{x:e+u,y:s},{x:e,y:s}),h.push({x:e-u,y:s},{x:n,y:t+c},{x:n,y:t}),h.push({x:n,y:t-c},{x:e-u,y:a},{x:e,y:a}),h.push({x:e+u,y:a},{x:o,y:t-c},{x:o,y:t}),h;}(a,s,l,l);pS(u).call(u,function(t,i){var r=0===i?0:2,n=i===u.length-1,o={x:t.x,y:t.y,step:r,close:n};e.push(o);});}function IF(e,t){if(pO(e)||""===e)return null;var i=zW(e);return"%"===i.unit?.01*t*i.value:i.value;}var EF=function(e){function t(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=i.style,n=bv(i,_N);dS(this,t),sS(e=nO(this,t,[uS({type:"rect",style:uS(uS({},vF),{},{x:0,y:0,width:0,height:0},r)},n)]),"shapeType","rect");var o=e.parsedStyle,a=o.x,s=o.y;return e.setLocalPosition(a,s),e.updateOrigin(),e;}return Qb(t,e),hS(t,[{key:"updateStyle",value:function value(e){var t,i=this;pS(t=kS(e)).call(t,function(t){BO(t,e)&&(i.style[t]=e[t]);});}},{key:"updateOrigin",value:function value(){var e=this.parsedStyle,t=e.width,i=e.height;this.setOrigin(t.value/2,i.value/2);}},{key:"updatePosition",value:function value(e,t){this.style.x=e,this.style.y=t;}},{key:"getPath",value:function value(){var e=this.parsedStyle,t=e.width,i=e.height,r=e.borderWidth,n=.5*((null==r?void 0:r.value)||0),o=0,a=0;o+=n,a+=n;var s=t.value-2*n,l=i.value-2*n;return this.path=[{x:o,y:a},{x:o+s,y:a},{x:o+s,y:a+l},{x:o,y:a+l}],this.steps=hF(this.path),this.path;}},{key:"getBoundingRect",value:function value(){var e=this.parsedStyle,t=e.x,i=e.y,r=e.width,n=e.height;return e.borderWidth,{x:t,y:i,width:r.value,height:n.value};}},{key:"getBoundingRectObject",value:function value(){var e=this.getBoundingRect();return new t({style:{x:e.x,y:e.y,width:e.width,height:e.height,borderWidth:1,background:"rgba(0,0,0,0)"}});}},{key:"isPointInPath",value:function value(e){var t=this.parsedStyle,i=t.x,r=t.y,n=t.background,o=t.borderWidth,a=t.width,s=t.height,l=o&&o.value,u=((null==o?void 0:o.value)||0)/2;return n&&l?bF(i-u,r-u,a.value+u,s.value+u,e.x,e.y):n?bF(i,r,a.value,s.value,e.x,e.y):!!l&&function(e,t,i,r,n,o,a){var s=n/2;return bF(e-s,t-s,i,n,o,a)||bF(e+i-s,t-s,n,r,o,a)||bF(e+s,t+r-s,i,n,o,a)||bF(e-s,t+s,n,r,o,a);}(i-u,r-u,a.value,s.value,o.value,e.x,e.y);}}]);}(uF);function PF(e,t,i,r,n){for(var o=n||[],a=e[t],s=e[i-1],l=0,u=1,c=t+1;c<i-1;c++){var h=LL(OL(a,s,e[c]),e[c]);h>l&&(l=h,u=c);}return l>=r?(PF(e,t,u,r,o),PF(e,u,i,r,o)):(o.length||o.push(a),o.push(s)),o;}var BF=function(e){function t(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=i.style,n=bv(i,GN);dS(this,t),sS(Kw(e=nO(this,t,[uS({type:"image",style:uS(uS({},vF),{},{x:0,y:0,width:0,height:0,img:""},r)},n)])),"shapeType","image"),sS(Kw(e),"meteData",void 0),e.meteData=(null==n?void 0:n.meteData)||null;var o=e.parsedStyle,a=o.x,s=o.y;return e.setLocalPosition(a,s),e.updateOrigin(),e;}return Qb(t,e),hS(t,[{key:"updateStyle",value:function value(e){var t,i=this;pS(t=kS(e)).call(t,function(t){BO(t,e)&&(i.style[t]=e[t]);});}},{key:"updateOrigin",value:function value(){var e=this.parsedStyle,t=e.width,i=e.height;this.setOrigin(t.value/2,i.value/2);}},{key:"updatePosition",value:function value(e,t){this.style.x=e,this.style.y=t;}},{key:"getBoundingRect",value:function value(){var e=this.parsedStyle,t=e.x,i=e.y,r=e.width,n=e.height;return{x:t,y:i,width:r.value,height:n.value};}},{key:"getBoundingRectObject",value:function value(){var e=this.getBoundingRect(),t=e.x,i=e.y,r=e.width,n=e.height;return new EF({style:{x:t,y:i,width:r,height:n,borderWidth:1,background:"rgba(0,0,0,0)"}});}},{key:"isPointInPath",value:function value(e){return this.getBoundingRectObject().isPointInPath(e);}}]);}(uF),DF=function(e){function t(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=i.style,n=bv(i,KN);dS(this,t),sS(e=nO(this,t,[uS({type:"line",style:uS(uS({},vF),{},{x1:0,y1:0,x2:0,y2:0,borderWidth:2},r)},n)]),"shapeType","line"),sS(e,"renderPath",void 0);var o=e.getBoundingRect(),a=o.x,s=o.y;return e.updatePosition(a,s),e.updateOrigin(),e;}return Qb(t,e),hS(t,[{key:"updateOrigin",value:function value(){var e=this.getBoundingRect(),t=e.width,i=e.height;this.setOrigin(t/2,i/2);}},{key:"updatePoints",value:function value(){var e=this.renderPath,t=this.getLocalPosition(),i=[];pS(e).call(e,function(e){i.push({x:e.x+t.x,y:e.y+t.y});}),this.updateStyle({x1:i[0].x||0,y1:i[0].y||0,x2:i[1].x||0,y2:i[1].y||0});}},{key:"updateStyle",value:function value(e){var t,i=this;pS(t=kS(e)).call(t,function(t){BO(t,e)&&(i.style[t]=e[t]);});}},{key:"updatePosition",value:function value(e,t){this.style.x=e,this.style.y=t;}},{key:"getPath",value:function value(){var e=this.renderable,t=this.parsedStyle,i=t.x1,r=t.x2,n=t.y1,o=t.y2,a=this.getBoundingRect(),s=a.x,l=a.y;return this.path&&!e.isRenderable()||(this.renderPath=[{x:i-s,y:n-l},{x:r-s,y:o-l}],this.path=[{x:i,y:n},{x:r,y:o}],this.steps=hF(this.renderPath,!1),e.toRenderable()),this.path;}},{key:"getBoundingRect",value:function value(){var e=this.parsedStyle,t=e.x1,i=e.x2,r=e.y1,n=e.y2,o=e.borderWidth,a=e.lineCap;return mF({x:t,y:r},{x:i,y:n},o.value,a);}},{key:"getBoundingRectObject",value:function value(){var e=this.getBoundingRect(),t=e.x,i=e.y,r=e.width,n=e.height;return new EF({style:{x:t,y:i,width:r,height:n,borderWidth:1,background:"rgba(0,0,0,0)"}});}},{key:"isPointInPath",value:function value(e){if(!this.getBoundingRectObject().isPointInPath(e))return!1;var t=this.parsedStyle,i=t.x1,r=t.x2,n=t.y1,o=t.y2,a=t.borderWidth;return pF({x:i,y:n},{x:r,y:o},a.value<20?10:a.value/2,e);}}]);}(uF),MF=function(e){function t(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=i.style,n=bv(i,$N);return dS(this,t),sS(Kw(e=nO(this,t,[uS({type:"path",style:uS(uS({},vF),{},{points:[],lineJoin:"miter",lineCap:"butt",borderWidth:2,miterLimit:4},r)},n)])),"shapeType","path"),sS(Kw(e),"renderPath",void 0),sS(Kw(e),"pointArray",[]),sS(Kw(e),"pointLength",0),sS(Kw(e),"initialRect",void 0),e.getPath(),e.initialRect=e.getBoundingRect(),e.updatePosition(e.initialRect.x,e.initialRect.y),e.setOrigin(e.initialRect.width,e.initialRect.height),e;}return Qb(t,e),hS(t,[{key:"addPoint",value:function value(e){var t=tk(this.style.points);t.push(e),this.style.points=t;}},{key:"updateStyle",value:function value(e){var t,i=this;pS(t=kS(e)).call(t,function(t){BO(t,e)&&(i.style[t]=e[t]);});}},{key:"updateOrigin",value:function value(){var e=this.getBoundingRect(),t=e.width,i=e.height;this.setOrigin(t/2,i/2);}},{key:"updatePosition",value:function value(e,t){this.style.x=e,this.style.y=t;}},{key:"getPath",value:function value(){var e,t,i=wP(e=this.parsedStyle.points).call(e,function(e){return new kL(e.x,e.y);});return i=BS(t=this.pointArray).call(t,PF(i,this.pointLength,i.length,2)),this.parsedStyle.points.length-this.pointLength===30&&(this.pointArray=_mO(i),this.pointLength=this.parsedStyle.points.length),i.length<=3&&i.push(i[i.length-1].clone()),i=function(e){var t=e.length;if(t<3)return e;var i=[];if(3===t)i.push(e[0].clone(),e[1].clone(),e[2].clone(),e[2].clone());else{var r=nE(e).call(e);i.push(r[0]);for(var n=0;n+2<r.length;n++){var o=r[n+1],a=r[n+2],s=o,l=new kL(((null==o?void 0:o.x)+(null==a?void 0:a.x))/2,((null==o?void 0:o.y)+(null==a?void 0:a.y))/2);i.push(s),n+3===r.length?i.push(a):i.push(l);}}return i;}(i),this.path=i,this.renderPath=this.getRenderPath(this.path),this.steps=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=e.length;if(i<=1)return[];var r=[],n=ek(e,1)[0];r.push(cF("moveTo",[n]));for(var o=0;o+2<i;o+=2){var a=e[o+1],s=e[o+2];r.push(cF("quadraticCurveTo",[a,s]));}return t&&e.length>2&&r.push(cF("lineTo",[n])),r;}(this.renderPath),this.path;}},{key:"getRenderPath",value:function value(e){var t=this.getBoundingRect(),i=t.x,r=t.y,n=[];return pS(e).call(e,function(e){!e||AS(e.x)||AS(e.y)||n.push({x:e.x-i,y:e.y-r});}),n;}},{key:"getBoundingRect",value:function value(){var e=this.parsedStyle,t=e.borderWidth,i=e.points,r=e.lineCap,n=wP(i).call(i,function(e){return new kL(e.x,e.y);}),o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=e.length;if(i<3)return e;var r=[];if(3===i)r.push(e[0].clone(),e[1].clone(),e[2].clone(),e[2].clone());else{var n=nE(e).call(e);n.unshift(e[0]),n.push(e[e.length-1]);var o=[],a=1-t;r.push(_mO(n[0]));for(var s=1;s+2<n.length;s++){var l=n[s],u=n[s-1],c=n[s+1],h=n[s+2];o[0]=_mO(l),o[1]=new kL(l.x+a*(c.x-u.x)/8,l.y+a*(c.y-u.y)/8),o[2]=new kL(c.x-a*(h.x-l.x)/8,c.y-a*(h.y-l.y)/8),o[3]=_mO(c),r.push(o[1],o[2],o[3]);}}return r;}(PF(n,0,n.length,1)),a=fF(o);if(2===i.length)return mF(i[0],i[1],t.value,r);var s=t.value/2;return{x:a.left-s,y:a.top-s,width:a.width+2*s,height:a.height+2*s};}},{key:"getBoundingRectObject",value:function value(){var e=this.getBoundingRect(),t=e.x,i=e.y,r=e.width,n=e.height;return new EF({style:{x:t,y:i,width:r,height:n,borderWidth:1,background:"rgba(0,0,0,0)"}});}},{key:"isPointInPath",value:function value(e){if(!this.getBoundingRectObject().isPointInPath(e))return!1;var t=this.parsedStyle.borderWidth,i=t.value<20?10:t.value/2;return function(e,t){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r=0;r<t.length;r++)if(LL(e,t[r])<=i)return!0;return!1;}(e,this.style.points,i);}}]);}(uF),UF=function(e){function t(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=i.style,n=bv(i,JN);dS(this,t),sS(Kw(e=nO(this,t,[uS({type:"polygon",style:uS(uS({},vF),{},{points:[{x:0,y:0},{x:10,y:10}],miterLimit:4,borderWidth:2},r)},n)])),"shapeType","polygon"),sS(Kw(e),"renderPath",void 0),0===e.parsedStyle.points.length&&(e.style.points=[{x:0,y:0},{x:10,y:10}]);var o=e.getBoundingRect(),a=o.x,s=o.y,l=o.width,u=o.height;return e.updatePosition(a,s),e.setOrigin(l/2,u/2),e;}return Qb(t,e),hS(t,[{key:"addPoint",value:function value(e){var t=tk(this.style.points);t.push(e),this.style.points=t;}},{key:"updatePoints",value:function value(){var e=this.renderPath,t=this.getLocalPosition(),i=[];pS(e).call(e,function(e){i.push({x:e.x+t.x,y:e.y+t.y});}),this.style.points=i;}},{key:"updateStyle",value:function value(e){var t,i=this;pS(t=kS(e)).call(t,function(t){BO(t,e)&&(i.style[t]=e[t]);});}},{key:"updateOrigin",value:function value(){var e=this.getBoundingRect(),t=e.width,i=e.height;this.setOrigin(t/2,i/2);}},{key:"updatePosition",value:function value(e,t){this.style.x=e,this.style.y=t;}},{key:"getPath",value:function value(){var e,t=this.getBoundingRect(),i=t.x,r=t.y;return this.path=this.parsedStyle.points,this.renderPath=wP(e=this.parsedStyle.points).call(e,function(e){return{x:e.x-i,y:e.y-r};}),this.steps=hF(this.renderPath,!0),this.path;}},{key:"getBoundingRect",value:function value(){var e=this.parsedStyle,t=e.borderWidth,i=e.points,r=e.lineCap;if(2===i.length)return mF(i[0],i[1],t.value,r);var n=fF(i),o=t.value/2||0;return{x:n.left-o,y:n.top-o,width:n.width+2*o,height:n.height+2*o};}},{key:"getBoundingRectObject",value:function value(){var e=this.getBoundingRect(),t=e.x,i=e.y,r=e.width,n=e.height;return new EF({style:{x:t,y:i,width:r,height:n,borderWidth:1,background:"rgba(0,0,0,0)"}});}},{key:"isPointInPath",value:function value(e){if(!this.getBoundingRectObject().isPointInPath(e))return!1;var t=this.parsedStyle,i=t.borderWidth,r=t.background,n=t.points,o=i&&i.value,a=i.value<20?10:i.value/2,s=!1;return o&&(s=wF(n,a,e.x,e.y,!0)),!s&&r&&(s=function(e,t,i){var r=!1,n=e.length;if(n<=2)return!1;for(var o=0;o<n;o++){var a=e[o],s=e[(o+1)%n];if(WL(a,s,{x:t,y:i}))return!0;yF(a.y-i)>0!=yF(s.y-i)>0&&yF(t-(i-a.y)*(a.x-s.x)/(a.y-s.y)-a.x)<0&&(r=!r);}return r;}(n,e.x,e.y)),s;}}]);}(uF),AF=function(e){function t(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=i.style,n=bv(i,QN);dS(this,t),sS(Kw(e=nO(this,t,[uS({type:"polyline",style:uS(uS({},vF),{},{points:[{x:0,y:0},{x:0,y:0}],lineEnding:null,borderWidth:2,miterLimit:4},r)},n)])),"shapeType","polyline"),sS(Kw(e),"renderPath",void 0),e.getPath();var o=e.getBoundingRect(),a=o.x,s=o.y;return e.updatePosition(a,s),e.updateOrigin(),e;}return Qb(t,e),hS(t,[{key:"initPath",value:function value(){var e=this.parsedStyle,t=e.points,i=e.lineEnding;t.length;var r=[];if(pS(t).call(t,function(e,t){0===t?r.push({x:e.x,y:e.y,step:0,close:!1}):r.push({x:e.x,y:e.y,step:1,close:!1});}),i)for(var n=0;n<i.length;n++)switch(i[n]){case"OpenArrow":this.addOpenArrow(r,n,!1);break;case"ROpenArrow":this.addOpenArrow(r,n,!0);break;case"ClosedArrow":this.addCloseArrow(r,n,!1);break;case"RClosedArrow":this.addCloseArrow(r,n,!0);break;case"Butt":this.addButt(r,n);break;case"Slash":this.addSlash(r,n);break;case"Square":this.addSquare(r,n);break;case"Diamond":this.addDiamond(r,n);break;case"Circle":this.addCircle(r,n);}return r;}},{key:"getRenderPath",value:function value(e){var t=this.getBoundingRect(),i=t.x,r=t.y,n=[];return pS(e).call(e,function(e){!e||AS(e.x)||AS(e.y)||n.push({x:e.x-i,y:e.y-r,step:e.step,close:e.close});}),n;}},{key:"addPoint",value:function value(e){var t=tk(this.style.points);t.push(e),this.style.points=t;}},{key:"updatePoints",value:function value(){var e,t,i=this.parsedStyle.points.length,r=this.getLocalPosition(),n=[];pS(e=nE(t=this.renderPath).call(t,0,i)).call(e,function(e){n.push({x:e.x+r.x,y:e.y+r.y});}),this.style.points=n;}},{key:"updateStyle",value:function value(e){var t,i=this;pS(t=kS(e)).call(t,function(t){BO(t,e)&&(i.style[t]=e[t]);});}},{key:"updateOrigin",value:function value(){var e=this.getBoundingRect(),t=e.width,i=e.height;this.setOrigin(t/2,i/2);}},{key:"updatePosition",value:function value(e,t){this.style.x=e,this.style.y=t;}},{key:"updatePoint",value:function value(){for(var e=this.getLocalPosition(),t=this.parsedStyle.points.length,i=[],r=0;r<t;r++)i.push({x:this.renderPath[r].x+e.x,y:this.renderPath[r].y+e.y});this.updateStyle({points:i});}},{key:"getPath",value:function value(){this.path=this.initPath(),this.renderPath=this.getRenderPath(this.path),this.steps=gF(this.renderPath);}},{key:"getBoundingRect",value:function value(){var e=this.parsedStyle,t=e.borderWidth,i=e.lineCap;if(2===this.path.length)return mF(this.path[0],this.path[1],t.value,i);var r=fF(this.path),n=t.value/2;return{x:r.left-n,y:r.top-n,width:r.width+2*n,height:r.height+2*n};}},{key:"getBoundingRectObject",value:function value(){var e=this.getBoundingRect(),t=e.x,i=e.y,r=e.width,n=e.height;return new EF({style:{x:t,y:i,width:r,height:n,borderWidth:1,background:"rgba(0,0,0,0)"}});}},{key:"isPointInPath",value:function value(e){if(!this.getBoundingRectObject().isPointInPath(e))return!1;var t=this.parsedStyle,i=t.borderWidth;return wF(t.points,i.value<20?10:i.value/2,e.x,e.y,!1);}},{key:"isLineArrow",value:function value(){var e=this.parsedStyle.lineEnding;return!!e&&("None"!==e[0]||"None"!==e[1]);}},{key:"addOpenArrow",value:function value(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.parsedStyle,n=r.points,o=r.borderWidth,a=n.length,s=n[a-2],l=n[a-1];0===t&&(s=uS({},n[1]),l=uS({},n[0])),kF(e,t,i,s,l,o.value);}},{key:"addCloseArrow",value:function value(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.parsedStyle,n=r.points,o=r.borderWidth,a=n.length,s=n[a-2],l=n[a-1];0===t&&(s=uS({},n[1]),l=uS({},n[0])),SF(e,t,i,s,l,o.value);}},{key:"addCircle",value:function value(e,t){var i=this.parsedStyle,r=i.points,n=i.borderWidth,o=r.length;TF(e,t,r[0],r[o-1],n.value);}},{key:"addDiamond",value:function value(e,t){var i=this.parsedStyle,r=i.points,n=i.borderWidth,o=r.length;VF(e,t,r[0],r[o-1],n.value);}},{key:"addSquare",value:function value(e,t){var i=this.parsedStyle,r=i.points,n=i.borderWidth,o=r.length;CF(e,t,r[0],r[o-1],n.value);}},{key:"addSlash",value:function value(e,t){var i=this.parsedStyle,r=i.points,n=i.borderWidth,o=r.length,a=r[o-2],s=r[o-1];0===t&&(a=uS({},r[1]),s=uS({},r[0])),CF(e,t,a,s,n.value);}},{key:"addButt",value:function value(e,t){var i=this.parsedStyle,r=i.points,n=i.borderWidth,o=r.length,a=r[o-2],s=r[o-1];0===t&&(a=uS({},r[1]),s=uS({},r[0])),xF(e,t,a,s,n.value);}}]);}(uF),zF=function(e){function t(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=i.style,n=bv(i,eO);dS(this,t),sS(e=nO(this,t,[uS({type:"text",style:uS(uS({},vF),{},{x:0,y:0,text:"",width:300,wordWarp:!0,wordBreak:!0,underline:!1,strikeout:!1,textAlign:"left",textBaseLine:"top",textTransform:"none",letterSpacing:0,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",fontFamily:"Microsoft YaHei",color:"white",fontSize:12,lineHeight:12},r)},n)]),"shapeType","text"),sS(e,"lines",[]),sS(e,"chars",[]),sS(e,"totalHeight",void 0),sS(e,"textX",void 0),sS(e,"textY",void 0),sS(e,"rowWidth",void 0),sS(e,"realWidth",void 0),sS(e,"cacheWidth",void 0),sS(e,"font",void 0);var o=e.parsedStyle,a=o.x,s=o.y;return e.setFont(),e.calculateTextPosition(),e.lineWrap(),e.saveCharPosition(),e.setLocalPosition(a,s),e.updateOrigin(),e;}return Qb(t,e),hS(t,[{key:"setFont",value:function value(){var e,t,i,r,n,o=this.parsedStyle,a=o.fontStyle,s=o.fontVariant,l=o.fontWeight,u=o.fontFamily,c=o.fontSize;this.font=BS(e=BS(t=BS(i=BS(r=BS(n="".concat(a," ")).call(n,s," ")).call(r,l," ")).call(i,c.value)).call(t,c.unit," ")).call(e,u);}},{key:"updateStyle",value:function value(e){var t,i=this;pS(t=kS(e)).call(t,function(t){BO(t,e)&&(i.style[t]=e[t]);});}},{key:"updateOrigin",value:function value(){if(this.chars[0]){var e=this.getBoundingRect(),t=e.width,i=e.height,r=this.chars[0].height/10||0,n=this.chars[0].height/2||0,o=0;switch(this.parsedStyle.textBaseLine){case"top":o=i/2-r;break;case"hanging":o=i/2;break;case"middle":o=-r+n*(this.lines.length-1);break;case"ideographic":o=1.5*-r+n*(this.lines.length-2);break;case"bottom":o=-r+n*(this.lines.length-2);break;default:o=r+n*(this.lines.length-2);}this.setOrigin(t/2-r,o);}}},{key:"updatePosition",value:function value(e,t){this.style.x=e,this.style.y=t;}},{key:"calculateTextPosition",value:function value(){var e=this.parsedStyle,t=e.x,i=e.y,r=e.width,n=e.letterSpacing,o=e.borderWidth,a=((null==o?void 0:o.value)||0)/2;this.textX=t+a+n.value,this.textY=i+a+n.value,this.rowWidth=r.value-2*a-2*n.value;}},{key:"lineWrap",value:function value(){this.totalHeight=0,this.realWidth=0;var e=this.textX,t=this.rowWidth,i=this.parsedStyle,r=i.lineHeight,n=i.wordWarp,o=i.fontSize,a=i.borderWidth,s=document.createElement("canvas").getContext("2d"),l=0;s.font=this.font;var u=o.value>r?o.value:r,c=this.transformText(this.parsedStyle.text);if(c.length||(this.lines=[],this.totalHeight=0),c.length){for(var h=[],d=this.textY,f="",v=0;v<c.length;v++){var g=c.charAt(v);if("\n"!==g&&"\r"!==g){if(f+=g,s.measureText(f).width>=t&&n){if(""===(f=f.substring(0,f.length-1))){f=g;continue;}l+=f.length;var m=s.measureText(f).width;m>this.realWidth&&(this.realWidth=s.measureText(f).width),h.push({text:f,x:e,y:d,lineWidth:m,length:f.length,sum:l}),f=g,d+=u,this.totalHeight+=u;}}else{var y=s.measureText(f).width;y>this.realWidth&&(this.realWidth=s.measureText(f).width),l+=(f+=g).length,h.push({text:f,x:e,y:d,lineWidth:y,length:f.length,sum:l}),f="",d+=u,this.totalHeight+=u;}}if(""!==f){l+=f.length;var p=s.measureText(f).width;p>this.realWidth&&(this.realWidth=s.measureText(f).width),h.push({text:f,x:e,y:d,lineWidth:p,length:f.length,sum:l});}this.totalHeight+=u,this.lines=h;}1===this.lines.length&&(this.realWidth=s.measureText(this.lines[0].text).width),a&&a.value&&(this.realWidth+=a.value);}},{key:"getBoundingRect",value:function value(){var e=this.parsedStyle,t=e.x,i=e.y,r=e.textBaseLine,n=e.fontSize,o=e.lineHeight,a=n.value>o?n.value:o,s=a/10;return{x:t-s,y:RF(r,i,a)-s,width:this.realWidth+2*s,height:this.totalHeight};}},{key:"getBoundingRectObject",value:function value(){var e=this.getBoundingRect(),t=e.x,i=e.y,r=e.width,n=e.height;return new EF({style:{x:t,y:i,width:r,height:n,borderWidth:1,background:"rgba(0,0,0,0)"}});}},{key:"isPointInPath",value:function value(e){return this.getBoundingRectObject().isPointInPath(e);}},{key:"saveCharPosition",value:function value(){var e=this;this.chars=[];var t=this.lines,i=this.parsedStyle,r=i.fontSize,n=i.textBaseLine,o=document.createElement("canvas").getContext("2d"),a=r.value;o.font=this.font;var s=0;pS(t).call(t,function(t,i){for(var r=t.x,l=0;l<t.text.length;l++){var u=t.text.charAt(l),c=o.measureText(u).width;"\n"!==u&&"\r"!==u||(c=.1),e.chars.push({char:u,index:s+l+1,charIndex:l+1,lineIndex:i,x:r,y:RF(n,t.y,a),width:c,height:a}),r+=1*o.measureText(u).width,l===t.text.length-1&&(s+=t.text.length);}});}},{key:"getCharByPosition",value:function value(e,t){for(var i={x:e,y:t},r=0;r<this.chars.length;r++)if(this.getCharBounding(r).isPointInPath(i))return this.chars[r];return!1;}},{key:"getCharBounding",value:function value(e){var t=this.chars[e],i=t.x,r=t.y,n=t.width,o=t.height;return new EF({style:{x:i,y:r-o/10,width:n,height:o,borderWidth:1,background:"rgba(0,0,0,0)"}});}},{key:"transformText",value:function value(e){var t=this.parsedStyle.textTransform;return"capitalize"===t?e=e[0].toUpperCase()+e.substring(1):"lowercase"===t?e.toLowerCase():"uppercase"===t?e.toUpperCase():e;}}]);}(uF);function RF(e,t,i){var r,n=i/10;switch(e){case"top":r=t-.5*n;break;case"hanging":r=t+.5*n;break;case"middle":r=t-i/2-.5*n;break;case"ideographic":r=t-i-.5*n;break;case"bottom":r=t-i;break;default:r=t+2*n-i;}return r;}var NF=function(e){function t(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=i.style,n=bv(i,tO);dS(this,t),sS(Kw(e=nO(this,t,[uS({type:"freeline",style:uS(uS({},vF),{},{startPoint:{x:0,y:0},endPoint:{x:0,y:0},lineEnding:null,borderWidth:2},r)},n)])),"shapeType","freeline"),sS(Kw(e),"renderPath",void 0),e.getPath();var o=e.getBoundingRect(),a=o.x,s=o.y;return e.updatePosition(a,s),e.updateOrigin(),e;}return Qb(t,e),hS(t,[{key:"initPath",value:function value(){var e=this.parsedStyle,t=e.startPoint,i=e.endPoint,r=e.lineEnding,n=[uS(uS({},t),{},{step:0,close:!1}),uS(uS({},i),{},{step:1,close:!0})];if(r)for(var o=0;o<r.length;o++)switch(r[o]){case"OpenArrow":this.addOpenArrow(n,o,!1);break;case"ROpenArrow":this.addOpenArrow(n,o,!0);break;case"ClosedArrow":this.addCloseArrow(n,o,!1);break;case"RClosedArrow":this.addCloseArrow(n,o,!0);break;case"Butt":this.addButt(n,o);break;case"Slash":this.addSlash(n,o);break;case"Square":this.addSquare(n,o);break;case"Diamond":this.addDiamond(n,o);break;case"Circle":this.addCircle(n,o);}return n;}},{key:"getRenderPath",value:function value(e){var t=this.getBoundingRect(),i=t.x,r=t.y,n=[];return pS(e).call(e,function(e){!e||AS(e.x)||AS(e.y)||n.push({x:e.x-i,y:e.y-r,step:e.step,close:e.close});}),n;}},{key:"updatePoints",value:function value(){var e=this.getLocalPosition();this.updateStyle({startPoint:{x:this.renderPath[0].x+e.x,y:this.renderPath[0].y+e.y},endPoint:{x:this.renderPath[1].x+e.x,y:this.renderPath[1].y+e.y}});}},{key:"updateOrigin",value:function value(){var e=this.getBoundingRect(),t=e.width,i=e.height;this.setOrigin(t/2,i/2);}},{key:"updateStyle",value:function value(e){var t,i=this;pS(t=kS(e)).call(t,function(t){BO(t,e)&&(i.style[t]=e[t]);});}},{key:"updatePosition",value:function value(e,t){this.style.x=e,this.style.y=t;}},{key:"getPath",value:function value(){this.path=this.initPath(),this.renderPath=this.getRenderPath(this.path),this.steps=gF(this.renderPath);}},{key:"getBoundingRect",value:function value(){var e=this.parsedStyle,t=e.borderWidth,i=e.lineCap,r=fF(this.path);if(2===this.path.length)return mF(this.path[0],this.path[1],t.value,i);var n=t.value/2||0;return{x:r.left-n,y:r.top-n,width:r.width+2*n,height:r.height+2*n};}},{key:"getBoundingRectObject",value:function value(){var e=this.getBoundingRect(),t=e.x,i=e.y,r=e.width,n=e.height;return new EF({style:{x:t,y:i,width:r,height:n,borderWidth:1,background:"rgba(0,0,0,0)"}});}},{key:"isPointInPath",value:function value(e){if(!this.getBoundingRectObject().isPointInPath(e))return!1;var t=this.parsedStyle,i=t.startPoint,r=t.endPoint,n=t.borderWidth;return pF(i,r,n.value<20?10:n.value,e);}},{key:"isLineArrow",value:function value(){var e=this.parsedStyle.lineEnding;return!!e&&("None"!==e[0]||"None"!==e[1]);}},{key:"addCircle",value:function value(e,t){var i=this.parsedStyle;TF(e,t,i.startPoint,i.endPoint,i.borderWidth.value);}},{key:"addDiamond",value:function value(e,t){var i=this.parsedStyle;VF(e,t,i.startPoint,i.endPoint,i.borderWidth.value);}},{key:"addSquare",value:function value(e,t){var i=this.parsedStyle;!function(e,t,i,r,n){var o=n,a=r.x,s=r.y;0===t&&(a=i.x,s=i.y);var l={x:a-3*o,y:s-3*o,step:0,close:!1},u={x:a+3*o,y:s-3*o,step:1,close:!1},c={x:a+3*o,y:s+3*o,step:1,close:!1},h={x:a-3*o,y:s+3*o,step:1,close:!0};e.push(l,u,c,h);}(e,t,i.startPoint,i.endPoint,i.borderWidth.value);}},{key:"addSlash",value:function value(e,t){var i=this.parsedStyle;CF(e,t,i.startPoint,i.endPoint,i.borderWidth.value);}},{key:"addButt",value:function value(e,t){var i=this.parsedStyle;xF(e,t,i.startPoint,i.endPoint,i.borderWidth.value);}},{key:"addOpenArrow",value:function value(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.parsedStyle;kF(e,t,i,r.startPoint,r.endPoint,r.borderWidth.value);}},{key:"addCloseArrow",value:function value(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.parsedStyle;SF(e,t,i,r.startPoint,r.endPoint,r.borderWidth.value);}}]);}(uF),OF=1/0,LF=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1/0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1/0;dS(this,e),sS(this,"minX",void 0),sS(this,"maxX",void 0),sS(this,"minY",void 0),sS(this,"maxY",void 0),sS(this,"rect",void 0),sS(this,"updateId",void 0),this.minX=t,this.maxX=i,this.minY=r,this.maxY=n,this.rect=null,this.updateId=-1;}return hS(e,[{key:"setFromBounds",value:function value(e){return this.minX=e.minX,this.minY=e.minY,this.maxX=e.maxX,this.maxY=e.maxY,this;}},{key:"clear",value:function value(){return this.minX=OF,this.maxX=-1/0,this.minY=OF,this.maxY=-1/0,this;}},{key:"getRect",value:function value(e){var t=this.minX,i=this.minY,r=this.maxX,n=this.maxY;if(t>r||i>n)return new FL(0,0,0,0);var o=e||new FL();return o.update(t,i,r-t,n-i),o;}},{key:"addPoint",value:function value(e){return this.addBounds({minX:e.x,maxX:e.x,minY:e.y,maxY:e.y});}},{key:"addBounds",value:function value(e){var t=FF(this,e);return this.setFromBounds(t);}},{key:"addBoundsMask",value:function value(e,t){var i=WF(e,t);if(i.minX<=i.maxX&&i.minY<=i.maxY){var r=FF(i,this);this.setFromBounds(r);}return this;}},{key:"intersection",value:function value(t){if(r=t,!((i=this).minX<=r.maxX&&i.maxX>=r.minX&&i.minY<=r.maxY&&i.maxY>=r.minY))return null;var i,r,n=WF(this,t);return e.fromBounds(n);}},{key:"union",value:function value(t){var i=FF(this,t);return e.fromBounds(i);}},{key:"addBoundsArea",value:function value(e,t){var i=t.x,r=t.y,n={minX:i,minY:r,maxX:i+t.width,maxY:r+t.height};return this.addBoundsMask(e,n);}},{key:"addFrame",value:function value(e,t){return this.setFromTransformedBounds(e.worldTransform,t);}},{key:"setFromTransformedBounds",value:function value(e,t){for(var i=0;i<2;i++){var r=e.transformPoint({x:i?t.maxX:t.minX,y:i?t.maxY:t.minY});this.addPoint(r);}return this;}},{key:"addQuad",value:function value(e){for(var t=0;t<4;t++)this.addPoint({x:e[2*t],y:e[2*t+1]});}}],[{key:"isEmpty",value:function value(e){return e.minX===e.maxX&&e.minY===e.maxY;}},{key:"fromBounds",value:function value(t){return new e().setFromBounds(t);}},{key:"create",value:function value(){return new e();}}]);}();function WF(e,t){return{minX:e.minX>t.minX?e.minX:t.minX,minY:e.minY>t.minY?e.minY:t.minY,maxX:e.maxX<t.maxX?e.maxX:t.maxX,maxY:e.maxY<t.maxY?e.maxY:t.maxY};}function FF(e,t){return{minX:e.minX<t.minX?e.minX:t.minX,minY:e.minY<t.minY?e.minY:t.minY,maxX:e.maxX>t.maxX?e.maxX:t.maxX,maxY:e.maxY>t.maxY?e.maxY:t.maxY};}var HF=function(e){function t(){var e;return dS(this,t),sS(Kw(e=nO(this,t)),"defaultView",void 0),sS(Kw(e),"documentElement",void 0),sS(Kw(e),"timeLine",void 0),e.nodeName="document",e.documentElement=new uF({id:"root",style:{visibility:"visible"}}),e.documentElement.ownerDocument=Kw(e),e.documentElement.parentNode=Kw(e),e.childNodes=[e.documentElement],e;}return Qb(t,e),hS(t,[{key:"children",get:function get(){return this.childNodes;}},{key:"childElementCount",get:function get(){return this.childNodes.length;}},{key:"firstElementChild",get:function get(){return this.firstChild;}},{key:"lastElementChild",get:function get(){return this.lastChild;}},{key:"createElement",value:function value(e,t){var i=this.defaultView.customElements.get(e);return i||console.warn("Unsupported tagName: ",e),new i(t);}},{key:"getElementById",value:function value(e){return null;}},{key:"getElementsByName",value:function value(e){return this.documentElement.getElementsByTagName(e);}},{key:"getElementsByTagName",value:function value(e){return this.documentElement.getElementsByTagName(e);}},{key:"getElementsByClassName",value:function value(e){return this.documentElement.getElementsByClassName(e);}},{key:"append",value:function value(){var e;return(e=this.documentElement).append.apply(e,arguments);}},{key:"prepend",value:function value(){var e;return(e=this.documentElement).prepend.apply(e,arguments);}},{key:"querySelector",value:function value(e){return this.documentElement.querySelector(e);}},{key:"querySelectorAll",value:function value(e){return this.documentElement.querySelectorAll(e);}},{key:"find",value:function value(e){var t;return YP(t=this.documentElement).call(t,e);}},{key:"findAll",value:function value(e){return this.documentElement.findAll(e);}},{key:"appendChild",value:function value(e){return this.documentElement.appendChild(e);}},{key:"cloneNode",value:function value(e){return this.documentElement.cloneNode(e);}},{key:"insertBefore",value:function value(e,t){return this.documentElement.insertBefore(e,t);}},{key:"removeChild",value:function value(e){return this.documentElement.removeChild(e);}},{key:"replaceChild",value:function value(e,t){return this.documentElement.replaceChild(e,t);}},{key:"destroy",value:function value(){}}]);}(eF);function jF(e,t,i){i instanceof zF!=0&&e!==t&&(i.calculateTextPosition(),i.lineWrap(),i.saveCharPosition(),i.updateOrigin());}function XF(e,t,i){if(i instanceof DF!=0&&e!==t){var r=i.getBoundingRect(),n=r.x,o=r.y;i.updatePosition(n,o);}}function YF(e,t,i){if((i instanceof UF||i instanceof AF||i instanceof MF)&&e!==t){i.getPath();var r=i.getBoundingRect(),n=r.x,o=r.y;i.updatePosition(n,o),i.updateOrigin();}}function qF(e,t,i){i instanceof zF!=0&&e!==t&&(i.setFont(),i.calculateTextPosition(),i.lineWrap(),i.saveCharPosition(),i.updateOrigin());}function ZF(e,t,i){(i instanceof EF||i instanceof BF)&&e!==t&&i.updateOrigin();}function _F(e,t,i){if(i instanceof NF!=0&&e!==t){i.getPath();var r=i.getBoundingRect(),n=r.x,o=r.y;i.updatePosition(n,o),i.updateOrigin();}}function GF(e,t,i){i instanceof NF==0&&i instanceof AF==0||e!==t&&(i.getPath(),i.updateOrigin());}function KF(e,t,i){t&&(sF[e]=t),i&&(lF[e]||(lF[e]=[]),lF[e].push(i));}function $F(e,t,i){for(var r=0;r<e.length;r++)KF(e[r],t,i);}var JF=function(){return hS(function e(t){dS(this,e),sS(this,"contextService",void 0),sS(this,"renderingPlugins",[]),sS(this,"config",{autoRendering:!0}),cz(this.config,t);},[{key:"use",value:function value(e){var t;sE(t=this.renderingPlugins).call(t,e)<0&&this.renderingPlugins.push(e);}},{key:"initPlugins",value:function value(e){var t;pS(t=this.renderingPlugins).call(t,function(t){t.init(e);});}},{key:"destroyPlugins",value:function value(){var e;pS(e=this.renderingPlugins).call(e,function(e){e.destroy();});}},{key:"getPlugins",value:function value(){return this.renderingPlugins;}},{key:"getConfig",value:function value(){return this.config;}}]);}(),QF=function(){return hS(function e(t){dS(this,e),sS(this,"hooks",{init:mL.create(),beginFrame:mL.create(),beforeRender:mL.create(),render:mL.create(),afterRender:mL.create(),putImageData:mL.create(),endFrame:mL.create(),destroy:mL.create(),pointerdown:mL.create(),pointerup:mL.create(),pointermove:mL.create(),pointerout:mL.create(),pointerover:mL.create(),pointerCancel:mL.create(),wheel:mL.create()}),sS(this,"isInited",!1),sS(this,"zIndexCounter",0),sS(this,"renderingContext",void 0),this.renderingContext=t;},[{key:"init",value:function value(){this.hooks.init.emit(),this.isInited=!0;}},{key:"destroy",value:function value(){this.isInited=!1,this.hooks.destroy.emit();}},{key:"render",value:function value(){var e=this.renderingContext.root;this.zIndexCounter=0,QW.recursiveUpdateHierarchy(e),this.isInited&&(this.renderDisplayObject(e),this.renderingContext.dirty&&(this.hooks.endFrame.emit(),this.renderingContext.dirty=!1),this.renderingContext.renderCondition.clear());}},{key:"renderDisplayObject",value:function value(e){var t,i,r=this;if(e.isVisible){var n=e.sortable;if(n.renderOrder=this.zIndexCounter,this.zIndexCounter+=1,this.renderingContext.dirty||(this.renderingContext.dirty=!0,this.hooks.beginFrame.emit()),e.imageData)this.hooks.putImageData.emit(e);else{this.hooks.beforeRender.emit(e),this.hooks.render.emit(e),this.hooks.afterRender.emit(e);var o=!1;n.dirty&&(n.sorted=Yz(t=nE(i=e.childNodes).call(i)).call(t,eH),n.dirty=!1,o=!0);var a=n.sorted||e.childNodes;a.length>1&&Yz(a).call(a,function(e,t){return e.style.zIndex-t.style.zIndex;}),pS(a).call(a,function(e){r.renderDisplayObject(e);}),Yz(a).call(a,function(e,t){return e.index-t.index;}),o&&e.recursiveCall(function(e){var t=new ZW("renderOrderChanged",{renderOrder:e.sortable.renderOrder});e.dispatchEvent(t);});}}}},{key:"dirty",value:function value(){this.renderingContext.renderCondition.add(0);}}]);}();function eH(e,t){var i=Number(e.style.zIndex),r=Number(t.style.zIndex);if(i===r&&e.parentNode){var n=e.parentNode.childNodes,o=void 0===n?[]:n;return sE(o).call(o,e)-sE(o).call(o,t);}return i-r;}var tH=function(e){function t(e){var i;dS(this,t),sS(i=nO(this,t),"document",void 0),sS(i,"customElements",void 0),sS(i,"devicePixelRatio",void 0),sS(i,"eventService",void 0),sS(i,"renderingService",void 0),sS(i,"renderingContext",void 0),sS(i,"canvasConfig",void 0),sS(i,"renderer",void 0),sS(i,"supportTouchEvent",void 0),sS(i,"supportPointerEvent",void 0),sS(i,"contextService",void 0);var r=e.renderer,n=e.dpr,o=e.width,a=e.height,s=e.canvas,l=e.supportPointerEvent,u=e.supportTouchEvent;i.supportPointerEvent=null!=l?l:!!eR.PointerEvent,i.supportTouchEvent=null!=u?u:"touchstart"in window;var c=o,h=a,d=n;return s&&(d=n||window.devicePixelRatio||1,c=o||s.width/d,h=a||s.height/d),i.canvasConfig=uS(uS({},e),{},{width:c,height:h,dpr:d}),i.canvasConfig=e,i.renderer=r,i.document=new HF(),i.document.defaultView=i,i.initRenderingContext(),i.renderingService=new QF(i.renderingContext),i.initRenderer(r),i;}return Qb(t,e),hS(t,[{key:"initRenderingContext",value:function value(){var e=this;this.renderingContext={root:this.document.documentElement,force:!1,dirty:!1,renderCondition:new iA()},this.document.documentElement.addEventListener("child-inserted",function(t){e.mountChildren(t.detail.child);}),this.document.documentElement.addEventListener("child-removed",function(t){e.unmountChildren(t.detail.child);});}},{key:"initRenderer",value:function value(e){this.renderingService.init(),e.initPlugins(this),this.contextService.init(),e.getConfig().autoRendering&&this.render(),this.document.documentElement.recursiveCall(function(e){var t=e.renderable;t&&(t.boundsDirty=!0,t.renderBoundsDirty=!0);}),this.mountChildren(this.document.documentElement);}},{key:"render",value:function value(){var e=new ZW("beforeRender",{});this.dispatchEvent(e),this.contextService.clearCanvas(),this.renderingService.render();}},{key:"setDPR",value:function value(e){this.canvasConfig.dpr=e,this.contextService.setDPR(e);}},{key:"resize",value:function value(e,t){this.canvasConfig.width=e,this.canvasConfig.height=t,this.contextService.resize(e,t);}},{key:"getContextService",value:function value(){return this.contextService;}},{key:"getEventService",value:function value(){return this.eventService;}},{key:"appendChild",value:function value(e,t){return this.document.documentElement.appendChild(e,t);}},{key:"insertBefore",value:function value(e,t){return this.document.documentElement.insertBefore(e,t);}},{key:"removeChild",value:function value(e){return this.document.documentElement.removeChild(e);}},{key:"getBoundingClientRect",value:function value(){return this.contextService.getBoundingClientRect();}},{key:"mountChildren",value:function value(e){var t=this;e.recursiveCall(function(e){e.isConnected||(e.isConnected=!0,e.ownerDocument=t.document,e.dispatchEvent(new ZW("DOMNodeInsertedIntoDocument",{})));});}},{key:"unmountChildren",value:function value(e){var t,i=this,r=[];e.recursiveCall(function(e){e.isConnected&&r.push(e);}),pS(t=fR(r).call(r)).call(t,function(e){e.isConnected=!1,e.dispatchEvent(new ZW("DOMNodeRemovedFromDocument",{})),e!==i.document.documentElement&&(e.ownerDocument=null);});}}]);}(_W),iH=hS(function e(){dS(this,e);}),rH=function(e){function t(){var e,i;dS(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return sS(i=nO(this,t,BS(e=[]).call(e,n)),"close",!0),sS(i,"shape",void 0),sS(i,"ctx",void 0),i;}return Qb(t,e),hS(t,[{key:"render",value:function value(e,t){var i=e.parsedStyle,r=i.background,n=i.borderColor;if("hidden"!==i.visibility){this.renderPath(e,t);var o=!PO(r)&&!r.isNone,a=!PO(n)&&!n.isNone;o&&this.renderFill(e,t),a&&this.renderStroke(e,t);}}},{key:"renderPath",value:function value(e,t){var i;e.getPath(),t.beginPath(),pS(i=e.steps).call(i,function(e){dF(t,e);}),this.close&&e.steps.length>2&&t.closePath();}},{key:"renderFill",value:function value(e,t){var i=e.parsedStyle,r=i.background,n=i.opacity,o=i.fillOpacity;if(t.save(),t.globalAlpha=n*o,gS(r)){this.setShapeGradientOrigin(e,t);for(var a=0;a<r.length;a++)0===a&&this.setShadow(e,t),t.fillStyle=this.getColor(e,r[a],t),MP(t).call(t);}else this.setShadow(e,t),t.fillStyle=r.formatted,MP(t).call(t);t.restore();}},{key:"renderStroke",value:function value(e,t){var i=this,r=e.parsedStyle,n=r.borderWidth,o=r.borderColor,a=r.opacity,s=r.lineCap,l=r.lineJoin,u=r.miterLimit,c=r.lineDash,h=r.lineDashOffset,d=r.borderOpacity;n&&n.value>0&&(t.save(),PO(n)||(t.lineWidth=n.value),t.miterLimit=u,t.globalAlpha=a*d,t.lineCap=s,t.lineJoin=l,t.setLineDash(c),t.lineDashOffset=h.value,gS(o)?(this.setShapeGradientOrigin(e,t),pS(o).call(o,function(r){t.strokeStyle=i.getColor(e,r,t),t.stroke();})):(t.strokeStyle=o.formatted,t.stroke()),t.restore());}},{key:"setShadow",value:function value(e,t){var i=e.parsedStyle,r=i.shadow,n=i.shadowOffsetX,o=i.shadowOffsetY,a=i.shadowBlur,s=i.shadowColor;(r||s)&&(t.shadowOffsetX=(null==n?void 0:n.value)||r[0],t.shadowOffsetY=(null==o?void 0:o.value)||r[1],t.shadowBlur=(null==a?void 0:a.value)||r[2],t.shadowColor=(null==s?void 0:s.formatted)||r[3]);}},{key:"getColor",value:function value(e,t,i){var r;if(1===t.type||2===t.type){var n=e.getBoundingRect(),o=n.width,a=n.height;r=function(e,t){var i=e.type,r=e.steps,n=e.width,o=e.height,a=e.angle,s=e.cx,l=e.cy,u=e.size,c=null;if(1===i){var h=function(e,t,i){var r=i*Math.PI/180,n=0+e/2,o=0+t/2,a=Math.abs(e*Math.cos(r))+Math.abs(t*Math.sin(r));return{x1:n-Math.cos(r)*a/2,y1:o-Math.sin(r)*a/2,x2:n+Math.cos(r)*a/2,y2:o+Math.sin(r)*a/2};}(n,o,a.value),d=h.x1,f=h.y1,v=h.x2,g=h.y2;c=t.createLinearGradient(d,f,v,g);}else if(2===i){var m=function(e,t,i,r,n){var o=i.value,a=r.value;"%"===i.unit&&(o=i.value/100*e),"%"===r.unit&&(a=r.value/100*t);var s=Math.max(kO({x:0,y:0},{x:o,y:a}),kO({x:0,y:t},{x:o,y:a}),kO({x:e,y:t},{x:o,y:a}),kO({x:e,y:0},{x:o,y:a}));return n&&(gO(n)?s=n.value:bO(n)&&("closest-side"===n?s=Math.min(o,e-o,a,t-a):"farthest-side"===n?s=Math.max(o,e-o,a,t-a):"closest-corner"===n&&(s=Math.min(kO({x:0,y:0},{x:o,y:a}),kO({x:0,y:t},{x:o,y:a}),kO({x:e,y:t},{x:o,y:a}),kO({x:e,y:0},{x:o,y:a}))))),{x:o,y:a,r:s};}(n,o,s,l,u),y=m.x,p=m.y,w=m.r;c=t.createRadialGradient(y,p,0,y,p,w);}return c&&pS(r).call(r,function(e){var t,i=e.offset,r=e.color;"%"===i.unit&&(null===(t=c)||void 0===t||t.addColorStop(i.value/100,r.toString()));}),c;}(uS(uS({type:t.type},t.value),{},{width:o,height:a}),i);}return r;}},{key:"setShapeGradientOrigin",value:function value(e,t){var i=e.config.type,r=e.parsedStyle,n=r.r,o=r.rx,a=r.ry;switch(i){case"circle":case"arc":t.translate(0-n.value,0-n.value);break;case"ellipse":t.translate(0-o.value,0-a.value);break;default:t.translate(0,0);}}}]);}(iH),nH=function(e){function t(){var e;return dS(this,t),(e=nO(this,t)).close=!1,e;}return Qb(t,e),hS(t);}(rH),oH=function(e){function t(){return dS(this,t),nO(this,t,arguments);}return Qb(t,e),hS(t);}(rH),aH=function(e){function t(){return dS(this,t),nO(this,t,arguments);}return Qb(t,e),hS(t);}(rH),sH=function(e){function t(){return dS(this,t),nO(this,t,arguments);}return Qb(t,e),hS(t,[{key:"render",value:function value(e,t){var i=e.parsedStyle,r=i.width,n=i.height;i.src;var o=i.img,a=i.opacity;"hidden"!==i.visibility&&(bO(o)||o&&(t.save(),t.globalAlpha=a,o instanceof ImageData?t.putImageData(o,0,0):t.drawImage(o,0,0,r.value,n.value),t.restore()));}}]);}(rH),lH=function(e){function t(){var e;return dS(this,t),(e=nO(this,t)).close=!1,e;}return Qb(t,e),hS(t);}(rH),uH=function(e){function t(){var e;return dS(this,t),(e=nO(this,t)).close=!1,e;}return Qb(t,e),hS(t);}(rH),cH=function(e){function t(){return dS(this,t),nO(this,t,arguments);}return Qb(t,e),hS(t);}(rH),hH=function(e){function t(){return dS(this,t),nO(this,t,arguments);}return Qb(t,e),hS(t,[{key:"render",value:function value(e,t){var i=e.parsedStyle,r=i.background,n=i.borderColor;if("hidden"!==i.visibility){var o=!PO(r)&&!r.isNone,a=!PO(n)&&!n.isNone;e.getPath();for(var s=e.steps.length,l=0;l<s;l++){var u,c=e.steps[l];t.beginPath(),pS(u=c.step).call(u,function(e){dF(t,e);}),c.close&&(t.closePath(),o&&this.renderFill(e,t)),a&&this.renderStroke(e,t);}}}}]);}(rH),dH=function(e){function t(){return dS(this,t),nO(this,t,arguments);}return Qb(t,e),hS(t);}(rH),fH=function(e){function t(){return dS(this,t),nO(this,t,arguments);}return Qb(t,e),hS(t,[{key:"render",value:function value(e,t){e&&this.renderText(e,t);}},{key:"renderText",value:function value(e,t){var i,r=this,n=e.parsedStyle,o=e.lines,a=n.color,s=n.borderWidth,l=n.borderColor,u=n.textBaseLine,c=n.opacity,h=n.textAlign,d=n.lineDash,f=n.textMaxWidth,v=n.fillOpacity,g=n.borderOpacity,m=n.letterSpacing;e.setFont(),t.save(),a&&gS(a)?pS(a).call(a,function(i){t.fillStyle=r.getColor(e,i,t);}):t.fillStyle=a.formatted,l&&gS(l)?pS(l).call(l,function(i){t.strokeStyle=r.getColor(e,i,t);}):t.strokeStyle=l.formatted,this.setShadow(e,t),t.font=e.font,t.globalAlpha=c,t.lineWidth=null==s?void 0:s.value,t.textAlign=h,t.textBaseline=u,t.letterSpacing="".concat(m.value,"px"),t.setLineDash(d),t.beginPath();var y=(null===(i=o[0])||void 0===i?void 0:i.y)||0;pS(o).call(o,function(i){var n=i.text,o=i.y-y;n=e.transformText(n),a&&r.fillText(t,n,0,o,v,null==f?void 0:f.value),s&&s.value&&s.value>0&&r.strokeText(t,n,0,o,g,null==f?void 0:f.value);}),t.closePath(),t.restore();}},{key:"fillText",value:function value(e,t,i,r,n,o){var a,s=!PO(n)&&1!==n;s&&(a=e.globalAlpha,e.globalAlpha=n*n),e.fillText(t,i,r,o),s&&(e.globalAlpha=a);}},{key:"strokeText",value:function value(e,t,i,r,n,o){var a,s=!PO(n)&&1!==n;s&&(a=e.globalAlpha,e.globalAlpha=n),e.strokeText(t,i,r,o),s&&(e.globalAlpha=a);}}]);}(rH),vH=function(e){function t(){return dS(this,t),nO(this,t,arguments);}return Qb(t,e),hS(t);}(rH),gH=function(e){function t(){return dS(this,t),nO(this,t,arguments);}return Qb(t,e),hS(t,[{key:"render",value:function value(e,t){var i,r=this,n=e.parsedStyle,o=n.background,a=n.borderColor;if("hidden"!==n.visibility){var s=!PO(o)&&!o.isNone,l=!PO(a)&&!a.isNone;e.getPath(),t.beginPath();var u=e.steps.length,c=!0;pS(i=e.steps).call(i,function(i,n){for(var o=0;o<i.step.length;o++)dF(t,i.step[o]);i.close&&(c=!1,t.closePath(),s&&r.renderFill(e,t),l&&r.renderStroke(e,t)),i.close&&n<u-1&&(c=!0,t.beginPath());}),c&&l&&this.renderStroke(e,t);}}}]);}(rH),mH=function(){return hS(function e(t){dS(this,e),sS(this,"canvasConfig",void 0),sS(this,"container",void 0),sS(this,"canvas",void 0),sS(this,"dpr",void 0),sS(this,"context",void 0),sS(this,"shapeRenderers",{}),this.canvasConfig=t;},[{key:"init",value:function value(){var e=this.canvasConfig,t=e.container,i=e.canvas,r=e.dpr,n=e.willReadFrequently;if(i){this.canvas=i;var o=i.parentElement;t&&o!==t&&t.appendChild(i),this.container=o,this.canvasConfig.container=o;}else if(t&&(this.container=t,bO(t)&&(this.container=document.getElementById(t)),this.container)){var a=document.createElement("canvas");this.container.appendChild(a),this.canvas=a;}this.context=this.canvas.getContext("2d",{willReadFrequently:n}),this.dpr=r||hL(),this.resize(this.canvasConfig.width,this.canvasConfig.height);}},{key:"registerShapeRenderer",value:function value(e,t){this.shapeRenderers[e]||(this.shapeRenderers[e]=t);}},{key:"getShapeRenderer",value:function value(e){return this.shapeRenderers[e];}},{key:"destroy",value:function value(){var e=this.canvas,t=this.container;t&&(null==e?void 0:e.parentNode)&&t.removeChild(e);}},{key:"resize",value:function value(e,t){var i=this.canvas,r=this.dpr;i&&(i.width=e*r,i.height=t*r,i.style.width="".concat(e,"px"),i.style.height="".concat(t,"px"),this.context.scale(r,r));}},{key:"getDPR",value:function value(){return this.dpr;}},{key:"setDPR",value:function value(e){this.canvasConfig.dpr=e,this.dpr=e;}},{key:"getContext",value:function value(){return this.context;}},{key:"getDomElement",value:function value(){return this.canvas;}},{key:"getCanvas",value:function value(){return this.canvas;}},{key:"setCursor",value:function value(e){var t;(null==this||null===(t=this.container)||void 0===t?void 0:t.style)&&(this.container.style.cursor=e);}},{key:"getBoundingClientRect",value:function value(){var e;return null===(e=this.canvas)||void 0===e?void 0:e.getBoundingClientRect();}},{key:"clearCanvas",value:function value(){this.canvas&&(this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.scale(this.dpr,this.dpr));}}]);}(),yH=function(){return hS(function e(){dS(this,e),sS(this,"restoreStack",[]);},[{key:"init",value:function value(e){var t=this,i=e.renderingService.hooks;i.init.on(function(){}),i.destroy.on(function(){}),i.beginFrame.on(function(){}),i.endFrame.on(function(){var i,r=e.contextService.getContext();pS(i=t.restoreStack).call(i,function(){r.restore();}),t.restoreStack=[];}),i.render.on(function(i){t.renderDisplayObject(i,e);}),i.putImageData.on(function(t){if(t.imageData){var i=t.getPosition(),r=i.x,n=i.y,o=e.contextService.getContext(),a=e.contextService.getDPR();o.putImageData(t.imageData,Math.floor(r*a+1),Math.floor(n*a+1));}});}},{key:"renderDisplayObject",value:function value(e,t){if(e.isVisible){for(var i=t.contextService,r=i.getContext(),n=this.restoreStack[this.restoreStack.length-1];n&&e.parentNode!==n;)r.restore(),this.restoreStack.pop(),n=this.restoreStack[this.restoreStack.length-1];r.save(),this.applyTransform(r,e);var o=e.style.clipPath;o&&(r.save(),this.applyTransform(r,o),r.restore(),r.clip()),this.useAnchor(r,e);var a=i.getShapeRenderer(e.shapeType);a&&(a.render(e,r),e.clippable&&r.clip()),this.restoreStack.push(e);}}},{key:"applyTransform",value:function value(e,t){var i,r,n;t.externalMatrixes.length&&pS(i=fR(r=nE(n=t.externalMatrixes).call(n)).call(r)).call(i,function(t){var i=t.a,r=t.b,n=t.c,o=t.d,a=t.e,s=t.f;e.transform(i,r,n,o,a,s);});var o=t.getLocalTransform(),a=o.a,s=o.b,l=o.c,u=o.d,c=o.e,h=o.f;e.transform(a,s,l,u,c,h);}},{key:"applyAttributes",value:function value(e,t,i){}},{key:"useAnchor",value:function value(e,t){var i=(t.parsedStyle||{}).anchor;if(i&&(0!==i.x||0!==i.y)){var r=t.getGeometryBounds().getRect();e.translate(-(i&&i.x||0)*r.width,-(i&&i.y||0)*r.height);}}},{key:"destroy",value:function value(){}}]);}();sS(yH,"moduleName",void 0);var pH=function(){return hS(function e(){dS(this,e);},[{key:"init",value:function value(e){var t,i=new mH(e.canvasConfig);e.contextService=i,pS(t=[{name:"arc",renderer:new nH()},{name:"circle",renderer:new oH()},{name:"ellipse",renderer:new aH()},{name:"freeline",renderer:new gH()},{name:"image",renderer:new sH()},{name:"line",renderer:new lH()},{name:"path",renderer:new uH()},{name:"polygon",renderer:new cH()},{name:"polyline",renderer:new hH()},{name:"rect",renderer:new dH()},{name:"stampPath",renderer:new vH()},{name:"text",renderer:new fH()}]).call(t,function(e){var t=e.name,r=e.renderer;i.registerShapeRenderer(t,r);});}},{key:"destroy",value:function value(){}}]);}(),wH=function(e){function t(e){var i;return dS(this,t),(i=nO(this,t,[e])).use(new pH()),i.use(new yH()),i;}return Qb(t,e),hS(t);}(JF),bH=function(e){function t(e){var i;return dS(this,t),sS(Kw(i=nO(this,t,[e])),"name",void 0),sS(Kw(i),"type",void 0),sS(Kw(i),"owners",[]),sS(Kw(i),"isDestroyed",!1),i.name=e.name,i.type=e.type,i.children=e.children||[],i;}return Qb(t,e),hS(t,[{key:"destroy",value:function value(){this.isDestroyed||(this.children=null,this.owners=null,this.isDestroyed=!0);}},{key:"count",value:function value(){return this.children.length;}},{key:"addOwner",value:function value(e){var t=this.owners;return sE(t).call(t,e)<0&&(t.push(e),!0);}},{key:"removeOwner",value:function value(e){var t=this.owners,i=sE(t).call(t,e);return!(i<0||(NE(t).call(t,i,1),0));}}]);}(jL),kH=function(){return hS(function e(t){dS(this,e),sS(this,"docs",[]),sS(this,"isDestroyed",!1),this.docs=[];},[{key:"destroy",value:function value(){var e;this.isDestroyed||(pS(e=this.docs).call(e,function(e){e.destroy();}),this.docs=[],this.isDestroyed=!0);}},{key:"addDoc",value:function value(e,t){var i=this.getDoc(e.uid);return i||(i=new bH(e),this.docs.push(i)),t&&i.addOwner(t),i;}},{key:"getDoc",value:function value(e){var t;return YP(t=this.docs).call(t,function(t){return t.uid===e;});}},{key:"getIndexByUid",value:function value(e){var t;return KE(t=this.docs).call(t,function(t){return t.uid===e;});}},{key:"removeDoc",value:function value(e){var t,i=this.getIndexByUid(e);return i>-1&&(NE(t=this.docs).call(t,i,1),!0);}},{key:"removePage",value:function value(e,t){var i=this.getDoc(e);return!!i&&i.remove(t);}}]);}(),SH=function(){return hS(function e(){dS(this,e),sS(this,"canvas",void 0),sS(this,"renderer",void 0),sS(this,"root",void 0),this.renderer=new wH(),this.canvas=new tH({renderer:this.renderer,width:10,height:10,canvas:document.createElement("canvas"),dpr:1,willReadFrequently:!0}),this.root=this.canvas.document.documentElement;},[{key:"render",value:function value(e){var t,i,r=this;pS(t=nE(i=this.root.children).call(i)).call(t,function(e){r.root.removeChild(e);}),this.root.appendChild(e),this.canvas.resize(e.width,e.height),this.canvas.render();}},{key:"clear",value:function value(){var e,t,i=this;pS(e=nE(t=this.root.children).call(t)).call(e,function(e){i.root.removeChild(e);}),this.root.sortable.sorted=[];}},{key:"getCanvas",value:function value(){return this.canvas.contextService.getDomElement();}}]);}(),xH=function(){return hS(function e(){dS(this,e),sS(this,"viewers",void 0),sS(this,"group",{}),sS(this,"isDestroyed",!1),this.viewers=[];},[{key:"destroy",value:function value(){this.isDestroyed||(this.viewers=[],this.viewers=null,this.group=null,this.isDestroyed=!0);}},{key:"addViewer",value:function value(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(sE(t=this.viewers).call(t,e)>-1)return!1;var r=[];return this.group[i]?r=this.group[i]:this.group[i]=r,r.push(e.uid),this.viewers.push(e),!0;}},{key:"removeViewer",value:function value(e){var t,i,r=KE(t=this.viewers).call(t,function(t){return t.uid===e.uid;});if(r<0)return!1;var n=this.group[e.groupUid],o=sE(n).call(n,e.uid);return NE(n).call(n,o,1),0===n.length&&delete this.group[e.groupUid],NE(i=this.viewers).call(i,r,1),e.destroy(),!0;}},{key:"getViewer",value:function value(e){var t=this.viewers;return e?YP(t).call(t,function(t){return t.uid===e;}):t[0]||null;}},{key:"getAllViewers",value:function value(){var e;return nE(e=this.viewers).call(e);}},{key:"getGroup",value:function value(e){var t=this.getViewer(e);return t?this.group[t.groupUid]:null;}}]);}();function CH(){onmessage=function onmessage(e){var t=e.data.core,i=e.data.sourceWidth,r=e.data.sourceHeight,n=e.data.width,o=e.data.height,a=e.data.source.data,s=n*o*4,l=new ArrayBuffer(s),u=null;try{u=new Uint8ClampedArray(l,0,s);}catch(e){u=new Uint8Array(l,0,s);}l=null;for(var c=0;c<o;c++)for(var h=c*r/o,d=Math.floor(h),f=1-(h-d),v=d,g=(c+1)*r/o,m=Math.floor(g-1e-5),y=g-m,p=m,w=c*n*4,b=0;b<n;b++){var k=b*i/n,S=Math.floor(k),x=1-(k-S),C=S,V=(b+1)*i/n,T=Math.floor(V-1e-5),I=V-T,E=T,P=0,B=0,D=0,M=0,U=0,A=255,z=void 0,R=void 0,N=(v+1)*i*4+4*C;for(z=v+1;z<p;++z){var O=A;P+=a[N+2]*x*O,B+=a[N+1]*x*O,D+=a[N]*x*O,M+=a[N+3]*x*O,U+=A*x,N+=4*i;}var L=(v+1)*i*4+4*E;for(z=v+1;z<p;++z){var W=A;P+=a[L+2]*I*W,B+=a[L+1]*I*W,D+=a[L]*I*W,M+=a[L+3]*I*W,U+=A*I,L+=4*i;}var F=v*i*4+4*(C+1);for(R=C+1;R<E;++R){var H=A;P+=a[F+2]*f*H,B+=a[F+1]*f*H,D+=a[F]*f*H,M+=a[F+3]*f*H,U+=A*f,F+=4;}var j=p*i*4+4*(C+1);for(R=C+1;R<E;++R){var X=A;P+=a[j+2]*y*X,B+=a[j+1]*y*X,D+=a[j]*y*X,M+=a[j+3]*y*X,U+=A*y,j+=4;}for(z=v+1;z<p;++z){var Y=z*i*4+4*(C+1);for(R=C+1;R<E;++R){var q=A;P+=a[Y+2]*q,B+=a[Y+1]*q,D+=a[Y]*q,M+=a[Y+3]*q,U+=q,Y+=4;}}var Z=v*i*4+4*C,_=A;P+=a[Z+2]*(f*x)*_,B+=a[Z+1]*(f*x)*_,D+=a[Z]*(f*x)*_,M+=a[Z+3]*(f*x)*_,U+=A*(f*x);var G=A;P+=a[(Z=v*i*4+4*E)+2]*(f*I)*G,B+=a[Z+1]*(f*I)*G,D+=a[Z]*(f*I)*G,M+=a[Z+3]*(f*I)*G,U+=A*(f*I);var K=A;P+=a[(Z=p*i*4+4*C)+2]*(y*x)*K,B+=a[Z+1]*(y*x)*K,D+=a[Z]*(y*x)*K,M+=a[Z+3]*(y*x)*K,U+=A*(y*x);var $=A;P+=a[(Z=p*i*4+4*E)+2]*(y*I)*$,B+=a[Z+1]*(y*I)*$,D+=a[Z]*(y*I)*$;var J=(M+=a[Z+3]*(y*I)*$)/(U+=A*(y*I)),Q=0,ee=0,te=0;0!==J&&(Q=P/U,ee=B/U,te=D/U),Q+=.5,ee+=.5,te+=.5,J+=.5,u[w]=Math.floor(te),u[w+=1]=Math.floor(ee),u[w+=1]=Math.floor(Q),u[w+=1]=Math.floor(J),w+=1;}var ie={core:t,target:u,taskUid:e.data.taskUid,callbackId:e.data.callbackId};try{postMessage(ie,[u.buffer]);}catch(e){postMessage(ie,null);}u=null,ie=null,a=null,e=null;};}var VH=function(){return hS(function e(t,i,r){var n=this;dS(this,e),sS(this,"worker",void 0),sS(this,"id",void 0),sS(this,"manager",void 0),sS(this,"callbacks",{}),sS(this,"busy",!1),sS(this,"counter",0),sS(this,"tasks",[]),this.worker=t,this.id=i,this.manager=r,this.worker.addEventListener("message",function(e){n.onMessage(e);},!1);},[{key:"setBusy",value:function value(e){if(this.busy=e,!e)if(this.tasks.length){var t=this.tasks.pop();this.send(t);}else this.worker.terminate(),this.manager.removeActor(this);}},{key:"isBusy",value:function value(){return this.busy;}},{key:"getWorker",value:function value(){return this.worker;}},{key:"onMessage",value:function value(e){this.setBusy(!1);var t=e.data.callbackId,i=t?this.callbacks[t]:null;i&&i(e.data),delete this.callbacks[t];}},{key:"send",value:function value(e,t){var i,r;if(this.busy)this.tasks.push(uS({},e));else{this.setBusy(!0);var n=BS(i=BS(r="".concat(this.id,"-")).call(r,e.action,"-cb-")).call(i,this.counter);e.callback&&(this.callbacks[n]=e.callback,this.counter+=1),e.callbackId=n;var o=uS(uS({},e.handler()),{},{callbackId:n});(t=o.source)?this.worker.postMessage(o,[t.data.buffer]):this.worker.postMessage(o);}}},{key:"cancel",value:function value(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];pS(t).call(t,function(t){var i,r=KE(i=e.tasks).call(i,function(e){return e.taskUid===t;});if(r>-1){var n,o=NE(n=e.tasks).call(n,r,1)[0];e.callbacks[o.callbackId]&&delete e.callbacks[o.callbackId];}});}}]);}(),TH=function(){return hS(function e(t,i){dS(this,e),sS(this,"concurrency",1),sS(this,"actors",[]),sS(this,"workerUrl",void 0),this.workerUrl=t,this.concurrency=i;},[{key:"send",value:function value(e,t){this.getActor().send(e,t);}},{key:"getActor",value:function value(){var e,t=Ox(e=this.actors).call(e,function(e){return!e.isBusy();})[0];if(t)return t;if(this.actors.length<this.concurrency){var i=new Worker(this.workerUrl),r=new VH(i,this.actors.length,this);return this.actors.push(r),r;}var n=Math.floor(Math.random()*this.concurrency);return this.actors[n];}},{key:"removeActor",value:function value(e){var t,i,r=sE(t=this.actors).call(t,e);NE(i=this.actors).call(i,r,1);}},{key:"clear",value:function value(){var e,t=Lf(this.actors);try{for(t.s();!(e=t.n()).done;){e.value.getWorker().terminate();}}catch(e){t.e(e);}finally{t.f();}this.actors=[];}},{key:"cancel",value:function value(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=Lf(this.actors);try{for(i.s();!(e=i.n()).done;){e.value.cancel(t);}}catch(e){i.e(e);}finally{i.f();}var r,n=Lf(this.actors);try{for(n.s();!(r=n.n()).done;){r.value.setBusy(!1);}}catch(e){n.e(e);}finally{n.f();}}}]);}(),IH=function(){return hS(function e(){dS(this,e);},[{key:"apply",value:function value(e){this.listenSpaceHooks(e),this.listenDVSHooks(e);}},{key:"listenDVSHooks",value:function value(e){var t=this,i=e.hooksService.hooks,r=function r(t){var i=e.spaceService.space;t.trigger!==i.uid&&i.removeSource(t.removedUids);},n=function n(t){var i=e.spaceService.space;t.trigger!==i.uid&&i.move(uS({emit:!1},t));},o=function o(t){var i=e.spaceService.space;t.trigger!==i.uid&&i.switch(uS({emit:!1},t));},a=function a(t){var i=e.spaceService.space;t.trigger!==i.uid&&i.reorder(uS({emit:!1},t));},s=function s(){t.listenSpaceHooks(e);};i.remove.on(r),i.move.on(n),i.switch.on(o),i.reorder.on(a),i.afterSetSpace.on(s),e.hooksService.hooks.destroy.on(function(){i.remove.off(r),i.move.off(n),i.switch.off(o),i.reorder.off(a),i.afterSetSpace.off(s);});}},{key:"listenSpaceHooks",value:function value(e){var t=e.spaceService.space.hooks,i=e.hooksService.hooks,r=function r(e){var t=e.uid;i.removeDoc.emit(t);},n=function n(e){var t=e.name,r=e.uid;i.renameDoc.emit(t,r);},o=function o(t){var i=t.node,r=t.config,n=t.type;e.viewerService.openDoc(i,n,null==r?void 0:r.viewerUid);},a=function a(e){i.appendPagesToDoc.emit(e);},s=function s(e){i.removePagesFromDoc.emit(e);},l=function l(e){i.afterUpdate.emit(e);},u=function u(e){i.remove.emit(e);},c=function c(e){i.switch.emit(e);},h=function h(e){i.move.emit(e);},d=function d(e){i.reorder.emit(e);};t.removeDoc.on(r),t.renameDoc.on(n),t.openDoc.on(o),t.loadToDoc.on(a),t.removeFromDoc.on(s),t.afterUpdateSource.on(l),t.afterRemoveSource.on(u),t.switch.on(c),t.move.on(h),t.reorder.on(d);var _f2=function f(){t.removeDoc.off(r),t.renameDoc.off(n),t.openDoc.off(o),t.loadToDoc.off(a),t.removeFromDoc.off(s),t.afterUpdateSource.off(l),t.afterRemoveSource.off(u),t.switch.off(c),t.move.off(h),t.reorder.off(d),e.spaceService.space.hooks.destroy.off(_f2),e.hooksService.hooks.afterSetSpace.off(_f2);};e.spaceService.space.hooks.destroy.on(_f2),e.hooksService.hooks.afterSetSpace.on(_f2);}}]);}(),EH=function(){return hS(function e(){dS(this,e);},[{key:"apply",value:function value(e){this.listenDVSHooks(e);}},{key:"listenDVSHooks",value:function value(e){var t=e.hooksService.hooks,i=function i(t){var i=e.viewerService.getDoc(t.docUid);i&&i.move(t.from,t.to);},r=function r(t){var i=e.viewerService.getDoc(t.docUid);i&&i.switch(t.one,t.other);},n=function n(t){var i=e.viewerService.getDoc(t.docUid);i&&i.reorder(t.indexes);},o=function o(t,i){var r=e.viewerService.getDoc(t);r&&r.removeOwner(i);},a=function a(t){var i=t.uid;e.viewerService.removeDoc(i);},s=function s(t){var i=t.name,r=t.uid;e.viewerService.renameDoc(i,r);},l=function l(t){e.viewerService.appendImagesToDoc(t.docUid,t.sourceUids,t.index);},u=function u(t){e.viewerService.removePagesFromDoc(t.docUid,t.sourceUids);},_c2=function c(){e.viewerService.destroy(),t.move.off(i),t.switch.off(r),t.reorder.off(n),t.removeTab.off(o),t.removeDoc.off(a),t.renameDoc.off(s),t.appendPagesToDoc.off(l),t.removePagesFromDoc.off(u),t.destroy.off(_c2);};t.move.on(i),t.switch.on(r),t.reorder.on(n),t.removeTab.on(o),t.removeDoc.on(a),t.renameDoc.on(s),t.appendPagesToDoc.on(l),t.removePagesFromDoc.on(u),t.destroy.on(_c2);}}]);}(),PH=function(){return hS(function e(t){dS(this,e),sS(this,"context",void 0),sS(this,"errorMessage","ok"),sS(this,"errorCode",0),this.context=t;},[{key:"updateErrorMessage",value:function value(e){this.errorMessage=e.message,this.errorCode=e.code;}},{key:"err",value:function value(e){this.errorMessage=e.message,this.errorCode=e.code;}},{key:"destroy",value:function value(){this.errorMessage="",this.errorCode=null;}}]);}(),BH=hS(function e(t){dS(this,e),sS(this,"context",void 0),sS(this,"hooks",{init:mL.create(),destroy:mL.create(),beforeLoad:mL.create(),load:mL.create(),afterLoad:mL.create(),beforeRemove:mL.create(),remove:mL.create(),afterRemove:mL.create(),beforeUpdate:mL.create(),update:mL.create(),afterUpdate:mL.create(),move:mL.create(),switch:mL.create(),reorder:mL.create(),appendPagesToDoc:mL.create(),removePagesFromDoc:mL.create(),removeDoc:mL.create(),renameDoc:mL.create(),openDoc:mL.create(),beforeChangeBuffer:mL.create(),afterChangeBuffer:mL.create(),changePage:mL.create(),selectPage:mL.create(),beforeRender:mL.create(),render:mL.create(),afterRender:mL.create(),createViewer:mL.create(),removeViewer:mL.create(),afterLoadImage:mL.create(),error:mL.create(),log:mL.create(),rotate:mL.create(),scale:mL.create(),flip:mL.create(),mirror:mL.create(),crop:mL.create(),erase:mL.create(),changeSize:mL.create(),reset:mL.create(),overlay:mL.create(),beforeUndo:mL.create(),undo:mL.create(),beforeRedo:mL.create(),redo:mL.create(),layout:mL.create(),beforeSetSpace:mL.create(),afterSetSpace:mL.create(),focusChanged:mL.create(),checkVisibility:mL.create(),removeTab:mL.create()}),this.context=t;}),DH=function(){return hS(function e(t){dS(this,e),sS(this,"imagePool",{}),sS(this,"tasks",[]),sS(this,"loaders",3),sS(this,"loadTimer",null),sS(this,"context",void 0),sS(this,"isDestroyed",!1),this.context=t;},[{key:"destroy",value:function value(){this.context=null,this.tasks=[],this.loaders=0,this.isDestroyed=!0;}},{key:"checkVisibility",value:function value(e){return this.context.viewerService.isPageNeedLoad(e);}},{key:"load",value:function value(e){var t,i=this,r=this.context.spaceService.getStatus(e);r&&!r.isLoading&&(sE(t=this.tasks).call(t,e)<0&&(this.tasks.push(e),this.loading()),this.loadTimer||(this.loadTimer=XL.createTimer(function(){i.loading();},20)));}},{key:"loading",value:function value(){if(this.loaders>0)if(this.tasks.length)for(;this.tasks.length;){var e=this.tasks.pop();if(this.context.viewerService.isPageNeedLoad(e).ori&&(this.loaders-=1,this.run(e).catch(function(){})),this.loaders<1)break;}else this.loadTimer&&(XL.clearTimer(this.loadTimer),this.loadTimer=null);}},{key:"run",value:(t=Gw(iO().m(function e(t){var i,r,n,o,a,s,l,u,c,h,d;return iO().w(function(e){for(;;)switch(e.n){case 0:if(i=this.context,r=i.spaceService,n=i.hooksService,o=i.viewerService,!(a=r.getStatus(t))){e.n=20;break;}if(a.isLoading=!0,s=AO(),a.oriTask=s,a.oriData){e.n=12;break;}return e.n=1,r.getOriginalData(t);case 1:if(l=e.v,a.oriTask===s){e.n=3;break;}return e.n=2,this.run(t);case 2:return e.a(2,void e.v);case 3:if(o.isPageNeedLoad(t).ori){e.n=4;break;}return e.a(2,(this.loaders+=1,void(a.isLoading=!1)));case 4:if(l&&l.oriData){e.n=8;break;}if(u=r.getExternalImageLoader()){e.n=5;break;}return e.a(2,(this.loaders+=1,void(a.isLoading=!1)));case 5:return e.n=6,u.getImage(t);case 6:if(c=e.v){e.n=7;break;}return e.a(2,(this.loaders+=1,void(a.isLoading=!1)));case 7:l.oriData=c,r.updateOriginalData(t,l);case 8:if(h="",10!==document.documentMode){e.n=10;break;}return e.n=9,this.convertData(l.oriData);case 9:h=e.v.data,e.n=11;break;case 10:h=cL(l.oriData).data;case 11:a.oriData=h;case 12:if(a.img&&(!a.img||a.img.src===a.oriData)){e.n=19;break;}if(!this.isDestroyed){e.n=13;break;}return e.a(2);case 13:return e.n=14,this.loadImage(a.oriData);case 14:if(d=e.v){e.n=15;break;}return e.a(2,(this.loaders+=1,void(a.isLoading=!1)));case 15:if(a.oriTask===s){e.n=17;break;}return e.n=16,this.run(t);case 16:return e.a(2,void e.v);case 17:if(o.isPageNeedLoad(t).ori){e.n=18;break;}return e.a(2,(this.loaders+=1,void(a.isLoading=!1)));case 18:a.img=d;case 19:a.isLoading=!1,n.hooks.afterLoadImage.emit(t,"ori");case 20:this.loaders+=1;case 21:return e.a(2);}},e,this);})),function(e){return t.apply(this,arguments);})},{key:"convertData",value:function value(e){return new BB(function(t,i){if(gO(e))t(e);else{var r=new XMLHttpRequest();r.onload=function(){var e=cL(r.response);t(e);},r.open("GET",e,!0),r.responseType="blob",r.send();}});}},{key:"loadImage",value:(e=Gw(iO().m(function e(t){return iO().w(function(e){for(;;)if(0===e.n)return e.a(2,new BB(function(e,i){var r=new Image();r.crossOrigin="Anonymous",r.onload=function(){r.onload=null,r.onerror=null,e(r);},r.onerror=function(t){r.onload=null,r.onerror=null,e(null);},r.src=t;}));},e);})),function(t){return e.apply(this,arguments);})}]);var e,t;}(),MH=function(){return hS(function e(t){dS(this,e),sS(this,"imagePool",{}),sS(this,"tasks",[]),sS(this,"loaders",3),sS(this,"loadTimer",null),sS(this,"context",void 0),sS(this,"isDestroyed",!1),this.context=t;},[{key:"destroy",value:function value(){this.context=null,this.tasks=[],this.loaders=0,this.isDestroyed=!0;}},{key:"checkVisibility",value:function value(e){return this.context.viewerService.isPageNeedLoad(e);}},{key:"load",value:function value(e){var t,i=this,r=this.context.spaceService.getStatus(e);r&&!r.isMinLoading&&(sE(t=this.tasks).call(t,e)<0&&(this.tasks.push(e),this.loading()),this.loadTimer||(this.loadTimer=XL.createTimer(function(){i.loading();},20)));}},{key:"loading",value:function value(){if(this.loaders>0)if(this.tasks.length)for(;this.tasks.length;){var e=this.tasks.pop();if(this.context.viewerService.isPageNeedLoad(e).min&&(this.loaders-=1,this.run(e).catch(function(){})),this.loaders<1)break;}else this.loadTimer&&(XL.clearTimer(this.loadTimer),this.loadTimer=null);}},{key:"run",value:(t=Gw(iO().m(function e(t){var i,r,n,o,a,s,l,u,c,h,d,f;return iO().w(function(e){for(;;)switch(e.n){case 0:if(i=this.context,r=i.spaceService,n=i.hooksService,o=i.viewerService,!(a=r.getStatus(t))){e.n=13;break;}if(a.isMinLoading=!0,s=AO(),a.minTask=s,a.minData){e.n=5;break;}return e.n=1,r.getOriginalData(t);case 1:if(l=e.v,a.minTask===s){e.n=3;break;}return e.n=2,this.run(t);case 2:return e.a(2,void e.v);case 3:if(o.isPageNeedLoad(t).min){e.n=4;break;}return e.a(2,(this.loaders+=1,void(a.isMinLoading=!1)));case 4:u=cL(l.minData||l.oriData).data,a.minData=u;case 5:if(a.minImg&&(!a.minImg||a.minImg.src===a.minData)){e.n=12;break;}if(!this.isDestroyed){e.n=6;break;}return e.a(2);case 6:return c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;try{var i=new tE(e),r=i.searchParams.get("width"),n=i.searchParams.get("height");if(!r||!n)return e;var o=px(r,10)*t,a=px(n,10)*t;return o<0||a<0||o>2e3||a>2e3?e:(i.searchParams.set("width",String(Math.floor(o))),i.searchParams.set("height",String(Math.floor(a))),i.toString());}catch(t){return e;}}(a.minData),e.n=7,this.loadImage(c);case 7:if(h=e.v){e.n=8;break;}return e.a(2,(this.loaders+=1,void(a.isMinLoading=!1)));case 8:if(a.minTask===s){e.n=10;break;}return e.n=9,this.run(t);case 9:return e.a(2,void e.v);case 10:if(o.isPageNeedLoad(t).min){e.n=11;break;}return e.a(2,(this.loaders+=1,void(a.isMinLoading=!1)));case 11:a.minImg=h,(d=r.space.getMetadata(t))&&(f=d.height/h.naturalHeight,a.imageScale=f);case 12:a.isMinLoading=!1,n.hooks.afterLoadImage.emit(t,"min");case 13:this.loaders+=1;case 14:return e.a(2);}},e,this);})),function(e){return t.apply(this,arguments);})},{key:"loadImage",value:(e=Gw(iO().m(function e(t){return iO().w(function(e){for(;;)if(0===e.n)return e.a(2,new BB(function(e,i){var r=new Image();r.crossOrigin="Anonymous",r.onload=function(){r.onload=null,r.onerror=null,e(r);},r.onerror=function(t){r.onload=null,r.onerror=null,e(null);},r.src=t;}));},e);})),function(t){return e.apply(this,arguments);})}]);var e,t;}(),UH=function(){return hS(function e(t){dS(this,e),sS(this,"context",void 0),this.context=t;},[{key:"getImageData",value:(e=Gw(iO().m(function e(t,i){var r=this;return iO().w(function(e){for(;;)if(0===e.n)return e.a(2,new BB(function(e,n){var o=r.context.spaceService.getStatus(t);o||n(new Error("The page is not exist."));var _a2=function a(n,s){if("min"!==s&&n===t&&o.isSaving){o.isSaving=!1,r.context.hooksService.hooks.afterLoadImage.off(_a2);var l=o.img.naturalWidth,u=o.img.naturalHeight,c=[],h=[];if(r.context.editService){var d={operations:o.operations,width:o.img.naturalWidth,height:o.img.naturalHeight},f=r.context.editService.handle(d);l=f.width,u=f.height,c=f.matrixes,h=f.blanks;}var v=new BF({style:{x:0,y:0,img:o.img,width:o.img.naturalWidth,height:o.img.naturalHeight}});v.externalMatrixes=c;var g=new EF({style:{x:0,y:0,width:l,height:u,background:"#fff"}}),m=new EF();pS(h).call(h,function(e){var t=new UF({id:e.uid,style:{background:e.background,points:e.points,borderWidth:0}});m.appendChild(t);}),v.appendChild(m),g.appendChild(v),r.context.commonCanvas.render(g),r.context.commonCanvas.clear();var y=r.context.commonCanvas.getCanvas(),p=(null==i?void 0:i.type)||"imageData",w=(null==i?void 0:i.mime)||"image/png",b=(null==i?void 0:i.mime)||1,k=Math.max(l,u)||1;if(null!=i&&i.min&&k>720){var S=720/k,x=S*l,C=S*u,V=document.createElement("canvas");V.width=x,V.height=C;var T=V.getContext("2d",{willReadFrequently:!0});if(T.drawImage(y,0,0,Math.floor(l),Math.floor(u),0,0,x,C),"imageData"===p){var I=T.getImageData(0,0,x,C);e(I);}else"blob"===p&&V.toBlob(function(t){e(t);},w,b);}else if("imageData"===p){var E=y.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,l,u);e(E);}else"blob"===p&&y.toBlob(function(t){e(t);},w,b);}};r.context.hooksService.hooks.afterLoadImage.on(_a2),o.isSaving=!0,r.context.imageService.load(t);}));},e);})),function(t,i){return e.apply(this,arguments);})}]);var e;}(),AH=function(){return hS(function e(t,i){dS(this,e),sS(this,"context",void 0),sS(this,"iSpace",void 0),this.context=t,this.iSpace=i||new uW();},[{key:"space",get:function get(){return this.iSpace;}},{key:"setSpace",value:function value(e){this.iSpace=e;}},{key:"getStatus",value:function value(e){return this.space.statusStore.get(e);}},{key:"getOriginalData",value:function value(e){return this.space.store.get(e);}},{key:"updateOriginalData",value:function value(e,t){return this.space.store.update(e,t);}},{key:"removeOriginalData",value:function value(e){return this.space.store.remove(e);}},{key:"getExternalImageLoader",value:function value(){return this.space.imageLoader;}},{key:"destroy",value:function value(){this.iSpace.destroy(),this.iSpace=null;}}]);}();function zH(e){var t;return BS(t="".concat(wO()," DVS: ")).call(t,e);}var RH=function(){return hS(function e(t){dS(this,e),sS(this,"context",void 0),sS(this,"logs",[]),sS(this,"enableLog",!0),this.context=t,this.logs.push(zH("Initialize Log object."));},[{key:"updateLogMessage",value:function value(e){this.enableLog&&(null==this||this.logs.push(zH(e)));}},{key:"log",value:function value(e){this.enableLog&&(null==this||this.logs.push(zH(e)));}},{key:"clear",value:function value(){this.logs=[];}},{key:"destroy",value:function value(){this.logs=null;}}]);}(),NH=function(){return hS(function e(t){dS(this,e),sS(this,"context",void 0),sS(this,"docManager",void 0),sS(this,"viewerManager",void 0),sS(this,"isDestroyed",!1),sS(this,"scrollbarWidth",0),this.context=t,this.docManager=new kH(),this.viewerManager=new xH(),this.getScrollbarWidth();},[{key:"isPageNeedLoad",value:function value(e){for(var t={ori:!1,min:!1},i=this.viewerManager.getAllViewers(),r=0,n=i.length;r<n;r++){var o=this.context.spaceService.getStatus(e);o&&o.isSaving&&(t.ori=!0);var a=i[r].checkPageVisibility(e);a.min&&(t.min=!0),a.ori&&(t.ori=!0);}return t;}},{key:"destroy",value:function value(){var e,t=this;this.isDestroyed||(pS(e=this.viewerManager.getAllViewers()).call(e,function(e){return t.removeViewer(e);}),this.docManager.destroy(),this.docManager=null,this.isDestroyed=!0);}},{key:"createViewer",value:function value(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=null,r=null,n=t.syncViewerUid;if(n){if(!(r=this.getViewer(n)))return this.context.errorService.err(cO),null;i=r.groupUid;}else i=AO();var o=vL.create(),a=this.context;o.save();var s,l=uS(uS({},t),{},{groupUid:i,emitter:o,dvsContext:a}),u=new a.dvs.subClasses.Viewer(l),c=u.uid;(o.restore(),this.context.hooksService.hooks.createViewer.emit({viewer:u}),this.viewerManager.addViewer(u,i),r)&&(pS(s=r.getAllTabs()).call(s,function(t){var i;pS(i=t.allPages).call(i,function(t){var i=e.context.spaceService.getStatus(t.uid);i&&i.addOwner(c);}),e.docManager.getDoc(t.uid).addOwner(c);}),u.context.syncFromViewer(r));return this.context.trackerService.log("Invoking ViewerController#createViewer."),u;}},{key:"removeViewer",value:function value(e){var t,i=this;if(!e)return!1;var r=e;return bO(e)&&(r=this.viewerManager.getViewer(e)),!!r&&(this.viewerManager.removeViewer(r),pS(t=this.docManager.docs).call(t,function(e){var t;e.removeOwner(r.uid)&&pS(t=e.children).call(t,function(e){var t=i.context.spaceService.getStatus(e);t&&t.removeViewer(r.uid);});}),this.context.trackerService.log("Invoking ViewerController#removeViewer."),!0);}},{key:"getViewer",value:function value(e){return this.viewerManager.getViewer(e);}},{key:"openDoc",value:function value(e,t,i){var r,n=this,o=nE(r=e.children).call(r),a=this.docManager.getDoc(e.uid);a||(a=this.docManager.addDoc({uid:e.uid,name:e.name,type:t,children:[]},i)),a.children=o;var s=[];if(i){var l=this.viewerManager.getGroup(i);if(!l)return void this.context.errorService.err(cO);s=wP(l).call(l,function(e){return n.viewerManager.getViewer(e);});}else s=this.viewerManager.getAllViewers();pS(s).call(s,function(e){e&&(a.addOwner(e.uid),e.context.hooksService.hooks.openDoc.emit(a));});}},{key:"removeDoc",value:function value(e){this.docManager.getDoc(e)&&this.docManager.removeDoc(e);}},{key:"renameDoc",value:function value(e,t){var i=this.docManager.getDoc(t);i&&(i.name=e);}},{key:"removePagesFromDoc",value:function value(e,t){var i=this.docManager.getDoc(e);i&&pS(t).call(t,function(e){i.remove(e);});}},{key:"appendImagesToDoc",value:function value(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=this.docManager.getDoc(e);if(r){var n=i>-1;pS(t).call(t,function(e,t){var o;sE(o=r.children).call(o,e)<0&&(n?r.insert(e,i+t):r.append(e));});}}},{key:"getDoc",value:function value(e){return this.docManager.getDoc(e);}},{key:"getScrollbarWidth",value:function value(){var e,t=document.createElement("div"),i=document.createElement("div");t.appendChild(i),t.style.width="60px",t.style.height="60px",t.style.position="absolute",t.style.overflow="auto",i.style.width="100px",i.style.height="100px",document.body.appendChild(t);var r=t.offsetWidth-t.clientWidth;document.body.removeChild(t),this.scrollbarWidth=r,pS(e=this.viewerManager.getAllViewers()).call(e,function(e){e.context.setScrollbarWidth(r);});}}]);}(),OH=function(){return hS(function e(t){dS(this,e),sS(this,"actorSystem",void 0),sS(this,"context",void 0),sS(this,"hermiteWorkerUrl",void 0),sS(this,"concurrency",3),this.context=t,this.createWorkerUlr(),this.actorSystem=new TH(this.hermiteWorkerUrl,this.concurrency);},[{key:"createWorkerUlr",value:function value(){this.hermiteWorkerUrl=tE.createObjectURL(new Blob(["(",CH.toString(),")()"],{type:"application/javascript"}));}},{key:"optimize",value:function value(e,t){var i=this;return new BB(function(r,n){var o={action:"optimize",handler:t,callback:function callback(e){r(e);},taskUid:e};i.actorSystem.send(o);});}},{key:"cancelOptimizePage",value:function value(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.actorSystem.cancel(e);}}]);}();function LH(e){var t,i=document.createElement("div");i.style.border=e,e=ix(t=i.style.border).call(t),i=null;var r=ek(e.match(/(^\d+)p?x?\s+(\w+)\s+(.+)/)||[],4),n=r[1],o=r[2],a=r[3];if(pO(n)||pO(o)||pO(a))return{};var s=[];return"dashed"===o&&(s=[2*px(n,10),px(n,10)]),{borderWidth:n,lineDash:s,borderColor:a};}function WH(e,t,i){var r={isOver:!1,pointerX:-1,pointerY:-1,obj:e};if(e&&e.isVisible){var n=e.getPosition(),o=n.x,a=n.y,s=e.width,l=e.height;r.isOver=t>=o&&i>=a&&t<=o+s&&i<=a+l;var u=e.getScale();r.pointerX=(t-o)/u.x,r.pointerY=(i-a)/u.y;}return r;}function FH(e,t){return void 0===t&&(t=[e.getCurrentIndex()]),CO(t)&&(t=[t]),t;}function HH(e,t){var i;if(!vO(t))return e.err(sO),!1;if(0===t.length)return e.err(cO),!1;var r=e.getCurrentTab();if(!r)return!1;var n=Yz(i=nE(t).call(t)).call(i,function(e,t){return e-t;});return n[0]<0||n[n.length-1]>r.total?(e.err(lO),!1):r;}var jH={tag:"div",id:"dvs-viewer",className:"dvs-viewer",children:[{tag:"div",id:"dvs-viewer-middle",className:"dvs-viewer-middle",children:[{tag:"div",id:"dvs-viewer-main",className:"dvs-viewer-main",children:[{tag:"div",id:"dvs-main-container",className:"dvs-main-container",children:[{tag:"div",id:"dvs-scroller-and-canvas",className:"dvs-scroller-and-canvas",children:[{tag:"div",id:"dvs-scroll-container",className:"dvs-scroll-container",children:[{tag:"div",id:"dvs-scroll-content",className:"dvs-scroll-content"}]},{tag:"div",id:"dvs-canvas-container",className:"dvs-canvas-container",children:[]}]},{tag:"div",id:"dvs-video-container",className:"dvs-video-container",children:[{tag:"img",id:"dvs-video-image",class:"dvs-video-image"}]}]}]}]}]},XH={tag:"div",id:"dvs-viewer",className:"dvs-viewer",children:[{tag:"div",id:"dvs-scroll-container",className:"dvs-scroll-container",children:[{tag:"div",id:"dvs-scroll-content",className:"dvs-scroll-content"}]},{tag:"div",id:"dvs-canvas-container",className:"dvs-canvas-container"}]},YH={viewerStyle:{background:"#434246"},canvasStyle:{cursor:"default"},pageStyle:{border:"4px solid #707070",background:"#e2e2e2"},selectedPageStyle:{background:"#6f76ff",border:"4px solid #e98b1f"},hoveredPageStyle:{background:"#a5a9fb",border:"4px solid #e98b1f"},placeholderStyle:{background:"#b5b5b5",border:"0px solid #f00"},pageNumberStyle:{visibility:"visible",width:24,height:24,background:"#fff",borderWidth:1,borderRadius:0,borderColor:"#000",opacity:.5,color:"#000",fontSize:12,fontFamily:"sans-serif",textAlign:"center",textBaseline:"middle",left:"",top:"",right:0,bottom:0},checkboxStyle:{visibility:"visible",width:24,height:24,background:"#fff",borderWidth:2,borderRadius:0,borderColor:"#000",opacity:.5,left:0,top:0},removeBtnStyle:{visibility:"visible",width:24,height:24,background:"#fff",borderWidth:1,borderRadius:"50%",borderColor:"#515151",opacity:1,left:"",top:-8,right:-8,bottom:"",checkMarkColor:"#ea2e2e"},enableDragPage:!0,enableKeyboardControl:!0,multiselectMode:!1,enableOptimizeImage:!1,zoomOrigin:{x:"center",y:"center"},zoom:1,minZoom:.02,maxZoom:8,enableZoom:!0,enableScrollX:!0,enableScrollY:!0,keepZoom:!0,zoomInDelta:1.2,zoomOutDelta:1.2,wheelZoomDelta:1.2,scrollDirection:"vertical",displayMode:"single",toolType:"default",fitType:"window",enableSlide:!0,show:!0,rows:1,columns:1,pure:!1,margin:10,gap:10,autoScroll:!0,autoChangeIndex:!0,autoSelectLatest:!0,enableSelectWithShift:!0,enableSelectWithCtrl:!0,enableZoomWithCtrl:!0,tabMode:"single",enableSyncSelect:!0,enableSingleModeBorder:!1,blankFillColor:"#fff",dragThreshold:3,slideThreshold:20,maxOptimizationSize:7e3,useMinImage:!0,enableDWT1x1:!1,enableEmitPageRendered:!0,autoSelectTopPage:!1,showVideoContainer:!1,DWTMinImageScale:1.5},qH=function(){return hS(function e(){dS(this,e);},[{key:"init",value:function value(e){this.listenDVSHooks(e),this.listenViewerHooks(e);}},{key:"listenDVSHooks",value:function value(e){var t=e.dvsContext.hooksService.hooks,i=function i(t,_i3){"min"===_i3?e.renderMinPage(t):e.renderPage(t);},r=function r(t){e.tabService.updateTab(t);},n=function n(t){e.tabService.movePage(t);},o=function o(t){e.tabService.switchPage(t);},a=function a(t){e.tabService.reorderPages(t);},s=function s(t){e.tabService.changePage(t);},l=function l(t){e.tabService.selectPage(t);},u=function u(t){e.tabService.appendPagesToDoc(t.docUid,t.sourceUids,t.index,t.isSameDoc);},c=function c(t){e.tabService.removePagesFromDoc(t.docUid,t.sourceUids);},h=function h(t){e.tabService.removeDoc(t);},d=function d(t,i){e.tabService.renameDoc(t,i);},f=function f(){e.tabCleared();},v=function v(t){e.isFocus=t===e.viewerUid;};t.afterLoadImage.on(i),t.afterUpdate.on(r),t.move.on(n),t.switch.on(o),t.reorder.on(a),t.changePage.on(s),t.selectPage.on(l),t.appendPagesToDoc.on(u),t.removePagesFromDoc.on(c),t.removeDoc.on(h),t.renameDoc.on(d),t.afterSetSpace.on(f),t.focusChanged.on(v),e.hooksService.hooks.destroy.on(function(){t.afterLoadImage.off(i),t.afterUpdate.off(r),t.move.off(n),t.switch.off(o),t.reorder.off(a),t.changePage.off(s),t.selectPage.off(l),t.appendPagesToDoc.off(u),t.removePagesFromDoc.off(c),t.removeDoc.off(h),t.renameDoc.off(d),t.afterSetSpace.off(f),t.focusChanged.off(v);});}},{key:"listenViewerHooks",value:function value(e){var t=e.hooksService.hooks,i=e.dvsContext.hooksService,r=function r(e){i.hooks.remove.emit(e);},n=function n(e){i.hooks.move.emit(e);},o=function o(e){i.hooks.switch.emit(e);},a=function a(e){i.hooks.reorder.emit(e);},s=function s(e){i.hooks.changePage.emit(e);},l=function l(e){i.hooks.selectPage.emit(e);},u=function u(e){i.hooks.focusChanged.emit(e);},c=function c(t){i.hooks.focusChanged.emit(t,e.viewerUid);},_h2=function h(){t.remove.off(r),t.move.off(n),t.switch.off(o),t.reorder.off(a),t.changePage.off(s),t.selectPage.off(l),t.focusChanged.off(u),t.removeTab.off(c),e.hooksService.hooks.destroy.off(_h2);};t.remove.on(r),t.move.on(n),t.switch.on(o),t.reorder.on(a),t.changePage.on(s),t.selectPage.on(l),t.focusChanged.on(u),t.removeTab.on(c),e.hooksService.hooks.destroy.on(_h2);}}]);}(),ZH=hS(function e(){dS(this,e);});function _H(e,t){if(e.tabUid===t.uid)return!0;if("tag"===e.tabType)for(var i=t.total,r=0;r<i;r++){var n;if(sE(n=e.uids).call(n,t.getChildByIndex(r).uid)>-1)return!0;}return!1;}var GH=function(){return hS(function e(){dS(this,e),sS(this,"undoStack",[]),sS(this,"redoStack",[]);},[{key:"execute",value:function value(e){e.execute(),this.undoStack.push(e),this.redoStack.length>0&&(this.redoStack.length=0);}},{key:"undo",value:function value(e){var t,i=KE(t=this.undoStack).call(t,function(t){return t.uid===e;});if(i>-1){var r,n=this.undoStack[i];NE(r=this.undoStack).call(r,i,1),n.undo(),this.redoStack.push(n);}}},{key:"redo",value:function value(e){var t,i=KE(t=this.redoStack).call(t,function(t){return t.uid===e;});if(i>-1){var r,n=this.redoStack[i];NE(r=this.redoStack).call(r,i,1),n.execute(),this.undoStack.push(n);}}},{key:"removeUidsFromCommand",value:function value(e){this.removeFromStack(this.undoStack,e),this.removeFromStack(this.redoStack,e);}},{key:"removeFromStack",value:function value(e,t){var i;pS(i=nE(e).call(e)).call(i,function(i){var r,n=i.action.uids;if(n&&(pS(r=nE(n).call(n)).call(r,function(e){if(sE(t).call(t,e)>-1){var i=sE(n).call(n,e);NE(n).call(n,i,1);}}),!n.length)){var o=sE(e).call(e,i);NE(e).call(e,o,1);}});}},{key:"reset",value:function value(){this.undoStack=[],this.redoStack=[];}}]);}(),KH=function(){return hS(function e(){dS(this,e);},[{key:"init",value:function value(e){var t=e.dvsContext.hooksService.hooks,i=t.undo,r=t.redo,n=t.reset,o=t.afterUpdate,a=function a(t){var i,r=t.commandUid;t.trigger,pS(i=e.tabService.getAllTabs()).call(i,function(t){var i=t.commandController.undoStack.length,n=t.commandController.undoStack[i-1];(null==n?void 0:n.uid)===r&&(t.commandController.undo(r),e.tabService.isCurrentTab(t.uid)&&e.render());});},s=function s(t){var i,r=t.commandUid;t.trigger,pS(i=e.tabService.getAllTabs()).call(i,function(t){var i=t.commandController.redoStack.length,n=t.commandController.redoStack[i-1];(null==n?void 0:n.uid)===r&&(t.commandController.redo(r),e.tabService.isCurrentTab(t.uid)&&e.render());});},l=function l(t){var i,r=t.uids;pS(i=e.tabService.getAllTabs()).call(i,function(i){_H(t,i)&&(i.commandController.removeUidsFromCommand(r),e.tabService.isCurrentTab(i.uid)&&e.render());});};i.on(a),r.on(s),n.on(l),e.hooksService.hooks.destroy.on(function(){i.off(a),r.off(s),n.off(l);});var u=e.hooksService.hooks.removePagesFromDoc,c=function c(t,i){var r=e.tabService.getTab(t);r&&r.commandController.removeUidsFromCommand(i);},h=function h(t){var i;pS(i=e.tabService.getAllTabs()).call(i,function(e){e.commandController.removeUidsFromCommand([t.modifiedUid]);});};u.on(c),o.on(h),e.hooksService.hooks.destroy.on(function(){u.off(c),o.off(h);});}}]);}();function $H(e,t){var i,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=-1,o=-1,a=0,s=0,l={canvasOffsetX:-1,canvasOffsetY:-1,containerOffsetX:-1,containerOffsetY:-1},u=e.pageX,c=e.pageY,h=ek(t.formatTouches(e,r),1)[0],d=t.getPointerOverPageInfo(h.pageX,h.pageY);if((i=d.index)>=0){var f;l.canvasOffsetX=Math.round(10*d.pageInfo.pagePositionX)/10,l.canvasOffsetY=Math.round(10*d.pageInfo.pagePositionY)/10,a=Math.round(10*d.pageInfo.pageWidth)/10,s=Math.round(10*d.pageInfo.pageHeight)/10;var v=t.rendererService,g=t.uiService.container;null!==(f=t.viewer)&&void 0!==f&&f.isThumbnail&&(g=t.viewer.thumbnailObject.viewer.context.uiService.container);var m=v.canvasDom,y=g.getBoundingClientRect(),p=y.left,w=y.top,b=m.getBoundingClientRect(),k=b.left,S=b.top;l.containerOffsetX=Math.round(10*(k-p+d.pageInfo.pagePositionX))/10,l.containerOffsetY=Math.round(10*(S-w+d.pageInfo.pagePositionY))/10;}if(d.imageInfo.isOver){n=d.imageInfo.pointerX,o=d.imageInfo.pointerY;var x=t.getCurrentTab();if(x){var C=x.getChildByIndex(i);if(C){var V=t.getStatus(C.uid);if(V&&"multiple"===t.config.displayMode&&t.config.useMinImage){var T=V.imageScale;n*=T,o*=T;}}}}return{index:i,imageX:n,imageY:o,pageX:u,pageY:c,pageWidth:a,pageHeight:s,position:l};}var JH=function(){return hS(function e(){dS(this,e);},[{key:"init",value:function value(e){var t,i,r,n,o=e.rendererService.canvasDom,a=0,s=0,l=0,u=0,c=!1,h=!1,d=null,f=!1,v=null,g=null,m=function m(){g&&(clearTimeout(g),g=null),v?g=hB(function(){e.externalResized();},50):v=hB(function(){e.externalResized(),v=null;},42);},y=function y(t){e.isFocus&&e.emit("keyup",t);},p=function p(t){e.isFocus&&e.emit("keydown",t);},w=function w(t){e.hooksService.hooks.focusChanged.emit("");},b=function b(t){var i=$H(t,e);e.emit("click",i,t),e.hooksService.hooks.focusChanged.emit(e.viewerUid),t.stopPropagation();},k=function k(t){e.hooksService.hooks.focusChanged.emit(e.viewerUid);},S=function S(){e.hooksService.hooks.focusChanged.emit("");},x=null,C=function C(i){if(0===i.button){var n=$H(i,e);e.emit("mousedown",n,i),h=!0;var o=i.pointerType;"mouse"===o?e.draggingPrepared=!0:"touch"!==o&&"pen"!==o||"multiple"!==e.config.displayMode||(x=hB(function(){e.draggingPrepared=!0;},300));var c=ek(e.formatTouches(i),1)[0],d=tL()?i.metaKey:i.ctrlKey,f=e.getPointerOverPageInfo(c.pageX,c.pageY).pageInfo.obj,v=e.tabService.getCurrentTab();if(v){var g=e.config;if(f&&"multiple"===g.displayMode&&!d){var m=v.getChildIndex(f);if(i.shiftKey&&g.enableSelectWithShift||g.multiselectMode){if(i.shiftKey&&g.enableSelectWithShift&&(f!==v.currentPage||1!==v.selected.length)){var y=v.getIndexByUid(v.shiftReference);if(y>-1){var p,w=Math.min(m,y),b=Math.max(m,y)-w+1,k=[];e.isSelectedBorderWidthEqualHovered()||e.clearOptimization([f.uid]);for(var S=0;S<b;S++){var C,V=v.getChildByIndex(w+S);sE(C=v.selected).call(C,V.uid)<0&&V.uid!==f.uid&&!e.isSelectedBorderWidthEqualNormal()&&e.clearOptimization([V.uid]),k.push(V.uid);}m<y&&fR(k).call(k);var T={selectedUids:k,indexes:[],docUid:v.uid,trigger:e.viewerUid,groupUid:e.groupUid,operation:"shift",updateShiftReference:!1};pS(p=v.selected).call(p,function(t){if(sE(k).call(k,t)<0&&!e.isSelectedBorderWidthEqualNormal()){var i=v.getChildByUid(t);i&&e.clearOptimization([i.uid]);}}),e.hooksService.hooks.selectPage.emit(T);}}}else{var I=v.selected,E=sE(I).call(I,f.uid)>-1;if(v.currentPage!==f&&I.length<2||!E){var P,B={index:m,docUid:v.uid,trigger:e.viewerUid,groupUid:e.groupUid,operation:"shift"};pS(P=v.selected).call(P,function(t){var i=v.getChildByUid(t);i&&(e.isSelectedBorderWidthEqualNormal()||e.clearOptimization([i.uid]));}),e.isSelectedBorderWidthEqualHovered()||e.clearOptimization([f.uid]),e.hooksService.hooks.changePage.emit(B);}}}if(f){var D;l=c.pageX,u=c.pageY;var M=f.getPosition();a=c.pageX-M.x,s=c.pageY-M.y,t=f,r=nE(D=v.allPages).call(D);}}}},V=function V(r){var o,v,g=$H(r,e);e.emit("mousemove",g,r),h&&!1===e.draggingPrepared&&x&&(clearTimeout(x),x=null);var m=ek(e.formatTouches(r),1)[0],y=e.tabService.getCurrentTab();if(y){var p=e.config,w=e.getPointerOverPageInfo(m.pageX,m.pageY).pageInfo.obj,b=y.getChildIndex(d),k=!1,S=!1,C=!1,V=!1;if(w?d?d!==w&&(c||(d.isSelected||e.isBorderWidthEqualHovered()||e.clearOptimization([d.uid]),w.isSelected||e.isBorderWidthEqualHovered()||e.clearOptimization([w.uid])),C=!0,k=!0,d=w):(c||w.isSelected||e.isBorderWidthEqualHovered()||e.clearOptimization([w.uid]),f||(V=!0),k=!0,d=w,f=!1):d&&(c||d.isSelected||e.isBorderWidthEqualHovered()||e.clearOptimization([d.uid]),C=!0,S=!0,d=null),y&&"multiple"===p.displayMode)if(c){var T,I,E,P;if(w)if(!(sE(P=y.selected).call(P,w.uid)>-1)){var B,D,M,U,A,z=Yz(B=wP(D=y.selected).call(D,function(e){return y.getIndexByUid(e);})).call(B,function(e,t){return e-t;}),R=z[0],N=y.getChildIndex(w),O=nE(M=y.allPages).call(M);pS(U=fR(A=nE(z).call(z)).call(A)).call(U,function(e){NE(O).call(O,e,1);});var L=sE(O).call(O,w);N>R&&(L+=1),pS(n).call(n,function(e,t){var i=y.getChildByUid(e.uid);NE(O).call(O,L+t,0,i);}),i=wP(O).call(O,function(e){return y.getChildIndex(e);}),y.reorder(i,!1),e.layoutService.layout(y);}pS(T=y.selected).call(T,function(e){var t=y.getChildByUid(e);t.borderBox.setPosition({x:m.pageX-a,y:m.pageY-s}),t.isDragging=!0,t.borderBox.updateStyle({visibility:"hidden"});}),null!==(I=t)&&void 0!==I&&I.updateStyle({zIndex:1}),null!==(E=t)&&void 0!==E&&E.borderBox.updateStyle({visibility:"visible"}),e.render();}else if(w&&w===t&&sE(o=y.selected).call(o,w.uid)>-1&&"crop"!==p.toolType&&e.draggingPrepared){var W,F;Math.pow(Math.pow(m.pageX-l,2)+Math.pow(m.pageY-u,2),.5)>=p.dragThreshold&&t&&p.enableDragPage&&(c=!0,n=Yz(W=wP(F=y.selected).call(F,function(e){return{uid:e,index:y.getIndexByUid(e)};})).call(W,function(e,t){return e.index-t.index;}));}var H=!1;y&&r instanceof MouseEvent&&pS(v=y.allPages).call(v,function(e){w&&w.uid===e.uid?(e.isHovered||(H=!0),e.isHovered=!0):(e.isHovered&&(H=!0),e.isHovered=!1);}),H&&"multiple"===p.displayMode&&e.render(),V&&e.emit("mouseout",uS(uS({},g),{},{index:-1}),r,"canvas"),C&&e.emit("mouseout",uS(uS({},g),{},{index:b}),r,"page"),k&&e.emit("mouseover",uS({},g),r,"page"),S&&e.emit("mouseover",uS(uS({},g),{},{index:-1}),r,"canvas");}},T=function T(t){if(0===t.button){var i=$H(t,e,!0);e.emit("mouseup",i,t);}},I=function I(o){if(0===o.button&&"annotation"!==e.config.toolType&&h){o instanceof MouseEvent?e.draggingPrepared=!1:o instanceof TouchEvent&&(x&&(clearTimeout(x),x=null),e.draggingPrepared=!1);var a=ek(e.formatTouches(o,!0),1)[0],s=e.tabService.getCurrentTab();if(s){var l=tL()?o.metaKey:o.ctrlKey,u=e.getPointerOverPageInfo(a.pageX,a.pageY).pageInfo.obj;if(c){var d;if(i){var f,v=wP(f=s.allPages).call(f,function(e){return sE(r).call(r,e);});s.allPages=r,s.freshPageIndex();var g={indexes:v,trigger:e.viewerUid,docUid:s.uid,type:s.type,operation:"shift"};e.hooksService.hooks.reorder.emit(g),i=null;}null==s||pS(d=s.selected).call(d,function(e){var t=s.getChildByUid(e);t.borderBox.setLocalPosition({x:0,y:0}),t.isDragging=!1,t.borderBox.updateStyle({visibility:"visible"});});var m=[];pS(n).call(n,function(e){var t=s.getIndexByUid(e.uid);m.push([e.index,t]);}),e.emit("dragdone",m);}else if(u&&t===u&&"multiple"===e.config.displayMode&&!o.shiftKey)if(l&&e.config.enableSelectWithCtrl||e.config.multiselectMode){var y,p=nE(y=s.selected).call(y),w=sE(p).call(p,u.uid),b=!1;if(w>-1?(l&&p.length>1||e.config.multiselectMode)&&(NE(p).call(p,w,1),b=!0):(p.push(u.uid),b=!0),b){var k={selectedUids:p,indexes:[],docUid:s.uid,trigger:e.viewerUid,groupUid:e.groupUid,operation:"shift"};e.isSelectedBorderWidthEqualHovered()||e.clearOptimization([u.uid]),e.hooksService.hooks.selectPage.emit(k);}}else if((!l||!o.shiftKey)&&s.selected.length>1){var S,C={index:s.getChildIndex(u),docUid:s.uid,trigger:e.viewerUid,groupUid:e.groupUid,operation:"shift"};pS(S=s.selected).call(S,function(t){var i=s.getChildByUid(t);i&&(e.isSelectedBorderWidthEqualNormal()||e.clearOptimization([i.uid]));}),e.isSelectedBorderWidthEqualHovered()||e.clearOptimization([u.uid]),e.hooksService.hooks.changePage.emit(C);}if(s&&"multiple"===e.config.displayMode){var V;if("visible"===e.config.removeBtnStyle.visibility){var T=e.getHitRemoveBtn(a.pageX,a.pageY);T>-1&&e.emit("removeBtnClick",T);}null!==(V=t)&&void 0!==V&&V.updateStyle({zIndex:0}),t=null,c=!1,e.render();}h=!1,t=null,r=[],n=[];}}},E=function E(t){f=!0;var i=$H(t,e);e.emit("mouseover",i,t);},P=function P(t){var i=e.tabService.getCurrentTab(),r=$H(t,e);if(i){var n;if(d){var o=i.getChildIndex(d);r.index=o;}d=null,e.emit("mouseout",r,t),i&&(pS(n=i.allPages).call(n,function(e){e.isHovered=!1;}),"multiple"===e.config.displayMode&&e.rendererService.render());}},B=function B(t){var i=$H(t,e);e.emit("dblclick",i,t);},D=function D(t){var i=$H(t,e);e.emit("wheel",i,t);},M=function M(t){t.preventDefault();var i=$H(t,e);e.emit("contextmenu",i,t);},U=function U(e){},A=function A(e){e.preventDefault();},z=function z(t){t.preventDefault(),e.emit("drop",t);},R=function R(t){if(!e.isDestroyed){e.emit("scroll",t);var i=e.getCurrentTab();if(i){var r,n=t.target,o=n.scrollLeft,a=n.scrollTop;if(i.setPosition({x:-o,y:-a}),i.updateLayoutStatus({scrollLeft:o,scrollTop:a}),e.layoutService.layout(i),pS(r=i.preloadChildren).call(r,function(t){var i;!t.isPreload||t.isLoaded||(null===(i=t.imageContainer)||void 0===i?void 0:i.imageData)||("multiple"===e.config.displayMode&&e.config.useMinImage?e.dvsContext.minImageService.load(t.uid):e.dvsContext.imageService.load(t.uid));}),e.scrollerService.updateScroller({scrollLeft:o,scrollTop:a}),i&&i.isTopPageChanged&&!i.isLoadPage&&!c&&e.config.autoSelectTopPage){var s,l;i.currentUid=i.topPageUid,sE(s=i.selected).call(s,i.currentUid)&&!e.isSelectedBorderWidthEqualNormal()&&e.clearOptimization([i.currentUid]),pS(l=i.selected).call(l,function(t){t===i.currentUid||e.isSelectedBorderWidthEqualNormal()||e.clearOptimization([t]);}),i.select([i.currentUid]);var u=i.getIndexByUid(i.topPageUid),h={selectedUids:[i.currentUid],indexes:[u],docUid:i.uid,trigger:e.viewerUid,groupUid:e.groupUid,operation:"shift",triggerByScroll:!0};e.getLocalHooks().selectPage.emit(h),e.layoutService.layout(i);}i.isLoadPage&&(i.isLoadPage=!1),e.render();}}};window.addEventListener("resize",m),document.addEventListener("keydown",p),document.addEventListener("keyup",y),document.addEventListener("click",w),o.addEventListener("click",b),window.PointerEvent?(o.addEventListener("pointerdown",C),o.addEventListener("pointermove",V),o.addEventListener("pointerup",T),document.addEventListener("pointerup",I)):window.MSPointerEvent&&(o.addEventListener("MSPointerDown",C),o.addEventListener("MSPointerMove",V),o.addEventListener("MSPointerUp",T),document.addEventListener("MSPointerUp",I)),o.addEventListener("touchmove",function(e){e.cancelable&&e.preventDefault();},{passive:!1}),o.addEventListener("blur",S),o.addEventListener("focus",k),o.addEventListener("mouseover",E),o.addEventListener("mouseout",P),o.addEventListener("dblclick",B),o.addEventListener("wheel",D,{passive:!0}),o.addEventListener("contextmenu",M),o.addEventListener("dragstart",U),o.addEventListener("dragover",A),e.uiService.defaultDom.addEventListener("drop",z),e.uiService.hooks.scroll.on(R);var _N2=function N(){v&&clearTimeout(v),g&&clearTimeout(g),x&&clearTimeout(x),window.removeEventListener("resize",m),document.removeEventListener("keydown",p),document.removeEventListener("keyup",y),document.removeEventListener("click",w),o.removeEventListener("click",b),window.PointerEvent?(o.removeEventListener("pointerdown",C),o.removeEventListener("pointermove",V),o.removeEventListener("pointerup",T),document.removeEventListener("pointerup",I)):window.MSPointerEvent&&(o.removeEventListener("MSPointerDown",C),o.removeEventListener("MSPointerMove",V),o.removeEventListener("MSPointerUp",T),document.removeEventListener("MSPointerUp",I)),o.removeEventListener("pointerdown",C),o.removeEventListener("pointermove",V),o.removeEventListener("pointerup",T),document.removeEventListener("pointerup",I),o.removeEventListener("blur",S),o.removeEventListener("focus",k),o.removeEventListener("mouseover",E),o.removeEventListener("mouseout",P),o.removeEventListener("dblclick",B),o.removeEventListener("wheel",D),o.removeEventListener("contextmenu",M),o.removeEventListener("dragstart",U),o.removeEventListener("dragover",A),e.uiService.defaultDom.removeEventListener("drop",z),e.hooksService.hooks.destroy.off(_N2),e.uiService.hooks.scroll.off(R);};e.hooksService.hooks.destroy.on(_N2);}}]);}(),QH={visibility:"hidden",left:0,top:0,right:"",bottom:"",width:"24px",height:"24px",opacity:1,borderWidth:1,borderRadius:0,background:"#ffffff",borderColor:"#000000",checkMarkColor:"#000000",checkMarkLineWidth:"2px",translateX:0,translateY:0},ej=function(e){function t(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_mO(QH);return dS(this,t),sS(Kw(e=nO(this,t,[{style:{visibility:"visible"===i.visibility?"visible":"hidden"}}])),"shapeType","checkbox"),sS(Kw(e),"checkBoxStyle",void 0),sS(Kw(e),"parsedCheckBoxStyle",void 0),sS(Kw(e),"isChecked",!1),e.checkBoxStyle=uS(uS({},QH),i),e;}return Qb(t,e),hS(t,[{key:"checked",get:function get(){return this.isChecked;},set:function set(e){this.isChecked=e;}},{key:"updateStyle",value:function value(e){this.checkBoxStyle=uS(uS({},this.checkBoxStyle),e),this.style.visibility=this.checkBoxStyle.visibility;}}]);}(uF),tj={visibility:"hidden",left:"",top:"",right:0,bottom:0,width:"24px",height:"24px",opacity:1,borderWidth:1,borderRadius:"50%",background:"#ffffff",borderColor:"#a79898",color:"#a79898",fontFamily:"sans-serif",fontSize:12,translateX:0,translateY:0},ij=function(e){function t(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_mO(tj),r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0";return dS(this,t),sS(Kw(e=nO(this,t,[{style:{visibility:"visible"===i.visibility?"visible":"hidden"}}])),"shapeType","pageNumber"),sS(Kw(e),"pageNumberStyle",void 0),sS(Kw(e),"text",void 0),sS(Kw(e),"parsedPageNumberStyle",void 0),e.text=r,e.pageNumberStyle=uS(uS({},tj),i),e;}return Qb(t,e),hS(t,[{key:"updateText",value:function value(e){this.text=e;}},{key:"updateStyle",value:function value(e){this.pageNumberStyle=uS(uS({},this.pageNumberStyle),e),this.style.visibility="visible"===this.pageNumberStyle.visibility?"visible":"hidden";}}]);}(uF),rj={visibility:"hidden",left:"",top:0,right:0,bottom:"",width:"24px",height:"24px",borderWidth:1,borderRadius:0,background:"#ffffff",borderColor:"#000000",checkMarkColor:"#ff0000",checkMarkLineWidth:"2px",translateX:0,translateY:0},nj=function(e){function t(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_mO(rj);return dS(this,t),sS(e=nO(this,t,[i]),"shapeType","removeBtn"),e;}return Qb(t,e),hS(t);}(ej),oj=function(e){function t(e){var i;dS(this,t),sS(Kw(i=nO(this,t,[e])),"uid",void 0),sS(Kw(i),"isSelected",!1),sS(Kw(i),"isPreload",!1),sS(Kw(i),"isMouseover",!1),sS(Kw(i),"isLoaded",!1),sS(Kw(i),"blanks",void 0),sS(Kw(i),"overlays",void 0),sS(Kw(i),"image",void 0),sS(Kw(i),"borderBox",void 0),sS(Kw(i),"imageContainer",void 0),sS(Kw(i),"checkbox",void 0),sS(Kw(i),"pageNumber",void 0),sS(Kw(i),"removeBtn",void 0),sS(Kw(i),"isHovered",!1),sS(Kw(i),"isDragging",!1),sS(Kw(i),"viewportPosition",void 0),sS(Kw(i),"isPageRendered",!1),sS(Kw(i),"isEdited",!1),sS(Kw(i),"isUpdated",!1),sS(Kw(i),"isOptimized",!1),sS(Kw(i),"optimizationUid","1"),sS(Kw(i),"optimizedUid","2"),sS(Kw(i),"realTimeWidth",void 0),sS(Kw(i),"realTimeHeight",void 0),sS(Kw(i),"zoom",1),sS(Kw(i),"imageScale",1),sS(Kw(i),"pageIndex",void 0),sS(Kw(i),"needLayout",void 0),sS(Kw(i),"visibleSortIndex",void 0),sS(Kw(i),"layoutDetail",void 0),i.uid=e.uid,i.realTimeWidth=e.realTimeWidth,i.realTimeHeight=e.realTimeHeight,i.updateStyle(e.style);var r=new BF({id:i.uid,style:{x:0,y:0}}),n=new EF({style:{x:0,y:0}});n.clippable=!0;var o=new EF({style:uS(uS({},e.style),e.formattedPageStyle),ttt:"borderBox"}),a=new ej(uS({},e.checkboxStyle)),s=new ij(uS({},e.pageNumberStyle),"0"),l=new nj(uS({},e.removeBtnStyle)),u=new EF(),c=new EF();return r.appendChild(u),i.appendChild(o),n.appendChild(r),n.appendChild(c),o.appendChild(n),o.appendChild(s),o.appendChild(a),o.appendChild(l),i.pageNumber=s,i.checkbox=a,i.removeBtn=l,i.image=r,i.borderBox=o,i.imageContainer=n,i.blanks=u,i.overlays=c,i.initEvent(),i;}return Qb(t,e),hS(t,[{key:"initEvent",value:function value(){var e=this;this.addEventListener("mouseover",function(){e.isMouseover=!0;}),this.addEventListener("mouseout",function(){e.isMouseover=!1;}),this.addEventListener("mouseup",function(){e.isMouseover=!1;});}},{key:"getImage",value:function value(){return this.image;}},{key:"updateImage",value:function value(e){this.image.style.img=e;}},{key:"clearOptimization",value:function value(){var e;this.isOptimized=!1,null!=this&&null!==(e=this.imageContainer)&&void 0!==e&&e.imageData&&(this.imageContainer.imageData=null),this.optimizationUid=AO();}},{key:"destroy",value:function value(){this.clearOptimization(),this.image.style.img=null,this.image=null,this.imageContainer=null,this.overlays=null,this.blanks=null;}}]);}(EF),aj=function(e){function t(){var e;return dS(this,t),sS(Kw(e=nO(this,t)),"viewportWidth",void 0),sS(Kw(e),"viewportHeight",void 0),sS(Kw(e),"contentWidth",void 0),sS(Kw(e),"contentHeight",void 0),sS(Kw(e),"scrollingX",!0),sS(Kw(e),"scrollingY",!0),sS(Kw(e),"scrollLeft",0),sS(Kw(e),"scrollTop",0),sS(Kw(e),"maxScrollLeft",0),sS(Kw(e),"maxScrollTop",0),sS(Kw(e),"zoom",1),sS(Kw(e),"minZoom",.01),sS(Kw(e),"maxZoom",8),sS(Kw(e),"zooming",!0),sS(Kw(e),"locking",!1),sS(Kw(e),"moveThreshold",5),sS(Kw(e),"scrollThreshold",3),sS(Kw(e),"moveSpeed",1),sS(Kw(e),"decelerationVelocityThreshold",1),sS(Kw(e),"startX",0),sS(Kw(e),"startY",0),sS(Kw(e),"lastX",0),sS(Kw(e),"lastY",0),sS(Kw(e),"lastScale",0),sS(Kw(e),"lastTimeStamp",0),sS(Kw(e),"isStart",!1),sS(Kw(e),"isMoving",!1),sS(Kw(e),"originLeft",0),sS(Kw(e),"originTop",0),sS(Kw(e),"decelerationVelocityX",0),sS(Kw(e),"decelerationVelocityY",0),sS(Kw(e),"enableScrollX",!0),sS(Kw(e),"enableScrollY",!0),sS(Kw(e),"isSingleTouch",!1),sS(Kw(e),"isProcessing",!1),sS(Kw(e),"isDragging",!1),sS(Kw(e),"positions",[]),sS(Kw(e),"hooks",{zoomComplete:mL.create(),scrollComplete:mL.create(),publish:mL.create(),beforeZoom:mL.create(),zoomTo:mL.create()}),e.viewportWidth=800,e.viewportHeight=800,e;}return Qb(t,e),hS(t,[{key:"updateScroller",value:function value(e){cz(this,e),this.calcMaxScroll();}},{key:"setOrigin",value:function value(e,t){this.originLeft=e,this.originTop=t;}},{key:"initScroller",value:function value(e){cz(this,e);}},{key:"zoomTo",value:function value(e,t,i){if(this.zooming){this.zoom;var r=this.minZoom,n=this.maxZoom,o=this.scrollLeft,a=this.scrollTop;this.maxScrollLeft,this.maxScrollTop,pO(t)&&(t=this.originLeft),pO(i)&&(i=this.originTop),this.hooks.beforeZoom.emit(t,i),e=zO(e,r,n),this.publish(o,a,e);}}},{key:"scrollTo",value:function value(e,t,i,r){this.enableScrollX&&(this.scrollLeft=e),this.enableScrollY&&(this.scrollTop=t);var n=this.scrollLeft,o=this.scrollTop;this.emit("_scrollChanged",{scrollLeft:n,scrollTop:o});}},{key:"canScroll",value:function value(){return this.contentWidth>this.viewportWidth||this.contentHeight>this.viewportHeight;}},{key:"onStartHandler",value:function value(e,t){if(this.canScroll()&&!this.isMoving){var i,r;this.isStart=!0,t instanceof Date&&(t=t.valueOf());var n=1===e.length;n?(i=e[0].pageX,r=e[0].pageY):(i=Math.abs(e[0].pageX+e[1].pageX)/2,r=Math.abs(e[0].pageY+e[1].pageY)/2),this.startX=i,this.startY=r,this.lastX=i,this.lastY=r,this.lastScale=1,this.lastTimeStamp=t,this.enableScrollX=this.scrollingX&&n,this.enableScrollY=this.scrollingY&&n,this.isProcessing=!0,this.isDragging=!n,this.isSingleTouch=n,this.positions=[];}}},{key:"onMoveHandler",value:function value(e,t,i){if(this.canScroll()&&this.isStart){var r,n;t instanceof Date&&(t=t.valueOf());var o=1===e.length,a=this.positions;if(o?(r=e[0].pageX,n=e[0].pageY):(r=Math.abs(e[0].pageX+e[1].pageX)/2,n=Math.abs(e[0].pageY+e[1].pageY)/2),this.isDragging){var s=r-this.lastX,l=n-this.lastY,u=this.scrollLeft,c=this.scrollTop,h=this.zoom;if(!pO(i)&&this.zooming){var d=h;h=h/this.lastScale*i,d!==(h=zO(h,this.minZoom,this.maxZoom))&&(u=(r+u)/d*h-r,c=(n+c)/d*h-n,this.calcMaxScroll(h));}this.enableScrollX&&(u-=s*this.moveSpeed,u=zO(u,0,this.maxScrollLeft)),this.enableScrollY&&(c-=l*this.moveSpeed,c=zO(c,0,this.maxScrollTop)),a.length>60&&NE(a).call(a,0,30),a.push({scrollLeft:u,scrollTop:c,timeStamp:t}),this.publish(u,c,h);}else{var f=this.locking?this.scrollThreshold:0,v=this.moveThreshold,g=Math.abs(r-this.startX),m=Math.abs(n-this.startY);this.enableScrollX=this.scrollingX&&g>=f,this.enableScrollY=this.scrollingY&&m>=f,a.push({scrollLeft:this.scrollLeft,scrollTop:this.scrollTop,timeStamp:t}),this.isDragging=(this.enableScrollX||this.enableScrollY)&&(g>=v||m>=v);}this.lastX=r,this.lastY=n,this.lastTimeStamp=t,this.lastScale=i;}}},{key:"onEndHandler",value:function value(e){if(this.canScroll()&&this.isStart&&this.isProcessing){if(e instanceof Date&&(e=e.valueOf()),this.isProcessing=!1,this.isDragging)if(this.isDragging=!1,this.isSingleTouch&&this.animating&&e-this.lastTimeStamp<100){for(var t=this.positions,i=this.decelerationVelocityThreshold,r=t.length-1,n=r,o=r;o>0&&t[o].timeStamp>this.lastTimeStamp-100;o--)n=o;if(n!==r){var a=t[r].timeStamp-t[n].timeStamp,s=this.scrollLeft-t[n].scrollLeft,l=this.scrollTop-this.positions[n].scrollTop;this.decelerationVelocityX=s/a*(1e3/60),this.decelerationVelocityX=l/a*(1e3/60),Math.abs(this.decelerationVelocityX)>i||Math.abs(this.decelerationVelocityY)>i?this.startDeceleration(e):this.hooks.scrollComplete.emit();}else this.hooks.scrollComplete.emit();}else e-this.lastTimeStamp>100&&this.hooks.scrollComplete.emit();this.isDragging&&this.hooks.scrollComplete.emit(),this.scrollTo(this.scrollLeft,this.scrollTop,!0,this.zoom),this.isStart=!1,this.isMoving=!1,this.positions.length=0;}}},{key:"onZoomHandler",value:function value(e,t,i){this.zoomTo(this.zoom*e,t,i);}},{key:"onWheelHandler",value:function value(e){if(!e.ctrlKey){var t=this.scrollLeft,i=this.scrollTop;e.shiftKey?t=this.scrollLeft+e.deltaY:i=this.scrollTop+e.deltaY,this.scrollTo(t,i);}}},{key:"publish",value:function value(e,t,i){this.scrollLeft=e,this.scrollTop=t,this.zoom=i,this.hooks.publish.emit(e,t,i),this.zooming&&(this.calcMaxScroll(),this.hooks.zoomComplete.emit());}},{key:"startDeceleration",value:function value(e){}},{key:"calcMaxScroll",value:function value(e){e=e||this.zoom,this.maxScrollLeft=Math.max(0,this.contentWidth*e-this.viewportWidth),this.maxScrollTop=Math.max(0,this.contentHeight*e-this.viewportHeight);}}]);}(vL),sj=function(e){function t(){return dS(this,t),nO(this,t,arguments);}return Qb(t,e),hS(t,[{key:"render",value:function value(e,t){e.parsedCheckBoxStyle=lj(e,e.checkBoxStyle);var i=e.parsedCheckBoxStyle.opacity;t.save(),t.globalAlpha=i,this.renderBox(e,t,"out"),t.clip(),this.renderBox(e,t,"in"),MP(this).call(this,e,t),this.renderBox(e,t,"center"),this.stroke(e,t),this.renderCheckMark(e,t),t.restore();}},{key:"renderBox",value:function value(e,t,i){var r=e.parsedCheckBoxStyle,n=r.x,o=r.y,a=r.width,s=r.height,l=r.borderWidth,u=r.borderRadiusX,c=r.borderRadiusY,h=0;"center"===i?h=l/2:"in"===i&&(h=l);var d=[{x:n+u,y:o+c,start:Math.PI,end:3*Math.PI/2},{x:n+a-u,y:o+c,start:3*Math.PI/2,end:2*Math.PI},{x:n+a-u,y:o+s-c,start:0,end:Math.PI/2},{x:n+u,y:o+s-c,start:Math.PI/2,end:Math.PI}],f=Math.max(u-h,0),v=Math.max(c-h,0);if(t.beginPath(),t.ellipse)for(var g=0;g<4;g++){var m=d[g],y=m.x,p=m.y,w=m.start,b=m.end;t.ellipse(y,p,f,v,0,w,b);}else t.rect(n,o,a,s);t.closePath();}},{key:"fill",value:function value(e,t){var i=e.parsedCheckBoxStyle.background;if(IO()){var r=FW(i);t.fillStyle=r.formatted;}else t.fillStyle=i;MP(t).call(t);}},{key:"stroke",value:function value(e,t){var i=e.parsedCheckBoxStyle,r=i.borderColor,n=i.borderWidth;if(IO()){var o=FW(r);t.strokeStyle=o.formatted;}else t.strokeStyle=r;t.lineWidth=n,n>0&&t.stroke();}},{key:"renderCheckMark",value:function value(e,t){if(e.checked){var i=e.parsedCheckBoxStyle,r=i.x,n=i.y,o=i.width,a=i.height,s=i.borderWidth,l=i.checkMarkLineWidth,u=i.checkMarkColor,c=Math.max(Math.min(o-2*s,a-2*s),0),h=r,d=n;if(0!==c){if(o<a?(h+=s,d=d+s+(a-o)/2):(h=h+s+(o-a)/2,d+=s),t.lineWidth=l,IO()){var f=FW(u);t.strokeStyle=f.formatted;}else t.strokeStyle=u;t.beginPath(),t.moveTo(h+.15*c,d+.5*c),t.lineTo(h+.4*c,d+.8*c),t.lineTo(h+.85*c,d+.2*c),t.stroke();}}}}]);}(iH);function lj(e,t){var i,r,n,o=_mO(t),a=e.parentNode.width||100,s=e.parentNode.height||100;pS(i=["borderWidth","checkMarkLineWidth","opacity","fontSize"]).call(i,function(e){pO(o[e])||(o[e]=AW(o[e]).value||0);}),pS(r=["left","top","right","bottom","width","height"]).call(r,function(e){var t,i=-1!==sE(t=["left","right","width"]).call(t,e)?a:s,r=IF(o[e],i);o[e]=r;}),CO(t.width)||null!==o.width||(CO(o.left)&&CO(o.right)?o.width=a-o.left-o.right:o.width=0),CO(t.height)||null!==o.height||(CO(o.bottom)&&CO(o.top)?o.height=s-o.top-o.bottom:o.height=0),pS(n=["borderRadius","translateX","translateY"]).call(n,function(e){var t=o.width,i=o.height,r=Math.max,n=Math.min;if("borderRadius"===e){var a=IF(o[e],t),s=IF(o[e],i);o.borderRadiusX=r(0,n(a,t/2)),o.borderRadiusY=r(0,n(s,i/2));}"translateX"===e&&(o[e]=IF(o[e],t)),"translateY"===e&&(o[e]=IF(o[e],i));});var l=o.left,u=o.top,c=o.right,h=o.bottom,d=o.translateX,f=o.translateY,v=o.borderWidth,g=l,m=u;return 2*v>o.width&&(o.width=2*v),2*v>o.height&&(o.height=2*v),CO(o.right)&&!CO(o.left)&&(g=a-o.width-c),CO(o.bottom)&&!CO(o.top)&&(m=s-o.height-h),uS({x:g+d,y:m+f},o);}var uj=function(e){function t(){return dS(this,t),nO(this,t,arguments);}return Qb(t,e),hS(t,[{key:"render",value:function value(e,t){e.parsedPageNumberStyle=lj(e,e.pageNumberStyle);var i=e.parsedPageNumberStyle.opacity;t.save(),t.globalAlpha=i,this.renderBox(e,t,"out"),t.clip(),this.renderBox(e,t,"in"),MP(this).call(this,e,t),this.renderBox(e,t,"center"),this.stroke(e,t),this.renderFont(e,t),t.restore();}},{key:"renderBox",value:function value(e,t,i){var r=e.parsedPageNumberStyle,n=r.x,o=r.y,a=r.width,s=r.height,l=r.borderWidth,u=r.borderRadiusX,c=r.borderRadiusY,h=0;"center"===i?h=l/2:"in"===i&&(h=l);var d=[{x:n+u,y:o+c,start:Math.PI,end:3*Math.PI/2},{x:n+a-u,y:o+c,start:3*Math.PI/2,end:2*Math.PI},{x:n+a-u,y:o+s-c,start:0,end:Math.PI/2},{x:n+u,y:o+s-c,start:Math.PI/2,end:Math.PI}],f=Math.max(u-h,0),v=Math.max(c-h,0);if(t.beginPath(),t.ellipse)for(var g=0;g<4;g++){var m=d[g],y=m.x,p=m.y,w=m.start,b=m.end;t.ellipse(y,p,f,v,0,w,b);}else t.rect(n,o,a,s);t.closePath();}},{key:"renderFont",value:function value(e,t){var i,r=e.parsedPageNumberStyle,n=r.x,o=r.y,a=r.width,s=r.height,l=r.fontSize,u=r.color,c=r.fontFamily;if(IO()){var h=FW(u);t.fillStyle=h.formatted;}else t.fillStyle=u;t.textAlign="center",t.textBaseline="middle",t.font=BS(i="".concat(l,"px ")).call(i,c),t.fillText(e.text,n+a/2,o+s/2+l/8,a);}},{key:"fill",value:function value(e,t){var i=e.parsedPageNumberStyle.background;if(IO()){var r=FW(i);t.fillStyle=r.formatted;}else t.fillStyle=i;MP(t).call(t);}},{key:"stroke",value:function value(e,t){var i=e.parsedPageNumberStyle,r=i.borderColor,n=i.borderWidth;if(IO()){var o=FW(r);t.strokeStyle=o.formatted;}else t.strokeStyle=r;t.lineWidth=n,n>0&&t.stroke();}}]);}(iH),cj=function(e){function t(){return dS(this,t),nO(this,t,arguments);}return Qb(t,e),hS(t,[{key:"renderCheckMark",value:function value(e,t){var i=e.parsedCheckBoxStyle,r=i.x,n=i.y,o=i.width,a=i.height,s=i.borderWidth,l=i.checkMarkLineWidth,u=i.checkMarkColor,c=Math.max(Math.min(o-2*s,a-2*s),0),h=r,d=n;0!==c&&(o<a?(h+=s,d=d+s+(a-o)/2):(h=h+s+(o-a)/2,d+=s),t.lineWidth=l,t.strokeStyle=u,t.beginPath(),t.moveTo(h+.3*c,d+.3*c),t.lineTo(h+.7*c,d+.7*c),t.moveTo(h+.3*c,d+.7*c),t.lineTo(h+.7*c,d+.3*c),t.stroke());}}]);}(sj),hj=function(){return hS(function e(t){dS(this,e),sS(this,"isMarginFixed",!0),sS(this,"isGapFixed",!0),sS(this,"isBorderFixed",!0),sS(this,"viewWidth",0),sS(this,"viewHeight",0),sS(this,"validVisualWidth",0),sS(this,"validVisualHeight",0),sS(this,"visualWidth",0),sS(this,"visualHeight",0),sS(this,"layoutWidth",0),sS(this,"layoutHeight",0),sS(this,"validLayoutWidth",0),sS(this,"validLayoutHeight",0),sS(this,"currentLayoutWidth",0),sS(this,"currentLayoutHeight",0),sS(this,"layoutLeft",0),sS(this,"layoutTop",0),sS(this,"calcWidth",0),sS(this,"calcHeight",0),sS(this,"calcViewWidth",0),sS(this,"calcViewHeight",0),sS(this,"fixedWidth",0),sS(this,"fixedHeight",0),sS(this,"defaultWidth",600),sS(this,"defaultHeight",800),sS(this,"rowHeightArray",[]),sS(this,"columnWidthArray",[]),sS(this,"scrollbarWidth",17),sS(this,"zoom",1),sS(this,"scrollLeft",0),sS(this,"scrollTop",0),sS(this,"realRow",void 0),sS(this,"realCol",void 0),sS(this,"skipCalcZoom",!1),sS(this,"isScrollbarAppeared",!1),sS(this,"isScrollbarXAppeared",!1),sS(this,"isScrollbarYAppeared",!1),sS(this,"isScrollbarChanged",!1),sS(this,"resized",!1),sS(this,"placeholderPages",[]),cz(this,t);},[{key:"resetScrollbarStatus",value:function value(){this.isScrollbarAppeared=!1,this.isScrollbarChanged=!1,this.isScrollbarXAppeared=!1,this.isScrollbarYAppeared=!1;}},{key:"reset",value:function value(){this.validVisualWidth=0,this.validVisualHeight=0,this.visualWidth=0,this.visualHeight=0,this.layoutWidth=0,this.layoutHeight=0,this.validLayoutWidth=0,this.validLayoutHeight=0,this.currentLayoutWidth=0,this.currentLayoutHeight=0,this.layoutLeft=0,this.layoutTop=0,this.calcWidth=0,this.calcHeight=0,this.calcViewWidth=0,this.calcViewHeight=0,this.fixedWidth=0,this.fixedHeight=0;}}]);}(),dj=function(e){function t(e){var i;return dS(this,t),sS(Kw(i=nO(this,t,[e])),"uid",void 0),sS(Kw(i),"tabName",void 0),sS(Kw(i),"type",void 0),sS(Kw(i),"doc",void 0),sS(Kw(i),"viewer",void 0),sS(Kw(i),"selected",[]),sS(Kw(i),"fitType","window"),sS(Kw(i),"displayMode","single"),sS(Kw(i),"toolType","default"),sS(Kw(i),"keepZoom",!1),sS(Kw(i),"isDirty",!0),sS(Kw(i),"layoutStatus",void 0),sS(Kw(i),"stepPageIdStack",[]),sS(Kw(i),"redoStack",[]),sS(Kw(i),"isDestroyed",!1),sS(Kw(i),"preloadCount",1),sS(Kw(i),"row",3),sS(Kw(i),"column",3),sS(Kw(i),"direction","vertical"),sS(Kw(i),"dpr",1),sS(Kw(i),"gap",20),sS(Kw(i),"margin",10),sS(Kw(i),"borderWidth",0),sS(Kw(i),"hoveredBorderWidth",0),sS(Kw(i),"selectedBorderWidth",0),sS(Kw(i),"enableDWT1x1",!1),sS(Kw(i),"shiftReference",null),sS(Kw(i),"commandController",void 0),sS(Kw(i),"topPageUid",null),sS(Kw(i),"isTopPageChanged",!1),sS(Kw(i),"isLoadPage",!1),sS(Kw(i),"visibleChildren",[]),sS(Kw(i),"preloadChildren",[]),sS(Kw(i),"allPages",[]),sS(Kw(i),"pageMap",new PR()),sS(Kw(i),"currentUid",null),sS(Kw(i),"scrollbarWidth",17),cz(Kw(i),e),i.layoutStatus=new hj({viewWidth:e.viewWidth||0,viewHeight:e.viewHeight||0}),i.commandController=new GH(),i;}return Qb(t,e),hS(t,[{key:"currentPage",get:function get(){return this.currentUid?this.pageMap.get(this.currentUid):null;}},{key:"current",get:function get(){var e=this.pageMap.get(this.currentUid);return e?e.pageIndex:-1;}},{key:"total",get:function get(){return this.allPages.length;}},{key:"freshPageIndex",value:function value(){var e;pS(e=this.allPages).call(e,function(e,t){e.pageIndex=t;});}},{key:"setZoom",value:function value(e){var t;this.layoutStatus.zoom=e,pS(t=this.allPages).call(t,function(t){t.zoom=e;});}},{key:"destroy",value:function value(){oO(t,"destroy",this,3)([]),this.viewer=null,this.selected=null,this.isDestroyed=!0;}},{key:"updateShiftReference",value:function value(){this.shiftReference=this.currentUid;}},{key:"move",value:function value(e,t){if(e===t)return!0;var i=this.allPages,r=ek(NE(i).call(i,e,1),1)[0];return!!r&&(NE(i).call(i,t,0,r),this.select([r.uid]));}},{key:"switch",value:function value(e,t){if(e===t)return!0;var i=this.allPages,r=this.current,n=i[e];return i[e]=i[t],i[t]=n,r===e?this.select([i[t].uid]):r===t&&this.select([i[e].uid]),!0;}},{key:"next",value:function value(){if(0===this.total)return-1;if(this.total-this.current>1){var e=this.allPages[this.current+1];this.currentUid=e.uid;}return this.selected=[this.currentUid],this.current;}},{key:"prev",value:function value(){return this.total<=0||this.current<0?-1:(this.current>0&&(this.currentUid=this.allPages[this.current-1].uid),this.selected=[this.currentUid],this.current);}},{key:"first",value:function value(){return 0===this.total?-1:(this.currentUid=this.allPages[0].uid,this.selected=[this.currentUid],0);}},{key:"last",value:function value(){return 0===this.total?-1:(this.currentUid=this.allPages[this.total-1].uid,this.selected=[this.currentUid],this.current);}},{key:"goto",value:function value(e){var t,i=this;return 0===this.total?-1:(e!==this.current&&(e=zO(e,0,this.total-1),this.currentUid=this.allPages[e].uid),this.selected=[this.currentUid],pS(t=this.allPages).call(t,function(e){var t;e.isSelected=sE(t=i.selected).call(t,e.uid)>-1;}),this.current);}},{key:"select",value:function value(e){var t,i,r=e.length;if(0===r)return this.selected=e,this.currentUid=null,pS(t=this.allPages).call(t,function(e){e.isSelected=!1;}),!0;var n=e[r-1];return!!n&&(pS(i=this.allPages).call(i,function(t){t.isSelected=sE(e).call(e,t.uid)>-1;}),this.selected=e,this.currentUid=n,!0);}},{key:"getSelected",value:function value(){var e;return nE(e=this.selected).call(e);}},{key:"getChildByIndex",value:function value(e){return this.allPages[e];}},{key:"getChildByUid",value:function value(e){return this.pageMap.get(e);}},{key:"getIndexByUid",value:function value(e){var t=this.pageMap.get(e);return t?t.pageIndex:-1;}},{key:"getUidByIndex",value:function value(e){var t;return null===(t=this.allPages[e])||void 0===t?void 0:t.uid;}},{key:"getChildIndex",value:function value(e){return e?e.pageIndex:-1;}},{key:"getChildUids",value:function value(){var e;return wP(e=this.allPages).call(e,function(e){return e.uid;});}},{key:"reorder",value:function value(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.allPages,r=e.length,n=[],o=!1;if(i.length!==r)return!1;for(var a=0;a<r;a++)if(e[a]!==a){o=!0;break;}if(!o)return!0;for(var s=0;s<r;s++)n[s]=i[e[s]];for(var l=0;l<r;l++)i[l]=n[l];if(this.freshPageIndex(),t&&this.selected.length){var u=this.selected[this.selected.length-1];this.currentUid=u;}return!0;}},{key:"updateLayoutStatus",value:function value(e){cz(this.layoutStatus,e);}}]);}(uF),fj=function(){return hS(function e(t){var i=t.tabMode;dS(this,e),sS(this,"tabs",void 0),sS(this,"mode",void 0),sS(this,"currentTabUid",void 0),sS(this,"isDestroyed",!1),sS(this,"hooks",{removeTab:mL.create()}),sS(this,"tabSelectionStack",void 0),this.tabs=[],this.mode=i,this.currentTabUid=null,this.tabSelectionStack=[];},[{key:"destroy",value:function value(){var e;pS(e=this.tabs).call(e,function(e){return e.destroy();}),this.tabs=null,this.tabSelectionStack=null,this.isDestroyed=!0;}},{key:"clear",value:function value(){this.tabs=[],this.currentTabUid=null,this.tabSelectionStack=[];}},{key:"createTab",value:function value(e,t){var i,r=this,n=YP(i=this.tabs).call(i,function(t){return e.uid===t.uid;});if(!n){var o,a,s=uS({uid:e.uid,name:e.name,type:e.type},t);n=new dj(s),"single"===this.mode&&pS(o=nE(a=this.tabs).call(a)).call(o,function(e){r.closeTab(e.uid);}),this.tabs.push(n);}return n;}},{key:"find",value:function value(e){var t;return YP(t=this.tabs).call(t,function(t){return e===t.uid;});}},{key:"findIndex",value:function value(e){var t;return KE(t=this.tabs).call(t,function(t){return e===t.uid;});}},{key:"setCurrentTab",value:function value(e){var t,i;if(KE(this).call(this,e)<0)return!1;var r=sE(t=this.tabSelectionStack).call(t,e);return r>-1&&NE(i=this.tabSelectionStack).call(i,r,1),this.tabSelectionStack.push(e),this.currentTabUid=e,!0;}},{key:"closeTab",value:function value(e){if(!this.removeTab(e))return!1;var t=this.tabs,i=this.tabSelectionStack,r=sE(i).call(i,e);return NE(i).call(i,r,1),t.length?this.currentTabUid=i[i.length-1]:this.currentTabUid=null,!0;}},{key:"removeTab",value:function value(e){var t,i=KE(this).call(this,e);return i>-1&&(NE(t=this.tabs).call(t,i,1),this.hooks.removeTab.emit(e),!0);}},{key:"getCurTab",value:function value(){return YP(this).call(this,this.currentTabUid);}},{key:"getAllTabs",value:function value(){var e;return nE(e=this.tabs).call(e);}},{key:"setMode",value:function value(e){return("single"===e||"multiple"===e)&&(this.mode=e,!0);}}]);}(),vj=function(){return hS(function e(){dS(this,e),sS(this,"optimizeTabTimer",null);},[{key:"init",value:function value(e){var t=e.uiService,i=e.rendererService,r=t.canvasContainer,n=t.getViewportSize(),o=n.width,a=n.height;i.initCanvas({container:r,width:o,height:a}),i.registerShapeRenderer("checkbox",new sj()),i.registerShapeRenderer("pageNumber",new uj()),i.registerShapeRenderer("removeBtn",new cj()),this.listenHooks(e);}},{key:"listenHooks",value:function value(e){var t=this,i=function i(e){var i=e.tabService,r=e.config,n=i.getCurrentTab();if(n){var o,a="multiple"===r.displayMode;if(pS(o=n.preloadChildren).call(o,function(e){var t,i=r.pageNumberStyle.visibility,o=r.checkboxStyle.visibility,s=r.removeBtnStyle.visibility;a||(i="hidden",o="hidden",s="hidden"),e.pageNumber.updateText(String(e.pageIndex+1)),e.pageNumber.updateStyle({visibility:i}),e.checkbox.checked=sE(t=n.selected).call(t,e.uid)>-1,e.checkbox.updateStyle({visibility:o}),e.removeBtn.updateStyle({visibility:s});var l=n.selected,u=r.pageStyle;a&&(YP(l).call(l,function(t){return t===e.uid;})?u=r.selectedPageStyle:e.isHovered&&(u=r.hoveredPageStyle));var c=u,h=c.background,d=c.border,f={};d&&(f=LH(d));var v=f.borderWidth;if(r.enableSingleModeBorder||"single"!==r.displayMode&&"slide"!==r.displayMode||(v=0),e.borderBox.updateStyle(uS(uS({background:h},f),{},{borderWidth:v})),e.isDragging&&a){f={};var g=r.placeholderStyle,m=g.background,y=g.border;y&&(f=LH(y)),e.updateStyle(uS({background:m},f));}else e.updateStyle({background:"#ffffff00",borderWidth:0});"slide"!==r.displayMode&&"single"!==r.displayMode&&"doc"!==r.displayMode||e.borderBox.updateStyle({background:"rgba(255,255,255,0)"});}),EO()||IO())return;t.optimizeTabTimer&&(clearTimeout(t.optimizeTabTimer),t.optimizeTabTimer=null),t.optimizeTabTimer=hB(function(){t.optimizeTab(e,n);},300);}},r=function r(e){var t,i=e.tabService,r=e.config,n=e.rendererService,o=i.getCurrentTab();if(o&&(o.isTopPageChanged||-1!==n.lastTopPageIndex&&0===o.total)&&(o.isTopPageChanged=!1,"multiple"===r.displayMode)){var a=o.getIndexByUid(o.topPageUid);a!==n.lastTopPageIndex&&(e.emit("topPageChanged",a),n.lastTopPageIndex=a);}o&&pS(t=o.preloadChildren).call(t,function(t){t.isPageRendered&&t.isVisible&&(t.isPageRendered=!1,t.isUpdated=!1,t.isEdited=!1,r.enableEmitPageRendered&&e.emit("pageRendered",t.pageIndex));});},n=e.rendererService.hooks;n.beforeRender.on(i),n.afterRender.on(r),e.hooksService.hooks.destroy.on(function(){n.beforeRender.off(i),n.afterRender.off(r);});}},{key:"optimizeTab",value:function value(e,t){var i;pS(i=t.preloadChildren).call(i,function(t){!t.isOptimized&&t.isVisible&&t.isLoaded&&t.zoom<1&&new BB(function(e,t){hB(function(){e(null);},200);}).then(function(){e.optimizePage(t.uid);});});}}]);}(),gj=function(){return hS(function e(){dS(this,e);},[{key:"init",value:function value(e){this.listenNativeEvent(e),this.listenViewerHooks(e);}},{key:"listenViewerHooks",value:function value(e){var t=e.hooksService.hooks,i=function i(t){var i,r,n,o=t.tabNode,a=(null==o||null===(i=o.layoutStatus)||void 0===i?void 0:i.currentLayoutWidth)||0,s=(null==o||null===(r=o.layoutStatus)||void 0===r?void 0:r.currentLayoutHeight)||0;a=Math.max(Math.floor(a)-1,0),s=Math.max(Math.floor(s)-1,0),e.uiService.updateScrollContentSize(a,s),e.scrollerService.updateScroller({contentWidth:a,contentHeight:s}),"single"===e.config.displayMode&&(e.config.zoom=o.layoutStatus.zoom),0!==o.layoutStatus.viewWidth&&0!==o.layoutStatus.viewHeight&&pS(n=o.allPages).call(n,function(t){var i;if(t.isPreload)t.isLoaded||(null===(i=t.imageContainer)||void 0===i?void 0:i.imageData)||("multiple"===e.config.displayMode&&e.config.useMinImage?e.dvsContext.minImageService.load(t.uid):e.dvsContext.imageService.load(t.uid));else{t.image.style.img=null,t.isLoaded=!1;var r=e.dvsContext.viewerService.isPageNeedLoad(t.uid);if(!r.min||r.min&&"multiple"===e.config.displayMode&&e.config.useMinImage){var n=e.getStatus(t.uid);n&&(n.minImg=null);}if(!r.ori||r.ori&&"single"===e.config.displayMode){var o=e.getStatus(t.uid);o&&(o.img=null);}}});},r=function r(t){if(!t.isPassive&&e.config.autoScroll&&"single"!==e.config.displayMode&&"slide"!==e.config.displayMode){var i=e.getCurrentTab(),r=i.layoutStatus,n=r.viewWidth,o=r.viewHeight,a=r.rowHeightArray,s=r.columnWidthArray,l=r.scrollLeft,u=r.scrollTop,c=r.realRow,h=r.realCol,d=r.placeholderPages,f=i.currentPage,v=i.current,g=i.row,m=i.column,y=i.enableDWT1x1,p=d[v],w=p.x,b=p.y,k=f.viewportPosition,S=l,x=u,C=!1,V=0,T=e.getMargin(),I=e.getGap(),E=1===m&&1===g&&y;"multiple"===e.config.displayMode&&("ahead"===k.x?(S=w-(V=0===k.column?T:E?0:I),C=!0):"behind"===k.x&&(V=k.column===h-1?T:E?0:I,S=w+s[0]-n+V,i.total<=i.row*i.column&&(S=i.getChildByIndex(0).getLocalPosition().x-T),C=!0),"ahead"===k.y?(x=b-(V=0===k.row?T:E?0:I),C=!0):"behind"===k.y&&(V=k.row===c-1?T:E?0:I,x=b+a[0]-o+V,i.total<=i.row*i.column&&(x=i.getChildByIndex(0).getLocalPosition().y-T),C=!0)),C?(i.setPosition({x:-S,y:-x}),i.updateLayoutStatus({scrollLeft:S,scrollTop:x}),e.scrollerService.updateScroller({scrollLeft:S,scrollTop:x}),e.uiService.scrollTo(S,x)):e.render();}};e.layoutService.hooks.afterLayout.on(i),t.currentIndexChanged.on(r),e.hooksService.hooks.destroy.on(function(){e.layoutService.hooks.afterLayout.off(i),t.currentIndexChanged.off(r);});}},{key:"listenNativeEvent",value:function value(e){var t=e.rendererService.canvasDom,i=function i(t){e.scrollerService.mousedownListener(t);},r=function r(t){e.scrollerService.mousemoveListener(t);},n=function n(t){e.scrollerService.mouseupListener(t);},o=function o(t){e.scrollerService.mousedownListener(t);},a=function a(t){e.scrollerService.mousemoveListener(t);},s=function s(t){e.scrollerService.mouseupListener(t);},l=function l(t){var i=e.tabService.getCurrentTab();null==i||!i.total||0===i.selected.length&&"single"===e.config.displayMode||e.scrollerService.wheelListener(t);},u=function u(e){e.cancelable&&e.preventDefault();};t.addEventListener("wheel",l,{passive:!1}),t.addEventListener("touchstart",o,{passive:!1}),t.addEventListener("touchmove",u,{passive:!1}),document.addEventListener("touchmove",a,{passive:!1}),document.addEventListener("touchend",s),t.addEventListener("mousedown",i),document.addEventListener("mousemove",r),document.addEventListener("mouseup",n),e.hooksService.hooks.destroy.on(function(){t.removeEventListener("wheel",l),t.removeEventListener("touchstart",o),t.removeEventListener("touchmove",u),document.removeEventListener("touchmove",a),document.removeEventListener("touchend",s),t.removeEventListener("mousedown",i),document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",n);});}}]);}(),mj=function(){return hS(function e(){dS(this,e);},[{key:"init",value:function value(e){this.listenViewerHooks(e);}},{key:"listenTabHooks",value:function value(e){var t=function t(_t4){e.hooksService.hooks.removeTab.emit(_t4);},_i4=function i(){e.tabService.tabManager.hooks.removeTab.off(t),e.hooksService.hooks.destroy.off(_i4);};e.tabService.tabManager.hooks.removeTab.on(t),e.hooksService.hooks.destroy.on(_i4);}},{key:"listenViewerHooks",value:function value(e){var t=this,i={beforeStatus:null,afterStatus:null,operation:null,docUid:null},r=function r(_r3){var n=_r3.modifiedUid,o=_r3.docUid,a=_r3.removedUids,s=e.tabService.getTab(o);s&&e.tabService.isCurrentTab(o)&&(i.beforeStatus=t.createBufferStatus(s,n,a));},n=function n(r){var n=r.modifiedUid,o=r.docUid,a=r.operation,s=r.removedUids,l=e.tabService.getTab(o);if(l&&e.tabService.isCurrentTab(o)){var u,c;i.afterStatus=t.createBufferStatus(l,n,s),i.operation=a,i.docUid=o,i.curIndex=l.current||0,i.total=l.total||0;var h=e.viewer.getSelectedIndexes();e.emit("_imageSelectedUI",h),e.emit("imageSelected",h);var d=l.current,f=l.total;e.emit("_dvsPagerChanged",{current:d,total:f}),r.isSameDoc||e.emit("bufferChanged",uS({},i));var v=null===(u=i.beforeStatus)||void 0===u?void 0:u.currentUid,g=null===(c=i.afterStatus)||void 0===c?void 0:c.currentUid;if("add"===a&&v!==g){var m=_mO(i);m.operation="shift",e.emit("bufferChanged",m);}}i={beforeStatus:null,afterStatus:null,operation:null,docUid:null,curIndex:0,total:0};},o=function o(t){e.tabService.openDoc(t);},a=e.hooksService.hooks;a.beforeBufferChanged.on(r),a.afterBufferChanged.on(n),a.openDoc.on(o);var _s2=function s(){a.beforeBufferChanged.off(r),a.afterBufferChanged.off(n),a.openDoc.off(o),e.hooksService.hooks.destroy.off(_s2);};e.hooksService.hooks.destroy.on(_s2);}},{key:"createBufferStatus",value:function value(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return{uids:e.getChildUids(),selectedUids:e.getSelected(),currentUid:e.currentUid,modifiedUid:t,removedUids:i};}}]);}();function yj(e,t){if(gO(t)){cz(e.config.viewerStyle,t);var i=e.uiService,r=i.scrollContainer,n=i.canvasContainer,o=e.getBorderWidth(e.config.viewerStyle);n&&r&&(cz(n.style,{left:"".concat(o,"px"),top:"".concat(o,"px")}),cz(r.style,t),e.resized());}}function pj(e,t){if(gO(t)){cz(e.config.canvasStyle,t);var i,r=e.rendererService.canvasDom;if(r)cz(r.style,t),sE(i=kS(t||{})).call(i,"border")>-1&&e.resized();}}function wj(e,t){if(gO(t)){var i;cz(e.config.pageStyle,t);var r=e.getBorderWidth(e.config.pageStyle);pS(i=e.getAllTabs()).call(i,function(e){e.borderWidth=r;}),e.clearCurTabOptimization(),e.render();}}function bj(e,t){if(gO(t)){var i;cz(e.config.selectedPageStyle,t);var r=e.getBorderWidth(e.config.selectedPageStyle);pS(i=e.getAllTabs()).call(i,function(e){e.selectedBorderWidth=r;}),e.clearCurTabOptimization(),e.render();}}function kj(e,t){if(gO(t)){var i;cz(e.config.hoveredPageStyle,t);var r=e.getBorderWidth(e.config.hoveredPageStyle);pS(i=e.getAllTabs()).call(i,function(e){e.hoveredBorderWidth=r;}),e.clearCurTabOptimization(),e.render();}}function Sj(e,t){gO&&(cz(e.config.placeholderStyle,t),e.render());}function xj(e,t){var i;gO(t)&&(cz(e.config.pageNumberStyle,t),pS(i=e.getAllTabs()).call(i,function(t){var i;pS(i=t.allPages).call(i,function(t){t.pageNumber.updateStyle(e.config.pageNumberStyle);});}),e.rendererService.render());}function Cj(e,t){var i;gO(t)&&(cz(e.config.checkboxStyle,t),pS(i=e.getAllTabs()).call(i,function(t){var i;pS(i=t.allPages).call(i,function(t){t.checkbox.updateStyle(e.config.checkboxStyle);});}),e.rendererService.render());}function Vj(e,t){var i;gO(t)&&(cz(e.config.removeBtnStyle,t),pS(i=e.getAllTabs()).call(i,function(t){var i;pS(i=t.allPages).call(i,function(t){t.removeBtn.updateStyle(e.config.removeBtnStyle);});}),e.rendererService.render());}function Tj(e,t){e.config.enableDragPage=t;}function Ij(e,t){e.config.enableKeyboardControl=t;}function Ej(e,t){e.config.multiselectMode=t;}function Pj(e,t){e.config.zoomOrigin=t;}function Bj(e,t){t=zO(t,e.config.minZoom,e.config.maxZoom),e.zoomService.zoomTo(t),e.config.zoom=t;}function Dj(e,t){e.config.minZoom=t;}function Mj(e,t){e.config.maxZoom=t;}function Uj(e,t){e.config.enableZoom=t;}function Aj(e,t){e.config.enableScrollX=t;}function zj(e,t){e.config.enableScrollY=t;}function Rj(e,t){e.config.keepZoom=t;}function Nj(e,t){e.config.zoomInDelta=t;}function Oj(e,t){e.config.zoomOutDelta=t;}function Lj(e,t){e.config.wheelZoomDelta=t;}function Wj(e,t){e.config.scrollDirection=t;var i=e.getCurrentTab();i&&(i.direction=t,e.resized());}function Fj(e,t){var i,r=t!==e.config.displayMode;e.config.displayMode=t;var n=e.getCurrentTab();n&&(n.displayMode=t,pS(i=n.allPages).call(i,function(e){e.isLoaded=!1;}),e.showTab(n),r&&e.resetScrollbarStatus(),e.clearCurTabOptimization(),e.render(),"multiple"===t&&e.emitCurrentIndexChanged());}function Hj(e,t){e.config.toolType=t;var i=e.getCurrentTab();i&&(i.toolType=t,e.rendererService.render());}function jj(e,t){if(e.config.fitType!==t){e.config.fitType=t;var i=e.getCurrentTab();if(i){i.fitType=t,e.resetScrollbarStatus(),e.resetScrollerSize(),e.resize(),e.clearCurTabOptimization(),e.render();var r=e.uiService.scrollContainer,n=r.scrollWidth,o=r.scrollHeight,a=n-r.clientWidth,s=o-r.clientHeight,l=e.config.zoomOrigin,u=l.x,c=l.y,h=0,d=0;"center"===u?h=a/2:"right"===u&&(h=a),"center"===c?d=s/2:"bottom"===c&&(d=s),0===h&&0===d||e.uiService.scrollTo(h,d);}}}function Xj(e,t){if(e.config.show!==t){e.config.show=t;var i=e.uiService,r=i.rootDom,n=i.defaultDom;if(r&&(t?(r.style.display="flex",n.style.display="flex"):r.style.display="none"),e.resized(),t){var o=e.getCurrentTab();o&&(e.showTab(o),e.renderOnly());}}}function Yj(e,t){e.setViewMode(t,e.config.columns);}function qj(e,t){e.setViewMode(e.config.rows,t);}function Zj(e,t){e.config.pure=!0;}function _j(e,t){e.config.margin!==t&&(e.config.margin=t,e.clearCurTabOptimization(),e.render());}function Gj(e,t){e.config.gap!==t&&(e.config.gap=t,e.clearCurTabOptimization(),e.render());}function Kj(e,t){e.config.autoChangeIndex=t;}function $j(e,t){e.config.autoScroll=t;}function Jj(e,t){e.config.autoSelectLatest=t;}function Qj(e,t){e.config.enableSelectWithShift=t;}function eX(e,t){e.config.enableZoomWithCtrl=t;}function tX(e,t){e.config.enableSelectWithCtrl=t;}function iX(e,t){"single"===t||"multiple"===t?(e.config.tabMode=t,e.tabService.tabManager.setMode(t),e.ok()):e.err(cO);}function rX(e,t){e.config.enableSyncSelect=t;}function nX(e,t){e.config.enableSingleModeBorder=t;}function oX(e,t){e.config.blankFillColor=t;}function aX(e,t){e.config.dragThreshold=t;}function sX(e,t){e.config.slideThreshold=t;}function lX(e,t){e.config.maxOptimizationSize=t;}function uX(e,t){e.config.enableSlide=t;}function cX(e,t){e.config.enableDWT1x1=t;}function hX(e,t){e.config.enableEmitPageRendered=t;}function dX(e,t){e.config.autoSelectTopPage=t;}function fX(e,t){e.config.enableOptimizeImage=t;}function vX(e,t){e.config.useMinImage=t;}var gX=function(){return hS(function e(t){dS(this,e),sS(this,"context",void 0),sS(this,"handlers",{}),this.context=t,this.initHandlers();},[{key:"destroy",value:function value(){this.context=null,this.handlers={};}},{key:"updateConfig",value:function value(e){for(var t=0,i=IB(e);t<i.length;t++){var r=ek(i[t],2),n=r[0],o=r[1],a=this.handlers[n];a&&a(this.context,o);}}},{key:"registerHandler",value:function value(e,t){return!this.handlers[e]&&(this.handlers[e]=t,!0);}},{key:"initHandlers",value:function value(){var e={viewerStyle:yj,canvasStyle:pj,pageStyle:wj,selectedPageStyle:bj,hoveredPageStyle:kj,placeholderStyle:Sj,pageNumberStyle:xj,checkboxStyle:Cj,removeBtnStyle:Vj,enableDragPage:Tj,enableKeyboardControl:Ij,multiselectMode:Ej,zoomOrigin:Pj,zoom:Bj,minZoom:Dj,maxZoom:Mj,enableZoom:Uj,enableScrollX:Aj,enableScrollY:zj,keepZoom:Rj,zoomInDelta:Nj,zoomOutDelta:Oj,wheelZoomDelta:Lj,scrollDirection:Wj,displayMode:Fj,toolType:Hj,fitType:jj,show:Xj,rows:Yj,columns:qj,pure:Zj,margin:_j,gap:Gj,autoChangeIndex:Kj,autoScroll:$j,autoSelectLatest:Jj,enableSelectWithShift:Qj,enableZoomWithCtrl:eX,enableSelectWithCtrl:tX,tabMode:iX,enableSyncSelect:rX,enableSingleModeBorder:nX,blankFillColor:oX,dragThreshold:aX,slideThreshold:sX,maxOptimizationSize:lX,enableSlide:uX,enableDWT1x1:cX,enableEmitPageRendered:hX,enableOptimizeImage:fX,useMinImage:vX,autoSelectTopPage:dX};this.handlers=e;}}]);}(),mX=hS(function e(t){dS(this,e),sS(this,"hooks",{init:mL.create(),destroy:mL.create(),beforeLayout:mL.create(),layout:mL.create(),afterLayout:mL.create(),beforeRender:mL.create(),render:mL.create(),afterRender:mL.create(),resize:mL.create(),externalResized:mL.create(),bindContainer:mL.create(),pageChanged:mL.create(),afterScroll:mL.create(),afterZoom:mL.create(),mousedown:mL.create(),mousemove:mL.create(),mouseup:mL.create(),mouseover:mL.create(),mouseout:mL.create(),click:mL.create(),dblclick:mL.create(),wheel:mL.create(),contextmenu:mL.create(),dragStart:mL.create(),loadImage:mL.create(),update:mL.create(),remove:mL.create(),move:mL.create(),switch:mL.create(),reorder:mL.create(),changePage:mL.create(),selectPage:mL.create(),beforeBufferChanged:mL.create(),afterBufferChanged:mL.create(),currentIndexChanged:mL.create(),tabCleared:mL.create(),focusChanged:mL.create(),removePagesFromDoc:mL.create(),appendPagesToDoc:mL.create(),openDoc:mL.create(),removeTab:mL.create()}),sS(this,"context",void 0),this.context=t;});function yX(e,t){var i,r,n=e.layoutStatus,o=n.viewWidth,a=n.viewHeight,s=e.borderWidth;e.viewer.context.config.enableSingleModeBorder||(s=0);var l=e.viewer.context.getMargin(),u=t.image.style.img,c=t.realTimeWidth||(null==u?void 0:u.naturalWidth)||e.layoutStatus.defaultWidth,h=t.realTimeHeight||(null==u?void 0:u.naturalHeight)||e.layoutStatus.defaultHeight,d=o-2*l-2*s,f=a-2*l-2*s,v=0,g=0,m=1;c<=d&&h<=f?(v=c,g=h,m=1):c/h>d/f?(v=d,g=h*(m=d/c)):(g=f,v=c*(m=f/h));var y=(d-c*m)/2+s/2+l,p=(f-h*m)/2+s/2+l;y=Math.max(l+s/2,y),p=Math.max(l+s/2,p);var w=c*(1-m)/2,b=h*(1-m)/2;return t.borderBox.updateStyle({x:0,y:0,width:v+2*s,height:g+2*s,borderWidth:s}),t.imageContainer.setLocalScale(1),t.imageContainer.updateStyle({x:s-w,y:s-b,width:c,height:h}),t.imageContainer.setLocalScale(m,m,1),t.zoom=m,t.image.updateStyle({x:0,y:0,width:(null===(i=t.image.style.img)||void 0===i?void 0:i.naturalWidth)||0,height:(null===(r=t.image.style.img)||void 0===r?void 0:r.naturalHeight)||0}),t.updateStyle({visibility:"visible"}),t.imageContainer.updateStyle({visibility:"visible"}),t.borderBox.updateStyle({visibility:"visible"}),t.image.updateStyle({visibility:"visible"}),{left:y-s/2,top:p-s/2};}var pX=function(){return hS(function e(t){dS(this,e),sS(this,"hooks",{beforeLayout:mL.create(),layout:mL.create(),afterLayout:mL.create()}),sS(this,"context",void 0),this.context=t;},[{key:"layoutExecutor",value:function value(e){"single"===e.displayMode?function(e,t){var i=e.currentPage;if(i){var r=e.layoutStatus,n=r.defaultWidth,o=r.defaultHeight,a=r.viewWidth,s=r.viewHeight,l=e.viewer.context.getMargin(),u=e.borderWidth,c=i.image.style.img,h=i.realTimeWidth||(null==c?void 0:c.naturalWidth)||n,d=i.realTimeHeight||(null==c?void 0:c.naturalHeight)||o;e.viewer.context.config.enableSingleModeBorder||(u=0);var f=2*u,v=2*l,g=a-f-v,m=s-f-v;e.updateLayoutStatus({layoutWidth:h,layoutHeight:d,calcWidth:h,calcHeight:d,calcViewWidth:g,calcViewHeight:m,validVisualWidth:g,validVisualHeight:m,validLayoutWidth:h,validLayoutHeight:d,fixedWidth:v+f,fixedHeight:v+f});var y=e.layoutStatus,p=y.calcWidth,w=y.calcHeight,b=y.calcViewWidth,k=y.calcViewHeight,S=y.scrollbarWidth,x=y.validLayoutWidth,C=y.validLayoutHeight,V=y.fixedWidth,T=y.fixedHeight,I=e.layoutStatus,E=I.isScrollbarChanged,P=I.isScrollbarXAppeared,B=I.isScrollbarYAppeared,D=e.direction,M=s,U=a,A=0,z=0,R=1,N=p/b>w/k,O=e.fitType;if("width"===O||"window"===O&&N)(z=C*(R=p<=b?1:b/p))>m?(B||(B=!0,E=!0,R=p<=b-S?1:(b-S)/p),z=C*R):B&&(B=!1,E=!0),A=x*R;else if("height"===O||"window"===O&&!N)(A=x*(R=w<=k?1:k/w))>b?(P||(P=!0,E=!0,R=w<=k-S?1:(k-S)/w),A=x*R):P&&(P=!1,E=!0),z=C*R;else if("none"===O){A=x*(R=e.layoutStatus.zoom),z=C*R,Math.floor(A)>g?P||(P=!0,E=!0):P&&(P=!1,E=!0),Math.floor(z)>m?B||(B=!0,E=!0):B&&(B=!1,E=!0);}var L="vertical"===D?(U-A-V)/2:0,W="vertical"===D?0:(M-z-T)/2;if(L<0&&(L=0),W<0&&(W=0),e.updateLayoutStatus({layoutLeft:L,layoutTop:W,zoom:R,visualWidth:U,visualHeight:M,currentLayoutWidth:A+V,currentLayoutHeight:z+T,isScrollbarChanged:E,isScrollbarXAppeared:P,isScrollbarYAppeared:B}),e.setZoom(R),!E){e.viewer.context.uiService.updateScrollContentSize(A,z);var F=e.viewer.context.uiService.scrollContainer,H=F.scrollLeft,j=F.scrollTop;e.setPosition({x:-H,y:-j}),e.viewer.context.config.enableSingleModeBorder||(u=0);var X=i.realTimeWidth||(null==c?void 0:c.naturalWidth)||n,Y=i.realTimeHeight||(null==c?void 0:c.naturalHeight)||o,q=X*R,Z=Y*R,_=(U-q)/2-u/2,G=(M-Z)/2-u/2;_=Math.max(l+u/2,_),G=Math.max(l+u/2,G);var K=X*(1-R)/2,$=Y*(1-R)/2;i.updateStyle({x:_-u/2,y:G-u/2,width:q+2*u,height:Z+2*u,borderWidth:u}),i.borderBox.updateStyle({x:0,y:0,width:q+2*u,height:Z+2*u,borderWidth:u}),i.image.updateStyle({width:(null==c?void 0:c.naturalWidth)||0,height:(null==c?void 0:c.naturalHeight)||0}),i.imageContainer.setLocalScale(1),i.imageContainer.updateStyle({x:u-K,y:u-$,width:X,height:Y}),i.imageContainer.setLocalScale(R),i.zoom=R;var J=e.current,Q=e.total,ee=e.preloadCount;if(e.topPageUid,i){var te=J-ee;te<0&&(te=0);var ie=J+ee;ie>=Q&&(ie=Q-1),e.visibleChildren=[],e.preloadChildren=[],pS(t=e.allPages).call(t,function(t,r){var n,o,a=t.uid===i.uid,s=r>=te&&r<=ie,l=t.isVisible;((t.isEdited||t.isUpdated)&&a||!l&&a)&&(t.isPageRendered=!0),t.isPreload=s,s&&e.preloadChildren.push(t);var u=!1;t.isVisible&&!a?rD(n=e.childNodes).call(n,t)&&e.removeChild(t):!t.isVisible&&a&&(u=!0),t.needLayout=u,a&&e.visibleChildren.push(t),s&&(rD(o=e.childNodes).call(o,t)||e.appendChild(t));var c=a?"visible":"hidden";t.updateStyle({visibility:c}),t.borderBox.updateStyle({visibility:c}),t.image.updateStyle({visibility:c}),t.imageContainer.updateStyle({visibility:c});});}}}}(e):"multiple"===e.displayMode?function(e){var t,i,r,n=e.layoutStatus,o=n.viewWidth,a=n.viewHeight,s=n.isScrollbarAppeared,l=n.isScrollbarChanged,u=e.layoutStatus.scrollbarWidth,c=e.total,h=e.row,d=e.column,f=e.direction,v=e.enableDWT1x1,g=e.viewer.context.getMargin(),m=e.viewer.context.getGap();1===h&&1===d&&v&&(g=0),d*h<c?s||(s=!0,l=!0,"vertical"===f?o-=u:a-=u):s&&(s=!1,l=!0);var y="vertical"===f,p=(o-(d-1)*m-2*g)/d,w=(a-(h+1)*m)/h;1===h&&1===d&&v&&(w=a),y||(w=(a-(h-1)*m-2*g)/h,p=(o-(d+1)*m)/d,1===h&&1===d&&v&&(p=o));var b=y?Math.max(h,Math.ceil(c/d)):h,k=y?d:Math.max(d,Math.ceil(c/h)),S=p*k+(k-1)*m+2*g,x=w*b+(b-1)*m+2*g;if(e.updateLayoutStatus({rowHeightArray:[w],columnWidthArray:[p],layoutWidth:S,layoutHeight:x,skipCalcZoom:!0,layoutLeft:0,layoutTop:0,visualWidth:o,visualHeight:a,currentLayoutWidth:S,currentLayoutHeight:x,isScrollbarAppeared:s,isScrollbarChanged:l,realRow:b,realCol:k}),!l){var C=e.allPages,V=e.borderWidth,T=e.hoveredBorderWidth,I=e.selectedBorderWidth;e.viewer.context.uiService.updateScrollContentSize(S,x);var E=e.viewer.context.uiService.scrollContainer,P=E.scrollLeft,B=E.scrollTop;e.setPosition({x:-P,y:-B});var D=wP(C).call(C,function(e){return{uid:e.uid,x:0,y:0,width:p,height:w};});pS(C).call(C,function(t,i){var r,n=V;t.isHovered&&(n=T),sE(r=e.selected).call(r,t.uid)>-1&&(n=I);var o=i%d,a=Math.floor(i/d);"horizontal"===f&&(o=Math.floor(i/h),a=i%h);var s=g+o*(m+p)+n/2,l=g+a*(m+w)+n/2,u=p-2*n,c=w-2*n;u=Math.max(u,0),c=Math.max(c,0);var v=t.getImage().style.img,y=t.realTimeWidth||(null==v?void 0:v.naturalWidth)||0,b=t.realTimeHeight||(null==v?void 0:v.naturalHeight)||0,k=0,S=0,x=y,C=b,E=1;(y>u||b>c)&&(y/b>u/c?(x=u,C=b*(E=u/y)):(C=c,x=y*(E=c/b))),k+=(u-x)/2,S+=(c-C)/2,k+=n,S+=n;var P=y*(1-E)/2,B=b*(1-E)/2;D[i].x=s-n/2,D[i].y=l-n/2,t.layoutDetail={imageWidth:(null==v?void 0:v.naturalWidth)||0,imageHeight:(null==v?void 0:v.naturalHeight)||0,imageContainerX:k-P,imageContainerY:S-B,imageContainerWidth:y,imageContainerHeight:b,scale:E,pageX:s-n/2,pageY:l-n/2,pageWidth:p,pageHeight:w,borderBoxX:0,borderBoxY:0,borderBoxWidth:p,borderBoxHeight:w};}),e.layoutStatus.placeholderPages=D;var M=e.preloadCount,U=e.topPageUid,A=function(e,t,i){var r=e.layoutStatus,n=r.scrollTop,o=r.placeholderPages,a=r.visualHeight,s="vertical"===e.direction,l=0,u=t-1;if(!s&&"multiple"===e.displayMode)return{startRow:l,endRow:u};for(var c=Number.MAX_VALUE,h=Number.MAX_VALUE,d=!1,f=!1,v=0;v<t;v++){var g=o[s?v*i:v];if(g){var m=g.y,y=g.height;if(!d){var p=m-n;p<=0&&m+y-n>1?(d=!0,l=v):p>0&&p<c&&(c=p,l=v);}if(!f){var w=n+a,b=w-(m+y);m-w<-1&&b<=0?(f=!0,u=v):b>0&&b<h&&(h=b,u=v);}if(d&&f)break;}}return{startRow:l,endRow:u};}(e,b,k),z=A.startRow,R=A.endRow,N=function(e,t,i){var r=e.layoutStatus,n=r.scrollLeft,o=r.placeholderPages,a=r.visualWidth,s="vertical"===e.direction,l=0,u=i-1;if(s&&"multiple"===e.displayMode)return{startColumn:l,endColumn:u};for(var c=Number.MAX_VALUE,h=Number.MAX_VALUE,d=!1,f=!1,v=0;v<i;v++){var g=o[s?v:v*t];if(g){var m=g.x,y=g.width;if(!d){var p=m-n;p<=0&&m+y-n>1?(d=!0,l=v):p>0&&p<c&&(c=p,l=v);}if(!f){var w=n+a,b=w-(m+y);m-w<-1&&b<=0?(f=!0,u=v):b>0&&b<h&&(h=b,u=v);}if(d&&f)break;}}return{startColumn:l,endColumn:u};}(e,b,k),O=N.startColumn,L=N.endColumn,W=null;e.visibleChildren=[],e.preloadChildren=[],pS(t=e.allPages).call(t,function(t,i){var r,n;t.visibleSortIndex=i;var o=y?Math.floor(i/d):i%h,a=y?i%d:Math.floor(i/h),s=o>=z&&o<=R&&a>=O&&a<=L,l=o>=z-M&&o<=R+M&&a>=O-M&&a<=L+M;s&&!W&&(W=t.uid),l&&e.preloadChildren.push(t),t.isPreload=l,s||l||rD(r=e.childNodes).call(r,t)&&e.removeChild(t),s&&e.visibleChildren.push(t),l&&(rD(n=e.childNodes).call(n,t)||e.appendChild(t)),((t.isEdited||t.isUpdated)&&s||!t.isVisible&&s)&&(t.isPageRendered=!0);var u=s?"visible":"hidden";if(t.isVisible!==s&&t.updateStyle({visibility:u}),!t.isDragging&&s){var c=t.isLoaded||t.imageContainer.imageData?u:"hidden";t.borderBox.updateStyle({visibility:u}),t.imageContainer.updateStyle({visibility:c}),t.image.updateStyle({visibility:u});}var f={x:a<=O?"ahead":a>=L?"behind":"inside",y:o<=z&&o<R?"ahead":o>=R&&o>=z?"behind":"inside",column:a,row:o};t.viewportPosition=f;}),W&&W!==U&&(e.isTopPageChanged=!0,e.topPageUid=W),Yz(i=e.childNodes).call(i,function(e,t){return e.visibleSortIndex-t.visibleSortIndex;}),pS(r=e.preloadChildren).call(r,function(e){var t=e.layoutDetail;e.image.updateStyle({width:t.imageWidth,height:t.imageHeight}),e.imageContainer.updateStyle({x:t.imageContainerX,y:t.imageContainerY,width:t.imageContainerWidth,height:t.imageContainerHeight});var i=t.scale;e.imageContainer.setLocalScale(i,i,1),e.zoom=i,e.updateStyle({x:t.pageX,y:t.pageY,width:t.pageWidth,height:t.pageHeight}),e.borderBox.updateStyle({x:t.borderBoxX,y:t.borderBoxY,width:t.borderBoxWidth,height:t.borderBoxHeight});});}}(e):"slide"===e.displayMode&&function(e){if(e.total){var t=e.layoutStatus,i=t.viewWidth,r=t.viewHeight,n=e.current,o=e.getChildByIndex(n-1),a=e.getChildByIndex(n+1);if(o){var s=yX(e,o),l=s.left,u=s.top;o.updateStyle({x:-i+l,y:u,width:i,height:r});}if(a){var c=yX(e,a),h=c.left,d=c.top;a.updateStyle({x:i+h,y:d,width:i,height:r});}}}(e);}},{key:"layout",value:function value(e){if(this.hooks.beforeLayout.emit({tabNode:e}),this.layoutExecutor(e),e.layoutStatus.isScrollbarChanged){e.layoutStatus.isScrollbarChanged=!1,this.hooks.afterLayout.emit({tabNode:e}),this.context.resize();var t=e.getChildUids();this.context.clearOptimization(t),this.layoutExecutor(e);}this.hooks.afterLayout.emit({tabNode:e});}}]);}(),wX=function(){return hS(function e(t){dS(this,e),sS(this,"canvasDom",void 0),sS(this,"hooks",{beforeRender:mL.create(),render:mL.create(),afterRender:mL.create()}),sS(this,"context",void 0),sS(this,"canvas",void 0),sS(this,"renderer",void 0),sS(this,"isInitialized",!1),sS(this,"lastTopPageIndex",-1),this.context=t;},[{key:"render",value:function value(){if("single"===this.context.config.displayMode){var e,t=null===(e=this.context)||void 0===e?void 0:e.getCurrentTab();if(t){var i=t.currentPage;if(i&&!i.isLoaded)return;}}this.hooks.beforeRender.emit(this.context),this.internalRender(),this.hooks.afterRender.emit(this.context);}},{key:"internalRender",value:function value(){var e,t,i=null===(e=this.context)||void 0===e?void 0:e.getCurrentTab(),r=this.canvas.document.documentElement;if(i)0===r.children.length?r.appendChild(i):sE(t=r.children).call(t,i)<0&&r.replaceChild(i,r.children[0]);else for(var n=r.childNodes.length-1;n>=0;n--)r.removeChild(r.childNodes[n]);this.canvas.render();}},{key:"initCanvas",value:function value(e){var t=e.container,i=e.width,r=e.height,n=new wH({}),o=new tH({renderer:n,container:t,width:i,height:r});this.renderer=n,this.canvas=o,this.canvasDom=o.contextService.getDomElement(),this.canvasDom.tabIndex=0,cz(this.canvasDom.style,this.context.config.canvasStyle),this.isInitialized=!0;}},{key:"registerShapeRenderer",value:function value(e,t){this.canvas.contextService.registerShapeRenderer(e,t);}},{key:"getCanvasPosition",value:function value(){var e=this.canvasDom.getBoundingClientRect(),t=fL(),i=t.scrollX,r=t.scrollY;return{x:e.left+i,y:e.top+r};}},{key:"resetCanvasSize",value:function value(){this.canvasDom.style.width="0px",this.canvasDom.style.height="0px";}}]);}(),bX=function(){return hS(function e(t){var i=this;dS(this,e),sS(this,"context",void 0),sS(this,"isStart",!1),sS(this,"scroller",void 0),sS(this,"startDistance",0),sS(this,"startZoom",1),sS(this,"lastScale",1),sS(this,"originX",0),sS(this,"originY",0),sS(this,"startX",0),sS(this,"startY",0),sS(this,"isSliding",!1),sS(this,"isZoom",!1),sS(this,"slideDirection","left"),sS(this,"slideDistance",0),sS(this,"slideTimer",null),sS(this,"wheelTimer",null),sS(this,"touchZoomTimer",null),sS(this,"startTime",0),sS(this,"isScrolling",!1),sS(this,"scrollTimer",null),sS(this,"scrollDirectionX","left"),sS(this,"scrollDirectionY","up"),sS(this,"lineHeight",this.getLineHeight()),sS(this,"startHandler",function(e,t){var r=i.context.config;"default"===r.toolType?(i.isStart=!0,e.length>1&&(i.startDistance=Math.pow(Math.pow(e[0].pageX-e[1].pageX,2)+Math.pow(e[0].pageY-e[1].pageY,2),.5)),i.scroller.onStartHandler(e,t)):"zoomIn"===r.toolType&&"multiple"!==r.displayMode?i.context.zoomService.zoomTo(r.zoom*r.zoomInDelta,e[0].pageX,e[0].pageY):"zoomOut"===r.toolType&&"multiple"!==r.displayMode&&i.context.zoomService.zoomTo(r.zoom/r.zoomOutDelta,e[0].pageX,e[0].pageY);}),this.context=t,this.scroller=new aj(),this.scroller.hooks.publish.on(function(e,i,r){t.uiService.scrollTo(e,i);});},[{key:"getLineHeight",value:function value(){var e=getComputedStyle(document.body),t=e.lineHeight,i=e.fontSize;if(/\d+/.test(t)){var r=ek(t.match(/(\d+)/),1)[0];return px(r,10);}if(/\d+/.test(i)){var n=ek(i.match(/(\d+)/),1)[0];return 1.2*px(n,10);}return 16;}},{key:"destroy",value:function value(){this.wheelTimer&&(clearTimeout(this.wheelTimer),this.wheelTimer=null),this.touchZoomTimer&&(clearTimeout(this.touchZoomTimer),this.touchZoomTimer=null),this.scrollTimer&&(XL.clearTimer(this.scrollTimer),this.scrollTimer=null),this.slideTimer&&(XL.clearTimer(this.slideTimer),this.slideTimer=null);}},{key:"updateScroller",value:function value(e){this.scroller.updateScroller(e);}},{key:"mousedownListener",value:function value(e){var t;if(!(e instanceof MouseEvent&&"multiple"===this.context.config.displayMode||this.isSliding)){var i=null===(t=this.context)||void 0===t?void 0:t.getCurrentTab();if(i&&i.total){var r=this.context.formatTouches(e);this.startX=r[0].pageX,this.startY=r[0].pageY,this.lastScale=1,this.startTime=new Date().getTime(),this.isScrolling=!1,this.scrollTimer&&(XL.clearTimer(this.scrollTimer),this.scrollTimer=null),this.startZoom=this.context.config.zoom,this.startHandler(r,e.timeStamp);}}}},{key:"mousemoveListener",value:function value(e){var t,i=this;if(this.isStart){var r=this.context.formatTouches(e);if(window.TouchEvent&&e instanceof TouchEvent){if(this.context.draggingPrepared)return void(e.cancelable&&e.preventDefault());if(r.length>1&&this.context.config.enableZoom&&"single"===this.context.config.displayMode){var n=(r[0].pageX+r[1].pageX)/2,o=(r[0].pageY+r[1].pageY)/2,a=Math.pow(Math.pow(r[0].pageX-r[1].pageX,2)+Math.pow(r[0].pageY-r[1].pageY,2),.5)/this.startDistance;e.scale&&(a=e.scale);var s=this.context.config.zoom,l=s;return(s=this.startZoom*a)!==l&&(this.touchZoomTimer||(this.touchZoomTimer=hB(function(){i.context.zoomService.zoomTo(s,n,o),clearTimeout(i.touchZoomTimer),i.touchZoomTimer=null;},25))),this.lastScale=a,void(this.isZoom=!0);}}var u=null===(t=this.context)||void 0===t?void 0:t.getCurrentTab(),c=r[0].pageX-this.startX;if(u&&u.total){if(c>0?this.slideDirection="right":c<0&&(this.slideDirection="left"),this.slideDistance=Math.min(u.layoutStatus.viewWidth,Math.abs(c)),this.isSliding)return"right"===this.slideDirection?u.setPosition({x:this.slideDistance,y:0,z:0}):"left"===this.slideDirection&&u.setPosition({x:-this.slideDistance,y:0,z:0}),void this.context.renderOnly();"single"===this.context.config.displayMode&&"default"===this.context.config.toolType&&this.context.config.enableSlide&&Math.abs(c)>this.context.config.slideThreshold&&!this.context.uiService.isScrollbarAppeared()&&(this.isSliding=!0,this.context.updateViewerConfig({displayMode:"slide"}));}this.scroller.onMoveHandler(r,e.timeStamp);}}},{key:"slide",value:function value(e){var t,i=this,r=0,n=0,o=0,a=!1;this.slideDistance>=this.context.config.slideThreshold?(t=(n=e.layoutStatus.viewWidth)-this.slideDistance,"left"===this.slideDirection?e.current!==e.total-1?(o=-this.slideDistance,r=-t/8):(n=0,t=this.slideDistance,a=!0,o=-this.slideDistance,r=t/8):0!==e.current?(o=this.slideDistance,r=t/8):(n=0,t=this.slideDistance,a=!0,o=this.slideDistance,r=-t/8)):(a=!0,n=0,t=this.slideDistance,"left"===this.slideDirection?(o=-this.slideDistance,r=t/8):(o=this.slideDistance,r=-t/8)),this.slideTimer=XL.createTimer(function(){var t=(o+=r)>=0;if(Math.abs(o)>=n&&(o=n,t||(o*=-1)),e.setPosition({x:o,y:0,z:0}),Math.abs(o)===n)return a||("right"===i.slideDirection?i.context.viewer.prevPage():i.context.viewer.nextPage(),i.context.updateViewerConfig({fitType:"window"})),i.isSliding=!1,i.context.updateViewerConfig({displayMode:"single"}),void XL.clearTimer(i.slideTimer);i.context.renderOnly();},25);}},{key:"mouseupListener",value:function value(e){if(this.isStart){var t=this.context.formatTouches(e,!0),i=this.context.config.displayMode;if(this.isZoom||"slide"!==i){this.scroller.onEndHandler(e.timeStamp);var r=this.context.uiService.getMaxScrollValue(),n=r.maxScrollLeft,o=r.maxScrollTop,a=this.context.uiService.scrollContainer,s=a.scrollLeft,l=a.scrollTop;if(!this.isZoom&&!this.isSliding&&!this.isScrolling&&!this.context.draggingPrepared&&(n>0||o>0)&&window.TouchEvent&&e instanceof TouchEvent&&"default"===this.context.config.toolType){var u=new Date().getTime(),c=t[0].pageX,h=t[0].pageY,d=c-this.startX,f=h-this.startY,v=!1,g=!1;d>0?(v=0!==s,this.scrollDirectionX="right"):(v=s!==n,this.scrollDirectionX="left"),f>0?(g=0!==l,this.scrollDirectionY="down"):(g=l!==o,this.scrollDirectionY="up");var m=u-this.startTime;if((Math.abs(d)>10||Math.abs(f)>10)&&m>0&&m<300&&(v||g)){var y=Math.abs(d)/m,p=Math.abs(f)/m;(y>.4||p>.4)&&(y=Math.min(y,2.8),p=Math.min(p,2.8),this.scroll(y,p,-.05));}}}else{var w,b=null===(w=this.context)||void 0===w?void 0:w.getCurrentTab();b&&this.slide(b);}this.isStart=!1,this.lastScale=1,this.isZoom=!1;}}},{key:"scroll",value:function value(e,t,i){var r=this;this.isScrolling=!0;var n=this.context.uiService.scrollContainer,o=n.scrollLeft,a=n.scrollTop,s=0,l=0;this.scrollTimer=XL.createTimer(function(){var n=r.context.uiService.getMaxScrollValue(),u=n.maxScrollLeft,c=n.maxScrollTop;if(e<=0&&t<=0||!1===r.isScrolling)return XL.clearTimer(r.scrollTimer),r.scrollTimer=null,void(r.isScrolling=!1);e>=0&&("right"===r.scrollDirectionX?s-=40*e:s+=40*e,e+=i),t>=0&&("down"===r.scrollDirectionY?l-=40*t:l+=40*t,t+=i);var h=zO(o+s,0,u),d=zO(a+l,0,c);r.context.uiService.scrollTo(h,d);},25);}},{key:"wheelListener",value:function value(e){var t=this,i=this.context.config,r=e.wheelDelta;if(e.deltaY&&(r=-e.deltaY),1===e.deltaMode&&(r*=this.lineHeight),2===e.deltaMode&&(r=r<0?-100:100),e.ctrlKey&&i.enableZoomWithCtrl){if("multiple"!==i.displayMode){e.cancelable&&e.preventDefault();var n=r>0?i.wheelZoomDelta:1/i.wheelZoomDelta,o=this.context.rendererService.getCanvasPosition(),a=o.x,s=o.y;this.wheelTimer||(this.wheelTimer=hB(function(){t.context.zoomService.zoomTo(i.zoom*n,e.pageX-a,e.pageY-s),clearTimeout(t.wheelTimer),t.wheelTimer=null;},40));}}else e.shiftKey?(e.cancelable&&e.preventDefault(),this.context.uiService.scrollBy(-r,0)):(e.cancelable&&e.preventDefault(),this.context.uiService.scrollBy(0,-r));}}]);}(),kX=function(){return hS(function e(t){var i=this;dS(this,e),sS(this,"context",void 0),sS(this,"tabManager",void 0),sS(this,"appendPageTimer",null),sS(this,"selectPage",function(e){var t=i.context,r=t.groupUid,n=t.hooksService,o=t.viewerUid;if(e.groupUid===r){var a=i.getTab(e.docUid);if(a){i.isCurrentTab(a.uid)&&n.hooks.beforeBufferChanged.emit(e);var s=!e.triggerByScroll||e.triggerByScroll&&e.trigger!==o;s&&(a.select(e.selectedUids),!1!==e.updateShiftReference&&a.updateShiftReference()),i.isCurrentTab(a.uid)&&(s&&!1!==e.updateShiftReference&&i.context.emitCurrentIndexChanged(),n.hooks.afterBufferChanged.emit(e),s&&(i.context.showTab(a),i.context.handleOrigin(),i.context.renderOnly()));}}}),this.context=t,this.tabManager=new fj({tabMode:this.context.config.tabMode});},[{key:"destroy",value:function value(){this.appendPageTimer&&(clearTimeout(this.appendPageTimer),this.appendPageTimer=null);}},{key:"createTab",value:function value(e){var t,i=this,r=this.context.config,n=r.displayMode,o=r.toolType,a=r.scrollDirection,s=r.fitType,l=r.rows,u=r.columns,c=r.enableDWT1x1,h=r.pageStyle,d=r.selectedPageStyle,f=r.hoveredPageStyle,v=r.zoom,g=this.context.getBorderWidth(h),m=this.context.getBorderWidth(d),y=this.context.getBorderWidth(f),p=this.context.uiService.getViewportSize(),w={doc:e,displayMode:n,toolType:o,fitType:s,direction:a,viewWidth:p.width||800,viewHeight:p.height||800,dpr:1,scrollbarWidth:17,row:l,column:u,borderWidth:g,selectedBorderWidth:m,hoveredBorderWidth:y,enableDWT1x1:c,viewer:this.context.viewer},b=YP(t=this.tabManager).call(t,e.uid);if(!b){var k;(b=this.tabManager.createTab(e,w)).layoutStatus.zoom=v;var S=0;pS(k=e.children).call(k,function(e){var t=i.createPage(e);t&&(t.pageIndex=S,S+=1,b.pageMap.set(e,t),b.allPages.push(t));});}return b;}},{key:"getCurrentTab",value:function value(){return this.tabManager.getCurTab();}},{key:"getAllTabs",value:function value(){return this.tabManager.getAllTabs();}},{key:"isCurrentTab",value:function value(e){return this.tabManager.currentTabUid===e;}},{key:"updateTab",value:function value(e){var t,i=this,r=e.modifiedUid,n=e.data,o=this.context,a=o.viewerUid,s=o.groupUid,l=o.hooksService;pS(t=this.tabManager.getAllTabs()).call(t,function(e){var t=e.getChildByUid(r);if(t){var o,u,c,h,d={docUid:e.uid,trigger:a,groupUid:s,operation:"modify",modifiedUid:r};i.isCurrentTab(e.uid)&&l.hooks.beforeBufferChanged.emit(d),t.isPreload=!1,t.isLoaded=!1,t.isUpdated=!0,t.image.style.img=null,i.context.clearOptimization([t.uid]),pS(o=nE(u=t.blanks.childNodes).call(u)).call(o,function(e){t.blanks.removeChild(e);}),void 0!==(null===(c=n.metadata)||void 0===c?void 0:c.width)&&(t.realTimeWidth=n.metadata.width),void 0!==(null===(h=n.metadata)||void 0===h?void 0:h.height)&&(t.realTimeHeight=n.metadata.height),i.isCurrentTab(e.uid)&&(i.context.showTab(e),l.hooks.afterBufferChanged.emit(d));}});}},{key:"movePage",value:function value(e){var t=this.getTab(e.docUid);if(t){var i=this.context.hooksService;this.isCurrentTab(t.uid)&&i.hooks.beforeBufferChanged.emit(e),t.move(e.from,e.to),t.freshPageIndex(),this.isCurrentTab(t.uid)&&(this.context.emitCurrentIndexChanged(),i.hooks.afterBufferChanged.emit(e),this.context.showTab(t),this.context.renderOnly());}}},{key:"switchPage",value:function value(e){var t=this.getTab(e.docUid);if(t){var i=this.context.hooksService;this.isCurrentTab(t.uid)&&i.hooks.beforeBufferChanged.emit(e),t.switch(e.one,e.other),t.freshPageIndex(),this.isCurrentTab(t.uid)&&(this.context.emitCurrentIndexChanged(),i.hooks.afterBufferChanged.emit(e),this.context.showTab(t),this.context.renderOnly());}}},{key:"reorderPages",value:function value(e){var t,i=YP(t=this.tabManager).call(t,e.docUid);if(i){var r=this.context.hooksService;this.isCurrentTab(i.uid)&&r.hooks.beforeBufferChanged.emit(e),i.reorder(e.indexes),i.freshPageIndex(),this.isCurrentTab(i.uid)&&(r.hooks.afterBufferChanged.emit(e),this.context.showTab(i),this.context.emitCurrentIndexChanged());}}},{key:"changePage",value:function value(e){var t=this,i=this.context,r=i.groupUid,n=i.hooksService;if(e.groupUid===r){var o,a=YP(o=this.tabManager).call(o,e.docUid);if(a&&(a.current!==e.index||a.selected.length>1)){var s;this.isCurrentTab(a.uid)&&n.hooks.beforeBufferChanged.emit(e),pS(s=a.selected).call(s,function(e){var i=a.getChildByUid(e);i&&(t.context.isSelectedBorderWidthEqualNormal()||t.context.clearOptimization([i.uid]));});var l=a.getChildByIndex(e.index);this.context.isSelectedBorderWidthEqualHovered()&&this.context.isSelectedBorderWidthEqualNormal()||this.context.clearOptimization([l.uid]),a.goto(e.index),a.updateShiftReference(),this.isCurrentTab(a.uid)&&(this.context.emitCurrentIndexChanged(),n.hooks.afterBufferChanged.emit(e),this.context.showTab(a),this.context.handleOrigin(),this.context.renderOnly());}}}},{key:"removePagesFromDoc",value:function value(e,t){var i=this.getTab(e);if(i){var r=this.context.hooksService,n={removedUids:t,docUid:i.uid,operation:"remove"};this.isCurrentTab(i.uid)&&r.hooks.beforeBufferChanged.emit(n);var o=tk(t),a=rD(t).call(t,i.currentUid);if(a){var s=sE(t).call(t,i.currentUid);NE(o).call(o,s,1),o.push(i.currentUid);}pS(o).call(o,function(e){var t,r,n=i.getChildByUid(e);if(a&&e===i.currentUid)if(1===i.total)i.currentUid=null;else{var o=i.current===i.total-1?-1:1;i.currentUid=i.getUidByIndex(i.current+o);}i.selected=[i.currentUid],i.removeChild(n);var s=sE(t=i.allPages).call(t,n);NE(r=i.allPages).call(r,s,1),i.pageMap.delete(e),i.freshPageIndex(),n&&n.destroy();}),i.updateShiftReference(),i.total||(i.topPageUid=null,i.visibleChildren=[],i.preloadChildren=[],i.allPages=[],i.selected=[],i.layoutStatus.placeholderPages=[]),this.isCurrentTab(i.uid)&&(r.hooks.afterBufferChanged.emit(n),this.context.showTab(i),this.context.handleOrigin(),this.context.renderOnly());}}},{key:"appendPagesToDoc",value:function value(e,t){var i=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.getTab(e);if(o){var a=this.context,s=a.viewerUid,l=a.groupUid,u=a.hooksService,c=a.config,h={docUid:e,trigger:s,groupUid:l,operation:"add",isSameDoc:n};this.isCurrentTab(o.uid)&&u.hooks.beforeBufferChanged.emit(h);var d=r>-1;if(pS(t).call(t,function(e,t){var n,a=i.createPage(e);a&&(o.pageMap.set(e,a),d?NE(n=o.allPages).call(n,r+t,0,a):o.allPages.push(a));}),this.context.clearOptimization(t),o.freshPageIndex(),c.autoSelectLatest){o.currentPage&&this.context.clearOptimization([o.currentUid]);var f;f=d?r+t.length-1:o.total-1,o.currentUid=o.allPages[f].uid;var v=o.currentPage;v&&o.select([v.uid]),c.autoSelectLatest&&"single"!==c.displayMode&&"slide"!==c.displayMode&&this.context.config.show?this.context.emitCurrentIndexChanged():this.context.renderOnly();}else o.total>0&&-1===o.current&&(o.currentUid=null,o.select([o.getChildByIndex(0).uid]));o.updateShiftReference(),this.isCurrentTab(o.uid)&&(u.hooks.afterBufferChanged.emit(h),this.appendPageTimer||(this.appendPageTimer=hB(function(){o.isLoadPage=!0,i.getCurrentTab()===o&&(i.context.showTab(o),c.autoSelectLatest&&"single"!==c.displayMode&&"slide"!==c.displayMode&&i.context.config.show?i.context.emitCurrentIndexChanged():i.context.renderOnly()),clearTimeout(i.appendPageTimer),i.appendPageTimer=null;},300)));}}},{key:"openDoc",value:function value(e){var t=this.getCurrentTab();if(!t||t.uid!==e.uid){var i=this.context,r=i.config,n=i.hooksService,o=i.viewerUid,a=i.groupUid,s=this.getTab(e.uid);if(!s&&(s=this.createTab(e)).total>0){var l=0;r.autoSelectLatest&&(l=s.total-1),s.currentUid=s.getChildByIndex(l).uid,s.select([s.currentUid]);}this.context.showTab(s);var u={docUid:e.uid,trigger:o,groupUid:a,operation:"filter"};n.hooks.beforeBufferChanged.emit(u),n.hooks.afterBufferChanged.emit(u),r.autoSelectLatest&&"single"!==r.displayMode&&"slide"!==r.displayMode&&this.context.config.show?this.context.emitCurrentIndexChanged():this.context.renderOnly();}}},{key:"renameDoc",value:function value(e,t){var i=this.getTab(t);i&&(i.name=e);}},{key:"removeDoc",value:function value(e){return!!bO(e)&&!!this.tabManager.closeTab(e)&&(0===this.getAllTabs().length&&this.context.tabCleared(),this.context.render(),!0);}},{key:"getTab",value:function value(e){var t;return YP(t=this.tabManager).call(t,e);}},{key:"createPage",value:function value(e){var t=this.context.config,i=t.pageStyle,r=t.checkboxStyle,n=t.pageNumberStyle,o=t.removeBtnStyle,a=t.blankFillColor,s=t.defaultWidth,l=t.defaultHeight,u=this.getFormattedStyle(i),c=this.context.getStatus(e);if(!c)return null;var h=c.realTimeWidth,d=c.realTimeHeight;return new oj({uid:e,style:{visibility:"hidden",pointerEvents:"auto",width:h||s,height:d||l},formattedPageStyle:u,checkboxStyle:r,pageNumberStyle:n,removeBtnStyle:o,realTimeWidth:h,realTimeHeight:d,blankFillColor:a||"rgba(0,0,0,0)"});}},{key:"getFormattedStyle",value:function value(e){var t=e.border,i=e.background,r={};return t&&(r=LH(t)),uS({background:i},r);}},{key:"setViewportSize",value:function value(e,t){var i=this.tabManager.getCurTab();i&&i.updateLayoutStatus({viewWidth:e,viewHeight:t});}}]);}(),SX=function(){return hS(function e(t){dS(this,e),sS(this,"container",void 0),sS(this,"scrollContent",void 0),sS(this,"scrollContainer",void 0),sS(this,"canvasAndScrollContainer",void 0),sS(this,"canvasContainer",void 0),sS(this,"defaultDom",void 0),sS(this,"rootDom",void 0),sS(this,"hooks",{scroll:mL.create()}),sS(this,"isBindContainer",!1),sS(this,"viewerWidth",void 0),sS(this,"viewerHeight",void 0),sS(this,"context",void 0),sS(this,"dpr",hL()),this.context=t;},[{key:"initDefaultUI",value:function value(){var e=this,t=this.context,i=t.postfix,r=t.config,n=this.createDefaultUI(),o=n.querySelector("#dvs-canvas-container".concat(i)),a=n.querySelector("#dvs-scroller-and-canvas".concat(i)),s=n.querySelector("#dvs-scroll-container".concat(i)),l=n.querySelector("#dvs-scroll-content".concat(i));if(this.canvasAndScrollContainer=a,this.scrollContainer=s,this.scrollContent=l,this.canvasContainer=o,this.defaultDom=n,o&&s){var u=this.context.getBorderWidth(r.viewerStyle);cz(o.style,{left:"".concat(u,"px"),top:"".concat(u,"px")}),cz(s.style,r.viewerStyle);}var c=function c(t){e.hooks.scroll.emit(t);};this.scrollContainer.addEventListener("scroll",c),this.context.hooksService.hooks.destroy.on(function(){e.scrollContainer.removeEventListener("scroll",c);});}},{key:"createDefaultUI",value:function value(){var e=this.context,t=e.postfix;return e.config.pure?xX(XH,t):xX(jH,t);}},{key:"updateScrollContentSize",value:function value(e,t){this.scrollContent.style.width="".concat(e,"px"),this.scrollContent.style.height="".concat(t,"px");}},{key:"resizeViewport",value:function value(){var e=this.scrollContainer,t=e.clientWidth,i=e.clientHeight;return this.viewerWidth=e.offsetWidth,this.viewerHeight=e.offsetHeight,cz(this.canvasContainer.style,{width:"".concat(t,"px"),height:"".concat(i,"px")}),{width:t,height:i};}},{key:"getMaxScrollValue",value:function value(){var e=this.scrollContainer;return{maxScrollLeft:e.scrollWidth-e.clientWidth,maxScrollTop:e.scrollHeight-e.clientHeight};}},{key:"isViewerResized",value:function value(){return this.scrollContainer.offsetWidth!==this.viewerWidth||this.scrollContainer.offsetHeight!==this.viewerHeight;}},{key:"isDPRChanged",value:function value(){var e=hL();return this.dpr!==e&&(this.dpr=e,!0);}},{key:"isScrollbarAppeared",value:function value(){return this.scrollContent.offsetWidth>this.scrollContainer.clientWidth||this.scrollContent.offsetHeight>this.scrollContainer.clientHeight;}},{key:"getViewportSize",value:function value(){return{width:this.scrollContainer.clientWidth,height:this.scrollContainer.clientHeight};}},{key:"bindContainer",value:function value(e){if(!e)return!1;var t=e;return e&&bO(e)&&(t=document.querySelector("#".concat(e))),t.appendChild(this.defaultDom),this.container=t,this.rootDom=this.defaultDom,this.isBindContainer=!0,this.context.resize(),!0;}},{key:"unbindContainer",value:function value(){if(0===this.container.children.length)return!1;for(var e=0;e<this.container.children.length;e++)if(this.container.children[e]===this.rootDom){this.container.removeChild(this.rootDom);break;}return this.isBindContainer=!1,!0;}},{key:"scrollTo",value:function value(e,t){this.scrollContainer.scrollTo?this.scrollContainer.scrollTo(e,t):(this.scrollContainer.scrollLeft=e,this.scrollContainer.scrollTop=t);}},{key:"scrollBy",value:function value(e,t){this.scrollContainer.scrollBy?this.scrollContainer.scrollBy(e,t):(this.scrollContainer.scrollLeft+=e,this.scrollContainer.scrollTop+=t);}}]);}();function xX(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=e.tag,r=e.style,n=e.id,o=e.className,a=e.children,s=document.createElement(i);return n&&(s.id=n+t),o&&(s.className=o),cz(s.style,r||{}),a&&pS(a).call(a,function(e){var i=xX(e,t);s.appendChild(i);}),s;}var CX=function(){return hS(function e(t){dS(this,e),sS(this,"context",void 0),sS(this,"zoomOriginCache",void 0),this.context=t;},[{key:"zoomTo",value:function value(e,t,i){var r;if((e=zO(e,this.context.config.minZoom,this.context.config.maxZoom))===this.context.config.zoom)return!1;var n=this.formatZoomOrigin(t,i);this.updateZoomReferencePoint(n),this.context.config.fitType="none",this.context.config.zoom=e;var o=null===(r=this.context)||void 0===r?void 0:r.getCurrentTab();if(o){if(o.layoutStatus.zoom=e,o.fitType="none","multiple"===this.context.config.displayMode)return!1;this.context.layoutService.layout(o),n=this.formatZoomOrigin(t,i);var a=this.alignZoomReferencePoint(n),s=a.scrollLeft,l=a.scrollTop;return o.updateLayoutStatus({scrollLeft:s,scrollTop:l}),this.context.uiService.scrollTo(s,l),this.context.scrollerService.updateScroller({scrollLeft:s,scrollTop:l}),this.context.clearCurTabOptimization(),this.context.rendererService.render(),!0;}return!1;}},{key:"formatZoomOrigin",value:function value(e,t){var i=this.context.rendererService.canvasDom.getBoundingClientRect(),r=i.width,n=i.height;if(pO(e)||pO(t)){var o=this.context.config.zoomOrigin,a=.5,s=.5;"left"===o.x?a=0:"right"===o.x&&(a=1),"top"===o.y?s=0:"bottom"===o.y&&(s=1),e=r*a,t=n*s;}return{originX:e=zO(e,0,r),originY:t=zO(t,0,n)};}},{key:"updateZoomReferencePoint",value:function value(e){var t,i,r,n,o=this,a=e.originX,s=e.originY,l=null,u=this.context.getPointerOverPageInfo(a,s).pageInfo.obj;if(u){var c=u.imageContainer.getPosition();r=(a-c.x)/this.context.config.zoom,n=(s-c.y)/this.context.config.zoom,t="center",i="center",l=u.uid;}else{var h,d,f=null===(h=this.context)||void 0===h?void 0:h.getCurrentTab(),v=Number.MAX_VALUE;null==f||pS(d=f.preloadChildren).call(d,function(e){if(e.isVisible){var u=e.imageContainer.getPosition(),c=e.imageContainer,h=c.width,d=c.height,f=new kL(u.x+h/2,u.y+d/2).distanceTo({x:a,y:s});f<v&&(v=f,l=e.uid,a<u.x?(t="start",r=u.x-a):a>u.x+h?(t="end",r=a-(u.x+h)):(t="center",r=(a-u.x)/o.context.config.zoom),s<u.y?(i="start",n=u.y-s):s>u.y+d?(i="end",n=s-(u.y+d)):(i="center",n=(s-u.y)/o.context.config.zoom));}});}this.zoomOriginCache={imageX:r,imageY:n,positionX:t,positionY:i,pageUid:l};}},{key:"alignZoomReferencePoint",value:function value(e){var t,i=e.originX,r=e.originY,n=0,o=0,a=this.zoomOriginCache,s=a.imageX,l=a.imageY,u=a.positionX,c=a.positionY,h=a.pageUid,d=null===(t=this.context)||void 0===t?void 0:t.getCurrentTab();if(d){var f=d.getChildByUid(h);if(f){var v,g,m=f.imageContainer.getPosition();"start"===u?v=m.x-s:"center"===u?v=m.x+s*this.context.config.zoom:"end"===u&&(v=m.x+f.imageContainer.width+s),"start"===c?g=m.y-l:"center"===c?g=m.y+l*this.context.config.zoom:"end"===c&&(g=m.y+f.imageContainer.height+l),n=v-i,o=g-r;}}var y=this.context.uiService.scrollContainer,p=y.scrollLeft,w=y.scrollTop,b=this.context.uiService.getMaxScrollValue(),k=b.maxScrollLeft,S=b.maxScrollTop;return w+=o,{scrollLeft:p=zO(p+=n,0,k),scrollTop:w=zO(w,0,S)};}}]);}(),VX=function(){return hS(function e(t,i){dS(this,e),sS(this,"viewerUid",void 0),sS(this,"postfix",void 0),sS(this,"groupUid",void 0),sS(this,"emitter",void 0),sS(this,"viewer",void 0),sS(this,"config",_mO(YH)),sS(this,"dvsContext",void 0),sS(this,"boxRenderer",void 0),sS(this,"configService",void 0),sS(this,"hooksService",void 0),sS(this,"layoutService",void 0),sS(this,"rendererService",void 0),sS(this,"scrollerService",void 0),sS(this,"tabService",void 0),sS(this,"uiService",void 0),sS(this,"zoomService",void 0),sS(this,"isFocus",!1),sS(this,"defaultWidth",600),sS(this,"defaultHeight",800),sS(this,"isDestroyed",!1),sS(this,"scrollByCurrentChanged",!1),sS(this,"iListeners",[]),sS(this,"draggingPrepared",!1),sS(this,"showOutline",!1),this.viewer=t,this.configService=new gX(this),this.hooksService=new mX(this),this.layoutService=new pX(this),this.rendererService=new wX(this),this.scrollerService=new bX(this),this.tabService=new kX(this),this.uiService=new SX(this),this.zoomService=new CX(this),this.viewerUid=AO(),this.groupUid=i.groupUid,MO(i.viewerConfig||{},this.config),this.emitter=i.emitter,this.postfix="-".concat(this.viewerUid),this.dvsContext=i.dvsContext,this.uiService.initDefaultUI(),this.initPlugins(),i.container&&this.uiService.bindContainer(i.container),this.config.show||(this.uiService.rootDom?this.uiService.rootDom.style.display="none":this.uiService.defaultDom.style.display="none");},[{key:"initPlugins",value:function value(){var e=this;new KH().init(this),new vj().init(this),new gj().init(this),new JH().init(this),new mj().init(this),new qH().init(this),pS(TX).call(TX,function(t){return t.init(e);});}},{key:"setDisableFocusOutline",value:function value(e){var t,i;this.showOutline=!e;var r=null==this||null===(t=this.rendererService)||void 0===t?void 0:t.canvasDom,n=null==this||null===(i=this.uiService)||void 0===i?void 0:i.scrollContainer;e?(n.classList.add("dvs-disable-outline"),r.classList.add("dvs-disable-outline")):(n.classList.remove("dvs-disable-outline"),r.classList.remove("dvs-disable-outline"));}},{key:"clearCurTabOptimization",value:function value(){var e=this.getCurrentTab();if(e){var t=e.getChildUids();this.clearOptimization(t);}}},{key:"clearOptimization",value:function value(e){var t=[],i=this.getCurrentTab();i&&pS(e).call(e,function(e){var r=i.getChildByUid(e);r&&(t.push(e),r.clearOptimization());}),this.dvsContext.optimizationService.cancelOptimizePage(t);}},{key:"updateViewerConfig",value:function value(e){this.configService.updateConfig(e);}},{key:"setViewMode",value:function value(e,t){if(!CO(t)||!CO(e))return this.err(sO),!1;if(e<=0||t<=0)return this.err(lO),!1;var i=this.config.rows!==e||this.config.columns!==t;this.config.rows=e,this.config.columns=t;var r=this.getCurrentTab();return r&&(r.row=e,r.column=t,this.resetScrollbarStatus(),this.clearCurTabOptimization(),this.render(),i&&this.emitCurrentIndexChanged()),this.ok(),!0;}},{key:"syncFromViewer",value:function value(e){var t=this,i=e.context.tabService.getAllTabs(),r=e.context.tabService.getCurrentTab();pS(i).call(i,function(e){var i,n,o=t.tabService.createTab(e.doc);o.currentUid=e.currentUid,o.select(nE(i=e.selected).call(i)),pS(n=e.allPages).call(n,function(e,t){var i,r,n=o.getChildByIndex(t);e.blanks.children.length&&pS(i=e.blanks.children).call(i,function(e){var t=new UF({id:e.id,style:{points:[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],background:e.style.background,borderWidth:0}});n.blanks.appendChild(t);}),e.overlays.children.length&&pS(r=e.overlays.children).call(r,function(e){var t,i=new UF({id:e.id,style:{points:nE(t=e.style.points).call(t),background:e.style.background,borderWidth:0,opacity:e.style.opacity}});n.overlays.appendChild(i);});}),r.uid===o.uid&&t.showTab(o);});}},{key:"getStatus",value:function value(e){return this.dvsContext.spaceService.getStatus(e);}},{key:"getGlobalHooks",value:function value(){return this.dvsContext.hooksService.hooks;}},{key:"getLocalHooks",value:function value(){return this.hooksService.hooks;}},{key:"getCurrentTab",value:function value(){return this.tabService.getCurrentTab();}},{key:"getTab",value:function value(e){return this.tabService.getTab(e);}},{key:"getAllTabs",value:function value(){return this.tabService.getAllTabs();}},{key:"showTab",value:function value(e){var t,i,r=this;this.tabService.tabManager.setCurrentTab(e.uid),e.style.visibility="visible",this.config.show&&(0===e.total&&(this.resetScrollbarStatus(),this.resetScrollerSize(),this.resize()),this.layoutService.layout(e),0!==e.layoutStatus.viewWidth&&0!==e.layoutStatus.viewHeight&&(0===e.selected.length&&"single"===this.config.displayMode&&(pS(t=e.allPages).call(t,function(e){e.updateStyle({visibility:"hidden"});}),this.resetScrollbarStatus(),this.resetScrollerSize(),this.resize()),pS(i=e.preloadChildren).call(i,function(e){e.isPreload&&!e.isLoaded&&("multiple"===r.config.displayMode&&r.config.useMinImage?r.dvsContext.minImageService.load(e.uid):r.dvsContext.imageService.load(e.uid));}),this.hooksService.hooks.pageChanged.emit({current:e.current,total:e.total})));}},{key:"emitCurrentIndexChanged",value:function value(){var e=this.tabService.getCurrentTab();if(e&&(this.layoutService.layout(e),e.currentPage)){var t={isPassive:!1,trigger:this.viewerUid,docUid:""};this.hooksService.hooks.currentIndexChanged.emit(t);}}},{key:"resize",value:function value(){this.rendererService.resetCanvasSize();var e=this.uiService.resizeViewport(),t=e.width,i=e.height,r=hL();this.rendererService.canvas.setDPR(r),this.rendererService.canvas.resize(t,i),this.tabService.setViewportSize(t,i),this.scrollerService.updateScroller({viewportWidth:t,viewportHeight:i});}},{key:"resized",value:function value(){this.uiService.isBindContainer&&this.config.show&&(this.resetScrollbarStatus(),this.resize(),this.hooksService.hooks.resize.emit(),this.emitCurrentIndexChanged(),this.clearCurTabOptimization(),this.rendererService.render(),this.handleOrigin(),this.emit("resize",this.viewer.width,this.viewer.height));}},{key:"externalResized",value:function value(){if((this.uiService.isViewerResized()||this.uiService.isDPRChanged())&&this.uiService.isBindContainer&&this.config.show){this.resetScrollbarStatus(),this.resetScrollerSize(),this.resize(),this.hooksService.hooks.externalResized.emit(),this.emitCurrentIndexChanged();var e=this.getCurrentTab();e&&(this.layoutService.layout(e),this.clearCurTabOptimization()),this.rendererService.render(),this.handleOrigin(),this.emit("resize",this.viewer.width,this.viewer.height);}}},{key:"handleOrigin",value:function value(){if("single"===this.config.displayMode){var e=this.uiService.getMaxScrollValue(),t=e.maxScrollLeft,i=e.maxScrollTop,r=this.config.zoomOrigin,n=r.x,o=r.y,a=t/2,s=i/2;"left"===n?a=0:"right"===n&&(a=t),"top"===o?s=0:"bottom"===o&&(s=i),this.uiService.scrollTo(a,s);}}},{key:"getScrollbarWidth",value:function value(){var e,t=document.createElement("div"),i=document.createElement("div");if(t.appendChild(i),t.style.width="60px",t.style.height="60px",t.style.position="absolute",t.style.overflow="auto",i.style.width="100px",i.style.height="100px",null===(e=document)||void 0===e||!e.body)return 0;document.body.appendChild(t);var r=t.offsetWidth-t.clientWidth;return document.body.removeChild(t),r;}},{key:"selectPage",value:function value(e){this.tabService.selectPage(e),this.dvsContext.hooksService.hooks.selectPage.emit(e);}},{key:"getCanvasDpr",value:function value(){return this.rendererService.canvas.contextService.getDPR();}},{key:"optimizePage",value:function value(e){var t=this;if(this.config.enableOptimizeImage){var i=this.tabService.getCurrentTab();if(i){var r=i.getChildByUid(e);if(!r)return;if(r.isOptimized||!r.isVisible||!r.isLoaded||r.optimizationUid===r.optimizedUid||this.scrollerService.isSliding||this.isDestroyed)return;var n=this.getStatus(e);if(!(null!=n&&n.img||null!=n&&n.minImg))return;var o=r.image.style.img,a=o.naturalWidth,s=o.naturalHeight,l=a,u=s,c=this.config.maxOptimizationSize;if(l>c||u>c||r.realTimeWidth>c||r.realTimeHeight>c)return;var h=hL(),d=Math.floor(r.imageContainer.width*h-1),f=Math.floor(r.imageContainer.height*h-1);this.dvsContext.optimizationService.optimize(r.optimizationUid,function(){var e,i=[],c=[];if(t.dvsContext.editService){var h={operations:n.operations,width:a,height:s};"multiple"===t.config.displayMode&&t.config.useMinImage&&(h.operations=t.dvsContext.editService.toMinImageOperations(n.operations,n.imageScale));var v=t.dvsContext.editService.handle(h);l=v.width,u=v.height,i=v.matrixes,c=v.blanks||[];}var g=new BF({style:{x:0,y:0,img:o,width:a,height:s}});g.externalMatrixes=i;var m="rgba(0,0,0,0)";if("multiple"===t.config.displayMode){var y=t.config.pageStyle;r.isSelected?y=t.config.selectedPageStyle:r.isHovered&&(y=t.config.hoveredPageStyle),m=y.background;}n.useFillColor&&(m=t.config.blankFillColor);var p=new EF({style:{x:0,y:0,width:l,height:u,background:m}}),w=new EF();pS(c).call(c,function(e){var t=new UF({id:e.uid,style:{background:e.background,points:e.points,borderWidth:0}});w.appendChild(t);}),g.appendChild(w),p.appendChild(g);var b=new EF();pS(e=r.overlays.children).call(e,function(e){var t,i=new UF({id:e.id,style:{points:nE(t=e.style.points).call(t),background:e.style.background,borderWidth:0,opacity:e.style.opacity}});b.appendChild(i);}),p.appendChild(b),t.dvsContext.commonCanvas.render(p),t.dvsContext.commonCanvas.clear();var k=t.dvsContext.commonCanvas.getCanvas().getContext("2d",{willReadFrequently:!0}),S=Math.floor(l)||1,x=Math.floor(u)||1,C=k.getImageData(0,0,S,x);return{taskUid:r.optimizationUid,sourceWidth:S,sourceHeight:x,width:Math.ceil(d)||1,height:Math.ceil(f)||1,source:C};}).then(function(e){if(!t.isDestroyed&&e.taskUid===r.optimizationUid){r.isOptimized=!0,r.optimizedUid=r.optimizationUid;var i=t.dvsContext.commonCanvas.getCanvas().getContext("2d",{willReadFrequently:!0}).createImageData(d,f);i.data.set(e.target),r.imageContainer.imageData=i,r.isVisible&&t.render();}}).catch(function(e){r.isOptimized=!1;});}}}},{key:"renderPage",value:function value(e){if(!(this.isDestroyed||this.config.useMinImage&&"multiple"===this.config.displayMode)){var t=this.tabService.getCurrentTab();if(t){var i=t.getChildByUid(e);if(i){var r=this.dvsContext.spaceService.getStatus(e);r&&(r.img&&(i.isLoaded=!0,i.updateImage(r.img)),i.isVisible&&(this.render(),this.handleOrigin()));}}}}},{key:"renderMinPage",value:function value(e){if(!this.isDestroyed&&this.config.useMinImage&&"multiple"===this.config.displayMode){var t=this.tabService.getCurrentTab();if(t){var i=t.getChildByUid(e);if(i){var r=this.dvsContext.spaceService.getStatus(e);r&&(r.minImg&&(i.isLoaded=!0,i.updateImage(r.minImg)),i.isVisible&&(this.render(),this.handleOrigin()));}}}}},{key:"renderOnly",value:function value(){this.rendererService.render();}},{key:"render",value:function value(){if(!this.config.show)return!1;if(this.isDestroyed)return!1;var e=this.tabService.getCurrentTab();if(e){var t;this.layoutService.layout(e),0===e.selected.length&&"single"===this.config.displayMode&&(pS(t=e.allPages).call(t,function(e){e.updateStyle({visibility:"hidden"});}),this.resetScrollbarStatus(),this.resetScrollerSize(),this.resize()),this.config.zoom=e.layoutStatus.zoom;var i=this.uiService.scrollContainer,r=i.scrollLeft,n=i.scrollTop;e.setPosition({x:-r,y:-n}),e.updateLayoutStatus({scrollLeft:r,scrollTop:n}),this.scrollerService.updateScroller({scrollLeft:r,scrollTop:n});}return this.rendererService.render(),this.ok(),!0;}},{key:"tabCleared",value:function value(){this.uiService.updateScrollContentSize(0,0),this.scrollerService.updateScroller({contentWidth:0,contentHeight:0}),this.render();}},{key:"storeActionToStatus",value:function value(e){var t,i=this;pS(t=(e=_mO(e)).uids).call(t,function(t){var r=i.getStatus(t);if(r){var n=r.operations[r.operations.length-1];n&&n.type===e.actionType||(n={type:e.actionType,detail:[]},r.operations.push(n)),n.detail.push(e);}});}},{key:"removeActionFromStatus",value:function value(e){var t,i=this;pS(t=e.uids).call(t,function(t){var r=i.getStatus(t);if(r){var n=r.operations[r.operations.length-1];if(n&&n.type===e.actionType&&(n.detail.pop(),!n.detail.length)){var o,a,s=sE(o=r.operations).call(o,n);s>-1&&NE(a=r.operations).call(a,s,1);}}});}},{key:"isEmpty",value:function value(){var e=this.getCurrentTab();return!e||0===e.allPages.length;}},{key:"resetScrollbarStatus",value:function value(){var e,t=this;pS(e=this.getAllTabs()).call(e,function(e){e.layoutStatus.scrollbarWidth=t.getScrollbarWidth(),e.layoutStatus.resetScrollbarStatus();});}},{key:"resetScrollerSize",value:function value(){var e=this.uiService.scrollContainer;this.rendererService.canvasDom.style.width="0px",this.rendererService.canvasDom.style.height="0px",this.uiService.canvasContainer.style.width="0px",this.uiService.canvasContainer.style.height="0px",this.uiService.scrollContent.style.width="0px",this.uiService.scrollContent.style.height="0px";var t=e.clientWidth,i=e.clientHeight;cz(this.uiService.canvasContainer.style,{width:"".concat(t,"px"),height:"".concat(i,"px")});}},{key:"setScrollbarWidth",value:function value(e){var t;pS(t=this.tabService.tabManager.tabs).call(t,function(t){t.scrollbarWidth=e;});}},{key:"getPointerOverPageInfo",value:function value(e,t){var i=function(e,t,i){var r={pageInfo:{isOver:!1,pointerX:-1,pointerY:-1,obj:null,pagePositionX:-1,pagePositionY:-1,pageWidth:-1,pageHeight:-1},imageInfo:{isOver:!1,pointerX:-1,pointerY:-1,obj:null},index:-1};if(e)for(var n=0;n<e.preloadChildren.length;n++){var o=e.preloadChildren[n],a=WH(o,t,i);if(a.isOver){r.index=o.pageIndex;var s=o.getPosition(),l=s.x,u=s.y,c=o.getScale(),h=c.x,d=c.y;a.pagePositionX=l,a.pagePositionY=u,a.pageWidth=o.parsedStyle.width.value*h,a.pageHeight=o.parsedStyle.height.value*d,cz(r.pageInfo,a);var f=WH(o.imageContainer,t,i);return cz(r.imageInfo,f),r;}}return r;}(this.tabService.getCurrentTab(),e,t);return i;}},{key:"getHitRemoveBtn",value:function value(e,t){var i=this.getCurrentTab();if(i)for(var r=0;r<i.preloadChildren.length;r++){var n=i.preloadChildren[r];if(n.isVisible&&n.removeBtn.isVisible){var o=n.removeBtn.parsedCheckBoxStyle,a=o.x,s=o.y,l=o.width,u=o.height,c=n.getPosition(),h=c.x,d=c.y;if(e>=a+h&&t>=s+d&&e<=a+h+l&&t<=s+d+u)return r;}}return-1;}},{key:"getCanvasPosition",value:function value(){return this.rendererService.getCanvasPosition();}},{key:"getBorderWidth",value:function value(e){var t=e.border;if(!t)return 0;var i=t.match(/[0-9]+/g)[0];return px(i||"0",10);}},{key:"isBorderWidthEqualHovered",value:function value(){return this.getBorderWidth(this.config.pageStyle)===this.getBorderWidth(this.config.hoveredPageStyle);}},{key:"isSelectedBorderWidthEqualHovered",value:function value(){return this.getBorderWidth(this.config.selectedPageStyle)===this.getBorderWidth(this.config.hoveredPageStyle);}},{key:"isSelectedBorderWidthEqualNormal",value:function value(){return this.getBorderWidth(this.config.pageStyle)===this.getBorderWidth(this.config.selectedPageStyle);}},{key:"formatTouches",value:function value(e){var t,i=[];t=e instanceof MouseEvent||e instanceof PointerEvent?[e]:arguments.length>1&&void 0!==arguments[1]&&arguments[1]?e.changedTouches:e.touches;for(var r=this.rendererService.getCanvasPosition(),n=r.x,o=r.y,a=0;a<t.length;a++){var s=t[a];i.push({pageX:s.pageX-n,pageY:s.pageY-o});}return i;}},{key:"getMargin",value:function value(){return this.formatMarginAndGap(this.config.margin);}},{key:"getGap",value:function value(){return this.formatMarginAndGap(this.config.gap);}},{key:"formatMarginAndGap",value:function value(e){if(bO(e)){if(/px/.test(e)){var t=ek(e.match(/(\d+)/),1)[0];return px(t,10);}if(/%/.test(e)){var i=this.rendererService.canvasDom.width/hL(),r=ek(e.match(/(\d+)/),1)[0];return i*px(r,10)/100;}if(/em/.test(e)){var n=ek(getComputedStyle(this.rendererService.canvasDom).fontSize.match(/(\d+)/),1)[0],o=ek(e.match(/(\d+)/),1)[0];return px(n,10)*px(o,10);}}return CO(e)?e:px(e,10);}},{key:"saveEvents",value:function value(){this.emitter.save();}},{key:"restoreEvents",value:function value(){this.emitter.restore();}},{key:"on",value:function value(e,t){if(bO(e)&&TO(t)){var i=this.emitter.on(e,t);this.iListeners.push(i);}else this.err(sO);}},{key:"emit",value:function value(e){for(var t,i,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];bO(e)?(t=this.emitter).emit.apply(t,BS(i=[e]).call(i,n)):this.err(sO);}},{key:"off",value:function value(e,t){bO(e)&&(void 0===t||TO(t))?this.emitter.off(e,t):this.err(sO);}},{key:"err",value:function value(e){this.dvsContext.errorService.err(e);}},{key:"ok",value:function value(){this.err(aO);}},{key:"unbindEvents",value:function value(){var e,t=this;pS(e=this.iListeners).call(e,function(e){var i=e.name,r=e.fn,n=e.context,o=e.once;t.emitter.off(i,r,n,o);}),this.iListeners=[];}},{key:"destroy",value:function value(){this.isDestroyed||(this.getLocalHooks().destroy.emit(),this.scrollerService.destroy(),this.tabService.destroy(),this.unbindEvents(),this.isDestroyed=!0);}},{key:"getVisiblePagesInfo",value:function value(){var e,t=this.tabService.getCurrentTab();if(!t)return[];if(0===(null==t||null===(e=t.allPages)||void 0===e?void 0:e.length))return[];if(!this.viewer.getViewerConfig().show)return[];var i=t.visibleChildren,r=[];if(i.length>0){var n,o=this.rendererService,a=this.uiService.container;null!==(n=this.viewer)&&void 0!==n&&n.isThumbnail&&(a=this.viewer.thumbnailObject.viewer.context.uiService.container);var s=o.canvasDom,l=a.getBoundingClientRect(),u=l.left,c=l.top,h=s.getBoundingClientRect(),d=h.left,f=h.top,v=t.getIndexByUid(i[0].id);pS(i).call(i,function(e,t){!function(e,t){if(e.isVisible){var i=e.getPosition(),n=i.x,o=i.y,a=e.getScale(),s=a.x,l=a.y,h=Math.round(e.parsedStyle.width.value*s*10)/10,v=Math.round(e.parsedStyle.height.value*l*10)/10;r.push({pageIndex:t,isHovered:e.isHovered,isSelected:e.isSelected,pageWidth:h,pageHeight:v,canvasOffsetX:Math.round(10*n)/10,canvasOffsetY:Math.round(10*o)/10,containerOffsetX:Math.round(10*(d-u+n))/10,containerOffsetY:Math.round(10*(f-c+o))/10});}}(e,v+t);});}return r;}}]);}(),TX=[],IX=function(){return hS(function e(t){dS(this,e),sS(this,"context",void 0),sS(this,"OriginalViewer",e),sS(this,"uid",void 0),sS(this,"groupUid",null),sS(this,"postfix",void 0),sS(this,"destroyFlag",!1),this.context=new VX(this,t),this.uid=this.context.viewerUid,this.postfix=this.context.postfix,this.groupUid=this.context.groupUid;},[{key:"isDestroyed",get:function get(){return this.destroyFlag;}},{key:"currentPageCount",get:function get(){var e=this.getCurrentTab();return(null==e?void 0:e.total)||0;}},{key:"rootDom",get:function get(){return this.context.uiService.rootDom;}},{key:"defaultDom",get:function get(){return this.context.uiService.defaultDom;}},{key:"container",get:function get(){return this.context.uiService.container;}},{key:"scrollContainer",get:function get(){return this.context.uiService.scrollContainer;}},{key:"canvasContainer",get:function get(){return this.context.uiService.canvasContainer;}},{key:"updateViewerConfig",value:function value(e){this.context.updateViewerConfig(e);}},{key:"getViewerConfig",value:function value(){var e;return null==this||null===(e=this.context)||void 0===e?void 0:e.config;}},{key:"getViewerConfigByName",value:function value(e){return this.context.config[e];}},{key:"show",value:function value(){if(!0!==this.context.config.show){this.context.config.show=!0;var e=this.context.uiService,t=e.rootDom,i=e.defaultDom;t&&(t.style.display="flex",i.style.display="flex"),this.resized();var r=this.getCurrentTab();return r&&this.context.showTab(r),!0;}return!1;}},{key:"hide",value:function value(){if(!1!==this.context.config.show){this.context.config.show=!1;var e=this.context.uiService.rootDom;return e&&(e.style.display="none"),!0;}return!1;}},{key:"bindContainer",value:function value(e){return this.context.uiService.bindContainer(e);}},{key:"unbindContainer",value:function value(){return this.context.uiService.unbindContainer();}},{key:"externalResized",value:function value(){this.context.externalResized();}},{key:"resized",value:function value(){this.context.resized();}},{key:"checkPageVisibility",value:function value(e){var t={min:!1,ori:!1},i=this.getCurrentTab();if(i){var r=i.getChildByUid(e);r&&r.isPreload&&("multiple"===this.context.config.displayMode&&this.context.config.useMinImage?t.min=!0:t.ori=!0);}return t;}},{key:"getCurrentTab",value:function value(){var e;return null===(e=this.context)||void 0===e?void 0:e.getCurrentTab();}},{key:"getTab",value:function value(e){return bO(e)?this.context.tabService.getTab(e):(this.err(sO),null);}},{key:"getAllTabs",value:function value(){return this.context.tabService.getAllTabs();}},{key:"removePage",value:function value(e){if(CO(e)&&(e=[e]),!vO(e))return this.err(sO),!1;var t=e.length;if(0===t)return this.err(cO),!1;var i=this.getCurrentTab();if(!i)return!1;for(var r=[],n=0;n<t;n++){var o=this.getUidByIndex(e[n]);if(!o)return!1;r.push(o);}var a={removedUids:r,docUid:i.uid,trigger:this.uid,operation:"remove"};return this.context.getLocalHooks().remove.emit(a),!0;}},{key:"removeAllPages",value:function value(){var e=this.getCurrentTab();if(e){var t,i={removedUids:wP(t=e.allPages).call(t,function(e){return e.uid;}),docUid:e.uid,trigger:this.uid,operation:"remove"};e.visibleChildren=[],this.context.getLocalHooks().remove.emit(i);}return this.ok(),!0;}},{key:"switchPage",value:function value(e,t){var i=this.getCurrentTab();if(!i||!this.isIndexValid(i,e)||!this.isIndexValid(i,t))return!1;var r={one:e,other:t,trigger:this.uid,docUid:i.uid,type:i.type,operation:"shift"};return this.context.getLocalHooks().switch.emit(r),!0;}},{key:"movePage",value:function value(e,t){var i=this.getCurrentTab();if(!i||!this.isIndexValid(i,e)||!this.isIndexValid(i,t))return!1;var r={from:e,to:t,trigger:this.uid,docUid:i.uid,type:i.type,operation:"shift"};return this.context.getLocalHooks().move.emit(r),!0;}},{key:"reorderPage",value:function value(e){var t=this.getCurrentTab();if(!t||!vO(e)||t.total!==e.length)return!1;var i={indexes:e,trigger:this.uid,docUid:t.uid,type:t.type,operation:"shift"};return this.context.getLocalHooks().reorder.emit(i),!0;}},{key:"setViewMode",value:function value(e,t){return this.context.setViewMode(e,t);}},{key:"nextPage",value:function value(){var e=this.getCurrentTab();if(!e)return-1;var t=e.current;if(t+1===e.total&&e.selected.length<=1)return t;var i={index:t+1,docUid:e.uid,trigger:this.uid,groupUid:this.groupUid,operation:"shift"};return this.context.getLocalHooks().changePage.emit(i),e.current;}},{key:"prevPage",value:function value(){var e=this.getCurrentTab();if(!e)return-1;var t=e.current;if(t-1<0&&e.selected.length<=1)return t;var i={index:t-1,docUid:e.uid,trigger:this.uid,groupUid:this.groupUid,operation:"shift"};return this.context.getLocalHooks().changePage.emit(i),e.current;}},{key:"firstPage",value:function value(){var e=this.getCurrentTab();if(!e)return-1;var t=e.current;if(0===t&&e.selected.length<=1)return t;var i={index:0,docUid:e.uid,trigger:this.uid,groupUid:this.groupUid,operation:"shift"};return this.context.getLocalHooks().changePage.emit(i),e.current;}},{key:"lastPage",value:function value(){var e=this.getCurrentTab();if(!e)return-1;var t=e.current,i=e.total;if(t===i-1&&e.selected.length<=1)return t;var r={index:i,docUid:e.uid,trigger:this.uid,groupUid:this.groupUid,operation:"shift"};return this.context.getLocalHooks().changePage.emit(r),e.current;}},{key:"gotoPage",value:function value(e){var t=this.getCurrentTab();if(!t)return-1;var i=t.current;if(e>t.total-1||e<0)return-1;if(i===e&&t.selected.length<=1)return i;var r={index:e,docUid:t.uid,trigger:this.uid,groupUid:this.groupUid,operation:"shift"};return this.context.getLocalHooks().changePage.emit(r),t.current;}},{key:"getCurrentIndex",value:function value(){var e=this.getCurrentTab();return e?(this.err(aO),e.current):(this.err(uO),-1);}},{key:"setCurrentIndex",value:function value(e){return-1!==this.gotoPage(e);}},{key:"setSelectedIndexes",value:function value(e){if(!vO(e))return this.err(sO),!1;var t=this.getCurrentTab();if(!t)return!1;var i=t.selected,r=!1;i.length!==e.length&&(r=!0);for(var n=[],o=0;o<e.length;o++){var a=this.getUidByIndex(e[o]);if(!a)return!1;i[o]!==a&&(r=!0),n.push(a);}if(!r)return!0;var s={selectedUids:n,indexes:e,docUid:t.uid,trigger:this.uid,groupUid:this.groupUid,operation:"shift"};return this.context.getLocalHooks().selectPage.emit(s),!0;}},{key:"getSelectedIndexes",value:function value(){var e,t=this.getCurrentTab();if(!t)return this.err(uO),null;var i=wP(e=t.selected).call(e,function(e){return t.getIndexByUid(e);});return this.ok(),i;}},{key:"selectAll",value:function value(){var e,t=this.getCurrentTab();if(!t)return this.err(uO),!1;var i=tk(yD(e=Array(t.total)).call(e));return this.setSelectedIndexes(i);}},{key:"getIndexByUid",value:function value(e){if(!bO(e))return null;var t=this.getCurrentTab();if(!t)return this.err(uO),null;var i=t.getIndexByUid(e);return i>-1?this.ok():this.err(cO),i;}},{key:"getUidByIndex",value:function value(e){var t=this.getCurrentTab();return t?this.isIndexValid(t,e)?(this.ok(),t.getUidByIndex(e)):null:(this.err(uO),null);}},{key:"undo",value:function value(){var e=this.getCurrentTab();if(e){var t=e.commandController.undoStack,i=t[t.length-1];if(i){var r={commandUid:i.uid,trigger:this.uid};return this.context.clearOptimization(i.action.uids),this.context.getGlobalHooks().undo.emit(r),!0;}}return!1;}},{key:"redo",value:function value(){var e=this.getCurrentTab();if(e){var t=e.commandController.redoStack,i=t[t.length-1];if(i){var r={commandUid:i.uid,trigger:this.uid};return this.context.clearOptimization(i.action.uids),this.context.storeActionToStatus(i.action),this.context.getGlobalHooks().redo.emit(r),!0;}}return!1;}},{key:"reset",value:function value(e){var t=this;if(!HH(this,e=FH(this,e)))return!1;var i=this.getCurrentTab(),r=wP(e).call(e,function(e){return i.getChildByIndex(e).uid;}),n={tabUid:i.uid,tabType:i.type,trigger:this.uid,uids:r};return pS(r).call(r,function(e){var i=t.context.getStatus(e);i&&(i.operations=[]);}),this.context.clearOptimization(r),this.context.getGlobalHooks().reset.emit(n),!0;}},{key:"zoomIn",value:function value(){var e=this.getViewerConfigByName("zoom");this.updateViewerConfig({zoom:1.2*e});}},{key:"zoomOut",value:function value(){var e=this.getViewerConfigByName("zoom");this.updateViewerConfig({zoom:e/1.2});}},{key:"render",value:function value(){return this.context.render();}},{key:"on",value:function value(e,t){this.context.on(e,t);}},{key:"emit",value:function value(e){for(var t,i,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];(t=this.context).emit.apply(t,BS(i=[e]).call(i,n));}},{key:"off",value:function value(e,t){this.context.off(e,t);}},{key:"err",value:function value(e){this.context.dvsContext.errorService.err(e);}},{key:"ok",value:function value(){this.err(aO);}},{key:"isIndexValid",value:function value(e,t){return CO(t)?!(t<0||t>=e.total)||(this.err(lO),!1):(this.err(sO),!1);}},{key:"destroy",value:function value(){this.destroyFlag||(this.context.destroy(),this.context=null,this.destroyFlag=!0);}}],[{key:"use",value:function value(e){sE(TX).call(TX,e)<0&&TX.push(e);}}]);}(),EX={Viewer:IX},PX=function(){return hS(function e(t,i){dS(this,e),sS(this,"dvs",void 0),sS(this,"errorService",void 0),sS(this,"hooksService",void 0),sS(this,"imageService",void 0),sS(this,"minImageService",void 0),sS(this,"spaceService",void 0),sS(this,"trackerService",void 0),sS(this,"viewerService",void 0),sS(this,"saveService",void 0),sS(this,"commonCanvas",void 0),sS(this,"optimizationService",void 0),this.dvs=t,this.errorService=new PH(this),this.hooksService=new BH(this),this.imageService=new DH(this),this.minImageService=new MH(this),this.spaceService=new AH(this,i),this.trackerService=new RH(this),this.viewerService=new NH(this),this.saveService=new UH(this),this.commonCanvas=new SH(),this.optimizationService=new OH(this);},[{key:"destroy",value:function value(){this.imageService.destroy(),this.minImageService.destroy();}},{key:"getSpace",value:function value(){return this.spaceService.space;}}]);}(),BX=[],DX=function(){return hS(function e(t){dS(this,e),sS(this,"uid",void 0),sS(this,"emitter",void 0),sS(this,"subClasses",void 0),sS(this,"isDestroyed",!1),sS(this,"options",void 0),sS(this,"context",void 0),this.uid=AO(),this.subClasses=EX,this.emitter=vL.create(),this.options=t,this.context=new PX(this,t.space),this.init(),$F(["borderWidth","letterSpacing","lineDashOffset","shadowOffsetX","shadowOffsetY","shadowBlur","textMaxWidth"],AW,void 0),$F(["startAngle","endAngle"],RW,void 0),$F(["r","rx","ry","width","height","padding","fontSize","arrowWidth","markSize","markLineWidth"],AW,void 0),$F(["borderColor","background","shadowColor","color"],FW,void 0),$F(["opacity","fillOpacity","borderOpacity"],XW,void 0),KF("lineDash",jW,void 0),KF("shadow",HW,void 0),$F(["x","y"],void 0,YW),$F(["points"],void 0,YF),$F(["x1","y1","x2","y2"],void 0,XF),$F(["startPoint","endPoint"],void 0,_F),$F(["lineEnding"],void 0,GF),$F(["fontStyle","fontVariant","fontWeight","fontFamily","fontSize"],void 0,qF),$F(["x","y","width","wordWarp","lineHeight","text","textTransform","textBaseLine"],void 0,jF),$F(["width","height"],void 0,ZF);},[{key:"init",value:function value(){var e=this;new IH().apply(this.context),new EH().apply(this.context),this.emitter.save(),pS(BX).call(BX,function(t){var i,r=t.plugin,n=t.config;!TO(r)&&TO(r.init)&&r.init.apply(r,BS(i=[e]).call(i,tk(n)));}),this.context.hooksService.hooks.init.emit(),this.emitter.restore();}},{key:"setSpace",value:function value(e){e!==this.context.spaceService.space&&(this.context.hooksService.hooks.beforeSetSpace.emit(e),this.context.spaceService.setSpace(e),this.context.hooksService.hooks.afterSetSpace.emit(e));}},{key:"getImageData",value:function value(e,t){return this.context.saveService.getImageData(e,t);}},{key:"destroy",value:function value(){var e;this.isDestroyed||(this.context.hooksService.hooks.destroy.emit(),this.context.destroy(),null!==(e=this.emitter)&&void 0!==e&&e.destroy(),this.emitter=null,this.subClasses=null,this.isDestroyed=!0);}},{key:"removeSource",value:function value(e){return this.context.spaceService.space.removeSource(e);}},{key:"loadSource",value:function value(e){return this.context.spaceService.space.loadSource(e);}},{key:"updateSource",value:function value(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.context.spaceService.space.updateSource(e,t,i);}},{key:"createViewer",value:function value(e){return this.context.viewerService.createViewer(e);}},{key:"removeViewer",value:function value(e){return this.context.viewerService.removeViewer(e);}},{key:"getViewerByUid",value:function value(e){return this.context.viewerService.getViewer(e);}},{key:"getViewerByIndex",value:function value(e){return this.context.viewerService.viewerManager.getAllViewers()[e];}},{key:"getViewerList",value:function value(){var e;return nE(e=this.context.viewerService.viewerManager.getAllViewers()).call(e);}}],[{key:"use",value:function value(e){for(var t,i,r,n=arguments.length,o=new Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];return sE(t=wP(BX).call(BX,function(e){return e.plugin;})).call(t,e)>-1?(console.error("The plugin ".concat(e.name," is already installed.")),this):("function"==typeof e?e.apply(void 0,BS(i=[this]).call(i,o)):"function"==typeof e.install&&e.install.apply(e,BS(r=[this]).call(r,o)),BX.push({plugin:e,config:o}),this);}},{key:"useAll",value:function value(e){var t=this;return pS(e).call(e,function(e){if(vO(e)){var i,r,n=od(s=e)||sf(s)||Nf(s)||Of(),o=n[0],a=nE(i=$h(n)).call(i,1);t.use.apply(t,BS(r=[o]).call(r,tk(a)));}else t.use(e);var s;}),this;}},{key:"getClassStore",value:function value(){return EX;}},{key:"getPlugins",value:function value(){return BX;}}]);}(),MX={sequence:-1,location:"horizontal",size:180,thumbnailStyle:{},canvasStyle:{border:"1px solid #2a2a2a"},pageStyle:{},selectedPageStyle:{},placeholderStyle:{},hoveredPageStyle:{},pageNumberStyle:{},checkboxStyle:{},removeBtnStyle:{},enableDragPage:!0,enableKeyboardControl:!0,multiselectMode:!1,scrollDirection:"vertical",rows:4,columns:1,show:!0,enableResizing:!0,autoChangeIndex:!0,gap:10,margin:10,autoSelectTopPage:!1,autoScroll:!0,autoSelectLatest:!0},UX={enableOptimizeImage:!1,enableZoom:!1,displayMode:"multiple",toolType:"default",rows:4,columns:1,pure:!0,tabMode:"single"},AX=function(){return hS(function e(t){dS(this,e),sS(this,"uid",void 0),sS(this,"emitter",void 0),sS(this,"thbConfig",{}),sS(this,"innerViewer",void 0),sS(this,"viewer",void 0),sS(this,"postfix",void 0),sS(this,"container",void 0),sS(this,"hooks",{destroy:mL.create()}),sS(this,"configHandlers",{}),sS(this,"isDestroyed",!1);var i=vL.create();this.emitter=i,this.viewer=t.viewer,MO(UX,this.thbConfig),MO(MX,this.thbConfig),MO(t.viewerConfig||{},this.thbConfig),this.initThbConfigHandlers(),this.innerViewer=new this.viewer.OriginalViewer(uS(uS({},t),{},{emitter:i,viewerConfig:uS(uS({},this.thbConfig),{},{viewerStyle:uS({},this.thbConfig.thumbnailStyle)}),groupUid:this.viewer.groupUid,dvsContext:t.viewer.context.dvsContext})),this.innerViewer.isThumbnail=!0,this.innerViewer.thumbnailObject=this,this.uid=this.innerViewer.uid,this.postfix=this.innerViewer.context.postfix,this.listenViewerHooks(),t.container||this.updatePosition();},[{key:"listenViewerHooks",value:function value(){var e=this,t=this.viewer.context.hooksService.hooks,i=function i(){e.innerViewer&&e.innerViewer.context.resized();},r=function r(){e.innerViewer&&e.innerViewer.externalResized();},n=function n(t){e.innerViewer.context.hooksService.hooks.openDoc.emit(t);};t.resize.on(i),t.externalResized.on(r),t.openDoc.on(n),t.destroy.on(function(){e.destroy();}),this.hooks.destroy.on(function(){t.resize.off(i),t.externalResized.off(r),t.openDoc.off(n);});}},{key:"updatePosition",value:function value(){var e=null,t=this.innerViewer.context.uiService.defaultDom,i=this.viewer.context.uiService.defaultDom;"horizontal"===this.thbConfig.location?(t.style.width=zX(this.thbConfig.size),t.style.height="100%",e=i.querySelector("#dvs-viewer-middle".concat(this.viewer.context.postfix))):(t.style.width="100%",t.style.height=zX(this.thbConfig.size),e=i);var r=String(this.thbConfig.sequence);t.style.order=r,this.container=e,this.innerViewer.context.uiService.bindContainer(e),this.viewer.externalResized();}},{key:"getThbConfig",value:function value(){return this.thbConfig;}},{key:"getThbConfigByName",value:function value(e){return this.thbConfig[e];}},{key:"updateThbConfig",value:function value(e){for(var t=0,i=IB(e);t<i.length;t++){var r=ek(i[t],2),n=r[0],o=r[1],a=this.configHandlers[n];a&&a(this,o);}}},{key:"initThbConfigHandlers",value:function value(){this.configHandlers={thumbnailStyle:RX,canvasStyle:NX,pageStyle:OX,selectedPageStyle:LX,placeholderStyle:WX,hoveredPageStyle:FX,pageNumberStyle:HX,checkboxStyle:jX,removeBtnStyle:XX,scrollDirection:YX,multiselectMode:qX,enableDragPage:ZX,enableKeyboardControl:_X,show:GX,rows:KX,columns:$X,margin:JX,gap:QX,autoSelectTopPage:eY,size:tY,sequence:iY,location:rY,showRemoveBtn:nY,autoScroll:oY,autoSelectLatest:aY};}},{key:"show",value:function value(){return this.updateThbConfig({show:!0}),!0;}},{key:"hide",value:function value(){return this.updateThbConfig({show:!1}),!0;}},{key:"resized",value:function value(){this.viewer.resized(),this.innerViewer.resized();}},{key:"setViewMode",value:function value(e,t){return this.innerViewer.setViewMode(e,t);}},{key:"bindContainer",value:function value(e){return this.innerViewer.bindContainer(e);}},{key:"unbindContainer",value:function value(){return this.innerViewer.unbindContainer();}},{key:"on",value:function value(e,t){bO(e)&&TO(t)?this.emitter.on(e,t):this.err(sO);}},{key:"emit",value:function value(e){for(var t,i,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];bO(e)?(t=this.emitter).emit.apply(t,BS(i=[e]).call(i,n)):this.err(sO);}},{key:"off",value:function value(e,t){bO(e)&&(void 0===t||TO(t))?this.emitter.off(e,t):this.err(sO);}},{key:"destroy",value:function value(){this.isDestroyed||(this.hooks.destroy.emit(),this.innerViewer.unbindContainer(),this.innerViewer.destroy(),this.innerViewer=null,this.container=null,this.isDestroyed=!0);}},{key:"err",value:function value(e){this.emitter.emit("_dvsUpdateErrorMessage",e);}},{key:"ok",value:function value(){this.emitter.emit("_dvsUpdateErrorMessage",aO);}}]);}();function zX(e){if(bO(e)){if(!/%/.test(e)&&!/px/.test(e)&&!/em/.test(e))return"".concat(e,"px");}else if(CO(e))return"".concat(e,"px");return e;}function RX(e,t){cz(e.thbConfig.thumbnailStyle,t),e.innerViewer.updateViewerConfig({viewerStyle:uS({},e.thbConfig.thumbnailStyle)}),e.viewer.resized();}function NX(e,t){cz(e.thbConfig.canvasStyle,t),e.innerViewer.updateViewerConfig({canvasStyle:uS({},e.thbConfig.canvasStyle)}),e.viewer.resized();}function OX(e,t){cz(e.thbConfig.pageStyle,t),e.innerViewer.updateViewerConfig({pageStyle:uS({},e.thbConfig.pageStyle)}),e.innerViewer.render();}function LX(e,t){cz(e.thbConfig.selectedPageStyle,t),e.innerViewer.updateViewerConfig({selectedPageStyle:uS({},e.thbConfig.selectedPageStyle)}),e.innerViewer.render();}function WX(e,t){cz(e.thbConfig.placeholderStyle,t),e.innerViewer.updateViewerConfig({placeholderStyle:uS({},e.thbConfig.placeholderStyle)}),e.innerViewer.render();}function FX(e,t){cz(e.thbConfig.hoveredPageStyle,t),e.innerViewer.updateViewerConfig({hoveredPageStyle:uS({},e.thbConfig.hoveredPageStyle)}),e.innerViewer.render();}function HX(e,t){cz(e.thbConfig.pageNumberStyle,t),e.innerViewer.updateViewerConfig({pageNumberStyle:uS({},e.thbConfig.pageNumberStyle)}),e.innerViewer.render();}function jX(e,t){cz(e.thbConfig.checkboxStyle,t),e.innerViewer.updateViewerConfig({checkboxStyle:uS({},e.thbConfig.checkboxStyle)}),e.innerViewer.render();}function XX(e,t){cz(e.thbConfig.removeBtnStyle,t),e.innerViewer.updateViewerConfig({removeBtnStyle:uS({},e.thbConfig.removeBtnStyle)}),e.innerViewer.render();}function YX(e,t){e.thbConfig.scrollDirection=t,e.innerViewer.updateViewerConfig({scrollDirection:t}),e.innerViewer.render();}function qX(e,t){e.thbConfig.multiselectMode=t,e.innerViewer.updateViewerConfig({multiselectMode:t}),e.innerViewer.render();}function ZX(e,t){e.thbConfig.enableDragPage=t,e.innerViewer.updateViewerConfig({enableDragPage:t});}function _X(e,t){e.thbConfig.enableKeyboardControl=t,e.innerViewer.updateViewerConfig({enableKeyboardControl:t});}function GX(e,t){if(VO(t)&&e.thbConfig.show!==t){e.thbConfig.show=t,e.innerViewer.context.config.show=t;var i=(e.innerViewer||{}).defaultDom;i&&(i.style.display=t?"flex":"none"),e.viewer.externalResized();var r=e.innerViewer.getCurrentTab();if(r){e.innerViewer.context.showTab(r),e.innerViewer.context.renderOnly();var n=e.innerViewer.context.config;n.autoSelectLatest&&n.show&&n.autoScroll&&e.innerViewer.context.emitCurrentIndexChanged();}}}function KX(e,t){CO(t)?t<=0?e.err(lO):(e.thbConfig.rows=t,e.setViewMode(t,e.thbConfig.columns),e.ok()):e.err(sO);}function $X(e,t){CO(t)?t<=0?e.err(lO):(e.thbConfig.columns=t,e.setViewMode(e.thbConfig.rows,t),e.ok()):e.err(sO);}function JX(e,t){e.thbConfig.margin=t,e.innerViewer.updateViewerConfig({margin:t});}function QX(e,t){e.thbConfig.gap=t,e.innerViewer.updateViewerConfig({gap:t});}function eY(e,t){e.thbConfig.autoSelectTopPage=t,e.innerViewer.updateViewerConfig({autoSelectTopPage:t});}function tY(e,t){!function(e){var t=String(e);return!!/^\d+(px|em)$|^\d+$|^(100|[1-9]?\d(\.\d\d?\d?)?)%$/.test(t);}(t)?e.err(hO):(e.thbConfig.size=t,e.updatePosition(),e.ok());}function iY(e,t){CO(t)?(e.thbConfig.sequence=t,e.updatePosition(),e.ok()):e.err(sO);}function rY(e,t){"horizontal"===t||"vertical"===t?(e.thbConfig.location=t,e.updatePosition(),e.ok()):e.err(sO);}function nY(e,t){VO(t)?(e.thbConfig.showRemoveBtn=t,e.ok()):e.err(sO);}function oY(e,t){e.thbConfig.autoScroll=t,e.innerViewer.updateViewerConfig({autoScroll:t});}function aY(e,t){e.thbConfig.autoSelectLatest=t,e.innerViewer.updateViewerConfig({autoSelectLatest:t});}var sY={name:"dvsThumbnail",install:function install(e){var t=e.getClassStore(),i=function(e,t){return t=function(e){function t(e){var i;return dS(this,t),sS(Kw(i=nO(this,t,[e])),"thumbnails",void 0),i.thumbnails=[],i;}return Qb(t,e),hS(t,[{key:"createThumbnail",value:function value(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new AX({container:e.container||"",viewerConfig:e,dvs:this.dvs,viewer:this});this.thumbnails.push(t);var i=this.context.getCurrentTab();if(i){var r,n,o=t.innerViewer.context,a=o.tabService.createTab(i.doc);a.currentUid=i.currentUid,a.select(nE(r=i.selected).call(r)),pS(n=i.allPages).call(n,function(e,t){var i,r,n=a.getChildByIndex(t);e.blanks.children.length&&pS(i=e.blanks.children).call(i,function(e){var t=new UF({id:e.id,style:{points:[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],background:e.style.background,borderWidth:0}});n.blanks.appendChild(t);}),e.overlays.children.length&&pS(r=e.overlays.children).call(r,function(e){var t,i=new UF({id:e.id,style:{points:nE(t=e.style.points).call(t),background:e.style.background,borderWidth:0,opacity:e.style.opacity}});n.overlays.appendChild(i);});}),o.showTab(a),o.config.autoSelectLatest&&o.config.show?o.emitCurrentIndexChanged():o.renderOnly();}return e.container&&this.context.resized(),t;}},{key:"removeThumbnail",value:function value(e){var t,i,r,n;return bO(e)?r=KE(t=this.thumbnails).call(t,function(t){return t.uid===e;}):gO(e)&&(r=KE(i=this.thumbnails).call(i,function(t){return t===e;})),r>-1&&(ek(NE(n=this.thumbnails).call(n,r,1),1)[0].destroy(),!0);}},{key:"getThumbnailList",value:function value(){return this.thumbnails;}},{key:"getThumbnailByIndex",value:function value(e){return this.thumbnails[e];}},{key:"getThumbnailByUid",value:function value(e){var t;return YP(t=this.thumbnails).call(t,function(t){return t.uid===e;});}},{key:"checkPageVisibility",value:function value(e){var t={min:!1,ori:!1},i=this.getCurrentTab();if(i){var r=i.getChildByUid(e);r&&r.isPreload&&("multiple"===this.context.config.displayMode&&(t.min=!0),t.ori=!0);}for(var n=0,o=this.thumbnails.length;n<o;n++){var a=this.thumbnails[n].innerViewer.checkPageVisibility(e);a.min&&(t.min=!0),a.ori&&(t.ori=!0);}return t;}}]);}(e),sS(t,"use",e.use),t;}(t.Viewer);t.Viewer=i;}},lY=function(){function e(t,i){dS(this,e),sS(this,"reducer",void 0),sS(this,"state",void 0),sS(this,"listeners",[]),this.reducer=t,this.state=i,this.dispatch({type:""});}return hS(e,[{key:"subscribe",value:function value(e){return this.listeners.push(e),function(){var t,i,r=null===(t=this.listeners)||void 0===t?void 0:sE(t).call(t,e);null===(i=this.listeners)||void 0===i||NE(i).call(i,r,1);};}},{key:"dispatch",value:function value(e){var t;this.state=this.reducer(this.state,e),pS(t=this.listeners).call(t,function(t){t(e);});}},{key:"getState",value:function value(){return this.state;}},{key:"replaceReducer",value:function value(e){this.reducer=e,this.dispatch({type:""});}}],[{key:"create",value:function value(t,i,r){return"function"==typeof i&&void 0===r&&(r=i,i=void 0),r?r(e.create)(t,i):new e(t,i);}},{key:"combineReducers",value:function value(e){return function(t,i){var r;null!==(r=t)&&void 0!==r||(t={});for(var n={},o=0,a=IB(e);o<a.length;o++){var s=ek(a[o],2),l=s[0],u=(0,s[1])(t[l],i);n[l]=u;}return n;};}},{key:"applyMiddleware",value:function value(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(e){return function(i,r){var n=e(i,r),o={getState:n.getState},a=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return 0===t.length?function(e){return e;}:1===t.length?t[0]:zx(t).call(t,function(e,t){return function(){return e(t.apply(void 0,arguments));};});}.apply(void 0,tk(wP(t).call(t,function(e){return e(o);})))(n.dispatch);return uS(uS({},n),{},{dispatch:a});};};}}]);}(),uY=/^<\/([^>]*)>/,cY=/^<([^\s>]+)[^>]*>/,hY=/^<slot>.*<\/slot>/,dY=/(:?[@\w-]+)\s*=\s*"(.*?)"/;function fY(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=vY(e.template,e.data,e.components,e.injection,t),r=i.length;return r&&(i[0].cpInstance=e,i[r-1].cpInstance=e),i;}function vY(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=ix(e).call(e),a=[];function s(e){o=o.substring(e);}function l(e){var n=ek(e,2),o=n[0],s=n[1];if(s){var l=function(e){var t={},i=DO(e,dY);return i?(pS(i).call(i,function(e){var i=ek(e,3),r=i[1],n=i[2];t[r]=n;}),t):t;}(o),u=t[":for"];u&&(delete t[":for"],l[":for"]=u);var c={type:"start",name:s,data:t,attrs:l};if(a.push(c),(i[s]||r.components&&r.components[s])&&(c.cpOption={Component:i[s]||r.components[s],injection:r}),"input"===s||/\/>/.test(o)){var h={type:"end",name:s,data:t,attrs:{}};a.push(h);}}}function u(e){var t=ek(e,2)[1];if(t){var i={type:"end",name:t,attrs:{}};a.push(i);}}function c(e){if(e=ix(e).call(e)){var i={type:"text",name:e,attrs:{},data:t};a.push(i);}}function h(){a.push.apply(a,tk(n));}for(;o;){var d=sE(o).call(o,"<"),f=void 0;if(0===d){var v=o.match(uY);if(v){s(v[0].length),u(v);continue;}var g=o.match(hY);if(g){s(g[0].length),h();continue;}var m=o.match(cY);if(m&&m[0]!==m.input){s(m[0].length),l(m);continue;}f=o;}else f=d>0?o.substring(0,d):o;f&&(s(f.length),c(f));}return a;}function gY(e){var t=e.cpInstance;e.el;var i=e.children;t&&!t.isInserted&&(t.isInserted=!0,t.inserted&&t.inserted()),pS(i).call(i,function(e){gY(e);});}function mY(e,t){return t.key===e.key&&t.tagName===e.tagName;}function yY(e,t,i){for(var r={},n=t;n<=i;++n){var o=e[n];if(o&&o.data){var a=o.data.key;a&&(r[a]=n);}}return r;}function pY(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;t<=i;)wY(e[t]),t+=1;}function wY(e){if(e){var t=e.el,i=e.children;if(function(e,t){var i=e.cpInstance;i&&(i.unbindSelfEvents(),i.unbindGlobalEvents(),i.unbindNativeEvents(),null===(t=i.beforeDestroyed)||void 0===t||t.call(i,e));}(e),t){var r=t.parentElement;r&&r.removeChild(t),t.dvsNode=null,e.el=null;}return function(e){var t=e.cpInstance;t&&t.destroyed&&t.destroyed(e);}(e),e.text=null,e.parent=null,i.length&&pS(i).call(i,function(e){wY(e);}),!0;}return!1;}function bY(e,t,i,r,n){for(var o=document.createDocumentFragment(),a=r;a<=n;a++){var s=i[a];o.appendChild(s.renderDom());}sL(o,t,e);}function kY(e,t){var i,r,n,o;if(e!==t){if((null===(i=e.cpInstance)||void 0===i||null===(r=i.constructor)||void 0===r?void 0:r.name)!==(null===(n=t.cpInstance)||void 0===n||null===(o=n.constructor)||void 0===o?void 0:o.name))return bY(e.parent.el,e.el,[t],0,0),void wY(e);var a=e.el;e.data;var s=e.children,l=e.tagName,u=e.text;t.el=a,a.dvsNode=t;var c,h=t.data,d=t.children,f=t.tagName,v=t.text;if(a.setAttribute)pS(c=kS(h)).call(c,function(e){a instanceof HTMLInputElement&&"value"===e?a.value=h[e]:a.setAttribute(e,h[e]);});l===f&&"TEXT"===f&&u!==v?a.textContent=aL(v):s.length&&d.length?function(e,t,i){for(var r,n=0,o=0,a=t.length-1,s=i.length-1,l=t[n],u=t[a],c=i[o],h=i[s];n<=a&&o<=s;)if(null==l)l=t[n+=1];else if(null==u)u=t[a-=1];else if(null==c)c=i[o+=1];else if(null==h)h=i[s-=1];else if(mY(l,c))kY(l,c),o+=1,l=t[n+=1],c=i[o];else if(mY(u,h))kY(u,h),s-=1,u=t[a-=1],h=i[s];else if(mY(l,h))kY(l,h),lL(l.el,u.el),s-=1,l=t[n+=1],h=i[s];else if(mY(u,c))kY(u,c),sL(u.el,l.el,e),o+=1,u=t[a-=1],c=i[o];else{void 0===r&&(r=yY(t,n,a));var d=r[c.key];if(void 0===d)bY(e,l.el,i,o,o),c=i[o+=1];else{var f=t[d];kY(f,c),sL(f.el,l.el,e),t[d]=null,c=i[o+=1];}}n>a?bY(e,i[s+1]?i[s+1].el:null,i,o,s):o>s&&pY(t,n,a);}(a,s,d):d.length?bY(a,null,d,0,d.length-1):s.length&&pY(s,0,s.length),function(e,t){var i=(e||{}).cpInstance,r=t.cpInstance;i&&(r&&(i.data=r.data,i.injection=uS(uS({},i.injection),r.injection)),t.cpInstance=i,i.dvsNode=t,i.updated&&i.updated(t));}(e,t);}}var SY=function(){return hS(function e(t){dS(this,e),sS(this,"el",void 0),sS(this,"tagName",void 0),sS(this,"sel",""),sS(this,"data",void 0),sS(this,"children",void 0),sS(this,"text",void 0),sS(this,"key",void 0),sS(this,"cpInstance",void 0),sS(this,"cpOptions",void 0),sS(this,"inserted",!1),sS(this,"parent",void 0),this.createVNode(t);},[{key:"renderDom",value:function value(){var e,t;if(this.el)return this.el;var i,r=this.cpInstance;if("FRAGMENT"===this.tagName)i=document.createDocumentFragment();else if("TEXT"===this.tagName){var n=aL(this.text);i=document.createTextNode(n);}else{var o;i=document.createElement("IMAGE"===this.tagName?"IMG":this.tagName);for(var a=0,s=IB(this.data);a<s.length;a++){var l=ek(s[a],2),u=l[0],c=l[1];if("style"===u){var h=xY(c);for(var d in h)h.hasOwnProperty(d)&&(i.style[d]=h[d]);}else i.setAttribute(u,c);}if(null!==(o=this.data)&&void 0!==o&&o.events)for(var f=0,v=IB(null===(g=this.data)||void 0===g?void 0:g.events);f<v.length;f++){var g,m=ek(v[f],2),y=m[0],p=m[1];i.addEventListener(y,p);}}return pS(e=this.children).call(e,function(e){var t=e.renderDom();i.appendChild(t);}),i.dvsNode=this,this.el=i,null!=r&&null!==(t=r.updated)&&void 0!==t&&t.call(r,this),function(e,t){var i=e.cpInstance,r=e.el;i&&(i.dvsNode=e,null===(t=i.created)||void 0===t||t.call(i,r));}(this),i;}},{key:"patch",value:function value(e){return function(e,t,i){if(mY(e,t))kY(e,t);else{var r=e.el,n=r.parentNode;null!==n&&(t.el=t.renderDom(),sL(t.el,r,n),pY([e]),e=null);}var o=-1,a=e.parent;return null!=a&&pS(i=a.children).call(i,function(t,i){t===e&&(o=i);}),o>-1&&(a.children[o]=t,t.parent=a,e.el=null),t;}(this,e);}},{key:"destroy",value:function value(){return wY(this);}},{key:"createVNode",value:function value(e){var t=e.tagName,i=e.data,r=void 0===i?{}:i,n=e.children,o=void 0===n?[]:n,a=e.el,s=void 0===a?null:a,l=e.key,u=e.text,c=void 0===u?"":u,h=e.cpOptions,d=e.cpInstance,f=t;r.id&&(f+="#".concat(r.id)),r.class&&(f+=".".concat(r.class)),this.sel=f,this.data=r,this.tagName=t,this.children=o,this.el=s,this.key=l,this.text=c,this.cpInstance=d,this.cpOptions=h;}}]);}();function xY(e){var t=e.split(";"),i={};return pS(t).call(t,function(e){var t,r=ix(e).call(e);if(r){var n=wP(t=r.split(":")).call(t,function(e){return ix(e).call(e);}),o=ek(n,2),a=o[0],s=o[1],l=a.replace(/-(\w)/g,function(e,t){return t.toUpperCase();});i[l]=s;}}),i;}function CY(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=[],r=[],n=[];return pS(e).call(e,function(e){if("start"===e.type)i.push(e),r.push(n),n=[];else if("text"===e.type)n.push({type:"text",value:e.name,data:e.data});else if(e instanceof SY)n.push(e);else{for(var t=i.pop();t.name!==e.name;)t=i.pop();if(t){var o=t,a=o.name,s=o.cpInstance,l=o.attrs,u={type:"token",tagName:a,cpInstance:s,cpOption:o.cpOption,attrs:l,data:o.data,children:n};pS(n).call(n,function(e){e.parent=u;}),(n=r.pop()).push(u);}}}),t?n[0]:n;}var VY=/'.+'|\\".+\\"|[\w$.]+/g,TY=/{{([^\s@}]+)}}/;function IY(e,t){for(var i=function i(){var i=n[r],o=ek(i.match(/^(:|@)(.+)/)||[],3),a=o[1],s=o[2];if(!s)return 1;var l=e[i];if(delete e[i],"for"===s){var u,c,h,d=ek(l.split(" in "),2),f=d[0],v=d[1],g=ek(f.split(","),2),m=g[0],y=g[1];m=ix(m).call(m),y=null===(u=y)||void 0===u?void 0:ix(u).call(u),v=null===(c=v)||void 0===c?void 0:ix(c).call(c);var p=[],w=zx(h=v.split(".")).call(h,function(e,t){return e[t];},t);if(vO(w))pS(w).call(w,function(e,t){var i={};i[m]=e,y&&(i[y]=t),p.push(i);});else if(gO(w))for(var b=0,k=IB(w);b<k.length;b++){var S=ek(k[b],2),x=S[0],C=S[1],V={};V[m]=C,y&&(V[y]=x),p.push(V);}e[":for"]=p;}else{var T,I,E=zx(T=l.split(".")).call(T,function(e,t){return null==e?void 0:e[t];},t);if(void 0!==E)"class"===s&&e[s]?e[s]=BS(I="".concat(e[s]," ")).call(I,E):e[s]=E;else{l=l.replace(VY,function(e){if(sE(e).call(e,'"')<0&&sE(e).call(e,"'")<0){var i;if(/^(true|false|\d+|undefined|null)$/.test(e))return e;var r=zx(i=e.split(".")).call(i,function(e,t){return null==e?void 0:e[t];},t);return yN(r);}return e;});try{var P,B=function(e,t){var i=null;try{for(var r=e.split(","),n=0;n<r.length;n++){var o=r[n],a=/(\w+)(\[(\d+)\])?/,s=o.match(a);if(!s){t=null;break;}var l=s[1],u=s[3];if(!Object.prototype.hasOwnProperty.call(t,l)){t=null;break;}t=t[l],void 0!==u&&gS(t)&&(t=t[u]);}i=t;}catch(e){i=null;}return i;}(l,t);PO(B)&&(e[s]=void 0),"class"===s&&e[s]?e[s]=BS(P="".concat(e[s]," ")).call(P,B):e[s]=B;}catch(t){e[s]=void 0;}}"@"===a&&(e.events||(e.events={}),e.events[s]=e[s],delete e["@".concat(s)]);}},r=0,n=kS(e);r<n.length;r++)i();}function EY(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(vO(e)){var i=[];return pS(e).call(e,function(e){i.push.apply(i,tk(PY(EY(e))));}),i;}if(e instanceof SY)return e;if("token"===e.type){var r,n,o=e.tagName,a=e.attrs,s=e.cpInstance,l=e.children,u=e.data,c=e.cpOption;if(a[":for"])return function(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.attrs,n=e.data,o=JSON.parse(yN(r)),a={":for":r[":for"]};delete r[":for"],IY(a,uS(uS({},n),i));var s=[];return pS(t=a[":for"]).call(t,function(t){var i=EY(e,t);s.push.apply(s,tk(PY(i)));}),e.attrs=o,s;}(e,t);var h,d=uS(uS({},u),t),f=uS({},a);if(IY(a,d),Object.prototype.hasOwnProperty.call(a,"if")&&!a.if)h=null;else if(delete a.if,c)h=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.children,r=e.attrs,n=e.cpOption,o=BY(i,t),a=CY(fY(new(0,n.Component)({data:r,injection:n.injection}),o));return a?PY(EY(a))[0]:null;}(e,t);else{var v=a.key;void 0!==v&&delete a.key;var g=BY(l,t);h=new SY({tagName:o.toUpperCase(),data:a,cpInstance:s,key:v,children:g});}return e.attrs=f,null!==(r=h)&&void 0!==r&&pS(n=r.children).call(n,function(e){e.parent=h;}),h;}return function(e){var t,i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.value,o=null===(t=e.parent)||void 0===t||null===(i=t.attrs)||void 0===i?void 0:i.html;return n=function(e,t){var i=DO(e,TY);return i.length&&pS(i).call(i,function(i){var r,n=zx(r=i[1].split(".")).call(r,function(e,t){return e[t];},t),o=i[0];e=e.replace(o,n);}),e;}(ix(n).call(n),uS(uS({},e.data),r)),o?EY(CY(vY(n),!1)):new SY({tagName:"TEXT",text:n});}(e,t);}function PY(e){return e?(vO(e)||(e=[e]),e):[];}function BY(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=[];return pS(e).call(e,function(e){var r=EY(e,t)||[];i.push.apply(i,tk(PY(r)));}),i;}var DY=function(){return hS(function e(t){var i=t.data,r=void 0===i?{}:i,n=t.template,o=void 0===n?"":n,a=t.components,s=void 0===a?{}:a,l=t.injection,u=void 0===l?{}:l;dS(this,e),sS(this,"template",""),sS(this,"data",{}),sS(this,"components",{}),sS(this,"injection",{}),sS(this,"isInserted",!1),sS(this,"emitter",void 0),sS(this,"uiEmitter",void 0),sS(this,"viewerEmitter",void 0),sS(this,"dvsNode",null),sS(this,"el",void 0),sS(this,"created",void 0),sS(this,"inserted",void 0),sS(this,"updated",void 0),sS(this,"beforeDestroyed",void 0),sS(this,"destroyed",void 0),sS(this,"selfEvents",[]),sS(this,"globalEvents",[]),sS(this,"nativeEvents",[]),this.emitter=vL.create(),this.setData(r),this.template=o,this.setComponents(s),this.setInjects(u),this.uiEmitter=this.injection.emitter,this.viewerEmitter=this.injection.viewerEmitter,this.autoBindEvents();},[{key:"parseHTML",value:function value(){return EY(CY(fY(this,[])));}},{key:"setData",value:function value(e){cz(this.data,e);}},{key:"setComponents",value:function value(e){cz(this.components,e);}},{key:"setInjects",value:function value(e){cz(this.injection,e);}},{key:"autoBindEvents",value:function value(){for(var e=this,t=function t(){var t=ek(r[i],2),n=t[0],o=t[1];e.on(n,function(){o.apply(void 0,arguments);});},i=0,r=IB(this.data.events||{});i<r.length;i++)t();for(var n=function n(){var t=ek(a[o],2),i=t[0],r=t[1];e.on(i,function(){for(var t,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];bO(r)?e.$emit.apply(e,BS(t=[r]).call(t,n)):TO(r)&&r.apply(void 0,n);});},o=0,a=IB((null===(s=this.data)||void 0===s||null===(l=s.options)||void 0===l?void 0:l.events)||{});o<a.length;o++){var s,l;n();}}},{key:"unbindSelfEvents",value:function value(){var e,t=this;pS(e=this.selfEvents).call(e,function(e){var i=ek(e,2),r=i[0],n=i[1];t.emitter.off(r,n);}),this.selfEvents=[];}},{key:"unbindGlobalEvents",value:function value(){var e,t=this;pS(e=this.globalEvents).call(e,function(e){var i=ek(e,2),r=i[0],n=i[1];t.uiEmitter.off(r,n);}),this.globalEvents=[];}},{key:"unbindNativeEvents",value:function value(){var e;pS(e=this.nativeEvents).call(e,function(e){e();}),this.nativeEvents=[];}},{key:"on",value:function value(e,t){this.emitter.on(e,t),this.selfEvents.push([e,t]);}},{key:"emit",value:function value(e){for(var t,i,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];(t=this.emitter).emit.apply(t,BS(i=[e]).call(i,n));}},{key:"$on",value:function value(e,t){var i;this.uiEmitter&&(null!==(i=this.uiEmitter)&&void 0!==i&&i.on(e,t),this.globalEvents.push([e,t]));}},{key:"$emit",value:function value(e){for(var t,i,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];null===(t=this.uiEmitter)||void 0===t||t.emit.apply(t,BS(i=[e]).call(i,n));}},{key:"nativeOn",value:function value(e,t,i){var r=function(e,t,i){return e?(e.addEventListener(t,i,void 0),function(){e.removeEventListener(t,i);}):null;}(e,t,i);r&&this.nativeEvents.push(r);}},{key:"reRenderVNode",value:function value(){var e=function(e){return EY(CY(fY(e)));}(this);this.dvsNode.patch(e);}},{key:"query",value:function value(e){var t;return null===(t=this.el)||void 0===t?void 0:t.querySelector(e);}},{key:"queryAll",value:function value(e){var t;return null===(t=this.el)||void 0===t?void 0:t.querySelectorAll(e);}}]);}();sS(DY,"storeName",void 0),sS(DY,"hasStore",!1),sS(DY,"reducer",void 0),sS(DY,"initState",void 0);var MY=function(){function e(t){dS(this,e),sS(this,"container",void 0),sS(this,"emitter",null),sS(this,"viewerEmitter",null),sS(this,"options",void 0),sS(this,"rootVNode",void 0),sS(this,"postfix",void 0),sS(this,"injection",void 0),sS(this,"data",void 0),sS(this,"isInserted",!1),sS(this,"iListeners",[]),sS(this,"rootDom",void 0),sS(this,"stores",{});var i=t.container,r=t.injection,n=t.emitter,o=t.postfix,a=t.data;this.viewerEmitter=n,this.emitter=vL.create(),this.postfix=o||"-".concat(AO()),this.options=t,this.injection=r,this.data=a,bO(i)?this.container=document.getElementById(i):"DIV"===(null==i?void 0:i.nodeName)&&(this.container=i),this.initStore(),this.init();}return hS(e,[{key:"initStore",value:function value(){for(var t=0,i=SN(e.getComponents());t<i.length;t++){var r=i[t];if(!r.hasStore||this.stores[r.storeName]);else{var n=lY.create(r.reducer,r.initState);this.stores[r.storeName]=n;}}}},{key:"init",value:function value(){var t=new DY({data:this.options.uiConfig,template:'<Root :options="root"></Root>',components:e.getComponents(),injection:uS(uS({},this.injection),{},{components:e.getComponents(),postfix:this.postfix,emitter:this.emitter,viewerEmitter:this.viewerEmitter,stores:this.stores,i18n:this.options.uiConfig.i18n})}).parseHTML(),i=t.renderDom();this.rootVNode=t,this.rootDom=i,this.container&&(this.container.appendChild(i),gY(t),this.isInserted=!0);}},{key:"bindContainer",value:function value(e){this.container=e,e.appendChild(this.rootDom),this.isInserted||gY(this.rootVNode);}},{key:"unbindContainer",value:function value(){for(var e=0;e<this.container.children.length;e++)if(this.container.children[e]===this.rootDom)return void this.container.removeChild(this.rootDom);}},{key:"queryByDataId",value:function value(e){var t;return null===(t=this.rootDom)||void 0===t?void 0:t.querySelector("[data-id=".concat(e,"]"));}},{key:"queryAllByDataId",value:function value(e){var t;return null===(t=this.rootDom)||void 0===t?void 0:t.querySelectorAll("[data-id=".concat(e,"]"));}},{key:"on",value:function value(e,t){var i=this.emitter.on(e,t);this.iListeners.push(i);}},{key:"emit",value:function value(e){for(var t,i,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];(t=this.emitter).emit.apply(t,BS(i=[e]).call(i,n));}},{key:"off",value:function value(e,t){this.emitter.off(e,t);}},{key:"unbindEvents",value:function value(){var e,t=this;pS(e=this.iListeners).call(e,function(e){var i=e.name,r=e.fn,n=e.context,o=e.once;t.emitter.off(i,r,n,o);});}},{key:"destroy",value:function value(){this.unbindEvents();}}],[{key:"registerComponent",value:function value(){for(var t=0,i=IB(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});t<i.length;t++){var r=ek(i[t],2),n=r[0],o=r[1];if(e.isAlreadyRegistered(n))return;this.components[n]=o;}}},{key:"isAlreadyRegistered",value:function value(e){return!!this.components[e];}},{key:"getComponents",value:function value(){return this.components;}}]);}();sS(MY,"components",{});var UY=function UY(e,t,i,r){var n,o,a=e||{},s=a.id,l=a.title,u=a.dataId,c=a.style,h=a.className,d=function(e){var t="";if(e)for(var i=0,r=IB(e);i<r.length;i++){var n,o=ek(r[i],2),a=o[0],s=o[1];t+=BS(n="".concat(dO(a),":")).call(n,s,";");}return t;}(c);return(pO(s)?"":' id="'.concat(s,'"'))+BS(n=BS(o=' class="'.concat(t)).call(o,null!=i?i:""," ")).call(n,h||"",'"')+(pO(r)?"":' :class="'.concat(r,'"'))+(d?' style="'.concat(d,'"'):"")+(pO(l)?"":' title="'.concat(l,'"'))+(pO(u)?"":' data-id="'.concat(u,'"'));},AY=function AY(e,t){var i,r,n,o=(null===(i=t)||void 0===i?void 0:i.className)||"";return MO(e=e||{},t=t||{}),t.className=BS(r="".concat(o," ")).call(r,(null===(n=t)||void 0===n?void 0:n.className)||""),t;},zY=function(e){function t(e){var i;if(dS(this,t),sS(Kw(i=nO(this,t,[e])),"status",!1),sS(Kw(i),"store",void 0),sS(Kw(i),"unsubscribe",void 0),sS(Kw(i),"created",function(e){i.el=e,i.initEvent(),i.$on("setButtonClass",function(e,t){e===i.data.options.name&&(i.el.className="dvs-btn ".concat(t));});}),sS(Kw(i),"updated",function(){}),sS(Kw(i),"destroyed",function(){var e,t;i.data.options.selectable&&(null===(e=(t=i).unsubscribe)||void 0===e||e.call(t));}),i.data.options.selectable){var r;i.store=i.injection.stores[t.storeName];var n=i.store.getState();i.setData({isSelect:sE(r=n.select).call(r,i.data.options.dataId)>-1}),i.unsubscribe=i.store.subscribe(function(){var e=i.data.options.dataId,t=i.store.getState(),r=t.select,n=t.unselect;sE(r).call(r,e)>-1&&!i.data.isSelect?(i.data.isSelect=!0,i.reRenderVNode()):sE(n).call(n,e)>-1&&i.data.isSelect&&(i.data.isSelect=!1,i.reRenderVNode());});}return i.initTemplate(),i;}return Qb(t,e),hS(t,[{key:"initEvent",value:function value(){var e=this,t=this.data.options.events;if(t)for(var i=function i(){var t=ek(n[r],2),i=t[0],o=t[1];e.el.addEventListener(i,function(t){e.uiEmitter.emit(o,t,e);});},r=0,n=IB(t);r<n.length;r++)i();}},{key:"initNativeEvent",value:function value(){var e,t=this,i=this.el,r=this.data.options;pS(e=kS(r.events||{})).call(e,function(e){t.nativeOn(i,e,function(i){t.emit(e,i,t);});});}},{key:"initTemplate",value:function value(){var e,t=this.data.options,i=t.selectable?"isSelect?'dvs-selected':''":void 0,r=UY(t,"dvs-btn","",i);this.template=BS(e="<div ".concat(r," >")).call(e,pO(t.label)?"":t.label,"<slot></slot></div>");}}]);}(DY);sS(zY,"hasStore",!0),sS(zY,"storeName","button"),sS(zY,"reducer",function(e,t){var i,r,n,o;switch(e||(e={select:[],unselect:[]}),t.type){case"setButton":return pS(i=t.select).call(i,function(t){var i,r,n=KE(i=e.unselect).call(i,function(e){return e===t;});NE(r=e.unselect).call(r,n,1);}),pS(r=t.unselect).call(r,function(t){var i,r,n=KE(i=e.select).call(i,function(e){return e===t;});NE(r=e.select).call(r,n,1);}),e.select=tk(new iA(BS(n=[]).call(n,tk(e.select),tk(t.select)))),e.unselect=tk(new iA(BS(o=[]).call(o,tk(e.unselect),tk(t.unselect)))),uS({},e);case"select":return uS(uS({},e),{},{select:t.select});case"unselect":return uS(uS({},e),{},{unselect:t.unselect});default:return e;}});var RY=function(e){function t(e){var i;return dS(this,t),sS(Kw(i=nO(this,t,[e])),"startScroll",!1),sS(Kw(i),"allowScroll",!1),sS(Kw(i),"startInfo",void 0),sS(Kw(i),"created",function(e){i.el=e,i.allowScroll&&(i.addButtonScroll(),i.addResizeEvent());}),sS(Kw(i),"inserted",function(){i.updateShowMore();}),i.initTemplate(),i;}return Qb(t,e),hS(t,[{key:"initTemplate",value:function value(){var e=this.data.options;e.style,e.id,e.className;var t=e.children;this.injection;var i="<div ".concat(UY(this.data.options,"dvs-group",""),">");t&&pS(t).call(t,function(e,t){var r,n,o=e.enable,a=e.type;!1!==o&&(ix(a).call(a),i+=BS(r=BS(n="<".concat(a,' :options="options.children.')).call(n,t,'"></')).call(r,a,">"));}),i+="</div>",this.template=i;}},{key:"addButtonScroll",value:function value(){var e=this,t=this.el;t.onmousedown=function(i){return!(i.button&&0!==i.button||t.scrollWidth<=t.clientWidth&&t.scrollHeight<=t.clientHeight||(e.startScroll=!0,e.startInfo={x:i.clientX,y:i.clientY,left:t.scrollLeft,top:t.scrollTop},0));},t.onmousemove=function(i){if(!e.startScroll)return!1;var r=e.startInfo,n=r.x,o=r.y,a=r.left,s=r.top,l=i.clientX-n,u=i.clientY-o;return(Math.abs(l)>5||Math.abs(u)>5)&&(t.scrollLeft=a-l,t.scrollTop=s-u),e.updateShowMore(),!0;},this.nativeOn(document.body,"mouseup",function(){e.startScroll=!1;});var i=t.querySelector(".dvs-showBefore");i&&(i.onclick=function(){t.scrollLeft=0,e.updateShowMore();});var r=t.querySelector(".dvs-showAfter");r&&(r.onclick=function(){t.scrollLeft=t.scrollWidth,e.updateShowMore();});}},{key:"updateShowMore",value:function value(){var e=this.el,t=e.clientWidth,i=e.scrollWidth,r=e.scrollLeft,n=e.querySelector(".dvs-showBefore");n&&(n.classList[r>5&&t>40?"remove":"add"]("dvs-display-none"),n.style.transform="translate3d(".concat(r,"px,0,0)"));var o=e.querySelector(".dvs-showAfter");o&&(o.classList[r+t<i-5&&t>40?"remove":"add"]("dvs-display-none"),o.style.transform="translate3d(".concat(r,"px,0,0)"));}},{key:"addResizeEvent",value:function value(){var e=this;this.nativeOn(window,"resize",function(){e.updateShowMore();});}}]);}(DY),NY=function(e){function t(e){var i;return dS(this,t),sS(Kw(i=nO(this,t,[e])),"created",function(e){i.el=e;}),sS(Kw(i),"inserted",function(){i.injection.viewer.context.uiService.bindContainer(i.el);}),i.initTemplate(),i;}return Qb(t,e),hS(t,[{key:"initTemplate",value:function value(){var e="<div ".concat(UY(this.data.options,"dvs-main-canvas","")," ><slot></slot></div>");this.template=e;}}]);}(DY);var OY=function(e){function t(e){var i;return dS(this,t),sS(Kw(i=nO(this,t,[e])),"current",0),sS(Kw(i),"total",0),sS(Kw(i),"store",void 0),sS(Kw(i),"unsubscribe",void 0),sS(Kw(i),"prefix","dvs-pagination-"),sS(Kw(i),"created",function(e){i.el=e,i.updateStyle(),i.initEvent();}),sS(Kw(i),"updated",function(){i.updateStyle();}),sS(Kw(i),"destroyed",function(){var e,t;null===(e=(t=i).unsubscribe)||void 0===e||e.call(t);}),i.data.firstPage=AY(i.data.options.firstPage,{className:i.getClassName("first-page")}),i.data.prevPage=AY(i.data.options.prevPage,{className:i.getClassName("prev-page")}),i.data.nextPage=AY(i.data.options.nextPage,{className:i.getClassName("next-page")}),i.data.lastPage=AY(i.data.options.lastPage,{className:i.getClassName("last-page")}),i.data.gotoPage=e.gotoPage||{},i.data.total=e.total||{},i.data.separator=e.separator||{},i.store=i.injection.stores[t.storeName],i.unsubscribe=i.store.subscribe(function(){i.initDataFromStore(),i.reRenderVNode();}),i.initDataFromStore(),i.initTemplate(),i;}return Qb(t,e),hS(t,[{key:"getClassName",value:function value(e){var t,i,r=this.prefix;return BS(t=BS(i="".concat(r,"iconfont dvs-icon-")).call(i,e," ")).call(t,r+e);}},{key:"initDataFromStore",value:function value(){this.setData({pageDetails:uS(uS({},this.store.getState()),{},{current:this.store.getState().current+1})});}},{key:"updateStyle",value:function value(){if(this.el){var e=this.data.pageDetails,t=e.current,i=e.total,r=this.prefix,n=this.query(".".concat(r,"first-page")),o=this.query(".".concat(r,"prev-page")),a=this.query(".".concat(r,"next-page")),s=this.query(".".concat(r,"last-page"));1===t||0===i?(this.disable(n),this.disable(o)):(this.enable(n),this.enable(o)),t===i||0===i?(this.disable(a),this.disable(s)):(this.enable(a),this.enable(s));}}},{key:"disable",value:function value(e){var t="".concat(this.prefix,"disable");e.classList.contains(t)||e.classList.add(t);}},{key:"enable",value:function value(e){var t="".concat(this.prefix,"disable");e.classList.contains(t)&&e.classList.remove(t);}},{key:"initEvent",value:function value(){var e=this,t=this.prefix,i=this.query(".".concat(t,"first-page")),r=this.query(".".concat(t,"prev-page")),n=this.query(".".concat(t,"next-page")),o=this.query(".".concat(t,"last-page")),a=this.query(".".concat(t,"goto"));this.nativeOn(i,"click",function(){var t=e.data.pageDetails,i=t.current,r=t.total;1!==i&&r>1&&(e.store.dispatch({type:"firstPage"}),e.emit("change",e.data.pageDetails));}),this.nativeOn(r,"click",function(){var t=e.data.pageDetails,i=t.current,r=t.total;1!==i&&r>1&&(e.store.dispatch({type:"previousPage"}),e.emit("change",e.data.pageDetails));}),this.nativeOn(n,"click",function(){var t=e.data.pageDetails,i=t.current,r=t.total;i!==r&&r>1&&(e.store.dispatch({type:"nextPage"}),e.emit("change",e.data.pageDetails));}),this.nativeOn(o,"click",function(){var t=e.data.pageDetails,i=t.current,r=t.total;i!==r&&r>1&&(e.store.dispatch({type:"lastPage"}),e.emit("change",e.data.pageDetails));}),this.nativeOn(a,"input",function(e){a.value=e.target.value.replace(/[^\d]/g,"");}),this.nativeOn(a,"keyup",function(t){if("Enter"===t.key){var i=e.data.pageDetails.total,r=px(a.value,10);r=zO(r,1,i),a.value=String(r),0!==i&&(e.store.dispatch({type:"gotoPage",current:r-1}),e.emit("change",e.data.pageDetails));}});}},{key:"initTemplate",value:function value(){var e,t,i,r=this.data.options,n=r.gotoPage,o=r.total,a=r.separator;this.injection;var s="dvs-pagination",l=BS(e=BS(t=BS(i="<div ".concat(UY(this.data.options,s,""),'><Button :options="firstPage"></Button><Button :options="prevPage"></Button><input ')).call(i,UY(n,s,"-goto"),' :value="pageDetails.current" :title="pageDetails.current"><div ')).call(t,UY(a,s,"-separator"),"></div><span ")).call(e,UY(o,s,"-total"),' :title="pageDetails.total">{{pageDetails.total}}</span><Button :options="nextPage"></Button><Button :options="lastPage"></Button></div>');this.template=l;}}]);}(DY);sS(OY,"hasStore",!0),sS(OY,"storeName","pagination"),sS(OY,"reducer",function(e,t){switch(e||(e={current:-1,total:0}),t.type){case"setPageNumber":return uS(uS({},e),t.pageDetails);case"firstPage":return uS(uS({},e),{},{current:0});case"lastPage":return uS(uS({},e),{},{current:e.total-1});case"nextPage":return uS(uS({},e),{},{current:e.current+1});case"previousPage":return uS(uS({},e),{},{current:e.current-1});case"gotoPage":return uS(uS({},e),{},{current:t.current});default:return e;}});var LY=function(e){function t(e){var i;dS(this,t),sS(Kw(i=nO(this,t,[e])),"postfix",""),sS(Kw(i),"created",function(e){i.el=e,i.initNativeEvent();}),e.template&&(i.template=e.template);var r=i.injection,n=r.emitter,o=r.postfix;return i.uiEmitter=n,i.emitter=n,i.postfix=o,i.initTemplate(),i;}return Qb(t,e),hS(t,[{key:"initTemplate",value:function value(){var e=this.data.options.children,t="<div ".concat(UY(this.data.options,"dvs-root","")," >");e&&pS(e).call(e,function(e,i){var r,n,o=e.enable,a=e.type;!1!==o&&(t+=BS(r=BS(n="<".concat(a,' :options="options.children.')).call(n,i,'"></')).call(r,a,">"));}),t+="</div>",this.template=t;}},{key:"initNativeEvent",value:function value(){}}]);}(DY),WY={name:"dvsUi",install:function install(e){for(var t=e.getClassStore(),i=t.Viewer,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];t.Viewer=function(e,t,i){var r=ek(t,1)[0];return i=function(e){function t(e){var i;return dS(this,t),sS(Kw(i=nO(this,t,[e])),"ui",void 0),sS(Kw(i),"uiConfig",void 0),sS(Kw(i),"bindPostfix",!0),i.uiConfig=MO(e.uiConfig||{root:{}},_mO(r||{})),n(i.uiConfig.root,i.context.postfix),MY.registerComponent({Group:RY,Button:zY,Root:LY,MainCanvas:NY,Pagination:OY}),i.ui=new MY({container:e.container,emitter:i.context.emitter,postfix:i.context.postfix,uiConfig:i.uiConfig,injection:{viewer:Kw(i)}}),i.context.uiService.rootDom=i.ui.rootDom,i.bindContainer(e.container),i.context.hooksService.hooks.destroy.on(function(){i.ui.unbindContainer();}),i.initEvent(),i;}return Qb(t,e),hS(t,[{key:"width",get:function get(){var e=getComputedStyle(this.rootDom).width.match(/\d+/);if(!e)return 0;var t=ek(e,1)[0];return px(t,10);},set:function set(e){this.uiConfig.root.style.width=e,e=String(e),/\d+$/.test(e)&&(e="".concat(e,"px")),this.rootDom.style.width="".concat(e),this.externalResized();}},{key:"height",get:function get(){var e=getComputedStyle(this.rootDom).height.match(/\d+/);if(!e)return 0;var t=ek(e,1)[0];return px(t,10);},set:function set(e){this.uiConfig.root.style.height=e,e=String(e),/\d+$/.test(e)&&(e="".concat(e,"px")),this.rootDom.style.height="".concat(e),this.externalResized();}},{key:"setButtonClass",value:function value(e,t){this.ui.emit("setButtonClass",e,t);}},{key:"updateUiConfig",value:function value(e){return!0;}},{key:"bindContainer",value:function value(e){if(!e)return!1;var t=e;return bO(e)&&(t=document.querySelector("#".concat(e))),this.ui.bindContainer(t),this.context.uiService.container=t,this.context.uiService.rootDom=this.ui.rootDom,this.getViewerConfig().show||(this.context.uiService.rootDom.style.display="none"),this.context.uiService.isBindContainer=!0,this.resized(),!0;}},{key:"initEvent",value:function value(){var e=this;this.context.hooksService.hooks.pageChanged.on(function(t){var i,r;null===(i=e.ui)||void 0===i||null===(r=i.stores[OY.storeName])||void 0===r||r.dispatch({type:"setPageNumber",pageDetails:t});});}}]);}(e),sS(i,"use",e.use),i;function n(e,t){if(gO(e)){pO(e.id)||(e.id+=t);for(var i=0,r=IB(e);i<r.length;i++){var o=ek(r[i],2);o[0],n(o[1],t);}}else vO(e)&&pS(e).call(e,function(e){n(e,t);});}}(i,n);}},FY=function(){return hS(function e(){dS(this,e);},[{key:"init",value:function value(e){var t=e.dvsContext.hooksService.hooks.overlay,i=function i(t){var i=t.uids,r=t.left,n=t.top,o=t.width,a=t.height,s=t.tabUid;t.trigger;var l=t.color,u=t.opacity,c=t.overlayUid,h=e.getTab(s);h&&(pS(i).call(i,function(e){var t=h.getChildByUid(e);if(t){var i=new UF({id:c,style:{points:[{x:r,y:n},{x:r+o,y:n},{x:r+o,y:n+a},{x:r,y:n+a}],background:l,borderWidth:0,opacity:u}});t.overlays.appendChild(i);}}),e.clearOptimization(i),e.tabService.isCurrentTab(s)&&(e.showTab(h),e.renderOnly()));},r=function r(t){var i,r=t.tabNode;pS(i=r.childNodes).call(i,function(t){var i=e.getStatus(t.uid);if(i&&t.isVisible){var r,n,o;pS(r=nE(n=t.overlays.childNodes).call(n)).call(r,function(e){t.overlays.removeChild(e);});var a=i.imageScale;pS(o=i.overlays).call(o,function(i){i.uids;var r=i.left,n=i.top,o=i.width,s=i.height;i.tabUid,i.trigger;var l=i.color,u=i.opacity,c=i.overlayUid;"multiple"===e.config.displayMode&&e.config.useMinImage&&(r/=a,n/=a,o/=a,s/=a);var h=new UF({id:c,style:{points:[{x:r,y:n},{x:r+o,y:n},{x:r+o,y:n+s},{x:r,y:n+s}],background:l,borderWidth:0,opacity:u}});t.overlays.appendChild(h);});}});};e.layoutService.hooks.beforeLayout.on(r),t.on(i),e.hooksService.hooks.destroy.on(function(){t.off(i),e.layoutService.hooks.beforeLayout.off(r);});}}]);}(),HY={name:"dvsDWT",install:function install(e){var t=e.getClassStore(),i=t.Viewer;if(i){var r=function(e,t){return t=function(e){function t(e){var i;return dS(this,t),sS(i=nO(this,t,[e]),"imageSize",void 0),sS(i,"loadingVideoImage",!1),sS(i,"nextVideoImageUrl",void 0),i.context.configService.registerHandler("showVideoContainer",function(e,t){e.config.showVideoContainer=t;var i=document.querySelector("#dvs-video-container".concat(e.postfix));i&&(t?(i.style.display="flex",i.firstChild.style.display="inline",e.uiService.canvasAndScrollContainer.style.display="none"):(i.style.display="none",i.firstChild.style.display="none",e.uiService.canvasAndScrollContainer.style.display="flex",e.resized()));}),i;}return Qb(t,e),hS(t,[{key:"dwtWidth",get:function get(){return this.width;},set:function set(e){this.width=e,this.emit("dwtResize",this.width,this.height);}},{key:"dwtHeight",get:function get(){return this.height;},set:function set(e){this.height=e,this.emit("dwtResize",this.width,this.height);}},{key:"dwtRender",value:function value(){var e=this,t=this.render();if(t&&"single"===this.context.config.displayMode){var i=this.getCurrentIndex();this.emit("pageRendered",i);}if(t&&"multiple"===this.context.config.displayMode){var r,n=this.getCurrentTab();n&&pS(r=n.preloadChildren).call(r,function(t,i){t.isVisible&&e.emit("pageRendered",t.pageIndex);});}return t;}},{key:"updateVideoImage",value:function value(e){var t=this;if(null==this||!this.context||!this.getViewerConfig().showVideoContainer)return!1;if(this.loadingVideoImage)return this.nextVideoImageUrl=e,!1;this.loadingVideoImage=!0;var i=document.querySelector("#dvs-video-image".concat(this.postfix));if(i.times?i.times+=1:i.times=1,i){i.src=e,i.setAttribute("loaded","");var r=hB(function(){var r=i.getAttribute("loaded");"true"!==r&&"false"!==r&&(i.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsIAAA7CARUoSoAAAAANSURBVBhXY/j///9/AAn7A/0FQ0XKAAAAAElFTkSuQmCC",t.loadingVideoImage=!1,t.nextVideoImageUrl?(i.times=0,t.nextVideoImageUrl=null,t.updateVideoImage(t.nextVideoImageUrl)):i.times<4&&i.times>0&&hB(function(){t.updateVideoImage(e);},300));},1e3);i.onload=function(){if(i.times=0,t.loadingVideoImage=!1,i.setAttribute("loaded","true"),clearTimeout(r),t.nextVideoImageUrl)return t.nextVideoImageUrl=null,void t.updateVideoImage(t.nextVideoImageUrl);var e=i.naturalWidth,n=i.naturalHeight,o=i.clientWidth,a=i.clientHeight,s=t.imageSize;s&&s.naturalWidth===e&&s.naturalHeight===n&&s.clientWidth===o&&s.clientHeight===a||(t.imageSize={naturalWidth:e,naturalHeight:n,clientWidth:o,clientHeight:a},t.updateVideoSize());},i.onerror=i.onabort=function(){i.times=0,t.loadingVideoImage=!1,i.setAttribute("loaded","false"),clearTimeout(r),t.nextVideoImageUrl&&(t.nextVideoImageUrl=null,t.updateVideoImage(t.nextVideoImageUrl));};}else this.loadingVideoImage=!1;return!0;}},{key:"updateVideoSize",value:function value(){if(null!=this&&this.context&&this.imageSize&&this.getViewerConfig().showVideoContainer){var e=document.querySelector("#dvs-video-container".concat(this.postfix)),t=document.querySelector("#dvs-video-image".concat(this.postfix)),i=e.clientWidth,r=e.clientHeight,n=this.imageSize,o=n.naturalWidth,a=n.naturalHeight,s=o,l=a;o/a>=i/r?(s=i,l=a*(i/o)):(l=r,s=o*(r/a)),t.style.width="".concat(s,"px"),t.style.height="".concat(l,"px"),this.imageSize.clientWidth=t.clientWidth,this.imageSize.clientHeight=t.clientHeight;}}},{key:"overlayRectangle",value:function value(e,t,i,r,n){var o=this,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"#000",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;if(!HH(this,e=FH(this,e)))return!1;var l=this.getCurrentTab(),u=wP(e).call(e,function(e){return l.getUidByIndex(e);}),c={tabUid:l.uid,tabType:l.type,trigger:this.uid,uids:u,left:t,top:i,width:r,height:n,color:a,opacity:s,overlayUid:AO()};return pS(u).call(u,function(e){o.context.getStatus(e).overlays.push(uS({},c));}),this.context.dvsContext.hooksService.hooks.overlay.emit(c),!0;}},{key:"getCurrentPageUids",value:function value(){var e,t=this.getCurrentTab();return t?wP(e=t.allPages).call(e,function(e){return e.uid;}):[];}},{key:"getCurrentPageCounts",value:function value(){var e=this.getCurrentTab();return(null==e?void 0:e.total)||0;}}]);}(e),sS(t,"use",e.use),t;}(i);r.use(new FY()),t.Viewer=r;}}},jY=function(){return hS(function e(t){dS(this,e),sS(this,"context",void 0),sS(this,"outer",void 0),sS(this,"inner",void 0),sS(this,"original",void 0),sS(this,"matrixes",void 0),sS(this,"blanks",[]),sS(this,"overlays",[]),this.context=t;},[{key:"handle",value:function value(e){var t,i=this;this.outer=new EF(),this.inner=new EF(),this.outer.appendChild(this.inner),this.original=this.inner,this.matrixes=[],this.blanks=[],this.overlays=[];var r=e.operations,n=e.width,o=e.height,a=e.blanks,s=n,l=o;return this.inner.updateStyle({x:0,y:0,width:n,height:o}),this.outer.updateStyle({width:n,height:o}),r&&pS(r).call(r,function(e){if("r"===e.type){var t=i.rotate(e,s,l),r=t.rWidth,n=t.rHeight;s=r,l=n;}else if("c"===e.type){var o=i.crop(e),u=o.width,c=o.height;s=u,l=c;}else if("f"===e.type)i.flip(e);else if("z"===e.type){var h=i.resize(e,s,l),d=h.rWidth,f=h.rHeight;s=d,l=f;}else"e"===e.type&&i.erase(e,a);}),{width:s,height:l,matrixes:nE(t=this.matrixes).call(t),blanks:this.blanks};}},{key:"erase",value:function value(e,t){var i,r=this;pS(i=e.detail).call(i,function(e){var t,i=e.left,n=e.top,o=e.width,a=e.height,s=r.original.getWorldTransform().clone().invertSelf(),l=wP(t=[[i,n],[i+o,n],[i+o,n+a],[i,n+a]]).call(t,function(e){var t=ek(e,2),i=t[0],r=t[1];return s.transformPoint({x:i,y:r,z:0});});r.blanks.push({uid:e.eraseUid,points:l,background:e.color});});}},{key:"resize",value:function value(e,t,i){var r=e.detail[e.detail.length-1];r||console.error("resize operation is empty");var n=r.width,o=r.height,a=n/t,s=o/i,l=(n-t)/2,u=(o-i)/2,c=new EF();c.updateStyle({x:0,y:0,width:n,height:o}),c.appendChild(this.outer),this.inner=this.outer,this.outer=c,this.inner.scale(a,s,1);var h=this.inner.getPosition(),d=h.x,f=h.y;this.inner.setPosition({x:d+l,y:f+u,z:0});var v=this.inner.getLocalTransform();return this.matrixes.push(v),{rWidth:n,rHeight:o};}},{key:"flip",value:function value(e){var t,i=[1,1,1];pS(t=e.detail).call(t,function(e){"v"===e.dir?(i[1]*=-1,i[2]*=-1):"h"===e.dir&&(i[0]*=-1,i[2]*=-1);});var r=new EF();r.updateStyle({x:0,y:0,width:this.outer.width,height:this.outer.height}),r.appendChild(this.outer),this.outer.scale(i[0],i[1],i[2]),this.inner=this.outer,this.outer=r;var n=this.inner.getLocalTransform();this.matrixes.push(n);}},{key:"crop",value:function value(e){var t,i=null;if(pS(t=e.detail).call(t,function(e){var t=e.left,r=e.top,n=e.width,o=e.height;if(i){var a=i.getRect(),s=a.left,l=a.top,u=new LF(t+s,t+s+n,r+l,r+l+o);i=i.intersection(u);}else i=new LF(t,t+n,r,r+o);}),!i)return console.error("there is no crop operation"),{width:0,height:0};var r=i.getRect(),n=new EF();n.updateStyle({x:0,y:0,width:r.width,height:r.height}),n.appendChild(this.outer),this.inner=this.outer,this.outer=n;var o=this.inner.getPosition(),a=o.x,s=o.y;this.inner.setPosition({x:a-r.left,y:s-r.top,z:0});var l=this.inner.getLocalTransform();return this.matrixes.push(l),i.getRect();}},{key:"rotate",value:function value(e,t,i){var r,n=this,o=null,a=0;if(pS(r=e.detail).call(r,function(e){if(null===o&&(o=e.type),e.type===o)a+=e.angle;else{var r=n.executeRotate(o,a,t,i),s=r.width,l=r.height;t=s,i=l,o=e.type,a=e.angle;}}),o){var s=this.executeRotate(o,a,t,i),l=s.width,u=s.height;t=l,i=u;}return{rWidth:t,rHeight:i};}},{key:"rotateInContainMode",value:function value(e,t,i){var r=function(e,t,i,r,n,o,a){var s=0+i/2,l=0+r/2,u=HL(0,0,s,l,n),c=HL(0+i,0,s,l,n),h=HL(0+i,0+r,s,l,n),d=HL(0,0+r,s,l,n),f=Yz(o=[c.x,u.x,d.x,h.x]).call(o,function(e,t){return e-t;}),v=Yz(a=[c.y,u.y,d.y,h.y]).call(a,function(e,t){return e-t;});return{x:f[0],y:v[0],width:f[3]-f[0],height:v[3]-v[0]};}(0,0,t,i,yL(e)),n=r.width,o=r.height,a=(n-t)/2,s=(o-i)/2;t=n,i=o;var l=new EF();l.updateStyle({x:0,y:0,width:n,height:o}),l.appendChild(this.outer),this.outer.rotateLocal(e),this.inner=this.outer,this.outer=l;var u=this.inner.getPosition(),c=u.x,h=u.y;this.inner.setPosition({x:c+a,y:h+s,z:0});var d=this.inner.getLocalTransform();return this.matrixes.push(d),{rWidth:n,rHeight:o};}},{key:"executeRotate",value:function value(e,t,i,r){if("clip"===e){var n=new EF();n.updateStyle({x:0,y:0,width:i,height:r}),n.appendChild(this.outer),this.outer.rotateLocal(t),this.inner=this.outer,this.outer=n;var o=this.inner.getLocalTransform();this.matrixes.push(o);}else if("contain"===e){var a=this.rotateInContainMode(t,i,r);i=a.rWidth,r=a.rHeight;}return{width:i,height:r};}},{key:"toMinImageOperations",value:function value(e,t){var i=[];return pS(e).call(e,function(e){var r,n,o,a={type:e.type,detail:[]};i.push(a),"c"===e.type||"e"===e.type?pS(r=e.detail).call(r,function(e){var i=uS(uS({},e),{},{left:e.left/t,top:e.top/t,width:e.width/t,height:e.height/t});a.detail.push(i);}):"f"===e.type||"r"===e.type?pS(n=e.detail).call(n,function(e){var t=uS({},e);a.detail.push(t);}):"z"===e.type&&pS(o=e.detail).call(o,function(e){var i=uS(uS({},e),{},{width:e.width/t,height:e.height/t});a.detail.push(i);});}),i;}}]);}(),XY=function(e){function t(e,i){var r;return dS(this,t),sS(Kw(r=nO(this,t)),"uid",void 0),sS(Kw(r),"context",void 0),sS(Kw(r),"action",void 0),sS(Kw(r),"tabUid",void 0),r.context=e,r.action=i,r.uid=i.commandUid,r.tabUid=i.tabUid,r;}return Qb(t,e),hS(t,[{key:"execute",value:function value(){}},{key:"undo",value:function value(){this.context.removeActionFromStatus(this.action);}}]);}(ZH),YY=function(e){function t(){return dS(this,t),nO(this,t,arguments);}return Qb(t,e),hS(t);}(XY),qY=function(e){function t(){return dS(this,t),nO(this,t,arguments);}return Qb(t,e),hS(t);}(XY),ZY=function(e){function t(){return dS(this,t),nO(this,t,arguments);}return Qb(t,e),hS(t,[{key:"execute",value:function value(){var e=this.action,t=e.left,i=e.top,r=e.width,n=e.height,o=e.color,a=e.uids,s=e.eraseUid,l=this.context.getTab(this.tabUid);l&&pS(a).call(a,function(e){var a=l.getChildByUid(e);if(a){var u=new UF({id:s,style:{points:[{x:t,y:i},{x:t+r,y:i},{x:t+r,y:i+n},{x:t,y:i+n}],background:o,borderWidth:0}});a.blanks.appendChild(u);}});}},{key:"undo",value:function value(){var e,t=this;this.context.removeActionFromStatus(this.action);var i=this.context.getTab(this.tabUid);i&&pS(e=this.action.uids).call(e,function(e){var r=i.getChildByUid(e);if(r){var n,o=YP(n=r.blanks.children).call(n,function(e){return e.id===t.action.eraseUid;});o&&r.blanks.removeChild(o);}});}}]);}(XY),_Y=function(e){function t(){return dS(this,t),nO(this,t,arguments);}return Qb(t,e),hS(t);}(XY),GY=function(e){function t(){return dS(this,t),nO(this,t,arguments);}return Qb(t,e),hS(t);}(XY),KY=function(){return hS(function e(){dS(this,e);},[{key:"init",value:function value(e){var t=e.getGlobalHooks(),i=t.rotate,r=t.flip,n=t.crop,o=t.erase,a=t.changeSize,s=t.reset,l=function l(t){var i;pS(i=e.getAllTabs()).call(i,function(i){var r;if(_H(t,i)){var n,o=null;switch(pS(n=(t=_mO(t)).uids).call(n,function(e){i.getChildByUid(e).isEdited=!0;}),e.clearOptimization(t.uids),t.actionType){case"r":(Math.abs(t.angle)%90||"clip"===t.type)&&pS(r=t.uids).call(r,function(t){var r=i.getChildByUid(t);r&&(r.imageContainer.updateStyle({background:e.config.blankFillColor}),e.getStatus(r.uid).useFillColor=!0);}),o=new GY(e,t);break;case"f":o=new _Y(e,t);break;case"c":o=new qY(e,t);break;case"e":o=new ZY(e,t);break;case"z":o=new YY(e,t);}i.commandController.execute(o),e.tabService.isCurrentTab(i.uid)&&e.render();}});},u=function u(t){var i,r=t.uids;pS(i=e.getAllTabs()).call(i,function(i){_H(t,i)&&(pS(r).call(r,function(e){var t,r,n=i.getChildByUid(e);n.isEdited=!0,n&&pS(t=nE(r=n.blanks.childNodes).call(r)).call(t,function(e){n.blanks.removeChild(e);});}),e.tabService.isCurrentTab(i.uid)&&e.render());});};e.layoutService.hooks.beforeLayout.on(function(t){var i,r=t.tabNode;pS(i=r.preloadChildren).call(i,function(t){var i,r=e.getStatus(t.uid);if(r&&t.isPreload&&t.isLoaded&&null!==(i=t.image)&&void 0!==i&&i.style.img){var n,o,a,s={operations:r.operations,width:(null===(n=t.image.style.img)||void 0===n?void 0:n.naturalWidth)||0,height:(null===(o=t.image.style.img)||void 0===o?void 0:o.naturalHeight)||0,blanks:wP(a=t.blanks.children).call(a,function(e){return e.id;})},l="multiple"===e.config.displayMode;l&&e.config.useMinImage&&(s.operations=e.dvsContext.editService.toMinImageOperations(r.operations,r.imageScale));var u=e.dvsContext.editService.handle(s),c=u.width,h=u.height,d=u.matrixes,f=u.blanks;t.image.externalMatrixes=d,t.realTimeWidth=c,t.realTimeHeight=h,l&&e.config.useMinImage||r.setRealTimeSize(c,h),pS(f).call(f,function(e){var i;YP(i=t.blanks.children).call(i,function(t){return t.id===e.uid;}).updateStyle({points:e.points,background:e.background});});}});}),i.on(l),r.on(l),n.on(l),o.on(l),a.on(l),s.on(u),e.hooksService.hooks.destroy.on(function(){i.off(l),r.off(l),n.off(l),o.off(l),a.off(l),s.off(u);});}}]);}(),$Y={name:"dvsEdit",install:function install(e){var t=e.getClassStore(),i=t.Viewer;if(i){var r=function(e,t){return t=function(e){function t(e){var i;return dS(this,t),sS(Kw(i=nO(this,t,[e])),"viewerConfig",void 0),i.context.configService.registerHandler("rotationType",function(e,t){e.config.rotationType=t;}),i.context.config.rotationType||(i.context.config.rotationType="contain"),i;}return Qb(t,e),hS(t,[{key:"rotate",value:function value(e,t){if(!HH(this,t=FH(this,t)))return!1;var i=this.getCurrentTab(),r=wP(t).call(t,function(e){return i.getUidByIndex(e);}),n={actionType:"r",commandUid:AO(),tabUid:i.uid,tabType:i.type,trigger:this.uid,uids:r,angle:e,type:this.getViewerConfigByName("rotationType")};return this.context.storeActionToStatus(n),this.context.getGlobalHooks().rotate.emit(n),!0;}},{key:"flip",value:function value(e,t){if(!HH(this,e=FH(this,e)))return!1;var i=this.getCurrentTab(),r=wP(e).call(e,function(e){return i.getUidByIndex(e);}),n={actionType:"f",commandUid:AO(),tabUid:i.uid,tabType:i.type,trigger:this.uid,uids:r,dir:t||"v"};return this.context.storeActionToStatus(n),this.context.getGlobalHooks().flip.emit(n),!0;}},{key:"mirror",value:function value(e){return this.flip(e,"h");}},{key:"changePageSize",value:function value(e,t,i){if(!HH(this,e=FH(this,e)))return!1;var r=this.getCurrentTab(),n=wP(e).call(e,function(e){return r.getUidByIndex(e);}),o={actionType:"z",commandUid:AO(),tabUid:r.uid,tabType:r.type,trigger:this.uid,uids:n,width:t,height:i};return this.context.storeActionToStatus(o),this.context.getGlobalHooks().changeSize.emit(o),!0;}},{key:"crop",value:function value(e,t,i,r,n){if(!HH(this,e=FH(this,e)))return!1;var o=this.getCurrentTab(),a=wP(e).call(e,function(e){return o.getUidByIndex(e);}),s={actionType:"c",commandUid:AO(),tabUid:o.uid,tabType:o.type,trigger:this.uid,uids:a,left:t,top:i,width:r,height:n};return this.context.storeActionToStatus(s),this.context.getGlobalHooks().crop.emit(s),!0;}},{key:"erase",value:function value(e,t,i,r,n,o){if(!HH(this,e=FH(this,e)))return!1;var a=this.getCurrentTab(),s=wP(e).call(e,function(e){return a.getUidByIndex(e);}),l={actionType:"e",commandUid:AO(),tabUid:a.uid,tabType:a.type,trigger:this.uid,eraseUid:AO(),uids:s,left:t,top:i,width:r,height:n,color:o};return this.context.storeActionToStatus(l),this.context.getGlobalHooks().erase.emit(l),!0;}}]);}(e),sS(t,"use",e.use),t;}(i);r.use(new KY()),t.Viewer=r;}},init:function init(e){e.context.editService=new jY(e.context);}},JY=function(){return hS(function e(t,i,r,n){dS(this,e),sS(this,"webViewer",void 0),sS(this,"bDispose",!1),sS(this,"element",void 0),sS(this,"container",void 0),sS(this,"css",void 0),this.webViewer=t,this.element=i,this.element.style.flexShrink="0";var o=this.webViewer.myViewer.rootDom;this.container=o.querySelector("#dvs-viewer-main".concat(t.myViewer.postfix));var a="dvs-customElement-right";switch(r){case"left":a="dvs-customElement-left";break;case"top":a="dvs-customElement-top";break;case"bottom":a="dvs-customElement-bottom";}n&&this.element.classList.add("dvs-customElement-full"),this.css=a,this.container.classList.add(a),this.container.appendChild(i),this.hide();},[{key:"show",value:function value(){if(this.element)return this.element.style.display="block",this.webViewer.resized(),this.webViewer.resized(),!0;var e=this.bDispose?"CustomElementDispose":"CustomElementNotExist";return this.webViewer.setError(e),!1;}},{key:"hide",value:function value(){if(this.element)return this.element.style.display="none",this.webViewer.resized(),this.webViewer.resized(),!0;var e=this.bDispose?"CustomElementDispose":"CustomElementNotExist";return this.webViewer.setError(e),!1;}},{key:"dispose",value:function value(){return this.bDispose||(this.element&&(this.container.removeChild(this.element),this.webViewer.resized(),this.webViewer.resized(),this.webViewer.customElement=void 0,this.element=null,this.container.classList.remove(this.css),this.container=void 0),this.bDispose=!0),!0;}}]);}();function QY(e){var t=function t(e){var t=Number(e).toString(16).toUpperCase();return 1===t.length&&(t=["0",t].join("")),t;},i=(65280&e)>>8,r=255&e;return["#",t(e>>16),t(i),t(r)].join("");}function eq(e){if(pO(e))return!1;if(""===e)return!0;var t=document.createElement("div");return t.style.background=e,""!==t.style.background;}function tq(e){if(pO(e))return!1;if(""===e)return!0;var t=document.createElement("div");t.style.border=e;var i=t.style,r=i.borderWidth,n=i.borderColor,o=i.borderStyle;return"initial"!==r&&""!==r&&"initial"!==n&&""!==r&&"initial"!==o&&""!==r;}function iq(e){var t=zW(e);return!(pO(t)||t.value<0);}var rq=10===document.documentMode?"dvs-buttons-ie":"dvs-buttons";function nq(e){var t;return BS(t="dvs-editor-iconfont ds-dwt-ui-icon-".concat(e," ")).call(t,rq);}var oq={type:"Button",className:"".concat(rq," dwt-viewer-imageEditor-emptyBtn"),style:{visibility:"visible"}},aq={type:"Button",name:"previous",id:"previous",className:nq("preImage"),style:{visibility:"visible"},events:{click:"previousImage"}},sq={type:"Button",name:"next",id:"next",className:nq("nextImage"),style:{visibility:"visible"},events:{click:"nextImage"}},lq={type:"Button",name:"scan",id:"scan",className:nq("acquire"),style:{visibility:"visible"},events:{click:"scanImage"}},uq={type:"Button",name:"load",id:"load",className:nq("load"),style:{visibility:"visible"},events:{click:"loadImage"}},cq={type:"Button",name:"print",id:"print",className:nq("printImage"),style:{visibility:"visible"},events:{click:"printImage"}},hq={type:"Button",name:"removeAll",id:"removeAll",className:nq("removeall"),style:{visibility:"visible"},events:{click:"removeAllImage"}},dq={type:"Button",name:"removeSelected",id:"removeSelected",className:nq("removeImage"),style:{visibility:"visible"},events:{click:"removeImage"}},fq={type:"Button",name:"rotateLeft",id:"rotateLeft",className:nq("rotateLeftImage"),style:{visibility:"visible"},events:{click:"rotateLeft"}},vq={type:"Button",name:"rotate",id:"rotate",className:nq("rotate"),style:{visibility:"visible",position:"relative"},events:{click:"rotate"}},gq={type:"Button",name:"rotateRight",id:"rotateRight",className:nq("rotateRightImage"),style:{visibility:"visible"},events:{click:"rotateRight"}},mq={type:"Button",name:"deskew",id:"deskew",className:nq("deskew"),style:{visibility:"visible"},events:{click:"deskew"}},yq={type:"Button",name:"crop",id:"crop",className:nq("cropImage-grey"),style:{visibility:"visible"},events:{click:"cropImage"}},pq={type:"Button",name:"cut",id:"cut",className:nq("erase-grey"),style:{visibility:"visible"},events:{click:"cutImage"}},wq={type:"Button",name:"changeImageSize",id:"changeImageSize",className:nq("changeImageSize"),style:{visibility:"visible",position:"relative"},events:{click:"changeImageSize"}},bq={type:"Button",name:"flip",id:"flip",className:nq("flipImage"),style:{visibility:"visible"},events:{click:"flipImage"}},kq={type:"Button",name:"mirror",id:"mirror",className:nq("mirrorImage"),style:{visibility:"visible"},events:{click:"mirrorImage"}},Sq={type:"Button",name:"zoomIn",id:"zoomIn",className:nq("zoomin"),style:{visibility:"visible"},events:{click:"zoomIn"}},xq={type:"Button",name:"originalSize",id:"originalSize",className:nq("originalsize"),style:{visibility:"visible"},events:{click:"originalSize"}},Cq={type:"Button",name:"zoomOut",id:"zoomOut",className:nq("zoomout"),style:{visibility:"visible"},events:{click:"zoomOut"}},Vq={type:"Button",name:"fit",id:"fit",className:nq("fullWebType"),style:{visibility:"visible"},events:{click:"fitWindow"}},Tq={type:"Button",name:"fitW",id:"fitW",className:nq("fitWidthType"),style:{visibility:"visible"},events:{click:"fitWidth"}},Iq={type:"Button",name:"fitH",id:"fitH",className:nq("fitHeightType"),style:{visibility:"visible"},events:{click:"fitHeight"}},Eq={type:"Button",name:"hand",id:"hand",className:nq("hand"),style:{visibility:"visible"},events:{click:"handMode"}},Pq={type:"Button",name:"rectSelect",id:"rectSelect",className:nq("select"),style:{visibility:"visible"},events:{click:"selectMode"}},Bq={type:"Button",name:"zoom",id:"zoom",className:nq("clicktozoomin"),style:{visibility:"visible"},events:{click:"zoomMode"}},Dq={type:"Button",name:"restore",id:"restore",className:nq("restore"),style:{visibility:"visible"},events:{click:"restoreImage"}},Mq={type:"Button",name:"save",id:"save",className:nq("saveImage"),style:{visibility:"visible"},events:{click:"saveImage"}},Uq={type:"Button",name:"close",id:"close",className:nq("close"),style:{visibility:"visible"},events:{click:"closeImageEditor"}},Aq=["previousImage","nextImage","scanImage","loadImage","printImage","removeAllImage","removeImage","rotateLeft","rotate","rotateRight","deskew","cropImage","cutImage","changeImageSize","flipImage","mirrorImage","zoomIn","originalSize","zoomOut","fitWindow","fitWidth","fitHeight","handMode","selectMode","zoomMode","restoreImage","saveImage","closeImageEditor"],zq=["bufferChanged","click","pageAreaSelected","pageAreaUnselected"],Rq={root:{style:{display:"flex",flexDirection:"column",position:"relative"},id:"root",children:[{type:"Group",style:{height:"40px",minHeight:"30px",background:"rgb(58, 57, 59)",boxSizing:"border-box"},id:"header",className:"dwt-viewer-imageEditor-header",children:[{style:{width:"95%"},type:"Group",className:"dwt-viewer-imageEditor-leftButtons",children:[aq,sq,oq,lq,uq,cq,oq,hq,dq,oq,fq,vq,gq,mq,oq,yq,pq,wq,bq,kq,oq,Sq,xq,Cq,oq,Vq,Tq,Iq,oq,Eq,Pq,Bq,oq,Dq,Mq]},{style:{width:"5%",justifyContent:"flex-end"},type:"Group",className:"dwt-viewer-imageEditor-rightButtons",children:[Uq]}]},{type:"MainCanvas",id:"canvas",className:"dvs-canvas"}]}},Nq={flex:"1",visibility:"visible",fontSize:"1.2em"},Oq={visibility:"visible",fontSize:"1.2em"},Lq={root:{style:{display:"flex",flexDirection:"column",position:"relative"},id:"root",children:[{type:"Group",dataId:"header",style:{padding:"0 8px",height:"40px",background:"#2a292b",boxSizing:"border-box"},className:"dwt-viewer-imageEditor-header",children:[uS(uS({},uq),{},{style:uS({},Oq)}),uS(uS({},Uq),{},{style:uS({},Oq)})]},{type:"Group",dataId:"body",style:{display:"flex",flexDirection:"column"},children:[{type:"Group",dataId:"topMenu",style:{height:"60px",boxSizing:"border-box",background:"#3a393b"},children:[uS(uS({},fq),{},{style:uS({},Nq)}),uS(uS({},gq),{},{style:uS({},Nq)}),uS(uS({},bq),{},{style:uS({},Nq)}),uS(uS({},kq),{},{style:uS({},Nq)}),uS(uS({},yq),{},{style:uS({},Nq)}),uS(uS({},pq),{},{style:uS({},Nq)}),uS(uS({},Eq),{},{style:uS({},Nq)}),uS(uS({},Pq),{},{style:uS({},Nq)})]},{type:"MainCanvas",dataId:"canvas",className:"dvs-canvas"},{type:"Group",dataId:"bottomMenu",style:{height:"60px",background:"rgb(58, 57, 59)"},children:[{type:"Pagination",className:"dvs-imageEditor-pagination",events:{change:"paginationChange"},style:{display:"flex",width:"50%"},firstPage:{id:"firstPage",style:{visibility:"visible",flex:1}},lastPage:{id:"lastPage",style:{visibility:"visible",flex:1}},prevPage:{id:"previousPage",style:{visibility:"visible",flex:1}},nextPage:{id:"nextPage",style:{visibility:"visible",flex:1}},gotoPage:{style:{visibility:"visible",flex:1}},total:{style:{visibility:"visible",flex:1,textAlign:"center"}}},uS(uS({},hq),{},{style:uS({},Nq)}),uS(uS({},dq),{},{style:uS({},Nq)}),uS(uS({},Dq),{},{style:uS({},Nq)}),uS(uS({},Mq),{},{style:uS({},Nq)})]}]}]}};function Wq(e){var t={};return CO(null==e?void 0:e.borderWidth)&&(t.borderWidth=e.borderWidth),vO(null==e?void 0:e.lineDash)&&CO(e.lineDash[0])&&CO(e.lineDash[1])&&(t.dashLine=[e.lineDash[0],e.lineDash[1]]),bO(null==e?void 0:e.borderColor)&&(t.borderColor=e.borderColor),bO(null==e?void 0:e.handleColor)&&(t.ctrlBorderColor=e.handleColor),CO(null==e?void 0:e.handleWidth)&&(t.ctrlWidth=e.handleWidth),CO(null==e?void 0:e.handleHeight)&&(t.ctrlHeight=e.handleHeight),t;}function Fq(e){return{borderWidth:e.borderWidth,lineDash:e.dashLine,handleWidth:e.ctrlWidth,handleHeight:e.ctrlHeight,handleColor:e.ctrlBorderColor,borderColor:e.borderColor};}var Hq=function(){return hS(function e(t,i){dS(this,e),sS(this,"dvs",void 0),sS(this,"cutColor","white"),sS(this,"webViewer",void 0),sS(this,"editorViewer",void 0),sS(this,"viewerSetting",void 0),sS(this,"containerElement",void 0),sS(this,"uiSetting",Rq),sS(this,"editorSetting",void 0),sS(this,"bShowImageEditor",!1),sS(this,"lastRotateAngle",45),sS(this,"lastRotateKeepSize",!1),sS(this,"promoteSaveChange",!0),sS(this,"workMode",!1),sS(this,"bCrop",!1),sS(this,"bErase",!1),sS(this,"curIndex",0),sS(this,"bChanged",!1),sS(this,"bChangedUid",""),sS(this,"cursor","select"),sS(this,"defaultBtnClass","dvs-btn dvs-editor-iconfont dvs-buttons"),sS(this,"bDispose",!1),sS(this,"bMobile",!1),sS(this,"bFullScreen",!1),sS(this,"deskewStarted",!1),this.webViewer=t,this.dvs=t.myDvs,this.editorSetting=i||pW,this.promoteSaveChange=i.promptToSaveChange,this.workMode=0===i.workMode,this.updateEditorSetting(i),this.init(i);},[{key:"init",value:function value(e){this.bMobile=EO(),this.editorViewer=this.webViewer.myDvs.createViewer({viewerConfig:{viewerStyle:{background:"white"},canvasStyle:{background:"rgba(0,0,0,0)"},pageStyle:{background:"white"},displayMode:"single",enableOptimizeImage:!0,enableSlide:!0,maxZoom:50,margin:0},uiConfig:this.uiSetting,syncViewerUid:this.webViewer.myViewer.uid}),this.updateViewerSetting(e),0!==this.dvs.context.errorService.errorCode&&this.webViewer.setDefaultError(),this.bDispose=!1,this.bindEditorEvents(),VN(this).call(this),this.disableMobileInput(),this.setWidth(null==e?void 0:e.width),this.setHeight(null==e?void 0:e.height),this.setIfAutoScroll(this.webViewer.getIfAutoScroll());}},{key:"updateViewerSetting",value:function value(e){if(!this.editorViewer)return!1;var t=e.innerBorder,i=e.background,r=e.zoomOrigin,n=this.editorViewer.getViewerConfig().canvasStyle,o={border:t||n.border,background:i||n.background};return this.setZoomOrigin(r),this.editorViewer.updateViewerConfig({cropBoxConfig:_mO(wW),canvasStyle:o}),!0;}},{key:"updateUISetting",value:function value(e){this.editorSetting=e,this.uiSetting=_mO(Rq);var t=this.uiSetting.root.children[0],i=t.children[0].children,r=t.children[1].children;if(e.topMenuBorder&&tq(e.topMenuBorder)&&(t.style.border=e.topMenuBorder),e.border&&tq(e.border)&&(this.uiSetting.root.style.border=e.border),this.editorSetting.buttons){for(var n,o=this.editorSetting.buttons,a=o.titles,s=o.visibility,l=[i,r],u=[],c=function c(e){var t;pS(t=l[e]).call(t,function(t,i){var r,n=null==t||null===(r=t.name)||void 0===r?void 0:r.toLocaleLowerCase();pO(a)||pO(a[n])||(t.title=a[n]),pO(s)||pO(s[n])||(t.style.display=!0===s[n]?"":"none",!1===s[n]&&0===e&&u.push(i));});},h=0;h<l.length;h++)c(h);pS(n=[[0,1],[3,4,5],[7,8],[10,11,12,13],[15,16,17,18,19],[21,22,23],[25,26,27],[29,30,31]]).call(n,function(e){if(function(e,t){for(var i=0;i<t.length;i++)if(!rD(e).call(e,t[i]))return!1;return!0;}(u,e)){var t=e[e.length-1]+1;i[t].style.display="none";}});}return this.uiSetting;}},{key:"updateMobileUISetting",value:function value(e){this.editorSetting=e,this.uiSetting=_mO(Lq);var t=this.uiSetting.root.children[0],i=this.uiSetting.root.children[1],r=t.children,n=i.children[0],o=n.children,a=i.children[2].children;if(e.topMenuBorder&&tq(e.topMenuBorder)&&(n.style.border=e.topMenuBorder),e.border&&tq(e.border)&&(this.uiSetting.root.style.border=e.border),this.editorSetting.buttons)for(var s=this.editorSetting.buttons,l=s.titles,u=s.visibility,c=[r,o,a],h=0;h<c.length;h++){var d;pS(d=c[h]).call(d,function(e){var t,i=null==e||null===(t=e.name)||void 0===t?void 0:t.toLocaleLowerCase();pO(l)||pO(l[i])||(e.title=l[i]),pO(u)||pO(u[i])||(e.style.visibility=!0===u[i]?"visible":"hidden");});}return this.uiSetting;}},{key:"updateEditorSetting",value:function value(e){this.editorSetting=e,EO()?this.updateMobileUISetting(e):this.updateUISetting(e);}},{key:"bindEditorEvents",value:function value(){var e=this;pS(Aq).call(Aq,function(t){e.editorViewer.ui.on(t,function(){e.hideImageEditorDialog(),e[t]();});}),pS(zq).call(zq,function(t){e.editorViewer.on(t,function(i,r){e[t](i,r);});}),this.editorViewer.on("contextmenu",function(e,t){t.preventDefault();});var t=this.webViewer.webViewerInitConfig.viewerEvents;TO(null==t?void 0:t.onDrop)&&this.editorViewer.on("drop",function(i,r){e.webViewer.acceptDrop&&(null==t||t.onDrop(i,r));}),this.bMobile&&this.editorViewer.ui.on("paginationChange",function(t){e.goToPage(t.current-1);});}},{key:"resize",value:function value(){if(this.editorViewer){var e=this.editorViewer.rootDom;if(e){var t=this.editorViewer.width,i=16;t>600&&(i=Math.min(22,t/750*16)),i<16&&(i=16),this.bMobile&&(i=20),e.style.fontSize="".concat(i,"px");}}}},{key:"hideImageEditorDialog",value:function value(){this.closeRotateDialog(),this.closeChangeSizeDialog();}},{key:"updateZoomInState",value:function value(e){var t=e?"ds-dwt-ui-icon-zoomin":"ds-dwt-ui-icon-zoomin dvs-grey";this.setButtonClass("zoomIn",t);}},{key:"updateZoomOutState",value:function value(e){var t=e?"ds-dwt-ui-icon-zoomout":"ds-dwt-ui-icon-zoomout dvs-grey";this.setButtonClass("zoomOut",t);}},{key:"updateDeskewState",value:function value(e){var t=e?"ds-dwt-ui-icon-deskew":"ds-dwt-ui-icon-deskew dvs-grey";this.setButtonClass("deskew",t);}},{key:"updateEraseState",value:function value(e,t){var i=e?"ds-dwt-ui-icon-erase":"ds-dwt-ui-icon-erase dvs-grey";this.setButtonClass("cut",i),t&&this.clearSelectedArea();}},{key:"updateCropState",value:function value(e,t){var i=e?"ds-dwt-ui-icon-cropImage":"ds-dwt-ui-icon-cropImage dvs-grey";this.setButtonClass("crop",i),t&&this.clearSelectedArea();}},{key:"updateSaveAndRestoreBtn",value:function value(){var e=this.bChanged?"ds-dwt-ui-icon-saveImage":"ds-dwt-ui-icon-saveImage dvs-grey",t=this.bChanged?"ds-dwt-ui-icon-restore":"ds-dwt-ui-icon-restore dvs-grey";this.setButtonClass("save",e),this.setButtonClass("restore",t);}},{key:"updateCursorState",value:function value(){switch(this.cursor){case"pointer":this.handMode();break;case"zoom":this.zoomMode();break;default:this.selectMode();}return!0;}},{key:"updateMouseModeState",value:function value(e){this.setButtonClass("hand","ds-dwt-ui-icon-hand"),this.setButtonClass("rectSelect","ds-dwt-ui-icon-select"),this.setButtonClass("zoom","ds-dwt-ui-icon-clicktozoomin"),"pointer"===e?this.setButtonClass("hand","ds-dwt-ui-icon-hand dwt-viewer-imageEditor-selected"):"crosshair"===e?this.setButtonClass("rectSelect","ds-dwt-ui-icon-select dwt-viewer-imageEditor-selected"):this.setButtonClass("zoom","ds-dwt-ui-icon-clicktozoomin dwt-viewer-imageEditor-selected");}},{key:"updateState",value:function value(){if(this.editorViewer){var e=this.webViewer.getHowManyImagesInBuffer(),t=this.webViewer.getCurrentIndex();e>1?(this.webViewer.getCurrentIndex()===e-1||e<=1?this.setButtonClass("next","ds-dwt-ui-icon-nextImage dvs-grey"):this.setButtonClass("next","ds-dwt-ui-icon-nextImage"),t<=0||e<=1?this.setButtonClass("previous","ds-dwt-ui-icon-preImage dvs-grey"):this.setButtonClass("previous","ds-dwt-ui-icon-preImage")):(this.setButtonClass("next","ds-dwt-ui-icon-nextImage dvs-grey"),this.setButtonClass("previous","ds-dwt-ui-icon-preImage dvs-grey")),this.updateSaveAndRestoreBtn(),this.updateCropState(!1,!0),this.updateEraseState(!1,!0),this.updateCursorState();}}},{key:"setChangedState",value:function value(e){e?(this.bChanged=!0,this.bChangedUid=this.webViewer.getCurrentImgUUid()):(this.bChanged=!1,this.bChangedUid="");}},{key:"disableMobileInput",value:function value(){if(this.bMobile){var e=document.querySelector(".dvs-pagination-goto");e&&(e.disabled=!0);}}},{key:"bindStopPropagation",value:function value(e){var t=document.getElementById(e);t&&(t.onclick=function(e){uL(e);});}},{key:"updateEditorConfig",value:function value(e){this.editorViewer.updateViewerConfig(e);}},{key:"setIfAutoScroll",value:function value(e){return!!this.editorViewer&&(this.updateEditorConfig({autoSelectLatest:e,autoScroll:e}),!0);}},{key:"getSelectionBoxStyle",value:function value(){if(!this.editorViewer){var e=this.bDispose?"ImageEditorDispose":"ImageEditorNotExist";return this.webViewer.setError(e),!1;}return Fq(this.editorViewer.cropBoxConfig);}},{key:"setSelectionBoxStyle",value:function value(e){if(!this.editorViewer){var t=this.bDispose?"ImageEditorDispose":"ImageEditorNotExist";return this.webViewer.setError(t),!1;}if(!gO(e))return!1;var i=Wq(e);return this.updateEditorConfig({cropBoxConfig:i}),!0;}},{key:"resetButtonState",value:function value(){this.setChangedState(!1),this.updateSaveAndRestoreBtn();}},{key:"bind",value:function value(){var e;if(this.bShowImageEditor)return!0;if(!this.editorViewer){var t=this.bDispose?"ImageEditorDispose":"ImageEditorNotExist";return this.webViewer.setError(t),!1;}if(this.editorSetting&&this.editorSetting.element)this.bFullScreen=!1,bO(this.editorSetting.element)?this.containerElement=document.getElementById(this.editorSetting.element):this.containerElement=this.editorSetting.element;else{var i=document.createElement("div");i.className="dwt-viewer-imageEditor-fullScreen",document.body.insertBefore(i,document.body.firstElementChild),this.bFullScreen=!0,this.containerElement=i;}if(this.editorViewer.bindContainer(this.containerElement),this.editorViewer.hide(),this.updateState(),this.setSelectionRectAspectRatio((null===(e=this.editorSetting)||void 0===e?void 0:e.selectionRectAspectRatio)||0),!this.bMobile){var r=document.getElementById("header".concat(this.editorViewer.postfix));r&&r.addEventListener("wheel",function(e){e.preventDefault();},{passive:!1});}return!0;}},{key:"close",value:function value(){if(!this.editorViewer){var e=this.bDispose?"ImageEditorDispose":"ImageEditorNotExist";return this.webViewer.setError(e),!1;}this.bFullScreen&&document.body.removeChild(this.containerElement);var t=this.webViewer.webViewerInitConfig.imageEditorEvents;return this.bShowImageEditor=!1,this.webViewer.bShowImageEditor=!1,this.hideImageEditorDialog(),this.dvs.removeViewer(this.editorViewer),this.bFullScreen=!1,this.containerElement=null,this.editorViewer=void 0,this.webViewer.imageEditor=void 0,this.dvs=null,this.bDispose=!0,t&&TO(null==t?void 0:t.close)&&null!=t&&t.close(),window.removeEventListener("resize",window.dvsResize),window.dvsResize=null,document.body.style.overflow="",!0;}},{key:"show",value:function value(){var e;if(this.bShowImageEditor)return!0;if(this.editorViewer)return this.bFullScreen&&(this.containerElement.style.display="block",document.body.style.overflow="hidden"),this.bShowImageEditor=!0,this.editorViewer.show(),window.dvsResize=VN(e=this.resize).call(e,this),window.addEventListener("resize",window.dvsResize),this.resize(),!0;var t=this.bDispose?"ImageEditorDispose":"ImageEditorNotExist";return this.webViewer.setError(t),!1;}},{key:"hide",value:function value(){if(this.editorViewer)return this.editorViewer.hide(),this.bShowImageEditor=!1,this.bFullScreen&&(document.body.style.overflow="",this.containerElement.style.display="none"),window.removeEventListener("resize",window.dvsResize),window.dvsResize=null,!0;var e=this.bDispose?"ImageEditorDispose":"ImageEditorNotExist";return this.webViewer.setError(e),!1;}},{key:"hideImageEditor",value:function value(){var e=this;this.bChanged?this.showSaveDialog(function(){e.hide();},this.webViewer.getCurrentImgUUid()):this.hide();}},{key:"setSelectionRectAspectRatio",value:function value(e){if(!this.editorViewer)return!1;var t=e>0,i=e>0?e:0;return this.editorViewer.updateViewerConfig({cropBoxConfig:{aspectRatio:i,keepAspectRatio:t}}),!0;}},{key:"clearSelectedArea",value:function value(){if(!this.editorViewer||this.bDispose)return!1;var e=this.webViewer.getHowManyImagesInBuffer(),t=this.webViewer.getCurrentIndex();if(e<=0||t<0)return!0;var i=this.editorViewer.clearCropBox();return this.editorViewer.render(),i||this.webViewer.setDefaultError(),i;}},{key:"setOperationMode",value:function value(e){if(this.editorViewer){var t="default";switch(e){case 1:t="crop";break;case 2:t="zoomIn";break;case 3:t="zoomOut";break;case 4:t="annotation";break;default:t="default";}this.editorViewer.updateViewerConfig({toolType:t});}}},{key:"setCursor",value:function value(e){if(!this.editorViewer)return!1;var t=this.webViewer.getHowManyImagesInBuffer(),i=this.webViewer.getCurrentIndex();if(t<=0||i<0)return!1;var r="pointer",n=0,o=this.bMobile?"pointer":"crosshair";switch(e){case"zoom-out":o="zoom",r="zoom-out",n=3;break;case"zoom-in":o="zoom",r="zoom-in",n=2;break;case"crosshair":o="crosshair",r="crosshair",n=1;break;default:o="pointer",r="pointer",n=0;}var a={cursor:r};return this.editorViewer.updateViewerConfig({canvasStyle:a}),this.setOperationMode(n),this.updateMouseModeState(e),this.cursor=o,!0;}},{key:"setFit",value:function value(e){if(!this.webViewer||!this.editorViewer)return!1;var t=this.webViewer.getHowManyImagesInBuffer(),i=this.webViewer.getCurrentIndex();return!(t<=0||i<0||(this.editorViewer.updateViewerConfig({fitType:e}),this.updateZoomInState(!0),this.updateZoomOutState(!0),this.updateCropState(!1,!0),this.updateEraseState(!1,!0),0));}},{key:"setWidth",value:function value(e){return!(!this.webViewer||!this.editorViewer)&&!(bO(e)&&!/^((\d+em)|(\d+px)|(\d+%)|(\d+))$/.test(e)||CO(e)&&e<=0||(this.editorViewer.dwtWidth=e,this.resize(),0));}},{key:"setHeight",value:function value(e){return!(!this.webViewer||!this.editorViewer)&&!(bO(e)&&!/^((\d+em)|(\d+px)|(\d+%)|(\d+))$/.test(e)||CO(e)&&e<=0||(this.editorViewer.dwtHeight=e,this.resize(),0));}},{key:"setButtonClass",value:function value(e,t){var i;return!!this.editorViewer&&this.editorViewer.setButtonClass(e,BS(i="".concat(this.defaultBtnClass," ")).call(i,t));}},{key:"setZoomOrigin",value:function value(e){var t,i;if(!this.editorViewer){var r=this.bDispose?"ImageEditorDispose":"ImageEditorNotExist";return this.webViewer.setError(r),!1;}if(!gO(e)||!bO(null==e?void 0:e.x)||!bO(null==e?void 0:e.y))return this.webViewer.setError("InvalidValue"),!1;var n=e.x,o=e.y;return-1===sE(t=["left","right","center"]).call(t,n)||-1===sE(i=["top","bottom","center"]).call(i,o)?(this.webViewer.setError("InvalidValue"),!1):(this.editorViewer.updateViewerConfig({zoomOrigin:{x:n,y:o}}),!0);}},{key:"getZoomOrigin",value:function value(){return this.bDispose?"":this.editorViewer.getViewerConfigByName("zoomOrigin");}},{key:"previousImage",value:function value(){var e=this;if(!this.webViewer||!this.editorViewer)return!1;var t=this.webViewer.getHowManyImagesInBuffer(),i=this.webViewer.getCurrentIndex();return!(t<2||0===i||(this.bChanged?this.showSaveDialog(function(){e.editorViewer.prevPage(),e.updateState();},this.webViewer.getCurrentImgUUid()):(this.editorViewer.prevPage(),this.updateState()),0));}},{key:"nextImage",value:function value(){var e=this;if(!this.webViewer||!this.editorViewer)return!1;var t=this.webViewer.getHowManyImagesInBuffer(),i=this.webViewer.getCurrentIndex();return!(t<2||i===t-1||(this.bChanged?this.showSaveDialog(function(){e.editorViewer.nextPage(),e.updateState();},this.webViewer.getCurrentImgUUid()):(this.editorViewer.nextPage(),this.updateState()),0));}},{key:"scanImage",value:function value(){var e=this;if(!this.webViewer||!this.editorViewer)return!1;var t=this.webViewer.webViewerInitConfig.imageEditorEvents;return!(!t||!TO(null==t?void 0:t.acquire)||(this.bChanged?this.showSaveDialog(function(){null!=t&&t.acquire(e.editorSetting.dialogText.selectSource),e.updateState();},this.webViewer.getCurrentImgUUid()):(null!=t&&t.acquire(this.editorSetting.dialogText.selectSource),this.updateState()),0));}},{key:"loadImage",value:function value(){var e=this;if(!this.webViewer||!this.editorViewer)return!1;var t=this.webViewer.webViewerInitConfig.imageEditorEvents;return!(!t||!TO(null==t?void 0:t.loadImage)||(this.bChanged?this.showSaveDialog(function(){null!=t&&t.loadImage(),e.updateState();},this.webViewer.getCurrentImgUUid()):(null!=t&&t.loadImage(),this.updateState()),0));}},{key:"removeAllImage",value:function value(){var e=this.webViewer.webViewerInitConfig.imageEditorEvents,t=this.webViewer.getHowManyImagesInBuffer(),i=this.webViewer.getCurrentIndex();return!(t<=0||i<0||(e&&TO(null==e?void 0:e.removeAllImage)?null==e||e.removeAllImage():this.webViewer.bufferService.removeAllImages(),this.setChangedState(!1),this.updateState(),0));}},{key:"removeImage",value:function value(){var e=this.webViewer.webViewerInitConfig.imageEditorEvents,t=this.webViewer.getHowManyImagesInBuffer(),i=this.webViewer.getCurrentIndex();return!(t<=0||i<0||(e&&TO(null==e?void 0:e.removeImage)?null==e||e.removeImage():this.webViewer.bufferService.removeSelectedImages(),this.setChangedState(!1),this.updateState(),0));}},{key:"rotate",value:function value(){this.showRotateDialog();}},{key:"changeImageSize",value:function value(){this.showChangeSizeDialog();}},{key:"zoomIn",value:function value(){if(!this.webViewer||!this.editorViewer)return!1;var e=this.webViewer.getHowManyImagesInBuffer(),t=this.webViewer.getCurrentIndex();if(e<=0||t<0)return!1;var i=this.editorViewer.getViewerConfig();return i.zoom<i.maxZoom?(this.editorViewer.zoomIn(),this.updateZoomInState(!0)):this.updateZoomInState(!1),this.updateZoomOutState(!0),this.updateCropState(!1,!0),this.updateEraseState(!1,!0),!0;}},{key:"originalSize",value:function value(){if(!this.webViewer||!this.editorViewer)return!1;var e=this.webViewer.getHowManyImagesInBuffer(),t=this.webViewer.getCurrentIndex();return!(e<=0||t<0||(this.editorViewer.updateViewerConfig({zoom:1}),this.updateZoomInState(!0),this.updateZoomOutState(!0),this.updateCropState(!1,!0),this.updateEraseState(!1,!0),0));}},{key:"zoomOut",value:function value(){if(!this.webViewer||!this.editorViewer)return!1;var e=this.webViewer.getHowManyImagesInBuffer(),t=this.webViewer.getCurrentIndex();if(e<=0||t<0)return!1;var i=this.editorViewer.getViewerConfig();return i.zoom>i.minZoom?(this.editorViewer.zoomOut(),this.updateZoomOutState(!0)):this.updateZoomOutState(!1),this.updateZoomInState(!0),this.updateCropState(!1,!0),this.updateEraseState(!1,!0),!0;}},{key:"fitWindow",value:function value(){this.setFit("window");}},{key:"fitWidth",value:function value(){this.setFit("width");}},{key:"fitHeight",value:function value(){this.setFit("height");}},{key:"selectMode",value:function value(){this.setCursor("crosshair");}},{key:"handMode",value:function value(){this.clearSelectedArea(),this.setCursor("pointer");}},{key:"zoomMode",value:function value(){this.clearSelectedArea(),this.setCursor("zoom-in");}},{key:"restoreImage",value:function value(e){if(!this.webViewer||!this.editorViewer)return!1;if(!this.bChanged)return!1;var t=this.webViewer.getHowManyImagesInBuffer(),i=this.webViewer.getCurrentIndex();if(pO(e)||(i=this.webViewer.myViewer.getIndexByUid(e)),t<=0||i<0)return!1;var r=this.webViewer.webViewerInitConfig.imageEditorServerCallback;if(this.workMode&&r&&TO(null==r?void 0:r.restore)){var n=e||this.webViewer.getCurrentImgUUid();r.restore(n);}else this.editorViewer.reset(i),this.webViewer.myViewer.resized();return this.setChangedState(!1),this.updateState(),this.webViewer.clearSelectedAreas(),!0;}},{key:"first",value:function value(){var e=this;this.bChanged?this.showSaveDialog(function(){e.goToPage(0);},this.webViewer.getCurrentImgUUid()):this.goToPage(0);}},{key:"last",value:function value(){var e=this,t=this.webViewer.getHowManyImagesInBuffer()-1;this.bChanged?this.showSaveDialog(function(){e.goToPage(t);},this.webViewer.getCurrentImgUUid()):this.goToPage(t);}},{key:"go",value:function value(e){var t=this;this.bChanged?this.showSaveDialog(function(){t.goToPage(e);},this.webViewer.getCurrentImgUUid()):this.goToPage(e);}},{key:"goToPage",value:function value(e){var t=this;if(!this.webViewer||!this.editorViewer)return!1;var i=this.webViewer.getHowManyImagesInBuffer(),r=this.webViewer.getCurrentIndex();return!(i<=0||r<0||!this.bShowImageEditor||pO(e)||-1===e||(this.bChanged?this.showSaveDialog(function(){t.editorViewer.gotoPage(e),t.updateState();},this.webViewer.getCurrentImgUUid()):(this.editorViewer.gotoPage(e),this.updateState()),0));}},{key:"selectPages",value:function value(e){var t=this,i=this.webViewer.getHowManyImagesInBuffer();return zN(e).call(e,function(e){return e>i-1;})?(this.webViewer.setError("ParameterOutRange"),!1):(this.bChanged?this.showSaveDialog(function(){t.webViewer.myViewer.setSelectedIndexes(e),t.updateState();},this.webViewer.getCurrentImgUUid()):(this.webViewer.myViewer.setSelectedIndexes(e),this.updateState()),!0);}},{key:"closeImageEditor",value:function value(){var e=this;0!==this.webViewer.getHowManyImagesInBuffer()&&this.bChanged?this.showSaveDialog(function(){e.close();},this.webViewer.getCurrentImgUUid()):this.close();}},{key:"dispose",value:function value(){this.bChanged&&this.saveImage(this.webViewer.getCurrentImgUUid()),this.close();}},{key:"printImage",value:(d=Gw(iO().m(function e(){var t,i,r,n,o,a,s,l,u;return iO().w(function(e){for(;;)switch(e.n){case 0:if(this.webViewer&&this.editorViewer){e.n=1;break;}return e.a(2,!1);case 1:if(t=this.webViewer.getHowManyImagesInBuffer(),i=this.webViewer.getCurrentIndex(),!(t<=0||i<0)){e.n=2;break;}return e.a(2,!1);case 2:return r=this.editorViewer.getCurrentTab(),n=r.currentPage,o=n.realTimeWidth,a=n.realTimeHeight,s=n.uid,l="",e.n=3,this.webViewer.myDvs.getImageData(s,{type:"blob"});case 3:if(u=e.v,!IO()){e.n=5;break;}return e.n=4,new BB(function(e){var t=new FileReader();t.onload=function(){return e(t.result);},t.readAsDataURL(u);});case 4:l=e.v,e.n=6;break;case 5:l=cL(u).data;case 6:return e.a(2,(function(e,t){var i,r="";r=BS(t="".concat(r,'<div class="image-container"><img src="')).call(t,e.url,'" /></div>');var n="".concat(Dynamsoft.DWT.ResourcesPath,"/src/dynamsoft.webtwain.css"),o=["alwaysRaised=yes,z-look=yes,top=0,left=0,toolbar=no,menubar=no,location=no,status=no,width=",0,",height=",0].join(""),a=window.open("about:blank","_blank",o),s=["<html>",'<head><link rel="stylesheet" type="text/css" href="',n,'"></head>','<body id="D_body">',r,"</body></html>"].join("");a&&(a.document.write(s),a.document.close(),a.focus(),(i=a.document.body)&&(i.onload=function(){a&&a.print();}));}({url:l,width:Math.floor(o),height:Math.floor(a)}),this.updateState(),!0));}},e,this);})),function(){return d.apply(this,arguments);})},{key:"rotateLeft",value:(h=Gw(iO().m(function e(){var t,i,r;return iO().w(function(e){for(;;)switch(e.n){case 0:if(t=this.webViewer.getHowManyImagesInBuffer(),i=this.webViewer.getCurrentIndex(),!(t<=0||i<0)){e.n=1;break;}return e.a(2,!1);case 1:if(!1!==this.bChanged||!this.workMode){e.n=2;break;}return e.n=2,this.saveToServerBeforeEdit();case 2:return r=this.webViewer.webViewerInitConfig.imageEditorServerCallback,e.a(2,(this.workMode&&r&&TO(null==r?void 0:r.rotateLeft)?null==r||r.rotateLeft():this.editorViewer.rotate(-90,i),this.setChangedState(!0),this.updateState(),this.webViewer.clearSelectedAreas(),!0));}},e,this);})),function(){return h.apply(this,arguments);})},{key:"rotateInner",value:(c=Gw(iO().m(function e(){var t,i,r,n,o,a,s;return iO().w(function(e){for(;;)switch(e.n){case 0:if(t=document.getElementById("dvsImageEditorKeepSize"),i=document.getElementById("dvsImageEditorRotateAngle"),r=px(i.value,10),n=this.webViewer.getHowManyImagesInBuffer(),o=this.webViewer.getCurrentIndex(),!(n<=0||o<0)){e.n=1;break;}return e.a(2,!1);case 1:if(!1!==this.bChanged||!this.workMode){e.n=2;break;}return e.n=2,this.saveToServerBeforeEdit();case 2:return a=this.webViewer.webViewerInitConfig.imageEditorServerCallback,this.workMode&&a&&TO(null==a?void 0:a.rotate)?(s=document.getElementById("dvsImageEditorInterpolation"),null==a||a.rotate(r,s.selectedIndex+1,t.checked)):this.webViewer.rotateInner(o,r,t.checked),e.a(2,(this.setChangedState(!0),this.closeRotateDialog(),this.updateState(),this.webViewer.clearSelectedAreas(),this.lastRotateAngle=r,this.lastRotateKeepSize=t.checked,!0));}},e,this);})),function(){return c.apply(this,arguments);})},{key:"rotateRight",value:(u=Gw(iO().m(function e(){var t,i,r,n;return iO().w(function(e){for(;;)switch(e.n){case 0:if(i=this.webViewer.getHowManyImagesInBuffer(),r=this.webViewer.getCurrentIndex(),!(i<=0||r<0)){e.n=1;break;}return e.a(2,!1);case 1:if(!1!==this.bChanged||!this.workMode){e.n=2;break;}return e.n=2,this.saveToServerBeforeEdit();case 2:return n=this.webViewer.webViewerInitConfig.imageEditorServerCallback,e.a(2,(this.workMode&&n&&TO(null==n?void 0:n.rotateRight)?null==n||n.rotateRight():null===(t=this.editorViewer)||void 0===t||t.rotate(90,r),this.setChangedState(!0),this.updateState(),this.webViewer.clearSelectedAreas(),!0));}},e,this);})),function(){return u.apply(this,arguments);})},{key:"deskew",value:(l=Gw(iO().m(function e(){var t,i,r,n,o,a,s,l,u=this;return iO().w(function(e){for(;;)switch(e.n){case 0:if(t=this.webViewer.getHowManyImagesInBuffer(),i=this.webViewer.getCurrentIndex(),!(t<=0||i<0)){e.n=1;break;}return e.a(2,!1);case 1:if(r=this.webViewer.webViewerInitConfig,n=r.imageEditorEvents,o=r.imageEditorServerCallback,!1!==this.bChanged||!this.workMode){e.n=2;break;}return e.n=2,this.saveToServerBeforeEdit();case 2:if(!this.deskewStarted){e.n=3;break;}return e.a(2,!1);case 3:if(this.deskewStarted=!0,this.updateDeskewState(!1),!(this.workMode&&o&&TO(null==o?void 0:o.deskew))){e.n=4;break;}o.deskew(),this.setChangedState(!0),this.deskewStarted=!1,this.updateDeskewState(!0),e.n=7;break;case 4:if(n&&TO(null==n?void 0:n.deskew)){e.n=5;break;}return e.a(2,!1);case 5:return a=this.webViewer.getCurrentImgUUid(),s=this.webViewer.getCurrentIndex(),e.n=6,this.webViewer.myDvs.getImageData(a,{type:"blob",min:!0});case 6:l=e.v,n.deskew(l,function(e){u.webViewer.rotateInner(s,e,!0),u.setChangedState(!0),u.deskewStarted=!1,u.updateDeskewState(!0),u.updateSaveAndRestoreBtn();});case 7:return e.a(2,(this.updateState(),!0));}},e,this);})),function(){return l.apply(this,arguments);})},{key:"cropImage",value:(s=Gw(iO().m(function e(){var t,i,r,n,o,a,s,l,u;return iO().w(function(e){for(;;)switch(e.n){case 0:if(this.bCrop){e.n=1;break;}return e.a(2,!1);case 1:if(t=this.webViewer.getHowManyImagesInBuffer(),i=this.webViewer.getCurrentIndex(),!(t<=0||i<0)){e.n=2;break;}return e.a(2,!1);case 2:if(1===(r=this.editorViewer.getCropBoxes()).length){e.n=3;break;}return e.a(2,!1);case 3:if(n=r[0],o=n.left,a=n.top,s=n.width,l=n.height,!1!==this.bChanged||!this.workMode){e.n=4;break;}return e.n=4,this.saveToServerBeforeEdit();case 4:return u=this.webViewer.webViewerInitConfig.imageEditorServerCallback,e.a(2,(this.workMode&&u&&TO(null==u?void 0:u.crop)?u.crop(n):this.editorViewer.crop(i,o,a,s,l),this.setChangedState(!0),this.updateState(),this.webViewer.clearSelectedAreas(),!0));}},e,this);})),function(){return s.apply(this,arguments);})},{key:"cutImage",value:(a=Gw(iO().m(function e(){var t,i,r,n,o,a,s,l,u;return iO().w(function(e){for(;;)switch(e.n){case 0:if(this.bErase){e.n=1;break;}return e.a(2,!1);case 1:if(t=this.webViewer.getHowManyImagesInBuffer(),i=this.webViewer.getCurrentIndex(),!(t<=0||i<0)){e.n=2;break;}return e.a(2,!1);case 2:if(1===(r=this.editorViewer.getCropBoxes()).length){e.n=3;break;}return e.a(2,!1);case 3:if(n=r[0],o=n.left,a=n.top,s=n.width,l=n.height,!1!==this.bChanged||!this.workMode){e.n=4;break;}return e.n=4,this.saveToServerBeforeEdit();case 4:return u=this.webViewer.webViewerInitConfig.imageEditorServerCallback,e.a(2,(this.workMode&&u&&TO(null==u?void 0:u.erase)?u.erase(n):this.editorViewer.erase(i,o,a,s,l,this.cutColor),this.setChangedState(!0),this.updateState(),this.webViewer.clearSelectedAreas(),!0));}},e,this);})),function(){return a.apply(this,arguments);})},{key:"changeImageSizeInner",value:(o=Gw(iO().m(function e(){var t,i,r,n,o,a,s,l;return iO().w(function(e){for(;;)switch(e.n){case 0:if(t=this.webViewer.getHowManyImagesInBuffer(),i=this.webViewer.getCurrentIndex(),!(t<=0||i<0)){e.n=1;break;}return e.a(2,!1);case 1:if(r=document.getElementById("dvsImageEditorChangeH"),n=document.getElementById("dvsImageEditorChangeW"),o=px(r.value,10),a=px(n.value,10),!1!==this.bChanged||!this.workMode){e.n=2;break;}return e.n=2,this.saveToServerBeforeEdit();case 2:return s=this.webViewer.webViewerInitConfig.imageEditorServerCallback,this.workMode&&s&&TO(null==s?void 0:s.changeImageSize)?(l=document.getElementById("dvsImageEditorInterpolation"),s.changeImageSize(a,o,l.selectedIndex+1)):this.editorViewer.changePageSize(i,a,o),e.a(2,(this.setChangedState(!0),this.updateState(),this.closeChangeSizeDialog(),this.webViewer.clearSelectedAreas(),!0));}},e,this);})),function(){return o.apply(this,arguments);})},{key:"flipImage",value:(n=Gw(iO().m(function e(){var t,i,r;return iO().w(function(e){for(;;)switch(e.n){case 0:if(t=this.webViewer.getHowManyImagesInBuffer(),i=this.webViewer.getCurrentIndex(),!(t<=0||i<0)){e.n=1;break;}return e.a(2,!1);case 1:if(!1!==this.bChanged||!this.workMode){e.n=2;break;}return e.n=2,this.saveToServerBeforeEdit();case 2:return r=this.webViewer.webViewerInitConfig.imageEditorServerCallback,e.a(2,(this.workMode&&r&&TO(null==r?void 0:r.flip)?r.flip():this.editorViewer.flip(i),this.setChangedState(!0),this.updateState(),this.webViewer.clearSelectedAreas(),!0));}},e,this);})),function(){return n.apply(this,arguments);})},{key:"mirrorImage",value:(r=Gw(iO().m(function e(){var t,i,r;return iO().w(function(e){for(;;)switch(e.n){case 0:if(t=this.webViewer.getHowManyImagesInBuffer(),i=this.webViewer.getCurrentIndex(),!(t<=0||i<0)){e.n=1;break;}return e.a(2,!1);case 1:if(!1!==this.bChanged||!this.workMode){e.n=2;break;}return e.n=2,this.saveToServerBeforeEdit();case 2:return r=this.webViewer.webViewerInitConfig.imageEditorServerCallback,e.a(2,(this.workMode&&r&&TO(null==r?void 0:r.mirror)?r.mirror():this.editorViewer.mirror(i),this.setChangedState(!0),this.updateState(),this.webViewer.clearSelectedAreas(),!0));}},e,this);})),function(){return r.apply(this,arguments);})},{key:"saveImageAsync",value:(i=Gw(iO().m(function e(){var t,i,r,n,o,a,s;return iO().w(function(e){for(;;)switch(e.n){case 0:if(this.editorViewer){e.n=1;break;}return t=this.bDispose?"ImageEditorDispose":"ImageEditorNotExist",e.a(2,(this.webViewer.setError(t),BB.reject("The ImageEditor object has been disposed.")));case 1:if(this.bChanged||!this.workMode){e.n=2;break;}return e.a(2,BB.resolve());case 2:if(this.bChanged){e.n=3;break;}return e.a(2,BB.resolve());case 3:if(i=this.webViewer.webViewerInitConfig,r=i.viewerEvents,n=i.imageEditorServerCallback,o=this.webViewer.getCurrentImgUUid(),this.setChangedState(!1),this.updateState(),this.webViewer.clearSelectedAreas(),this.workMode&&n&&TO(null==n?void 0:n.save)){e.n=6;break;}if(r&&TO(null==r?void 0:r.save)){e.n=4;break;}return e.a(2,BB.reject());case 4:return e.n=5,this.webViewer.myDvs.getImageData(o,{type:"imageData"});case 5:return a=e.v,s=uS(uS({},this.webViewer.bufferService.getMetadataByUid(o)),{},{width:Math.floor(a.width),height:Math.floor(a.height)}),e.a(2,null==r?void 0:r.save(o,a.data.buffer,s,!0));case 6:return e.a(2,(n.save(o),BB.resolve()));}},e,this);})),function(){return i.apply(this,arguments);})},{key:"saveImage",value:(t=Gw(iO().m(function e(t){var i,r,n,o,a,s,l,u;return iO().w(function(e){for(;;)switch(e.p=e.n){case 0:if(this.editorViewer){e.n=1;break;}return e.a(2);case 1:if(this.bChanged){e.n=2;break;}return e.a(2);case 2:if(i=this.webViewer.webViewerInitConfig,r=i.viewerEvents,n=i.imageEditorServerCallback,o=t||this.webViewer.getCurrentImgUUid(),this.setChangedState(!1),this.updateState(),this.webViewer.clearSelectedAreas(),!(this.workMode&&n&&TO(null==n?void 0:n.save))){e.n=3;break;}n.save(o),e.n=9;break;case 3:if(r&&TO(null==r?void 0:r.save)){e.n=4;break;}return e.a(2);case 4:return e.n=5,this.webViewer.myDvs.getImageData(o,{type:"imageData"});case 5:return l=e.v,u=uS(uS({},(null===(a=this.webViewer)||void 0===a||null===(s=a.bufferService)||void 0===s?void 0:s.getMetadataByUid(o))||{}),{},{width:Math.floor(l.width),height:Math.floor(l.height)}),e.p=6,e.n=7,null==r?void 0:r.save(o,l.data.buffer,u,!0);case 7:e.n=9;break;case 8:e.p=8,e.v,this.setChangedState(!0),this.updateState();case 9:return e.a(2);}},e,this,[[6,8]]);})),function(e){return t.apply(this,arguments);})},{key:"saveToServerBeforeEdit",value:(e=Gw(iO().m(function e(){var t,i,r;return iO().w(function(e){for(;;)switch(e.n){case 0:if(t=this.webViewer.webViewerInitConfig.imageEditorServerCallback,i=this.webViewer.myViewer,!(this.workMode&&t&&TO(null==t?void 0:t.save))){e.n=2;break;}return i.updateViewerConfig({enableEmitPageRendered:!1}),this.webViewer.bEmitBufferChanged=!1,r=this.webViewer.getCurrentImgUUid(),e.n=1,t.save(r);case 1:this.webViewer.bEmitBufferChanged=!0,i.updateViewerConfig({enableEmitPageRendered:!0});case 2:return e.a(2);}},e,this);})),function(){return e.apply(this,arguments);})},{key:"bufferChanged",value:function value(e){return this.curIndex!==this.webViewer.getCurrentIndex()&&(this.curIndex=this.webViewer.getCurrentIndex(),this.updateState()),"shift"===e.operation&&this.bChanged||"add"===e.operation&&this.bChanged?(this.showSaveDialog(function(){},e.beforeStatus.currentUid),!1):("remove"===e.operation&&this.bChanged&&this.bChangedUid===e.beforeStatus.currentUid&&(this.setChangedState(!1),this.updateState()),!0);}},{key:"click",value:function value(){this.hideImageEditorDialog();var e=this.editorViewer.getViewerConfig();e.zoom<e.maxZoom?this.updateZoomInState(!0):this.updateZoomInState(!1),this.updateZoomOutState(!0);}},{key:"pageAreaSelected",value:function value(e,t){var i=1===t.length;this.bCrop=i,this.updateCropState(i,!1);var r=1===t.length;this.bErase=r,this.updateEraseState(r,!1);}},{key:"pageAreaUnselected",value:function value(){this.updateCropState(!1,!1),this.updateEraseState(!1,!1);}},{key:"wheel",value:function value(e,t){if(t.ctrlKey){var i=this.editorViewer.getViewerConfig(),r=i.zoom,n=r<i.maxZoom,o=r>i.minZoom;this.updateZoomInState(n),this.updateZoomOutState(o);}}},{key:"showMask",value:function value(){var e=document.createElement("div");e.className="dvs-imageEditor-mask",this.editorViewer.rootDom.appendChild(e);}},{key:"closeMask",value:function value(){var e=document.querySelector(".dvs-imageEditor-mask");e&&e.parentNode.removeChild(e);}},{key:"createSaveDialog",value:function value(){var e=this.editorSetting.dialogText,t=null==e?void 0:e.saveChangedImage;(pO(e)||pO(null==e?void 0:e.saveChangedImage))&&(t=yW.saveChangedImage);var i=jq({tag:"div",className:"dvs-imageEditor-saveDlg",children:[{tag:"div",className:"dvs-imageEditor-saveDlg-header",children:[{tag:"i",className:"dynamsoft-dialog-close"}]},{tag:"div",className:"dvs-imageEditor-saveDlg-box",children:[{tag:"div",textContent:t[0]},{tag:"div",className:"dvs-imageEditor-saveDlg-btnGroup",children:[{tag:"input",className:"dynamsoft_btnSave",attributes:{type:"button",value:t[1]}},{tag:"input",className:"dynamsoft_btnCancel",attributes:{type:"button",value:t[2]}}]}]}]});return i.style.width=this.bMobile?"300px":"420px",i;}},{key:"showSaveDialog",value:function value(e,t){var i=this;if(document.querySelector(".dvs-imageEditor-saveDlg")||!this.bChanged)return!1;if(!this.promoteSaveChange)return this.saveImage(t),e(),!0;this.showMask();var r=this.createSaveDialog();this.editorViewer.rootDom.appendChild(r);var n=document.querySelector(".dynamsoft_btnSave"),o=document.querySelector(".dynamsoft_btnCancel"),a=document.querySelector(".dynamsoft-dialog-close");return a&&(a.onclick=function(){i.closeSaveDialog(),i.closeMask();}),n&&(n.onclick=Gw(iO().m(function r(){return iO().w(function(r){for(;;)switch(r.n){case 0:return r.n=1,i.saveImage(t);case 1:i.closeSaveDialog(),i.closeMask(),e();case 2:return r.a(2);}},r);}))),o&&(o.onclick=function(){i.restoreImage(t),i.closeSaveDialog(),i.closeMask(),e();}),!0;}},{key:"closeSaveDialog",value:function value(){var e=document.querySelector(".dvs-imageEditor-saveDlg");e&&e.parentNode.removeChild(e);}},{key:"createRotateDialog",value:function value(){var e=this.editorSetting.dialogText,t=null==e?void 0:e.dlgRotateAnyAngle;(pO(e)||pO(null==e?void 0:e.dlgRotateAnyAngle))&&(t=yW.dlgRotateAnyAngle);var i=!0===this.lastRotateKeepSize?"checked":"",r=this.workMode?"flex":"none",n=jq({tag:"div",children:[{tag:"div",children:[{tag:"span",textContent:t[0]},{tag:"input",attributes:{id:"dvsImageEditorRotateAngle",type:"number",value:this.lastRotateAngle}}]},{tag:"div",attributes:{style:"display:".concat(r)},children:[{tag:"span",textContent:t[1]},{tag:"select",attributes:{size:"1",id:"dvsImageEditorInterpolation"},children:[{tag:"option",attributes:{value:"1"},textContent:"NearestNeighbor"},{tag:"option",attributes:{value:"2"},textContent:"Bilinear"},{tag:"option",attributes:{value:"3"},textContent:"Bicubic"}]}]},{tag:"div",children:[{tag:"label",children:[uS({tag:"input",attributes:{type:"checkbox",id:"dvsImageEditorKeepSize"}},i&&{checked:"checked"}),{tag:"span",textContent:t[2]}]}]},{tag:"div",children:[{tag:"input",attributes:{id:"dvsImageEditorRotateOk",type:"button",value:t[3]}},{tag:"input",attributes:{id:"dvsImageEditorRotateCancel",type:"button",value:t[4]}}]}]});return n.className="dvs-imageEditor-rotateBox",n.id="dvsImageEditorRotateBox",n;}},{key:"showRotateDialog",value:function value(){var e=this;if(!document.getElementById("dvsImageEditorRotateBox")){var t=this.webViewer.getHowManyImagesInBuffer(),i=this.webViewer.getCurrentIndex();if(!(t<=0||i<0)){var r=document.getElementById("rotate".concat(this.editorViewer.postfix));if(r){var n=this.createRotateDialog();r.appendChild(n);var o=r.getBoundingClientRect(),a=o.width,s=o.height;n.style.left=a/2+"px",n.style.top=s/2+"px";var l=document.getElementById("dvsImageEditorRotateOk"),u=document.getElementById("dvsImageEditorRotateCancel");this.bindStopPropagation("dvsImageEditorRotateBox"),l&&(l.onclick=function(t){e.rotateInner();}),u&&(u.onclick=function(t){e.closeRotateDialog();});}}}}},{key:"closeRotateDialog",value:function value(){var e=document.getElementById("dvsImageEditorRotateBox");e&&e.parentNode.removeChild(e);}},{key:"createChangeSizeDialog",value:function value(e,t){var i=this.editorSetting.dialogText,r=null==i?void 0:i.dlgChangeImageSize;(pO(i)||pO(null==i?void 0:i.dlgChangeImageSize))&&(r=yW.dlgChangeImageSize);var n=this.workMode?"flex":"none",o=jq({tag:"div",children:[{tag:"div",children:[{tag:"span",textContent:r[0]},{tag:"div",children:[{tag:"input",attributes:{id:"dvsImageEditorChangeH",type:"number",value:t}},{tag:"span",textContent:"pixel"}]}]},{tag:"div",attributes:{style:"margin-top:10px"},children:[{tag:"span",textContent:r[1]},{tag:"div",children:[{tag:"input",attributes:{id:"dvsImageEditorChangeW",type:"number",value:e}},{tag:"span",textContent:"pixel"}]}]},{tag:"div",attributes:{style:"display:".concat(n)},children:[{tag:"span",textContent:r[2]},{tag:"select",attributes:{size:"1",id:"dvsImageEditorInterpolation"},children:[{tag:"option",attributes:{value:"1"},textContent:"NearestNeighbor"},{tag:"option",attributes:{value:"2"},textContent:"Bilinear"},{tag:"option",attributes:{value:"3"},textContent:"Bicubic"}]}]},{tag:"div",children:[{tag:"input",attributes:{id:"dvsImageEditorChangeSizeOk",type:"button",value:r[3]}},{tag:"input",attributes:{id:"dvsImageEditorChangeSizeCancel",type:"button",value:r[4]}}]}]});return o.className="dvs-imageEditor-changeSizeBox",o.id="dvsImageEditorChangeSizeBox",o;}},{key:"showChangeSizeDialog",value:function value(){var e=this;if(!document.getElementById("dvsImageEditorChangeSizeBox")){var t=this.webViewer.getHowManyImagesInBuffer(),i=this.webViewer.getCurrentIndex();if(!(t<=0||i<0)){var r=document.getElementById("changeImageSize".concat(this.editorViewer.postfix));if(r){var n=this.editorViewer.getCurrentTab().currentPage,o=n.realTimeWidth,a=n.realTimeHeight,s=this.createChangeSizeDialog(Math.floor(o),Math.floor(a));r.appendChild(s);var l=r.getBoundingClientRect(),u=l.width,c=l.height;s.style.left=u/2+"px",s.style.top=c/2+"px";var h=document.getElementById("dvsImageEditorChangeSizeOk"),d=document.getElementById("dvsImageEditorChangeSizeCancel");this.bindStopPropagation("dvsImageEditorChangeSizeBox"),h&&(h.onclick=function(t){uL(t),e.changeImageSizeInner();}),d&&(d.onclick=function(t){uL(t),e.closeChangeSizeDialog();});}}}}},{key:"closeChangeSizeDialog",value:function value(){var e=document.getElementById("dvsImageEditorChangeSizeBox");e&&e.parentNode.removeChild(e);}}]);var e,t,i,r,n,o,a,s,l,u,c,h,d;}();function jq(e){var t=e.tag,i=e.className,r=void 0===i?"":i,n=e.attributes,o=void 0===n?{}:n,a=e.textContent,s=void 0===a?"":a,l=e.children,u=void 0===l?[]:l,c=document.createElement(t);r&&(c.className=r);for(var h=0,d=IB(o);h<d.length;h++){var f=ek(d[h],2),v=f[0],g=f[1];if("style"===v){var m=Xq(g);for(var y in m)m.hasOwnProperty(y)&&(c.style[y]=m[y]);}else c.setAttribute(v,g);}return s&&(c.textContent=s),pS(u).call(u,function(e){var t=jq(e);c.appendChild(t);}),c;}function Xq(e){var t=e.split(";"),i={};return pS(t).call(t,function(e){var t,r=ix(e).call(e);if(r){var n=wP(t=r.split(":")).call(t,function(e){return ix(e).call(e);}),o=ek(n,2),a=o[0],s=o[1],l=a.replace(/-(\w)/g,function(e,t){return t.toUpperCase();});i[l]=s;}}),i;}var Yq=function(){return hS(function e(t,i){dS(this,e),sS(this,"inner",void 0),this.inner=new Hq(t,i);},[{key:"idPostfix",get:function get(){return this.inner.editorViewer.postfix;}},{key:"zoomOrigin",get:function get(){return this.inner.getZoomOrigin();},set:function set(e){this.inner.webViewer.setError("Successful"),this.inner.setZoomOrigin(e);}},{key:"show",value:function value(){return this.inner.webViewer.setError("Successful"),this.inner.show();}},{key:"hide",value:function value(){return this.inner.webViewer.setError("Successful"),this.inner.hideImageEditor();}},{key:"save",value:function value(){return this.inner.webViewer.setError("Successful"),this.inner.saveImageAsync();}},{key:"dispose",value:function value(){return this.inner.webViewer.setError("Successful"),this.inner.dispose();}},{key:"updateSelectionBoxStyle",value:function value(e){this.inner.setSelectionBoxStyle(e);}}]);}();function qq(e,t){var i=t.getViewerConfig(),r=i.rows,n=i.columns,o=getComputedStyle(t.canvasContainer).fontSize,a=t.canvasContainer.getBoundingClientRect(),s=a.width,l=a.height,u=zW(e),c=s||0,h=l||0,d=zW(o).value,f=Math.floor(Math.min(h/(2*r+1),c/(2*n+1))),v=e,g=0;switch(u.unit){case"%":g=.01*u.value*c;break;case"em":g=u.value*d;break;default:g=u.value;}if(g>f)switch(u.unit){case"%":v="".concat(Math.floor(f/c*100),"%");break;case"em":v="".concat(Math.floor(f/d),"em");break;case"px":v="".concat(f,"px");break;default:v=f;}return v;}var Zq=function(){return hS(function e(t,i){if(dS(this,e),sS(this,"stretchBarColor","black"),sS(this,"bHide",!0),sS(this,"pageMargin",10),sS(this,"bSingleMode",!1),sS(this,"bDispose",!1),sS(this,"webViewer",void 0),sS(this,"myThumbnailViewer",void 0),sS(this,"thbStretchBar",null),sS(this,"enableResizing",!1),sS(this,"enableProps",["enableDragPage","enableResizing","autoSelectTopPage"]),sS(this,"keyboardControl",!0),sS(this,"stretchEventHandlers",{}),this.webViewer=t,i){var r=i.removeBtn;pO(null==r?void 0:r.removeMarkColor)||(r.checkMarkColor=r.removeMarkColor),pO(null==r?void 0:r.removeMarkLineWidth)||(r.checkMarkLineWidth=r.removeMarkLineWidth);var n=function(e){var t,i,r,n,o,a,s=e.size,l=e.pageMargin,u=e.checkbox,c=e.pageNumber,h=e.removeBtn,d=e.scrollDirection,f={};return pS(t=["showThumbnail","allowKeyboardControl","allowPageDragging","allowResizing","autoChangeIndex"]).call(t,function(t){var i;i=e[t],!pO(i)&&VO(i)&&(f[t]=e[t]);}),pS(i=["columns","rows"]).call(i,function(t){(function(e){var t=zW(e);return!(pO(t)||t.value<0);})(e[t])&&(f[t]=e[t]);}),pS(r=["background","hoverPageBackground","pageBackground","placeholderBackground","selectedPageBackground"]).call(r,function(t){eq(e[t])&&(f[t]=e[t]);}),pS(n=["border","hoverPageBorder","pageBorder","selectedPageBorder"]).call(n,function(t){tq(e[t])&&(f[t]=e[t]);}),pS(o=["location"]).call(o,function(t){var i;i=e[t],!pO(i)&&bO(i)&&(f[t]=e[t]);}),function(e){var t=zW(e);return!pO(t)&&!(t.value>100&&"%"===t.unit||t.value<0);}(s)&&(f.size=s),iq(l)&&(f.pageMargin=l),pO(u)||(f.checkbox=u),pO(c)||(f.pageNumber=c),pO(h)||(f.removeBtn=h),-1!==sE(a=["vertical","horizontal"]).call(a,d)&&(f.scrollDirection=d),f;}(i);i=this.mergeThumbSettings(n);}else i=_mO(mW);this.myThumbnailViewer=this.webViewer.myViewer.createThumbnail(i),this.bDispose=!1,this.pageMargin=this.myThumbnailViewer.getThbConfigByName("gap"),this.webViewer.bThumbnailDispose=!1,this.setIfAutoScroll(this.webViewer.getIfAutoScroll()),i.show&&(this.bHide=!1,this.setPageMargin(this.pageMargin)),this.bindDefaultEvent(),this.initStretchBar(),this.allowResize=i.enableResizing;},[{key:"setDefaultError",value:function value(){var e=this.bDispose?"ThumbnailViewerDispose":"ThumbnailViewerNotExist";this.webViewer.setError(e);}},{key:"getLegalBorder",value:function value(e,t){var i,r;if(pO(e))return"";if(""===e)return"";var n=document.createElement("div");n.style.border=e;var o=n.style,a=o.borderWidth,s=o.borderColor,l=o.borderStyle;return BS(i=BS(r="".concat(""===a||"initial"===a||"medium"===a?"1px":a," ")).call(r,"initial"===l||"none"===l?"solid":l," ")).call(i,"initial"===s||"currentcolor"===s?t:s);}},{key:"mergeThumbSettings",value:function value(e){var t="horizontal",i=-1;switch(e.location||"left"){case"right":t="horizontal",i=1;break;case"top":t="vertical",i=-1;break;case"bottom":t="vertical",i=1;}var r=e.showThumbnail,n=e.size,o=e.columns,a=e.rows,s=e.autoChangeIndex,l=e.allowPageDragging,u=e.allowKeyboardControl,c=e.allowResizing,h=e.pageMargin,d=e.scrollDirection,f=e.background,v=e.border,g=e.hoverPageBackground,m=e.hoverPageBorder,y=e.pageBackground,p=e.pageBorder,w=e.placeholderBackground,b=e.selectedPageBackground,k=e.selectedPageBorder,S=h,x=h;a===o&&1===a&&(x=0,this.bSingleMode=!0);var C={location:t,sequence:i,show:r,size:n,columns:o,rows:a,autoSelectTopPage:s,enableDragPage:l,enableKeyboardControl:u,enableResizing:c,gap:S,margin:x,scrollDirection:d,thumbnailStyle:{background:f||this.webViewer.getBackground(),border:this.getLegalBorder(v,"rgba(0,0,0,0)")||""},hoveredPageStyle:{background:g||"rgb(239, 246, 253)",border:this.getLegalBorder(m,"rgb(238, 238, 238)")||"1px solid rgb(238, 238, 238)"},pageStyle:{background:y||"transparent",border:this.getLegalBorder(p,"rgb(238, 238, 238)")||"1px solid rgb(238, 238, 238)"},placeholderStyle:{background:w||"rgb(251, 236, 136)"},selectedPageStyle:{background:b||"rgb(199, 222, 252)",border:this.getLegalBorder(k,"rgb(125, 162, 206)")||"1px solid rgb(125, 162, 206)"},checkboxStyle:uS(uS({},this.webViewer.myViewer.getViewerConfig().checkboxStyle),eL(e.checkbox)),pageNumberStyle:uS(uS({},this.webViewer.myViewer.getViewerConfig().pageNumberStyle),eL(e.pageNumber)),removeBtnStyle:uS(uS({},this.webViewer.myViewer.getViewerConfig().removeBtnStyle),eL(e.removeBtn)),multiselectMode:1===this.webViewer.getMultiSelectMode()},V={};return MO(_mO(mW),V),MO(eL(C),V),V;}},{key:"bindDefaultEvent",value:function value(){this.myThumbnailViewer&&this.webViewer&&(this.bindDefaultKeyDown(),this.bindDefaultContextmenu());}},{key:"bindDefaultKeyDown",value:function value(){var e=this;this.myThumbnailViewer.on("keydown",function(t){if(e.keyboardControl)return"ArrowUp"===t.key||"Up"===t.key?(t.preventDefault(),void e.webViewer.previous()):void("ArrowDown"!==t.key&&"Down"!==t.key||(t.preventDefault(),e.webViewer.next()));});}},{key:"bindDefaultContextmenu",value:function value(){var e=this;this.myThumbnailViewer.on("contextmenu",function(t,i){e.webViewer.hideContextmenu&&i.preventDefault();});}},{key:"initStretchBar",value:function value(){var e=document.createElement("div");e.id="thbStretchBar",e.style.display="none",this.thbStretchBar=e;var t=this.getLocation(),i=this.myThumbnailViewer.innerViewer.rootDom;e.className="top"!==t&&"bottom"!==t?"dvs-thbStretchBarH dvs-thbStretchBar-".concat(t):"dvs-thbStretchBarV dvs-thbStretchBar-".concat(t),i.appendChild(e),this.bindStretchEvent(e);}},{key:"bindStretchEvent",value:function value(e){var t=this,i=0,r=0,n=!1,o=this.getLocation(),a=0,s=0,l=0,u=0,c=function c(_c3){if(t.myThumbnailViewer){var h=t.myThumbnailViewer.innerViewer.rootDom,d=t.webViewer.myViewer.rootDom,f=getComputedStyle(h),v=getComputedStyle(d);l=AW(f.width).value,u=AW(f.height).value,a=AW(v.width).value,s=AW(v.height).value,i=_c3.clientX,r=_c3.clientY,n=!0,o=t.getLocation(),e.style.background=t.stretchBarColor;}},h=function h(c){if(n&&t.myThumbnailViewer){var h="left"===o?c.clientX-i:i-c.clientX,d="top"===o?c.clientY-r:r-c.clientY;"right"===o&&t.thbStretchBar.classList.remove("dvs-thbStretchBar-right"),"bottom"===o&&t.thbStretchBar.classList.remove("dvs-thbStretchBar-bottom");var f=l+h;"top"!==o&&"bottom"!==o||(f=u+d),f<0&&(f=0),("left"===o||"right"===o)&&f>a&&(f=a),("top"===o||"bottom"===o)&&f>s&&(f=s),e.style[o]="".concat(f,"px");}},d=function d(i){if(n&&t.myThumbnailViewer){n=!1;var r,a=t.myThumbnailViewer.getThbConfigByName("size");switch(o){case"top":""!==e.style.top&&(r=AW(e.style.top),e.style.top="");break;case"bottom":""!==e.style.bottom&&(r=AW(e.style.bottom),e.style.bottom="",t.thbStretchBar.classList.add("dvs-thbStretchBar-bottom"));break;case"right":""!==e.style.right&&(r=AW(e.style.right),e.style.right="",t.thbStretchBar.classList.add("dvs-thbStretchBar-right"));break;default:""!==e.style.left&&(r=AW(e.style.left),e.style.left="");}e.style.background="",r&&a!==r.value&&(t.myThumbnailViewer.updateThbConfig({size:Math.floor(r.value)}),t.emitThumbnailResize(),t.resized());}};this.stretchEventHandlers={pointerdown:c,pointermove:h,pointerup:d},window.PointerEvent?(e.addEventListener("pointerdown",c),document.addEventListener("pointermove",h),document.addEventListener("pointerup",d)):window.MSPointerEvent?(e.addEventListener("MSPointerDown",c),document.addEventListener("MSPointerMove",h),document.addEventListener("MSPointerUp",d)):(e.addEventListener("mousedown",c),document.addEventListener("mousemove",h),document.addEventListener("mouseup",d));}},{key:"unbindStretchEvent",value:function value(){if(this.thbStretchBar&&this.stretchEventHandlers.pointerdown){var e=this.stretchEventHandlers,t=e.pointerdown,i=e.pointermove,r=e.pointerup;window.PointerEvent?(this.thbStretchBar.removeEventListener("pointerdown",t),document.removeEventListener("pointermove",i),document.removeEventListener("pointerup",r)):window.MSPointerEvent?(this.thbStretchBar.removeEventListener("MSPointerDown",t),document.removeEventListener("MSPointerMove",i),document.removeEventListener("MSPointerUp",r)):(this.thbStretchBar.removeEventListener("mousedown",t),document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",r)),this.stretchEventHandlers={};}}},{key:"showThumbnail",get:function get(){return this.myThumbnailViewer.getThbConfig().show;},set:function set(e){this.showThumbnail===e&&!0===e||(this.bHide=!e,this.myThumbnailViewer.updateThbConfig({show:e}),this.setPageMargin(this.pageMargin));}},{key:"allowResize",get:function get(){return this.enableResizing;},set:function set(e){this.enableResizing=e,this.thbStretchBar.style.display=!0===e?"":"none";}},{key:"updateThumbnailConfig",value:function value(e){this.myThumbnailViewer.updateThbConfig(e);}},{key:"e",value:function value(){this.webViewer.setError("Successful");}},{key:"setError",value:function value(e){this.webViewer.setError(e);}},{key:"setBorder",value:function value(e){var t;if(!this.myThumbnailViewer)return!1;var i=this.getLocation(),r=this.myThumbnailViewer.innerViewer.defaultDom;if(!r)return!1;switch(pS(t=["borderLeft","borderBottom","borderTop","borderRight"]).call(t,function(e){r.style[e]="";}),i){case"right":r.style.borderLeft=e;break;case"top":r.style.borderBottom=e;break;case"bottom":r.style.borderTop=e;break;default:r.style.borderRight=e;}return!0;}},{key:"getLocation",value:function value(){return this.myThumbnailViewer?"vertical"===this.myThumbnailViewer.getThbConfig().location?this.myThumbnailViewer.getThbConfig().sequence>0?"bottom":"top":this.myThumbnailViewer.getThbConfig().sequence>0?"right":"left":(this.setDefaultError(),"");}},{key:"setLocation",value:function value(e){var t=e||"left",i="horizontal",r=-1;if(this.myThumbnailViewer){switch(t){case"right":i="horizontal",r=1;break;case"top":i="vertical",r=-1;break;case"bottom":i="vertical",r=1;}this.myThumbnailViewer.updateThbConfig({location:i,sequence:r});var n=this.getLocation();return this.setBorder(this.webViewer.getBorder()),this.thbStretchBar.className="top"!==n&&"bottom"!==n?"dvs-thbStretchBarH dvs-thbStretchBar-".concat(n):"dvs-thbStretchBarV dvs-thbStretchBar-".concat(n),this.resized(),!0;}return this.setDefaultError(),!1;}},{key:"getSize",value:function value(){return this.myThumbnailViewer?this.myThumbnailViewer.getThbConfig().size:(this.setDefaultError(),!1);}},{key:"setSize",value:function value(e){return!/^((\d+em)|(\d+px)|(\d+%)|(\d+))$/.test(e)||e<0?(this.webViewer.setError("InvalidValue"),!1):e===this.myThumbnailViewer.getThbConfig().size||(this.myThumbnailViewer?(this.setPageMargin(this.pageMargin),this.myThumbnailViewer.updateThbConfig({size:e}),this.bHide?(this.show(),this.emitThumbnailResize(),this.hide()):this.emitThumbnailResize(),this.myThumbnailViewer.innerViewer.resized(),!0):(this.setDefaultError(),!1));}},{key:"getScrollDirection",value:function value(){return this.myThumbnailViewer?this.myThumbnailViewer.getThbConfig().scrollDirection:(this.setDefaultError(),!1);}},{key:"setScrollDirection",value:function value(e){return"horizontal"!==e&&(e="vertical"),this.myThumbnailViewer?(this.myThumbnailViewer.updateThbConfig({scrollDirection:e}),!0):(this.setDefaultError(),!1);}},{key:"getShowPageNumber",value:function value(){return this.myThumbnailViewer?"visible"===this.myThumbnailViewer.getThbConfig().pageNumberStyle.visibility:(this.setDefaultError(),!1);}},{key:"setShowPageNumber",value:function value(e){if(!VO(e))return this.webViewer.setError("InvalidValue"),!1;var t={visibility:e?"visible":"hidden"};return this.updatePageNumberStyle(t),!0;}},{key:"getShowCheckbox",value:function value(){return this.myThumbnailViewer?"visible"===this.myThumbnailViewer.getThbConfig().checkboxStyle.visibility:(this.setDefaultError(),!1);}},{key:"setShowCheckbox",value:function value(e){if(!VO(e))return this.webViewer.setError("InvalidValue"),!1;if(this.myThumbnailViewer){var t={visibility:e?"visible":"hidden"};this.updateCheckboxStyle(t);var i="visible"===t.visibility?1:0;return this.setMultiSelectMode(i),!0;}return this.setDefaultError(),!1;}},{key:"getShowRemoveBtn",value:function value(){return this.myThumbnailViewer?"visible"===this.myThumbnailViewer.getThbConfig().removeBtnStyle.visibility:(this.setDefaultError(),!1);}},{key:"setShowRemoveBtn",value:function value(e){if(!VO(e))return this.webViewer.setError("InvalidValue"),!1;if(this.myThumbnailViewer){var t={visibility:e?"visible":"hidden"};return this.updateRemoveBtnStyle(t),!0;}return this.setDefaultError(),!1;}},{key:"getPageMargin",value:function value(){if(this.myThumbnailViewer){var e=this.myThumbnailViewer.getThbConfig(),t=e.columns,i=e.rows;return t===i&&1===i?0:this.pageMargin;}return this.setDefaultError(),0;}},{key:"setPageMargin",value:function value(e){if(!/^((\d+em)|(\d+px)|(\d+%)|(\d+))$/.test(e)||e<0)return this.webViewer.setError("InvalidValue"),!1;this.pageMargin=e;var t=qq(e,this.myThumbnailViewer.innerViewer);return this.myThumbnailViewer?(this.myThumbnailViewer.updateThbConfig({gap:t}),this.bSingleMode||this.myThumbnailViewer.updateThbConfig({margin:t}),this.resized(),!0):(this.setDefaultError(),!1);}},{key:"getEnableProp",value:function value(e){var t;return-1!==sE(t=this.enableProps).call(t,e)&&("enableResizing"===e?this.allowResize:this.myThumbnailViewer?this.myThumbnailViewer.getThbConfigByName(e):(this.setDefaultError(),!1));}},{key:"setEnableProp",value:function value(e,t){var i;return-1!==sE(i=this.enableProps).call(i,e)&&(VO(t)?("enableResizing"===e&&(this.allowResize=t),this.myThumbnailViewer?(this.myThumbnailViewer.updateThbConfig(sS({},e,t)),!0):(this.setDefaultError(),!1)):(this.webViewer.setError("InvalidValue"),!1));}},{key:"getThumbSetting",value:function value(e){return this.myThumbnailViewer?this.myThumbnailViewer.getThbConfig().thumbnailStyle[e]:(this.setDefaultError(),"");}},{key:"setThumbSetting",value:function value(e,t){if(this.myThumbnailViewer){var i=sS({},e,t);return this.myThumbnailViewer.updateThbConfig({thumbnailStyle:i}),!0;}return this.setDefaultError(),!1;}},{key:"getPageSetting",value:function value(e){return this.myThumbnailViewer?this.myThumbnailViewer.getThbConfig().pageStyle[e]:(this.setDefaultError(),"");}},{key:"setPageSetting",value:function value(e,t){if(this.myThumbnailViewer){var i=sS({},e,t);return this.myThumbnailViewer.updateThbConfig({pageStyle:i}),!0;}return this.setDefaultError(),!1;}},{key:"getHoverSetting",value:function value(e){return this.myThumbnailViewer?this.myThumbnailViewer.getThbConfig().hoveredPageStyle[e]:(this.setDefaultError(),"");}},{key:"setHoverSetting",value:function value(e,t){if(this.myThumbnailViewer){var i=sS({},e,t);return this.myThumbnailViewer.updateThbConfig({hoveredPageStyle:i}),!0;}return this.setDefaultError(),!1;}},{key:"getSelectSetting",value:function value(e){return this.myThumbnailViewer?this.myThumbnailViewer.getThbConfig().selectedPageStyle[e]:(this.setDefaultError(),"");}},{key:"setSelectSetting",value:function value(e,t){if(this.myThumbnailViewer){var i=sS({},e,t);return this.myThumbnailViewer.updateThbConfig({selectedPageStyle:i}),!0;}return this.setDefaultError(),!1;}},{key:"getPlaceholderSetting",value:function value(e){return this.myThumbnailViewer?this.myThumbnailViewer.getThbConfig().placeholderStyle[e]:(this.setDefaultError(),"");}},{key:"setPlaceholderSetting",value:function value(e,t){if(this.myThumbnailViewer){var i=sS({},e,t);return this.myThumbnailViewer.updateThbConfig({placeholderStyle:i}),!0;}return this.setDefaultError(),!1;}},{key:"show",value:function value(){return this.myThumbnailViewer?(this.webViewer.myViewer.setViewMode(1,1),this.webViewer.setIfSinglePageMode(!0),this.myThumbnailViewer.show(),this.bHide=!1,this.setPageMargin(this.pageMargin),!0):(this.setDefaultError(),!1);}},{key:"hide",value:function value(){return this.myThumbnailViewer?(this.bHide=!0,this.myThumbnailViewer.hide(),!0):(this.setDefaultError(),!1);}},{key:"dispose",value:function value(){if(this.bDispose)return!0;this.unbindStretchEvent();var e=this.webViewer.myViewer.removeThumbnail(this.myThumbnailViewer);return this.webViewer.resized(),e&&(this.bDispose=!0,this.webViewer.bThumbnailDispose=!0,this.myThumbnailViewer=void 0,this.webViewer.thumbnailViewer=void 0,this.thbStretchBar=null),e;}},{key:"updateViewMode",value:function value(e){if(!e)return this.webViewer.setError("InvalidValue"),!1;if(this.myThumbnailViewer){var t=e.columns,i=e.rows,r=e.scrollDirection;if(i&&t){var n;if(i<0||t<0)return this.webViewer.setError("InvalidPropertyValue"),!1;this.myThumbnailViewer.setViewMode(i,t),i===t&&1===i?(this.bSingleMode=!0,this.myThumbnailViewer.updateThbConfig({margin:0})):(this.bSingleMode=!1,this.setPageMargin(this.pageMargin),this.myThumbnailViewer.updateThbConfig({margin:this.myThumbnailViewer.getThbConfig().gap})),r&&-1!==sE(n=["horizontal","vertical"]).call(n,r)&&this.myThumbnailViewer.updateThbConfig({scrollDirection:r});}return this.resized(),!0;}return this.setDefaultError(),!1;}},{key:"updateCheckboxStyle",value:function value(e){return this.myThumbnailViewer?(this.myThumbnailViewer.updateThbConfig({checkboxStyle:e}),!0):(this.setDefaultError(),!1);}},{key:"updatePageNumberStyle",value:function value(e){return this.myThumbnailViewer?(this.myThumbnailViewer.updateThbConfig({pageNumberStyle:e}),!0):(this.setDefaultError(),!1);}},{key:"updateRemoveBtnStyle",value:function value(e){if(this.myThumbnailViewer){var t=uS({},e);return pO(null==e?void 0:e.removeMarkColor)||(t.checkMarkColor=null==e?void 0:e.removeMarkColor),pO(null==e?void 0:e.removeMarkLineWidth)||(t.checkMarkLineWidth=null==e?void 0:e.removeMarkLineWidth),this.myThumbnailViewer.updateThbConfig({removeBtnStyle:t}),!0;}return this.setDefaultError(),!1;}},{key:"on",value:function value(e,t){if(e)if(TO(t)){var i=e;switch(e){case"onDrop":i="drop";break;case"rightclick":i="contextmenu";break;case"resize":i="dwtResize";break;default:i=e;}this.myThumbnailViewer.on(i,t);}else this.webViewer.setError("CallbackNotAFunction");}},{key:"off",value:function value(e,t){if(e){var i=e;switch(e){case"onDrop":i="drop";break;case"rightclick":i="contextmenu";break;case"resize":i="dwtResize";break;default:i=e;}if(pO(t))return this.myThumbnailViewer.off(i),"keydown"===i&&this.bindDefaultKeyDown(),void("contextmenu"===i&&this.bindDefaultContextmenu());TO(t)?this.myThumbnailViewer.off(i,t):this.webViewer.setError("CallbackNotAFunction");}}},{key:"setIfAutoScroll",value:function value(e){return!!this.myThumbnailViewer&&(this.myThumbnailViewer.updateThbConfig({autoSelectLatest:e,autoScroll:e}),!0);}},{key:"setMultiSelectMode",value:function value(e){return CO(e)?this.myThumbnailViewer?(this.myThumbnailViewer.updateThbConfig({multiselectMode:1===e}),!0):(this.setDefaultError(),!1):(this.webViewer.setError("InvalidValue"),!1);}},{key:"emitThumbnailResize",value:function value(){if(this.myThumbnailViewer){var e=this.myThumbnailViewer.innerViewer.defaultDom;if(e){var t=e.getClientRects();if(!(t.length<1)){var i=t[0],r=i.width,n=i.height;this.myThumbnailViewer.innerViewer.emit("dwtResize",r,n);}}}}},{key:"resized",value:function value(){this.myThumbnailViewer&&this.myThumbnailViewer.innerViewer.resized();}},{key:"showFocusOutLine",value:function value(e){this.myThumbnailViewer&&this.myThumbnailViewer.innerViewer.context.setDisableFocusOutline(!e);}},{key:"getVisiblePagesInfo",value:function value(){return this.myThumbnailViewer?this.myThumbnailViewer.innerViewer.context.getVisiblePagesInfo():[];}}]);}(),_q=function(){return hS(function e(t,i){dS(this,e),sS(this,"inner",void 0),this.inner=new Zq(t,i);},[{key:"location",get:function get(){return this.inner.e(),this.inner.getLocation();},set:function set(e){this.inner.e(),this.inner.setLocation(e);}},{key:"size",get:function get(){return this.inner.e(),this.inner.getSize();},set:function set(e){this.inner.e(),this.inner.setSize(e);}},{key:"scrollDirection",get:function get(){return this.inner.e(),this.inner.getScrollDirection();},set:function set(e){this.inner.e(),this.inner.setScrollDirection(e);}},{key:"showPageNumber",get:function get(){return this.inner.e(),this.inner.getShowPageNumber();},set:function set(e){this.inner.e(),this.inner.setShowPageNumber(e);}},{key:"showCheckbox",get:function get(){return this.inner.e(),this.inner.getShowCheckbox();},set:function set(e){this.inner.e(),this.inner.setShowCheckbox(e);}},{key:"showRemoveBtn",get:function get(){return this.inner.e(),this.inner.getShowRemoveBtn();},set:function set(e){this.inner.e(),this.inner.setShowRemoveBtn(e);}},{key:"pageMargin",get:function get(){return this.inner.e(),this.inner.getPageMargin();},set:function set(e){this.inner.e(),iq(e)?this.inner.setPageMargin(e):this.inner.setError("InvalidValue");}},{key:"border",get:function get(){return this.inner.e(),this.inner.getThumbSetting("border");},set:function set(e){this.inner.e(),tq(e)&&this.inner.setThumbSetting("border",e);}},{key:"background",get:function get(){return this.inner.e(),this.inner.getThumbSetting("background");},set:function set(e){this.inner.e(),CO(e)&&(e=QY(e)),eq(e)&&this.inner.setThumbSetting("background",e);}},{key:"pageBackground",get:function get(){return this.inner.e(),this.inner.getPageSetting("background");},set:function set(e){this.inner.e(),CO(e)&&(e=QY(e)),eq(e)&&this.inner.setPageSetting("background",e);}},{key:"pageBorder",get:function get(){return this.inner.e(),this.inner.getPageSetting("border");},set:function set(e){this.inner.e(),tq(e)&&this.inner.setPageSetting("border",e);}},{key:"hoverPageBackground",get:function get(){return this.inner.e(),this.inner.getHoverSetting("background");},set:function set(e){this.inner.e(),CO(e)&&(e=QY(e)),eq(e)&&this.inner.setHoverSetting("background",e);}},{key:"hoverPageBorder",get:function get(){return this.inner.e(),this.inner.getHoverSetting("border");},set:function set(e){this.inner.e(),tq(e)&&this.inner.setHoverSetting("border",e);}},{key:"placeholderBackground",get:function get(){return this.inner.e(),this.inner.getPlaceholderSetting("background");},set:function set(e){this.inner.e(),CO(e)&&(e=QY(e)),eq(e)&&this.inner.setPlaceholderSetting("background",e);}},{key:"selectedPageBorder",get:function get(){return this.inner.e(),this.inner.getSelectSetting("border");},set:function set(e){this.inner.e(),tq(e)&&this.inner.setSelectSetting("border",e);}},{key:"selectedPageBackground",get:function get(){return this.inner.e(),this.inner.getSelectSetting("background");},set:function set(e){this.inner.e(),CO(e)&&(e=QY(e)),eq(e)&&this.inner.setSelectSetting("background",e);}},{key:"allowKeyboardControl",get:function get(){return this.inner.e(),this.inner.keyboardControl;},set:function set(e){this.inner.e(),VO(e)&&(this.inner.keyboardControl=e);}},{key:"allowPageDragging",get:function get(){return this.inner.e(),this.inner.getEnableProp("enableDragPage");},set:function set(e){this.inner.e(),this.inner.setEnableProp("enableDragPage",e);}},{key:"allowResizing",get:function get(){return this.inner.e(),this.inner.getEnableProp("enableResizing");},set:function set(e){this.inner.e(),this.inner.setEnableProp("enableResizing",e);}},{key:"autoChangeIndex",get:function get(){return this.inner.e(),this.inner.getEnableProp("autoSelectTopPage");},set:function set(e){this.inner.e(),this.inner.setEnableProp("autoSelectTopPage",e);}},{key:"show",value:function value(){return this.inner.e(),this.inner.show();}},{key:"hide",value:function value(){return this.inner.e(),this.inner.hide();}},{key:"dispose",value:function value(){return this.inner.e(),this.inner.dispose();}},{key:"updateViewMode",value:function value(e){return this.inner.e(),this.inner.updateViewMode(e);}},{key:"updateCheckboxStyle",value:function value(e){return this.inner.e(),this.inner.updateCheckboxStyle(e);}},{key:"updatePageNumberStyle",value:function value(e){return this.inner.e(),this.inner.updatePageNumberStyle(e);}},{key:"on",value:function value(e,t){return this.inner.e(),this.inner.on(e,t);}},{key:"off",value:function value(e,t){return this.inner.e(),this.inner.off(e,t);}},{key:"getVisiblePagesInfo",value:function value(){return this.inner.e(),this.inner.getVisiblePagesInfo();}}]);}(),Gq={root:{style:{},className:"dvs-web-viewer",id:"root",children:[{type:"Group",dataId:"body",className:"dvs-body",children:[{type:"MainCanvas",style:{},dataId:"canvas",className:"dvs-canvas"}]}]}},Kq=function(){function e(t,i){dS(this,e),sS(this,"myDvs",void 0),sS(this,"myViewer",void 0),sS(this,"error",void 0),sS(this,"containerElement",void 0),sS(this,"imageEditor",void 0),sS(this,"customElement",void 0),sS(this,"thumbnailViewer",void 0),sS(this,"bindViewUI",!1),sS(this,"hideContextmenu",!0),sS(this,"acceptDrop",void 0),sS(this,"bShowImageEditor",void 0),sS(this,"bThumbnailDispose",void 0),sS(this,"bufferService",void 0),sS(this,"webViewerInitConfig",{}),sS(this,"bEmitBufferChanged",!0),sS(this,"pageMargin",10),sS(this,"initWidth",void 0),sS(this,"initHeight",void 0),sS(this,"bSingleMode",!0),sS(this,"oldEnableDrag",!0),sS(this,"oldBShowThumbnail",!1),sS(this,"outerBorder","1px solid rgb(204, 204, 204)"),sS(this,"minZoom",.02),sS(this,"maxZoom",65),sS(this,"bindViewEvent",!1),sS(this,"resizeObserver",null),this.acceptDrop=!0,this.bShowImageEditor=!1,this.error=new bW(),this.bufferService=t||new kW(),this.webViewerInitConfig=i||{},this.init(),this.bufferService.bindViewer(this);}return hS(e,[{key:"init",value:function value(){var t=this;e.isInstallDVSPlugin||(DX.use(WY),DX.use($Y),DX.use(sY),DX.use(MW),DX.use(HY),e.isInstallDVSPlugin=!0),this.myDvs=new DX({space:this.bufferService.space,container:""}),this.myViewer=this.myDvs.createViewer({uiConfig:_mO(Gq),viewerConfig:_mO(gW)}),this.myViewer.updateViewerConfig({cropBoxConfig:_mO(wW)});var i=this.webViewerInitConfig.viewerEvents;TO(null==i?void 0:i.bufferChanged)&&this.myViewer.on("bufferChanged",function(e,r){var n;t.bEmitBufferChanged&&(e.docName=(null===(n=t.bufferService.space.dir.getFileByUid(e.docUid))||void 0===n?void 0:n.name)||"",i.bufferChanged(e,r));}),TO(null==i?void 0:i.removeBtnClick)&&this.myViewer.on("removeBtnClick",function(e){i.removeBtnClick(e);}),this.initBind();}},{key:"initBind",value:function value(){var e=this.webViewerInitConfig.viewerContainer;if(pO(e))return!1;var t=e.container,i=e.width,r=e.height;return!!this.bindView(t)&&(pO(i)||(this.setWidth(i),this.initWidth=this.getWidth()),pO(r)||(this.setHeight(r),this.initHeight=this.getHeight()),this.show(),!0);}},{key:"bindDefaultKeyEvent",value:function value(){var e=this;this.myViewer.on("keydown",function(t){var i=e.myViewer.getViewerConfig(),r=i.rows,n=i.columns,o=i.displayMode;if(!(r<1&&n<1||"single"===o))return"ArrowUp"===t.key||"Up"===t.key?(t.preventDefault(),void e.previous()):void("ArrowDown"!==t.key&&"Down"!==t.key||(t.preventDefault(),e.next()));});}},{key:"bindDefaultDrop",value:function value(){var e=this,t=this.webViewerInitConfig.viewerEvents;this.myViewer.on("drop",function(i,r){e.acceptDrop&&t.onDrop(i,r);});}},{key:"bindDefaultRightClick",value:function value(){var e=this.webViewerInitConfig.viewerEvents;this.myViewer.on("contextmenu",function(t,i){e.rightclick(t,i);});}},{key:"preventDefaultContextmenu",value:function value(){var e=this;this.myViewer.on("contextmenu",function(t,i){e.hideContextmenu&&i.preventDefault();});}},{key:"bindViewerEvents",value:function value(){var e=this;if(this.myViewer){var t=this.webViewerInitConfig.viewerEvents;this.myViewer.off("bufferChanged"),this.bindDefaultKeyEvent(),this.preventDefaultContextmenu(),pS(vW).call(vW,function(i){t&&TO(t[i])&&("onDrop"===i?e.bindDefaultDrop():"rightclick"===i?e.bindDefaultRightClick():"bufferChanged"===i?e.myViewer.on("bufferChanged",function(i,r){var n;e.bEmitBufferChanged&&(i.docName=(null===(n=e.bufferService.space.dir.getFileByUid(i.docUid))||void 0===n?void 0:n.name)||"",t.bufferChanged(i,r));}):e.myViewer.on(i,function(e,r){t[i](e,r);}));}),this.bindViewEvent=!0;}}},{key:"unbindViewEvents",value:function value(){var e=this;pS(vW).call(vW,function(t){"bufferChanged"!==t&&e.myViewer.off(t);});}},{key:"initViewer",value:function value(){this.myViewer.updateViewerConfig({autoSelectLatest:!0,maxZoom:this.maxZoom,minZoom:this.minZoom}),EO()?this.setCursor("default"):this.setCursor("crosshair"),this.setAcceptDrop(!0),this.setAllowSlide(!0);}},{key:"getErrorInfo",value:function value(e){return cW[e].errorString||"Successful";}},{key:"disConnectObserver",value:function value(){this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null);}},{key:"emitPageRendered",value:function value(){var e,t=this;this.myViewer.updateViewerConfig({enableEmitPageRendered:!0});var i=this.myViewer.getCurrentTab();i&&pS(e=i.preloadChildren).call(e,function(e,i){e.isVisible&&t.myViewer.emit("pageRendered",e.pageIndex);});}},{key:"updateViewerConfig",value:function value(e){this.myViewer.updateViewerConfig(e);}},{key:"resetImageEditorButton",value:function value(){this.imageEditor&&this.imageEditor.inner.resetButtonState();}},{key:"resized",value:function value(){return!!this.myViewer&&(this.myViewer.resized(),!0);}},{key:"setBufferService",value:function value(e){return!!e&&e!==this.bufferService&&(this.bufferService.webViewer=void 0,this.myDvs.setSpace(e.space),this.bufferService=e,this.bufferService.bindViewer(this),this.bufferService.isActiveFile?this.bufferService.openDocument(this.bufferService.getCurrentDocument()):this.bufferService.isActiveTag&&this.bufferService.filterImagesByTag(this.bufferService.getCurrentTag(),function(){},function(){}),this.resized(),!0);}},{key:"setDefaultError",value:function value(){var e=this.webViewerInitConfig.viewerError,t=this.myDvs.context.errorService,i=t.errorCode,r=t.errorMessage;TO(null==e?void 0:e.setError)&&null!=e&&e.setError(i,r),this.error.setError(i,r);}},{key:"setError",value:function value(e){var t=this.webViewerInitConfig.viewerError,i=cW[e],r=i.errorCode,n=i.errorString;TO(null==t?void 0:t.setError)&&null!=t&&t.setError(r,n),this.error.setError(r,n);}},{key:"show",value:function value(){return this.bindViewUI?!!this.myViewer&&(this.myViewer.show(),this.setPageMargin(this.pageMargin),!0):(this.setError("UnBindViewer"),!1);}},{key:"hide",value:function value(){return this.bindViewUI?!!this.myViewer&&(this.myViewer.hide(),!0):(this.setError("UnBindViewer"),!1);}},{key:"setOperationMode",value:function value(e){if(this.myViewer){var t="default";switch(e){case 1:t="crop";break;case 3:t="zoomOut";break;case 2:t="zoomIn";break;case 4:t="annotation";break;default:t="default";}this.myViewer.updateViewerConfig({toolType:t});}}},{key:"bindView",value:function value(e){var t,i,r,n=this,o=null;if(this.closeImageEditor(),e&&(o="DIV"===(null==e?void 0:e.nodeName)?e:document.getElementById(e)),pO(o)||PO(o))return this.setError("ElementNotExist"),!1;if(bO(o.id)||(o.id=AO()),(null===(t=o)||void 0===t||null===(i=t.getElementsByClassName("dvs-root dvs-web-viewer"))||void 0===i?void 0:i.length)>0)return this.setError("AlReadyBindViewer"),!1;if(!(r=this.myViewer.bindContainer(o)))return this.setDefaultError(),!1;var a=this.webViewerInitConfig.viewerEvents;if(a&&TO(a.onBind)&&a.onBind(o),this.bindViewUI=!0,this.containerElement=o,this.initWidth=this.getWidth(),this.initHeight=this.getHeight(),this.initViewer(),this.setBorder(this.outerBorder),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),TO(window.ResizeObserver)){var s=new ResizeObserver(function(){var e;(null===(e=document)||void 0===e?void 0:e.body)&&n.render();});s.observe(this.myViewer.rootDom),this.resizeObserver=s;}else this.resizeObserver=null;return this.bindViewUI&&!this.bindViewEvent&&this.bindViewerEvents(),r;}},{key:"unbindView",value:function value(){if(!this.bindViewUI)return!0;var e;if(this.resetViewerSettings(!1),this.disposeComponent(),e=this.myViewer.unbindContainer()){this.hide(),this.unbindViewEvents(),this.bindViewUI=!1,this.bindViewEvent=!1;var t=this.webViewerInitConfig.viewerEvents;t&&TO(t.onUnBind)&&t.onUnBind(this.containerElement),this.containerElement="";}else this.setDefaultError();return e;}},{key:"getIdPostfix",value:function value(){return this.bindViewUI?!!this.myViewer&&this.myViewer.postfix:(this.setError("UnBindViewer"),"");}},{key:"getCursor",value:function value(){return this.bindViewUI?!!this.myViewer&&this.myViewer.getViewerConfig().canvasStyle.cursor:(this.setError("UnBindViewer"),"");}},{key:"setCursor",value:function value(e){if(!this.bindViewUI)return this.setError("UnBindViewer"),!1;if(!this.myViewer)return!1;if(("zoom-in"===e||"zoom-out"===e)&&!this.getIfSinglePageMode())return this.setError("CursorInvalidMode"),!1;"crosshair"===this.getCursor()&&"crosshair"!==e&&this.clearSelectedAreas();var t="default",i=0;switch(e){case"zoom-out":t="zoom-out",i=3;break;case"zoom-in":t="zoom-in",i=2;break;case"crosshair":t="crosshair",i=1;break;case"pointer":t="pointer",i=0;break;default:t="default",i=0;}return this.myViewer.updateViewerConfig({canvasStyle:{cursor:t}}),this.setOperationMode(i),!0;}},{key:"setIfSinglePageMode",value:function value(e){if(!this.bindViewUI)return this.setError("UnBindViewer"),!1;if(!this.myViewer)return!1;var t=e?"single":"multiple",i=0;if(e)this.bSingleMode=!0,i=0;else{var r=this.myViewer.getViewerConfig(),n=r.rows,o=r.columns;(n>1||o>1)&&(i=this.myViewer.getViewerConfig().gap,this.bSingleMode=!1);}return this.myViewer.updateViewerConfig({displayMode:t,margin:i}),this.clearSelectedAreas(),this.resized(),!0;}},{key:"getIfSinglePageMode",value:function value(){return this.bindViewUI?!!this.myViewer&&"single"===this.myViewer.getViewerConfigByName("displayMode"):(this.setError("UnBindViewer"),!1);}},{key:"setZoom",value:function value(e){return this.bindViewUI?!!this.myViewer&&(this.myViewer.updateViewerConfig({zoom:e}),!0):(this.setError("UnBindViewer"),!1);}},{key:"getZoom",value:function value(){return this.bindViewUI?!!this.myViewer&&this.myViewer.getViewerConfigByName("zoom"):(this.setError("UnBindViewer"),"");}},{key:"setZoomOrigin",value:function value(e){var t,i;if(!this.bindViewUI)return this.setError("UnBindViewer"),"";if(!this.myViewer)return!1;if(!gO(e)||!bO(null==e?void 0:e.x)||!bO(null==e?void 0:e.y))return this.setError("InvalidValue"),!1;var r=e.x,n=e.y;return-1===sE(t=["left","right","center"]).call(t,r)||-1===sE(i=["top","bottom","center"]).call(i,n)?(this.setError("InvalidValue"),!1):(this.updateViewerConfig({zoomOrigin:{x:r,y:n}}),!0);}},{key:"getZoomOrigin",value:function value(){return this.bindViewUI?!!this.myViewer&&this.myViewer.getViewerConfigByName("zoomOrigin"):(this.setError("UnBindViewer"),"");}},{key:"setAcceptDrop",value:function value(e){return this.bindViewUI?!!this.myViewer&&(VO(e)?(this.acceptDrop=e,!0):(this.setError("InvalidValue"),!1)):(this.setError("UnBindViewer"),!1);}},{key:"getAcceptDrop",value:function value(){return this.bindViewUI?!!this.myViewer&&this.acceptDrop:(this.setError("UnBindViewer"),"");}},{key:"setAllowSlide",value:function value(e){return this.bindViewUI?!!this.myViewer&&(VO(e)?(this.myViewer.updateViewerConfig({enableSlide:e}),!0):(this.setError("InvalidValue"),!1)):(this.setError("UnBindViewer"),!1);}},{key:"getAllowSlide",value:function value(){return this.bindViewUI?!!this.myViewer&&this.myViewer.getViewerConfigByName("enableSlide"):(this.setError("UnBindViewer"),"");}},{key:"setShowRemoveBtn",value:function value(e){if(!this.bindViewUI)return this.setError("UnBindViewer"),!1;if(!this.myViewer)return!1;if(!VO(e))return this.setError("InvalidValue"),!1;var t=e?"visible":"hidden";return this.myViewer.updateViewerConfig({removeBtnStyle:{visibility:t}}),!0;}},{key:"getShowRemoveBtn",value:function value(){return this.bindViewUI?!!this.myViewer&&"visible"===this.myViewer.getViewerConfig().removeBtnStyle.visibility:(this.setError("UnBindViewer"),"");}},{key:"setShowCheckbox",value:function value(e){if(!this.bindViewUI)return this.setError("UnBindViewer"),!1;if(!this.myViewer)return!1;if(!VO(e))return this.setError("InvalidValue"),!1;var t=e?"visible":"hidden",i="visible"===t?1:0;return this.myViewer.updateViewerConfig({checkboxStyle:{visibility:t}}),this.setMultiSelectMode(i),this.thumbnailViewer&&(this.thumbnailViewer.showCheckbox=!0),!0;}},{key:"getShowCheckbox",value:function value(){return this.bindViewUI?!!this.myViewer&&"visible"===this.myViewer.getViewerConfig().checkboxStyle.visibility:(this.setError("UnBindViewer"),"");}},{key:"getSelectionRectAspectRatio",value:function value(){if(!this.bindViewUI)return this.setError("UnBindViewer"),"";if(!this.myViewer)return!1;var e=this.myViewer.cropBoxConfig,t=e.aspectRatio;return!1===e.keepAspectRatio||t<1?0:this.myViewer.cropBoxConfig.aspectRatio;}},{key:"setSelectionRectAspectRatio",value:function value(e){if(!this.bindViewUI)return this.setError("UnBindViewer"),!1;if(!this.myViewer)return!1;var t=e>0,i=e>0?e:0;return this.myViewer.updateViewerConfig({cropBoxConfig:{aspectRatio:i,keepAspectRatio:t}}),!0;}},{key:"getIfAutoScroll",value:function value(){return this.bindViewUI?!!this.myViewer&&this.myViewer.getViewerConfig().autoScroll:(this.setError("UnBindViewer"),"");}},{key:"setIfAutoScroll",value:function value(e){return this.bindViewUI?!!this.myViewer&&(VO(e)?(this.thumbnailViewer&&this.thumbnailViewer.inner.setIfAutoScroll(e),this.imageEditor&&this.imageEditor.inner.setIfAutoScroll(e),this.myViewer.updateViewerConfig({autoSelectLatest:e,autoScroll:e}),!0):(this.setError("InvalidValue"),!1)):(this.setError("UnBindViewer"),!1);}},{key:"getPageMargin",value:function value(){return this.bindViewUI?!!this.myViewer&&this.pageMargin:(this.setError("UnBindViewer"),0);}},{key:"setPageMargin",value:function value(e){if(!this.bindViewUI)return this.setError("UnBindViewer"),!1;if(!this.myViewer)return!1;if(!/^((\d+em)|(\d+px)|(\d+%)|(\d+))$/.test(e)||e<0)return this.setError("InvalidValue"),!1;if(!iq(e))return!1;this.pageMargin=e;var t=qq(e,this.myViewer);return this.myViewer.updateViewerConfig({gap:t}),this.bSingleMode||this.myViewer.updateViewerConfig({margin:t}),this.resized(),!0;}},{key:"getWidth",value:function value(){if(!this.bindViewUI)return this.setError("UnBindViewer"),"";if(this.myViewer){var e=this.myViewer.dwtWidth||"";if(window.navigator.userAgent.match(/Trident/g)||window.navigator.userAgent.match(/MSIE/g)){var t=this.myViewer.rootDom,i=getComputedStyle(t).borderLeftWidth,r=2*AW(i).value;if(CO(e))return e+r;}return e;}return"";}},{key:"setWidth",value:function value(e){if(!this.bindViewUI)return this.setError("UnBindViewer"),!1;if(bO(e)&&!/^((\d+em)|(\d+px)|(\d+%)|(\d+))$/.test(e)||CO(e)&&e<0)return this.setError("InvalidWidth"),!1;if(e===this.myViewer.dwtWidth)return!0;if(this.myViewer.dwtWidth=e,this.myViewer.getViewerConfig().show&&this.setPageMargin(this.pageMargin),this.thumbnailViewer){var t=this.thumbnailViewer.size;"%"===zW(t).unit&&this.thumbnailViewer.inner.emitThumbnailResize();}return!0;}},{key:"getHeight",value:function value(){if(!this.bindViewUI)return this.setError("UnBindViewer"),"";if(this.myViewer){var e=this.myViewer.dwtHeight||"";if(window.navigator.userAgent.match(/Trident/g)||window.navigator.userAgent.match(/MSIE/g)){var t=this.myViewer.rootDom,i=getComputedStyle(t).borderLeftWidth,r=2*AW(i).value;if(CO(e))return e+r;}return e;}return"";}},{key:"setHeight",value:function value(e){if(!this.bindViewUI)return this.setError("UnBindViewer"),!1;if(bO(e)&&!/^((\d+em)|(\d+px)|(\d+%)|(\d+))$/.test(e)||CO(e)&&e<0)return this.setError("InvalidHeight"),!1;if(e===this.myViewer.dwtHeight)return!0;if(this.myViewer.dwtHeight=e,this.myViewer.getViewerConfig().show&&this.setPageMargin(this.pageMargin),this.thumbnailViewer){var t=this.thumbnailViewer.size;"%"===zW(t).unit&&this.thumbnailViewer.inner.emitThumbnailResize();}return!0;}},{key:"getBackground",value:function value(){return this.bindViewUI?this.myViewer?this.myViewer.getViewerConfig().canvasStyle.background:"":(this.setError("UnBindViewer"),"");}},{key:"setBackground",value:function value(e){return this.bindViewUI?!(!this.myViewer&&!this.thumbnailViewer||!eq(e)||(this.myViewer&&this.myViewer.updateViewerConfig({canvasStyle:{background:e}}),this.thumbnailViewer&&(this.thumbnailViewer.background=e),0)):(this.setError("UnBindViewer"),!1);}},{key:"getBorder",value:function value(){return this.bindViewUI?this.outerBorder:(this.setError("UnBindViewer"),"");}},{key:"setBorder",value:function value(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.bindViewUI)return this.setError("UnBindViewer"),!1;if(!this.myViewer)return!1;if(!tq(e))return!1;var i=this.myViewer.rootDom;return i&&(i.style.border=e),this.outerBorder=e,this.thumbnailViewer&&this.thumbnailViewer.inner.setBorder(e),t&&this.myViewer.externalResized(),!0;}},{key:"getInnerBorder",value:function value(){return this.bindViewUI?!!this.myViewer&&this.myViewer.getViewerConfig().viewerStyle.border:(this.setError("UnBindViewer"),"");}},{key:"setInnerBorder",value:function value(e){return this.bindViewUI?!!this.myViewer&&!!tq(e)&&(this.myViewer.updateViewerConfig({viewerStyle:{border:e}}),this.resized(),!0):(this.setError("UnBindViewer"),!1);}},{key:"getSelectedPageBorder",value:function value(){return this.bindViewUI?!!this.myViewer&&this.myViewer.getViewerConfig().selectedPageStyle.border:(this.setError("UnBindViewer"),"");}},{key:"setSelectedPageBorder",value:function value(e){return this.bindViewUI?!!this.myViewer&&!!tq(e)&&(this.myViewer.updateViewerConfig({selectedPageStyle:{border:e}}),this.thumbnailViewer&&(this.thumbnailViewer.selectedPageBorder=e),!0):(this.setError("UnBindViewer"),!1);}},{key:"getSelectedPageBackground",value:function value(){return this.bindViewUI?!!this.myViewer&&this.myViewer.getViewerConfig().selectedPageStyle.background:(this.setError("UnBindViewer"),"");}},{key:"setSelectedPageBackground",value:function value(e){return this.bindViewUI?!(!this.myViewer&&!this.thumbnailViewer||!eq(e)||(this.myViewer.updateViewerConfig({selectedPageStyle:{background:e}}),this.thumbnailViewer&&(this.thumbnailViewer.selectedPageBackground=e),0)):(this.setError("UnBindViewer"),!1);}},{key:"getShowPageNumber",value:function value(){return this.bindViewUI?!!this.myViewer&&"visible"===this.myViewer.getViewerConfig().pageNumberStyle.visibility:(this.setError("UnBindViewer"),"");}},{key:"setShowPageNumber",value:function value(e){if(!this.bindViewUI)return this.setError("UnBindViewer"),!1;if(!this.myViewer)return!1;if(!VO(e))return this.setError("InvalidValue"),!1;var t={visibility:e?"visible":"hidden"};return this.updatePageNumberStyle(t),!0;}},{key:"setMultiSelectMode",value:function value(e){if(!this.bindViewUI)return this.setError("UnBindViewer"),!1;if(!this.myViewer)return!1;if(!CO(e))return this.setError("InvalidValue"),!1;var t=1===e;return this.myViewer.updateViewerConfig({multiselectMode:t}),this.thumbnailViewer&&this.thumbnailViewer.inner.setMultiSelectMode(e),t&&this.setCursor("pointer"),!0;}},{key:"getMultiSelectMode",value:function value(){return this.bindViewUI?!!this.myViewer&&(this.myViewer.getViewerConfig().multiselectMode?1:0):(this.setError("UnBindViewer"),"");}},{key:"setAllowPageDragging",value:function value(e){if(!this.bindViewUI)return this.setError("UnBindViewer"),!1;if(!this.myViewer)return!1;if(!VO)return this.setError("InvalidValue"),!1;var t=e;return this.bSingleMode&&(this.oldEnableDrag=e,t=!1),this.myViewer.updateViewerConfig({enableDragPage:t}),!0;}},{key:"getAllowPageDragging",value:function value(){return this.bindViewUI?!!this.myViewer&&(this.bSingleMode?this.oldEnableDrag:this.myViewer.getViewerConfig().enableDragPage):(this.setError("UnBindViewer"),"");}},{key:"getAutoChangeIndex",value:function value(){return this.bindViewUI?!!this.myViewer&&this.myViewer.getViewerConfig().autoSelectTopPage:(this.setError("UnBindViewer"),"");}},{key:"setAutoChangeIndex",value:function value(e){return this.bindViewUI?!!this.myViewer&&(VO(e)?(this.myViewer.updateViewerConfig({autoSelectTopPage:e}),!0):(this.setError("InvalidValue"),!1)):(this.setError("UnBindViewer"),!1);}},{key:"getSelectedAreaBorderColor",value:function value(){return this.bindViewUI?!!this.myViewer&&this.myViewer.cropBoxConfig.borderColor:(this.setError("UnBindViewer"),"");}},{key:"setSelectedAreaBorderColor",value:function value(e){return this.bindViewUI?!!this.myViewer&&!!eq(e)&&(this.myViewer.updateViewerConfig({cropBoxConfig:{borderColor:e,ctrlBorderColor:e}}),!0):(this.setError("UnBindViewer"),!1);}},{key:"updateCheckboxStyle",value:function value(e){return this.bindViewUI?(this.myViewer.updateViewerConfig({checkboxStyle:e}),this.thumbnailViewer&&this.thumbnailViewer.inner.updateCheckboxStyle(e),!0):(this.setError("UnBindViewer"),!1);}},{key:"updatePageNumberStyle",value:function value(e){return this.bindViewUI?!(!this.myViewer&&!this.thumbnailViewer||(this.myViewer&&this.myViewer.updateViewerConfig({pageNumberStyle:e}),this.thumbnailViewer&&this.thumbnailViewer.updatePageNumberStyle(e),0)):(this.setError("UnBindViewer"),!1);}},{key:"updateRemoveBtnStyle",value:function value(e){if(!this.bindViewUI)return this.setError("UnBindViewer"),!1;var t=uS({},e);return pO(null==e?void 0:e.removeMarkColor)||(t.checkMarkColor=null==e?void 0:e.removeMarkColor),pO(null==e?void 0:e.removeMarkLineWidth)||(t.checkMarkLineWidth=null==e?void 0:e.removeMarkLineWidth),this.myViewer.updateViewerConfig({removeBtnStyle:t}),this.thumbnailViewer&&this.thumbnailViewer.inner.updateRemoveBtnStyle(t),!0;}},{key:"getUISettings",value:function value(){return this.bindViewUI?!!this.myViewer&&this.myViewer.uiConfig:(this.setError("UnBindViewer"),!1);}},{key:"resetViewerSettings",value:function value(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.bindViewUI)return this.setError("UnBindViewer"),!1;if(!this.myViewer)return!1;var t=_mO(gW);return this.initViewer(),this.setWidth(this.initWidth),this.setHeight(this.initHeight),this.setBorder("1px solid rgb(204, 204, 204)",e),this.pageMargin=10,this.bSingleMode=!0,this.oldEnableDrag=!0,this.myViewer.updateViewerConfig({rows:1,columns:1,margin:0,gap:10,zoom:1,enableDragPage:!1,scrollDirection:"vertical",displayMode:"multiple",fitType:"window",autoSelectTopPage:!1,autoScroll:!0,viewerStyle:t.viewerStyle,canvasStyle:t.canvasStyle,pageStyle:t.pageStyle,selectedPageStyle:t.selectedPageStyle,hoveredPageStyle:t.hoveredPageStyle,placeholderStyle:t.placeholderStyle,checkboxStyle:t.checkboxStyle,pageNumberStyle:t.pageNumberStyle}),this.resized(),!0;}},{key:"updateUISettings",value:function value(){return!!this.bindViewUI||(this.setError("UnBindViewer"),!1);}},{key:"setSelectionBoxStyle",value:function value(e){if(!this.bindViewUI)return this.setError("UnBindViewer"),"";if(!gO(e))return!1;if(!this.myViewer)return!1;var t=Wq(e);return this.updateCropBoxConfig(t),!0;}},{key:"getSelectionBoxStyle",value:function value(){return this.bindViewUI?!!this.myViewer&&Fq(this.myViewer.cropBoxConfig):(this.setError("UnBindViewer"),"");}},{key:"updateCropBoxConfig",value:function value(e){return!!this.myViewer&&(this.myViewer.updateViewerConfig({cropBoxConfig:e}),!0);}},{key:"isFocusOutLine",value:function value(){return!!this.myViewer&&this.myViewer.context.showOutline;}},{key:"showFocusOutLine",value:function value(e){this.thumbnailViewer&&this.thumbnailViewer.inner.showFocusOutLine(e),this.imageEditor&&this.imageEditor.inner.editorViewer.context.setDisableFocusOutline(!e),this.myViewer.context.setDisableFocusOutline(!e);}},{key:"getIfShowVideoContainer",value:function value(){return!!this.myViewer&&this.myViewer.getViewerConfig().showVideoContainer;}},{key:"showVideoContainer",value:function value(e){return!!this.myViewer&&(this.getIfShowVideoContainer()===e||(this.thumbnailViewer&&(e?(this.oldBShowThumbnail=this.thumbnailViewer.inner.showThumbnail,this.thumbnailViewer.inner.showThumbnail=!1):this.thumbnailViewer.inner.showThumbnail=this.oldBShowThumbnail),this.myViewer.updateViewerConfig({showVideoContainer:e})),!0);}},{key:"updateVideoImage",value:function value(e){var t=this.myViewer.updateVideoImage(e);return t||this.setDefaultError(),t;}},{key:"createThumbnailViewer",value:function value(e){if(!this.bindViewUI)return this.setError("UnBindViewer"),null;if(this.thumbnailViewer)return this.setError("ThumbnailViewerExist"),this.thumbnailViewer;this.thumbnailViewer=new _q(this,e),this.setBorder(this.outerBorder);var t=this.webViewerInitConfig.viewerEvents;return TO(null==t?void 0:t.removeBtnClick)&&this.thumbnailViewer.on("removeBtnClick",function(e){t.removeBtnClick(e);}),this.showFocusOutLine(this.isFocusOutLine()),this.thumbnailViewer;}},{key:"createImageEditor",value:function value(e){if(!this.bindViewUI)return this.setError("UnBindViewer"),null;if(this.imageEditor)this.setError("ImageEditorExist");else{var t,i,r=yO(_mO(pW),this.webViewerInitConfig.imageEditorUiConfig);r.border=this.getBorder(),r.selectionRectAspectRatio=this.getSelectionRectAspectRatio();var n=r;TO(null===(t=this.webViewerInitConfig)||void 0===t?void 0:t.beforeImageEditorCreated)&&null!==(i=this.webViewerInitConfig)&&void 0!==i&&i.beforeImageEditorCreated(n),e&&(n=yO(n,e)),this.imageEditor=new Yq(this,n);var o=this.getSelectionBoxStyle();this.imageEditor.updateSelectionBoxStyle(o);}return this.showFocusOutLine(this.isFocusOutLine()),this.imageEditor;}},{key:"closeImageEditor",value:function value(){this.imageEditor&&(this.imageEditor.dispose(),this.imageEditor=void 0);}},{key:"createCustomElement",value:function value(e,t,i){if(!this.bindViewUI)return this.setError("UnBindViewer"),null;var r=t||"right",n=!!VO(i)&&i;return pO(e)?(this.setError("ElementRequired"),null):e instanceof HTMLDivElement?(this.customElement?this.setError("CustomElementExist"):this.customElement=new JY(this,e,r,n),this.customElement):(this.setError("ElementNotExist"),null);}},{key:"getCurrentIndex",value:function value(){var e=-1;return this.getHowManyImagesInBuffer()>0&&(e=this.myViewer.getCurrentIndex(),(pO(e)||e<0)&&this.setDefaultError()),e;}},{key:"getCurrentImgUUid",value:function value(){var e=this.myViewer.getCurrentIndex();return-1===e?"":this.bufferService.getUidByIndex(e);}},{key:"getHowManyImagesInBuffer",value:function value(){return!!this.myViewer&&(pO(this.myViewer.currentPageCount)?0:this.myViewer.currentPageCount);}},{key:"getSelectedImagesIndices",value:function value(){return!!this.myViewer&&this.myViewer.getSelectedIndexes();}},{key:"setButtonClass",value:function value(e,t){return this.bindViewUI?pO(e)||pO(t)?(this.setError("InvalidValue"),!1):(this.myViewer.setButtonClass(e,t),!0):(this.setError("UnBindViewer"),!1);}},{key:"setViewMode",value:function value(e,t){if(!this.bindViewUI)return this.setError("UnBindViewer"),!1;var i=!1,r="vertical";if(!CO(e)||!CO(t))return this.setError("InvalidValue"),!1;this.myViewer.updateViewerConfig({enableEmitPageRendered:!1}),this.thumbnailViewer&&this.thumbnailViewer.hide();var n=this.myViewer.getViewerConfig(),o=n.rows,a=n.columns;return-1===e&&-1===t?(this.setIfSinglePageMode(!0),i=!0):(t<0&&(r="horizontal",t=-t),e=e<0?-e:e,this.myViewer.updateViewerConfig({scrollDirection:r}),i=this.myViewer.setViewMode(t,e),1===e&&1===t?(this.bSingleMode=!0,1===o&&1===a||(this.oldEnableDrag=this.myViewer.getViewerConfig().enableDragPage),this.myViewer.updateViewerConfig({margin:0,enableDragPage:!1})):(this.bSingleMode=!1,this.setPageMargin(this.pageMargin),this.myViewer.updateViewerConfig({enableDragPage:this.oldEnableDrag})),this.setIfSinglePageMode(!1),i||this.setDefaultError(),"zoom-in"===this.getCursor()&&this.setCursor("crosshair")),this.emitPageRendered(),i;}},{key:"setFitType",value:function value(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"window";if(!this.bindViewUI)return this.setError("UnBindViewer"),!1;var i="window";return-1===sE(e=["width","height","window"]).call(e,t)?(this.setError("InvalidValue"),!1):(i=t,this.myViewer.updateViewerConfig({fitType:i}),!0);}},{key:"setSelectedAreas",value:function value(e){if(!this.bindViewUI)return this.setError("UnBindViewer"),!1;if("crosshair"!==this.getCursor())return this.setError("OperationError"),!1;var t,i=[],r=!0;if(this.getCurrentIndex()<0)return this.setError("NoImage"),!1;if(pO(e)||pO(e.length)||0===e.length)return this.setError("InvalidLeftOrTopOrRightOrBottom"),!1;if(e.length&&e.length>0)for(var n=0;n<e.length;n++){var o=e[n],a=o.left,s=o.right,l=o.top,u=o.bottom;if(t={},CO(a+s+l+u)){if(a<0||l<0||s<0||u<0)continue;if(a>s||l>u)continue;t.left=a,t.top=l,t.width=s-a,t.height=u-l,i.push(t);}}return 0===i.length?(this.setError("InvalidLeftOrTopOrRightOrBottom"),!1):((r=this.myViewer.setCropBox(i,!0))||this.setDefaultError(),r);}},{key:"clearSelectedAreas",value:function value(){if(!this.bindViewUI)return this.setError("UnBindViewer"),!1;var e=!0;return!(this.getHowManyImagesInBuffer()<=0)&&(e=this.myViewer.clearCropBox(),this.myViewer.render(),e||this.setDefaultError(),e);}},{key:"next",value:function value(){if(!this.bindViewUI)return this.setError("UnBindViewer"),-1;if(!this.myViewer)return!1;var e=this.getHowManyImagesInBuffer();if(e<=0)return this.setError("NoImage"),-1;if(0===e)return 0;var t=this.getIfAutoScroll();return!1===t&&this.setIfAutoScroll(!0),this.imageEditor&&this.imageEditor.inner&&this.imageEditor.inner.bShowImageEditor?this.imageEditor.inner.nextImage():this.myViewer.nextPage(),!1===t&&this.setIfAutoScroll(!1),this.getCurrentIndex();}},{key:"previous",value:function value(){if(!this.bindViewUI)return this.setError("UnBindViewer"),-1;if(!this.myViewer)return!1;var e=this.getHowManyImagesInBuffer();if(e<=0)return this.setError("NoImage"),-1;if(0===e)return 0;var t=this.getIfAutoScroll();return!1===t&&this.setIfAutoScroll(!0),this.imageEditor&&this.imageEditor.inner&&this.imageEditor.inner.bShowImageEditor?this.imageEditor.inner.previousImage():this.myViewer.prevPage(),!1===t&&this.setIfAutoScroll(!1),this.getCurrentIndex();}},{key:"first",value:function value(){if(!this.bindViewUI)return this.setError("UnBindViewer"),-1;if(this.getHowManyImagesInBuffer()<=0)return this.setError("NoImage"),-1;var e=this.getIfAutoScroll();return!1===e&&this.setIfAutoScroll(!0),this.imageEditor&&this.imageEditor.inner&&this.imageEditor.inner.bShowImageEditor?this.imageEditor.inner.first():this.myViewer.firstPage(),this.myViewer.firstPage(),!1===e&&this.setIfAutoScroll(!1),0;}},{key:"last",value:function value(){if(!this.bindViewUI)return this.setError("UnBindViewer"),-1;var e=this.getHowManyImagesInBuffer();if(e<=0)return this.setError("NoImage"),-1;var t=this.getIfAutoScroll();return!1===t&&this.setIfAutoScroll(!0),this.imageEditor&&this.imageEditor.inner&&this.imageEditor.inner.bShowImageEditor?this.imageEditor.inner.last():this.myViewer.lastPage(),!1===t&&this.setIfAutoScroll(!1),e-1;}},{key:"gotoPage",value:function value(e){if(!this.bindViewUI)return this.setError("UnBindViewer"),-1;var t=this.getHowManyImagesInBuffer();if(t<=0)return this.setError("NoImage"),-1;if(t<0||e>=this.getHowManyImagesInBuffer())return this.setError("IndexOutOfRange"),-1;if(!/^(\d+)$/.test(e)||e<0)return this.setError("MobileServer_InvalidIndex"),-1;var i=this.getIfAutoScroll();return!1===i&&this.setIfAutoScroll(!0),this.imageEditor&&this.imageEditor.inner&&this.imageEditor.inner.bShowImageEditor?this.imageEditor.inner.goToPage(e):this.myViewer.gotoPage(e),!1===i&&this.setIfAutoScroll(!1),this.resized(),e;}},{key:"render",value:function value(){return this.bindViewUI?!!this.myViewer&&(this.myViewer.dwtRender(),this.myViewer.externalResized(),this.resized(),!0):(this.setError("UnBindViewer"),!1);}},{key:"on",value:function value(e,t){if(!e)return this.setError("InvalidValue"),!1;if(!TO(t))return this.setError("CallbackNotAFunction"),!1;var i=e;switch(e){case"onDrop":i="drop";break;case"rightclick":i="contextmenu";break;case"resize":i="dwtResize";break;default:i=e;}return this.myViewer.on(i,t),!0;}},{key:"off",value:function value(e,t){if(!e)return this.setError("InvalidValue"),!1;var i=e;switch(e){case"onDrop":i="drop";break;case"rightclick":i="contextmenu";break;case"resize":i="dwtResize";break;default:i=e;}if(pO(t)){this.myViewer.off(i),"contextmenu"===e&&this.preventDefaultContextmenu();var r=this.webViewerInitConfig.viewerEvents;sE(vW).call(vW,e)>=0&&TO(r[e])&&("onDrop"===e?this.bindDefaultDrop():"rightclick"===e?this.bindDefaultRightClick():this.myViewer.on(i,function(t,i){r[e](t,i);}));}else{if(!TO(t))return this.setError("CallbackNotAFunction"),!1;this.myViewer.off(i,t);}return!0;}},{key:"disposeComponent",value:function value(){this.disConnectObserver(),this.imageEditor&&this.imageEditor.dispose(),this.thumbnailViewer&&this.thumbnailViewer.dispose(),this.customElement&&this.customElement.dispose();}},{key:"dispose",value:function value(){if(this.myViewer){this.myViewer.off("bufferChanged"),this.disposeComponent(),this.myViewer.destroy(),this.myViewer=null;var e=this.webViewerInitConfig.viewerEvents;e&&TO(e.onUnBind)&&e.onUnBind(this.containerElement);}this.bufferService&&(this.bufferService.space.destroy(),this.bufferService=null),this.myDvs&&(this.myDvs.destroy(),this.myDvs=null);}},{key:"rotateInner",value:function value(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:90,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.myViewer)return!1;if(!CO(e)||e<0)return this.setError("InvalidIndex"),!1;var r=this.getHowManyImagesInBuffer();return r<0?(this.setError("NoImage"),!1):e>=r?(this.setError("IndexOutOfRange"),!1):CO(t)?(this.myViewer.updateViewerConfig({rotationType:i?"clip":"contain"}),this.myViewer.rotate(t,e)):(this.setError("InvalidValue"),!1);}},{key:"rotate",value:function value(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:90,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!CO(e)||e<0)return this.setError("InvalidIndex"),BB.reject(this.getErrorInfo("InvalidIndex"));var r=this.getHowManyImagesInBuffer();if(r<0)return this.setError("NoImage"),BB.reject(this.getErrorInfo("NoImage"));if(e>=r)return this.setError("IndexOutOfRange"),BB.reject(this.getErrorInfo("IndexOutOfRange"));if(!CO(t))return this.setError("InvalidValue"),BB.reject(this.getErrorInfo("InvalidValue"));var n=this.webViewerInitConfig.viewerEvents;return n&&TO(null==n?void 0:n.rotate)?n.rotate(e,t,i):(this.myViewer.updateViewerConfig({rotationType:i?"clip":"contain"}),this.myViewer.rotate(t,e),this.saveToServer(e));}},{key:"crop",value:(i=Gw(iO().m(function e(t,i){var r,n,o,a,s,l,u,c,h,d;return iO().w(function(e){for(;;)switch(e.n){case 0:if(r=this.getHowManyImagesInBuffer(),!(t<0)&&CO(t)){e.n=1;break;}return e.a(2,(this.setError("InvalidIndex"),BB.reject(this.getErrorInfo("InvalidIndex"))));case 1:if(!(r<0)){e.n=2;break;}return e.a(2,(this.setError("NoImage"),BB.reject(this.getErrorInfo("NoImage"))));case 2:if(!(t>=r)){e.n=3;break;}return e.a(2,(this.setError("IndexOutOfRange"),BB.reject(this.getErrorInfo("IndexOutOfRange"))));case 3:if(n=i.x,o=i.y,a=i.width,s=i.height,!pO(i)&&CO(n+o+a+s)){e.n=4;break;}return e.a(2,(this.setError("InvalidValue"),BB.reject(this.getErrorInfo("InvalidValue"))));case 4:if(!(n<0||o<0||a<=0||s<=0)){e.n=5;break;}return e.a(2,(this.setError("InvalidValue"),BB.reject(this.getErrorInfo("InvalidValue"))));case 5:if(l=this.myViewer.getCurrentTab().getChildByIndex(t),u=this.bufferService.space.statusStore.get(l.uid),c=u.realTimeWidth,h=u.realTimeHeight,!(a>c||s>h)){e.n=6;break;}return e.a(2,(this.setError("WidthOrHeightOutOfImageSize"),BB.reject(this.getErrorInfo("WidthOrHeightOutOfImageSize"))));case 6:return d=this.webViewerInitConfig.viewerEvents,e.a(2,d&&TO(null==d?void 0:d.crop)?d.crop(t,n,o,a,s):(this.myViewer.crop(t,n,o,a,s),this.saveToServer(t)));}},e,this);})),function(e,t){return i.apply(this,arguments);})},{key:"saveToServer",value:(t=Gw(iO().m(function e(t){var i,r,n,o;return iO().w(function(e){for(;;)switch(e.n){case 0:if(i=this.bufferService.getUidByIndex(t),(r=this.webViewerInitConfig.viewerEvents)&&TO(null==r?void 0:r.save)){e.n=1;break;}return e.a(2,BB.reject());case 1:return e.n=2,this.myDvs.getImageData(i,{type:"imageData"});case 2:return n=e.v,o=uS(uS({},this.bufferService.getMetadataByUid(i)),{},{width:Math.floor(n.width),height:Math.floor(n.height)}),e.a(2,r.save(i,n.data.buffer,o,!1));}},e,this);})),function(e){return t.apply(this,arguments);})},{key:"overlayRectangle",value:function value(e,t,i,r,n,o,a){if(pO(e)||pO(t)||pO(i)||pO(r)||pO(n))return!1;var s=r-t,l=n-i;return!(s<=0||l<=0)&&this.myViewer.overlayRectangle(e,t,i,s,l,o,a);}},{key:"selectPages",value:function value(e){if(!this.myViewer)return!1;var t=e[e.length-1],i=this.getCurrentIndex();return this.imageEditor&&this.imageEditor.inner&&this.imageEditor.inner.bShowImageEditor&&t!==i?this.imageEditor.inner.selectPages(e):this.myViewer.setSelectedIndexes(e);}},{key:"removePageByUid",value:function value(e){if(!this.myViewer)return!1;var t=this.myViewer.getIndexByUid(e);return null!==t&&this.myViewer.removePage(t);}},{key:"removePageByIndexes",value:function value(e){return!!this.myViewer&&this.myViewer.removePage(e);}},{key:"removeAllPages",value:function value(){return!!this.myViewer&&this.myViewer.removeAllPages();}},{key:"getVisiblePagesInfo",value:function value(){return this.myViewer?this.myViewer.context.getVisiblePagesInfo():[];}}]);var t,i;}();sS(Kq,"isInstallDVSPlugin",!1);var $q=function(){return hS(function e(t,i){dS(this,e),sS(this,"webViewer",void 0),sS(this,"elements",[]),this.webViewer=new Kq(t,i),this.elements=[],this.focusOutlineEnabled=!1;},[{key:"e",value:function value(){this.webViewer.setError("Successful");}},{key:"focusOutlineEnabled",get:function get(){return this.webViewer.isFocusOutLine();},set:function set(e){this.e(),this.webViewer.showFocusOutLine(e);}},{key:"idPostfix",get:function get(){return this.e(),this.webViewer.getIdPostfix();}},{key:"width",get:function get(){return this.e(),this.webViewer.getWidth();},set:function set(e){this.e(),this.webViewer.setWidth(e);}},{key:"height",get:function get(){return this.e(),this.webViewer.getHeight();},set:function set(e){this.e(),this.webViewer.setHeight(e);}},{key:"background",get:function get(){return this.e(),this.webViewer.getBackground();},set:function set(e){this.e(),CO(e)&&(e=QY(e)),this.webViewer.setBackground(e);}},{key:"border",get:function get(){return this.e(),this.webViewer.getBorder();},set:function set(e){this.e(),this.webViewer.setBorder(e);}},{key:"innerBorder",get:function get(){return this.e(),this.webViewer.getInnerBorder();},set:function set(e){this.e(),this.webViewer.setInnerBorder(e);}},{key:"selectedPageBorder",get:function get(){return this.e(),this.webViewer.getSelectedPageBorder();},set:function set(e){this.e(),this.webViewer.setSelectedPageBorder(e);}},{key:"selectedPageBackground",get:function get(){return this.e(),this.webViewer.getSelectedPageBackground();},set:function set(e){this.e(),CO(e)&&(e=QY(e)),this.webViewer.setSelectedPageBackground(e);}},{key:"selectedAreaBorderColor",get:function get(){return this.e(),this.webViewer.getSelectedAreaBorderColor();},set:function set(e){this.e(),CO(e)&&(e=QY(e)),this.webViewer.setSelectedAreaBorderColor(e);}},{key:"selectionRectAspectRatio",get:function get(){return this.e(),this.webViewer.getSelectionRectAspectRatio();},set:function set(e){this.e(),this.webViewer.setSelectionRectAspectRatio(e);}},{key:"showPageNumber",get:function get(){return this.e(),this.webViewer.getShowPageNumber();},set:function set(e){this.e(),this.webViewer.setShowPageNumber(e);}},{key:"showCheckbox",get:function get(){return this.e(),this.webViewer.getShowCheckbox();},set:function set(e){this.e(),this.webViewer.setShowCheckbox(e);}},{key:"cursor",get:function get(){return this.e(),this.webViewer.getCursor();},set:function set(e){this.e(),this.webViewer.setCursor(e);}},{key:"ifAutoScroll",get:function get(){return this.e(),this.webViewer.getIfAutoScroll();},set:function set(e){this.e(),this.webViewer.setIfAutoScroll(e);}},{key:"pageMargin",get:function get(){return this.e(),this.webViewer.getPageMargin();},set:function set(e){this.e(),this.webViewer.setPageMargin(e);}},{key:"zoom",get:function get(){return this.e(),this.webViewer.getZoom();},set:function set(e){this.e(),this.webViewer.setZoom(e);}},{key:"zoomOrigin",get:function get(){return this.e(),this.webViewer.getZoomOrigin();},set:function set(e){this.e(),this.webViewer.setZoomOrigin(e);}},{key:"singlePageMode",get:function get(){return this.e(),this.webViewer.getIfSinglePageMode();},set:function set(e){this.e(),this.webViewer.setIfSinglePageMode(e);}},{key:"acceptDrop",get:function get(){return this.e(),this.webViewer.getAcceptDrop();},set:function set(e){this.e(),this.webViewer.setAcceptDrop(e);}},{key:"allowSlide",get:function get(){return this.e(),this.webViewer.getAllowSlide();},set:function set(e){this.e(),this.webViewer.setAllowSlide(e);}},{key:"autoChangeIndex",get:function get(){return this.e(),this.webViewer.getAutoChangeIndex();},set:function set(e){this.e(),this.webViewer.setAutoChangeIndex(e);}},{key:"selectionMode",get:function get(){return this.e(),this.webViewer.getMultiSelectMode();},set:function set(e){this.e(),this.webViewer.setMultiSelectMode(e);}},{key:"allowPageDragging",get:function get(){return this.e(),this.webViewer.getAllowPageDragging();},set:function set(e){this.e(),this.webViewer.setAllowPageDragging(e);}},{key:"selectedImagesIndices",get:function get(){return this.e(),this.webViewer.getSelectedImagesIndices();}},{key:"next",value:function value(){return this.e(),this.webViewer.next();}},{key:"previous",value:function value(){return this.e(),this.webViewer.previous();}},{key:"first",value:function value(){return this.e(),this.webViewer.first();}},{key:"last",value:function value(){return this.e(),this.webViewer.last();}},{key:"gotoPage",value:function value(e){return this.e(),this.webViewer.gotoPage(e);}},{key:"render",value:function value(){return this.e(),this.webViewer.render();}},{key:"show",value:function value(){return this.e(),this.webViewer.show();}},{key:"hide",value:function value(){return this.e(),this.webViewer.hide();}},{key:"on",value:function value(e,t){return this.e(),this.webViewer.on(e,t);}},{key:"off",value:function value(e,t){return this.e(),this.webViewer.off(e,t);}},{key:"createImageEditor",value:function value(e){return this.e(),this.webViewer.createImageEditor(e);}},{key:"createThumbnailViewer",value:function value(e){return this.e(),this.webViewer.createThumbnailViewer(e);}},{key:"createCustomElement",value:function value(e,t,i){return this.e(),this.webViewer.createCustomElement(e,t,i);}},{key:"updateCheckboxStyle",value:function value(e){return this.e(),this.webViewer.updateCheckboxStyle(e);}},{key:"updatePageNumberStyle",value:function value(e){return this.e(),this.webViewer.updatePageNumberStyle(e);}},{key:"updateSelectionBoxStyle",value:function value(e){return this.e(),this.webViewer.setSelectionBoxStyle(e);}},{key:"clearSelectedAreas",value:function value(){return this.e(),this.webViewer.clearSelectedAreas();}},{key:"setSelectedAreas",value:function value(e){return this.e(),this.webViewer.setSelectedAreas(e);}},{key:"fitWindow",value:function value(e){return this.e(),this.webViewer.setFitType(e);}},{key:"setButtonClass",value:function value(e,t){return this.e(),this.webViewer.setButtonClass(e,t);}},{key:"setViewMode",value:function value(e,t){return this.e(),this.webViewer.setViewMode(e,t);}},{key:"bind",value:function value(e){this.e();var t,i,r=e;if(t=r,window.ShadowRoot&&t instanceof window.ShadowRoot){var n=document.createElement("div");r.appendChild(n),this.elements.push(n),r=n;}if(i=r,"object"==("undefined"==typeof HTMLElement?"undefined":Kh(HTMLElement))?i instanceof HTMLElement:i&&"object"==Kh(i)&&1===i.nodeType&&"string"==typeof i.nodeName){var o=function(e){var t=e;if(window.ShadowRoot)for(;t;){if(t instanceof window.ShadowRoot)return t;t=t.parentNode;}return!1;}(r);if(o){var a=document.createElement("style");a.innerHTML=['@import url("',Dynamsoft.DWT.ResourcesPath,"/src/dynamsoft.webtwain.viewer.css",'")'].join(""),o.appendChild(a);var s=document.createElement("style");s.innerHTML=['@import url("',Dynamsoft.DWT.ResourcesPath,"/src/dynamsoft.webtwain.css",'")'].join(""),o.appendChild(s),this.elements.push(a,s);}else o=!1;r.id&&""!==r.id||(r.id=["dwt_",AO()].join(""));}return this.webViewer.bindView(r);}},{key:"unbind",value:function value(){var e;return this.e(),pS(e=this.elements).call(e,function(e){e.parentNode&&e.parentNode.removeChild(e);}),this.webViewer.unbindView();}},{key:"getUISettings",value:function value(){return this.e(),this.webViewer.getUISettings();}},{key:"updateUISettings",value:function value(){return this.e(),this.webViewer.updateUISettings();}},{key:"resetUISettings",value:function value(){return this.e(),this.webViewer.resetViewerSettings();}},{key:"getVisiblePagesInfo",value:function value(){return this.e(),this.webViewer.getVisiblePagesInfo();}}]);}(),Jq=function(e){function t(e,i){return dS(this,t),nO(this,t,[e,i]);}return Qb(t,e),hS(t,[{key:"errorCode",get:function get(){return this.webViewer.error.getError().errCode;}},{key:"errorString",get:function get(){return this.webViewer.error.getError().errorString;}},{key:"SelectedImagesIndices",get:function get(){return this.webViewer.getSelectedImagesIndices();}},{key:"rotate",value:function value(e,t,i){return this.webViewer.rotate(e,t,i);}},{key:"crop",value:function value(e,t){return this.webViewer.crop(e,t);}}]);}($q);HTMLCanvasElement.prototype.toBlob||ZN(HTMLCanvasElement.prototype,"toBlob",{value:function value(e,t,i){for(var r=atob(this.toDataURL(t,i).split(",")[1]),n=r.length,o=new Uint8Array(n),a=0;a<n;a++)o[a]=r.charCodeAt(a);e(new Blob([o],{type:t||"image/png"}));}});var Qq=window.Dynamsoft||window;Qq.DWTViewer=$q,Qq.DWTViewerEx=Jq;}();
